# Comparing `tmp/dask-2023.5.0.tar.gz` & `tmp/dask-2023.5.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dask-2023.5.0.tar", last modified: Fri May 12 15:53:17 2023, max compression
+gzip compressed data, was "dask-2023.5.1.tar", last modified: Fri May 26 20:09:35 2023, max compression
```

## Comparing `dask-2023.5.0.tar` & `dask-2023.5.1.tar`

### file list

```diff
@@ -1,486 +1,487 @@
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:17.149675 dask-2023.5.0/
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1531 2022-08-02 08:55:22.000000 dask-2023.5.0/LICENSE.txt
--rw-r--r--   0 jtomlinson   (502) staff       (20)      325 2022-08-02 08:55:22.000000 dask-2023.5.0/MANIFEST.in
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2582 2023-05-12 15:53:17.149102 dask-2023.5.0/PKG-INFO
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1291 2022-08-02 08:55:22.000000 dask-2023.5.0/README.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2361 2023-04-27 14:07:51.000000 dask-2023.5.0/conftest.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:17.150206 dask-2023.5.0/dask/
--rw-r--r--   0 jtomlinson   (502) staff       (20)      428 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)       97 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/__main__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      607 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/_compatibility.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      500 2023-05-12 15:53:17.150347 dask-2023.5.0/dask/_version.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.607715 dask-2023.5.0/dask/array/
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1543 2019-09-09 13:11:42.000000 dask-2023.5.0/dask/array/NUMPY_LICENSE.txt
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5377 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12564 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/backends.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     9947 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/array/blockwise.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12268 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/chunk.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5030 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/array/chunk_types.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)   190916 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/array/core.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    40564 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/creation.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2078 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/cupy_entry_point.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      490 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/array/dispatch.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     9153 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/array/einsumfuncs.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7216 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/array/fft.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    32620 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/array/gufunc.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1960 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/image.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.609191 dask-2023.5.0/dask/array/lib/
--rw-r--r--   0 jtomlinson   (502) staff       (20)       41 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/lib/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)       65 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/lib/stride_tricks.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    53299 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/linalg.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6327 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/array/ma.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5663 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/numpy_compat.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12811 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/optimization.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    28444 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/overlap.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    10616 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/percentile.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    40795 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/random.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    27183 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/rechunk.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    57251 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/reductions.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    10729 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/reshape.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    81898 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/routines.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    72595 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/slicing.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    14578 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/stats.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     8012 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/array/svg.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.706168 dask-2023.5.0/dask/array/tests/
--rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/array/tests/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)   161425 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_array_core.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6653 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_array_function.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3123 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/tests/test_array_utils.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    23186 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_atop.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3055 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/array/tests/test_chunk.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    31114 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/tests/test_creation.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    19852 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_core.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6420 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_creation.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      558 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_gufunc.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    13376 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_linalg.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4267 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/tests/test_cupy_overlap.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2826 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_percentile.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6443 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/tests/test_cupy_random.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2188 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_reductions.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7401 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_routines.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4841 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/tests/test_cupy_slicing.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2946 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_sparse.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     8829 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_dispatch.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     8401 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/tests/test_fft.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    20977 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_gufunc.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1446 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/array/tests/test_image.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    36412 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_linalg.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    15599 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_masked.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1051 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/array/tests/test_numpy_compat.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    17410 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/tests/test_optimization.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    26682 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_overlap.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3407 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_percentiles.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    15467 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/tests/test_random.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    33636 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_rechunk.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    32720 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_reductions.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7253 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/array/tests/test_reshape.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    83813 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_routines.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    32266 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_slicing.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6556 2022-08-17 10:33:51.000000 dask-2023.5.0/dask/array/tests/test_sparse.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5453 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/array/tests/test_stats.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2704 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/array/tests/test_svg.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      489 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/array/tests/test_testing.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    17354 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/tests/test_ufunc.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2670 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/tests/test_wrap.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1281 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/array/tests/test_xarray.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4701 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/tiledb_io.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     9907 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/ufunc.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    18638 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/utils.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6870 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/wrap.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4909 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/backends.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.716839 dask-2023.5.0/dask/bag/
--rw-r--r--   0 jtomlinson   (502) staff       (20)      867 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/bag/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     9075 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/bag/avro.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      726 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/bag/chunk.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    84624 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/bag/core.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5428 2022-08-17 10:33:51.000000 dask-2023.5.0/dask/bag/random.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.758481 dask-2023.5.0/dask/bag/tests/
--rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/bag/tests/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3772 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/bag/tests/test_avro.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    49657 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/bag/tests/test_bag.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6492 2022-08-17 10:33:51.000000 dask-2023.5.0/dask/bag/tests/test_random.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5013 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/bag/tests/test_text.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6729 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/bag/text.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      204 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/bag/utils.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    52102 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/base.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    53252 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/blockwise.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.763969 dask-2023.5.0/dask/bytes/
--rw-r--r--   0 jtomlinson   (502) staff       (20)       39 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/bytes/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6897 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/bytes/core.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.773717 dask-2023.5.0/dask/bytes/tests/
--rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/bytes/tests/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5122 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/bytes/tests/test_bytes_utils.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      494 2020-01-16 09:59:28.000000 dask-2023.5.0/dask/bytes/tests/test_compression.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6657 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/bytes/tests/test_http.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    11440 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/bytes/tests/test_local.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    19631 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/bytes/tests/test_s3.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      464 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/bytes/utils.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1965 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/cache.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4067 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/callbacks.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3028 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/cli.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      487 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/compatibility.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    21645 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/config.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1720 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/context.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    14797 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/core.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6944 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dask-schema.yaml
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1498 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dask.yaml
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.812526 dask-2023.5.0/dask/dataframe/
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1776 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/dataframe/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6978 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/_compat.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2135 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/_dtypes.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3183 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/_pyarrow.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1900 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/_pyarrow_compat.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12101 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/accessor.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    24289 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/backends.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     9471 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/categorical.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)   299064 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/core.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4437 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/dataframe/dispatch.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      516 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/dataframe/extensions.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)   114841 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/groupby.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2427 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/dataframe/hyperloglog.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    13376 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/indexing.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.822775 dask-2023.5.0/dask/dataframe/io/
--rw-r--r--   0 jtomlinson   (502) staff       (20)      670 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/dataframe/io/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    33618 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/io/csv.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5745 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/dataframe/io/demo.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    18043 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/hdf.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    38497 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/dataframe/io/io.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    11127 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/json.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.827274 dask-2023.5.0/dask/dataframe/io/orc/
--rw-r--r--   0 jtomlinson   (502) staff       (20)       56 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/dataframe/io/orc/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4451 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/io/orc/arrow.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7062 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/io/orc/core.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      473 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/dataframe/io/orc/utils.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.833203 dask-2023.5.0/dask/dataframe/io/parquet/
--rw-r--r--   0 jtomlinson   (502) staff       (20)      130 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/dataframe/io/parquet/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    71139 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/parquet/arrow.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    66556 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/parquet/core.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    52390 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/parquet/fastparquet.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    32860 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/parquet/utils.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    21072 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/sql.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.844797 dask-2023.5.0/dask/dataframe/io/tests/
--rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/dataframe/io/tests/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    58831 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/tests/test_csv.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5000 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/io/tests/test_demo.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    27186 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/tests/test_hdf.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    34402 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/tests/test_io.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     8589 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/tests/test_json.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5202 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/io/tests/test_orc.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)   164356 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/io/tests/test_parquet.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    17596 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/tests/test_sql.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7863 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/utils.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    13979 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/methods.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    53848 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/multi.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1564 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/dataframe/numeric.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     8742 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/optimize.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    20008 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/partitionquantiles.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    11874 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/reshape.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    22149 2023-03-24 11:33:15.000000 dask-2023.5.0/dask/dataframe/rolling.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    38047 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/shuffle.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.873710 dask-2023.5.0/dask/dataframe/tests/
--rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/dataframe/tests/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    10597 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/tests/test_accessors.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    66179 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/tests/test_arithmetics_reduction.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      906 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/dataframe/tests/test_boolean.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    16642 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/tests/test_categorical.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)   187198 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/tests/test_dataframe.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1420 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/dataframe/tests/test_extensions.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    14707 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/dataframe/tests/test_format.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)   119303 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/tests/test_groupby.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2666 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/dataframe/tests/test_hashing.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2861 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/dataframe/tests/test_hyperloglog.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    22346 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/tests/test_indexing.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6998 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/dataframe/tests/test_merge_column_and_index.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    90981 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/tests/test_multi.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2084 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/tests/test_numeric.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1031 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/dataframe/tests/test_optimize_dataframe.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6626 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/tests/test_pyarrow.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4514 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/dataframe/tests/test_pyarrow_compat.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    11535 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/tests/test_reshape.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    17488 2023-03-24 11:33:15.000000 dask-2023.5.0/dask/dataframe/tests/test_rolling.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    53350 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/tests/test_shuffle.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    16559 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/tests/test_ufunc.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    21243 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/tests/test_utils_dataframe.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.875090 dask-2023.5.0/dask/dataframe/tseries/
--rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/dataframe/tseries/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7628 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/dataframe/tseries/resample.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.876744 dask-2023.5.0/dask/dataframe/tseries/tests/
--rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/dataframe/tseries/tests/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6830 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/tseries/tests/test_resample.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    26648 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/utils.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5278 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/datasets.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    24353 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/delayed.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.881528 dask-2023.5.0/dask/diagnostics/
--rw-r--r--   0 jtomlinson   (502) staff       (20)      222 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/diagnostics/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12100 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/diagnostics/profile.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    16296 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/diagnostics/profile_visualize.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4965 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/diagnostics/progress.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.884254 dask-2023.5.0/dask/diagnostics/tests/
--rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/diagnostics/tests/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12009 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/diagnostics/tests/test_profiler.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3352 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/diagnostics/tests/test_progress.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      679 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/distributed.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    16587 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/dot.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    19595 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/graph_manipulation.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2456 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/hashing.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    34771 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/highlevelgraph.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    46007 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/layers.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    18888 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/local.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      450 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/ml.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     8466 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/multiprocessing.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    35602 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/optimization.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    45732 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/order.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/py.typed
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12561 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/rewrite.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7254 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/sizeof.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1474 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/system.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.917444 dask-2023.5.0/dask/tests/
--rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/tests/__init__.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      706 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/tests/test_backends.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    51088 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_base.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1577 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/tests/test_cache.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2534 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/tests/test_callbacks.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1163 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/tests/test_ci.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3230 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_cli.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      343 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_compatibility.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    17810 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_config.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1101 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_context.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7386 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_core.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1076 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_datasets.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    22953 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/tests/test_delayed.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    31257 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_distributed.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      889 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/tests/test_docs.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12235 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/tests/test_dot.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    15036 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/tests/test_graph_manipulation.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1059 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/tests/test_hashing.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7929 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_highgraph.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     9305 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/tests/test_layers.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4972 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_local.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      382 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_ml.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     8421 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_multiprocessing.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    45191 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_optimization.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    28193 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_order.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4648 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/tests/test_rewrite.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7482 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/tests/test_sizeof.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7118 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_spark_compat.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1361 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/tests/test_system.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4713 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/tests/test_threaded.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5670 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/tests/test_typing.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    21288 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/tests/test_utils.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1562 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_utils_test.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)      175 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/tests/warning_aliases.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2993 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/threaded.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    14538 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/typing.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    55904 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/utils.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4825 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/utils_test.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.919071 dask-2023.5.0/dask/widgets/
--rw-r--r--   0 jtomlinson   (502) staff       (20)      756 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/widgets/__init__.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.922274 dask-2023.5.0/dask/widgets/templates/
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1295 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/widgets/templates/array.html.j2
--rw-r--r--   0 jtomlinson   (502) staff       (20)      124 2022-08-02 08:55:26.000000 dask-2023.5.0/dask/widgets/templates/dataframe.html.j2
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2579 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/widgets/templates/highlevelgraph.html.j2
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1981 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/widgets/templates/highlevelgraph_layer.html.j2
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.922828 dask-2023.5.0/dask/widgets/tests/
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.925752 dask-2023.5.0/dask/widgets/tests/templates/
--rw-r--r--   0 jtomlinson   (502) staff       (20)       38 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/widgets/tests/templates/bytes.html.j2
--rw-r--r--   0 jtomlinson   (502) staff       (20)       39 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/widgets/tests/templates/custom_filter.html.j2
--rw-r--r--   0 jtomlinson   (502) staff       (20)       30 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/widgets/tests/templates/example.html.j2
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1365 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/widgets/tests/test_widgets.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1084 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/widgets/widgets.py
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.576244 dask-2023.5.0/dask.egg-info/
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2582 2023-05-12 15:53:16.000000 dask-2023.5.0/dask.egg-info/PKG-INFO
--rw-r--r--   0 jtomlinson   (502) staff       (20)    13902 2023-05-12 15:53:16.000000 dask-2023.5.0/dask.egg-info/SOURCES.txt
--rw-r--r--   0 jtomlinson   (502) staff       (20)        1 2023-05-12 15:53:16.000000 dask-2023.5.0/dask.egg-info/dependency_links.txt
--rw-r--r--   0 jtomlinson   (502) staff       (20)      124 2023-05-12 15:53:16.000000 dask-2023.5.0/dask.egg-info/entry_points.txt
--rw-r--r--   0 jtomlinson   (502) staff       (20)        1 2023-05-12 15:53:15.000000 dask-2023.5.0/dask.egg-info/not-zip-safe
--rw-r--r--   0 jtomlinson   (502) staff       (20)      443 2023-05-12 15:53:16.000000 dask-2023.5.0/dask.egg-info/requires.txt
--rw-r--r--   0 jtomlinson   (502) staff       (20)        5 2023-05-12 15:53:16.000000 dask-2023.5.0/dask.egg-info/top_level.txt
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.927386 dask-2023.5.0/docs/
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5741 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/Makefile
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5186 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/make.bat
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.988272 dask-2023.5.0/docs/source/
--rw-r--r--   0 jtomlinson   (502) staff       (20)    17598 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/10-minutes-to-dask.rst
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.995555 dask-2023.5.0/docs/source/_static/
--rw-r--r--   0 jtomlinson   (502) staff       (20)    10187 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/_static/config_converter.js
--rw-r--r--   0 jtomlinson   (502) staff       (20)    11021 2019-09-09 13:11:43.000000 dask-2023.5.0/docs/source/_static/dask-simple.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2375 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/_static/main-page.css
--rw-r--r--   0 jtomlinson   (502) staff       (20)    15598 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/_static/profile.html
--rw-r--r--   0 jtomlinson   (502) staff       (20)    65304 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/_static/stacked_profile.html
--rw-r--r--   0 jtomlinson   (502) staff       (20)      523 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/_static/style.css
--rw-r--r--   0 jtomlinson   (502) staff       (20)      365 2021-08-11 13:55:55.000000 dask-2023.5.0/docs/source/_static/theme_overrides.css
--rw-r--r--   0 jtomlinson   (502) staff       (20)   292662 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/_static/transpose_cyto.html
--rw-r--r--   0 jtomlinson   (502) staff       (20)    49423 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/_static/yaml.min.js
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.996741 dask-2023.5.0/docs/source/_templates/
--rw-r--r--   0 jtomlinson   (502) staff       (20)      180 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/_templates/layout.html
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2235 2022-08-17 10:33:51.000000 dask-2023.5.0/docs/source/api.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6896 2023-03-23 09:49:13.000000 dask-2023.5.0/docs/source/array-api.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2943 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/array-assignment.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4740 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/array-best-practices.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    13035 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array-chunks.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    18437 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array-creation.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5885 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/array-design.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2857 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array-gufunc.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6069 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/array-overlap.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3411 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array-random.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4137 2021-08-18 09:15:49.000000 dask-2023.5.0/docs/source/array-slicing.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3291 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array-sparse.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2018 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/array-stack.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1140 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array-stats.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4121 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1574 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/bag-api.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4557 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/bag-creation.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4068 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/bag.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    14205 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/best-practices.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5553 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/caching.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)   301741 2023-05-12 15:39:48.000000 dask-2023.5.0/docs/source/changelog.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)      211 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/cheatsheet.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4047 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/cli.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    15465 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/conf.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    16654 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/configuration.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    18651 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/custom-collections.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3604 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/custom-graphs.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)      896 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/dashboard-progress-script.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)    15045 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/dashboard.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)   203552 2019-09-09 13:11:43.000000 dask-2023.5.0/docs/source/daskcheatsheet.pdf
--rw-r--r--   0 jtomlinson   (502) staff       (20)    13693 2023-05-12 15:11:40.000000 dask-2023.5.0/docs/source/dataframe-api.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     9611 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/dataframe-best-practices.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3951 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/dataframe-categoricals.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5967 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/dataframe-create.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5002 2022-08-17 10:33:51.000000 dask-2023.5.0/docs/source/dataframe-design.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6224 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/dataframe-extend.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     8050 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/dataframe-groupby.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6115 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/dataframe-indexing.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3454 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/dataframe-joins.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    10952 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/dataframe-parquet.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12661 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/dataframe-sql.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7772 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/dataframe.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)      363 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/debugging-performance.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1696 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/delayed-api.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    17616 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/delayed-best-practices.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1497 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/delayed-collections.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6357 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/delayed.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3620 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/deploying-cli.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2965 2023-05-12 15:11:40.000000 dask-2023.5.0/docs/source/deploying-cloud.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2868 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/deploying-docker.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     9939 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/deploying-hpc.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4001 2023-05-12 15:11:40.000000 dask-2023.5.0/docs/source/deploying-kubernetes.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5823 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/deploying-python-advanced.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2839 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/deploying-python.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1619 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/deploying-ssh.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7266 2023-05-12 15:11:40.000000 dask-2023.5.0/docs/source/deploying.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    10758 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/deployment-considerations.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    13142 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/develop.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4442 2022-08-17 10:33:51.000000 dask-2023.5.0/docs/source/diagnostics-distributed.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    10407 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/diagnostics-local.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4323 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/ecosystem.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    19964 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/faq.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    25569 2023-05-12 15:11:40.000000 dask-2023.5.0/docs/source/futures.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5820 2020-03-25 19:50:34.000000 dask-2023.5.0/docs/source/gpu.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2541 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/graph_manipulation.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5433 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/graphs.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5399 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/graphviz.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6946 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/high-level-graphs.rst
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:17.002504 dask-2023.5.0/docs/source/how-to/
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4364 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/how-to/adaptive.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    15360 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/how-to/connect-to-remote-data.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4209 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/how-to/customize-initialization.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    10859 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/how-to/debug.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1722 2022-08-17 10:33:51.000000 dask-2023.5.0/docs/source/how-to/extend-sizeof.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)      433 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/how-to/index.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4562 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/how-to/manage-environments.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6680 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/how-to/selecting-the-collection-backend.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)      902 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/how-to/setup-prometheus.rst
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:17.146953 dask-2023.5.0/docs/source/images/
--rw-r--r--   0 jtomlinson   (502) staff       (20)    99565 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/10_minutes_array_graph.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    22442 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/10_minutes_bag_graph.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    56229 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/10_minutes_dataframe_graph.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4059 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/HHMI_Janelia_Color.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    18406 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/array.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)  1620104 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/async-embarrassing.gif
--rw-r--r--   0 jtomlinson   (502) staff       (20)    10752 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/concurrent-futures-threaded.webp
--rw-r--r--   0 jtomlinson   (502) staff       (20)   135129 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/crosstalk.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)  2367087 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dashboard_jupyterlab.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    37971 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dashboard_link.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    68712 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dashboard_memory.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)   281018 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/images/dashboard_memory_new.gif
--rw-r--r--   0 jtomlinson   (502) staff       (20)    25435 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/images/dashboard_progress.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)   276928 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/images/dashboard_status.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12009 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/images/dashboard_task_processing.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    58238 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dashboard_task_stream_unhealthy.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)   103654 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dashboard_taskstream_healthy.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)   112822 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-adaptive.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)    14645 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-array.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)   222084 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-cluster-manager.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)    18782 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-dataframe.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)   381903 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-overview-distributed-callout.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)   357643 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-overview-schedulers.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)    97471 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-overview.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3022 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_horizontal.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3651 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_horizontal_black.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3767 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_horizontal_on_blue.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3738 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_horizontal_on_pink.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3738 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_horizontal_white.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1607 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_icon.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1571 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_icon_black.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1607 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_icon_on_pink.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1609 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_icon_white.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)    20216 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/delayed-inc-double-add.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)   104628 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/distributed-overview.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)    18297 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/frame-shuffle.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)    22979 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/frame-sort.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12181 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/frame.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)    41828 2022-08-02 08:26:56.000000 dask-2023.5.0/docs/source/images/gputester-msg.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)   210392 2020-02-12 13:02:38.000000 dask-2023.5.0/docs/source/images/growth_of_languages.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)   167834 2020-02-12 13:02:38.000000 dask-2023.5.0/docs/source/images/growth_of_libraries.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4097 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/inc-add.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)   123010 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/map-reduce-task-scheduling.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)   482302 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/map_blocks_drop_axis.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)   113067 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/merge_chunks.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    63244 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/merge_chunks_false.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    13024 2020-03-25 19:50:34.000000 dask-2023.5.0/docs/source/images/optimize_dask1.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     8803 2020-03-25 19:50:34.000000 dask-2023.5.0/docs/source/images/optimize_dask2.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5198 2020-03-25 19:50:34.000000 dask-2023.5.0/docs/source/images/optimize_dask3.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4104 2020-03-25 19:50:34.000000 dask-2023.5.0/docs/source/images/optimize_dask4.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2738 2020-03-25 19:50:34.000000 dask-2023.5.0/docs/source/images/optimize_dask5.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)   292827 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/order-failure.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)   239828 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/order-success.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    40833 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/overlap.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)    18785 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/overlapping-blocks.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4537 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/overlapping-neighbors.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)    20533 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/pipeline.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)    31576 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/reshape.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    31410 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/reshape_problem.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    33288 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/reshape_rechunked.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    50209 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/scaling-edges.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    68476 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/scaling-nodes.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    21294 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/simple-dask.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    27572 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/transpose-hlg-hovertooltip.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    84492 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/transpose-hlg-html-repr.png
--rw-r--r--   0 jtomlinson   (502) staff       (20)    39365 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/transpose.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)    22446 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/transpose_opt.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)   115022 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/trivial.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     2451 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/unoverlapping-neighbors.svg
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6237 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/index.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    15235 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/install.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)      341 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/internals.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)      868 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/logos.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3573 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/maintainers.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12200 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/optimize.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     7119 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/order.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4810 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/phases-of-computation.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5089 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/presentations.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6010 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/scheduler-overview.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4493 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/scheduling-policy.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    11014 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/scheduling.rst
-drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:17.147983 dask-2023.5.0/docs/source/scripts/
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3258 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/scripts/scheduling.py
--rw-r--r--   0 jtomlinson   (502) staff       (20)     6104 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/shared.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     9342 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/spark.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     3966 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/spec.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     4608 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/support.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     1831 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/understanding-performance.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    12205 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/user-interfaces.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)    11744 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/why.rst
--rw-r--r--   0 jtomlinson   (502) staff       (20)     5500 2023-05-12 15:29:01.000000 dask-2023.5.0/pyproject.toml
--rw-r--r--   0 jtomlinson   (502) staff       (20)       38 2023-05-12 15:53:17.149774 dask-2023.5.0/setup.cfg
--rwxr-xr-x   0 jtomlinson   (502) staff       (20)      194 2023-04-27 14:07:51.000000 dask-2023.5.0/setup.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.479508 dask-2023.5.1/
+-rw-r--r--   0 james      (501) staff       (20)     1531 2022-10-24 20:44:15.000000 dask-2023.5.1/LICENSE.txt
+-rw-r--r--   0 james      (501) staff       (20)      325 2022-11-09 22:20:24.000000 dask-2023.5.1/MANIFEST.in
+-rw-r--r--   0 james      (501) staff       (20)     2532 2023-05-26 20:09:35.478474 dask-2023.5.1/PKG-INFO
+-rw-r--r--   0 james      (501) staff       (20)     1291 2022-11-09 22:20:24.000000 dask-2023.5.1/README.rst
+-rw-r--r--   0 james      (501) staff       (20)     2397 2023-05-24 20:58:41.000000 dask-2023.5.1/conftest.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.480087 dask-2023.5.1/dask/
+-rw-r--r--   0 james      (501) staff       (20)      464 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)      133 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/__main__.py
+-rw-r--r--   0 james      (501) staff       (20)      643 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/_compatibility.py
+-rw-r--r--   0 james      (501) staff       (20)      500 2023-05-26 20:09:35.480178 dask-2023.5.1/dask/_version.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.814626 dask-2023.5.1/dask/array/
+-rw-r--r--   0 james      (501) staff       (20)     1543 2021-06-08 02:50:30.000000 dask-2023.5.1/dask/array/NUMPY_LICENSE.txt
+-rw-r--r--   0 james      (501) staff       (20)     5413 2023-05-24 21:26:44.000000 dask-2023.5.1/dask/array/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    12600 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/backends.py
+-rw-r--r--   0 james      (501) staff       (20)     9983 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/blockwise.py
+-rw-r--r--   0 james      (501) staff       (20)    12304 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/chunk.py
+-rw-r--r--   0 james      (501) staff       (20)     5066 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/chunk_types.py
+-rw-r--r--   0 james      (501) staff       (20)   190916 2023-05-19 15:53:47.000000 dask-2023.5.1/dask/array/core.py
+-rw-r--r--   0 james      (501) staff       (20)    40564 2023-05-03 18:02:08.000000 dask-2023.5.1/dask/array/creation.py
+-rw-r--r--   0 james      (501) staff       (20)     2114 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/cupy_entry_point.py
+-rw-r--r--   0 james      (501) staff       (20)      526 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)     9189 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/einsumfuncs.py
+-rw-r--r--   0 james      (501) staff       (20)     7252 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/fft.py
+-rw-r--r--   0 james      (501) staff       (20)    32656 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/gufunc.py
+-rw-r--r--   0 james      (501) staff       (20)     1996 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/image.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.815913 dask-2023.5.1/dask/array/lib/
+-rw-r--r--   0 james      (501) staff       (20)       77 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/lib/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)      101 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/lib/stride_tricks.py
+-rw-r--r--   0 james      (501) staff       (20)    53335 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/linalg.py
+-rw-r--r--   0 james      (501) staff       (20)     6363 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/ma.py
+-rw-r--r--   0 james      (501) staff       (20)     5699 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/numpy_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    12838 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    28480 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/overlap.py
+-rw-r--r--   0 james      (501) staff       (20)    10652 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/percentile.py
+-rw-r--r--   0 james      (501) staff       (20)    40604 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/random.py
+-rw-r--r--   0 james      (501) staff       (20)    28023 2023-05-24 22:18:59.000000 dask-2023.5.1/dask/array/rechunk.py
+-rw-r--r--   0 james      (501) staff       (20)    57287 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/reductions.py
+-rw-r--r--   0 james      (501) staff       (20)    10765 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    81988 2023-05-19 15:53:47.000000 dask-2023.5.1/dask/array/routines.py
+-rw-r--r--   0 james      (501) staff       (20)    72631 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/slicing.py
+-rw-r--r--   0 james      (501) staff       (20)    14613 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/stats.py
+-rw-r--r--   0 james      (501) staff       (20)     8048 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/svg.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.882922 dask-2023.5.1/dask/array/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.5.1/dask/array/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)   161461 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_array_core.py
+-rw-r--r--   0 james      (501) staff       (20)     6689 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_array_function.py
+-rw-r--r--   0 james      (501) staff       (20)     3159 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_array_utils.py
+-rw-r--r--   0 james      (501) staff       (20)    23222 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_atop.py
+-rw-r--r--   0 james      (501) staff       (20)     3304 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_chunk.py
+-rw-r--r--   0 james      (501) staff       (20)    31150 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_creation.py
+-rw-r--r--   0 james      (501) staff       (20)    19888 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_cupy_core.py
+-rw-r--r--   0 james      (501) staff       (20)     6456 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_cupy_creation.py
+-rw-r--r--   0 james      (501) staff       (20)      594 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_cupy_gufunc.py
+-rw-r--r--   0 james      (501) staff       (20)    13412 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_cupy_linalg.py
+-rw-r--r--   0 james      (501) staff       (20)     4303 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_cupy_overlap.py
+-rw-r--r--   0 james      (501) staff       (20)     2862 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_cupy_percentile.py
+-rw-r--r--   0 james      (501) staff       (20)     9219 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_cupy_random.py
+-rw-r--r--   0 james      (501) staff       (20)     2224 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_cupy_reductions.py
+-rw-r--r--   0 james      (501) staff       (20)     7437 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_cupy_routines.py
+-rw-r--r--   0 james      (501) staff       (20)     4877 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_cupy_slicing.py
+-rw-r--r--   0 james      (501) staff       (20)     2982 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_cupy_sparse.py
+-rw-r--r--   0 james      (501) staff       (20)     8865 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)     8437 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_fft.py
+-rw-r--r--   0 james      (501) staff       (20)    21013 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_gufunc.py
+-rw-r--r--   0 james      (501) staff       (20)     1482 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_image.py
+-rw-r--r--   0 james      (501) staff       (20)    36448 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_linalg.py
+-rw-r--r--   0 james      (501) staff       (20)    15635 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_masked.py
+-rw-r--r--   0 james      (501) staff       (20)     1087 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_numpy_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    17446 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    26718 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_overlap.py
+-rw-r--r--   0 james      (501) staff       (20)     3443 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_percentiles.py
+-rw-r--r--   0 james      (501) staff       (20)    15353 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_random.py
+-rw-r--r--   0 james      (501) staff       (20)    36341 2023-05-24 21:57:25.000000 dask-2023.5.1/dask/array/tests/test_rechunk.py
+-rw-r--r--   0 james      (501) staff       (20)    32756 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_reductions.py
+-rw-r--r--   0 james      (501) staff       (20)     7289 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    83849 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_routines.py
+-rw-r--r--   0 james      (501) staff       (20)    32302 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_slicing.py
+-rw-r--r--   0 james      (501) staff       (20)     6592 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_sparse.py
+-rw-r--r--   0 james      (501) staff       (20)     5489 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_stats.py
+-rw-r--r--   0 james      (501) staff       (20)     2740 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_svg.py
+-rw-r--r--   0 james      (501) staff       (20)      525 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_testing.py
+-rw-r--r--   0 james      (501) staff       (20)    17390 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_ufunc.py
+-rw-r--r--   0 james      (501) staff       (20)     2706 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_wrap.py
+-rw-r--r--   0 james      (501) staff       (20)     1317 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tests/test_xarray.py
+-rw-r--r--   0 james      (501) staff       (20)     4737 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/tiledb_io.py
+-rw-r--r--   0 james      (501) staff       (20)     9943 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/ufunc.py
+-rw-r--r--   0 james      (501) staff       (20)    18674 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     6906 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/array/wrap.py
+-rw-r--r--   0 james      (501) staff       (20)     4936 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/backends.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.888761 dask-2023.5.1/dask/bag/
+-rw-r--r--   0 james      (501) staff       (20)      903 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bag/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     9111 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bag/avro.py
+-rw-r--r--   0 james      (501) staff       (20)      763 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bag/chunk.py
+-rw-r--r--   0 james      (501) staff       (20)    84784 2023-05-24 15:39:04.000000 dask-2023.5.1/dask/bag/core.py
+-rw-r--r--   0 james      (501) staff       (20)     5464 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bag/random.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.892166 dask-2023.5.1/dask/bag/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.5.1/dask/bag/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     3808 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bag/tests/test_avro.py
+-rw-r--r--   0 james      (501) staff       (20)    50747 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bag/tests/test_bag.py
+-rw-r--r--   0 james      (501) staff       (20)     6528 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bag/tests/test_random.py
+-rw-r--r--   0 james      (501) staff       (20)     5049 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bag/tests/test_text.py
+-rw-r--r--   0 james      (501) staff       (20)     6765 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bag/text.py
+-rw-r--r--   0 james      (501) staff       (20)      241 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bag/utils.py
+-rw-r--r--   0 james      (501) staff       (20)    52086 2023-05-26 16:18:40.000000 dask-2023.5.1/dask/base.py
+-rw-r--r--   0 james      (501) staff       (20)    53252 2023-05-19 15:53:47.000000 dask-2023.5.1/dask/blockwise.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.894508 dask-2023.5.1/dask/bytes/
+-rw-r--r--   0 james      (501) staff       (20)       75 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bytes/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     6933 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bytes/core.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.900449 dask-2023.5.1/dask/bytes/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.5.1/dask/bytes/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     5158 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bytes/tests/test_bytes_utils.py
+-rw-r--r--   0 james      (501) staff       (20)      530 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bytes/tests/test_compression.py
+-rw-r--r--   0 james      (501) staff       (20)     6657 2023-05-03 18:02:08.000000 dask-2023.5.1/dask/bytes/tests/test_http.py
+-rw-r--r--   0 james      (501) staff       (20)    11476 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bytes/tests/test_local.py
+-rw-r--r--   0 james      (501) staff       (20)    19667 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bytes/tests/test_s3.py
+-rw-r--r--   0 james      (501) staff       (20)      500 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/bytes/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     2001 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/cache.py
+-rw-r--r--   0 james      (501) staff       (20)     4067 2022-10-24 20:44:15.000000 dask-2023.5.1/dask/callbacks.py
+-rw-r--r--   0 james      (501) staff       (20)     3064 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/cli.py
+-rw-r--r--   0 james      (501) staff       (20)      523 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/compatibility.py
+-rw-r--r--   0 james      (501) staff       (20)    21645 2023-05-03 18:02:08.000000 dask-2023.5.1/dask/config.py
+-rw-r--r--   0 james      (501) staff       (20)     1756 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/context.py
+-rw-r--r--   0 james      (501) staff       (20)    14833 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/core.py
+-rw-r--r--   0 james      (501) staff       (20)     6944 2023-05-03 18:02:08.000000 dask-2023.5.1/dask/dask-schema.yaml
+-rw-r--r--   0 james      (501) staff       (20)     1498 2023-05-03 18:02:08.000000 dask-2023.5.1/dask/dask.yaml
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.925194 dask-2023.5.1/dask/dataframe/
+-rw-r--r--   0 james      (501) staff       (20)     1812 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     7496 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/_compat.py
+-rw-r--r--   0 james      (501) staff       (20)     2171 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/_dtypes.py
+-rw-r--r--   0 james      (501) staff       (20)     3219 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/_pyarrow.py
+-rw-r--r--   0 james      (501) staff       (20)     1936 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/_pyarrow_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    12101 2023-05-03 18:02:08.000000 dask-2023.5.1/dask/dataframe/accessor.py
+-rw-r--r--   0 james      (501) staff       (20)    24298 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/backends.py
+-rw-r--r--   0 james      (501) staff       (20)     9507 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/categorical.py
+-rw-r--r--   0 james      (501) staff       (20)   302228 2023-05-26 16:32:18.000000 dask-2023.5.1/dask/dataframe/core.py
+-rw-r--r--   0 james      (501) staff       (20)     4473 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)      552 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/extensions.py
+-rw-r--r--   0 james      (501) staff       (20)   114780 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/groupby.py
+-rw-r--r--   0 james      (501) staff       (20)     2463 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/hyperloglog.py
+-rw-r--r--   0 james      (501) staff       (20)    13412 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/indexing.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.933555 dask-2023.5.1/dask/dataframe/io/
+-rw-r--r--   0 james      (501) staff       (20)      706 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    33811 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/csv.py
+-rw-r--r--   0 james      (501) staff       (20)     5781 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/demo.py
+-rw-r--r--   0 james      (501) staff       (20)    18079 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/hdf.py
+-rw-r--r--   0 james      (501) staff       (20)    38487 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/io.py
+-rw-r--r--   0 james      (501) staff       (20)    11163 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/json.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.937064 dask-2023.5.1/dask/dataframe/io/orc/
+-rw-r--r--   0 james      (501) staff       (20)       92 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/orc/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     4487 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/orc/arrow.py
+-rw-r--r--   0 james      (501) staff       (20)     7098 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/orc/core.py
+-rw-r--r--   0 james      (501) staff       (20)      510 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/orc/utils.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.948404 dask-2023.5.1/dask/dataframe/io/parquet/
+-rw-r--r--   0 james      (501) staff       (20)      166 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/parquet/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    71237 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/parquet/arrow.py
+-rw-r--r--   0 james      (501) staff       (20)    66556 2023-05-03 18:02:08.000000 dask-2023.5.1/dask/dataframe/io/parquet/core.py
+-rw-r--r--   0 james      (501) staff       (20)    52426 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/parquet/fastparquet.py
+-rw-r--r--   0 james      (501) staff       (20)    32896 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/parquet/utils.py
+-rw-r--r--   0 james      (501) staff       (20)    21108 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/sql.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.963708 dask-2023.5.1/dask/dataframe/io/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-03-07 20:03:52.000000 dask-2023.5.1/dask/dataframe/io/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    59231 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/tests/test_csv.py
+-rw-r--r--   0 james      (501) staff       (20)     5036 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/tests/test_demo.py
+-rw-r--r--   0 james      (501) staff       (20)    27232 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/tests/test_hdf.py
+-rw-r--r--   0 james      (501) staff       (20)    34438 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/tests/test_io.py
+-rw-r--r--   0 james      (501) staff       (20)     8625 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/tests/test_json.py
+-rw-r--r--   0 james      (501) staff       (20)     5238 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/tests/test_orc.py
+-rw-r--r--   0 james      (501) staff       (20)   164976 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/tests/test_parquet.py
+-rw-r--r--   0 james      (501) staff       (20)    17632 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/tests/test_sql.py
+-rw-r--r--   0 james      (501) staff       (20)     7899 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/io/utils.py
+-rw-r--r--   0 james      (501) staff       (20)    14015 2023-05-26 19:43:33.000000 dask-2023.5.1/dask/dataframe/methods.py
+-rw-r--r--   0 james      (501) staff       (20)    53884 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/multi.py
+-rw-r--r--   0 james      (501) staff       (20)     1600 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/numeric.py
+-rw-r--r--   0 james      (501) staff       (20)     8778 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/optimize.py
+-rw-r--r--   0 james      (501) staff       (20)    20044 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/partitionquantiles.py
+-rw-r--r--   0 james      (501) staff       (20)    11825 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    22185 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/rolling.py
+-rw-r--r--   0 james      (501) staff       (20)    37975 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/shuffle.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.998479 dask-2023.5.1/dask/dataframe/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.5.1/dask/dataframe/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    10633 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_accessors.py
+-rw-r--r--   0 james      (501) staff       (20)    67628 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_arithmetics_reduction.py
+-rw-r--r--   0 james      (501) staff       (20)      942 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_boolean.py
+-rw-r--r--   0 james      (501) staff       (20)    16678 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_categorical.py
+-rw-r--r--   0 james      (501) staff       (20)   192106 2023-05-26 16:32:18.000000 dask-2023.5.1/dask/dataframe/tests/test_dataframe.py
+-rw-r--r--   0 james      (501) staff       (20)     1456 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_extensions.py
+-rw-r--r--   0 james      (501) staff       (20)    14743 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_format.py
+-rw-r--r--   0 james      (501) staff       (20)   120823 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_groupby.py
+-rw-r--r--   0 james      (501) staff       (20)     2702 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_hashing.py
+-rw-r--r--   0 james      (501) staff       (20)     2897 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_hyperloglog.py
+-rw-r--r--   0 james      (501) staff       (20)    22382 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_indexing.py
+-rw-r--r--   0 james      (501) staff       (20)     7034 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_merge_column_and_index.py
+-rw-r--r--   0 james      (501) staff       (20)      463 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_methods.py
+-rw-r--r--   0 james      (501) staff       (20)    91017 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_multi.py
+-rw-r--r--   0 james      (501) staff       (20)     2120 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_numeric.py
+-rw-r--r--   0 james      (501) staff       (20)     1067 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_optimize_dataframe.py
+-rw-r--r--   0 james      (501) staff       (20)     6662 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_pyarrow.py
+-rw-r--r--   0 james      (501) staff       (20)     4550 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_pyarrow_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    11571 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    17524 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_rolling.py
+-rw-r--r--   0 james      (501) staff       (20)    53386 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_shuffle.py
+-rw-r--r--   0 james      (501) staff       (20)    16595 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_ufunc.py
+-rw-r--r--   0 james      (501) staff       (20)    21288 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tests/test_utils_dataframe.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.000059 dask-2023.5.1/dask/dataframe/tseries/
+-rw-r--r--   0 james      (501) staff       (20)        0 2021-06-08 02:50:30.000000 dask-2023.5.1/dask/dataframe/tseries/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     7664 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tseries/resample.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.001222 dask-2023.5.1/dask/dataframe/tseries/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.5.1/dask/dataframe/tseries/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     6866 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/tseries/tests/test_resample.py
+-rw-r--r--   0 james      (501) staff       (20)    27404 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/dataframe/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     5314 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/datasets.py
+-rw-r--r--   0 james      (501) staff       (20)    24389 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/delayed.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.003784 dask-2023.5.1/dask/diagnostics/
+-rw-r--r--   0 james      (501) staff       (20)      258 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/diagnostics/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    12136 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/diagnostics/profile.py
+-rw-r--r--   0 james      (501) staff       (20)    16332 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/diagnostics/profile_visualize.py
+-rw-r--r--   0 james      (501) staff       (20)     5001 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/diagnostics/progress.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.006323 dask-2023.5.1/dask/diagnostics/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.5.1/dask/diagnostics/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    12045 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/diagnostics/tests/test_profiler.py
+-rw-r--r--   0 james      (501) staff       (20)     3388 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/diagnostics/tests/test_progress.py
+-rw-r--r--   0 james      (501) staff       (20)      715 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/distributed.py
+-rw-r--r--   0 james      (501) staff       (20)    16587 2022-11-09 22:20:24.000000 dask-2023.5.1/dask/dot.py
+-rw-r--r--   0 james      (501) staff       (20)    19595 2022-11-09 22:20:24.000000 dask-2023.5.1/dask/graph_manipulation.py
+-rw-r--r--   0 james      (501) staff       (20)     2492 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/hashing.py
+-rw-r--r--   0 james      (501) staff       (20)    34771 2023-05-03 18:02:08.000000 dask-2023.5.1/dask/highlevelgraph.py
+-rw-r--r--   0 james      (501) staff       (20)    46007 2023-05-03 18:02:08.000000 dask-2023.5.1/dask/layers.py
+-rw-r--r--   0 james      (501) staff       (20)    18888 2022-11-09 22:20:24.000000 dask-2023.5.1/dask/local.py
+-rw-r--r--   0 james      (501) staff       (20)      487 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/ml.py
+-rw-r--r--   0 james      (501) staff       (20)     8466 2022-11-09 22:20:24.000000 dask-2023.5.1/dask/multiprocessing.py
+-rw-r--r--   0 james      (501) staff       (20)    35638 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    45768 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/order.py
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-11-09 22:20:24.000000 dask-2023.5.1/dask/py.typed
+-rw-r--r--   0 james      (501) staff       (20)    12597 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/rewrite.py
+-rw-r--r--   0 james      (501) staff       (20)     7298 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/sizeof.py
+-rw-r--r--   0 james      (501) staff       (20)     1510 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/system.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.045470 dask-2023.5.1/dask/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-03-07 20:04:31.000000 dask-2023.5.1/dask/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)      742 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_backends.py
+-rw-r--r--   0 james      (501) staff       (20)    51124 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_base.py
+-rw-r--r--   0 james      (501) staff       (20)     1613 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_cache.py
+-rw-r--r--   0 james      (501) staff       (20)     2570 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_callbacks.py
+-rw-r--r--   0 james      (501) staff       (20)     1199 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_ci.py
+-rw-r--r--   0 james      (501) staff       (20)     3266 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_cli.py
+-rw-r--r--   0 james      (501) staff       (20)      379 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_compatibility.py
+-rw-r--r--   0 james      (501) staff       (20)    17846 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_config.py
+-rw-r--r--   0 james      (501) staff       (20)     1137 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_context.py
+-rw-r--r--   0 james      (501) staff       (20)     7422 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_core.py
+-rw-r--r--   0 james      (501) staff       (20)     1112 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_datasets.py
+-rw-r--r--   0 james      (501) staff       (20)    22989 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_delayed.py
+-rw-r--r--   0 james      (501) staff       (20)    31293 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_distributed.py
+-rw-r--r--   0 james      (501) staff       (20)      925 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_docs.py
+-rw-r--r--   0 james      (501) staff       (20)    12271 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_dot.py
+-rw-r--r--   0 james      (501) staff       (20)    15070 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_graph_manipulation.py
+-rw-r--r--   0 james      (501) staff       (20)     1095 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_hashing.py
+-rw-r--r--   0 james      (501) staff       (20)     8363 2023-05-26 16:18:40.000000 dask-2023.5.1/dask/tests/test_highgraph.py
+-rw-r--r--   0 james      (501) staff       (20)     9341 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_layers.py
+-rw-r--r--   0 james      (501) staff       (20)     5008 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_local.py
+-rw-r--r--   0 james      (501) staff       (20)      419 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_ml.py
+-rw-r--r--   0 james      (501) staff       (20)     8457 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_multiprocessing.py
+-rw-r--r--   0 james      (501) staff       (20)    45227 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    28229 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_order.py
+-rw-r--r--   0 james      (501) staff       (20)     4684 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_rewrite.py
+-rw-r--r--   0 james      (501) staff       (20)     7518 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_sizeof.py
+-rw-r--r--   0 james      (501) staff       (20)     7154 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_spark_compat.py
+-rw-r--r--   0 james      (501) staff       (20)     1397 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_system.py
+-rw-r--r--   0 james      (501) staff       (20)     4749 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_threaded.py
+-rw-r--r--   0 james      (501) staff       (20)     5670 2023-04-25 18:34:46.000000 dask-2023.5.1/dask/tests/test_typing.py
+-rw-r--r--   0 james      (501) staff       (20)    22705 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_utils.py
+-rw-r--r--   0 james      (501) staff       (20)     1598 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/test_utils_test.py
+-rw-r--r--   0 james      (501) staff       (20)      211 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/tests/warning_aliases.py
+-rw-r--r--   0 james      (501) staff       (20)     2993 2022-11-09 22:20:24.000000 dask-2023.5.1/dask/threaded.py
+-rw-r--r--   0 james      (501) staff       (20)    14538 2022-11-09 22:20:24.000000 dask-2023.5.1/dask/typing.py
+-rw-r--r--   0 james      (501) staff       (20)    56051 2023-05-24 15:39:04.000000 dask-2023.5.1/dask/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     4825 2023-04-11 17:13:14.000000 dask-2023.5.1/dask/utils_test.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.046630 dask-2023.5.1/dask/widgets/
+-rw-r--r--   0 james      (501) staff       (20)      792 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/widgets/__init__.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.051499 dask-2023.5.1/dask/widgets/templates/
+-rw-r--r--   0 james      (501) staff       (20)     1295 2023-03-13 17:40:25.000000 dask-2023.5.1/dask/widgets/templates/array.html.j2
+-rw-r--r--   0 james      (501) staff       (20)      124 2022-11-09 22:20:24.000000 dask-2023.5.1/dask/widgets/templates/dataframe.html.j2
+-rw-r--r--   0 james      (501) staff       (20)     2579 2022-11-09 22:20:24.000000 dask-2023.5.1/dask/widgets/templates/highlevelgraph.html.j2
+-rw-r--r--   0 james      (501) staff       (20)     1981 2022-11-09 22:20:24.000000 dask-2023.5.1/dask/widgets/templates/highlevelgraph_layer.html.j2
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.052781 dask-2023.5.1/dask/widgets/tests/
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.056871 dask-2023.5.1/dask/widgets/tests/templates/
+-rw-r--r--   0 james      (501) staff       (20)       38 2022-10-24 20:44:15.000000 dask-2023.5.1/dask/widgets/tests/templates/bytes.html.j2
+-rw-r--r--   0 james      (501) staff       (20)       39 2022-10-24 20:44:15.000000 dask-2023.5.1/dask/widgets/tests/templates/custom_filter.html.j2
+-rw-r--r--   0 james      (501) staff       (20)       30 2022-10-24 20:44:15.000000 dask-2023.5.1/dask/widgets/tests/templates/example.html.j2
+-rw-r--r--   0 james      (501) staff       (20)     1401 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/widgets/tests/test_widgets.py
+-rw-r--r--   0 james      (501) staff       (20)     1120 2023-05-24 20:58:41.000000 dask-2023.5.1/dask/widgets/widgets.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:34.772426 dask-2023.5.1/dask.egg-info/
+-rw-r--r--   0 james      (501) staff       (20)     2532 2023-05-26 20:09:34.000000 dask-2023.5.1/dask.egg-info/PKG-INFO
+-rw-r--r--   0 james      (501) staff       (20)    13939 2023-05-26 20:09:34.000000 dask-2023.5.1/dask.egg-info/SOURCES.txt
+-rw-r--r--   0 james      (501) staff       (20)        1 2023-05-26 20:09:34.000000 dask-2023.5.1/dask.egg-info/dependency_links.txt
+-rw-r--r--   0 james      (501) staff       (20)      124 2023-05-26 20:09:34.000000 dask-2023.5.1/dask.egg-info/entry_points.txt
+-rw-r--r--   0 james      (501) staff       (20)        1 2023-05-26 20:09:33.000000 dask-2023.5.1/dask.egg-info/not-zip-safe
+-rw-r--r--   0 james      (501) staff       (20)      454 2023-05-26 20:09:34.000000 dask-2023.5.1/dask.egg-info/requires.txt
+-rw-r--r--   0 james      (501) staff       (20)        5 2023-05-26 20:09:34.000000 dask-2023.5.1/dask.egg-info/top_level.txt
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.061375 dask-2023.5.1/docs/
+-rw-r--r--   0 james      (501) staff       (20)     5741 2023-03-22 19:03:53.000000 dask-2023.5.1/docs/Makefile
+-rw-r--r--   0 james      (501) staff       (20)     5186 2022-08-08 20:45:08.000000 dask-2023.5.1/docs/make.bat
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.301131 dask-2023.5.1/docs/source/
+-rw-r--r--   0 james      (501) staff       (20)    17598 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/10-minutes-to-dask.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.315722 dask-2023.5.1/docs/source/_static/
+-rw-r--r--   0 james      (501) staff       (20)    10187 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/_static/config_converter.js
+-rw-r--r--   0 james      (501) staff       (20)    11021 2021-06-08 02:50:31.000000 dask-2023.5.1/docs/source/_static/dask-simple.png
+-rw-r--r--   0 james      (501) staff       (20)     2375 2021-06-08 02:51:08.000000 dask-2023.5.1/docs/source/_static/main-page.css
+-rw-r--r--   0 james      (501) staff       (20)    15598 2022-08-08 20:45:08.000000 dask-2023.5.1/docs/source/_static/profile.html
+-rw-r--r--   0 james      (501) staff       (20)    65304 2022-08-08 20:45:08.000000 dask-2023.5.1/docs/source/_static/stacked_profile.html
+-rw-r--r--   0 james      (501) staff       (20)      523 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/_static/style.css
+-rw-r--r--   0 james      (501) staff       (20)      365 2021-06-16 20:41:28.000000 dask-2023.5.1/docs/source/_static/theme_overrides.css
+-rw-r--r--   0 james      (501) staff       (20)   292662 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/_static/transpose_cyto.html
+-rw-r--r--   0 james      (501) staff       (20)    49423 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/_static/yaml.min.js
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.317827 dask-2023.5.1/docs/source/_templates/
+-rw-r--r--   0 james      (501) staff       (20)      180 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/_templates/layout.html
+-rw-r--r--   0 james      (501) staff       (20)     2235 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/api.rst
+-rw-r--r--   0 james      (501) staff       (20)     6968 2023-05-24 15:39:04.000000 dask-2023.5.1/docs/source/array-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     2943 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/array-assignment.rst
+-rw-r--r--   0 james      (501) staff       (20)     4740 2023-03-13 17:40:25.000000 dask-2023.5.1/docs/source/array-best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)    13035 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/array-chunks.rst
+-rw-r--r--   0 james      (501) staff       (20)    18437 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/array-creation.rst
+-rw-r--r--   0 james      (501) staff       (20)     5885 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/array-design.rst
+-rw-r--r--   0 james      (501) staff       (20)     2857 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/array-gufunc.rst
+-rw-r--r--   0 james      (501) staff       (20)     6069 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/array-overlap.rst
+-rw-r--r--   0 james      (501) staff       (20)     3924 2023-05-19 15:53:47.000000 dask-2023.5.1/docs/source/array-random.rst
+-rw-r--r--   0 james      (501) staff       (20)     4137 2021-11-11 17:33:01.000000 dask-2023.5.1/docs/source/array-slicing.rst
+-rw-r--r--   0 james      (501) staff       (20)     3291 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/array-sparse.rst
+-rw-r--r--   0 james      (501) staff       (20)     2018 2022-10-07 21:37:36.000000 dask-2023.5.1/docs/source/array-stack.rst
+-rw-r--r--   0 james      (501) staff       (20)     1140 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/array-stats.rst
+-rw-r--r--   0 james      (501) staff       (20)     4121 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/array.rst
+-rw-r--r--   0 james      (501) staff       (20)     1574 2022-08-08 20:45:08.000000 dask-2023.5.1/docs/source/bag-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     4557 2021-06-08 02:51:08.000000 dask-2023.5.1/docs/source/bag-creation.rst
+-rw-r--r--   0 james      (501) staff       (20)     4068 2023-03-13 17:40:25.000000 dask-2023.5.1/docs/source/bag.rst
+-rw-r--r--   0 james      (501) staff       (20)    14050 2023-05-22 17:52:26.000000 dask-2023.5.1/docs/source/best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)     5553 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/caching.rst
+-rw-r--r--   0 james      (501) staff       (20)   305185 2023-05-26 20:04:56.000000 dask-2023.5.1/docs/source/changelog.rst
+-rw-r--r--   0 james      (501) staff       (20)      211 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/cheatsheet.rst
+-rw-r--r--   0 james      (501) staff       (20)     4047 2023-03-13 17:40:25.000000 dask-2023.5.1/docs/source/cli.rst
+-rw-r--r--   0 james      (501) staff       (20)    15465 2023-03-13 20:41:19.000000 dask-2023.5.1/docs/source/conf.py
+-rw-r--r--   0 james      (501) staff       (20)    16654 2023-04-06 21:35:01.000000 dask-2023.5.1/docs/source/configuration.rst
+-rw-r--r--   0 james      (501) staff       (20)    18651 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/custom-collections.rst
+-rw-r--r--   0 james      (501) staff       (20)     3604 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/custom-graphs.rst
+-rw-r--r--   0 james      (501) staff       (20)      932 2023-05-24 20:58:41.000000 dask-2023.5.1/docs/source/dashboard-progress-script.py
+-rw-r--r--   0 james      (501) staff       (20)    15045 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/dashboard.rst
+-rw-r--r--   0 james      (501) staff       (20)   203552 2021-06-08 02:51:08.000000 dask-2023.5.1/docs/source/daskcheatsheet.pdf
+-rw-r--r--   0 james      (501) staff       (20)    13693 2023-05-19 15:53:47.000000 dask-2023.5.1/docs/source/dataframe-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     9611 2023-03-13 17:40:25.000000 dask-2023.5.1/docs/source/dataframe-best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)     3951 2021-11-11 20:27:17.000000 dask-2023.5.1/docs/source/dataframe-categoricals.rst
+-rw-r--r--   0 james      (501) staff       (20)     5967 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/dataframe-create.rst
+-rw-r--r--   0 james      (501) staff       (20)     5002 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/dataframe-design.rst
+-rw-r--r--   0 james      (501) staff       (20)     6224 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/dataframe-extend.rst
+-rw-r--r--   0 james      (501) staff       (20)     8050 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/dataframe-groupby.rst
+-rw-r--r--   0 james      (501) staff       (20)     6115 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/dataframe-indexing.rst
+-rw-r--r--   0 james      (501) staff       (20)     3454 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/dataframe-joins.rst
+-rw-r--r--   0 james      (501) staff       (20)    10952 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/dataframe-parquet.rst
+-rw-r--r--   0 james      (501) staff       (20)    12661 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/dataframe-sql.rst
+-rw-r--r--   0 james      (501) staff       (20)     7772 2023-03-13 17:40:25.000000 dask-2023.5.1/docs/source/dataframe.rst
+-rw-r--r--   0 james      (501) staff       (20)      363 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/debugging-performance.rst
+-rw-r--r--   0 james      (501) staff       (20)     1696 2022-08-08 20:45:08.000000 dask-2023.5.1/docs/source/delayed-api.rst
+-rw-r--r--   0 james      (501) staff       (20)    17616 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/delayed-best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)     1497 2022-10-07 21:37:36.000000 dask-2023.5.1/docs/source/delayed-collections.rst
+-rw-r--r--   0 james      (501) staff       (20)     6357 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/delayed.rst
+-rw-r--r--   0 james      (501) staff       (20)     3620 2023-03-13 17:40:25.000000 dask-2023.5.1/docs/source/deploying-cli.rst
+-rw-r--r--   0 james      (501) staff       (20)     3012 2023-05-22 17:52:26.000000 dask-2023.5.1/docs/source/deploying-cloud.rst
+-rw-r--r--   0 james      (501) staff       (20)     2868 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/deploying-docker.rst
+-rw-r--r--   0 james      (501) staff       (20)     9939 2023-03-13 17:40:25.000000 dask-2023.5.1/docs/source/deploying-hpc.rst
+-rw-r--r--   0 james      (501) staff       (20)     4001 2023-05-19 15:53:47.000000 dask-2023.5.1/docs/source/deploying-kubernetes.rst
+-rw-r--r--   0 james      (501) staff       (20)     5823 2023-03-13 17:40:25.000000 dask-2023.5.1/docs/source/deploying-python-advanced.rst
+-rw-r--r--   0 james      (501) staff       (20)     2839 2023-04-25 18:34:46.000000 dask-2023.5.1/docs/source/deploying-python.rst
+-rw-r--r--   0 james      (501) staff       (20)     1619 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/deploying-ssh.rst
+-rw-r--r--   0 james      (501) staff       (20)     7348 2023-05-22 17:52:26.000000 dask-2023.5.1/docs/source/deploying.rst
+-rw-r--r--   0 james      (501) staff       (20)    10873 2023-05-22 17:52:26.000000 dask-2023.5.1/docs/source/deployment-considerations.rst
+-rw-r--r--   0 james      (501) staff       (20)    13144 2023-05-24 20:58:41.000000 dask-2023.5.1/docs/source/develop.rst
+-rw-r--r--   0 james      (501) staff       (20)     4442 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/diagnostics-distributed.rst
+-rw-r--r--   0 james      (501) staff       (20)    10407 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/diagnostics-local.rst
+-rw-r--r--   0 james      (501) staff       (20)     4364 2023-05-22 17:52:26.000000 dask-2023.5.1/docs/source/ecosystem.rst
+-rw-r--r--   0 james      (501) staff       (20)    19999 2023-05-22 17:52:26.000000 dask-2023.5.1/docs/source/faq.rst
+-rw-r--r--   0 james      (501) staff       (20)    25569 2023-05-19 15:53:47.000000 dask-2023.5.1/docs/source/futures.rst
+-rw-r--r--   0 james      (501) staff       (20)     5820 2022-10-07 21:37:14.000000 dask-2023.5.1/docs/source/gpu.rst
+-rw-r--r--   0 james      (501) staff       (20)     2541 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/graph_manipulation.rst
+-rw-r--r--   0 james      (501) staff       (20)     5433 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/graphs.rst
+-rw-r--r--   0 james      (501) staff       (20)     5399 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/graphviz.rst
+-rw-r--r--   0 james      (501) staff       (20)     6946 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/high-level-graphs.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.332580 dask-2023.5.1/docs/source/how-to/
+-rw-r--r--   0 james      (501) staff       (20)     4364 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/how-to/adaptive.rst
+-rw-r--r--   0 james      (501) staff       (20)    15360 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/how-to/connect-to-remote-data.rst
+-rw-r--r--   0 james      (501) staff       (20)     4209 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/how-to/customize-initialization.rst
+-rw-r--r--   0 james      (501) staff       (20)    10859 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/how-to/debug.rst
+-rw-r--r--   0 james      (501) staff       (20)     1722 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/how-to/extend-sizeof.rst
+-rw-r--r--   0 james      (501) staff       (20)      433 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/how-to/index.rst
+-rw-r--r--   0 james      (501) staff       (20)     4562 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/how-to/manage-environments.rst
+-rw-r--r--   0 james      (501) staff       (20)     6680 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/how-to/selecting-the-collection-backend.rst
+-rw-r--r--   0 james      (501) staff       (20)      902 2023-04-25 18:34:46.000000 dask-2023.5.1/docs/source/how-to/setup-prometheus.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.475904 dask-2023.5.1/docs/source/images/
+-rw-r--r--   0 james      (501) staff       (20)    99565 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/10_minutes_array_graph.png
+-rw-r--r--   0 james      (501) staff       (20)    22442 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/10_minutes_bag_graph.png
+-rw-r--r--   0 james      (501) staff       (20)    56229 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/10_minutes_dataframe_graph.png
+-rw-r--r--   0 james      (501) staff       (20)     4059 2021-06-08 02:51:08.000000 dask-2023.5.1/docs/source/images/HHMI_Janelia_Color.png
+-rw-r--r--   0 james      (501) staff       (20)    18406 2021-06-08 02:50:31.000000 dask-2023.5.1/docs/source/images/array.svg
+-rw-r--r--   0 james      (501) staff       (20)  1620104 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/async-embarrassing.gif
+-rw-r--r--   0 james      (501) staff       (20)    10752 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/concurrent-futures-threaded.webp
+-rw-r--r--   0 james      (501) staff       (20)   135129 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/crosstalk.svg
+-rw-r--r--   0 james      (501) staff       (20)  2367087 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dashboard_jupyterlab.png
+-rw-r--r--   0 james      (501) staff       (20)    37971 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dashboard_link.png
+-rw-r--r--   0 james      (501) staff       (20)    68712 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dashboard_memory.png
+-rw-r--r--   0 james      (501) staff       (20)   281018 2023-04-25 18:34:46.000000 dask-2023.5.1/docs/source/images/dashboard_memory_new.gif
+-rw-r--r--   0 james      (501) staff       (20)    25435 2023-03-13 17:40:25.000000 dask-2023.5.1/docs/source/images/dashboard_progress.png
+-rw-r--r--   0 james      (501) staff       (20)   276928 2023-03-13 17:40:25.000000 dask-2023.5.1/docs/source/images/dashboard_status.png
+-rw-r--r--   0 james      (501) staff       (20)    12009 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/images/dashboard_task_processing.png
+-rw-r--r--   0 james      (501) staff       (20)    58238 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dashboard_task_stream_unhealthy.png
+-rw-r--r--   0 james      (501) staff       (20)   103654 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dashboard_taskstream_healthy.png
+-rw-r--r--   0 james      (501) staff       (20)   112822 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/dask-adaptive.svg
+-rw-r--r--   0 james      (501) staff       (20)    14645 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/dask-array.svg
+-rw-r--r--   0 james      (501) staff       (20)   222084 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/dask-cluster-manager.svg
+-rw-r--r--   0 james      (501) staff       (20)    18782 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/dask-dataframe.svg
+-rw-r--r--   0 james      (501) staff       (20)   381903 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dask-overview-distributed-callout.svg
+-rw-r--r--   0 james      (501) staff       (20)   357643 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dask-overview-schedulers.svg
+-rw-r--r--   0 james      (501) staff       (20)    97471 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/dask-overview.svg
+-rw-r--r--   0 james      (501) staff       (20)     3022 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dask_horizontal.svg
+-rw-r--r--   0 james      (501) staff       (20)     3651 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dask_horizontal_black.svg
+-rw-r--r--   0 james      (501) staff       (20)     3767 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dask_horizontal_on_blue.svg
+-rw-r--r--   0 james      (501) staff       (20)     3738 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dask_horizontal_on_pink.svg
+-rw-r--r--   0 james      (501) staff       (20)     3738 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dask_horizontal_white.svg
+-rw-r--r--   0 james      (501) staff       (20)     1607 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dask_icon.svg
+-rw-r--r--   0 james      (501) staff       (20)     1571 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dask_icon_black.svg
+-rw-r--r--   0 james      (501) staff       (20)     1607 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dask_icon_on_pink.svg
+-rw-r--r--   0 james      (501) staff       (20)     1609 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/dask_icon_white.svg
+-rw-r--r--   0 james      (501) staff       (20)    20216 2021-06-08 02:51:08.000000 dask-2023.5.1/docs/source/images/delayed-inc-double-add.svg
+-rw-r--r--   0 james      (501) staff       (20)   104628 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/distributed-overview.svg
+-rw-r--r--   0 james      (501) staff       (20)    18297 2021-06-08 02:50:31.000000 dask-2023.5.1/docs/source/images/frame-shuffle.svg
+-rw-r--r--   0 james      (501) staff       (20)    22979 2021-06-08 02:50:31.000000 dask-2023.5.1/docs/source/images/frame-sort.svg
+-rw-r--r--   0 james      (501) staff       (20)    12181 2021-06-08 02:50:31.000000 dask-2023.5.1/docs/source/images/frame.svg
+-rw-r--r--   0 james      (501) staff       (20)    41828 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/gputester-msg.png
+-rw-r--r--   0 james      (501) staff       (20)   210392 2021-11-11 17:33:01.000000 dask-2023.5.1/docs/source/images/growth_of_languages.png
+-rw-r--r--   0 james      (501) staff       (20)   167834 2021-11-11 17:33:01.000000 dask-2023.5.1/docs/source/images/growth_of_libraries.png
+-rw-r--r--   0 james      (501) staff       (20)     4097 2021-06-08 02:51:08.000000 dask-2023.5.1/docs/source/images/inc-add.svg
+-rw-r--r--   0 james      (501) staff       (20)   123010 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/map-reduce-task-scheduling.svg
+-rw-r--r--   0 james      (501) staff       (20)   482302 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/map_blocks_drop_axis.png
+-rw-r--r--   0 james      (501) staff       (20)   113067 2021-11-11 20:27:17.000000 dask-2023.5.1/docs/source/images/merge_chunks.png
+-rw-r--r--   0 james      (501) staff       (20)    63244 2021-11-11 20:27:17.000000 dask-2023.5.1/docs/source/images/merge_chunks_false.png
+-rw-r--r--   0 james      (501) staff       (20)    13024 2021-11-11 17:33:01.000000 dask-2023.5.1/docs/source/images/optimize_dask1.svg
+-rw-r--r--   0 james      (501) staff       (20)     8803 2021-11-11 17:33:01.000000 dask-2023.5.1/docs/source/images/optimize_dask2.svg
+-rw-r--r--   0 james      (501) staff       (20)     5198 2021-11-11 17:33:01.000000 dask-2023.5.1/docs/source/images/optimize_dask3.svg
+-rw-r--r--   0 james      (501) staff       (20)     4104 2021-11-11 17:33:01.000000 dask-2023.5.1/docs/source/images/optimize_dask4.svg
+-rw-r--r--   0 james      (501) staff       (20)     2738 2021-11-11 17:33:01.000000 dask-2023.5.1/docs/source/images/optimize_dask5.svg
+-rw-r--r--   0 james      (501) staff       (20)   292827 2021-11-11 20:27:17.000000 dask-2023.5.1/docs/source/images/order-failure.png
+-rw-r--r--   0 james      (501) staff       (20)   239828 2021-11-11 20:27:17.000000 dask-2023.5.1/docs/source/images/order-success.png
+-rw-r--r--   0 james      (501) staff       (20)    40833 2021-06-08 02:51:08.000000 dask-2023.5.1/docs/source/images/overlap.svg
+-rw-r--r--   0 james      (501) staff       (20)    18785 2021-06-08 02:51:08.000000 dask-2023.5.1/docs/source/images/overlapping-blocks.svg
+-rw-r--r--   0 james      (501) staff       (20)     4537 2021-06-08 02:51:08.000000 dask-2023.5.1/docs/source/images/overlapping-neighbors.svg
+-rw-r--r--   0 james      (501) staff       (20)    20533 2021-06-08 02:51:08.000000 dask-2023.5.1/docs/source/images/pipeline.svg
+-rw-r--r--   0 james      (501) staff       (20)    31576 2021-11-11 20:27:17.000000 dask-2023.5.1/docs/source/images/reshape.png
+-rw-r--r--   0 james      (501) staff       (20)    31410 2021-11-11 20:27:17.000000 dask-2023.5.1/docs/source/images/reshape_problem.png
+-rw-r--r--   0 james      (501) staff       (20)    33288 2021-11-11 20:27:17.000000 dask-2023.5.1/docs/source/images/reshape_rechunked.png
+-rw-r--r--   0 james      (501) staff       (20)    50209 2021-06-08 02:50:31.000000 dask-2023.5.1/docs/source/images/scaling-edges.png
+-rw-r--r--   0 james      (501) staff       (20)    68476 2021-06-08 02:50:31.000000 dask-2023.5.1/docs/source/images/scaling-nodes.png
+-rw-r--r--   0 james      (501) staff       (20)    21294 2021-06-08 02:50:31.000000 dask-2023.5.1/docs/source/images/simple-dask.png
+-rw-r--r--   0 james      (501) staff       (20)    27572 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/transpose-hlg-hovertooltip.png
+-rw-r--r--   0 james      (501) staff       (20)    84492 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/images/transpose-hlg-html-repr.png
+-rw-r--r--   0 james      (501) staff       (20)    39365 2021-06-08 02:51:08.000000 dask-2023.5.1/docs/source/images/transpose.svg
+-rw-r--r--   0 james      (501) staff       (20)    22446 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/transpose_opt.svg
+-rw-r--r--   0 james      (501) staff       (20)   115022 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/images/trivial.svg
+-rw-r--r--   0 james      (501) staff       (20)     2451 2021-06-08 02:51:08.000000 dask-2023.5.1/docs/source/images/unoverlapping-neighbors.svg
+-rw-r--r--   0 james      (501) staff       (20)     6237 2023-03-13 17:40:25.000000 dask-2023.5.1/docs/source/index.rst
+-rw-r--r--   0 james      (501) staff       (20)    15235 2023-05-24 20:58:41.000000 dask-2023.5.1/docs/source/install.rst
+-rw-r--r--   0 james      (501) staff       (20)      341 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/internals.rst
+-rw-r--r--   0 james      (501) staff       (20)      868 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/logos.rst
+-rw-r--r--   0 james      (501) staff       (20)     3573 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/maintainers.rst
+-rw-r--r--   0 james      (501) staff       (20)    12200 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/optimize.rst
+-rw-r--r--   0 james      (501) staff       (20)     7119 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/order.rst
+-rw-r--r--   0 james      (501) staff       (20)     4810 2022-10-07 21:37:14.000000 dask-2023.5.1/docs/source/phases-of-computation.rst
+-rw-r--r--   0 james      (501) staff       (20)     5089 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/presentations.rst
+-rw-r--r--   0 james      (501) staff       (20)     6010 2022-10-07 21:37:14.000000 dask-2023.5.1/docs/source/scheduler-overview.rst
+-rw-r--r--   0 james      (501) staff       (20)     4493 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/scheduling-policy.rst
+-rw-r--r--   0 james      (501) staff       (20)    11015 2023-05-24 20:58:41.000000 dask-2023.5.1/docs/source/scheduling.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-05-26 20:09:35.477147 dask-2023.5.1/docs/source/scripts/
+-rw-r--r--   0 james      (501) staff       (20)     3294 2023-05-24 20:58:41.000000 dask-2023.5.1/docs/source/scripts/scheduling.py
+-rw-r--r--   0 james      (501) staff       (20)     6104 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/shared.rst
+-rw-r--r--   0 james      (501) staff       (20)     9342 2022-11-09 22:20:24.000000 dask-2023.5.1/docs/source/spark.rst
+-rw-r--r--   0 james      (501) staff       (20)     3966 2022-10-07 21:37:14.000000 dask-2023.5.1/docs/source/spec.rst
+-rw-r--r--   0 james      (501) staff       (20)     4754 2023-05-22 17:52:26.000000 dask-2023.5.1/docs/source/support.rst
+-rw-r--r--   0 james      (501) staff       (20)     1831 2021-06-16 20:41:28.000000 dask-2023.5.1/docs/source/understanding-performance.rst
+-rw-r--r--   0 james      (501) staff       (20)    12205 2023-05-03 18:02:08.000000 dask-2023.5.1/docs/source/user-interfaces.rst
+-rw-r--r--   0 james      (501) staff       (20)    11744 2022-10-24 20:44:15.000000 dask-2023.5.1/docs/source/why.rst
+-rw-r--r--   0 james      (501) staff       (20)     5713 2023-05-26 19:49:48.000000 dask-2023.5.1/pyproject.toml
+-rw-r--r--   0 james      (501) staff       (20)       38 2023-05-26 20:09:35.479697 dask-2023.5.1/setup.cfg
+-rwxr-xr-x   0 james      (501) staff       (20)      194 2023-05-03 18:02:08.000000 dask-2023.5.1/setup.py
```

### Comparing `dask-2023.5.0/LICENSE.txt` & `dask-2023.5.1/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/PKG-INFO` & `dask-2023.5.1/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,30 +1,29 @@
 Metadata-Version: 2.1
 Name: dask
-Version: 2023.5.0
+Version: 2023.5.1
 Summary: Parallel PyData with Task Scheduling
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD
 Project-URL: Homepage, https://github.com/dask/dask/
 Keywords: task-scheduling parallel numpy pandas pydata
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
 Classifier: Intended Audience :: Science/Research
 Classifier: License :: OSI Approved :: BSD License
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: Python
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3 :: Only
-Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Topic :: Scientific/Engineering
 Classifier: Topic :: System :: Distributed Computing
-Requires-Python: >=3.8
+Requires-Python: >=3.9
 Description-Content-Type: text/x-rst
 Provides-Extra: array
 Provides-Extra: bag
 Provides-Extra: dataframe
 Provides-Extra: distributed
 Provides-Extra: diagnostics
 Provides-Extra: delayed
```

### Comparing `dask-2023.5.0/README.rst` & `dask-2023.5.1/README.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/conftest.py` & `dask-2023.5.1/conftest.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 import dask
 
 # The doctests in these files fail due to either:
 # - Non-required dependencies not being installed
 # - Imported doctests due to pulling the docstrings from other packages
```

### Comparing `dask-2023.5.0/dask/_compatibility.py` & `dask-2023.5.1/dask/_compatibility.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import sys
 import warnings
 
 from importlib_metadata import entry_points as _entry_points
 from packaging.version import parse as parse_version
 
 PY_VERSION = parse_version(".".join(map(str, sys.version_info[:3])))
```

### Comparing `dask-2023.5.0/dask/array/NUMPY_LICENSE.txt` & `dask-2023.5.1/dask/array/NUMPY_LICENSE.txt`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/array/__init__.py` & `dask-2023.5.1/dask/array/__init__.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 try:
     from dask.array import backends, fft, lib, linalg, ma, overlap, random
     from dask.array.blockwise import atop, blockwise
     from dask.array.chunk_types import register_chunk_type
     from dask.array.core import (
         Array,
         PerformanceWarning,
```

### Comparing `dask-2023.5.0/dask/array/backends.py` & `dask-2023.5.1/dask/array/backends.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import math
 
 import numpy as np
 
 from dask.array import chunk
 from dask.array.core import Array
 from dask.array.dispatch import (
```

### Comparing `dask-2023.5.0/dask/array/blockwise.py` & `dask-2023.5.1/dask/array/blockwise.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numbers
 import warnings
 
 import tlz as toolz
 
 from dask import base, utils
 from dask.blockwise import blockwise as core_blockwise
```

### Comparing `dask-2023.5.0/dask/array/chunk.py` & `dask-2023.5.1/dask/array/chunk.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,10 @@
 """ A set of NumPy functions to apply per chunk """
+from __future__ import annotations
+
 import contextlib
 from collections.abc import Container, Iterable, Sequence
 from functools import wraps
 from numbers import Integral
 
 import numpy as np
 from tlz import concat
```

### Comparing `dask-2023.5.0/dask/array/chunk_types.py` & `dask-2023.5.1/dask/array/chunk_types.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 
 # Start list of valid chunk types, to be added to with guarded imports
 _HANDLED_CHUNK_TYPES = [np.ndarray, np.ma.MaskedArray]
 
 
 def register_chunk_type(type):
```

### Comparing `dask-2023.5.0/dask/array/core.py` & `dask-2023.5.1/dask/array/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/array/creation.py` & `dask-2023.5.1/dask/array/creation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/array/cupy_entry_point.py` & `dask-2023.5.1/dask/array/cupy_entry_point.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import dask.array as da
 from dask import config
 from dask.array.backends import ArrayBackendEntrypoint, register_cupy
 from dask.array.core import Array
 from dask.array.dispatch import to_cupy_dispatch
```

### Comparing `dask-2023.5.0/dask/array/einsumfuncs.py` & `dask-2023.5.1/dask/array/einsumfuncs.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 from numpy.compat import basestring
 
 from dask.array.core import asarray, blockwise, einsum_lookup
 from dask.utils import derived_from
 
 einsum_symbols = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"
```

### Comparing `dask-2023.5.0/dask/array/fft.py` & `dask-2023.5.1/dask/array/fft.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import inspect
 from collections.abc import Sequence
 
 import numpy as np
 
 try:
     import scipy
```

### Comparing `dask-2023.5.0/dask/array/gufunc.py` & `dask-2023.5.1/dask/array/gufunc.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import re
 
 import numpy as np
 from tlz import concat, merge, unique
 
 from dask.array.core import Array, apply_infer_dtype, asarray, blockwise, getitem
 from dask.array.utils import meta_from_array
```

### Comparing `dask-2023.5.0/dask/array/image.py` & `dask-2023.5.1/dask/array/image.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os
 from glob import glob
 
 try:
     from skimage.io import imread as sk_imread
 except (AttributeError, ImportError):
     pass
```

### Comparing `dask-2023.5.0/dask/array/linalg.py` & `dask-2023.5.1/dask/array/linalg.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import operator
 import warnings
 from functools import partial
 from numbers import Number
 
 import numpy as np
 import tlz as toolz
```

### Comparing `dask-2023.5.0/dask/array/ma.py` & `dask-2023.5.1/dask/array/ma.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from functools import wraps
 
 import numpy as np
 
 from dask.array import chunk
 from dask.array.core import asanyarray, blockwise, elemwise, map_blocks
 from dask.array.reductions import reduction
```

### Comparing `dask-2023.5.0/dask/array/numpy_compat.py` & `dask-2023.5.1/dask/array/numpy_compat.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import warnings
 
 import numpy as np
 from packaging.version import parse as parse_version
 
 from dask.utils import derived_from
```

### Comparing `dask-2023.5.0/dask/array/optimization.py` & `dask-2023.5.1/dask/array/optimization.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,12 +1,13 @@
 from __future__ import annotations
 
+from collections.abc import Callable
 from itertools import zip_longest
 from numbers import Integral
-from typing import Any, Callable
+from typing import Any
 
 import numpy as np
 
 from dask import config
 from dask.array.chunk import getitem
 from dask.array.core import getter, getter_inline, getter_nofancy
 from dask.blockwise import fuse_roots, optimize_blockwise
```

### Comparing `dask-2023.5.0/dask/array/overlap.py` & `dask-2023.5.1/dask/array/overlap.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import warnings
 from numbers import Integral, Number
 
 import numpy as np
 from tlz import concat, get, partial
 from tlz.curried import map
```

### Comparing `dask-2023.5.0/dask/array/percentile.py` & `dask-2023.5.1/dask/array/percentile.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import warnings
 from collections.abc import Iterator
 from functools import wraps
 from numbers import Number
 
 import numpy as np
 from tlz import merge
```

### Comparing `dask-2023.5.0/dask/array/random.py` & `dask-2023.5.1/dask/array/random.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,13 +1,16 @@
+from __future__ import annotations
+
 import contextlib
 import importlib
 import numbers
 from itertools import chain, product
 from numbers import Integral
 from operator import getitem
+from threading import Lock
 
 import numpy as np
 
 from dask.array.backends import array_creation_dispatch
 from dask.array.core import (
     Array,
     asarray,
@@ -1029,66 +1032,46 @@
 
     graph = HighLevelGraph.from_collections(name, dsk, dependencies=dependencies)
     return Array(graph, name, chunks + extra_chunks, meta=meta)
 
 
 """
 Lazy RNG-state machinery
-"""
 
-_cached_states = {}
+Many of the RandomState methods are exported as functions in da.random for
+backward compatibility reasons. Their usage is discouraged.
+Use da.random.default_rng() to get a Generator based rng and use its
+methods instead.
+"""
 
+_cached_states: dict[str, RandomState] = {}
+_cached_states_lock = Lock()
 
-def _make_api(attr, state_constructor=None, state_class=None):
-    state_constructor = state_constructor or RandomState
-    state_class = state_class or RandomState
 
+def _make_api(attr):
     def wrapper(*args, **kwargs):
-        backend = array_creation_dispatch.backend
-        key = (backend, state_constructor.__name__)
-        if key not in _cached_states:
-            # Cache the default RandomState object for this backend
-            _cached_states[key] = state_constructor()
-        return getattr(
-            _cached_states[key],
-            attr,
-        )(*args, **kwargs)
+        key = array_creation_dispatch.backend
+        with _cached_states_lock:
+            try:
+                state = _cached_states[key]
+            except KeyError:
+                _cached_states[key] = state = RandomState()
+        return getattr(state, attr)(*args, **kwargs)
 
-    wrapper.__name__ = getattr(state_class, attr).__name__
-    wrapper.__doc__ = getattr(state_class, attr).__doc__
+    wrapper.__name__ = getattr(RandomState, attr).__name__
+    wrapper.__doc__ = getattr(RandomState, attr).__doc__
     return wrapper
 
 
 """
-Generator only
-"""
-
-integers = _make_api("integers", default_rng, Generator)
-multivariate_hypergeometric = _make_api(
-    "multivariate_hypergeometric", default_rng, Generator
-)
-random = _make_api("random", default_rng, Generator)
-
-
-"""
 RandomState only
 """
 
 seed = _make_api("seed")
 
-random_sample = _make_api("random_sample")
-random = _make_api("random_sample")
-randint = _make_api("randint")
-random_integers = _make_api("random_integers")
-
-
-"""
-Common distributions
-"""
-
 beta = _make_api("beta")
 binomial = _make_api("binomial")
 chisquare = _make_api("chisquare")
 choice = _make_api("choice")
 exponential = _make_api("exponential")
 f = _make_api("f")
 gamma = _make_api("gamma")
@@ -1104,25 +1087,23 @@
 noncentral_chisquare = _make_api("noncentral_chisquare")
 noncentral_f = _make_api("noncentral_f")
 normal = _make_api("normal")
 pareto = _make_api("pareto")
 permutation = _make_api("permutation")
 poisson = _make_api("poisson")
 power = _make_api("power")
+random_sample = _make_api("random_sample")
+random = _make_api("random_sample")
+randint = _make_api("randint")
+random_integers = _make_api("random_integers")
 rayleigh = _make_api("rayleigh")
+standard_cauchy = _make_api("standard_cauchy")
+standard_exponential = _make_api("standard_exponential")
+standard_gamma = _make_api("standard_gamma")
+standard_normal = _make_api("standard_normal")
+standard_t = _make_api("standard_t")
 triangular = _make_api("triangular")
 uniform = _make_api("uniform")
 vonmises = _make_api("vonmises")
 wald = _make_api("wald")
 weibull = _make_api("weibull")
 zipf = _make_api("zipf")
-
-
-"""
-Standard distributions
-"""
-
-standard_cauchy = _make_api("standard_cauchy")
-standard_exponential = _make_api("standard_exponential")
-standard_gamma = _make_api("standard_gamma")
-standard_normal = _make_api("standard_normal")
-standard_t = _make_api("standard_t")
```

### Comparing `dask-2023.5.0/dask/array/rechunk.py` & `dask-2023.5.1/dask/array/rechunk.py`

 * *Files 3% similar despite different names*

```diff
@@ -6,15 +6,15 @@
         of an existing dask array to new chunks or blockshape
 """
 from __future__ import annotations
 
 import heapq
 import math
 from functools import reduce
-from itertools import chain, count, product
+from itertools import chain, compress, count, product
 from operator import add, itemgetter, mul
 from warnings import warn
 
 import numpy as np
 import tlz as toolz
 from tlz import accumulate
 
@@ -150,56 +150,79 @@
 
     if ret_next:
         ret.append(ret_next)
 
     return ret
 
 
-def _old_to_new(old_chunks, new_chunks):
+def old_to_new(old_chunks, new_chunks):
     """Helper to build old_chunks to new_chunks.
 
-    Handles missing values, as long as the missing dimension
+    Handles missing values, as long as the dimension with the missing chunk values
     is unchanged.
 
+    This function expects that the arguments have been pre-processed by
+    :func:`dask.array.core.normalize_chunks`. In particular any ``nan`` values should
+    have been replaced (and are so by :func:`dask.array.core.normalize_chunks`)
+    by the canonical ``np.nan``.
+
     Examples
     --------
     >>> old = ((10, 10, 10, 10, 10), )
     >>> new = ((25, 5, 20), )
-    >>> _old_to_new(old, new)  # doctest: +NORMALIZE_WHITESPACE
+    >>> old_to_new(old, new)  # doctest: +NORMALIZE_WHITESPACE
     [[[(0, slice(0, 10, None)), (1, slice(0, 10, None)), (2, slice(0, 5, None))],
       [(2, slice(5, 10, None))],
       [(3, slice(0, 10, None)), (4, slice(0, 10, None))]]]
     """
-    old_known = [x for x in old_chunks if not any(math.isnan(y) for y in x)]
-    new_known = [x for x in new_chunks if not any(math.isnan(y) for y in x)]
-
-    n_missing = [sum(math.isnan(y) for y in x) for x in old_chunks]
-    n_missing2 = [sum(math.isnan(y) for y in x) for x in new_chunks]
 
-    cmo = cumdims_label(old_known, "o")
-    cmn = cumdims_label(new_known, "n")
+    def is_unknown(dim):
+        return any(math.isnan(chunk) for chunk in dim)
 
-    sums = [sum(o) for o in old_known]
-    sums2 = [sum(n) for n in new_known]
+    old_is_unknown = [is_unknown(dim) for dim in old_chunks]
+    new_is_unknown = [is_unknown(dim) for dim in new_chunks]
 
-    if not sums == sums2:
-        raise ValueError(f"Cannot change dimensions from {sums!r} to {sums2!r}")
-    if not n_missing == n_missing2:
+    if old_is_unknown != new_is_unknown or any(
+        new != old for new, old in compress(zip(old_chunks, new_chunks), old_is_unknown)
+    ):
         raise ValueError(
-            "Chunks must be unchanging along unknown dimensions.\n\n"
+            "Chunks must be unchanging along dimensions with missing values.\n\n"
             "A possible solution:\n  x.compute_chunk_sizes()"
         )
 
-    old_to_new = [_intersect_1d(_breakpoints(cm[0], cm[1])) for cm in zip(cmo, cmn)]
-    for idx, missing in enumerate(n_missing):
-        if missing:
-            # Missing dimensions are always unchanged, so old -> new is everything
-            extra = [[(i, slice(0, None))] for i in range(missing)]
-            old_to_new.insert(idx, extra)
-    return old_to_new
+    old_known_indices = [i for i, unknown in enumerate(old_is_unknown) if not unknown]
+    old_known = [dim for dim, unknown in zip(old_chunks, old_is_unknown) if not unknown]
+    new_known = [dim for dim, unknown in zip(new_chunks, new_is_unknown) if not unknown]
+
+    old_sizes = [sum(o) for o in old_known]
+    new_sizes = [sum(n) for n in new_known]
+
+    if old_sizes != new_sizes:
+        raise ValueError(
+            f"Cannot change dimensions from {old_sizes!r} to {new_sizes!r}"
+        )
+
+    cmos = cumdims_label(old_known, "o")
+    cmns = cumdims_label(new_known, "n")
+
+    sliced = [None] * len(old_chunks)
+    for i, cmo, cmn in zip(old_known_indices, cmos, cmns):
+        sliced[i] = _intersect_1d(_breakpoints(cmo, cmn))
+
+    for i, unknown in enumerate(old_is_unknown):
+        if unknown:
+            dim = old_chunks[i]
+            # Unknown dimensions are always unchanged, so old -> new is everything
+            extra = [
+                [(j, slice(0, size if not math.isnan(size) else None))]
+                for j, size in enumerate(dim)
+            ]
+            sliced[i] = extra
+    assert all(x is not None for x in sliced)
+    return sliced
 
 
 def intersect_chunks(old_chunks, new_chunks):
     """
     Make dask.array slices as intersection of old and new chunks.
 
     >>> intersections = intersect_chunks(((4, 4), (2,)),
@@ -214,17 +237,15 @@
     ----------
 
     old_chunks : iterable of tuples
         block sizes along each dimension (convert from old_chunks)
     new_chunks: iterable of tuples
         block sizes along each dimension (converts to new_chunks)
     """
-    old_to_new = _old_to_new(old_chunks, new_chunks)
-
-    cross1 = product(*old_to_new)
+    cross1 = product(*old_to_new(old_chunks, new_chunks))
     cross = chain(tuple(product(*cr)) for cr in cross1)
     return cross
 
 
 def rechunk(
     x,
     chunks="auto",
```

### Comparing `dask-2023.5.0/dask/array/reductions.py` & `dask-2023.5.1/dask/array/reductions.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import builtins
 import contextlib
 import math
 import operator
 import warnings
 from collections.abc import Iterable
 from functools import partial
```

### Comparing `dask-2023.5.0/dask/array/reshape.py` & `dask-2023.5.1/dask/array/reshape.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import math
 import warnings
 from collections import Counter
 from functools import reduce
 from itertools import product
 from operator import mul
```

### Comparing `dask-2023.5.0/dask/array/routines.py` & `dask-2023.5.1/dask/array/routines.py`

 * *Files 0% similar despite different names*

```diff
@@ -2313,16 +2313,19 @@
 
     name = "coarsen-" + tokenize(reduction, x, axes, trim_excess)
     dsk = {
         (name,)
         + key[1:]: (apply, chunk.coarsen, [reduction, key, axes, trim_excess], kwargs)
         for key in flatten(x.__dask_keys__())
     }
+
+    coarsen_dim = lambda dim, ax: int(dim // axes.get(ax, 1))
     chunks = tuple(
-        tuple(int(bd // axes.get(i, 1)) for bd in bds) for i, bds in enumerate(x.chunks)
+        tuple(coarsen_dim(bd, i) for bd in bds if coarsen_dim(bd, i) > 0)
+        for i, bds in enumerate(x.chunks)
     )
 
     meta = reduction(np.empty((1,) * x.ndim, dtype=x.dtype), **kwargs)
     graph = HighLevelGraph.from_collections(name, dsk, dependencies=[x])
     return Array(graph, name, chunks, meta=meta)
```

### Comparing `dask-2023.5.0/dask/array/slicing.py` & `dask-2023.5.1/dask/array/slicing.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import bisect
 import functools
 import math
 import warnings
 from itertools import product
 from numbers import Integral, Number
 from operator import itemgetter
```

### Comparing `dask-2023.5.0/dask/array/stats.py` & `dask-2023.5.1/dask/array/stats.py`

 * *Files 1% similar despite different names*

```diff
@@ -2,18 +2,19 @@
 Statistical functions and tests, following scipy.stats.
 
 Some differences
 
 - We don't handle missing values at all
 
 """
+from __future__ import annotations
+
 # This is lightly adapted from scipy.stats 0.19
 # https://github.com/scipy/scipy/blob/v0.19.0/scipy/stats/stats.py
 # The original copyright notice follows:
-
 # Copyright 2002 Gary Strangman.  All rights reserved
 # Copyright 2002-2016 The SciPy Developers
 #
 # The original code from Gary Strangman was heavily adapted for
 # use in SciPy by Travis Oliphant.  The original code came with the
 # following disclaimer:
 #
```

### Comparing `dask-2023.5.0/dask/array/svg.py` & `dask-2023.5.1/dask/array/svg.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import math
 import re
 
 import numpy as np
 
 
 def svg(chunks, size=200, **kwargs):
```

### Comparing `dask-2023.5.0/dask/array/tests/test_array_core.py` & `dask-2023.5.1/dask/array/tests/test_array_core.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 import copy
 import pathlib
 import re
 import xml.etree.ElementTree
 from unittest import mock
```

### Comparing `dask-2023.5.0/dask/array/tests/test_array_function.py` & `dask-2023.5.1/dask/array/tests/test_array_function.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 
 import dask.array as da
 from dask.array.tests.test_dispatch import EncapsulateNDArray, WrappedArray
 from dask.array.utils import assert_eq
```

### Comparing `dask-2023.5.0/dask/array/tests/test_array_utils.py` & `dask-2023.5.1/dask/array/tests/test_array_utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 
 import dask.array as da
 from dask.array.core import Array
 from dask.array.utils import assert_eq, meta_from_array
 from dask.local import get_sync
```

### Comparing `dask-2023.5.0/dask/array/tests/test_atop.py` & `dask-2023.5.1/dask/array/tests/test_atop.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import collections
 from operator import add
 
 import numpy as np
 import pytest
 
 import dask
```

### Comparing `dask-2023.5.0/dask/array/tests/test_chunk.py` & `dask-2023.5.1/dask/array/tests/test_chunk.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 pytest.importorskip("numpy")
 
 import operator
 
 import numpy as np
@@ -94,14 +96,21 @@
 def test_coarsen():
     x = np.random.randint(10, size=(24, 24))
     y = coarsen(np.sum, x, {0: 2, 1: 4})
     assert y.shape == (12, 6)
     assert y[0, 0] == np.sum(x[:2, :4])
 
 
+def test_coarsen_unaligned_shape():
+    """https://github.com/dask/dask/issues/10274"""
+    x = da.random.random(100)
+    res = da.coarsen(np.mean, x, {0: 3}, trim_excess=True)
+    assert res.chunks == ((33,),)
+
+
 """
 def test_coarsen_on_uneven_shape():
     x = np.random.randint(10, size=(23, 24))
     y = coarsen(np.sum, x, {0: 2, 1: 4})
     assert y.shape == (12, 6)
     assert y[0, 0] == np.sum(x[:2, :4])
     assert eq(y[11, :], x[23, :])
```

### Comparing `dask-2023.5.0/dask/array/tests/test_creation.py` & `dask-2023.5.1/dask/array/tests/test_creation.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 pytest.importorskip("numpy")
 
 import numpy as np
 import pytest
 from tlz import concat
```

### Comparing `dask-2023.5.0/dask/array/tests/test_cupy_core.py` & `dask-2023.5.1/dask/array/tests/test_cupy_core.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 from packaging.version import parse as parse_version
 
 pytestmark = pytest.mark.gpu
 
 import dask
```

### Comparing `dask-2023.5.0/dask/array/tests/test_cupy_creation.py` & `dask-2023.5.1/dask/array/tests/test_cupy_creation.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 
 pytestmark = pytest.mark.gpu
 
 import dask.array as da
 from dask import config
```

### Comparing `dask-2023.5.0/dask/array/tests/test_cupy_gufunc.py` & `dask-2023.5.1/dask/array/tests/test_cupy_gufunc.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 
 pytestmark = pytest.mark.gpu
 
 import dask.array as da
 from dask.array.gufunc import apply_gufunc
```

### Comparing `dask-2023.5.0/dask/array/tests/test_cupy_linalg.py` & `dask-2023.5.1/dask/array/tests/test_cupy_linalg.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 from packaging.version import parse as parse_version
 
 pytestmark = pytest.mark.gpu
 
 import dask.array as da
```

### Comparing `dask-2023.5.0/dask/array/tests/test_cupy_overlap.py` & `dask-2023.5.1/dask/array/tests/test_cupy_overlap.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 from packaging.version import parse as parse_version
 
 pytestmark = pytest.mark.gpu
 
 import dask.array as da
```

### Comparing `dask-2023.5.0/dask/array/tests/test_cupy_percentile.py` & `dask-2023.5.1/dask/array/tests/test_cupy_percentile.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 
 pytestmark = pytest.mark.gpu
 
 import dask.array as da
 from dask.array.utils import assert_eq, same_keys
```

### Comparing `dask-2023.5.0/dask/array/tests/test_cupy_reductions.py` & `dask-2023.5.1/dask/array/tests/test_cupy_reductions.py`

 * *Files 11% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import warnings
 
 import numpy as np
 import pytest
 
 pytestmark = pytest.mark.gpu
```

### Comparing `dask-2023.5.0/dask/array/tests/test_cupy_routines.py` & `dask-2023.5.1/dask/array/tests/test_cupy_routines.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 from packaging.version import parse as parse_version
 
 pytestmark = pytest.mark.gpu
 
 import dask.array as da
```

### Comparing `dask-2023.5.0/dask/array/tests/test_cupy_slicing.py` & `dask-2023.5.1/dask/array/tests/test_cupy_slicing.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 
 pytestmark = pytest.mark.gpu
 
 import dask.array as da
 from dask.array.utils import assert_eq
```

### Comparing `dask-2023.5.0/dask/array/tests/test_cupy_sparse.py` & `dask-2023.5.1/dask/array/tests/test_cupy_sparse.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 pytestmark = pytest.mark.gpu
 
 import dask.array as da
 from dask.array.utils import assert_eq
```

### Comparing `dask-2023.5.0/dask/array/tests/test_dispatch.py` & `dask-2023.5.1/dask/array/tests/test_dispatch.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import operator
 
 import numpy as np
 import pytest
 
 import dask.array as da
 from dask.array import Array
```

### Comparing `dask-2023.5.0/dask/array/tests/test_fft.py` & `dask-2023.5.1/dask/array/tests/test_fft.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from itertools import combinations_with_replacement
 
 import numpy as np
 import pytest
 
 import dask.array as da
 import dask.array.fft
```

### Comparing `dask-2023.5.0/dask/array/tests/test_gufunc.py` & `dask-2023.5.1/dask/array/tests/test_gufunc.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 from numpy.testing import assert_equal
 
 import dask.array as da
 from dask.array.core import Array
 from dask.array.gufunc import (
```

### Comparing `dask-2023.5.0/dask/array/tests/test_image.py` & `dask-2023.5.1/dask/array/tests/test_image.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os
 from contextlib import contextmanager
 
 import pytest
 
 pytest.importorskip("skimage")
 import numpy as np
```

### Comparing `dask-2023.5.0/dask/array/tests/test_linalg.py` & `dask-2023.5.1/dask/array/tests/test_linalg.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import sys
 
 import pytest
 
 pytest.importorskip("numpy")
 pytest.importorskip("scipy")
```

### Comparing `dask-2023.5.0/dask/array/tests/test_masked.py` & `dask-2023.5.1/dask/array/tests/test_masked.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import random
 import sys
 from copy import deepcopy
 from itertools import product
 
 import numpy as np
 import pytest
```

### Comparing `dask-2023.5.0/dask/array/tests/test_numpy_compat.py` & `dask-2023.5.1/dask/array/tests/test_numpy_compat.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 
 import dask.array as da
 from dask.array.utils import assert_eq
```

### Comparing `dask-2023.5.0/dask/array/tests/test_optimization.py` & `dask-2023.5.1/dask/array/tests/test_optimization.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 pytest.importorskip("numpy")
 
 import numpy as np
 
 import dask
```

### Comparing `dask-2023.5.0/dask/array/tests/test_overlap.py` & `dask-2023.5.1/dask/array/tests/test_overlap.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 pytest.importorskip("numpy")
 
 import numpy as np
 from numpy.testing import assert_array_almost_equal, assert_array_equal
```

### Comparing `dask-2023.5.0/dask/array/tests/test_percentiles.py` & `dask-2023.5.1/dask/array/tests/test_percentiles.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 pytest.importorskip("numpy")
 
 import numpy as np
 
 import dask.array as da
```

### Comparing `dask-2023.5.0/dask/array/tests/test_random.py` & `dask-2023.5.1/dask/array/tests/test_random.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 pytest.importorskip("numpy")
 
 import numpy as np
 
 import dask
@@ -160,21 +162,19 @@
     da.random.chisquare(1, size=sz, chunks=3).compute()
     da.random.exponential(1, size=sz, chunks=3).compute()
     da.random.f(1, 2, size=sz, chunks=3).compute()
     da.random.gamma(5, 1, size=sz, chunks=3).compute()
     da.random.geometric(1, size=sz, chunks=3).compute()
     da.random.gumbel(1, size=sz, chunks=3).compute()
     da.random.hypergeometric(1, 2, 3, size=sz, chunks=3).compute()
-    da.random.integers(5, high=15, size=sz, chunks=3).compute()
     da.random.laplace(size=sz, chunks=3).compute()
     da.random.logistic(size=sz, chunks=3).compute()
     da.random.lognormal(size=sz, chunks=3).compute()
     da.random.logseries(0.5, size=sz, chunks=3).compute()
     da.random.multinomial(20, [1 / 6.0] * 6, size=sz, chunks=3).compute()
-    da.random.multivariate_hypergeometric([16, 8, 4], 6, size=sz, chunks=6).compute()
     da.random.negative_binomial(5, 0.5, size=sz, chunks=3).compute()
     da.random.noncentral_chisquare(2, 2, size=sz, chunks=3).compute()
 
     da.random.noncentral_f(2, 2, 3, size=sz, chunks=3).compute()
     da.random.normal(2, 2, size=sz, chunks=3).compute()
     da.random.pareto(1, size=sz, chunks=3).compute()
     da.random.poisson(size=sz, chunks=3).compute()
```

### Comparing `dask-2023.5.0/dask/array/tests/test_rechunk.py` & `dask-2023.5.1/dask/array/tests/test_rechunk.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,25 +1,28 @@
+from __future__ import annotations
+
 import warnings
 from itertools import product
 
 import pytest
 
 np = pytest.importorskip("numpy")
+import math
 
 import dask
 import dask.array as da
 from dask.array.rechunk import (
     _breakpoints,
     _intersect_1d,
-    _old_to_new,
     cumdims_label,
     divide_to_width,
     intersect_chunks,
     merge_to_number,
     normalize_chunks,
+    old_to_new,
     plan_rechunk,
     rechunk,
 )
 from dask.array.utils import assert_eq
 from dask.utils import funcname
 
 
@@ -278,36 +281,47 @@
 
 def test_rechunk_same():
     x = da.ones((24, 24), chunks=(4, 8))
     y = x.rechunk(x.chunks)
     assert x is y
 
 
-def test_rechunk_same_unknown():
+def test_rechunk_same_fully_unknown():
     dd = pytest.importorskip("dask.dataframe")
     x = da.ones(shape=(10, 10), chunks=(5, 10))
     y = dd.from_array(x).values
     new_chunks = ((np.nan, np.nan), (10,))
     assert y.chunks == new_chunks
     result = y.rechunk(new_chunks)
     assert y is result
 
 
-def test_rechunk_same_unknown_floats():
-    """Similar to test_rechunk_same_unknown but testing the behavior if
+def test_rechunk_same_fully_unknown_floats():
+    """Similar to test_rechunk_same_fully_unknown but testing the behavior if
     ``float("nan")`` is used instead of the recommended ``np.nan``
     """
     dd = pytest.importorskip("dask.dataframe")
     x = da.ones(shape=(10, 10), chunks=(5, 10))
     y = dd.from_array(x).values
     new_chunks = ((float("nan"), float("nan")), (10,))
     result = y.rechunk(new_chunks)
     assert y is result
 
 
+def test_rechunk_same_partially_unknown():
+    dd = pytest.importorskip("dask.dataframe")
+    x = da.ones(shape=(10, 10), chunks=(5, 10))
+    y = dd.from_array(x).values
+    z = da.concatenate([x, y])
+    new_chunks = ((5, 5, np.nan, np.nan), (10,))
+    assert z.chunks == new_chunks
+    result = z.rechunk(new_chunks)
+    assert z is result
+
+
 def test_rechunk_with_zero_placeholders():
     x = da.ones((24, 24), chunks=((12, 12), (24, 0)))
     y = da.ones((24, 24), chunks=((12, 12), (12, 12)))
     y = y.rechunk(((12, 12), (24, 0)))
     assert x.chunks == y.chunks
 
 
@@ -616,102 +630,163 @@
         (da.ones(shape=(10, 10), chunks=(10, 10)), {1: 5}),
         (da.ones(shape=(10, 10), chunks=(10, 10)), (None, (5, 5))),
         (da.ones(shape=(10, 10), chunks=(10, 2)), (None, 5)),
         (da.ones(shape=(10, 10), chunks=(10, 2)), {1: 5}),
         (da.ones(shape=(10, 10), chunks=(10, 2)), (None, (5, 5))),
     ],
 )
-def test_rechunk_unknown(x, chunks):
+def test_rechunk_with_fully_unknown_dimension(x, chunks):
     dd = pytest.importorskip("dask.dataframe")
     y = dd.from_array(x).values
     result = y.rechunk(chunks)
     expected = x.rechunk(chunks)
     assert_chunks_match(result.chunks, expected.chunks)
     assert_eq(result, expected)
 
 
-def test_rechunk_unknown_explicit():
+@pytest.mark.parametrize(
+    "x, chunks",
+    [
+        (da.ones(shape=(50, 10), chunks=(25, 10)), (None, 5)),
+        (da.ones(shape=(50, 10), chunks=(25, 10)), {1: 5}),
+        (da.ones(shape=(50, 10), chunks=(25, 10)), (None, (5, 5))),
+        (da.ones(shape=(1000, 10), chunks=(5, 10)), (None, 5)),
+        (da.ones(shape=(1000, 10), chunks=(5, 10)), {1: 5}),
+        (da.ones(shape=(1000, 10), chunks=(5, 10)), (None, (5, 5))),
+        (da.ones(shape=(10, 10), chunks=(10, 10)), (None, 5)),
+        (da.ones(shape=(10, 10), chunks=(10, 10)), {1: 5}),
+        (da.ones(shape=(10, 10), chunks=(10, 10)), (None, (5, 5))),
+        (da.ones(shape=(10, 10), chunks=(10, 2)), (None, 5)),
+        (da.ones(shape=(10, 10), chunks=(10, 2)), {1: 5}),
+        (da.ones(shape=(10, 10), chunks=(10, 2)), (None, (5, 5))),
+    ],
+)
+def test_rechunk_with_partially_unknown_dimension(x, chunks):
+    dd = pytest.importorskip("dask.dataframe")
+    y = dd.from_array(x).values
+    z = da.concatenate([x, y])
+    xx = da.concatenate([x, x])
+    result = z.rechunk(chunks)
+    expected = xx.rechunk(chunks)
+    assert_chunks_match(result.chunks, expected.chunks)
+    assert_eq(result, expected)
+
+
+@pytest.mark.parametrize(
+    "new_chunks",
+    [
+        ((np.nan, np.nan), (5, 5)),
+        ((math.nan, math.nan), (5, 5)),
+        ((float("nan"), float("nan")), (5, 5)),
+    ],
+)
+def test_rechunk_with_fully_unknown_dimension_explicit(new_chunks):
     dd = pytest.importorskip("dask.dataframe")
     x = da.ones(shape=(10, 10), chunks=(5, 2))
     y = dd.from_array(x).values
-    result = y.rechunk(((np.nan, np.nan), (5, 5)))
+    result = y.rechunk(new_chunks)
     expected = x.rechunk((None, (5, 5)))
     assert_chunks_match(result.chunks, expected.chunks)
     assert_eq(result, expected)
 
 
+@pytest.mark.parametrize(
+    "new_chunks",
+    [
+        ((5, 5, np.nan, np.nan), (5, 5)),
+        ((5, 5, math.nan, math.nan), (5, 5)),
+        ((5, 5, float("nan"), float("nan")), (5, 5)),
+    ],
+)
+def test_rechunk_with_partially_unknown_dimension_explicit(new_chunks):
+    dd = pytest.importorskip("dask.dataframe")
+    x = da.ones(shape=(10, 10), chunks=(5, 2))
+    y = dd.from_array(x).values
+    z = da.concatenate([x, y])
+    xx = da.concatenate([x, x])
+    result = z.rechunk(new_chunks)
+    expected = xx.rechunk((None, (5, 5)))
+    assert_chunks_match(result.chunks, expected.chunks)
+    assert_eq(result, expected)
+
+
 def assert_chunks_match(left, right):
-    for x, y in zip(left, right):
-        if np.isnan(x).any():
-            assert np.isnan(x).all()
-        else:
-            assert x == y
+    for ldim, rdim in zip(left, right):
+        assert all(np.isnan(l) or l == r for l, r in zip(ldim, rdim))
 
 
 def test_rechunk_unknown_raises():
     dd = pytest.importorskip("dask.dataframe")
 
-    x = dd.from_array(da.ones(shape=(10, 10), chunks=(5, 5))).values
-    with pytest.raises(ValueError):
-        x.rechunk((None, (5, 5, 5)))
+    x = da.ones(shape=(10, 10), chunks=(5, 5))
+    y = dd.from_array(x).values
+    with pytest.raises(ValueError, match="Chunks do not add"):
+        y.rechunk((None, (5, 5, 5)))
+
+    with pytest.raises(ValueError, match="Chunks must be unchanging"):
+        y.rechunk(((5, 5), (5, 5)))
+
+    with pytest.raises(ValueError, match="Chunks must be unchanging"):
+        z = da.concatenate([x, y])
+        z.rechunk(((5, 3, 2, np.nan, np.nan), (5, 5)))
 
 
 def test_old_to_new_single():
     old = ((np.nan, np.nan), (8,))
     new = ((np.nan, np.nan), (4, 4))
-    result = _old_to_new(old, new)
+    result = old_to_new(old, new)
 
     expected = [
         [[(0, slice(0, None, None))], [(1, slice(0, None, None))]],
         [[(0, slice(0, 4, None))], [(0, slice(4, 8, None))]],
     ]
 
     assert result == expected
 
 
 def test_old_to_new():
     old = ((np.nan,), (10,))
     new = ((np.nan,), (5, 5))
-    result = _old_to_new(old, new)
+    result = old_to_new(old, new)
     expected = [
         [[(0, slice(0, None, None))]],
         [[(0, slice(0, 5, None))], [(0, slice(5, 10, None))]],
     ]
 
     assert result == expected
 
 
 def test_old_to_new_large():
     old = (tuple([np.nan] * 4), (10,))
     new = (tuple([np.nan] * 4), (5, 5))
 
-    result = _old_to_new(old, new)
+    result = old_to_new(old, new)
     expected = [
         [
             [(0, slice(0, None, None))],
             [(1, slice(0, None, None))],
             [(2, slice(0, None, None))],
             [(3, slice(0, None, None))],
         ],
         [[(0, slice(0, 5, None))], [(0, slice(5, 10, None))]],
     ]
     assert result == expected
 
 
 def test_changing_raises():
     with pytest.raises(ValueError) as record:
-        _old_to_new(((np.nan, np.nan), (4, 4)), ((np.nan, np.nan, np.nan), (4, 4)))
+        old_to_new(((np.nan, np.nan), (4, 4)), ((np.nan, np.nan, np.nan), (4, 4)))
 
     assert "unchanging" in str(record.value)
 
 
 def test_old_to_new_known():
     old = ((10, 10, 10, 10, 10),)
     new = ((25, 5, 20),)
-    result = _old_to_new(old, new)
+    result = old_to_new(old, new)
     expected = [
         [
             [(0, slice(0, 10, None)), (1, slice(0, 10, None)), (2, slice(0, 5, None))],
             [(2, slice(5, 10, None))],
             [(3, slice(0, 10, None)), (4, slice(0, 10, None))],
         ]
     ]
@@ -1067,28 +1142,28 @@
         (((1, slice(0, 4, None)), (0, slice(1, 2, None))),),
     ]
 
     assert result == expected
 
 
 def test_old_to_new_with_zero():
-    from dask.array.rechunk import _old_to_new
+    from dask.array.rechunk import old_to_new
 
     old = ((4, 4),)
     new = ((4, 0, 4),)
-    result = _old_to_new(old, new)
+    result = old_to_new(old, new)
     expected = [[[(0, slice(0, 4))], [(1, slice(0, 0))], [(1, slice(0, 4))]]]
     assert result == expected
 
     old = ((4,),)
     new = ((4, 0),)
-    result = _old_to_new(old, new)
+    result = old_to_new(old, new)
     expected = [[[(0, slice(0, 4))], [(0, slice(4, 4))]]]
     assert result == expected
 
     old = ((4, 0, 4),)
     new = ((4, 0, 2, 2),)
-    result = _old_to_new(old, new)
+    result = old_to_new(old, new)
     expected = [
         [[(0, slice(0, 4))], [(2, slice(0, 0))], [(2, slice(0, 2))], [(2, slice(2, 4))]]
     ]
     assert result == expected
```

### Comparing `dask-2023.5.0/dask/array/tests/test_reductions.py` & `dask-2023.5.1/dask/array/tests/test_reductions.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os
 import warnings
 from itertools import permutations, zip_longest
 
 import pytest
 
 np = pytest.importorskip("numpy")
```

### Comparing `dask-2023.5.0/dask/array/tests/test_reshape.py` & `dask-2023.5.1/dask/array/tests/test_reshape.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 
 import dask.array as da
 from dask.array.reshape import contract_tuple, expand_tuple, reshape_rechunk
 from dask.array.utils import assert_eq
```

### Comparing `dask-2023.5.0/dask/array/tests/test_routines.py` & `dask-2023.5.1/dask/array/tests/test_routines.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 import itertools
 import sys
 import warnings
 from numbers import Number
 
 import pytest
```

### Comparing `dask-2023.5.0/dask/array/tests/test_slicing.py` & `dask-2023.5.1/dask/array/tests/test_slicing.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import itertools
 import warnings
 
 import pytest
 from tlz import merge
 
 np = pytest.importorskip("numpy")
```

### Comparing `dask-2023.5.0/dask/array/tests/test_sparse.py` & `dask-2023.5.1/dask/array/tests/test_sparse.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pytest
 from packaging.version import parse as parse_version
 
 import dask
 import dask.array as da
 from dask.array.reductions import nannumel, numel
```

### Comparing `dask-2023.5.0/dask/array/tests/test_stats.py` & `dask-2023.5.1/dask/array/tests/test_stats.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import warnings
 
 import pytest
 from packaging.version import parse as parse_version
 
 scipy = pytest.importorskip("scipy")
 import numpy as np
```

### Comparing `dask-2023.5.0/dask/array/tests/test_svg.py` & `dask-2023.5.1/dask/array/tests/test_svg.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import xml.etree.ElementTree
 
 import pytest
 
 import dask.array as da
 from dask.array.svg import draw_sizes
```

### Comparing `dask-2023.5.0/dask/array/tests/test_ufunc.py` & `dask-2023.5.1/dask/array/tests/test_ufunc.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pickle
 import warnings
 from functools import partial
 from operator import add
 
 import pytest
```

### Comparing `dask-2023.5.0/dask/array/tests/test_wrap.py` & `dask-2023.5.1/dask/array/tests/test_wrap.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 pytest.importorskip("numpy")
 
 import numpy as np
 
 import dask.array as da
```

### Comparing `dask-2023.5.0/dask/array/tests/test_xarray.py` & `dask-2023.5.1/dask/array/tests/test_xarray.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 import dask.array as da
 from dask.array.utils import assert_eq
 
 xr = pytest.importorskip("xarray")
```

### Comparing `dask-2023.5.0/dask/array/tiledb_io.py` & `dask-2023.5.1/dask/array/tiledb_io.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from dask.array import core
 
 
 def _tiledb_to_chunks(tiledb_array):
     schema = tiledb_array.schema
     return list(schema.domain.dim(i).tile for i in range(schema.ndim))
```

### Comparing `dask-2023.5.0/dask/array/ufunc.py` & `dask-2023.5.1/dask/array/ufunc.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from functools import partial
 from operator import getitem
 
 import numpy as np
 
 from dask import core
 from dask.array.core import Array, apply_infer_dtype, asarray, blockwise, elemwise
```

### Comparing `dask-2023.5.0/dask/array/utils.py` & `dask-2023.5.1/dask/array/utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 import functools
 import itertools
 import math
 import numbers
 import warnings
```

### Comparing `dask-2023.5.0/dask/array/wrap.py` & `dask-2023.5.1/dask/array/wrap.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from functools import partial
 from itertools import product
 
 import numpy as np
 from tlz import curry
 
 from dask.array.backends import array_creation_dispatch
```

### Comparing `dask-2023.5.0/dask/backends.py` & `dask-2023.5.1/dask/backends.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,11 +1,12 @@
 from __future__ import annotations
 
+from collections.abc import Callable
 from functools import lru_cache, wraps
-from typing import TYPE_CHECKING, Callable, Generic, TypeVar
+from typing import TYPE_CHECKING, Generic, TypeVar
 
 import importlib_metadata
 
 from dask import config
 from dask.utils import funcname
 
 if TYPE_CHECKING:
```

### Comparing `dask-2023.5.0/dask/bag/__init__.py` & `dask-2023.5.1/dask/bag/__init__.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 try:
     from dask.bag.avro import read_avro
     from dask.bag.core import Bag, Item
     from dask.bag.core import bag_map as map
     from dask.bag.core import bag_range as range
     from dask.bag.core import bag_zip as zip
     from dask.bag.core import (
```

### Comparing `dask-2023.5.0/dask/bag/avro.py` & `dask-2023.5.1/dask/bag/avro.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import io
 import uuid
 
 from fsspec.core import OpenFile, get_fs_token_paths, open_files
 from fsspec.utils import read_block
 from fsspec.utils import tokenize as fs_tokenize
```

### Comparing `dask-2023.5.0/dask/bag/chunk.py` & `dask-2023.5.1/dask/bag/chunk.py`

 * *Files 13% similar despite different names*

```diff
@@ -1,7 +1,10 @@
+from __future__ import annotations
+
+
 def barrier(*args):
     return None
 
 
 def getitem(x, key):
     """Like :func:`operator.getitem`, but allows setting key using partial
     ``partial(chunk.getitem, key=key)
```

### Comparing `dask-2023.5.0/dask/bag/core.py` & `dask-2023.5.1/dask/bag/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -1768,20 +1768,23 @@
 
     See Also
     --------
     read_text: Create bag from text files
     """
     seq = list(seq)
     if npartitions and not partition_size:
-        partition_size = int(math.ceil(len(seq) / npartitions))
+        if len(seq) <= 100:
+            partition_size = int(math.ceil(len(seq) / npartitions))
+        else:
+            partition_size = max(1, int(math.floor(len(seq) / npartitions)))
     if npartitions is None and partition_size is None:
-        if len(seq) < 100:
+        if len(seq) <= 100:
             partition_size = 1
         else:
-            partition_size = int(len(seq) / 100)
+            partition_size = max(1, math.ceil(math.sqrt(len(seq)) / math.sqrt(100)))
 
     parts = list(partition_all(partition_size, seq))
     name = "from_sequence-" + tokenize(seq, partition_size)
     if len(parts) > 0:
         d = {(name, i): list(part) for i, part in enumerate(parts)}
     else:
         d = {(name, 0): []}
```

### Comparing `dask-2023.5.0/dask/bag/random.py` & `dask-2023.5.1/dask/bag/random.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import heapq
 import math
 import random as rnd
 from functools import partial
 from itertools import islice
 
 from dask.bag.core import Bag
```

### Comparing `dask-2023.5.0/dask/bag/tests/test_avro.py` & `dask-2023.5.1/dask/bag/tests/test_avro.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os
 import random
 
 import pytest
 
 import dask.bag as db
```

### Comparing `dask-2023.5.0/dask/bag/tests/test_bag.py` & `dask-2023.5.1/dask/bag/tests/test_bag.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import gc
 import math
 import os
 import random
 import warnings
 import weakref
 from bz2 import BZ2File
@@ -1186,15 +1188,16 @@
 
 
 @pytest.mark.parametrize("npartitions", [1, 7, 10, 28])
 def test_zip(npartitions, hi=1000):
     evens = db.from_sequence(range(0, hi, 2), npartitions=npartitions)
     odds = db.from_sequence(range(1, hi, 2), npartitions=npartitions)
     pairs = db.zip(evens, odds)
-    assert pairs.npartitions == npartitions
+    assert pairs.npartitions == evens.npartitions
+    assert pairs.npartitions == odds.npartitions
     assert list(pairs) == list(zip(range(0, hi, 2), range(1, hi, 2)))
 
 
 @pytest.mark.parametrize("nin", [1, 2, 7, 11, 23])
 @pytest.mark.parametrize("nout", [1, 2, 5, 12, 23])
 def test_repartition_npartitions(nin, nout):
     b = db.from_sequence(range(100), npartitions=nin)
@@ -1652,7 +1655,29 @@
         1 + int(pyarrow_strings_enabled())
     )
 
     # Annotations are still there
     assert hlg_layer_topological(d2.dask, 1).annotations == {"foo": True}
 
     assert_eq_df(d, d2)
+
+
+@pytest.mark.parametrize("nworkers", [100, 250, 500, 1000])
+def test_default_partitioning_worker_saturation(nworkers):
+    # Ensure that Dask Bag can saturate any number of workers with concurrent tasks.
+    # The default partitioning scheme partitions items to keep the task to item ratio sensible
+    # but it should always be possible to saturate any number of workers given enough items in the bag.
+    ntasks = 0
+    nitems = 1
+    while ntasks < nworkers:
+        ntasks = len(db.from_sequence(range(nitems)).dask)
+        nitems += math.floor(max(1, nworkers / 10))
+        assert nitems < 20_000
+
+
+@pytest.mark.parametrize("nworkers", [100, 250, 500, 1000])
+def test_npartitions_saturation(nworkers):
+    # If npartitions is set the bag should always contain at least that number of tasks
+    for nitems in range(nworkers, 10 * nworkers, max(1, math.floor(nworkers / 10))):
+        assert (
+            len(db.from_sequence(range(nitems), npartitions=nworkers).dask) >= nworkers
+        )
```

### Comparing `dask-2023.5.0/dask/bag/tests/test_random.py` & `dask-2023.5.1/dask/bag/tests/test_random.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import math
 import random as rnd
 
 import pytest
 
 import dask.bag as db
 from dask.bag import random
```

### Comparing `dask-2023.5.0/dask/bag/tests/test_text.py` & `dask-2023.5.1/dask/bag/tests/test_text.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from functools import partial
 
 import pytest
 from fsspec.compression import compr
 from tlz import concat
 
 from dask import compute, config
```

### Comparing `dask-2023.5.0/dask/bag/text.py` & `dask-2023.5.1/dask/bag/text.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import io
 from functools import partial
 
 from fsspec.core import open_files
 from tlz import concat
 
 from dask.bag.core import from_delayed
```

### Comparing `dask-2023.5.0/dask/base.py` & `dask-2023.5.1/dask/base.py`

 * *Files 0% similar despite different names*

```diff
@@ -14,22 +14,21 @@
 from collections.abc import Callable, Iterator, Mapping
 from concurrent.futures import Executor
 from contextlib import contextmanager
 from enum import Enum
 from functools import partial
 from numbers import Integral, Number
 from operator import getitem
-from typing import Literal
+from typing import TYPE_CHECKING, Literal, Protocol
 
-from packaging.version import parse as parse_version
 from tlz import curry, groupby, identity, merge
 from tlz.functoolz import Compose
 
 from dask import config, local
-from dask._compatibility import EMSCRIPTEN, PY_VERSION
+from dask._compatibility import EMSCRIPTEN
 from dask.core import flatten
 from dask.core import get as simple_get
 from dask.core import literal, quote
 from dask.hashing import hash_buffer_hex
 from dask.system import CPU_COUNT
 from dask.typing import SchedulerGetCallable
 from dask.utils import Dispatch, apply, ensure_dict, is_namedtuple_instance, key_split
@@ -46,14 +45,17 @@
     "normalize_token",
     "get_collection_names",
     "get_name_from_key",
     "replace_name_in_key",
     "clone_key",
 )
 
+if TYPE_CHECKING:
+    from _typeshed import ReadableBuffer
+
 
 @contextmanager
 def annotate(**annotations):
     """Context Manager for setting HighLevelGraph Layer annotations.
 
     Annotations are metadata or soft constraints associated with
     tasks that dask schedulers may choose to respect: They signal intent
@@ -147,21 +149,15 @@
         and not callable(annotations["allow_other_workers"])
     ):
         raise TypeError(
             "'allow_other_workers' annotations must be a bool or a callable, but got %s"
             % annotations["allow_other_workers"]
         )
 
-    prev_annotations = config.get("annotations", {})
-    new_annotations = {
-        **prev_annotations,
-        **{f"annotations.{k}": v for k, v in annotations.items()},
-    }
-
-    with config.set(new_annotations):
+    with config.set({f"annotations.{k}": v for k, v in annotations.items()}):
         yield
 
 
 def is_dask_collection(x) -> bool:
     """Returns ``True`` if ``x`` is a dask collection.
 
     Parameters
@@ -903,23 +899,25 @@
     return repack(results2)
 
 
 ############
 # Tokenize #
 ############
 
-# Pass `usedforsecurity=False` for Python 3.9+ to support FIPS builds of Python
-_md5: Callable
-if PY_VERSION >= parse_version("3.9"):
 
-    def _md5(x, _hashlib_md5=hashlib.md5):
-        return _hashlib_md5(x, usedforsecurity=False)
+class _HashFactory(Protocol):
+    def __call__(
+        self, string: ReadableBuffer = b"", *, usedforsecurity: bool = True
+    ) -> hashlib._Hash:
+        ...
+
 
-else:
-    _md5 = hashlib.md5
+# Pass `usedforsecurity=False` to support FIPS builds of Python
+def _md5(x: ReadableBuffer, _hashlib_md5: _HashFactory = hashlib.md5) -> hashlib._Hash:
+    return _hashlib_md5(x, usedforsecurity=False)
 
 
 def tokenize(*args, **kwargs):
     """Deterministic token
 
     >>> tokenize([1, 2, '3'])
     '7d6a880cd9ec03506eee6973ff551339'
```

### Comparing `dask-2023.5.0/dask/blockwise.py` & `dask-2023.5.1/dask/blockwise.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/bytes/core.py` & `dask-2023.5.1/dask/bytes/core.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import copy
 import os
 
 from fsspec.core import OpenFile, get_fs_token_paths
 from fsspec.utils import infer_compression, read_block
 
 from dask.base import tokenize
```

### Comparing `dask-2023.5.0/dask/bytes/tests/test_bytes_utils.py` & `dask-2023.5.1/dask/bytes/tests/test_bytes_utils.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import io
 import os
 import pathlib
 
 import pytest
 from fsspec.utils import (
     infer_storage_options,
```

### Comparing `dask-2023.5.0/dask/bytes/tests/test_http.py` & `dask-2023.5.1/dask/bytes/tests/test_http.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/bytes/tests/test_local.py` & `dask-2023.5.1/dask/bytes/tests/test_local.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import gzip
 import os
 import pathlib
 import sys
 from functools import partial
 from time import sleep
```

### Comparing `dask-2023.5.0/dask/bytes/tests/test_s3.py` & `dask-2023.5.1/dask/bytes/tests/test_s3.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import io
 import os
 import shlex
 import subprocess
 import sys
 import time
 from contextlib import contextmanager
```

### Comparing `dask-2023.5.0/dask/cache.py` & `dask-2023.5.1/dask/cache.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import sys
 from numbers import Number
 from timeit import default_timer
 
 from dask.callbacks import Callback
 
 overhead = sys.getsizeof(1.23) * 4 + sys.getsizeof(()) * 4
```

### Comparing `dask-2023.5.0/dask/callbacks.py` & `dask-2023.5.1/dask/callbacks.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/cli.py` & `dask-2023.5.1/dask/cli.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import warnings
 from functools import reduce
 
 import click
 import importlib_metadata
 from yaml import dump
```

### Comparing `dask-2023.5.0/dask/config.py` & `dask-2023.5.1/dask/config.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/context.py` & `dask-2023.5.1/dask/context.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,10 +1,12 @@
 """
 Control global computation context
 """
+from __future__ import annotations
+
 import threading
 from functools import partial
 
 from dask import config
 
 _globals = config.config
```

### Comparing `dask-2023.5.0/dask/core.py` & `dask-2023.5.1/dask/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from collections import defaultdict
 
 no_default = "__no_default__"
 
 
 def ishashable(x):
     """Is x hashable?
```

### Comparing `dask-2023.5.0/dask/dask-schema.yaml` & `dask-2023.5.1/dask/dask-schema.yaml`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/dask.yaml` & `dask-2023.5.1/dask/dask.yaml`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/dataframe/__init__.py` & `dask-2023.5.1/dask/dataframe/__init__.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 try:
     import dask.dataframe._pyarrow_compat
     from dask.base import compute
     from dask.dataframe import backends, dispatch, rolling
     from dask.dataframe.core import (
         DataFrame,
         Index,
```

### Comparing `dask-2023.5.0/dask/dataframe/_compat.py` & `dask-2023.5.1/dask/dataframe/_compat.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 import string
 import warnings
 
 import numpy as np
 import pandas as pd
 from packaging.version import Version
@@ -9,14 +11,15 @@
 PANDAS_VERSION = Version(pd.__version__)
 PANDAS_GT_131 = PANDAS_VERSION >= Version("1.3.1")
 PANDAS_GT_133 = PANDAS_VERSION >= Version("1.3.3")
 PANDAS_GT_140 = PANDAS_VERSION >= Version("1.4.0")
 PANDAS_GT_150 = PANDAS_VERSION >= Version("1.5.0")
 PANDAS_GT_200 = PANDAS_VERSION.major >= 2
 PANDAS_GT_201 = PANDAS_VERSION.release >= (2, 0, 1)
+PANDAS_GT_202 = PANDAS_VERSION.release >= (2, 0, 2)
 PANDAS_GT_210 = PANDAS_VERSION.release >= (2, 1, 0)
 
 import pandas.testing as tm
 
 
 def assert_categorical_equal(left, right, *args, **kwargs):
     tm.assert_extension_array_equal(left, right, *args, **kwargs)
@@ -79,15 +82,15 @@
         }
     )
     return df
 
 
 @contextlib.contextmanager
 def check_numeric_only_deprecation(name=None, show_nuisance_warning: bool = False):
-    supported_funcs = ["sum", "median", "prod", "min", "max", "var"]
+    supported_funcs = ["sum", "median", "prod", "min", "max", "std", "var", "quantile"]
     if name not in supported_funcs and PANDAS_GT_150 and not PANDAS_GT_200:
         with warnings.catch_warnings():
             warnings.filterwarnings(
                 "ignore",
                 message="The default value of numeric_only",
                 category=FutureWarning,
             )
@@ -171,63 +174,63 @@
             )
             yield
     else:
         yield
 
 
 @contextlib.contextmanager
-def check_reductions_runtime_warning():
-    if PANDAS_GT_200 and not PANDAS_GT_201:
+def check_to_pydatetime_deprecation(catch_deprecation_warnings: bool):
+    if PANDAS_GT_210 and catch_deprecation_warnings:
         with warnings.catch_warnings():
             warnings.filterwarnings(
                 "ignore",
-                message="invalid value encountered in double_scalars|Degrees of freedom <= 0 for slice",
-                category=RuntimeWarning,
+                message=".*DatetimeProperties.to_pydatetime is deprecated",
+                category=FutureWarning,
             )
             yield
     else:
         yield
 
 
 @contextlib.contextmanager
-def check_to_pydatetime_deprecation(catch_deprecation_warnings: bool):
-    if PANDAS_GT_210 and catch_deprecation_warnings:
+def check_apply_dataframe_deprecation():
+    if PANDAS_GT_210:
         with warnings.catch_warnings():
             warnings.filterwarnings(
                 "ignore",
-                message=".*DatetimeProperties.to_pydatetime is deprecated",
+                message="Returning a DataFrame",
                 category=FutureWarning,
             )
             yield
     else:
         yield
 
 
 @contextlib.contextmanager
-def check_apply_dataframe_deprecation():
+def check_applymap_dataframe_deprecation():
     if PANDAS_GT_210:
         with warnings.catch_warnings():
             warnings.filterwarnings(
                 "ignore",
-                message="Returning a DataFrame",
+                message="DataFrame.applymap has been deprecated",
                 category=FutureWarning,
             )
             yield
     else:
         yield
 
 
 @contextlib.contextmanager
-def check_applymap_dataframe_deprecation():
-    if PANDAS_GT_210:
+def check_reductions_runtime_warning():
+    if PANDAS_GT_200 and not PANDAS_GT_201:
         with warnings.catch_warnings():
             warnings.filterwarnings(
                 "ignore",
-                message="DataFrame.applymap has been deprecated",
-                category=FutureWarning,
+                message="invalid value encountered in double_scalars|Degrees of freedom <= 0 for slice",
+                category=RuntimeWarning,
             )
             yield
     else:
         yield
 
 
 if PANDAS_GT_150:
@@ -245,7 +248,20 @@
         from pandas.api.types import is_bool_dtype, is_complex_dtype, is_numeric_dtype
 
         return (
             is_numeric_dtype(arr_or_dtype)
             and not is_complex_dtype(arr_or_dtype)
             and not is_bool_dtype(arr_or_dtype)
         )
+
+
+def is_string_dtype(arr_or_dtype) -> bool:
+    # is_string_dtype did not recognize pyarrow strings before 2.0
+    # Can remove once 2.0 is minimum version for us
+    if hasattr(arr_or_dtype, "dtype"):
+        dtype = arr_or_dtype.dtype
+    else:
+        dtype = arr_or_dtype
+
+    if not PANDAS_GT_200:
+        return pd.api.types.is_dtype_equal(dtype, "string")
+    return pd.api.types.is_string_dtype(dtype)
```

### Comparing `dask-2023.5.0/dask/dataframe/_dtypes.py` & `dask-2023.5.1/dask/dataframe/_dtypes.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from datetime import date, time
 from decimal import Decimal
 
 import pandas as pd
 
 from dask.dataframe._compat import PANDAS_GT_150
 from dask.dataframe.extensions import make_array_nonempty, make_scalar
```

### Comparing `dask-2023.5.0/dask/dataframe/_pyarrow.py` & `dask-2023.5.1/dask/dataframe/_pyarrow.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pandas as pd
 
 from dask.dataframe._compat import PANDAS_GT_150, PANDAS_GT_200
 from dask.dataframe.utils import is_dataframe_like, is_index_like, is_series_like
 
 try:
     import pyarrow as pa
```

### Comparing `dask-2023.5.0/dask/dataframe/_pyarrow_compat.py` & `dask-2023.5.1/dask/dataframe/_pyarrow_compat.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import copyreg
 
 import pandas as pd
 
 try:
     import pyarrow as pa
 except ImportError:
```

### Comparing `dask-2023.5.0/dask/dataframe/accessor.py` & `dask-2023.5.1/dask/dataframe/accessor.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/dataframe/backends.py` & `dask-2023.5.1/dask/dataframe/backends.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 from __future__ import annotations
 
 import warnings
-from typing import Iterable
+from collections.abc import Iterable
 
 import numpy as np
 import pandas as pd
 from pandas.api.types import is_scalar, union_categoricals
 
 from dask.array.core import Array
 from dask.array.dispatch import percentile_lookup
```

### Comparing `dask-2023.5.0/dask/dataframe/categorical.py` & `dask-2023.5.1/dask/dataframe/categorical.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from collections import defaultdict
 from numbers import Integral
 
 import pandas as pd
 from pandas.api.types import is_scalar
 from tlz import partition_all
```

### Comparing `dask-2023.5.0/dask/dataframe/core.py` & `dask-2023.5.1/dask/dataframe/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,27 +1,27 @@
 00000000: 6672 6f6d 205f 5f66 7574 7572 655f 5f20  from __future__ 
 00000010: 696d 706f 7274 2061 6e6e 6f74 6174 696f  import annotatio
 00000020: 6e73 0a0a 696d 706f 7274 206f 7065 7261  ns..import opera
 00000030: 746f 720a 696d 706f 7274 2077 6172 6e69  tor.import warni
 00000040: 6e67 730a 6672 6f6d 2063 6f6c 6c65 6374  ngs.from collect
 00000050: 696f 6e73 2e61 6263 2069 6d70 6f72 7420  ions.abc import 
-00000060: 4861 7368 6162 6c65 2c20 4974 6572 6174  Hashable, Iterat
-00000070: 6f72 2c20 5365 7175 656e 6365 0a66 726f  or, Sequence.fro
-00000080: 6d20 6675 6e63 746f 6f6c 7320 696d 706f  m functools impo
-00000090: 7274 2070 6172 7469 616c 2c20 7772 6170  rt partial, wrap
-000000a0: 730a 6672 6f6d 206e 756d 6265 7273 2069  s.from numbers i
-000000b0: 6d70 6f72 7420 496e 7465 6772 616c 2c20  mport Integral, 
-000000c0: 4e75 6d62 6572 0a66 726f 6d20 6f70 6572  Number.from oper
-000000d0: 6174 6f72 2069 6d70 6f72 7420 6765 7469  ator import geti
-000000e0: 7465 6d0a 6672 6f6d 2070 7072 696e 7420  tem.from pprint 
-000000f0: 696d 706f 7274 2070 666f 726d 6174 0a66  import pformat.f
-00000100: 726f 6d20 7479 7069 6e67 2069 6d70 6f72  rom typing impor
-00000110: 7420 416e 792c 2043 616c 6c61 626c 652c  t Any, Callable,
-00000120: 2043 6c61 7373 5661 722c 204c 6974 6572   ClassVar, Liter
-00000130: 616c 2c20 4d61 7070 696e 670a 0a69 6d70  al, Mapping..imp
+00000060: 4361 6c6c 6162 6c65 2c20 4861 7368 6162  Callable, Hashab
+00000070: 6c65 2c20 4974 6572 6174 6f72 2c20 4d61  le, Iterator, Ma
+00000080: 7070 696e 672c 2053 6571 7565 6e63 650a  pping, Sequence.
+00000090: 6672 6f6d 2066 756e 6374 6f6f 6c73 2069  from functools i
+000000a0: 6d70 6f72 7420 7061 7274 6961 6c2c 2077  mport partial, w
+000000b0: 7261 7073 0a66 726f 6d20 6e75 6d62 6572  raps.from number
+000000c0: 7320 696d 706f 7274 2049 6e74 6567 7261  s import Integra
+000000d0: 6c2c 204e 756d 6265 720a 6672 6f6d 206f  l, Number.from o
+000000e0: 7065 7261 746f 7220 696d 706f 7274 2067  perator import g
+000000f0: 6574 6974 656d 0a66 726f 6d20 7070 7269  etitem.from ppri
+00000100: 6e74 2069 6d70 6f72 7420 7066 6f72 6d61  nt import pforma
+00000110: 740a 6672 6f6d 2074 7970 696e 6720 696d  t.from typing im
+00000120: 706f 7274 2041 6e79 2c20 436c 6173 7356  port Any, ClassV
+00000130: 6172 2c20 4c69 7465 7261 6c0a 0a69 6d70  ar, Literal..imp
 00000140: 6f72 7420 6e75 6d70 7920 6173 206e 700a  ort numpy as np.
 00000150: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
 00000160: 2070 640a 6672 6f6d 2070 616e 6461 732e   pd.from pandas.
 00000170: 6170 692e 7479 7065 7320 696d 706f 7274  api.types import
 00000180: 2028 0a20 2020 2069 735f 626f 6f6c 5f64   (.    is_bool_d
 00000190: 7479 7065 2c0a 2020 2020 6973 5f64 6174  type,.    is_dat
 000001a0: 6574 696d 6536 345f 616e 795f 6474 7970  etime64_any_dtyp
@@ -75,18618 +75,18816 @@
 000004a0: 6174 696f 6e2c 0a20 2020 2063 6865 636b  ation,.    check
 000004b0: 5f6e 7569 7361 6e63 655f 636f 6c75 6d6e  _nuisance_column
 000004c0: 735f 7761 726e 696e 672c 0a20 2020 2063  s_warning,.    c
 000004d0: 6865 636b 5f6e 756d 6572 6963 5f6f 6e6c  heck_numeric_onl
 000004e0: 795f 6465 7072 6563 6174 696f 6e2c 0a20  y_deprecation,. 
 000004f0: 2020 2063 6865 636b 5f72 6564 7563 7469     check_reducti
 00000500: 6f6e 735f 7275 6e74 696d 655f 7761 726e  ons_runtime_warn
-00000510: 696e 672c 0a29 0a66 726f 6d20 6461 736b  ing,.).from dask
-00000520: 2e64 6174 6166 7261 6d65 2e61 6363 6573  .dataframe.acces
-00000530: 736f 7220 696d 706f 7274 2043 6163 6865  sor import Cache
-00000540: 6441 6363 6573 736f 722c 2044 6174 6574  dAccessor, Datet
-00000550: 696d 6541 6363 6573 736f 722c 2053 7472  imeAccessor, Str
-00000560: 696e 6741 6363 6573 736f 720a 6672 6f6d  ingAccessor.from
-00000570: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
-00000580: 6361 7465 676f 7269 6361 6c20 696d 706f  categorical impo
-00000590: 7274 2043 6174 6567 6f72 6963 616c 4163  rt CategoricalAc
-000005a0: 6365 7373 6f72 2c20 6361 7465 676f 7269  cessor, categori
-000005b0: 7a65 0a66 726f 6d20 6461 736b 2e64 6174  ze.from dask.dat
-000005c0: 6166 7261 6d65 2e64 6973 7061 7463 6820  aframe.dispatch 
-000005d0: 696d 706f 7274 2028 0a20 2020 2067 6574  import (.    get
-000005e0: 5f70 6172 616c 6c65 6c5f 7479 7065 2c0a  _parallel_type,.
-000005f0: 2020 2020 6772 6f75 705f 7370 6c69 745f      group_split_
-00000600: 6469 7370 6174 6368 2c0a 2020 2020 6861  dispatch,.    ha
-00000610: 7368 5f6f 626a 6563 745f 6469 7370 6174  sh_object_dispat
-00000620: 6368 2c0a 2020 2020 6d65 7461 5f6e 6f6e  ch,.    meta_non
-00000630: 656d 7074 792c 0a29 0a66 726f 6d20 6461  empty,.).from da
-00000640: 736b 2e64 6174 6166 7261 6d65 2e6f 7074  sk.dataframe.opt
-00000650: 696d 697a 6520 696d 706f 7274 206f 7074  imize import opt
-00000660: 696d 697a 650a 6672 6f6d 2064 6173 6b2e  imize.from dask.
-00000670: 6461 7461 6672 616d 652e 7574 696c 7320  dataframe.utils 
-00000680: 696d 706f 7274 2028 0a20 2020 2041 7474  import (.    Att
-00000690: 7269 6275 7465 4e6f 7449 6d70 6c65 6d65  ributeNotImpleme
-000006a0: 6e74 6564 4572 726f 722c 0a20 2020 2063  ntedError,.    c
-000006b0: 6865 636b 5f6d 6174 6368 696e 675f 636f  heck_matching_co
-000006c0: 6c75 6d6e 732c 0a20 2020 2063 6c65 6172  lumns,.    clear
-000006d0: 5f6b 6e6f 776e 5f63 6174 6567 6f72 6965  _known_categorie
-000006e0: 732c 0a20 2020 2064 726f 705f 6279 5f73  s,.    drop_by_s
-000006f0: 6861 6c6c 6f77 5f63 6f70 792c 0a20 2020  hallow_copy,.   
-00000700: 2067 6574 5f6e 756d 6572 6963 5f6f 6e6c   get_numeric_onl
-00000710: 795f 6b77 6172 6773 2c0a 2020 2020 6861  y_kwargs,.    ha
-00000720: 735f 6b6e 6f77 6e5f 6361 7465 676f 7269  s_known_categori
-00000730: 6573 2c0a 2020 2020 696e 6465 785f 7375  es,.    index_su
-00000740: 6d6d 6172 792c 0a20 2020 2069 6e73 6572  mmary,.    inser
-00000750: 745f 6d65 7461 5f70 6172 616d 5f64 6573  t_meta_param_des
-00000760: 6372 6970 7469 6f6e 2c0a 2020 2020 6973  cription,.    is
-00000770: 5f64 6174 6166 7261 6d65 5f6c 696b 652c  _dataframe_like,
-00000780: 0a20 2020 2069 735f 696e 6465 785f 6c69  .    is_index_li
-00000790: 6b65 2c0a 2020 2020 6973 5f73 6572 6965  ke,.    is_serie
-000007a0: 735f 6c69 6b65 2c0a 2020 2020 6d61 6b65  s_like,.    make
-000007b0: 5f6d 6574 612c 0a20 2020 206d 6574 615f  _meta,.    meta_
-000007c0: 6672 616d 655f 636f 6e73 7472 7563 746f  frame_constructo
-000007d0: 722c 0a20 2020 206d 6574 615f 7365 7269  r,.    meta_seri
-000007e0: 6573 5f63 6f6e 7374 7275 6374 6f72 2c0a  es_constructor,.
-000007f0: 2020 2020 7261 6973 655f 6f6e 5f6d 6574      raise_on_met
-00000800: 615f 6572 726f 722c 0a20 2020 2076 616c  a_error,.    val
-00000810: 6964 5f64 6976 6973 696f 6e73 2c0a 290a  id_divisions,.).
-00000820: 6672 6f6d 2064 6173 6b2e 6465 6c61 7965  from dask.delaye
-00000830: 6420 696d 706f 7274 2044 656c 6179 6564  d import Delayed
-00000840: 2c20 6465 6c61 7965 642c 2075 6e70 6163  , delayed, unpac
-00000850: 6b5f 636f 6c6c 6563 7469 6f6e 730a 6672  k_collections.fr
-00000860: 6f6d 2064 6173 6b2e 6869 6768 6c65 7665  om dask.highleve
-00000870: 6c67 7261 7068 2069 6d70 6f72 7420 4869  lgraph import Hi
-00000880: 6768 4c65 7665 6c47 7261 7068 0a66 726f  ghLevelGraph.fro
-00000890: 6d20 6461 736b 2e6c 6179 6572 7320 696d  m dask.layers im
-000008a0: 706f 7274 2044 6174 6146 7261 6d65 5472  port DataFrameTr
-000008b0: 6565 5265 6475 6374 696f 6e0a 6672 6f6d  eeReduction.from
-000008c0: 2064 6173 6b2e 7574 696c 7320 696d 706f   dask.utils impo
-000008d0: 7274 2028 0a20 2020 2049 6e64 6578 4361  rt (.    IndexCa
-000008e0: 6c6c 6162 6c65 2c0a 2020 2020 4d2c 0a20  llable,.    M,. 
-000008f0: 2020 204f 7065 7261 746f 724d 6574 686f     OperatorMetho
-00000900: 644d 6978 696e 2c0a 2020 2020 5f64 6570  dMixin,.    _dep
-00000910: 7265 6361 7465 642c 0a20 2020 2061 7070  recated,.    app
-00000920: 6c79 2c0a 2020 2020 6465 7269 7665 645f  ly,.    derived_
-00000930: 6672 6f6d 2c0a 2020 2020 6675 6e63 6e61  from,.    funcna
-00000940: 6d65 2c0a 2020 2020 6861 735f 6b65 7977  me,.    has_keyw
-00000950: 6f72 642c 0a20 2020 2069 735f 6172 7261  ord,.    is_arra
-00000960: 796c 696b 652c 0a20 2020 2069 7465 725f  ylike,.    iter_
-00000970: 6368 756e 6b73 2c0a 2020 2020 6b65 795f  chunks,.    key_
-00000980: 7370 6c69 742c 0a20 2020 206d 6179 6265  split,.    maybe
-00000990: 5f70 6c75 7261 6c69 7a65 2c0a 2020 2020  _pluralize,.    
-000009a0: 6d65 6d6f 7279 5f72 6570 722c 0a20 2020  memory_repr,.   
-000009b0: 2070 6172 7365 5f62 7974 6573 2c0a 2020   parse_bytes,.  
-000009c0: 2020 7061 7274 6961 6c5f 6279 5f6f 7264    partial_by_ord
-000009d0: 6572 2c0a 2020 2020 7073 6575 646f 7261  er,.    pseudora
-000009e0: 6e64 6f6d 2c0a 2020 2020 7075 745f 6c69  ndom,.    put_li
-000009f0: 6e65 732c 0a20 2020 2072 616e 646f 6d5f  nes,.    random_
-00000a00: 7374 6174 655f 6461 7461 2c0a 2020 2020  state_data,.    
-00000a10: 7479 7065 6e61 6d65 2c0a 290a 6672 6f6d  typename,.).from
-00000a20: 2064 6173 6b2e 7769 6467 6574 7320 696d   dask.widgets im
-00000a30: 706f 7274 2067 6574 5f74 656d 706c 6174  port get_templat
-00000a40: 650a 0a44 4546 4155 4c54 5f47 4554 203d  e..DEFAULT_GET =
-00000a50: 206e 616d 6564 5f73 6368 6564 756c 6572   named_scheduler
-00000a60: 732e 6765 7428 2274 6872 6561 6473 222c  s.get("threads",
-00000a70: 206e 616d 6564 5f73 6368 6564 756c 6572   named_scheduler
-00000a80: 735b 2273 796e 6322 5d29 0a0a 6e6f 5f64  s["sync"])..no_d
-00000a90: 6566 6175 6c74 203d 2022 5f5f 6e6f 5f64  efault = "__no_d
-00000aa0: 6566 6175 6c74 5f5f 220a 0a47 524f 5550  efault__"..GROUP
-00000ab0: 5f4b 4559 535f 4445 4641 554c 543a 2062  _KEYS_DEFAULT: b
-00000ac0: 6f6f 6c20 7c20 4e6f 6e65 203d 2054 7275  ool | None = Tru
-00000ad0: 650a 6966 2050 414e 4441 535f 4754 5f31  e.if PANDAS_GT_1
-00000ae0: 3530 2061 6e64 206e 6f74 2050 414e 4441  50 and not PANDA
-00000af0: 535f 4754 5f32 3030 3a0a 2020 2020 4752  S_GT_200:.    GR
-00000b00: 4f55 505f 4b45 5953 5f44 4546 4155 4c54  OUP_KEYS_DEFAULT
-00000b10: 203d 204e 6f6e 650a 0a70 642e 7365 745f   = None..pd.set_
-00000b20: 6f70 7469 6f6e 2822 636f 6d70 7574 652e  option("compute.
-00000b30: 7573 655f 6e75 6d65 7870 7222 2c20 4661  use_numexpr", Fa
-00000b40: 6c73 6529 0a0a 0a64 6566 205f 6e75 6d65  lse)...def _nume
-00000b50: 7269 635f 6f6e 6c79 2866 756e 6329 3a0a  ric_only(func):.
-00000b60: 2020 2020 2222 2244 6563 6f72 6174 6f72      """Decorator
-00000b70: 2066 6f72 206d 6574 686f 6473 2074 6861   for methods tha
-00000b80: 7420 6163 6365 7074 2061 206e 756d 6572  t accept a numer
-00000b90: 6963 5f6f 6e6c 7920 6b77 6172 6722 2222  ic_only kwarg"""
-00000ba0: 0a0a 2020 2020 4077 7261 7073 2866 756e  ..    @wraps(fun
-00000bb0: 6329 0a20 2020 2064 6566 2077 7261 7070  c).    def wrapp
-00000bc0: 6572 2873 656c 662c 202a 6172 6773 2c20  er(self, *args, 
-00000bd0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-00000be0: 2020 2023 206e 756d 6572 6963 5f6f 6e6c     # numeric_onl
-00000bf0: 7920 6973 204e 6f6e 6520 6279 2064 6566  y is None by def
-00000c00: 6175 6c74 202d 2069 6e20 7468 6174 2063  ault - in that c
-00000c10: 6173 6520 7365 6c66 203d 2073 656c 662e  ase self = self.
-00000c20: 0a20 2020 2020 2020 2069 6620 6b77 6172  .        if kwar
-00000c30: 6773 2e67 6574 2822 6e75 6d65 7269 635f  gs.get("numeric_
-00000c40: 6f6e 6c79 2229 2069 7320 4661 6c73 653a  only") is False:
-00000c50: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00000c60: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-00000c70: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
-00000c80: 2020 2020 2020 2020 2227 6e75 6d65 7269          "'numeri
-00000c90: 635f 6f6e 6c79 3d46 616c 7365 2720 6973  c_only=False' is
-00000ca0: 206e 6f74 2069 6d70 6c65 6d65 6e74 6564   not implemented
-00000cb0: 2069 6e20 4461 736b 2e22 0a20 2020 2020   in Dask.".     
-00000cc0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00000cd0: 2065 6c69 6620 6b77 6172 6773 2e67 6574   elif kwargs.get
-00000ce0: 2822 6e75 6d65 7269 635f 6f6e 6c79 2229  ("numeric_only")
-00000cf0: 2069 7320 5472 7565 3a0a 2020 2020 2020   is True:.      
-00000d00: 2020 2020 2020 7365 6c66 203d 2073 656c        self = sel
-00000d10: 662e 5f67 6574 5f6e 756d 6572 6963 5f64  f._get_numeric_d
-00000d20: 6174 6128 290a 2020 2020 2020 2020 7265  ata().        re
-00000d30: 7475 726e 2066 756e 6328 7365 6c66 2c20  turn func(self, 
-00000d40: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-00000d50: 0a0a 2020 2020 7265 7475 726e 2077 7261  ..    return wra
-00000d60: 7070 6572 0a0a 0a64 6566 205f 6e75 6d65  pper...def _nume
-00000d70: 7269 635f 6461 7461 2866 756e 6329 3a0a  ric_data(func):.
-00000d80: 2020 2020 2222 224d 6f64 6966 6965 6420      """Modified 
-00000d90: 7665 7273 696f 6e20 6f66 2074 6865 2061  version of the a
-00000da0: 626f 7665 2064 6563 6f72 6174 6f72 2c20  bove decorator, 
-00000db0: 7269 6768 7420 6e6f 7720 6f6e 6c79 2075  right now only u
-00000dc0: 7365 6420 7769 7468 2073 7464 2e20 5765  sed with std. We
-00000dd0: 2064 6f6e 2774 0a20 2020 206e 6565 6420   don't.    need 
-00000de0: 7261 6973 696e 6720 4e6f 7449 6d70 6c65  raising NotImple
-00000df0: 6d65 6e74 6564 4572 726f 7220 7468 6572  mentedError ther
-00000e00: 652c 2062 6563 6175 7365 2069 7427 7320  e, because it's 
-00000e10: 6861 6e64 6c65 6420 6279 0a20 2020 205f  handled by.    _
-00000e20: 6e75 6d65 7269 635f 6f6e 6c79 5f6d 6179  numeric_only_may
-00000e30: 6265 5f77 6172 6e20 696e 7374 6561 642e  be_warn instead.
-00000e40: 2054 6869 7320 6973 2061 2074 656d 706f   This is a tempo
-00000e50: 7261 7279 2073 6f6c 7574 696f 6e20 7468  rary solution th
-00000e60: 6174 206e 6565 6473 0a20 2020 206d 6f72  at needs.    mor
-00000e70: 6520 7469 6d65 2074 6f20 6265 2067 656e  e time to be gen
-00000e80: 6572 616c 697a 6564 2e22 2222 0a0a 2020  eralized."""..  
-00000e90: 2020 4077 7261 7073 2866 756e 6329 0a20    @wraps(func). 
-00000ea0: 2020 2064 6566 2077 7261 7070 6572 2873     def wrapper(s
-00000eb0: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
-00000ec0: 6172 6773 293a 0a20 2020 2020 2020 2069  args):.        i
-00000ed0: 6620 6b77 6172 6773 2e67 6574 2822 6e75  f kwargs.get("nu
-00000ee0: 6d65 7269 635f 6f6e 6c79 2229 2069 7320  meric_only") is 
-00000ef0: 5472 7565 3a0a 2020 2020 2020 2020 2020  True:.          
-00000f00: 2020 7365 6c66 203d 2073 656c 662e 5f67    self = self._g
-00000f10: 6574 5f6e 756d 6572 6963 5f64 6174 6128  et_numeric_data(
-00000f20: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00000f30: 2066 756e 6328 7365 6c66 2c20 2a61 7267   func(self, *arg
-00000f40: 732c 202a 2a6b 7761 7267 7329 0a0a 2020  s, **kwargs)..  
-00000f50: 2020 7265 7475 726e 2077 7261 7070 6572    return wrapper
-00000f60: 0a0a 0a64 6566 205f 6e75 6d65 7269 635f  ...def _numeric_
-00000f70: 6f6e 6c79 5f6d 6179 6265 5f77 6172 6e28  only_maybe_warn(
-00000f80: 6466 2c20 6e75 6d65 7269 635f 6f6e 6c79  df, numeric_only
-00000f90: 2c20 6465 6661 756c 743d 4e6f 6e65 293a  , default=None):
-00000fa0: 0a20 2020 2022 2222 5570 6461 7465 206e  .    """Update n
-00000fb0: 756d 6572 6963 5f6f 6e6c 7920 746f 2067  umeric_only to g
-00000fc0: 6574 2072 6964 206f 6620 6e6f 5f64 6566  et rid of no_def
-00000fd0: 6175 6c74 2c20 616e 6420 706f 7373 6962  ault, and possib
-00000fe0: 6c79 2077 6172 6e20 6162 6f75 7420 6465  ly warn about de
-00000ff0: 6661 756c 7420 7661 6c75 652e 0a20 2020  fault value..   
-00001000: 2054 4f44 4f3a 2073 686f 756c 6420 6d6f   TODO: should mo
-00001010: 7665 2074 6f20 6e75 6d65 7269 635f 6f6e  ve to numeric_on
-00001020: 6c79 2064 6563 6f72 6174 6f72 2e20 5365  ly decorator. Se
-00001030: 6520 6874 7470 733a 2f2f 6769 7468 7562  e https://github
-00001040: 2e63 6f6d 2f64 6173 6b2f 6461 736b 2f70  .com/dask/dask/p
-00001050: 756c 6c2f 3939 3532 0a20 2020 2022 2222  ull/9952.    """
-00001060: 0a20 2020 2069 6620 6973 5f64 6174 6166  .    if is_dataf
-00001070: 7261 6d65 5f6c 696b 6528 6466 293a 0a20  rame_like(df):. 
-00001080: 2020 2020 2020 2077 6172 6e5f 6e75 6d65         warn_nume
-00001090: 7269 635f 6f6e 6c79 203d 2046 616c 7365  ric_only = False
-000010a0: 0a20 2020 2020 2020 2069 6620 6e75 6d65  .        if nume
-000010b0: 7269 635f 6f6e 6c79 2069 7320 6e6f 5f64  ric_only is no_d
-000010c0: 6566 6175 6c74 3a0a 2020 2020 2020 2020  efault:.        
-000010d0: 2020 2020 6966 2050 414e 4441 535f 4754      if PANDAS_GT
-000010e0: 5f32 3030 3a0a 2020 2020 2020 2020 2020  _200:.          
-000010f0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
-00001100: 6c79 203d 2046 616c 7365 0a20 2020 2020  ly = False.     
-00001110: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00001120: 2020 2020 2020 2020 2020 2020 2077 6172               war
-00001130: 6e5f 6e75 6d65 7269 635f 6f6e 6c79 203d  n_numeric_only =
-00001140: 2054 7275 650a 0a20 2020 2020 2020 206e   True..        n
-00001150: 756d 6572 6963 7320 3d20 6466 2e5f 6d65  umerics = df._me
-00001160: 7461 2e5f 6765 745f 6e75 6d65 7269 635f  ta._get_numeric_
-00001170: 6461 7461 2829 0a20 2020 2020 2020 2068  data().        h
-00001180: 6173 5f6e 6f6e 5f6e 756d 6572 6963 7320  as_non_numerics 
-00001190: 3d20 6c65 6e28 6e75 6d65 7269 6373 2e63  = len(numerics.c
-000011a0: 6f6c 756d 6e73 2920 3c20 6c65 6e28 6466  olumns) < len(df
-000011b0: 2e5f 6d65 7461 2e63 6f6c 756d 6e73 290a  ._meta.columns).
-000011c0: 2020 2020 2020 2020 6966 2068 6173 5f6e          if has_n
-000011d0: 6f6e 5f6e 756d 6572 6963 733a 0a20 2020  on_numerics:.   
-000011e0: 2020 2020 2020 2020 2069 6620 6e75 6d65           if nume
-000011f0: 7269 635f 6f6e 6c79 2069 7320 4661 6c73  ric_only is Fals
-00001200: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00001210: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00001220: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-00001230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001240: 2020 2227 6e75 6d65 7269 635f 6f6e 6c79    "'numeric_only
-00001250: 3d46 616c 7365 2720 6973 206e 6f74 2069  =False' is not i
-00001260: 6d70 6c65 6d65 6e74 6564 2069 6e20 4461  mplemented in Da
-00001270: 736b 2e22 0a20 2020 2020 2020 2020 2020  sk.".           
-00001280: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00001290: 2020 2065 6c69 6620 7761 726e 5f6e 756d     elif warn_num
-000012a0: 6572 6963 5f6f 6e6c 793a 0a20 2020 2020  eric_only:.     
-000012b0: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
-000012c0: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
-000012d0: 2020 2020 2020 2020 2020 2020 2020 2254                "T
-000012e0: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
-000012f0: 206f 6620 6e75 6d65 7269 635f 6f6e 6c79   of numeric_only
-00001300: 2069 6e20 6461 736b 2077 696c 6c20 6265   in dask will be
-00001310: 2063 6861 6e67 6564 2074 6f20 4661 6c73   changed to Fals
-00001320: 6520 696e 2022 0a20 2020 2020 2020 2020  e in ".         
-00001330: 2020 2020 2020 2020 2020 2022 7468 6520             "the 
-00001340: 6675 7475 7265 2077 6865 6e20 7573 696e  future when usin
-00001350: 6720 6461 736b 2077 6974 6820 7061 6e64  g dask with pand
-00001360: 6173 2032 2e30 222c 0a20 2020 2020 2020  as 2.0",.       
-00001370: 2020 2020 2020 2020 2020 2020 2046 7574               Fut
-00001380: 7572 6557 6172 6e69 6e67 2c0a 2020 2020  ureWarning,.    
-00001390: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000013a0: 2020 6966 206e 756d 6572 6963 5f6f 6e6c    if numeric_onl
-000013b0: 7920 6973 206e 6f5f 6465 6661 756c 7420  y is no_default 
-000013c0: 616e 6420 6465 6661 756c 7420 6973 206e  and default is n
-000013d0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-000013e0: 206e 756d 6572 6963 5f6f 6e6c 7920 3d20   numeric_only = 
-000013f0: 6465 6661 756c 740a 2020 2020 7265 7475  default.    retu
-00001400: 726e 207b 7d20 6966 206e 756d 6572 6963  rn {} if numeric
-00001410: 5f6f 6e6c 7920 6973 206e 6f5f 6465 6661  _only is no_defa
-00001420: 756c 7420 656c 7365 207b 226e 756d 6572  ult else {"numer
-00001430: 6963 5f6f 6e6c 7922 3a20 6e75 6d65 7269  ic_only": numeri
-00001440: 635f 6f6e 6c79 7d0a 0a0a 6465 6620 5f63  c_only}...def _c
-00001450: 6f6e 6361 7428 6172 6773 2c20 6967 6e6f  oncat(args, igno
-00001460: 7265 5f69 6e64 6578 3d46 616c 7365 293a  re_index=False):
-00001470: 0a20 2020 2069 6620 6e6f 7420 6172 6773  .    if not args
-00001480: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00001490: 2061 7267 730a 2020 2020 6966 2069 7369   args.    if isi
-000014a0: 6e73 7461 6e63 6528 6669 7273 7428 636f  nstance(first(co
-000014b0: 7265 2e66 6c61 7474 656e 2861 7267 7329  re.flatten(args)
-000014c0: 292c 206e 702e 6e64 6172 7261 7929 3a0a  ), np.ndarray):.
-000014d0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-000014e0: 612e 636f 7265 2e63 6f6e 6361 7465 6e61  a.core.concatena
-000014f0: 7465 3328 6172 6773 290a 2020 2020 6966  te3(args).    if
-00001500: 206e 6f74 2068 6173 5f70 6172 616c 6c65   not has_paralle
-00001510: 6c5f 7479 7065 2861 7267 735b 305d 293a  l_type(args[0]):
-00001520: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
-00001530: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00001540: 2070 642e 5365 7269 6573 2861 7267 7329   pd.Series(args)
-00001550: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00001560: 4578 6365 7074 696f 6e3a 0a20 2020 2020  Exception:.     
-00001570: 2020 2020 2020 2072 6574 7572 6e20 6172         return ar
-00001580: 6773 0a20 2020 2023 2057 6520 6669 6c74  gs.    # We filt
-00001590: 6572 206f 7574 2065 6d70 7479 2070 6172  er out empty par
-000015a0: 7469 7469 6f6e 7320 6865 7265 2062 6563  titions here bec
-000015b0: 6175 7365 2070 616e 6461 7320 6672 6571  ause pandas freq
-000015c0: 7565 6e74 6c79 2068 6173 0a20 2020 2023  uently has.    #
-000015d0: 2069 6e63 6f6e 7369 7374 656e 7420 6474   inconsistent dt
-000015e0: 7970 6573 2069 6e20 7265 7375 6c74 7320  ypes in results 
-000015f0: 6265 7477 6565 6e20 656d 7074 7920 616e  between empty an
-00001600: 6420 6e6f 6e2d 656d 7074 7920 6672 616d  d non-empty fram
-00001610: 6573 2e0a 2020 2020 2320 4964 6561 6c6c  es..    # Ideall
-00001620: 7920 7468 6973 2077 6f75 6c64 2062 6520  y this would be 
-00001630: 6861 6e64 6c65 6420 6c6f 6361 6c6c 7920  handled locally 
-00001640: 666f 7220 6561 6368 206f 7065 7261 7469  for each operati
-00001650: 6f6e 2c20 6275 7420 696e 2070 7261 6374  on, but in pract
-00001660: 6963 650a 2020 2020 2320 7468 6973 2073  ice.    # this s
-00001670: 6565 6d73 2065 6173 6965 722e 2054 4f44  eems easier. TOD
-00001680: 4f3a 2064 6f6e 2774 2064 6f20 7468 6973  O: don't do this
-00001690: 2e0a 2020 2020 6172 6773 3220 3d20 5b69  ..    args2 = [i
-000016a0: 2066 6f72 2069 2069 6e20 6172 6773 2069   for i in args i
-000016b0: 6620 6c65 6e28 6929 5d0a 2020 2020 7265  f len(i)].    re
-000016c0: 7475 726e 2028 0a20 2020 2020 2020 2061  turn (.        a
-000016d0: 7267 735b 305d 0a20 2020 2020 2020 2069  rgs[0].        i
-000016e0: 6620 6e6f 7420 6172 6773 320a 2020 2020  f not args2.    
-000016f0: 2020 2020 656c 7365 206d 6574 686f 6473      else methods
-00001700: 2e63 6f6e 6361 7428 6172 6773 322c 2075  .concat(args2, u
-00001710: 6e69 666f 726d 3d54 7275 652c 2069 676e  niform=True, ign
-00001720: 6f72 655f 696e 6465 783d 6967 6e6f 7265  ore_index=ignore
-00001730: 5f69 6e64 6578 290a 2020 2020 290a 0a0a  _index).    )...
-00001740: 6465 6620 6669 6e61 6c69 7a65 2872 6573  def finalize(res
-00001750: 756c 7473 293a 0a20 2020 2072 6574 7572  ults):.    retur
-00001760: 6e20 5f63 6f6e 6361 7428 7265 7375 6c74  n _concat(result
-00001770: 7329 0a0a 0a63 6c61 7373 2053 6361 6c61  s)...class Scala
-00001780: 7228 4461 736b 4d65 7468 6f64 734d 6978  r(DaskMethodsMix
-00001790: 696e 2c20 4f70 6572 6174 6f72 4d65 7468  in, OperatorMeth
-000017a0: 6f64 4d69 7869 6e29 3a0a 2020 2020 2222  odMixin):.    ""
-000017b0: 2241 2044 6173 6b20 6f62 6a65 6374 2074  "A Dask object t
-000017c0: 6f20 7265 7072 6573 656e 7420 6120 7061  o represent a pa
-000017d0: 6e64 6173 2073 6361 6c61 7222 2222 0a0a  ndas scalar"""..
-000017e0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-000017f0: 2873 656c 662c 2064 736b 2c20 6e61 6d65  (self, dsk, name
-00001800: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
-00001810: 733d 4e6f 6e65 293a 0a20 2020 2020 2020  s=None):.       
-00001820: 2023 2064 6976 6973 696f 6e73 2069 7320   # divisions is 
-00001830: 6967 6e6f 7265 642c 206f 6e6c 7920 7072  ignored, only pr
-00001840: 6573 656e 7420 746f 2062 6520 636f 6d70  esent to be comp
-00001850: 6174 6962 6c65 2077 6974 6820 6f74 6865  atible with othe
-00001860: 720a 2020 2020 2020 2020 2320 6f62 6a65  r.        # obje
-00001870: 6374 732e 0a20 2020 2020 2020 2069 6620  cts..        if 
-00001880: 6e6f 7420 6973 696e 7374 616e 6365 2864  not isinstance(d
-00001890: 736b 2c20 4869 6768 4c65 7665 6c47 7261  sk, HighLevelGra
-000018a0: 7068 293a 0a20 2020 2020 2020 2020 2020  ph):.           
-000018b0: 2064 736b 203d 2048 6967 684c 6576 656c   dsk = HighLevel
-000018c0: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-000018d0: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
-000018e0: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
-000018f0: 5d29 0a20 2020 2020 2020 2073 656c 662e  ]).        self.
-00001900: 6461 736b 203d 2064 736b 0a20 2020 2020  dask = dsk.     
-00001910: 2020 2073 656c 662e 5f6e 616d 6520 3d20     self._name = 
-00001920: 6e61 6d65 0a20 2020 2020 2020 2073 656c  name.        sel
-00001930: 662e 5f70 6172 656e 745f 6d65 7461 203d  f._parent_meta =
-00001940: 2070 642e 5365 7269 6573 2864 7479 7065   pd.Series(dtype
-00001950: 3d22 666c 6f61 7436 3422 290a 0a20 2020  ="float64")..   
-00001960: 2020 2020 206d 6574 6120 3d20 6d61 6b65       meta = make
-00001970: 5f6d 6574 6128 6d65 7461 2c20 7061 7265  _meta(meta, pare
-00001980: 6e74 5f6d 6574 613d 7365 6c66 2e5f 7061  nt_meta=self._pa
-00001990: 7265 6e74 5f6d 6574 6129 0a20 2020 2020  rent_meta).     
-000019a0: 2020 2069 6620 6973 5f64 6174 6166 7261     if is_datafra
-000019b0: 6d65 5f6c 696b 6528 6d65 7461 2920 6f72  me_like(meta) or
-000019c0: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
-000019d0: 6d65 7461 2920 6f72 2069 735f 696e 6465  meta) or is_inde
-000019e0: 785f 6c69 6b65 286d 6574 6129 3a0a 2020  x_like(meta):.  
-000019f0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00001a00: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
-00001a10: 2020 2020 2020 2020 2020 2066 2245 7870             f"Exp
-00001a20: 6563 7465 6420 6d65 7461 2074 6f20 7370  ected meta to sp
-00001a30: 6563 6966 7920 7363 616c 6172 2c20 676f  ecify scalar, go
-00001a40: 7420 7b74 7970 656e 616d 6528 7479 7065  t {typename(type
-00001a50: 286d 6574 6129 297d 220a 2020 2020 2020  (meta))}".      
-00001a60: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00001a70: 7365 6c66 2e5f 6d65 7461 203d 206d 6574  self._meta = met
-00001a80: 610a 0a20 2020 2064 6566 205f 5f64 6173  a..    def __das
-00001a90: 6b5f 6772 6170 685f 5f28 7365 6c66 293a  k_graph__(self):
-00001aa0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00001ab0: 7365 6c66 2e64 6173 6b0a 0a20 2020 2064  self.dask..    d
-00001ac0: 6566 205f 5f64 6173 6b5f 6b65 7973 5f5f  ef __dask_keys__
-00001ad0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00001ae0: 7265 7475 726e 205b 7365 6c66 2e6b 6579  return [self.key
-00001af0: 5d0a 0a20 2020 2064 6566 205f 5f64 6173  ]..    def __das
-00001b00: 6b5f 746f 6b65 6e69 7a65 5f5f 2873 656c  k_tokenize__(sel
-00001b10: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00001b20: 726e 2073 656c 662e 5f6e 616d 650a 0a20  rn self._name.. 
-00001b30: 2020 2064 6566 205f 5f64 6173 6b5f 6c61     def __dask_la
-00001b40: 7965 7273 5f5f 2873 656c 6629 3a0a 2020  yers__(self):.  
-00001b50: 2020 2020 2020 7265 7475 726e 2028 7365        return (se
-00001b60: 6c66 2e5f 6e61 6d65 2c29 0a0a 2020 2020  lf._name,)..    
-00001b70: 5f5f 6461 736b 5f6f 7074 696d 697a 655f  __dask_optimize_
-00001b80: 5f20 3d20 676c 6f62 616c 6d65 7468 6f64  _ = globalmethod
-00001b90: 280a 2020 2020 2020 2020 6f70 7469 6d69  (.        optimi
-00001ba0: 7a65 2c20 6b65 793d 2264 6174 6166 7261  ze, key="datafra
-00001bb0: 6d65 5f6f 7074 696d 697a 6522 2c20 6661  me_optimize", fa
-00001bc0: 6c73 6579 3d64 6f6e 745f 6f70 7469 6d69  lsey=dont_optimi
-00001bd0: 7a65 0a20 2020 2029 0a20 2020 205f 5f64  ze.    ).    __d
-00001be0: 6173 6b5f 7363 6865 6475 6c65 725f 5f20  ask_scheduler__ 
-00001bf0: 3d20 7374 6174 6963 6d65 7468 6f64 2844  = staticmethod(D
-00001c00: 4546 4155 4c54 5f47 4554 290a 0a20 2020  EFAULT_GET)..   
-00001c10: 2064 6566 205f 5f64 6173 6b5f 706f 7374   def __dask_post
-00001c20: 636f 6d70 7574 655f 5f28 7365 6c66 293a  compute__(self):
-00001c30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00001c40: 6669 7273 742c 2028 290a 0a20 2020 2064  first, ()..    d
-00001c50: 6566 205f 5f64 6173 6b5f 706f 7374 7065  ef __dask_postpe
-00001c60: 7273 6973 745f 5f28 7365 6c66 293a 0a20  rsist__(self):. 
-00001c70: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00001c80: 6c66 2e5f 7265 6275 696c 642c 2028 290a  lf._rebuild, ().
-00001c90: 0a20 2020 2064 6566 205f 7265 6275 696c  .    def _rebuil
-00001ca0: 6428 7365 6c66 2c20 6473 6b2c 202a 2c20  d(self, dsk, *, 
-00001cb0: 7265 6e61 6d65 3d4e 6f6e 6529 3a0a 2020  rename=None):.  
-00001cc0: 2020 2020 2020 6e61 6d65 203d 2073 656c        name = sel
-00001cd0: 662e 5f6e 616d 650a 2020 2020 2020 2020  f._name.        
-00001ce0: 6966 2072 656e 616d 653a 0a20 2020 2020  if rename:.     
-00001cf0: 2020 2020 2020 206e 616d 6520 3d20 7265         name = re
-00001d00: 6e61 6d65 2e67 6574 286e 616d 652c 206e  name.get(name, n
-00001d10: 616d 6529 0a20 2020 2020 2020 2072 6574  ame).        ret
-00001d20: 7572 6e20 5363 616c 6172 2864 736b 2c20  urn Scalar(dsk, 
-00001d30: 6e61 6d65 2c20 7365 6c66 2e5f 6d65 7461  name, self._meta
-00001d40: 2c20 7365 6c66 2e64 6976 6973 696f 6e73  , self.divisions
-00001d50: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-00001d60: 0a20 2020 2064 6566 205f 6d65 7461 5f6e  .    def _meta_n
-00001d70: 6f6e 656d 7074 7928 7365 6c66 293a 0a20  onempty(self):. 
-00001d80: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00001d90: 6c66 2e5f 6d65 7461 0a0a 2020 2020 4070  lf._meta..    @p
-00001da0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00001db0: 6474 7970 6528 7365 6c66 293a 0a20 2020  dtype(self):.   
-00001dc0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00001dd0: 2e5f 6d65 7461 2e64 7479 7065 0a0a 2020  ._meta.dtype..  
-00001de0: 2020 6465 6620 5f5f 6469 725f 5f28 7365    def __dir__(se
-00001df0: 6c66 293a 0a20 2020 2020 2020 206f 203d  lf):.        o =
-00001e00: 2073 6574 2864 6972 2874 7970 6528 7365   set(dir(type(se
-00001e10: 6c66 2929 290a 2020 2020 2020 2020 6f2e  lf))).        o.
-00001e20: 7570 6461 7465 2873 656c 662e 5f5f 6469  update(self.__di
-00001e30: 6374 5f5f 290a 2020 2020 2020 2020 6966  ct__).        if
-00001e40: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
-00001e50: 662e 5f6d 6574 612c 2022 6474 7970 6522  f._meta, "dtype"
-00001e60: 293a 0a20 2020 2020 2020 2020 2020 206f  ):.            o
-00001e70: 2e72 656d 6f76 6528 2264 7479 7065 2229  .remove("dtype")
-00001e80: 2020 2320 6474 7970 6520 6f6e 6c79 2069    # dtype only i
-00001e90: 6e20 6064 6972 6020 6966 2061 7661 696c  n `dir` if avail
-00001ea0: 6162 6c65 0a20 2020 2020 2020 2072 6574  able.        ret
-00001eb0: 7572 6e20 6c69 7374 286f 290a 0a20 2020  urn list(o)..   
-00001ec0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00001ed0: 6566 2064 6976 6973 696f 6e73 2873 656c  ef divisions(sel
-00001ee0: 6629 3a0a 2020 2020 2020 2020 2222 2244  f):.        """D
-00001ef0: 756d 6d79 2064 6976 6973 696f 6e73 2074  ummy divisions t
-00001f00: 6f20 6265 2063 6f6d 7061 7420 7769 7468  o be compat with
-00001f10: 2053 6572 6965 7320 616e 6420 4461 7461   Series and Data
-00001f20: 4672 616d 6522 2222 0a20 2020 2020 2020  Frame""".       
-00001f30: 2072 6574 7572 6e20 284e 6f6e 652c 204e   return (None, N
-00001f40: 6f6e 6529 0a0a 2020 2020 6465 6620 5f5f  one)..    def __
-00001f50: 7265 7072 5f5f 2873 656c 6629 3a0a 2020  repr__(self):.  
-00001f60: 2020 2020 2020 6e61 6d65 203d 2073 656c        name = sel
-00001f70: 662e 5f6e 616d 6520 6966 206c 656e 2873  f._name if len(s
-00001f80: 656c 662e 5f6e 616d 6529 203c 2031 3020  elf._name) < 10 
-00001f90: 656c 7365 2073 656c 662e 5f6e 616d 655b  else self._name[
-00001fa0: 3a37 5d20 2b20 222e 2e2e 220a 2020 2020  :7] + "...".    
-00001fb0: 2020 2020 6966 2068 6173 6174 7472 2873      if hasattr(s
-00001fc0: 656c 662e 5f6d 6574 612c 2022 6474 7970  elf._meta, "dtyp
-00001fd0: 6522 293a 0a20 2020 2020 2020 2020 2020  e"):.           
-00001fe0: 2065 7874 7261 203d 2022 2c20 6474 7970   extra = ", dtyp
-00001ff0: 653d 2573 2220 2520 7365 6c66 2e5f 6d65  e=%s" % self._me
-00002000: 7461 2e64 7479 7065 0a20 2020 2020 2020  ta.dtype.       
-00002010: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00002020: 2020 2065 7874 7261 203d 2022 2c20 7479     extra = ", ty
-00002030: 7065 3d25 7322 2025 2074 7970 6528 7365  pe=%s" % type(se
-00002040: 6c66 2e5f 6d65 7461 292e 5f5f 6e61 6d65  lf._meta).__name
-00002050: 5f5f 0a20 2020 2020 2020 2072 6574 7572  __.        retur
-00002060: 6e20 6622 6464 2e53 6361 6c61 723c 7b6e  n f"dd.Scalar<{n
-00002070: 616d 657d 7b65 7874 7261 7d3e 220a 0a20  ame}{extra}>".. 
-00002080: 2020 2064 6566 205f 5f61 7272 6179 5f5f     def __array__
-00002090: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000020a0: 2320 6172 7261 7920 696e 7465 7266 6163  # array interfac
-000020b0: 6520 6973 2072 6571 7569 7265 6420 746f  e is required to
-000020c0: 2073 7570 706f 7274 2070 616e 6461 7320   support pandas 
-000020d0: 696e 7374 616e 6365 202b 2053 6361 6c61  instance + Scala
-000020e0: 720a 2020 2020 2020 2020 2320 4f74 6865  r.        # Othe
-000020f0: 7277 6973 652c 2061 626f 7665 206f 7020  rwise, above op 
-00002100: 7265 7375 6c74 7320 696e 2070 642e 5365  results in pd.Se
-00002110: 7269 6573 206f 6620 5363 616c 6172 2028  ries of Scalar (
-00002120: 6f62 6a65 6374 2064 7479 7065 290a 2020  object dtype).  
-00002130: 2020 2020 2020 7265 7475 726e 206e 702e        return np.
-00002140: 6173 6172 7261 7928 7365 6c66 2e63 6f6d  asarray(self.com
-00002150: 7075 7465 2829 290a 0a20 2020 2040 7072  pute())..    @pr
-00002160: 6f70 6572 7479 0a20 2020 2064 6566 205f  operty.    def _
-00002170: 6172 6773 2873 656c 6629 3a0a 2020 2020  args(self):.    
-00002180: 2020 2020 7265 7475 726e 2028 7365 6c66      return (self
-00002190: 2e64 6173 6b2c 2073 656c 662e 5f6e 616d  .dask, self._nam
-000021a0: 652c 2073 656c 662e 5f6d 6574 6129 0a0a  e, self._meta)..
-000021b0: 2020 2020 6465 6620 5f5f 6765 7473 7461      def __getsta
-000021c0: 7465 5f5f 2873 656c 6629 3a0a 2020 2020  te__(self):.    
-000021d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000021e0: 5f61 7267 730a 0a20 2020 2064 6566 205f  _args..    def _
-000021f0: 5f73 6574 7374 6174 655f 5f28 7365 6c66  _setstate__(self
-00002200: 2c20 7374 6174 6529 3a0a 2020 2020 2020  , state):.      
-00002210: 2020 7365 6c66 2e64 6173 6b2c 2073 656c    self.dask, sel
-00002220: 662e 5f6e 616d 652c 2073 656c 662e 5f6d  f._name, self._m
-00002230: 6574 6120 3d20 7374 6174 650a 0a20 2020  eta = state..   
-00002240: 2064 6566 205f 5f62 6f6f 6c5f 5f28 7365   def __bool__(se
-00002250: 6c66 293a 0a20 2020 2020 2020 2072 6169  lf):.        rai
-00002260: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
-00002270: 2020 2020 2020 2020 2020 6622 5472 7969            f"Tryi
-00002280: 6e67 2074 6f20 636f 6e76 6572 7420 7b73  ng to convert {s
-00002290: 656c 667d 2074 6f20 6120 626f 6f6c 6561  elf} to a boolea
-000022a0: 6e20 7661 6c75 652e 2042 6563 6175 7365  n value. Because
-000022b0: 2044 6173 6b20 6f62 6a65 6374 7320 6172   Dask objects ar
-000022c0: 6520 220a 2020 2020 2020 2020 2020 2020  e ".            
-000022d0: 226c 617a 696c 7920 6576 616c 7561 7465  "lazily evaluate
-000022e0: 642c 2074 6865 7920 6361 6e6e 6f74 2062  d, they cannot b
-000022f0: 6520 636f 6e76 6572 7465 6420 746f 2061  e converted to a
-00002300: 2062 6f6f 6c65 616e 2076 616c 7565 206f   boolean value o
-00002310: 7220 7573 6564 2022 0a20 2020 2020 2020  r used ".       
-00002320: 2020 2020 2022 696e 2062 6f6f 6c65 616e       "in boolean
-00002330: 2063 6f6e 6469 7469 6f6e 7320 6c69 6b65   conditions like
-00002340: 2069 6620 7374 6174 656d 656e 7473 2e20   if statements. 
-00002350: 5472 7920 6361 6c6c 696e 6720 2e63 6f6d  Try calling .com
-00002360: 7075 7465 2829 2074 6f20 220a 2020 2020  pute() to ".    
-00002370: 2020 2020 2020 2020 2266 6f72 6365 2063          "force c
-00002380: 6f6d 7075 7461 7469 6f6e 2070 7269 6f72  omputation prior
-00002390: 2074 6f20 636f 6e76 6572 7469 6e67 2074   to converting t
-000023a0: 6f20 6120 626f 6f6c 6561 6e20 7661 6c75  o a boolean valu
-000023b0: 6520 6f72 2075 7369 6e67 2069 6e20 220a  e or using in ".
-000023c0: 2020 2020 2020 2020 2020 2020 2261 2063              "a c
-000023d0: 6f6e 6469 7469 6f6e 616c 2073 7461 7465  onditional state
-000023e0: 6d65 6e74 2e22 0a20 2020 2020 2020 2029  ment.".        )
-000023f0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00002400: 2020 2020 6465 6620 6b65 7928 7365 6c66      def key(self
-00002410: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00002420: 6e20 2873 656c 662e 5f6e 616d 652c 2030  n (self._name, 0
-00002430: 290a 0a20 2020 2040 636c 6173 736d 6574  )..    @classmet
-00002440: 686f 640a 2020 2020 6465 6620 5f67 6574  hod.    def _get
-00002450: 5f75 6e61 7279 5f6f 7065 7261 746f 7228  _unary_operator(
-00002460: 636c 732c 206f 7029 3a0a 2020 2020 2020  cls, op):.      
-00002470: 2020 6465 6620 6628 7365 6c66 293a 0a20    def f(self):. 
-00002480: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-00002490: 3d20 6675 6e63 6e61 6d65 286f 7029 202b  = funcname(op) +
-000024a0: 2022 2d22 202b 2074 6f6b 656e 697a 6528   "-" + tokenize(
-000024b0: 7365 6c66 290a 2020 2020 2020 2020 2020  self).          
-000024c0: 2020 6473 6b20 3d20 7b28 6e61 6d65 2c20    dsk = {(name, 
-000024d0: 3029 3a20 286f 702c 2028 7365 6c66 2e5f  0): (op, (self._
-000024e0: 6e61 6d65 2c20 3029 297d 0a20 2020 2020  name, 0))}.     
-000024f0: 2020 2020 2020 206d 6574 6120 3d20 6f70         meta = op
-00002500: 2873 656c 662e 5f6d 6574 615f 6e6f 6e65  (self._meta_none
-00002510: 6d70 7479 290a 2020 2020 2020 2020 2020  mpty).          
-00002520: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-00002530: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-00002540: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
-00002550: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
-00002560: 733d 5b73 656c 665d 290a 2020 2020 2020  s=[self]).      
-00002570: 2020 2020 2020 7265 7475 726e 2053 6361        return Sca
-00002580: 6c61 7228 6772 6170 682c 206e 616d 652c  lar(graph, name,
-00002590: 206d 6574 6129 0a0a 2020 2020 2020 2020   meta)..        
-000025a0: 7265 7475 726e 2066 0a0a 2020 2020 4063  return f..    @c
-000025b0: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
-000025c0: 6566 205f 6765 745f 6269 6e61 7279 5f6f  ef _get_binary_o
-000025d0: 7065 7261 746f 7228 636c 732c 206f 702c  perator(cls, op,
-000025e0: 2069 6e76 3d46 616c 7365 293a 0a20 2020   inv=False):.   
-000025f0: 2020 2020 2072 6574 7572 6e20 6c61 6d62       return lamb
-00002600: 6461 2073 656c 662c 206f 7468 6572 3a20  da self, other: 
-00002610: 5f73 6361 6c61 725f 6269 6e61 7279 286f  _scalar_binary(o
-00002620: 702c 2073 656c 662c 206f 7468 6572 2c20  p, self, other, 
-00002630: 696e 763d 696e 7629 0a0a 2020 2020 6465  inv=inv)..    de
-00002640: 6620 746f 5f64 656c 6179 6564 2873 656c  f to_delayed(sel
-00002650: 662c 206f 7074 696d 697a 655f 6772 6170  f, optimize_grap
-00002660: 683d 5472 7565 293a 0a20 2020 2020 2020  h=True):.       
-00002670: 2022 2222 436f 6e76 6572 7420 696e 746f   """Convert into
-00002680: 2061 2060 6064 6173 6b2e 6465 6c61 7965   a ``dask.delaye
-00002690: 6460 6020 6f62 6a65 6374 2e0a 0a20 2020  d`` object...   
-000026a0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-000026b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000026c0: 2d2d 0a20 2020 2020 2020 206f 7074 696d  --.        optim
-000026d0: 697a 655f 6772 6170 6820 3a20 626f 6f6c  ize_graph : bool
-000026e0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-000026f0: 2020 2020 2020 2049 6620 5472 7565 205b         If True [
-00002700: 6465 6661 756c 745d 2c20 7468 6520 6772  default], the gr
-00002710: 6170 6820 6973 206f 7074 696d 697a 6564  aph is optimized
-00002720: 2062 6566 6f72 6520 636f 6e76 6572 7469   before converti
-00002730: 6e67 2069 6e74 6f0a 2020 2020 2020 2020  ng into.        
-00002740: 2020 2020 6060 6461 736b 2e64 656c 6179      ``dask.delay
-00002750: 6564 6060 206f 626a 6563 7473 2e0a 2020  ed`` objects..  
-00002760: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00002770: 2020 6473 6b20 3d20 7365 6c66 2e5f 5f64    dsk = self.__d
-00002780: 6173 6b5f 6772 6170 685f 5f28 290a 2020  ask_graph__().  
-00002790: 2020 2020 2020 6c61 7965 7220 3d20 7365        layer = se
-000027a0: 6c66 2e5f 5f64 6173 6b5f 6c61 7965 7273  lf.__dask_layers
-000027b0: 5f5f 2829 5b30 5d0a 2020 2020 2020 2020  __()[0].        
-000027c0: 6966 206f 7074 696d 697a 655f 6772 6170  if optimize_grap
-000027d0: 683a 0a20 2020 2020 2020 2020 2020 2064  h:.            d
-000027e0: 736b 203d 2073 656c 662e 5f5f 6461 736b  sk = self.__dask
-000027f0: 5f6f 7074 696d 697a 655f 5f28 6473 6b2c  _optimize__(dsk,
-00002800: 2073 656c 662e 5f5f 6461 736b 5f6b 6579   self.__dask_key
-00002810: 735f 5f28 2929 0a20 2020 2020 2020 2020  s__()).         
-00002820: 2020 206c 6179 6572 203d 2022 6465 6c61     layer = "dela
-00002830: 7965 642d 2220 2b20 7365 6c66 2e5f 6e61  yed-" + self._na
-00002840: 6d65 0a20 2020 2020 2020 2020 2020 2064  me.            d
-00002850: 736b 203d 2048 6967 684c 6576 656c 4772  sk = HighLevelGr
-00002860: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
-00002870: 696f 6e73 286c 6179 6572 2c20 6473 6b2c  ions(layer, dsk,
-00002880: 2064 6570 656e 6465 6e63 6965 733d 2829   dependencies=()
-00002890: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000028a0: 2044 656c 6179 6564 2873 656c 662e 6b65   Delayed(self.ke
-000028b0: 792c 2064 736b 2c20 6c61 7965 723d 6c61  y, dsk, layer=la
-000028c0: 7965 7229 0a0a 0a64 6566 205f 7363 616c  yer)...def _scal
-000028d0: 6172 5f62 696e 6172 7928 6f70 2c20 7365  ar_binary(op, se
-000028e0: 6c66 2c20 6f74 6865 722c 2069 6e76 3d46  lf, other, inv=F
-000028f0: 616c 7365 293a 0a20 2020 206e 616d 6520  alse):.    name 
-00002900: 3d20 6622 7b66 756e 636e 616d 6528 6f70  = f"{funcname(op
-00002910: 297d 2d7b 746f 6b65 6e69 7a65 2873 656c  )}-{tokenize(sel
-00002920: 662c 206f 7468 6572 297d 220a 2020 2020  f, other)}".    
-00002930: 6465 7065 6e64 656e 6369 6573 203d 205b  dependencies = [
-00002940: 7365 6c66 5d0a 0a20 2020 2064 736b 203d  self]..    dsk =
-00002950: 207b 7d0a 2020 2020 7265 7475 726e 5f74   {}.    return_t
-00002960: 7970 6520 3d20 6765 745f 7061 7261 6c6c  ype = get_parall
-00002970: 656c 5f74 7970 6528 6f74 6865 7229 0a0a  el_type(other)..
-00002980: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00002990: 6528 6f74 6865 722c 2053 6361 6c61 7229  e(other, Scalar)
-000029a0: 3a0a 2020 2020 2020 2020 6465 7065 6e64  :.        depend
-000029b0: 656e 6369 6573 2e61 7070 656e 6428 6f74  encies.append(ot
-000029c0: 6865 7229 0a20 2020 2020 2020 206f 7468  her).        oth
-000029d0: 6572 5f6b 6579 203d 2028 6f74 6865 722e  er_key = (other.
-000029e0: 5f6e 616d 652c 2030 290a 2020 2020 656c  _name, 0).    el
-000029f0: 6966 2069 735f 6461 736b 5f63 6f6c 6c65  if is_dask_colle
-00002a00: 6374 696f 6e28 6f74 6865 7229 3a0a 2020  ction(other):.  
-00002a10: 2020 2020 2020 7265 7475 726e 204e 6f74        return Not
-00002a20: 496d 706c 656d 656e 7465 640a 2020 2020  Implemented.    
-00002a30: 656c 7365 3a0a 2020 2020 2020 2020 6f74  else:.        ot
-00002a40: 6865 725f 6b65 7920 3d20 6f74 6865 720a  her_key = other.
-00002a50: 0a20 2020 2064 736b 5b28 6e61 6d65 2c20  .    dsk[(name, 
-00002a60: 3029 5d20 3d20 280a 2020 2020 2020 2020  0)] = (.        
-00002a70: 286f 702c 206f 7468 6572 5f6b 6579 2c20  (op, other_key, 
-00002a80: 2873 656c 662e 5f6e 616d 652c 2030 2929  (self._name, 0))
-00002a90: 2069 6620 696e 7620 656c 7365 2028 6f70   if inv else (op
-00002aa0: 2c20 2873 656c 662e 5f6e 616d 652c 2030  , (self._name, 0
-00002ab0: 292c 206f 7468 6572 5f6b 6579 290a 2020  ), other_key).  
-00002ac0: 2020 290a 0a20 2020 206f 7468 6572 5f6d    )..    other_m
-00002ad0: 6574 6120 3d20 6d61 6b65 5f6d 6574 6128  eta = make_meta(
-00002ae0: 6f74 6865 722c 2070 6172 656e 745f 6d65  other, parent_me
-00002af0: 7461 3d73 656c 662e 5f70 6172 656e 745f  ta=self._parent_
-00002b00: 6d65 7461 290a 2020 2020 6f74 6865 725f  meta).    other_
-00002b10: 6d65 7461 5f6e 6f6e 656d 7074 7920 3d20  meta_nonempty = 
-00002b20: 6d65 7461 5f6e 6f6e 656d 7074 7928 6f74  meta_nonempty(ot
-00002b30: 6865 725f 6d65 7461 290a 2020 2020 6966  her_meta).    if
-00002b40: 2069 6e76 3a0a 2020 2020 2020 2020 6d65   inv:.        me
-00002b50: 7461 203d 206f 7028 6f74 6865 725f 6d65  ta = op(other_me
-00002b60: 7461 5f6e 6f6e 656d 7074 792c 2073 656c  ta_nonempty, sel
-00002b70: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
-00002b80: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
-00002b90: 2020 2020 6d65 7461 203d 206f 7028 7365      meta = op(se
-00002ba0: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
-00002bb0: 792c 206f 7468 6572 5f6d 6574 615f 6e6f  y, other_meta_no
-00002bc0: 6e65 6d70 7479 290a 0a20 2020 2067 7261  nempty)..    gra
-00002bd0: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
-00002be0: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
-00002bf0: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
-00002c00: 6465 7065 6e64 656e 6369 6573 3d64 6570  dependencies=dep
-00002c10: 656e 6465 6e63 6965 7329 0a20 2020 2069  endencies).    i
-00002c20: 6620 7265 7475 726e 5f74 7970 6520 6973  f return_type is
-00002c30: 206e 6f74 2053 6361 6c61 723a 0a20 2020   not Scalar:.   
-00002c40: 2020 2020 2072 6574 7572 6e20 7265 7475       return retu
-00002c50: 726e 5f74 7970 6528 6772 6170 682c 206e  rn_type(graph, n
-00002c60: 616d 652c 206d 6574 612c 205b 6f74 6865  ame, meta, [othe
-00002c70: 722e 696e 6465 782e 6d69 6e28 292c 206f  r.index.min(), o
-00002c80: 7468 6572 2e69 6e64 6578 2e6d 6178 2829  ther.index.max()
-00002c90: 5d29 0a20 2020 2065 6c73 653a 0a20 2020  ]).    else:.   
-00002ca0: 2020 2020 2072 6574 7572 6e20 5363 616c       return Scal
-00002cb0: 6172 2867 7261 7068 2c20 6e61 6d65 2c20  ar(graph, name, 
-00002cc0: 6d65 7461 290a 0a0a 636c 6173 7320 5f46  meta)...class _F
-00002cd0: 7261 6d65 2844 6173 6b4d 6574 686f 6473  rame(DaskMethods
-00002ce0: 4d69 7869 6e2c 204f 7065 7261 746f 724d  Mixin, OperatorM
-00002cf0: 6574 686f 644d 6978 696e 293a 0a20 2020  ethodMixin):.   
-00002d00: 2022 2222 5375 7065 7263 6c61 7373 2066   """Superclass f
-00002d10: 6f72 2044 6174 6146 7261 6d65 2061 6e64  or DataFrame and
-00002d20: 2053 6572 6965 730a 0a20 2020 2050 6172   Series..    Par
-00002d30: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-00002d40: 2d2d 2d2d 2d2d 0a20 2020 2064 736b 3a20  ------.    dsk: 
-00002d50: 6469 6374 0a20 2020 2020 2020 2054 6865  dict.        The
-00002d60: 2064 6173 6b20 6772 6170 6820 746f 2063   dask graph to c
-00002d70: 6f6d 7075 7465 2074 6869 7320 4461 7461  ompute this Data
-00002d80: 4672 616d 650a 2020 2020 6e61 6d65 3a20  Frame.    name: 
-00002d90: 7374 720a 2020 2020 2020 2020 5468 6520  str.        The 
-00002da0: 6b65 7920 7072 6566 6978 2074 6861 7420  key prefix that 
-00002db0: 7370 6563 6966 6965 7320 7768 6963 6820  specifies which 
-00002dc0: 6b65 7973 2069 6e20 7468 6520 6461 736b  keys in the dask
-00002dd0: 2063 6f6d 7072 6973 6520 7468 6973 0a20   comprise this. 
-00002de0: 2020 2020 2020 2070 6172 7469 6375 6c61         particula
-00002df0: 7220 4461 7461 4672 616d 6520 2f20 5365  r DataFrame / Se
-00002e00: 7269 6573 0a20 2020 206d 6574 613a 2070  ries.    meta: p
-00002e10: 616e 6461 732e 4461 7461 4672 616d 652c  andas.DataFrame,
-00002e20: 2070 616e 6461 732e 5365 7269 6573 2c20   pandas.Series, 
-00002e30: 6f72 2070 616e 6461 732e 496e 6465 780a  or pandas.Index.
-00002e40: 2020 2020 2020 2020 416e 2065 6d70 7479          An empty
-00002e50: 2070 616e 6461 7320 6f62 6a65 6374 2077   pandas object w
-00002e60: 6974 6820 6e61 6d65 732c 2064 7479 7065  ith names, dtype
-00002e70: 732c 2061 6e64 2069 6e64 6963 6573 206d  s, and indices m
-00002e80: 6174 6368 696e 6720 7468 650a 2020 2020  atching the.    
-00002e90: 2020 2020 6578 7065 6374 6564 206f 7574      expected out
-00002ea0: 7075 742e 0a20 2020 2064 6976 6973 696f  put..    divisio
-00002eb0: 6e73 3a20 7475 706c 6520 6f66 2069 6e64  ns: tuple of ind
-00002ec0: 6578 2076 616c 7565 730a 2020 2020 2020  ex values.      
-00002ed0: 2020 5661 6c75 6573 2061 6c6f 6e67 2077    Values along w
-00002ee0: 6869 6368 2077 6520 7061 7274 6974 696f  hich we partitio
-00002ef0: 6e20 6f75 7220 626c 6f63 6b73 206f 6e20  n our blocks on 
-00002f00: 7468 6520 696e 6465 780a 2020 2020 2222  the index.    ""
-00002f10: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
-00002f20: 745f 5f28 7365 6c66 2c20 6473 6b2c 206e  t__(self, dsk, n
-00002f30: 616d 652c 206d 6574 612c 2064 6976 6973  ame, meta, divis
-00002f40: 696f 6e73 293a 0a20 2020 2020 2020 2069  ions):.        i
-00002f50: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-00002f60: 2864 736b 2c20 4869 6768 4c65 7665 6c47  (dsk, HighLevelG
-00002f70: 7261 7068 293a 0a20 2020 2020 2020 2020  raph):.         
-00002f80: 2020 2064 736b 203d 2048 6967 684c 6576     dsk = HighLev
-00002f90: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-00002fa0: 6c65 6374 696f 6e73 286e 616d 652c 2064  lections(name, d
-00002fb0: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
-00002fc0: 3d5b 5d29 0a20 2020 2020 2020 2073 656c  =[]).        sel
-00002fd0: 662e 6461 736b 203d 2064 736b 0a20 2020  f.dask = dsk.   
-00002fe0: 2020 2020 2073 656c 662e 5f6e 616d 6520       self._name 
-00002ff0: 3d20 6e61 6d65 0a20 2020 2020 2020 206d  = name.        m
-00003000: 6574 6120 3d20 6d61 6b65 5f6d 6574 6128  eta = make_meta(
-00003010: 6d65 7461 290a 2020 2020 2020 2020 6966  meta).        if
-00003020: 206e 6f74 2073 656c 662e 5f69 735f 7061   not self._is_pa
-00003030: 7274 6974 696f 6e5f 7479 7065 286d 6574  rtition_type(met
-00003040: 6129 3a0a 2020 2020 2020 2020 2020 2020  a):.            
-00003050: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-00003060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003070: 2066 2245 7870 6563 7465 6420 6d65 7461   f"Expected meta
-00003080: 2074 6f20 7370 6563 6966 7920 7479 7065   to specify type
-00003090: 207b 7479 7065 2873 656c 6629 2e5f 5f6e   {type(self).__n
-000030a0: 616d 655f 5f7d 2c20 676f 7420 7479 7065  ame__}, got type
-000030b0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-000030c0: 2020 2066 227b 7479 7065 6e61 6d65 2874     f"{typename(t
-000030d0: 7970 6528 6d65 7461 2929 7d22 0a20 2020  ype(meta))}".   
-000030e0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000030f0: 2020 2073 656c 662e 5f6d 6574 6120 3d20     self._meta = 
-00003100: 6d65 7461 0a20 2020 2020 2020 2073 656c  meta.        sel
-00003110: 662e 6469 7669 7369 6f6e 7320 3d20 7475  f.divisions = tu
-00003120: 706c 6528 6469 7669 7369 6f6e 7329 0a0a  ple(divisions)..
-00003130: 2020 2020 2020 2020 2320 4f70 7469 6f6e          # Option
-00003140: 616c 6c79 2063 6173 7420 6f62 6a65 6374  ally cast object
-00003150: 2064 7479 7065 7320 746f 2060 7079 6172   dtypes to `pyar
-00003160: 726f 7760 2073 7472 696e 6773 0a20 2020  row` strings.   
-00003170: 2020 2020 2069 6620 6461 736b 2e63 6f6e       if dask.con
-00003180: 6669 672e 6765 7428 2264 6174 6166 7261  fig.get("datafra
-00003190: 6d65 2e63 6f6e 7665 7274 2d73 7472 696e  me.convert-strin
-000031a0: 6722 293a 0a20 2020 2020 2020 2020 2020  g"):.           
-000031b0: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
-000031c0: 7261 6d65 2e5f 7079 6172 726f 7720 696d  rame._pyarrow im
-000031d0: 706f 7274 2063 6865 636b 5f70 7961 7272  port check_pyarr
-000031e0: 6f77 5f73 7472 696e 675f 7375 7070 6f72  ow_string_suppor
-000031f0: 7465 640a 0a20 2020 2020 2020 2020 2020  ted..           
-00003200: 2063 6865 636b 5f70 7961 7272 6f77 5f73   check_pyarrow_s
-00003210: 7472 696e 675f 7375 7070 6f72 7465 6428  tring_supported(
-00003220: 290a 0a20 2020 2020 2020 2020 2020 2066  )..            f
-00003230: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-00003240: 6d65 2e5f 7079 6172 726f 7720 696d 706f  me._pyarrow impo
-00003250: 7274 2028 0a20 2020 2020 2020 2020 2020  rt (.           
-00003260: 2020 2020 2069 735f 6f62 6a65 6374 5f73       is_object_s
-00003270: 7472 696e 675f 6461 7461 6672 616d 652c  tring_dataframe,
-00003280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003290: 2069 735f 6f62 6a65 6374 5f73 7472 696e   is_object_strin
-000032a0: 675f 6474 7970 652c 0a20 2020 2020 2020  g_dtype,.       
-000032b0: 2020 2020 2020 2020 2069 735f 6f62 6a65           is_obje
-000032c0: 6374 5f73 7472 696e 675f 696e 6465 782c  ct_string_index,
-000032d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000032e0: 2069 735f 6f62 6a65 6374 5f73 7472 696e   is_object_strin
-000032f0: 675f 7365 7269 6573 2c0a 2020 2020 2020  g_series,.      
-00003300: 2020 2020 2020 2020 2020 746f 5f70 7961            to_pya
-00003310: 7272 6f77 5f73 7472 696e 672c 0a20 2020  rrow_string,.   
-00003320: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00003330: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
-00003340: 2020 2020 2020 2020 2020 2020 2069 735f               is_
-00003350: 6f62 6a65 6374 5f73 7472 696e 675f 6461  object_string_da
-00003360: 7461 6672 616d 6528 6d65 7461 290a 2020  taframe(meta).  
-00003370: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-00003380: 2069 735f 6f62 6a65 6374 5f73 7472 696e   is_object_strin
-00003390: 675f 7365 7269 6573 286d 6574 6129 0a20  g_series(meta). 
-000033a0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-000033b0: 7220 6973 5f6f 626a 6563 745f 7374 7269  r is_object_stri
-000033c0: 6e67 5f69 6e64 6578 286d 6574 6129 0a20  ng_index(meta). 
-000033d0: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
-000033e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000033f0: 5072 696f 7220 746f 2070 616e 6461 733d  Prior to pandas=
-00003400: 312e 342c 2060 7064 2e49 6e64 6578 6020  1.4, `pd.Index` 
-00003410: 636f 756c 646e 2774 2063 6f6e 7461 696e  couldn't contain
-00003420: 2065 7874 656e 7369 6f6e 2064 7479 7065   extension dtype
-00003430: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
-00003440: 2020 2023 2048 6572 6520 7765 2064 6f6e     # Here we don
-00003450: 2774 2063 6173 7420 6f62 6a65 6374 7320  't cast objects 
-00003460: 746f 2070 7961 7272 6f77 2073 7472 696e  to pyarrow strin
-00003470: 6773 2077 6865 7265 206f 6e6c 7920 7468  gs where only th
-00003480: 6520 696e 6465 780a 2020 2020 2020 2020  e index.        
-00003490: 2020 2020 2020 2020 2320 636f 6e74 6169          # contai
-000034a0: 6e73 206e 6f6e 2d70 7961 7272 6f77 2073  ns non-pyarrow s
-000034b0: 7472 696e 6720 6461 7461 2e0a 2020 2020  tring data..    
-000034c0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-000034d0: 6f74 2050 414e 4441 535f 4754 5f31 3430  ot PANDAS_GT_140
-000034e0: 2061 6e64 2028 0a20 2020 2020 2020 2020   and (.         
-000034f0: 2020 2020 2020 2020 2020 2028 0a20 2020             (.   
-00003500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003510: 2020 2020 2069 735f 6f62 6a65 6374 5f73       is_object_s
-00003520: 7472 696e 675f 6461 7461 6672 616d 6528  tring_dataframe(
-00003530: 6d65 7461 290a 2020 2020 2020 2020 2020  meta).          
-00003540: 2020 2020 2020 2020 2020 2020 2020 616e                an
-00003550: 6420 6e6f 7420 616e 7928 6973 5f6f 626a  d not any(is_obj
-00003560: 6563 745f 7374 7269 6e67 5f64 7479 7065  ect_string_dtype
-00003570: 2864 2920 666f 7220 6420 696e 206d 6574  (d) for d in met
-00003580: 612e 6474 7970 6573 290a 2020 2020 2020  a.dtypes).      
-00003590: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000035a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000035b0: 2020 2020 6f72 2028 0a20 2020 2020 2020      or (.       
-000035c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000035d0: 2069 735f 6f62 6a65 6374 5f73 7472 696e   is_object_strin
-000035e0: 675f 7365 7269 6573 286d 6574 6129 0a20  g_series(meta). 
-000035f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003600: 2020 2020 2020 2061 6e64 206e 6f74 2069         and not i
-00003610: 735f 6f62 6a65 6374 5f73 7472 696e 675f  s_object_string_
-00003620: 6474 7970 6528 6d65 7461 2e64 7479 7065  dtype(meta.dtype
-00003630: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00003640: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00003650: 2020 2020 2020 2020 2020 2020 6f72 2069              or i
-00003660: 735f 6f62 6a65 6374 5f73 7472 696e 675f  s_object_string_
-00003670: 696e 6465 7828 6d65 7461 290a 2020 2020  index(meta).    
-00003680: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
-00003690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000036a0: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
-000036b0: 2020 2020 2020 2020 2020 2023 2074 6869             # thi
-000036c0: 7320 6973 2061 6e20 696e 7465 726e 616c  s is an internal
-000036d0: 2063 616c 6c2c 2061 6e64 2069 6620 7765   call, and if we
-000036e0: 2065 6e66 6f72 6365 206d 6574 6164 6174   enforce metadat
-000036f0: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-00003700: 2020 2023 2069 7420 6d61 7920 696e 7465     # it may inte
-00003710: 7266 6572 6520 7768 656e 2072 6561 6469  rfere when readi
-00003720: 6e67 2063 7376 2077 6974 6820 656e 666f  ng csv with enfo
-00003730: 7263 653d 4661 6c73 650a 2020 2020 2020  rce=False.      
-00003740: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00003750: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
-00003760: 6974 696f 6e73 2874 6f5f 7079 6172 726f  itions(to_pyarro
-00003770: 775f 7374 7269 6e67 2c20 656e 666f 7263  w_string, enforc
-00003780: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-00003790: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000037a0: 2020 7365 6c66 2e64 6173 6b20 3d20 7265    self.dask = re
-000037b0: 7375 6c74 2e64 6173 6b0a 2020 2020 2020  sult.dask.      
-000037c0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-000037d0: 6e61 6d65 203d 2072 6573 756c 742e 5f6e  name = result._n
-000037e0: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
-000037f0: 2020 2020 7365 6c66 2e5f 6d65 7461 203d      self._meta =
-00003800: 2072 6573 756c 742e 5f6d 6574 610a 2020   result._meta.  
-00003810: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00003820: 6c66 2e64 6976 6973 696f 6e73 203d 2072  lf.divisions = r
-00003830: 6573 756c 742e 6469 7669 7369 6f6e 730a  esult.divisions.
-00003840: 0a20 2020 2064 6566 205f 5f64 6173 6b5f  .    def __dask_
-00003850: 6772 6170 685f 5f28 7365 6c66 293a 0a20  graph__(self):. 
-00003860: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00003870: 6c66 2e64 6173 6b0a 0a20 2020 2064 6566  lf.dask..    def
-00003880: 205f 5f64 6173 6b5f 6b65 7973 5f5f 2873   __dask_keys__(s
-00003890: 656c 6629 202d 3e20 6c69 7374 5b48 6173  elf) -> list[Has
-000038a0: 6861 626c 655d 3a0a 2020 2020 2020 2020  hable]:.        
-000038b0: 7265 7475 726e 205b 2873 656c 662e 5f6e  return [(self._n
-000038c0: 616d 652c 2069 2920 666f 7220 6920 696e  ame, i) for i in
-000038d0: 2072 616e 6765 2873 656c 662e 6e70 6172   range(self.npar
-000038e0: 7469 7469 6f6e 7329 5d0a 0a20 2020 2064  titions)]..    d
-000038f0: 6566 205f 5f64 6173 6b5f 6c61 7965 7273  ef __dask_layers
-00003900: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00003910: 2020 7265 7475 726e 2028 7365 6c66 2e5f    return (self._
-00003920: 6e61 6d65 2c29 0a0a 2020 2020 6465 6620  name,)..    def 
-00003930: 5f5f 6461 736b 5f74 6f6b 656e 697a 655f  __dask_tokenize_
-00003940: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00003950: 2072 6574 7572 6e20 7365 6c66 2e5f 6e61   return self._na
-00003960: 6d65 0a0a 2020 2020 5f5f 6461 736b 5f6f  me..    __dask_o
-00003970: 7074 696d 697a 655f 5f20 3d20 676c 6f62  ptimize__ = glob
-00003980: 616c 6d65 7468 6f64 280a 2020 2020 2020  almethod(.      
-00003990: 2020 6f70 7469 6d69 7a65 2c20 6b65 793d    optimize, key=
-000039a0: 2264 6174 6166 7261 6d65 5f6f 7074 696d  "dataframe_optim
-000039b0: 697a 6522 2c20 6661 6c73 6579 3d64 6f6e  ize", falsey=don
-000039c0: 745f 6f70 7469 6d69 7a65 0a20 2020 2029  t_optimize.    )
-000039d0: 0a20 2020 205f 5f64 6173 6b5f 7363 6865  .    __dask_sche
-000039e0: 6475 6c65 725f 5f20 3d20 7374 6174 6963  duler__ = static
-000039f0: 6d65 7468 6f64 2844 4546 4155 4c54 5f47  method(DEFAULT_G
-00003a00: 4554 290a 0a20 2020 2064 6566 205f 5f64  ET)..    def __d
-00003a10: 6173 6b5f 706f 7374 636f 6d70 7574 655f  ask_postcompute_
-00003a20: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00003a30: 2072 6574 7572 6e20 6669 6e61 6c69 7a65   return finalize
-00003a40: 2c20 2829 0a0a 2020 2020 6465 6620 5f5f  , ()..    def __
-00003a50: 6461 736b 5f70 6f73 7470 6572 7369 7374  dask_postpersist
-00003a60: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00003a70: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
-00003a80: 6562 7569 6c64 2c20 2829 0a0a 2020 2020  ebuild, ()..    
-00003a90: 6465 6620 5f72 6562 7569 6c64 2873 656c  def _rebuild(sel
-00003aa0: 662c 2064 736b 2c20 2a2c 2072 656e 616d  f, dsk, *, renam
-00003ab0: 653d 4e6f 6e65 293a 0a20 2020 2020 2020  e=None):.       
-00003ac0: 206e 616d 6520 3d20 7365 6c66 2e5f 6e61   name = self._na
-00003ad0: 6d65 0a20 2020 2020 2020 2069 6620 7265  me.        if re
-00003ae0: 6e61 6d65 3a0a 2020 2020 2020 2020 2020  name:.          
-00003af0: 2020 6e61 6d65 203d 2072 656e 616d 652e    name = rename.
-00003b00: 6765 7428 6e61 6d65 2c20 6e61 6d65 290a  get(name, name).
-00003b10: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-00003b20: 7970 6528 7365 6c66 2928 6473 6b2c 206e  ype(self)(dsk, n
-00003b30: 616d 652c 2073 656c 662e 5f6d 6574 612c  ame, self._meta,
-00003b40: 2073 656c 662e 6469 7669 7369 6f6e 7329   self.divisions)
-00003b50: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00003b60: 2020 2020 6465 6620 5f63 6f6e 7374 7275      def _constru
-00003b70: 6374 6f72 2873 656c 6629 3a0a 2020 2020  ctor(self):.    
-00003b80: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
-00003b90: 645f 6f62 6a65 6374 0a0a 2020 2020 4070  d_object..    @p
-00003ba0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00003bb0: 6469 7669 7369 6f6e 7328 7365 6c66 293a  divisions(self):
-00003bc0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00003bd0: 2020 2020 2054 7570 6c65 206f 6620 6060       Tuple of ``
-00003be0: 6e70 6172 7469 7469 6f6e 7320 2b20 3160  npartitions + 1`
-00003bf0: 6020 7661 6c75 6573 2c20 696e 2061 7363  ` values, in asc
-00003c00: 656e 6469 6e67 206f 7264 6572 2c20 6d61  ending order, ma
-00003c10: 726b 696e 6720 7468 650a 2020 2020 2020  rking the.      
-00003c20: 2020 6c6f 7765 722f 7570 7065 7220 626f    lower/upper bo
-00003c30: 756e 6473 206f 6620 6561 6368 2070 6172  unds of each par
-00003c40: 7469 7469 6f6e 2773 2069 6e64 6578 2e20  tition's index. 
-00003c50: 4469 7669 7369 6f6e 7320 616c 6c6f 7720  Divisions allow 
-00003c60: 4461 736b 0a20 2020 2020 2020 2074 6f20  Dask.        to 
-00003c70: 6b6e 6f77 2077 6869 6368 2070 6172 7469  know which parti
-00003c80: 7469 6f6e 2077 696c 6c20 636f 6e74 6169  tion will contai
-00003c90: 6e20 6120 6769 7665 6e20 7661 6c75 652c  n a given value,
-00003ca0: 2073 6967 6e69 6669 6361 6e74 6c79 0a20   significantly. 
-00003cb0: 2020 2020 2020 2073 7065 6564 696e 6720         speeding 
-00003cc0: 7570 206f 7065 7261 7469 6f6e 7320 6c69  up operations li
-00003cd0: 6b65 2060 6c6f 6360 2c20 606d 6572 6765  ke `loc`, `merge
-00003ce0: 602c 2061 6e64 2060 6772 6f75 7062 7960  `, and `groupby`
-00003cf0: 2062 7920 6e6f 740a 2020 2020 2020 2020   by not.        
-00003d00: 6861 7669 6e67 2074 6f20 7365 6172 6368  having to search
-00003d10: 2074 6865 2066 756c 6c20 6461 7461 7365   the full datase
-00003d20: 742e 0a0a 2020 2020 2020 2020 4578 616d  t...        Exam
-00003d30: 706c 653a 2066 6f72 2060 6064 6976 6973  ple: for ``divis
-00003d40: 696f 6e73 203d 2028 302c 2031 302c 2035  ions = (0, 10, 5
-00003d50: 302c 2031 3030 2960 602c 2074 6865 7265  0, 100)``, there
-00003d60: 2061 7265 2074 6872 6565 2070 6172 7469   are three parti
-00003d70: 7469 6f6e 732c 0a20 2020 2020 2020 2077  tions,.        w
-00003d80: 6865 7265 2074 6865 2069 6e64 6578 2069  here the index i
-00003d90: 6e20 6561 6368 2070 6172 7469 7469 6f6e  n each partition
-00003da0: 2063 6f6e 7461 696e 7320 7661 6c75 6573   contains values
-00003db0: 205b 302c 2031 3029 2c20 5b31 302c 2035   [0, 10), [10, 5
-00003dc0: 3029 2c0a 2020 2020 2020 2020 616e 6420  0),.        and 
-00003dd0: 5b35 302c 2031 3030 5d2c 2072 6573 7065  [50, 100], respe
-00003de0: 6374 6976 656c 792e 2044 6173 6b20 7468  ctively. Dask th
-00003df0: 6572 6566 6f72 6520 6b6e 6f77 7320 6060  erefore knows ``
-00003e00: 6466 2e6c 6f63 5b34 355d 6060 0a20 2020  df.loc[45]``.   
-00003e10: 2020 2020 2077 696c 6c20 6265 2069 6e20       will be in 
-00003e20: 7468 6520 7365 636f 6e64 2070 6172 7469  the second parti
-00003e30: 7469 6f6e 2e0a 0a20 2020 2020 2020 2057  tion...        W
-00003e40: 6865 6e20 6576 6572 7920 6974 656d 2069  hen every item i
-00003e50: 6e20 6060 6469 7669 7369 6f6e 7360 6020  n ``divisions`` 
-00003e60: 6973 2060 604e 6f6e 6560 602c 2074 6865  is ``None``, the
-00003e70: 2064 6976 6973 696f 6e73 2061 7265 2075   divisions are u
-00003e80: 6e6b 6e6f 776e 2e0a 2020 2020 2020 2020  nknown..        
-00003e90: 4d6f 7374 206f 7065 7261 7469 6f6e 7320  Most operations 
-00003ea0: 6361 6e20 7374 696c 6c20 6265 2070 6572  can still be per
-00003eb0: 666f 726d 6564 2c20 6275 7420 736f 6d65  formed, but some
-00003ec0: 2077 696c 6c20 6265 206d 7563 6820 736c   will be much sl
-00003ed0: 6f77 6572 2c0a 2020 2020 2020 2020 616e  ower,.        an
-00003ee0: 6420 6120 6665 7720 6d61 7920 6661 696c  d a few may fail
-00003ef0: 2e0a 0a20 2020 2020 2020 2049 7420 6973  ...        It is
-00003f00: 2075 6e63 6f6d 6d6f 6e20 746f 2073 6574   uncommon to set
-00003f10: 2060 6064 6976 6973 696f 6e73 6060 2064   ``divisions`` d
-00003f20: 6972 6563 746c 792e 2049 6e73 7465 6164  irectly. Instead
-00003f30: 2c20 7573 6520 6060 7365 745f 696e 6465  , use ``set_inde
-00003f40: 7860 602c 0a20 2020 2020 2020 2077 6869  x``,.        whi
-00003f50: 6368 2073 6f72 7473 2061 6e64 2073 706c  ch sorts and spl
-00003f60: 6974 7320 7468 6520 6461 7461 2061 7320  its the data as 
-00003f70: 6e65 6564 6564 2e0a 2020 2020 2020 2020  needed..        
-00003f80: 5365 6520 6874 7470 733a 2f2f 646f 6373  See https://docs
-00003f90: 2e64 6173 6b2e 6f72 672f 656e 2f6c 6174  .dask.org/en/lat
-00003fa0: 6573 742f 6461 7461 6672 616d 652d 6465  est/dataframe-de
-00003fb0: 7369 676e 2e68 746d 6c23 7061 7274 6974  sign.html#partit
-00003fc0: 696f 6e73 2e0a 2020 2020 2020 2020 2222  ions..        ""
-00003fd0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00003fe0: 2073 656c 662e 5f64 6976 6973 696f 6e73   self._divisions
-00003ff0: 0a0a 2020 2020 4064 6976 6973 696f 6e73  ..    @divisions
-00004000: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
-00004010: 6469 7669 7369 6f6e 7328 7365 6c66 2c20  divisions(self, 
-00004020: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
-00004030: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00004040: 6528 7661 6c75 652c 2074 7570 6c65 293a  e(value, tuple):
-00004050: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00004060: 7365 2054 7970 6545 7272 6f72 2822 6469  se TypeError("di
-00004070: 7669 7369 6f6e 7320 6d75 7374 2062 6520  visions must be 
-00004080: 6120 7475 706c 6522 290a 0a20 2020 2020  a tuple")..     
-00004090: 2020 2069 6620 6861 7361 7474 7228 7365     if hasattr(se
-000040a0: 6c66 2c20 225f 6469 7669 7369 6f6e 7322  lf, "_divisions"
-000040b0: 2920 616e 6420 6c65 6e28 7661 6c75 6529  ) and len(value)
-000040c0: 2021 3d20 6c65 6e28 7365 6c66 2e5f 6469   != len(self._di
-000040d0: 7669 7369 6f6e 7329 3a0a 2020 2020 2020  visions):.      
-000040e0: 2020 2020 2020 6e20 3d20 6c65 6e28 7365        n = len(se
-000040f0: 6c66 2e5f 6469 7669 7369 6f6e 7329 0a20  lf._divisions). 
-00004100: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00004110: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00004120: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
-00004130: 6869 7320 6461 7461 6672 616d 6520 6861  his dataframe ha
-00004140: 7320 6e70 6172 7469 7469 6f6e 733d 7b6e  s npartitions={n
-00004150: 202d 2031 7d2c 2064 6976 6973 696f 6e73   - 1}, divisions
-00004160: 2073 686f 756c 6420 6265 2061 2022 0a20   should be a ". 
-00004170: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00004180: 2274 7570 6c65 206f 6620 6c65 6e67 7468  "tuple of length
-00004190: 3d7b 6e7d 2c20 676f 7420 7b6c 656e 2876  ={n}, got {len(v
-000041a0: 616c 7565 297d 220a 2020 2020 2020 2020  alue)}".        
-000041b0: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-000041c0: 6620 4e6f 6e65 2069 6e20 7661 6c75 653a  f None in value:
-000041d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000041e0: 616e 7928 7620 6973 206e 6f74 204e 6f6e  any(v is not Non
-000041f0: 6520 666f 7220 7620 696e 2076 616c 7565  e for v in value
-00004200: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00004210: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00004220: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00004230: 2020 2020 2020 2020 2022 6469 7669 7369           "divisi
-00004240: 6f6e 7320 6d61 7920 6e6f 7420 636f 6e74  ons may not cont
-00004250: 6169 6e20 6120 6d69 7820 6f66 204e 6f6e  ain a mix of Non
-00004260: 6520 616e 6420 6e6f 6e2d 4e6f 6e65 2076  e and non-None v
-00004270: 616c 7565 7322 0a20 2020 2020 2020 2020  alues".         
-00004280: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00004290: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000042a0: 2020 2023 204b 6e6f 776e 2064 6976 6973     # Known divis
-000042b0: 696f 6e73 2c20 6368 6563 6b20 6d6f 6e6f  ions, check mono
-000042c0: 746f 6e69 6361 6c6c 7920 696e 6372 6561  tonically increa
-000042d0: 7369 6e67 0a0a 2020 2020 2020 2020 2020  sing..          
-000042e0: 2020 2320 5858 583a 2069 6620 7468 6520    # XXX: if the 
-000042f0: 696e 6465 7820 6474 7970 6520 6973 2061  index dtype is a
-00004300: 6e20 6f72 6465 7265 6420 6361 7465 676f  n ordered catego
-00004310: 7269 6361 6c20 6474 7970 652c 2074 6865  rical dtype, the
-00004320: 6e20 7765 2073 6b69 7020 7468 650a 2020  n we skip the.  
-00004330: 2020 2020 2020 2020 2020 2320 736f 7274            # sort
-00004340: 6564 6e65 7373 2063 6865 636b 2c20 7369  edness check, si
-00004350: 6e63 6520 7468 6520 6f72 6465 7220 6973  nce the order is
-00004360: 2064 7479 7065 2064 6570 656e 6465 6e74   dtype dependent
-00004370: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00004380: 6578 5f64 7479 7065 203d 2067 6574 6174  ex_dtype = getat
-00004390: 7472 2873 656c 662e 5f6d 6574 612c 2022  tr(self._meta, "
-000043a0: 696e 6465 7822 2c20 7365 6c66 2e5f 6d65  index", self._me
-000043b0: 7461 292e 6474 7970 650a 2020 2020 2020  ta).dtype.      
-000043c0: 2020 2020 2020 6966 206e 6f74 2028 0a20        if not (. 
-000043d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000043e0: 7369 6e73 7461 6e63 6528 696e 6465 785f  sinstance(index_
-000043f0: 6474 7970 652c 2070 642e 4361 7465 676f  dtype, pd.Catego
-00004400: 7269 6361 6c44 7479 7065 2920 616e 6420  ricalDtype) and 
-00004410: 696e 6465 785f 6474 7970 652e 6f72 6465  index_dtype.orde
-00004420: 7265 640a 2020 2020 2020 2020 2020 2020  red.            
-00004430: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00004440: 2020 2069 6620 7661 6c75 6520 213d 2074     if value != t
-00004450: 7570 6c65 2873 6f72 7465 6428 7661 6c75  uple(sorted(valu
-00004460: 6529 293a 0a20 2020 2020 2020 2020 2020  e)):.           
-00004470: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00004480: 616c 7565 4572 726f 7228 2264 6976 6973  alueError("divis
-00004490: 696f 6e73 206d 7573 7420 6265 2073 6f72  ions must be sor
-000044a0: 7465 6422 290a 0a20 2020 2020 2020 2073  ted")..        s
-000044b0: 656c 662e 5f64 6976 6973 696f 6e73 203d  elf._divisions =
-000044c0: 2076 616c 7565 0a0a 2020 2020 4070 726f   value..    @pro
-000044d0: 7065 7274 790a 2020 2020 6465 6620 6e70  perty.    def np
-000044e0: 6172 7469 7469 6f6e 7328 7365 6c66 2920  artitions(self) 
-000044f0: 2d3e 2069 6e74 3a0a 2020 2020 2020 2020  -> int:.        
-00004500: 2222 2252 6574 7572 6e20 6e75 6d62 6572  """Return number
-00004510: 206f 6620 7061 7274 6974 696f 6e73 2222   of partitions""
-00004520: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00004530: 206c 656e 2873 656c 662e 6469 7669 7369   len(self.divisi
-00004540: 6f6e 7329 202d 2031 0a0a 2020 2020 4070  ons) - 1..    @p
-00004550: 726f 7065 7274 790a 2020 2020 4064 6572  roperty.    @der
-00004560: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00004570: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00004580: 6174 7472 7328 7365 6c66 293a 0a20 2020  attrs(self):.   
-00004590: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000045a0: 2e5f 6d65 7461 2e61 7474 7273 0a0a 2020  ._meta.attrs..  
-000045b0: 2020 4061 7474 7273 2e73 6574 7465 720a    @attrs.setter.
-000045c0: 2020 2020 6465 6620 6174 7472 7328 7365      def attrs(se
-000045d0: 6c66 2c20 7661 6c75 6529 3a0a 2020 2020  lf, value):.    
-000045e0: 2020 2020 7365 6c66 2e5f 6d65 7461 2e61      self._meta.a
-000045f0: 7474 7273 203d 2064 6963 7428 7661 6c75  ttrs = dict(valu
-00004600: 6529 0a0a 2020 2020 4070 726f 7065 7274  e)..    @propert
-00004610: 790a 2020 2020 6465 6620 7369 7a65 2873  y.    def size(s
-00004620: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00004630: 2253 697a 6520 6f66 2074 6865 2053 6572  "Size of the Ser
-00004640: 6965 7320 6f72 2044 6174 6146 7261 6d65  ies or DataFrame
-00004650: 2061 7320 6120 4465 6c61 7965 6420 6f62   as a Delayed ob
-00004660: 6a65 6374 2e0a 0a20 2020 2020 2020 2045  ject...        E
-00004670: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-00004680: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00004690: 203e 3e3e 2073 6572 6965 732e 7369 7a65   >>> series.size
-000046a0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-000046b0: 4950 0a20 2020 2020 2020 2064 642e 5363  IP.        dd.Sc
-000046c0: 616c 6172 3c73 697a 652d 6167 2e2e 2e2c  alar<size-ag...,
-000046d0: 2064 7479 7065 3d69 6e74 3634 3e0a 2020   dtype=int64>.  
-000046e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000046f0: 2020 7265 7475 726e 2073 656c 662e 7265    return self.re
-00004700: 6475 6374 696f 6e28 0a20 2020 2020 2020  duction(.       
-00004710: 2020 2020 206d 6574 686f 6473 2e73 697a       methods.siz
-00004720: 652c 206e 702e 7375 6d2c 2074 6f6b 656e  e, np.sum, token
-00004730: 3d22 7369 7a65 222c 206d 6574 613d 696e  ="size", meta=in
-00004740: 742c 2073 706c 6974 5f65 7665 7279 3d46  t, split_every=F
-00004750: 616c 7365 0a20 2020 2020 2020 2029 0a0a  alse.        )..
-00004760: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00004770: 2020 6465 6620 5f6d 6574 615f 6e6f 6e65    def _meta_none
-00004780: 6d70 7479 2873 656c 6629 3a0a 2020 2020  mpty(self):.    
-00004790: 2020 2020 2222 2241 206e 6f6e 2d65 6d70      """A non-emp
-000047a0: 7479 2076 6572 7369 6f6e 206f 6620 605f  ty version of `_
-000047b0: 6d65 7461 6020 7769 7468 2066 616b 6520  meta` with fake 
-000047c0: 6461 7461 2e22 2222 0a20 2020 2020 2020  data.""".       
-000047d0: 2072 6574 7572 6e20 6d65 7461 5f6e 6f6e   return meta_non
-000047e0: 656d 7074 7928 7365 6c66 2e5f 6d65 7461  empty(self._meta
-000047f0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-00004800: 0a20 2020 2064 6566 205f 6172 6773 2873  .    def _args(s
-00004810: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00004820: 7475 726e 2028 7365 6c66 2e64 6173 6b2c  turn (self.dask,
-00004830: 2073 656c 662e 5f6e 616d 652c 2073 656c   self._name, sel
-00004840: 662e 5f6d 6574 612c 2073 656c 662e 6469  f._meta, self.di
-00004850: 7669 7369 6f6e 7329 0a0a 2020 2020 6465  visions)..    de
-00004860: 6620 5f5f 6765 7473 7461 7465 5f5f 2873  f __getstate__(s
-00004870: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00004880: 7475 726e 2073 656c 662e 5f61 7267 730a  turn self._args.
-00004890: 0a20 2020 2064 6566 205f 5f73 6574 7374  .    def __setst
-000048a0: 6174 655f 5f28 7365 6c66 2c20 7374 6174  ate__(self, stat
-000048b0: 6529 3a0a 2020 2020 2020 2020 7365 6c66  e):.        self
-000048c0: 2e64 6173 6b2c 2073 656c 662e 5f6e 616d  .dask, self._nam
-000048d0: 652c 2073 656c 662e 5f6d 6574 612c 2073  e, self._meta, s
-000048e0: 656c 662e 5f64 6976 6973 696f 6e73 203d  elf._divisions =
-000048f0: 2073 7461 7465 0a0a 2020 2020 6465 6620   state..    def 
-00004900: 636f 7079 2873 656c 662c 2064 6565 703d  copy(self, deep=
-00004910: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
-00004920: 2222 224d 616b 6520 6120 636f 7079 206f  """Make a copy o
-00004930: 6620 7468 6520 6461 7461 6672 616d 650a  f the dataframe.
-00004940: 0a20 2020 2020 2020 2054 6869 7320 6973  .        This is
-00004950: 2073 7472 6963 746c 7920 6120 7368 616c   strictly a shal
-00004960: 6c6f 7720 636f 7079 206f 6620 7468 6520  low copy of the 
-00004970: 756e 6465 726c 7969 6e67 2063 6f6d 7075  underlying compu
-00004980: 7461 7469 6f6e 616c 2067 7261 7068 2e0a  tational graph..
-00004990: 2020 2020 2020 2020 4974 2064 6f65 7320          It does 
-000049a0: 6e6f 7420 6166 6665 6374 2074 6865 2075  not affect the u
-000049b0: 6e64 6572 6c79 696e 6720 6461 7461 0a0a  nderlying data..
-000049c0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-000049d0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-000049e0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6465  -----.        de
-000049f0: 6570 203a 2062 6f6f 6c65 616e 2c20 6465  ep : boolean, de
-00004a00: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
-00004a10: 2020 2020 2020 2020 5468 6520 6465 6570          The deep
-00004a20: 2076 616c 7565 206d 7573 7420 6265 2060   value must be `
-00004a30: 4661 6c73 6560 2061 6e64 2069 7420 6973  False` and it is
-00004a40: 2064 6563 6c61 7265 6420 6173 2061 2070   declared as a p
-00004a50: 6172 616d 6574 6572 206a 7573 7420 666f  arameter just fo
-00004a60: 720a 2020 2020 2020 2020 2020 2020 636f  r.            co
-00004a70: 6d70 6174 6962 696c 6974 7920 7769 7468  mpatibility with
-00004a80: 2074 6869 7264 2d70 6172 7479 206c 6962   third-party lib
-00004a90: 7261 7269 6573 206c 696b 6520 6375 4446  raries like cuDF
-00004aa0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00004ab0: 2020 2020 2069 6620 6465 6570 2069 7320       if deep is 
-00004ac0: 6e6f 7420 4661 6c73 653a 0a20 2020 2020  not False:.     
-00004ad0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00004ae0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
-00004af0: 2020 2020 2020 2020 2022 5468 6520 6064           "The `d
-00004b00: 6565 7060 2076 616c 7565 206d 7573 7420  eep` value must 
-00004b10: 6265 2046 616c 7365 2e20 5468 6973 2069  be False. This i
-00004b20: 7320 7374 7269 6374 6c79 2061 2073 6861  s strictly a sha
-00004b30: 6c6c 6f77 2063 6f70 7920 220a 2020 2020  llow copy ".    
-00004b40: 2020 2020 2020 2020 2020 2020 226f 6620              "of 
-00004b50: 7468 6520 756e 6465 726c 7969 6e67 2063  the underlying c
-00004b60: 6f6d 7075 7461 7469 6f6e 616c 2067 7261  omputational gra
-00004b70: 7068 2e22 0a20 2020 2020 2020 2020 2020  ph.".           
-00004b80: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-00004b90: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
-00004ba0: 7365 6c66 2e64 6173 6b2c 2073 656c 662e  self.dask, self.
-00004bb0: 5f6e 616d 652c 2073 656c 662e 5f6d 6574  _name, self._met
-00004bc0: 612c 2073 656c 662e 6469 7669 7369 6f6e  a, self.division
-00004bd0: 7329 0a0a 2020 2020 6465 6620 5f5f 6172  s)..    def __ar
-00004be0: 7261 795f 5f28 7365 6c66 2c20 6474 7970  ray__(self, dtyp
-00004bf0: 653d 4e6f 6e65 2c20 2a2a 6b77 6172 6773  e=None, **kwargs
-00004c00: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-00004c10: 5f63 6f6d 7075 7465 6420 3d20 7365 6c66  _computed = self
-00004c20: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
-00004c30: 2020 2078 203d 206e 702e 6172 7261 7928     x = np.array(
-00004c40: 7365 6c66 2e5f 636f 6d70 7574 6564 290a  self._computed).
-00004c50: 2020 2020 2020 2020 7265 7475 726e 2078          return x
-00004c60: 0a0a 2020 2020 6465 6620 5f5f 6172 7261  ..    def __arra
-00004c70: 795f 7772 6170 5f5f 2873 656c 662c 2061  y_wrap__(self, a
-00004c80: 7272 6179 2c20 636f 6e74 6578 743d 4e6f  rray, context=No
-00004c90: 6e65 293a 0a20 2020 2020 2020 2072 6169  ne):.        rai
-00004ca0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-00004cb0: 6445 7272 6f72 0a0a 2020 2020 6465 6620  dError..    def 
-00004cc0: 5f5f 6172 7261 795f 7566 756e 635f 5f28  __array_ufunc__(
-00004cd0: 7365 6c66 2c20 6e75 6d70 795f 7566 756e  self, numpy_ufun
-00004ce0: 632c 206d 6574 686f 642c 202a 696e 7075  c, method, *inpu
-00004cf0: 7473 2c20 2a2a 6b77 6172 6773 293a 0a20  ts, **kwargs):. 
-00004d00: 2020 2020 2020 206f 7574 203d 206b 7761         out = kwa
-00004d10: 7267 732e 6765 7428 226f 7574 222c 2028  rgs.get("out", (
-00004d20: 2929 0a20 2020 2020 2020 2066 6f72 2078  )).        for x
-00004d30: 2069 6e20 696e 7075 7473 202b 206f 7574   in inputs + out
-00004d40: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-00004d50: 7566 756e 6373 2077 6f72 6b20 7769 7468  ufuncs work with
-00004d60: 2030 2d64 696d 656e 7369 6f6e 616c 204e   0-dimensional N
-00004d70: 756d 5079 206e 6461 7272 6179 730a 2020  umPy ndarrays.  
-00004d80: 2020 2020 2020 2020 2020 2320 736f 2077            # so w
-00004d90: 6520 646f 6e27 7420 7761 6e74 2074 6f20  e don't want to 
-00004da0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00004db0: 6e74 6564 0a20 2020 2020 2020 2020 2020  nted.           
-00004dc0: 2069 6620 6973 696e 7374 616e 6365 2878   if isinstance(x
-00004dd0: 2c20 6e70 2e6e 6461 7272 6179 2920 616e  , np.ndarray) an
-00004de0: 6420 782e 7368 6170 6520 3d3d 2028 293a  d x.shape == ():
-00004df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004e00: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
-00004e10: 2020 2020 2020 656c 6966 206e 6f74 2069        elif not i
-00004e20: 7369 6e73 7461 6e63 6528 0a20 2020 2020  sinstance(.     
-00004e30: 2020 2020 2020 2020 2020 2078 2c20 284e             x, (N
-00004e40: 756d 6265 722c 2053 6361 6c61 722c 205f  umber, Scalar, _
-00004e50: 4672 616d 652c 2041 7272 6179 2c20 7064  Frame, Array, pd
-00004e60: 2e44 6174 6146 7261 6d65 2c20 7064 2e53  .DataFrame, pd.S
-00004e70: 6572 6965 732c 2070 642e 496e 6465 7829  eries, pd.Index)
-00004e80: 0a20 2020 2020 2020 2020 2020 2029 3a0a  .            ):.
-00004e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ea0: 7265 7475 726e 204e 6f74 496d 706c 656d  return NotImplem
-00004eb0: 656e 7465 640a 0a20 2020 2020 2020 2069  ented..        i
-00004ec0: 6620 6d65 7468 6f64 203d 3d20 225f 5f63  f method == "__c
-00004ed0: 616c 6c5f 5f22 3a0a 2020 2020 2020 2020  all__":.        
-00004ee0: 2020 2020 6966 206e 756d 7079 5f75 6675      if numpy_ufu
-00004ef0: 6e63 2e73 6967 6e61 7475 7265 2069 7320  nc.signature is 
-00004f00: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00004f10: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00004f20: 204e 6f74 496d 706c 656d 656e 7465 640a   NotImplemented.
-00004f30: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00004f40: 756d 7079 5f75 6675 6e63 2e6e 6f75 7420  umpy_ufunc.nout 
-00004f50: 3e20 313a 0a20 2020 2020 2020 2020 2020  > 1:.           
-00004f60: 2020 2020 2023 2075 6675 6e63 7320 7769       # ufuncs wi
-00004f70: 7468 206d 756c 7469 706c 6520 6f75 7470  th multiple outp
-00004f80: 7574 2076 616c 7565 730a 2020 2020 2020  ut values.      
-00004f90: 2020 2020 2020 2020 2020 2320 6172 6520            # are 
-00004fa0: 6e6f 7420 7965 7420 7375 7070 6f72 7465  not yet supporte
-00004fb0: 6420 666f 7220 6672 616d 6573 0a20 2020  d for frames.   
-00004fc0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00004fd0: 7572 6e20 4e6f 7449 6d70 6c65 6d65 6e74  urn NotImplement
-00004fe0: 6564 0a20 2020 2020 2020 2020 2020 2065  ed.            e
-00004ff0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00005000: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
-00005010: 7769 7365 286e 756d 7079 5f75 6675 6e63  wise(numpy_ufunc
-00005020: 2c20 2a69 6e70 7574 732c 202a 2a6b 7761  , *inputs, **kwa
-00005030: 7267 7329 0a20 2020 2020 2020 2065 6c73  rgs).        els
-00005040: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
-00005050: 2075 6675 6e63 206d 6574 686f 6473 2061   ufunc methods a
-00005060: 7265 206e 6f74 2079 6574 2073 7570 706f  re not yet suppo
-00005070: 7274 6564 2066 6f72 2066 7261 6d65 730a  rted for frames.
-00005080: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00005090: 726e 204e 6f74 496d 706c 656d 656e 7465  rn NotImplemente
-000050a0: 640a 0a20 2020 2040 7072 6f70 6572 7479  d..    @property
-000050b0: 0a20 2020 2064 6566 205f 656c 656d 7769  .    def _elemwi
-000050c0: 7365 2873 656c 6629 3a0a 2020 2020 2020  se(self):.      
-000050d0: 2020 7265 7475 726e 2065 6c65 6d77 6973    return elemwis
-000050e0: 650a 0a20 2020 2064 6566 205f 7265 7072  e..    def _repr
-000050f0: 5f64 6174 6128 7365 6c66 293a 0a20 2020  _data(self):.   
-00005100: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-00005110: 706c 656d 656e 7465 6445 7272 6f72 0a0a  plementedError..
-00005120: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00005130: 2020 6465 6620 5f72 6570 725f 6469 7669    def _repr_divi
-00005140: 7369 6f6e 7328 7365 6c66 293a 0a20 2020  sions(self):.   
-00005150: 2020 2020 206e 616d 6520 3d20 6622 6e70       name = f"np
-00005160: 6172 7469 7469 6f6e 733d 7b73 656c 662e  artitions={self.
-00005170: 6e70 6172 7469 7469 6f6e 737d 220a 2020  npartitions}".  
-00005180: 2020 2020 2020 6966 2073 656c 662e 6b6e        if self.kn
-00005190: 6f77 6e5f 6469 7669 7369 6f6e 733a 0a20  own_divisions:. 
-000051a0: 2020 2020 2020 2020 2020 2064 6976 6973             divis
-000051b0: 696f 6e73 203d 2070 642e 496e 6465 7828  ions = pd.Index(
-000051c0: 7365 6c66 2e64 6976 6973 696f 6e73 2c20  self.divisions, 
-000051d0: 6e61 6d65 3d6e 616d 6529 0a20 2020 2020  name=name).     
-000051e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000051f0: 2020 2020 2023 2061 766f 6964 2074 6f20       # avoid to 
-00005200: 6265 2063 6f6e 7665 7274 6564 2074 6f20  be converted to 
-00005210: 4e61 4e0a 2020 2020 2020 2020 2020 2020  NaN.            
-00005220: 6469 7669 7369 6f6e 7320 3d20 7064 2e49  divisions = pd.I
-00005230: 6e64 6578 285b 2222 5d20 2a20 2873 656c  ndex([""] * (sel
-00005240: 662e 6e70 6172 7469 7469 6f6e 7320 2b20  f.npartitions + 
-00005250: 3129 2c20 6e61 6d65 3d6e 616d 6529 0a20  1), name=name). 
-00005260: 2020 2020 2020 2072 6574 7572 6e20 6469         return di
-00005270: 7669 7369 6f6e 730a 0a20 2020 2064 6566  visions..    def
-00005280: 205f 5f72 6570 725f 5f28 7365 6c66 293a   __repr__(self):
-00005290: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-000052a0: 7365 6c66 2e5f 7265 7072 5f64 6174 6128  self._repr_data(
-000052b0: 292e 746f 5f73 7472 696e 6728 6d61 785f  ).to_string(max_
-000052c0: 726f 7773 3d35 2c20 7368 6f77 5f64 696d  rows=5, show_dim
-000052d0: 656e 7369 6f6e 733d 4661 6c73 6529 0a20  ensions=False). 
-000052e0: 2020 2020 2020 205f 7374 725f 666d 7420         _str_fmt 
-000052f0: 3d20 2222 2244 6173 6b20 7b6b 6c61 7373  = """Dask {klass
-00005300: 7d20 5374 7275 6374 7572 653a 0a7b 6461  } Structure:.{da
-00005310: 7461 7d0a 4461 736b 204e 616d 653a 207b  ta}.Dask Name: {
-00005320: 6e61 6d65 7d2c 207b 6c61 7965 7273 7d22  name}, {layers}"
-00005330: 2222 0a20 2020 2020 2020 2069 6620 6c65  "".        if le
-00005340: 6e28 7365 6c66 2e63 6f6c 756d 6e73 2920  n(self.columns) 
-00005350: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00005360: 2020 6461 7461 203d 2064 6174 612e 7061    data = data.pa
-00005370: 7274 6974 696f 6e28 225c 6e22 295b 2d31  rtition("\n")[-1
-00005380: 5d2e 7265 706c 6163 6528 2249 6e64 6578  ].replace("Index
-00005390: 222c 2022 4469 7669 7369 6f6e 7322 290a  ", "Divisions").
-000053a0: 2020 2020 2020 2020 2020 2020 5f73 7472              _str
-000053b0: 5f66 6d74 203d 2066 2245 6d70 7479 207b  _fmt = f"Empty {
-000053c0: 5f73 7472 5f66 6d74 7d22 0a20 2020 2020  _str_fmt}".     
-000053d0: 2020 2072 6574 7572 6e20 5f73 7472 5f66     return _str_f
-000053e0: 6d74 2e66 6f72 6d61 7428 0a20 2020 2020  mt.format(.     
-000053f0: 2020 2020 2020 206b 6c61 7373 3d73 656c         klass=sel
-00005400: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
-00005410: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
-00005420: 2020 6461 7461 3d64 6174 612c 0a20 2020    data=data,.   
-00005430: 2020 2020 2020 2020 206e 616d 653d 6b65           name=ke
-00005440: 795f 7370 6c69 7428 7365 6c66 2e5f 6e61  y_split(self._na
-00005450: 6d65 292c 0a20 2020 2020 2020 2020 2020  me),.           
-00005460: 206c 6179 6572 733d 6d61 7962 655f 706c   layers=maybe_pl
-00005470: 7572 616c 697a 6528 6c65 6e28 7365 6c66  uralize(len(self
-00005480: 2e64 6173 6b2e 6c61 7965 7273 292c 2022  .dask.layers), "
-00005490: 6772 6170 6820 6c61 7965 7222 292c 0a20  graph layer"),. 
-000054a0: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
-000054b0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000054c0: 696e 6465 7828 7365 6c66 293a 0a20 2020  index(self):.   
-000054d0: 2020 2020 2022 2222 5265 7475 726e 2064       """Return d
-000054e0: 6173 6b20 496e 6465 7820 696e 7374 616e  ask Index instan
-000054f0: 6365 2222 220a 2020 2020 2020 2020 7265  ce""".        re
-00005500: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
-00005510: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-00005520: 2020 2020 2020 6765 7461 7474 722c 0a20        getattr,. 
-00005530: 2020 2020 2020 2020 2020 2022 696e 6465             "inde
-00005540: 7822 2c0a 2020 2020 2020 2020 2020 2020  x",.            
-00005550: 746f 6b65 6e3d 6b65 795f 7370 6c69 7428  token=key_split(
-00005560: 7365 6c66 2e5f 6e61 6d65 2920 2b20 222d  self._name) + "-
-00005570: 696e 6465 7822 2c0a 2020 2020 2020 2020  index",.        
-00005580: 2020 2020 6d65 7461 3d73 656c 662e 5f6d      meta=self._m
-00005590: 6574 612e 696e 6465 782c 0a20 2020 2020  eta.index,.     
-000055a0: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
-000055b0: 6574 6164 6174 613d 4661 6c73 652c 0a20  etadata=False,. 
-000055c0: 2020 2020 2020 2029 0a0a 2020 2020 4069         )..    @i
-000055d0: 6e64 6578 2e73 6574 7465 720a 2020 2020  ndex.setter.    
-000055e0: 6465 6620 696e 6465 7828 7365 6c66 2c20  def index(self, 
-000055f0: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
-00005600: 7365 6c66 2e64 6976 6973 696f 6e73 203d  self.divisions =
-00005610: 2076 616c 7565 2e64 6976 6973 696f 6e73   value.divisions
-00005620: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
-00005630: 3d20 6d61 705f 7061 7274 6974 696f 6e73  = map_partitions
-00005640: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
-00005650: 7468 6f64 732e 6173 7369 676e 5f69 6e64  thods.assign_ind
-00005660: 6578 2c20 7365 6c66 2c20 7661 6c75 652c  ex, self, value,
-00005670: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-00005680: 613d 4661 6c73 650a 2020 2020 2020 2020  a=False.        
-00005690: 290a 2020 2020 2020 2020 7365 6c66 2e64  ).        self.d
-000056a0: 6173 6b20 3d20 7265 7375 6c74 2e64 6173  ask = result.das
-000056b0: 6b0a 2020 2020 2020 2020 7365 6c66 2e5f  k.        self._
-000056c0: 6e61 6d65 203d 2072 6573 756c 742e 5f6e  name = result._n
-000056d0: 616d 650a 2020 2020 2020 2020 7365 6c66  ame.        self
-000056e0: 2e5f 6d65 7461 203d 2072 6573 756c 742e  ._meta = result.
-000056f0: 5f6d 6574 610a 0a20 2020 2064 6566 2072  _meta..    def r
-00005700: 6573 6574 5f69 6e64 6578 2873 656c 662c  eset_index(self,
-00005710: 2064 726f 703d 4661 6c73 6529 3a0a 2020   drop=False):.  
-00005720: 2020 2020 2020 2222 2252 6573 6574 2074        """Reset t
-00005730: 6865 2069 6e64 6578 2074 6f20 7468 6520  he index to the 
-00005740: 6465 6661 756c 7420 696e 6465 782e 0a0a  default index...
-00005750: 2020 2020 2020 2020 4e6f 7465 2074 6861          Note tha
-00005760: 7420 756e 6c69 6b65 2069 6e20 6060 7061  t unlike in ``pa
-00005770: 6e64 6173 6060 2c20 7468 6520 7265 7365  ndas``, the rese
-00005780: 7420 6060 6461 736b 2e64 6174 6166 7261  t ``dask.datafra
-00005790: 6d65 6060 2069 6e64 6578 2077 696c 6c0a  me`` index will.
-000057a0: 2020 2020 2020 2020 6e6f 7420 6265 206d          not be m
-000057b0: 6f6e 6f74 6f6e 6963 616c 6c79 2069 6e63  onotonically inc
-000057c0: 7265 6173 696e 6720 6672 6f6d 2030 2e20  reasing from 0. 
-000057d0: 496e 7374 6561 642c 2069 7420 7769 6c6c  Instead, it will
-000057e0: 2072 6573 7461 7274 2061 7420 300a 2020   restart at 0.  
-000057f0: 2020 2020 2020 666f 7220 6561 6368 2070        for each p
-00005800: 6172 7469 7469 6f6e 2028 652e 672e 2060  artition (e.g. `
-00005810: 6069 6e64 6578 3120 3d20 5b30 2c20 2e2e  `index1 = [0, ..
-00005820: 2e2c 2031 305d 2c20 696e 6465 7832 203d  ., 10], index2 =
-00005830: 205b 302c 202e 2e2e 5d60 6029 2e0a 2020   [0, ...]``)..  
-00005840: 2020 2020 2020 5468 6973 2069 7320 6475        This is du
-00005850: 6520 746f 2074 6865 2069 6e61 6269 6c69  e to the inabili
-00005860: 7479 2074 6f20 7374 6174 6963 616c 6c79  ty to statically
-00005870: 206b 6e6f 7720 7468 6520 6675 6c6c 206c   know the full l
-00005880: 656e 6774 6820 6f66 2074 6865 0a20 2020  ength of the.   
-00005890: 2020 2020 2069 6e64 6578 2e0a 0a20 2020       index...   
-000058a0: 2020 2020 2046 6f72 2044 6174 6146 7261       For DataFra
-000058b0: 6d65 2077 6974 6820 6d75 6c74 692d 6c65  me with multi-le
-000058c0: 7665 6c20 696e 6465 782c 2072 6574 7572  vel index, retur
-000058d0: 6e73 2061 206e 6577 2044 6174 6146 7261  ns a new DataFra
-000058e0: 6d65 2077 6974 680a 2020 2020 2020 2020  me with.        
-000058f0: 6c61 6265 6c69 6e67 2069 6e66 6f72 6d61  labeling informa
-00005900: 7469 6f6e 2069 6e20 7468 6520 636f 6c75  tion in the colu
-00005910: 6d6e 7320 756e 6465 7220 7468 6520 696e  mns under the in
-00005920: 6465 7820 6e61 6d65 732c 2064 6566 6175  dex names, defau
-00005930: 6c74 696e 670a 2020 2020 2020 2020 746f  lting.        to
-00005940: 2027 6c65 7665 6c5f 3027 2c20 276c 6576   'level_0', 'lev
-00005950: 656c 5f31 272c 2065 7463 2e20 6966 2061  el_1', etc. if a
-00005960: 6e79 2061 7265 204e 6f6e 652e 2046 6f72  ny are None. For
-00005970: 2061 2073 7461 6e64 6172 6420 696e 6465   a standard inde
-00005980: 782c 0a20 2020 2020 2020 2074 6865 2069  x,.        the i
-00005990: 6e64 6578 206e 616d 6520 7769 6c6c 2062  ndex name will b
-000059a0: 6520 7573 6564 2028 6966 2073 6574 292c  e used (if set),
-000059b0: 206f 7468 6572 7769 7365 2061 2064 6566   otherwise a def
-000059c0: 6175 6c74 2027 696e 6465 7827 206f 720a  ault 'index' or.
-000059d0: 2020 2020 2020 2020 276c 6576 656c 5f30          'level_0
-000059e0: 2720 2869 6620 2769 6e64 6578 2720 6973  ' (if 'index' is
-000059f0: 2061 6c72 6561 6479 2074 616b 656e 2920   already taken) 
-00005a00: 7769 6c6c 2062 6520 7573 6564 2e0a 0a20  will be used... 
-00005a10: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00005a20: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00005a30: 2d2d 2d2d 0a20 2020 2020 2020 2064 726f  ----.        dro
-00005a40: 7020 3a20 626f 6f6c 6561 6e2c 2064 6566  p : boolean, def
-00005a50: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
-00005a60: 2020 2020 2020 2044 6f20 6e6f 7420 7472         Do not tr
-00005a70: 7920 746f 2069 6e73 6572 7420 696e 6465  y to insert inde
-00005a80: 7820 696e 746f 2064 6174 6166 7261 6d65  x into dataframe
-00005a90: 2063 6f6c 756d 6e73 2e0a 2020 2020 2020   columns..      
-00005aa0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-00005ab0: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
-00005ac0: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-00005ad0: 2020 2020 2020 4d2e 7265 7365 745f 696e        M.reset_in
-00005ae0: 6465 782c 2064 726f 703d 6472 6f70 2c20  dex, drop=drop, 
-00005af0: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-00005b00: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
-00005b10: 2e63 6c65 6172 5f64 6976 6973 696f 6e73  .clear_divisions
-00005b20: 2829 0a0a 2020 2020 4070 726f 7065 7274  ()..    @propert
-00005b30: 790a 2020 2020 6465 6620 6b6e 6f77 6e5f  y.    def known_
-00005b40: 6469 7669 7369 6f6e 7328 7365 6c66 293a  divisions(self):
-00005b50: 0a20 2020 2020 2020 2022 2222 5768 6574  .        """Whet
-00005b60: 6865 7220 6469 7669 7369 6f6e 7320 6172  her divisions ar
-00005b70: 6520 616c 7265 6164 7920 6b6e 6f77 6e22  e already known"
-00005b80: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00005b90: 6e20 6c65 6e28 7365 6c66 2e64 6976 6973  n len(self.divis
-00005ba0: 696f 6e73 2920 3e20 3020 616e 6420 7365  ions) > 0 and se
-00005bb0: 6c66 2e64 6976 6973 696f 6e73 5b30 5d20  lf.divisions[0] 
-00005bc0: 6973 206e 6f74 204e 6f6e 650a 0a20 2020  is not None..   
-00005bd0: 2064 6566 2063 6c65 6172 5f64 6976 6973   def clear_divis
-00005be0: 696f 6e73 2873 656c 6629 3a0a 2020 2020  ions(self):.    
-00005bf0: 2020 2020 2222 2246 6f72 6765 7420 6469      """Forget di
-00005c00: 7669 7369 6f6e 2069 6e66 6f72 6d61 7469  vision informati
-00005c10: 6f6e 2222 220a 2020 2020 2020 2020 6469  on""".        di
-00005c20: 7669 7369 6f6e 7320 3d20 284e 6f6e 652c  visions = (None,
-00005c30: 2920 2a20 2873 656c 662e 6e70 6172 7469  ) * (self.nparti
-00005c40: 7469 6f6e 7320 2b20 3129 0a20 2020 2020  tions + 1).     
-00005c50: 2020 2072 6574 7572 6e20 7479 7065 2873     return type(s
-00005c60: 656c 6629 2873 656c 662e 6461 736b 2c20  elf)(self.dask, 
-00005c70: 7365 6c66 2e5f 6e61 6d65 2c20 7365 6c66  self._name, self
-00005c80: 2e5f 6d65 7461 2c20 6469 7669 7369 6f6e  ._meta, division
-00005c90: 7329 0a0a 2020 2020 6465 6620 636f 6d70  s)..    def comp
-00005ca0: 7574 655f 6375 7272 656e 745f 6469 7669  ute_current_divi
-00005cb0: 7369 6f6e 7328 7365 6c66 2c20 636f 6c3d  sions(self, col=
-00005cc0: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
-00005cd0: 2222 436f 6d70 7574 6520 7468 6520 6375  ""Compute the cu
-00005ce0: 7272 656e 7420 6469 7669 7369 6f6e 7320  rrent divisions 
-00005cf0: 6f66 2074 6865 2044 6174 6146 7261 6d65  of the DataFrame
-00005d00: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
-00005d10: 6d65 7468 6f64 2074 7269 6767 6572 7320  method triggers 
-00005d20: 696d 6d65 6469 6174 6520 636f 6d70 7574  immediate comput
-00005d30: 6174 696f 6e2e 2049 6620 796f 7520 6669  ation. If you fi
-00005d40: 6e64 2079 6f75 7273 656c 6620 7275 6e6e  nd yourself runn
-00005d50: 696e 6720 7468 6973 2063 6f6d 6d61 6e64  ing this command
-00005d60: 0a20 2020 2020 2020 2072 6570 6561 7465  .        repeate
-00005d70: 646c 7920 666f 7220 7468 6520 7361 6d65  dly for the same
-00005d80: 2064 6174 6166 7261 6d65 2c20 7765 2072   dataframe, we r
-00005d90: 6563 6f6d 6d65 6e64 2073 746f 7269 6e67  ecommend storing
-00005da0: 2074 6865 2072 6573 756c 740a 2020 2020   the result.    
-00005db0: 2020 2020 736f 2079 6f75 2064 6f6e 2774      so you don't
-00005dc0: 2068 6176 6520 746f 2072 6572 756e 2069   have to rerun i
-00005dd0: 742e 0a0a 2020 2020 2020 2020 4966 2074  t...        If t
-00005de0: 6865 2063 6f6c 756d 6e20 6f72 2069 6e64  he column or ind
-00005df0: 6578 2076 616c 7565 7320 6f76 6572 6c61  ex values overla
-00005e00: 7020 6265 7477 6565 6e20 7061 7274 6974  p between partit
-00005e10: 696f 6e73 2c20 7261 6973 6573 2060 6056  ions, raises ``V
-00005e20: 616c 7565 4572 726f 7260 602e 0a20 2020  alueError``..   
-00005e30: 2020 2020 2054 6f20 7072 6576 656e 7420       To prevent 
-00005e40: 7468 6973 2c20 6d61 6b65 2073 7572 6520  this, make sure 
-00005e50: 7468 6520 6461 7461 2061 7265 2073 6f72  the data are sor
-00005e60: 7465 6420 6279 2074 6865 2063 6f6c 756d  ted by the colum
-00005e70: 6e20 6f72 2069 6e64 6578 2e0a 0a20 2020  n or index...   
-00005e80: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00005e90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00005ea0: 2d2d 0a20 2020 2020 2020 2063 6f6c 203a  --.        col :
-00005eb0: 2073 7472 696e 672c 206f 7074 696f 6e61   string, optiona
-00005ec0: 6c0a 2020 2020 2020 2020 2020 2020 4361  l.            Ca
-00005ed0: 6c63 756c 6174 6520 7468 6520 6469 7669  lculate the divi
-00005ee0: 7369 6f6e 7320 666f 7220 6120 6e6f 6e2d  sions for a non-
-00005ef0: 696e 6465 7820 636f 6c75 6d6e 2062 7920  index column by 
-00005f00: 7061 7373 696e 6720 696e 2074 6865 206e  passing in the n
-00005f10: 616d 6520 6f66 2074 6865 2063 6f6c 756d  ame of the colum
-00005f20: 6e2e 0a20 2020 2020 2020 2020 2020 2049  n..            I
-00005f30: 6620 636f 6c20 6973 206e 6f74 2073 7065  f col is not spe
-00005f40: 6369 6669 6564 2c20 7468 6520 696e 6465  cified, the inde
-00005f50: 7820 7769 6c6c 2062 6520 7573 6564 2074  x will be used t
-00005f60: 6f20 6361 6c63 756c 6174 6520 6469 7669  o calculate divi
-00005f70: 7369 6f6e 732e 0a20 2020 2020 2020 2020  sions..         
-00005f80: 2020 2049 6e20 7468 6973 2063 6173 652c     In this case,
-00005f90: 2069 6620 7468 6520 6469 7669 7369 6f6e   if the division
-00005fa0: 7320 6172 6520 616c 7265 6164 7920 6b6e  s are already kn
-00005fb0: 6f77 6e2c 2074 6865 7920 7769 6c6c 2062  own, they will b
-00005fc0: 6520 7265 7475 726e 6564 0a20 2020 2020  e returned.     
-00005fd0: 2020 2020 2020 2069 6d6d 6564 6961 7465         immediate
-00005fe0: 6c79 2077 6974 686f 7574 2063 6f6d 7075  ly without compu
-00005ff0: 7469 6e67 2e0a 0a20 2020 2020 2020 2045  ting...        E
-00006000: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-00006010: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00006020: 203e 3e3e 2069 6d70 6f72 7420 6461 736b   >>> import dask
-00006030: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
-00006040: 203d 2064 6173 6b2e 6461 7461 7365 7473   = dask.datasets
-00006050: 2e74 696d 6573 6572 6965 7328 7374 6172  .timeseries(star
-00006060: 743d 2232 3032 312d 3031 2d30 3122 2c20  t="2021-01-01", 
-00006070: 656e 643d 2232 3032 312d 3031 2d30 3722  end="2021-01-07"
-00006080: 2c20 6672 6571 3d22 3148 2229 2e63 6c65  , freq="1H").cle
-00006090: 6172 5f64 6976 6973 696f 6e73 2829 0a20  ar_divisions(). 
-000060a0: 2020 2020 2020 203e 3e3e 2064 6976 6973         >>> divis
-000060b0: 696f 6e73 203d 2064 6466 2e63 6f6d 7075  ions = ddf.compu
-000060c0: 7465 5f63 7572 7265 6e74 5f64 6976 6973  te_current_divis
-000060d0: 696f 6e73 2829 0a20 2020 2020 2020 203e  ions().        >
-000060e0: 3e3e 2070 7269 6e74 2864 6976 6973 696f  >> print(divisio
-000060f0: 6e73 2920 2023 2064 6f63 7465 7374 3a20  ns)  # doctest: 
-00006100: 2b4e 4f52 4d41 4c49 5a45 5f57 4849 5445  +NORMALIZE_WHITE
-00006110: 5350 4143 450a 2020 2020 2020 2020 2854  SPACE.        (T
-00006120: 696d 6573 7461 6d70 2827 3230 3231 2d30  imestamp('2021-0
-00006130: 312d 3031 2030 303a 3030 3a30 3027 292c  1-01 00:00:00'),
-00006140: 0a20 2020 2020 2020 2020 5469 6d65 7374  .         Timest
-00006150: 616d 7028 2732 3032 312d 3031 2d30 3220  amp('2021-01-02 
-00006160: 3030 3a30 303a 3030 2729 2c0a 2020 2020  00:00:00'),.    
-00006170: 2020 2020 2054 696d 6573 7461 6d70 2827       Timestamp('
-00006180: 3230 3231 2d30 312d 3033 2030 303a 3030  2021-01-03 00:00
-00006190: 3a30 3027 292c 0a20 2020 2020 2020 2020  :00'),.         
-000061a0: 5469 6d65 7374 616d 7028 2732 3032 312d  Timestamp('2021-
-000061b0: 3031 2d30 3420 3030 3a30 303a 3030 2729  01-04 00:00:00')
-000061c0: 2c0a 2020 2020 2020 2020 2054 696d 6573  ,.         Times
-000061d0: 7461 6d70 2827 3230 3231 2d30 312d 3035  tamp('2021-01-05
-000061e0: 2030 303a 3030 3a30 3027 292c 0a20 2020   00:00:00'),.   
-000061f0: 2020 2020 2020 5469 6d65 7374 616d 7028        Timestamp(
-00006200: 2732 3032 312d 3031 2d30 3620 3030 3a30  '2021-01-06 00:0
-00006210: 303a 3030 2729 2c0a 2020 2020 2020 2020  0:00'),.        
-00006220: 2054 696d 6573 7461 6d70 2827 3230 3231   Timestamp('2021
-00006230: 2d30 312d 3036 2032 333a 3030 3a30 3027  -01-06 23:00:00'
-00006240: 2929 0a0a 2020 2020 2020 2020 3e3e 3e20  ))..        >>> 
-00006250: 6464 662e 6469 7669 7369 6f6e 7320 3d20  ddf.divisions = 
-00006260: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
-00006270: 2020 3e3e 3e20 6464 662e 6b6e 6f77 6e5f    >>> ddf.known_
-00006280: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
-00006290: 2020 5472 7565 0a0a 2020 2020 2020 2020    True..        
-000062a0: 3e3e 3e20 6464 6620 3d20 6464 662e 7265  >>> ddf = ddf.re
-000062b0: 7365 745f 696e 6465 7828 292e 636c 6561  set_index().clea
-000062c0: 725f 6469 7669 7369 6f6e 7328 290a 2020  r_divisions().  
-000062d0: 2020 2020 2020 3e3e 3e20 6469 7669 7369        >>> divisi
-000062e0: 6f6e 7320 3d20 6464 662e 636f 6d70 7574  ons = ddf.comput
-000062f0: 655f 6375 7272 656e 745f 6469 7669 7369  e_current_divisi
-00006300: 6f6e 7328 2274 696d 6573 7461 6d70 2229  ons("timestamp")
-00006310: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00006320: 6e74 2864 6976 6973 696f 6e73 2920 2023  nt(divisions)  #
-00006330: 2064 6f63 7465 7374 3a20 2b4e 4f52 4d41   doctest: +NORMA
-00006340: 4c49 5a45 5f57 4849 5445 5350 4143 450a  LIZE_WHITESPACE.
-00006350: 2020 2020 2020 2020 2854 696d 6573 7461          (Timesta
-00006360: 6d70 2827 3230 3231 2d30 312d 3031 2030  mp('2021-01-01 0
-00006370: 303a 3030 3a30 3027 292c 0a20 2020 2020  0:00:00'),.     
-00006380: 2020 2020 5469 6d65 7374 616d 7028 2732      Timestamp('2
-00006390: 3032 312d 3031 2d30 3220 3030 3a30 303a  021-01-02 00:00:
-000063a0: 3030 2729 2c0a 2020 2020 2020 2020 2054  00'),.         T
-000063b0: 696d 6573 7461 6d70 2827 3230 3231 2d30  imestamp('2021-0
-000063c0: 312d 3033 2030 303a 3030 3a30 3027 292c  1-03 00:00:00'),
-000063d0: 0a20 2020 2020 2020 2020 5469 6d65 7374  .         Timest
-000063e0: 616d 7028 2732 3032 312d 3031 2d30 3420  amp('2021-01-04 
-000063f0: 3030 3a30 303a 3030 2729 2c0a 2020 2020  00:00:00'),.    
-00006400: 2020 2020 2054 696d 6573 7461 6d70 2827       Timestamp('
-00006410: 3230 3231 2d30 312d 3035 2030 303a 3030  2021-01-05 00:00
-00006420: 3a30 3027 292c 0a20 2020 2020 2020 2020  :00'),.         
-00006430: 5469 6d65 7374 616d 7028 2732 3032 312d  Timestamp('2021-
-00006440: 3031 2d30 3620 3030 3a30 303a 3030 2729  01-06 00:00:00')
-00006450: 2c0a 2020 2020 2020 2020 2054 696d 6573  ,.         Times
-00006460: 7461 6d70 2827 3230 3231 2d30 312d 3036  tamp('2021-01-06
-00006470: 2032 333a 3030 3a30 3027 2929 0a0a 2020   23:00:00'))..  
-00006480: 2020 2020 2020 3e3e 3e20 6464 6620 3d20        >>> ddf = 
-00006490: 6464 662e 7365 745f 696e 6465 7828 2274  ddf.set_index("t
-000064a0: 696d 6573 7461 6d70 222c 2064 6976 6973  imestamp", divis
-000064b0: 696f 6e73 3d64 6976 6973 696f 6e73 2c20  ions=divisions, 
-000064c0: 736f 7274 6564 3d54 7275 6529 0a20 2020  sorted=True).   
-000064d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000064e0: 2069 6620 636f 6c20 6973 204e 6f6e 6520   if col is None 
-000064f0: 616e 6420 7365 6c66 2e6b 6e6f 776e 5f64  and self.known_d
-00006500: 6976 6973 696f 6e73 3a0a 2020 2020 2020  ivisions:.      
-00006510: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00006520: 662e 6469 7669 7369 6f6e 730a 0a20 2020  f.divisions..   
-00006530: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-00006540: 6174 6166 7261 6d65 2e73 6875 6666 6c65  ataframe.shuffle
-00006550: 2069 6d70 6f72 7420 636f 6d70 7574 655f   import compute_
-00006560: 6469 7669 7369 6f6e 730a 0a20 2020 2020  divisions..     
-00006570: 2020 2072 6574 7572 6e20 636f 6d70 7574     return comput
-00006580: 655f 6469 7669 7369 6f6e 7328 7365 6c66  e_divisions(self
-00006590: 2c20 636f 6c3d 636f 6c29 0a0a 2020 2020  , col=col)..    
-000065a0: 6465 6620 6765 745f 7061 7274 6974 696f  def get_partitio
-000065b0: 6e28 7365 6c66 2c20 6e29 3a0a 2020 2020  n(self, n):.    
-000065c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000065d0: 4765 7420 6120 6461 736b 2044 6174 6146  Get a dask DataF
-000065e0: 7261 6d65 2f53 6572 6965 7320 7265 7072  rame/Series repr
-000065f0: 6573 656e 7469 6e67 2074 6865 2060 6e74  esenting the `nt
-00006600: 6860 2070 6172 7469 7469 6f6e 2e0a 0a20  h` partition... 
-00006610: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00006620: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00006630: 2d2d 2d2d 0a20 2020 2020 2020 206e 203a  ----.        n :
-00006640: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
-00006650: 2054 6865 2030 2d69 6e64 6578 6564 2070   The 0-indexed p
-00006660: 6172 7469 7469 6f6e 206e 756d 6265 7220  artition number 
-00006670: 746f 2073 656c 6563 742e 0a0a 2020 2020  to select...    
-00006680: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-00006690: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-000066a0: 2020 2020 4461 736b 2044 6174 6146 7261      Dask DataFra
-000066b0: 6d65 206f 7220 5365 7269 6573 0a20 2020  me or Series.   
-000066c0: 2020 2020 2020 2020 2054 6865 2073 616d           The sam
-000066d0: 6520 7479 7065 2061 7320 7468 6520 6f72  e type as the or
-000066e0: 6967 696e 616c 206f 626a 6563 742e 0a0a  iginal object...
-000066f0: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-00006700: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00006710: 2d0a 2020 2020 2020 2020 3e3e 3e20 696d  -.        >>> im
-00006720: 706f 7274 2064 6173 6b0a 2020 2020 2020  port dask.      
-00006730: 2020 3e3e 3e20 6464 6620 3d20 6461 736b    >>> ddf = dask
-00006740: 2e64 6174 6173 6574 732e 7469 6d65 7365  .datasets.timese
-00006750: 7269 6573 2873 7461 7274 3d22 3230 3231  ries(start="2021
-00006760: 2d30 312d 3031 222c 2065 6e64 3d22 3230  -01-01", end="20
-00006770: 3231 2d30 312d 3037 222c 2066 7265 713d  21-01-07", freq=
-00006780: 2231 4822 290a 2020 2020 2020 2020 3e3e  "1H").        >>
-00006790: 3e20 6464 662e 6765 745f 7061 7274 6974  > ddf.get_partit
-000067a0: 696f 6e28 3029 2020 2320 646f 6374 6573  ion(0)  # doctes
-000067b0: 743a 202b 4e4f 524d 414c 495a 455f 5748  t: +NORMALIZE_WH
-000067c0: 4954 4553 5041 4345 0a20 2020 2020 2020  ITESPACE.       
-000067d0: 2044 6173 6b20 4461 7461 4672 616d 6520   Dask DataFrame 
-000067e0: 5374 7275 6374 7572 653a 0a20 2020 2020  Structure:.     
-000067f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006800: 2020 2020 6e61 6d65 2020 2020 2069 6420      name     id 
-00006810: 2020 2020 2020 2078 2020 2020 2020 2020         x        
-00006820: 790a 2020 2020 2020 2020 6e70 6172 7469  y.        nparti
-00006830: 7469 6f6e 733d 310a 2020 2020 2020 2020  tions=1.        
-00006840: 3230 3231 2d30 312d 3031 2020 2020 206f  2021-01-01     o
-00006850: 626a 6563 7420 2069 6e74 3634 2020 666c  bject  int64  fl
-00006860: 6f61 7436 3420 2066 6c6f 6174 3634 0a20  oat64  float64. 
-00006870: 2020 2020 2020 2032 3032 312d 3031 2d30         2021-01-0
-00006880: 3220 2020 2020 2020 202e 2e2e 2020 2020  2        ...    
-00006890: 2e2e 2e20 2020 2020 202e 2e2e 2020 2020  ...      ...    
-000068a0: 2020 2e2e 2e0a 2020 2020 2020 2020 4461    ....        Da
-000068b0: 736b 204e 616d 653a 2067 6574 2d70 6172  sk Name: get-par
-000068c0: 7469 7469 6f6e 2c20 3220 6772 6170 6820  tition, 2 graph 
-000068d0: 6c61 7965 7273 0a0a 2020 2020 2020 2020  layers..        
-000068e0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-000068f0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00006900: 2020 4461 7461 4672 616d 652e 7061 7274    DataFrame.part
-00006910: 6974 696f 6e73 0a20 2020 2020 2020 2022  itions.        "
-00006920: 2222 0a20 2020 2020 2020 2069 6620 3020  "".        if 0 
-00006930: 3c3d 206e 203c 2073 656c 662e 6e70 6172  <= n < self.npar
-00006940: 7469 7469 6f6e 733a 0a20 2020 2020 2020  titions:.       
-00006950: 2020 2020 206e 616d 6520 3d20 6622 6765       name = f"ge
-00006960: 742d 7061 7274 6974 696f 6e2d 7b73 7472  t-partition-{str
-00006970: 286e 297d 2d7b 7365 6c66 2e5f 6e61 6d65  (n)}-{self._name
-00006980: 7d22 0a20 2020 2020 2020 2020 2020 2064  }".            d
-00006990: 6976 6973 696f 6e73 203d 2073 656c 662e  ivisions = self.
-000069a0: 6469 7669 7369 6f6e 735b 6e20 3a20 6e20  divisions[n : n 
-000069b0: 2b20 325d 0a20 2020 2020 2020 2020 2020  + 2].           
-000069c0: 206c 6179 6572 203d 207b 286e 616d 652c   layer = {(name,
-000069d0: 2030 293a 2028 7365 6c66 2e5f 6e61 6d65   0): (self._name
-000069e0: 2c20 6e29 7d0a 2020 2020 2020 2020 2020  , n)}.          
-000069f0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-00006a00: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-00006a10: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
-00006a20: 6c61 7965 722c 2064 6570 656e 6465 6e63  layer, dependenc
-00006a30: 6965 733d 5b73 656c 665d 290a 2020 2020  ies=[self]).    
-00006a40: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-00006a50: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
-00006a60: 7068 2c20 6e61 6d65 2c20 7365 6c66 2e5f  ph, name, self._
-00006a70: 6d65 7461 2c20 6469 7669 7369 6f6e 7329  meta, divisions)
-00006a80: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00006a90: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
-00006aa0: 2066 226e 206d 7573 7420 6265 2030 203c   f"n must be 0 <
-00006ab0: 3d20 6e20 3c20 7b73 656c 662e 6e70 6172  = n < {self.npar
-00006ac0: 7469 7469 6f6e 737d 220a 2020 2020 2020  titions}".      
-00006ad0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00006ae0: 6545 7272 6f72 286d 7367 290a 0a20 2020  eError(msg)..   
-00006af0: 2040 6465 7269 7665 645f 6672 6f6d 280a   @derived_from(.
-00006b00: 2020 2020 2020 2020 7064 2e44 6174 6146          pd.DataF
-00006b10: 7261 6d65 2c0a 2020 2020 2020 2020 696e  rame,.        in
-00006b20: 636f 6e73 6973 7465 6e63 6965 733d 226b  consistencies="k
-00006b30: 6565 703d 4661 6c73 6520 7769 6c6c 2072  eep=False will r
-00006b40: 6169 7365 2061 2060 604e 6f74 496d 706c  aise a ``NotImpl
-00006b50: 656d 656e 7465 6445 7272 6f72 6060 222c  ementedError``",
-00006b60: 0a20 2020 2029 0a20 2020 2064 6566 2064  .    ).    def d
-00006b70: 726f 705f 6475 706c 6963 6174 6573 280a  rop_duplicates(.
-00006b80: 2020 2020 2020 2020 7365 6c66 2c20 7375          self, su
-00006b90: 6273 6574 3d4e 6f6e 652c 2073 706c 6974  bset=None, split
-00006ba0: 5f65 7665 7279 3d4e 6f6e 652c 2073 706c  _every=None, spl
-00006bb0: 6974 5f6f 7574 3d31 2c20 6967 6e6f 7265  it_out=1, ignore
-00006bc0: 5f69 6e64 6578 3d46 616c 7365 2c20 2a2a  _index=False, **
-00006bd0: 6b77 6172 6773 0a20 2020 2029 3a0a 2020  kwargs.    ):.  
-00006be0: 2020 2020 2020 6966 2073 7562 7365 7420        if subset 
-00006bf0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00006c00: 2020 2020 2020 2020 2023 204c 6574 2070           # Let p
-00006c10: 616e 6461 7320 6572 726f 7220 6f6e 2062  andas error on b
-00006c20: 6164 2069 6e70 7574 730a 2020 2020 2020  ad inputs.      
-00006c30: 2020 2020 2020 7365 6c66 2e5f 6d65 7461        self._meta
-00006c40: 5f6e 6f6e 656d 7074 792e 6472 6f70 5f64  _nonempty.drop_d
-00006c50: 7570 6c69 6361 7465 7328 7375 6273 6574  uplicates(subset
-00006c60: 3d73 7562 7365 742c 202a 2a6b 7761 7267  =subset, **kwarg
-00006c70: 7329 0a20 2020 2020 2020 2020 2020 206b  s).            k
-00006c80: 7761 7267 735b 2273 7562 7365 7422 5d20  wargs["subset"] 
-00006c90: 3d20 7375 6273 6574 0a20 2020 2020 2020  = subset.       
-00006ca0: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
-00006cb0: 6574 7570 203d 2073 706c 6974 5f6f 7574  etup = split_out
-00006cc0: 5f6f 6e5f 636f 6c73 0a20 2020 2020 2020  _on_cols.       
-00006cd0: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
-00006ce0: 6574 7570 5f6b 7761 7267 7320 3d20 7b22  etup_kwargs = {"
-00006cf0: 636f 6c73 223a 2073 7562 7365 747d 0a20  cols": subset}. 
-00006d00: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00006d10: 2020 2020 2020 2020 2073 656c 662e 5f6d           self._m
-00006d20: 6574 615f 6e6f 6e65 6d70 7479 2e64 726f  eta_nonempty.dro
-00006d30: 705f 6475 706c 6963 6174 6573 282a 2a6b  p_duplicates(**k
-00006d40: 7761 7267 7329 0a20 2020 2020 2020 2020  wargs).         
-00006d50: 2020 2073 706c 6974 5f6f 7574 5f73 6574     split_out_set
-00006d60: 7570 203d 2073 706c 6974 5f6f 7574 5f73  up = split_out_s
-00006d70: 6574 7570 5f6b 7761 7267 7320 3d20 4e6f  etup_kwargs = No
-00006d80: 6e65 0a0a 2020 2020 2020 2020 6966 206b  ne..        if k
-00006d90: 7761 7267 732e 6765 7428 226b 6565 7022  wargs.get("keep"
-00006da0: 2c20 5472 7565 2920 6973 2046 616c 7365  , True) is False
-00006db0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00006dc0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-00006dd0: 6564 4572 726f 7228 2264 726f 705f 6475  edError("drop_du
-00006de0: 706c 6963 6174 6573 2077 6974 6820 6b65  plicates with ke
-00006df0: 6570 3d46 616c 7365 2229 0a0a 2020 2020  ep=False")..    
-00006e00: 2020 2020 6368 756e 6b20 3d20 4d2e 6472      chunk = M.dr
-00006e10: 6f70 5f64 7570 6c69 6361 7465 730a 2020  op_duplicates.  
-00006e20: 2020 2020 2020 7265 7475 726e 2061 6361        return aca
-00006e30: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-00006e40: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
-00006e50: 6368 756e 6b3d 6368 756e 6b2c 0a20 2020  chunk=chunk,.   
-00006e60: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
-00006e70: 7465 3d63 6875 6e6b 2c0a 2020 2020 2020  te=chunk,.      
-00006e80: 2020 2020 2020 6d65 7461 3d73 656c 662e        meta=self.
-00006e90: 5f6d 6574 612c 0a20 2020 2020 2020 2020  _meta,.         
-00006ea0: 2020 2074 6f6b 656e 3d22 6472 6f70 2d64     token="drop-d
-00006eb0: 7570 6c69 6361 7465 7322 2c0a 2020 2020  uplicates",.    
-00006ec0: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-00006ed0: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
-00006ee0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-00006ef0: 6974 5f6f 7574 3d73 706c 6974 5f6f 7574  it_out=split_out
-00006f00: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
-00006f10: 6c69 745f 6f75 745f 7365 7475 703d 7370  lit_out_setup=sp
-00006f20: 6c69 745f 6f75 745f 7365 7475 702c 0a20  lit_out_setup,. 
-00006f30: 2020 2020 2020 2020 2020 2073 706c 6974             split
-00006f40: 5f6f 7574 5f73 6574 7570 5f6b 7761 7267  _out_setup_kwarg
-00006f50: 733d 7370 6c69 745f 6f75 745f 7365 7475  s=split_out_setu
-00006f60: 705f 6b77 6172 6773 2c0a 2020 2020 2020  p_kwargs,.      
-00006f70: 2020 2020 2020 6967 6e6f 7265 5f69 6e64        ignore_ind
-00006f80: 6578 3d69 676e 6f72 655f 696e 6465 782c  ex=ignore_index,
-00006f90: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
-00006fa0: 7761 7267 732c 0a20 2020 2020 2020 2029  wargs,.        )
-00006fb0: 0a0a 2020 2020 6465 6620 5f5f 6c65 6e5f  ..    def __len_
-00006fc0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00006fd0: 2072 6574 7572 6e20 7365 6c66 2e72 6564   return self.red
-00006fe0: 7563 7469 6f6e 280a 2020 2020 2020 2020  uction(.        
-00006ff0: 2020 2020 6c65 6e2c 206e 702e 7375 6d2c      len, np.sum,
-00007000: 2074 6f6b 656e 3d22 6c65 6e22 2c20 6d65   token="len", me
-00007010: 7461 3d69 6e74 2c20 7370 6c69 745f 6576  ta=int, split_ev
-00007020: 6572 793d 4661 6c73 650a 2020 2020 2020  ery=False.      
-00007030: 2020 292e 636f 6d70 7574 6528 290a 0a20    ).compute().. 
-00007040: 2020 2064 6566 205f 5f62 6f6f 6c5f 5f28     def __bool__(
-00007050: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00007060: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00007070: 0a20 2020 2020 2020 2020 2020 2066 2254  .            f"T
-00007080: 6865 2074 7275 7468 2076 616c 7565 206f  he truth value o
-00007090: 6620 6120 7b73 656c 662e 5f5f 636c 6173  f a {self.__clas
-000070a0: 735f 5f2e 5f5f 6e61 6d65 5f5f 7d20 6973  s__.__name__} is
-000070b0: 2061 6d62 6967 756f 7573 2e20 220a 2020   ambiguous. ".  
-000070c0: 2020 2020 2020 2020 2020 2255 7365 2061            "Use a
-000070d0: 2e61 6e79 2829 206f 7220 612e 616c 6c28  .any() or a.all(
-000070e0: 292e 220a 2020 2020 2020 2020 290a 0a20  ).".        ).. 
-000070f0: 2020 205f 5f6e 6f6e 7a65 726f 5f5f 203d     __nonzero__ =
-00007100: 205f 5f62 6f6f 6c5f 5f20 2023 2070 7974   __bool__  # pyt
-00007110: 686f 6e20 320a 0a20 2020 2064 6566 205f  hon 2..    def _
-00007120: 7363 616c 6172 6675 6e63 2873 656c 662c  scalarfunc(self,
-00007130: 2063 6173 745f 7479 7065 293a 0a20 2020   cast_type):.   
-00007140: 2020 2020 2064 6566 2077 7261 7070 6572       def wrapper
-00007150: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00007160: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-00007170: 6622 6361 6e6e 6f74 2063 6f6e 7665 7274  f"cannot convert
-00007180: 2074 6865 2073 6572 6965 7320 746f 207b   the series to {
-00007190: 6361 7374 5f74 7970 657d 2229 0a0a 2020  cast_type}")..  
-000071a0: 2020 2020 2020 7265 7475 726e 2077 7261        return wra
-000071b0: 7070 6572 0a0a 2020 2020 6465 6620 5f5f  pper..    def __
-000071c0: 666c 6f61 745f 5f28 7365 6c66 293a 0a20  float__(self):. 
-000071d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000071e0: 6c66 2e5f 7363 616c 6172 6675 6e63 2866  lf._scalarfunc(f
-000071f0: 6c6f 6174 290a 0a20 2020 2064 6566 205f  loat)..    def _
-00007200: 5f69 6e74 5f5f 2873 656c 6629 3a0a 2020  _int__(self):.  
-00007210: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00007220: 662e 5f73 6361 6c61 7266 756e 6328 696e  f._scalarfunc(in
-00007230: 7429 0a0a 2020 2020 5f5f 6c6f 6e67 5f5f  t)..    __long__
-00007240: 203d 205f 5f69 6e74 5f5f 2020 2320 7079   = __int__  # py
-00007250: 7468 6f6e 2032 0a0a 2020 2020 6465 6620  thon 2..    def 
-00007260: 5f5f 636f 6d70 6c65 785f 5f28 7365 6c66  __complex__(self
-00007270: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00007280: 6e20 7365 6c66 2e5f 7363 616c 6172 6675  n self._scalarfu
-00007290: 6e63 2863 6f6d 706c 6578 290a 0a20 2020  nc(complex)..   
-000072a0: 2040 696e 7365 7274 5f6d 6574 615f 7061   @insert_meta_pa
-000072b0: 7261 6d5f 6465 7363 7269 7074 696f 6e28  ram_description(
-000072c0: 7061 643d 3132 290a 2020 2020 6465 6620  pad=12).    def 
-000072d0: 6d61 705f 7061 7274 6974 696f 6e73 2873  map_partitions(s
-000072e0: 656c 662c 2066 756e 632c 202a 6172 6773  elf, func, *args
-000072f0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00007300: 2020 2020 2022 2222 4170 706c 7920 5079       """Apply Py
-00007310: 7468 6f6e 2066 756e 6374 696f 6e20 6f6e  thon function on
-00007320: 2065 6163 6820 4461 7461 4672 616d 6520   each DataFrame 
-00007330: 7061 7274 6974 696f 6e2e 0a0a 2020 2020  partition...    
-00007340: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
-00007350: 6520 696e 6465 7820 616e 6420 6469 7669  e index and divi
-00007360: 7369 6f6e 7320 6172 6520 6173 7375 6d65  sions are assume
-00007370: 6420 746f 2072 656d 6169 6e20 756e 6368  d to remain unch
-00007380: 616e 6765 642e 0a0a 2020 2020 2020 2020  anged...        
-00007390: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-000073a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-000073b0: 2020 2020 2020 6675 6e63 203a 2066 756e        func : fun
-000073c0: 6374 696f 6e0a 2020 2020 2020 2020 2020  ction.          
-000073d0: 2020 5468 6520 6675 6e63 7469 6f6e 2061    The function a
-000073e0: 7070 6c69 6564 2074 6f20 6561 6368 2070  pplied to each p
-000073f0: 6172 7469 7469 6f6e 2e20 4966 2074 6869  artition. If thi
-00007400: 7320 6675 6e63 7469 6f6e 2061 6363 6570  s function accep
-00007410: 7473 0a20 2020 2020 2020 2020 2020 2074  ts.            t
-00007420: 6865 2073 7065 6369 616c 2060 6070 6172  he special ``par
-00007430: 7469 7469 6f6e 5f69 6e66 6f60 6020 6b65  tition_info`` ke
-00007440: 7977 6f72 6420 6172 6775 6d65 6e74 2c20  yword argument, 
-00007450: 6974 2077 696c 6c20 7265 6365 6976 650a  it will receive.
-00007460: 2020 2020 2020 2020 2020 2020 696e 666f              info
-00007470: 726d 6174 696f 6e20 6f6e 2074 6865 2070  rmation on the p
-00007480: 6172 7469 7469 6f6e 2773 2072 656c 6174  artition's relat
-00007490: 6976 6520 6c6f 6361 7469 6f6e 2077 6974  ive location wit
-000074a0: 6869 6e20 7468 650a 2020 2020 2020 2020  hin the.        
-000074b0: 2020 2020 6461 7461 6672 616d 652e 0a20      dataframe.. 
-000074c0: 2020 2020 2020 2061 7267 732c 206b 7761         args, kwa
-000074d0: 7267 7320 3a0a 2020 2020 2020 2020 2020  rgs :.          
-000074e0: 2020 506f 7369 7469 6f6e 616c 2061 6e64    Positional and
-000074f0: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
-00007500: 7473 2074 6f20 7061 7373 2074 6f20 7468  ts to pass to th
-00007510: 6520 6675 6e63 7469 6f6e 2e0a 2020 2020  e function..    
-00007520: 2020 2020 2020 2020 506f 7369 7469 6f6e          Position
-00007530: 616c 2061 7267 756d 656e 7473 2061 7265  al arguments are
-00007540: 2063 6f6d 7075 7465 6420 6f6e 2061 2070   computed on a p
-00007550: 6572 2d70 6172 7469 7469 6f6e 2062 6173  er-partition bas
-00007560: 6973 2c20 7768 696c 650a 2020 2020 2020  is, while.      
-00007570: 2020 2020 2020 6b65 7977 6f72 6420 6172        keyword ar
-00007580: 6775 6d65 6e74 7320 6172 6520 7368 6172  guments are shar
-00007590: 6564 2061 6372 6f73 7320 616c 6c20 7061  ed across all pa
-000075a0: 7274 6974 696f 6e73 2e20 5468 6520 7061  rtitions. The pa
-000075b0: 7274 6974 696f 6e0a 2020 2020 2020 2020  rtition.        
-000075c0: 2020 2020 6974 7365 6c66 2077 696c 6c20      itself will 
-000075d0: 6265 2074 6865 2066 6972 7374 2070 6f73  be the first pos
-000075e0: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
-000075f0: 2c20 7769 7468 2061 6c6c 206f 7468 6572  , with all other
-00007600: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
-00007610: 756d 656e 7473 2070 6173 7365 6420 2a61  uments passed *a
-00007620: 6674 6572 2a2e 2041 7267 756d 656e 7473  fter*. Arguments
-00007630: 2063 616e 2062 6520 6060 5363 616c 6172   can be ``Scalar
-00007640: 6060 2c20 6060 4465 6c61 7965 6460 602c  ``, ``Delayed``,
-00007650: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-00007660: 7265 6775 6c61 7220 5079 7468 6f6e 206f  regular Python o
-00007670: 626a 6563 7473 2e20 4461 7461 4672 616d  bjects. DataFram
-00007680: 652d 6c69 6b65 2061 7267 7320 2862 6f74  e-like args (bot
-00007690: 6820 6461 736b 2061 6e64 0a20 2020 2020  h dask and.     
-000076a0: 2020 2020 2020 2070 616e 6461 7329 2077         pandas) w
-000076b0: 696c 6c20 6265 2072 6570 6172 7469 7469  ill be repartiti
-000076c0: 6f6e 6564 2074 6f20 616c 6967 6e20 2869  oned to align (i
-000076d0: 6620 6e65 6365 7373 6172 7929 2062 6566  f necessary) bef
-000076e0: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
-000076f0: 6170 706c 7969 6e67 2074 6865 2066 756e  applying the fun
-00007700: 6374 696f 6e3b 2073 6565 2060 6061 6c69  ction; see ``ali
-00007710: 676e 5f64 6174 6166 7261 6d65 7360 6020  gn_dataframes`` 
-00007720: 746f 2063 6f6e 7472 6f6c 2074 6869 730a  to control this.
-00007730: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-00007740: 7669 6f72 2e0a 2020 2020 2020 2020 656e  vior..        en
-00007750: 666f 7263 655f 6d65 7461 6461 7461 203a  force_metadata :
-00007760: 2062 6f6f 6c2c 2064 6566 6175 6c74 2054   bool, default T
-00007770: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-00007780: 5768 6574 6865 7220 746f 2065 6e66 6f72  Whether to enfor
-00007790: 6365 2061 7420 7275 6e74 696d 6520 7468  ce at runtime th
-000077a0: 6174 2074 6865 2073 7472 7563 7475 7265  at the structure
-000077b0: 206f 6620 7468 6520 4461 7461 4672 616d   of the DataFram
-000077c0: 650a 2020 2020 2020 2020 2020 2020 7072  e.            pr
-000077d0: 6f64 7563 6564 2062 7920 6060 6675 6e63  oduced by ``func
-000077e0: 6060 2061 6374 7561 6c6c 7920 6d61 7463  `` actually matc
-000077f0: 6865 7320 7468 6520 7374 7275 6374 7572  hes the structur
-00007800: 6520 6f66 2060 606d 6574 6160 602e 0a20  e of ``meta``.. 
-00007810: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-00007820: 7769 6c6c 2072 656e 616d 6520 616e 6420  will rename and 
-00007830: 7265 6f72 6465 7220 636f 6c75 6d6e 7320  reorder columns 
-00007840: 666f 7220 6561 6368 2070 6172 7469 7469  for each partiti
-00007850: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-00007860: 616e 6420 7769 6c6c 2072 6169 7365 2061  and will raise a
-00007870: 6e20 6572 726f 7220 6966 2074 6869 7320  n error if this 
-00007880: 646f 6573 6e27 7420 776f 726b 2c0a 2020  doesn't work,.  
-00007890: 2020 2020 2020 2020 2020 6275 7420 6974            but it
-000078a0: 2077 6f6e 2774 2072 6169 7365 2069 6620   won't raise if 
-000078b0: 6474 7970 6573 2064 6f6e 2774 206d 6174  dtypes don't mat
-000078c0: 6368 2e0a 2020 2020 2020 2020 7472 616e  ch..        tran
-000078d0: 7366 6f72 6d5f 6469 7669 7369 6f6e 7320  sform_divisions 
-000078e0: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
-000078f0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
-00007900: 2057 6865 7468 6572 2074 6f20 6170 706c   Whether to appl
-00007910: 7920 7468 6520 6675 6e63 7469 6f6e 206f  y the function o
-00007920: 6e74 6f20 7468 6520 6469 7669 7369 6f6e  nto the division
-00007930: 7320 616e 6420 6170 706c 7920 7468 6f73  s and apply thos
-00007940: 650a 2020 2020 2020 2020 2020 2020 7472  e.            tr
-00007950: 616e 7366 6f72 6d65 6420 6469 7669 7369  ansformed divisi
-00007960: 6f6e 7320 746f 2074 6865 206f 7574 7075  ons to the outpu
-00007970: 742e 0a20 2020 2020 2020 2061 6c69 676e  t..        align
-00007980: 5f64 6174 6166 7261 6d65 7320 3a20 626f  _dataframes : bo
-00007990: 6f6c 2c20 6465 6661 756c 7420 5472 7565  ol, default True
-000079a0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
-000079b0: 7468 6572 2074 6f20 7265 7061 7274 6974  ther to repartit
-000079c0: 696f 6e20 4461 7461 4672 616d 652d 206f  ion DataFrame- o
-000079d0: 7220 5365 7269 6573 2d6c 696b 6520 6172  r Series-like ar
-000079e0: 6773 0a20 2020 2020 2020 2020 2020 2028  gs.            (
-000079f0: 626f 7468 2064 6173 6b20 616e 6420 7061  both dask and pa
-00007a00: 6e64 6173 2920 736f 2074 6865 6972 2064  ndas) so their d
-00007a10: 6976 6973 696f 6e73 2061 6c69 676e 2062  ivisions align b
-00007a20: 6566 6f72 6520 6170 706c 7969 6e67 0a20  efore applying. 
-00007a30: 2020 2020 2020 2020 2020 2074 6865 2066             the f
-00007a40: 756e 6374 696f 6e2e 2054 6869 7320 7265  unction. This re
-00007a50: 7175 6972 6573 2061 6c6c 2069 6e70 7574  quires all input
-00007a60: 7320 746f 2068 6176 6520 6b6e 6f77 6e20  s to have known 
-00007a70: 6469 7669 7369 6f6e 732e 0a20 2020 2020  divisions..     
-00007a80: 2020 2020 2020 2053 696e 676c 652d 7061         Single-pa
-00007a90: 7274 6974 696f 6e20 696e 7075 7473 2077  rtition inputs w
-00007aa0: 696c 6c20 6265 2073 706c 6974 2069 6e74  ill be split int
-00007ab0: 6f20 6d75 6c74 6970 6c65 2070 6172 7469  o multiple parti
-00007ac0: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
-00007ad0: 2020 2020 4966 2046 616c 7365 2c20 616c      If False, al
-00007ae0: 6c20 696e 7075 7473 206d 7573 7420 6861  l inputs must ha
-00007af0: 7665 2065 6974 6865 7220 7468 6520 7361  ve either the sa
-00007b00: 6d65 206e 756d 6265 7220 6f66 2070 6172  me number of par
-00007b10: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
-00007b20: 2020 2020 6f72 2061 2073 696e 676c 6520      or a single 
-00007b30: 7061 7274 6974 696f 6e2e 2053 696e 676c  partition. Singl
-00007b40: 652d 7061 7274 6974 696f 6e20 696e 7075  e-partition inpu
-00007b50: 7473 2077 696c 6c20 6265 2062 726f 6164  ts will be broad
-00007b60: 6361 7374 2074 6f0a 2020 2020 2020 2020  cast to.        
-00007b70: 2020 2020 6576 6572 7920 7061 7274 6974      every partit
-00007b80: 696f 6e20 6f66 206d 756c 7469 2d70 6172  ion of multi-par
-00007b90: 7469 7469 6f6e 2069 6e70 7574 732e 0a20  tition inputs.. 
-00007ba0: 2020 2020 2020 2024 4d45 5441 0a0a 2020         $META..  
-00007bb0: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
-00007bc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00007bd0: 2020 2020 2020 2020 4769 7665 6e20 6120          Given a 
-00007be0: 4461 7461 4672 616d 652c 2053 6572 6965  DataFrame, Serie
-00007bf0: 732c 206f 7220 496e 6465 782c 2073 7563  s, or Index, suc
-00007c00: 6820 6173 3a0a 0a20 2020 2020 2020 203e  h as:..        >
-00007c10: 3e3e 2069 6d70 6f72 7420 7061 6e64 6173  >> import pandas
-00007c20: 2061 7320 7064 0a20 2020 2020 2020 203e   as pd.        >
-00007c30: 3e3e 2069 6d70 6f72 7420 6461 736b 2e64  >> import dask.d
-00007c40: 6174 6166 7261 6d65 2061 7320 6464 0a20  ataframe as dd. 
-00007c50: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00007c60: 7064 2e44 6174 6146 7261 6d65 287b 2778  pd.DataFrame({'x
-00007c70: 273a 205b 312c 2032 2c20 332c 2034 2c20  ': [1, 2, 3, 4, 
-00007c80: 355d 2c0a 2020 2020 2020 2020 2e2e 2e20  5],.        ... 
-00007c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ca0: 2020 2027 7927 3a20 5b31 2e2c 2032 2e2c     'y': [1., 2.,
-00007cb0: 2033 2e2c 2034 2e2c 2035 2e5d 7d29 0a20   3., 4., 5.]}). 
-00007cc0: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
-00007cd0: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
-00007ce0: 6466 2c20 6e70 6172 7469 7469 6f6e 733d  df, npartitions=
-00007cf0: 3229 0a0a 2020 2020 2020 2020 4f6e 6520  2)..        One 
-00007d00: 6361 6e20 7573 6520 6060 6d61 705f 7061  can use ``map_pa
-00007d10: 7274 6974 696f 6e73 6060 2074 6f20 6170  rtitions`` to ap
-00007d20: 706c 7920 6120 6675 6e63 7469 6f6e 206f  ply a function o
-00007d30: 6e20 6561 6368 2070 6172 7469 7469 6f6e  n each partition
-00007d40: 2e0a 2020 2020 2020 2020 4578 7472 6120  ..        Extra 
-00007d50: 6172 6775 6d65 6e74 7320 616e 6420 6b65  arguments and ke
-00007d60: 7977 6f72 6473 2063 616e 206f 7074 696f  ywords can optio
-00007d70: 6e61 6c6c 7920 6265 2070 726f 7669 6465  nally be provide
-00007d80: 642c 2061 6e64 2077 696c 6c20 6265 0a20  d, and will be. 
-00007d90: 2020 2020 2020 2070 6173 7365 6420 746f         passed to
-00007da0: 2074 6865 2066 756e 6374 696f 6e20 6166   the function af
-00007db0: 7465 7220 7468 6520 7061 7274 6974 696f  ter the partitio
-00007dc0: 6e2e 0a0a 2020 2020 2020 2020 4865 7265  n...        Here
-00007dd0: 2077 6520 6170 706c 7920 6120 6675 6e63   we apply a func
-00007de0: 7469 6f6e 2077 6974 6820 6172 6775 6d65  tion with argume
-00007df0: 6e74 7320 616e 6420 6b65 7977 6f72 6473  nts and keywords
-00007e00: 2074 6f20 6120 4461 7461 4672 616d 652c   to a DataFrame,
-00007e10: 0a20 2020 2020 2020 2072 6573 756c 7469  .        resulti
-00007e20: 6e67 2069 6e20 6120 5365 7269 6573 3a0a  ng in a Series:.
-00007e30: 0a20 2020 2020 2020 203e 3e3e 2064 6566  .        >>> def
-00007e40: 206d 7961 6464 2864 662c 2061 2c20 623d   myadd(df, a, b=
-00007e50: 3129 3a0a 2020 2020 2020 2020 2e2e 2e20  1):.        ... 
-00007e60: 2020 2020 7265 7475 726e 2064 662e 7820      return df.x 
-00007e70: 2b20 6466 2e79 202b 2061 202b 2062 0a20  + df.y + a + b. 
-00007e80: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
-00007e90: 2064 6466 2e6d 6170 5f70 6172 7469 7469   ddf.map_partiti
-00007ea0: 6f6e 7328 6d79 6164 642c 2031 2c20 623d  ons(myadd, 1, b=
-00007eb0: 3229 0a20 2020 2020 2020 203e 3e3e 2072  2).        >>> r
-00007ec0: 6573 2e64 7479 7065 0a20 2020 2020 2020  es.dtype.       
-00007ed0: 2064 7479 7065 2827 666c 6f61 7436 3427   dtype('float64'
-00007ee0: 290a 0a20 2020 2020 2020 2048 6572 6520  )..        Here 
-00007ef0: 7765 2061 7070 6c79 2061 2066 756e 6374  we apply a funct
-00007f00: 696f 6e20 746f 2061 2053 6572 6965 7320  ion to a Series 
-00007f10: 7265 7375 6c74 696e 6720 696e 2061 2053  resulting in a S
-00007f20: 6572 6965 733a 0a0a 2020 2020 2020 2020  eries:..        
-00007f30: 3e3e 3e20 7265 7320 3d20 6464 662e 782e  >>> res = ddf.x.
-00007f40: 6d61 705f 7061 7274 6974 696f 6e73 286c  map_partitions(l
-00007f50: 616d 6264 6120 783a 206c 656e 2878 2929  ambda x: len(x))
-00007f60: 2023 2064 6466 2e78 2069 7320 6120 4461   # ddf.x is a Da
-00007f70: 736b 2053 6572 6965 7320 5374 7275 6374  sk Series Struct
-00007f80: 7572 650a 2020 2020 2020 2020 3e3e 3e20  ure.        >>> 
-00007f90: 7265 732e 6474 7970 650a 2020 2020 2020  res.dtype.      
-00007fa0: 2020 6474 7970 6528 2769 6e74 3634 2729    dtype('int64')
-00007fb0: 0a0a 2020 2020 2020 2020 4279 2064 6566  ..        By def
-00007fc0: 6175 6c74 2c20 6461 736b 2074 7269 6573  ault, dask tries
-00007fd0: 2074 6f20 696e 6665 7220 7468 6520 6f75   to infer the ou
-00007fe0: 7470 7574 206d 6574 6164 6174 6120 6279  tput metadata by
-00007ff0: 2072 756e 6e69 6e67 2079 6f75 720a 2020   running your.  
-00008000: 2020 2020 2020 7072 6f76 6964 6564 2066        provided f
-00008010: 756e 6374 696f 6e20 6f6e 2073 6f6d 6520  unction on some 
-00008020: 6661 6b65 2064 6174 612e 2054 6869 7320  fake data. This 
-00008030: 776f 726b 7320 7765 6c6c 2069 6e20 6d61  works well in ma
-00008040: 6e79 2063 6173 6573 2c20 6275 740a 2020  ny cases, but.  
-00008050: 2020 2020 2020 6361 6e20 736f 6d65 7469        can someti
-00008060: 6d65 7320 6265 2065 7870 656e 7369 7665  mes be expensive
-00008070: 2c20 6f72 2065 7665 6e20 6661 696c 2e20  , or even fail. 
-00008080: 546f 2061 766f 6964 2074 6869 732c 2079  To avoid this, y
-00008090: 6f75 2063 616e 0a20 2020 2020 2020 206d  ou can.        m
-000080a0: 616e 7561 6c6c 7920 7370 6563 6966 7920  anually specify 
-000080b0: 7468 6520 6f75 7470 7574 206d 6574 6164  the output metad
-000080c0: 6174 6120 7769 7468 2074 6865 2060 606d  ata with the ``m
-000080d0: 6574 6160 6020 6b65 7977 6f72 642e 2054  eta`` keyword. T
-000080e0: 6869 730a 2020 2020 2020 2020 6361 6e20  his.        can 
-000080f0: 6265 2073 7065 6369 6669 6564 2069 6e20  be specified in 
-00008100: 6d61 6e79 2066 6f72 6d73 2c20 666f 7220  many forms, for 
-00008110: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
-00008120: 2073 6565 0a20 2020 2020 2020 2060 6064   see.        ``d
-00008130: 6173 6b2e 6461 7461 6672 616d 652e 7574  ask.dataframe.ut
-00008140: 696c 732e 6d61 6b65 5f6d 6574 6160 602e  ils.make_meta``.
-00008150: 0a0a 2020 2020 2020 2020 4865 7265 2077  ..        Here w
-00008160: 6520 7370 6563 6966 7920 7468 6520 6f75  e specify the ou
-00008170: 7470 7574 2069 7320 6120 5365 7269 6573  tput is a Series
-00008180: 2077 6974 6820 6e6f 206e 616d 652c 2061   with no name, a
-00008190: 6e64 2064 7479 7065 0a20 2020 2020 2020  nd dtype.       
-000081a0: 2060 6066 6c6f 6174 3634 6060 3a0a 0a20   ``float64``:.. 
-000081b0: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
-000081c0: 2064 6466 2e6d 6170 5f70 6172 7469 7469   ddf.map_partiti
-000081d0: 6f6e 7328 6d79 6164 642c 2031 2c20 623d  ons(myadd, 1, b=
-000081e0: 322c 206d 6574 613d 284e 6f6e 652c 2027  2, meta=(None, '
-000081f0: 6638 2729 290a 0a20 2020 2020 2020 2048  f8'))..        H
-00008200: 6572 6520 7765 206d 6170 2061 2066 756e  ere we map a fun
-00008210: 6374 696f 6e20 7468 6174 2074 616b 6573  ction that takes
-00008220: 2069 6e20 6120 4461 7461 4672 616d 652c   in a DataFrame,
-00008230: 2061 6e64 2072 6574 7572 6e73 2061 0a20   and returns a. 
-00008240: 2020 2020 2020 2044 6174 6146 7261 6d65         DataFrame
-00008250: 2077 6974 6820 6120 6e65 7720 636f 6c75   with a new colu
-00008260: 6d6e 3a0a 0a20 2020 2020 2020 203e 3e3e  mn:..        >>>
-00008270: 2072 6573 203d 2064 6466 2e6d 6170 5f70   res = ddf.map_p
-00008280: 6172 7469 7469 6f6e 7328 6c61 6d62 6461  artitions(lambda
-00008290: 2064 663a 2064 662e 6173 7369 676e 287a   df: df.assign(z
-000082a0: 3d64 662e 7820 2a20 6466 2e79 2929 0a20  =df.x * df.y)). 
-000082b0: 2020 2020 2020 203e 3e3e 2072 6573 2e64         >>> res.d
-000082c0: 7479 7065 730a 2020 2020 2020 2020 7820  types.        x 
-000082d0: 2020 2020 2069 6e74 3634 0a20 2020 2020       int64.     
-000082e0: 2020 2079 2020 2020 666c 6f61 7436 340a     y    float64.
-000082f0: 2020 2020 2020 2020 7a20 2020 2066 6c6f          z    flo
-00008300: 6174 3634 0a20 2020 2020 2020 2064 7479  at64.        dty
-00008310: 7065 3a20 6f62 6a65 6374 0a0a 2020 2020  pe: object..    
-00008320: 2020 2020 4173 2062 6566 6f72 652c 2074      As before, t
-00008330: 6865 206f 7574 7075 7420 6d65 7461 6461  he output metada
-00008340: 7461 2063 616e 2061 6c73 6f20 6265 2073  ta can also be s
-00008350: 7065 6369 6669 6564 206d 616e 7561 6c6c  pecified manuall
-00008360: 792e 2054 6869 730a 2020 2020 2020 2020  y. This.        
-00008370: 7469 6d65 2077 6520 7061 7373 2069 6e20  time we pass in 
-00008380: 6120 6060 6469 6374 6060 2c20 6173 2074  a ``dict``, as t
-00008390: 6865 206f 7574 7075 7420 6973 2061 2044  he output is a D
-000083a0: 6174 6146 7261 6d65 3a0a 0a20 2020 2020  ataFrame:..     
-000083b0: 2020 203e 3e3e 2072 6573 203d 2064 6466     >>> res = ddf
-000083c0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-000083d0: 6c61 6d62 6461 2064 663a 2064 662e 6173  lambda df: df.as
-000083e0: 7369 676e 287a 3d64 662e 7820 2a20 6466  sign(z=df.x * df
-000083f0: 2e79 292c 0a20 2020 2020 2020 202e 2e2e  .y),.        ...
-00008400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008410: 2020 2020 2020 2020 2020 6d65 7461 3d7b            meta={
-00008420: 2778 273a 2027 6938 272c 2027 7927 3a20  'x': 'i8', 'y': 
-00008430: 2766 3827 2c20 277a 273a 2027 6638 277d  'f8', 'z': 'f8'}
-00008440: 290a 0a20 2020 2020 2020 2049 6e20 7468  )..        In th
-00008450: 6520 6361 7365 2077 6865 7265 2074 6865  e case where the
-00008460: 206d 6574 6164 6174 6120 646f 6573 6e27   metadata doesn'
-00008470: 7420 6368 616e 6765 2c20 796f 7520 6361  t change, you ca
-00008480: 6e20 616c 736f 2070 6173 7320 696e 0a20  n also pass in. 
-00008490: 2020 2020 2020 2074 6865 206f 626a 6563         the objec
-000084a0: 7420 6974 7365 6c66 2064 6972 6563 746c  t itself directl
-000084b0: 793a 0a0a 2020 2020 2020 2020 3e3e 3e20  y:..        >>> 
-000084c0: 7265 7320 3d20 6464 662e 6d61 705f 7061  res = ddf.map_pa
-000084d0: 7274 6974 696f 6e73 286c 616d 6264 6120  rtitions(lambda 
-000084e0: 6466 3a20 6466 2e68 6561 6428 292c 206d  df: df.head(), m
-000084f0: 6574 613d 6464 6629 0a0a 2020 2020 2020  eta=ddf)..      
-00008500: 2020 416c 736f 206e 6f74 6520 7468 6174    Also note that
-00008510: 2074 6865 2069 6e64 6578 2061 6e64 2064   the index and d
-00008520: 6976 6973 696f 6e73 2061 7265 2061 7373  ivisions are ass
-00008530: 756d 6564 2074 6f20 7265 6d61 696e 2075  umed to remain u
-00008540: 6e63 6861 6e67 6564 2e0a 2020 2020 2020  nchanged..      
-00008550: 2020 4966 2074 6865 2066 756e 6374 696f    If the functio
-00008560: 6e20 796f 7527 7265 206d 6170 7069 6e67  n you're mapping
-00008570: 2063 6861 6e67 6573 2074 6865 2069 6e64   changes the ind
-00008580: 6578 2f64 6976 6973 696f 6e73 2c20 796f  ex/divisions, yo
-00008590: 7527 6c6c 206e 6565 640a 2020 2020 2020  u'll need.      
-000085a0: 2020 746f 2063 6c65 6172 2074 6865 6d20    to clear them 
-000085b0: 6166 7465 7277 6172 6473 3a0a 0a20 2020  afterwards:..   
-000085c0: 2020 2020 203e 3e3e 2064 6466 2e6d 6170       >>> ddf.map
-000085d0: 5f70 6172 7469 7469 6f6e 7328 6675 6e63  _partitions(func
-000085e0: 292e 636c 6561 725f 6469 7669 7369 6f6e  ).clear_division
-000085f0: 7328 2920 2023 2064 6f63 7465 7374 3a20  s()  # doctest: 
-00008600: 2b53 4b49 500a 0a20 2020 2020 2020 2059  +SKIP..        Y
-00008610: 6f75 7220 6d61 7020 6675 6e63 7469 6f6e  our map function
-00008620: 2067 6574 7320 696e 666f 726d 6174 696f   gets informatio
-00008630: 6e20 6162 6f75 7420 7768 6572 6520 6974  n about where it
-00008640: 2069 7320 696e 2074 6865 2064 6174 6166   is in the dataf
-00008650: 7261 6d65 2062 790a 2020 2020 2020 2020  rame by.        
-00008660: 6163 6365 7074 696e 6720 6120 7370 6563  accepting a spec
-00008670: 6961 6c20 6060 7061 7274 6974 696f 6e5f  ial ``partition_
-00008680: 696e 666f 6060 206b 6579 776f 7264 2061  info`` keyword a
-00008690: 7267 756d 656e 742e 0a0a 2020 2020 2020  rgument...      
-000086a0: 2020 3e3e 3e20 6465 6620 6675 6e63 2870    >>> def func(p
-000086b0: 6172 7469 7469 6f6e 2c20 7061 7274 6974  artition, partit
-000086c0: 696f 6e5f 696e 666f 3d4e 6f6e 6529 3a0a  ion_info=None):.
-000086d0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-000086e0: 7061 7373 0a0a 2020 2020 2020 2020 5468  pass..        Th
-000086f0: 6973 2077 696c 6c20 7265 6365 6976 6520  is will receive 
-00008700: 7468 6520 666f 6c6c 6f77 696e 6720 696e  the following in
-00008710: 666f 726d 6174 696f 6e3a 0a0a 2020 2020  formation:..    
-00008720: 2020 2020 3e3e 3e20 7061 7274 6974 696f      >>> partitio
-00008730: 6e5f 696e 666f 2020 2320 646f 6374 6573  n_info  # doctes
-00008740: 743a 202b 534b 4950 0a20 2020 2020 2020  t: +SKIP.       
-00008750: 207b 276e 756d 6265 7227 3a20 312c 2027   {'number': 1, '
-00008760: 6469 7669 7369 6f6e 273a 2033 7d0a 0a20  division': 3}.. 
-00008770: 2020 2020 2020 2046 6f72 2065 6163 6820         For each 
-00008780: 6172 6775 6d65 6e74 2061 6e64 206b 6579  argument and key
-00008790: 776f 7264 2061 7267 756d 656e 7473 2074  word arguments t
-000087a0: 6861 7420 6172 6520 6461 736b 2064 6174  hat are dask dat
-000087b0: 6166 7261 6d65 7320 796f 7520 7769 6c6c  aframes you will
-000087c0: 0a20 2020 2020 2020 2072 6563 6569 7665  .        receive
-000087d0: 2074 6865 206e 756d 6265 7220 286e 2920   the number (n) 
-000087e0: 7768 6963 6820 7265 7072 6573 656e 7473  which represents
-000087f0: 2074 6865 206e 7468 2070 6172 7469 7469   the nth partiti
-00008800: 6f6e 206f 6620 7468 6520 6461 7461 6672  on of the datafr
-00008810: 616d 650a 2020 2020 2020 2020 616e 6420  ame.        and 
-00008820: 7468 6520 6469 7669 7369 6f6e 2028 7468  the division (th
-00008830: 6520 6669 7273 7420 696e 6465 7820 7661  e first index va
-00008840: 6c75 6520 696e 2074 6865 2070 6172 7469  lue in the parti
-00008850: 7469 6f6e 292e 2049 6620 6469 7669 7369  tion). If divisi
-00008860: 6f6e 730a 2020 2020 2020 2020 6172 6520  ons.        are 
-00008870: 6e6f 7420 6b6e 6f77 6e20 2866 6f72 2069  not known (for i
-00008880: 6e73 7461 6e63 6520 6966 2074 6865 2069  nstance if the i
-00008890: 6e64 6578 2069 7320 6e6f 7420 736f 7274  ndex is not sort
-000088a0: 6564 2920 7468 656e 2079 6f75 2077 696c  ed) then you wil
-000088b0: 6c20 6765 740a 2020 2020 2020 2020 4e6f  l get.        No
-000088c0: 6e65 2061 7320 7468 6520 6469 7669 7369  ne as the divisi
-000088d0: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
-000088e0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-000088f0: 6170 5f70 6172 7469 7469 6f6e 7328 6675  ap_partitions(fu
-00008900: 6e63 2c20 7365 6c66 2c20 2a61 7267 732c  nc, self, *args,
-00008910: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
-00008920: 4069 6e73 6572 745f 6d65 7461 5f70 6172  @insert_meta_par
-00008930: 616d 5f64 6573 6372 6970 7469 6f6e 2870  am_description(p
-00008940: 6164 3d31 3229 0a20 2020 2064 6566 206d  ad=12).    def m
-00008950: 6170 5f6f 7665 726c 6170 2873 656c 662c  ap_overlap(self,
-00008960: 2066 756e 632c 2062 6566 6f72 652c 2061   func, before, a
-00008970: 6674 6572 2c20 2a61 7267 732c 202a 2a6b  fter, *args, **k
-00008980: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00008990: 2222 2241 7070 6c79 2061 2066 756e 6374  """Apply a funct
-000089a0: 696f 6e20 746f 2065 6163 6820 7061 7274  ion to each part
-000089b0: 6974 696f 6e2c 2073 6861 7269 6e67 2072  ition, sharing r
-000089c0: 6f77 7320 7769 7468 2061 646a 6163 656e  ows with adjacen
-000089d0: 7420 7061 7274 6974 696f 6e73 2e0a 0a20  t partitions... 
-000089e0: 2020 2020 2020 2054 6869 7320 6361 6e20         This can 
-000089f0: 6265 2075 7365 6675 6c20 666f 7220 696d  be useful for im
-00008a00: 706c 656d 656e 7469 6e67 2077 696e 646f  plementing windo
-00008a10: 7769 6e67 2066 756e 6374 696f 6e73 2073  wing functions s
-00008a20: 7563 6820 6173 0a20 2020 2020 2020 2060  uch as.        `
-00008a30: 6064 662e 726f 6c6c 696e 6728 2e2e 2e29  `df.rolling(...)
-00008a40: 2e6d 6561 6e28 2960 6020 6f72 2060 6064  .mean()`` or ``d
-00008a50: 662e 6469 6666 2829 6060 2e0a 0a20 2020  f.diff()``...   
-00008a60: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00008a70: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00008a80: 2d2d 0a20 2020 2020 2020 2066 756e 6320  --.        func 
-00008a90: 3a20 6675 6e63 7469 6f6e 0a20 2020 2020  : function.     
-00008aa0: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
-00008ab0: 6170 706c 6965 6420 746f 2065 6163 6820  applied to each 
-00008ac0: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
-00008ad0: 2020 2062 6566 6f72 6520 3a20 696e 742c     before : int,
-00008ae0: 2074 696d 6564 656c 7461 206f 7220 7374   timedelta or st
-00008af0: 7269 6e67 2074 696d 6564 656c 7461 0a20  ring timedelta. 
-00008b00: 2020 2020 2020 2020 2020 2054 6865 2072             The r
-00008b10: 6f77 7320 746f 2070 7265 7065 6e64 2074  ows to prepend t
-00008b20: 6f20 7061 7274 6974 696f 6e20 6060 6960  o partition ``i`
-00008b30: 6020 6672 6f6d 2074 6865 2065 6e64 206f  ` from the end o
-00008b40: 660a 2020 2020 2020 2020 2020 2020 7061  f.            pa
-00008b50: 7274 6974 696f 6e20 6060 6920 2d20 3160  rtition ``i - 1`
-00008b60: 602e 0a20 2020 2020 2020 2061 6674 6572  `..        after
-00008b70: 203a 2069 6e74 2c20 7469 6d65 6465 6c74   : int, timedelt
-00008b80: 6120 6f72 2073 7472 696e 6720 7469 6d65  a or string time
-00008b90: 6465 6c74 610a 2020 2020 2020 2020 2020  delta.          
-00008ba0: 2020 5468 6520 726f 7773 2074 6f20 6170    The rows to ap
-00008bb0: 7065 6e64 2074 6f20 7061 7274 6974 696f  pend to partitio
-00008bc0: 6e20 6060 6960 6020 6672 6f6d 2074 6865  n ``i`` from the
-00008bd0: 2062 6567 696e 6e69 6e67 0a20 2020 2020   beginning.     
-00008be0: 2020 2020 2020 206f 6620 7061 7274 6974         of partit
-00008bf0: 696f 6e20 6060 6920 2b20 3160 602e 0a20  ion ``i + 1``.. 
-00008c00: 2020 2020 2020 2061 7267 732c 206b 7761         args, kwa
-00008c10: 7267 7320 3a0a 2020 2020 2020 2020 2020  rgs :.          
-00008c20: 2020 506f 7369 7469 6f6e 616c 2061 6e64    Positional and
-00008c30: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
-00008c40: 7473 2074 6f20 7061 7373 2074 6f20 7468  ts to pass to th
-00008c50: 6520 6675 6e63 7469 6f6e 2e0a 2020 2020  e function..    
-00008c60: 2020 2020 2020 2020 506f 7369 7469 6f6e          Position
-00008c70: 616c 2061 7267 756d 656e 7473 2061 7265  al arguments are
-00008c80: 2063 6f6d 7075 7465 6420 6f6e 2061 2070   computed on a p
-00008c90: 6572 2d70 6172 7469 7469 6f6e 2062 6173  er-partition bas
-00008ca0: 6973 2c20 7768 696c 650a 2020 2020 2020  is, while.      
-00008cb0: 2020 2020 2020 6b65 7977 6f72 6420 6172        keyword ar
-00008cc0: 6775 6d65 6e74 7320 6172 6520 7368 6172  guments are shar
-00008cd0: 6564 2061 6372 6f73 7320 616c 6c20 7061  ed across all pa
-00008ce0: 7274 6974 696f 6e73 2e20 5468 6520 7061  rtitions. The pa
-00008cf0: 7274 6974 696f 6e0a 2020 2020 2020 2020  rtition.        
-00008d00: 2020 2020 6974 7365 6c66 2077 696c 6c20      itself will 
-00008d10: 6265 2074 6865 2066 6972 7374 2070 6f73  be the first pos
-00008d20: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
-00008d30: 2c20 7769 7468 2061 6c6c 206f 7468 6572  , with all other
-00008d40: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
-00008d50: 756d 656e 7473 2070 6173 7365 6420 2a61  uments passed *a
-00008d60: 6674 6572 2a2e 2041 7267 756d 656e 7473  fter*. Arguments
-00008d70: 2063 616e 2062 6520 6060 5363 616c 6172   can be ``Scalar
-00008d80: 6060 2c20 6060 4465 6c61 7965 6460 602c  ``, ``Delayed``,
-00008d90: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-00008da0: 7265 6775 6c61 7220 5079 7468 6f6e 206f  regular Python o
-00008db0: 626a 6563 7473 2e20 4461 7461 4672 616d  bjects. DataFram
-00008dc0: 652d 6c69 6b65 2061 7267 7320 2862 6f74  e-like args (bot
-00008dd0: 6820 6461 736b 2061 6e64 0a20 2020 2020  h dask and.     
-00008de0: 2020 2020 2020 2070 616e 6461 7329 2077         pandas) w
-00008df0: 696c 6c20 6265 2072 6570 6172 7469 7469  ill be repartiti
-00008e00: 6f6e 6564 2074 6f20 616c 6967 6e20 2869  oned to align (i
-00008e10: 6620 6e65 6365 7373 6172 7929 2062 6566  f necessary) bef
-00008e20: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
-00008e30: 6170 706c 7969 6e67 2074 6865 2066 756e  applying the fun
-00008e40: 6374 696f 6e3b 2073 6565 2060 6061 6c69  ction; see ``ali
-00008e50: 676e 5f64 6174 6166 7261 6d65 7360 6020  gn_dataframes`` 
-00008e60: 746f 2063 6f6e 7472 6f6c 2074 6869 730a  to control this.
-00008e70: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-00008e80: 7669 6f72 2e0a 2020 2020 2020 2020 656e  vior..        en
-00008e90: 666f 7263 655f 6d65 7461 6461 7461 203a  force_metadata :
-00008ea0: 2062 6f6f 6c2c 2064 6566 6175 6c74 2054   bool, default T
-00008eb0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-00008ec0: 5768 6574 6865 7220 746f 2065 6e66 6f72  Whether to enfor
-00008ed0: 6365 2061 7420 7275 6e74 696d 6520 7468  ce at runtime th
-00008ee0: 6174 2074 6865 2073 7472 7563 7475 7265  at the structure
-00008ef0: 206f 6620 7468 6520 4461 7461 4672 616d   of the DataFram
-00008f00: 650a 2020 2020 2020 2020 2020 2020 7072  e.            pr
-00008f10: 6f64 7563 6564 2062 7920 6060 6675 6e63  oduced by ``func
-00008f20: 6060 2061 6374 7561 6c6c 7920 6d61 7463  `` actually matc
-00008f30: 6865 7320 7468 6520 7374 7275 6374 7572  hes the structur
-00008f40: 6520 6f66 2060 606d 6574 6160 602e 0a20  e of ``meta``.. 
-00008f50: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-00008f60: 7769 6c6c 2072 656e 616d 6520 616e 6420  will rename and 
-00008f70: 7265 6f72 6465 7220 636f 6c75 6d6e 7320  reorder columns 
-00008f80: 666f 7220 6561 6368 2070 6172 7469 7469  for each partiti
-00008f90: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-00008fa0: 616e 6420 7769 6c6c 2072 6169 7365 2061  and will raise a
-00008fb0: 6e20 6572 726f 7220 6966 2074 6869 7320  n error if this 
-00008fc0: 646f 6573 6e27 7420 776f 726b 2c0a 2020  doesn't work,.  
-00008fd0: 2020 2020 2020 2020 2020 6275 7420 6974            but it
-00008fe0: 2077 6f6e 2774 2072 6169 7365 2069 6620   won't raise if 
-00008ff0: 6474 7970 6573 2064 6f6e 2774 206d 6174  dtypes don't mat
-00009000: 6368 2e0a 2020 2020 2020 2020 7472 616e  ch..        tran
-00009010: 7366 6f72 6d5f 6469 7669 7369 6f6e 7320  sform_divisions 
-00009020: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
-00009030: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
-00009040: 2057 6865 7468 6572 2074 6f20 6170 706c   Whether to appl
-00009050: 7920 7468 6520 6675 6e63 7469 6f6e 206f  y the function o
-00009060: 6e74 6f20 7468 6520 6469 7669 7369 6f6e  nto the division
-00009070: 7320 616e 6420 6170 706c 7920 7468 6f73  s and apply thos
-00009080: 650a 2020 2020 2020 2020 2020 2020 7472  e.            tr
-00009090: 616e 7366 6f72 6d65 6420 6469 7669 7369  ansformed divisi
-000090a0: 6f6e 7320 746f 2074 6865 206f 7574 7075  ons to the outpu
-000090b0: 742e 0a20 2020 2020 2020 2061 6c69 676e  t..        align
-000090c0: 5f64 6174 6166 7261 6d65 7320 3a20 626f  _dataframes : bo
-000090d0: 6f6c 2c20 6465 6661 756c 7420 5472 7565  ol, default True
-000090e0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
-000090f0: 7468 6572 2074 6f20 7265 7061 7274 6974  ther to repartit
-00009100: 696f 6e20 4461 7461 4672 616d 652d 206f  ion DataFrame- o
-00009110: 7220 5365 7269 6573 2d6c 696b 6520 6172  r Series-like ar
-00009120: 6773 0a20 2020 2020 2020 2020 2020 2028  gs.            (
-00009130: 626f 7468 2064 6173 6b20 616e 6420 7061  both dask and pa
-00009140: 6e64 6173 2920 736f 2074 6865 6972 2064  ndas) so their d
-00009150: 6976 6973 696f 6e73 2061 6c69 676e 2062  ivisions align b
-00009160: 6566 6f72 6520 6170 706c 7969 6e67 0a20  efore applying. 
-00009170: 2020 2020 2020 2020 2020 2074 6865 2066             the f
-00009180: 756e 6374 696f 6e2e 2054 6869 7320 7265  unction. This re
-00009190: 7175 6972 6573 2061 6c6c 2069 6e70 7574  quires all input
-000091a0: 7320 746f 2068 6176 6520 6b6e 6f77 6e20  s to have known 
-000091b0: 6469 7669 7369 6f6e 732e 0a20 2020 2020  divisions..     
-000091c0: 2020 2020 2020 2053 696e 676c 652d 7061         Single-pa
-000091d0: 7274 6974 696f 6e20 696e 7075 7473 2077  rtition inputs w
-000091e0: 696c 6c20 6265 2073 706c 6974 2069 6e74  ill be split int
-000091f0: 6f20 6d75 6c74 6970 6c65 2070 6172 7469  o multiple parti
-00009200: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
-00009210: 2020 2020 4966 2046 616c 7365 2c20 616c      If False, al
-00009220: 6c20 696e 7075 7473 206d 7573 7420 6861  l inputs must ha
-00009230: 7665 2065 6974 6865 7220 7468 6520 7361  ve either the sa
-00009240: 6d65 206e 756d 6265 7220 6f66 2070 6172  me number of par
-00009250: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
-00009260: 2020 2020 6f72 2061 2073 696e 676c 6520      or a single 
-00009270: 7061 7274 6974 696f 6e2e 2053 696e 676c  partition. Singl
-00009280: 652d 7061 7274 6974 696f 6e20 696e 7075  e-partition inpu
-00009290: 7473 2077 696c 6c20 6265 2062 726f 6164  ts will be broad
-000092a0: 6361 7374 2074 6f0a 2020 2020 2020 2020  cast to.        
-000092b0: 2020 2020 6576 6572 7920 7061 7274 6974      every partit
-000092c0: 696f 6e20 6f66 206d 756c 7469 2d70 6172  ion of multi-par
-000092d0: 7469 7469 6f6e 2069 6e70 7574 732e 0a20  tition inputs.. 
-000092e0: 2020 2020 2020 2024 4d45 5441 0a0a 2020         $META..  
-000092f0: 2020 2020 2020 4e6f 7465 730a 2020 2020        Notes.    
-00009300: 2020 2020 2d2d 2d2d 2d0a 2020 2020 2020      -----.      
-00009310: 2020 4769 7665 6e20 706f 7369 7469 7665    Given positive
-00009320: 2069 6e74 6567 6572 7320 6060 6265 666f   integers ``befo
-00009330: 7265 6060 2061 6e64 2060 6061 6674 6572  re`` and ``after
-00009340: 6060 2c20 616e 6420 6120 6675 6e63 7469  ``, and a functi
-00009350: 6f6e 0a20 2020 2020 2020 2060 6066 756e  on.        ``fun
-00009360: 6360 602c 2060 606d 6170 5f6f 7665 726c  c``, ``map_overl
-00009370: 6170 6060 2064 6f65 7320 7468 6520 666f  ap`` does the fo
-00009380: 6c6c 6f77 696e 673a 0a0a 2020 2020 2020  llowing:..      
-00009390: 2020 312e 2050 7265 7065 6e64 2060 6062    1. Prepend ``b
-000093a0: 6566 6f72 6560 6020 726f 7773 2074 6f20  efore`` rows to 
-000093b0: 6561 6368 2070 6172 7469 7469 6f6e 2060  each partition `
-000093c0: 6069 6060 2066 726f 6d20 7468 6520 656e  `i`` from the en
-000093d0: 6420 6f66 0a20 2020 2020 2020 2020 2020  d of.           
-000093e0: 7061 7274 6974 696f 6e20 6060 6920 2d20  partition ``i - 
-000093f0: 3160 602e 2054 6865 2066 6972 7374 2070  1``. The first p
-00009400: 6172 7469 7469 6f6e 2068 6173 206e 6f20  artition has no 
-00009410: 726f 7773 2070 7265 7065 6e64 6564 2e0a  rows prepended..
-00009420: 0a20 2020 2020 2020 2032 2e20 4170 7065  .        2. Appe
-00009430: 6e64 2060 6061 6674 6572 6060 2072 6f77  nd ``after`` row
-00009440: 7320 746f 2065 6163 6820 7061 7274 6974  s to each partit
-00009450: 696f 6e20 6060 6960 6020 6672 6f6d 2074  ion ``i`` from t
-00009460: 6865 2062 6567 696e 6e69 6e67 206f 660a  he beginning of.
-00009470: 2020 2020 2020 2020 2020 2070 6172 7469             parti
-00009480: 7469 6f6e 2060 6069 202b 2031 6060 2e20  tion ``i + 1``. 
-00009490: 5468 6520 6c61 7374 2070 6172 7469 7469  The last partiti
-000094a0: 6f6e 2068 6173 206e 6f20 726f 7773 2061  on has no rows a
-000094b0: 7070 656e 6465 642e 0a0a 2020 2020 2020  ppended...      
-000094c0: 2020 332e 2041 7070 6c79 2060 6066 756e    3. Apply ``fun
-000094d0: 6360 6020 746f 2065 6163 6820 7061 7274  c`` to each part
-000094e0: 6974 696f 6e2c 2070 6173 7369 6e67 2069  ition, passing i
-000094f0: 6e20 616e 7920 6578 7472 6120 6060 6172  n any extra ``ar
-00009500: 6773 6060 2061 6e64 0a20 2020 2020 2020  gs`` and.       
-00009510: 2020 2020 6060 6b77 6172 6773 6060 2069      ``kwargs`` i
-00009520: 6620 7072 6f76 6964 6564 2e0a 0a20 2020  f provided...   
-00009530: 2020 2020 2034 2e20 5472 696d 2060 6062       4. Trim ``b
-00009540: 6566 6f72 6560 6020 726f 7773 2066 726f  efore`` rows fro
-00009550: 6d20 7468 6520 6265 6769 6e6e 696e 6720  m the beginning 
-00009560: 6f66 2061 6c6c 2062 7574 2074 6865 2066  of all but the f
-00009570: 6972 7374 0a20 2020 2020 2020 2020 2020  irst.           
-00009580: 7061 7274 6974 696f 6e2e 0a0a 2020 2020  partition...    
-00009590: 2020 2020 352e 2054 7269 6d20 6060 6166      5. Trim ``af
-000095a0: 7465 7260 6020 726f 7773 2066 726f 6d20  ter`` rows from 
-000095b0: 7468 6520 656e 6420 6f66 2061 6c6c 2062  the end of all b
-000095c0: 7574 2074 6865 206c 6173 7420 7061 7274  ut the last part
-000095d0: 6974 696f 6e2e 0a0a 2020 2020 2020 2020  ition...        
-000095e0: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-000095f0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00009600: 2020 4769 7665 6e20 6120 4461 7461 4672    Given a DataFr
-00009610: 616d 652c 2053 6572 6965 732c 206f 7220  ame, Series, or 
-00009620: 496e 6465 782c 2073 7563 6820 6173 3a0a  Index, such as:.
-00009630: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-00009640: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
-00009650: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-00009660: 6f72 7420 6461 736b 2e64 6174 6166 7261  ort dask.datafra
-00009670: 6d65 2061 7320 6464 0a20 2020 2020 2020  me as dd.       
-00009680: 203e 3e3e 2064 6620 3d20 7064 2e44 6174   >>> df = pd.Dat
-00009690: 6146 7261 6d65 287b 2778 273a 205b 312c  aFrame({'x': [1,
-000096a0: 2032 2c20 342c 2037 2c20 3131 5d2c 0a20   2, 4, 7, 11],. 
-000096b0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-000096c0: 2020 2020 2020 2020 2020 2020 2020 2779                'y
-000096d0: 273a 205b 312e 2c20 322e 2c20 332e 2c20  ': [1., 2., 3., 
-000096e0: 342e 2c20 352e 5d7d 290a 2020 2020 2020  4., 5.]}).      
-000096f0: 2020 3e3e 3e20 6464 6620 3d20 6464 2e66    >>> ddf = dd.f
-00009700: 726f 6d5f 7061 6e64 6173 2864 662c 206e  rom_pandas(df, n
-00009710: 7061 7274 6974 696f 6e73 3d32 290a 0a20  partitions=2).. 
-00009720: 2020 2020 2020 2041 2072 6f6c 6c69 6e67         A rolling
-00009730: 2073 756d 2077 6974 6820 6120 7472 6169   sum with a trai
-00009740: 6c69 6e67 206d 6f76 696e 6720 7769 6e64  ling moving wind
-00009750: 6f77 206f 6620 7369 7a65 2032 2063 616e  ow of size 2 can
-00009760: 2062 6520 636f 6d70 7574 6564 2062 790a   be computed by.
-00009770: 2020 2020 2020 2020 6f76 6572 6c61 7070          overlapp
-00009780: 696e 6720 3220 726f 7773 2062 6566 6f72  ing 2 rows befor
-00009790: 6520 6561 6368 2070 6172 7469 7469 6f6e  e each partition
-000097a0: 2c20 616e 6420 7468 656e 206d 6170 7069  , and then mappi
-000097b0: 6e67 2063 616c 6c73 2074 6f0a 2020 2020  ng calls to.    
-000097c0: 2020 2020 6060 6466 2e72 6f6c 6c69 6e67      ``df.rolling
-000097d0: 2832 292e 7375 6d28 2960 603a 0a0a 2020  (2).sum()``:..  
-000097e0: 2020 2020 2020 3e3e 3e20 6464 662e 636f        >>> ddf.co
-000097f0: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
-00009800: 2020 2020 7820 2020 2079 0a20 2020 2020      x    y.     
-00009810: 2020 2030 2020 2031 2020 312e 300a 2020     0   1  1.0.  
-00009820: 2020 2020 2020 3120 2020 3220 2032 2e30        1   2  2.0
-00009830: 0a20 2020 2020 2020 2032 2020 2034 2020  .        2   4  
-00009840: 332e 300a 2020 2020 2020 2020 3320 2020  3.0.        3   
-00009850: 3720 2034 2e30 0a20 2020 2020 2020 2034  7  4.0.        4
-00009860: 2020 3131 2020 352e 300a 2020 2020 2020    11  5.0.      
-00009870: 2020 3e3e 3e20 6464 662e 6d61 705f 6f76    >>> ddf.map_ov
-00009880: 6572 6c61 7028 6c61 6d62 6461 2064 663a  erlap(lambda df:
-00009890: 2064 662e 726f 6c6c 696e 6728 3229 2e73   df.rolling(2).s
-000098a0: 756d 2829 2c20 322c 2030 292e 636f 6d70  um(), 2, 0).comp
-000098b0: 7574 6528 290a 2020 2020 2020 2020 2020  ute().          
-000098c0: 2020 2020 7820 2020 2079 0a20 2020 2020      x    y.     
-000098d0: 2020 2030 2020 204e 614e 2020 4e61 4e0a     0   NaN  NaN.
-000098e0: 2020 2020 2020 2020 3120 2020 332e 3020          1   3.0 
-000098f0: 2033 2e30 0a20 2020 2020 2020 2032 2020   3.0.        2  
-00009900: 2036 2e30 2020 352e 300a 2020 2020 2020   6.0  5.0.      
-00009910: 2020 3320 2031 312e 3020 2037 2e30 0a20    3  11.0  7.0. 
-00009920: 2020 2020 2020 2034 2020 3138 2e30 2020         4  18.0  
-00009930: 392e 300a 0a20 2020 2020 2020 2054 6865  9.0..        The
-00009940: 2070 616e 6461 7320 6060 6469 6666 6060   pandas ``diff``
-00009950: 206d 6574 686f 6420 636f 6d70 7574 6573   method computes
-00009960: 2061 2064 6973 6372 6574 6520 6469 6666   a discrete diff
-00009970: 6572 656e 6365 2073 6869 6674 6564 2062  erence shifted b
-00009980: 7920 610a 2020 2020 2020 2020 6e75 6d62  y a.        numb
-00009990: 6572 206f 6620 7065 7269 6f64 7320 2863  er of periods (c
-000099a0: 616e 2062 6520 706f 7369 7469 7665 206f  an be positive o
-000099b0: 7220 6e65 6761 7469 7665 292e 2054 6869  r negative). Thi
-000099c0: 7320 6361 6e20 6265 0a20 2020 2020 2020  s can be.       
-000099d0: 2069 6d70 6c65 6d65 6e74 6564 2062 7920   implemented by 
-000099e0: 6d61 7070 696e 6720 6361 6c6c 7320 746f  mapping calls to
-000099f0: 2060 6064 662e 6469 6666 6060 2074 6f20   ``df.diff`` to 
-00009a00: 6561 6368 2070 6172 7469 7469 6f6e 2061  each partition a
-00009a10: 6674 6572 0a20 2020 2020 2020 2070 7265  fter.        pre
-00009a20: 7065 6e64 696e 672f 6170 7065 6e64 696e  pending/appendin
-00009a30: 6720 7468 6174 206d 616e 7920 726f 7773  g that many rows
-00009a40: 2c20 6465 7065 6e64 696e 6720 6f6e 2073  , depending on s
-00009a50: 6967 6e3a 0a0a 2020 2020 2020 2020 3e3e  ign:..        >>
-00009a60: 3e20 6465 6620 6469 6666 2864 662c 2070  > def diff(df, p
-00009a70: 6572 696f 6473 3d31 293a 0a20 2020 2020  eriods=1):.     
-00009a80: 2020 202e 2e2e 2020 2020 2062 6566 6f72     ...     befor
-00009a90: 652c 2061 6674 6572 203d 2028 7065 7269  e, after = (peri
-00009aa0: 6f64 732c 2030 2920 6966 2070 6572 696f  ods, 0) if perio
-00009ab0: 6473 203e 2030 2065 6c73 6520 2830 2c20  ds > 0 else (0, 
-00009ac0: 2d70 6572 696f 6473 290a 2020 2020 2020  -periods).      
-00009ad0: 2020 2e2e 2e20 2020 2020 7265 7475 726e    ...     return
-00009ae0: 2064 662e 6d61 705f 6f76 6572 6c61 7028   df.map_overlap(
-00009af0: 6c61 6d62 6461 2064 662c 2070 6572 696f  lambda df, perio
-00009b00: 6473 3d31 3a20 6466 2e64 6966 6628 7065  ds=1: df.diff(pe
-00009b10: 7269 6f64 7329 2c0a 2020 2020 2020 2020  riods),.        
-00009b20: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-00009b30: 2020 2020 2020 2020 2020 2020 2020 7065                pe
-00009b40: 7269 6f64 732c 2030 2c20 7065 7269 6f64  riods, 0, period
-00009b50: 733d 7065 7269 6f64 7329 0a20 2020 2020  s=periods).     
-00009b60: 2020 203e 3e3e 2064 6966 6628 6464 662c     >>> diff(ddf,
-00009b70: 2031 292e 636f 6d70 7574 6528 290a 2020   1).compute().  
-00009b80: 2020 2020 2020 2020 2020 2078 2020 2020             x    
-00009b90: 790a 2020 2020 2020 2020 3020 204e 614e  y.        0  NaN
-00009ba0: 2020 4e61 4e0a 2020 2020 2020 2020 3120    NaN.        1 
-00009bb0: 2031 2e30 2020 312e 300a 2020 2020 2020   1.0  1.0.      
-00009bc0: 2020 3220 2032 2e30 2020 312e 300a 2020    2  2.0  1.0.  
-00009bd0: 2020 2020 2020 3320 2033 2e30 2020 312e        3  3.0  1.
-00009be0: 300a 2020 2020 2020 2020 3420 2034 2e30  0.        4  4.0
-00009bf0: 2020 312e 300a 0a20 2020 2020 2020 2049    1.0..        I
-00009c00: 6620 796f 7520 6861 7665 2061 2060 6044  f you have a ``D
-00009c10: 6174 6574 696d 6549 6e64 6578 6060 2c20  atetimeIndex``, 
-00009c20: 796f 7520 6361 6e20 7573 6520 6120 6060  you can use a ``
-00009c30: 7064 2e54 696d 6564 656c 7461 6060 2066  pd.Timedelta`` f
-00009c40: 6f72 2074 696d 652d 0a20 2020 2020 2020  or time-.       
-00009c50: 2062 6173 6564 2077 696e 646f 7773 206f   based windows o
-00009c60: 7220 616e 7920 6060 7064 2e54 696d 6564  r any ``pd.Timed
-00009c70: 656c 7461 6060 2063 6f6e 7665 7274 6962  elta`` convertib
-00009c80: 6c65 2073 7472 696e 673a 0a0a 2020 2020  le string:..    
-00009c90: 2020 2020 3e3e 3e20 7473 203d 2070 642e      >>> ts = pd.
-00009ca0: 5365 7269 6573 2872 616e 6765 2831 3029  Series(range(10)
-00009cb0: 2c20 696e 6465 783d 7064 2e64 6174 655f  , index=pd.date_
-00009cc0: 7261 6e67 6528 2732 3031 3727 2c20 7065  range('2017', pe
-00009cd0: 7269 6f64 733d 3130 2929 0a20 2020 2020  riods=10)).     
-00009ce0: 2020 203e 3e3e 2064 7473 203d 2064 642e     >>> dts = dd.
-00009cf0: 6672 6f6d 5f70 616e 6461 7328 7473 2c20  from_pandas(ts, 
-00009d00: 6e70 6172 7469 7469 6f6e 733d 3229 0a20  npartitions=2). 
-00009d10: 2020 2020 2020 203e 3e3e 2064 7473 2e6d         >>> dts.m
-00009d20: 6170 5f6f 7665 726c 6170 286c 616d 6264  ap_overlap(lambd
-00009d30: 6120 6466 3a20 6466 2e72 6f6c 6c69 6e67  a df: df.rolling
-00009d40: 2827 3244 2729 2e73 756d 2829 2c0a 2020  ('2D').sum(),.  
-00009d50: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-00009d60: 2020 2020 2020 2020 2020 7064 2e54 696d            pd.Tim
-00009d70: 6564 656c 7461 2827 3244 2729 2c20 3029  edelta('2D'), 0)
-00009d80: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
-00009d90: 2020 2032 3031 372d 3031 2d30 3120 2020     2017-01-01   
-00009da0: 2020 302e 300a 2020 2020 2020 2020 3230    0.0.        20
-00009db0: 3137 2d30 312d 3032 2020 2020 2031 2e30  17-01-02     1.0
-00009dc0: 0a20 2020 2020 2020 2032 3031 372d 3031  .        2017-01
-00009dd0: 2d30 3320 2020 2020 332e 300a 2020 2020  -03     3.0.    
-00009de0: 2020 2020 3230 3137 2d30 312d 3034 2020      2017-01-04  
-00009df0: 2020 2035 2e30 0a20 2020 2020 2020 2032     5.0.        2
-00009e00: 3031 372d 3031 2d30 3520 2020 2020 372e  017-01-05     7.
-00009e10: 300a 2020 2020 2020 2020 3230 3137 2d30  0.        2017-0
-00009e20: 312d 3036 2020 2020 2039 2e30 0a20 2020  1-06     9.0.   
-00009e30: 2020 2020 2032 3031 372d 3031 2d30 3720       2017-01-07 
-00009e40: 2020 2031 312e 300a 2020 2020 2020 2020     11.0.        
-00009e50: 3230 3137 2d30 312d 3038 2020 2020 3133  2017-01-08    13
-00009e60: 2e30 0a20 2020 2020 2020 2032 3031 372d  .0.        2017-
-00009e70: 3031 2d30 3920 2020 2031 352e 300a 2020  01-09    15.0.  
-00009e80: 2020 2020 2020 3230 3137 2d30 312d 3130        2017-01-10
-00009e90: 2020 2020 3137 2e30 0a20 2020 2020 2020      17.0.       
-00009ea0: 2046 7265 713a 2044 2c20 6474 7970 653a   Freq: D, dtype:
-00009eb0: 2066 6c6f 6174 3634 0a20 2020 2020 2020   float64.       
-00009ec0: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-00009ed0: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
-00009ee0: 2e72 6f6c 6c69 6e67 2069 6d70 6f72 7420  .rolling import 
-00009ef0: 6d61 705f 6f76 6572 6c61 700a 0a20 2020  map_overlap..   
-00009f00: 2020 2020 2072 6574 7572 6e20 6d61 705f       return map_
-00009f10: 6f76 6572 6c61 7028 6675 6e63 2c20 7365  overlap(func, se
-00009f20: 6c66 2c20 6265 666f 7265 2c20 6166 7465  lf, before, afte
-00009f30: 722c 202a 6172 6773 2c20 2a2a 6b77 6172  r, *args, **kwar
-00009f40: 6773 290a 0a20 2020 2064 6566 206d 656d  gs)..    def mem
-00009f50: 6f72 795f 7573 6167 655f 7065 725f 7061  ory_usage_per_pa
-00009f60: 7274 6974 696f 6e28 7365 6c66 2c20 696e  rtition(self, in
-00009f70: 6465 783d 5472 7565 2c20 6465 6570 3d46  dex=True, deep=F
-00009f80: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
-00009f90: 2222 5265 7475 726e 2074 6865 206d 656d  ""Return the mem
-00009fa0: 6f72 7920 7573 6167 6520 6f66 2065 6163  ory usage of eac
-00009fb0: 6820 7061 7274 6974 696f 6e0a 0a20 2020  h partition..   
-00009fc0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00009fd0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00009fe0: 2d2d 0a20 2020 2020 2020 2069 6e64 6578  --.        index
-00009ff0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
-0000a000: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-0000a010: 2020 5370 6563 6966 6965 7320 7768 6574    Specifies whet
-0000a020: 6865 7220 746f 2069 6e63 6c75 6465 2074  her to include t
-0000a030: 6865 206d 656d 6f72 7920 7573 6167 6520  he memory usage 
-0000a040: 6f66 2074 6865 2069 6e64 6578 2069 6e0a  of the index in.
-0000a050: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000a060: 726e 6564 2053 6572 6965 732e 0a20 2020  rned Series..   
-0000a070: 2020 2020 2064 6565 7020 3a20 626f 6f6c       deep : bool
-0000a080: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
-0000a090: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-0000a0a0: 7275 652c 2069 6e74 726f 7370 6563 7420  rue, introspect 
-0000a0b0: 7468 6520 6461 7461 2064 6565 706c 7920  the data deeply 
-0000a0c0: 6279 2069 6e74 6572 726f 6761 7469 6e67  by interrogating
-0000a0d0: 0a20 2020 2020 2020 2020 2020 2060 606f  .            ``o
-0000a0e0: 626a 6563 7460 6020 6474 7970 6573 2066  bject`` dtypes f
-0000a0f0: 6f72 2073 7973 7465 6d2d 6c65 7665 6c20  or system-level 
-0000a100: 6d65 6d6f 7279 2063 6f6e 7375 6d70 7469  memory consumpti
-0000a110: 6f6e 2c20 616e 6420 696e 636c 7564 650a  on, and include.
-0000a120: 2020 2020 2020 2020 2020 2020 6974 2069              it i
-0000a130: 6e20 7468 6520 7265 7475 726e 6564 2076  n the returned v
-0000a140: 616c 7565 732e 0a0a 2020 2020 2020 2020  alues...        
-0000a150: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-0000a160: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000a170: 5365 7269 6573 0a20 2020 2020 2020 2020  Series.         
-0000a180: 2020 2041 2053 6572 6965 7320 7768 6f73     A Series whos
-0000a190: 6520 696e 6465 7820 6973 2074 6865 2070  e index is the p
-0000a1a0: 6172 7469 7469 6f6e 206e 756d 6265 7220  artition number 
-0000a1b0: 616e 6420 7768 6f73 6520 7661 6c75 6573  and whose values
-0000a1c0: 0a20 2020 2020 2020 2020 2020 2061 7265  .            are
-0000a1d0: 2074 6865 206d 656d 6f72 7920 7573 6167   the memory usag
-0000a1e0: 6520 6f66 2065 6163 6820 7061 7274 6974  e of each partit
-0000a1f0: 696f 6e20 696e 2062 7974 6573 2e0a 2020  ion in bytes..  
-0000a200: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000a210: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-0000a220: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-0000a230: 2020 2020 2020 2020 2020 746f 7461 6c5f            total_
-0000a240: 6d65 6d5f 7573 6167 652c 2069 6e64 6578  mem_usage, index
-0000a250: 3d69 6e64 6578 2c20 6465 6570 3d64 6565  =index, deep=dee
-0000a260: 700a 2020 2020 2020 2020 292e 636c 6561  p.        ).clea
-0000a270: 725f 6469 7669 7369 6f6e 7328 290a 0a20  r_divisions().. 
-0000a280: 2020 2040 696e 7365 7274 5f6d 6574 615f     @insert_meta_
-0000a290: 7061 7261 6d5f 6465 7363 7269 7074 696f  param_descriptio
-0000a2a0: 6e28 7061 643d 3132 290a 2020 2020 6465  n(pad=12).    de
-0000a2b0: 6620 7265 6475 6374 696f 6e28 0a20 2020  f reduction(.   
-0000a2c0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000a2d0: 2020 2063 6875 6e6b 2c0a 2020 2020 2020     chunk,.      
-0000a2e0: 2020 6167 6772 6567 6174 653d 4e6f 6e65    aggregate=None
-0000a2f0: 2c0a 2020 2020 2020 2020 636f 6d62 696e  ,.        combin
-0000a300: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-0000a310: 6d65 7461 3d6e 6f5f 6465 6661 756c 742c  meta=no_default,
-0000a320: 0a20 2020 2020 2020 2074 6f6b 656e 3d4e  .        token=N
-0000a330: 6f6e 652c 0a20 2020 2020 2020 2073 706c  one,.        spl
-0000a340: 6974 5f65 7665 7279 3d4e 6f6e 652c 0a20  it_every=None,. 
-0000a350: 2020 2020 2020 2063 6875 6e6b 5f6b 7761         chunk_kwa
-0000a360: 7267 733d 4e6f 6e65 2c0a 2020 2020 2020  rgs=None,.      
-0000a370: 2020 6167 6772 6567 6174 655f 6b77 6172    aggregate_kwar
-0000a380: 6773 3d4e 6f6e 652c 0a20 2020 2020 2020  gs=None,.       
-0000a390: 2063 6f6d 6269 6e65 5f6b 7761 7267 733d   combine_kwargs=
-0000a3a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2a2a  None,.        **
-0000a3b0: 6b77 6172 6773 2c0a 2020 2020 293a 0a20  kwargs,.    ):. 
-0000a3c0: 2020 2020 2020 2022 2222 4765 6e65 7269         """Generi
-0000a3d0: 6320 726f 772d 7769 7365 2072 6564 7563  c row-wise reduc
-0000a3e0: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
-0000a3f0: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-0000a400: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-0000a410: 2020 2020 2020 6368 756e 6b20 3a20 6361        chunk : ca
-0000a420: 6c6c 6162 6c65 0a20 2020 2020 2020 2020  llable.         
-0000a430: 2020 2046 756e 6374 696f 6e20 746f 206f     Function to o
-0000a440: 7065 7261 7465 206f 6e20 6561 6368 2070  perate on each p
-0000a450: 6172 7469 7469 6f6e 2e20 5368 6f75 6c64  artition. Should
-0000a460: 2072 6574 7572 6e20 610a 2020 2020 2020   return a.      
-0000a470: 2020 2020 2020 6060 7061 6e64 6173 2e44        ``pandas.D
-0000a480: 6174 6146 7261 6d65 6060 2c20 6060 7061  ataFrame``, ``pa
-0000a490: 6e64 6173 2e53 6572 6965 7360 602c 206f  ndas.Series``, o
-0000a4a0: 7220 6120 7363 616c 6172 2e0a 2020 2020  r a scalar..    
-0000a4b0: 2020 2020 6167 6772 6567 6174 6520 3a20      aggregate : 
-0000a4c0: 6361 6c6c 6162 6c65 2c20 6f70 7469 6f6e  callable, option
-0000a4d0: 616c 0a20 2020 2020 2020 2020 2020 2046  al.            F
-0000a4e0: 756e 6374 696f 6e20 746f 206f 7065 7261  unction to opera
-0000a4f0: 7465 206f 6e20 7468 6520 636f 6e63 6174  te on the concat
-0000a500: 656e 6174 6564 2072 6573 756c 7420 6f66  enated result of
-0000a510: 2060 6063 6875 6e6b 6060 2e20 4966 206e   ``chunk``. If n
-0000a520: 6f74 0a20 2020 2020 2020 2020 2020 2073  ot.            s
-0000a530: 7065 6369 6669 6564 2c20 6465 6661 756c  pecified, defaul
-0000a540: 7473 2074 6f20 6060 6368 756e 6b60 602e  ts to ``chunk``.
-0000a550: 2055 7365 6420 746f 2064 6f20 7468 6520   Used to do the 
-0000a560: 6669 6e61 6c20 6167 6772 6567 6174 696f  final aggregatio
-0000a570: 6e0a 2020 2020 2020 2020 2020 2020 696e  n.            in
-0000a580: 2061 2074 7265 6520 7265 6475 6374 696f   a tree reductio
-0000a590: 6e2e 0a0a 2020 2020 2020 2020 2020 2020  n...            
-0000a5a0: 5468 6520 696e 7075 7420 746f 2060 6061  The input to ``a
-0000a5b0: 6767 7265 6761 7465 6060 2064 6570 656e  ggregate`` depen
-0000a5c0: 6473 206f 6e20 7468 6520 6f75 7470 7574  ds on the output
-0000a5d0: 206f 6620 6060 6368 756e 6b60 602e 0a20   of ``chunk``.. 
-0000a5e0: 2020 2020 2020 2020 2020 2049 6620 7468             If th
-0000a5f0: 6520 6f75 7470 7574 206f 6620 6060 6368  e output of ``ch
-0000a600: 756e 6b60 6020 6973 2061 3a0a 0a20 2020  unk`` is a:..   
-0000a610: 2020 2020 2020 2020 202d 2073 6361 6c61           - scala
-0000a620: 723a 2049 6e70 7574 2069 7320 6120 5365  r: Input is a Se
-0000a630: 7269 6573 2c20 7769 7468 206f 6e65 2072  ries, with one r
-0000a640: 6f77 2070 6572 2070 6172 7469 7469 6f6e  ow per partition
-0000a650: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0000a660: 5365 7269 6573 3a20 496e 7075 7420 6973  Series: Input is
-0000a670: 2061 2044 6174 6146 7261 6d65 2c20 7769   a DataFrame, wi
-0000a680: 7468 206f 6e65 2072 6f77 2070 6572 2070  th one row per p
-0000a690: 6172 7469 7469 6f6e 2e20 436f 6c75 6d6e  artition. Column
-0000a6a0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-0000a6b0: 6172 6520 7468 6520 726f 7773 2069 6e20  are the rows in 
-0000a6c0: 7468 6520 6f75 7470 7574 2073 6572 6965  the output serie
-0000a6d0: 732e 0a20 2020 2020 2020 2020 2020 202d  s..            -
-0000a6e0: 2044 6174 6146 7261 6d65 3a20 496e 7075   DataFrame: Inpu
-0000a6f0: 7420 6973 2061 2044 6174 6146 7261 6d65  t is a DataFrame
-0000a700: 2c20 7769 7468 206f 6e65 2072 6f77 2070  , with one row p
-0000a710: 6572 2070 6172 7469 7469 6f6e 2e0a 2020  er partition..  
-0000a720: 2020 2020 2020 2020 2020 2020 436f 6c75              Colu
-0000a730: 6d6e 7320 6172 6520 7468 6520 636f 6c75  mns are the colu
-0000a740: 6d6e 7320 696e 2074 6865 206f 7574 7075  mns in the outpu
-0000a750: 7420 6461 7461 6672 616d 6573 2e0a 0a20  t dataframes... 
-0000a760: 2020 2020 2020 2020 2020 2053 686f 756c             Shoul
-0000a770: 6420 7265 7475 726e 2061 2060 6070 616e  d return a ``pan
-0000a780: 6461 732e 4461 7461 4672 616d 6560 602c  das.DataFrame``,
-0000a790: 2060 6070 616e 6461 732e 5365 7269 6573   ``pandas.Series
-0000a7a0: 6060 2c20 6f72 2061 0a20 2020 2020 2020  ``, or a.       
-0000a7b0: 2020 2020 2073 6361 6c61 722e 0a20 2020       scalar..   
-0000a7c0: 2020 2020 2063 6f6d 6269 6e65 203a 2063       combine : c
-0000a7d0: 616c 6c61 626c 652c 206f 7074 696f 6e61  allable, optiona
-0000a7e0: 6c0a 2020 2020 2020 2020 2020 2020 4675  l.            Fu
-0000a7f0: 6e63 7469 6f6e 2074 6f20 6f70 6572 6174  nction to operat
-0000a800: 6520 6f6e 2069 6e74 6572 6d65 6469 6174  e on intermediat
-0000a810: 6520 636f 6e63 6174 656e 6174 6564 2072  e concatenated r
-0000a820: 6573 756c 7473 206f 660a 2020 2020 2020  esults of.      
-0000a830: 2020 2020 2020 6060 6368 756e 6b60 6020        ``chunk`` 
-0000a840: 696e 2061 2074 7265 652d 7265 6475 6374  in a tree-reduct
-0000a850: 696f 6e2e 2049 6620 6e6f 7420 7072 6f76  ion. If not prov
-0000a860: 6964 6564 2c20 6465 6661 756c 7473 2074  ided, defaults t
-0000a870: 6f0a 2020 2020 2020 2020 2020 2020 6060  o.            ``
-0000a880: 6167 6772 6567 6174 6560 602e 2054 6865  aggregate``. The
-0000a890: 2069 6e70 7574 2f6f 7574 7075 7420 7265   input/output re
-0000a8a0: 7175 6972 656d 656e 7473 2073 686f 756c  quirements shoul
-0000a8b0: 6420 6d61 7463 6820 7468 6174 206f 660a  d match that of.
-0000a8c0: 2020 2020 2020 2020 2020 2020 6060 6167              ``ag
-0000a8d0: 6772 6567 6174 6560 6020 6465 7363 7269  gregate`` descri
-0000a8e0: 6265 6420 6162 6f76 652e 0a20 2020 2020  bed above..     
-0000a8f0: 2020 2024 4d45 5441 0a20 2020 2020 2020     $META.       
-0000a900: 2074 6f6b 656e 203a 2073 7472 2c20 6f70   token : str, op
-0000a910: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0000a920: 2020 2054 6865 206e 616d 6520 746f 2075     The name to u
-0000a930: 7365 2066 6f72 2074 6865 206f 7574 7075  se for the outpu
-0000a940: 7420 6b65 7973 2e0a 2020 2020 2020 2020  t keys..        
-0000a950: 7370 6c69 745f 6576 6572 7920 3a20 696e  split_every : in
-0000a960: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-0000a970: 2020 2020 2020 2020 4772 6f75 7020 7061          Group pa
-0000a980: 7274 6974 696f 6e73 2069 6e74 6f20 6772  rtitions into gr
-0000a990: 6f75 7073 206f 6620 7468 6973 2073 697a  oups of this siz
-0000a9a0: 6520 7768 696c 6520 7065 7266 6f72 6d69  e while performi
-0000a9b0: 6e67 2061 0a20 2020 2020 2020 2020 2020  ng a.           
-0000a9c0: 2074 7265 652d 7265 6475 6374 696f 6e2e   tree-reduction.
-0000a9d0: 2049 6620 7365 7420 746f 2046 616c 7365   If set to False
-0000a9e0: 2c20 6e6f 2074 7265 652d 7265 6475 6374  , no tree-reduct
-0000a9f0: 696f 6e20 7769 6c6c 2062 6520 7573 6564  ion will be used
-0000aa00: 2c0a 2020 2020 2020 2020 2020 2020 616e  ,.            an
-0000aa10: 6420 616c 6c20 696e 7465 726d 6564 6961  d all intermedia
-0000aa20: 7465 7320 7769 6c6c 2062 6520 636f 6e63  tes will be conc
-0000aa30: 6174 656e 6174 6564 2061 6e64 2070 6173  atenated and pas
-0000aa40: 7365 6420 746f 0a20 2020 2020 2020 2020  sed to.         
-0000aa50: 2020 2060 6061 6767 7265 6761 7465 6060     ``aggregate``
-0000aa60: 2e20 4465 6661 756c 7420 6973 2038 2e0a  . Default is 8..
-0000aa70: 2020 2020 2020 2020 6368 756e 6b5f 6b77          chunk_kw
-0000aa80: 6172 6773 203a 2064 6963 742c 206f 7074  args : dict, opt
-0000aa90: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0000aaa0: 2020 4b65 7977 6f72 6420 6172 6775 6d65    Keyword argume
-0000aab0: 6e74 7320 746f 2070 6173 7320 6f6e 2074  nts to pass on t
-0000aac0: 6f20 6060 6368 756e 6b60 6020 6f6e 6c79  o ``chunk`` only
-0000aad0: 2e0a 2020 2020 2020 2020 6167 6772 6567  ..        aggreg
-0000aae0: 6174 655f 6b77 6172 6773 203a 2064 6963  ate_kwargs : dic
-0000aaf0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-0000ab00: 2020 2020 2020 2020 4b65 7977 6f72 6420          Keyword 
-0000ab10: 6172 6775 6d65 6e74 7320 746f 2070 6173  arguments to pas
-0000ab20: 7320 6f6e 2074 6f20 6060 6167 6772 6567  s on to ``aggreg
-0000ab30: 6174 6560 6020 6f6e 6c79 2e0a 2020 2020  ate`` only..    
-0000ab40: 2020 2020 636f 6d62 696e 655f 6b77 6172      combine_kwar
-0000ab50: 6773 203a 2064 6963 742c 206f 7074 696f  gs : dict, optio
-0000ab60: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-0000ab70: 4b65 7977 6f72 6420 6172 6775 6d65 6e74  Keyword argument
-0000ab80: 7320 746f 2070 6173 7320 6f6e 2074 6f20  s to pass on to 
-0000ab90: 6060 636f 6d62 696e 6560 6020 6f6e 6c79  ``combine`` only
-0000aba0: 2e0a 2020 2020 2020 2020 6b77 6172 6773  ..        kwargs
-0000abb0: 203a 0a20 2020 2020 2020 2020 2020 2041   :.            A
-0000abc0: 6c6c 2072 656d 6169 6e69 6e67 206b 6579  ll remaining key
-0000abd0: 776f 7264 7320 7769 6c6c 2062 6520 7061  words will be pa
-0000abe0: 7373 6564 2074 6f20 6060 6368 756e 6b60  ssed to ``chunk`
-0000abf0: 602c 2060 6063 6f6d 6269 6e65 6060 2c0a  `, ``combine``,.
-0000ac00: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-0000ac10: 6060 6167 6772 6567 6174 6560 602e 0a0a  ``aggregate``...
-0000ac20: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-0000ac30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000ac40: 2d0a 2020 2020 2020 2020 3e3e 3e20 696d  -.        >>> im
-0000ac50: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
-0000ac60: 640a 2020 2020 2020 2020 3e3e 3e20 696d  d.        >>> im
-0000ac70: 706f 7274 2064 6173 6b2e 6461 7461 6672  port dask.datafr
-0000ac80: 616d 6520 6173 2064 640a 2020 2020 2020  ame as dd.      
-0000ac90: 2020 3e3e 3e20 6466 203d 2070 642e 4461    >>> df = pd.Da
-0000aca0: 7461 4672 616d 6528 7b27 7827 3a20 7261  taFrame({'x': ra
-0000acb0: 6e67 6528 3530 292c 2027 7927 3a20 7261  nge(50), 'y': ra
-0000acc0: 6e67 6528 3530 2c20 3130 3029 7d29 0a20  nge(50, 100)}). 
-0000acd0: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
-0000ace0: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
-0000acf0: 6466 2c20 6e70 6172 7469 7469 6f6e 733d  df, npartitions=
-0000ad00: 3429 0a0a 2020 2020 2020 2020 436f 756e  4)..        Coun
-0000ad10: 7420 7468 6520 6e75 6d62 6572 206f 6620  t the number of 
-0000ad20: 726f 7773 2069 6e20 6120 4461 7461 4672  rows in a DataFr
-0000ad30: 616d 652e 2054 6f20 646f 2074 6869 732c  ame. To do this,
-0000ad40: 2063 6f75 6e74 2074 6865 206e 756d 6265   count the numbe
-0000ad50: 720a 2020 2020 2020 2020 6f66 2072 6f77  r.        of row
-0000ad60: 7320 696e 2065 6163 6820 7061 7274 6974  s in each partit
-0000ad70: 696f 6e2c 2074 6865 6e20 7375 6d20 7468  ion, then sum th
-0000ad80: 6520 7265 7375 6c74 733a 0a0a 2020 2020  e results:..    
-0000ad90: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
-0000ada0: 662e 7265 6475 6374 696f 6e28 6c61 6d62  f.reduction(lamb
-0000adb0: 6461 2078 3a20 782e 636f 756e 7428 292c  da x: x.count(),
-0000adc0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0000add0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ade0: 2061 6767 7265 6761 7465 3d6c 616d 6264   aggregate=lambd
-0000adf0: 6120 783a 2078 2e73 756d 2829 290a 2020  a x: x.sum()).  
-0000ae00: 2020 2020 2020 3e3e 3e20 7265 732e 636f        >>> res.co
-0000ae10: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
-0000ae20: 7820 2020 2035 300a 2020 2020 2020 2020  x    50.        
-0000ae30: 7920 2020 2035 300a 2020 2020 2020 2020  y    50.        
-0000ae40: 6474 7970 653a 2069 6e74 3634 0a0a 2020  dtype: int64..  
-0000ae50: 2020 2020 2020 436f 756e 7420 7468 6520        Count the 
-0000ae60: 6e75 6d62 6572 206f 6620 726f 7773 2069  number of rows i
-0000ae70: 6e20 6120 5365 7269 6573 2077 6974 6820  n a Series with 
-0000ae80: 656c 656d 656e 7473 2067 7265 6174 6572  elements greater
-0000ae90: 2074 6861 6e20 6f72 0a20 2020 2020 2020   than or.       
-0000aea0: 2065 7175 616c 2074 6f20 6120 7661 6c75   equal to a valu
-0000aeb0: 6520 2870 726f 7669 6465 6420 7669 6120  e (provided via 
-0000aec0: 6120 6b65 7977 6f72 6429 2e0a 0a20 2020  a keyword)...   
-0000aed0: 2020 2020 203e 3e3e 2064 6566 2063 6f75       >>> def cou
-0000aee0: 6e74 5f67 7265 6174 6572 2878 2c20 7661  nt_greater(x, va
-0000aef0: 6c75 653d 3029 3a0a 2020 2020 2020 2020  lue=0):.        
-0000af00: 2e2e 2e20 2020 2020 7265 7475 726e 2028  ...     return (
-0000af10: 7820 3e3d 2076 616c 7565 292e 7375 6d28  x >= value).sum(
-0000af20: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
-0000af30: 7320 3d20 6464 662e 782e 7265 6475 6374  s = ddf.x.reduct
-0000af40: 696f 6e28 636f 756e 745f 6772 6561 7465  ion(count_greate
-0000af50: 722c 2061 6767 7265 6761 7465 3d6c 616d  r, aggregate=lam
-0000af60: 6264 6120 783a 2078 2e73 756d 2829 2c0a  bda x: x.sum(),.
-0000af70: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0000af80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af90: 2020 6368 756e 6b5f 6b77 6172 6773 3d7b    chunk_kwargs={
-0000afa0: 2776 616c 7565 273a 2032 357d 290a 2020  'value': 25}).  
-0000afb0: 2020 2020 2020 3e3e 3e20 7265 732e 636f        >>> res.co
-0000afc0: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
-0000afd0: 3235 0a0a 2020 2020 2020 2020 4167 6772  25..        Aggr
-0000afe0: 6567 6174 6520 626f 7468 2074 6865 2073  egate both the s
-0000aff0: 756d 2061 6e64 2063 6f75 6e74 206f 6620  um and count of 
-0000b000: 6120 5365 7269 6573 2061 7420 7468 6520  a Series at the 
-0000b010: 7361 6d65 2074 696d 653a 0a0a 2020 2020  same time:..    
-0000b020: 2020 2020 3e3e 3e20 6465 6620 7375 6d5f      >>> def sum_
-0000b030: 616e 645f 636f 756e 7428 7829 3a0a 2020  and_count(x):.  
-0000b040: 2020 2020 2020 2e2e 2e20 2020 2020 7265        ...     re
-0000b050: 7475 726e 2070 642e 5365 7269 6573 287b  turn pd.Series({
-0000b060: 2763 6f75 6e74 273a 2078 2e63 6f75 6e74  'count': x.count
-0000b070: 2829 2c20 2773 756d 273a 2078 2e73 756d  (), 'sum': x.sum
-0000b080: 2829 7d2c 0a20 2020 2020 2020 202e 2e2e  ()},.        ...
-0000b090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b0a0: 2020 2020 2020 696e 6465 783d 5b27 636f        index=['co
-0000b0b0: 756e 7427 2c20 2773 756d 275d 290a 2020  unt', 'sum']).  
-0000b0c0: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
-0000b0d0: 6464 662e 782e 7265 6475 6374 696f 6e28  ddf.x.reduction(
-0000b0e0: 7375 6d5f 616e 645f 636f 756e 742c 2061  sum_and_count, a
-0000b0f0: 6767 7265 6761 7465 3d6c 616d 6264 6120  ggregate=lambda 
-0000b100: 783a 2078 2e73 756d 2829 290a 2020 2020  x: x.sum()).    
-0000b110: 2020 2020 3e3e 3e20 7265 732e 636f 6d70      >>> res.comp
-0000b120: 7574 6528 290a 2020 2020 2020 2020 636f  ute().        co
-0000b130: 756e 7420 2020 2020 2035 300a 2020 2020  unt      50.    
-0000b140: 2020 2020 7375 6d20 2020 2020 2031 3232      sum      122
-0000b150: 350a 2020 2020 2020 2020 6474 7970 653a  5.        dtype:
-0000b160: 2069 6e74 3634 0a0a 2020 2020 2020 2020   int64..        
-0000b170: 446f 696e 6720 7468 6520 7361 6d65 2c20  Doing the same, 
-0000b180: 6275 7420 666f 7220 6120 4461 7461 4672  but for a DataFr
-0000b190: 616d 652e 2048 6572 6520 6060 6368 756e  ame. Here ``chun
-0000b1a0: 6b60 6020 7265 7475 726e 7320 610a 2020  k`` returns a.  
-0000b1b0: 2020 2020 2020 4461 7461 4672 616d 652c        DataFrame,
-0000b1c0: 206d 6561 6e69 6e67 2074 6865 2069 6e70   meaning the inp
-0000b1d0: 7574 2074 6f20 6060 6167 6772 6567 6174  ut to ``aggregat
-0000b1e0: 6560 6020 6973 2061 2044 6174 6146 7261  e`` is a DataFra
-0000b1f0: 6d65 2077 6974 6820 616e 0a20 2020 2020  me with an.     
-0000b200: 2020 2069 6e64 6578 2077 6974 6820 6e6f     index with no
-0000b210: 6e2d 756e 6971 7565 2065 6e74 7269 6573  n-unique entries
-0000b220: 2066 6f72 2062 6f74 6820 2778 2720 616e   for both 'x' an
-0000b230: 6420 2779 272e 2057 6520 6772 6f75 7062  d 'y'. We groupb
-0000b240: 7920 7468 650a 2020 2020 2020 2020 696e  y the.        in
-0000b250: 6465 782c 2061 6e64 2073 756d 2065 6163  dex, and sum eac
-0000b260: 6820 6772 6f75 7020 746f 2067 6574 2074  h group to get t
-0000b270: 6865 2066 696e 616c 2072 6573 756c 742e  he final result.
-0000b280: 0a0a 2020 2020 2020 2020 3e3e 3e20 6465  ..        >>> de
-0000b290: 6620 7375 6d5f 616e 645f 636f 756e 7428  f sum_and_count(
-0000b2a0: 7829 3a0a 2020 2020 2020 2020 2e2e 2e20  x):.        ... 
-0000b2b0: 2020 2020 7265 7475 726e 2070 642e 4461      return pd.Da
-0000b2c0: 7461 4672 616d 6528 7b27 636f 756e 7427  taFrame({'count'
-0000b2d0: 3a20 782e 636f 756e 7428 292c 2027 7375  : x.count(), 'su
-0000b2e0: 6d27 3a20 782e 7375 6d28 297d 2c0a 2020  m': x.sum()},.  
-0000b2f0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0000b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b310: 2020 636f 6c75 6d6e 733d 5b27 636f 756e    columns=['coun
-0000b320: 7427 2c20 2773 756d 275d 290a 2020 2020  t', 'sum']).    
-0000b330: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
-0000b340: 662e 7265 6475 6374 696f 6e28 7375 6d5f  f.reduction(sum_
-0000b350: 616e 645f 636f 756e 742c 0a20 2020 2020  and_count,.     
-0000b360: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-0000b370: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
-0000b380: 6761 7465 3d6c 616d 6264 6120 783a 2078  gate=lambda x: x
-0000b390: 2e67 726f 7570 6279 286c 6576 656c 3d30  .groupby(level=0
-0000b3a0: 292e 7375 6d28 2929 0a20 2020 2020 2020  ).sum()).       
-0000b3b0: 203e 3e3e 2072 6573 2e63 6f6d 7075 7465   >>> res.compute
-0000b3c0: 2829 0a20 2020 2020 2020 2020 2020 636f  ().           co
-0000b3d0: 756e 7420 2020 7375 6d0a 2020 2020 2020  unt   sum.      
-0000b3e0: 2020 7820 2020 2020 3530 2020 3132 3235    x     50  1225
-0000b3f0: 0a20 2020 2020 2020 2079 2020 2020 2035  .        y     5
-0000b400: 3020 2033 3732 350a 2020 2020 2020 2020  0  3725.        
-0000b410: 2222 220a 2020 2020 2020 2020 6966 2061  """.        if a
-0000b420: 6767 7265 6761 7465 2069 7320 4e6f 6e65  ggregate is None
-0000b430: 3a0a 2020 2020 2020 2020 2020 2020 6167  :.            ag
-0000b440: 6772 6567 6174 6520 3d20 6368 756e 6b0a  gregate = chunk.
-0000b450: 0a20 2020 2020 2020 2069 6620 636f 6d62  .        if comb
-0000b460: 696e 6520 6973 204e 6f6e 653a 0a20 2020  ine is None:.   
-0000b470: 2020 2020 2020 2020 2069 6620 636f 6d62           if comb
-0000b480: 696e 655f 6b77 6172 6773 3a0a 2020 2020  ine_kwargs:.    
-0000b490: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000b4a0: 6520 5661 6c75 6545 7272 6f72 2822 6063  e ValueError("`c
-0000b4b0: 6f6d 6269 6e65 5f6b 7761 7267 7360 2070  ombine_kwargs` p
-0000b4c0: 726f 7669 6465 6420 7769 7468 206e 6f20  rovided with no 
-0000b4d0: 6063 6f6d 6269 6e65 6022 290a 2020 2020  `combine`").    
-0000b4e0: 2020 2020 2020 2020 636f 6d62 696e 6520          combine 
-0000b4f0: 3d20 6167 6772 6567 6174 650a 2020 2020  = aggregate.    
-0000b500: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
-0000b510: 6b77 6172 6773 203d 2061 6767 7265 6761  kwargs = aggrega
-0000b520: 7465 5f6b 7761 7267 730a 0a20 2020 2020  te_kwargs..     
-0000b530: 2020 2063 6875 6e6b 5f6b 7761 7267 7320     chunk_kwargs 
-0000b540: 3d20 6368 756e 6b5f 6b77 6172 6773 2e63  = chunk_kwargs.c
-0000b550: 6f70 7928 2920 6966 2063 6875 6e6b 5f6b  opy() if chunk_k
-0000b560: 7761 7267 7320 656c 7365 207b 7d0a 2020  wargs else {}.  
-0000b570: 2020 2020 2020 6368 756e 6b5f 6b77 6172        chunk_kwar
-0000b580: 6773 5b22 6163 615f 6368 756e 6b22 5d20  gs["aca_chunk"] 
-0000b590: 3d20 6368 756e 6b0a 0a20 2020 2020 2020  = chunk..       
-0000b5a0: 2063 6f6d 6269 6e65 5f6b 7761 7267 7320   combine_kwargs 
-0000b5b0: 3d20 636f 6d62 696e 655f 6b77 6172 6773  = combine_kwargs
-0000b5c0: 2e63 6f70 7928 2920 6966 2063 6f6d 6269  .copy() if combi
-0000b5d0: 6e65 5f6b 7761 7267 7320 656c 7365 207b  ne_kwargs else {
-0000b5e0: 7d0a 2020 2020 2020 2020 636f 6d62 696e  }.        combin
-0000b5f0: 655f 6b77 6172 6773 5b22 6163 615f 636f  e_kwargs["aca_co
-0000b600: 6d62 696e 6522 5d20 3d20 636f 6d62 696e  mbine"] = combin
-0000b610: 650a 0a20 2020 2020 2020 2061 6767 7265  e..        aggre
-0000b620: 6761 7465 5f6b 7761 7267 7320 3d20 6167  gate_kwargs = ag
-0000b630: 6772 6567 6174 655f 6b77 6172 6773 2e63  gregate_kwargs.c
-0000b640: 6f70 7928 2920 6966 2061 6767 7265 6761  opy() if aggrega
-0000b650: 7465 5f6b 7761 7267 7320 656c 7365 207b  te_kwargs else {
-0000b660: 7d0a 2020 2020 2020 2020 6167 6772 6567  }.        aggreg
-0000b670: 6174 655f 6b77 6172 6773 5b22 6163 615f  ate_kwargs["aca_
-0000b680: 6167 6772 6567 6174 6522 5d20 3d20 6167  aggregate"] = ag
-0000b690: 6772 6567 6174 650a 0a20 2020 2020 2020  gregate..       
-0000b6a0: 2072 6574 7572 6e20 6163 6128 0a20 2020   return aca(.   
-0000b6b0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-0000b6c0: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
-0000b6d0: 3d5f 7265 6475 6374 696f 6e5f 6368 756e  =_reduction_chun
-0000b6e0: 6b2c 0a20 2020 2020 2020 2020 2020 2061  k,.            a
-0000b6f0: 6767 7265 6761 7465 3d5f 7265 6475 6374  ggregate=_reduct
-0000b700: 696f 6e5f 6167 6772 6567 6174 652c 0a20  ion_aggregate,. 
-0000b710: 2020 2020 2020 2020 2020 2063 6f6d 6269             combi
-0000b720: 6e65 3d5f 7265 6475 6374 696f 6e5f 636f  ne=_reduction_co
-0000b730: 6d62 696e 652c 0a20 2020 2020 2020 2020  mbine,.         
-0000b740: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
-0000b750: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
-0000b760: 746f 6b65 6e2c 0a20 2020 2020 2020 2020  token,.         
-0000b770: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
-0000b780: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
-0000b790: 2020 2020 2020 2020 6368 756e 6b5f 6b77          chunk_kw
-0000b7a0: 6172 6773 3d63 6875 6e6b 5f6b 7761 7267  args=chunk_kwarg
-0000b7b0: 732c 0a20 2020 2020 2020 2020 2020 2061  s,.            a
-0000b7c0: 6767 7265 6761 7465 5f6b 7761 7267 733d  ggregate_kwargs=
-0000b7d0: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
-0000b7e0: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
-0000b7f0: 6d62 696e 655f 6b77 6172 6773 3d63 6f6d  mbine_kwargs=com
-0000b800: 6269 6e65 5f6b 7761 7267 732c 0a20 2020  bine_kwargs,.   
-0000b810: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
-0000b820: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
-0000b830: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-0000b840: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-0000b850: 2020 6465 6620 7069 7065 2873 656c 662c    def pipe(self,
-0000b860: 2066 756e 632c 202a 6172 6773 2c20 2a2a   func, *args, **
-0000b870: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-0000b880: 2023 2054 616b 656e 2066 726f 6d20 7061   # Taken from pa
-0000b890: 6e64 6173 3a0a 2020 2020 2020 2020 2320  ndas:.        # 
-0000b8a0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-0000b8b0: 6f6d 2f70 7964 6174 612f 7061 6e64 6173  om/pydata/pandas
-0000b8c0: 2f62 6c6f 622f 6d61 7374 6572 2f70 616e  /blob/master/pan
-0000b8d0: 6461 732f 636f 7265 2f67 656e 6572 6963  das/core/generic
-0000b8e0: 2e70 7923 4c32 3639 382d 4c32 3730 370a  .py#L2698-L2707.
-0000b8f0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0000b900: 7461 6e63 6528 6675 6e63 2c20 7475 706c  tance(func, tupl
-0000b910: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-0000b920: 6675 6e63 2c20 7461 7267 6574 203d 2066  func, target = f
-0000b930: 756e 630a 2020 2020 2020 2020 2020 2020  unc.            
-0000b940: 6966 2074 6172 6765 7420 696e 206b 7761  if target in kwa
-0000b950: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-0000b960: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000b970: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0000b980: 2020 2020 2020 2020 2020 2022 2573 2069             "%s i
-0000b990: 7320 626f 7468 2074 6865 2070 6970 6520  s both the pipe 
-0000b9a0: 7461 7267 6574 2061 6e64 2061 206b 6579  target and a key
-0000b9b0: 776f 7264 2061 7267 756d 656e 7422 2025  word argument" %
-0000b9c0: 2074 6172 6765 740a 2020 2020 2020 2020   target.        
-0000b9d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000b9e0: 2020 2020 2020 6b77 6172 6773 5b74 6172        kwargs[tar
-0000b9f0: 6765 745d 203d 2073 656c 660a 2020 2020  get] = self.    
-0000ba00: 2020 2020 2020 2020 7265 7475 726e 2066          return f
-0000ba10: 756e 6328 2a61 7267 732c 202a 2a6b 7761  unc(*args, **kwa
-0000ba20: 7267 7329 0a20 2020 2020 2020 2065 6c73  rgs).        els
-0000ba30: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000ba40: 6574 7572 6e20 6675 6e63 2873 656c 662c  eturn func(self,
-0000ba50: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-0000ba60: 290a 0a20 2020 2064 6566 2072 616e 646f  )..    def rando
-0000ba70: 6d5f 7370 6c69 7428 7365 6c66 2c20 6672  m_split(self, fr
-0000ba80: 6163 2c20 7261 6e64 6f6d 5f73 7461 7465  ac, random_state
-0000ba90: 3d4e 6f6e 652c 2073 6875 6666 6c65 3d46  =None, shuffle=F
-0000baa0: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
-0000bab0: 2222 5073 6575 646f 7261 6e64 6f6d 6c79  ""Pseudorandomly
-0000bac0: 2073 706c 6974 2064 6174 6166 7261 6d65   split dataframe
-0000bad0: 2069 6e74 6f20 6469 6666 6572 656e 7420   into different 
-0000bae0: 7069 6563 6573 2072 6f77 2d77 6973 650a  pieces row-wise.
-0000baf0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0000bb00: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-0000bb10: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2066  ------.        f
-0000bb20: 7261 6320 3a20 6c69 7374 0a20 2020 2020  rac : list.     
-0000bb30: 2020 2020 2020 204c 6973 7420 6f66 2066         List of f
-0000bb40: 6c6f 6174 7320 7468 6174 2073 686f 756c  loats that shoul
-0000bb50: 6420 7375 6d20 746f 206f 6e65 2e0a 2020  d sum to one..  
-0000bb60: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
-0000bb70: 7465 203a 2069 6e74 206f 7220 6e70 2e72  te : int or np.r
-0000bb80: 616e 646f 6d2e 5261 6e64 6f6d 5374 6174  andom.RandomStat
-0000bb90: 650a 2020 2020 2020 2020 2020 2020 4966  e.            If
-0000bba0: 2069 6e74 2063 7265 6174 6520 6120 6e65   int create a ne
-0000bbb0: 7720 5261 6e64 6f6d 5374 6174 6520 7769  w RandomState wi
-0000bbc0: 7468 2074 6869 7320 6173 2074 6865 2073  th this as the s
-0000bbd0: 6565 642e 0a20 2020 2020 2020 2020 2020  eed..           
-0000bbe0: 204f 7468 6572 7769 7365 2064 7261 7720   Otherwise draw 
-0000bbf0: 6672 6f6d 2074 6865 2070 6173 7365 6420  from the passed 
-0000bc00: 5261 6e64 6f6d 5374 6174 652e 0a20 2020  RandomState..   
-0000bc10: 2020 2020 2073 6875 6666 6c65 203a 2062       shuffle : b
-0000bc20: 6f6f 6c2c 2064 6566 6175 6c74 2046 616c  ool, default Fal
-0000bc30: 7365 0a20 2020 2020 2020 2020 2020 2049  se.            I
-0000bc40: 6620 7365 7420 746f 2054 7275 652c 2074  f set to True, t
-0000bc50: 6865 2064 6174 6166 7261 6d65 2069 7320  he dataframe is 
-0000bc60: 7368 7566 666c 6564 2028 7769 7468 696e  shuffled (within
-0000bc70: 2070 6172 7469 7469 6f6e 290a 2020 2020   partition).    
-0000bc80: 2020 2020 2020 2020 6265 666f 7265 2074          before t
-0000bc90: 6865 2073 706c 6974 2e0a 0a20 2020 2020  he split...     
-0000bca0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-0000bcb0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a0a 2020      --------..  
-0000bcc0: 2020 2020 2020 3530 2f35 3020 7370 6c69        50/50 spli
-0000bcd0: 740a 0a20 2020 2020 2020 203e 3e3e 2061  t..        >>> a
-0000bce0: 2c20 6220 3d20 6466 2e72 616e 646f 6d5f  , b = df.random_
-0000bcf0: 7370 6c69 7428 5b30 2e35 2c20 302e 355d  split([0.5, 0.5]
-0000bd00: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-0000bd10: 4b49 500a 0a20 2020 2020 2020 2038 302f  KIP..        80/
-0000bd20: 3130 2f31 3020 7370 6c69 742c 2063 6f6e  10/10 split, con
-0000bd30: 7369 7374 656e 7420 7261 6e64 6f6d 5f73  sistent random_s
-0000bd40: 7461 7465 0a0a 2020 2020 2020 2020 3e3e  tate..        >>
-0000bd50: 3e20 612c 2062 2c20 6320 3d20 6466 2e72  > a, b, c = df.r
-0000bd60: 616e 646f 6d5f 7370 6c69 7428 5b30 2e38  andom_split([0.8
-0000bd70: 2c20 302e 312c 2030 2e31 5d2c 2072 616e  , 0.1, 0.1], ran
-0000bd80: 646f 6d5f 7374 6174 653d 3132 3329 2020  dom_state=123)  
-0000bd90: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
-0000bda0: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
-0000bdb0: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
-0000bdc0: 2d2d 2d0a 2020 2020 2020 2020 6461 736b  ---.        dask
-0000bdd0: 2e44 6174 6146 7261 6d65 2e73 616d 706c  .DataFrame.sampl
-0000bde0: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
-0000bdf0: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
-0000be00: 616c 6c63 6c6f 7365 2873 756d 2866 7261  allclose(sum(fra
-0000be10: 6329 2c20 3129 3a0a 2020 2020 2020 2020  c), 1):.        
-0000be20: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0000be30: 7272 6f72 2822 6672 6163 2073 686f 756c  rror("frac shoul
-0000be40: 6420 7375 6d20 746f 2031 2229 0a20 2020  d sum to 1").   
-0000be50: 2020 2020 2073 7461 7465 5f64 6174 6120       state_data 
-0000be60: 3d20 7261 6e64 6f6d 5f73 7461 7465 5f64  = random_state_d
-0000be70: 6174 6128 7365 6c66 2e6e 7061 7274 6974  ata(self.npartit
-0000be80: 696f 6e73 2c20 7261 6e64 6f6d 5f73 7461  ions, random_sta
-0000be90: 7465 290a 2020 2020 2020 2020 746f 6b65  te).        toke
-0000bea0: 6e20 3d20 746f 6b65 6e69 7a65 2873 656c  n = tokenize(sel
-0000beb0: 662c 2066 7261 632c 2072 616e 646f 6d5f  f, frac, random_
-0000bec0: 7374 6174 6529 0a20 2020 2020 2020 206e  state).        n
-0000bed0: 616d 6520 3d20 2273 706c 6974 2d22 202b  ame = "split-" +
-0000bee0: 2074 6f6b 656e 0a20 2020 2020 2020 206c   token.        l
-0000bef0: 6179 6572 203d 207b 0a20 2020 2020 2020  ayer = {.       
-0000bf00: 2020 2020 2028 6e61 6d65 2c20 6929 3a20       (name, i): 
-0000bf10: 2870 645f 7370 6c69 742c 2028 7365 6c66  (pd_split, (self
-0000bf20: 2e5f 6e61 6d65 2c20 6929 2c20 6672 6163  ._name, i), frac
-0000bf30: 2c20 7374 6174 652c 2073 6875 6666 6c65  , state, shuffle
-0000bf40: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-0000bf50: 7220 692c 2073 7461 7465 2069 6e20 656e  r i, state in en
-0000bf60: 756d 6572 6174 6528 7374 6174 655f 6461  umerate(state_da
-0000bf70: 7461 290a 2020 2020 2020 2020 7d0a 0a20  ta).        }.. 
-0000bf80: 2020 2020 2020 206f 7574 203d 205b 5d0a         out = [].
-0000bf90: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-0000bfa0: 2072 616e 6765 286c 656e 2866 7261 6329   range(len(frac)
-0000bfb0: 293a 0a20 2020 2020 2020 2020 2020 206e  ):.            n
-0000bfc0: 616d 6532 203d 2022 7370 6c69 742d 2564  ame2 = "split-%d
-0000bfd0: 2d25 7322 2025 2028 692c 2074 6f6b 656e  -%s" % (i, token
-0000bfe0: 290a 2020 2020 2020 2020 2020 2020 6473  ).            ds
-0000bff0: 6b32 203d 207b 0a20 2020 2020 2020 2020  k2 = {.         
-0000c000: 2020 2020 2020 2028 6e61 6d65 322c 206a         (name2, j
-0000c010: 293a 2028 6765 7469 7465 6d2c 2028 6e61  ): (getitem, (na
-0000c020: 6d65 2c20 6a29 2c20 6929 2066 6f72 206a  me, j), i) for j
-0000c030: 2069 6e20 7261 6e67 6528 7365 6c66 2e6e   in range(self.n
-0000c040: 7061 7274 6974 696f 6e73 290a 2020 2020  partitions).    
-0000c050: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-0000c060: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
-0000c070: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-0000c080: 6d5f 636f 6c6c 6563 7469 6f6e 7328 0a20  m_collections(. 
-0000c090: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000c0a0: 616d 6532 2c20 6d65 7267 6528 6473 6b32  ame2, merge(dsk2
-0000c0b0: 2c20 6c61 7965 7229 2c20 6465 7065 6e64  , layer), depend
-0000c0c0: 656e 6369 6573 3d5b 7365 6c66 5d0a 2020  encies=[self].  
-0000c0d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000c0e0: 2020 2020 2020 2020 6f75 745f 6466 203d          out_df =
-0000c0f0: 2074 7970 6528 7365 6c66 2928 6772 6170   type(self)(grap
-0000c100: 682c 206e 616d 6532 2c20 7365 6c66 2e5f  h, name2, self._
-0000c110: 6d65 7461 2c20 7365 6c66 2e64 6976 6973  meta, self.divis
-0000c120: 696f 6e73 290a 2020 2020 2020 2020 2020  ions).          
-0000c130: 2020 6f75 742e 6170 7065 6e64 286f 7574    out.append(out
-0000c140: 5f64 6629 0a20 2020 2020 2020 2072 6574  _df).        ret
-0000c150: 7572 6e20 6f75 740a 0a20 2020 2064 6566  urn out..    def
-0000c160: 2068 6561 6428 7365 6c66 2c20 6e3d 352c   head(self, n=5,
-0000c170: 206e 7061 7274 6974 696f 6e73 3d31 2c20   npartitions=1, 
-0000c180: 636f 6d70 7574 653d 5472 7565 293a 0a20  compute=True):. 
-0000c190: 2020 2020 2020 2022 2222 4669 7273 7420         """First 
-0000c1a0: 6e20 726f 7773 206f 6620 7468 6520 6461  n rows of the da
-0000c1b0: 7461 7365 740a 0a20 2020 2020 2020 2050  taset..        P
-0000c1c0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-0000c1d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0000c1e0: 2020 2020 206e 203a 2069 6e74 2c20 6f70       n : int, op
-0000c1f0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0000c200: 2020 2054 6865 206e 756d 6265 7220 6f66     The number of
-0000c210: 2072 6f77 7320 746f 2072 6574 7572 6e2e   rows to return.
-0000c220: 2044 6566 6175 6c74 2069 7320 352e 0a20   Default is 5.. 
-0000c230: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
-0000c240: 6e73 203a 2069 6e74 2c20 6f70 7469 6f6e  ns : int, option
-0000c250: 616c 0a20 2020 2020 2020 2020 2020 2045  al.            E
-0000c260: 6c65 6d65 6e74 7320 6172 6520 6f6e 6c79  lements are only
-0000c270: 2074 616b 656e 2066 726f 6d20 7468 6520   taken from the 
-0000c280: 6669 7273 7420 6060 6e70 6172 7469 7469  first ``npartiti
-0000c290: 6f6e 7360 602c 2077 6974 6820 610a 2020  ons``, with a.  
-0000c2a0: 2020 2020 2020 2020 2020 6465 6661 756c            defaul
-0000c2b0: 7420 6f66 2031 2e20 4966 2074 6865 7265  t of 1. If there
-0000c2c0: 2061 7265 2066 6577 6572 2074 6861 6e20   are fewer than 
-0000c2d0: 6060 6e60 6020 726f 7773 2069 6e20 7468  ``n`` rows in th
-0000c2e0: 6520 6669 7273 740a 2020 2020 2020 2020  e first.        
-0000c2f0: 2020 2020 6060 6e70 6172 7469 7469 6f6e      ``npartition
-0000c300: 7360 6020 6120 7761 726e 696e 6720 7769  s`` a warning wi
-0000c310: 6c6c 2062 6520 7261 6973 6564 2061 6e64  ll be raised and
-0000c320: 2061 6e79 2066 6f75 6e64 2072 6f77 730a   any found rows.
-0000c330: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000c340: 726e 6564 2e20 5061 7373 202d 3120 746f  rned. Pass -1 to
-0000c350: 2075 7365 2061 6c6c 2070 6172 7469 7469   use all partiti
-0000c360: 6f6e 732e 0a20 2020 2020 2020 2063 6f6d  ons..        com
-0000c370: 7075 7465 203a 2062 6f6f 6c2c 206f 7074  pute : bool, opt
-0000c380: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0000c390: 2020 5768 6574 6865 7220 746f 2063 6f6d    Whether to com
-0000c3a0: 7075 7465 2074 6865 2072 6573 756c 742c  pute the result,
-0000c3b0: 2064 6566 6175 6c74 2069 7320 5472 7565   default is True
-0000c3c0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000c3d0: 2020 2020 2020 6966 206e 7061 7274 6974        if npartit
-0000c3e0: 696f 6e73 203c 3d20 2d31 3a0a 2020 2020  ions <= -1:.    
-0000c3f0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
-0000c400: 6f6e 7320 3d20 7365 6c66 2e6e 7061 7274  ons = self.npart
-0000c410: 6974 696f 6e73 0a20 2020 2020 2020 2023  itions.        #
-0000c420: 204e 6f20 6e65 6564 2074 6f20 7761 726e   No need to warn
-0000c430: 2069 6620 7765 2772 6520 616c 7265 6164   if we're alread
-0000c440: 7920 6c6f 6f6b 696e 6720 6174 2061 6c6c  y looking at all
-0000c450: 2070 6172 7469 7469 6f6e 730a 2020 2020   partitions.    
-0000c460: 2020 2020 7361 6665 203d 206e 7061 7274      safe = npart
-0000c470: 6974 696f 6e73 2021 3d20 7365 6c66 2e6e  itions != self.n
-0000c480: 7061 7274 6974 696f 6e73 0a20 2020 2020  partitions.     
-0000c490: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0000c4a0: 6865 6164 286e 3d6e 2c20 6e70 6172 7469  head(n=n, nparti
-0000c4b0: 7469 6f6e 733d 6e70 6172 7469 7469 6f6e  tions=npartition
-0000c4c0: 732c 2063 6f6d 7075 7465 3d63 6f6d 7075  s, compute=compu
-0000c4d0: 7465 2c20 7361 6665 3d73 6166 6529 0a0a  te, safe=safe)..
-0000c4e0: 2020 2020 6465 6620 5f68 6561 6428 7365      def _head(se
-0000c4f0: 6c66 2c20 6e2c 206e 7061 7274 6974 696f  lf, n, npartitio
-0000c500: 6e73 2c20 636f 6d70 7574 652c 2073 6166  ns, compute, saf
-0000c510: 6529 3a0a 2020 2020 2020 2020 6966 206e  e):.        if n
-0000c520: 7061 7274 6974 696f 6e73 203c 3d20 2d31  partitions <= -1
-0000c530: 3a0a 2020 2020 2020 2020 2020 2020 6e70  :.            np
-0000c540: 6172 7469 7469 6f6e 7320 3d20 7365 6c66  artitions = self
-0000c550: 2e6e 7061 7274 6974 696f 6e73 0a20 2020  .npartitions.   
+00000510: 696e 672c 0a20 2020 2069 735f 7374 7269  ing,.    is_stri
+00000520: 6e67 5f64 7479 7065 2c0a 290a 6672 6f6d  ng_dtype,.).from
+00000530: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+00000540: 6163 6365 7373 6f72 2069 6d70 6f72 7420  accessor import 
+00000550: 4361 6368 6564 4163 6365 7373 6f72 2c20  CachedAccessor, 
+00000560: 4461 7465 7469 6d65 4163 6365 7373 6f72  DatetimeAccessor
+00000570: 2c20 5374 7269 6e67 4163 6365 7373 6f72  , StringAccessor
+00000580: 0a66 726f 6d20 6461 736b 2e64 6174 6166  .from dask.dataf
+00000590: 7261 6d65 2e63 6174 6567 6f72 6963 616c  rame.categorical
+000005a0: 2069 6d70 6f72 7420 4361 7465 676f 7269   import Categori
+000005b0: 6361 6c41 6363 6573 736f 722c 2063 6174  calAccessor, cat
+000005c0: 6567 6f72 697a 650a 6672 6f6d 2064 6173  egorize.from das
+000005d0: 6b2e 6461 7461 6672 616d 652e 6469 7370  k.dataframe.disp
+000005e0: 6174 6368 2069 6d70 6f72 7420 280a 2020  atch import (.  
+000005f0: 2020 6765 745f 7061 7261 6c6c 656c 5f74    get_parallel_t
+00000600: 7970 652c 0a20 2020 2067 726f 7570 5f73  ype,.    group_s
+00000610: 706c 6974 5f64 6973 7061 7463 682c 0a20  plit_dispatch,. 
+00000620: 2020 2068 6173 685f 6f62 6a65 6374 5f64     hash_object_d
+00000630: 6973 7061 7463 682c 0a20 2020 206d 6574  ispatch,.    met
+00000640: 615f 6e6f 6e65 6d70 7479 2c0a 290a 6672  a_nonempty,.).fr
+00000650: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+00000660: 652e 6f70 7469 6d69 7a65 2069 6d70 6f72  e.optimize impor
+00000670: 7420 6f70 7469 6d69 7a65 0a66 726f 6d20  t optimize.from 
+00000680: 6461 736b 2e64 6174 6166 7261 6d65 2e75  dask.dataframe.u
+00000690: 7469 6c73 2069 6d70 6f72 7420 280a 2020  tils import (.  
+000006a0: 2020 4174 7472 6962 7574 654e 6f74 496d    AttributeNotIm
+000006b0: 706c 656d 656e 7465 6445 7272 6f72 2c0a  plementedError,.
+000006c0: 2020 2020 6368 6563 6b5f 6d61 7463 6869      check_matchi
+000006d0: 6e67 5f63 6f6c 756d 6e73 2c0a 2020 2020  ng_columns,.    
+000006e0: 6368 6563 6b5f 6e75 6d65 7269 635f 6f6e  check_numeric_on
+000006f0: 6c79 5f76 616c 6964 2c0a 2020 2020 636c  ly_valid,.    cl
+00000700: 6561 725f 6b6e 6f77 6e5f 6361 7465 676f  ear_known_catego
+00000710: 7269 6573 2c0a 2020 2020 6472 6f70 5f62  ries,.    drop_b
+00000720: 795f 7368 616c 6c6f 775f 636f 7079 2c0a  y_shallow_copy,.
+00000730: 2020 2020 6765 745f 6e75 6d65 7269 635f      get_numeric_
+00000740: 6f6e 6c79 5f6b 7761 7267 732c 0a20 2020  only_kwargs,.   
+00000750: 2068 6173 5f6b 6e6f 776e 5f63 6174 6567   has_known_categ
+00000760: 6f72 6965 732c 0a20 2020 2069 6e64 6578  ories,.    index
+00000770: 5f73 756d 6d61 7279 2c0a 2020 2020 696e  _summary,.    in
+00000780: 7365 7274 5f6d 6574 615f 7061 7261 6d5f  sert_meta_param_
+00000790: 6465 7363 7269 7074 696f 6e2c 0a20 2020  description,.   
+000007a0: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
+000007b0: 6b65 2c0a 2020 2020 6973 5f69 6e64 6578  ke,.    is_index
+000007c0: 5f6c 696b 652c 0a20 2020 2069 735f 7365  _like,.    is_se
+000007d0: 7269 6573 5f6c 696b 652c 0a20 2020 206d  ries_like,.    m
+000007e0: 616b 655f 6d65 7461 2c0a 2020 2020 6d65  ake_meta,.    me
+000007f0: 7461 5f66 7261 6d65 5f63 6f6e 7374 7275  ta_frame_constru
+00000800: 6374 6f72 2c0a 2020 2020 6d65 7461 5f73  ctor,.    meta_s
+00000810: 6572 6965 735f 636f 6e73 7472 7563 746f  eries_constructo
+00000820: 722c 0a20 2020 2072 6169 7365 5f6f 6e5f  r,.    raise_on_
+00000830: 6d65 7461 5f65 7272 6f72 2c0a 2020 2020  meta_error,.    
+00000840: 7661 6c69 645f 6469 7669 7369 6f6e 732c  valid_divisions,
+00000850: 0a29 0a66 726f 6d20 6461 736b 2e64 656c  .).from dask.del
+00000860: 6179 6564 2069 6d70 6f72 7420 4465 6c61  ayed import Dela
+00000870: 7965 642c 2064 656c 6179 6564 2c20 756e  yed, delayed, un
+00000880: 7061 636b 5f63 6f6c 6c65 6374 696f 6e73  pack_collections
+00000890: 0a66 726f 6d20 6461 736b 2e68 6967 686c  .from dask.highl
+000008a0: 6576 656c 6772 6170 6820 696d 706f 7274  evelgraph import
+000008b0: 2048 6967 684c 6576 656c 4772 6170 680a   HighLevelGraph.
+000008c0: 6672 6f6d 2064 6173 6b2e 6c61 7965 7273  from dask.layers
+000008d0: 2069 6d70 6f72 7420 4461 7461 4672 616d   import DataFram
+000008e0: 6554 7265 6552 6564 7563 7469 6f6e 0a66  eTreeReduction.f
+000008f0: 726f 6d20 6461 736b 2e75 7469 6c73 2069  rom dask.utils i
+00000900: 6d70 6f72 7420 280a 2020 2020 496e 6465  mport (.    Inde
+00000910: 7843 616c 6c61 626c 652c 0a20 2020 204d  xCallable,.    M
+00000920: 2c0a 2020 2020 4f70 6572 6174 6f72 4d65  ,.    OperatorMe
+00000930: 7468 6f64 4d69 7869 6e2c 0a20 2020 205f  thodMixin,.    _
+00000940: 6465 7072 6563 6174 6564 2c0a 2020 2020  deprecated,.    
+00000950: 6170 706c 792c 0a20 2020 2064 6572 6976  apply,.    deriv
+00000960: 6564 5f66 726f 6d2c 0a20 2020 2066 756e  ed_from,.    fun
+00000970: 636e 616d 652c 0a20 2020 2067 6574 5f6d  cname,.    get_m
+00000980: 6574 615f 6c69 6272 6172 792c 0a20 2020  eta_library,.   
+00000990: 2068 6173 5f6b 6579 776f 7264 2c0a 2020   has_keyword,.  
+000009a0: 2020 6973 5f61 7272 6179 6c69 6b65 2c0a    is_arraylike,.
+000009b0: 2020 2020 6974 6572 5f63 6875 6e6b 732c      iter_chunks,
+000009c0: 0a20 2020 206b 6579 5f73 706c 6974 2c0a  .    key_split,.
+000009d0: 2020 2020 6d61 7962 655f 706c 7572 616c      maybe_plural
+000009e0: 697a 652c 0a20 2020 206d 656d 6f72 795f  ize,.    memory_
+000009f0: 7265 7072 2c0a 2020 2020 7061 7273 655f  repr,.    parse_
+00000a00: 6279 7465 732c 0a20 2020 2070 6172 7469  bytes,.    parti
+00000a10: 616c 5f62 795f 6f72 6465 722c 0a20 2020  al_by_order,.   
+00000a20: 2070 7365 7564 6f72 616e 646f 6d2c 0a20   pseudorandom,. 
+00000a30: 2020 2070 7574 5f6c 696e 6573 2c0a 2020     put_lines,.  
+00000a40: 2020 7261 6e64 6f6d 5f73 7461 7465 5f64    random_state_d
+00000a50: 6174 612c 0a20 2020 2074 7970 656e 616d  ata,.    typenam
+00000a60: 652c 0a29 0a66 726f 6d20 6461 736b 2e77  e,.).from dask.w
+00000a70: 6964 6765 7473 2069 6d70 6f72 7420 6765  idgets import ge
+00000a80: 745f 7465 6d70 6c61 7465 0a0a 4445 4641  t_template..DEFA
+00000a90: 554c 545f 4745 5420 3d20 6e61 6d65 645f  ULT_GET = named_
+00000aa0: 7363 6865 6475 6c65 7273 2e67 6574 2822  schedulers.get("
+00000ab0: 7468 7265 6164 7322 2c20 6e61 6d65 645f  threads", named_
+00000ac0: 7363 6865 6475 6c65 7273 5b22 7379 6e63  schedulers["sync
+00000ad0: 225d 290a 0a6e 6f5f 6465 6661 756c 7420  "])..no_default 
+00000ae0: 3d20 225f 5f6e 6f5f 6465 6661 756c 745f  = "__no_default_
+00000af0: 5f22 0a0a 4752 4f55 505f 4b45 5953 5f44  _"..GROUP_KEYS_D
+00000b00: 4546 4155 4c54 3a20 626f 6f6c 207c 204e  EFAULT: bool | N
+00000b10: 6f6e 6520 3d20 5472 7565 0a69 6620 5041  one = True.if PA
+00000b20: 4e44 4153 5f47 545f 3135 3020 616e 6420  NDAS_GT_150 and 
+00000b30: 6e6f 7420 5041 4e44 4153 5f47 545f 3230  not PANDAS_GT_20
+00000b40: 303a 0a20 2020 2047 524f 5550 5f4b 4559  0:.    GROUP_KEY
+00000b50: 535f 4445 4641 554c 5420 3d20 4e6f 6e65  S_DEFAULT = None
+00000b60: 0a0a 7064 2e73 6574 5f6f 7074 696f 6e28  ..pd.set_option(
+00000b70: 2263 6f6d 7075 7465 2e75 7365 5f6e 756d  "compute.use_num
+00000b80: 6578 7072 222c 2046 616c 7365 290a 0a0a  expr", False)...
+00000b90: 6465 6620 5f6e 756d 6572 6963 5f6f 6e6c  def _numeric_onl
+00000ba0: 7928 6675 6e63 293a 0a20 2020 2022 2222  y(func):.    """
+00000bb0: 4465 636f 7261 746f 7220 666f 7220 6d65  Decorator for me
+00000bc0: 7468 6f64 7320 7468 6174 2061 6363 6570  thods that accep
+00000bd0: 7420 6120 6e75 6d65 7269 635f 6f6e 6c79  t a numeric_only
+00000be0: 206b 7761 7267 2222 220a 0a20 2020 2040   kwarg"""..    @
+00000bf0: 7772 6170 7328 6675 6e63 290a 2020 2020  wraps(func).    
+00000c00: 6465 6620 7772 6170 7065 7228 7365 6c66  def wrapper(self
+00000c10: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+00000c20: 7329 3a0a 2020 2020 2020 2020 2320 6e75  s):.        # nu
+00000c30: 6d65 7269 635f 6f6e 6c79 2069 7320 4e6f  meric_only is No
+00000c40: 6e65 2062 7920 6465 6661 756c 7420 2d20  ne by default - 
+00000c50: 696e 2074 6861 7420 6361 7365 2073 656c  in that case sel
+00000c60: 6620 3d20 7365 6c66 2e0a 2020 2020 2020  f = self..      
+00000c70: 2020 6966 206b 7761 7267 732e 6765 7428    if kwargs.get(
+00000c80: 226e 756d 6572 6963 5f6f 6e6c 7922 2920  "numeric_only") 
+00000c90: 6973 2046 616c 7365 3a0a 2020 2020 2020  is False:.      
+00000ca0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+00000cb0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+00000cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000cd0: 2022 276e 756d 6572 6963 5f6f 6e6c 793d   "'numeric_only=
+00000ce0: 4661 6c73 6527 2069 7320 6e6f 7420 696d  False' is not im
+00000cf0: 706c 656d 656e 7465 6420 696e 2044 6173  plemented in Das
+00000d00: 6b2e 220a 2020 2020 2020 2020 2020 2020  k.".            
+00000d10: 290a 2020 2020 2020 2020 656c 6966 206b  ).        elif k
+00000d20: 7761 7267 732e 6765 7428 226e 756d 6572  wargs.get("numer
+00000d30: 6963 5f6f 6e6c 7922 2920 6973 2054 7275  ic_only") is Tru
+00000d40: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00000d50: 656c 6620 3d20 7365 6c66 2e5f 6765 745f  elf = self._get_
+00000d60: 6e75 6d65 7269 635f 6461 7461 2829 0a20  numeric_data(). 
+00000d70: 2020 2020 2020 2072 6574 7572 6e20 6675         return fu
+00000d80: 6e63 2873 656c 662c 202a 6172 6773 2c20  nc(self, *args, 
+00000d90: 2a2a 6b77 6172 6773 290a 0a20 2020 2072  **kwargs)..    r
+00000da0: 6574 7572 6e20 7772 6170 7065 720a 0a0a  eturn wrapper...
+00000db0: 6465 6620 5f6e 756d 6572 6963 5f64 6174  def _numeric_dat
+00000dc0: 6128 6675 6e63 293a 0a20 2020 2022 2222  a(func):.    """
+00000dd0: 4d6f 6469 6669 6564 2076 6572 7369 6f6e  Modified version
+00000de0: 206f 6620 7468 6520 6162 6f76 6520 6465   of the above de
+00000df0: 636f 7261 746f 722c 2072 6967 6874 206e  corator, right n
+00000e00: 6f77 206f 6e6c 7920 7573 6564 2077 6974  ow only used wit
+00000e10: 6820 7374 642e 2057 6520 646f 6e27 740a  h std. We don't.
+00000e20: 2020 2020 6e65 6564 2072 6169 7369 6e67      need raising
+00000e30: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+00000e40: 7272 6f72 2074 6865 7265 2c20 6265 6361  rror there, beca
+00000e50: 7573 6520 6974 2773 2068 616e 646c 6564  use it's handled
+00000e60: 2062 790a 2020 2020 5f6e 756d 6572 6963   by.    _numeric
+00000e70: 5f6f 6e6c 795f 6d61 7962 655f 7761 726e  _only_maybe_warn
+00000e80: 2069 6e73 7465 6164 2e20 5468 6973 2069   instead. This i
+00000e90: 7320 6120 7465 6d70 6f72 6172 7920 736f  s a temporary so
+00000ea0: 6c75 7469 6f6e 2074 6861 7420 6e65 6564  lution that need
+00000eb0: 730a 2020 2020 6d6f 7265 2074 696d 6520  s.    more time 
+00000ec0: 746f 2062 6520 6765 6e65 7261 6c69 7a65  to be generalize
+00000ed0: 642e 2222 220a 0a20 2020 2040 7772 6170  d."""..    @wrap
+00000ee0: 7328 6675 6e63 290a 2020 2020 6465 6620  s(func).    def 
+00000ef0: 7772 6170 7065 7228 7365 6c66 2c20 2a61  wrapper(self, *a
+00000f00: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+00000f10: 2020 2020 2020 2020 6966 206b 7761 7267          if kwarg
+00000f20: 732e 6765 7428 226e 756d 6572 6963 5f6f  s.get("numeric_o
+00000f30: 6e6c 7922 2920 6973 2054 7275 653a 0a20  nly") is True:. 
+00000f40: 2020 2020 2020 2020 2020 2073 656c 6620             self 
+00000f50: 3d20 7365 6c66 2e5f 6765 745f 6e75 6d65  = self._get_nume
+00000f60: 7269 635f 6461 7461 2829 0a20 2020 2020  ric_data().     
+00000f70: 2020 2072 6574 7572 6e20 6675 6e63 2873     return func(s
+00000f80: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+00000f90: 6172 6773 290a 0a20 2020 2072 6574 7572  args)..    retur
+00000fa0: 6e20 7772 6170 7065 720a 0a0a 6465 6620  n wrapper...def 
+00000fb0: 5f6e 756d 6572 6963 5f6f 6e6c 795f 6d61  _numeric_only_ma
+00000fc0: 7962 655f 7761 726e 2864 662c 206e 756d  ybe_warn(df, num
+00000fd0: 6572 6963 5f6f 6e6c 792c 2064 6566 6175  eric_only, defau
+00000fe0: 6c74 3d4e 6f6e 6529 3a0a 2020 2020 2222  lt=None):.    ""
+00000ff0: 2255 7064 6174 6520 6e75 6d65 7269 635f  "Update numeric_
+00001000: 6f6e 6c79 2074 6f20 6765 7420 7269 6420  only to get rid 
+00001010: 6f66 206e 6f5f 6465 6661 756c 742c 2061  of no_default, a
+00001020: 6e64 2070 6f73 7369 626c 7920 7761 726e  nd possibly warn
+00001030: 2061 626f 7574 2064 6566 6175 6c74 2076   about default v
+00001040: 616c 7565 2e0a 2020 2020 544f 444f 3a20  alue..    TODO: 
+00001050: 7368 6f75 6c64 206d 6f76 6520 746f 206e  should move to n
+00001060: 756d 6572 6963 5f6f 6e6c 7920 6465 636f  umeric_only deco
+00001070: 7261 746f 722e 2053 6565 2068 7474 7073  rator. See https
+00001080: 3a2f 2f67 6974 6875 622e 636f 6d2f 6461  ://github.com/da
+00001090: 736b 2f64 6173 6b2f 7075 6c6c 2f39 3935  sk/dask/pull/995
+000010a0: 320a 2020 2020 2222 220a 2020 2020 6966  2.    """.    if
+000010b0: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
+000010c0: 6b65 2864 6629 3a0a 2020 2020 2020 2020  ke(df):.        
+000010d0: 7761 726e 5f6e 756d 6572 6963 5f6f 6e6c  warn_numeric_onl
+000010e0: 7920 3d20 4661 6c73 650a 2020 2020 2020  y = False.      
+000010f0: 2020 6966 206e 756d 6572 6963 5f6f 6e6c    if numeric_onl
+00001100: 7920 6973 206e 6f5f 6465 6661 756c 743a  y is no_default:
+00001110: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00001120: 5041 4e44 4153 5f47 545f 3230 303a 0a20  PANDAS_GT_200:. 
+00001130: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00001140: 756d 6572 6963 5f6f 6e6c 7920 3d20 4661  umeric_only = Fa
+00001150: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00001160: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00001170: 2020 2020 2020 7761 726e 5f6e 756d 6572        warn_numer
+00001180: 6963 5f6f 6e6c 7920 3d20 5472 7565 0a0a  ic_only = True..
+00001190: 2020 2020 2020 2020 6e75 6d65 7269 6373          numerics
+000011a0: 203d 2064 662e 5f6d 6574 612e 5f67 6574   = df._meta._get
+000011b0: 5f6e 756d 6572 6963 5f64 6174 6128 290a  _numeric_data().
+000011c0: 2020 2020 2020 2020 6861 735f 6e6f 6e5f          has_non_
+000011d0: 6e75 6d65 7269 6373 203d 206c 656e 286e  numerics = len(n
+000011e0: 756d 6572 6963 732e 636f 6c75 6d6e 7329  umerics.columns)
+000011f0: 203c 206c 656e 2864 662e 5f6d 6574 612e   < len(df._meta.
+00001200: 636f 6c75 6d6e 7329 0a20 2020 2020 2020  columns).       
+00001210: 2069 6620 6861 735f 6e6f 6e5f 6e75 6d65   if has_non_nume
+00001220: 7269 6373 3a0a 2020 2020 2020 2020 2020  rics:.          
+00001230: 2020 6966 206e 756d 6572 6963 5f6f 6e6c    if numeric_onl
+00001240: 7920 6973 2046 616c 7365 3a0a 2020 2020  y is False:.    
+00001250: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00001260: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+00001270: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00001280: 2020 2020 2020 2020 2020 2022 276e 756d             "'num
+00001290: 6572 6963 5f6f 6e6c 793d 4661 6c73 6527  eric_only=False'
+000012a0: 2069 7320 6e6f 7420 696d 706c 656d 656e   is not implemen
+000012b0: 7465 6420 696e 2044 6173 6b2e 220a 2020  ted in Dask.".  
+000012c0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+000012d0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000012e0: 2077 6172 6e5f 6e75 6d65 7269 635f 6f6e   warn_numeric_on
+000012f0: 6c79 3a0a 2020 2020 2020 2020 2020 2020  ly:.            
+00001300: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00001310: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+00001320: 2020 2020 2020 2022 5468 6520 6465 6661         "The defa
+00001330: 756c 7420 7661 6c75 6520 6f66 206e 756d  ult value of num
+00001340: 6572 6963 5f6f 6e6c 7920 696e 2064 6173  eric_only in das
+00001350: 6b20 7769 6c6c 2062 6520 6368 616e 6765  k will be change
+00001360: 6420 746f 2046 616c 7365 2069 6e20 220a  d to False in ".
+00001370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001380: 2020 2020 2274 6865 2066 7574 7572 6520      "the future 
+00001390: 7768 656e 2075 7369 6e67 2064 6173 6b20  when using dask 
+000013a0: 7769 7468 2070 616e 6461 7320 322e 3022  with pandas 2.0"
+000013b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000013c0: 2020 2020 2020 4675 7475 7265 5761 726e        FutureWarn
+000013d0: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
+000013e0: 2020 2020 2029 0a20 2020 2069 6620 6e75       ).    if nu
+000013f0: 6d65 7269 635f 6f6e 6c79 2069 7320 6e6f  meric_only is no
+00001400: 5f64 6566 6175 6c74 2061 6e64 2064 6566  _default and def
+00001410: 6175 6c74 2069 7320 6e6f 7420 4e6f 6e65  ault is not None
+00001420: 3a0a 2020 2020 2020 2020 6e75 6d65 7269  :.        numeri
+00001430: 635f 6f6e 6c79 203d 2064 6566 6175 6c74  c_only = default
+00001440: 0a20 2020 2072 6574 7572 6e20 7b7d 2069  .    return {} i
+00001450: 6620 6e75 6d65 7269 635f 6f6e 6c79 2069  f numeric_only i
+00001460: 7320 6e6f 5f64 6566 6175 6c74 2065 6c73  s no_default els
+00001470: 6520 7b22 6e75 6d65 7269 635f 6f6e 6c79  e {"numeric_only
+00001480: 223a 206e 756d 6572 6963 5f6f 6e6c 797d  ": numeric_only}
+00001490: 0a0a 0a64 6566 205f 636f 6e63 6174 2861  ...def _concat(a
+000014a0: 7267 732c 2069 676e 6f72 655f 696e 6465  rgs, ignore_inde
+000014b0: 783d 4661 6c73 6529 3a0a 2020 2020 6966  x=False):.    if
+000014c0: 206e 6f74 2061 7267 733a 0a20 2020 2020   not args:.     
+000014d0: 2020 2072 6574 7572 6e20 6172 6773 0a20     return args. 
+000014e0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+000014f0: 2866 6972 7374 2863 6f72 652e 666c 6174  (first(core.flat
+00001500: 7465 6e28 6172 6773 2929 2c20 6e70 2e6e  ten(args)), np.n
+00001510: 6461 7272 6179 293a 0a20 2020 2020 2020  darray):.       
+00001520: 2072 6574 7572 6e20 6461 2e63 6f72 652e   return da.core.
+00001530: 636f 6e63 6174 656e 6174 6533 2861 7267  concatenate3(arg
+00001540: 7329 0a20 2020 2069 6620 6e6f 7420 6861  s).    if not ha
+00001550: 735f 7061 7261 6c6c 656c 5f74 7970 6528  s_parallel_type(
+00001560: 6172 6773 5b30 5d29 3a0a 2020 2020 2020  args[0]):.      
+00001570: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00001580: 2020 2072 6574 7572 6e20 7064 2e53 6572     return pd.Ser
+00001590: 6965 7328 6172 6773 290a 2020 2020 2020  ies(args).      
+000015a0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+000015b0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+000015c0: 7265 7475 726e 2061 7267 730a 2020 2020  return args.    
+000015d0: 2320 5765 2066 696c 7465 7220 6f75 7420  # We filter out 
+000015e0: 656d 7074 7920 7061 7274 6974 696f 6e73  empty partitions
+000015f0: 2068 6572 6520 6265 6361 7573 6520 7061   here because pa
+00001600: 6e64 6173 2066 7265 7175 656e 746c 7920  ndas frequently 
+00001610: 6861 730a 2020 2020 2320 696e 636f 6e73  has.    # incons
+00001620: 6973 7465 6e74 2064 7479 7065 7320 696e  istent dtypes in
+00001630: 2072 6573 756c 7473 2062 6574 7765 656e   results between
+00001640: 2065 6d70 7479 2061 6e64 206e 6f6e 2d65   empty and non-e
+00001650: 6d70 7479 2066 7261 6d65 732e 0a20 2020  mpty frames..   
+00001660: 2023 2049 6465 616c 6c79 2074 6869 7320   # Ideally this 
+00001670: 776f 756c 6420 6265 2068 616e 646c 6564  would be handled
+00001680: 206c 6f63 616c 6c79 2066 6f72 2065 6163   locally for eac
+00001690: 6820 6f70 6572 6174 696f 6e2c 2062 7574  h operation, but
+000016a0: 2069 6e20 7072 6163 7469 6365 0a20 2020   in practice.   
+000016b0: 2023 2074 6869 7320 7365 656d 7320 6561   # this seems ea
+000016c0: 7369 6572 2e20 544f 444f 3a20 646f 6e27  sier. TODO: don'
+000016d0: 7420 646f 2074 6869 732e 0a20 2020 2061  t do this..    a
+000016e0: 7267 7332 203d 205b 6920 666f 7220 6920  rgs2 = [i for i 
+000016f0: 696e 2061 7267 7320 6966 206c 656e 2869  in args if len(i
+00001700: 295d 0a20 2020 2072 6574 7572 6e20 280a  )].    return (.
+00001710: 2020 2020 2020 2020 6172 6773 5b30 5d0a          args[0].
+00001720: 2020 2020 2020 2020 6966 206e 6f74 2061          if not a
+00001730: 7267 7332 0a20 2020 2020 2020 2065 6c73  rgs2.        els
+00001740: 6520 6d65 7468 6f64 732e 636f 6e63 6174  e methods.concat
+00001750: 2861 7267 7332 2c20 756e 6966 6f72 6d3d  (args2, uniform=
+00001760: 5472 7565 2c20 6967 6e6f 7265 5f69 6e64  True, ignore_ind
+00001770: 6578 3d69 676e 6f72 655f 696e 6465 7829  ex=ignore_index)
+00001780: 0a20 2020 2029 0a0a 0a64 6566 2066 696e  .    )...def fin
+00001790: 616c 697a 6528 7265 7375 6c74 7329 3a0a  alize(results):.
+000017a0: 2020 2020 7265 7475 726e 205f 636f 6e63      return _conc
+000017b0: 6174 2872 6573 756c 7473 290a 0a0a 636c  at(results)...cl
+000017c0: 6173 7320 5363 616c 6172 2844 6173 6b4d  ass Scalar(DaskM
+000017d0: 6574 686f 6473 4d69 7869 6e2c 204f 7065  ethodsMixin, Ope
+000017e0: 7261 746f 724d 6574 686f 644d 6978 696e  ratorMethodMixin
+000017f0: 293a 0a20 2020 2022 2222 4120 4461 736b  ):.    """A Dask
+00001800: 206f 626a 6563 7420 746f 2072 6570 7265   object to repre
+00001810: 7365 6e74 2061 2070 616e 6461 7320 7363  sent a pandas sc
+00001820: 616c 6172 2222 220a 0a20 2020 2064 6566  alar"""..    def
+00001830: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00001840: 6473 6b2c 206e 616d 652c 206d 6574 612c  dsk, name, meta,
+00001850: 2064 6976 6973 696f 6e73 3d4e 6f6e 6529   divisions=None)
+00001860: 3a0a 2020 2020 2020 2020 2320 6469 7669  :.        # divi
+00001870: 7369 6f6e 7320 6973 2069 676e 6f72 6564  sions is ignored
+00001880: 2c20 6f6e 6c79 2070 7265 7365 6e74 2074  , only present t
+00001890: 6f20 6265 2063 6f6d 7061 7469 626c 6520  o be compatible 
+000018a0: 7769 7468 206f 7468 6572 0a20 2020 2020  with other.     
+000018b0: 2020 2023 206f 626a 6563 7473 2e0a 2020     # objects..  
+000018c0: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+000018d0: 6e73 7461 6e63 6528 6473 6b2c 2048 6967  nstance(dsk, Hig
+000018e0: 684c 6576 656c 4772 6170 6829 3a0a 2020  hLevelGraph):.  
+000018f0: 2020 2020 2020 2020 2020 6473 6b20 3d20            dsk = 
+00001900: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
+00001910: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
+00001920: 6e61 6d65 2c20 6473 6b2c 2064 6570 656e  name, dsk, depen
+00001930: 6465 6e63 6965 733d 5b5d 290a 2020 2020  dencies=[]).    
+00001940: 2020 2020 7365 6c66 2e64 6173 6b20 3d20      self.dask = 
+00001950: 6473 6b0a 2020 2020 2020 2020 7365 6c66  dsk.        self
+00001960: 2e5f 6e61 6d65 203d 206e 616d 650a 2020  ._name = name.  
+00001970: 2020 2020 2020 7365 6c66 2e5f 7061 7265        self._pare
+00001980: 6e74 5f6d 6574 6120 3d20 7064 2e53 6572  nt_meta = pd.Ser
+00001990: 6965 7328 6474 7970 653d 2266 6c6f 6174  ies(dtype="float
+000019a0: 3634 2229 0a0a 2020 2020 2020 2020 6d65  64")..        me
+000019b0: 7461 203d 206d 616b 655f 6d65 7461 286d  ta = make_meta(m
+000019c0: 6574 612c 2070 6172 656e 745f 6d65 7461  eta, parent_meta
+000019d0: 3d73 656c 662e 5f70 6172 656e 745f 6d65  =self._parent_me
+000019e0: 7461 290a 2020 2020 2020 2020 6966 2069  ta).        if i
+000019f0: 735f 6461 7461 6672 616d 655f 6c69 6b65  s_dataframe_like
+00001a00: 286d 6574 6129 206f 7220 6973 5f73 6572  (meta) or is_ser
+00001a10: 6965 735f 6c69 6b65 286d 6574 6129 206f  ies_like(meta) o
+00001a20: 7220 6973 5f69 6e64 6578 5f6c 696b 6528  r is_index_like(
+00001a30: 6d65 7461 293a 0a20 2020 2020 2020 2020  meta):.         
+00001a40: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00001a50: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00001a60: 2020 2020 6622 4578 7065 6374 6564 206d      f"Expected m
+00001a70: 6574 6120 746f 2073 7065 6369 6679 2073  eta to specify s
+00001a80: 6361 6c61 722c 2067 6f74 207b 7479 7065  calar, got {type
+00001a90: 6e61 6d65 2874 7970 6528 6d65 7461 2929  name(type(meta))
+00001aa0: 7d22 0a20 2020 2020 2020 2020 2020 2029  }".            )
+00001ab0: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
+00001ac0: 6574 6120 3d20 6d65 7461 0a0a 2020 2020  eta = meta..    
+00001ad0: 6465 6620 5f5f 6461 736b 5f67 7261 7068  def __dask_graph
+00001ae0: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+00001af0: 2020 7265 7475 726e 2073 656c 662e 6461    return self.da
+00001b00: 736b 0a0a 2020 2020 6465 6620 5f5f 6461  sk..    def __da
+00001b10: 736b 5f6b 6579 735f 5f28 7365 6c66 293a  sk_keys__(self):
+00001b20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00001b30: 5b73 656c 662e 6b65 795d 0a0a 2020 2020  [self.key]..    
+00001b40: 6465 6620 5f5f 6461 736b 5f74 6f6b 656e  def __dask_token
+00001b50: 697a 655f 5f28 7365 6c66 293a 0a20 2020  ize__(self):.   
+00001b60: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00001b70: 2e5f 6e61 6d65 0a0a 2020 2020 6465 6620  ._name..    def 
+00001b80: 5f5f 6461 736b 5f6c 6179 6572 735f 5f28  __dask_layers__(
+00001b90: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00001ba0: 6574 7572 6e20 2873 656c 662e 5f6e 616d  eturn (self._nam
+00001bb0: 652c 290a 0a20 2020 205f 5f64 6173 6b5f  e,)..    __dask_
+00001bc0: 6f70 7469 6d69 7a65 5f5f 203d 2067 6c6f  optimize__ = glo
+00001bd0: 6261 6c6d 6574 686f 6428 0a20 2020 2020  balmethod(.     
+00001be0: 2020 206f 7074 696d 697a 652c 206b 6579     optimize, key
+00001bf0: 3d22 6461 7461 6672 616d 655f 6f70 7469  ="dataframe_opti
+00001c00: 6d69 7a65 222c 2066 616c 7365 793d 646f  mize", falsey=do
+00001c10: 6e74 5f6f 7074 696d 697a 650a 2020 2020  nt_optimize.    
+00001c20: 290a 2020 2020 5f5f 6461 736b 5f73 6368  ).    __dask_sch
+00001c30: 6564 756c 6572 5f5f 203d 2073 7461 7469  eduler__ = stati
+00001c40: 636d 6574 686f 6428 4445 4641 554c 545f  cmethod(DEFAULT_
+00001c50: 4745 5429 0a0a 2020 2020 6465 6620 5f5f  GET)..    def __
+00001c60: 6461 736b 5f70 6f73 7463 6f6d 7075 7465  dask_postcompute
+00001c70: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+00001c80: 2020 7265 7475 726e 2066 6972 7374 2c20    return first, 
+00001c90: 2829 0a0a 2020 2020 6465 6620 5f5f 6461  ()..    def __da
+00001ca0: 736b 5f70 6f73 7470 6572 7369 7374 5f5f  sk_postpersist__
+00001cb0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00001cc0: 7265 7475 726e 2073 656c 662e 5f72 6562  return self._reb
+00001cd0: 7569 6c64 2c20 2829 0a0a 2020 2020 6465  uild, ()..    de
+00001ce0: 6620 5f72 6562 7569 6c64 2873 656c 662c  f _rebuild(self,
+00001cf0: 2064 736b 2c20 2a2c 2072 656e 616d 653d   dsk, *, rename=
+00001d00: 4e6f 6e65 293a 0a20 2020 2020 2020 206e  None):.        n
+00001d10: 616d 6520 3d20 7365 6c66 2e5f 6e61 6d65  ame = self._name
+00001d20: 0a20 2020 2020 2020 2069 6620 7265 6e61  .        if rena
+00001d30: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
+00001d40: 6e61 6d65 203d 2072 656e 616d 652e 6765  name = rename.ge
+00001d50: 7428 6e61 6d65 2c20 6e61 6d65 290a 2020  t(name, name).  
+00001d60: 2020 2020 2020 7265 7475 726e 2053 6361        return Sca
+00001d70: 6c61 7228 6473 6b2c 206e 616d 652c 2073  lar(dsk, name, s
+00001d80: 656c 662e 5f6d 6574 612c 2073 656c 662e  elf._meta, self.
+00001d90: 6469 7669 7369 6f6e 7329 0a0a 2020 2020  divisions)..    
+00001da0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00001db0: 6620 5f6d 6574 615f 6e6f 6e65 6d70 7479  f _meta_nonempty
+00001dc0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00001dd0: 7265 7475 726e 2073 656c 662e 5f6d 6574  return self._met
+00001de0: 610a 0a20 2020 2040 7072 6f70 6572 7479  a..    @property
+00001df0: 0a20 2020 2064 6566 2064 7479 7065 2873  .    def dtype(s
+00001e00: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00001e10: 7475 726e 2073 656c 662e 5f6d 6574 612e  turn self._meta.
+00001e20: 6474 7970 650a 0a20 2020 2064 6566 205f  dtype..    def _
+00001e30: 5f64 6972 5f5f 2873 656c 6629 3a0a 2020  _dir__(self):.  
+00001e40: 2020 2020 2020 6f20 3d20 7365 7428 6469        o = set(di
+00001e50: 7228 7479 7065 2873 656c 6629 2929 0a20  r(type(self))). 
+00001e60: 2020 2020 2020 206f 2e75 7064 6174 6528         o.update(
+00001e70: 7365 6c66 2e5f 5f64 6963 745f 5f29 0a20  self.__dict__). 
+00001e80: 2020 2020 2020 2069 6620 6e6f 7420 6861         if not ha
+00001e90: 7361 7474 7228 7365 6c66 2e5f 6d65 7461  sattr(self._meta
+00001ea0: 2c20 2264 7479 7065 2229 3a0a 2020 2020  , "dtype"):.    
+00001eb0: 2020 2020 2020 2020 6f2e 7265 6d6f 7665          o.remove
+00001ec0: 2822 6474 7970 6522 2920 2023 2064 7479  ("dtype")  # dty
+00001ed0: 7065 206f 6e6c 7920 696e 2060 6469 7260  pe only in `dir`
+00001ee0: 2069 6620 6176 6169 6c61 626c 650a 2020   if available.  
+00001ef0: 2020 2020 2020 7265 7475 726e 206c 6973        return lis
+00001f00: 7428 6f29 0a0a 2020 2020 4070 726f 7065  t(o)..    @prope
+00001f10: 7274 790a 2020 2020 6465 6620 6469 7669  rty.    def divi
+00001f20: 7369 6f6e 7328 7365 6c66 293a 0a20 2020  sions(self):.   
+00001f30: 2020 2020 2022 2222 4475 6d6d 7920 6469       """Dummy di
+00001f40: 7669 7369 6f6e 7320 746f 2062 6520 636f  visions to be co
+00001f50: 6d70 6174 2077 6974 6820 5365 7269 6573  mpat with Series
+00001f60: 2061 6e64 2044 6174 6146 7261 6d65 2222   and DataFrame""
+00001f70: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00001f80: 2028 4e6f 6e65 2c20 4e6f 6e65 290a 0a20   (None, None).. 
+00001f90: 2020 2064 6566 205f 5f72 6570 725f 5f28     def __repr__(
+00001fa0: 7365 6c66 293a 0a20 2020 2020 2020 206e  self):.        n
+00001fb0: 616d 6520 3d20 7365 6c66 2e5f 6e61 6d65  ame = self._name
+00001fc0: 2069 6620 6c65 6e28 7365 6c66 2e5f 6e61   if len(self._na
+00001fd0: 6d65 2920 3c20 3130 2065 6c73 6520 7365  me) < 10 else se
+00001fe0: 6c66 2e5f 6e61 6d65 5b3a 375d 202b 2022  lf._name[:7] + "
+00001ff0: 2e2e 2e22 0a20 2020 2020 2020 2069 6620  ...".        if 
+00002000: 6861 7361 7474 7228 7365 6c66 2e5f 6d65  hasattr(self._me
+00002010: 7461 2c20 2264 7479 7065 2229 3a0a 2020  ta, "dtype"):.  
+00002020: 2020 2020 2020 2020 2020 6578 7472 6120            extra 
+00002030: 3d20 222c 2064 7479 7065 3d25 7322 2025  = ", dtype=%s" %
+00002040: 2073 656c 662e 5f6d 6574 612e 6474 7970   self._meta.dtyp
+00002050: 650a 2020 2020 2020 2020 656c 7365 3a0a  e.        else:.
+00002060: 2020 2020 2020 2020 2020 2020 6578 7472              extr
+00002070: 6120 3d20 222c 2074 7970 653d 2573 2220  a = ", type=%s" 
+00002080: 2520 7479 7065 2873 656c 662e 5f6d 6574  % type(self._met
+00002090: 6129 2e5f 5f6e 616d 655f 5f0a 2020 2020  a).__name__.    
+000020a0: 2020 2020 7265 7475 726e 2066 2264 642e      return f"dd.
+000020b0: 5363 616c 6172 3c7b 6e61 6d65 7d7b 6578  Scalar<{name}{ex
+000020c0: 7472 617d 3e22 0a0a 2020 2020 6465 6620  tra}>"..    def 
+000020d0: 5f5f 6172 7261 795f 5f28 7365 6c66 293a  __array__(self):
+000020e0: 0a20 2020 2020 2020 2023 2061 7272 6179  .        # array
+000020f0: 2069 6e74 6572 6661 6365 2069 7320 7265   interface is re
+00002100: 7175 6972 6564 2074 6f20 7375 7070 6f72  quired to suppor
+00002110: 7420 7061 6e64 6173 2069 6e73 7461 6e63  t pandas instanc
+00002120: 6520 2b20 5363 616c 6172 0a20 2020 2020  e + Scalar.     
+00002130: 2020 2023 204f 7468 6572 7769 7365 2c20     # Otherwise, 
+00002140: 6162 6f76 6520 6f70 2072 6573 756c 7473  above op results
+00002150: 2069 6e20 7064 2e53 6572 6965 7320 6f66   in pd.Series of
+00002160: 2053 6361 6c61 7220 286f 626a 6563 7420   Scalar (object 
+00002170: 6474 7970 6529 0a20 2020 2020 2020 2072  dtype).        r
+00002180: 6574 7572 6e20 6e70 2e61 7361 7272 6179  eturn np.asarray
+00002190: 2873 656c 662e 636f 6d70 7574 6528 2929  (self.compute())
+000021a0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+000021b0: 2020 2020 6465 6620 5f61 7267 7328 7365      def _args(se
+000021c0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+000021d0: 7572 6e20 2873 656c 662e 6461 736b 2c20  urn (self.dask, 
+000021e0: 7365 6c66 2e5f 6e61 6d65 2c20 7365 6c66  self._name, self
+000021f0: 2e5f 6d65 7461 290a 0a20 2020 2064 6566  ._meta)..    def
+00002200: 205f 5f67 6574 7374 6174 655f 5f28 7365   __getstate__(se
+00002210: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00002220: 7572 6e20 7365 6c66 2e5f 6172 6773 0a0a  urn self._args..
+00002230: 2020 2020 6465 6620 5f5f 7365 7473 7461      def __setsta
+00002240: 7465 5f5f 2873 656c 662c 2073 7461 7465  te__(self, state
+00002250: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+00002260: 6461 736b 2c20 7365 6c66 2e5f 6e61 6d65  dask, self._name
+00002270: 2c20 7365 6c66 2e5f 6d65 7461 203d 2073  , self._meta = s
+00002280: 7461 7465 0a0a 2020 2020 6465 6620 5f5f  tate..    def __
+00002290: 626f 6f6c 5f5f 2873 656c 6629 3a0a 2020  bool__(self):.  
+000022a0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+000022b0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000022c0: 2020 2066 2254 7279 696e 6720 746f 2063     f"Trying to c
+000022d0: 6f6e 7665 7274 207b 7365 6c66 7d20 746f  onvert {self} to
+000022e0: 2061 2062 6f6f 6c65 616e 2076 616c 7565   a boolean value
+000022f0: 2e20 4265 6361 7573 6520 4461 736b 206f  . Because Dask o
+00002300: 626a 6563 7473 2061 7265 2022 0a20 2020  bjects are ".   
+00002310: 2020 2020 2020 2020 2022 6c61 7a69 6c79           "lazily
+00002320: 2065 7661 6c75 6174 6564 2c20 7468 6579   evaluated, they
+00002330: 2063 616e 6e6f 7420 6265 2063 6f6e 7665   cannot be conve
+00002340: 7274 6564 2074 6f20 6120 626f 6f6c 6561  rted to a boolea
+00002350: 6e20 7661 6c75 6520 6f72 2075 7365 6420  n value or used 
+00002360: 220a 2020 2020 2020 2020 2020 2020 2269  ".            "i
+00002370: 6e20 626f 6f6c 6561 6e20 636f 6e64 6974  n boolean condit
+00002380: 696f 6e73 206c 696b 6520 6966 2073 7461  ions like if sta
+00002390: 7465 6d65 6e74 732e 2054 7279 2063 616c  tements. Try cal
+000023a0: 6c69 6e67 202e 636f 6d70 7574 6528 2920  ling .compute() 
+000023b0: 746f 2022 0a20 2020 2020 2020 2020 2020  to ".           
+000023c0: 2022 666f 7263 6520 636f 6d70 7574 6174   "force computat
+000023d0: 696f 6e20 7072 696f 7220 746f 2063 6f6e  ion prior to con
+000023e0: 7665 7274 696e 6720 746f 2061 2062 6f6f  verting to a boo
+000023f0: 6c65 616e 2076 616c 7565 206f 7220 7573  lean value or us
+00002400: 696e 6720 696e 2022 0a20 2020 2020 2020  ing in ".       
+00002410: 2020 2020 2022 6120 636f 6e64 6974 696f       "a conditio
+00002420: 6e61 6c20 7374 6174 656d 656e 742e 220a  nal statement.".
+00002430: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+00002440: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00002450: 206b 6579 2873 656c 6629 3a0a 2020 2020   key(self):.    
+00002460: 2020 2020 7265 7475 726e 2028 7365 6c66      return (self
+00002470: 2e5f 6e61 6d65 2c20 3029 0a0a 2020 2020  ._name, 0)..    
+00002480: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
+00002490: 2064 6566 205f 6765 745f 756e 6172 795f   def _get_unary_
+000024a0: 6f70 6572 6174 6f72 2863 6c73 2c20 6f70  operator(cls, op
+000024b0: 293a 0a20 2020 2020 2020 2064 6566 2066  ):.        def f
+000024c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000024d0: 2020 2020 6e61 6d65 203d 2066 756e 636e      name = funcn
+000024e0: 616d 6528 6f70 2920 2b20 222d 2220 2b20  ame(op) + "-" + 
+000024f0: 746f 6b65 6e69 7a65 2873 656c 6629 0a20  tokenize(self). 
+00002500: 2020 2020 2020 2020 2020 2064 736b 203d             dsk =
+00002510: 207b 286e 616d 652c 2030 293a 2028 6f70   {(name, 0): (op
+00002520: 2c20 2873 656c 662e 5f6e 616d 652c 2030  , (self._name, 0
+00002530: 2929 7d0a 2020 2020 2020 2020 2020 2020  ))}.            
+00002540: 6d65 7461 203d 206f 7028 7365 6c66 2e5f  meta = op(self._
+00002550: 6d65 7461 5f6e 6f6e 656d 7074 7929 0a20  meta_nonempty). 
+00002560: 2020 2020 2020 2020 2020 2067 7261 7068             graph
+00002570: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+00002580: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+00002590: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
+000025a0: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
+000025b0: 5d29 0a20 2020 2020 2020 2020 2020 2072  ]).            r
+000025c0: 6574 7572 6e20 5363 616c 6172 2867 7261  eturn Scalar(gra
+000025d0: 7068 2c20 6e61 6d65 2c20 6d65 7461 290a  ph, name, meta).
+000025e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000025f0: 660a 0a20 2020 2040 636c 6173 736d 6574  f..    @classmet
+00002600: 686f 640a 2020 2020 6465 6620 5f67 6574  hod.    def _get
+00002610: 5f62 696e 6172 795f 6f70 6572 6174 6f72  _binary_operator
+00002620: 2863 6c73 2c20 6f70 2c20 696e 763d 4661  (cls, op, inv=Fa
+00002630: 6c73 6529 3a0a 2020 2020 2020 2020 7265  lse):.        re
+00002640: 7475 726e 206c 616d 6264 6120 7365 6c66  turn lambda self
+00002650: 2c20 6f74 6865 723a 205f 7363 616c 6172  , other: _scalar
+00002660: 5f62 696e 6172 7928 6f70 2c20 7365 6c66  _binary(op, self
+00002670: 2c20 6f74 6865 722c 2069 6e76 3d69 6e76  , other, inv=inv
+00002680: 290a 0a20 2020 2064 6566 2074 6f5f 6465  )..    def to_de
+00002690: 6c61 7965 6428 7365 6c66 2c20 6f70 7469  layed(self, opti
+000026a0: 6d69 7a65 5f67 7261 7068 3d54 7275 6529  mize_graph=True)
+000026b0: 3a0a 2020 2020 2020 2020 2222 2243 6f6e  :.        """Con
+000026c0: 7665 7274 2069 6e74 6f20 6120 6060 6461  vert into a ``da
+000026d0: 736b 2e64 656c 6179 6564 6060 206f 626a  sk.delayed`` obj
+000026e0: 6563 742e 0a0a 2020 2020 2020 2020 5061  ect...        Pa
+000026f0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00002700: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00002710: 2020 2020 6f70 7469 6d69 7a65 5f67 7261      optimize_gra
+00002720: 7068 203a 2062 6f6f 6c2c 206f 7074 696f  ph : bool, optio
+00002730: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00002740: 4966 2054 7275 6520 5b64 6566 6175 6c74  If True [default
+00002750: 5d2c 2074 6865 2067 7261 7068 2069 7320  ], the graph is 
+00002760: 6f70 7469 6d69 7a65 6420 6265 666f 7265  optimized before
+00002770: 2063 6f6e 7665 7274 696e 6720 696e 746f   converting into
+00002780: 0a20 2020 2020 2020 2020 2020 2060 6064  .            ``d
+00002790: 6173 6b2e 6465 6c61 7965 6460 6020 6f62  ask.delayed`` ob
+000027a0: 6a65 6374 732e 0a20 2020 2020 2020 2022  jects..        "
+000027b0: 2222 0a20 2020 2020 2020 2064 736b 203d  "".        dsk =
+000027c0: 2073 656c 662e 5f5f 6461 736b 5f67 7261   self.__dask_gra
+000027d0: 7068 5f5f 2829 0a20 2020 2020 2020 206c  ph__().        l
+000027e0: 6179 6572 203d 2073 656c 662e 5f5f 6461  ayer = self.__da
+000027f0: 736b 5f6c 6179 6572 735f 5f28 295b 305d  sk_layers__()[0]
+00002800: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
+00002810: 6d69 7a65 5f67 7261 7068 3a0a 2020 2020  mize_graph:.    
+00002820: 2020 2020 2020 2020 6473 6b20 3d20 7365          dsk = se
+00002830: 6c66 2e5f 5f64 6173 6b5f 6f70 7469 6d69  lf.__dask_optimi
+00002840: 7a65 5f5f 2864 736b 2c20 7365 6c66 2e5f  ze__(dsk, self._
+00002850: 5f64 6173 6b5f 6b65 7973 5f5f 2829 290a  _dask_keys__()).
+00002860: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
+00002870: 7220 3d20 2264 656c 6179 6564 2d22 202b  r = "delayed-" +
+00002880: 2073 656c 662e 5f6e 616d 650a 2020 2020   self._name.    
+00002890: 2020 2020 2020 2020 6473 6b20 3d20 4869          dsk = Hi
+000028a0: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+000028b0: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6c61  m_collections(la
+000028c0: 7965 722c 2064 736b 2c20 6465 7065 6e64  yer, dsk, depend
+000028d0: 656e 6369 6573 3d28 2929 0a20 2020 2020  encies=()).     
+000028e0: 2020 2072 6574 7572 6e20 4465 6c61 7965     return Delaye
+000028f0: 6428 7365 6c66 2e6b 6579 2c20 6473 6b2c  d(self.key, dsk,
+00002900: 206c 6179 6572 3d6c 6179 6572 290a 0a0a   layer=layer)...
+00002910: 6465 6620 5f73 6361 6c61 725f 6269 6e61  def _scalar_bina
+00002920: 7279 286f 702c 2073 656c 662c 206f 7468  ry(op, self, oth
+00002930: 6572 2c20 696e 763d 4661 6c73 6529 3a0a  er, inv=False):.
+00002940: 2020 2020 6e61 6d65 203d 2066 227b 6675      name = f"{fu
+00002950: 6e63 6e61 6d65 286f 7029 7d2d 7b74 6f6b  ncname(op)}-{tok
+00002960: 656e 697a 6528 7365 6c66 2c20 6f74 6865  enize(self, othe
+00002970: 7229 7d22 0a20 2020 2064 6570 656e 6465  r)}".    depende
+00002980: 6e63 6965 7320 3d20 5b73 656c 665d 0a0a  ncies = [self]..
+00002990: 2020 2020 6473 6b20 3d20 7b7d 0a20 2020      dsk = {}.   
+000029a0: 2072 6574 7572 6e5f 7479 7065 203d 2067   return_type = g
+000029b0: 6574 5f70 6172 616c 6c65 6c5f 7479 7065  et_parallel_type
+000029c0: 286f 7468 6572 290a 0a20 2020 2069 6620  (other)..    if 
+000029d0: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
+000029e0: 2c20 5363 616c 6172 293a 0a20 2020 2020  , Scalar):.     
+000029f0: 2020 2064 6570 656e 6465 6e63 6965 732e     dependencies.
+00002a00: 6170 7065 6e64 286f 7468 6572 290a 2020  append(other).  
+00002a10: 2020 2020 2020 6f74 6865 725f 6b65 7920        other_key 
+00002a20: 3d20 286f 7468 6572 2e5f 6e61 6d65 2c20  = (other._name, 
+00002a30: 3029 0a20 2020 2065 6c69 6620 6973 5f64  0).    elif is_d
+00002a40: 6173 6b5f 636f 6c6c 6563 7469 6f6e 286f  ask_collection(o
+00002a50: 7468 6572 293a 0a20 2020 2020 2020 2072  ther):.        r
+00002a60: 6574 7572 6e20 4e6f 7449 6d70 6c65 6d65  eturn NotImpleme
+00002a70: 6e74 6564 0a20 2020 2065 6c73 653a 0a20  nted.    else:. 
+00002a80: 2020 2020 2020 206f 7468 6572 5f6b 6579         other_key
+00002a90: 203d 206f 7468 6572 0a0a 2020 2020 6473   = other..    ds
+00002aa0: 6b5b 286e 616d 652c 2030 295d 203d 2028  k[(name, 0)] = (
+00002ab0: 0a20 2020 2020 2020 2028 6f70 2c20 6f74  .        (op, ot
+00002ac0: 6865 725f 6b65 792c 2028 7365 6c66 2e5f  her_key, (self._
+00002ad0: 6e61 6d65 2c20 3029 2920 6966 2069 6e76  name, 0)) if inv
+00002ae0: 2065 6c73 6520 286f 702c 2028 7365 6c66   else (op, (self
+00002af0: 2e5f 6e61 6d65 2c20 3029 2c20 6f74 6865  ._name, 0), othe
+00002b00: 725f 6b65 7929 0a20 2020 2029 0a0a 2020  r_key).    )..  
+00002b10: 2020 6f74 6865 725f 6d65 7461 203d 206d    other_meta = m
+00002b20: 616b 655f 6d65 7461 286f 7468 6572 2c20  ake_meta(other, 
+00002b30: 7061 7265 6e74 5f6d 6574 613d 7365 6c66  parent_meta=self
+00002b40: 2e5f 7061 7265 6e74 5f6d 6574 6129 0a20  ._parent_meta). 
+00002b50: 2020 206f 7468 6572 5f6d 6574 615f 6e6f     other_meta_no
+00002b60: 6e65 6d70 7479 203d 206d 6574 615f 6e6f  nempty = meta_no
+00002b70: 6e65 6d70 7479 286f 7468 6572 5f6d 6574  nempty(other_met
+00002b80: 6129 0a20 2020 2069 6620 696e 763a 0a20  a).    if inv:. 
+00002b90: 2020 2020 2020 206d 6574 6120 3d20 6f70         meta = op
+00002ba0: 286f 7468 6572 5f6d 6574 615f 6e6f 6e65  (other_meta_none
+00002bb0: 6d70 7479 2c20 7365 6c66 2e5f 6d65 7461  mpty, self._meta
+00002bc0: 5f6e 6f6e 656d 7074 7929 0a20 2020 2065  _nonempty).    e
+00002bd0: 6c73 653a 0a20 2020 2020 2020 206d 6574  lse:.        met
+00002be0: 6120 3d20 6f70 2873 656c 662e 5f6d 6574  a = op(self._met
+00002bf0: 615f 6e6f 6e65 6d70 7479 2c20 6f74 6865  a_nonempty, othe
+00002c00: 725f 6d65 7461 5f6e 6f6e 656d 7074 7929  r_meta_nonempty)
+00002c10: 0a0a 2020 2020 6772 6170 6820 3d20 4869  ..    graph = Hi
+00002c20: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+00002c30: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
+00002c40: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
+00002c50: 6e63 6965 733d 6465 7065 6e64 656e 6369  ncies=dependenci
+00002c60: 6573 290a 2020 2020 6966 2072 6574 7572  es).    if retur
+00002c70: 6e5f 7479 7065 2069 7320 6e6f 7420 5363  n_type is not Sc
+00002c80: 616c 6172 3a0a 2020 2020 2020 2020 7265  alar:.        re
+00002c90: 7475 726e 2072 6574 7572 6e5f 7479 7065  turn return_type
+00002ca0: 2867 7261 7068 2c20 6e61 6d65 2c20 6d65  (graph, name, me
+00002cb0: 7461 2c20 5b6f 7468 6572 2e69 6e64 6578  ta, [other.index
+00002cc0: 2e6d 696e 2829 2c20 6f74 6865 722e 696e  .min(), other.in
+00002cd0: 6465 782e 6d61 7828 295d 290a 2020 2020  dex.max()]).    
+00002ce0: 656c 7365 3a0a 2020 2020 2020 2020 7265  else:.        re
+00002cf0: 7475 726e 2053 6361 6c61 7228 6772 6170  turn Scalar(grap
+00002d00: 682c 206e 616d 652c 206d 6574 6129 0a0a  h, name, meta)..
+00002d10: 0a63 6c61 7373 205f 4672 616d 6528 4461  .class _Frame(Da
+00002d20: 736b 4d65 7468 6f64 734d 6978 696e 2c20  skMethodsMixin, 
+00002d30: 4f70 6572 6174 6f72 4d65 7468 6f64 4d69  OperatorMethodMi
+00002d40: 7869 6e29 3a0a 2020 2020 2222 2253 7570  xin):.    """Sup
+00002d50: 6572 636c 6173 7320 666f 7220 4461 7461  erclass for Data
+00002d60: 4672 616d 6520 616e 6420 5365 7269 6573  Frame and Series
+00002d70: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00002d80: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00002d90: 2020 2020 6473 6b3a 2064 6963 740a 2020      dsk: dict.  
+00002da0: 2020 2020 2020 5468 6520 6461 736b 2067        The dask g
+00002db0: 7261 7068 2074 6f20 636f 6d70 7574 6520  raph to compute 
+00002dc0: 7468 6973 2044 6174 6146 7261 6d65 0a20  this DataFrame. 
+00002dd0: 2020 206e 616d 653a 2073 7472 0a20 2020     name: str.   
+00002de0: 2020 2020 2054 6865 206b 6579 2070 7265       The key pre
+00002df0: 6669 7820 7468 6174 2073 7065 6369 6669  fix that specifi
+00002e00: 6573 2077 6869 6368 206b 6579 7320 696e  es which keys in
+00002e10: 2074 6865 2064 6173 6b20 636f 6d70 7269   the dask compri
+00002e20: 7365 2074 6869 730a 2020 2020 2020 2020  se this.        
+00002e30: 7061 7274 6963 756c 6172 2044 6174 6146  particular DataF
+00002e40: 7261 6d65 202f 2053 6572 6965 730a 2020  rame / Series.  
+00002e50: 2020 6d65 7461 3a20 7061 6e64 6173 2e44    meta: pandas.D
+00002e60: 6174 6146 7261 6d65 2c20 7061 6e64 6173  ataFrame, pandas
+00002e70: 2e53 6572 6965 732c 206f 7220 7061 6e64  .Series, or pand
+00002e80: 6173 2e49 6e64 6578 0a20 2020 2020 2020  as.Index.       
+00002e90: 2041 6e20 656d 7074 7920 7061 6e64 6173   An empty pandas
+00002ea0: 206f 626a 6563 7420 7769 7468 206e 616d   object with nam
+00002eb0: 6573 2c20 6474 7970 6573 2c20 616e 6420  es, dtypes, and 
+00002ec0: 696e 6469 6365 7320 6d61 7463 6869 6e67  indices matching
+00002ed0: 2074 6865 0a20 2020 2020 2020 2065 7870   the.        exp
+00002ee0: 6563 7465 6420 6f75 7470 7574 2e0a 2020  ected output..  
+00002ef0: 2020 6469 7669 7369 6f6e 733a 2074 7570    divisions: tup
+00002f00: 6c65 206f 6620 696e 6465 7820 7661 6c75  le of index valu
+00002f10: 6573 0a20 2020 2020 2020 2056 616c 7565  es.        Value
+00002f20: 7320 616c 6f6e 6720 7768 6963 6820 7765  s along which we
+00002f30: 2070 6172 7469 7469 6f6e 206f 7572 2062   partition our b
+00002f40: 6c6f 636b 7320 6f6e 2074 6865 2069 6e64  locks on the ind
+00002f50: 6578 0a20 2020 2022 2222 0a0a 2020 2020  ex.    """..    
+00002f60: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00002f70: 662c 2064 736b 2c20 6e61 6d65 2c20 6d65  f, dsk, name, me
+00002f80: 7461 2c20 6469 7669 7369 6f6e 7329 3a0a  ta, divisions):.
+00002f90: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+00002fa0: 7369 6e73 7461 6e63 6528 6473 6b2c 2048  sinstance(dsk, H
+00002fb0: 6967 684c 6576 656c 4772 6170 6829 3a0a  ighLevelGraph):.
+00002fc0: 2020 2020 2020 2020 2020 2020 6473 6b20              dsk 
+00002fd0: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
+00002fe0: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
+00002ff0: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
+00003000: 656e 6465 6e63 6965 733d 5b5d 290a 2020  endencies=[]).  
+00003010: 2020 2020 2020 7365 6c66 2e64 6173 6b20        self.dask 
+00003020: 3d20 6473 6b0a 2020 2020 2020 2020 7365  = dsk.        se
+00003030: 6c66 2e5f 6e61 6d65 203d 206e 616d 650a  lf._name = name.
+00003040: 2020 2020 2020 2020 6d65 7461 203d 206d          meta = m
+00003050: 616b 655f 6d65 7461 286d 6574 6129 0a20  ake_meta(meta). 
+00003060: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+00003070: 6c66 2e5f 6973 5f70 6172 7469 7469 6f6e  lf._is_partition
+00003080: 5f74 7970 6528 6d65 7461 293a 0a20 2020  _type(meta):.   
+00003090: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+000030a0: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
+000030b0: 2020 2020 2020 2020 2020 6622 4578 7065            f"Expe
+000030c0: 6374 6564 206d 6574 6120 746f 2073 7065  cted meta to spe
+000030d0: 6369 6679 2074 7970 6520 7b74 7970 6528  cify type {type(
+000030e0: 7365 6c66 292e 5f5f 6e61 6d65 5f5f 7d2c  self).__name__},
+000030f0: 2067 6f74 2074 7970 6520 220a 2020 2020   got type ".    
+00003100: 2020 2020 2020 2020 2020 2020 6622 7b74              f"{t
+00003110: 7970 656e 616d 6528 7479 7065 286d 6574  ypename(type(met
+00003120: 6129 297d 220a 2020 2020 2020 2020 2020  a))}".          
+00003130: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00003140: 2e5f 6d65 7461 203d 206d 6574 610a 2020  ._meta = meta.  
+00003150: 2020 2020 2020 7365 6c66 2e64 6976 6973        self.divis
+00003160: 696f 6e73 203d 2074 7570 6c65 2864 6976  ions = tuple(div
+00003170: 6973 696f 6e73 290a 0a20 2020 2020 2020  isions)..       
+00003180: 2023 204f 7074 696f 6e61 6c6c 7920 6361   # Optionally ca
+00003190: 7374 206f 626a 6563 7420 6474 7970 6573  st object dtypes
+000031a0: 2074 6f20 6070 7961 7272 6f77 6020 7374   to `pyarrow` st
+000031b0: 7269 6e67 730a 2020 2020 2020 2020 6966  rings.        if
+000031c0: 2064 6173 6b2e 636f 6e66 6967 2e67 6574   dask.config.get
+000031d0: 2822 6461 7461 6672 616d 652e 636f 6e76  ("dataframe.conv
+000031e0: 6572 742d 7374 7269 6e67 2229 3a0a 2020  ert-string"):.  
+000031f0: 2020 2020 2020 2020 2020 6672 6f6d 2064            from d
+00003200: 6173 6b2e 6461 7461 6672 616d 652e 5f70  ask.dataframe._p
+00003210: 7961 7272 6f77 2069 6d70 6f72 7420 6368  yarrow import ch
+00003220: 6563 6b5f 7079 6172 726f 775f 7374 7269  eck_pyarrow_stri
+00003230: 6e67 5f73 7570 706f 7274 6564 0a0a 2020  ng_supported..  
+00003240: 2020 2020 2020 2020 2020 6368 6563 6b5f            check_
+00003250: 7079 6172 726f 775f 7374 7269 6e67 5f73  pyarrow_string_s
+00003260: 7570 706f 7274 6564 2829 0a0a 2020 2020  upported()..    
+00003270: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
+00003280: 6b2e 6461 7461 6672 616d 652e 5f70 7961  k.dataframe._pya
+00003290: 7272 6f77 2069 6d70 6f72 7420 280a 2020  rrow import (.  
+000032a0: 2020 2020 2020 2020 2020 2020 2020 6973                is
+000032b0: 5f6f 626a 6563 745f 7374 7269 6e67 5f64  _object_string_d
+000032c0: 6174 6166 7261 6d65 2c0a 2020 2020 2020  ataframe,.      
+000032d0: 2020 2020 2020 2020 2020 6973 5f6f 626a            is_obj
+000032e0: 6563 745f 7374 7269 6e67 5f64 7479 7065  ect_string_dtype
+000032f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00003300: 2020 6973 5f6f 626a 6563 745f 7374 7269    is_object_stri
+00003310: 6e67 5f69 6e64 6578 2c0a 2020 2020 2020  ng_index,.      
+00003320: 2020 2020 2020 2020 2020 6973 5f6f 626a            is_obj
+00003330: 6563 745f 7374 7269 6e67 5f73 6572 6965  ect_string_serie
+00003340: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00003350: 2020 2074 6f5f 7079 6172 726f 775f 7374     to_pyarrow_st
+00003360: 7269 6e67 2c0a 2020 2020 2020 2020 2020  ring,.          
+00003370: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00003380: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
+00003390: 2020 2020 2020 6973 5f6f 626a 6563 745f        is_object_
+000033a0: 7374 7269 6e67 5f64 6174 6166 7261 6d65  string_dataframe
+000033b0: 286d 6574 6129 0a20 2020 2020 2020 2020  (meta).         
+000033c0: 2020 2020 2020 206f 7220 6973 5f6f 626a         or is_obj
+000033d0: 6563 745f 7374 7269 6e67 5f73 6572 6965  ect_string_serie
+000033e0: 7328 6d65 7461 290a 2020 2020 2020 2020  s(meta).        
+000033f0: 2020 2020 2020 2020 6f72 2069 735f 6f62          or is_ob
+00003400: 6a65 6374 5f73 7472 696e 675f 696e 6465  ject_string_inde
+00003410: 7828 6d65 7461 290a 2020 2020 2020 2020  x(meta).        
+00003420: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+00003430: 2020 2020 2020 2023 2050 7269 6f72 2074         # Prior t
+00003440: 6f20 7061 6e64 6173 3d31 2e34 2c20 6070  o pandas=1.4, `p
+00003450: 642e 496e 6465 7860 2063 6f75 6c64 6e27  d.Index` couldn'
+00003460: 7420 636f 6e74 6169 6e20 6578 7465 6e73  t contain extens
+00003470: 696f 6e20 6474 7970 6573 2e0a 2020 2020  ion dtypes..    
+00003480: 2020 2020 2020 2020 2020 2020 2320 4865              # He
+00003490: 7265 2077 6520 646f 6e27 7420 6361 7374  re we don't cast
+000034a0: 206f 626a 6563 7473 2074 6f20 7079 6172   objects to pyar
+000034b0: 726f 7720 7374 7269 6e67 7320 7768 6572  row strings wher
+000034c0: 6520 6f6e 6c79 2074 6865 2069 6e64 6578  e only the index
+000034d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000034e0: 2023 2063 6f6e 7461 696e 7320 6e6f 6e2d   # contains non-
+000034f0: 7079 6172 726f 7720 7374 7269 6e67 2064  pyarrow string d
+00003500: 6174 612e 0a20 2020 2020 2020 2020 2020  ata..           
+00003510: 2020 2020 2069 6620 6e6f 7420 5041 4e44       if not PAND
+00003520: 4153 5f47 545f 3134 3020 616e 6420 280a  AS_GT_140 and (.
+00003530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003540: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
+00003550: 2020 2020 2020 2020 2020 2020 2020 6973                is
+00003560: 5f6f 626a 6563 745f 7374 7269 6e67 5f64  _object_string_d
+00003570: 6174 6166 7261 6d65 286d 6574 6129 0a20  ataframe(meta). 
+00003580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003590: 2020 2020 2020 2061 6e64 206e 6f74 2061         and not a
+000035a0: 6e79 2869 735f 6f62 6a65 6374 5f73 7472  ny(is_object_str
+000035b0: 696e 675f 6474 7970 6528 6429 2066 6f72  ing_dtype(d) for
+000035c0: 2064 2069 6e20 6d65 7461 2e64 7479 7065   d in meta.dtype
+000035d0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+000035e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000035f0: 2020 2020 2020 2020 2020 2020 206f 7220               or 
+00003600: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00003610: 2020 2020 2020 2020 2020 6973 5f6f 626a            is_obj
+00003620: 6563 745f 7374 7269 6e67 5f73 6572 6965  ect_string_serie
+00003630: 7328 6d65 7461 290a 2020 2020 2020 2020  s(meta).        
+00003640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003650: 616e 6420 6e6f 7420 6973 5f6f 626a 6563  and not is_objec
+00003660: 745f 7374 7269 6e67 5f64 7479 7065 286d  t_string_dtype(m
+00003670: 6574 612e 6474 7970 6529 0a20 2020 2020  eta.dtype).     
+00003680: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00003690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000036a0: 2020 2020 206f 7220 6973 5f6f 626a 6563       or is_objec
+000036b0: 745f 7374 7269 6e67 5f69 6e64 6578 286d  t_string_index(m
+000036c0: 6574 6129 0a20 2020 2020 2020 2020 2020  eta).           
+000036d0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+000036e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000036f0: 726e 0a0a 2020 2020 2020 2020 2020 2020  rn..            
+00003700: 2020 2020 2320 7468 6973 2069 7320 616e      # this is an
+00003710: 2069 6e74 6572 6e61 6c20 6361 6c6c 2c20   internal call, 
+00003720: 616e 6420 6966 2077 6520 656e 666f 7263  and if we enforc
+00003730: 6520 6d65 7461 6461 7461 2c0a 2020 2020  e metadata,.    
+00003740: 2020 2020 2020 2020 2020 2020 2320 6974              # it
+00003750: 206d 6179 2069 6e74 6572 6665 7265 2077   may interfere w
+00003760: 6865 6e20 7265 6164 696e 6720 6373 7620  hen reading csv 
+00003770: 7769 7468 2065 6e66 6f72 6365 3d46 616c  with enforce=Fal
+00003780: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
+00003790: 2020 2072 6573 756c 7420 3d20 7365 6c66     result = self
+000037a0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+000037b0: 746f 5f70 7961 7272 6f77 5f73 7472 696e  to_pyarrow_strin
+000037c0: 672c 2065 6e66 6f72 6365 5f6d 6574 6164  g, enforce_metad
+000037d0: 6174 613d 4661 6c73 6529 0a20 2020 2020  ata=False).     
+000037e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000037f0: 6461 736b 203d 2072 6573 756c 742e 6461  dask = result.da
+00003800: 736b 0a20 2020 2020 2020 2020 2020 2020  sk.             
+00003810: 2020 2073 656c 662e 5f6e 616d 6520 3d20     self._name = 
+00003820: 7265 7375 6c74 2e5f 6e61 6d65 0a20 2020  result._name.   
+00003830: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00003840: 662e 5f6d 6574 6120 3d20 7265 7375 6c74  f._meta = result
+00003850: 2e5f 6d65 7461 0a20 2020 2020 2020 2020  ._meta.         
+00003860: 2020 2020 2020 2073 656c 662e 6469 7669         self.divi
+00003870: 7369 6f6e 7320 3d20 7265 7375 6c74 2e64  sions = result.d
+00003880: 6976 6973 696f 6e73 0a0a 2020 2020 6465  ivisions..    de
+00003890: 6620 5f5f 6461 736b 5f67 7261 7068 5f5f  f __dask_graph__
+000038a0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000038b0: 7265 7475 726e 2073 656c 662e 6461 736b  return self.dask
+000038c0: 0a0a 2020 2020 6465 6620 5f5f 6461 736b  ..    def __dask
+000038d0: 5f6b 6579 735f 5f28 7365 6c66 2920 2d3e  _keys__(self) ->
+000038e0: 206c 6973 745b 4861 7368 6162 6c65 5d3a   list[Hashable]:
+000038f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00003900: 5b28 7365 6c66 2e5f 6e61 6d65 2c20 6929  [(self._name, i)
+00003910: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00003920: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
+00003930: 295d 0a0a 2020 2020 6465 6620 5f5f 6461  )]..    def __da
+00003940: 736b 5f6c 6179 6572 735f 5f28 7365 6c66  sk_layers__(self
+00003950: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00003960: 6e20 2873 656c 662e 5f6e 616d 652c 290a  n (self._name,).
+00003970: 0a20 2020 2064 6566 205f 5f64 6173 6b5f  .    def __dask_
+00003980: 746f 6b65 6e69 7a65 5f5f 2873 656c 6629  tokenize__(self)
+00003990: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000039a0: 2073 656c 662e 5f6e 616d 650a 0a20 2020   self._name..   
+000039b0: 205f 5f64 6173 6b5f 6f70 7469 6d69 7a65   __dask_optimize
+000039c0: 5f5f 203d 2067 6c6f 6261 6c6d 6574 686f  __ = globalmetho
+000039d0: 6428 0a20 2020 2020 2020 206f 7074 696d  d(.        optim
+000039e0: 697a 652c 206b 6579 3d22 6461 7461 6672  ize, key="datafr
+000039f0: 616d 655f 6f70 7469 6d69 7a65 222c 2066  ame_optimize", f
+00003a00: 616c 7365 793d 646f 6e74 5f6f 7074 696d  alsey=dont_optim
+00003a10: 697a 650a 2020 2020 290a 2020 2020 5f5f  ize.    ).    __
+00003a20: 6461 736b 5f73 6368 6564 756c 6572 5f5f  dask_scheduler__
+00003a30: 203d 2073 7461 7469 636d 6574 686f 6428   = staticmethod(
+00003a40: 4445 4641 554c 545f 4745 5429 0a0a 2020  DEFAULT_GET)..  
+00003a50: 2020 6465 6620 5f5f 6461 736b 5f70 6f73    def __dask_pos
+00003a60: 7463 6f6d 7075 7465 5f5f 2873 656c 6629  tcompute__(self)
+00003a70: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00003a80: 2066 696e 616c 697a 652c 2028 290a 0a20   finalize, ().. 
+00003a90: 2020 2064 6566 205f 5f64 6173 6b5f 706f     def __dask_po
+00003aa0: 7374 7065 7273 6973 745f 5f28 7365 6c66  stpersist__(self
+00003ab0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00003ac0: 6e20 7365 6c66 2e5f 7265 6275 696c 642c  n self._rebuild,
+00003ad0: 2028 290a 0a20 2020 2064 6566 205f 7265   ()..    def _re
+00003ae0: 6275 696c 6428 7365 6c66 2c20 6473 6b2c  build(self, dsk,
+00003af0: 202a 2c20 7265 6e61 6d65 3d4e 6f6e 6529   *, rename=None)
+00003b00: 3a0a 2020 2020 2020 2020 6e61 6d65 203d  :.        name =
+00003b10: 2073 656c 662e 5f6e 616d 650a 2020 2020   self._name.    
+00003b20: 2020 2020 6966 2072 656e 616d 653a 0a20      if rename:. 
+00003b30: 2020 2020 2020 2020 2020 206e 616d 6520             name 
+00003b40: 3d20 7265 6e61 6d65 2e67 6574 286e 616d  = rename.get(nam
+00003b50: 652c 206e 616d 6529 0a20 2020 2020 2020  e, name).       
+00003b60: 2072 6574 7572 6e20 7479 7065 2873 656c   return type(sel
+00003b70: 6629 2864 736b 2c20 6e61 6d65 2c20 7365  f)(dsk, name, se
+00003b80: 6c66 2e5f 6d65 7461 2c20 7365 6c66 2e64  lf._meta, self.d
+00003b90: 6976 6973 696f 6e73 290a 0a20 2020 2040  ivisions)..    @
+00003ba0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00003bb0: 205f 636f 6e73 7472 7563 746f 7228 7365   _constructor(se
+00003bc0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00003bd0: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
+00003be0: 740a 0a20 2020 2040 7072 6f70 6572 7479  t..    @property
+00003bf0: 0a20 2020 2064 6566 2064 6976 6973 696f  .    def divisio
+00003c00: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
+00003c10: 2020 2222 220a 2020 2020 2020 2020 5475    """.        Tu
+00003c20: 706c 6520 6f66 2060 606e 7061 7274 6974  ple of ``npartit
+00003c30: 696f 6e73 202b 2031 6060 2076 616c 7565  ions + 1`` value
+00003c40: 732c 2069 6e20 6173 6365 6e64 696e 6720  s, in ascending 
+00003c50: 6f72 6465 722c 206d 6172 6b69 6e67 2074  order, marking t
+00003c60: 6865 0a20 2020 2020 2020 206c 6f77 6572  he.        lower
+00003c70: 2f75 7070 6572 2062 6f75 6e64 7320 6f66  /upper bounds of
+00003c80: 2065 6163 6820 7061 7274 6974 696f 6e27   each partition'
+00003c90: 7320 696e 6465 782e 2044 6976 6973 696f  s index. Divisio
+00003ca0: 6e73 2061 6c6c 6f77 2044 6173 6b0a 2020  ns allow Dask.  
+00003cb0: 2020 2020 2020 746f 206b 6e6f 7720 7768        to know wh
+00003cc0: 6963 6820 7061 7274 6974 696f 6e20 7769  ich partition wi
+00003cd0: 6c6c 2063 6f6e 7461 696e 2061 2067 6976  ll contain a giv
+00003ce0: 656e 2076 616c 7565 2c20 7369 676e 6966  en value, signif
+00003cf0: 6963 616e 746c 790a 2020 2020 2020 2020  icantly.        
+00003d00: 7370 6565 6469 6e67 2075 7020 6f70 6572  speeding up oper
+00003d10: 6174 696f 6e73 206c 696b 6520 606c 6f63  ations like `loc
+00003d20: 602c 2060 6d65 7267 6560 2c20 616e 6420  `, `merge`, and 
+00003d30: 6067 726f 7570 6279 6020 6279 206e 6f74  `groupby` by not
+00003d40: 0a20 2020 2020 2020 2068 6176 696e 6720  .        having 
+00003d50: 746f 2073 6561 7263 6820 7468 6520 6675  to search the fu
+00003d60: 6c6c 2064 6174 6173 6574 2e0a 0a20 2020  ll dataset...   
+00003d70: 2020 2020 2045 7861 6d70 6c65 3a20 666f       Example: fo
+00003d80: 7220 6060 6469 7669 7369 6f6e 7320 3d20  r ``divisions = 
+00003d90: 2830 2c20 3130 2c20 3530 2c20 3130 3029  (0, 10, 50, 100)
+00003da0: 6060 2c20 7468 6572 6520 6172 6520 7468  ``, there are th
+00003db0: 7265 6520 7061 7274 6974 696f 6e73 2c0a  ree partitions,.
+00003dc0: 2020 2020 2020 2020 7768 6572 6520 7468          where th
+00003dd0: 6520 696e 6465 7820 696e 2065 6163 6820  e index in each 
+00003de0: 7061 7274 6974 696f 6e20 636f 6e74 6169  partition contai
+00003df0: 6e73 2076 616c 7565 7320 5b30 2c20 3130  ns values [0, 10
+00003e00: 292c 205b 3130 2c20 3530 292c 0a20 2020  ), [10, 50),.   
+00003e10: 2020 2020 2061 6e64 205b 3530 2c20 3130       and [50, 10
+00003e20: 305d 2c20 7265 7370 6563 7469 7665 6c79  0], respectively
+00003e30: 2e20 4461 736b 2074 6865 7265 666f 7265  . Dask therefore
+00003e40: 206b 6e6f 7773 2060 6064 662e 6c6f 635b   knows ``df.loc[
+00003e50: 3435 5d60 600a 2020 2020 2020 2020 7769  45]``.        wi
+00003e60: 6c6c 2062 6520 696e 2074 6865 2073 6563  ll be in the sec
+00003e70: 6f6e 6420 7061 7274 6974 696f 6e2e 0a0a  ond partition...
+00003e80: 2020 2020 2020 2020 5768 656e 2065 7665          When eve
+00003e90: 7279 2069 7465 6d20 696e 2060 6064 6976  ry item in ``div
+00003ea0: 6973 696f 6e73 6060 2069 7320 6060 4e6f  isions`` is ``No
+00003eb0: 6e65 6060 2c20 7468 6520 6469 7669 7369  ne``, the divisi
+00003ec0: 6f6e 7320 6172 6520 756e 6b6e 6f77 6e2e  ons are unknown.
+00003ed0: 0a20 2020 2020 2020 204d 6f73 7420 6f70  .        Most op
+00003ee0: 6572 6174 696f 6e73 2063 616e 2073 7469  erations can sti
+00003ef0: 6c6c 2062 6520 7065 7266 6f72 6d65 642c  ll be performed,
+00003f00: 2062 7574 2073 6f6d 6520 7769 6c6c 2062   but some will b
+00003f10: 6520 6d75 6368 2073 6c6f 7765 722c 0a20  e much slower,. 
+00003f20: 2020 2020 2020 2061 6e64 2061 2066 6577         and a few
+00003f30: 206d 6179 2066 6169 6c2e 0a0a 2020 2020   may fail...    
+00003f40: 2020 2020 4974 2069 7320 756e 636f 6d6d      It is uncomm
+00003f50: 6f6e 2074 6f20 7365 7420 6060 6469 7669  on to set ``divi
+00003f60: 7369 6f6e 7360 6020 6469 7265 6374 6c79  sions`` directly
+00003f70: 2e20 496e 7374 6561 642c 2075 7365 2060  . Instead, use `
+00003f80: 6073 6574 5f69 6e64 6578 6060 2c0a 2020  `set_index``,.  
+00003f90: 2020 2020 2020 7768 6963 6820 736f 7274        which sort
+00003fa0: 7320 616e 6420 7370 6c69 7473 2074 6865  s and splits the
+00003fb0: 2064 6174 6120 6173 206e 6565 6465 642e   data as needed.
+00003fc0: 0a20 2020 2020 2020 2053 6565 2068 7474  .        See htt
+00003fd0: 7073 3a2f 2f64 6f63 732e 6461 736b 2e6f  ps://docs.dask.o
+00003fe0: 7267 2f65 6e2f 6c61 7465 7374 2f64 6174  rg/en/latest/dat
+00003ff0: 6166 7261 6d65 2d64 6573 6967 6e2e 6874  aframe-design.ht
+00004000: 6d6c 2370 6172 7469 7469 6f6e 732e 0a20  ml#partitions.. 
+00004010: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00004020: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00004030: 6469 7669 7369 6f6e 730a 0a20 2020 2040  divisions..    @
+00004040: 6469 7669 7369 6f6e 732e 7365 7474 6572  divisions.setter
+00004050: 0a20 2020 2064 6566 2064 6976 6973 696f  .    def divisio
+00004060: 6e73 2873 656c 662c 2076 616c 7565 293a  ns(self, value):
+00004070: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00004080: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
+00004090: 2c20 7475 706c 6529 3a0a 2020 2020 2020  , tuple):.      
+000040a0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+000040b0: 4572 726f 7228 2264 6976 6973 696f 6e73  Error("divisions
+000040c0: 206d 7573 7420 6265 2061 2074 7570 6c65   must be a tuple
+000040d0: 2229 0a0a 2020 2020 2020 2020 6966 2068  ")..        if h
+000040e0: 6173 6174 7472 2873 656c 662c 2022 5f64  asattr(self, "_d
+000040f0: 6976 6973 696f 6e73 2229 2061 6e64 206c  ivisions") and l
+00004100: 656e 2876 616c 7565 2920 213d 206c 656e  en(value) != len
+00004110: 2873 656c 662e 5f64 6976 6973 696f 6e73  (self._divisions
+00004120: 293a 0a20 2020 2020 2020 2020 2020 206e  ):.            n
+00004130: 203d 206c 656e 2873 656c 662e 5f64 6976   = len(self._div
+00004140: 6973 696f 6e73 290a 2020 2020 2020 2020  isions).        
+00004150: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00004160: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00004170: 2020 2020 2020 6622 5468 6973 2064 6174        f"This dat
+00004180: 6166 7261 6d65 2068 6173 206e 7061 7274  aframe has npart
+00004190: 6974 696f 6e73 3d7b 6e20 2d20 317d 2c20  itions={n - 1}, 
+000041a0: 6469 7669 7369 6f6e 7320 7368 6f75 6c64  divisions should
+000041b0: 2062 6520 6120 220a 2020 2020 2020 2020   be a ".        
+000041c0: 2020 2020 2020 2020 6622 7475 706c 6520          f"tuple 
+000041d0: 6f66 206c 656e 6774 683d 7b6e 7d2c 2067  of length={n}, g
+000041e0: 6f74 207b 6c65 6e28 7661 6c75 6529 7d22  ot {len(value)}"
+000041f0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00004200: 2020 2020 2020 2020 6966 204e 6f6e 6520          if None 
+00004210: 696e 2076 616c 7565 3a0a 2020 2020 2020  in value:.      
+00004220: 2020 2020 2020 6966 2061 6e79 2876 2069        if any(v i
+00004230: 7320 6e6f 7420 4e6f 6e65 2066 6f72 2076  s not None for v
+00004240: 2069 6e20 7661 6c75 6529 3a0a 2020 2020   in value):.    
+00004250: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00004260: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+00004270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004280: 2020 2264 6976 6973 696f 6e73 206d 6179    "divisions may
+00004290: 206e 6f74 2063 6f6e 7461 696e 2061 206d   not contain a m
+000042a0: 6978 206f 6620 4e6f 6e65 2061 6e64 206e  ix of None and n
+000042b0: 6f6e 2d4e 6f6e 6520 7661 6c75 6573 220a  on-None values".
+000042c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000042d0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+000042e0: 2020 2020 2020 2020 2020 2020 2320 4b6e              # Kn
+000042f0: 6f77 6e20 6469 7669 7369 6f6e 732c 2063  own divisions, c
+00004300: 6865 636b 206d 6f6e 6f74 6f6e 6963 616c  heck monotonical
+00004310: 6c79 2069 6e63 7265 6173 696e 670a 0a20  ly increasing.. 
+00004320: 2020 2020 2020 2020 2020 2023 2058 5858             # XXX
+00004330: 3a20 6966 2074 6865 2069 6e64 6578 2064  : if the index d
+00004340: 7479 7065 2069 7320 616e 206f 7264 6572  type is an order
+00004350: 6564 2063 6174 6567 6f72 6963 616c 2064  ed categorical d
+00004360: 7479 7065 2c20 7468 656e 2077 6520 736b  type, then we sk
+00004370: 6970 2074 6865 0a20 2020 2020 2020 2020  ip the.         
+00004380: 2020 2023 2073 6f72 7465 646e 6573 7320     # sortedness 
+00004390: 6368 6563 6b2c 2073 696e 6365 2074 6865  check, since the
+000043a0: 206f 7264 6572 2069 7320 6474 7970 6520   order is dtype 
+000043b0: 6465 7065 6e64 656e 740a 2020 2020 2020  dependent.      
+000043c0: 2020 2020 2020 696e 6465 785f 6474 7970        index_dtyp
+000043d0: 6520 3d20 6765 7461 7474 7228 7365 6c66  e = getattr(self
+000043e0: 2e5f 6d65 7461 2c20 2269 6e64 6578 222c  ._meta, "index",
+000043f0: 2073 656c 662e 5f6d 6574 6129 2e64 7479   self._meta).dty
+00004400: 7065 0a20 2020 2020 2020 2020 2020 2069  pe.            i
+00004410: 6620 6e6f 7420 280a 2020 2020 2020 2020  f not (.        
+00004420: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
+00004430: 6365 2869 6e64 6578 5f64 7479 7065 2c20  ce(index_dtype, 
+00004440: 7064 2e43 6174 6567 6f72 6963 616c 4474  pd.CategoricalDt
+00004450: 7970 6529 2061 6e64 2069 6e64 6578 5f64  ype) and index_d
+00004460: 7479 7065 2e6f 7264 6572 6564 0a20 2020  type.ordered.   
+00004470: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
+00004480: 2020 2020 2020 2020 2020 2020 6966 2076              if v
+00004490: 616c 7565 2021 3d20 7475 706c 6528 736f  alue != tuple(so
+000044a0: 7274 6564 2876 616c 7565 2929 3a0a 2020  rted(value)):.  
+000044b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000044c0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000044d0: 6f72 2822 6469 7669 7369 6f6e 7320 6d75  or("divisions mu
+000044e0: 7374 2062 6520 736f 7274 6564 2229 0a0a  st be sorted")..
+000044f0: 2020 2020 2020 2020 7365 6c66 2e5f 6469          self._di
+00004500: 7669 7369 6f6e 7320 3d20 7661 6c75 650a  visions = value.
+00004510: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00004520: 2020 2064 6566 206e 7061 7274 6974 696f     def npartitio
+00004530: 6e73 2873 656c 6629 202d 3e20 696e 743a  ns(self) -> int:
+00004540: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00004550: 726e 206e 756d 6265 7220 6f66 2070 6172  rn number of par
+00004560: 7469 7469 6f6e 7322 2222 0a20 2020 2020  titions""".     
+00004570: 2020 2072 6574 7572 6e20 6c65 6e28 7365     return len(se
+00004580: 6c66 2e64 6976 6973 696f 6e73 2920 2d20  lf.divisions) - 
+00004590: 310a 0a20 2020 2040 7072 6f70 6572 7479  1..    @property
+000045a0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+000045b0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+000045c0: 0a20 2020 2064 6566 2061 7474 7273 2873  .    def attrs(s
+000045d0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+000045e0: 7475 726e 2073 656c 662e 5f6d 6574 612e  turn self._meta.
+000045f0: 6174 7472 730a 0a20 2020 2040 6174 7472  attrs..    @attr
+00004600: 732e 7365 7474 6572 0a20 2020 2064 6566  s.setter.    def
+00004610: 2061 7474 7273 2873 656c 662c 2076 616c   attrs(self, val
+00004620: 7565 293a 0a20 2020 2020 2020 2073 656c  ue):.        sel
+00004630: 662e 5f6d 6574 612e 6174 7472 7320 3d20  f._meta.attrs = 
+00004640: 6469 6374 2876 616c 7565 290a 0a20 2020  dict(value)..   
+00004650: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00004660: 6566 2073 697a 6528 7365 6c66 293a 0a20  ef size(self):. 
+00004670: 2020 2020 2020 2022 2222 5369 7a65 206f         """Size o
+00004680: 6620 7468 6520 5365 7269 6573 206f 7220  f the Series or 
+00004690: 4461 7461 4672 616d 6520 6173 2061 2044  DataFrame as a D
+000046a0: 656c 6179 6564 206f 626a 6563 742e 0a0a  elayed object...
+000046b0: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+000046c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000046d0: 2d0a 2020 2020 2020 2020 3e3e 3e20 7365  -.        >>> se
+000046e0: 7269 6573 2e73 697a 6520 2023 2064 6f63  ries.size  # doc
+000046f0: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
+00004700: 2020 2020 6464 2e53 6361 6c61 723c 7369      dd.Scalar<si
+00004710: 7a65 2d61 672e 2e2e 2c20 6474 7970 653d  ze-ag..., dtype=
+00004720: 696e 7436 343e 0a20 2020 2020 2020 2022  int64>.        "
+00004730: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00004740: 6e20 7365 6c66 2e72 6564 7563 7469 6f6e  n self.reduction
+00004750: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
+00004760: 7468 6f64 732e 7369 7a65 2c20 6e70 2e73  thods.size, np.s
+00004770: 756d 2c20 746f 6b65 6e3d 2273 697a 6522  um, token="size"
+00004780: 2c20 6d65 7461 3d69 6e74 2c20 7370 6c69  , meta=int, spli
+00004790: 745f 6576 6572 793d 4661 6c73 650a 2020  t_every=False.  
+000047a0: 2020 2020 2020 290a 0a20 2020 2040 7072        )..    @pr
+000047b0: 6f70 6572 7479 0a20 2020 2064 6566 205f  operty.    def _
+000047c0: 6d65 7461 5f6e 6f6e 656d 7074 7928 7365  meta_nonempty(se
+000047d0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+000047e0: 4120 6e6f 6e2d 656d 7074 7920 7665 7273  A non-empty vers
+000047f0: 696f 6e20 6f66 2060 5f6d 6574 6160 2077  ion of `_meta` w
+00004800: 6974 6820 6661 6b65 2064 6174 612e 2222  ith fake data.""
+00004810: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00004820: 206d 6574 615f 6e6f 6e65 6d70 7479 2873   meta_nonempty(s
+00004830: 656c 662e 5f6d 6574 6129 0a0a 2020 2020  elf._meta)..    
+00004840: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00004850: 6620 5f61 7267 7328 7365 6c66 293a 0a20  f _args(self):. 
+00004860: 2020 2020 2020 2072 6574 7572 6e20 2873         return (s
+00004870: 656c 662e 6461 736b 2c20 7365 6c66 2e5f  elf.dask, self._
+00004880: 6e61 6d65 2c20 7365 6c66 2e5f 6d65 7461  name, self._meta
+00004890: 2c20 7365 6c66 2e64 6976 6973 696f 6e73  , self.divisions
+000048a0: 290a 0a20 2020 2064 6566 205f 5f67 6574  )..    def __get
+000048b0: 7374 6174 655f 5f28 7365 6c66 293a 0a20  state__(self):. 
+000048c0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000048d0: 6c66 2e5f 6172 6773 0a0a 2020 2020 6465  lf._args..    de
+000048e0: 6620 5f5f 7365 7473 7461 7465 5f5f 2873  f __setstate__(s
+000048f0: 656c 662c 2073 7461 7465 293a 0a20 2020  elf, state):.   
+00004900: 2020 2020 2073 656c 662e 6461 736b 2c20       self.dask, 
+00004910: 7365 6c66 2e5f 6e61 6d65 2c20 7365 6c66  self._name, self
+00004920: 2e5f 6d65 7461 2c20 7365 6c66 2e5f 6469  ._meta, self._di
+00004930: 7669 7369 6f6e 7320 3d20 7374 6174 650a  visions = state.
+00004940: 0a20 2020 2064 6566 2063 6f70 7928 7365  .    def copy(se
+00004950: 6c66 2c20 6465 6570 3d46 616c 7365 293a  lf, deep=False):
+00004960: 0a20 2020 2020 2020 2022 2222 4d61 6b65  .        """Make
+00004970: 2061 2063 6f70 7920 6f66 2074 6865 2064   a copy of the d
+00004980: 6174 6166 7261 6d65 0a0a 2020 2020 2020  ataframe..      
+00004990: 2020 5468 6973 2069 7320 7374 7269 6374    This is strict
+000049a0: 6c79 2061 2073 6861 6c6c 6f77 2063 6f70  ly a shallow cop
+000049b0: 7920 6f66 2074 6865 2075 6e64 6572 6c79  y of the underly
+000049c0: 696e 6720 636f 6d70 7574 6174 696f 6e61  ing computationa
+000049d0: 6c20 6772 6170 682e 0a20 2020 2020 2020  l graph..       
+000049e0: 2049 7420 646f 6573 206e 6f74 2061 6666   It does not aff
+000049f0: 6563 7420 7468 6520 756e 6465 726c 7969  ect the underlyi
+00004a00: 6e67 2064 6174 610a 0a20 2020 2020 2020  ng data..       
+00004a10: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00004a20: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00004a30: 2020 2020 2020 2064 6565 7020 3a20 626f         deep : bo
+00004a40: 6f6c 6561 6e2c 2064 6566 6175 6c74 2046  olean, default F
+00004a50: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00004a60: 2054 6865 2064 6565 7020 7661 6c75 6520   The deep value 
+00004a70: 6d75 7374 2062 6520 6046 616c 7365 6020  must be `False` 
+00004a80: 616e 6420 6974 2069 7320 6465 636c 6172  and it is declar
+00004a90: 6564 2061 7320 6120 7061 7261 6d65 7465  ed as a paramete
+00004aa0: 7220 6a75 7374 2066 6f72 0a20 2020 2020  r just for.     
+00004ab0: 2020 2020 2020 2063 6f6d 7061 7469 6269         compatibi
+00004ac0: 6c69 7479 2077 6974 6820 7468 6972 642d  lity with third-
+00004ad0: 7061 7274 7920 6c69 6272 6172 6965 7320  party libraries 
+00004ae0: 6c69 6b65 2063 7544 460a 2020 2020 2020  like cuDF.      
+00004af0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+00004b00: 2064 6565 7020 6973 206e 6f74 2046 616c   deep is not Fal
+00004b10: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00004b20: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00004b30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00004b40: 2020 2254 6865 2060 6465 6570 6020 7661    "The `deep` va
+00004b50: 6c75 6520 6d75 7374 2062 6520 4661 6c73  lue must be Fals
+00004b60: 652e 2054 6869 7320 6973 2073 7472 6963  e. This is stric
+00004b70: 746c 7920 6120 7368 616c 6c6f 7720 636f  tly a shallow co
+00004b80: 7079 2022 0a20 2020 2020 2020 2020 2020  py ".           
+00004b90: 2020 2020 2022 6f66 2074 6865 2075 6e64       "of the und
+00004ba0: 6572 6c79 696e 6720 636f 6d70 7574 6174  erlying computat
+00004bb0: 696f 6e61 6c20 6772 6170 682e 220a 2020  ional graph.".  
+00004bc0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00004bd0: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
+00004be0: 645f 6f62 6a65 6374 2873 656c 662e 6461  d_object(self.da
+00004bf0: 736b 2c20 7365 6c66 2e5f 6e61 6d65 2c20  sk, self._name, 
+00004c00: 7365 6c66 2e5f 6d65 7461 2c20 7365 6c66  self._meta, self
+00004c10: 2e64 6976 6973 696f 6e73 290a 0a20 2020  .divisions)..   
+00004c20: 2064 6566 205f 5f61 7272 6179 5f5f 2873   def __array__(s
+00004c30: 656c 662c 2064 7479 7065 3d4e 6f6e 652c  elf, dtype=None,
+00004c40: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00004c50: 2020 2020 7365 6c66 2e5f 636f 6d70 7574      self._comput
+00004c60: 6564 203d 2073 656c 662e 636f 6d70 7574  ed = self.comput
+00004c70: 6528 290a 2020 2020 2020 2020 7820 3d20  e().        x = 
+00004c80: 6e70 2e61 7272 6179 2873 656c 662e 5f63  np.array(self._c
+00004c90: 6f6d 7075 7465 6429 0a20 2020 2020 2020  omputed).       
+00004ca0: 2072 6574 7572 6e20 780a 0a20 2020 2064   return x..    d
+00004cb0: 6566 205f 5f61 7272 6179 5f77 7261 705f  ef __array_wrap_
+00004cc0: 5f28 7365 6c66 2c20 6172 7261 792c 2063  _(self, array, c
+00004cd0: 6f6e 7465 7874 3d4e 6f6e 6529 3a0a 2020  ontext=None):.  
+00004ce0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+00004cf0: 6d70 6c65 6d65 6e74 6564 4572 726f 720a  mplementedError.
+00004d00: 0a20 2020 2064 6566 205f 5f61 7272 6179  .    def __array
+00004d10: 5f75 6675 6e63 5f5f 2873 656c 662c 206e  _ufunc__(self, n
+00004d20: 756d 7079 5f75 6675 6e63 2c20 6d65 7468  umpy_ufunc, meth
+00004d30: 6f64 2c20 2a69 6e70 7574 732c 202a 2a6b  od, *inputs, **k
+00004d40: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00004d50: 6f75 7420 3d20 6b77 6172 6773 2e67 6574  out = kwargs.get
+00004d60: 2822 6f75 7422 2c20 2829 290a 2020 2020  ("out", ()).    
+00004d70: 2020 2020 666f 7220 7820 696e 2069 6e70      for x in inp
+00004d80: 7574 7320 2b20 6f75 743a 0a20 2020 2020  uts + out:.     
+00004d90: 2020 2020 2020 2023 2075 6675 6e63 7320         # ufuncs 
+00004da0: 776f 726b 2077 6974 6820 302d 6469 6d65  work with 0-dime
+00004db0: 6e73 696f 6e61 6c20 4e75 6d50 7920 6e64  nsional NumPy nd
+00004dc0: 6172 7261 7973 0a20 2020 2020 2020 2020  arrays.         
+00004dd0: 2020 2023 2073 6f20 7765 2064 6f6e 2774     # so we don't
+00004de0: 2077 616e 7420 746f 2072 6169 7365 204e   want to raise N
+00004df0: 6f74 496d 706c 656d 656e 7465 640a 2020  otImplemented.  
+00004e00: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00004e10: 6e73 7461 6e63 6528 782c 206e 702e 6e64  nstance(x, np.nd
+00004e20: 6172 7261 7929 2061 6e64 2078 2e73 6861  array) and x.sha
+00004e30: 7065 203d 3d20 2829 3a0a 2020 2020 2020  pe == ():.      
+00004e40: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
+00004e50: 7565 0a20 2020 2020 2020 2020 2020 2065  ue.            e
+00004e60: 6c69 6620 6e6f 7420 6973 696e 7374 616e  lif not isinstan
+00004e70: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
+00004e80: 2020 2020 782c 2028 4e75 6d62 6572 2c20      x, (Number, 
+00004e90: 5363 616c 6172 2c20 5f46 7261 6d65 2c20  Scalar, _Frame, 
+00004ea0: 4172 7261 792c 2070 642e 4461 7461 4672  Array, pd.DataFr
+00004eb0: 616d 652c 2070 642e 5365 7269 6573 2c20  ame, pd.Series, 
+00004ec0: 7064 2e49 6e64 6578 290a 2020 2020 2020  pd.Index).      
+00004ed0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00004ee0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00004ef0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 0a0a  NotImplemented..
+00004f00: 2020 2020 2020 2020 6966 206d 6574 686f          if metho
+00004f10: 6420 3d3d 2022 5f5f 6361 6c6c 5f5f 223a  d == "__call__":
+00004f20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00004f30: 6e75 6d70 795f 7566 756e 632e 7369 676e  numpy_ufunc.sign
+00004f40: 6174 7572 6520 6973 206e 6f74 204e 6f6e  ature is not Non
+00004f50: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00004f60: 2020 2072 6574 7572 6e20 4e6f 7449 6d70     return NotImp
+00004f70: 6c65 6d65 6e74 6564 0a20 2020 2020 2020  lemented.       
+00004f80: 2020 2020 2069 6620 6e75 6d70 795f 7566       if numpy_uf
+00004f90: 756e 632e 6e6f 7574 203e 2031 3a0a 2020  unc.nout > 1:.  
+00004fa0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00004fb0: 7566 756e 6373 2077 6974 6820 6d75 6c74  ufuncs with mult
+00004fc0: 6970 6c65 206f 7574 7075 7420 7661 6c75  iple output valu
+00004fd0: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
+00004fe0: 2020 2023 2061 7265 206e 6f74 2079 6574     # are not yet
+00004ff0: 2073 7570 706f 7274 6564 2066 6f72 2066   supported for f
+00005000: 7261 6d65 730a 2020 2020 2020 2020 2020  rames.          
+00005010: 2020 2020 2020 7265 7475 726e 204e 6f74        return Not
+00005020: 496d 706c 656d 656e 7465 640a 2020 2020  Implemented.    
+00005030: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00005040: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00005050: 7475 726e 2065 6c65 6d77 6973 6528 6e75  turn elemwise(nu
+00005060: 6d70 795f 7566 756e 632c 202a 696e 7075  mpy_ufunc, *inpu
+00005070: 7473 2c20 2a2a 6b77 6172 6773 290a 2020  ts, **kwargs).  
+00005080: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00005090: 2020 2020 2020 2020 2320 7566 756e 6320          # ufunc 
+000050a0: 6d65 7468 6f64 7320 6172 6520 6e6f 7420  methods are not 
+000050b0: 7965 7420 7375 7070 6f72 7465 6420 666f  yet supported fo
+000050c0: 7220 6672 616d 6573 0a20 2020 2020 2020  r frames.       
+000050d0: 2020 2020 2072 6574 7572 6e20 4e6f 7449       return NotI
+000050e0: 6d70 6c65 6d65 6e74 6564 0a0a 2020 2020  mplemented..    
+000050f0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00005100: 6620 5f65 6c65 6d77 6973 6528 7365 6c66  f _elemwise(self
+00005110: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00005120: 6e20 656c 656d 7769 7365 0a0a 2020 2020  n elemwise..    
+00005130: 6465 6620 5f72 6570 725f 6461 7461 2873  def _repr_data(s
+00005140: 656c 6629 3a0a 2020 2020 2020 2020 7261  elf):.        ra
+00005150: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+00005160: 6564 4572 726f 720a 0a20 2020 2040 7072  edError..    @pr
+00005170: 6f70 6572 7479 0a20 2020 2064 6566 205f  operty.    def _
+00005180: 7265 7072 5f64 6976 6973 696f 6e73 2873  repr_divisions(s
+00005190: 656c 6629 3a0a 2020 2020 2020 2020 6e61  elf):.        na
+000051a0: 6d65 203d 2066 226e 7061 7274 6974 696f  me = f"npartitio
+000051b0: 6e73 3d7b 7365 6c66 2e6e 7061 7274 6974  ns={self.npartit
+000051c0: 696f 6e73 7d22 0a20 2020 2020 2020 2069  ions}".        i
+000051d0: 6620 7365 6c66 2e6b 6e6f 776e 5f64 6976  f self.known_div
+000051e0: 6973 696f 6e73 3a0a 2020 2020 2020 2020  isions:.        
+000051f0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
+00005200: 7064 2e49 6e64 6578 2873 656c 662e 6469  pd.Index(self.di
+00005210: 7669 7369 6f6e 732c 206e 616d 653d 6e61  visions, name=na
+00005220: 6d65 290a 2020 2020 2020 2020 656c 7365  me).        else
+00005230: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00005240: 6176 6f69 6420 746f 2062 6520 636f 6e76  avoid to be conv
+00005250: 6572 7465 6420 746f 204e 614e 0a20 2020  erted to NaN.   
+00005260: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
+00005270: 6e73 203d 2070 642e 496e 6465 7828 5b22  ns = pd.Index(["
+00005280: 225d 202a 2028 7365 6c66 2e6e 7061 7274  "] * (self.npart
+00005290: 6974 696f 6e73 202b 2031 292c 206e 616d  itions + 1), nam
+000052a0: 653d 6e61 6d65 290a 2020 2020 2020 2020  e=name).        
+000052b0: 7265 7475 726e 2064 6976 6973 696f 6e73  return divisions
+000052c0: 0a0a 2020 2020 6465 6620 5f5f 7265 7072  ..    def __repr
+000052d0: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+000052e0: 2020 6461 7461 203d 2073 656c 662e 5f72    data = self._r
+000052f0: 6570 725f 6461 7461 2829 2e74 6f5f 7374  epr_data().to_st
+00005300: 7269 6e67 286d 6178 5f72 6f77 733d 352c  ring(max_rows=5,
+00005310: 2073 686f 775f 6469 6d65 6e73 696f 6e73   show_dimensions
+00005320: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
+00005330: 5f73 7472 5f66 6d74 203d 2022 2222 4461  _str_fmt = """Da
+00005340: 736b 207b 6b6c 6173 737d 2053 7472 7563  sk {klass} Struc
+00005350: 7475 7265 3a0a 7b64 6174 617d 0a44 6173  ture:.{data}.Das
+00005360: 6b20 4e61 6d65 3a20 7b6e 616d 657d 2c20  k Name: {name}, 
+00005370: 7b6c 6179 6572 737d 2222 220a 2020 2020  {layers}""".    
+00005380: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
+00005390: 636f 6c75 6d6e 7329 203d 3d20 303a 0a20  columns) == 0:. 
+000053a0: 2020 2020 2020 2020 2020 2064 6174 6120             data 
+000053b0: 3d20 6461 7461 2e70 6172 7469 7469 6f6e  = data.partition
+000053c0: 2822 5c6e 2229 5b2d 315d 2e72 6570 6c61  ("\n")[-1].repla
+000053d0: 6365 2822 496e 6465 7822 2c20 2244 6976  ce("Index", "Div
+000053e0: 6973 696f 6e73 2229 0a20 2020 2020 2020  isions").       
+000053f0: 2020 2020 205f 7374 725f 666d 7420 3d20       _str_fmt = 
+00005400: 6622 456d 7074 7920 7b5f 7374 725f 666d  f"Empty {_str_fm
+00005410: 747d 220a 2020 2020 2020 2020 7265 7475  t}".        retu
+00005420: 726e 205f 7374 725f 666d 742e 666f 726d  rn _str_fmt.form
+00005430: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+00005440: 6b6c 6173 733d 7365 6c66 2e5f 5f63 6c61  klass=self.__cla
+00005450: 7373 5f5f 2e5f 5f6e 616d 655f 5f2c 0a20  ss__.__name__,. 
+00005460: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00005470: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
+00005480: 2020 6e61 6d65 3d6b 6579 5f73 706c 6974    name=key_split
+00005490: 2873 656c 662e 5f6e 616d 6529 2c0a 2020  (self._name),.  
+000054a0: 2020 2020 2020 2020 2020 6c61 7965 7273            layers
+000054b0: 3d6d 6179 6265 5f70 6c75 7261 6c69 7a65  =maybe_pluralize
+000054c0: 286c 656e 2873 656c 662e 6461 736b 2e6c  (len(self.dask.l
+000054d0: 6179 6572 7329 2c20 2267 7261 7068 206c  ayers), "graph l
+000054e0: 6179 6572 2229 2c0a 2020 2020 2020 2020  ayer"),.        
+000054f0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00005500: 0a20 2020 2064 6566 2069 6e64 6578 2873  .    def index(s
+00005510: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00005520: 2252 6574 7572 6e20 6461 736b 2049 6e64  "Return dask Ind
+00005530: 6578 2069 6e73 7461 6e63 6522 2222 0a20  ex instance""". 
+00005540: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00005550: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00005560: 7328 0a20 2020 2020 2020 2020 2020 2067  s(.            g
+00005570: 6574 6174 7472 2c0a 2020 2020 2020 2020  etattr,.        
+00005580: 2020 2020 2269 6e64 6578 222c 0a20 2020      "index",.   
+00005590: 2020 2020 2020 2020 2074 6f6b 656e 3d6b           token=k
+000055a0: 6579 5f73 706c 6974 2873 656c 662e 5f6e  ey_split(self._n
+000055b0: 616d 6529 202b 2022 2d69 6e64 6578 222c  ame) + "-index",
+000055c0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+000055d0: 613d 7365 6c66 2e5f 6d65 7461 2e69 6e64  a=self._meta.ind
+000055e0: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
+000055f0: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+00005600: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00005610: 290a 0a20 2020 2040 696e 6465 782e 7365  )..    @index.se
+00005620: 7474 6572 0a20 2020 2064 6566 2069 6e64  tter.    def ind
+00005630: 6578 2873 656c 662c 2076 616c 7565 293a  ex(self, value):
+00005640: 0a20 2020 2020 2020 2073 656c 662e 6469  .        self.di
+00005650: 7669 7369 6f6e 7320 3d20 7661 6c75 652e  visions = value.
+00005660: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
+00005670: 2020 7265 7375 6c74 203d 206d 6170 5f70    result = map_p
+00005680: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+00005690: 2020 2020 2020 206d 6574 686f 6473 2e61         methods.a
+000056a0: 7373 6967 6e5f 696e 6465 782c 2073 656c  ssign_index, sel
+000056b0: 662c 2076 616c 7565 2c20 656e 666f 7263  f, value, enforc
+000056c0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+000056d0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000056e0: 2020 2073 656c 662e 6461 736b 203d 2072     self.dask = r
+000056f0: 6573 756c 742e 6461 736b 0a20 2020 2020  esult.dask.     
+00005700: 2020 2073 656c 662e 5f6e 616d 6520 3d20     self._name = 
+00005710: 7265 7375 6c74 2e5f 6e61 6d65 0a20 2020  result._name.   
+00005720: 2020 2020 2073 656c 662e 5f6d 6574 6120       self._meta 
+00005730: 3d20 7265 7375 6c74 2e5f 6d65 7461 0a0a  = result._meta..
+00005740: 2020 2020 6465 6620 7265 7365 745f 696e      def reset_in
+00005750: 6465 7828 7365 6c66 2c20 6472 6f70 3d46  dex(self, drop=F
+00005760: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
+00005770: 2222 5265 7365 7420 7468 6520 696e 6465  ""Reset the inde
+00005780: 7820 746f 2074 6865 2064 6566 6175 6c74  x to the default
+00005790: 2069 6e64 6578 2e0a 0a20 2020 2020 2020   index...       
+000057a0: 204e 6f74 6520 7468 6174 2075 6e6c 696b   Note that unlik
+000057b0: 6520 696e 2060 6070 616e 6461 7360 602c  e in ``pandas``,
+000057c0: 2074 6865 2072 6573 6574 2060 6064 6173   the reset ``das
+000057d0: 6b2e 6461 7461 6672 616d 6560 6020 696e  k.dataframe`` in
+000057e0: 6465 7820 7769 6c6c 0a20 2020 2020 2020  dex will.       
+000057f0: 206e 6f74 2062 6520 6d6f 6e6f 746f 6e69   not be monotoni
+00005800: 6361 6c6c 7920 696e 6372 6561 7369 6e67  cally increasing
+00005810: 2066 726f 6d20 302e 2049 6e73 7465 6164   from 0. Instead
+00005820: 2c20 6974 2077 696c 6c20 7265 7374 6172  , it will restar
+00005830: 7420 6174 2030 0a20 2020 2020 2020 2066  t at 0.        f
+00005840: 6f72 2065 6163 6820 7061 7274 6974 696f  or each partitio
+00005850: 6e20 2865 2e67 2e20 6060 696e 6465 7831  n (e.g. ``index1
+00005860: 203d 205b 302c 202e 2e2e 2c20 3130 5d2c   = [0, ..., 10],
+00005870: 2069 6e64 6578 3220 3d20 5b30 2c20 2e2e   index2 = [0, ..
+00005880: 2e5d 6060 292e 0a20 2020 2020 2020 2054  .]``)..        T
+00005890: 6869 7320 6973 2064 7565 2074 6f20 7468  his is due to th
+000058a0: 6520 696e 6162 696c 6974 7920 746f 2073  e inability to s
+000058b0: 7461 7469 6361 6c6c 7920 6b6e 6f77 2074  tatically know t
+000058c0: 6865 2066 756c 6c20 6c65 6e67 7468 206f  he full length o
+000058d0: 6620 7468 650a 2020 2020 2020 2020 696e  f the.        in
+000058e0: 6465 782e 0a0a 2020 2020 2020 2020 466f  dex...        Fo
+000058f0: 7220 4461 7461 4672 616d 6520 7769 7468  r DataFrame with
+00005900: 206d 756c 7469 2d6c 6576 656c 2069 6e64   multi-level ind
+00005910: 6578 2c20 7265 7475 726e 7320 6120 6e65  ex, returns a ne
+00005920: 7720 4461 7461 4672 616d 6520 7769 7468  w DataFrame with
+00005930: 0a20 2020 2020 2020 206c 6162 656c 696e  .        labelin
+00005940: 6720 696e 666f 726d 6174 696f 6e20 696e  g information in
+00005950: 2074 6865 2063 6f6c 756d 6e73 2075 6e64   the columns und
+00005960: 6572 2074 6865 2069 6e64 6578 206e 616d  er the index nam
+00005970: 6573 2c20 6465 6661 756c 7469 6e67 0a20  es, defaulting. 
+00005980: 2020 2020 2020 2074 6f20 276c 6576 656c         to 'level
+00005990: 5f30 272c 2027 6c65 7665 6c5f 3127 2c20  _0', 'level_1', 
+000059a0: 6574 632e 2069 6620 616e 7920 6172 6520  etc. if any are 
+000059b0: 4e6f 6e65 2e20 466f 7220 6120 7374 616e  None. For a stan
+000059c0: 6461 7264 2069 6e64 6578 2c0a 2020 2020  dard index,.    
+000059d0: 2020 2020 7468 6520 696e 6465 7820 6e61      the index na
+000059e0: 6d65 2077 696c 6c20 6265 2075 7365 6420  me will be used 
+000059f0: 2869 6620 7365 7429 2c20 6f74 6865 7277  (if set), otherw
+00005a00: 6973 6520 6120 6465 6661 756c 7420 2769  ise a default 'i
+00005a10: 6e64 6578 2720 6f72 0a20 2020 2020 2020  ndex' or.       
+00005a20: 2027 6c65 7665 6c5f 3027 2028 6966 2027   'level_0' (if '
+00005a30: 696e 6465 7827 2069 7320 616c 7265 6164  index' is alread
+00005a40: 7920 7461 6b65 6e29 2077 696c 6c20 6265  y taken) will be
+00005a50: 2075 7365 642e 0a0a 2020 2020 2020 2020   used...        
+00005a60: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+00005a70: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00005a80: 2020 2020 2020 6472 6f70 203a 2062 6f6f        drop : boo
+00005a90: 6c65 616e 2c20 6465 6661 756c 7420 4661  lean, default Fa
+00005aa0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00005ab0: 446f 206e 6f74 2074 7279 2074 6f20 696e  Do not try to in
+00005ac0: 7365 7274 2069 6e64 6578 2069 6e74 6f20  sert index into 
+00005ad0: 6461 7461 6672 616d 6520 636f 6c75 6d6e  dataframe column
+00005ae0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
+00005af0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00005b00: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00005b10: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
+00005b20: 2e72 6573 6574 5f69 6e64 6578 2c20 6472  .reset_index, dr
+00005b30: 6f70 3d64 726f 702c 2065 6e66 6f72 6365  op=drop, enforce
+00005b40: 5f6d 6574 6164 6174 613d 4661 6c73 650a  _metadata=False.
+00005b50: 2020 2020 2020 2020 292e 636c 6561 725f          ).clear_
+00005b60: 6469 7669 7369 6f6e 7328 290a 0a20 2020  divisions()..   
+00005b70: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00005b80: 6566 206b 6e6f 776e 5f64 6976 6973 696f  ef known_divisio
+00005b90: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
+00005ba0: 2020 2222 2257 6865 7468 6572 2064 6976    """Whether div
+00005bb0: 6973 696f 6e73 2061 7265 2061 6c72 6561  isions are alrea
+00005bc0: 6479 206b 6e6f 776e 2222 220a 2020 2020  dy known""".    
+00005bd0: 2020 2020 7265 7475 726e 206c 656e 2873      return len(s
+00005be0: 656c 662e 6469 7669 7369 6f6e 7329 203e  elf.divisions) >
+00005bf0: 2030 2061 6e64 2073 656c 662e 6469 7669   0 and self.divi
+00005c00: 7369 6f6e 735b 305d 2069 7320 6e6f 7420  sions[0] is not 
+00005c10: 4e6f 6e65 0a0a 2020 2020 6465 6620 636c  None..    def cl
+00005c20: 6561 725f 6469 7669 7369 6f6e 7328 7365  ear_divisions(se
+00005c30: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00005c40: 466f 7267 6574 2064 6976 6973 696f 6e20  Forget division 
+00005c50: 696e 666f 726d 6174 696f 6e22 2222 0a20  information""". 
+00005c60: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+00005c70: 203d 2028 4e6f 6e65 2c29 202a 2028 7365   = (None,) * (se
+00005c80: 6c66 2e6e 7061 7274 6974 696f 6e73 202b  lf.npartitions +
+00005c90: 2031 290a 2020 2020 2020 2020 7265 7475   1).        retu
+00005ca0: 726e 2074 7970 6528 7365 6c66 2928 7365  rn type(self)(se
+00005cb0: 6c66 2e64 6173 6b2c 2073 656c 662e 5f6e  lf.dask, self._n
+00005cc0: 616d 652c 2073 656c 662e 5f6d 6574 612c  ame, self._meta,
+00005cd0: 2064 6976 6973 696f 6e73 290a 0a20 2020   divisions)..   
+00005ce0: 2064 6566 2063 6f6d 7075 7465 5f63 7572   def compute_cur
+00005cf0: 7265 6e74 5f64 6976 6973 696f 6e73 2873  rent_divisions(s
+00005d00: 656c 662c 2063 6f6c 3d4e 6f6e 6529 3a0a  elf, col=None):.
+00005d10: 2020 2020 2020 2020 2222 2243 6f6d 7075          """Compu
+00005d20: 7465 2074 6865 2063 7572 7265 6e74 2064  te the current d
+00005d30: 6976 6973 696f 6e73 206f 6620 7468 6520  ivisions of the 
+00005d40: 4461 7461 4672 616d 652e 0a0a 2020 2020  DataFrame...    
+00005d50: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
+00005d60: 7472 6967 6765 7273 2069 6d6d 6564 6961  triggers immedia
+00005d70: 7465 2063 6f6d 7075 7461 7469 6f6e 2e20  te computation. 
+00005d80: 4966 2079 6f75 2066 696e 6420 796f 7572  If you find your
+00005d90: 7365 6c66 2072 756e 6e69 6e67 2074 6869  self running thi
+00005da0: 7320 636f 6d6d 616e 640a 2020 2020 2020  s command.      
+00005db0: 2020 7265 7065 6174 6564 6c79 2066 6f72    repeatedly for
+00005dc0: 2074 6865 2073 616d 6520 6461 7461 6672   the same datafr
+00005dd0: 616d 652c 2077 6520 7265 636f 6d6d 656e  ame, we recommen
+00005de0: 6420 7374 6f72 696e 6720 7468 6520 7265  d storing the re
+00005df0: 7375 6c74 0a20 2020 2020 2020 2073 6f20  sult.        so 
+00005e00: 796f 7520 646f 6e27 7420 6861 7665 2074  you don't have t
+00005e10: 6f20 7265 7275 6e20 6974 2e0a 0a20 2020  o rerun it...   
+00005e20: 2020 2020 2049 6620 7468 6520 636f 6c75       If the colu
+00005e30: 6d6e 206f 7220 696e 6465 7820 7661 6c75  mn or index valu
+00005e40: 6573 206f 7665 726c 6170 2062 6574 7765  es overlap betwe
+00005e50: 656e 2070 6172 7469 7469 6f6e 732c 2072  en partitions, r
+00005e60: 6169 7365 7320 6060 5661 6c75 6545 7272  aises ``ValueErr
+00005e70: 6f72 6060 2e0a 2020 2020 2020 2020 546f  or``..        To
+00005e80: 2070 7265 7665 6e74 2074 6869 732c 206d   prevent this, m
+00005e90: 616b 6520 7375 7265 2074 6865 2064 6174  ake sure the dat
+00005ea0: 6120 6172 6520 736f 7274 6564 2062 7920  a are sorted by 
+00005eb0: 7468 6520 636f 6c75 6d6e 206f 7220 696e  the column or in
+00005ec0: 6465 782e 0a0a 2020 2020 2020 2020 5061  dex...        Pa
+00005ed0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00005ee0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00005ef0: 2020 2020 636f 6c20 3a20 7374 7269 6e67      col : string
+00005f00: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00005f10: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
+00005f20: 2074 6865 2064 6976 6973 696f 6e73 2066   the divisions f
+00005f30: 6f72 2061 206e 6f6e 2d69 6e64 6578 2063  or a non-index c
+00005f40: 6f6c 756d 6e20 6279 2070 6173 7369 6e67  olumn by passing
+00005f50: 2069 6e20 7468 6520 6e61 6d65 206f 6620   in the name of 
+00005f60: 7468 6520 636f 6c75 6d6e 2e0a 2020 2020  the column..    
+00005f70: 2020 2020 2020 2020 4966 2063 6f6c 2069          If col i
+00005f80: 7320 6e6f 7420 7370 6563 6966 6965 642c  s not specified,
+00005f90: 2074 6865 2069 6e64 6578 2077 696c 6c20   the index will 
+00005fa0: 6265 2075 7365 6420 746f 2063 616c 6375  be used to calcu
+00005fb0: 6c61 7465 2064 6976 6973 696f 6e73 2e0a  late divisions..
+00005fc0: 2020 2020 2020 2020 2020 2020 496e 2074              In t
+00005fd0: 6869 7320 6361 7365 2c20 6966 2074 6865  his case, if the
+00005fe0: 2064 6976 6973 696f 6e73 2061 7265 2061   divisions are a
+00005ff0: 6c72 6561 6479 206b 6e6f 776e 2c20 7468  lready known, th
+00006000: 6579 2077 696c 6c20 6265 2072 6574 7572  ey will be retur
+00006010: 6e65 640a 2020 2020 2020 2020 2020 2020  ned.            
+00006020: 696d 6d65 6469 6174 656c 7920 7769 7468  immediately with
+00006030: 6f75 7420 636f 6d70 7574 696e 672e 0a0a  out computing...
+00006040: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+00006050: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00006060: 2d0a 2020 2020 2020 2020 3e3e 3e20 696d  -.        >>> im
+00006070: 706f 7274 2064 6173 6b0a 2020 2020 2020  port dask.      
+00006080: 2020 3e3e 3e20 6464 6620 3d20 6461 736b    >>> ddf = dask
+00006090: 2e64 6174 6173 6574 732e 7469 6d65 7365  .datasets.timese
+000060a0: 7269 6573 2873 7461 7274 3d22 3230 3231  ries(start="2021
+000060b0: 2d30 312d 3031 222c 2065 6e64 3d22 3230  -01-01", end="20
+000060c0: 3231 2d30 312d 3037 222c 2066 7265 713d  21-01-07", freq=
+000060d0: 2231 4822 292e 636c 6561 725f 6469 7669  "1H").clear_divi
+000060e0: 7369 6f6e 7328 290a 2020 2020 2020 2020  sions().        
+000060f0: 3e3e 3e20 6469 7669 7369 6f6e 7320 3d20  >>> divisions = 
+00006100: 6464 662e 636f 6d70 7574 655f 6375 7272  ddf.compute_curr
+00006110: 656e 745f 6469 7669 7369 6f6e 7328 290a  ent_divisions().
+00006120: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00006130: 7428 6469 7669 7369 6f6e 7329 2020 2320  t(divisions)  # 
+00006140: 646f 6374 6573 743a 202b 4e4f 524d 414c  doctest: +NORMAL
+00006150: 495a 455f 5748 4954 4553 5041 4345 0a20  IZE_WHITESPACE. 
+00006160: 2020 2020 2020 2028 5469 6d65 7374 616d         (Timestam
+00006170: 7028 2732 3032 312d 3031 2d30 3120 3030  p('2021-01-01 00
+00006180: 3a30 303a 3030 2729 2c0a 2020 2020 2020  :00:00'),.      
+00006190: 2020 2054 696d 6573 7461 6d70 2827 3230     Timestamp('20
+000061a0: 3231 2d30 312d 3032 2030 303a 3030 3a30  21-01-02 00:00:0
+000061b0: 3027 292c 0a20 2020 2020 2020 2020 5469  0'),.         Ti
+000061c0: 6d65 7374 616d 7028 2732 3032 312d 3031  mestamp('2021-01
+000061d0: 2d30 3320 3030 3a30 303a 3030 2729 2c0a  -03 00:00:00'),.
+000061e0: 2020 2020 2020 2020 2054 696d 6573 7461           Timesta
+000061f0: 6d70 2827 3230 3231 2d30 312d 3034 2030  mp('2021-01-04 0
+00006200: 303a 3030 3a30 3027 292c 0a20 2020 2020  0:00:00'),.     
+00006210: 2020 2020 5469 6d65 7374 616d 7028 2732      Timestamp('2
+00006220: 3032 312d 3031 2d30 3520 3030 3a30 303a  021-01-05 00:00:
+00006230: 3030 2729 2c0a 2020 2020 2020 2020 2054  00'),.         T
+00006240: 696d 6573 7461 6d70 2827 3230 3231 2d30  imestamp('2021-0
+00006250: 312d 3036 2030 303a 3030 3a30 3027 292c  1-06 00:00:00'),
+00006260: 0a20 2020 2020 2020 2020 5469 6d65 7374  .         Timest
+00006270: 616d 7028 2732 3032 312d 3031 2d30 3620  amp('2021-01-06 
+00006280: 3233 3a30 303a 3030 2729 290a 0a20 2020  23:00:00'))..   
+00006290: 2020 2020 203e 3e3e 2064 6466 2e64 6976       >>> ddf.div
+000062a0: 6973 696f 6e73 203d 2064 6976 6973 696f  isions = divisio
+000062b0: 6e73 0a20 2020 2020 2020 203e 3e3e 2064  ns.        >>> d
+000062c0: 6466 2e6b 6e6f 776e 5f64 6976 6973 696f  df.known_divisio
+000062d0: 6e73 0a20 2020 2020 2020 2054 7275 650a  ns.        True.
+000062e0: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
+000062f0: 203d 2064 6466 2e72 6573 6574 5f69 6e64   = ddf.reset_ind
+00006300: 6578 2829 2e63 6c65 6172 5f64 6976 6973  ex().clear_divis
+00006310: 696f 6e73 2829 0a20 2020 2020 2020 203e  ions().        >
+00006320: 3e3e 2064 6976 6973 696f 6e73 203d 2064  >> divisions = d
+00006330: 6466 2e63 6f6d 7075 7465 5f63 7572 7265  df.compute_curre
+00006340: 6e74 5f64 6976 6973 696f 6e73 2822 7469  nt_divisions("ti
+00006350: 6d65 7374 616d 7022 290a 2020 2020 2020  mestamp").      
+00006360: 2020 3e3e 3e20 7072 696e 7428 6469 7669    >>> print(divi
+00006370: 7369 6f6e 7329 2020 2320 646f 6374 6573  sions)  # doctes
+00006380: 743a 202b 4e4f 524d 414c 495a 455f 5748  t: +NORMALIZE_WH
+00006390: 4954 4553 5041 4345 0a20 2020 2020 2020  ITESPACE.       
+000063a0: 2028 5469 6d65 7374 616d 7028 2732 3032   (Timestamp('202
+000063b0: 312d 3031 2d30 3120 3030 3a30 303a 3030  1-01-01 00:00:00
+000063c0: 2729 2c0a 2020 2020 2020 2020 2054 696d  '),.         Tim
+000063d0: 6573 7461 6d70 2827 3230 3231 2d30 312d  estamp('2021-01-
+000063e0: 3032 2030 303a 3030 3a30 3027 292c 0a20  02 00:00:00'),. 
+000063f0: 2020 2020 2020 2020 5469 6d65 7374 616d          Timestam
+00006400: 7028 2732 3032 312d 3031 2d30 3320 3030  p('2021-01-03 00
+00006410: 3a30 303a 3030 2729 2c0a 2020 2020 2020  :00:00'),.      
+00006420: 2020 2054 696d 6573 7461 6d70 2827 3230     Timestamp('20
+00006430: 3231 2d30 312d 3034 2030 303a 3030 3a30  21-01-04 00:00:0
+00006440: 3027 292c 0a20 2020 2020 2020 2020 5469  0'),.         Ti
+00006450: 6d65 7374 616d 7028 2732 3032 312d 3031  mestamp('2021-01
+00006460: 2d30 3520 3030 3a30 303a 3030 2729 2c0a  -05 00:00:00'),.
+00006470: 2020 2020 2020 2020 2054 696d 6573 7461           Timesta
+00006480: 6d70 2827 3230 3231 2d30 312d 3036 2030  mp('2021-01-06 0
+00006490: 303a 3030 3a30 3027 292c 0a20 2020 2020  0:00:00'),.     
+000064a0: 2020 2020 5469 6d65 7374 616d 7028 2732      Timestamp('2
+000064b0: 3032 312d 3031 2d30 3620 3233 3a30 303a  021-01-06 23:00:
+000064c0: 3030 2729 290a 0a20 2020 2020 2020 203e  00'))..        >
+000064d0: 3e3e 2064 6466 203d 2064 6466 2e73 6574  >> ddf = ddf.set
+000064e0: 5f69 6e64 6578 2822 7469 6d65 7374 616d  _index("timestam
+000064f0: 7022 2c20 6469 7669 7369 6f6e 733d 6469  p", divisions=di
+00006500: 7669 7369 6f6e 732c 2073 6f72 7465 643d  visions, sorted=
+00006510: 5472 7565 290a 2020 2020 2020 2020 2222  True).        ""
+00006520: 220a 2020 2020 2020 2020 6966 2063 6f6c  ".        if col
+00006530: 2069 7320 4e6f 6e65 2061 6e64 2073 656c   is None and sel
+00006540: 662e 6b6e 6f77 6e5f 6469 7669 7369 6f6e  f.known_division
+00006550: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00006560: 6574 7572 6e20 7365 6c66 2e64 6976 6973  eturn self.divis
+00006570: 696f 6e73 0a0a 2020 2020 2020 2020 6672  ions..        fr
+00006580: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+00006590: 652e 7368 7566 666c 6520 696d 706f 7274  e.shuffle import
+000065a0: 2063 6f6d 7075 7465 5f64 6976 6973 696f   compute_divisio
+000065b0: 6e73 0a0a 2020 2020 2020 2020 7265 7475  ns..        retu
+000065c0: 726e 2063 6f6d 7075 7465 5f64 6976 6973  rn compute_divis
+000065d0: 696f 6e73 2873 656c 662c 2063 6f6c 3d63  ions(self, col=c
+000065e0: 6f6c 290a 0a20 2020 2064 6566 2067 6574  ol)..    def get
+000065f0: 5f70 6172 7469 7469 6f6e 2873 656c 662c  _partition(self,
+00006600: 206e 293a 0a20 2020 2020 2020 2022 2222   n):.        """
+00006610: 0a20 2020 2020 2020 2047 6574 2061 2064  .        Get a d
+00006620: 6173 6b20 4461 7461 4672 616d 652f 5365  ask DataFrame/Se
+00006630: 7269 6573 2072 6570 7265 7365 6e74 696e  ries representin
+00006640: 6720 7468 6520 606e 7468 6020 7061 7274  g the `nth` part
+00006650: 6974 696f 6e2e 0a0a 2020 2020 2020 2020  ition...        
+00006660: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+00006670: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00006680: 2020 2020 2020 6e20 3a20 696e 740a 2020        n : int.  
+00006690: 2020 2020 2020 2020 2020 5468 6520 302d            The 0-
+000066a0: 696e 6465 7865 6420 7061 7274 6974 696f  indexed partitio
+000066b0: 6e20 6e75 6d62 6572 2074 6f20 7365 6c65  n number to sele
+000066c0: 6374 2e0a 0a20 2020 2020 2020 2052 6574  ct...        Ret
+000066d0: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+000066e0: 2d2d 2d2d 0a20 2020 2020 2020 2044 6173  ----.        Das
+000066f0: 6b20 4461 7461 4672 616d 6520 6f72 2053  k DataFrame or S
+00006700: 6572 6965 730a 2020 2020 2020 2020 2020  eries.          
+00006710: 2020 5468 6520 7361 6d65 2074 7970 6520    The same type 
+00006720: 6173 2074 6865 206f 7269 6769 6e61 6c20  as the original 
+00006730: 6f62 6a65 6374 2e0a 0a20 2020 2020 2020  object...       
+00006740: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
+00006750: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+00006760: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+00006770: 736b 0a20 2020 2020 2020 203e 3e3e 2064  sk.        >>> d
+00006780: 6466 203d 2064 6173 6b2e 6461 7461 7365  df = dask.datase
+00006790: 7473 2e74 696d 6573 6572 6965 7328 7374  ts.timeseries(st
+000067a0: 6172 743d 2232 3032 312d 3031 2d30 3122  art="2021-01-01"
+000067b0: 2c20 656e 643d 2232 3032 312d 3031 2d30  , end="2021-01-0
+000067c0: 3722 2c20 6672 6571 3d22 3148 2229 0a20  7", freq="1H"). 
+000067d0: 2020 2020 2020 203e 3e3e 2064 6466 2e67         >>> ddf.g
+000067e0: 6574 5f70 6172 7469 7469 6f6e 2830 2920  et_partition(0) 
+000067f0: 2023 2064 6f63 7465 7374 3a20 2b4e 4f52   # doctest: +NOR
+00006800: 4d41 4c49 5a45 5f57 4849 5445 5350 4143  MALIZE_WHITESPAC
+00006810: 450a 2020 2020 2020 2020 4461 736b 2044  E.        Dask D
+00006820: 6174 6146 7261 6d65 2053 7472 7563 7475  ataFrame Structu
+00006830: 7265 3a0a 2020 2020 2020 2020 2020 2020  re:.            
+00006840: 2020 2020 2020 2020 2020 2020 206e 616d               nam
+00006850: 6520 2020 2020 6964 2020 2020 2020 2020  e     id        
+00006860: 7820 2020 2020 2020 2079 0a20 2020 2020  x        y.     
+00006870: 2020 206e 7061 7274 6974 696f 6e73 3d31     npartitions=1
+00006880: 0a20 2020 2020 2020 2032 3032 312d 3031  .        2021-01
+00006890: 2d30 3120 2020 2020 6f62 6a65 6374 2020  -01     object  
+000068a0: 696e 7436 3420 2066 6c6f 6174 3634 2020  int64  float64  
+000068b0: 666c 6f61 7436 340a 2020 2020 2020 2020  float64.        
+000068c0: 3230 3231 2d30 312d 3032 2020 2020 2020  2021-01-02      
+000068d0: 2020 2e2e 2e20 2020 202e 2e2e 2020 2020    ...    ...    
+000068e0: 2020 2e2e 2e20 2020 2020 202e 2e2e 0a20    ...      .... 
+000068f0: 2020 2020 2020 2044 6173 6b20 4e61 6d65         Dask Name
+00006900: 3a20 6765 742d 7061 7274 6974 696f 6e2c  : get-partition,
+00006910: 2032 2067 7261 7068 206c 6179 6572 730a   2 graph layers.
+00006920: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
+00006930: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
+00006940: 2d2d 0a20 2020 2020 2020 2044 6174 6146  --.        DataF
+00006950: 7261 6d65 2e70 6172 7469 7469 6f6e 730a  rame.partitions.
+00006960: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00006970: 2020 2020 6966 2030 203c 3d20 6e20 3c20      if 0 <= n < 
+00006980: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
+00006990: 3a0a 2020 2020 2020 2020 2020 2020 6e61  :.            na
+000069a0: 6d65 203d 2066 2267 6574 2d70 6172 7469  me = f"get-parti
+000069b0: 7469 6f6e 2d7b 7374 7228 6e29 7d2d 7b73  tion-{str(n)}-{s
+000069c0: 656c 662e 5f6e 616d 657d 220a 2020 2020  elf._name}".    
+000069d0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+000069e0: 7320 3d20 7365 6c66 2e64 6976 6973 696f  s = self.divisio
+000069f0: 6e73 5b6e 203a 206e 202b 2032 5d0a 2020  ns[n : n + 2].  
+00006a00: 2020 2020 2020 2020 2020 6c61 7965 7220            layer 
+00006a10: 3d20 7b28 6e61 6d65 2c20 3029 3a20 2873  = {(name, 0): (s
+00006a20: 656c 662e 5f6e 616d 652c 206e 297d 0a20  elf._name, n)}. 
+00006a30: 2020 2020 2020 2020 2020 2067 7261 7068             graph
+00006a40: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+00006a50: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+00006a60: 6e73 286e 616d 652c 206c 6179 6572 2c20  ns(name, layer, 
+00006a70: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
+00006a80: 6c66 5d29 0a20 2020 2020 2020 2020 2020  lf]).           
+00006a90: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
+00006aa0: 626a 6563 7428 6772 6170 682c 206e 616d  bject(graph, nam
+00006ab0: 652c 2073 656c 662e 5f6d 6574 612c 2064  e, self._meta, d
+00006ac0: 6976 6973 696f 6e73 290a 2020 2020 2020  ivisions).      
+00006ad0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00006ae0: 2020 2020 6d73 6720 3d20 6622 6e20 6d75      msg = f"n mu
+00006af0: 7374 2062 6520 3020 3c3d 206e 203c 207b  st be 0 <= n < {
+00006b00: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
+00006b10: 7d22 0a20 2020 2020 2020 2020 2020 2072  }".            r
+00006b20: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00006b30: 6d73 6729 0a0a 2020 2020 4064 6572 6976  msg)..    @deriv
+00006b40: 6564 5f66 726f 6d28 0a20 2020 2020 2020  ed_from(.       
+00006b50: 2070 642e 4461 7461 4672 616d 652c 0a20   pd.DataFrame,. 
+00006b60: 2020 2020 2020 2069 6e63 6f6e 7369 7374         inconsist
+00006b70: 656e 6369 6573 3d22 6b65 6570 3d46 616c  encies="keep=Fal
+00006b80: 7365 2077 696c 6c20 7261 6973 6520 6120  se will raise a 
+00006b90: 6060 4e6f 7449 6d70 6c65 6d65 6e74 6564  ``NotImplemented
+00006ba0: 4572 726f 7260 6022 2c0a 2020 2020 290a  Error``",.    ).
+00006bb0: 2020 2020 6465 6620 6472 6f70 5f64 7570      def drop_dup
+00006bc0: 6c69 6361 7465 7328 0a20 2020 2020 2020  licates(.       
+00006bd0: 2073 656c 662c 2073 7562 7365 743d 4e6f   self, subset=No
+00006be0: 6e65 2c20 7370 6c69 745f 6576 6572 793d  ne, split_every=
+00006bf0: 4e6f 6e65 2c20 7370 6c69 745f 6f75 743d  None, split_out=
+00006c00: 312c 2069 676e 6f72 655f 696e 6465 783d  1, ignore_index=
+00006c10: 4661 6c73 652c 202a 2a6b 7761 7267 730a  False, **kwargs.
+00006c20: 2020 2020 293a 0a20 2020 2020 2020 2069      ):.        i
+00006c30: 6620 7375 6273 6574 2069 7320 6e6f 7420  f subset is not 
+00006c40: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00006c50: 2020 2320 4c65 7420 7061 6e64 6173 2065    # Let pandas e
+00006c60: 7272 6f72 206f 6e20 6261 6420 696e 7075  rror on bad inpu
+00006c70: 7473 0a20 2020 2020 2020 2020 2020 2073  ts.            s
+00006c80: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
+00006c90: 7479 2e64 726f 705f 6475 706c 6963 6174  ty.drop_duplicat
+00006ca0: 6573 2873 7562 7365 743d 7375 6273 6574  es(subset=subset
+00006cb0: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
+00006cc0: 2020 2020 2020 2020 6b77 6172 6773 5b22          kwargs["
+00006cd0: 7375 6273 6574 225d 203d 2073 7562 7365  subset"] = subse
+00006ce0: 740a 2020 2020 2020 2020 2020 2020 7370  t.            sp
+00006cf0: 6c69 745f 6f75 745f 7365 7475 7020 3d20  lit_out_setup = 
+00006d00: 7370 6c69 745f 6f75 745f 6f6e 5f63 6f6c  split_out_on_col
+00006d10: 730a 2020 2020 2020 2020 2020 2020 7370  s.            sp
+00006d20: 6c69 745f 6f75 745f 7365 7475 705f 6b77  lit_out_setup_kw
+00006d30: 6172 6773 203d 207b 2263 6f6c 7322 3a20  args = {"cols": 
+00006d40: 7375 6273 6574 7d0a 2020 2020 2020 2020  subset}.        
+00006d50: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00006d60: 2020 7365 6c66 2e5f 6d65 7461 5f6e 6f6e    self._meta_non
+00006d70: 656d 7074 792e 6472 6f70 5f64 7570 6c69  empty.drop_dupli
+00006d80: 6361 7465 7328 2a2a 6b77 6172 6773 290a  cates(**kwargs).
+00006d90: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+00006da0: 745f 6f75 745f 7365 7475 7020 3d20 7370  t_out_setup = sp
+00006db0: 6c69 745f 6f75 745f 7365 7475 705f 6b77  lit_out_setup_kw
+00006dc0: 6172 6773 203d 204e 6f6e 650a 0a20 2020  args = None..   
+00006dd0: 2020 2020 2069 6620 6b77 6172 6773 2e67       if kwargs.g
+00006de0: 6574 2822 6b65 6570 222c 2054 7275 6529  et("keep", True)
+00006df0: 2069 7320 4661 6c73 653a 0a20 2020 2020   is False:.     
+00006e00: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00006e10: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00006e20: 2822 6472 6f70 5f64 7570 6c69 6361 7465  ("drop_duplicate
+00006e30: 7320 7769 7468 206b 6565 703d 4661 6c73  s with keep=Fals
+00006e40: 6522 290a 0a20 2020 2020 2020 2063 6875  e")..        chu
+00006e50: 6e6b 203d 204d 2e64 726f 705f 6475 706c  nk = M.drop_dupl
+00006e60: 6963 6174 6573 0a20 2020 2020 2020 2072  icates.        r
+00006e70: 6574 7572 6e20 6163 6128 0a20 2020 2020  eturn aca(.     
+00006e80: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00006e90: 2020 2020 2020 2020 2063 6875 6e6b 3d63           chunk=c
+00006ea0: 6875 6e6b 2c0a 2020 2020 2020 2020 2020  hunk,.          
+00006eb0: 2020 6167 6772 6567 6174 653d 6368 756e    aggregate=chun
+00006ec0: 6b2c 0a20 2020 2020 2020 2020 2020 206d  k,.            m
+00006ed0: 6574 613d 7365 6c66 2e5f 6d65 7461 2c0a  eta=self._meta,.
+00006ee0: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
+00006ef0: 6e3d 2264 726f 702d 6475 706c 6963 6174  n="drop-duplicat
+00006f00: 6573 222c 0a20 2020 2020 2020 2020 2020  es",.           
+00006f10: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+00006f20: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
+00006f30: 2020 2020 2020 7370 6c69 745f 6f75 743d        split_out=
+00006f40: 7370 6c69 745f 6f75 742c 0a20 2020 2020  split_out,.     
+00006f50: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
+00006f60: 5f73 6574 7570 3d73 706c 6974 5f6f 7574  _setup=split_out
+00006f70: 5f73 6574 7570 2c0a 2020 2020 2020 2020  _setup,.        
+00006f80: 2020 2020 7370 6c69 745f 6f75 745f 7365      split_out_se
+00006f90: 7475 705f 6b77 6172 6773 3d73 706c 6974  tup_kwargs=split
+00006fa0: 5f6f 7574 5f73 6574 7570 5f6b 7761 7267  _out_setup_kwarg
+00006fb0: 732c 0a20 2020 2020 2020 2020 2020 2069  s,.            i
+00006fc0: 676e 6f72 655f 696e 6465 783d 6967 6e6f  gnore_index=igno
+00006fd0: 7265 5f69 6e64 6578 2c0a 2020 2020 2020  re_index,.      
+00006fe0: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
+00006ff0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00007000: 6566 205f 5f6c 656e 5f5f 2873 656c 6629  ef __len__(self)
+00007010: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00007020: 2073 656c 662e 7265 6475 6374 696f 6e28   self.reduction(
+00007030: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
+00007040: 2c20 6e70 2e73 756d 2c20 746f 6b65 6e3d  , np.sum, token=
+00007050: 226c 656e 222c 206d 6574 613d 696e 742c  "len", meta=int,
+00007060: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+00007070: 7365 0a20 2020 2020 2020 2029 2e63 6f6d  se.        ).com
+00007080: 7075 7465 2829 0a0a 2020 2020 6465 6620  pute()..    def 
+00007090: 5f5f 626f 6f6c 5f5f 2873 656c 6629 3a0a  __bool__(self):.
+000070a0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+000070b0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+000070c0: 2020 2020 2020 6622 5468 6520 7472 7574        f"The trut
+000070d0: 6820 7661 6c75 6520 6f66 2061 207b 7365  h value of a {se
+000070e0: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
+000070f0: 616d 655f 5f7d 2069 7320 616d 6269 6775  ame__} is ambigu
+00007100: 6f75 732e 2022 0a20 2020 2020 2020 2020  ous. ".         
+00007110: 2020 2022 5573 6520 612e 616e 7928 2920     "Use a.any() 
+00007120: 6f72 2061 2e61 6c6c 2829 2e22 0a20 2020  or a.all().".   
+00007130: 2020 2020 2029 0a0a 2020 2020 5f5f 6e6f       )..    __no
+00007140: 6e7a 6572 6f5f 5f20 3d20 5f5f 626f 6f6c  nzero__ = __bool
+00007150: 5f5f 2020 2320 7079 7468 6f6e 2032 0a0a  __  # python 2..
+00007160: 2020 2020 6465 6620 5f73 6361 6c61 7266      def _scalarf
+00007170: 756e 6328 7365 6c66 2c20 6361 7374 5f74  unc(self, cast_t
+00007180: 7970 6529 3a0a 2020 2020 2020 2020 6465  ype):.        de
+00007190: 6620 7772 6170 7065 7228 293a 0a20 2020  f wrapper():.   
+000071a0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+000071b0: 7970 6545 7272 6f72 2866 2263 616e 6e6f  ypeError(f"canno
+000071c0: 7420 636f 6e76 6572 7420 7468 6520 7365  t convert the se
+000071d0: 7269 6573 2074 6f20 7b63 6173 745f 7479  ries to {cast_ty
+000071e0: 7065 7d22 290a 0a20 2020 2020 2020 2072  pe}")..        r
+000071f0: 6574 7572 6e20 7772 6170 7065 720a 0a20  eturn wrapper.. 
+00007200: 2020 2064 6566 205f 5f66 6c6f 6174 5f5f     def __float__
+00007210: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00007220: 7265 7475 726e 2073 656c 662e 5f73 6361  return self._sca
+00007230: 6c61 7266 756e 6328 666c 6f61 7429 0a0a  larfunc(float)..
+00007240: 2020 2020 6465 6620 5f5f 696e 745f 5f28      def __int__(
+00007250: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00007260: 6574 7572 6e20 7365 6c66 2e5f 7363 616c  eturn self._scal
+00007270: 6172 6675 6e63 2869 6e74 290a 0a20 2020  arfunc(int)..   
+00007280: 205f 5f6c 6f6e 675f 5f20 3d20 5f5f 696e   __long__ = __in
+00007290: 745f 5f20 2023 2070 7974 686f 6e20 320a  t__  # python 2.
+000072a0: 0a20 2020 2064 6566 205f 5f63 6f6d 706c  .    def __compl
+000072b0: 6578 5f5f 2873 656c 6629 3a0a 2020 2020  ex__(self):.    
+000072c0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000072d0: 5f73 6361 6c61 7266 756e 6328 636f 6d70  _scalarfunc(comp
+000072e0: 6c65 7829 0a0a 2020 2020 4069 6e73 6572  lex)..    @inser
+000072f0: 745f 6d65 7461 5f70 6172 616d 5f64 6573  t_meta_param_des
+00007300: 6372 6970 7469 6f6e 2870 6164 3d31 3229  cription(pad=12)
+00007310: 0a20 2020 2064 6566 206d 6170 5f70 6172  .    def map_par
+00007320: 7469 7469 6f6e 7328 7365 6c66 2c20 6675  titions(self, fu
+00007330: 6e63 2c20 2a61 7267 732c 202a 2a6b 7761  nc, *args, **kwa
+00007340: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+00007350: 2241 7070 6c79 2050 7974 686f 6e20 6675  "Apply Python fu
+00007360: 6e63 7469 6f6e 206f 6e20 6561 6368 2044  nction on each D
+00007370: 6174 6146 7261 6d65 2070 6172 7469 7469  ataFrame partiti
+00007380: 6f6e 2e0a 0a20 2020 2020 2020 204e 6f74  on...        Not
+00007390: 6520 7468 6174 2074 6865 2069 6e64 6578  e that the index
+000073a0: 2061 6e64 2064 6976 6973 696f 6e73 2061   and divisions a
+000073b0: 7265 2061 7373 756d 6564 2074 6f20 7265  re assumed to re
+000073c0: 6d61 696e 2075 6e63 6861 6e67 6564 2e0a  main unchanged..
+000073d0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+000073e0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+000073f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2066  ------.        f
+00007400: 756e 6320 3a20 6675 6e63 7469 6f6e 0a20  unc : function. 
+00007410: 2020 2020 2020 2020 2020 2054 6865 2066             The f
+00007420: 756e 6374 696f 6e20 6170 706c 6965 6420  unction applied 
+00007430: 746f 2065 6163 6820 7061 7274 6974 696f  to each partitio
+00007440: 6e2e 2049 6620 7468 6973 2066 756e 6374  n. If this funct
+00007450: 696f 6e20 6163 6365 7074 730a 2020 2020  ion accepts.    
+00007460: 2020 2020 2020 2020 7468 6520 7370 6563          the spec
+00007470: 6961 6c20 6060 7061 7274 6974 696f 6e5f  ial ``partition_
+00007480: 696e 666f 6060 206b 6579 776f 7264 2061  info`` keyword a
+00007490: 7267 756d 656e 742c 2069 7420 7769 6c6c  rgument, it will
+000074a0: 2072 6563 6569 7665 0a20 2020 2020 2020   receive.       
+000074b0: 2020 2020 2069 6e66 6f72 6d61 7469 6f6e       information
+000074c0: 206f 6e20 7468 6520 7061 7274 6974 696f   on the partitio
+000074d0: 6e27 7320 7265 6c61 7469 7665 206c 6f63  n's relative loc
+000074e0: 6174 696f 6e20 7769 7468 696e 2074 6865  ation within the
+000074f0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+00007500: 6166 7261 6d65 2e0a 2020 2020 2020 2020  aframe..        
+00007510: 6172 6773 2c20 6b77 6172 6773 203a 0a20  args, kwargs :. 
+00007520: 2020 2020 2020 2020 2020 2050 6f73 6974             Posit
+00007530: 696f 6e61 6c20 616e 6420 6b65 7977 6f72  ional and keywor
+00007540: 6420 6172 6775 6d65 6e74 7320 746f 2070  d arguments to p
+00007550: 6173 7320 746f 2074 6865 2066 756e 6374  ass to the funct
+00007560: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
+00007570: 2050 6f73 6974 696f 6e61 6c20 6172 6775   Positional argu
+00007580: 6d65 6e74 7320 6172 6520 636f 6d70 7574  ments are comput
+00007590: 6564 206f 6e20 6120 7065 722d 7061 7274  ed on a per-part
+000075a0: 6974 696f 6e20 6261 7369 732c 2077 6869  ition basis, whi
+000075b0: 6c65 0a20 2020 2020 2020 2020 2020 206b  le.            k
+000075c0: 6579 776f 7264 2061 7267 756d 656e 7473  eyword arguments
+000075d0: 2061 7265 2073 6861 7265 6420 6163 726f   are shared acro
+000075e0: 7373 2061 6c6c 2070 6172 7469 7469 6f6e  ss all partition
+000075f0: 732e 2054 6865 2070 6172 7469 7469 6f6e  s. The partition
+00007600: 0a20 2020 2020 2020 2020 2020 2069 7473  .            its
+00007610: 656c 6620 7769 6c6c 2062 6520 7468 6520  elf will be the 
+00007620: 6669 7273 7420 706f 7369 7469 6f6e 616c  first positional
+00007630: 2061 7267 756d 656e 742c 2077 6974 6820   argument, with 
+00007640: 616c 6c20 6f74 6865 720a 2020 2020 2020  all other.      
+00007650: 2020 2020 2020 6172 6775 6d65 6e74 7320        arguments 
+00007660: 7061 7373 6564 202a 6166 7465 722a 2e20  passed *after*. 
+00007670: 4172 6775 6d65 6e74 7320 6361 6e20 6265  Arguments can be
+00007680: 2060 6053 6361 6c61 7260 602c 2060 6044   ``Scalar``, ``D
+00007690: 656c 6179 6564 6060 2c0a 2020 2020 2020  elayed``,.      
+000076a0: 2020 2020 2020 6f72 2072 6567 756c 6172        or regular
+000076b0: 2050 7974 686f 6e20 6f62 6a65 6374 732e   Python objects.
+000076c0: 2044 6174 6146 7261 6d65 2d6c 696b 6520   DataFrame-like 
+000076d0: 6172 6773 2028 626f 7468 2064 6173 6b20  args (both dask 
+000076e0: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+000076f0: 7061 6e64 6173 2920 7769 6c6c 2062 6520  pandas) will be 
+00007700: 7265 7061 7274 6974 696f 6e65 6420 746f  repartitioned to
+00007710: 2061 6c69 676e 2028 6966 206e 6563 6573   align (if neces
+00007720: 7361 7279 2920 6265 666f 7265 0a20 2020  sary) before.   
+00007730: 2020 2020 2020 2020 2061 7070 6c79 696e           applyin
+00007740: 6720 7468 6520 6675 6e63 7469 6f6e 3b20  g the function; 
+00007750: 7365 6520 6060 616c 6967 6e5f 6461 7461  see ``align_data
+00007760: 6672 616d 6573 6060 2074 6f20 636f 6e74  frames`` to cont
+00007770: 726f 6c20 7468 6973 0a20 2020 2020 2020  rol this.       
+00007780: 2020 2020 2062 6568 6176 696f 722e 0a20       behavior.. 
+00007790: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
+000077a0: 6574 6164 6174 6120 3a20 626f 6f6c 2c20  etadata : bool, 
+000077b0: 6465 6661 756c 7420 5472 7565 0a20 2020  default True.   
+000077c0: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
+000077d0: 2074 6f20 656e 666f 7263 6520 6174 2072   to enforce at r
+000077e0: 756e 7469 6d65 2074 6861 7420 7468 6520  untime that the 
+000077f0: 7374 7275 6374 7572 6520 6f66 2074 6865  structure of the
+00007800: 2044 6174 6146 7261 6d65 0a20 2020 2020   DataFrame.     
+00007810: 2020 2020 2020 2070 726f 6475 6365 6420         produced 
+00007820: 6279 2060 6066 756e 6360 6020 6163 7475  by ``func`` actu
+00007830: 616c 6c79 206d 6174 6368 6573 2074 6865  ally matches the
+00007840: 2073 7472 7563 7475 7265 206f 6620 6060   structure of ``
+00007850: 6d65 7461 6060 2e0a 2020 2020 2020 2020  meta``..        
+00007860: 2020 2020 5468 6973 2077 696c 6c20 7265      This will re
+00007870: 6e61 6d65 2061 6e64 2072 656f 7264 6572  name and reorder
+00007880: 2063 6f6c 756d 6e73 2066 6f72 2065 6163   columns for eac
+00007890: 6820 7061 7274 6974 696f 6e2c 0a20 2020  h partition,.   
+000078a0: 2020 2020 2020 2020 2061 6e64 2077 696c           and wil
+000078b0: 6c20 7261 6973 6520 616e 2065 7272 6f72  l raise an error
+000078c0: 2069 6620 7468 6973 2064 6f65 736e 2774   if this doesn't
+000078d0: 2077 6f72 6b2c 0a20 2020 2020 2020 2020   work,.         
+000078e0: 2020 2062 7574 2069 7420 776f 6e27 7420     but it won't 
+000078f0: 7261 6973 6520 6966 2064 7479 7065 7320  raise if dtypes 
+00007900: 646f 6e27 7420 6d61 7463 682e 0a20 2020  don't match..   
+00007910: 2020 2020 2074 7261 6e73 666f 726d 5f64       transform_d
+00007920: 6976 6973 696f 6e73 203a 2062 6f6f 6c2c  ivisions : bool,
+00007930: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
+00007940: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
+00007950: 7220 746f 2061 7070 6c79 2074 6865 2066  r to apply the f
+00007960: 756e 6374 696f 6e20 6f6e 746f 2074 6865  unction onto the
+00007970: 2064 6976 6973 696f 6e73 2061 6e64 2061   divisions and a
+00007980: 7070 6c79 2074 686f 7365 0a20 2020 2020  pply those.     
+00007990: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
+000079a0: 6564 2064 6976 6973 696f 6e73 2074 6f20  ed divisions to 
+000079b0: 7468 6520 6f75 7470 7574 2e0a 2020 2020  the output..    
+000079c0: 2020 2020 616c 6967 6e5f 6461 7461 6672      align_datafr
+000079d0: 616d 6573 203a 2062 6f6f 6c2c 2064 6566  ames : bool, def
+000079e0: 6175 6c74 2054 7275 650a 2020 2020 2020  ault True.      
+000079f0: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
+00007a00: 2072 6570 6172 7469 7469 6f6e 2044 6174   repartition Dat
+00007a10: 6146 7261 6d65 2d20 6f72 2053 6572 6965  aFrame- or Serie
+00007a20: 732d 6c69 6b65 2061 7267 730a 2020 2020  s-like args.    
+00007a30: 2020 2020 2020 2020 2862 6f74 6820 6461          (both da
+00007a40: 736b 2061 6e64 2070 616e 6461 7329 2073  sk and pandas) s
+00007a50: 6f20 7468 6569 7220 6469 7669 7369 6f6e  o their division
+00007a60: 7320 616c 6967 6e20 6265 666f 7265 2061  s align before a
+00007a70: 7070 6c79 696e 670a 2020 2020 2020 2020  pplying.        
+00007a80: 2020 2020 7468 6520 6675 6e63 7469 6f6e      the function
+00007a90: 2e20 5468 6973 2072 6571 7569 7265 7320  . This requires 
+00007aa0: 616c 6c20 696e 7075 7473 2074 6f20 6861  all inputs to ha
+00007ab0: 7665 206b 6e6f 776e 2064 6976 6973 696f  ve known divisio
+00007ac0: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
+00007ad0: 5369 6e67 6c65 2d70 6172 7469 7469 6f6e  Single-partition
+00007ae0: 2069 6e70 7574 7320 7769 6c6c 2062 6520   inputs will be 
+00007af0: 7370 6c69 7420 696e 746f 206d 756c 7469  split into multi
+00007b00: 706c 6520 7061 7274 6974 696f 6e73 2e0a  ple partitions..
+00007b10: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00007b20: 4661 6c73 652c 2061 6c6c 2069 6e70 7574  False, all input
+00007b30: 7320 6d75 7374 2068 6176 6520 6569 7468  s must have eith
+00007b40: 6572 2074 6865 2073 616d 6520 6e75 6d62  er the same numb
+00007b50: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
+00007b60: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
+00007b70: 6120 7369 6e67 6c65 2070 6172 7469 7469  a single partiti
+00007b80: 6f6e 2e20 5369 6e67 6c65 2d70 6172 7469  on. Single-parti
+00007b90: 7469 6f6e 2069 6e70 7574 7320 7769 6c6c  tion inputs will
+00007ba0: 2062 6520 6272 6f61 6463 6173 7420 746f   be broadcast to
+00007bb0: 0a20 2020 2020 2020 2020 2020 2065 7665  .            eve
+00007bc0: 7279 2070 6172 7469 7469 6f6e 206f 6620  ry partition of 
+00007bd0: 6d75 6c74 692d 7061 7274 6974 696f 6e20  multi-partition 
+00007be0: 696e 7075 7473 2e0a 2020 2020 2020 2020  inputs..        
+00007bf0: 244d 4554 410a 0a20 2020 2020 2020 2045  $META..        E
+00007c00: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
+00007c10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00007c20: 2047 6976 656e 2061 2044 6174 6146 7261   Given a DataFra
+00007c30: 6d65 2c20 5365 7269 6573 2c20 6f72 2049  me, Series, or I
+00007c40: 6e64 6578 2c20 7375 6368 2061 733a 0a0a  ndex, such as:..
+00007c50: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+00007c60: 7274 2070 616e 6461 7320 6173 2070 640a  rt pandas as pd.
+00007c70: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+00007c80: 7274 2064 6173 6b2e 6461 7461 6672 616d  rt dask.datafram
+00007c90: 6520 6173 2064 640a 2020 2020 2020 2020  e as dd.        
+00007ca0: 3e3e 3e20 6466 203d 2070 642e 4461 7461  >>> df = pd.Data
+00007cb0: 4672 616d 6528 7b27 7827 3a20 5b31 2c20  Frame({'x': [1, 
+00007cc0: 322c 2033 2c20 342c 2035 5d2c 0a20 2020  2, 3, 4, 5],.   
+00007cd0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+00007ce0: 2020 2020 2020 2020 2020 2020 2779 273a              'y':
+00007cf0: 205b 312e 2c20 322e 2c20 332e 2c20 342e   [1., 2., 3., 4.
+00007d00: 2c20 352e 5d7d 290a 2020 2020 2020 2020  , 5.]}).        
+00007d10: 3e3e 3e20 6464 6620 3d20 6464 2e66 726f  >>> ddf = dd.fro
+00007d20: 6d5f 7061 6e64 6173 2864 662c 206e 7061  m_pandas(df, npa
+00007d30: 7274 6974 696f 6e73 3d32 290a 0a20 2020  rtitions=2)..   
+00007d40: 2020 2020 204f 6e65 2063 616e 2075 7365       One can use
+00007d50: 2060 606d 6170 5f70 6172 7469 7469 6f6e   ``map_partition
+00007d60: 7360 6020 746f 2061 7070 6c79 2061 2066  s`` to apply a f
+00007d70: 756e 6374 696f 6e20 6f6e 2065 6163 6820  unction on each 
+00007d80: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
+00007d90: 2020 2045 7874 7261 2061 7267 756d 656e     Extra argumen
+00007da0: 7473 2061 6e64 206b 6579 776f 7264 7320  ts and keywords 
+00007db0: 6361 6e20 6f70 7469 6f6e 616c 6c79 2062  can optionally b
+00007dc0: 6520 7072 6f76 6964 6564 2c20 616e 6420  e provided, and 
+00007dd0: 7769 6c6c 2062 650a 2020 2020 2020 2020  will be.        
+00007de0: 7061 7373 6564 2074 6f20 7468 6520 6675  passed to the fu
+00007df0: 6e63 7469 6f6e 2061 6674 6572 2074 6865  nction after the
+00007e00: 2070 6172 7469 7469 6f6e 2e0a 0a20 2020   partition...   
+00007e10: 2020 2020 2048 6572 6520 7765 2061 7070       Here we app
+00007e20: 6c79 2061 2066 756e 6374 696f 6e20 7769  ly a function wi
+00007e30: 7468 2061 7267 756d 656e 7473 2061 6e64  th arguments and
+00007e40: 206b 6579 776f 7264 7320 746f 2061 2044   keywords to a D
+00007e50: 6174 6146 7261 6d65 2c0a 2020 2020 2020  ataFrame,.      
+00007e60: 2020 7265 7375 6c74 696e 6720 696e 2061    resulting in a
+00007e70: 2053 6572 6965 733a 0a0a 2020 2020 2020   Series:..      
+00007e80: 2020 3e3e 3e20 6465 6620 6d79 6164 6428    >>> def myadd(
+00007e90: 6466 2c20 612c 2062 3d31 293a 0a20 2020  df, a, b=1):.   
+00007ea0: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
+00007eb0: 7572 6e20 6466 2e78 202b 2064 662e 7920  urn df.x + df.y 
+00007ec0: 2b20 6120 2b20 620a 2020 2020 2020 2020  + a + b.        
+00007ed0: 3e3e 3e20 7265 7320 3d20 6464 662e 6d61  >>> res = ddf.ma
+00007ee0: 705f 7061 7274 6974 696f 6e73 286d 7961  p_partitions(mya
+00007ef0: 6464 2c20 312c 2062 3d32 290a 2020 2020  dd, 1, b=2).    
+00007f00: 2020 2020 3e3e 3e20 7265 732e 6474 7970      >>> res.dtyp
+00007f10: 650a 2020 2020 2020 2020 6474 7970 6528  e.        dtype(
+00007f20: 2766 6c6f 6174 3634 2729 0a0a 2020 2020  'float64')..    
+00007f30: 2020 2020 4865 7265 2077 6520 6170 706c      Here we appl
+00007f40: 7920 6120 6675 6e63 7469 6f6e 2074 6f20  y a function to 
+00007f50: 6120 5365 7269 6573 2072 6573 756c 7469  a Series resulti
+00007f60: 6e67 2069 6e20 6120 5365 7269 6573 3a0a  ng in a Series:.
+00007f70: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+00007f80: 203d 2064 6466 2e78 2e6d 6170 5f70 6172   = ddf.x.map_par
+00007f90: 7469 7469 6f6e 7328 6c61 6d62 6461 2078  titions(lambda x
+00007fa0: 3a20 6c65 6e28 7829 2920 2320 6464 662e  : len(x)) # ddf.
+00007fb0: 7820 6973 2061 2044 6173 6b20 5365 7269  x is a Dask Seri
+00007fc0: 6573 2053 7472 7563 7475 7265 0a20 2020  es Structure.   
+00007fd0: 2020 2020 203e 3e3e 2072 6573 2e64 7479       >>> res.dty
+00007fe0: 7065 0a20 2020 2020 2020 2064 7479 7065  pe.        dtype
+00007ff0: 2827 696e 7436 3427 290a 0a20 2020 2020  ('int64')..     
+00008000: 2020 2042 7920 6465 6661 756c 742c 2064     By default, d
+00008010: 6173 6b20 7472 6965 7320 746f 2069 6e66  ask tries to inf
+00008020: 6572 2074 6865 206f 7574 7075 7420 6d65  er the output me
+00008030: 7461 6461 7461 2062 7920 7275 6e6e 696e  tadata by runnin
+00008040: 6720 796f 7572 0a20 2020 2020 2020 2070  g your.        p
+00008050: 726f 7669 6465 6420 6675 6e63 7469 6f6e  rovided function
+00008060: 206f 6e20 736f 6d65 2066 616b 6520 6461   on some fake da
+00008070: 7461 2e20 5468 6973 2077 6f72 6b73 2077  ta. This works w
+00008080: 656c 6c20 696e 206d 616e 7920 6361 7365  ell in many case
+00008090: 732c 2062 7574 0a20 2020 2020 2020 2063  s, but.        c
+000080a0: 616e 2073 6f6d 6574 696d 6573 2062 6520  an sometimes be 
+000080b0: 6578 7065 6e73 6976 652c 206f 7220 6576  expensive, or ev
+000080c0: 656e 2066 6169 6c2e 2054 6f20 6176 6f69  en fail. To avoi
+000080d0: 6420 7468 6973 2c20 796f 7520 6361 6e0a  d this, you can.
+000080e0: 2020 2020 2020 2020 6d61 6e75 616c 6c79          manually
+000080f0: 2073 7065 6369 6679 2074 6865 206f 7574   specify the out
+00008100: 7075 7420 6d65 7461 6461 7461 2077 6974  put metadata wit
+00008110: 6820 7468 6520 6060 6d65 7461 6060 206b  h the ``meta`` k
+00008120: 6579 776f 7264 2e20 5468 6973 0a20 2020  eyword. This.   
+00008130: 2020 2020 2063 616e 2062 6520 7370 6563       can be spec
+00008140: 6966 6965 6420 696e 206d 616e 7920 666f  ified in many fo
+00008150: 726d 732c 2066 6f72 206d 6f72 6520 696e  rms, for more in
+00008160: 666f 726d 6174 696f 6e20 7365 650a 2020  formation see.  
+00008170: 2020 2020 2020 6060 6461 736b 2e64 6174        ``dask.dat
+00008180: 6166 7261 6d65 2e75 7469 6c73 2e6d 616b  aframe.utils.mak
+00008190: 655f 6d65 7461 6060 2e0a 0a20 2020 2020  e_meta``...     
+000081a0: 2020 2048 6572 6520 7765 2073 7065 6369     Here we speci
+000081b0: 6679 2074 6865 206f 7574 7075 7420 6973  fy the output is
+000081c0: 2061 2053 6572 6965 7320 7769 7468 206e   a Series with n
+000081d0: 6f20 6e61 6d65 2c20 616e 6420 6474 7970  o name, and dtyp
+000081e0: 650a 2020 2020 2020 2020 6060 666c 6f61  e.        ``floa
+000081f0: 7436 3460 603a 0a0a 2020 2020 2020 2020  t64``:..        
+00008200: 3e3e 3e20 7265 7320 3d20 6464 662e 6d61  >>> res = ddf.ma
+00008210: 705f 7061 7274 6974 696f 6e73 286d 7961  p_partitions(mya
+00008220: 6464 2c20 312c 2062 3d32 2c20 6d65 7461  dd, 1, b=2, meta
+00008230: 3d28 4e6f 6e65 2c20 2766 3827 2929 0a0a  =(None, 'f8'))..
+00008240: 2020 2020 2020 2020 4865 7265 2077 6520          Here we 
+00008250: 6d61 7020 6120 6675 6e63 7469 6f6e 2074  map a function t
+00008260: 6861 7420 7461 6b65 7320 696e 2061 2044  hat takes in a D
+00008270: 6174 6146 7261 6d65 2c20 616e 6420 7265  ataFrame, and re
+00008280: 7475 726e 7320 610a 2020 2020 2020 2020  turns a.        
+00008290: 4461 7461 4672 616d 6520 7769 7468 2061  DataFrame with a
+000082a0: 206e 6577 2063 6f6c 756d 6e3a 0a0a 2020   new column:..  
+000082b0: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
+000082c0: 6464 662e 6d61 705f 7061 7274 6974 696f  ddf.map_partitio
+000082d0: 6e73 286c 616d 6264 6120 6466 3a20 6466  ns(lambda df: df
+000082e0: 2e61 7373 6967 6e28 7a3d 6466 2e78 202a  .assign(z=df.x *
+000082f0: 2064 662e 7929 290a 2020 2020 2020 2020   df.y)).        
+00008300: 3e3e 3e20 7265 732e 6474 7970 6573 0a20  >>> res.dtypes. 
+00008310: 2020 2020 2020 2078 2020 2020 2020 696e         x      in
+00008320: 7436 340a 2020 2020 2020 2020 7920 2020  t64.        y   
+00008330: 2066 6c6f 6174 3634 0a20 2020 2020 2020   float64.       
+00008340: 207a 2020 2020 666c 6f61 7436 340a 2020   z    float64.  
+00008350: 2020 2020 2020 6474 7970 653a 206f 626a        dtype: obj
+00008360: 6563 740a 0a20 2020 2020 2020 2041 7320  ect..        As 
+00008370: 6265 666f 7265 2c20 7468 6520 6f75 7470  before, the outp
+00008380: 7574 206d 6574 6164 6174 6120 6361 6e20  ut metadata can 
+00008390: 616c 736f 2062 6520 7370 6563 6966 6965  also be specifie
+000083a0: 6420 6d61 6e75 616c 6c79 2e20 5468 6973  d manually. This
+000083b0: 0a20 2020 2020 2020 2074 696d 6520 7765  .        time we
+000083c0: 2070 6173 7320 696e 2061 2060 6064 6963   pass in a ``dic
+000083d0: 7460 602c 2061 7320 7468 6520 6f75 7470  t``, as the outp
+000083e0: 7574 2069 7320 6120 4461 7461 4672 616d  ut is a DataFram
+000083f0: 653a 0a0a 2020 2020 2020 2020 3e3e 3e20  e:..        >>> 
+00008400: 7265 7320 3d20 6464 662e 6d61 705f 7061  res = ddf.map_pa
+00008410: 7274 6974 696f 6e73 286c 616d 6264 6120  rtitions(lambda 
+00008420: 6466 3a20 6466 2e61 7373 6967 6e28 7a3d  df: df.assign(z=
+00008430: 6466 2e78 202a 2064 662e 7929 2c0a 2020  df.x * df.y),.  
+00008440: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+00008450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008460: 2020 206d 6574 613d 7b27 7827 3a20 2769     meta={'x': 'i
+00008470: 3827 2c20 2779 273a 2027 6638 272c 2027  8', 'y': 'f8', '
+00008480: 7a27 3a20 2766 3827 7d29 0a0a 2020 2020  z': 'f8'})..    
+00008490: 2020 2020 496e 2074 6865 2063 6173 6520      In the case 
+000084a0: 7768 6572 6520 7468 6520 6d65 7461 6461  where the metada
+000084b0: 7461 2064 6f65 736e 2774 2063 6861 6e67  ta doesn't chang
+000084c0: 652c 2079 6f75 2063 616e 2061 6c73 6f20  e, you can also 
+000084d0: 7061 7373 2069 6e0a 2020 2020 2020 2020  pass in.        
+000084e0: 7468 6520 6f62 6a65 6374 2069 7473 656c  the object itsel
+000084f0: 6620 6469 7265 6374 6c79 3a0a 0a20 2020  f directly:..   
+00008500: 2020 2020 203e 3e3e 2072 6573 203d 2064       >>> res = d
+00008510: 6466 2e6d 6170 5f70 6172 7469 7469 6f6e  df.map_partition
+00008520: 7328 6c61 6d62 6461 2064 663a 2064 662e  s(lambda df: df.
+00008530: 6865 6164 2829 2c20 6d65 7461 3d64 6466  head(), meta=ddf
+00008540: 290a 0a20 2020 2020 2020 2041 6c73 6f20  )..        Also 
+00008550: 6e6f 7465 2074 6861 7420 7468 6520 696e  note that the in
+00008560: 6465 7820 616e 6420 6469 7669 7369 6f6e  dex and division
+00008570: 7320 6172 6520 6173 7375 6d65 6420 746f  s are assumed to
+00008580: 2072 656d 6169 6e20 756e 6368 616e 6765   remain unchange
+00008590: 642e 0a20 2020 2020 2020 2049 6620 7468  d..        If th
+000085a0: 6520 6675 6e63 7469 6f6e 2079 6f75 2772  e function you'r
+000085b0: 6520 6d61 7070 696e 6720 6368 616e 6765  e mapping change
+000085c0: 7320 7468 6520 696e 6465 782f 6469 7669  s the index/divi
+000085d0: 7369 6f6e 732c 2079 6f75 276c 6c20 6e65  sions, you'll ne
+000085e0: 6564 0a20 2020 2020 2020 2074 6f20 636c  ed.        to cl
+000085f0: 6561 7220 7468 656d 2061 6674 6572 7761  ear them afterwa
+00008600: 7264 733a 0a0a 2020 2020 2020 2020 3e3e  rds:..        >>
+00008610: 3e20 6464 662e 6d61 705f 7061 7274 6974  > ddf.map_partit
+00008620: 696f 6e73 2866 756e 6329 2e63 6c65 6172  ions(func).clear
+00008630: 5f64 6976 6973 696f 6e73 2829 2020 2320  _divisions()  # 
+00008640: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
+00008650: 2020 2020 2020 2020 596f 7572 206d 6170          Your map
+00008660: 2066 756e 6374 696f 6e20 6765 7473 2069   function gets i
+00008670: 6e66 6f72 6d61 7469 6f6e 2061 626f 7574  nformation about
+00008680: 2077 6865 7265 2069 7420 6973 2069 6e20   where it is in 
+00008690: 7468 6520 6461 7461 6672 616d 6520 6279  the dataframe by
+000086a0: 0a20 2020 2020 2020 2061 6363 6570 7469  .        accepti
+000086b0: 6e67 2061 2073 7065 6369 616c 2060 6070  ng a special ``p
+000086c0: 6172 7469 7469 6f6e 5f69 6e66 6f60 6020  artition_info`` 
+000086d0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+000086e0: 2e0a 0a20 2020 2020 2020 203e 3e3e 2064  ...        >>> d
+000086f0: 6566 2066 756e 6328 7061 7274 6974 696f  ef func(partitio
+00008700: 6e2c 2070 6172 7469 7469 6f6e 5f69 6e66  n, partition_inf
+00008710: 6f3d 4e6f 6e65 293a 0a20 2020 2020 2020  o=None):.       
+00008720: 202e 2e2e 2020 2020 2070 6173 730a 0a20   ...     pass.. 
+00008730: 2020 2020 2020 2054 6869 7320 7769 6c6c         This will
+00008740: 2072 6563 6569 7665 2074 6865 2066 6f6c   receive the fol
+00008750: 6c6f 7769 6e67 2069 6e66 6f72 6d61 7469  lowing informati
+00008760: 6f6e 3a0a 0a20 2020 2020 2020 203e 3e3e  on:..        >>>
+00008770: 2070 6172 7469 7469 6f6e 5f69 6e66 6f20   partition_info 
+00008780: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+00008790: 500a 2020 2020 2020 2020 7b27 6e75 6d62  P.        {'numb
+000087a0: 6572 273a 2031 2c20 2764 6976 6973 696f  er': 1, 'divisio
+000087b0: 6e27 3a20 337d 0a0a 2020 2020 2020 2020  n': 3}..        
+000087c0: 466f 7220 6561 6368 2061 7267 756d 656e  For each argumen
+000087d0: 7420 616e 6420 6b65 7977 6f72 6420 6172  t and keyword ar
+000087e0: 6775 6d65 6e74 7320 7468 6174 2061 7265  guments that are
+000087f0: 2064 6173 6b20 6461 7461 6672 616d 6573   dask dataframes
+00008800: 2079 6f75 2077 696c 6c0a 2020 2020 2020   you will.      
+00008810: 2020 7265 6365 6976 6520 7468 6520 6e75    receive the nu
+00008820: 6d62 6572 2028 6e29 2077 6869 6368 2072  mber (n) which r
+00008830: 6570 7265 7365 6e74 7320 7468 6520 6e74  epresents the nt
+00008840: 6820 7061 7274 6974 696f 6e20 6f66 2074  h partition of t
+00008850: 6865 2064 6174 6166 7261 6d65 0a20 2020  he dataframe.   
+00008860: 2020 2020 2061 6e64 2074 6865 2064 6976       and the div
+00008870: 6973 696f 6e20 2874 6865 2066 6972 7374  ision (the first
+00008880: 2069 6e64 6578 2076 616c 7565 2069 6e20   index value in 
+00008890: 7468 6520 7061 7274 6974 696f 6e29 2e20  the partition). 
+000088a0: 4966 2064 6976 6973 696f 6e73 0a20 2020  If divisions.   
+000088b0: 2020 2020 2061 7265 206e 6f74 206b 6e6f       are not kno
+000088c0: 776e 2028 666f 7220 696e 7374 616e 6365  wn (for instance
+000088d0: 2069 6620 7468 6520 696e 6465 7820 6973   if the index is
+000088e0: 206e 6f74 2073 6f72 7465 6429 2074 6865   not sorted) the
+000088f0: 6e20 796f 7520 7769 6c6c 2067 6574 0a20  n you will get. 
+00008900: 2020 2020 2020 204e 6f6e 6520 6173 2074         None as t
+00008910: 6865 2064 6976 6973 696f 6e2e 0a20 2020  he division..   
+00008920: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00008930: 2072 6574 7572 6e20 6d61 705f 7061 7274   return map_part
+00008940: 6974 696f 6e73 2866 756e 632c 2073 656c  itions(func, sel
+00008950: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00008960: 6773 290a 0a20 2020 2040 696e 7365 7274  gs)..    @insert
+00008970: 5f6d 6574 615f 7061 7261 6d5f 6465 7363  _meta_param_desc
+00008980: 7269 7074 696f 6e28 7061 643d 3132 290a  ription(pad=12).
+00008990: 2020 2020 6465 6620 6d61 705f 6f76 6572      def map_over
+000089a0: 6c61 7028 7365 6c66 2c20 6675 6e63 2c20  lap(self, func, 
+000089b0: 6265 666f 7265 2c20 6166 7465 722c 202a  before, after, *
+000089c0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+000089d0: 0a20 2020 2020 2020 2022 2222 4170 706c  .        """Appl
+000089e0: 7920 6120 6675 6e63 7469 6f6e 2074 6f20  y a function to 
+000089f0: 6561 6368 2070 6172 7469 7469 6f6e 2c20  each partition, 
+00008a00: 7368 6172 696e 6720 726f 7773 2077 6974  sharing rows wit
+00008a10: 6820 6164 6a61 6365 6e74 2070 6172 7469  h adjacent parti
+00008a20: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
+00008a30: 5468 6973 2063 616e 2062 6520 7573 6566  This can be usef
+00008a40: 756c 2066 6f72 2069 6d70 6c65 6d65 6e74  ul for implement
+00008a50: 696e 6720 7769 6e64 6f77 696e 6720 6675  ing windowing fu
+00008a60: 6e63 7469 6f6e 7320 7375 6368 2061 730a  nctions such as.
+00008a70: 2020 2020 2020 2020 6060 6466 2e72 6f6c          ``df.rol
+00008a80: 6c69 6e67 282e 2e2e 292e 6d65 616e 2829  ling(...).mean()
+00008a90: 6060 206f 7220 6060 6466 2e64 6966 6628  `` or ``df.diff(
+00008aa0: 2960 602e 0a0a 2020 2020 2020 2020 5061  )``...        Pa
+00008ab0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00008ac0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00008ad0: 2020 2020 6675 6e63 203a 2066 756e 6374      func : funct
+00008ae0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+00008af0: 4675 6e63 7469 6f6e 2061 7070 6c69 6564  Function applied
+00008b00: 2074 6f20 6561 6368 2070 6172 7469 7469   to each partiti
+00008b10: 6f6e 2e0a 2020 2020 2020 2020 6265 666f  on..        befo
+00008b20: 7265 203a 2069 6e74 2c20 7469 6d65 6465  re : int, timede
+00008b30: 6c74 6120 6f72 2073 7472 696e 6720 7469  lta or string ti
+00008b40: 6d65 6465 6c74 610a 2020 2020 2020 2020  medelta.        
+00008b50: 2020 2020 5468 6520 726f 7773 2074 6f20      The rows to 
+00008b60: 7072 6570 656e 6420 746f 2070 6172 7469  prepend to parti
+00008b70: 7469 6f6e 2060 6069 6060 2066 726f 6d20  tion ``i`` from 
+00008b80: 7468 6520 656e 6420 6f66 0a20 2020 2020  the end of.     
+00008b90: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+00008ba0: 2060 6069 202d 2031 6060 2e0a 2020 2020   ``i - 1``..    
+00008bb0: 2020 2020 6166 7465 7220 3a20 696e 742c      after : int,
+00008bc0: 2074 696d 6564 656c 7461 206f 7220 7374   timedelta or st
+00008bd0: 7269 6e67 2074 696d 6564 656c 7461 0a20  ring timedelta. 
+00008be0: 2020 2020 2020 2020 2020 2054 6865 2072             The r
+00008bf0: 6f77 7320 746f 2061 7070 656e 6420 746f  ows to append to
+00008c00: 2070 6172 7469 7469 6f6e 2060 6069 6060   partition ``i``
+00008c10: 2066 726f 6d20 7468 6520 6265 6769 6e6e   from the beginn
+00008c20: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00008c30: 6f66 2070 6172 7469 7469 6f6e 2060 6069  of partition ``i
+00008c40: 202b 2031 6060 2e0a 2020 2020 2020 2020   + 1``..        
+00008c50: 6172 6773 2c20 6b77 6172 6773 203a 0a20  args, kwargs :. 
+00008c60: 2020 2020 2020 2020 2020 2050 6f73 6974             Posit
+00008c70: 696f 6e61 6c20 616e 6420 6b65 7977 6f72  ional and keywor
+00008c80: 6420 6172 6775 6d65 6e74 7320 746f 2070  d arguments to p
+00008c90: 6173 7320 746f 2074 6865 2066 756e 6374  ass to the funct
+00008ca0: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
+00008cb0: 2050 6f73 6974 696f 6e61 6c20 6172 6775   Positional argu
+00008cc0: 6d65 6e74 7320 6172 6520 636f 6d70 7574  ments are comput
+00008cd0: 6564 206f 6e20 6120 7065 722d 7061 7274  ed on a per-part
+00008ce0: 6974 696f 6e20 6261 7369 732c 2077 6869  ition basis, whi
+00008cf0: 6c65 0a20 2020 2020 2020 2020 2020 206b  le.            k
+00008d00: 6579 776f 7264 2061 7267 756d 656e 7473  eyword arguments
+00008d10: 2061 7265 2073 6861 7265 6420 6163 726f   are shared acro
+00008d20: 7373 2061 6c6c 2070 6172 7469 7469 6f6e  ss all partition
+00008d30: 732e 2054 6865 2070 6172 7469 7469 6f6e  s. The partition
+00008d40: 0a20 2020 2020 2020 2020 2020 2069 7473  .            its
+00008d50: 656c 6620 7769 6c6c 2062 6520 7468 6520  elf will be the 
+00008d60: 6669 7273 7420 706f 7369 7469 6f6e 616c  first positional
+00008d70: 2061 7267 756d 656e 742c 2077 6974 6820   argument, with 
+00008d80: 616c 6c20 6f74 6865 720a 2020 2020 2020  all other.      
+00008d90: 2020 2020 2020 6172 6775 6d65 6e74 7320        arguments 
+00008da0: 7061 7373 6564 202a 6166 7465 722a 2e20  passed *after*. 
+00008db0: 4172 6775 6d65 6e74 7320 6361 6e20 6265  Arguments can be
+00008dc0: 2060 6053 6361 6c61 7260 602c 2060 6044   ``Scalar``, ``D
+00008dd0: 656c 6179 6564 6060 2c0a 2020 2020 2020  elayed``,.      
+00008de0: 2020 2020 2020 6f72 2072 6567 756c 6172        or regular
+00008df0: 2050 7974 686f 6e20 6f62 6a65 6374 732e   Python objects.
+00008e00: 2044 6174 6146 7261 6d65 2d6c 696b 6520   DataFrame-like 
+00008e10: 6172 6773 2028 626f 7468 2064 6173 6b20  args (both dask 
+00008e20: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+00008e30: 7061 6e64 6173 2920 7769 6c6c 2062 6520  pandas) will be 
+00008e40: 7265 7061 7274 6974 696f 6e65 6420 746f  repartitioned to
+00008e50: 2061 6c69 676e 2028 6966 206e 6563 6573   align (if neces
+00008e60: 7361 7279 2920 6265 666f 7265 0a20 2020  sary) before.   
+00008e70: 2020 2020 2020 2020 2061 7070 6c79 696e           applyin
+00008e80: 6720 7468 6520 6675 6e63 7469 6f6e 3b20  g the function; 
+00008e90: 7365 6520 6060 616c 6967 6e5f 6461 7461  see ``align_data
+00008ea0: 6672 616d 6573 6060 2074 6f20 636f 6e74  frames`` to cont
+00008eb0: 726f 6c20 7468 6973 0a20 2020 2020 2020  rol this.       
+00008ec0: 2020 2020 2062 6568 6176 696f 722e 0a20       behavior.. 
+00008ed0: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
+00008ee0: 6574 6164 6174 6120 3a20 626f 6f6c 2c20  etadata : bool, 
+00008ef0: 6465 6661 756c 7420 5472 7565 0a20 2020  default True.   
+00008f00: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
+00008f10: 2074 6f20 656e 666f 7263 6520 6174 2072   to enforce at r
+00008f20: 756e 7469 6d65 2074 6861 7420 7468 6520  untime that the 
+00008f30: 7374 7275 6374 7572 6520 6f66 2074 6865  structure of the
+00008f40: 2044 6174 6146 7261 6d65 0a20 2020 2020   DataFrame.     
+00008f50: 2020 2020 2020 2070 726f 6475 6365 6420         produced 
+00008f60: 6279 2060 6066 756e 6360 6020 6163 7475  by ``func`` actu
+00008f70: 616c 6c79 206d 6174 6368 6573 2074 6865  ally matches the
+00008f80: 2073 7472 7563 7475 7265 206f 6620 6060   structure of ``
+00008f90: 6d65 7461 6060 2e0a 2020 2020 2020 2020  meta``..        
+00008fa0: 2020 2020 5468 6973 2077 696c 6c20 7265      This will re
+00008fb0: 6e61 6d65 2061 6e64 2072 656f 7264 6572  name and reorder
+00008fc0: 2063 6f6c 756d 6e73 2066 6f72 2065 6163   columns for eac
+00008fd0: 6820 7061 7274 6974 696f 6e2c 0a20 2020  h partition,.   
+00008fe0: 2020 2020 2020 2020 2061 6e64 2077 696c           and wil
+00008ff0: 6c20 7261 6973 6520 616e 2065 7272 6f72  l raise an error
+00009000: 2069 6620 7468 6973 2064 6f65 736e 2774   if this doesn't
+00009010: 2077 6f72 6b2c 0a20 2020 2020 2020 2020   work,.         
+00009020: 2020 2062 7574 2069 7420 776f 6e27 7420     but it won't 
+00009030: 7261 6973 6520 6966 2064 7479 7065 7320  raise if dtypes 
+00009040: 646f 6e27 7420 6d61 7463 682e 0a20 2020  don't match..   
+00009050: 2020 2020 2074 7261 6e73 666f 726d 5f64       transform_d
+00009060: 6976 6973 696f 6e73 203a 2062 6f6f 6c2c  ivisions : bool,
+00009070: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
+00009080: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
+00009090: 7220 746f 2061 7070 6c79 2074 6865 2066  r to apply the f
+000090a0: 756e 6374 696f 6e20 6f6e 746f 2074 6865  unction onto the
+000090b0: 2064 6976 6973 696f 6e73 2061 6e64 2061   divisions and a
+000090c0: 7070 6c79 2074 686f 7365 0a20 2020 2020  pply those.     
+000090d0: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
+000090e0: 6564 2064 6976 6973 696f 6e73 2074 6f20  ed divisions to 
+000090f0: 7468 6520 6f75 7470 7574 2e0a 2020 2020  the output..    
+00009100: 2020 2020 616c 6967 6e5f 6461 7461 6672      align_datafr
+00009110: 616d 6573 203a 2062 6f6f 6c2c 2064 6566  ames : bool, def
+00009120: 6175 6c74 2054 7275 650a 2020 2020 2020  ault True.      
+00009130: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
+00009140: 2072 6570 6172 7469 7469 6f6e 2044 6174   repartition Dat
+00009150: 6146 7261 6d65 2d20 6f72 2053 6572 6965  aFrame- or Serie
+00009160: 732d 6c69 6b65 2061 7267 730a 2020 2020  s-like args.    
+00009170: 2020 2020 2020 2020 2862 6f74 6820 6461          (both da
+00009180: 736b 2061 6e64 2070 616e 6461 7329 2073  sk and pandas) s
+00009190: 6f20 7468 6569 7220 6469 7669 7369 6f6e  o their division
+000091a0: 7320 616c 6967 6e20 6265 666f 7265 2061  s align before a
+000091b0: 7070 6c79 696e 670a 2020 2020 2020 2020  pplying.        
+000091c0: 2020 2020 7468 6520 6675 6e63 7469 6f6e      the function
+000091d0: 2e20 5468 6973 2072 6571 7569 7265 7320  . This requires 
+000091e0: 616c 6c20 696e 7075 7473 2074 6f20 6861  all inputs to ha
+000091f0: 7665 206b 6e6f 776e 2064 6976 6973 696f  ve known divisio
+00009200: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
+00009210: 5369 6e67 6c65 2d70 6172 7469 7469 6f6e  Single-partition
+00009220: 2069 6e70 7574 7320 7769 6c6c 2062 6520   inputs will be 
+00009230: 7370 6c69 7420 696e 746f 206d 756c 7469  split into multi
+00009240: 706c 6520 7061 7274 6974 696f 6e73 2e0a  ple partitions..
+00009250: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00009260: 4661 6c73 652c 2061 6c6c 2069 6e70 7574  False, all input
+00009270: 7320 6d75 7374 2068 6176 6520 6569 7468  s must have eith
+00009280: 6572 2074 6865 2073 616d 6520 6e75 6d62  er the same numb
+00009290: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
+000092a0: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
+000092b0: 6120 7369 6e67 6c65 2070 6172 7469 7469  a single partiti
+000092c0: 6f6e 2e20 5369 6e67 6c65 2d70 6172 7469  on. Single-parti
+000092d0: 7469 6f6e 2069 6e70 7574 7320 7769 6c6c  tion inputs will
+000092e0: 2062 6520 6272 6f61 6463 6173 7420 746f   be broadcast to
+000092f0: 0a20 2020 2020 2020 2020 2020 2065 7665  .            eve
+00009300: 7279 2070 6172 7469 7469 6f6e 206f 6620  ry partition of 
+00009310: 6d75 6c74 692d 7061 7274 6974 696f 6e20  multi-partition 
+00009320: 696e 7075 7473 2e0a 2020 2020 2020 2020  inputs..        
+00009330: 244d 4554 410a 0a20 2020 2020 2020 204e  $META..        N
+00009340: 6f74 6573 0a20 2020 2020 2020 202d 2d2d  otes.        ---
+00009350: 2d2d 0a20 2020 2020 2020 2047 6976 656e  --.        Given
+00009360: 2070 6f73 6974 6976 6520 696e 7465 6765   positive intege
+00009370: 7273 2060 6062 6566 6f72 6560 6020 616e  rs ``before`` an
+00009380: 6420 6060 6166 7465 7260 602c 2061 6e64  d ``after``, and
+00009390: 2061 2066 756e 6374 696f 6e0a 2020 2020   a function.    
+000093a0: 2020 2020 6060 6675 6e63 6060 2c20 6060      ``func``, ``
+000093b0: 6d61 705f 6f76 6572 6c61 7060 6020 646f  map_overlap`` do
+000093c0: 6573 2074 6865 2066 6f6c 6c6f 7769 6e67  es the following
+000093d0: 3a0a 0a20 2020 2020 2020 2031 2e20 5072  :..        1. Pr
+000093e0: 6570 656e 6420 6060 6265 666f 7265 6060  epend ``before``
+000093f0: 2072 6f77 7320 746f 2065 6163 6820 7061   rows to each pa
+00009400: 7274 6974 696f 6e20 6060 6960 6020 6672  rtition ``i`` fr
+00009410: 6f6d 2074 6865 2065 6e64 206f 660a 2020  om the end of.  
+00009420: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
+00009430: 6f6e 2060 6069 202d 2031 6060 2e20 5468  on ``i - 1``. Th
+00009440: 6520 6669 7273 7420 7061 7274 6974 696f  e first partitio
+00009450: 6e20 6861 7320 6e6f 2072 6f77 7320 7072  n has no rows pr
+00009460: 6570 656e 6465 642e 0a0a 2020 2020 2020  epended...      
+00009470: 2020 322e 2041 7070 656e 6420 6060 6166    2. Append ``af
+00009480: 7465 7260 6020 726f 7773 2074 6f20 6561  ter`` rows to ea
+00009490: 6368 2070 6172 7469 7469 6f6e 2060 6069  ch partition ``i
+000094a0: 6060 2066 726f 6d20 7468 6520 6265 6769  `` from the begi
+000094b0: 6e6e 696e 6720 6f66 0a20 2020 2020 2020  nning of.       
+000094c0: 2020 2020 7061 7274 6974 696f 6e20 6060      partition ``
+000094d0: 6920 2b20 3160 602e 2054 6865 206c 6173  i + 1``. The las
+000094e0: 7420 7061 7274 6974 696f 6e20 6861 7320  t partition has 
+000094f0: 6e6f 2072 6f77 7320 6170 7065 6e64 6564  no rows appended
+00009500: 2e0a 0a20 2020 2020 2020 2033 2e20 4170  ...        3. Ap
+00009510: 706c 7920 6060 6675 6e63 6060 2074 6f20  ply ``func`` to 
+00009520: 6561 6368 2070 6172 7469 7469 6f6e 2c20  each partition, 
+00009530: 7061 7373 696e 6720 696e 2061 6e79 2065  passing in any e
+00009540: 7874 7261 2060 6061 7267 7360 6020 616e  xtra ``args`` an
+00009550: 640a 2020 2020 2020 2020 2020 2060 606b  d.           ``k
+00009560: 7761 7267 7360 6020 6966 2070 726f 7669  wargs`` if provi
+00009570: 6465 642e 0a0a 2020 2020 2020 2020 342e  ded...        4.
+00009580: 2054 7269 6d20 6060 6265 666f 7265 6060   Trim ``before``
+00009590: 2072 6f77 7320 6672 6f6d 2074 6865 2062   rows from the b
+000095a0: 6567 696e 6e69 6e67 206f 6620 616c 6c20  eginning of all 
+000095b0: 6275 7420 7468 6520 6669 7273 740a 2020  but the first.  
+000095c0: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
+000095d0: 6f6e 2e0a 0a20 2020 2020 2020 2035 2e20  on...        5. 
+000095e0: 5472 696d 2060 6061 6674 6572 6060 2072  Trim ``after`` r
+000095f0: 6f77 7320 6672 6f6d 2074 6865 2065 6e64  ows from the end
+00009600: 206f 6620 616c 6c20 6275 7420 7468 6520   of all but the 
+00009610: 6c61 7374 2070 6172 7469 7469 6f6e 2e0a  last partition..
+00009620: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00009630: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00009640: 2d2d 0a20 2020 2020 2020 2047 6976 656e  --.        Given
+00009650: 2061 2044 6174 6146 7261 6d65 2c20 5365   a DataFrame, Se
+00009660: 7269 6573 2c20 6f72 2049 6e64 6578 2c20  ries, or Index, 
+00009670: 7375 6368 2061 733a 0a0a 2020 2020 2020  such as:..      
+00009680: 2020 3e3e 3e20 696d 706f 7274 2070 616e    >>> import pan
+00009690: 6461 7320 6173 2070 640a 2020 2020 2020  das as pd.      
+000096a0: 2020 3e3e 3e20 696d 706f 7274 2064 6173    >>> import das
+000096b0: 6b2e 6461 7461 6672 616d 6520 6173 2064  k.dataframe as d
+000096c0: 640a 2020 2020 2020 2020 3e3e 3e20 6466  d.        >>> df
+000096d0: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
+000096e0: 7b27 7827 3a20 5b31 2c20 322c 2034 2c20  {'x': [1, 2, 4, 
+000096f0: 372c 2031 315d 2c0a 2020 2020 2020 2020  7, 11],.        
+00009700: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+00009710: 2020 2020 2020 2027 7927 3a20 5b31 2e2c         'y': [1.,
+00009720: 2032 2e2c 2033 2e2c 2034 2e2c 2035 2e5d   2., 3., 4., 5.]
+00009730: 7d29 0a20 2020 2020 2020 203e 3e3e 2064  }).        >>> d
+00009740: 6466 203d 2064 642e 6672 6f6d 5f70 616e  df = dd.from_pan
+00009750: 6461 7328 6466 2c20 6e70 6172 7469 7469  das(df, npartiti
+00009760: 6f6e 733d 3229 0a0a 2020 2020 2020 2020  ons=2)..        
+00009770: 4120 726f 6c6c 696e 6720 7375 6d20 7769  A rolling sum wi
+00009780: 7468 2061 2074 7261 696c 696e 6720 6d6f  th a trailing mo
+00009790: 7669 6e67 2077 696e 646f 7720 6f66 2073  ving window of s
+000097a0: 697a 6520 3220 6361 6e20 6265 2063 6f6d  ize 2 can be com
+000097b0: 7075 7465 6420 6279 0a20 2020 2020 2020  puted by.       
+000097c0: 206f 7665 726c 6170 7069 6e67 2032 2072   overlapping 2 r
+000097d0: 6f77 7320 6265 666f 7265 2065 6163 6820  ows before each 
+000097e0: 7061 7274 6974 696f 6e2c 2061 6e64 2074  partition, and t
+000097f0: 6865 6e20 6d61 7070 696e 6720 6361 6c6c  hen mapping call
+00009800: 7320 746f 0a20 2020 2020 2020 2060 6064  s to.        ``d
+00009810: 662e 726f 6c6c 696e 6728 3229 2e73 756d  f.rolling(2).sum
+00009820: 2829 6060 3a0a 0a20 2020 2020 2020 203e  ()``:..        >
+00009830: 3e3e 2064 6466 2e63 6f6d 7075 7465 2829  >> ddf.compute()
+00009840: 0a20 2020 2020 2020 2020 2020 2078 2020  .            x  
+00009850: 2020 790a 2020 2020 2020 2020 3020 2020    y.        0   
+00009860: 3120 2031 2e30 0a20 2020 2020 2020 2031  1  1.0.        1
+00009870: 2020 2032 2020 322e 300a 2020 2020 2020     2  2.0.      
+00009880: 2020 3220 2020 3420 2033 2e30 0a20 2020    2   4  3.0.   
+00009890: 2020 2020 2033 2020 2037 2020 342e 300a       3   7  4.0.
+000098a0: 2020 2020 2020 2020 3420 2031 3120 2035          4  11  5
+000098b0: 2e30 0a20 2020 2020 2020 203e 3e3e 2064  .0.        >>> d
+000098c0: 6466 2e6d 6170 5f6f 7665 726c 6170 286c  df.map_overlap(l
+000098d0: 616d 6264 6120 6466 3a20 6466 2e72 6f6c  ambda df: df.rol
+000098e0: 6c69 6e67 2832 292e 7375 6d28 292c 2032  ling(2).sum(), 2
+000098f0: 2c20 3029 2e63 6f6d 7075 7465 2829 0a20  , 0).compute(). 
+00009900: 2020 2020 2020 2020 2020 2020 2078 2020               x  
+00009910: 2020 790a 2020 2020 2020 2020 3020 2020    y.        0   
+00009920: 4e61 4e20 204e 614e 0a20 2020 2020 2020  NaN  NaN.       
+00009930: 2031 2020 2033 2e30 2020 332e 300a 2020   1   3.0  3.0.  
+00009940: 2020 2020 2020 3220 2020 362e 3020 2035        2   6.0  5
+00009950: 2e30 0a20 2020 2020 2020 2033 2020 3131  .0.        3  11
+00009960: 2e30 2020 372e 300a 2020 2020 2020 2020  .0  7.0.        
+00009970: 3420 2031 382e 3020 2039 2e30 0a0a 2020  4  18.0  9.0..  
+00009980: 2020 2020 2020 5468 6520 7061 6e64 6173        The pandas
+00009990: 2060 6064 6966 6660 6020 6d65 7468 6f64   ``diff`` method
+000099a0: 2063 6f6d 7075 7465 7320 6120 6469 7363   computes a disc
+000099b0: 7265 7465 2064 6966 6665 7265 6e63 6520  rete difference 
+000099c0: 7368 6966 7465 6420 6279 2061 0a20 2020  shifted by a.   
+000099d0: 2020 2020 206e 756d 6265 7220 6f66 2070       number of p
+000099e0: 6572 696f 6473 2028 6361 6e20 6265 2070  eriods (can be p
+000099f0: 6f73 6974 6976 6520 6f72 206e 6567 6174  ositive or negat
+00009a00: 6976 6529 2e20 5468 6973 2063 616e 2062  ive). This can b
+00009a10: 650a 2020 2020 2020 2020 696d 706c 656d  e.        implem
+00009a20: 656e 7465 6420 6279 206d 6170 7069 6e67  ented by mapping
+00009a30: 2063 616c 6c73 2074 6f20 6060 6466 2e64   calls to ``df.d
+00009a40: 6966 6660 6020 746f 2065 6163 6820 7061  iff`` to each pa
+00009a50: 7274 6974 696f 6e20 6166 7465 720a 2020  rtition after.  
+00009a60: 2020 2020 2020 7072 6570 656e 6469 6e67        prepending
+00009a70: 2f61 7070 656e 6469 6e67 2074 6861 7420  /appending that 
+00009a80: 6d61 6e79 2072 6f77 732c 2064 6570 656e  many rows, depen
+00009a90: 6469 6e67 206f 6e20 7369 676e 3a0a 0a20  ding on sign:.. 
+00009aa0: 2020 2020 2020 203e 3e3e 2064 6566 2064         >>> def d
+00009ab0: 6966 6628 6466 2c20 7065 7269 6f64 733d  iff(df, periods=
+00009ac0: 3129 3a0a 2020 2020 2020 2020 2e2e 2e20  1):.        ... 
+00009ad0: 2020 2020 6265 666f 7265 2c20 6166 7465      before, afte
+00009ae0: 7220 3d20 2870 6572 696f 6473 2c20 3029  r = (periods, 0)
+00009af0: 2069 6620 7065 7269 6f64 7320 3e20 3020   if periods > 0 
+00009b00: 656c 7365 2028 302c 202d 7065 7269 6f64  else (0, -period
+00009b10: 7329 0a20 2020 2020 2020 202e 2e2e 2020  s).        ...  
+00009b20: 2020 2072 6574 7572 6e20 6466 2e6d 6170     return df.map
+00009b30: 5f6f 7665 726c 6170 286c 616d 6264 6120  _overlap(lambda 
+00009b40: 6466 2c20 7065 7269 6f64 733d 313a 2064  df, periods=1: d
+00009b50: 662e 6469 6666 2870 6572 696f 6473 292c  f.diff(periods),
+00009b60: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00009b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b80: 2020 2020 2020 2070 6572 696f 6473 2c20         periods, 
+00009b90: 302c 2070 6572 696f 6473 3d70 6572 696f  0, periods=perio
+00009ba0: 6473 290a 2020 2020 2020 2020 3e3e 3e20  ds).        >>> 
+00009bb0: 6469 6666 2864 6466 2c20 3129 2e63 6f6d  diff(ddf, 1).com
+00009bc0: 7075 7465 2829 0a20 2020 2020 2020 2020  pute().         
+00009bd0: 2020 2020 7820 2020 2079 0a20 2020 2020      x    y.     
+00009be0: 2020 2030 2020 4e61 4e20 204e 614e 0a20     0  NaN  NaN. 
+00009bf0: 2020 2020 2020 2031 2020 312e 3020 2031         1  1.0  1
+00009c00: 2e30 0a20 2020 2020 2020 2032 2020 322e  .0.        2  2.
+00009c10: 3020 2031 2e30 0a20 2020 2020 2020 2033  0  1.0.        3
+00009c20: 2020 332e 3020 2031 2e30 0a20 2020 2020    3.0  1.0.     
+00009c30: 2020 2034 2020 342e 3020 2031 2e30 0a0a     4  4.0  1.0..
+00009c40: 2020 2020 2020 2020 4966 2079 6f75 2068          If you h
+00009c50: 6176 6520 6120 6060 4461 7465 7469 6d65  ave a ``Datetime
+00009c60: 496e 6465 7860 602c 2079 6f75 2063 616e  Index``, you can
+00009c70: 2075 7365 2061 2060 6070 642e 5469 6d65   use a ``pd.Time
+00009c80: 6465 6c74 6160 6020 666f 7220 7469 6d65  delta`` for time
+00009c90: 2d0a 2020 2020 2020 2020 6261 7365 6420  -.        based 
+00009ca0: 7769 6e64 6f77 7320 6f72 2061 6e79 2060  windows or any `
+00009cb0: 6070 642e 5469 6d65 6465 6c74 6160 6020  `pd.Timedelta`` 
+00009cc0: 636f 6e76 6572 7469 626c 6520 7374 7269  convertible stri
+00009cd0: 6e67 3a0a 0a20 2020 2020 2020 203e 3e3e  ng:..        >>>
+00009ce0: 2074 7320 3d20 7064 2e53 6572 6965 7328   ts = pd.Series(
+00009cf0: 7261 6e67 6528 3130 292c 2069 6e64 6578  range(10), index
+00009d00: 3d70 642e 6461 7465 5f72 616e 6765 2827  =pd.date_range('
+00009d10: 3230 3137 272c 2070 6572 696f 6473 3d31  2017', periods=1
+00009d20: 3029 290a 2020 2020 2020 2020 3e3e 3e20  0)).        >>> 
+00009d30: 6474 7320 3d20 6464 2e66 726f 6d5f 7061  dts = dd.from_pa
+00009d40: 6e64 6173 2874 732c 206e 7061 7274 6974  ndas(ts, npartit
+00009d50: 696f 6e73 3d32 290a 2020 2020 2020 2020  ions=2).        
+00009d60: 3e3e 3e20 6474 732e 6d61 705f 6f76 6572  >>> dts.map_over
+00009d70: 6c61 7028 6c61 6d62 6461 2064 663a 2064  lap(lambda df: d
+00009d80: 662e 726f 6c6c 696e 6728 2732 4427 292e  f.rolling('2D').
+00009d90: 7375 6d28 292c 0a20 2020 2020 2020 202e  sum(),.        .
+00009da0: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+00009db0: 2020 2070 642e 5469 6d65 6465 6c74 6128     pd.Timedelta(
+00009dc0: 2732 4427 292c 2030 292e 636f 6d70 7574  '2D'), 0).comput
+00009dd0: 6528 290a 2020 2020 2020 2020 3230 3137  e().        2017
+00009de0: 2d30 312d 3031 2020 2020 2030 2e30 0a20  -01-01     0.0. 
+00009df0: 2020 2020 2020 2032 3031 372d 3031 2d30         2017-01-0
+00009e00: 3220 2020 2020 312e 300a 2020 2020 2020  2     1.0.      
+00009e10: 2020 3230 3137 2d30 312d 3033 2020 2020    2017-01-03    
+00009e20: 2033 2e30 0a20 2020 2020 2020 2032 3031   3.0.        201
+00009e30: 372d 3031 2d30 3420 2020 2020 352e 300a  7-01-04     5.0.
+00009e40: 2020 2020 2020 2020 3230 3137 2d30 312d          2017-01-
+00009e50: 3035 2020 2020 2037 2e30 0a20 2020 2020  05     7.0.     
+00009e60: 2020 2032 3031 372d 3031 2d30 3620 2020     2017-01-06   
+00009e70: 2020 392e 300a 2020 2020 2020 2020 3230    9.0.        20
+00009e80: 3137 2d30 312d 3037 2020 2020 3131 2e30  17-01-07    11.0
+00009e90: 0a20 2020 2020 2020 2032 3031 372d 3031  .        2017-01
+00009ea0: 2d30 3820 2020 2031 332e 300a 2020 2020  -08    13.0.    
+00009eb0: 2020 2020 3230 3137 2d30 312d 3039 2020      2017-01-09  
+00009ec0: 2020 3135 2e30 0a20 2020 2020 2020 2032    15.0.        2
+00009ed0: 3031 372d 3031 2d31 3020 2020 2031 372e  017-01-10    17.
+00009ee0: 300a 2020 2020 2020 2020 4672 6571 3a20  0.        Freq: 
+00009ef0: 442c 2064 7479 7065 3a20 666c 6f61 7436  D, dtype: float6
+00009f00: 340a 2020 2020 2020 2020 2222 220a 2020  4.        """.  
+00009f10: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+00009f20: 6461 7461 6672 616d 652e 726f 6c6c 696e  dataframe.rollin
+00009f30: 6720 696d 706f 7274 206d 6170 5f6f 7665  g import map_ove
+00009f40: 726c 6170 0a0a 2020 2020 2020 2020 7265  rlap..        re
+00009f50: 7475 726e 206d 6170 5f6f 7665 726c 6170  turn map_overlap
+00009f60: 2866 756e 632c 2073 656c 662c 2062 6566  (func, self, bef
+00009f70: 6f72 652c 2061 6674 6572 2c20 2a61 7267  ore, after, *arg
+00009f80: 732c 202a 2a6b 7761 7267 7329 0a0a 2020  s, **kwargs)..  
+00009f90: 2020 6465 6620 6d65 6d6f 7279 5f75 7361    def memory_usa
+00009fa0: 6765 5f70 6572 5f70 6172 7469 7469 6f6e  ge_per_partition
+00009fb0: 2873 656c 662c 2069 6e64 6578 3d54 7275  (self, index=Tru
+00009fc0: 652c 2064 6565 703d 4661 6c73 6529 3a0a  e, deep=False):.
+00009fd0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00009fe0: 6e20 7468 6520 6d65 6d6f 7279 2075 7361  n the memory usa
+00009ff0: 6765 206f 6620 6561 6368 2070 6172 7469  ge of each parti
+0000a000: 7469 6f6e 0a0a 2020 2020 2020 2020 5061  tion..        Pa
+0000a010: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+0000a020: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0000a030: 2020 2020 696e 6465 7820 3a20 626f 6f6c      index : bool
+0000a040: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
+0000a050: 2020 2020 2020 2020 2020 2053 7065 6369             Speci
+0000a060: 6669 6573 2077 6865 7468 6572 2074 6f20  fies whether to 
+0000a070: 696e 636c 7564 6520 7468 6520 6d65 6d6f  include the memo
+0000a080: 7279 2075 7361 6765 206f 6620 7468 6520  ry usage of the 
+0000a090: 696e 6465 7820 696e 0a20 2020 2020 2020  index in.       
+0000a0a0: 2020 2020 2072 6574 7572 6e65 6420 5365       returned Se
+0000a0b0: 7269 6573 2e0a 2020 2020 2020 2020 6465  ries..        de
+0000a0c0: 6570 203a 2062 6f6f 6c2c 2064 6566 6175  ep : bool, defau
+0000a0d0: 6c74 2046 616c 7365 0a20 2020 2020 2020  lt False.       
+0000a0e0: 2020 2020 2049 6620 5472 7565 2c20 696e       If True, in
+0000a0f0: 7472 6f73 7065 6374 2074 6865 2064 6174  trospect the dat
+0000a100: 6120 6465 6570 6c79 2062 7920 696e 7465  a deeply by inte
+0000a110: 7272 6f67 6174 696e 670a 2020 2020 2020  rrogating.      
+0000a120: 2020 2020 2020 6060 6f62 6a65 6374 6060        ``object``
+0000a130: 2064 7479 7065 7320 666f 7220 7379 7374   dtypes for syst
+0000a140: 656d 2d6c 6576 656c 206d 656d 6f72 7920  em-level memory 
+0000a150: 636f 6e73 756d 7074 696f 6e2c 2061 6e64  consumption, and
+0000a160: 2069 6e63 6c75 6465 0a20 2020 2020 2020   include.       
+0000a170: 2020 2020 2069 7420 696e 2074 6865 2072       it in the r
+0000a180: 6574 7572 6e65 6420 7661 6c75 6573 2e0a  eturned values..
+0000a190: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0000a1a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000a1b0: 0a20 2020 2020 2020 2053 6572 6965 730a  .        Series.
+0000a1c0: 2020 2020 2020 2020 2020 2020 4120 5365              A Se
+0000a1d0: 7269 6573 2077 686f 7365 2069 6e64 6578  ries whose index
+0000a1e0: 2069 7320 7468 6520 7061 7274 6974 696f   is the partitio
+0000a1f0: 6e20 6e75 6d62 6572 2061 6e64 2077 686f  n number and who
+0000a200: 7365 2076 616c 7565 730a 2020 2020 2020  se values.      
+0000a210: 2020 2020 2020 6172 6520 7468 6520 6d65        are the me
+0000a220: 6d6f 7279 2075 7361 6765 206f 6620 6561  mory usage of ea
+0000a230: 6368 2070 6172 7469 7469 6f6e 2069 6e20  ch partition in 
+0000a240: 6279 7465 732e 0a20 2020 2020 2020 2022  bytes..        "
+0000a250: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0000a260: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+0000a270: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+0000a280: 2020 2074 6f74 616c 5f6d 656d 5f75 7361     total_mem_usa
+0000a290: 6765 2c20 696e 6465 783d 696e 6465 782c  ge, index=index,
+0000a2a0: 2064 6565 703d 6465 6570 0a20 2020 2020   deep=deep.     
+0000a2b0: 2020 2029 2e63 6c65 6172 5f64 6976 6973     ).clear_divis
+0000a2c0: 696f 6e73 2829 0a0a 2020 2020 4069 6e73  ions()..    @ins
+0000a2d0: 6572 745f 6d65 7461 5f70 6172 616d 5f64  ert_meta_param_d
+0000a2e0: 6573 6372 6970 7469 6f6e 2870 6164 3d31  escription(pad=1
+0000a2f0: 3229 0a20 2020 2064 6566 2072 6564 7563  2).    def reduc
+0000a300: 7469 6f6e 280a 2020 2020 2020 2020 7365  tion(.        se
+0000a310: 6c66 2c0a 2020 2020 2020 2020 6368 756e  lf,.        chun
+0000a320: 6b2c 0a20 2020 2020 2020 2061 6767 7265  k,.        aggre
+0000a330: 6761 7465 3d4e 6f6e 652c 0a20 2020 2020  gate=None,.     
+0000a340: 2020 2063 6f6d 6269 6e65 3d4e 6f6e 652c     combine=None,
+0000a350: 0a20 2020 2020 2020 206d 6574 613d 6e6f  .        meta=no
+0000a360: 5f64 6566 6175 6c74 2c0a 2020 2020 2020  _default,.      
+0000a370: 2020 746f 6b65 6e3d 4e6f 6e65 2c0a 2020    token=None,.  
+0000a380: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
+0000a390: 793d 4e6f 6e65 2c0a 2020 2020 2020 2020  y=None,.        
+0000a3a0: 6368 756e 6b5f 6b77 6172 6773 3d4e 6f6e  chunk_kwargs=Non
+0000a3b0: 652c 0a20 2020 2020 2020 2061 6767 7265  e,.        aggre
+0000a3c0: 6761 7465 5f6b 7761 7267 733d 4e6f 6e65  gate_kwargs=None
+0000a3d0: 2c0a 2020 2020 2020 2020 636f 6d62 696e  ,.        combin
+0000a3e0: 655f 6b77 6172 6773 3d4e 6f6e 652c 0a20  e_kwargs=None,. 
+0000a3f0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+0000a400: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0000a410: 2222 2247 656e 6572 6963 2072 6f77 2d77  """Generic row-w
+0000a420: 6973 6520 7265 6475 6374 696f 6e73 2e0a  ise reductions..
+0000a430: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0000a440: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0000a450: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2063  ------.        c
+0000a460: 6875 6e6b 203a 2063 616c 6c61 626c 650a  hunk : callable.
+0000a470: 2020 2020 2020 2020 2020 2020 4675 6e63              Func
+0000a480: 7469 6f6e 2074 6f20 6f70 6572 6174 6520  tion to operate 
+0000a490: 6f6e 2065 6163 6820 7061 7274 6974 696f  on each partitio
+0000a4a0: 6e2e 2053 686f 756c 6420 7265 7475 726e  n. Should return
+0000a4b0: 2061 0a20 2020 2020 2020 2020 2020 2060   a.            `
+0000a4c0: 6070 616e 6461 732e 4461 7461 4672 616d  `pandas.DataFram
+0000a4d0: 6560 602c 2060 6070 616e 6461 732e 5365  e``, ``pandas.Se
+0000a4e0: 7269 6573 6060 2c20 6f72 2061 2073 6361  ries``, or a sca
+0000a4f0: 6c61 722e 0a20 2020 2020 2020 2061 6767  lar..        agg
+0000a500: 7265 6761 7465 203a 2063 616c 6c61 626c  regate : callabl
+0000a510: 652c 206f 7074 696f 6e61 6c0a 2020 2020  e, optional.    
+0000a520: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
+0000a530: 2074 6f20 6f70 6572 6174 6520 6f6e 2074   to operate on t
+0000a540: 6865 2063 6f6e 6361 7465 6e61 7465 6420  he concatenated 
+0000a550: 7265 7375 6c74 206f 6620 6060 6368 756e  result of ``chun
+0000a560: 6b60 602e 2049 6620 6e6f 740a 2020 2020  k``. If not.    
+0000a570: 2020 2020 2020 2020 7370 6563 6966 6965          specifie
+0000a580: 642c 2064 6566 6175 6c74 7320 746f 2060  d, defaults to `
+0000a590: 6063 6875 6e6b 6060 2e20 5573 6564 2074  `chunk``. Used t
+0000a5a0: 6f20 646f 2074 6865 2066 696e 616c 2061  o do the final a
+0000a5b0: 6767 7265 6761 7469 6f6e 0a20 2020 2020  ggregation.     
+0000a5c0: 2020 2020 2020 2069 6e20 6120 7472 6565         in a tree
+0000a5d0: 2072 6564 7563 7469 6f6e 2e0a 0a20 2020   reduction...   
+0000a5e0: 2020 2020 2020 2020 2054 6865 2069 6e70           The inp
+0000a5f0: 7574 2074 6f20 6060 6167 6772 6567 6174  ut to ``aggregat
+0000a600: 6560 6020 6465 7065 6e64 7320 6f6e 2074  e`` depends on t
+0000a610: 6865 206f 7574 7075 7420 6f66 2060 6063  he output of ``c
+0000a620: 6875 6e6b 6060 2e0a 2020 2020 2020 2020  hunk``..        
+0000a630: 2020 2020 4966 2074 6865 206f 7574 7075      If the outpu
+0000a640: 7420 6f66 2060 6063 6875 6e6b 6060 2069  t of ``chunk`` i
+0000a650: 7320 613a 0a0a 2020 2020 2020 2020 2020  s a:..          
+0000a660: 2020 2d20 7363 616c 6172 3a20 496e 7075    - scalar: Inpu
+0000a670: 7420 6973 2061 2053 6572 6965 732c 2077  t is a Series, w
+0000a680: 6974 6820 6f6e 6520 726f 7720 7065 7220  ith one row per 
+0000a690: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
+0000a6a0: 2020 2020 2020 202d 2053 6572 6965 733a         - Series:
+0000a6b0: 2049 6e70 7574 2069 7320 6120 4461 7461   Input is a Data
+0000a6c0: 4672 616d 652c 2077 6974 6820 6f6e 6520  Frame, with one 
+0000a6d0: 726f 7720 7065 7220 7061 7274 6974 696f  row per partitio
+0000a6e0: 6e2e 2043 6f6c 756d 6e73 0a20 2020 2020  n. Columns.     
+0000a6f0: 2020 2020 2020 2020 2061 7265 2074 6865           are the
+0000a700: 2072 6f77 7320 696e 2074 6865 206f 7574   rows in the out
+0000a710: 7075 7420 7365 7269 6573 2e0a 2020 2020  put series..    
+0000a720: 2020 2020 2020 2020 2d20 4461 7461 4672          - DataFr
+0000a730: 616d 653a 2049 6e70 7574 2069 7320 6120  ame: Input is a 
+0000a740: 4461 7461 4672 616d 652c 2077 6974 6820  DataFrame, with 
+0000a750: 6f6e 6520 726f 7720 7065 7220 7061 7274  one row per part
+0000a760: 6974 696f 6e2e 0a20 2020 2020 2020 2020  ition..         
+0000a770: 2020 2020 2043 6f6c 756d 6e73 2061 7265       Columns are
+0000a780: 2074 6865 2063 6f6c 756d 6e73 2069 6e20   the columns in 
+0000a790: 7468 6520 6f75 7470 7574 2064 6174 6166  the output dataf
+0000a7a0: 7261 6d65 732e 0a0a 2020 2020 2020 2020  rames...        
+0000a7b0: 2020 2020 5368 6f75 6c64 2072 6574 7572      Should retur
+0000a7c0: 6e20 6120 6060 7061 6e64 6173 2e44 6174  n a ``pandas.Dat
+0000a7d0: 6146 7261 6d65 6060 2c20 6060 7061 6e64  aFrame``, ``pand
+0000a7e0: 6173 2e53 6572 6965 7360 602c 206f 7220  as.Series``, or 
+0000a7f0: 610a 2020 2020 2020 2020 2020 2020 7363  a.            sc
+0000a800: 616c 6172 2e0a 2020 2020 2020 2020 636f  alar..        co
+0000a810: 6d62 696e 6520 3a20 6361 6c6c 6162 6c65  mbine : callable
+0000a820: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0000a830: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
+0000a840: 746f 206f 7065 7261 7465 206f 6e20 696e  to operate on in
+0000a850: 7465 726d 6564 6961 7465 2063 6f6e 6361  termediate conca
+0000a860: 7465 6e61 7465 6420 7265 7375 6c74 7320  tenated results 
+0000a870: 6f66 0a20 2020 2020 2020 2020 2020 2060  of.            `
+0000a880: 6063 6875 6e6b 6060 2069 6e20 6120 7472  `chunk`` in a tr
+0000a890: 6565 2d72 6564 7563 7469 6f6e 2e20 4966  ee-reduction. If
+0000a8a0: 206e 6f74 2070 726f 7669 6465 642c 2064   not provided, d
+0000a8b0: 6566 6175 6c74 7320 746f 0a20 2020 2020  efaults to.     
+0000a8c0: 2020 2020 2020 2060 6061 6767 7265 6761         ``aggrega
+0000a8d0: 7465 6060 2e20 5468 6520 696e 7075 742f  te``. The input/
+0000a8e0: 6f75 7470 7574 2072 6571 7569 7265 6d65  output requireme
+0000a8f0: 6e74 7320 7368 6f75 6c64 206d 6174 6368  nts should match
+0000a900: 2074 6861 7420 6f66 0a20 2020 2020 2020   that of.       
+0000a910: 2020 2020 2060 6061 6767 7265 6761 7465       ``aggregate
+0000a920: 6060 2064 6573 6372 6962 6564 2061 626f  `` described abo
+0000a930: 7665 2e0a 2020 2020 2020 2020 244d 4554  ve..        $MET
+0000a940: 410a 2020 2020 2020 2020 746f 6b65 6e20  A.        token 
+0000a950: 3a20 7374 722c 206f 7074 696f 6e61 6c0a  : str, optional.
+0000a960: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+0000a970: 6e61 6d65 2074 6f20 7573 6520 666f 7220  name to use for 
+0000a980: 7468 6520 6f75 7470 7574 206b 6579 732e  the output keys.
+0000a990: 0a20 2020 2020 2020 2073 706c 6974 5f65  .        split_e
+0000a9a0: 7665 7279 203a 2069 6e74 2c20 6f70 7469  very : int, opti
+0000a9b0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+0000a9c0: 2047 726f 7570 2070 6172 7469 7469 6f6e   Group partition
+0000a9d0: 7320 696e 746f 2067 726f 7570 7320 6f66  s into groups of
+0000a9e0: 2074 6869 7320 7369 7a65 2077 6869 6c65   this size while
+0000a9f0: 2070 6572 666f 726d 696e 6720 610a 2020   performing a.  
+0000aa00: 2020 2020 2020 2020 2020 7472 6565 2d72            tree-r
+0000aa10: 6564 7563 7469 6f6e 2e20 4966 2073 6574  eduction. If set
+0000aa20: 2074 6f20 4661 6c73 652c 206e 6f20 7472   to False, no tr
+0000aa30: 6565 2d72 6564 7563 7469 6f6e 2077 696c  ee-reduction wil
+0000aa40: 6c20 6265 2075 7365 642c 0a20 2020 2020  l be used,.     
+0000aa50: 2020 2020 2020 2061 6e64 2061 6c6c 2069         and all i
+0000aa60: 6e74 6572 6d65 6469 6174 6573 2077 696c  ntermediates wil
+0000aa70: 6c20 6265 2063 6f6e 6361 7465 6e61 7465  l be concatenate
+0000aa80: 6420 616e 6420 7061 7373 6564 2074 6f0a  d and passed to.
+0000aa90: 2020 2020 2020 2020 2020 2020 6060 6167              ``ag
+0000aaa0: 6772 6567 6174 6560 602e 2044 6566 6175  gregate``. Defau
+0000aab0: 6c74 2069 7320 382e 0a20 2020 2020 2020  lt is 8..       
+0000aac0: 2063 6875 6e6b 5f6b 7761 7267 7320 3a20   chunk_kwargs : 
+0000aad0: 6469 6374 2c20 6f70 7469 6f6e 616c 0a20  dict, optional. 
+0000aae0: 2020 2020 2020 2020 2020 204b 6579 776f             Keywo
+0000aaf0: 7264 2061 7267 756d 656e 7473 2074 6f20  rd arguments to 
+0000ab00: 7061 7373 206f 6e20 746f 2060 6063 6875  pass on to ``chu
+0000ab10: 6e6b 6060 206f 6e6c 792e 0a20 2020 2020  nk`` only..     
+0000ab20: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
+0000ab30: 7267 7320 3a20 6469 6374 2c20 6f70 7469  rgs : dict, opti
+0000ab40: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+0000ab50: 204b 6579 776f 7264 2061 7267 756d 656e   Keyword argumen
+0000ab60: 7473 2074 6f20 7061 7373 206f 6e20 746f  ts to pass on to
+0000ab70: 2060 6061 6767 7265 6761 7465 6060 206f   ``aggregate`` o
+0000ab80: 6e6c 792e 0a20 2020 2020 2020 2063 6f6d  nly..        com
+0000ab90: 6269 6e65 5f6b 7761 7267 7320 3a20 6469  bine_kwargs : di
+0000aba0: 6374 2c20 6f70 7469 6f6e 616c 0a20 2020  ct, optional.   
+0000abb0: 2020 2020 2020 2020 204b 6579 776f 7264           Keyword
+0000abc0: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
+0000abd0: 7373 206f 6e20 746f 2060 6063 6f6d 6269  ss on to ``combi
+0000abe0: 6e65 6060 206f 6e6c 792e 0a20 2020 2020  ne`` only..     
+0000abf0: 2020 206b 7761 7267 7320 3a0a 2020 2020     kwargs :.    
+0000ac00: 2020 2020 2020 2020 416c 6c20 7265 6d61          All rema
+0000ac10: 696e 696e 6720 6b65 7977 6f72 6473 2077  ining keywords w
+0000ac20: 696c 6c20 6265 2070 6173 7365 6420 746f  ill be passed to
+0000ac30: 2060 6063 6875 6e6b 6060 2c20 6060 636f   ``chunk``, ``co
+0000ac40: 6d62 696e 6560 602c 0a20 2020 2020 2020  mbine``,.       
+0000ac50: 2020 2020 2061 6e64 2060 6061 6767 7265       and ``aggre
+0000ac60: 6761 7465 6060 2e0a 0a20 2020 2020 2020  gate``...       
+0000ac70: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
+0000ac80: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+0000ac90: 2020 203e 3e3e 2069 6d70 6f72 7420 7061     >>> import pa
+0000aca0: 6e64 6173 2061 7320 7064 0a20 2020 2020  ndas as pd.     
+0000acb0: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+0000acc0: 736b 2e64 6174 6166 7261 6d65 2061 7320  sk.dataframe as 
+0000acd0: 6464 0a20 2020 2020 2020 203e 3e3e 2064  dd.        >>> d
+0000ace0: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
+0000acf0: 287b 2778 273a 2072 616e 6765 2835 3029  ({'x': range(50)
+0000ad00: 2c20 2779 273a 2072 616e 6765 2835 302c  , 'y': range(50,
+0000ad10: 2031 3030 297d 290a 2020 2020 2020 2020   100)}).        
+0000ad20: 3e3e 3e20 6464 6620 3d20 6464 2e66 726f  >>> ddf = dd.fro
+0000ad30: 6d5f 7061 6e64 6173 2864 662c 206e 7061  m_pandas(df, npa
+0000ad40: 7274 6974 696f 6e73 3d34 290a 0a20 2020  rtitions=4)..   
+0000ad50: 2020 2020 2043 6f75 6e74 2074 6865 206e       Count the n
+0000ad60: 756d 6265 7220 6f66 2072 6f77 7320 696e  umber of rows in
+0000ad70: 2061 2044 6174 6146 7261 6d65 2e20 546f   a DataFrame. To
+0000ad80: 2064 6f20 7468 6973 2c20 636f 756e 7420   do this, count 
+0000ad90: 7468 6520 6e75 6d62 6572 0a20 2020 2020  the number.     
+0000ada0: 2020 206f 6620 726f 7773 2069 6e20 6561     of rows in ea
+0000adb0: 6368 2070 6172 7469 7469 6f6e 2c20 7468  ch partition, th
+0000adc0: 656e 2073 756d 2074 6865 2072 6573 756c  en sum the resul
+0000add0: 7473 3a0a 0a20 2020 2020 2020 203e 3e3e  ts:..        >>>
+0000ade0: 2072 6573 203d 2064 6466 2e72 6564 7563   res = ddf.reduc
+0000adf0: 7469 6f6e 286c 616d 6264 6120 783a 2078  tion(lambda x: x
+0000ae00: 2e63 6f75 6e74 2829 2c0a 2020 2020 2020  .count(),.      
+0000ae10: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+0000ae20: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
+0000ae30: 6174 653d 6c61 6d62 6461 2078 3a20 782e  ate=lambda x: x.
+0000ae40: 7375 6d28 2929 0a20 2020 2020 2020 203e  sum()).        >
+0000ae50: 3e3e 2072 6573 2e63 6f6d 7075 7465 2829  >> res.compute()
+0000ae60: 0a20 2020 2020 2020 2078 2020 2020 3530  .        x    50
+0000ae70: 0a20 2020 2020 2020 2079 2020 2020 3530  .        y    50
+0000ae80: 0a20 2020 2020 2020 2064 7479 7065 3a20  .        dtype: 
+0000ae90: 696e 7436 340a 0a20 2020 2020 2020 2043  int64..        C
+0000aea0: 6f75 6e74 2074 6865 206e 756d 6265 7220  ount the number 
+0000aeb0: 6f66 2072 6f77 7320 696e 2061 2053 6572  of rows in a Ser
+0000aec0: 6965 7320 7769 7468 2065 6c65 6d65 6e74  ies with element
+0000aed0: 7320 6772 6561 7465 7220 7468 616e 206f  s greater than o
+0000aee0: 720a 2020 2020 2020 2020 6571 7561 6c20  r.        equal 
+0000aef0: 746f 2061 2076 616c 7565 2028 7072 6f76  to a value (prov
+0000af00: 6964 6564 2076 6961 2061 206b 6579 776f  ided via a keywo
+0000af10: 7264 292e 0a0a 2020 2020 2020 2020 3e3e  rd)...        >>
+0000af20: 3e20 6465 6620 636f 756e 745f 6772 6561  > def count_grea
+0000af30: 7465 7228 782c 2076 616c 7565 3d30 293a  ter(x, value=0):
+0000af40: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0000af50: 2072 6574 7572 6e20 2878 203e 3d20 7661   return (x >= va
+0000af60: 6c75 6529 2e73 756d 2829 0a20 2020 2020  lue).sum().     
+0000af70: 2020 203e 3e3e 2072 6573 203d 2064 6466     >>> res = ddf
+0000af80: 2e78 2e72 6564 7563 7469 6f6e 2863 6f75  .x.reduction(cou
+0000af90: 6e74 5f67 7265 6174 6572 2c20 6167 6772  nt_greater, aggr
+0000afa0: 6567 6174 653d 6c61 6d62 6461 2078 3a20  egate=lambda x: 
+0000afb0: 782e 7375 6d28 292c 0a20 2020 2020 2020  x.sum(),.       
+0000afc0: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
+0000afd0: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+0000afe0: 5f6b 7761 7267 733d 7b27 7661 6c75 6527  _kwargs={'value'
+0000aff0: 3a20 3235 7d29 0a20 2020 2020 2020 203e  : 25}).        >
+0000b000: 3e3e 2072 6573 2e63 6f6d 7075 7465 2829  >> res.compute()
+0000b010: 0a20 2020 2020 2020 2032 350a 0a20 2020  .        25..   
+0000b020: 2020 2020 2041 6767 7265 6761 7465 2062       Aggregate b
+0000b030: 6f74 6820 7468 6520 7375 6d20 616e 6420  oth the sum and 
+0000b040: 636f 756e 7420 6f66 2061 2053 6572 6965  count of a Serie
+0000b050: 7320 6174 2074 6865 2073 616d 6520 7469  s at the same ti
+0000b060: 6d65 3a0a 0a20 2020 2020 2020 203e 3e3e  me:..        >>>
+0000b070: 2064 6566 2073 756d 5f61 6e64 5f63 6f75   def sum_and_cou
+0000b080: 6e74 2878 293a 0a20 2020 2020 2020 202e  nt(x):.        .
+0000b090: 2e2e 2020 2020 2072 6574 7572 6e20 7064  ..     return pd
+0000b0a0: 2e53 6572 6965 7328 7b27 636f 756e 7427  .Series({'count'
+0000b0b0: 3a20 782e 636f 756e 7428 292c 2027 7375  : x.count(), 'su
+0000b0c0: 6d27 3a20 782e 7375 6d28 297d 2c0a 2020  m': x.sum()},.  
+0000b0d0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+0000b0e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000b0f0: 6e64 6578 3d5b 2763 6f75 6e74 272c 2027  ndex=['count', '
+0000b100: 7375 6d27 5d29 0a20 2020 2020 2020 203e  sum']).        >
+0000b110: 3e3e 2072 6573 203d 2064 6466 2e78 2e72  >> res = ddf.x.r
+0000b120: 6564 7563 7469 6f6e 2873 756d 5f61 6e64  eduction(sum_and
+0000b130: 5f63 6f75 6e74 2c20 6167 6772 6567 6174  _count, aggregat
+0000b140: 653d 6c61 6d62 6461 2078 3a20 782e 7375  e=lambda x: x.su
+0000b150: 6d28 2929 0a20 2020 2020 2020 203e 3e3e  m()).        >>>
+0000b160: 2072 6573 2e63 6f6d 7075 7465 2829 0a20   res.compute(). 
+0000b170: 2020 2020 2020 2063 6f75 6e74 2020 2020         count    
+0000b180: 2020 3530 0a20 2020 2020 2020 2073 756d    50.        sum
+0000b190: 2020 2020 2020 3132 3235 0a20 2020 2020        1225.     
+0000b1a0: 2020 2064 7479 7065 3a20 696e 7436 340a     dtype: int64.
+0000b1b0: 0a20 2020 2020 2020 2044 6f69 6e67 2074  .        Doing t
+0000b1c0: 6865 2073 616d 652c 2062 7574 2066 6f72  he same, but for
+0000b1d0: 2061 2044 6174 6146 7261 6d65 2e20 4865   a DataFrame. He
+0000b1e0: 7265 2060 6063 6875 6e6b 6060 2072 6574  re ``chunk`` ret
+0000b1f0: 7572 6e73 2061 0a20 2020 2020 2020 2044  urns a.        D
+0000b200: 6174 6146 7261 6d65 2c20 6d65 616e 696e  ataFrame, meanin
+0000b210: 6720 7468 6520 696e 7075 7420 746f 2060  g the input to `
+0000b220: 6061 6767 7265 6761 7465 6060 2069 7320  `aggregate`` is 
+0000b230: 6120 4461 7461 4672 616d 6520 7769 7468  a DataFrame with
+0000b240: 2061 6e0a 2020 2020 2020 2020 696e 6465   an.        inde
+0000b250: 7820 7769 7468 206e 6f6e 2d75 6e69 7175  x with non-uniqu
+0000b260: 6520 656e 7472 6965 7320 666f 7220 626f  e entries for bo
+0000b270: 7468 2027 7827 2061 6e64 2027 7927 2e20  th 'x' and 'y'. 
+0000b280: 5765 2067 726f 7570 6279 2074 6865 0a20  We groupby the. 
+0000b290: 2020 2020 2020 2069 6e64 6578 2c20 616e         index, an
+0000b2a0: 6420 7375 6d20 6561 6368 2067 726f 7570  d sum each group
+0000b2b0: 2074 6f20 6765 7420 7468 6520 6669 6e61   to get the fina
+0000b2c0: 6c20 7265 7375 6c74 2e0a 0a20 2020 2020  l result...     
+0000b2d0: 2020 203e 3e3e 2064 6566 2073 756d 5f61     >>> def sum_a
+0000b2e0: 6e64 5f63 6f75 6e74 2878 293a 0a20 2020  nd_count(x):.   
+0000b2f0: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
+0000b300: 7572 6e20 7064 2e44 6174 6146 7261 6d65  urn pd.DataFrame
+0000b310: 287b 2763 6f75 6e74 273a 2078 2e63 6f75  ({'count': x.cou
+0000b320: 6e74 2829 2c20 2773 756d 273a 2078 2e73  nt(), 'sum': x.s
+0000b330: 756d 2829 7d2c 0a20 2020 2020 2020 202e  um()},.        .
+0000b340: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+0000b350: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+0000b360: 6e73 3d5b 2763 6f75 6e74 272c 2027 7375  ns=['count', 'su
+0000b370: 6d27 5d29 0a20 2020 2020 2020 203e 3e3e  m']).        >>>
+0000b380: 2072 6573 203d 2064 6466 2e72 6564 7563   res = ddf.reduc
+0000b390: 7469 6f6e 2873 756d 5f61 6e64 5f63 6f75  tion(sum_and_cou
+0000b3a0: 6e74 2c0a 2020 2020 2020 2020 2e2e 2e20  nt,.        ... 
+0000b3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b3c0: 2020 2020 6167 6772 6567 6174 653d 6c61      aggregate=la
+0000b3d0: 6d62 6461 2078 3a20 782e 6772 6f75 7062  mbda x: x.groupb
+0000b3e0: 7928 6c65 7665 6c3d 3029 2e73 756d 2829  y(level=0).sum()
+0000b3f0: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
+0000b400: 732e 636f 6d70 7574 6528 290a 2020 2020  s.compute().    
+0000b410: 2020 2020 2020 2063 6f75 6e74 2020 2073         count   s
+0000b420: 756d 0a20 2020 2020 2020 2078 2020 2020  um.        x    
+0000b430: 2035 3020 2031 3232 350a 2020 2020 2020   50  1225.      
+0000b440: 2020 7920 2020 2020 3530 2020 3337 3235    y     50  3725
+0000b450: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000b460: 2020 2020 2069 6620 6167 6772 6567 6174       if aggregat
+0000b470: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
+0000b480: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
+0000b490: 203d 2063 6875 6e6b 0a0a 2020 2020 2020   = chunk..      
+0000b4a0: 2020 6966 2063 6f6d 6269 6e65 2069 7320    if combine is 
+0000b4b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000b4c0: 2020 6966 2063 6f6d 6269 6e65 5f6b 7761    if combine_kwa
+0000b4d0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+0000b4e0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000b4f0: 4572 726f 7228 2260 636f 6d62 696e 655f  Error("`combine_
+0000b500: 6b77 6172 6773 6020 7072 6f76 6964 6564  kwargs` provided
+0000b510: 2077 6974 6820 6e6f 2060 636f 6d62 696e   with no `combin
+0000b520: 6560 2229 0a20 2020 2020 2020 2020 2020  e`").           
+0000b530: 2063 6f6d 6269 6e65 203d 2061 6767 7265   combine = aggre
+0000b540: 6761 7465 0a20 2020 2020 2020 2020 2020  gate.           
+0000b550: 2063 6f6d 6269 6e65 5f6b 7761 7267 7320   combine_kwargs 
+0000b560: 3d20 6167 6772 6567 6174 655f 6b77 6172  = aggregate_kwar
+0000b570: 6773 0a0a 2020 2020 2020 2020 6368 756e  gs..        chun
+0000b580: 6b5f 6b77 6172 6773 203d 2063 6875 6e6b  k_kwargs = chunk
+0000b590: 5f6b 7761 7267 732e 636f 7079 2829 2069  _kwargs.copy() i
+0000b5a0: 6620 6368 756e 6b5f 6b77 6172 6773 2065  f chunk_kwargs e
+0000b5b0: 6c73 6520 7b7d 0a20 2020 2020 2020 2063  lse {}.        c
+0000b5c0: 6875 6e6b 5f6b 7761 7267 735b 2261 6361  hunk_kwargs["aca
+0000b5d0: 5f63 6875 6e6b 225d 203d 2063 6875 6e6b  _chunk"] = chunk
+0000b5e0: 0a0a 2020 2020 2020 2020 636f 6d62 696e  ..        combin
+0000b5f0: 655f 6b77 6172 6773 203d 2063 6f6d 6269  e_kwargs = combi
+0000b600: 6e65 5f6b 7761 7267 732e 636f 7079 2829  ne_kwargs.copy()
+0000b610: 2069 6620 636f 6d62 696e 655f 6b77 6172   if combine_kwar
+0000b620: 6773 2065 6c73 6520 7b7d 0a20 2020 2020  gs else {}.     
+0000b630: 2020 2063 6f6d 6269 6e65 5f6b 7761 7267     combine_kwarg
+0000b640: 735b 2261 6361 5f63 6f6d 6269 6e65 225d  s["aca_combine"]
+0000b650: 203d 2063 6f6d 6269 6e65 0a0a 2020 2020   = combine..    
+0000b660: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
+0000b670: 6172 6773 203d 2061 6767 7265 6761 7465  args = aggregate
+0000b680: 5f6b 7761 7267 732e 636f 7079 2829 2069  _kwargs.copy() i
+0000b690: 6620 6167 6772 6567 6174 655f 6b77 6172  f aggregate_kwar
+0000b6a0: 6773 2065 6c73 6520 7b7d 0a20 2020 2020  gs else {}.     
+0000b6b0: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
+0000b6c0: 7267 735b 2261 6361 5f61 6767 7265 6761  rgs["aca_aggrega
+0000b6d0: 7465 225d 203d 2061 6767 7265 6761 7465  te"] = aggregate
+0000b6e0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000b6f0: 2061 6361 280a 2020 2020 2020 2020 2020   aca(.          
+0000b700: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0000b710: 2020 2020 6368 756e 6b3d 5f72 6564 7563      chunk=_reduc
+0000b720: 7469 6f6e 5f63 6875 6e6b 2c0a 2020 2020  tion_chunk,.    
+0000b730: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+0000b740: 653d 5f72 6564 7563 7469 6f6e 5f61 6767  e=_reduction_agg
+0000b750: 7265 6761 7465 2c0a 2020 2020 2020 2020  regate,.        
+0000b760: 2020 2020 636f 6d62 696e 653d 5f72 6564      combine=_red
+0000b770: 7563 7469 6f6e 5f63 6f6d 6269 6e65 2c0a  uction_combine,.
+0000b780: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+0000b790: 3d6d 6574 612c 0a20 2020 2020 2020 2020  =meta,.         
+0000b7a0: 2020 2074 6f6b 656e 3d74 6f6b 656e 2c0a     token=token,.
+0000b7b0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+0000b7c0: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+0000b7d0: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+0000b7e0: 2063 6875 6e6b 5f6b 7761 7267 733d 6368   chunk_kwargs=ch
+0000b7f0: 756e 6b5f 6b77 6172 6773 2c0a 2020 2020  unk_kwargs,.    
+0000b800: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+0000b810: 655f 6b77 6172 6773 3d61 6767 7265 6761  e_kwargs=aggrega
+0000b820: 7465 5f6b 7761 7267 732c 0a20 2020 2020  te_kwargs,.     
+0000b830: 2020 2020 2020 2063 6f6d 6269 6e65 5f6b         combine_k
+0000b840: 7761 7267 733d 636f 6d62 696e 655f 6b77  wargs=combine_kw
+0000b850: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
+0000b860: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
+0000b870: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
+0000b880: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0000b890: 4672 616d 6529 0a20 2020 2064 6566 2070  Frame).    def p
+0000b8a0: 6970 6528 7365 6c66 2c20 6675 6e63 2c20  ipe(self, func, 
+0000b8b0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+0000b8c0: 3a0a 2020 2020 2020 2020 2320 5461 6b65  :.        # Take
+0000b8d0: 6e20 6672 6f6d 2070 616e 6461 733a 0a20  n from pandas:. 
+0000b8e0: 2020 2020 2020 2023 2068 7474 7073 3a2f         # https:/
+0000b8f0: 2f67 6974 6875 622e 636f 6d2f 7079 6461  /github.com/pyda
+0000b900: 7461 2f70 616e 6461 732f 626c 6f62 2f6d  ta/pandas/blob/m
+0000b910: 6173 7465 722f 7061 6e64 6173 2f63 6f72  aster/pandas/cor
+0000b920: 652f 6765 6e65 7269 632e 7079 234c 3236  e/generic.py#L26
+0000b930: 3938 2d4c 3237 3037 0a20 2020 2020 2020  98-L2707.       
+0000b940: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
+0000b950: 756e 632c 2074 7570 6c65 293a 0a20 2020  unc, tuple):.   
+0000b960: 2020 2020 2020 2020 2066 756e 632c 2074           func, t
+0000b970: 6172 6765 7420 3d20 6675 6e63 0a20 2020  arget = func.   
+0000b980: 2020 2020 2020 2020 2069 6620 7461 7267           if targ
+0000b990: 6574 2069 6e20 6b77 6172 6773 3a0a 2020  et in kwargs:.  
+0000b9a0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0000b9b0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+0000b9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b9d0: 2020 2020 2225 7320 6973 2062 6f74 6820      "%s is both 
+0000b9e0: 7468 6520 7069 7065 2074 6172 6765 7420  the pipe target 
+0000b9f0: 616e 6420 6120 6b65 7977 6f72 6420 6172  and a keyword ar
+0000ba00: 6775 6d65 6e74 2220 2520 7461 7267 6574  gument" % target
+0000ba10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ba20: 2029 0a20 2020 2020 2020 2020 2020 206b   ).            k
+0000ba30: 7761 7267 735b 7461 7267 6574 5d20 3d20  wargs[target] = 
+0000ba40: 7365 6c66 0a20 2020 2020 2020 2020 2020  self.           
+0000ba50: 2072 6574 7572 6e20 6675 6e63 282a 6172   return func(*ar
+0000ba60: 6773 2c20 2a2a 6b77 6172 6773 290a 2020  gs, **kwargs).  
+0000ba70: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000ba80: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+0000ba90: 756e 6328 7365 6c66 2c20 2a61 7267 732c  unc(self, *args,
+0000baa0: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
+0000bab0: 6465 6620 7261 6e64 6f6d 5f73 706c 6974  def random_split
+0000bac0: 2873 656c 662c 2066 7261 632c 2072 616e  (self, frac, ran
+0000bad0: 646f 6d5f 7374 6174 653d 4e6f 6e65 2c20  dom_state=None, 
+0000bae0: 7368 7566 666c 653d 4661 6c73 6529 3a0a  shuffle=False):.
+0000baf0: 2020 2020 2020 2020 2222 2250 7365 7564          """Pseud
+0000bb00: 6f72 616e 646f 6d6c 7920 7370 6c69 7420  orandomly split 
+0000bb10: 6461 7461 6672 616d 6520 696e 746f 2064  dataframe into d
+0000bb20: 6966 6665 7265 6e74 2070 6965 6365 7320  ifferent pieces 
+0000bb30: 726f 772d 7769 7365 0a0a 2020 2020 2020  row-wise..      
+0000bb40: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0000bb50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+0000bb60: 2020 2020 2020 2020 6672 6163 203a 206c          frac : l
+0000bb70: 6973 740a 2020 2020 2020 2020 2020 2020  ist.            
+0000bb80: 4c69 7374 206f 6620 666c 6f61 7473 2074  List of floats t
+0000bb90: 6861 7420 7368 6f75 6c64 2073 756d 2074  hat should sum t
+0000bba0: 6f20 6f6e 652e 0a20 2020 2020 2020 2072  o one..        r
+0000bbb0: 616e 646f 6d5f 7374 6174 6520 3a20 696e  andom_state : in
+0000bbc0: 7420 6f72 206e 702e 7261 6e64 6f6d 2e52  t or np.random.R
+0000bbd0: 616e 646f 6d53 7461 7465 0a20 2020 2020  andomState.     
+0000bbe0: 2020 2020 2020 2049 6620 696e 7420 6372         If int cr
+0000bbf0: 6561 7465 2061 206e 6577 2052 616e 646f  eate a new Rando
+0000bc00: 6d53 7461 7465 2077 6974 6820 7468 6973  mState with this
+0000bc10: 2061 7320 7468 6520 7365 6564 2e0a 2020   as the seed..  
+0000bc20: 2020 2020 2020 2020 2020 4f74 6865 7277            Otherw
+0000bc30: 6973 6520 6472 6177 2066 726f 6d20 7468  ise draw from th
+0000bc40: 6520 7061 7373 6564 2052 616e 646f 6d53  e passed RandomS
+0000bc50: 7461 7465 2e0a 2020 2020 2020 2020 7368  tate..        sh
+0000bc60: 7566 666c 6520 3a20 626f 6f6c 2c20 6465  uffle : bool, de
+0000bc70: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
+0000bc80: 2020 2020 2020 2020 4966 2073 6574 2074          If set t
+0000bc90: 6f20 5472 7565 2c20 7468 6520 6461 7461  o True, the data
+0000bca0: 6672 616d 6520 6973 2073 6875 6666 6c65  frame is shuffle
+0000bcb0: 6420 2877 6974 6869 6e20 7061 7274 6974  d (within partit
+0000bcc0: 696f 6e29 0a20 2020 2020 2020 2020 2020  ion).           
+0000bcd0: 2062 6566 6f72 6520 7468 6520 7370 6c69   before the spli
+0000bce0: 742e 0a0a 2020 2020 2020 2020 4578 616d  t...        Exam
+0000bcf0: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
+0000bd00: 2d2d 2d2d 2d0a 0a20 2020 2020 2020 2035  -----..        5
+0000bd10: 302f 3530 2073 706c 6974 0a0a 2020 2020  0/50 split..    
+0000bd20: 2020 2020 3e3e 3e20 612c 2062 203d 2064      >>> a, b = d
+0000bd30: 662e 7261 6e64 6f6d 5f73 706c 6974 285b  f.random_split([
+0000bd40: 302e 352c 2030 2e35 5d29 2020 2320 646f  0.5, 0.5])  # do
+0000bd50: 6374 6573 743a 202b 534b 4950 0a0a 2020  ctest: +SKIP..  
+0000bd60: 2020 2020 2020 3830 2f31 302f 3130 2073        80/10/10 s
+0000bd70: 706c 6974 2c20 636f 6e73 6973 7465 6e74  plit, consistent
+0000bd80: 2072 616e 646f 6d5f 7374 6174 650a 0a20   random_state.. 
+0000bd90: 2020 2020 2020 203e 3e3e 2061 2c20 622c         >>> a, b,
+0000bda0: 2063 203d 2064 662e 7261 6e64 6f6d 5f73   c = df.random_s
+0000bdb0: 706c 6974 285b 302e 382c 2030 2e31 2c20  plit([0.8, 0.1, 
+0000bdc0: 302e 315d 2c20 7261 6e64 6f6d 5f73 7461  0.1], random_sta
+0000bdd0: 7465 3d31 3233 2920 2023 2064 6f63 7465  te=123)  # docte
+0000bde0: 7374 3a20 2b53 4b49 500a 0a20 2020 2020  st: +SKIP..     
+0000bdf0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+0000be00: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+0000be10: 2020 2020 2064 6173 6b2e 4461 7461 4672       dask.DataFr
+0000be20: 616d 652e 7361 6d70 6c65 0a20 2020 2020  ame.sample.     
+0000be30: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0000be40: 6620 6e6f 7420 6e70 2e61 6c6c 636c 6f73  f not np.allclos
+0000be50: 6528 7375 6d28 6672 6163 292c 2031 293a  e(sum(frac), 1):
+0000be60: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000be70: 7365 2056 616c 7565 4572 726f 7228 2266  se ValueError("f
+0000be80: 7261 6320 7368 6f75 6c64 2073 756d 2074  rac should sum t
+0000be90: 6f20 3122 290a 2020 2020 2020 2020 7374  o 1").        st
+0000bea0: 6174 655f 6461 7461 203d 2072 616e 646f  ate_data = rando
+0000beb0: 6d5f 7374 6174 655f 6461 7461 2873 656c  m_state_data(sel
+0000bec0: 662e 6e70 6172 7469 7469 6f6e 732c 2072  f.npartitions, r
+0000bed0: 616e 646f 6d5f 7374 6174 6529 0a20 2020  andom_state).   
+0000bee0: 2020 2020 2074 6f6b 656e 203d 2074 6f6b       token = tok
+0000bef0: 656e 697a 6528 7365 6c66 2c20 6672 6163  enize(self, frac
+0000bf00: 2c20 7261 6e64 6f6d 5f73 7461 7465 290a  , random_state).
+0000bf10: 2020 2020 2020 2020 6e61 6d65 203d 2022          name = "
+0000bf20: 7370 6c69 742d 2220 2b20 746f 6b65 6e0a  split-" + token.
+0000bf30: 2020 2020 2020 2020 6c61 7965 7220 3d20          layer = 
+0000bf40: 7b0a 2020 2020 2020 2020 2020 2020 286e  {.            (n
+0000bf50: 616d 652c 2069 293a 2028 7064 5f73 706c  ame, i): (pd_spl
+0000bf60: 6974 2c20 2873 656c 662e 5f6e 616d 652c  it, (self._name,
+0000bf70: 2069 292c 2066 7261 632c 2073 7461 7465   i), frac, state
+0000bf80: 2c20 7368 7566 666c 6529 0a20 2020 2020  , shuffle).     
+0000bf90: 2020 2020 2020 2066 6f72 2069 2c20 7374         for i, st
+0000bfa0: 6174 6520 696e 2065 6e75 6d65 7261 7465  ate in enumerate
+0000bfb0: 2873 7461 7465 5f64 6174 6129 0a20 2020  (state_data).   
+0000bfc0: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
+0000bfd0: 6f75 7420 3d20 5b5d 0a20 2020 2020 2020  out = [].       
+0000bfe0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0000bff0: 6c65 6e28 6672 6163 2929 3a0a 2020 2020  len(frac)):.    
+0000c000: 2020 2020 2020 2020 6e61 6d65 3220 3d20          name2 = 
+0000c010: 2273 706c 6974 2d25 642d 2573 2220 2520  "split-%d-%s" % 
+0000c020: 2869 2c20 746f 6b65 6e29 0a20 2020 2020  (i, token).     
+0000c030: 2020 2020 2020 2064 736b 3220 3d20 7b0a         dsk2 = {.
+0000c040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c050: 286e 616d 6532 2c20 6a29 3a20 2867 6574  (name2, j): (get
+0000c060: 6974 656d 2c20 286e 616d 652c 206a 292c  item, (name, j),
+0000c070: 2069 2920 666f 7220 6a20 696e 2072 616e   i) for j in ran
+0000c080: 6765 2873 656c 662e 6e70 6172 7469 7469  ge(self.npartiti
+0000c090: 6f6e 7329 0a20 2020 2020 2020 2020 2020  ons).           
+0000c0a0: 207d 0a20 2020 2020 2020 2020 2020 2067   }.            g
+0000c0b0: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
+0000c0c0: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+0000c0d0: 6374 696f 6e73 280a 2020 2020 2020 2020  ctions(.        
+0000c0e0: 2020 2020 2020 2020 6e61 6d65 322c 206d          name2, m
+0000c0f0: 6572 6765 2864 736b 322c 206c 6179 6572  erge(dsk2, layer
+0000c100: 292c 2064 6570 656e 6465 6e63 6965 733d  ), dependencies=
+0000c110: 5b73 656c 665d 0a20 2020 2020 2020 2020  [self].         
+0000c120: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0000c130: 206f 7574 5f64 6620 3d20 7479 7065 2873   out_df = type(s
+0000c140: 656c 6629 2867 7261 7068 2c20 6e61 6d65  elf)(graph, name
+0000c150: 322c 2073 656c 662e 5f6d 6574 612c 2073  2, self._meta, s
+0000c160: 656c 662e 6469 7669 7369 6f6e 7329 0a20  elf.divisions). 
+0000c170: 2020 2020 2020 2020 2020 206f 7574 2e61             out.a
+0000c180: 7070 656e 6428 6f75 745f 6466 290a 2020  ppend(out_df).  
+0000c190: 2020 2020 2020 7265 7475 726e 206f 7574        return out
+0000c1a0: 0a0a 2020 2020 6465 6620 6865 6164 2873  ..    def head(s
+0000c1b0: 656c 662c 206e 3d35 2c20 6e70 6172 7469  elf, n=5, nparti
+0000c1c0: 7469 6f6e 733d 312c 2063 6f6d 7075 7465  tions=1, compute
+0000c1d0: 3d54 7275 6529 3a0a 2020 2020 2020 2020  =True):.        
+0000c1e0: 2222 2246 6972 7374 206e 2072 6f77 7320  """First n rows 
+0000c1f0: 6f66 2074 6865 2064 6174 6173 6574 0a0a  of the dataset..
+0000c200: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0000c210: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+0000c220: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6e20  -----.        n 
+0000c230: 3a20 696e 742c 206f 7074 696f 6e61 6c0a  : int, optional.
+0000c240: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+0000c250: 6e75 6d62 6572 206f 6620 726f 7773 2074  number of rows t
+0000c260: 6f20 7265 7475 726e 2e20 4465 6661 756c  o return. Defaul
+0000c270: 7420 6973 2035 2e0a 2020 2020 2020 2020  t is 5..        
+0000c280: 6e70 6172 7469 7469 6f6e 7320 3a20 696e  npartitions : in
+0000c290: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+0000c2a0: 2020 2020 2020 2020 456c 656d 656e 7473          Elements
+0000c2b0: 2061 7265 206f 6e6c 7920 7461 6b65 6e20   are only taken 
+0000c2c0: 6672 6f6d 2074 6865 2066 6972 7374 2060  from the first `
+0000c2d0: 606e 7061 7274 6974 696f 6e73 6060 2c20  `npartitions``, 
+0000c2e0: 7769 7468 2061 0a20 2020 2020 2020 2020  with a.         
+0000c2f0: 2020 2064 6566 6175 6c74 206f 6620 312e     default of 1.
+0000c300: 2049 6620 7468 6572 6520 6172 6520 6665   If there are fe
+0000c310: 7765 7220 7468 616e 2060 606e 6060 2072  wer than ``n`` r
+0000c320: 6f77 7320 696e 2074 6865 2066 6972 7374  ows in the first
+0000c330: 0a20 2020 2020 2020 2020 2020 2060 606e  .            ``n
+0000c340: 7061 7274 6974 696f 6e73 6060 2061 2077  partitions`` a w
+0000c350: 6172 6e69 6e67 2077 696c 6c20 6265 2072  arning will be r
+0000c360: 6169 7365 6420 616e 6420 616e 7920 666f  aised and any fo
+0000c370: 756e 6420 726f 7773 0a20 2020 2020 2020  und rows.       
+0000c380: 2020 2020 2072 6574 7572 6e65 642e 2050       returned. P
+0000c390: 6173 7320 2d31 2074 6f20 7573 6520 616c  ass -1 to use al
+0000c3a0: 6c20 7061 7274 6974 696f 6e73 2e0a 2020  l partitions..  
+0000c3b0: 2020 2020 2020 636f 6d70 7574 6520 3a20        compute : 
+0000c3c0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
+0000c3d0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
+0000c3e0: 6572 2074 6f20 636f 6d70 7574 6520 7468  er to compute th
+0000c3f0: 6520 7265 7375 6c74 2c20 6465 6661 756c  e result, defaul
+0000c400: 7420 6973 2054 7275 652e 0a20 2020 2020  t is True..     
+0000c410: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0000c420: 6620 6e70 6172 7469 7469 6f6e 7320 3c3d  f npartitions <=
+0000c430: 202d 313a 0a20 2020 2020 2020 2020 2020   -1:.           
+0000c440: 206e 7061 7274 6974 696f 6e73 203d 2073   npartitions = s
+0000c450: 656c 662e 6e70 6172 7469 7469 6f6e 730a  elf.npartitions.
+0000c460: 2020 2020 2020 2020 2320 4e6f 206e 6565          # No nee
+0000c470: 6420 746f 2077 6172 6e20 6966 2077 6527  d to warn if we'
+0000c480: 7265 2061 6c72 6561 6479 206c 6f6f 6b69  re already looki
+0000c490: 6e67 2061 7420 616c 6c20 7061 7274 6974  ng at all partit
+0000c4a0: 696f 6e73 0a20 2020 2020 2020 2073 6166  ions.        saf
+0000c4b0: 6520 3d20 6e70 6172 7469 7469 6f6e 7320  e = npartitions 
+0000c4c0: 213d 2073 656c 662e 6e70 6172 7469 7469  != self.npartiti
+0000c4d0: 6f6e 730a 2020 2020 2020 2020 7265 7475  ons.        retu
+0000c4e0: 726e 2073 656c 662e 5f68 6561 6428 6e3d  rn self._head(n=
+0000c4f0: 6e2c 206e 7061 7274 6974 696f 6e73 3d6e  n, npartitions=n
+0000c500: 7061 7274 6974 696f 6e73 2c20 636f 6d70  partitions, comp
+0000c510: 7574 653d 636f 6d70 7574 652c 2073 6166  ute=compute, saf
+0000c520: 653d 7361 6665 290a 0a20 2020 2064 6566  e=safe)..    def
+0000c530: 205f 6865 6164 2873 656c 662c 206e 2c20   _head(self, n, 
+0000c540: 6e70 6172 7469 7469 6f6e 732c 2063 6f6d  npartitions, com
+0000c550: 7075 7465 2c20 7361 6665 293a 0a20 2020  pute, safe):.   
 0000c560: 2020 2020 2069 6620 6e70 6172 7469 7469       if npartiti
-0000c570: 6f6e 7320 3e20 7365 6c66 2e6e 7061 7274  ons > self.npart
-0000c580: 6974 696f 6e73 3a0a 2020 2020 2020 2020  itions:.        
-0000c590: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0000c5a0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0000c5b0: 2020 2020 2020 6622 6f6e 6c79 207b 7365        f"only {se
-0000c5c0: 6c66 2e6e 7061 7274 6974 696f 6e73 7d20  lf.npartitions} 
-0000c5d0: 7061 7274 6974 696f 6e73 2c20 6865 6164  partitions, head
-0000c5e0: 2072 6563 6569 7665 6420 7b6e 7061 7274   received {npart
-0000c5f0: 6974 696f 6e73 7d22 0a20 2020 2020 2020  itions}".       
-0000c600: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0000c610: 6e61 6d65 203d 2066 2268 6561 642d 7b6e  name = f"head-{n
-0000c620: 7061 7274 6974 696f 6e73 7d2d 7b6e 7d2d  partitions}-{n}-
-0000c630: 7b73 656c 662e 5f6e 616d 657d 220a 2020  {self._name}".  
-0000c640: 2020 2020 2020 6966 2073 6166 653a 0a20        if safe:. 
-0000c650: 2020 2020 2020 2020 2020 2068 6561 6420             head 
-0000c660: 3d20 7361 6665 5f68 6561 640a 2020 2020  = safe_head.    
-0000c670: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000c680: 2020 2020 2020 6865 6164 203d 204d 2e68        head = M.h
-0000c690: 6561 640a 0a20 2020 2020 2020 2069 6620  ead..        if 
-0000c6a0: 6e70 6172 7469 7469 6f6e 7320 3e20 313a  npartitions > 1:
-0000c6b0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-0000c6c0: 655f 7020 3d20 6622 6865 6164 2d70 6172  e_p = f"head-par
-0000c6d0: 7469 616c 2d7b 6e7d 2d7b 7365 6c66 2e5f  tial-{n}-{self._
-0000c6e0: 6e61 6d65 7d22 0a0a 2020 2020 2020 2020  name}"..        
-0000c6f0: 2020 2020 6473 6b20 3d20 7b7d 0a20 2020      dsk = {}.   
-0000c700: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-0000c710: 6e20 7261 6e67 6528 6e70 6172 7469 7469  n range(npartiti
-0000c720: 6f6e 7329 3a0a 2020 2020 2020 2020 2020  ons):.          
-0000c730: 2020 2020 2020 6473 6b5b 286e 616d 655f        dsk[(name_
-0000c740: 702c 2069 295d 203d 2028 4d2e 6865 6164  p, i)] = (M.head
-0000c750: 2c20 2873 656c 662e 5f6e 616d 652c 2069  , (self._name, i
-0000c760: 292c 206e 290a 0a20 2020 2020 2020 2020  ), n)..         
-0000c770: 2020 2063 6f6e 6361 7420 3d20 285f 636f     concat = (_co
-0000c780: 6e63 6174 2c20 5b28 6e61 6d65 5f70 2c20  ncat, [(name_p, 
-0000c790: 6929 2066 6f72 2069 2069 6e20 7261 6e67  i) for i in rang
-0000c7a0: 6528 6e70 6172 7469 7469 6f6e 7329 5d29  e(npartitions)])
-0000c7b0: 0a20 2020 2020 2020 2020 2020 2064 736b  .            dsk
-0000c7c0: 5b28 6e61 6d65 2c20 3029 5d20 3d20 2868  [(name, 0)] = (h
-0000c7d0: 6561 642c 2063 6f6e 6361 742c 206e 290a  ead, concat, n).
-0000c7e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000c7f0: 2020 2020 2020 2020 2020 6473 6b20 3d20            dsk = 
-0000c800: 7b28 6e61 6d65 2c20 3029 3a20 2868 6561  {(name, 0): (hea
-0000c810: 642c 2028 7365 6c66 2e5f 6e61 6d65 2c20  d, (self._name, 
-0000c820: 3029 2c20 6e29 7d0a 0a20 2020 2020 2020  0), n)}..       
-0000c830: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-0000c840: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-0000c850: 6c65 6374 696f 6e73 286e 616d 652c 2064  lections(name, d
-0000c860: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
-0000c870: 3d5b 7365 6c66 5d29 0a20 2020 2020 2020  =[self]).       
-0000c880: 2072 6573 756c 7420 3d20 6e65 775f 6464   result = new_dd
-0000c890: 5f6f 626a 6563 7428 0a20 2020 2020 2020  _object(.       
-0000c8a0: 2020 2020 2067 7261 7068 2c20 6e61 6d65       graph, name
-0000c8b0: 2c20 7365 6c66 2e5f 6d65 7461 2c20 5b73  , self._meta, [s
-0000c8c0: 656c 662e 6469 7669 7369 6f6e 735b 305d  elf.divisions[0]
-0000c8d0: 2c20 7365 6c66 2e64 6976 6973 696f 6e73  , self.divisions
-0000c8e0: 5b6e 7061 7274 6974 696f 6e73 5d5d 0a20  [npartitions]]. 
-0000c8f0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0000c900: 2020 6966 2063 6f6d 7075 7465 3a0a 2020    if compute:.  
-0000c910: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-0000c920: 203d 2072 6573 756c 742e 636f 6d70 7574   = result.comput
-0000c930: 6528 290a 2020 2020 2020 2020 7265 7475  e().        retu
-0000c940: 726e 2072 6573 756c 740a 0a20 2020 2064  rn result..    d
-0000c950: 6566 2074 6169 6c28 7365 6c66 2c20 6e3d  ef tail(self, n=
-0000c960: 352c 2063 6f6d 7075 7465 3d54 7275 6529  5, compute=True)
-0000c970: 3a0a 2020 2020 2020 2020 2222 224c 6173  :.        """Las
-0000c980: 7420 6e20 726f 7773 206f 6620 7468 6520  t n rows of the 
-0000c990: 6461 7461 7365 740a 0a20 2020 2020 2020  dataset..       
-0000c9a0: 2043 6176 6561 742c 2074 6865 206f 6e6c   Caveat, the onl
-0000c9b0: 7920 6368 6563 6b73 2074 6865 206c 6173  y checks the las
-0000c9c0: 7420 6e20 726f 7773 206f 6620 7468 6520  t n rows of the 
-0000c9d0: 6c61 7374 2070 6172 7469 7469 6f6e 2e0a  last partition..
-0000c9e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000c9f0: 2020 2020 6e61 6d65 203d 2022 7461 696c      name = "tail
-0000ca00: 2d25 642d 2573 2220 2520 286e 2c20 7365  -%d-%s" % (n, se
-0000ca10: 6c66 2e5f 6e61 6d65 290a 2020 2020 2020  lf._name).      
-0000ca20: 2020 6473 6b20 3d20 7b28 6e61 6d65 2c20    dsk = {(name, 
-0000ca30: 3029 3a20 284d 2e74 6169 6c2c 2028 7365  0): (M.tail, (se
-0000ca40: 6c66 2e5f 6e61 6d65 2c20 7365 6c66 2e6e  lf._name, self.n
-0000ca50: 7061 7274 6974 696f 6e73 202d 2031 292c  partitions - 1),
-0000ca60: 206e 297d 0a0a 2020 2020 2020 2020 6772   n)}..        gr
-0000ca70: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
-0000ca80: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
-0000ca90: 7469 6f6e 7328 6e61 6d65 2c20 6473 6b2c  tions(name, dsk,
-0000caa0: 2064 6570 656e 6465 6e63 6965 733d 5b73   dependencies=[s
-0000cab0: 656c 665d 290a 2020 2020 2020 2020 7265  elf]).        re
-0000cac0: 7375 6c74 203d 206e 6577 5f64 645f 6f62  sult = new_dd_ob
-0000cad0: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
-0000cae0: 2c20 7365 6c66 2e5f 6d65 7461 2c20 7365  , self._meta, se
-0000caf0: 6c66 2e64 6976 6973 696f 6e73 5b2d 323a  lf.divisions[-2:
-0000cb00: 5d29 0a0a 2020 2020 2020 2020 6966 2063  ])..        if c
-0000cb10: 6f6d 7075 7465 3a0a 2020 2020 2020 2020  ompute:.        
-0000cb20: 2020 2020 7265 7375 6c74 203d 2072 6573      result = res
-0000cb30: 756c 742e 636f 6d70 7574 6528 290a 2020  ult.compute().  
-0000cb40: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-0000cb50: 756c 740a 0a20 2020 2040 7072 6f70 6572  ult..    @proper
-0000cb60: 7479 0a20 2020 2064 6566 206c 6f63 2873  ty.    def loc(s
-0000cb70: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0000cb80: 2250 7572 656c 7920 6c61 6265 6c2d 6c6f  "Purely label-lo
-0000cb90: 6361 7469 6f6e 2062 6173 6564 2069 6e64  cation based ind
-0000cba0: 6578 6572 2066 6f72 2073 656c 6563 7469  exer for selecti
-0000cbb0: 6f6e 2062 7920 6c61 6265 6c2e 0a0a 2020  on by label...  
-0000cbc0: 2020 2020 2020 3e3e 3e20 6466 2e6c 6f63        >>> df.loc
-0000cbd0: 5b22 6222 5d20 2023 2064 6f63 7465 7374  ["b"]  # doctest
-0000cbe0: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
-0000cbf0: 3e3e 3e20 6466 2e6c 6f63 5b22 6222 3a22  >>> df.loc["b":"
-0000cc00: 6422 5d20 2023 2064 6f63 7465 7374 3a20  d"]  # doctest: 
-0000cc10: 2b53 4b49 500a 2020 2020 2020 2020 2222  +SKIP.        ""
-0000cc20: 220a 2020 2020 2020 2020 6672 6f6d 2064  ".        from d
-0000cc30: 6173 6b2e 6461 7461 6672 616d 652e 696e  ask.dataframe.in
-0000cc40: 6465 7869 6e67 2069 6d70 6f72 7420 5f4c  dexing import _L
-0000cc50: 6f63 496e 6465 7865 720a 0a20 2020 2020  ocIndexer..     
-0000cc60: 2020 2072 6574 7572 6e20 5f4c 6f63 496e     return _LocIn
-0000cc70: 6465 7865 7228 7365 6c66 290a 0a20 2020  dexer(self)..   
-0000cc80: 2064 6566 205f 7061 7274 6974 696f 6e73   def _partitions
-0000cc90: 2873 656c 662c 2069 6e64 6578 293a 0a20  (self, index):. 
-0000cca0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-0000ccb0: 696e 7374 616e 6365 2869 6e64 6578 2c20  instance(index, 
-0000ccc0: 7475 706c 6529 3a0a 2020 2020 2020 2020  tuple):.        
-0000ccd0: 2020 2020 696e 6465 7820 3d20 2869 6e64      index = (ind
-0000cce0: 6578 2c29 0a20 2020 2020 2020 2066 726f  ex,).        fro
-0000ccf0: 6d20 6461 736b 2e61 7272 6179 2e73 6c69  m dask.array.sli
-0000cd00: 6369 6e67 2069 6d70 6f72 7420 6e6f 726d  cing import norm
-0000cd10: 616c 697a 655f 696e 6465 780a 0a20 2020  alize_index..   
-0000cd20: 2020 2020 2069 6e64 6578 203d 206e 6f72       index = nor
-0000cd30: 6d61 6c69 7a65 5f69 6e64 6578 2869 6e64  malize_index(ind
-0000cd40: 6578 2c20 2873 656c 662e 6e70 6172 7469  ex, (self.nparti
-0000cd50: 7469 6f6e 732c 2929 0a20 2020 2020 2020  tions,)).       
-0000cd60: 2069 6e64 6578 203d 2074 7570 6c65 2873   index = tuple(s
-0000cd70: 6c69 6365 286b 2c20 6b20 2b20 3129 2069  lice(k, k + 1) i
-0000cd80: 6620 6973 696e 7374 616e 6365 286b 2c20  f isinstance(k, 
-0000cd90: 4e75 6d62 6572 2920 656c 7365 206b 2066  Number) else k f
-0000cda0: 6f72 206b 2069 6e20 696e 6465 7829 0a20  or k in index). 
-0000cdb0: 2020 2020 2020 206e 616d 6520 3d20 2262         name = "b
-0000cdc0: 6c6f 636b 732d 2220 2b20 746f 6b65 6e69  locks-" + tokeni
-0000cdd0: 7a65 2873 656c 662c 2069 6e64 6578 290a  ze(self, index).
-0000cde0: 2020 2020 2020 2020 6e65 775f 6b65 7973          new_keys
-0000cdf0: 203d 206e 702e 6172 7261 7928 7365 6c66   = np.array(self
-0000ce00: 2e5f 5f64 6173 6b5f 6b65 7973 5f5f 2829  .__dask_keys__()
-0000ce10: 2c20 6474 7970 653d 6f62 6a65 6374 295b  , dtype=object)[
-0000ce20: 696e 6465 785d 2e74 6f6c 6973 7428 290a  index].tolist().
-0000ce30: 0a20 2020 2020 2020 2064 6976 6973 696f  .        divisio
-0000ce40: 6e73 203d 205b 7365 6c66 2e64 6976 6973  ns = [self.divis
-0000ce50: 696f 6e73 5b69 5d20 666f 7220 5f2c 2069  ions[i] for _, i
-0000ce60: 2069 6e20 6e65 775f 6b65 7973 5d20 2b20   in new_keys] + 
-0000ce70: 5b0a 2020 2020 2020 2020 2020 2020 7365  [.            se
-0000ce80: 6c66 2e64 6976 6973 696f 6e73 5b6e 6577  lf.divisions[new
-0000ce90: 5f6b 6579 735b 2d31 5d5b 315d 202b 2031  _keys[-1][1] + 1
-0000cea0: 5d0a 2020 2020 2020 2020 5d0a 2020 2020  ].        ].    
-0000ceb0: 2020 2020 6473 6b20 3d20 7b28 6e61 6d65      dsk = {(name
-0000cec0: 2c20 6929 3a20 7475 706c 6528 6b65 7929  , i): tuple(key)
-0000ced0: 2066 6f72 2069 2c20 6b65 7920 696e 2065   for i, key in e
-0000cee0: 6e75 6d65 7261 7465 286e 6577 5f6b 6579  numerate(new_key
-0000cef0: 7329 7d0a 0a20 2020 2020 2020 2067 7261  s)}..        gra
-0000cf00: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
-0000cf10: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
-0000cf20: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
-0000cf30: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
-0000cf40: 6c66 5d29 0a20 2020 2020 2020 2072 6574  lf]).        ret
-0000cf50: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
-0000cf60: 7428 6772 6170 682c 206e 616d 652c 2073  t(graph, name, s
-0000cf70: 656c 662e 5f6d 6574 612c 2064 6976 6973  elf._meta, divis
-0000cf80: 696f 6e73 290a 0a20 2020 2040 7072 6f70  ions)..    @prop
-0000cf90: 6572 7479 0a20 2020 2064 6566 2070 6172  erty.    def par
-0000cfa0: 7469 7469 6f6e 7328 7365 6c66 293a 0a20  titions(self):. 
-0000cfb0: 2020 2020 2020 2022 2222 536c 6963 6520         """Slice 
-0000cfc0: 6461 7461 6672 616d 6520 6279 2070 6172  dataframe by par
-0000cfd0: 7469 7469 6f6e 730a 0a20 2020 2020 2020  titions..       
-0000cfe0: 2054 6869 7320 616c 6c6f 7773 2070 6172   This allows par
-0000cff0: 7469 7469 6f6e 7769 7365 2073 6c69 6369  titionwise slici
-0000d000: 6e67 206f 6620 6120 4461 736b 2044 6174  ng of a Dask Dat
-0000d010: 6166 7261 6d65 2e20 2059 6f75 2063 616e  aframe.  You can
-0000d020: 2070 6572 666f 726d 206e 6f72 6d61 6c0a   perform normal.
-0000d030: 2020 2020 2020 2020 4e75 6d70 792d 7374          Numpy-st
-0000d040: 796c 6520 736c 6963 696e 672c 2062 7574  yle slicing, but
-0000d050: 206e 6f77 2072 6174 6865 7220 7468 616e   now rather than
-0000d060: 2073 6c69 6365 2065 6c65 6d65 6e74 7320   slice elements 
-0000d070: 6f66 2074 6865 2061 7272 6179 2079 6f75  of the array you
-0000d080: 0a20 2020 2020 2020 2073 6c69 6365 2061  .        slice a
-0000d090: 6c6f 6e67 2070 6172 7469 7469 6f6e 7320  long partitions 
-0000d0a0: 736f 2c20 666f 7220 6578 616d 706c 652c  so, for example,
-0000d0b0: 2060 6064 662e 7061 7274 6974 696f 6e73   ``df.partitions
-0000d0c0: 5b3a 355d 6060 2070 726f 6475 6365 7320  [:5]`` produces 
-0000d0d0: 6120 6e65 770a 2020 2020 2020 2020 4461  a new.        Da
-0000d0e0: 736b 2044 6174 6166 7261 6d65 206f 6620  sk Dataframe of 
-0000d0f0: 7468 6520 6669 7273 7420 6669 7665 2070  the first five p
-0000d100: 6172 7469 7469 6f6e 732e 2056 616c 6964  artitions. Valid
-0000d110: 2069 6e64 6578 6572 7320 6172 6520 696e   indexers are in
-0000d120: 7465 6765 7273 2c20 7365 7175 656e 6365  tegers, sequence
-0000d130: 730a 2020 2020 2020 2020 6f66 2069 6e74  s.        of int
-0000d140: 6567 6572 732c 2073 6c69 6365 732c 206f  egers, slices, o
-0000d150: 7220 626f 6f6c 6561 6e20 6d61 736b 732e  r boolean masks.
-0000d160: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-0000d170: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-0000d180: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
-0000d190: 6466 2e70 6172 7469 7469 6f6e 735b 305d  df.partitions[0]
-0000d1a0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0000d1b0: 4950 0a20 2020 2020 2020 203e 3e3e 2064  IP.        >>> d
-0000d1c0: 662e 7061 7274 6974 696f 6e73 5b3a 335d  f.partitions[:3]
-0000d1d0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0000d1e0: 4950 0a20 2020 2020 2020 203e 3e3e 2064  IP.        >>> d
-0000d1f0: 662e 7061 7274 6974 696f 6e73 5b3a 3a31  f.partitions[::1
-0000d200: 305d 2020 2320 646f 6374 6573 743a 202b  0]  # doctest: +
-0000d210: 534b 4950 0a0a 2020 2020 2020 2020 5265  SKIP..        Re
-0000d220: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-0000d230: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4120  -----.        A 
-0000d240: 4461 736b 2044 6174 6146 7261 6d65 0a20  Dask DataFrame. 
-0000d250: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000d260: 2020 2072 6574 7572 6e20 496e 6465 7843     return IndexC
-0000d270: 616c 6c61 626c 6528 7365 6c66 2e5f 7061  allable(self._pa
-0000d280: 7274 6974 696f 6e73 290a 0a20 2020 2023  rtitions)..    #
-0000d290: 204e 6f74 653a 2069 6c6f 6320 6973 2069   Note: iloc is i
-0000d2a0: 6d70 6c65 6d65 6e74 6564 206f 6e6c 7920  mplemented only 
-0000d2b0: 6f6e 2044 6174 6146 7261 6d65 0a0a 2020  on DataFrame..  
-0000d2c0: 2020 6465 6620 7265 7061 7274 6974 696f    def repartitio
-0000d2d0: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
-0000d2e0: 0a20 2020 2020 2020 2064 6976 6973 696f  .        divisio
-0000d2f0: 6e73 3d4e 6f6e 652c 0a20 2020 2020 2020  ns=None,.       
-0000d300: 206e 7061 7274 6974 696f 6e73 3d4e 6f6e   npartitions=Non
-0000d310: 652c 0a20 2020 2020 2020 2070 6172 7469  e,.        parti
-0000d320: 7469 6f6e 5f73 697a 653d 4e6f 6e65 2c0a  tion_size=None,.
-0000d330: 2020 2020 2020 2020 6672 6571 3d4e 6f6e          freq=Non
-0000d340: 652c 0a20 2020 2020 2020 2066 6f72 6365  e,.        force
-0000d350: 3d46 616c 7365 2c0a 2020 2020 293a 0a20  =False,.    ):. 
-0000d360: 2020 2020 2020 2022 2222 5265 7061 7274         """Repart
-0000d370: 6974 696f 6e20 6461 7461 6672 616d 6520  ition dataframe 
-0000d380: 616c 6f6e 6720 6e65 7720 6469 7669 7369  along new divisi
-0000d390: 6f6e 730a 0a20 2020 2020 2020 2050 6172  ons..        Par
-0000d3a0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-0000d3b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000d3c0: 2020 2064 6976 6973 696f 6e73 203a 206c     divisions : l
-0000d3d0: 6973 742c 206f 7074 696f 6e61 6c0a 2020  ist, optional.  
-0000d3e0: 2020 2020 2020 2020 2020 5468 6520 2264            The "d
-0000d3f0: 6976 6964 696e 6720 6c69 6e65 7322 2075  ividing lines" u
-0000d400: 7365 6420 746f 2073 706c 6974 2074 6865  sed to split the
-0000d410: 2064 6174 6166 7261 6d65 2069 6e74 6f20   dataframe into 
-0000d420: 7061 7274 6974 696f 6e73 2e0a 2020 2020  partitions..    
-0000d430: 2020 2020 2020 2020 466f 7220 6060 6469          For ``di
-0000d440: 7669 7369 6f6e 733d 5b30 2c20 3130 2c20  visions=[0, 10, 
-0000d450: 3530 2c20 3130 305d 6060 2c20 7468 6572  50, 100]``, ther
-0000d460: 6520 776f 756c 6420 6265 2074 6872 6565  e would be three
-0000d470: 206f 7574 7075 7420 7061 7274 6974 696f   output partitio
-0000d480: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-0000d490: 7768 6572 6520 7468 6520 6e65 7720 696e  where the new in
-0000d4a0: 6465 7820 636f 6e74 6169 6e65 6420 5b30  dex contained [0
-0000d4b0: 2c20 3130 292c 205b 3130 2c20 3530 292c  , 10), [10, 50),
-0000d4c0: 2061 6e64 205b 3530 2c20 3130 3029 2c20   and [50, 100), 
-0000d4d0: 7265 7370 6563 7469 7665 6c79 2e0a 2020  respectively..  
-0000d4e0: 2020 2020 2020 2020 2020 5365 6520 6874            See ht
-0000d4f0: 7470 733a 2f2f 646f 6373 2e64 6173 6b2e  tps://docs.dask.
-0000d500: 6f72 672f 656e 2f6c 6174 6573 742f 6461  org/en/latest/da
-0000d510: 7461 6672 616d 652d 6465 7369 676e 2e68  taframe-design.h
-0000d520: 746d 6c23 7061 7274 6974 696f 6e73 2e0a  tml#partitions..
-0000d530: 2020 2020 2020 2020 2020 2020 4f6e 6c79              Only
-0000d540: 2075 7365 6420 6966 206e 7061 7274 6974   used if npartit
-0000d550: 696f 6e73 2061 6e64 2070 6172 7469 7469  ions and partiti
-0000d560: 6f6e 5f73 697a 6520 6973 6e27 7420 7370  on_size isn't sp
-0000d570: 6563 6966 6965 642e 0a20 2020 2020 2020  ecified..       
-0000d580: 2020 2020 2046 6f72 2063 6f6e 7665 6e69       For conveni
-0000d590: 656e 6365 2069 6620 6769 7665 6e20 616e  ence if given an
-0000d5a0: 2069 6e74 6567 6572 2074 6869 7320 7769   integer this wi
-0000d5b0: 6c6c 2064 6566 6572 2074 6f20 6e70 6172  ll defer to npar
-0000d5c0: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
-0000d5d0: 2020 2020 616e 6420 6966 2067 6976 656e      and if given
-0000d5e0: 2061 2073 7472 696e 6720 6974 2077 696c   a string it wil
-0000d5f0: 6c20 6465 6665 7220 746f 2070 6172 7469  l defer to parti
-0000d600: 7469 6f6e 5f73 697a 6520 2873 6565 2062  tion_size (see b
-0000d610: 656c 6f77 290a 2020 2020 2020 2020 6e70  elow).        np
-0000d620: 6172 7469 7469 6f6e 7320 3a20 696e 742c  artitions : int,
-0000d630: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0000d640: 2020 2020 2020 4170 7072 6f78 696d 6174        Approximat
-0000d650: 6520 6e75 6d62 6572 206f 6620 7061 7274  e number of part
-0000d660: 6974 696f 6e73 206f 6620 6f75 7470 7574  itions of output
-0000d670: 2e20 4f6e 6c79 2075 7365 6420 6966 2070  . Only used if p
-0000d680: 6172 7469 7469 6f6e 5f73 697a 650a 2020  artition_size.  
-0000d690: 2020 2020 2020 2020 2020 6973 6e27 7420            isn't 
-0000d6a0: 7370 6563 6966 6965 642e 2054 6865 206e  specified. The n
-0000d6b0: 756d 6265 7220 6f66 2070 6172 7469 7469  umber of partiti
-0000d6c0: 6f6e 7320 7573 6564 206d 6179 2062 6520  ons used may be 
-0000d6d0: 736c 6967 6874 6c79 0a20 2020 2020 2020  slightly.       
-0000d6e0: 2020 2020 206c 6f77 6572 2074 6861 6e20       lower than 
-0000d6f0: 6e70 6172 7469 7469 6f6e 7320 6465 7065  npartitions depe
-0000d700: 6e64 696e 6720 6f6e 2064 6174 6120 6469  nding on data di
-0000d710: 7374 7269 6275 7469 6f6e 2c20 6275 7420  stribution, but 
-0000d720: 7769 6c6c 206e 6576 6572 2062 650a 2020  will never be.  
-0000d730: 2020 2020 2020 2020 2020 6869 6768 6572            higher
-0000d740: 2e0a 2020 2020 2020 2020 7061 7274 6974  ..        partit
-0000d750: 696f 6e5f 7369 7a65 3a20 696e 7420 6f72  ion_size: int or
-0000d760: 2073 7472 696e 672c 206f 7074 696f 6e61   string, optiona
-0000d770: 6c0a 2020 2020 2020 2020 2020 2020 4d61  l.            Ma
-0000d780: 7820 6e75 6d62 6572 206f 6620 6279 7465  x number of byte
-0000d790: 7320 6f66 206d 656d 6f72 7920 666f 7220  s of memory for 
-0000d7a0: 6561 6368 2070 6172 7469 7469 6f6e 2e20  each partition. 
-0000d7b0: 5573 6520 6e75 6d62 6572 7320 6f72 0a20  Use numbers or. 
-0000d7c0: 2020 2020 2020 2020 2020 2073 7472 696e             strin
-0000d7d0: 6773 206c 696b 6520 354d 422e 2049 6620  gs like 5MB. If 
-0000d7e0: 7370 6563 6966 6965 6420 6e70 6172 7469  specified nparti
-0000d7f0: 7469 6f6e 7320 616e 6420 6469 7669 7369  tions and divisi
-0000d800: 6f6e 7320 7769 6c6c 2062 650a 2020 2020  ons will be.    
-0000d810: 2020 2020 2020 2020 6967 6e6f 7265 642e          ignored.
-0000d820: 204e 6f74 6520 7468 6174 2074 6865 2073   Note that the s
-0000d830: 697a 6520 7265 666c 6563 7473 2074 6865  ize reflects the
-0000d840: 206e 756d 6265 7220 6f66 2062 7974 6573   number of bytes
-0000d850: 2075 7365 6420 6173 0a20 2020 2020 2020   used as.       
-0000d860: 2020 2020 2063 6f6d 7075 7465 6420 6279       computed by
-0000d870: 2060 6070 616e 6461 732e 4461 7461 4672   ``pandas.DataFr
-0000d880: 616d 652e 6d65 6d6f 7279 5f75 7361 6765  ame.memory_usage
-0000d890: 6060 2c20 7768 6963 6820 7769 6c6c 206e  ``, which will n
-0000d8a0: 6f74 0a20 2020 2020 2020 2020 2020 206e  ot.            n
-0000d8b0: 6563 6573 7361 7269 6c79 206d 6174 6368  ecessarily match
-0000d8c0: 2074 6865 2073 697a 6520 7768 656e 2073   the size when s
-0000d8d0: 746f 7269 6e67 2074 6f20 6469 736b 2e0a  toring to disk..
-0000d8e0: 0a20 2020 2020 2020 2020 2020 202e 2e20  .            .. 
-0000d8f0: 7761 726e 696e 673a 3a0a 0a20 2020 2020  warning::..     
-0000d900: 2020 2020 2020 2020 2020 5468 6973 206b            This k
-0000d910: 6579 776f 7264 2061 7267 756d 656e 7420  eyword argument 
-0000d920: 7472 6967 6765 7273 2063 6f6d 7075 7461  triggers computa
-0000d930: 7469 6f6e 2074 6f20 6465 7465 726d 696e  tion to determin
-0000d940: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0000d950: 2074 6865 206d 656d 6f72 7920 7369 7a65   the memory size
-0000d960: 206f 6620 6561 6368 2070 6172 7469 7469   of each partiti
-0000d970: 6f6e 2c20 7768 6963 6820 6d61 7920 6265  on, which may be
-0000d980: 2065 7870 656e 7369 7665 2e0a 0a20 2020   expensive...   
-0000d990: 2020 2020 2066 7265 7120 3a20 7374 722c       freq : str,
-0000d9a0: 2070 642e 5469 6d65 6465 6c74 610a 2020   pd.Timedelta.  
-0000d9b0: 2020 2020 2020 2020 2020 4120 7065 7269            A peri
-0000d9c0: 6f64 206f 6e20 7768 6963 6820 746f 2070  od on which to p
-0000d9d0: 6172 7469 7469 6f6e 2074 696d 6573 6572  artition timeser
-0000d9e0: 6965 7320 6461 7461 206c 696b 6520 6060  ies data like ``
-0000d9f0: 2737 4427 6060 206f 720a 2020 2020 2020  '7D'`` or.      
-0000da00: 2020 2020 2020 6060 2731 3268 2760 6020        ``'12h'`` 
-0000da10: 6f72 2060 6070 642e 5469 6d65 6465 6c74  or ``pd.Timedelt
-0000da20: 6128 686f 7572 733d 3132 2960 602e 2020  a(hours=12)``.  
-0000da30: 4173 7375 6d65 7320 6120 6461 7465 7469  Assumes a dateti
-0000da40: 6d65 2069 6e64 6578 2e0a 2020 2020 2020  me index..      
-0000da50: 2020 666f 7263 6520 3a20 626f 6f6c 2c20    force : bool, 
-0000da60: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
-0000da70: 2020 2020 2020 2020 2020 416c 6c6f 7773            Allows
-0000da80: 2074 6865 2065 7870 616e 7369 6f6e 206f   the expansion o
-0000da90: 6620 7468 6520 6578 6973 7469 6e67 2064  f the existing d
-0000daa0: 6976 6973 696f 6e73 2e0a 2020 2020 2020  ivisions..      
-0000dab0: 2020 2020 2020 4966 2046 616c 7365 2074        If False t
-0000dac0: 6865 6e20 7468 6520 6e65 7720 6469 7669  hen the new divi
-0000dad0: 7369 6f6e 7327 206c 6f77 6572 2061 6e64  sions' lower and
-0000dae0: 2075 7070 6572 2062 6f75 6e64 7320 6d75   upper bounds mu
-0000daf0: 7374 2062 650a 2020 2020 2020 2020 2020  st be.          
-0000db00: 2020 7468 6520 7361 6d65 2061 7320 7468    the same as th
-0000db10: 6520 6f6c 6420 6469 7669 7369 6f6e 7327  e old divisions'
-0000db20: 2e0a 0a20 2020 2020 2020 204e 6f74 6573  ...        Notes
-0000db30: 0a20 2020 2020 2020 202d 2d2d 2d2d 0a20  .        -----. 
-0000db40: 2020 2020 2020 2045 7861 6374 6c79 206f         Exactly o
-0000db50: 6e65 206f 6620 6064 6976 6973 696f 6e73  ne of `divisions
-0000db60: 602c 2060 6e70 6172 7469 7469 6f6e 7360  `, `npartitions`
-0000db70: 2c20 6070 6172 7469 7469 6f6e 5f73 697a  , `partition_siz
-0000db80: 6560 2c20 6f72 2060 6672 6571 600a 2020  e`, or `freq`.  
-0000db90: 2020 2020 2020 7368 6f75 6c64 2062 6520        should be 
-0000dba0: 7370 6563 6966 6965 642e 2041 2060 6056  specified. A ``V
-0000dbb0: 616c 7565 4572 726f 7260 6020 7769 6c6c  alueError`` will
-0000dbc0: 2062 6520 7261 6973 6564 2077 6865 6e20   be raised when 
-0000dbd0: 7468 6174 2069 730a 2020 2020 2020 2020  that is.        
-0000dbe0: 6e6f 7420 7468 6520 6361 7365 2e0a 0a20  not the case... 
-0000dbf0: 2020 2020 2020 2041 6c73 6f20 6e6f 7465         Also note
-0000dc00: 2074 6861 7420 6060 6c65 6e28 6469 7669   that ``len(divi
-0000dc10: 736f 6e73 2960 6020 6973 2065 7175 616c  sons)`` is equal
-0000dc20: 2074 6f20 6060 6e70 6172 7469 7469 6f6e   to ``npartition
-0000dc30: 7320 2b20 3160 602e 2054 6869 7320 6973  s + 1``. This is
-0000dc40: 2062 6563 6175 7365 2060 6064 6976 6973   because ``divis
-0000dc50: 696f 6e73 6060 0a20 2020 2020 2020 2072  ions``.        r
-0000dc60: 6570 7265 7365 6e74 7320 7468 6520 7570  epresents the up
-0000dc70: 7065 7220 616e 6420 6c6f 7765 7220 626f  per and lower bo
-0000dc80: 756e 6473 206f 6620 6561 6368 2070 6172  unds of each par
-0000dc90: 7469 7469 6f6e 2e20 5468 6520 6669 7273  tition. The firs
-0000dca0: 7420 6974 656d 2069 7320 7468 650a 2020  t item is the.  
-0000dcb0: 2020 2020 2020 6c6f 7765 7220 626f 756e        lower boun
-0000dcc0: 6420 6f66 2074 6865 2066 6972 7374 2070  d of the first p
-0000dcd0: 6172 7469 7469 6f6e 2c20 7468 6520 7365  artition, the se
-0000dce0: 636f 6e64 2069 7465 6d20 6973 2074 6865  cond item is the
-0000dcf0: 206c 6f77 6572 2062 6f75 6e64 206f 6620   lower bound of 
-0000dd00: 7468 650a 2020 2020 2020 2020 7365 636f  the.        seco
-0000dd10: 6e64 2070 6172 7469 7469 6f6e 2061 6e64  nd partition and
-0000dd20: 2074 6865 2075 7070 6572 2062 6f75 6e64   the upper bound
-0000dd30: 206f 6620 7468 6520 6669 7273 7420 7061   of the first pa
-0000dd40: 7274 6974 696f 6e2c 2061 6e64 2073 6f20  rtition, and so 
-0000dd50: 6f6e 2e0a 2020 2020 2020 2020 5468 6520  on..        The 
-0000dd60: 7365 636f 6e64 2d74 6f2d 6c61 7374 2069  second-to-last i
-0000dd70: 7465 6d20 6973 2074 6865 206c 6f77 6572  tem is the lower
-0000dd80: 2062 6f75 6e64 206f 6620 7468 6520 6c61   bound of the la
-0000dd90: 7374 2070 6172 7469 7469 6f6e 2c20 616e  st partition, an
-0000dda0: 6420 7468 6520 6c61 7374 0a20 2020 2020  d the last.     
-0000ddb0: 2020 2028 6578 7472 6129 2069 7465 6d20     (extra) item 
-0000ddc0: 6973 2074 6865 2075 7070 6572 2062 6f75  is the upper bou
-0000ddd0: 6e64 206f 6620 7468 6520 6c61 7374 2070  nd of the last p
-0000dde0: 6172 7469 7469 6f6e 2e0a 0a20 2020 2020  artition...     
-0000ddf0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-0000de00: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0000de10: 2020 2020 203e 3e3e 2064 6620 3d20 6466       >>> df = df
-0000de20: 2e72 6570 6172 7469 7469 6f6e 286e 7061  .repartition(npa
-0000de30: 7274 6974 696f 6e73 3d31 3029 2020 2320  rtitions=10)  # 
-0000de40: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0000de50: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0000de60: 6466 2e72 6570 6172 7469 7469 6f6e 2864  df.repartition(d
-0000de70: 6976 6973 696f 6e73 3d5b 302c 2035 2c20  ivisions=[0, 5, 
-0000de80: 3130 2c20 3230 5d29 2020 2320 646f 6374  10, 20])  # doct
-0000de90: 6573 743a 202b 534b 4950 0a20 2020 2020  est: +SKIP.     
-0000dea0: 2020 203e 3e3e 2064 6620 3d20 6466 2e72     >>> df = df.r
-0000deb0: 6570 6172 7469 7469 6f6e 2866 7265 713d  epartition(freq=
-0000dec0: 2737 6427 2920 2023 2064 6f63 7465 7374  '7d')  # doctest
-0000ded0: 3a20 2b53 4b49 500a 0a20 2020 2020 2020  : +SKIP..       
-0000dee0: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-0000def0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-0000df00: 2020 2044 6174 6146 7261 6d65 2e6d 656d     DataFrame.mem
-0000df10: 6f72 795f 7573 6167 655f 7065 725f 7061  ory_usage_per_pa
-0000df20: 7274 6974 696f 6e0a 2020 2020 2020 2020  rtition.        
-0000df30: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
-0000df40: 2e6d 656d 6f72 795f 7573 6167 650a 2020  .memory_usage.  
-0000df50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000df60: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0000df70: 6469 7669 7369 6f6e 732c 2069 6e74 293a  divisions, int):
-0000df80: 0a20 2020 2020 2020 2020 2020 206e 7061  .            npa
-0000df90: 7274 6974 696f 6e73 203d 2064 6976 6973  rtitions = divis
-0000dfa0: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
-0000dfb0: 2064 6976 6973 696f 6e73 203d 204e 6f6e   divisions = Non
-0000dfc0: 650a 2020 2020 2020 2020 6966 2069 7369  e.        if isi
-0000dfd0: 6e73 7461 6e63 6528 6469 7669 7369 6f6e  nstance(division
-0000dfe0: 732c 2073 7472 293a 0a20 2020 2020 2020  s, str):.       
-0000dff0: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
-0000e000: 697a 6520 3d20 6469 7669 7369 6f6e 730a  ize = divisions.
-0000e010: 2020 2020 2020 2020 2020 2020 6469 7669              divi
-0000e020: 7369 6f6e 7320 3d20 4e6f 6e65 0a20 2020  sions = None.   
-0000e030: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
-0000e040: 2020 2020 2020 7375 6d28 0a20 2020 2020        sum(.     
-0000e050: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-0000e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e070: 2070 6172 7469 7469 6f6e 5f73 697a 6520   partition_size 
-0000e080: 6973 206e 6f74 204e 6f6e 652c 0a20 2020  is not None,.   
-0000e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e0a0: 2064 6976 6973 696f 6e73 2069 7320 6e6f   divisions is no
-0000e0b0: 7420 4e6f 6e65 2c0a 2020 2020 2020 2020  t None,.        
-0000e0c0: 2020 2020 2020 2020 2020 2020 6e70 6172              npar
-0000e0d0: 7469 7469 6f6e 7320 6973 206e 6f74 204e  titions is not N
-0000e0e0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0000e0f0: 2020 2020 2020 2020 2066 7265 7120 6973           freq is
-0000e100: 206e 6f74 204e 6f6e 652c 0a20 2020 2020   not None,.     
-0000e110: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-0000e120: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000e130: 2020 2020 2020 2021 3d20 310a 2020 2020         != 1.    
-0000e140: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-0000e150: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0000e160: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0000e170: 2020 2020 2022 506c 6561 7365 2070 726f       "Please pro
-0000e180: 7669 6465 2065 7861 6374 6c79 206f 6e65  vide exactly one
-0000e190: 206f 6620 6060 6e70 6172 7469 7469 6f6e   of ``npartition
-0000e1a0: 733d 6060 2c20 6060 6672 6571 3d60 602c  s=``, ``freq=``,
-0000e1b0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0000e1c0: 2020 2022 6060 6469 7669 7369 6f6e 733d     "``divisions=
-0000e1d0: 6060 2c20 6060 7061 7274 6974 696f 6e5f  ``, ``partition_
-0000e1e0: 7369 7a65 3d60 6020 6b65 7977 6f72 6420  size=`` keyword 
-0000e1f0: 6172 6775 6d65 6e74 7322 0a20 2020 2020  arguments".     
-0000e200: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0000e210: 2020 6966 2070 6172 7469 7469 6f6e 5f73    if partition_s
-0000e220: 697a 6520 6973 206e 6f74 204e 6f6e 653a  ize is not None:
-0000e230: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000e240: 7572 6e20 7265 7061 7274 6974 696f 6e5f  urn repartition_
-0000e250: 7369 7a65 2873 656c 662c 2070 6172 7469  size(self, parti
-0000e260: 7469 6f6e 5f73 697a 6529 0a20 2020 2020  tion_size).     
-0000e270: 2020 2065 6c69 6620 6e70 6172 7469 7469     elif npartiti
-0000e280: 6f6e 7320 6973 206e 6f74 204e 6f6e 653a  ons is not None:
-0000e290: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000e2a0: 7572 6e20 7265 7061 7274 6974 696f 6e5f  urn repartition_
-0000e2b0: 6e70 6172 7469 7469 6f6e 7328 7365 6c66  npartitions(self
-0000e2c0: 2c20 6e70 6172 7469 7469 6f6e 7329 0a20  , npartitions). 
-0000e2d0: 2020 2020 2020 2065 6c69 6620 6469 7669         elif divi
-0000e2e0: 7369 6f6e 7320 6973 206e 6f74 204e 6f6e  sions is not Non
-0000e2f0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000e300: 6574 7572 6e20 7265 7061 7274 6974 696f  eturn repartitio
-0000e310: 6e28 7365 6c66 2c20 6469 7669 7369 6f6e  n(self, division
-0000e320: 732c 2066 6f72 6365 3d66 6f72 6365 290a  s, force=force).
-0000e330: 2020 2020 2020 2020 656c 6966 2066 7265          elif fre
-0000e340: 7120 6973 206e 6f74 204e 6f6e 653a 0a20  q is not None:. 
-0000e350: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000e360: 6e20 7265 7061 7274 6974 696f 6e5f 6672  n repartition_fr
-0000e370: 6571 2873 656c 662c 2066 7265 713d 6672  eq(self, freq=fr
-0000e380: 6571 290a 0a20 2020 2064 6566 2073 6875  eq)..    def shu
-0000e390: 6666 6c65 280a 2020 2020 2020 2020 7365  ffle(.        se
-0000e3a0: 6c66 2c0a 2020 2020 2020 2020 6f6e 2c0a  lf,.        on,.
-0000e3b0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
-0000e3c0: 6f6e 733d 4e6f 6e65 2c0a 2020 2020 2020  ons=None,.      
-0000e3d0: 2020 6d61 785f 6272 616e 6368 3d4e 6f6e    max_branch=Non
-0000e3e0: 652c 0a20 2020 2020 2020 2073 6875 6666  e,.        shuff
-0000e3f0: 6c65 3d4e 6f6e 652c 0a20 2020 2020 2020  le=None,.       
-0000e400: 2069 676e 6f72 655f 696e 6465 783d 4661   ignore_index=Fa
-0000e410: 6c73 652c 0a20 2020 2020 2020 2063 6f6d  lse,.        com
-0000e420: 7075 7465 3d4e 6f6e 652c 0a20 2020 2029  pute=None,.    )
-0000e430: 3a0a 2020 2020 2020 2020 2222 2252 6561  :.        """Rea
-0000e440: 7272 616e 6765 2044 6174 6146 7261 6d65  rrange DataFrame
-0000e450: 2069 6e74 6f20 6e65 7720 7061 7274 6974   into new partit
-0000e460: 696f 6e73 0a0a 2020 2020 2020 2020 5573  ions..        Us
-0000e470: 6573 2068 6173 6869 6e67 206f 6620 606f  es hashing of `o
-0000e480: 6e60 2074 6f20 6d61 7020 726f 7773 2074  n` to map rows t
-0000e490: 6f20 6f75 7470 7574 2070 6172 7469 7469  o output partiti
-0000e4a0: 6f6e 732e 2041 6674 6572 2074 6869 730a  ons. After this.
-0000e4b0: 2020 2020 2020 2020 6f70 6572 6174 696f          operatio
-0000e4c0: 6e2c 2072 6f77 7320 7769 7468 2074 6865  n, rows with the
-0000e4d0: 2073 616d 6520 7661 6c75 6520 6f66 2060   same value of `
-0000e4e0: 6f6e 6020 7769 6c6c 2062 6520 696e 2074  on` will be in t
-0000e4f0: 6865 2073 616d 650a 2020 2020 2020 2020  he same.        
-0000e500: 7061 7274 6974 696f 6e2e 0a0a 2020 2020  partition...    
-0000e510: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-0000e520: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000e530: 2d0a 2020 2020 2020 2020 6f6e 203a 2073  -.        on : s
-0000e540: 7472 2c20 6c69 7374 206f 6620 7374 722c  tr, list of str,
-0000e550: 206f 7220 5365 7269 6573 2c20 496e 6465   or Series, Inde
-0000e560: 782c 206f 7220 4461 7461 4672 616d 650a  x, or DataFrame.
-0000e570: 2020 2020 2020 2020 2020 2020 436f 6c75              Colu
-0000e580: 6d6e 2873 2920 6f72 2069 6e64 6578 2074  mn(s) or index t
-0000e590: 6f20 6265 2075 7365 6420 746f 206d 6170  o be used to map
-0000e5a0: 2072 6f77 7320 746f 206f 7574 7075 7420   rows to output 
-0000e5b0: 7061 7274 6974 696f 6e73 0a20 2020 2020  partitions.     
-0000e5c0: 2020 206e 7061 7274 6974 696f 6e73 203a     npartitions :
-0000e5d0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-0000e5e0: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
-0000e5f0: 7220 6f66 2070 6172 7469 7469 6f6e 7320  r of partitions 
-0000e600: 6f66 206f 7574 7075 742e 2050 6172 7469  of output. Parti
-0000e610: 7469 6f6e 2063 6f75 6e74 2077 696c 6c20  tion count will 
-0000e620: 6e6f 7420 6265 0a20 2020 2020 2020 2020  not be.         
-0000e630: 2020 2063 6861 6e67 6564 2062 7920 6465     changed by de
-0000e640: 6661 756c 742e 0a20 2020 2020 2020 206d  fault..        m
-0000e650: 6178 5f62 7261 6e63 683a 2069 6e74 2c20  ax_branch: int, 
-0000e660: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-0000e670: 2020 2020 2054 6865 206d 6178 696d 756d       The maximum
-0000e680: 206e 756d 6265 7220 6f66 2073 706c 6974   number of split
-0000e690: 7320 7065 7220 696e 7075 7420 7061 7274  s per input part
-0000e6a0: 6974 696f 6e2e 2055 7365 6420 7769 7468  ition. Used with
-0000e6b0: 696e 0a20 2020 2020 2020 2020 2020 2074  in.            t
-0000e6c0: 6865 2073 7461 6765 6420 7368 7566 666c  he staged shuffl
-0000e6d0: 696e 6720 616c 676f 7269 7468 6d2e 0a20  ing algorithm.. 
-0000e6e0: 2020 2020 2020 2073 6875 6666 6c65 3a20         shuffle: 
-0000e6f0: 7b27 6469 736b 272c 2027 7461 736b 7327  {'disk', 'tasks'
-0000e700: 7d2c 206f 7074 696f 6e61 6c0a 2020 2020  }, optional.    
-0000e710: 2020 2020 2020 2020 4569 7468 6572 2060          Either `
-0000e720: 6027 6469 736b 2760 6020 666f 7220 7369  `'disk'`` for si
-0000e730: 6e67 6c65 2d6e 6f64 6520 6f70 6572 6174  ngle-node operat
-0000e740: 696f 6e20 6f72 2060 6027 7461 736b 7327  ion or ``'tasks'
-0000e750: 6060 2066 6f72 0a20 2020 2020 2020 2020  `` for.         
-0000e760: 2020 2064 6973 7472 6962 7574 6564 206f     distributed o
-0000e770: 7065 7261 7469 6f6e 2e20 2057 696c 6c20  peration.  Will 
-0000e780: 6265 2069 6e66 6572 7265 6420 6279 2079  be inferred by y
-0000e790: 6f75 7220 6375 7272 656e 7420 7363 6865  our current sche
-0000e7a0: 6475 6c65 722e 0a20 2020 2020 2020 2069  duler..        i
-0000e7b0: 676e 6f72 655f 696e 6465 783a 2062 6f6f  gnore_index: boo
-0000e7c0: 6c2c 2064 6566 6175 6c74 2046 616c 7365  l, default False
-0000e7d0: 0a20 2020 2020 2020 2020 2020 2049 676e  .            Ign
-0000e7e0: 6f72 6520 696e 6465 7820 6475 7269 6e67  ore index during
-0000e7f0: 2073 6875 6666 6c65 2e20 2049 6620 6060   shuffle.  If ``
-0000e800: 5472 7565 6060 2c20 7065 7266 6f72 6d61  True``, performa
-0000e810: 6e63 6520 6d61 7920 696d 7072 6f76 652c  nce may improve,
-0000e820: 0a20 2020 2020 2020 2020 2020 2062 7574  .            but
-0000e830: 2069 6e64 6578 2076 616c 7565 7320 7769   index values wi
-0000e840: 6c6c 206e 6f74 2062 6520 7072 6573 6572  ll not be preser
-0000e850: 7665 642e 0a20 2020 2020 2020 2063 6f6d  ved..        com
-0000e860: 7075 7465 3a20 626f 6f6c 0a20 2020 2020  pute: bool.     
-0000e870: 2020 2020 2020 2057 6865 7468 6572 206f         Whether o
-0000e880: 7220 6e6f 7420 746f 2074 7269 6767 6572  r not to trigger
-0000e890: 2061 6e20 696d 6d65 6469 6174 6520 636f   an immediate co
-0000e8a0: 6d70 7574 6174 696f 6e2e 2044 6566 6175  mputation. Defau
-0000e8b0: 6c74 7320 746f 2046 616c 7365 2e0a 0a20  lts to False... 
-0000e8c0: 2020 2020 2020 204e 6f74 6573 0a20 2020         Notes.   
-0000e8d0: 2020 2020 202d 2d2d 2d2d 0a20 2020 2020       -----.     
-0000e8e0: 2020 2054 6869 7320 646f 6573 206e 6f74     This does not
-0000e8f0: 2070 7265 7365 7276 6520 6120 6d65 616e   preserve a mean
-0000e900: 696e 6766 756c 2069 6e64 6578 2f70 6172  ingful index/par
-0000e910: 7469 7469 6f6e 696e 6720 7363 6865 6d65  titioning scheme
-0000e920: 2e20 5468 6973 0a20 2020 2020 2020 2069  . This.        i
-0000e930: 7320 6e6f 7420 6465 7465 726d 696e 6973  s not determinis
-0000e940: 7469 6320 6966 2064 6f6e 6520 696e 2070  tic if done in p
-0000e950: 6172 616c 6c65 6c2e 0a0a 2020 2020 2020  arallel...      
-0000e960: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
-0000e970: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-0000e980: 2020 2020 3e3e 3e20 6466 203d 2064 662e      >>> df = df.
-0000e990: 7368 7566 666c 6528 6466 2e63 6f6c 756d  shuffle(df.colum
-0000e9a0: 6e73 5b30 5d29 2020 2320 646f 6374 6573  ns[0])  # doctes
-0000e9b0: 743a 202b 534b 4950 0a20 2020 2020 2020  t: +SKIP.       
-0000e9c0: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-0000e9d0: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
-0000e9e0: 2e73 6875 6666 6c65 2069 6d70 6f72 7420  .shuffle import 
-0000e9f0: 7368 7566 666c 6520 6173 2064 645f 7368  shuffle as dd_sh
-0000ea00: 7566 666c 650a 0a20 2020 2020 2020 2072  uffle..        r
-0000ea10: 6574 7572 6e20 6464 5f73 6875 6666 6c65  eturn dd_shuffle
-0000ea20: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-0000ea30: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
-0000ea40: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0000ea50: 6e70 6172 7469 7469 6f6e 733d 6e70 6172  npartitions=npar
-0000ea60: 7469 7469 6f6e 732c 0a20 2020 2020 2020  titions,.       
-0000ea70: 2020 2020 206d 6178 5f62 7261 6e63 683d       max_branch=
-0000ea80: 6d61 785f 6272 616e 6368 2c0a 2020 2020  max_branch,.    
-0000ea90: 2020 2020 2020 2020 7368 7566 666c 653d          shuffle=
-0000eaa0: 7368 7566 666c 652c 0a20 2020 2020 2020  shuffle,.       
-0000eab0: 2020 2020 2069 676e 6f72 655f 696e 6465       ignore_inde
-0000eac0: 783d 6967 6e6f 7265 5f69 6e64 6578 2c0a  x=ignore_index,.
-0000ead0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-0000eae0: 7574 653d 636f 6d70 7574 652c 0a20 2020  ute=compute,.   
-0000eaf0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
-0000eb00: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-0000eb10: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-0000eb20: 6669 6c6c 6e61 2873 656c 662c 2076 616c  fillna(self, val
-0000eb30: 7565 3d4e 6f6e 652c 206d 6574 686f 643d  ue=None, method=
-0000eb40: 4e6f 6e65 2c20 6c69 6d69 743d 4e6f 6e65  None, limit=None
-0000eb50: 2c20 6178 6973 3d4e 6f6e 6529 3a0a 2020  , axis=None):.  
-0000eb60: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
-0000eb70: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
-0000eb80: 2861 7869 7329 0a20 2020 2020 2020 2069  (axis).        i
-0000eb90: 6620 6d65 7468 6f64 2069 7320 4e6f 6e65  f method is None
-0000eba0: 2061 6e64 206c 696d 6974 2069 7320 6e6f   and limit is no
-0000ebb0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0000ebc0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-0000ebd0: 6c65 6d65 6e74 6564 4572 726f 7228 2266  lementedError("f
-0000ebe0: 696c 6c6e 6120 7769 7468 2073 6574 206c  illna with set l
-0000ebf0: 696d 6974 2061 6e64 206d 6574 686f 643d  imit and method=
-0000ec00: 4e6f 6e65 2229 0a20 2020 2020 2020 2069  None").        i
-0000ec10: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
-0000ec20: 7565 2c20 285f 4672 616d 652c 2053 6361  ue, (_Frame, Sca
-0000ec30: 6c61 7229 293a 0a20 2020 2020 2020 2020  lar)):.         
-0000ec40: 2020 2074 6573 745f 7661 6c75 6520 3d20     test_value = 
-0000ec50: 7661 6c75 652e 5f6d 6574 615f 6e6f 6e65  value._meta_none
-0000ec60: 6d70 7479 0a20 2020 2020 2020 2065 6c73  mpty.        els
-0000ec70: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
-0000ec80: 6573 745f 7661 6c75 6520 3d20 7661 6c75  est_value = valu
-0000ec90: 650a 2020 2020 2020 2020 6d65 7461 203d  e.        meta =
-0000eca0: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
-0000ecb0: 6d70 7479 2e66 696c 6c6e 6128 0a20 2020  mpty.fillna(.   
-0000ecc0: 2020 2020 2020 2020 2076 616c 7565 3d74           value=t
-0000ecd0: 6573 745f 7661 6c75 652c 206d 6574 686f  est_value, metho
-0000ece0: 643d 6d65 7468 6f64 2c20 6c69 6d69 743d  d=method, limit=
-0000ecf0: 6c69 6d69 742c 2061 7869 733d 6178 6973  limit, axis=axis
-0000ed00: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0000ed10: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
-0000ed20: 206f 7220 6d65 7468 6f64 2069 7320 4e6f   or method is No
-0000ed30: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000ed40: 2320 436f 6e74 726f 6c20 7768 6574 6865  # Control whethe
-0000ed50: 7220 6f72 206e 6f74 2064 6173 6b27 7320  r or not dask's 
-0000ed60: 7061 7274 6974 696f 6e20 616c 6967 6e6d  partition alignm
-0000ed70: 656e 7420 6861 7070 656e 732e 0a20 2020  ent happens..   
-0000ed80: 2020 2020 2020 2020 2023 2057 6520 646f           # We do
-0000ed90: 6e27 7420 7761 6e74 2066 6f72 2061 2070  n't want for a p
-0000eda0: 616e 6461 7320 5365 7269 6573 2e0a 2020  andas Series..  
-0000edb0: 2020 2020 2020 2020 2020 2320 5765 2064            # We d
-0000edc0: 6f20 7761 6e74 2069 7420 666f 7220 6120  o want it for a 
-0000edd0: 6461 736b 2053 6572 6965 730a 2020 2020  dask Series.    
-0000ede0: 2020 2020 2020 2020 6966 2069 735f 7365          if is_se
-0000edf0: 7269 6573 5f6c 696b 6528 7661 6c75 6529  ries_like(value)
-0000ee00: 2061 6e64 206e 6f74 2069 735f 6461 736b   and not is_dask
-0000ee10: 5f63 6f6c 6c65 6374 696f 6e28 7661 6c75  _collection(valu
-0000ee20: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-0000ee30: 2020 2020 6172 6773 203d 2028 290a 2020      args = ().  
-0000ee40: 2020 2020 2020 2020 2020 2020 2020 6b77                kw
-0000ee50: 6172 6773 203d 207b 2276 616c 7565 223a  args = {"value":
-0000ee60: 2076 616c 7565 7d0a 2020 2020 2020 2020   value}.        
-0000ee70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000ee80: 2020 2020 2020 2020 2020 6172 6773 203d            args =
-0000ee90: 2028 7661 6c75 652c 290a 2020 2020 2020   (value,).      
-0000eea0: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-0000eeb0: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
-0000eec0: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-0000eed0: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-0000eee0: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
-0000eef0: 6669 6c6c 6e61 2c0a 2020 2020 2020 2020  fillna,.        
-0000ef00: 2020 2020 2020 2020 2a61 7267 732c 0a20          *args,. 
-0000ef10: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0000ef20: 6574 686f 643d 6d65 7468 6f64 2c0a 2020  ethod=method,.  
-0000ef30: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-0000ef40: 6d69 743d 6c69 6d69 742c 0a20 2020 2020  mit=limit,.     
-0000ef50: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-0000ef60: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-0000ef70: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
-0000ef80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ef90: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-0000efa0: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
-0000efb0: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
-0000efc0: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
-0000efd0: 0a0a 2020 2020 2020 2020 6966 206d 6574  ..        if met
-0000efe0: 686f 6420 696e 2028 2270 6164 222c 2022  hod in ("pad", "
-0000eff0: 6666 696c 6c22 293a 0a20 2020 2020 2020  ffill"):.       
-0000f000: 2020 2020 206d 6574 686f 6420 3d20 2266       method = "f
-0000f010: 6669 6c6c 220a 2020 2020 2020 2020 2020  fill".          
-0000f020: 2020 736b 6970 5f63 6865 636b 203d 2030    skip_check = 0
-0000f030: 0a20 2020 2020 2020 2020 2020 2062 6566  .            bef
-0000f040: 6f72 652c 2061 6674 6572 203d 2031 2069  ore, after = 1 i
-0000f050: 6620 6c69 6d69 7420 6973 204e 6f6e 6520  f limit is None 
-0000f060: 656c 7365 206c 696d 6974 2c20 300a 2020  else limit, 0.  
-0000f070: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000f080: 2020 2020 2020 2020 6d65 7468 6f64 203d          method =
-0000f090: 2022 6266 696c 6c22 0a20 2020 2020 2020   "bfill".       
-0000f0a0: 2020 2020 2073 6b69 705f 6368 6563 6b20       skip_check 
-0000f0b0: 3d20 7365 6c66 2e6e 7061 7274 6974 696f  = self.npartitio
-0000f0c0: 6e73 202d 2031 0a20 2020 2020 2020 2020  ns - 1.         
-0000f0d0: 2020 2062 6566 6f72 652c 2061 6674 6572     before, after
-0000f0e0: 203d 2030 2c20 3120 6966 206c 696d 6974   = 0, 1 if limit
-0000f0f0: 2069 7320 4e6f 6e65 2065 6c73 6520 6c69   is None else li
-0000f100: 6d69 740a 0a20 2020 2020 2020 2069 6620  mit..        if 
-0000f110: 6c69 6d69 7420 6973 204e 6f6e 653a 0a20  limit is None:. 
-0000f120: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-0000f130: 3d20 2266 696c 6c6e 612d 6368 756e 6b2d  = "fillna-chunk-
-0000f140: 2220 2b20 746f 6b65 6e69 7a65 2873 656c  " + tokenize(sel
-0000f150: 662c 206d 6574 686f 6429 0a20 2020 2020  f, method).     
-0000f160: 2020 2020 2020 2064 736b 203d 207b 0a20         dsk = {. 
-0000f170: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0000f180: 6e61 6d65 2c20 6929 3a20 280a 2020 2020  name, i): (.    
-0000f190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f1a0: 6d65 7468 6f64 732e 6669 6c6c 6e61 5f63  methods.fillna_c
-0000f1b0: 6865 636b 2c0a 2020 2020 2020 2020 2020  heck,.          
-0000f1c0: 2020 2020 2020 2020 2020 2873 656c 662e            (self.
-0000f1d0: 5f6e 616d 652c 2069 292c 0a20 2020 2020  _name, i),.     
-0000f1e0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0000f1f0: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
-0000f200: 2020 2020 2020 2020 2020 2069 2021 3d20             i != 
-0000f210: 736b 6970 5f63 6865 636b 2c0a 2020 2020  skip_check,.    
-0000f220: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000f230: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0000f240: 7220 6920 696e 2072 616e 6765 2873 656c  r i in range(sel
-0000f250: 662e 6e70 6172 7469 7469 6f6e 7329 0a20  f.npartitions). 
-0000f260: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-0000f270: 2020 2020 2020 2020 2067 7261 7068 203d           graph =
-0000f280: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-0000f290: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-0000f2a0: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
-0000f2b0: 6e64 656e 6369 6573 3d5b 7365 6c66 5d29  ndencies=[self])
-0000f2c0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-0000f2d0: 7473 203d 206e 6577 5f64 645f 6f62 6a65  ts = new_dd_obje
-0000f2e0: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
-0000f2f0: 6d65 7461 2c20 7365 6c66 2e64 6976 6973  meta, self.divis
-0000f300: 696f 6e73 290a 2020 2020 2020 2020 656c  ions).        el
-0000f310: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000f320: 7061 7274 7320 3d20 7365 6c66 0a0a 2020  parts = self..  
-0000f330: 2020 2020 2020 7265 7475 726e 2070 6172        return par
-0000f340: 7473 2e6d 6170 5f6f 7665 726c 6170 280a  ts.map_overlap(.
-0000f350: 2020 2020 2020 2020 2020 2020 4d2e 6669              M.fi
-0000f360: 6c6c 6e61 2c20 6265 666f 7265 2c20 6166  llna, before, af
-0000f370: 7465 722c 206d 6574 686f 643d 6d65 7468  ter, method=meth
-0000f380: 6f64 2c20 6c69 6d69 743d 6c69 6d69 742c  od, limit=limit,
-0000f390: 206d 6574 613d 6d65 7461 0a20 2020 2020   meta=meta.     
-0000f3a0: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
-0000f3b0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-0000f3c0: 7261 6d65 290a 2020 2020 6465 6620 6666  rame).    def ff
-0000f3d0: 696c 6c28 7365 6c66 2c20 6178 6973 3d4e  ill(self, axis=N
-0000f3e0: 6f6e 652c 206c 696d 6974 3d4e 6f6e 6529  one, limit=None)
-0000f3f0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0000f400: 2073 656c 662e 6669 6c6c 6e61 286d 6574   self.fillna(met
-0000f410: 686f 643d 2266 6669 6c6c 222c 206c 696d  hod="ffill", lim
-0000f420: 6974 3d6c 696d 6974 2c20 6178 6973 3d61  it=limit, axis=a
-0000f430: 7869 7329 0a0a 2020 2020 4064 6572 6976  xis)..    @deriv
-0000f440: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-0000f450: 7261 6d65 290a 2020 2020 6465 6620 6266  rame).    def bf
-0000f460: 696c 6c28 7365 6c66 2c20 6178 6973 3d4e  ill(self, axis=N
-0000f470: 6f6e 652c 206c 696d 6974 3d4e 6f6e 6529  one, limit=None)
-0000f480: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0000f490: 2073 656c 662e 6669 6c6c 6e61 286d 6574   self.fillna(met
-0000f4a0: 686f 643d 2262 6669 6c6c 222c 206c 696d  hod="bfill", lim
-0000f4b0: 6974 3d6c 696d 6974 2c20 6178 6973 3d61  it=limit, axis=a
-0000f4c0: 7869 7329 0a0a 2020 2020 6465 6620 7361  xis)..    def sa
-0000f4d0: 6d70 6c65 2873 656c 662c 206e 3d4e 6f6e  mple(self, n=Non
-0000f4e0: 652c 2066 7261 633d 4e6f 6e65 2c20 7265  e, frac=None, re
-0000f4f0: 706c 6163 653d 4661 6c73 652c 2072 616e  place=False, ran
-0000f500: 646f 6d5f 7374 6174 653d 4e6f 6e65 293a  dom_state=None):
-0000f510: 0a20 2020 2020 2020 2022 2222 5261 6e64  .        """Rand
-0000f520: 6f6d 2073 616d 706c 6520 6f66 2069 7465  om sample of ite
-0000f530: 6d73 0a0a 2020 2020 2020 2020 5061 7261  ms..        Para
-0000f540: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-0000f550: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0000f560: 2020 6e20 3a20 696e 742c 206f 7074 696f    n : int, optio
-0000f570: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-0000f580: 4e75 6d62 6572 206f 6620 6974 656d 7320  Number of items 
-0000f590: 746f 2072 6574 7572 6e20 6973 206e 6f74  to return is not
-0000f5a0: 2073 7570 706f 7274 6564 2062 7920 6461   supported by da
-0000f5b0: 736b 2e20 5573 6520 6672 6163 0a20 2020  sk. Use frac.   
-0000f5c0: 2020 2020 2020 2020 2069 6e73 7465 6164           instead
-0000f5d0: 2e0a 2020 2020 2020 2020 6672 6163 203a  ..        frac :
-0000f5e0: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
-0000f5f0: 0a20 2020 2020 2020 2020 2020 2041 7070  .            App
-0000f600: 726f 7869 6d61 7465 2066 7261 6374 696f  roximate fractio
-0000f610: 6e20 6f66 2069 7465 6d73 2074 6f20 7265  n of items to re
-0000f620: 7475 726e 2e20 5468 6973 2073 616d 706c  turn. This sampl
-0000f630: 696e 6720 6672 6163 7469 6f6e 2069 730a  ing fraction is.
-0000f640: 2020 2020 2020 2020 2020 2020 6170 706c              appl
-0000f650: 6965 6420 746f 2061 6c6c 2070 6172 7469  ied to all parti
-0000f660: 7469 6f6e 7320 6571 7561 6c6c 792e 204e  tions equally. N
-0000f670: 6f74 6520 7468 6174 2074 6869 7320 6973  ote that this is
-0000f680: 2061 6e0a 2020 2020 2020 2020 2020 2020   an.            
-0000f690: 2a2a 6170 7072 6f78 696d 6174 6520 6672  **approximate fr
-0000f6a0: 6163 7469 6f6e 2a2a 2e20 596f 7520 7368  action**. You sh
-0000f6b0: 6f75 6c64 206e 6f74 2065 7870 6563 7420  ould not expect 
-0000f6c0: 6578 6163 746c 7920 6060 6c65 6e28 6466  exactly ``len(df
-0000f6d0: 2920 2a20 6672 6163 6060 0a20 2020 2020  ) * frac``.     
-0000f6e0: 2020 2020 2020 2069 7465 6d73 2074 6f20         items to 
-0000f6f0: 6265 2072 6574 7572 6e65 642c 2061 7320  be returned, as 
-0000f700: 7468 6520 6578 6163 7420 6e75 6d62 6572  the exact number
-0000f710: 206f 6620 656c 656d 656e 7473 2073 656c   of elements sel
-0000f720: 6563 7465 6420 7769 6c6c 0a20 2020 2020  ected will.     
-0000f730: 2020 2020 2020 2064 6570 656e 6420 6f6e         depend on
-0000f740: 2068 6f77 2079 6f75 7220 6461 7461 2069   how your data i
-0000f750: 7320 7061 7274 6974 696f 6e65 6420 2862  s partitioned (b
-0000f760: 7574 2073 686f 756c 6420 6265 2070 7265  ut should be pre
-0000f770: 7474 7920 636c 6f73 650a 2020 2020 2020  tty close.      
-0000f780: 2020 2020 2020 696e 2070 7261 6374 6963        in practic
-0000f790: 6529 2e0a 2020 2020 2020 2020 7265 706c  e)..        repl
-0000f7a0: 6163 6520 3a20 626f 6f6c 6561 6e2c 206f  ace : boolean, o
-0000f7b0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-0000f7c0: 2020 2020 5361 6d70 6c65 2077 6974 6820      Sample with 
-0000f7d0: 6f72 2077 6974 686f 7574 2072 6570 6c61  or without repla
-0000f7e0: 6365 6d65 6e74 2e20 4465 6661 756c 7420  cement. Default 
-0000f7f0: 3d20 4661 6c73 652e 0a20 2020 2020 2020  = False..       
-0000f800: 2072 616e 646f 6d5f 7374 6174 6520 3a20   random_state : 
-0000f810: 696e 7420 6f72 2060 606e 702e 7261 6e64  int or ``np.rand
-0000f820: 6f6d 2e52 616e 646f 6d53 7461 7465 6060  om.RandomState``
-0000f830: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-0000f840: 616e 2069 6e74 2c20 7765 2063 7265 6174  an int, we creat
-0000f850: 6520 6120 6e65 7720 5261 6e64 6f6d 5374  e a new RandomSt
-0000f860: 6174 6520 7769 7468 2074 6869 7320 6173  ate with this as
-0000f870: 2074 6865 2073 6565 643b 0a20 2020 2020   the seed;.     
-0000f880: 2020 2020 2020 204f 7468 6572 7769 7365         Otherwise
-0000f890: 2077 6520 6472 6177 2066 726f 6d20 7468   we draw from th
-0000f8a0: 6520 7061 7373 6564 2052 616e 646f 6d53  e passed RandomS
-0000f8b0: 7461 7465 2e0a 0a20 2020 2020 2020 2053  tate...        S
-0000f8c0: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
-0000f8d0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0000f8e0: 2044 6174 6146 7261 6d65 2e72 616e 646f   DataFrame.rando
-0000f8f0: 6d5f 7370 6c69 740a 2020 2020 2020 2020  m_split.        
-0000f900: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
-0000f910: 2e73 616d 706c 650a 2020 2020 2020 2020  .sample.        
-0000f920: 2222 220a 2020 2020 2020 2020 6966 206e  """.        if n
-0000f930: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0000f940: 2020 2020 2020 2020 2020 6d73 6720 3d20            msg = 
-0000f950: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000f960: 2020 2273 616d 706c 6520 646f 6573 206e    "sample does n
-0000f970: 6f74 2073 7570 706f 7274 2074 6865 206e  ot support the n
-0000f980: 756d 6265 7220 6f66 2073 616d 706c 6564  umber of sampled
-0000f990: 2069 7465 6d73 2022 0a20 2020 2020 2020   items ".       
-0000f9a0: 2020 2020 2020 2020 2022 7061 7261 6d65           "parame
-0000f9b0: 7465 722c 2027 6e27 2e20 506c 6561 7365  ter, 'n'. Please
-0000f9c0: 2075 7365 2074 6865 2027 6672 6163 2720   use the 'frac' 
-0000f9d0: 7061 7261 6d65 7465 7220 696e 7374 6561  parameter instea
-0000f9e0: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
-0000f9f0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-0000fa00: 2069 7369 6e73 7461 6e63 6528 6e2c 204e   isinstance(n, N
-0000fa10: 756d 6265 7229 2061 6e64 2030 203c 3d20  umber) and 0 <= 
-0000fa20: 6e20 3c3d 2031 3a0a 2020 2020 2020 2020  n <= 1:.        
-0000fa30: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-0000fa40: 2e77 6172 6e28 6d73 6729 0a20 2020 2020  .warn(msg).     
-0000fa50: 2020 2020 2020 2020 2020 2066 7261 6320             frac 
-0000fa60: 3d20 6e0a 2020 2020 2020 2020 2020 2020  = n.            
-0000fa70: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000fa80: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0000fa90: 6545 7272 6f72 286d 7367 290a 0a20 2020  eError(msg)..   
-0000faa0: 2020 2020 2069 6620 6672 6163 2069 7320       if frac is 
-0000fab0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000fac0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0000fad0: 6f72 2822 6672 6163 206d 7573 7420 6e6f  or("frac must no
-0000fae0: 7420 6265 204e 6f6e 6522 290a 0a20 2020  t be None")..   
-0000faf0: 2020 2020 2069 6620 7261 6e64 6f6d 5f73       if random_s
-0000fb00: 7461 7465 2069 7320 4e6f 6e65 3a0a 2020  tate is None:.  
-0000fb10: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
-0000fb20: 5f73 7461 7465 203d 206e 702e 7261 6e64  _state = np.rand
-0000fb30: 6f6d 2e52 616e 646f 6d53 7461 7465 2829  om.RandomState()
-0000fb40: 0a0a 2020 2020 2020 2020 6e61 6d65 203d  ..        name =
-0000fb50: 2022 7361 6d70 6c65 2d22 202b 2074 6f6b   "sample-" + tok
-0000fb60: 656e 697a 6528 7365 6c66 2c20 6672 6163  enize(self, frac
-0000fb70: 2c20 7265 706c 6163 652c 2072 616e 646f  , replace, rando
-0000fb80: 6d5f 7374 6174 6529 0a0a 2020 2020 2020  m_state)..      
-0000fb90: 2020 7374 6174 655f 6461 7461 203d 2072    state_data = r
-0000fba0: 616e 646f 6d5f 7374 6174 655f 6461 7461  andom_state_data
-0000fbb0: 2873 656c 662e 6e70 6172 7469 7469 6f6e  (self.npartition
-0000fbc0: 732c 2072 616e 646f 6d5f 7374 6174 6529  s, random_state)
-0000fbd0: 0a20 2020 2020 2020 2064 736b 203d 207b  .        dsk = {
-0000fbe0: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
-0000fbf0: 6d65 2c20 6929 3a20 286d 6574 686f 6473  me, i): (methods
-0000fc00: 2e73 616d 706c 652c 2028 7365 6c66 2e5f  .sample, (self._
-0000fc10: 6e61 6d65 2c20 6929 2c20 7374 6174 652c  name, i), state,
-0000fc20: 2066 7261 632c 2072 6570 6c61 6365 290a   frac, replace).
-0000fc30: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0000fc40: 692c 2073 7461 7465 2069 6e20 656e 756d  i, state in enum
-0000fc50: 6572 6174 6528 7374 6174 655f 6461 7461  erate(state_data
-0000fc60: 290a 2020 2020 2020 2020 7d0a 0a20 2020  ).        }..   
-0000fc70: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
-0000fc80: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-0000fc90: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
-0000fca0: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
-0000fcb0: 6369 6573 3d5b 7365 6c66 5d29 0a20 2020  cies=[self]).   
-0000fcc0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-0000fcd0: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
-0000fce0: 206e 616d 652c 2073 656c 662e 5f6d 6574   name, self._met
-0000fcf0: 612c 2073 656c 662e 6469 7669 7369 6f6e  a, self.division
-0000fd00: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
-0000fd10: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0000fd20: 6d65 290a 2020 2020 6465 6620 7265 706c  me).    def repl
-0000fd30: 6163 6528 7365 6c66 2c20 746f 5f72 6570  ace(self, to_rep
-0000fd40: 6c61 6365 3d4e 6f6e 652c 2076 616c 7565  lace=None, value
-0000fd50: 3d4e 6f6e 652c 2072 6567 6578 3d46 616c  =None, regex=Fal
-0000fd60: 7365 293a 0a20 2020 2020 2020 2023 2049  se):.        # I
-0000fd70: 6e20 5041 4e44 4153 5f47 545f 3134 3020  n PANDAS_GT_140 
-0000fd80: 7061 6e64 6173 2073 7461 7274 7320 7573  pandas starts us
-0000fd90: 696e 6720 6e6f 5f64 6566 6175 6c74 2069  ing no_default i
-0000fda0: 6e73 7465 6164 206f 6620 4e6f 6e65 0a20  nstead of None. 
-0000fdb0: 2020 2020 2020 2076 616c 7565 5f6b 7761         value_kwa
-0000fdc0: 7267 203d 207b 2276 616c 7565 223a 2076  rg = {"value": v
-0000fdd0: 616c 7565 7d20 6966 2076 616c 7565 2069  alue} if value i
-0000fde0: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
-0000fdf0: 7b7d 0a20 2020 2020 2020 2072 6574 7572  {}.        retur
-0000fe00: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
-0000fe10: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
-0000fe20: 2020 204d 2e72 6570 6c61 6365 2c0a 2020     M.replace,.  
-0000fe30: 2020 2020 2020 2020 2020 746f 5f72 6570            to_rep
-0000fe40: 6c61 6365 3d74 6f5f 7265 706c 6163 652c  lace=to_replace,
-0000fe50: 0a20 2020 2020 2020 2020 2020 202a 2a76  .            **v
-0000fe60: 616c 7565 5f6b 7761 7267 2c0a 2020 2020  alue_kwarg,.    
-0000fe70: 2020 2020 2020 2020 7265 6765 783d 7265          regex=re
-0000fe80: 6765 782c 0a20 2020 2020 2020 2020 2020  gex,.           
-0000fe90: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-0000fea0: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
-0000feb0: 2029 0a0a 2020 2020 6465 6620 746f 5f64   )..    def to_d
-0000fec0: 6173 6b5f 6172 7261 7928 7365 6c66 2c20  ask_array(self, 
-0000fed0: 6c65 6e67 7468 733d 4e6f 6e65 2c20 6d65  lengths=None, me
-0000fee0: 7461 3d4e 6f6e 6529 3a0a 2020 2020 2020  ta=None):.      
-0000fef0: 2020 2222 2243 6f6e 7665 7274 2061 2064    """Convert a d
-0000ff00: 6173 6b20 4461 7461 4672 616d 6520 746f  ask DataFrame to
-0000ff10: 2061 2064 6173 6b20 6172 7261 792e 0a0a   a dask array...
-0000ff20: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0000ff30: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0000ff40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6c65  -----.        le
-0000ff50: 6e67 7468 7320 3a20 626f 6f6c 206f 7220  ngths : bool or 
-0000ff60: 5365 7175 656e 6365 206f 6620 696e 7473  Sequence of ints
-0000ff70: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-0000ff80: 2020 2020 2020 2048 6f77 2074 6f20 6465         How to de
-0000ff90: 7465 726d 696e 6520 7468 6520 6368 756e  termine the chun
-0000ffa0: 6b73 2073 697a 6573 2066 6f72 2074 6865  ks sizes for the
-0000ffb0: 206f 7574 7075 7420 6172 7261 792e 0a20   output array.. 
-0000ffc0: 2020 2020 2020 2020 2020 2042 7920 6465             By de
-0000ffd0: 6661 756c 742c 2074 6865 206f 7574 7075  fault, the outpu
-0000ffe0: 7420 6172 7261 7920 7769 6c6c 2068 6176  t array will hav
-0000fff0: 6520 756e 6b6e 6f77 6e20 6368 756e 6b20  e unknown chunk 
-00010000: 6c65 6e67 7468 730a 2020 2020 2020 2020  lengths.        
-00010010: 2020 2020 616c 6f6e 6720 7468 6520 6669      along the fi
-00010020: 7273 7420 6178 6973 2c20 7768 6963 6820  rst axis, which 
-00010030: 6361 6e20 6361 7573 6520 736f 6d65 206c  can cause some l
-00010040: 6174 6572 206f 7065 7261 7469 6f6e 730a  ater operations.
-00010050: 2020 2020 2020 2020 2020 2020 746f 2066              to f
-00010060: 6169 6c2e 0a0a 2020 2020 2020 2020 2020  ail...          
-00010070: 2020 2a20 5472 7565 203a 2069 6d6d 6564    * True : immed
-00010080: 6961 7465 6c79 2063 6f6d 7075 7465 2074  iately compute t
-00010090: 6865 206c 656e 6774 6820 6f66 2065 6163  he length of eac
-000100a0: 6820 7061 7274 6974 696f 6e0a 2020 2020  h partition.    
-000100b0: 2020 2020 2020 2020 2a20 5365 7175 656e          * Sequen
-000100c0: 6365 203a 2061 2073 6571 7565 6e63 6520  ce : a sequence 
-000100d0: 6f66 2069 6e74 6567 6572 7320 746f 2075  of integers to u
-000100e0: 7365 2066 6f72 2074 6865 2063 6875 6e6b  se for the chunk
-000100f0: 2073 697a 6573 0a20 2020 2020 2020 2020   sizes.         
-00010100: 2020 2020 206f 6e20 7468 6520 6669 7273       on the firs
-00010110: 7420 6178 6973 2e20 5468 6573 6520 7661  t axis. These va
-00010120: 6c75 6573 2061 7265 202a 6e6f 742a 2076  lues are *not* v
-00010130: 616c 6964 6174 6564 2066 6f72 0a20 2020  alidated for.   
-00010140: 2020 2020 2020 2020 2020 2063 6f72 7265             corre
-00010150: 6374 6e65 7373 2c20 6265 796f 6e64 2065  ctness, beyond e
-00010160: 6e73 7572 696e 6720 7468 6174 2074 6865  nsuring that the
-00010170: 206e 756d 6265 7220 6f66 2069 7465 6d73   number of items
-00010180: 0a20 2020 2020 2020 2020 2020 2020 206d  .              m
-00010190: 6174 6368 6573 2074 6865 206e 756d 6265  atches the numbe
-000101a0: 7220 6f66 2070 6172 7469 7469 6f6e 732e  r of partitions.
-000101b0: 0a20 2020 2020 2020 206d 6574 6120 3a20  .        meta : 
-000101c0: 6f62 6a65 6374 2c20 6f70 7469 6f6e 616c  object, optional
-000101d0: 0a20 2020 2020 2020 2020 2020 2041 6e20  .            An 
-000101e0: 6f70 7469 6f6e 616c 2060 6d65 7461 6020  optional `meta` 
-000101f0: 7061 7261 6d65 7465 7220 6361 6e20 6265  parameter can be
-00010200: 2070 6173 7365 6420 666f 7220 6461 736b   passed for dask
-00010210: 2074 6f20 6f76 6572 7269 6465 2074 6865   to override the
-00010220: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
-00010230: 6175 6c74 206d 6574 6164 6174 6120 6f6e  ault metadata on
-00010240: 2074 6865 2075 6e64 6572 6c79 696e 6720   the underlying 
-00010250: 6461 736b 2061 7272 6179 2e0a 0a20 2020  dask array...   
-00010260: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-00010270: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00010280: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00010290: 2069 6620 6c65 6e67 7468 7320 6973 2054   if lengths is T
-000102a0: 7275 653a 0a20 2020 2020 2020 2020 2020  rue:.           
-000102b0: 206c 656e 6774 6873 203d 2074 7570 6c65   lengths = tuple
-000102c0: 2873 656c 662e 6d61 705f 7061 7274 6974  (self.map_partit
-000102d0: 696f 6e73 286c 656e 2c20 656e 666f 7263  ions(len, enforc
-000102e0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-000102f0: 292e 636f 6d70 7574 6528 2929 0a0a 2020  ).compute())..  
-00010300: 2020 2020 2020 6172 7220 3d20 7365 6c66        arr = self
-00010310: 2e76 616c 7565 730a 0a20 2020 2020 2020  .values..       
-00010320: 2063 6875 6e6b 7320 3d20 7365 6c66 2e5f   chunks = self._
-00010330: 7661 6c69 6461 7465 5f63 6875 6e6b 7328  validate_chunks(
-00010340: 6172 722c 206c 656e 6774 6873 290a 2020  arr, lengths).  
-00010350: 2020 2020 2020 6172 722e 5f63 6875 6e6b        arr._chunk
-00010360: 7320 3d20 6368 756e 6b73 0a0a 2020 2020  s = chunks..    
-00010370: 2020 2020 6966 206d 6574 6120 6973 206e      if meta is n
-00010380: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00010390: 2020 2020 2061 7272 2e5f 6d65 7461 203d       arr._meta =
-000103a0: 206d 6574 610a 0a20 2020 2020 2020 2072   meta..        r
-000103b0: 6574 7572 6e20 6172 720a 0a20 2020 2064  eturn arr..    d
-000103c0: 6566 2074 6f5f 6864 6628 7365 6c66 2c20  ef to_hdf(self, 
-000103d0: 7061 7468 5f6f 725f 6275 662c 206b 6579  path_or_buf, key
-000103e0: 2c20 6d6f 6465 3d22 6122 2c20 6170 7065  , mode="a", appe
-000103f0: 6e64 3d46 616c 7365 2c20 2a2a 6b77 6172  nd=False, **kwar
-00010400: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-00010410: 5365 6520 6464 2e74 6f5f 6864 6620 646f  See dd.to_hdf do
-00010420: 6373 7472 696e 6720 666f 7220 6d6f 7265  cstring for more
-00010430: 2069 6e66 6f72 6d61 7469 6f6e 2222 220a   information""".
-00010440: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00010450: 6b2e 6461 7461 6672 616d 652e 696f 2069  k.dataframe.io i
-00010460: 6d70 6f72 7420 746f 5f68 6466 0a0a 2020  mport to_hdf..  
-00010470: 2020 2020 2020 7265 7475 726e 2074 6f5f        return to_
-00010480: 6864 6628 7365 6c66 2c20 7061 7468 5f6f  hdf(self, path_o
-00010490: 725f 6275 662c 206b 6579 2c20 6d6f 6465  r_buf, key, mode
-000104a0: 2c20 6170 7065 6e64 2c20 2a2a 6b77 6172  , append, **kwar
-000104b0: 6773 290a 0a20 2020 2064 6566 2074 6f5f  gs)..    def to_
-000104c0: 6373 7628 7365 6c66 2c20 6669 6c65 6e61  csv(self, filena
-000104d0: 6d65 2c20 2a2a 6b77 6172 6773 293a 0a20  me, **kwargs):. 
-000104e0: 2020 2020 2020 2022 2222 5365 6520 6464         """See dd
-000104f0: 2e74 6f5f 6373 7620 646f 6373 7472 696e  .to_csv docstrin
-00010500: 6720 666f 7220 6d6f 7265 2069 6e66 6f72  g for more infor
-00010510: 6d61 7469 6f6e 2222 220a 2020 2020 2020  mation""".      
-00010520: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
-00010530: 6672 616d 652e 696f 2069 6d70 6f72 7420  frame.io import 
-00010540: 746f 5f63 7376 0a0a 2020 2020 2020 2020  to_csv..        
-00010550: 7265 7475 726e 2074 6f5f 6373 7628 7365  return to_csv(se
-00010560: 6c66 2c20 6669 6c65 6e61 6d65 2c20 2a2a  lf, filename, **
-00010570: 6b77 6172 6773 290a 0a20 2020 2064 6566  kwargs)..    def
-00010580: 2074 6f5f 7371 6c28 0a20 2020 2020 2020   to_sql(.       
-00010590: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
-000105a0: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
-000105b0: 2020 7572 693a 2073 7472 2c0a 2020 2020    uri: str,.    
-000105c0: 2020 2020 7363 6865 6d61 3d4e 6f6e 652c      schema=None,
-000105d0: 0a20 2020 2020 2020 2069 665f 6578 6973  .        if_exis
-000105e0: 7473 3a20 7374 7220 3d20 2266 6169 6c22  ts: str = "fail"
-000105f0: 2c0a 2020 2020 2020 2020 696e 6465 783a  ,.        index:
-00010600: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
-00010610: 2020 2020 2020 696e 6465 785f 6c61 6265        index_labe
-00010620: 6c3d 4e6f 6e65 2c0a 2020 2020 2020 2020  l=None,.        
-00010630: 6368 756e 6b73 697a 653d 4e6f 6e65 2c0a  chunksize=None,.
-00010640: 2020 2020 2020 2020 6474 7970 653d 4e6f          dtype=No
-00010650: 6e65 2c0a 2020 2020 2020 2020 6d65 7468  ne,.        meth
-00010660: 6f64 3d4e 6f6e 652c 0a20 2020 2020 2020  od=None,.       
-00010670: 2063 6f6d 7075 7465 3d54 7275 652c 0a20   compute=True,. 
-00010680: 2020 2020 2020 2070 6172 616c 6c65 6c3d         parallel=
-00010690: 4661 6c73 652c 0a20 2020 2020 2020 2065  False,.        e
-000106a0: 6e67 696e 655f 6b77 6172 6773 3d4e 6f6e  ngine_kwargs=Non
-000106b0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-000106c0: 2020 2222 2253 6565 2064 642e 746f 5f73    """See dd.to_s
-000106d0: 716c 2064 6f63 7374 7269 6e67 2066 6f72  ql docstring for
-000106e0: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-000106f0: 6e22 2222 0a20 2020 2020 2020 2066 726f  n""".        fro
-00010700: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
-00010710: 2e69 6f20 696d 706f 7274 2074 6f5f 7371  .io import to_sq
-00010720: 6c0a 0a20 2020 2020 2020 2072 6574 7572  l..        retur
-00010730: 6e20 746f 5f73 716c 280a 2020 2020 2020  n to_sql(.      
-00010740: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00010750: 2020 2020 2020 2020 6e61 6d65 3d6e 616d          name=nam
-00010760: 652c 0a20 2020 2020 2020 2020 2020 2075  e,.            u
-00010770: 7269 3d75 7269 2c0a 2020 2020 2020 2020  ri=uri,.        
-00010780: 2020 2020 7363 6865 6d61 3d73 6368 656d      schema=schem
-00010790: 612c 0a20 2020 2020 2020 2020 2020 2069  a,.            i
-000107a0: 665f 6578 6973 7473 3d69 665f 6578 6973  f_exists=if_exis
-000107b0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-000107c0: 696e 6465 783d 696e 6465 782c 0a20 2020  index=index,.   
-000107d0: 2020 2020 2020 2020 2069 6e64 6578 5f6c           index_l
-000107e0: 6162 656c 3d69 6e64 6578 5f6c 6162 656c  abel=index_label
-000107f0: 2c0a 2020 2020 2020 2020 2020 2020 6368  ,.            ch
-00010800: 756e 6b73 697a 653d 6368 756e 6b73 697a  unksize=chunksiz
-00010810: 652c 0a20 2020 2020 2020 2020 2020 2064  e,.            d
-00010820: 7479 7065 3d64 7479 7065 2c0a 2020 2020  type=dtype,.    
-00010830: 2020 2020 2020 2020 6d65 7468 6f64 3d6d          method=m
-00010840: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
-00010850: 2020 2063 6f6d 7075 7465 3d63 6f6d 7075     compute=compu
-00010860: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
-00010870: 7061 7261 6c6c 656c 3d70 6172 616c 6c65  parallel=paralle
-00010880: 6c2c 0a20 2020 2020 2020 2020 2020 2065  l,.            e
-00010890: 6e67 696e 655f 6b77 6172 6773 3d65 6e67  ngine_kwargs=eng
-000108a0: 696e 655f 6b77 6172 6773 2c0a 2020 2020  ine_kwargs,.    
-000108b0: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
-000108c0: 6f5f 6a73 6f6e 2873 656c 662c 2066 696c  o_json(self, fil
-000108d0: 656e 616d 652c 202a 6172 6773 2c20 2a2a  ename, *args, **
-000108e0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-000108f0: 2022 2222 5365 6520 6464 2e74 6f5f 6a73   """See dd.to_js
-00010900: 6f6e 2064 6f63 7374 7269 6e67 2066 6f72  on docstring for
-00010910: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-00010920: 6e22 2222 0a20 2020 2020 2020 2066 726f  n""".        fro
-00010930: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
-00010940: 2e69 6f20 696d 706f 7274 2074 6f5f 6a73  .io import to_js
-00010950: 6f6e 0a0a 2020 2020 2020 2020 7265 7475  on..        retu
-00010960: 726e 2074 6f5f 6a73 6f6e 2873 656c 662c  rn to_json(self,
-00010970: 2066 696c 656e 616d 652c 202a 6172 6773   filename, *args
-00010980: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
-00010990: 2064 6566 2074 6f5f 6465 6c61 7965 6428   def to_delayed(
-000109a0: 7365 6c66 2c20 6f70 7469 6d69 7a65 5f67  self, optimize_g
-000109b0: 7261 7068 3d54 7275 6529 3a0a 2020 2020  raph=True):.    
-000109c0: 2020 2020 2222 2243 6f6e 7665 7274 2069      """Convert i
-000109d0: 6e74 6f20 6120 6c69 7374 206f 6620 6060  nto a list of ``
-000109e0: 6461 736b 2e64 656c 6179 6564 6060 206f  dask.delayed`` o
-000109f0: 626a 6563 7473 2c20 6f6e 6520 7065 7220  bjects, one per 
-00010a00: 7061 7274 6974 696f 6e2e 0a0a 2020 2020  partition...    
-00010a10: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00010a20: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00010a30: 2d0a 2020 2020 2020 2020 6f70 7469 6d69  -.        optimi
-00010a40: 7a65 5f67 7261 7068 203a 2062 6f6f 6c2c  ze_graph : bool,
-00010a50: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00010a60: 2020 2020 2020 4966 2054 7275 6520 5b64        If True [d
-00010a70: 6566 6175 6c74 5d2c 2074 6865 2067 7261  efault], the gra
-00010a80: 7068 2069 7320 6f70 7469 6d69 7a65 6420  ph is optimized 
-00010a90: 6265 666f 7265 2063 6f6e 7665 7274 696e  before convertin
-00010aa0: 6720 696e 746f 0a20 2020 2020 2020 2020  g into.         
-00010ab0: 2020 2060 6064 6173 6b2e 6465 6c61 7965     ``dask.delaye
-00010ac0: 6460 6020 6f62 6a65 6374 732e 0a0a 2020  d`` objects...  
-00010ad0: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
-00010ae0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00010af0: 2020 2020 2020 2020 3e3e 3e20 7061 7274          >>> part
-00010b00: 6974 696f 6e73 203d 2064 662e 746f 5f64  itions = df.to_d
-00010b10: 656c 6179 6564 2829 2020 2320 646f 6374  elayed()  # doct
-00010b20: 6573 743a 202b 534b 4950 0a0a 2020 2020  est: +SKIP..    
-00010b30: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-00010b40: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-00010b50: 2020 2020 2020 6461 736b 2e64 6174 6166        dask.dataf
-00010b60: 7261 6d65 2e66 726f 6d5f 6465 6c61 7965  rame.from_delaye
-00010b70: 640a 2020 2020 2020 2020 2222 220a 2020  d.        """.  
-00010b80: 2020 2020 2020 6b65 7973 203d 2073 656c        keys = sel
-00010b90: 662e 5f5f 6461 736b 5f6b 6579 735f 5f28  f.__dask_keys__(
-00010ba0: 290a 2020 2020 2020 2020 6772 6170 6820  ).        graph 
-00010bb0: 3d20 7365 6c66 2e5f 5f64 6173 6b5f 6772  = self.__dask_gr
-00010bc0: 6170 685f 5f28 290a 2020 2020 2020 2020  aph__().        
-00010bd0: 6c61 7965 7220 3d20 7365 6c66 2e5f 5f64  layer = self.__d
-00010be0: 6173 6b5f 6c61 7965 7273 5f5f 2829 5b30  ask_layers__()[0
-00010bf0: 5d0a 2020 2020 2020 2020 6966 206f 7074  ].        if opt
-00010c00: 696d 697a 655f 6772 6170 683a 0a20 2020  imize_graph:.   
-00010c10: 2020 2020 2020 2020 2067 7261 7068 203d           graph =
-00010c20: 2073 656c 662e 5f5f 6461 736b 5f6f 7074   self.__dask_opt
-00010c30: 696d 697a 655f 5f28 6772 6170 682c 2073  imize__(graph, s
-00010c40: 656c 662e 5f5f 6461 736b 5f6b 6579 735f  elf.__dask_keys_
-00010c50: 5f28 2929 0a20 2020 2020 2020 2020 2020  _()).           
-00010c60: 206c 6179 6572 203d 2022 6465 6c61 7965   layer = "delaye
-00010c70: 642d 2220 2b20 7365 6c66 2e5f 6e61 6d65  d-" + self._name
-00010c80: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
-00010c90: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
-00010ca0: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
-00010cb0: 696f 6e73 286c 6179 6572 2c20 6772 6170  ions(layer, grap
-00010cc0: 682c 2064 6570 656e 6465 6e63 6965 733d  h, dependencies=
-00010cd0: 2829 290a 2020 2020 2020 2020 7265 7475  ()).        retu
-00010ce0: 726e 205b 4465 6c61 7965 6428 6b2c 2067  rn [Delayed(k, g
-00010cf0: 7261 7068 2c20 6c61 7965 723d 6c61 7965  raph, layer=laye
-00010d00: 7229 2066 6f72 206b 2069 6e20 6b65 7973  r) for k in keys
-00010d10: 5d0a 0a20 2020 2064 6566 2074 6f5f 6261  ]..    def to_ba
-00010d20: 636b 656e 6428 7365 6c66 2c20 6261 636b  ckend(self, back
-00010d30: 656e 643a 2073 7472 207c 204e 6f6e 6520  end: str | None 
-00010d40: 3d20 4e6f 6e65 2c20 2a2a 6b77 6172 6773  = None, **kwargs
-00010d50: 293a 0a20 2020 2020 2020 2022 2222 4d6f  ):.        """Mo
-00010d60: 7665 2074 6f20 6120 6e65 7720 4461 7461  ve to a new Data
-00010d70: 4672 616d 6520 6261 636b 656e 640a 0a20  Frame backend.. 
-00010d80: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00010d90: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00010da0: 2d2d 2d2d 0a20 2020 2020 2020 2062 6163  ----.        bac
-00010db0: 6b65 6e64 203a 2073 7472 2c20 4f70 7469  kend : str, Opti
-00010dc0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00010dd0: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
-00010de0: 206e 6577 2062 6163 6b65 6e64 2074 6f20   new backend to 
-00010df0: 6d6f 7665 2074 6f2e 2054 6865 2064 6566  move to. The def
-00010e00: 6175 6c74 0a20 2020 2020 2020 2020 2020  ault.           
-00010e10: 2069 7320 7468 6520 6375 7272 656e 7420   is the current 
-00010e20: 2264 6174 6166 7261 6d65 2e62 6163 6b65  "dataframe.backe
-00010e30: 6e64 2220 636f 6e66 6967 7572 6174 696f  nd" configuratio
-00010e40: 6e2e 0a0a 2020 2020 2020 2020 5265 7475  n...        Retu
-00010e50: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-00010e60: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
-00010e70: 4672 616d 652c 2053 6572 6965 7320 6f72  Frame, Series or
-00010e80: 2049 6e64 6578 0a20 2020 2020 2020 2022   Index.        "
-00010e90: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
-00010ea0: 6461 736b 2e64 6174 6166 7261 6d65 2e69  dask.dataframe.i
-00010eb0: 6f20 696d 706f 7274 2074 6f5f 6261 636b  o import to_back
-00010ec0: 656e 640a 0a20 2020 2020 2020 2072 6574  end..        ret
-00010ed0: 7572 6e20 746f 5f62 6163 6b65 6e64 2873  urn to_backend(s
-00010ee0: 656c 662c 2062 6163 6b65 6e64 3d62 6163  elf, backend=bac
-00010ef0: 6b65 6e64 2c20 2a2a 6b77 6172 6773 290a  kend, **kwargs).
-00010f00: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-00010f10: 640a 2020 2020 6465 6620 5f67 6574 5f75  d.    def _get_u
-00010f20: 6e61 7279 5f6f 7065 7261 746f 7228 636c  nary_operator(cl
-00010f30: 732c 206f 7029 3a0a 2020 2020 2020 2020  s, op):.        
-00010f40: 7265 7475 726e 206c 616d 6264 6120 7365  return lambda se
-00010f50: 6c66 3a20 656c 656d 7769 7365 286f 702c  lf: elemwise(op,
-00010f60: 2073 656c 6629 0a0a 2020 2020 4063 6c61   self)..    @cla
-00010f70: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
-00010f80: 205f 6765 745f 6269 6e61 7279 5f6f 7065   _get_binary_ope
-00010f90: 7261 746f 7228 636c 732c 206f 702c 2069  rator(cls, op, i
-00010fa0: 6e76 3d46 616c 7365 293a 0a20 2020 2020  nv=False):.     
-00010fb0: 2020 2069 6620 696e 763a 0a20 2020 2020     if inv:.     
-00010fc0: 2020 2020 2020 2072 6574 7572 6e20 6c61         return la
-00010fd0: 6d62 6461 2073 656c 662c 206f 7468 6572  mbda self, other
-00010fe0: 3a20 656c 656d 7769 7365 286f 702c 206f  : elemwise(op, o
-00010ff0: 7468 6572 2c20 7365 6c66 290a 2020 2020  ther, self).    
-00011000: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00011010: 2020 2020 2020 7265 7475 726e 206c 616d        return lam
-00011020: 6264 6120 7365 6c66 2c20 6f74 6865 723a  bda self, other:
-00011030: 2065 6c65 6d77 6973 6528 6f70 2c20 7365   elemwise(op, se
-00011040: 6c66 2c20 6f74 6865 7229 0a0a 2020 2020  lf, other)..    
-00011050: 6465 6620 726f 6c6c 696e 6728 0a20 2020  def rolling(.   
-00011060: 2020 2020 2073 656c 662c 2077 696e 646f       self, windo
-00011070: 772c 206d 696e 5f70 6572 696f 6473 3d4e  w, min_periods=N
-00011080: 6f6e 652c 2063 656e 7465 723d 4661 6c73  one, center=Fals
-00011090: 652c 2077 696e 5f74 7970 653d 4e6f 6e65  e, win_type=None
-000110a0: 2c20 6178 6973 3d6e 6f5f 6465 6661 756c  , axis=no_defaul
-000110b0: 740a 2020 2020 293a 0a20 2020 2020 2020  t.    ):.       
-000110c0: 2022 2222 5072 6f76 6964 6573 2072 6f6c   """Provides rol
-000110d0: 6c69 6e67 2074 7261 6e73 666f 726d 6174  ling transformat
-000110e0: 696f 6e73 2e0a 0a20 2020 2020 2020 2050  ions...        P
-000110f0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00011100: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00011110: 2020 2020 2077 696e 646f 7720 3a20 696e       window : in
-00011120: 742c 2073 7472 2c20 6f66 6673 6574 0a20  t, str, offset. 
-00011130: 2020 2020 2020 2020 2020 5369 7a65 206f            Size o
-00011140: 6620 7468 6520 6d6f 7669 6e67 2077 696e  f the moving win
-00011150: 646f 772e 2054 6869 7320 6973 2074 6865  dow. This is the
-00011160: 206e 756d 6265 7220 6f66 206f 6273 6572   number of obser
-00011170: 7661 7469 6f6e 7320 7573 6564 0a20 2020  vations used.   
-00011180: 2020 2020 2020 2020 666f 7220 6361 6c63          for calc
-00011190: 756c 6174 696e 6720 7468 6520 7374 6174  ulating the stat
-000111a0: 6973 7469 632e 2057 6865 6e20 6e6f 7420  istic. When not 
-000111b0: 7573 696e 6720 6120 6060 4461 7465 7469  using a ``Dateti
-000111c0: 6d65 496e 6465 7860 602c 0a20 2020 2020  meIndex``,.     
-000111d0: 2020 2020 2020 7468 6520 7769 6e64 6f77        the window
-000111e0: 2073 697a 6520 6d75 7374 206e 6f74 2062   size must not b
-000111f0: 6520 736f 206c 6172 6765 2061 7320 746f  e so large as to
-00011200: 2073 7061 6e20 6d6f 7265 2074 6861 6e20   span more than 
-00011210: 6f6e 650a 2020 2020 2020 2020 2020 2061  one.           a
-00011220: 646a 6163 656e 7420 7061 7274 6974 696f  djacent partitio
-00011230: 6e2e 2049 6620 7573 696e 6720 616e 206f  n. If using an o
-00011240: 6666 7365 7420 6f72 206f 6666 7365 7420  ffset or offset 
-00011250: 616c 6961 7320 6c69 6b65 2027 3544 272c  alias like '5D',
-00011260: 0a20 2020 2020 2020 2020 2020 7468 6520  .           the 
-00011270: 6461 7461 206d 7573 7420 6861 7665 2061  data must have a
-00011280: 2060 6044 6174 6574 696d 6549 6e64 6578   ``DatetimeIndex
-00011290: 6060 0a0a 2020 2020 2020 2020 2020 202e  ``..           .
-000112a0: 2e20 7665 7273 696f 6e63 6861 6e67 6564  . versionchanged
-000112b0: 3a3a 2030 2e31 352e 300a 0a20 2020 2020  :: 0.15.0..     
-000112c0: 2020 2020 2020 2020 204e 6f77 2061 6363           Now acc
-000112d0: 6570 7473 206f 6666 7365 7473 2061 6e64  epts offsets and
-000112e0: 2073 7472 696e 6720 6f66 6673 6574 2061   string offset a
-000112f0: 6c69 6173 6573 0a0a 2020 2020 2020 2020  liases..        
-00011300: 6d69 6e5f 7065 7269 6f64 7320 3a20 696e  min_periods : in
-00011310: 742c 2064 6566 6175 6c74 204e 6f6e 650a  t, default None.
-00011320: 2020 2020 2020 2020 2020 2020 4d69 6e69              Mini
-00011330: 6d75 6d20 6e75 6d62 6572 206f 6620 6f62  mum number of ob
-00011340: 7365 7276 6174 696f 6e73 2069 6e20 7769  servations in wi
-00011350: 6e64 6f77 2072 6571 7569 7265 6420 746f  ndow required to
-00011360: 2068 6176 6520 6120 7661 6c75 650a 2020   have a value.  
-00011370: 2020 2020 2020 2020 2020 286f 7468 6572            (other
-00011380: 7769 7365 2072 6573 756c 7420 6973 204e  wise result is N
-00011390: 4129 2e0a 2020 2020 2020 2020 6365 6e74  A)..        cent
-000113a0: 6572 203a 2062 6f6f 6c65 616e 2c20 6465  er : boolean, de
-000113b0: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
-000113c0: 2020 2020 2020 2020 5365 7420 7468 6520          Set the 
-000113d0: 6c61 6265 6c73 2061 7420 7468 6520 6365  labels at the ce
-000113e0: 6e74 6572 206f 6620 7468 6520 7769 6e64  nter of the wind
-000113f0: 6f77 2e0a 2020 2020 2020 2020 7769 6e5f  ow..        win_
-00011400: 7479 7065 203a 2073 7472 696e 672c 2064  type : string, d
-00011410: 6566 6175 6c74 204e 6f6e 650a 2020 2020  efault None.    
-00011420: 2020 2020 2020 2020 5072 6f76 6964 6520          Provide 
-00011430: 6120 7769 6e64 6f77 2074 7970 652e 2054  a window type. T
-00011440: 6865 2072 6563 6f67 6e69 7a65 6420 7769  he recognized wi
-00011450: 6e64 6f77 2074 7970 6573 2061 7265 2069  ndow types are i
-00011460: 6465 6e74 6963 616c 0a20 2020 2020 2020  dentical.       
-00011470: 2020 2020 2074 6f20 7061 6e64 6173 2e0a       to pandas..
-00011480: 2020 2020 2020 2020 6178 6973 203a 2069          axis : i
-00011490: 6e74 2c20 7374 722c 204e 6f6e 652c 2064  nt, str, None, d
-000114a0: 6566 6175 6c74 2030 0a20 2020 2020 2020  efault 0.       
-000114b0: 2020 2020 2054 6869 7320 7061 7261 6d65       This parame
-000114c0: 7465 7220 6973 2064 6570 7265 6361 7465  ter is deprecate
-000114d0: 6420 7769 7468 2060 6070 616e 6461 733e  d with ``pandas>
-000114e0: 3d32 2e31 6060 2e0a 0a20 2020 2020 2020  =2.1``...       
-000114f0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-00011500: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-00011510: 2061 2052 6f6c 6c69 6e67 206f 626a 6563   a Rolling objec
-00011520: 7420 6f6e 2077 6869 6368 2074 6f20 6361  t on which to ca
-00011530: 6c6c 2061 206d 6574 686f 6420 746f 2063  ll a method to c
-00011540: 6f6d 7075 7465 2061 2073 7461 7469 7374  ompute a statist
-00011550: 6963 0a20 2020 2020 2020 2022 2222 0a20  ic.        """. 
-00011560: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-00011570: 2e64 6174 6166 7261 6d65 2e72 6f6c 6c69  .dataframe.rolli
-00011580: 6e67 2069 6d70 6f72 7420 526f 6c6c 696e  ng import Rollin
-00011590: 670a 0a20 2020 2020 2020 2069 6620 6973  g..        if is
-000115a0: 696e 7374 616e 6365 2877 696e 646f 772c  instance(window,
-000115b0: 2049 6e74 6567 7261 6c29 3a0a 2020 2020   Integral):.    
-000115c0: 2020 2020 2020 2020 6966 2077 696e 646f          if windo
-000115d0: 7720 3c20 303a 0a20 2020 2020 2020 2020  w < 0:.         
-000115e0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-000115f0: 7565 4572 726f 7228 2277 696e 646f 7720  ueError("window 
-00011600: 6d75 7374 2062 6520 3e3d 2030 2229 0a0a  must be >= 0")..
-00011610: 2020 2020 2020 2020 6966 206d 696e 5f70          if min_p
-00011620: 6572 696f 6473 2069 7320 6e6f 7420 4e6f  eriods is not No
-00011630: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00011640: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00011650: 6528 6d69 6e5f 7065 7269 6f64 732c 2049  e(min_periods, I
-00011660: 6e74 6567 7261 6c29 3a0a 2020 2020 2020  ntegral):.      
-00011670: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00011680: 5661 6c75 6545 7272 6f72 2822 6d69 6e5f  ValueError("min_
-00011690: 7065 7269 6f64 7320 6d75 7374 2062 6520  periods must be 
-000116a0: 616e 2069 6e74 6567 6572 2229 0a20 2020  an integer").   
-000116b0: 2020 2020 2020 2020 2069 6620 6d69 6e5f           if min_
-000116c0: 7065 7269 6f64 7320 3c20 303a 0a20 2020  periods < 0:.   
-000116d0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-000116e0: 7365 2056 616c 7565 4572 726f 7228 226d  se ValueError("m
-000116f0: 696e 5f70 6572 696f 6473 206d 7573 7420  in_periods must 
-00011700: 6265 203e 3d20 3022 290a 0a20 2020 2020  be >= 0")..     
-00011710: 2020 2072 6574 7572 6e20 526f 6c6c 696e     return Rollin
-00011720: 6728 0a20 2020 2020 2020 2020 2020 2073  g(.            s
-00011730: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-00011740: 2077 696e 646f 773d 7769 6e64 6f77 2c0a   window=window,.
-00011750: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
-00011760: 7065 7269 6f64 733d 6d69 6e5f 7065 7269  periods=min_peri
-00011770: 6f64 732c 0a20 2020 2020 2020 2020 2020  ods,.           
-00011780: 2063 656e 7465 723d 6365 6e74 6572 2c0a   center=center,.
-00011790: 2020 2020 2020 2020 2020 2020 7769 6e5f              win_
-000117a0: 7479 7065 3d77 696e 5f74 7970 652c 0a20  type=win_type,. 
-000117b0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-000117c0: 6178 6973 2c0a 2020 2020 2020 2020 290a  axis,.        ).
-000117d0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-000117e0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-000117f0: 0a20 2020 2064 6566 2064 6966 6628 7365  .    def diff(se
-00011800: 6c66 2c20 7065 7269 6f64 733d 312c 2061  lf, periods=1, a
-00011810: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
-00011820: 2222 220a 2020 2020 2020 2020 2e2e 206e  """.        .. n
-00011830: 6f74 653a 3a0a 0a20 2020 2020 2020 2020  ote::..         
-00011840: 2020 5061 6e64 6173 2063 7572 7265 6e74    Pandas current
-00011850: 6c79 2075 7365 7320 616e 2060 606f 626a  ly uses an ``obj
-00011860: 6563 7460 602d 6474 7970 6520 636f 6c75  ect``-dtype colu
-00011870: 6d6e 2074 6f20 7265 7072 6573 656e 740a  mn to represent.
-00011880: 2020 2020 2020 2020 2020 2062 6f6f 6c65             boole
-00011890: 616e 2064 6174 6120 7769 7468 206d 6973  an data with mis
-000118a0: 7369 6e67 2076 616c 7565 732e 2054 6869  sing values. Thi
-000118b0: 7320 6361 6e20 6361 7573 6520 6973 7375  s can cause issu
-000118c0: 6573 2066 6f72 0a20 2020 2020 2020 2020  es for.         
-000118d0: 2020 626f 6f6c 6561 6e2d 7370 6563 6966    boolean-specif
-000118e0: 6963 206f 7065 7261 7469 6f6e 732c 206c  ic operations, l
-000118f0: 696b 6520 6060 7c60 602e 2054 6f20 656e  ike ``|``. To en
-00011900: 6162 6c65 2062 6f6f 6c65 616e 2d0a 2020  able boolean-.  
-00011910: 2020 2020 2020 2020 2073 7065 6369 6669           specifi
-00011920: 6320 6f70 6572 6174 696f 6e73 2c20 6174  c operations, at
-00011930: 2074 6865 2063 6f73 7420 6f66 206d 6574   the cost of met
-00011940: 6164 6174 6120 7468 6174 2064 6f65 736e  adata that doesn
-00011950: 2774 206d 6174 6368 0a20 2020 2020 2020  't match.       
-00011960: 2020 2020 7061 6e64 6173 2c20 7573 6520      pandas, use 
-00011970: 6060 2e61 7374 7970 6528 626f 6f6c 2960  ``.astype(bool)`
-00011980: 6020 6166 7465 7220 7468 6520 6060 7368  ` after the ``sh
-00011990: 6966 7460 602e 0a20 2020 2020 2020 2022  ift``..        "
-000119a0: 2222 0a20 2020 2020 2020 2061 7869 7320  "".        axis 
-000119b0: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
-000119c0: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
-000119d0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-000119e0: 7461 6e63 6528 7065 7269 6f64 732c 2049  tance(periods, I
-000119f0: 6e74 6567 7261 6c29 3a0a 2020 2020 2020  ntegral):.      
-00011a00: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00011a10: 4572 726f 7228 2270 6572 696f 6473 206d  Error("periods m
-00011a20: 7573 7420 6265 2061 6e20 696e 7465 6765  ust be an intege
-00011a30: 7222 290a 0a20 2020 2020 2020 2069 6620  r")..        if 
-00011a40: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
-00011a50: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00011a60: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00011a70: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-00011a80: 2020 204d 2e64 6966 662c 2074 6f6b 656e     M.diff, token
-00011a90: 3d22 6469 6666 222c 2070 6572 696f 6473  ="diff", periods
-00011aa0: 3d70 6572 696f 6473 2c20 6178 6973 3d31  =periods, axis=1
-00011ab0: 2c20 656e 666f 7263 655f 6d65 7461 6461  , enforce_metada
-00011ac0: 7461 3d46 616c 7365 0a20 2020 2020 2020  ta=False.       
-00011ad0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00011ae0: 6265 666f 7265 2c20 6166 7465 7220 3d20  before, after = 
-00011af0: 2870 6572 696f 6473 2c20 3029 2069 6620  (periods, 0) if 
-00011b00: 7065 7269 6f64 7320 3e20 3020 656c 7365  periods > 0 else
-00011b10: 2028 302c 202d 7065 7269 6f64 7329 0a20   (0, -periods). 
-00011b20: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00011b30: 6c66 2e6d 6170 5f6f 7665 726c 6170 284d  lf.map_overlap(M
-00011b40: 2e64 6966 662c 2062 6566 6f72 652c 2061  .diff, before, a
-00011b50: 6674 6572 2c20 746f 6b65 6e3d 2264 6966  fter, token="dif
-00011b60: 6622 2c20 7065 7269 6f64 733d 7065 7269  f", periods=peri
-00011b70: 6f64 7329 0a0a 2020 2020 4064 6572 6976  ods)..    @deriv
-00011b80: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-00011b90: 7261 6d65 290a 2020 2020 6465 6620 7368  rame).    def sh
-00011ba0: 6966 7428 7365 6c66 2c20 7065 7269 6f64  ift(self, period
-00011bb0: 733d 312c 2066 7265 713d 4e6f 6e65 2c20  s=1, freq=None, 
-00011bc0: 6178 6973 3d30 293a 0a20 2020 2020 2020  axis=0):.       
-00011bd0: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
-00011be0: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
-00011bf0: 290a 2020 2020 2020 2020 6966 206e 6f74  ).        if not
-00011c00: 2069 7369 6e73 7461 6e63 6528 7065 7269   isinstance(peri
-00011c10: 6f64 732c 2049 6e74 6567 7261 6c29 3a0a  ods, Integral):.
-00011c20: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00011c30: 6520 5479 7065 4572 726f 7228 2270 6572  e TypeError("per
-00011c40: 696f 6473 206d 7573 7420 6265 2061 6e20  iods must be an 
-00011c50: 696e 7465 6765 7222 290a 0a20 2020 2020  integer")..     
-00011c60: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
-00011c70: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00011c80: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
-00011c90: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
-00011ca0: 2020 2020 2020 2020 204d 2e73 6869 6674           M.shift
-00011cb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00011cc0: 2020 746f 6b65 6e3d 2273 6869 6674 222c    token="shift",
-00011cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011ce0: 2070 6572 696f 6473 3d70 6572 696f 6473   periods=periods
-00011cf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00011d00: 2020 6672 6571 3d66 7265 712c 0a20 2020    freq=freq,.   
-00011d10: 2020 2020 2020 2020 2020 2020 2061 7869               axi
-00011d20: 733d 312c 0a20 2020 2020 2020 2020 2020  s=1,.           
-00011d30: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
-00011d40: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
-00011d50: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00011d60: 2020 2020 6966 2066 7265 7120 6973 204e      if freq is N
-00011d70: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00011d80: 2062 6566 6f72 652c 2061 6674 6572 203d   before, after =
-00011d90: 2028 7065 7269 6f64 732c 2030 2920 6966   (periods, 0) if
-00011da0: 2070 6572 696f 6473 203e 2030 2065 6c73   periods > 0 els
-00011db0: 6520 2830 2c20 2d70 6572 696f 6473 290a  e (0, -periods).
-00011dc0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00011dd0: 726e 2073 656c 662e 6d61 705f 6f76 6572  rn self.map_over
-00011de0: 6c61 7028 0a20 2020 2020 2020 2020 2020  lap(.           
-00011df0: 2020 2020 204d 2e73 6869 6674 2c20 6265       M.shift, be
-00011e00: 666f 7265 2c20 6166 7465 722c 2074 6f6b  fore, after, tok
-00011e10: 656e 3d22 7368 6966 7422 2c20 7065 7269  en="shift", peri
-00011e20: 6f64 733d 7065 7269 6f64 730a 2020 2020  ods=periods.    
-00011e30: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00011e40: 2020 2023 204c 6574 2070 616e 6461 7320     # Let pandas 
-00011e50: 6572 726f 7220 6f6e 2069 6e76 616c 6964  error on invalid
-00011e60: 2061 7267 756d 656e 7473 0a20 2020 2020   arguments.     
-00011e70: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
-00011e80: 6d65 7461 5f6e 6f6e 656d 7074 792e 7368  meta_nonempty.sh
-00011e90: 6966 7428 7065 7269 6f64 732c 2066 7265  ift(periods, fre
-00011ea0: 713d 6672 6571 290a 2020 2020 2020 2020  q=freq).        
-00011eb0: 6f75 7420 3d20 7365 6c66 2e6d 6170 5f70  out = self.map_p
-00011ec0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-00011ed0: 2020 2020 2020 204d 2e73 6869 6674 2c0a         M.shift,.
-00011ee0: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-00011ef0: 6e3d 2273 6869 6674 222c 0a20 2020 2020  n="shift",.     
-00011f00: 2020 2020 2020 2070 6572 696f 6473 3d70         periods=p
-00011f10: 6572 696f 6473 2c0a 2020 2020 2020 2020  eriods,.        
-00011f20: 2020 2020 6672 6571 3d66 7265 712c 0a20      freq=freq,. 
-00011f30: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
-00011f40: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-00011f50: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
-00011f60: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
-00011f70: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
-00011f80: 6469 7669 7369 6f6e 733d 4661 6c73 652c  divisions=False,
-00011f90: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00011fa0: 2020 2072 6574 7572 6e20 6d61 7962 655f     return maybe_
-00011fb0: 7368 6966 745f 6469 7669 7369 6f6e 7328  shift_divisions(
-00011fc0: 6f75 742c 2070 6572 696f 6473 2c20 6672  out, periods, fr
-00011fd0: 6571 3d66 7265 7129 0a0a 2020 2020 6465  eq=freq)..    de
-00011fe0: 6620 5f72 6564 7563 7469 6f6e 5f61 6767  f _reduction_agg
-00011ff0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00012000: 2020 2020 2020 2020 6e61 6d65 2c0a 2020          name,.  
-00012010: 2020 2020 2020 6178 6973 3d4e 6f6e 652c        axis=None,
-00012020: 0a20 2020 2020 2020 2073 6b69 706e 613d  .        skipna=
-00012030: 5472 7565 2c0a 2020 2020 2020 2020 7370  True,.        sp
-00012040: 6c69 745f 6576 6572 793d 4661 6c73 652c  lit_every=False,
-00012050: 0a20 2020 2020 2020 206f 7574 3d4e 6f6e  .        out=Non
-00012060: 652c 0a20 2020 2020 2020 206e 756d 6572  e,.        numer
-00012070: 6963 5f6f 6e6c 793d 4e6f 6e65 2c0a 2020  ic_only=None,.  
-00012080: 2020 2020 2020 6e6f 6e65 5f69 735f 7a65        none_is_ze
-00012090: 726f 3d54 7275 652c 0a20 2020 2029 3a0a  ro=True,.    ):.
-000120a0: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
-000120b0: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
-000120c0: 6973 2861 7869 732c 206e 6f6e 655f 6973  is(axis, none_is
-000120d0: 5f7a 6572 6f3d 6e6f 6e65 5f69 735f 7a65  _zero=none_is_ze
-000120e0: 726f 290a 0a20 2020 2020 2020 2069 6620  ro)..        if 
-000120f0: 6861 735f 6b65 7977 6f72 6428 6765 7461  has_keyword(geta
-00012100: 7474 7228 7365 6c66 2e5f 6d65 7461 5f6e  ttr(self._meta_n
-00012110: 6f6e 656d 7074 792c 206e 616d 6529 2c20  onempty, name), 
-00012120: 226e 756d 6572 6963 5f6f 6e6c 7922 293a  "numeric_only"):
-00012130: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-00012140: 6572 6963 5f6f 6e6c 795f 6b77 6172 6773  eric_only_kwargs
-00012150: 203d 207b 226e 756d 6572 6963 5f6f 6e6c   = {"numeric_onl
-00012160: 7922 3a20 6e75 6d65 7269 635f 6f6e 6c79  y": numeric_only
-00012170: 7d0a 2020 2020 2020 2020 656c 7365 3a0a  }.        else:.
-00012180: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
-00012190: 7269 635f 6f6e 6c79 5f6b 7761 7267 7320  ric_only_kwargs 
-000121a0: 3d20 7b7d 0a0a 2020 2020 2020 2020 7769  = {}..        wi
-000121b0: 7468 2063 6865 636b 5f6e 756d 6572 6963  th check_numeric
-000121c0: 5f6f 6e6c 795f 6465 7072 6563 6174 696f  _only_deprecatio
-000121d0: 6e28 6e61 6d65 2c20 5472 7565 293a 0a20  n(name, True):. 
-000121e0: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
-000121f0: 3d20 6765 7461 7474 7228 7365 6c66 2e5f  = getattr(self._
-00012200: 6d65 7461 5f6e 6f6e 656d 7074 792c 206e  meta_nonempty, n
-00012210: 616d 6529 280a 2020 2020 2020 2020 2020  ame)(.          
-00012220: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
-00012230: 2073 6b69 706e 613d 736b 6970 6e61 2c20   skipna=skipna, 
-00012240: 2a2a 6e75 6d65 7269 635f 6f6e 6c79 5f6b  **numeric_only_k
-00012250: 7761 7267 730a 2020 2020 2020 2020 2020  wargs.          
-00012260: 2020 290a 0a20 2020 2020 2020 2074 6f6b    )..        tok
-00012270: 656e 203d 2073 656c 662e 5f74 6f6b 656e  en = self._token
-00012280: 5f70 7265 6669 7820 2b20 6e61 6d65 0a20  _prefix + name. 
-00012290: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-000122a0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-000122b0: 2072 6573 756c 7420 3d20 7365 6c66 2e6d   result = self.m
-000122c0: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-000122d0: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-000122e0: 6765 7461 7474 725f 6e75 6d65 7269 635f  getattr_numeric_
-000122f0: 6f6e 6c79 2c0a 2020 2020 2020 2020 2020  only,.          
-00012300: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
-00012310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012320: 2074 6f6b 656e 3d74 6f6b 656e 2c0a 2020   token=token,.  
-00012330: 2020 2020 2020 2020 2020 2020 2020 736b                sk
-00012340: 6970 6e61 3d73 6b69 706e 612c 0a20 2020  ipna=skipna,.   
-00012350: 2020 2020 2020 2020 2020 2020 2061 7869               axi
-00012360: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
-00012370: 2020 2020 2020 2020 5f64 6173 6b5f 6d65          _dask_me
-00012380: 7468 6f64 5f6e 616d 653d 6e61 6d65 2c0a  thod_name=name,.
-00012390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000123a0: 2a2a 6e75 6d65 7269 635f 6f6e 6c79 5f6b  **numeric_only_k
-000123b0: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
-000123c0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000123d0: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
-000123e0: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
-000123f0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00012400: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00012410: 203d 2073 656c 662e 7265 6475 6374 696f   = self.reductio
-00012420: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00012430: 2020 205f 6765 7461 7474 725f 6e75 6d65     _getattr_nume
-00012440: 7269 635f 6f6e 6c79 2c0a 2020 2020 2020  ric_only,.      
-00012450: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
-00012460: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-00012470: 2020 2020 2074 6f6b 656e 3d74 6f6b 656e       token=token
-00012480: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00012490: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
-000124a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000124b0: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
-000124c0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-000124d0: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-000124e0: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
-000124f0: 2020 2020 205f 6461 736b 5f6d 6574 686f       _dask_metho
-00012500: 645f 6e61 6d65 3d6e 616d 652c 0a20 2020  d_name=name,.   
-00012510: 2020 2020 2020 2020 2020 2020 202a 2a6e               **n
-00012520: 756d 6572 6963 5f6f 6e6c 795f 6b77 6172  umeric_only_kwar
-00012530: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-00012540: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00012550: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
-00012560: 2c20 4461 7461 4672 616d 6529 2061 6e64  , DataFrame) and
-00012570: 2069 7369 6e73 7461 6e63 6528 7265 7375   isinstance(resu
-00012580: 6c74 2c20 5365 7269 6573 293a 0a20 2020  lt, Series):.   
-00012590: 2020 2020 2020 2020 2020 2020 2072 6573               res
-000125a0: 756c 742e 6469 7669 7369 6f6e 7320 3d20  ult.divisions = 
-000125b0: 2873 656c 662e 636f 6c75 6d6e 732e 6d69  (self.columns.mi
-000125c0: 6e28 292c 2073 656c 662e 636f 6c75 6d6e  n(), self.column
-000125d0: 732e 6d61 7828 2929 0a20 2020 2020 2020  s.max()).       
-000125e0: 2020 2020 2072 6574 7572 6e20 6861 6e64       return hand
-000125f0: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
-00012600: 6c74 290a 0a20 2020 2040 6465 7269 7665  lt)..    @derive
-00012610: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-00012620: 616d 6529 0a20 2020 2064 6566 2061 6464  ame).    def add
-00012630: 5f70 7265 6669 7828 7365 6c66 2c20 7072  _prefix(self, pr
-00012640: 6566 6978 293a 0a20 2020 2020 2020 2072  efix):.        r
-00012650: 6573 203d 2073 656c 662e 6d61 705f 7061  es = self.map_pa
-00012660: 7274 6974 696f 6e73 284d 2e61 6464 5f70  rtitions(M.add_p
-00012670: 7265 6669 782c 2070 7265 6669 7829 0a20  refix, prefix). 
-00012680: 2020 2020 2020 2069 6620 7365 6c66 2e6b         if self.k
-00012690: 6e6f 776e 5f64 6976 6973 696f 6e73 2061  nown_divisions a
-000126a0: 6e64 2069 735f 7365 7269 6573 5f6c 696b  nd is_series_lik
-000126b0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-000126c0: 2020 2020 2072 6573 2e64 6976 6973 696f       res.divisio
-000126d0: 6e73 203d 2074 7570 6c65 2870 7265 6669  ns = tuple(prefi
-000126e0: 7820 2b20 7374 7228 6469 7669 7369 6f6e  x + str(division
-000126f0: 2920 666f 7220 6469 7669 7369 6f6e 2069  ) for division i
-00012700: 6e20 7365 6c66 2e64 6976 6973 696f 6e73  n self.divisions
-00012710: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00012720: 2072 6573 0a0a 2020 2020 4064 6572 6976   res..    @deriv
-00012730: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-00012740: 7261 6d65 290a 2020 2020 6465 6620 6164  rame).    def ad
-00012750: 645f 7375 6666 6978 2873 656c 662c 2073  d_suffix(self, s
-00012760: 7566 6669 7829 3a0a 2020 2020 2020 2020  uffix):.        
-00012770: 7265 7320 3d20 7365 6c66 2e6d 6170 5f70  res = self.map_p
-00012780: 6172 7469 7469 6f6e 7328 4d2e 6164 645f  artitions(M.add_
-00012790: 7375 6666 6978 2c20 7375 6666 6978 290a  suffix, suffix).
-000127a0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000127b0: 6b6e 6f77 6e5f 6469 7669 7369 6f6e 7320  known_divisions 
-000127c0: 616e 6420 6973 5f73 6572 6965 735f 6c69  and is_series_li
-000127d0: 6b65 2873 656c 6629 3a0a 2020 2020 2020  ke(self):.      
-000127e0: 2020 2020 2020 7265 732e 6469 7669 7369        res.divisi
-000127f0: 6f6e 7320 3d20 7475 706c 6528 7374 7228  ons = tuple(str(
-00012800: 6469 7669 7369 6f6e 2920 2b20 7375 6666  division) + suff
-00012810: 6978 2066 6f72 2064 6976 6973 696f 6e20  ix for division 
-00012820: 696e 2073 656c 662e 6469 7669 7369 6f6e  in self.division
-00012830: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
-00012840: 6e20 7265 730a 0a20 2020 2040 6465 7269  n res..    @deri
-00012850: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-00012860: 4672 616d 6529 0a20 2020 2064 6566 2061  Frame).    def a
-00012870: 6273 2873 656c 6629 3a0a 2020 2020 2020  bs(self):.      
-00012880: 2020 5f72 6169 7365 5f69 665f 6f62 6a65    _raise_if_obje
-00012890: 6374 5f73 6572 6965 7328 7365 6c66 2c20  ct_series(self, 
-000128a0: 2261 6273 2229 0a20 2020 2020 2020 206d  "abs").        m
-000128b0: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
-000128c0: 5f6e 6f6e 656d 7074 792e 6162 7328 290a  _nonempty.abs().
-000128d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000128e0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-000128f0: 6e73 284d 2e61 6273 2c20 6d65 7461 3d6d  ns(M.abs, meta=m
-00012900: 6574 612c 2065 6e66 6f72 6365 5f6d 6574  eta, enforce_met
-00012910: 6164 6174 613d 4661 6c73 6529 0a0a 2020  adata=False)..  
-00012920: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00012930: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00012940: 2020 6465 6620 616c 6c28 7365 6c66 2c20    def all(self, 
-00012950: 6178 6973 3d4e 6f6e 652c 2073 6b69 706e  axis=None, skipn
-00012960: 613d 5472 7565 2c20 7370 6c69 745f 6576  a=True, split_ev
-00012970: 6572 793d 4661 6c73 652c 206f 7574 3d4e  ery=False, out=N
-00012980: 6f6e 6529 3a0a 2020 2020 2020 2020 7265  one):.        re
-00012990: 7475 726e 2073 656c 662e 5f72 6564 7563  turn self._reduc
-000129a0: 7469 6f6e 5f61 6767 280a 2020 2020 2020  tion_agg(.      
-000129b0: 2020 2020 2020 2261 6c6c 222c 2061 7869        "all", axi
-000129c0: 733d 6178 6973 2c20 736b 6970 6e61 3d73  s=axis, skipna=s
-000129d0: 6b69 706e 612c 2073 706c 6974 5f65 7665  kipna, split_eve
-000129e0: 7279 3d73 706c 6974 5f65 7665 7279 2c20  ry=split_every, 
-000129f0: 6f75 743d 6f75 740a 2020 2020 2020 2020  out=out.        
-00012a00: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00012a10: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00012a20: 6529 0a20 2020 2064 6566 2061 6e79 2873  e).    def any(s
-00012a30: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
-00012a40: 736b 6970 6e61 3d54 7275 652c 2073 706c  skipna=True, spl
-00012a50: 6974 5f65 7665 7279 3d46 616c 7365 2c20  it_every=False, 
-00012a60: 6f75 743d 4e6f 6e65 293a 0a20 2020 2020  out=None):.     
-00012a70: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00012a80: 7265 6475 6374 696f 6e5f 6167 6728 0a20  reduction_agg(. 
-00012a90: 2020 2020 2020 2020 2020 2022 616e 7922             "any"
-00012aa0: 2c20 6178 6973 3d61 7869 732c 2073 6b69  , axis=axis, ski
-00012ab0: 706e 613d 736b 6970 6e61 2c20 7370 6c69  pna=skipna, spli
-00012ac0: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-00012ad0: 6572 792c 206f 7574 3d6f 7574 0a20 2020  ery, out=out.   
-00012ae0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
-00012af0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00012b00: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00012b10: 7375 6d28 0a20 2020 2020 2020 2073 656c  sum(.        sel
-00012b20: 662c 0a20 2020 2020 2020 2061 7869 733d  f,.        axis=
-00012b30: 4e6f 6e65 2c0a 2020 2020 2020 2020 736b  None,.        sk
-00012b40: 6970 6e61 3d54 7275 652c 0a20 2020 2020  ipna=True,.     
-00012b50: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
-00012b60: 616c 7365 2c0a 2020 2020 2020 2020 6474  alse,.        dt
-00012b70: 7970 653d 4e6f 6e65 2c0a 2020 2020 2020  ype=None,.      
-00012b80: 2020 6f75 743d 4e6f 6e65 2c0a 2020 2020    out=None,.    
-00012b90: 2020 2020 6d69 6e5f 636f 756e 743d 4e6f      min_count=No
-00012ba0: 6e65 2c0a 2020 2020 2020 2020 6e75 6d65  ne,.        nume
-00012bb0: 7269 635f 6f6e 6c79 3d4e 6f6e 652c 0a20  ric_only=None,. 
-00012bc0: 2020 2029 3a0a 2020 2020 2020 2020 7265     ):.        re
-00012bd0: 7375 6c74 203d 2073 656c 662e 5f72 6564  sult = self._red
-00012be0: 7563 7469 6f6e 5f61 6767 280a 2020 2020  uction_agg(.    
-00012bf0: 2020 2020 2020 2020 2273 756d 222c 0a20          "sum",. 
-00012c00: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-00012c10: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-00012c20: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
-00012c30: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-00012c40: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-00012c50: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
-00012c60: 2020 6f75 743d 6f75 742c 0a20 2020 2020    out=out,.     
-00012c70: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
-00012c80: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
-00012c90: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00012ca0: 2020 2020 6966 206d 696e 5f63 6f75 6e74      if min_count
-00012cb0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-00012cc0: 6e64 203d 2073 656c 662e 6e6f 746e 756c  nd = self.notnul
-00012cd0: 6c28 292e 7375 6d28 6178 6973 3d61 7869  l().sum(axis=axi
-00012ce0: 7329 203e 3d20 6d69 6e5f 636f 756e 740a  s) >= min_count.
-00012cf0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00012d00: 735f 7365 7269 6573 5f6c 696b 6528 636f  s_series_like(co
-00012d10: 6e64 293a 0a20 2020 2020 2020 2020 2020  nd):.           
-00012d20: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-00012d30: 6c74 2e77 6865 7265 2863 6f6e 642c 206f  lt.where(cond, o
-00012d40: 7468 6572 3d6e 702e 4e61 4e29 0a20 2020  ther=np.NaN).   
-00012d50: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00012d60: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00012d70: 6574 7572 6e20 5f73 6361 6c61 725f 6269  eturn _scalar_bi
-00012d80: 6e61 7279 280a 2020 2020 2020 2020 2020  nary(.          
-00012d90: 2020 2020 2020 2020 2020 6c61 6d62 6461            lambda
-00012da0: 2078 2c20 793a 2072 6573 756c 7420 6966   x, y: result if
-00012db0: 2078 2069 7320 7920 656c 7365 206e 702e   x is y else np.
-00012dc0: 4e61 4e2c 2063 6f6e 642c 2054 7275 650a  NaN, cond, True.
+0000c570: 6f6e 7320 3c3d 202d 313a 0a20 2020 2020  ons <= -1:.     
+0000c580: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
+0000c590: 6e73 203d 2073 656c 662e 6e70 6172 7469  ns = self.nparti
+0000c5a0: 7469 6f6e 730a 2020 2020 2020 2020 6966  tions.        if
+0000c5b0: 206e 7061 7274 6974 696f 6e73 203e 2073   npartitions > s
+0000c5c0: 656c 662e 6e70 6172 7469 7469 6f6e 733a  elf.npartitions:
+0000c5d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000c5e0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+0000c5f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000c600: 226f 6e6c 7920 7b73 656c 662e 6e70 6172  "only {self.npar
+0000c610: 7469 7469 6f6e 737d 2070 6172 7469 7469  titions} partiti
+0000c620: 6f6e 732c 2068 6561 6420 7265 6365 6976  ons, head receiv
+0000c630: 6564 207b 6e70 6172 7469 7469 6f6e 737d  ed {npartitions}
+0000c640: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+0000c650: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
+0000c660: 6622 6865 6164 2d7b 6e70 6172 7469 7469  f"head-{npartiti
+0000c670: 6f6e 737d 2d7b 6e7d 2d7b 7365 6c66 2e5f  ons}-{n}-{self._
+0000c680: 6e61 6d65 7d22 0a20 2020 2020 2020 2069  name}".        i
+0000c690: 6620 7361 6665 3a0a 2020 2020 2020 2020  f safe:.        
+0000c6a0: 2020 2020 6865 6164 203d 2073 6166 655f      head = safe_
+0000c6b0: 6865 6164 0a20 2020 2020 2020 2065 6c73  head.        els
+0000c6c0: 653a 0a20 2020 2020 2020 2020 2020 2068  e:.            h
+0000c6d0: 6561 6420 3d20 4d2e 6865 6164 0a0a 2020  ead = M.head..  
+0000c6e0: 2020 2020 2020 6966 206e 7061 7274 6974        if npartit
+0000c6f0: 696f 6e73 203e 2031 3a0a 2020 2020 2020  ions > 1:.      
+0000c700: 2020 2020 2020 6e61 6d65 5f70 203d 2066        name_p = f
+0000c710: 2268 6561 642d 7061 7274 6961 6c2d 7b6e  "head-partial-{n
+0000c720: 7d2d 7b73 656c 662e 5f6e 616d 657d 220a  }-{self._name}".
+0000c730: 0a20 2020 2020 2020 2020 2020 2064 736b  .            dsk
+0000c740: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
+0000c750: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+0000c760: 286e 7061 7274 6974 696f 6e73 293a 0a20  (npartitions):. 
+0000c770: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000c780: 736b 5b28 6e61 6d65 5f70 2c20 6929 5d20  sk[(name_p, i)] 
+0000c790: 3d20 284d 2e68 6561 642c 2028 7365 6c66  = (M.head, (self
+0000c7a0: 2e5f 6e61 6d65 2c20 6929 2c20 6e29 0a0a  ._name, i), n)..
+0000c7b0: 2020 2020 2020 2020 2020 2020 636f 6e63              conc
+0000c7c0: 6174 203d 2028 5f63 6f6e 6361 742c 205b  at = (_concat, [
+0000c7d0: 286e 616d 655f 702c 2069 2920 666f 7220  (name_p, i) for 
+0000c7e0: 6920 696e 2072 616e 6765 286e 7061 7274  i in range(npart
+0000c7f0: 6974 696f 6e73 295d 290a 2020 2020 2020  itions)]).      
+0000c800: 2020 2020 2020 6473 6b5b 286e 616d 652c        dsk[(name,
+0000c810: 2030 295d 203d 2028 6865 6164 2c20 636f   0)] = (head, co
+0000c820: 6e63 6174 2c20 6e29 0a20 2020 2020 2020  ncat, n).       
+0000c830: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000c840: 2020 2064 736b 203d 207b 286e 616d 652c     dsk = {(name,
+0000c850: 2030 293a 2028 6865 6164 2c20 2873 656c   0): (head, (sel
+0000c860: 662e 5f6e 616d 652c 2030 292c 206e 297d  f._name, 0), n)}
+0000c870: 0a0a 2020 2020 2020 2020 6772 6170 6820  ..        graph 
+0000c880: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
+0000c890: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
+0000c8a0: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
+0000c8b0: 656e 6465 6e63 6965 733d 5b73 656c 665d  endencies=[self]
+0000c8c0: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
+0000c8d0: 203d 206e 6577 5f64 645f 6f62 6a65 6374   = new_dd_object
+0000c8e0: 280a 2020 2020 2020 2020 2020 2020 6772  (.            gr
+0000c8f0: 6170 682c 206e 616d 652c 2073 656c 662e  aph, name, self.
+0000c900: 5f6d 6574 612c 205b 7365 6c66 2e64 6976  _meta, [self.div
+0000c910: 6973 696f 6e73 5b30 5d2c 2073 656c 662e  isions[0], self.
+0000c920: 6469 7669 7369 6f6e 735b 6e70 6172 7469  divisions[nparti
+0000c930: 7469 6f6e 735d 5d0a 2020 2020 2020 2020  tions]].        
+0000c940: 290a 0a20 2020 2020 2020 2069 6620 636f  )..        if co
+0000c950: 6d70 7574 653a 0a20 2020 2020 2020 2020  mpute:.         
+0000c960: 2020 2072 6573 756c 7420 3d20 7265 7375     result = resu
+0000c970: 6c74 2e63 6f6d 7075 7465 2829 0a20 2020  lt.compute().   
+0000c980: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+0000c990: 6c74 0a0a 2020 2020 6465 6620 7461 696c  lt..    def tail
+0000c9a0: 2873 656c 662c 206e 3d35 2c20 636f 6d70  (self, n=5, comp
+0000c9b0: 7574 653d 5472 7565 293a 0a20 2020 2020  ute=True):.     
+0000c9c0: 2020 2022 2222 4c61 7374 206e 2072 6f77     """Last n row
+0000c9d0: 7320 6f66 2074 6865 2064 6174 6173 6574  s of the dataset
+0000c9e0: 0a0a 2020 2020 2020 2020 4361 7665 6174  ..        Caveat
+0000c9f0: 2c20 7468 6520 6f6e 6c79 2063 6865 636b  , the only check
+0000ca00: 7320 7468 6520 6c61 7374 206e 2072 6f77  s the last n row
+0000ca10: 7320 6f66 2074 6865 206c 6173 7420 7061  s of the last pa
+0000ca20: 7274 6974 696f 6e2e 0a20 2020 2020 2020  rtition..       
+0000ca30: 2022 2222 0a20 2020 2020 2020 206e 616d   """.        nam
+0000ca40: 6520 3d20 2274 6169 6c2d 2564 2d25 7322  e = "tail-%d-%s"
+0000ca50: 2025 2028 6e2c 2073 656c 662e 5f6e 616d   % (n, self._nam
+0000ca60: 6529 0a20 2020 2020 2020 2064 736b 203d  e).        dsk =
+0000ca70: 207b 286e 616d 652c 2030 293a 2028 4d2e   {(name, 0): (M.
+0000ca80: 7461 696c 2c20 2873 656c 662e 5f6e 616d  tail, (self._nam
+0000ca90: 652c 2073 656c 662e 6e70 6172 7469 7469  e, self.npartiti
+0000caa0: 6f6e 7320 2d20 3129 2c20 6e29 7d0a 0a20  ons - 1), n)}.. 
+0000cab0: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
+0000cac0: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+0000cad0: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
+0000cae0: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
+0000caf0: 656e 6369 6573 3d5b 7365 6c66 5d29 0a20  encies=[self]). 
+0000cb00: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0000cb10: 6e65 775f 6464 5f6f 626a 6563 7428 6772  new_dd_object(gr
+0000cb20: 6170 682c 206e 616d 652c 2073 656c 662e  aph, name, self.
+0000cb30: 5f6d 6574 612c 2073 656c 662e 6469 7669  _meta, self.divi
+0000cb40: 7369 6f6e 735b 2d32 3a5d 290a 0a20 2020  sions[-2:])..   
+0000cb50: 2020 2020 2069 6620 636f 6d70 7574 653a       if compute:
+0000cb60: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+0000cb70: 756c 7420 3d20 7265 7375 6c74 2e63 6f6d  ult = result.com
+0000cb80: 7075 7465 2829 0a20 2020 2020 2020 2072  pute().        r
+0000cb90: 6574 7572 6e20 7265 7375 6c74 0a0a 2020  eturn result..  
+0000cba0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000cbb0: 6465 6620 6c6f 6328 7365 6c66 293a 0a20  def loc(self):. 
+0000cbc0: 2020 2020 2020 2022 2222 5075 7265 6c79         """Purely
+0000cbd0: 206c 6162 656c 2d6c 6f63 6174 696f 6e20   label-location 
+0000cbe0: 6261 7365 6420 696e 6465 7865 7220 666f  based indexer fo
+0000cbf0: 7220 7365 6c65 6374 696f 6e20 6279 206c  r selection by l
+0000cc00: 6162 656c 2e0a 0a20 2020 2020 2020 203e  abel...        >
+0000cc10: 3e3e 2064 662e 6c6f 635b 2262 225d 2020  >> df.loc["b"]  
+0000cc20: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
+0000cc30: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+0000cc40: 6c6f 635b 2262 223a 2264 225d 2020 2320  loc["b":"d"]  # 
+0000cc50: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
+0000cc60: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000cc70: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
+0000cc80: 6166 7261 6d65 2e69 6e64 6578 696e 6720  aframe.indexing 
+0000cc90: 696d 706f 7274 205f 4c6f 6349 6e64 6578  import _LocIndex
+0000cca0: 6572 0a0a 2020 2020 2020 2020 7265 7475  er..        retu
+0000ccb0: 726e 205f 4c6f 6349 6e64 6578 6572 2873  rn _LocIndexer(s
+0000ccc0: 656c 6629 0a0a 2020 2020 6465 6620 5f70  elf)..    def _p
+0000ccd0: 6172 7469 7469 6f6e 7328 7365 6c66 2c20  artitions(self, 
+0000cce0: 696e 6465 7829 3a0a 2020 2020 2020 2020  index):.        
+0000ccf0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+0000cd00: 6528 696e 6465 782c 2074 7570 6c65 293a  e(index, tuple):
+0000cd10: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+0000cd20: 6578 203d 2028 696e 6465 782c 290a 2020  ex = (index,).  
+0000cd30: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+0000cd40: 6172 7261 792e 736c 6963 696e 6720 696d  array.slicing im
+0000cd50: 706f 7274 206e 6f72 6d61 6c69 7a65 5f69  port normalize_i
+0000cd60: 6e64 6578 0a0a 2020 2020 2020 2020 696e  ndex..        in
+0000cd70: 6465 7820 3d20 6e6f 726d 616c 697a 655f  dex = normalize_
+0000cd80: 696e 6465 7828 696e 6465 782c 2028 7365  index(index, (se
+0000cd90: 6c66 2e6e 7061 7274 6974 696f 6e73 2c29  lf.npartitions,)
+0000cda0: 290a 2020 2020 2020 2020 696e 6465 7820  ).        index 
+0000cdb0: 3d20 7475 706c 6528 736c 6963 6528 6b2c  = tuple(slice(k,
+0000cdc0: 206b 202b 2031 2920 6966 2069 7369 6e73   k + 1) if isins
+0000cdd0: 7461 6e63 6528 6b2c 204e 756d 6265 7229  tance(k, Number)
+0000cde0: 2065 6c73 6520 6b20 666f 7220 6b20 696e   else k for k in
+0000cdf0: 2069 6e64 6578 290a 2020 2020 2020 2020   index).        
+0000ce00: 6e61 6d65 203d 2022 626c 6f63 6b73 2d22  name = "blocks-"
+0000ce10: 202b 2074 6f6b 656e 697a 6528 7365 6c66   + tokenize(self
+0000ce20: 2c20 696e 6465 7829 0a20 2020 2020 2020  , index).       
+0000ce30: 206e 6577 5f6b 6579 7320 3d20 6e70 2e61   new_keys = np.a
+0000ce40: 7272 6179 2873 656c 662e 5f5f 6461 736b  rray(self.__dask
+0000ce50: 5f6b 6579 735f 5f28 292c 2064 7479 7065  _keys__(), dtype
+0000ce60: 3d6f 626a 6563 7429 5b69 6e64 6578 5d2e  =object)[index].
+0000ce70: 746f 6c69 7374 2829 0a0a 2020 2020 2020  tolist()..      
+0000ce80: 2020 6469 7669 7369 6f6e 7320 3d20 5b73    divisions = [s
+0000ce90: 656c 662e 6469 7669 7369 6f6e 735b 695d  elf.divisions[i]
+0000cea0: 2066 6f72 205f 2c20 6920 696e 206e 6577   for _, i in new
+0000ceb0: 5f6b 6579 735d 202b 205b 0a20 2020 2020  _keys] + [.     
+0000cec0: 2020 2020 2020 2073 656c 662e 6469 7669         self.divi
+0000ced0: 7369 6f6e 735b 6e65 775f 6b65 7973 5b2d  sions[new_keys[-
+0000cee0: 315d 5b31 5d20 2b20 315d 0a20 2020 2020  1][1] + 1].     
+0000cef0: 2020 205d 0a20 2020 2020 2020 2064 736b     ].        dsk
+0000cf00: 203d 207b 286e 616d 652c 2069 293a 2074   = {(name, i): t
+0000cf10: 7570 6c65 286b 6579 2920 666f 7220 692c  uple(key) for i,
+0000cf20: 206b 6579 2069 6e20 656e 756d 6572 6174   key in enumerat
+0000cf30: 6528 6e65 775f 6b65 7973 297d 0a0a 2020  e(new_keys)}..  
+0000cf40: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
+0000cf50: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+0000cf60: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
+0000cf70: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
+0000cf80: 6e63 6965 733d 5b73 656c 665d 290a 2020  ncies=[self]).  
+0000cf90: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+0000cfa0: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
+0000cfb0: 2c20 6e61 6d65 2c20 7365 6c66 2e5f 6d65  , name, self._me
+0000cfc0: 7461 2c20 6469 7669 7369 6f6e 7329 0a0a  ta, divisions)..
+0000cfd0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0000cfe0: 2020 6465 6620 7061 7274 6974 696f 6e73    def partitions
+0000cff0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000d000: 2222 2253 6c69 6365 2064 6174 6166 7261  """Slice datafra
+0000d010: 6d65 2062 7920 7061 7274 6974 696f 6e73  me by partitions
+0000d020: 0a0a 2020 2020 2020 2020 5468 6973 2061  ..        This a
+0000d030: 6c6c 6f77 7320 7061 7274 6974 696f 6e77  llows partitionw
+0000d040: 6973 6520 736c 6963 696e 6720 6f66 2061  ise slicing of a
+0000d050: 2044 6173 6b20 4461 7461 6672 616d 652e   Dask Dataframe.
+0000d060: 2020 596f 7520 6361 6e20 7065 7266 6f72    You can perfor
+0000d070: 6d20 6e6f 726d 616c 0a20 2020 2020 2020  m normal.       
+0000d080: 204e 756d 7079 2d73 7479 6c65 2073 6c69   Numpy-style sli
+0000d090: 6369 6e67 2c20 6275 7420 6e6f 7720 7261  cing, but now ra
+0000d0a0: 7468 6572 2074 6861 6e20 736c 6963 6520  ther than slice 
+0000d0b0: 656c 656d 656e 7473 206f 6620 7468 6520  elements of the 
+0000d0c0: 6172 7261 7920 796f 750a 2020 2020 2020  array you.      
+0000d0d0: 2020 736c 6963 6520 616c 6f6e 6720 7061    slice along pa
+0000d0e0: 7274 6974 696f 6e73 2073 6f2c 2066 6f72  rtitions so, for
+0000d0f0: 2065 7861 6d70 6c65 2c20 6060 6466 2e70   example, ``df.p
+0000d100: 6172 7469 7469 6f6e 735b 3a35 5d60 6020  artitions[:5]`` 
+0000d110: 7072 6f64 7563 6573 2061 206e 6577 0a20  produces a new. 
+0000d120: 2020 2020 2020 2044 6173 6b20 4461 7461         Dask Data
+0000d130: 6672 616d 6520 6f66 2074 6865 2066 6972  frame of the fir
+0000d140: 7374 2066 6976 6520 7061 7274 6974 696f  st five partitio
+0000d150: 6e73 2e20 5661 6c69 6420 696e 6465 7865  ns. Valid indexe
+0000d160: 7273 2061 7265 2069 6e74 6567 6572 732c  rs are integers,
+0000d170: 2073 6571 7565 6e63 6573 0a20 2020 2020   sequences.     
+0000d180: 2020 206f 6620 696e 7465 6765 7273 2c20     of integers, 
+0000d190: 736c 6963 6573 2c20 6f72 2062 6f6f 6c65  slices, or boole
+0000d1a0: 616e 206d 6173 6b73 2e0a 0a20 2020 2020  an masks...     
+0000d1b0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
+0000d1c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+0000d1d0: 2020 2020 203e 3e3e 2064 662e 7061 7274       >>> df.part
+0000d1e0: 6974 696f 6e73 5b30 5d20 2023 2064 6f63  itions[0]  # doc
+0000d1f0: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
+0000d200: 2020 2020 3e3e 3e20 6466 2e70 6172 7469      >>> df.parti
+0000d210: 7469 6f6e 735b 3a33 5d20 2023 2064 6f63  tions[:3]  # doc
+0000d220: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
+0000d230: 2020 2020 3e3e 3e20 6466 2e70 6172 7469      >>> df.parti
+0000d240: 7469 6f6e 735b 3a3a 3130 5d20 2023 2064  tions[::10]  # d
+0000d250: 6f63 7465 7374 3a20 2b53 4b49 500a 0a20  octest: +SKIP.. 
+0000d260: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+0000d270: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+0000d280: 2020 2020 2020 2041 2044 6173 6b20 4461         A Dask Da
+0000d290: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
+0000d2a0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0000d2b0: 726e 2049 6e64 6578 4361 6c6c 6162 6c65  rn IndexCallable
+0000d2c0: 2873 656c 662e 5f70 6172 7469 7469 6f6e  (self._partition
+0000d2d0: 7329 0a0a 2020 2020 2320 4e6f 7465 3a20  s)..    # Note: 
+0000d2e0: 696c 6f63 2069 7320 696d 706c 656d 656e  iloc is implemen
+0000d2f0: 7465 6420 6f6e 6c79 206f 6e20 4461 7461  ted only on Data
+0000d300: 4672 616d 650a 0a20 2020 2064 6566 2072  Frame..    def r
+0000d310: 6570 6172 7469 7469 6f6e 280a 2020 2020  epartition(.    
+0000d320: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000d330: 2020 6469 7669 7369 6f6e 733d 4e6f 6e65    divisions=None
+0000d340: 2c0a 2020 2020 2020 2020 6e70 6172 7469  ,.        nparti
+0000d350: 7469 6f6e 733d 4e6f 6e65 2c0a 2020 2020  tions=None,.    
+0000d360: 2020 2020 7061 7274 6974 696f 6e5f 7369      partition_si
+0000d370: 7a65 3d4e 6f6e 652c 0a20 2020 2020 2020  ze=None,.       
+0000d380: 2066 7265 713d 4e6f 6e65 2c0a 2020 2020   freq=None,.    
+0000d390: 2020 2020 666f 7263 653d 4661 6c73 652c      force=False,
+0000d3a0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0000d3b0: 2222 2252 6570 6172 7469 7469 6f6e 2064  """Repartition d
+0000d3c0: 6174 6166 7261 6d65 2061 6c6f 6e67 206e  ataframe along n
+0000d3d0: 6577 2064 6976 6973 696f 6e73 0a0a 2020  ew divisions..  
+0000d3e0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0000d3f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000d400: 2d2d 2d0a 2020 2020 2020 2020 6469 7669  ---.        divi
+0000d410: 7369 6f6e 7320 3a20 6c69 7374 2c20 6f70  sions : list, op
+0000d420: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+0000d430: 2020 2054 6865 2022 6469 7669 6469 6e67     The "dividing
+0000d440: 206c 696e 6573 2220 7573 6564 2074 6f20   lines" used to 
+0000d450: 7370 6c69 7420 7468 6520 6461 7461 6672  split the datafr
+0000d460: 616d 6520 696e 746f 2070 6172 7469 7469  ame into partiti
+0000d470: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
+0000d480: 2046 6f72 2060 6064 6976 6973 696f 6e73   For ``divisions
+0000d490: 3d5b 302c 2031 302c 2035 302c 2031 3030  =[0, 10, 50, 100
+0000d4a0: 5d60 602c 2074 6865 7265 2077 6f75 6c64  ]``, there would
+0000d4b0: 2062 6520 7468 7265 6520 6f75 7470 7574   be three output
+0000d4c0: 2070 6172 7469 7469 6f6e 732c 0a20 2020   partitions,.   
+0000d4d0: 2020 2020 2020 2020 2077 6865 7265 2074           where t
+0000d4e0: 6865 206e 6577 2069 6e64 6578 2063 6f6e  he new index con
+0000d4f0: 7461 696e 6564 205b 302c 2031 3029 2c20  tained [0, 10), 
+0000d500: 5b31 302c 2035 3029 2c20 616e 6420 5b35  [10, 50), and [5
+0000d510: 302c 2031 3030 292c 2072 6573 7065 6374  0, 100), respect
+0000d520: 6976 656c 792e 0a20 2020 2020 2020 2020  ively..         
+0000d530: 2020 2053 6565 2068 7474 7073 3a2f 2f64     See https://d
+0000d540: 6f63 732e 6461 736b 2e6f 7267 2f65 6e2f  ocs.dask.org/en/
+0000d550: 6c61 7465 7374 2f64 6174 6166 7261 6d65  latest/dataframe
+0000d560: 2d64 6573 6967 6e2e 6874 6d6c 2370 6172  -design.html#par
+0000d570: 7469 7469 6f6e 732e 0a20 2020 2020 2020  titions..       
+0000d580: 2020 2020 204f 6e6c 7920 7573 6564 2069       Only used i
+0000d590: 6620 6e70 6172 7469 7469 6f6e 7320 616e  f npartitions an
+0000d5a0: 6420 7061 7274 6974 696f 6e5f 7369 7a65  d partition_size
+0000d5b0: 2069 736e 2774 2073 7065 6369 6669 6564   isn't specified
+0000d5c0: 2e0a 2020 2020 2020 2020 2020 2020 466f  ..            Fo
+0000d5d0: 7220 636f 6e76 656e 6965 6e63 6520 6966  r convenience if
+0000d5e0: 2067 6976 656e 2061 6e20 696e 7465 6765   given an intege
+0000d5f0: 7220 7468 6973 2077 696c 6c20 6465 6665  r this will defe
+0000d600: 7220 746f 206e 7061 7274 6974 696f 6e73  r to npartitions
+0000d610: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+0000d620: 2069 6620 6769 7665 6e20 6120 7374 7269   if given a stri
+0000d630: 6e67 2069 7420 7769 6c6c 2064 6566 6572  ng it will defer
+0000d640: 2074 6f20 7061 7274 6974 696f 6e5f 7369   to partition_si
+0000d650: 7a65 2028 7365 6520 6265 6c6f 7729 0a20  ze (see below). 
+0000d660: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
+0000d670: 6e73 203a 2069 6e74 2c20 6f70 7469 6f6e  ns : int, option
+0000d680: 616c 0a20 2020 2020 2020 2020 2020 2041  al.            A
+0000d690: 7070 726f 7869 6d61 7465 206e 756d 6265  pproximate numbe
+0000d6a0: 7220 6f66 2070 6172 7469 7469 6f6e 7320  r of partitions 
+0000d6b0: 6f66 206f 7574 7075 742e 204f 6e6c 7920  of output. Only 
+0000d6c0: 7573 6564 2069 6620 7061 7274 6974 696f  used if partitio
+0000d6d0: 6e5f 7369 7a65 0a20 2020 2020 2020 2020  n_size.         
+0000d6e0: 2020 2069 736e 2774 2073 7065 6369 6669     isn't specifi
+0000d6f0: 6564 2e20 5468 6520 6e75 6d62 6572 206f  ed. The number o
+0000d700: 6620 7061 7274 6974 696f 6e73 2075 7365  f partitions use
+0000d710: 6420 6d61 7920 6265 2073 6c69 6768 746c  d may be slightl
+0000d720: 790a 2020 2020 2020 2020 2020 2020 6c6f  y.            lo
+0000d730: 7765 7220 7468 616e 206e 7061 7274 6974  wer than npartit
+0000d740: 696f 6e73 2064 6570 656e 6469 6e67 206f  ions depending o
+0000d750: 6e20 6461 7461 2064 6973 7472 6962 7574  n data distribut
+0000d760: 696f 6e2c 2062 7574 2077 696c 6c20 6e65  ion, but will ne
+0000d770: 7665 7220 6265 0a20 2020 2020 2020 2020  ver be.         
+0000d780: 2020 2068 6967 6865 722e 0a20 2020 2020     higher..     
+0000d790: 2020 2070 6172 7469 7469 6f6e 5f73 697a     partition_siz
+0000d7a0: 653a 2069 6e74 206f 7220 7374 7269 6e67  e: int or string
+0000d7b0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0000d7c0: 2020 2020 2020 204d 6178 206e 756d 6265         Max numbe
+0000d7d0: 7220 6f66 2062 7974 6573 206f 6620 6d65  r of bytes of me
+0000d7e0: 6d6f 7279 2066 6f72 2065 6163 6820 7061  mory for each pa
+0000d7f0: 7274 6974 696f 6e2e 2055 7365 206e 756d  rtition. Use num
+0000d800: 6265 7273 206f 720a 2020 2020 2020 2020  bers or.        
+0000d810: 2020 2020 7374 7269 6e67 7320 6c69 6b65      strings like
+0000d820: 2035 4d42 2e20 4966 2073 7065 6369 6669   5MB. If specifi
+0000d830: 6564 206e 7061 7274 6974 696f 6e73 2061  ed npartitions a
+0000d840: 6e64 2064 6976 6973 696f 6e73 2077 696c  nd divisions wil
+0000d850: 6c20 6265 0a20 2020 2020 2020 2020 2020  l be.           
+0000d860: 2069 676e 6f72 6564 2e20 4e6f 7465 2074   ignored. Note t
+0000d870: 6861 7420 7468 6520 7369 7a65 2072 6566  hat the size ref
+0000d880: 6c65 6374 7320 7468 6520 6e75 6d62 6572  lects the number
+0000d890: 206f 6620 6279 7465 7320 7573 6564 2061   of bytes used a
+0000d8a0: 730a 2020 2020 2020 2020 2020 2020 636f  s.            co
+0000d8b0: 6d70 7574 6564 2062 7920 6060 7061 6e64  mputed by ``pand
+0000d8c0: 6173 2e44 6174 6146 7261 6d65 2e6d 656d  as.DataFrame.mem
+0000d8d0: 6f72 795f 7573 6167 6560 602c 2077 6869  ory_usage``, whi
+0000d8e0: 6368 2077 696c 6c20 6e6f 740a 2020 2020  ch will not.    
+0000d8f0: 2020 2020 2020 2020 6e65 6365 7373 6172          necessar
+0000d900: 696c 7920 6d61 7463 6820 7468 6520 7369  ily match the si
+0000d910: 7a65 2077 6865 6e20 7374 6f72 696e 6720  ze when storing 
+0000d920: 746f 2064 6973 6b2e 0a0a 2020 2020 2020  to disk...      
+0000d930: 2020 2020 2020 2e2e 2077 6172 6e69 6e67        .. warning
+0000d940: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
+0000d950: 2020 2054 6869 7320 6b65 7977 6f72 6420     This keyword 
+0000d960: 6172 6775 6d65 6e74 2074 7269 6767 6572  argument trigger
+0000d970: 7320 636f 6d70 7574 6174 696f 6e20 746f  s computation to
+0000d980: 2064 6574 6572 6d69 6e65 0a20 2020 2020   determine.     
+0000d990: 2020 2020 2020 2020 2020 7468 6520 6d65            the me
+0000d9a0: 6d6f 7279 2073 697a 6520 6f66 2065 6163  mory size of eac
+0000d9b0: 6820 7061 7274 6974 696f 6e2c 2077 6869  h partition, whi
+0000d9c0: 6368 206d 6179 2062 6520 6578 7065 6e73  ch may be expens
+0000d9d0: 6976 652e 0a0a 2020 2020 2020 2020 6672  ive...        fr
+0000d9e0: 6571 203a 2073 7472 2c20 7064 2e54 696d  eq : str, pd.Tim
+0000d9f0: 6564 656c 7461 0a20 2020 2020 2020 2020  edelta.         
+0000da00: 2020 2041 2070 6572 696f 6420 6f6e 2077     A period on w
+0000da10: 6869 6368 2074 6f20 7061 7274 6974 696f  hich to partitio
+0000da20: 6e20 7469 6d65 7365 7269 6573 2064 6174  n timeseries dat
+0000da30: 6120 6c69 6b65 2060 6027 3744 2760 6020  a like ``'7D'`` 
+0000da40: 6f72 0a20 2020 2020 2020 2020 2020 2060  or.            `
+0000da50: 6027 3132 6827 6060 206f 7220 6060 7064  `'12h'`` or ``pd
+0000da60: 2e54 696d 6564 656c 7461 2868 6f75 7273  .Timedelta(hours
+0000da70: 3d31 3229 6060 2e20 2041 7373 756d 6573  =12)``.  Assumes
+0000da80: 2061 2064 6174 6574 696d 6520 696e 6465   a datetime inde
+0000da90: 782e 0a20 2020 2020 2020 2066 6f72 6365  x..        force
+0000daa0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+0000dab0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+0000dac0: 2020 2041 6c6c 6f77 7320 7468 6520 6578     Allows the ex
+0000dad0: 7061 6e73 696f 6e20 6f66 2074 6865 2065  pansion of the e
+0000dae0: 7869 7374 696e 6720 6469 7669 7369 6f6e  xisting division
+0000daf0: 732e 0a20 2020 2020 2020 2020 2020 2049  s..            I
+0000db00: 6620 4661 6c73 6520 7468 656e 2074 6865  f False then the
+0000db10: 206e 6577 2064 6976 6973 696f 6e73 2720   new divisions' 
+0000db20: 6c6f 7765 7220 616e 6420 7570 7065 7220  lower and upper 
+0000db30: 626f 756e 6473 206d 7573 7420 6265 0a20  bounds must be. 
+0000db40: 2020 2020 2020 2020 2020 2074 6865 2073             the s
+0000db50: 616d 6520 6173 2074 6865 206f 6c64 2064  ame as the old d
+0000db60: 6976 6973 696f 6e73 272e 0a0a 2020 2020  ivisions'...    
+0000db70: 2020 2020 4e6f 7465 730a 2020 2020 2020      Notes.      
+0000db80: 2020 2d2d 2d2d 2d0a 2020 2020 2020 2020    -----.        
+0000db90: 4578 6163 746c 7920 6f6e 6520 6f66 2060  Exactly one of `
+0000dba0: 6469 7669 7369 6f6e 7360 2c20 606e 7061  divisions`, `npa
+0000dbb0: 7274 6974 696f 6e73 602c 2060 7061 7274  rtitions`, `part
+0000dbc0: 6974 696f 6e5f 7369 7a65 602c 206f 7220  ition_size`, or 
+0000dbd0: 6066 7265 7160 0a20 2020 2020 2020 2073  `freq`.        s
+0000dbe0: 686f 756c 6420 6265 2073 7065 6369 6669  hould be specifi
+0000dbf0: 6564 2e20 4120 6060 5661 6c75 6545 7272  ed. A ``ValueErr
+0000dc00: 6f72 6060 2077 696c 6c20 6265 2072 6169  or`` will be rai
+0000dc10: 7365 6420 7768 656e 2074 6861 7420 6973  sed when that is
+0000dc20: 0a20 2020 2020 2020 206e 6f74 2074 6865  .        not the
+0000dc30: 2063 6173 652e 0a0a 2020 2020 2020 2020   case...        
+0000dc40: 416c 736f 206e 6f74 6520 7468 6174 2060  Also note that `
+0000dc50: 606c 656e 2864 6976 6973 6f6e 7329 6060  `len(divisons)``
+0000dc60: 2069 7320 6571 7561 6c20 746f 2060 606e   is equal to ``n
+0000dc70: 7061 7274 6974 696f 6e73 202b 2031 6060  partitions + 1``
+0000dc80: 2e20 5468 6973 2069 7320 6265 6361 7573  . This is becaus
+0000dc90: 6520 6060 6469 7669 7369 6f6e 7360 600a  e ``divisions``.
+0000dca0: 2020 2020 2020 2020 7265 7072 6573 656e          represen
+0000dcb0: 7473 2074 6865 2075 7070 6572 2061 6e64  ts the upper and
+0000dcc0: 206c 6f77 6572 2062 6f75 6e64 7320 6f66   lower bounds of
+0000dcd0: 2065 6163 6820 7061 7274 6974 696f 6e2e   each partition.
+0000dce0: 2054 6865 2066 6972 7374 2069 7465 6d20   The first item 
+0000dcf0: 6973 2074 6865 0a20 2020 2020 2020 206c  is the.        l
+0000dd00: 6f77 6572 2062 6f75 6e64 206f 6620 7468  ower bound of th
+0000dd10: 6520 6669 7273 7420 7061 7274 6974 696f  e first partitio
+0000dd20: 6e2c 2074 6865 2073 6563 6f6e 6420 6974  n, the second it
+0000dd30: 656d 2069 7320 7468 6520 6c6f 7765 7220  em is the lower 
+0000dd40: 626f 756e 6420 6f66 2074 6865 0a20 2020  bound of the.   
+0000dd50: 2020 2020 2073 6563 6f6e 6420 7061 7274       second part
+0000dd60: 6974 696f 6e20 616e 6420 7468 6520 7570  ition and the up
+0000dd70: 7065 7220 626f 756e 6420 6f66 2074 6865  per bound of the
+0000dd80: 2066 6972 7374 2070 6172 7469 7469 6f6e   first partition
+0000dd90: 2c20 616e 6420 736f 206f 6e2e 0a20 2020  , and so on..   
+0000dda0: 2020 2020 2054 6865 2073 6563 6f6e 642d       The second-
+0000ddb0: 746f 2d6c 6173 7420 6974 656d 2069 7320  to-last item is 
+0000ddc0: 7468 6520 6c6f 7765 7220 626f 756e 6420  the lower bound 
+0000ddd0: 6f66 2074 6865 206c 6173 7420 7061 7274  of the last part
+0000dde0: 6974 696f 6e2c 2061 6e64 2074 6865 206c  ition, and the l
+0000ddf0: 6173 740a 2020 2020 2020 2020 2865 7874  ast.        (ext
+0000de00: 7261 2920 6974 656d 2069 7320 7468 6520  ra) item is the 
+0000de10: 7570 7065 7220 626f 756e 6420 6f66 2074  upper bound of t
+0000de20: 6865 206c 6173 7420 7061 7274 6974 696f  he last partitio
+0000de30: 6e2e 0a0a 2020 2020 2020 2020 4578 616d  n...        Exam
+0000de40: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
+0000de50: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
+0000de60: 3e20 6466 203d 2064 662e 7265 7061 7274  > df = df.repart
+0000de70: 6974 696f 6e28 6e70 6172 7469 7469 6f6e  ition(npartition
+0000de80: 733d 3130 2920 2023 2064 6f63 7465 7374  s=10)  # doctest
+0000de90: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
+0000dea0: 3e3e 3e20 6466 203d 2064 662e 7265 7061  >>> df = df.repa
+0000deb0: 7274 6974 696f 6e28 6469 7669 7369 6f6e  rtition(division
+0000dec0: 733d 5b30 2c20 352c 2031 302c 2032 305d  s=[0, 5, 10, 20]
+0000ded0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+0000dee0: 4b49 500a 2020 2020 2020 2020 3e3e 3e20  KIP.        >>> 
+0000def0: 6466 203d 2064 662e 7265 7061 7274 6974  df = df.repartit
+0000df00: 696f 6e28 6672 6571 3d27 3764 2729 2020  ion(freq='7d')  
+0000df10: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
+0000df20: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+0000df30: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+0000df40: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
+0000df50: 4672 616d 652e 6d65 6d6f 7279 5f75 7361  Frame.memory_usa
+0000df60: 6765 5f70 6572 5f70 6172 7469 7469 6f6e  ge_per_partition
+0000df70: 0a20 2020 2020 2020 2070 616e 6461 732e  .        pandas.
+0000df80: 4461 7461 4672 616d 652e 6d65 6d6f 7279  DataFrame.memory
+0000df90: 5f75 7361 6765 0a20 2020 2020 2020 2022  _usage.        "
+0000dfa0: 2222 0a20 2020 2020 2020 2069 6620 6973  "".        if is
+0000dfb0: 696e 7374 616e 6365 2864 6976 6973 696f  instance(divisio
+0000dfc0: 6e73 2c20 696e 7429 3a0a 2020 2020 2020  ns, int):.      
+0000dfd0: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
+0000dfe0: 7320 3d20 6469 7669 7369 6f6e 730a 2020  s = divisions.  
+0000dff0: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
+0000e000: 6f6e 7320 3d20 4e6f 6e65 0a20 2020 2020  ons = None.     
+0000e010: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0000e020: 2864 6976 6973 696f 6e73 2c20 7374 7229  (divisions, str)
+0000e030: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
+0000e040: 7274 6974 696f 6e5f 7369 7a65 203d 2064  rtition_size = d
+0000e050: 6976 6973 696f 6e73 0a20 2020 2020 2020  ivisions.       
+0000e060: 2020 2020 2064 6976 6973 696f 6e73 203d       divisions =
+0000e070: 204e 6f6e 650a 2020 2020 2020 2020 6966   None.        if
+0000e080: 2028 0a20 2020 2020 2020 2020 2020 2073   (.            s
+0000e090: 756d 280a 2020 2020 2020 2020 2020 2020  um(.            
+0000e0a0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+0000e0b0: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+0000e0c0: 696f 6e5f 7369 7a65 2069 7320 6e6f 7420  ion_size is not 
+0000e0d0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+0000e0e0: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
+0000e0f0: 6f6e 7320 6973 206e 6f74 204e 6f6e 652c  ons is not None,
+0000e100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e110: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
+0000e120: 2069 7320 6e6f 7420 4e6f 6e65 2c0a 2020   is not None,.  
+0000e130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e140: 2020 6672 6571 2069 7320 6e6f 7420 4e6f    freq is not No
+0000e150: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+0000e160: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
+0000e170: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000e180: 213d 2031 0a20 2020 2020 2020 2029 3a0a  != 1.        ):.
+0000e190: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000e1a0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+0000e1b0: 2020 2020 2020 2020 2020 2020 2020 2250                "P
+0000e1c0: 6c65 6173 6520 7072 6f76 6964 6520 6578  lease provide ex
+0000e1d0: 6163 746c 7920 6f6e 6520 6f66 2060 606e  actly one of ``n
+0000e1e0: 7061 7274 6974 696f 6e73 3d60 602c 2060  partitions=``, `
+0000e1f0: 6066 7265 713d 6060 2c20 220a 2020 2020  `freq=``, ".    
+0000e200: 2020 2020 2020 2020 2020 2020 2260 6064              "``d
+0000e210: 6976 6973 696f 6e73 3d60 602c 2060 6070  ivisions=``, ``p
+0000e220: 6172 7469 7469 6f6e 5f73 697a 653d 6060  artition_size=``
+0000e230: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
+0000e240: 7473 220a 2020 2020 2020 2020 2020 2020  ts".            
+0000e250: 290a 0a20 2020 2020 2020 2069 6620 7061  )..        if pa
+0000e260: 7274 6974 696f 6e5f 7369 7a65 2069 7320  rtition_size is 
+0000e270: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0000e280: 2020 2020 2020 7265 7475 726e 2072 6570        return rep
+0000e290: 6172 7469 7469 6f6e 5f73 697a 6528 7365  artition_size(se
+0000e2a0: 6c66 2c20 7061 7274 6974 696f 6e5f 7369  lf, partition_si
+0000e2b0: 7a65 290a 2020 2020 2020 2020 656c 6966  ze).        elif
+0000e2c0: 206e 7061 7274 6974 696f 6e73 2069 7320   npartitions is 
+0000e2d0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0000e2e0: 2020 2020 2020 7265 7475 726e 2072 6570        return rep
+0000e2f0: 6172 7469 7469 6f6e 5f6e 7061 7274 6974  artition_npartit
+0000e300: 696f 6e73 2873 656c 662c 206e 7061 7274  ions(self, npart
+0000e310: 6974 696f 6e73 290a 2020 2020 2020 2020  itions).        
+0000e320: 656c 6966 2064 6976 6973 696f 6e73 2069  elif divisions i
+0000e330: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0000e340: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0000e350: 6570 6172 7469 7469 6f6e 2873 656c 662c  epartition(self,
+0000e360: 2064 6976 6973 696f 6e73 2c20 666f 7263   divisions, forc
+0000e370: 653d 666f 7263 6529 0a20 2020 2020 2020  e=force).       
+0000e380: 2065 6c69 6620 6672 6571 2069 7320 6e6f   elif freq is no
+0000e390: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0000e3a0: 2020 2020 7265 7475 726e 2072 6570 6172      return repar
+0000e3b0: 7469 7469 6f6e 5f66 7265 7128 7365 6c66  tition_freq(self
+0000e3c0: 2c20 6672 6571 3d66 7265 7129 0a0a 2020  , freq=freq)..  
+0000e3d0: 2020 6465 6620 7368 7566 666c 6528 0a20    def shuffle(. 
+0000e3e0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0000e3f0: 2020 2020 206f 6e2c 0a20 2020 2020 2020       on,.       
+0000e400: 206e 7061 7274 6974 696f 6e73 3d4e 6f6e   npartitions=Non
+0000e410: 652c 0a20 2020 2020 2020 206d 6178 5f62  e,.        max_b
+0000e420: 7261 6e63 683d 4e6f 6e65 2c0a 2020 2020  ranch=None,.    
+0000e430: 2020 2020 7368 7566 666c 653d 4e6f 6e65      shuffle=None
+0000e440: 2c0a 2020 2020 2020 2020 6967 6e6f 7265  ,.        ignore
+0000e450: 5f69 6e64 6578 3d46 616c 7365 2c0a 2020  _index=False,.  
+0000e460: 2020 2020 2020 636f 6d70 7574 653d 4e6f        compute=No
+0000e470: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
+0000e480: 2020 2022 2222 5265 6172 7261 6e67 6520     """Rearrange 
+0000e490: 4461 7461 4672 616d 6520 696e 746f 206e  DataFrame into n
+0000e4a0: 6577 2070 6172 7469 7469 6f6e 730a 0a20  ew partitions.. 
+0000e4b0: 2020 2020 2020 2055 7365 7320 6861 7368         Uses hash
+0000e4c0: 696e 6720 6f66 2060 6f6e 6020 746f 206d  ing of `on` to m
+0000e4d0: 6170 2072 6f77 7320 746f 206f 7574 7075  ap rows to outpu
+0000e4e0: 7420 7061 7274 6974 696f 6e73 2e20 4166  t partitions. Af
+0000e4f0: 7465 7220 7468 6973 0a20 2020 2020 2020  ter this.       
+0000e500: 206f 7065 7261 7469 6f6e 2c20 726f 7773   operation, rows
+0000e510: 2077 6974 6820 7468 6520 7361 6d65 2076   with the same v
+0000e520: 616c 7565 206f 6620 606f 6e60 2077 696c  alue of `on` wil
+0000e530: 6c20 6265 2069 6e20 7468 6520 7361 6d65  l be in the same
+0000e540: 0a20 2020 2020 2020 2070 6172 7469 7469  .        partiti
+0000e550: 6f6e 2e0a 0a20 2020 2020 2020 2050 6172  on...        Par
+0000e560: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+0000e570: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0000e580: 2020 206f 6e20 3a20 7374 722c 206c 6973     on : str, lis
+0000e590: 7420 6f66 2073 7472 2c20 6f72 2053 6572  t of str, or Ser
+0000e5a0: 6965 732c 2049 6e64 6578 2c20 6f72 2044  ies, Index, or D
+0000e5b0: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
+0000e5c0: 2020 2020 2043 6f6c 756d 6e28 7329 206f       Column(s) o
+0000e5d0: 7220 696e 6465 7820 746f 2062 6520 7573  r index to be us
+0000e5e0: 6564 2074 6f20 6d61 7020 726f 7773 2074  ed to map rows t
+0000e5f0: 6f20 6f75 7470 7574 2070 6172 7469 7469  o output partiti
+0000e600: 6f6e 730a 2020 2020 2020 2020 6e70 6172  ons.        npar
+0000e610: 7469 7469 6f6e 7320 3a20 696e 742c 206f  titions : int, o
+0000e620: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0000e630: 2020 2020 4e75 6d62 6572 206f 6620 7061      Number of pa
+0000e640: 7274 6974 696f 6e73 206f 6620 6f75 7470  rtitions of outp
+0000e650: 7574 2e20 5061 7274 6974 696f 6e20 636f  ut. Partition co
+0000e660: 756e 7420 7769 6c6c 206e 6f74 2062 650a  unt will not be.
+0000e670: 2020 2020 2020 2020 2020 2020 6368 616e              chan
+0000e680: 6765 6420 6279 2064 6566 6175 6c74 2e0a  ged by default..
+0000e690: 2020 2020 2020 2020 6d61 785f 6272 616e          max_bran
+0000e6a0: 6368 3a20 696e 742c 206f 7074 696f 6e61  ch: int, optiona
+0000e6b0: 6c0a 2020 2020 2020 2020 2020 2020 5468  l.            Th
+0000e6c0: 6520 6d61 7869 6d75 6d20 6e75 6d62 6572  e maximum number
+0000e6d0: 206f 6620 7370 6c69 7473 2070 6572 2069   of splits per i
+0000e6e0: 6e70 7574 2070 6172 7469 7469 6f6e 2e20  nput partition. 
+0000e6f0: 5573 6564 2077 6974 6869 6e0a 2020 2020  Used within.    
+0000e700: 2020 2020 2020 2020 7468 6520 7374 6167          the stag
+0000e710: 6564 2073 6875 6666 6c69 6e67 2061 6c67  ed shuffling alg
+0000e720: 6f72 6974 686d 2e0a 2020 2020 2020 2020  orithm..        
+0000e730: 7368 7566 666c 653a 207b 2764 6973 6b27  shuffle: {'disk'
+0000e740: 2c20 2774 6173 6b73 277d 2c20 6f70 7469  , 'tasks'}, opti
+0000e750: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+0000e760: 2045 6974 6865 7220 6060 2764 6973 6b27   Either ``'disk'
+0000e770: 6060 2066 6f72 2073 696e 676c 652d 6e6f  `` for single-no
+0000e780: 6465 206f 7065 7261 7469 6f6e 206f 7220  de operation or 
+0000e790: 6060 2774 6173 6b73 2760 6020 666f 720a  ``'tasks'`` for.
+0000e7a0: 2020 2020 2020 2020 2020 2020 6469 7374              dist
+0000e7b0: 7269 6275 7465 6420 6f70 6572 6174 696f  ributed operatio
+0000e7c0: 6e2e 2020 5769 6c6c 2062 6520 696e 6665  n.  Will be infe
+0000e7d0: 7272 6564 2062 7920 796f 7572 2063 7572  rred by your cur
+0000e7e0: 7265 6e74 2073 6368 6564 756c 6572 2e0a  rent scheduler..
+0000e7f0: 2020 2020 2020 2020 6967 6e6f 7265 5f69          ignore_i
+0000e800: 6e64 6578 3a20 626f 6f6c 2c20 6465 6661  ndex: bool, defa
+0000e810: 756c 7420 4661 6c73 650a 2020 2020 2020  ult False.      
+0000e820: 2020 2020 2020 4967 6e6f 7265 2069 6e64        Ignore ind
+0000e830: 6578 2064 7572 696e 6720 7368 7566 666c  ex during shuffl
+0000e840: 652e 2020 4966 2060 6054 7275 6560 602c  e.  If ``True``,
+0000e850: 2070 6572 666f 726d 616e 6365 206d 6179   performance may
+0000e860: 2069 6d70 726f 7665 2c0a 2020 2020 2020   improve,.      
+0000e870: 2020 2020 2020 6275 7420 696e 6465 7820        but index 
+0000e880: 7661 6c75 6573 2077 696c 6c20 6e6f 7420  values will not 
+0000e890: 6265 2070 7265 7365 7276 6564 2e0a 2020  be preserved..  
+0000e8a0: 2020 2020 2020 636f 6d70 7574 653a 2062        compute: b
+0000e8b0: 6f6f 6c0a 2020 2020 2020 2020 2020 2020  ool.            
+0000e8c0: 5768 6574 6865 7220 6f72 206e 6f74 2074  Whether or not t
+0000e8d0: 6f20 7472 6967 6765 7220 616e 2069 6d6d  o trigger an imm
+0000e8e0: 6564 6961 7465 2063 6f6d 7075 7461 7469  ediate computati
+0000e8f0: 6f6e 2e20 4465 6661 756c 7473 2074 6f20  on. Defaults to 
+0000e900: 4661 6c73 652e 0a0a 2020 2020 2020 2020  False...        
+0000e910: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
+0000e920: 2d2d 2d0a 2020 2020 2020 2020 5468 6973  ---.        This
+0000e930: 2064 6f65 7320 6e6f 7420 7072 6573 6572   does not preser
+0000e940: 7665 2061 206d 6561 6e69 6e67 6675 6c20  ve a meaningful 
+0000e950: 696e 6465 782f 7061 7274 6974 696f 6e69  index/partitioni
+0000e960: 6e67 2073 6368 656d 652e 2054 6869 730a  ng scheme. This.
+0000e970: 2020 2020 2020 2020 6973 206e 6f74 2064          is not d
+0000e980: 6574 6572 6d69 6e69 7374 6963 2069 6620  eterministic if 
+0000e990: 646f 6e65 2069 6e20 7061 7261 6c6c 656c  done in parallel
+0000e9a0: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+0000e9b0: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
+0000e9c0: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
+0000e9d0: 2064 6620 3d20 6466 2e73 6875 6666 6c65   df = df.shuffle
+0000e9e0: 2864 662e 636f 6c75 6d6e 735b 305d 2920  (df.columns[0]) 
+0000e9f0: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+0000ea00: 500a 2020 2020 2020 2020 2222 220a 2020  P.        """.  
+0000ea10: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+0000ea20: 6461 7461 6672 616d 652e 7368 7566 666c  dataframe.shuffl
+0000ea30: 6520 696d 706f 7274 2073 6875 6666 6c65  e import shuffle
+0000ea40: 2061 7320 6464 5f73 6875 6666 6c65 0a0a   as dd_shuffle..
+0000ea50: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+0000ea60: 645f 7368 7566 666c 6528 0a20 2020 2020  d_shuffle(.     
+0000ea70: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0000ea80: 2020 2020 2020 2020 206f 6e2c 0a20 2020           on,.   
+0000ea90: 2020 2020 2020 2020 206e 7061 7274 6974           npartit
+0000eaa0: 696f 6e73 3d6e 7061 7274 6974 696f 6e73  ions=npartitions
+0000eab0: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
+0000eac0: 785f 6272 616e 6368 3d6d 6178 5f62 7261  x_branch=max_bra
+0000ead0: 6e63 682c 0a20 2020 2020 2020 2020 2020  nch,.           
+0000eae0: 2073 6875 6666 6c65 3d73 6875 6666 6c65   shuffle=shuffle
+0000eaf0: 2c0a 2020 2020 2020 2020 2020 2020 6967  ,.            ig
+0000eb00: 6e6f 7265 5f69 6e64 6578 3d69 676e 6f72  nore_index=ignor
+0000eb10: 655f 696e 6465 782c 0a20 2020 2020 2020  e_index,.       
+0000eb20: 2020 2020 2063 6f6d 7075 7465 3d63 6f6d       compute=com
+0000eb30: 7075 7465 2c0a 2020 2020 2020 2020 290a  pute,.        ).
+0000eb40: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+0000eb50: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+0000eb60: 0a20 2020 2064 6566 2066 696c 6c6e 6128  .    def fillna(
+0000eb70: 7365 6c66 2c20 7661 6c75 653d 4e6f 6e65  self, value=None
+0000eb80: 2c20 6d65 7468 6f64 3d4e 6f6e 652c 206c  , method=None, l
+0000eb90: 696d 6974 3d4e 6f6e 652c 2061 7869 733d  imit=None, axis=
+0000eba0: 4e6f 6e65 293a 0a20 2020 2020 2020 2061  None):.        a
+0000ebb0: 7869 7320 3d20 7365 6c66 2e5f 7661 6c69  xis = self._vali
+0000ebc0: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
+0000ebd0: 2020 2020 2020 2020 6966 206d 6574 686f          if metho
+0000ebe0: 6420 6973 204e 6f6e 6520 616e 6420 6c69  d is None and li
+0000ebf0: 6d69 7420 6973 206e 6f74 204e 6f6e 653a  mit is not None:
+0000ec00: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000ec10: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+0000ec20: 6445 7272 6f72 2822 6669 6c6c 6e61 2077  dError("fillna w
+0000ec30: 6974 6820 7365 7420 6c69 6d69 7420 616e  ith set limit an
+0000ec40: 6420 6d65 7468 6f64 3d4e 6f6e 6522 290a  d method=None").
+0000ec50: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0000ec60: 7461 6e63 6528 7661 6c75 652c 2028 5f46  tance(value, (_F
+0000ec70: 7261 6d65 2c20 5363 616c 6172 2929 3a0a  rame, Scalar)):.
+0000ec80: 2020 2020 2020 2020 2020 2020 7465 7374              test
+0000ec90: 5f76 616c 7565 203d 2076 616c 7565 2e5f  _value = value._
+0000eca0: 6d65 7461 5f6e 6f6e 656d 7074 790a 2020  meta_nonempty.  
+0000ecb0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000ecc0: 2020 2020 2020 2020 7465 7374 5f76 616c          test_val
+0000ecd0: 7565 203d 2076 616c 7565 0a20 2020 2020  ue = value.     
+0000ece0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+0000ecf0: 6d65 7461 5f6e 6f6e 656d 7074 792e 6669  meta_nonempty.fi
+0000ed00: 6c6c 6e61 280a 2020 2020 2020 2020 2020  llna(.          
+0000ed10: 2020 7661 6c75 653d 7465 7374 5f76 616c    value=test_val
+0000ed20: 7565 2c20 6d65 7468 6f64 3d6d 6574 686f  ue, method=metho
+0000ed30: 642c 206c 696d 6974 3d6c 696d 6974 2c20  d, limit=limit, 
+0000ed40: 6178 6973 3d61 7869 730a 2020 2020 2020  axis=axis.      
+0000ed50: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
+0000ed60: 6178 6973 203d 3d20 3120 6f72 206d 6574  axis == 1 or met
+0000ed70: 686f 6420 6973 204e 6f6e 653a 0a20 2020  hod is None:.   
+0000ed80: 2020 2020 2020 2020 2023 2043 6f6e 7472           # Contr
+0000ed90: 6f6c 2077 6865 7468 6572 206f 7220 6e6f  ol whether or no
+0000eda0: 7420 6461 736b 2773 2070 6172 7469 7469  t dask's partiti
+0000edb0: 6f6e 2061 6c69 676e 6d65 6e74 2068 6170  on alignment hap
+0000edc0: 7065 6e73 2e0a 2020 2020 2020 2020 2020  pens..          
+0000edd0: 2020 2320 5765 2064 6f6e 2774 2077 616e    # We don't wan
+0000ede0: 7420 666f 7220 6120 7061 6e64 6173 2053  t for a pandas S
+0000edf0: 6572 6965 732e 0a20 2020 2020 2020 2020  eries..         
+0000ee00: 2020 2023 2057 6520 646f 2077 616e 7420     # We do want 
+0000ee10: 6974 2066 6f72 2061 2064 6173 6b20 5365  it for a dask Se
+0000ee20: 7269 6573 0a20 2020 2020 2020 2020 2020  ries.           
+0000ee30: 2069 6620 6973 5f73 6572 6965 735f 6c69   if is_series_li
+0000ee40: 6b65 2876 616c 7565 2920 616e 6420 6e6f  ke(value) and no
+0000ee50: 7420 6973 5f64 6173 6b5f 636f 6c6c 6563  t is_dask_collec
+0000ee60: 7469 6f6e 2876 616c 7565 293a 0a20 2020  tion(value):.   
+0000ee70: 2020 2020 2020 2020 2020 2020 2061 7267               arg
+0000ee80: 7320 3d20 2829 0a20 2020 2020 2020 2020  s = ().         
+0000ee90: 2020 2020 2020 206b 7761 7267 7320 3d20         kwargs = 
+0000eea0: 7b22 7661 6c75 6522 3a20 7661 6c75 657d  {"value": value}
+0000eeb0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0000eec0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000eed0: 2020 2061 7267 7320 3d20 2876 616c 7565     args = (value
+0000eee0: 2c29 0a20 2020 2020 2020 2020 2020 2020  ,).             
+0000eef0: 2020 206b 7761 7267 7320 3d20 7b7d 0a20     kwargs = {}. 
+0000ef00: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000ef10: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+0000ef20: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+0000ef30: 2020 2020 2020 204d 2e66 696c 6c6e 612c         M.fillna,
+0000ef40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ef50: 202a 6172 6773 2c0a 2020 2020 2020 2020   *args,.        
+0000ef60: 2020 2020 2020 2020 6d65 7468 6f64 3d6d          method=m
+0000ef70: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
+0000ef80: 2020 2020 2020 206c 696d 6974 3d6c 696d         limit=lim
+0000ef90: 6974 2c0a 2020 2020 2020 2020 2020 2020  it,.            
+0000efa0: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
+0000efb0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000efc0: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
+0000efd0: 2020 2020 2020 2020 2020 656e 666f 7263            enforc
+0000efe0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+0000eff0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000f000: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
+0000f010: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0000f020: 2020 2069 6620 6d65 7468 6f64 2069 6e20     if method in 
+0000f030: 2822 7061 6422 2c20 2266 6669 6c6c 2229  ("pad", "ffill")
+0000f040: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
+0000f050: 7468 6f64 203d 2022 6666 696c 6c22 0a20  thod = "ffill". 
+0000f060: 2020 2020 2020 2020 2020 2073 6b69 705f             skip_
+0000f070: 6368 6563 6b20 3d20 300a 2020 2020 2020  check = 0.      
+0000f080: 2020 2020 2020 6265 666f 7265 2c20 6166        before, af
+0000f090: 7465 7220 3d20 3120 6966 206c 696d 6974  ter = 1 if limit
+0000f0a0: 2069 7320 4e6f 6e65 2065 6c73 6520 6c69   is None else li
+0000f0b0: 6d69 742c 2030 0a20 2020 2020 2020 2065  mit, 0.        e
+0000f0c0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000f0d0: 206d 6574 686f 6420 3d20 2262 6669 6c6c   method = "bfill
+0000f0e0: 220a 2020 2020 2020 2020 2020 2020 736b  ".            sk
+0000f0f0: 6970 5f63 6865 636b 203d 2073 656c 662e  ip_check = self.
+0000f100: 6e70 6172 7469 7469 6f6e 7320 2d20 310a  npartitions - 1.
+0000f110: 2020 2020 2020 2020 2020 2020 6265 666f              befo
+0000f120: 7265 2c20 6166 7465 7220 3d20 302c 2031  re, after = 0, 1
+0000f130: 2069 6620 6c69 6d69 7420 6973 204e 6f6e   if limit is Non
+0000f140: 6520 656c 7365 206c 696d 6974 0a0a 2020  e else limit..  
+0000f150: 2020 2020 2020 6966 206c 696d 6974 2069        if limit i
+0000f160: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0000f170: 2020 2020 6e61 6d65 203d 2022 6669 6c6c      name = "fill
+0000f180: 6e61 2d63 6875 6e6b 2d22 202b 2074 6f6b  na-chunk-" + tok
+0000f190: 656e 697a 6528 7365 6c66 2c20 6d65 7468  enize(self, meth
+0000f1a0: 6f64 290a 2020 2020 2020 2020 2020 2020  od).            
+0000f1b0: 6473 6b20 3d20 7b0a 2020 2020 2020 2020  dsk = {.        
+0000f1c0: 2020 2020 2020 2020 286e 616d 652c 2069          (name, i
+0000f1d0: 293a 2028 0a20 2020 2020 2020 2020 2020  ): (.           
+0000f1e0: 2020 2020 2020 2020 206d 6574 686f 6473           methods
+0000f1f0: 2e66 696c 6c6e 615f 6368 6563 6b2c 0a20  .fillna_check,. 
+0000f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f210: 2020 2028 7365 6c66 2e5f 6e61 6d65 2c20     (self._name, 
+0000f220: 6929 2c0a 2020 2020 2020 2020 2020 2020  i),.            
+0000f230: 2020 2020 2020 2020 6d65 7468 6f64 2c0a          method,.
+0000f240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f250: 2020 2020 6920 213d 2073 6b69 705f 6368      i != skip_ch
+0000f260: 6563 6b2c 0a20 2020 2020 2020 2020 2020  eck,.           
+0000f270: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0000f280: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+0000f290: 7261 6e67 6528 7365 6c66 2e6e 7061 7274  range(self.npart
+0000f2a0: 6974 696f 6e73 290a 2020 2020 2020 2020  itions).        
+0000f2b0: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+0000f2c0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+0000f2d0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+0000f2e0: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
+0000f2f0: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
+0000f300: 733d 5b73 656c 665d 290a 2020 2020 2020  s=[self]).      
+0000f310: 2020 2020 2020 7061 7274 7320 3d20 6e65        parts = ne
+0000f320: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
+0000f330: 682c 206e 616d 652c 206d 6574 612c 2073  h, name, meta, s
+0000f340: 656c 662e 6469 7669 7369 6f6e 7329 0a20  elf.divisions). 
+0000f350: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000f360: 2020 2020 2020 2020 2070 6172 7473 203d           parts =
+0000f370: 2073 656c 660a 0a20 2020 2020 2020 2072   self..        r
+0000f380: 6574 7572 6e20 7061 7274 732e 6d61 705f  eturn parts.map_
+0000f390: 6f76 6572 6c61 7028 0a20 2020 2020 2020  overlap(.       
+0000f3a0: 2020 2020 204d 2e66 696c 6c6e 612c 2062       M.fillna, b
+0000f3b0: 6566 6f72 652c 2061 6674 6572 2c20 6d65  efore, after, me
+0000f3c0: 7468 6f64 3d6d 6574 686f 642c 206c 696d  thod=method, lim
+0000f3d0: 6974 3d6c 696d 6974 2c20 6d65 7461 3d6d  it=limit, meta=m
+0000f3e0: 6574 610a 2020 2020 2020 2020 290a 0a20  eta.        ).. 
+0000f3f0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0000f400: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0000f410: 2020 2064 6566 2066 6669 6c6c 2873 656c     def ffill(sel
+0000f420: 662c 2061 7869 733d 4e6f 6e65 2c20 6c69  f, axis=None, li
+0000f430: 6d69 743d 4e6f 6e65 293a 0a20 2020 2020  mit=None):.     
+0000f440: 2020 2072 6574 7572 6e20 7365 6c66 2e66     return self.f
+0000f450: 696c 6c6e 6128 6d65 7468 6f64 3d22 6666  illna(method="ff
+0000f460: 696c 6c22 2c20 6c69 6d69 743d 6c69 6d69  ill", limit=limi
+0000f470: 742c 2061 7869 733d 6178 6973 290a 0a20  t, axis=axis).. 
+0000f480: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0000f490: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0000f4a0: 2020 2064 6566 2062 6669 6c6c 2873 656c     def bfill(sel
+0000f4b0: 662c 2061 7869 733d 4e6f 6e65 2c20 6c69  f, axis=None, li
+0000f4c0: 6d69 743d 4e6f 6e65 293a 0a20 2020 2020  mit=None):.     
+0000f4d0: 2020 2072 6574 7572 6e20 7365 6c66 2e66     return self.f
+0000f4e0: 696c 6c6e 6128 6d65 7468 6f64 3d22 6266  illna(method="bf
+0000f4f0: 696c 6c22 2c20 6c69 6d69 743d 6c69 6d69  ill", limit=limi
+0000f500: 742c 2061 7869 733d 6178 6973 290a 0a20  t, axis=axis).. 
+0000f510: 2020 2064 6566 2073 616d 706c 6528 7365     def sample(se
+0000f520: 6c66 2c20 6e3d 4e6f 6e65 2c20 6672 6163  lf, n=None, frac
+0000f530: 3d4e 6f6e 652c 2072 6570 6c61 6365 3d46  =None, replace=F
+0000f540: 616c 7365 2c20 7261 6e64 6f6d 5f73 7461  alse, random_sta
+0000f550: 7465 3d4e 6f6e 6529 3a0a 2020 2020 2020  te=None):.      
+0000f560: 2020 2222 2252 616e 646f 6d20 7361 6d70    """Random samp
+0000f570: 6c65 206f 6620 6974 656d 730a 0a20 2020  le of items..   
+0000f580: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+0000f590: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000f5a0: 2d2d 0a20 2020 2020 2020 206e 203a 2069  --.        n : i
+0000f5b0: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
+0000f5c0: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
+0000f5d0: 6f66 2069 7465 6d73 2074 6f20 7265 7475  of items to retu
+0000f5e0: 726e 2069 7320 6e6f 7420 7375 7070 6f72  rn is not suppor
+0000f5f0: 7465 6420 6279 2064 6173 6b2e 2055 7365  ted by dask. Use
+0000f600: 2066 7261 630a 2020 2020 2020 2020 2020   frac.          
+0000f610: 2020 696e 7374 6561 642e 0a20 2020 2020    instead..     
+0000f620: 2020 2066 7261 6320 3a20 666c 6f61 742c     frac : float,
+0000f630: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0000f640: 2020 2020 2020 4170 7072 6f78 696d 6174        Approximat
+0000f650: 6520 6672 6163 7469 6f6e 206f 6620 6974  e fraction of it
+0000f660: 656d 7320 746f 2072 6574 7572 6e2e 2054  ems to return. T
+0000f670: 6869 7320 7361 6d70 6c69 6e67 2066 7261  his sampling fra
+0000f680: 6374 696f 6e20 6973 0a20 2020 2020 2020  ction is.       
+0000f690: 2020 2020 2061 7070 6c69 6564 2074 6f20       applied to 
+0000f6a0: 616c 6c20 7061 7274 6974 696f 6e73 2065  all partitions e
+0000f6b0: 7175 616c 6c79 2e20 4e6f 7465 2074 6861  qually. Note tha
+0000f6c0: 7420 7468 6973 2069 7320 616e 0a20 2020  t this is an.   
+0000f6d0: 2020 2020 2020 2020 202a 2a61 7070 726f           **appro
+0000f6e0: 7869 6d61 7465 2066 7261 6374 696f 6e2a  ximate fraction*
+0000f6f0: 2a2e 2059 6f75 2073 686f 756c 6420 6e6f  *. You should no
+0000f700: 7420 6578 7065 6374 2065 7861 6374 6c79  t expect exactly
+0000f710: 2060 606c 656e 2864 6629 202a 2066 7261   ``len(df) * fra
+0000f720: 6360 600a 2020 2020 2020 2020 2020 2020  c``.            
+0000f730: 6974 656d 7320 746f 2062 6520 7265 7475  items to be retu
+0000f740: 726e 6564 2c20 6173 2074 6865 2065 7861  rned, as the exa
+0000f750: 6374 206e 756d 6265 7220 6f66 2065 6c65  ct number of ele
+0000f760: 6d65 6e74 7320 7365 6c65 6374 6564 2077  ments selected w
+0000f770: 696c 6c0a 2020 2020 2020 2020 2020 2020  ill.            
+0000f780: 6465 7065 6e64 206f 6e20 686f 7720 796f  depend on how yo
+0000f790: 7572 2064 6174 6120 6973 2070 6172 7469  ur data is parti
+0000f7a0: 7469 6f6e 6564 2028 6275 7420 7368 6f75  tioned (but shou
+0000f7b0: 6c64 2062 6520 7072 6574 7479 2063 6c6f  ld be pretty clo
+0000f7c0: 7365 0a20 2020 2020 2020 2020 2020 2069  se.            i
+0000f7d0: 6e20 7072 6163 7469 6365 292e 0a20 2020  n practice)..   
+0000f7e0: 2020 2020 2072 6570 6c61 6365 203a 2062       replace : b
+0000f7f0: 6f6f 6c65 616e 2c20 6f70 7469 6f6e 616c  oolean, optional
+0000f800: 0a20 2020 2020 2020 2020 2020 2053 616d  .            Sam
+0000f810: 706c 6520 7769 7468 206f 7220 7769 7468  ple with or with
+0000f820: 6f75 7420 7265 706c 6163 656d 656e 742e  out replacement.
+0000f830: 2044 6566 6175 6c74 203d 2046 616c 7365   Default = False
+0000f840: 2e0a 2020 2020 2020 2020 7261 6e64 6f6d  ..        random
+0000f850: 5f73 7461 7465 203a 2069 6e74 206f 7220  _state : int or 
+0000f860: 6060 6e70 2e72 616e 646f 6d2e 5261 6e64  ``np.random.Rand
+0000f870: 6f6d 5374 6174 6560 600a 2020 2020 2020  omState``.      
+0000f880: 2020 2020 2020 4966 2061 6e20 696e 742c        If an int,
+0000f890: 2077 6520 6372 6561 7465 2061 206e 6577   we create a new
+0000f8a0: 2052 616e 646f 6d53 7461 7465 2077 6974   RandomState wit
+0000f8b0: 6820 7468 6973 2061 7320 7468 6520 7365  h this as the se
+0000f8c0: 6564 3b0a 2020 2020 2020 2020 2020 2020  ed;.            
+0000f8d0: 4f74 6865 7277 6973 6520 7765 2064 7261  Otherwise we dra
+0000f8e0: 7720 6672 6f6d 2074 6865 2070 6173 7365  w from the passe
+0000f8f0: 6420 5261 6e64 6f6d 5374 6174 652e 0a0a  d RandomState...
+0000f900: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
+0000f910: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000f920: 2d0a 2020 2020 2020 2020 4461 7461 4672  -.        DataFr
+0000f930: 616d 652e 7261 6e64 6f6d 5f73 706c 6974  ame.random_split
+0000f940: 0a20 2020 2020 2020 2070 616e 6461 732e  .        pandas.
+0000f950: 4461 7461 4672 616d 652e 7361 6d70 6c65  DataFrame.sample
+0000f960: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000f970: 2020 2020 2069 6620 6e20 6973 206e 6f74       if n is not
+0000f980: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0000f990: 2020 206d 7367 203d 2028 0a20 2020 2020     msg = (.     
+0000f9a0: 2020 2020 2020 2020 2020 2022 7361 6d70             "samp
+0000f9b0: 6c65 2064 6f65 7320 6e6f 7420 7375 7070  le does not supp
+0000f9c0: 6f72 7420 7468 6520 6e75 6d62 6572 206f  ort the number o
+0000f9d0: 6620 7361 6d70 6c65 6420 6974 656d 7320  f sampled items 
+0000f9e0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0000f9f0: 2020 2270 6172 616d 6574 6572 2c20 276e    "parameter, 'n
+0000fa00: 272e 2050 6c65 6173 6520 7573 6520 7468  '. Please use th
+0000fa10: 6520 2766 7261 6327 2070 6172 616d 6574  e 'frac' paramet
+0000fa20: 6572 2069 6e73 7465 6164 2e22 0a20 2020  er instead.".   
+0000fa30: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000fa40: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0000fa50: 616e 6365 286e 2c20 4e75 6d62 6572 2920  ance(n, Number) 
+0000fa60: 616e 6420 3020 3c3d 206e 203c 3d20 313a  and 0 <= n <= 1:
+0000fa70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fa80: 2077 6172 6e69 6e67 732e 7761 726e 286d   warnings.warn(m
+0000fa90: 7367 290a 2020 2020 2020 2020 2020 2020  sg).            
+0000faa0: 2020 2020 6672 6163 203d 206e 0a20 2020      frac = n.   
+0000fab0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000fac0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000fad0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0000fae0: 6d73 6729 0a0a 2020 2020 2020 2020 6966  msg)..        if
+0000faf0: 2066 7261 6320 6973 204e 6f6e 653a 0a20   frac is None:. 
+0000fb00: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000fb10: 2056 616c 7565 4572 726f 7228 2266 7261   ValueError("fra
+0000fb20: 6320 6d75 7374 206e 6f74 2062 6520 4e6f  c must not be No
+0000fb30: 6e65 2229 0a0a 2020 2020 2020 2020 6966  ne")..        if
+0000fb40: 2072 616e 646f 6d5f 7374 6174 6520 6973   random_state is
+0000fb50: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0000fb60: 2020 2072 616e 646f 6d5f 7374 6174 6520     random_state 
+0000fb70: 3d20 6e70 2e72 616e 646f 6d2e 5261 6e64  = np.random.Rand
+0000fb80: 6f6d 5374 6174 6528 290a 0a20 2020 2020  omState()..     
+0000fb90: 2020 206e 616d 6520 3d20 2273 616d 706c     name = "sampl
+0000fba0: 652d 2220 2b20 746f 6b65 6e69 7a65 2873  e-" + tokenize(s
+0000fbb0: 656c 662c 2066 7261 632c 2072 6570 6c61  elf, frac, repla
+0000fbc0: 6365 2c20 7261 6e64 6f6d 5f73 7461 7465  ce, random_state
+0000fbd0: 290a 0a20 2020 2020 2020 2073 7461 7465  )..        state
+0000fbe0: 5f64 6174 6120 3d20 7261 6e64 6f6d 5f73  _data = random_s
+0000fbf0: 7461 7465 5f64 6174 6128 7365 6c66 2e6e  tate_data(self.n
+0000fc00: 7061 7274 6974 696f 6e73 2c20 7261 6e64  partitions, rand
+0000fc10: 6f6d 5f73 7461 7465 290a 2020 2020 2020  om_state).      
+0000fc20: 2020 6473 6b20 3d20 7b0a 2020 2020 2020    dsk = {.      
+0000fc30: 2020 2020 2020 286e 616d 652c 2069 293a        (name, i):
+0000fc40: 2028 6d65 7468 6f64 732e 7361 6d70 6c65   (methods.sample
+0000fc50: 2c20 2873 656c 662e 5f6e 616d 652c 2069  , (self._name, i
+0000fc60: 292c 2073 7461 7465 2c20 6672 6163 2c20  ), state, frac, 
+0000fc70: 7265 706c 6163 6529 0a20 2020 2020 2020  replace).       
+0000fc80: 2020 2020 2066 6f72 2069 2c20 7374 6174       for i, stat
+0000fc90: 6520 696e 2065 6e75 6d65 7261 7465 2873  e in enumerate(s
+0000fca0: 7461 7465 5f64 6174 6129 0a20 2020 2020  tate_data).     
+0000fcb0: 2020 207d 0a0a 2020 2020 2020 2020 6772     }..        gr
+0000fcc0: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+0000fcd0: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+0000fce0: 7469 6f6e 7328 6e61 6d65 2c20 6473 6b2c  tions(name, dsk,
+0000fcf0: 2064 6570 656e 6465 6e63 6965 733d 5b73   dependencies=[s
+0000fd00: 656c 665d 290a 2020 2020 2020 2020 7265  elf]).        re
+0000fd10: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
+0000fd20: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
+0000fd30: 7365 6c66 2e5f 6d65 7461 2c20 7365 6c66  self._meta, self
+0000fd40: 2e64 6976 6973 696f 6e73 290a 0a20 2020  .divisions)..   
+0000fd50: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+0000fd60: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+0000fd70: 2064 6566 2072 6570 6c61 6365 2873 656c   def replace(sel
+0000fd80: 662c 2074 6f5f 7265 706c 6163 653d 4e6f  f, to_replace=No
+0000fd90: 6e65 2c20 7661 6c75 653d 4e6f 6e65 2c20  ne, value=None, 
+0000fda0: 7265 6765 783d 4661 6c73 6529 3a0a 2020  regex=False):.  
+0000fdb0: 2020 2020 2020 2320 496e 2050 414e 4441        # In PANDA
+0000fdc0: 535f 4754 5f31 3430 2070 616e 6461 7320  S_GT_140 pandas 
+0000fdd0: 7374 6172 7473 2075 7369 6e67 206e 6f5f  starts using no_
+0000fde0: 6465 6661 756c 7420 696e 7374 6561 6420  default instead 
+0000fdf0: 6f66 204e 6f6e 650a 2020 2020 2020 2020  of None.        
+0000fe00: 7661 6c75 655f 6b77 6172 6720 3d20 7b22  value_kwarg = {"
+0000fe10: 7661 6c75 6522 3a20 7661 6c75 657d 2069  value": value} i
+0000fe20: 6620 7661 6c75 6520 6973 206e 6f74 204e  f value is not N
+0000fe30: 6f6e 6520 656c 7365 207b 7d0a 2020 2020  one else {}.    
+0000fe40: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000fe50: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+0000fe60: 2020 2020 2020 2020 2020 2020 4d2e 7265              M.re
+0000fe70: 706c 6163 652c 0a20 2020 2020 2020 2020  place,.         
+0000fe80: 2020 2074 6f5f 7265 706c 6163 653d 746f     to_replace=to
+0000fe90: 5f72 6570 6c61 6365 2c0a 2020 2020 2020  _replace,.      
+0000fea0: 2020 2020 2020 2a2a 7661 6c75 655f 6b77        **value_kw
+0000feb0: 6172 672c 0a20 2020 2020 2020 2020 2020  arg,.           
+0000fec0: 2072 6567 6578 3d72 6567 6578 2c0a 2020   regex=regex,.  
+0000fed0: 2020 2020 2020 2020 2020 656e 666f 7263            enforc
+0000fee0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+0000fef0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0000ff00: 2064 6566 2074 6f5f 6461 736b 5f61 7272   def to_dask_arr
+0000ff10: 6179 2873 656c 662c 206c 656e 6774 6873  ay(self, lengths
+0000ff20: 3d4e 6f6e 652c 206d 6574 613d 4e6f 6e65  =None, meta=None
+0000ff30: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
+0000ff40: 6e76 6572 7420 6120 6461 736b 2044 6174  nvert a dask Dat
+0000ff50: 6146 7261 6d65 2074 6f20 6120 6461 736b  aFrame to a dask
+0000ff60: 2061 7272 6179 2e0a 0a20 2020 2020 2020   array...       
+0000ff70: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0000ff80: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0000ff90: 2020 2020 2020 206c 656e 6774 6873 203a         lengths :
+0000ffa0: 2062 6f6f 6c20 6f72 2053 6571 7565 6e63   bool or Sequenc
+0000ffb0: 6520 6f66 2069 6e74 732c 206f 7074 696f  e of ints, optio
+0000ffc0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0000ffd0: 486f 7720 746f 2064 6574 6572 6d69 6e65  How to determine
+0000ffe0: 2074 6865 2063 6875 6e6b 7320 7369 7a65   the chunks size
+0000fff0: 7320 666f 7220 7468 6520 6f75 7470 7574  s for the output
+00010000: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
+00010010: 2020 2020 4279 2064 6566 6175 6c74 2c20      By default, 
+00010020: 7468 6520 6f75 7470 7574 2061 7272 6179  the output array
+00010030: 2077 696c 6c20 6861 7665 2075 6e6b 6e6f   will have unkno
+00010040: 776e 2063 6875 6e6b 206c 656e 6774 6873  wn chunk lengths
+00010050: 0a20 2020 2020 2020 2020 2020 2061 6c6f  .            alo
+00010060: 6e67 2074 6865 2066 6972 7374 2061 7869  ng the first axi
+00010070: 732c 2077 6869 6368 2063 616e 2063 6175  s, which can cau
+00010080: 7365 2073 6f6d 6520 6c61 7465 7220 6f70  se some later op
+00010090: 6572 6174 696f 6e73 0a20 2020 2020 2020  erations.       
+000100a0: 2020 2020 2074 6f20 6661 696c 2e0a 0a20       to fail... 
+000100b0: 2020 2020 2020 2020 2020 202a 2054 7275             * Tru
+000100c0: 6520 3a20 696d 6d65 6469 6174 656c 7920  e : immediately 
+000100d0: 636f 6d70 7574 6520 7468 6520 6c65 6e67  compute the leng
+000100e0: 7468 206f 6620 6561 6368 2070 6172 7469  th of each parti
+000100f0: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+00010100: 202a 2053 6571 7565 6e63 6520 3a20 6120   * Sequence : a 
+00010110: 7365 7175 656e 6365 206f 6620 696e 7465  sequence of inte
+00010120: 6765 7273 2074 6f20 7573 6520 666f 7220  gers to use for 
+00010130: 7468 6520 6368 756e 6b20 7369 7a65 730a  the chunk sizes.
+00010140: 2020 2020 2020 2020 2020 2020 2020 6f6e                on
+00010150: 2074 6865 2066 6972 7374 2061 7869 732e   the first axis.
+00010160: 2054 6865 7365 2076 616c 7565 7320 6172   These values ar
+00010170: 6520 2a6e 6f74 2a20 7661 6c69 6461 7465  e *not* validate
+00010180: 6420 666f 720a 2020 2020 2020 2020 2020  d for.          
+00010190: 2020 2020 636f 7272 6563 746e 6573 732c      correctness,
+000101a0: 2062 6579 6f6e 6420 656e 7375 7269 6e67   beyond ensuring
+000101b0: 2074 6861 7420 7468 6520 6e75 6d62 6572   that the number
+000101c0: 206f 6620 6974 656d 730a 2020 2020 2020   of items.      
+000101d0: 2020 2020 2020 2020 6d61 7463 6865 7320          matches 
+000101e0: 7468 6520 6e75 6d62 6572 206f 6620 7061  the number of pa
+000101f0: 7274 6974 696f 6e73 2e0a 2020 2020 2020  rtitions..      
+00010200: 2020 6d65 7461 203a 206f 626a 6563 742c    meta : object,
+00010210: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00010220: 2020 2020 2020 416e 206f 7074 696f 6e61        An optiona
+00010230: 6c20 606d 6574 6160 2070 6172 616d 6574  l `meta` paramet
+00010240: 6572 2063 616e 2062 6520 7061 7373 6564  er can be passed
+00010250: 2066 6f72 2064 6173 6b20 746f 206f 7665   for dask to ove
+00010260: 7272 6964 6520 7468 650a 2020 2020 2020  rride the.      
+00010270: 2020 2020 2020 6465 6661 756c 7420 6d65        default me
+00010280: 7461 6461 7461 206f 6e20 7468 6520 756e  tadata on the un
+00010290: 6465 726c 7969 6e67 2064 6173 6b20 6172  derlying dask ar
+000102a0: 7261 792e 0a0a 2020 2020 2020 2020 5265  ray...        Re
+000102b0: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+000102c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 2222  -----.        ""
+000102d0: 220a 2020 2020 2020 2020 6966 206c 656e  ".        if len
+000102e0: 6774 6873 2069 7320 5472 7565 3a0a 2020  gths is True:.  
+000102f0: 2020 2020 2020 2020 2020 6c65 6e67 7468            length
+00010300: 7320 3d20 7475 706c 6528 7365 6c66 2e6d  s = tuple(self.m
+00010310: 6170 5f70 6172 7469 7469 6f6e 7328 6c65  ap_partitions(le
+00010320: 6e2c 2065 6e66 6f72 6365 5f6d 6574 6164  n, enforce_metad
+00010330: 6174 613d 4661 6c73 6529 2e63 6f6d 7075  ata=False).compu
+00010340: 7465 2829 290a 0a20 2020 2020 2020 2061  te())..        a
+00010350: 7272 203d 2073 656c 662e 7661 6c75 6573  rr = self.values
+00010360: 0a0a 2020 2020 2020 2020 6368 756e 6b73  ..        chunks
+00010370: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
+00010380: 655f 6368 756e 6b73 2861 7272 2c20 6c65  e_chunks(arr, le
+00010390: 6e67 7468 7329 0a20 2020 2020 2020 2061  ngths).        a
+000103a0: 7272 2e5f 6368 756e 6b73 203d 2063 6875  rr._chunks = chu
+000103b0: 6e6b 730a 0a20 2020 2020 2020 2069 6620  nks..        if 
+000103c0: 6d65 7461 2069 7320 6e6f 7420 4e6f 6e65  meta is not None
+000103d0: 3a0a 2020 2020 2020 2020 2020 2020 6172  :.            ar
+000103e0: 722e 5f6d 6574 6120 3d20 6d65 7461 0a0a  r._meta = meta..
+000103f0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00010400: 7272 0a0a 2020 2020 6465 6620 746f 5f68  rr..    def to_h
+00010410: 6466 2873 656c 662c 2070 6174 685f 6f72  df(self, path_or
+00010420: 5f62 7566 2c20 6b65 792c 206d 6f64 653d  _buf, key, mode=
+00010430: 2261 222c 2061 7070 656e 643d 4661 6c73  "a", append=Fals
+00010440: 652c 202a 2a6b 7761 7267 7329 3a0a 2020  e, **kwargs):.  
+00010450: 2020 2020 2020 2222 2253 6565 2064 642e        """See dd.
+00010460: 746f 5f68 6466 2064 6f63 7374 7269 6e67  to_hdf docstring
+00010470: 2066 6f72 206d 6f72 6520 696e 666f 726d   for more inform
+00010480: 6174 696f 6e22 2222 0a20 2020 2020 2020  ation""".       
+00010490: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+000104a0: 7261 6d65 2e69 6f20 696d 706f 7274 2074  rame.io import t
+000104b0: 6f5f 6864 660a 0a20 2020 2020 2020 2072  o_hdf..        r
+000104c0: 6574 7572 6e20 746f 5f68 6466 2873 656c  eturn to_hdf(sel
+000104d0: 662c 2070 6174 685f 6f72 5f62 7566 2c20  f, path_or_buf, 
+000104e0: 6b65 792c 206d 6f64 652c 2061 7070 656e  key, mode, appen
+000104f0: 642c 202a 2a6b 7761 7267 7329 0a0a 2020  d, **kwargs)..  
+00010500: 2020 6465 6620 746f 5f63 7376 2873 656c    def to_csv(sel
+00010510: 662c 2066 696c 656e 616d 652c 202a 2a6b  f, filename, **k
+00010520: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00010530: 2222 2253 6565 2064 642e 746f 5f63 7376  """See dd.to_csv
+00010540: 2064 6f63 7374 7269 6e67 2066 6f72 206d   docstring for m
+00010550: 6f72 6520 696e 666f 726d 6174 696f 6e22  ore information"
+00010560: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+00010570: 6461 736b 2e64 6174 6166 7261 6d65 2e69  dask.dataframe.i
+00010580: 6f20 696d 706f 7274 2074 6f5f 6373 760a  o import to_csv.
+00010590: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000105a0: 746f 5f63 7376 2873 656c 662c 2066 696c  to_csv(self, fil
+000105b0: 656e 616d 652c 202a 2a6b 7761 7267 7329  ename, **kwargs)
+000105c0: 0a0a 2020 2020 6465 6620 746f 5f73 716c  ..    def to_sql
+000105d0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+000105e0: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+000105f0: 722c 0a20 2020 2020 2020 2075 7269 3a20  r,.        uri: 
+00010600: 7374 722c 0a20 2020 2020 2020 2073 6368  str,.        sch
+00010610: 656d 613d 4e6f 6e65 2c0a 2020 2020 2020  ema=None,.      
+00010620: 2020 6966 5f65 7869 7374 733a 2073 7472    if_exists: str
+00010630: 203d 2022 6661 696c 222c 0a20 2020 2020   = "fail",.     
+00010640: 2020 2069 6e64 6578 3a20 626f 6f6c 203d     index: bool =
+00010650: 2054 7275 652c 0a20 2020 2020 2020 2069   True,.        i
+00010660: 6e64 6578 5f6c 6162 656c 3d4e 6f6e 652c  ndex_label=None,
+00010670: 0a20 2020 2020 2020 2063 6875 6e6b 7369  .        chunksi
+00010680: 7a65 3d4e 6f6e 652c 0a20 2020 2020 2020  ze=None,.       
+00010690: 2064 7479 7065 3d4e 6f6e 652c 0a20 2020   dtype=None,.   
+000106a0: 2020 2020 206d 6574 686f 643d 4e6f 6e65       method=None
+000106b0: 2c0a 2020 2020 2020 2020 636f 6d70 7574  ,.        comput
+000106c0: 653d 5472 7565 2c0a 2020 2020 2020 2020  e=True,.        
+000106d0: 7061 7261 6c6c 656c 3d46 616c 7365 2c0a  parallel=False,.
+000106e0: 2020 2020 2020 2020 656e 6769 6e65 5f6b          engine_k
+000106f0: 7761 7267 733d 4e6f 6e65 2c0a 2020 2020  wargs=None,.    
+00010700: 293a 0a20 2020 2020 2020 2022 2222 5365  ):.        """Se
+00010710: 6520 6464 2e74 6f5f 7371 6c20 646f 6373  e dd.to_sql docs
+00010720: 7472 696e 6720 666f 7220 6d6f 7265 2069  tring for more i
+00010730: 6e66 6f72 6d61 7469 6f6e 2222 220a 2020  nformation""".  
+00010740: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+00010750: 6461 7461 6672 616d 652e 696f 2069 6d70  dataframe.io imp
+00010760: 6f72 7420 746f 5f73 716c 0a0a 2020 2020  ort to_sql..    
+00010770: 2020 2020 7265 7475 726e 2074 6f5f 7371      return to_sq
+00010780: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
+00010790: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+000107a0: 206e 616d 653d 6e61 6d65 2c0a 2020 2020   name=name,.    
+000107b0: 2020 2020 2020 2020 7572 693d 7572 692c          uri=uri,
+000107c0: 0a20 2020 2020 2020 2020 2020 2073 6368  .            sch
+000107d0: 656d 613d 7363 6865 6d61 2c0a 2020 2020  ema=schema,.    
+000107e0: 2020 2020 2020 2020 6966 5f65 7869 7374          if_exist
+000107f0: 733d 6966 5f65 7869 7374 732c 0a20 2020  s=if_exists,.   
+00010800: 2020 2020 2020 2020 2069 6e64 6578 3d69           index=i
+00010810: 6e64 6578 2c0a 2020 2020 2020 2020 2020  ndex,.          
+00010820: 2020 696e 6465 785f 6c61 6265 6c3d 696e    index_label=in
+00010830: 6465 785f 6c61 6265 6c2c 0a20 2020 2020  dex_label,.     
+00010840: 2020 2020 2020 2063 6875 6e6b 7369 7a65         chunksize
+00010850: 3d63 6875 6e6b 7369 7a65 2c0a 2020 2020  =chunksize,.    
+00010860: 2020 2020 2020 2020 6474 7970 653d 6474          dtype=dt
+00010870: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00010880: 206d 6574 686f 643d 6d65 7468 6f64 2c0a   method=method,.
+00010890: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+000108a0: 7574 653d 636f 6d70 7574 652c 0a20 2020  ute=compute,.   
+000108b0: 2020 2020 2020 2020 2070 6172 616c 6c65           paralle
+000108c0: 6c3d 7061 7261 6c6c 656c 2c0a 2020 2020  l=parallel,.    
+000108d0: 2020 2020 2020 2020 656e 6769 6e65 5f6b          engine_k
+000108e0: 7761 7267 733d 656e 6769 6e65 5f6b 7761  wargs=engine_kwa
+000108f0: 7267 732c 0a20 2020 2020 2020 2029 0a0a  rgs,.        )..
+00010900: 2020 2020 6465 6620 746f 5f6a 736f 6e28      def to_json(
+00010910: 7365 6c66 2c20 6669 6c65 6e61 6d65 2c20  self, filename, 
+00010920: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00010930: 3a0a 2020 2020 2020 2020 2222 2253 6565  :.        """See
+00010940: 2064 642e 746f 5f6a 736f 6e20 646f 6373   dd.to_json docs
+00010950: 7472 696e 6720 666f 7220 6d6f 7265 2069  tring for more i
+00010960: 6e66 6f72 6d61 7469 6f6e 2222 220a 2020  nformation""".  
+00010970: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+00010980: 6461 7461 6672 616d 652e 696f 2069 6d70  dataframe.io imp
+00010990: 6f72 7420 746f 5f6a 736f 6e0a 0a20 2020  ort to_json..   
+000109a0: 2020 2020 2072 6574 7572 6e20 746f 5f6a       return to_j
+000109b0: 736f 6e28 7365 6c66 2c20 6669 6c65 6e61  son(self, filena
+000109c0: 6d65 2c20 2a61 7267 732c 202a 2a6b 7761  me, *args, **kwa
+000109d0: 7267 7329 0a0a 2020 2020 6465 6620 746f  rgs)..    def to
+000109e0: 5f64 656c 6179 6564 2873 656c 662c 206f  _delayed(self, o
+000109f0: 7074 696d 697a 655f 6772 6170 683d 5472  ptimize_graph=Tr
+00010a00: 7565 293a 0a20 2020 2020 2020 2022 2222  ue):.        """
+00010a10: 436f 6e76 6572 7420 696e 746f 2061 206c  Convert into a l
+00010a20: 6973 7420 6f66 2060 6064 6173 6b2e 6465  ist of ``dask.de
+00010a30: 6c61 7965 6460 6020 6f62 6a65 6374 732c  layed`` objects,
+00010a40: 206f 6e65 2070 6572 2070 6172 7469 7469   one per partiti
+00010a50: 6f6e 2e0a 0a20 2020 2020 2020 2050 6172  on...        Par
+00010a60: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00010a70: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00010a80: 2020 206f 7074 696d 697a 655f 6772 6170     optimize_grap
+00010a90: 6820 3a20 626f 6f6c 2c20 6f70 7469 6f6e  h : bool, option
+00010aa0: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
+00010ab0: 6620 5472 7565 205b 6465 6661 756c 745d  f True [default]
+00010ac0: 2c20 7468 6520 6772 6170 6820 6973 206f  , the graph is o
+00010ad0: 7074 696d 697a 6564 2062 6566 6f72 6520  ptimized before 
+00010ae0: 636f 6e76 6572 7469 6e67 2069 6e74 6f0a  converting into.
+00010af0: 2020 2020 2020 2020 2020 2020 6060 6461              ``da
+00010b00: 736b 2e64 656c 6179 6564 6060 206f 626a  sk.delayed`` obj
+00010b10: 6563 7473 2e0a 0a20 2020 2020 2020 2045  ects...        E
+00010b20: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
+00010b30: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00010b40: 203e 3e3e 2070 6172 7469 7469 6f6e 7320   >>> partitions 
+00010b50: 3d20 6466 2e74 6f5f 6465 6c61 7965 6428  = df.to_delayed(
+00010b60: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+00010b70: 4b49 500a 0a20 2020 2020 2020 2053 6565  KIP..        See
+00010b80: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
+00010b90: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
+00010ba0: 6173 6b2e 6461 7461 6672 616d 652e 6672  ask.dataframe.fr
+00010bb0: 6f6d 5f64 656c 6179 6564 0a20 2020 2020  om_delayed.     
+00010bc0: 2020 2022 2222 0a20 2020 2020 2020 206b     """.        k
+00010bd0: 6579 7320 3d20 7365 6c66 2e5f 5f64 6173  eys = self.__das
+00010be0: 6b5f 6b65 7973 5f5f 2829 0a20 2020 2020  k_keys__().     
+00010bf0: 2020 2067 7261 7068 203d 2073 656c 662e     graph = self.
+00010c00: 5f5f 6461 736b 5f67 7261 7068 5f5f 2829  __dask_graph__()
+00010c10: 0a20 2020 2020 2020 206c 6179 6572 203d  .        layer =
+00010c20: 2073 656c 662e 5f5f 6461 736b 5f6c 6179   self.__dask_lay
+00010c30: 6572 735f 5f28 295b 305d 0a20 2020 2020  ers__()[0].     
+00010c40: 2020 2069 6620 6f70 7469 6d69 7a65 5f67     if optimize_g
+00010c50: 7261 7068 3a0a 2020 2020 2020 2020 2020  raph:.          
+00010c60: 2020 6772 6170 6820 3d20 7365 6c66 2e5f    graph = self._
+00010c70: 5f64 6173 6b5f 6f70 7469 6d69 7a65 5f5f  _dask_optimize__
+00010c80: 2867 7261 7068 2c20 7365 6c66 2e5f 5f64  (graph, self.__d
+00010c90: 6173 6b5f 6b65 7973 5f5f 2829 290a 2020  ask_keys__()).  
+00010ca0: 2020 2020 2020 2020 2020 6c61 7965 7220            layer 
+00010cb0: 3d20 2264 656c 6179 6564 2d22 202b 2073  = "delayed-" + s
+00010cc0: 656c 662e 5f6e 616d 650a 2020 2020 2020  elf._name.      
+00010cd0: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
+00010ce0: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+00010cf0: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6c61  m_collections(la
+00010d00: 7965 722c 2067 7261 7068 2c20 6465 7065  yer, graph, depe
+00010d10: 6e64 656e 6369 6573 3d28 2929 0a20 2020  ndencies=()).   
+00010d20: 2020 2020 2072 6574 7572 6e20 5b44 656c       return [Del
+00010d30: 6179 6564 286b 2c20 6772 6170 682c 206c  ayed(k, graph, l
+00010d40: 6179 6572 3d6c 6179 6572 2920 666f 7220  ayer=layer) for 
+00010d50: 6b20 696e 206b 6579 735d 0a0a 2020 2020  k in keys]..    
+00010d60: 6465 6620 746f 5f62 6163 6b65 6e64 2873  def to_backend(s
+00010d70: 656c 662c 2062 6163 6b65 6e64 3a20 7374  elf, backend: st
+00010d80: 7220 7c20 4e6f 6e65 203d 204e 6f6e 652c  r | None = None,
+00010d90: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00010da0: 2020 2020 2222 224d 6f76 6520 746f 2061      """Move to a
+00010db0: 206e 6577 2044 6174 6146 7261 6d65 2062   new DataFrame b
+00010dc0: 6163 6b65 6e64 0a0a 2020 2020 2020 2020  ackend..        
+00010dd0: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+00010de0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00010df0: 2020 2020 2020 6261 636b 656e 6420 3a20        backend : 
+00010e00: 7374 722c 204f 7074 696f 6e61 6c0a 2020  str, Optional.  
+00010e10: 2020 2020 2020 2020 2020 5468 6520 6e61            The na
+00010e20: 6d65 206f 6620 7468 6520 6e65 7720 6261  me of the new ba
+00010e30: 636b 656e 6420 746f 206d 6f76 6520 746f  ckend to move to
+00010e40: 2e20 5468 6520 6465 6661 756c 740a 2020  . The default.  
+00010e50: 2020 2020 2020 2020 2020 6973 2074 6865            is the
+00010e60: 2063 7572 7265 6e74 2022 6461 7461 6672   current "datafr
+00010e70: 616d 652e 6261 636b 656e 6422 2063 6f6e  ame.backend" con
+00010e80: 6669 6775 7261 7469 6f6e 2e0a 0a20 2020  figuration...   
+00010e90: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+00010ea0: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+00010eb0: 2020 2020 2044 6174 6146 7261 6d65 2c20       DataFrame, 
+00010ec0: 5365 7269 6573 206f 7220 496e 6465 780a  Series or Index.
+00010ed0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00010ee0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+00010ef0: 7461 6672 616d 652e 696f 2069 6d70 6f72  taframe.io impor
+00010f00: 7420 746f 5f62 6163 6b65 6e64 0a0a 2020  t to_backend..  
+00010f10: 2020 2020 2020 7265 7475 726e 2074 6f5f        return to_
+00010f20: 6261 636b 656e 6428 7365 6c66 2c20 6261  backend(self, ba
+00010f30: 636b 656e 643d 6261 636b 656e 642c 202a  ckend=backend, *
+00010f40: 2a6b 7761 7267 7329 0a0a 2020 2020 4063  *kwargs)..    @c
+00010f50: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
+00010f60: 6566 205f 6765 745f 756e 6172 795f 6f70  ef _get_unary_op
+00010f70: 6572 6174 6f72 2863 6c73 2c20 6f70 293a  erator(cls, op):
+00010f80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00010f90: 6c61 6d62 6461 2073 656c 663a 2065 6c65  lambda self: ele
+00010fa0: 6d77 6973 6528 6f70 2c20 7365 6c66 290a  mwise(op, self).
+00010fb0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
+00010fc0: 640a 2020 2020 6465 6620 5f67 6574 5f62  d.    def _get_b
+00010fd0: 696e 6172 795f 6f70 6572 6174 6f72 2863  inary_operator(c
+00010fe0: 6c73 2c20 6f70 2c20 696e 763d 4661 6c73  ls, op, inv=Fals
+00010ff0: 6529 3a0a 2020 2020 2020 2020 6966 2069  e):.        if i
+00011000: 6e76 3a0a 2020 2020 2020 2020 2020 2020  nv:.            
+00011010: 7265 7475 726e 206c 616d 6264 6120 7365  return lambda se
+00011020: 6c66 2c20 6f74 6865 723a 2065 6c65 6d77  lf, other: elemw
+00011030: 6973 6528 6f70 2c20 6f74 6865 722c 2073  ise(op, other, s
+00011040: 656c 6629 0a20 2020 2020 2020 2065 6c73  elf).        els
+00011050: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00011060: 6574 7572 6e20 6c61 6d62 6461 2073 656c  eturn lambda sel
+00011070: 662c 206f 7468 6572 3a20 656c 656d 7769  f, other: elemwi
+00011080: 7365 286f 702c 2073 656c 662c 206f 7468  se(op, self, oth
+00011090: 6572 290a 0a20 2020 2064 6566 2072 6f6c  er)..    def rol
+000110a0: 6c69 6e67 280a 2020 2020 2020 2020 7365  ling(.        se
+000110b0: 6c66 2c20 7769 6e64 6f77 2c20 6d69 6e5f  lf, window, min_
+000110c0: 7065 7269 6f64 733d 4e6f 6e65 2c20 6365  periods=None, ce
+000110d0: 6e74 6572 3d46 616c 7365 2c20 7769 6e5f  nter=False, win_
+000110e0: 7479 7065 3d4e 6f6e 652c 2061 7869 733d  type=None, axis=
+000110f0: 6e6f 5f64 6566 6175 6c74 0a20 2020 2029  no_default.    )
+00011100: 3a0a 2020 2020 2020 2020 2222 2250 726f  :.        """Pro
+00011110: 7669 6465 7320 726f 6c6c 696e 6720 7472  vides rolling tr
+00011120: 616e 7366 6f72 6d61 7469 6f6e 732e 0a0a  ansformations...
+00011130: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00011140: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00011150: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7769  -----.        wi
+00011160: 6e64 6f77 203a 2069 6e74 2c20 7374 722c  ndow : int, str,
+00011170: 206f 6666 7365 740a 2020 2020 2020 2020   offset.        
+00011180: 2020 2053 697a 6520 6f66 2074 6865 206d     Size of the m
+00011190: 6f76 696e 6720 7769 6e64 6f77 2e20 5468  oving window. Th
+000111a0: 6973 2069 7320 7468 6520 6e75 6d62 6572  is is the number
+000111b0: 206f 6620 6f62 7365 7276 6174 696f 6e73   of observations
+000111c0: 2075 7365 640a 2020 2020 2020 2020 2020   used.          
+000111d0: 2066 6f72 2063 616c 6375 6c61 7469 6e67   for calculating
+000111e0: 2074 6865 2073 7461 7469 7374 6963 2e20   the statistic. 
+000111f0: 5768 656e 206e 6f74 2075 7369 6e67 2061  When not using a
+00011200: 2060 6044 6174 6574 696d 6549 6e64 6578   ``DatetimeIndex
+00011210: 6060 2c0a 2020 2020 2020 2020 2020 2074  ``,.           t
+00011220: 6865 2077 696e 646f 7720 7369 7a65 206d  he window size m
+00011230: 7573 7420 6e6f 7420 6265 2073 6f20 6c61  ust not be so la
+00011240: 7267 6520 6173 2074 6f20 7370 616e 206d  rge as to span m
+00011250: 6f72 6520 7468 616e 206f 6e65 0a20 2020  ore than one.   
+00011260: 2020 2020 2020 2020 6164 6a61 6365 6e74          adjacent
+00011270: 2070 6172 7469 7469 6f6e 2e20 4966 2075   partition. If u
+00011280: 7369 6e67 2061 6e20 6f66 6673 6574 206f  sing an offset o
+00011290: 7220 6f66 6673 6574 2061 6c69 6173 206c  r offset alias l
+000112a0: 696b 6520 2735 4427 2c0a 2020 2020 2020  ike '5D',.      
+000112b0: 2020 2020 2074 6865 2064 6174 6120 6d75       the data mu
+000112c0: 7374 2068 6176 6520 6120 6060 4461 7465  st have a ``Date
+000112d0: 7469 6d65 496e 6465 7860 600a 0a20 2020  timeIndex``..   
+000112e0: 2020 2020 2020 2020 2e2e 2076 6572 7369          .. versi
+000112f0: 6f6e 6368 616e 6765 643a 3a20 302e 3135  onchanged:: 0.15
+00011300: 2e30 0a0a 2020 2020 2020 2020 2020 2020  .0..            
+00011310: 2020 4e6f 7720 6163 6365 7074 7320 6f66    Now accepts of
+00011320: 6673 6574 7320 616e 6420 7374 7269 6e67  fsets and string
+00011330: 206f 6666 7365 7420 616c 6961 7365 730a   offset aliases.
+00011340: 0a20 2020 2020 2020 206d 696e 5f70 6572  .        min_per
+00011350: 696f 6473 203a 2069 6e74 2c20 6465 6661  iods : int, defa
+00011360: 756c 7420 4e6f 6e65 0a20 2020 2020 2020  ult None.       
+00011370: 2020 2020 204d 696e 696d 756d 206e 756d       Minimum num
+00011380: 6265 7220 6f66 206f 6273 6572 7661 7469  ber of observati
+00011390: 6f6e 7320 696e 2077 696e 646f 7720 7265  ons in window re
+000113a0: 7175 6972 6564 2074 6f20 6861 7665 2061  quired to have a
+000113b0: 2076 616c 7565 0a20 2020 2020 2020 2020   value.         
+000113c0: 2020 2028 6f74 6865 7277 6973 6520 7265     (otherwise re
+000113d0: 7375 6c74 2069 7320 4e41 292e 0a20 2020  sult is NA)..   
+000113e0: 2020 2020 2063 656e 7465 7220 3a20 626f       center : bo
+000113f0: 6f6c 6561 6e2c 2064 6566 6175 6c74 2046  olean, default F
+00011400: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00011410: 2053 6574 2074 6865 206c 6162 656c 7320   Set the labels 
+00011420: 6174 2074 6865 2063 656e 7465 7220 6f66  at the center of
+00011430: 2074 6865 2077 696e 646f 772e 0a20 2020   the window..   
+00011440: 2020 2020 2077 696e 5f74 7970 6520 3a20       win_type : 
+00011450: 7374 7269 6e67 2c20 6465 6661 756c 7420  string, default 
+00011460: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+00011470: 2050 726f 7669 6465 2061 2077 696e 646f   Provide a windo
+00011480: 7720 7479 7065 2e20 5468 6520 7265 636f  w type. The reco
+00011490: 676e 697a 6564 2077 696e 646f 7720 7479  gnized window ty
+000114a0: 7065 7320 6172 6520 6964 656e 7469 6361  pes are identica
+000114b0: 6c0a 2020 2020 2020 2020 2020 2020 746f  l.            to
+000114c0: 2070 616e 6461 732e 0a20 2020 2020 2020   pandas..       
+000114d0: 2061 7869 7320 3a20 696e 742c 2073 7472   axis : int, str
+000114e0: 2c20 4e6f 6e65 2c20 6465 6661 756c 7420  , None, default 
+000114f0: 300a 2020 2020 2020 2020 2020 2020 5468  0.            Th
+00011500: 6973 2070 6172 616d 6574 6572 2069 7320  is parameter is 
+00011510: 6465 7072 6563 6174 6564 2077 6974 6820  deprecated with 
+00011520: 6060 7061 6e64 6173 3e3d 322e 3160 602e  ``pandas>=2.1``.
+00011530: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00011540: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00011550: 2d0a 2020 2020 2020 2020 6120 526f 6c6c  -.        a Roll
+00011560: 696e 6720 6f62 6a65 6374 206f 6e20 7768  ing object on wh
+00011570: 6963 6820 746f 2063 616c 6c20 6120 6d65  ich to call a me
+00011580: 7468 6f64 2074 6f20 636f 6d70 7574 6520  thod to compute 
+00011590: 6120 7374 6174 6973 7469 630a 2020 2020  a statistic.    
+000115a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000115b0: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
+000115c0: 616d 652e 726f 6c6c 696e 6720 696d 706f  ame.rolling impo
+000115d0: 7274 2052 6f6c 6c69 6e67 0a0a 2020 2020  rt Rolling..    
+000115e0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000115f0: 6528 7769 6e64 6f77 2c20 496e 7465 6772  e(window, Integr
+00011600: 616c 293a 0a20 2020 2020 2020 2020 2020  al):.           
+00011610: 2069 6620 7769 6e64 6f77 203c 2030 3a0a   if window < 0:.
+00011620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011630: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00011640: 2822 7769 6e64 6f77 206d 7573 7420 6265  ("window must be
+00011650: 203e 3d20 3022 290a 0a20 2020 2020 2020   >= 0")..       
+00011660: 2069 6620 6d69 6e5f 7065 7269 6f64 7320   if min_periods 
+00011670: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00011680: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00011690: 6973 696e 7374 616e 6365 286d 696e 5f70  isinstance(min_p
+000116a0: 6572 696f 6473 2c20 496e 7465 6772 616c  eriods, Integral
+000116b0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000116c0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000116d0: 726f 7228 226d 696e 5f70 6572 696f 6473  ror("min_periods
+000116e0: 206d 7573 7420 6265 2061 6e20 696e 7465   must be an inte
+000116f0: 6765 7222 290a 2020 2020 2020 2020 2020  ger").          
+00011700: 2020 6966 206d 696e 5f70 6572 696f 6473    if min_periods
+00011710: 203c 2030 3a0a 2020 2020 2020 2020 2020   < 0:.          
+00011720: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00011730: 6545 7272 6f72 2822 6d69 6e5f 7065 7269  eError("min_peri
+00011740: 6f64 7320 6d75 7374 2062 6520 3e3d 2030  ods must be >= 0
+00011750: 2229 0a0a 2020 2020 2020 2020 7265 7475  ")..        retu
+00011760: 726e 2052 6f6c 6c69 6e67 280a 2020 2020  rn Rolling(.    
+00011770: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00011780: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
+00011790: 3d77 696e 646f 772c 0a20 2020 2020 2020  =window,.       
+000117a0: 2020 2020 206d 696e 5f70 6572 696f 6473       min_periods
+000117b0: 3d6d 696e 5f70 6572 696f 6473 2c0a 2020  =min_periods,.  
+000117c0: 2020 2020 2020 2020 2020 6365 6e74 6572            center
+000117d0: 3d63 656e 7465 722c 0a20 2020 2020 2020  =center,.       
+000117e0: 2020 2020 2077 696e 5f74 7970 653d 7769       win_type=wi
+000117f0: 6e5f 7479 7065 2c0a 2020 2020 2020 2020  n_type,.        
+00011800: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
+00011810: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+00011820: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00011830: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+00011840: 6620 6469 6666 2873 656c 662c 2070 6572  f diff(self, per
+00011850: 696f 6473 3d31 2c20 6178 6973 3d30 293a  iods=1, axis=0):
+00011860: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00011870: 2020 2020 202e 2e20 6e6f 7465 3a3a 0a0a       .. note::..
+00011880: 2020 2020 2020 2020 2020 2050 616e 6461             Panda
+00011890: 7320 6375 7272 656e 746c 7920 7573 6573  s currently uses
+000118a0: 2061 6e20 6060 6f62 6a65 6374 6060 2d64   an ``object``-d
+000118b0: 7479 7065 2063 6f6c 756d 6e20 746f 2072  type column to r
+000118c0: 6570 7265 7365 6e74 0a20 2020 2020 2020  epresent.       
+000118d0: 2020 2020 626f 6f6c 6561 6e20 6461 7461      boolean data
+000118e0: 2077 6974 6820 6d69 7373 696e 6720 7661   with missing va
+000118f0: 6c75 6573 2e20 5468 6973 2063 616e 2063  lues. This can c
+00011900: 6175 7365 2069 7373 7565 7320 666f 720a  ause issues for.
+00011910: 2020 2020 2020 2020 2020 2062 6f6f 6c65             boole
+00011920: 616e 2d73 7065 6369 6669 6320 6f70 6572  an-specific oper
+00011930: 6174 696f 6e73 2c20 6c69 6b65 2060 607c  ations, like ``|
+00011940: 6060 2e20 546f 2065 6e61 626c 6520 626f  ``. To enable bo
+00011950: 6f6c 6561 6e2d 0a20 2020 2020 2020 2020  olean-.         
+00011960: 2020 7370 6563 6966 6963 206f 7065 7261    specific opera
+00011970: 7469 6f6e 732c 2061 7420 7468 6520 636f  tions, at the co
+00011980: 7374 206f 6620 6d65 7461 6461 7461 2074  st of metadata t
+00011990: 6861 7420 646f 6573 6e27 7420 6d61 7463  hat doesn't matc
+000119a0: 680a 2020 2020 2020 2020 2020 2070 616e  h.           pan
+000119b0: 6461 732c 2075 7365 2060 602e 6173 7479  das, use ``.asty
+000119c0: 7065 2862 6f6f 6c29 6060 2061 6674 6572  pe(bool)`` after
+000119d0: 2074 6865 2060 6073 6869 6674 6060 2e0a   the ``shift``..
+000119e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000119f0: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
+00011a00: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
+00011a10: 7869 7329 0a20 2020 2020 2020 2069 6620  xis).        if 
+00011a20: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
+00011a30: 6572 696f 6473 2c20 496e 7465 6772 616c  eriods, Integral
+00011a40: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00011a50: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
+00011a60: 7065 7269 6f64 7320 6d75 7374 2062 6520  periods must be 
+00011a70: 616e 2069 6e74 6567 6572 2229 0a0a 2020  an integer")..  
+00011a80: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
+00011a90: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00011aa0: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
+00011ab0: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+00011ac0: 2020 2020 2020 2020 2020 2020 4d2e 6469              M.di
+00011ad0: 6666 2c20 746f 6b65 6e3d 2264 6966 6622  ff, token="diff"
+00011ae0: 2c20 7065 7269 6f64 733d 7065 7269 6f64  , periods=period
+00011af0: 732c 2061 7869 733d 312c 2065 6e66 6f72  s, axis=1, enfor
+00011b00: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+00011b10: 650a 2020 2020 2020 2020 2020 2020 290a  e.            ).
+00011b20: 0a20 2020 2020 2020 2062 6566 6f72 652c  .        before,
+00011b30: 2061 6674 6572 203d 2028 7065 7269 6f64   after = (period
+00011b40: 732c 2030 2920 6966 2070 6572 696f 6473  s, 0) if periods
+00011b50: 203e 2030 2065 6c73 6520 2830 2c20 2d70   > 0 else (0, -p
+00011b60: 6572 696f 6473 290a 2020 2020 2020 2020  eriods).        
+00011b70: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
+00011b80: 6f76 6572 6c61 7028 4d2e 6469 6666 2c20  overlap(M.diff, 
+00011b90: 6265 666f 7265 2c20 6166 7465 722c 2074  before, after, t
+00011ba0: 6f6b 656e 3d22 6469 6666 222c 2070 6572  oken="diff", per
+00011bb0: 696f 6473 3d70 6572 696f 6473 290a 0a20  iods=periods).. 
+00011bc0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00011bd0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00011be0: 2020 2064 6566 2073 6869 6674 2873 656c     def shift(sel
+00011bf0: 662c 2070 6572 696f 6473 3d31 2c20 6672  f, periods=1, fr
+00011c00: 6571 3d4e 6f6e 652c 2061 7869 733d 3029  eq=None, axis=0)
+00011c10: 3a0a 2020 2020 2020 2020 6178 6973 203d  :.        axis =
+00011c20: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
+00011c30: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
+00011c40: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00011c50: 616e 6365 2870 6572 696f 6473 2c20 496e  ance(periods, In
+00011c60: 7465 6772 616c 293a 0a20 2020 2020 2020  tegral):.       
+00011c70: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00011c80: 7272 6f72 2822 7065 7269 6f64 7320 6d75  rror("periods mu
+00011c90: 7374 2062 6520 616e 2069 6e74 6567 6572  st be an integer
+00011ca0: 2229 0a0a 2020 2020 2020 2020 6966 2061  ")..        if a
+00011cb0: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
+00011cc0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00011cd0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+00011ce0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00011cf0: 2020 4d2e 7368 6966 742c 0a20 2020 2020    M.shift,.     
+00011d00: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
+00011d10: 3d22 7368 6966 7422 2c0a 2020 2020 2020  ="shift",.      
+00011d20: 2020 2020 2020 2020 2020 7065 7269 6f64            period
+00011d30: 733d 7065 7269 6f64 732c 0a20 2020 2020  s=periods,.     
+00011d40: 2020 2020 2020 2020 2020 2066 7265 713d             freq=
+00011d50: 6672 6571 2c0a 2020 2020 2020 2020 2020  freq,.          
+00011d60: 2020 2020 2020 6178 6973 3d31 2c0a 2020        axis=1,.  
+00011d70: 2020 2020 2020 2020 2020 2020 2020 656e                en
+00011d80: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+00011d90: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00011da0: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
+00011db0: 6672 6571 2069 7320 4e6f 6e65 3a0a 2020  freq is None:.  
+00011dc0: 2020 2020 2020 2020 2020 6265 666f 7265            before
+00011dd0: 2c20 6166 7465 7220 3d20 2870 6572 696f  , after = (perio
+00011de0: 6473 2c20 3029 2069 6620 7065 7269 6f64  ds, 0) if period
+00011df0: 7320 3e20 3020 656c 7365 2028 302c 202d  s > 0 else (0, -
+00011e00: 7065 7269 6f64 7329 0a20 2020 2020 2020  periods).       
+00011e10: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00011e20: 2e6d 6170 5f6f 7665 726c 6170 280a 2020  .map_overlap(.  
+00011e30: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
+00011e40: 7368 6966 742c 2062 6566 6f72 652c 2061  shift, before, a
+00011e50: 6674 6572 2c20 746f 6b65 6e3d 2273 6869  fter, token="shi
+00011e60: 6674 222c 2070 6572 696f 6473 3d70 6572  ft", periods=per
+00011e70: 696f 6473 0a20 2020 2020 2020 2020 2020  iods.           
+00011e80: 2029 0a0a 2020 2020 2020 2020 2320 4c65   )..        # Le
+00011e90: 7420 7061 6e64 6173 2065 7272 6f72 206f  t pandas error o
+00011ea0: 6e20 696e 7661 6c69 6420 6172 6775 6d65  n invalid argume
+00011eb0: 6e74 730a 2020 2020 2020 2020 6d65 7461  nts.        meta
+00011ec0: 203d 2073 656c 662e 5f6d 6574 615f 6e6f   = self._meta_no
+00011ed0: 6e65 6d70 7479 2e73 6869 6674 2870 6572  nempty.shift(per
+00011ee0: 696f 6473 2c20 6672 6571 3d66 7265 7129  iods, freq=freq)
+00011ef0: 0a20 2020 2020 2020 206f 7574 203d 2073  .        out = s
+00011f00: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+00011f10: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+00011f20: 4d2e 7368 6966 742c 0a20 2020 2020 2020  M.shift,.       
+00011f30: 2020 2020 2074 6f6b 656e 3d22 7368 6966       token="shif
+00011f40: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+00011f50: 7065 7269 6f64 733d 7065 7269 6f64 732c  periods=periods,
+00011f60: 0a20 2020 2020 2020 2020 2020 2066 7265  .            fre
+00011f70: 713d 6672 6571 2c0a 2020 2020 2020 2020  q=freq,.        
+00011f80: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
+00011f90: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
+00011fa0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+00011fb0: 652c 0a20 2020 2020 2020 2020 2020 2074  e,.            t
+00011fc0: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
+00011fd0: 6e73 3d46 616c 7365 2c0a 2020 2020 2020  ns=False,.      
+00011fe0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+00011ff0: 726e 206d 6179 6265 5f73 6869 6674 5f64  rn maybe_shift_d
+00012000: 6976 6973 696f 6e73 286f 7574 2c20 7065  ivisions(out, pe
+00012010: 7269 6f64 732c 2066 7265 713d 6672 6571  riods, freq=freq
+00012020: 290a 0a20 2020 2064 6566 205f 7265 6475  )..    def _redu
+00012030: 6374 696f 6e5f 6167 6728 0a20 2020 2020  ction_agg(.     
+00012040: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00012050: 206e 616d 652c 0a20 2020 2020 2020 2061   name,.        a
+00012060: 7869 733d 4e6f 6e65 2c0a 2020 2020 2020  xis=None,.      
+00012070: 2020 736b 6970 6e61 3d54 7275 652c 0a20    skipna=True,. 
+00012080: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+00012090: 7279 3d46 616c 7365 2c0a 2020 2020 2020  ry=False,.      
+000120a0: 2020 6f75 743d 4e6f 6e65 2c0a 2020 2020    out=None,.    
+000120b0: 2020 2020 6e75 6d65 7269 635f 6f6e 6c79      numeric_only
+000120c0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
+000120d0: 6f6e 655f 6973 5f7a 6572 6f3d 5472 7565  one_is_zero=True
+000120e0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+000120f0: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
+00012100: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
+00012110: 2c20 6e6f 6e65 5f69 735f 7a65 726f 3d6e  , none_is_zero=n
+00012120: 6f6e 655f 6973 5f7a 6572 6f29 0a0a 2020  one_is_zero)..  
+00012130: 2020 2020 2020 6966 2068 6173 5f6b 6579        if has_key
+00012140: 776f 7264 2867 6574 6174 7472 2873 656c  word(getattr(sel
+00012150: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
+00012160: 2c20 6e61 6d65 292c 2022 6e75 6d65 7269  , name), "numeri
+00012170: 635f 6f6e 6c79 2229 3a0a 2020 2020 2020  c_only"):.      
+00012180: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+00012190: 6c79 5f6b 7761 7267 7320 3d20 7b22 6e75  ly_kwargs = {"nu
+000121a0: 6d65 7269 635f 6f6e 6c79 223a 206e 756d  meric_only": num
+000121b0: 6572 6963 5f6f 6e6c 797d 0a20 2020 2020  eric_only}.     
+000121c0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000121d0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+000121e0: 795f 6b77 6172 6773 203d 207b 7d0a 0a20  y_kwargs = {}.. 
+000121f0: 2020 2020 2020 2077 6974 6820 6368 6563         with chec
+00012200: 6b5f 6e75 6d65 7269 635f 6f6e 6c79 5f64  k_numeric_only_d
+00012210: 6570 7265 6361 7469 6f6e 286e 616d 652c  eprecation(name,
+00012220: 2054 7275 6529 3a0a 2020 2020 2020 2020   True):.        
+00012230: 2020 2020 6d65 7461 203d 2067 6574 6174      meta = getat
+00012240: 7472 2873 656c 662e 5f6d 6574 615f 6e6f  tr(self._meta_no
+00012250: 6e65 6d70 7479 2c20 6e61 6d65 2928 0a20  nempty, name)(. 
+00012260: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00012270: 7869 733d 6178 6973 2c20 736b 6970 6e61  xis=axis, skipna
+00012280: 3d73 6b69 706e 612c 202a 2a6e 756d 6572  =skipna, **numer
+00012290: 6963 5f6f 6e6c 795f 6b77 6172 6773 0a20  ic_only_kwargs. 
+000122a0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+000122b0: 2020 2020 2020 746f 6b65 6e20 3d20 7365        token = se
+000122c0: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
+000122d0: 202b 206e 616d 650a 2020 2020 2020 2020   + name.        
+000122e0: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
+000122f0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00012300: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
+00012310: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+00012320: 2020 2020 2020 2020 5f67 6574 6174 7472          _getattr
+00012330: 5f6e 756d 6572 6963 5f6f 6e6c 792c 0a20  _numeric_only,. 
+00012340: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00012350: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
+00012360: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
+00012370: 746f 6b65 6e2c 0a20 2020 2020 2020 2020  token,.         
+00012380: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
+00012390: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
+000123a0: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
+000123b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000123c0: 205f 6461 736b 5f6d 6574 686f 645f 6e61   _dask_method_na
+000123d0: 6d65 3d6e 616d 652c 0a20 2020 2020 2020  me=name,.       
+000123e0: 2020 2020 2020 2020 202a 2a6e 756d 6572           **numer
+000123f0: 6963 5f6f 6e6c 795f 6b77 6172 6773 2c0a  ic_only_kwargs,.
+00012400: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00012410: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00012420: 2068 616e 646c 655f 6f75 7428 6f75 742c   handle_out(out,
+00012430: 2072 6573 756c 7429 0a20 2020 2020 2020   result).       
+00012440: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00012450: 2020 2072 6573 756c 7420 3d20 7365 6c66     result = self
+00012460: 2e72 6564 7563 7469 6f6e 280a 2020 2020  .reduction(.    
+00012470: 2020 2020 2020 2020 2020 2020 5f67 6574              _get
+00012480: 6174 7472 5f6e 756d 6572 6963 5f6f 6e6c  attr_numeric_onl
+00012490: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+000124a0: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
+000124b0: 2020 2020 2020 2020 2020 2020 2020 746f                to
+000124c0: 6b65 6e3d 746f 6b65 6e2c 0a20 2020 2020  ken=token,.     
+000124d0: 2020 2020 2020 2020 2020 2073 6b69 706e             skipn
+000124e0: 613d 736b 6970 6e61 2c0a 2020 2020 2020  a=skipna,.      
+000124f0: 2020 2020 2020 2020 2020 6178 6973 3d61            axis=a
+00012500: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
+00012510: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+00012520: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
+00012530: 2020 2020 2020 2020 2020 2020 2020 5f64                _d
+00012540: 6173 6b5f 6d65 7468 6f64 5f6e 616d 653d  ask_method_name=
+00012550: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00012560: 2020 2020 2020 2a2a 6e75 6d65 7269 635f        **numeric_
+00012570: 6f6e 6c79 5f6b 7761 7267 732c 0a20 2020  only_kwargs,.   
+00012580: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00012590: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+000125a0: 616e 6365 2873 656c 662c 2044 6174 6146  ance(self, DataF
+000125b0: 7261 6d65 2920 616e 6420 6973 696e 7374  rame) and isinst
+000125c0: 616e 6365 2872 6573 756c 742c 2053 6572  ance(result, Ser
+000125d0: 6965 7329 3a0a 2020 2020 2020 2020 2020  ies):.          
+000125e0: 2020 2020 2020 7265 7375 6c74 2e64 6976        result.div
+000125f0: 6973 696f 6e73 203d 2028 7365 6c66 2e63  isions = (self.c
+00012600: 6f6c 756d 6e73 2e6d 696e 2829 2c20 7365  olumns.min(), se
+00012610: 6c66 2e63 6f6c 756d 6e73 2e6d 6178 2829  lf.columns.max()
+00012620: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00012630: 7475 726e 2068 616e 646c 655f 6f75 7428  turn handle_out(
+00012640: 6f75 742c 2072 6573 756c 7429 0a0a 2020  out, result)..  
+00012650: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00012660: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+00012670: 2020 6465 6620 6164 645f 7072 6566 6978    def add_prefix
+00012680: 2873 656c 662c 2070 7265 6669 7829 3a0a  (self, prefix):.
+00012690: 2020 2020 2020 2020 7265 7320 3d20 7365          res = se
+000126a0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+000126b0: 7328 4d2e 6164 645f 7072 6566 6978 2c20  s(M.add_prefix, 
+000126c0: 7072 6566 6978 290a 2020 2020 2020 2020  prefix).        
+000126d0: 6966 2073 656c 662e 6b6e 6f77 6e5f 6469  if self.known_di
+000126e0: 7669 7369 6f6e 7320 616e 6420 6973 5f73  visions and is_s
+000126f0: 6572 6965 735f 6c69 6b65 2873 656c 6629  eries_like(self)
+00012700: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00012710: 732e 6469 7669 7369 6f6e 7320 3d20 7475  s.divisions = tu
+00012720: 706c 6528 7072 6566 6978 202b 2073 7472  ple(prefix + str
+00012730: 2864 6976 6973 696f 6e29 2066 6f72 2064  (division) for d
+00012740: 6976 6973 696f 6e20 696e 2073 656c 662e  ivision in self.
+00012750: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
+00012760: 2020 2072 6574 7572 6e20 7265 730a 0a20     return res.. 
+00012770: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00012780: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00012790: 2020 2064 6566 2061 6464 5f73 7566 6669     def add_suffi
+000127a0: 7828 7365 6c66 2c20 7375 6666 6978 293a  x(self, suffix):
+000127b0: 0a20 2020 2020 2020 2072 6573 203d 2073  .        res = s
+000127c0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+000127d0: 6e73 284d 2e61 6464 5f73 7566 6669 782c  ns(M.add_suffix,
+000127e0: 2073 7566 6669 7829 0a20 2020 2020 2020   suffix).       
+000127f0: 2069 6620 7365 6c66 2e6b 6e6f 776e 5f64   if self.known_d
+00012800: 6976 6973 696f 6e73 2061 6e64 2069 735f  ivisions and is_
+00012810: 7365 7269 6573 5f6c 696b 6528 7365 6c66  series_like(self
+00012820: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00012830: 6573 2e64 6976 6973 696f 6e73 203d 2074  es.divisions = t
+00012840: 7570 6c65 2873 7472 2864 6976 6973 696f  uple(str(divisio
+00012850: 6e29 202b 2073 7566 6669 7820 666f 7220  n) + suffix for 
+00012860: 6469 7669 7369 6f6e 2069 6e20 7365 6c66  division in self
+00012870: 2e64 6976 6973 696f 6e73 290a 2020 2020  .divisions).    
+00012880: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
+00012890: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+000128a0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+000128b0: 2020 2020 6465 6620 6162 7328 7365 6c66      def abs(self
+000128c0: 293a 0a20 2020 2020 2020 205f 7261 6973  ):.        _rais
+000128d0: 655f 6966 5f6f 626a 6563 745f 7365 7269  e_if_object_seri
+000128e0: 6573 2873 656c 662c 2022 6162 7322 290a  es(self, "abs").
+000128f0: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
+00012900: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
+00012910: 7479 2e61 6273 2829 0a20 2020 2020 2020  ty.abs().       
+00012920: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+00012930: 5f70 6172 7469 7469 6f6e 7328 4d2e 6162  _partitions(M.ab
+00012940: 732c 206d 6574 613d 6d65 7461 2c20 656e  s, meta=meta, en
+00012950: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+00012960: 616c 7365 290a 0a20 2020 2040 6465 7269  alse)..    @deri
+00012970: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+00012980: 4672 616d 6529 0a20 2020 2064 6566 2061  Frame).    def a
+00012990: 6c6c 2873 656c 662c 2061 7869 733d 4e6f  ll(self, axis=No
+000129a0: 6e65 2c20 736b 6970 6e61 3d54 7275 652c  ne, skipna=True,
+000129b0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+000129c0: 7365 2c20 6f75 743d 4e6f 6e65 293a 0a20  se, out=None):. 
+000129d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000129e0: 6c66 2e5f 7265 6475 6374 696f 6e5f 6167  lf._reduction_ag
+000129f0: 6728 0a20 2020 2020 2020 2020 2020 2022  g(.            "
+00012a00: 616c 6c22 2c20 6178 6973 3d61 7869 732c  all", axis=axis,
+00012a10: 2073 6b69 706e 613d 736b 6970 6e61 2c20   skipna=skipna, 
+00012a20: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+00012a30: 745f 6576 6572 792c 206f 7574 3d6f 7574  t_every, out=out
+00012a40: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00012a50: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00012a60: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00012a70: 6465 6620 616e 7928 7365 6c66 2c20 6178  def any(self, ax
+00012a80: 6973 3d4e 6f6e 652c 2073 6b69 706e 613d  is=None, skipna=
+00012a90: 5472 7565 2c20 7370 6c69 745f 6576 6572  True, split_ever
+00012aa0: 793d 4661 6c73 652c 206f 7574 3d4e 6f6e  y=False, out=Non
+00012ab0: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
+00012ac0: 726e 2073 656c 662e 5f72 6564 7563 7469  rn self._reducti
+00012ad0: 6f6e 5f61 6767 280a 2020 2020 2020 2020  on_agg(.        
+00012ae0: 2020 2020 2261 6e79 222c 2061 7869 733d      "any", axis=
+00012af0: 6178 6973 2c20 736b 6970 6e61 3d73 6b69  axis, skipna=ski
+00012b00: 706e 612c 2073 706c 6974 5f65 7665 7279  pna, split_every
+00012b10: 3d73 706c 6974 5f65 7665 7279 2c20 6f75  =split_every, ou
+00012b20: 743d 6f75 740a 2020 2020 2020 2020 290a  t=out.        ).
+00012b30: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00012b40: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+00012b50: 0a20 2020 2064 6566 2073 756d 280a 2020  .    def sum(.  
+00012b60: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00012b70: 2020 2020 6178 6973 3d4e 6f6e 652c 0a20      axis=None,. 
+00012b80: 2020 2020 2020 2073 6b69 706e 613d 5472         skipna=Tr
+00012b90: 7565 2c0a 2020 2020 2020 2020 7370 6c69  ue,.        spli
+00012ba0: 745f 6576 6572 793d 4661 6c73 652c 0a20  t_every=False,. 
+00012bb0: 2020 2020 2020 2064 7479 7065 3d4e 6f6e         dtype=Non
+00012bc0: 652c 0a20 2020 2020 2020 206f 7574 3d4e  e,.        out=N
+00012bd0: 6f6e 652c 0a20 2020 2020 2020 206d 696e  one,.        min
+00012be0: 5f63 6f75 6e74 3d4e 6f6e 652c 0a20 2020  _count=None,.   
+00012bf0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+00012c00: 793d 4e6f 6e65 2c0a 2020 2020 293a 0a20  y=None,.    ):. 
+00012c10: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00012c20: 7365 6c66 2e5f 7265 6475 6374 696f 6e5f  self._reduction_
+00012c30: 6167 6728 0a20 2020 2020 2020 2020 2020  agg(.           
+00012c40: 2022 7375 6d22 2c0a 2020 2020 2020 2020   "sum",.        
+00012c50: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
+00012c60: 2020 2020 2020 2020 2020 2073 6b69 706e             skipn
+00012c70: 613d 736b 6970 6e61 2c0a 2020 2020 2020  a=skipna,.      
+00012c80: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
+00012c90: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
+00012ca0: 2020 2020 2020 2020 2020 206f 7574 3d6f             out=o
+00012cb0: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
+00012cc0: 6e75 6d65 7269 635f 6f6e 6c79 3d6e 756d  numeric_only=num
+00012cd0: 6572 6963 5f6f 6e6c 792c 0a20 2020 2020  eric_only,.     
+00012ce0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+00012cf0: 6d69 6e5f 636f 756e 743a 0a20 2020 2020  min_count:.     
+00012d00: 2020 2020 2020 2063 6f6e 6420 3d20 7365         cond = se
+00012d10: 6c66 2e6e 6f74 6e75 6c6c 2829 2e73 756d  lf.notnull().sum
+00012d20: 2861 7869 733d 6178 6973 2920 3e3d 206d  (axis=axis) >= m
+00012d30: 696e 5f63 6f75 6e74 0a20 2020 2020 2020  in_count.       
+00012d40: 2020 2020 2069 6620 6973 5f73 6572 6965       if is_serie
+00012d50: 735f 6c69 6b65 2863 6f6e 6429 3a0a 2020  s_like(cond):.  
+00012d60: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00012d70: 7475 726e 2072 6573 756c 742e 7768 6572  turn result.wher
+00012d80: 6528 636f 6e64 2c20 6f74 6865 723d 6e70  e(cond, other=np
+00012d90: 2e4e 614e 290a 2020 2020 2020 2020 2020  .NaN).          
+00012da0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00012db0: 2020 2020 2020 2020 7265 7475 726e 205f          return _
+00012dc0: 7363 616c 6172 5f62 696e 6172 7928 0a20  scalar_binary(. 
 00012dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012de0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00012df0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00012e00: 726e 2072 6573 756c 740a 0a20 2020 2040  rn result..    @
-00012e10: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00012e20: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00012e30: 6566 2070 726f 6428 0a20 2020 2020 2020  ef prod(.       
-00012e40: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
-00012e50: 7869 733d 4e6f 6e65 2c0a 2020 2020 2020  xis=None,.      
-00012e60: 2020 736b 6970 6e61 3d54 7275 652c 0a20    skipna=True,. 
-00012e70: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-00012e80: 7279 3d46 616c 7365 2c0a 2020 2020 2020  ry=False,.      
-00012e90: 2020 6474 7970 653d 4e6f 6e65 2c0a 2020    dtype=None,.  
-00012ea0: 2020 2020 2020 6f75 743d 4e6f 6e65 2c0a        out=None,.
-00012eb0: 2020 2020 2020 2020 6d69 6e5f 636f 756e          min_coun
-00012ec0: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
-00012ed0: 6e75 6d65 7269 635f 6f6e 6c79 3d4e 6f6e  numeric_only=Non
-00012ee0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00012ef0: 2020 7265 7375 6c74 203d 2073 656c 662e    result = self.
-00012f00: 5f72 6564 7563 7469 6f6e 5f61 6767 280a  _reduction_agg(.
-00012f10: 2020 2020 2020 2020 2020 2020 2270 726f              "pro
-00012f20: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
-00012f30: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
-00012f40: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
-00012f50: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
-00012f60: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
-00012f70: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
-00012f80: 2020 2020 2020 206f 7574 3d6f 7574 2c0a         out=out,.
-00012f90: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
-00012fa0: 7269 635f 6f6e 6c79 3d6e 756d 6572 6963  ric_only=numeric
-00012fb0: 5f6f 6e6c 792c 0a20 2020 2020 2020 2029  _only,.        )
-00012fc0: 0a20 2020 2020 2020 2069 6620 6d69 6e5f  .        if min_
-00012fd0: 636f 756e 743a 0a20 2020 2020 2020 2020  count:.         
-00012fe0: 2020 2063 6f6e 6420 3d20 7365 6c66 2e6e     cond = self.n
-00012ff0: 6f74 6e75 6c6c 2829 2e73 756d 2861 7869  otnull().sum(axi
-00013000: 733d 6178 6973 2920 3e3d 206d 696e 5f63  s=axis) >= min_c
-00013010: 6f75 6e74 0a20 2020 2020 2020 2020 2020  ount.           
-00013020: 2069 6620 6973 5f73 6572 6965 735f 6c69   if is_series_li
-00013030: 6b65 2863 6f6e 6429 3a0a 2020 2020 2020  ke(cond):.      
-00013040: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00013050: 2072 6573 756c 742e 7768 6572 6528 636f   result.where(co
-00013060: 6e64 2c20 6f74 6865 723d 6e70 2e4e 614e  nd, other=np.NaN
-00013070: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00013080: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00013090: 2020 2020 7265 7475 726e 205f 7363 616c      return _scal
-000130a0: 6172 5f62 696e 6172 7928 0a20 2020 2020  ar_binary(.     
-000130b0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-000130c0: 616d 6264 6120 782c 2079 3a20 7265 7375  ambda x, y: resu
-000130d0: 6c74 2069 6620 7820 6973 2079 2065 6c73  lt if x is y els
-000130e0: 6520 6e70 2e4e 614e 2c20 636f 6e64 2c20  e np.NaN, cond, 
-000130f0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
-00013100: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-00013110: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00013120: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
-00013130: 2020 2020 7072 6f64 7563 7420 3d20 7072      product = pr
-00013140: 6f64 2020 2320 616c 6961 7365 6420 6464  od  # aliased dd
-00013150: 2e70 726f 6475 6374 0a0a 2020 2020 4064  .product..    @d
-00013160: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00013170: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00013180: 6620 6d61 7828 7365 6c66 2c20 6178 6973  f max(self, axis
-00013190: 3d30 2c20 736b 6970 6e61 3d54 7275 652c  =0, skipna=True,
-000131a0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-000131b0: 7365 2c20 6f75 743d 4e6f 6e65 2c20 6e75  se, out=None, nu
-000131c0: 6d65 7269 635f 6f6e 6c79 3d4e 6f6e 6529  meric_only=None)
-000131d0: 3a0a 2020 2020 2020 2020 6966 2028 0a20  :.        if (. 
-000131e0: 2020 2020 2020 2020 2020 2050 414e 4441             PANDA
-000131f0: 535f 4754 5f31 3430 0a20 2020 2020 2020  S_GT_140.       
-00013200: 2020 2020 2061 6e64 206e 6f74 2050 414e       and not PAN
-00013210: 4441 535f 4754 5f32 3030 0a20 2020 2020  DAS_GT_200.     
-00013220: 2020 2020 2020 2061 6e64 2061 7869 7320         and axis 
-00013230: 6973 204e 6f6e 650a 2020 2020 2020 2020  is None.        
-00013240: 2020 2020 616e 6420 6973 696e 7374 616e      and isinstan
-00013250: 6365 2873 656c 662c 2044 6174 6146 7261  ce(self, DataFra
-00013260: 6d65 290a 2020 2020 2020 2020 293a 0a20  me).        ):. 
-00013270: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
-00013280: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
-00013290: 2020 2020 2020 2020 2020 2249 6e20 6120            "In a 
-000132a0: 6675 7475 7265 2076 6572 7369 6f6e 2c20  future version, 
-000132b0: 4461 7461 4672 616d 652e 6d61 7828 6178  DataFrame.max(ax
-000132c0: 6973 3d4e 6f6e 6529 2077 696c 6c20 7265  is=None) will re
-000132d0: 7475 726e 2061 2073 6361 6c61 7220 6d61  turn a scalar ma
-000132e0: 7820 6f76 6572 2074 6865 2065 6e74 6972  x over the entir
-000132f0: 6520 4461 7461 4672 616d 652e 2022 0a20  e DataFrame. ". 
-00013300: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00013310: 546f 2072 6574 6169 6e20 7468 6520 6f6c  To retain the ol
-00013320: 6420 6265 6861 7669 6f72 2c20 7573 6520  d behavior, use 
-00013330: 2766 7261 6d65 2e6d 6178 2861 7869 733d  'frame.max(axis=
-00013340: 3029 2720 6f72 206a 7573 7420 2766 7261  0)' or just 'fra
-00013350: 6d65 2e6d 6178 2829 2722 2c0a 2020 2020  me.max()'",.    
-00013360: 2020 2020 2020 2020 2020 2020 4675 7475              Futu
-00013370: 7265 5761 726e 696e 672c 0a20 2020 2020  reWarning,.     
-00013380: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00013390: 2020 2020 2061 7869 7320 3d20 300a 0a20       axis = 0.. 
-000133a0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000133b0: 6c66 2e5f 7265 6475 6374 696f 6e5f 6167  lf._reduction_ag
-000133c0: 6728 0a20 2020 2020 2020 2020 2020 2022  g(.            "
-000133d0: 6d61 7822 2c0a 2020 2020 2020 2020 2020  max",.          
-000133e0: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
-000133f0: 2020 2020 2020 2020 2073 6b69 706e 613d           skipna=
-00013400: 736b 6970 6e61 2c0a 2020 2020 2020 2020  skipna,.        
-00013410: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
-00013420: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
-00013430: 2020 2020 2020 2020 206f 7574 3d6f 7574           out=out
-00013440: 2c0a 2020 2020 2020 2020 2020 2020 2320  ,.            # 
-00013450: 5374 6172 7469 6e67 2069 6e20 7061 6e64  Starting in pand
-00013460: 6173 2032 2e30 2c20 6061 7869 733d 4e6f  as 2.0, `axis=No
-00013470: 6e65 6020 646f 6573 2061 2066 756c 6c20  ne` does a full 
-00013480: 6167 6772 6567 6174 696f 6e20 6163 726f  aggregation acro
-00013490: 7373 2062 6f74 6820 6178 6573 0a20 2020  ss both axes.   
-000134a0: 2020 2020 2020 2020 206e 6f6e 655f 6973           none_is
-000134b0: 5f7a 6572 6f3d 6e6f 7420 5041 4e44 4153  _zero=not PANDAS
-000134c0: 5f47 545f 3230 302c 0a20 2020 2020 2020  _GT_200,.       
-000134d0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-000134e0: 793d 6e75 6d65 7269 635f 6f6e 6c79 2c0a  y=numeric_only,.
-000134f0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00013500: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00013510: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00013520: 6566 206d 696e 2873 656c 662c 2061 7869  ef min(self, axi
-00013530: 733d 302c 2073 6b69 706e 613d 5472 7565  s=0, skipna=True
-00013540: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
-00013550: 6c73 652c 206f 7574 3d4e 6f6e 652c 206e  lse, out=None, n
-00013560: 756d 6572 6963 5f6f 6e6c 793d 4e6f 6e65  umeric_only=None
-00013570: 293a 0a20 2020 2020 2020 2069 6620 280a  ):.        if (.
-00013580: 2020 2020 2020 2020 2020 2020 5041 4e44              PAND
-00013590: 4153 5f47 545f 3134 300a 2020 2020 2020  AS_GT_140.      
-000135a0: 2020 2020 2020 616e 6420 6e6f 7420 5041        and not PA
-000135b0: 4e44 4153 5f47 545f 3230 300a 2020 2020  NDAS_GT_200.    
-000135c0: 2020 2020 2020 2020 616e 6420 6178 6973          and axis
-000135d0: 2069 7320 4e6f 6e65 0a20 2020 2020 2020   is None.       
-000135e0: 2020 2020 2061 6e64 2069 7369 6e73 7461       and isinsta
-000135f0: 6e63 6528 7365 6c66 2c20 4461 7461 4672  nce(self, DataFr
-00013600: 616d 6529 0a20 2020 2020 2020 2029 3a0a  ame).        ):.
-00013610: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00013620: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
-00013630: 2020 2020 2020 2020 2020 2022 496e 2061             "In a
-00013640: 2066 7574 7572 6520 7665 7273 696f 6e2c   future version,
-00013650: 2044 6174 6146 7261 6d65 2e6d 696e 2861   DataFrame.min(a
-00013660: 7869 733d 4e6f 6e65 2920 7769 6c6c 2072  xis=None) will r
-00013670: 6574 7572 6e20 6120 7363 616c 6172 206d  eturn a scalar m
-00013680: 696e 206f 7665 7220 7468 6520 656e 7469  in over the enti
-00013690: 7265 2044 6174 6146 7261 6d65 2e20 220a  re DataFrame. ".
-000136a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000136b0: 2254 6f20 7265 7461 696e 2074 6865 206f  "To retain the o
-000136c0: 6c64 2062 6568 6176 696f 722c 2075 7365  ld behavior, use
-000136d0: 2027 6672 616d 652e 6d69 6e28 6178 6973   'frame.min(axis
-000136e0: 3d30 2927 206f 7220 6a75 7374 2027 6672  =0)' or just 'fr
-000136f0: 616d 652e 6d69 6e28 2927 222c 0a20 2020  ame.min()'",.   
-00013700: 2020 2020 2020 2020 2020 2020 2046 7574               Fut
-00013710: 7572 6557 6172 6e69 6e67 2c0a 2020 2020  ureWarning,.    
-00013720: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00013730: 2020 2020 2020 6178 6973 203d 2030 0a0a        axis = 0..
-00013740: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00013750: 656c 662e 5f72 6564 7563 7469 6f6e 5f61  elf._reduction_a
-00013760: 6767 280a 2020 2020 2020 2020 2020 2020  gg(.            
-00013770: 226d 696e 222c 0a20 2020 2020 2020 2020  "min",.         
-00013780: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
-00013790: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
-000137a0: 3d73 6b69 706e 612c 0a20 2020 2020 2020  =skipna,.       
-000137b0: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-000137c0: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
-000137d0: 2020 2020 2020 2020 2020 6f75 743d 6f75            out=ou
-000137e0: 742c 0a20 2020 2020 2020 2020 2020 2023  t,.            #
-000137f0: 2053 7461 7274 696e 6720 696e 2070 616e   Starting in pan
-00013800: 6461 7320 322e 302c 2060 6178 6973 3d4e  das 2.0, `axis=N
-00013810: 6f6e 6560 2064 6f65 7320 6120 6675 6c6c  one` does a full
-00013820: 2061 6767 7265 6761 7469 6f6e 2061 6372   aggregation acr
-00013830: 6f73 7320 626f 7468 2061 7865 730a 2020  oss both axes.  
-00013840: 2020 2020 2020 2020 2020 6e6f 6e65 5f69            none_i
-00013850: 735f 7a65 726f 3d6e 6f74 2050 414e 4441  s_zero=not PANDA
-00013860: 535f 4754 5f32 3030 2c0a 2020 2020 2020  S_GT_200,.      
-00013870: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
-00013880: 6c79 3d6e 756d 6572 6963 5f6f 6e6c 792c  ly=numeric_only,
-00013890: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000138a0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-000138b0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-000138c0: 6465 6620 6964 786d 6178 2873 656c 662c  def idxmax(self,
-000138d0: 2061 7869 733d 4e6f 6e65 2c20 736b 6970   axis=None, skip
-000138e0: 6e61 3d54 7275 652c 2073 706c 6974 5f65  na=True, split_e
-000138f0: 7665 7279 3d46 616c 7365 293a 0a20 2020  very=False):.   
-00013900: 2020 2020 2066 6e20 3d20 2269 6478 6d61       fn = "idxma
-00013910: 7822 0a20 2020 2020 2020 2061 7869 7320  x".        axis 
-00013920: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
-00013930: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
-00013940: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
-00013950: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e69  _meta_nonempty.i
-00013960: 6478 6d61 7828 6178 6973 3d61 7869 732c  dxmax(axis=axis,
-00013970: 2073 6b69 706e 613d 736b 6970 6e61 290a   skipna=skipna).
-00013980: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-00013990: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-000139a0: 2020 7265 7475 726e 206d 6170 5f70 6172    return map_par
-000139b0: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
-000139c0: 2020 2020 2020 2020 204d 2e69 6478 6d61           M.idxma
-000139d0: 782c 0a20 2020 2020 2020 2020 2020 2020  x,.             
-000139e0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-000139f0: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
-00013a00: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-00013a10: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
-00013a20: 746f 6b65 6e5f 7072 6566 6978 202b 2066  token_prefix + f
-00013a30: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-00013a40: 2020 2073 6b69 706e 613d 736b 6970 6e61     skipna=skipna
-00013a50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013a60: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
-00013a70: 2020 2020 2020 2020 2020 2020 2065 6e66               enf
-00013a80: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-00013a90: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00013aa0: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
-00013ab0: 0a20 2020 2020 2020 2020 2020 2073 6361  .            sca
-00013ac0: 6c61 7220 3d20 6e6f 7420 6973 5f73 6572  lar = not is_ser
-00013ad0: 6965 735f 6c69 6b65 286d 6574 6129 0a20  ies_like(meta). 
-00013ae0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00013af0: 7420 3d20 6163 6128 0a20 2020 2020 2020  t = aca(.       
-00013b00: 2020 2020 2020 2020 205b 7365 6c66 5d2c           [self],
-00013b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013b20: 2063 6875 6e6b 3d69 6478 6d61 786d 696e   chunk=idxmaxmin
-00013b30: 5f63 6875 6e6b 2c0a 2020 2020 2020 2020  _chunk,.        
-00013b40: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-00013b50: 653d 6964 786d 6178 6d69 6e5f 6167 672c  e=idxmaxmin_agg,
-00013b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013b70: 2063 6f6d 6269 6e65 3d69 6478 6d61 786d   combine=idxmaxm
-00013b80: 696e 5f63 6f6d 6269 6e65 2c0a 2020 2020  in_combine,.    
-00013b90: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00013ba0: 3d6d 6574 612c 0a20 2020 2020 2020 2020  =meta,.         
-00013bb0: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
-00013bc0: 5f6b 7761 7267 733d 7b22 7363 616c 6172  _kwargs={"scalar
-00013bd0: 223a 2073 6361 6c61 727d 2c0a 2020 2020  ": scalar},.    
-00013be0: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-00013bf0: 6e3d 7365 6c66 2e5f 746f 6b65 6e5f 7072  n=self._token_pr
-00013c00: 6566 6978 202b 2066 6e2c 0a20 2020 2020  efix + fn,.     
-00013c10: 2020 2020 2020 2020 2020 2073 706c 6974             split
-00013c20: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-00013c30: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
-00013c40: 2020 2020 736b 6970 6e61 3d73 6b69 706e      skipna=skipn
-00013c50: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-00013c60: 2020 2066 6e3d 666e 2c0a 2020 2020 2020     fn=fn,.      
-00013c70: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00013c80: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00013c90: 6528 7365 6c66 2c20 4461 7461 4672 616d  e(self, DataFram
-00013ca0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00013cb0: 2020 2020 7265 7375 6c74 2e64 6976 6973      result.divis
-00013cc0: 696f 6e73 203d 2028 6d69 6e28 7365 6c66  ions = (min(self
-00013cd0: 2e63 6f6c 756d 6e73 292c 206d 6178 2873  .columns), max(s
-00013ce0: 656c 662e 636f 6c75 6d6e 7329 290a 2020  elf.columns)).  
-00013cf0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00013d00: 2072 6573 756c 740a 0a20 2020 2040 6465   result..    @de
-00013d10: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-00013d20: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-00013d30: 2069 6478 6d69 6e28 7365 6c66 2c20 6178   idxmin(self, ax
-00013d40: 6973 3d4e 6f6e 652c 2073 6b69 706e 613d  is=None, skipna=
-00013d50: 5472 7565 2c20 7370 6c69 745f 6576 6572  True, split_ever
-00013d60: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
-00013d70: 2020 666e 203d 2022 6964 786d 696e 220a    fn = "idxmin".
-00013d80: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
-00013d90: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
-00013da0: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
-00013db0: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
-00013dc0: 7461 5f6e 6f6e 656d 7074 792e 6964 786d  ta_nonempty.idxm
-00013dd0: 6178 2861 7869 733d 6178 6973 290a 2020  ax(axis=axis).  
-00013de0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
-00013df0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00013e00: 7265 7475 726e 206d 6170 5f70 6172 7469  return map_parti
-00013e10: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
-00013e20: 2020 2020 2020 204d 2e69 6478 6d69 6e2c         M.idxmin,
-00013e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013e40: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-00013e50: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
-00013e60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013e70: 2020 746f 6b65 6e3d 7365 6c66 2e5f 746f    token=self._to
-00013e80: 6b65 6e5f 7072 6566 6978 202b 2066 6e2c  ken_prefix + fn,
-00013e90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013ea0: 2073 6b69 706e 613d 736b 6970 6e61 2c0a   skipna=skipna,.
-00013eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ec0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
-00013ed0: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
-00013ee0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-00013ef0: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
-00013f00: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00013f10: 2020 2020 2020 2020 2020 2073 6361 6c61             scala
-00013f20: 7220 3d20 6e6f 7420 6973 5f73 6572 6965  r = not is_serie
-00013f30: 735f 6c69 6b65 286d 6574 6129 0a20 2020  s_like(meta).   
-00013f40: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-00013f50: 3d20 6163 6128 0a20 2020 2020 2020 2020  = aca(.         
-00013f60: 2020 2020 2020 205b 7365 6c66 5d2c 0a20         [self],. 
-00013f70: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00013f80: 6875 6e6b 3d69 6478 6d61 786d 696e 5f63  hunk=idxmaxmin_c
-00013f90: 6875 6e6b 2c0a 2020 2020 2020 2020 2020  hunk,.          
-00013fa0: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
-00013fb0: 6964 786d 6178 6d69 6e5f 6167 672c 0a20  idxmaxmin_agg,. 
-00013fc0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00013fd0: 6f6d 6269 6e65 3d69 6478 6d61 786d 696e  ombine=idxmaxmin
-00013fe0: 5f63 6f6d 6269 6e65 2c0a 2020 2020 2020  _combine,.      
-00013ff0: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
-00014000: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-00014010: 2020 2020 2061 6767 7265 6761 7465 5f6b       aggregate_k
-00014020: 7761 7267 733d 7b22 7363 616c 6172 223a  wargs={"scalar":
-00014030: 2073 6361 6c61 727d 2c0a 2020 2020 2020   scalar},.      
-00014040: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
-00014050: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
-00014060: 6978 202b 2066 6e2c 0a20 2020 2020 2020  ix + fn,.       
-00014070: 2020 2020 2020 2020 2073 706c 6974 5f65           split_e
-00014080: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-00014090: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000140a0: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
-000140b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000140c0: 2066 6e3d 666e 2c0a 2020 2020 2020 2020   fn=fn,.        
-000140d0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000140e0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000140f0: 7365 6c66 2c20 4461 7461 4672 616d 6529  self, DataFrame)
-00014100: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00014110: 2020 7265 7375 6c74 2e64 6976 6973 696f    result.divisio
-00014120: 6e73 203d 2028 6d69 6e28 7365 6c66 2e63  ns = (min(self.c
-00014130: 6f6c 756d 6e73 292c 206d 6178 2873 656c  olumns), max(sel
-00014140: 662e 636f 6c75 6d6e 7329 290a 2020 2020  f.columns)).    
-00014150: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00014160: 6573 756c 740a 0a20 2020 2040 6465 7269  esult..    @deri
-00014170: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-00014180: 4672 616d 6529 0a20 2020 2064 6566 2063  Frame).    def c
-00014190: 6f75 6e74 2873 656c 662c 2061 7869 733d  ount(self, axis=
-000141a0: 4e6f 6e65 2c20 7370 6c69 745f 6576 6572  None, split_ever
-000141b0: 793d 4661 6c73 652c 206e 756d 6572 6963  y=False, numeric
-000141c0: 5f6f 6e6c 793d 4661 6c73 6529 3a0a 2020  _only=False):.  
-000141d0: 2020 2020 2020 2320 5468 6973 206d 6574        # This met
-000141e0: 686f 6420 6973 2073 6861 7265 6420 6279  hod is shared by
-000141f0: 2044 6174 6146 7261 6d65 202f 2053 6572   DataFrame / Ser
-00014200: 6965 732c 2062 7574 206f 6e6c 7920 4461  ies, but only Da
-00014210: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
-00014220: 2320 7375 7070 6f72 7473 2060 6e75 6d65  # supports `nume
-00014230: 7269 635f 6f6e 6c79 3d60 2e20 4861 6e64  ric_only=`. Hand
-00014240: 6c65 2061 6363 6f72 6469 6e67 6c79 2068  le accordingly h
-00014250: 6572 652e 0a20 2020 2020 2020 206e 756d  ere..        num
-00014260: 6572 6963 5f6f 6e6c 795f 6b77 6172 6773  eric_only_kwargs
-00014270: 203d 207b 7d0a 2020 2020 2020 2020 6966   = {}.        if
-00014280: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
-00014290: 6b65 2873 656c 6629 3a0a 2020 2020 2020  ke(self):.      
-000142a0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
-000142b0: 6c79 5f6b 7761 7267 7320 3d20 6765 745f  ly_kwargs = get_
-000142c0: 6e75 6d65 7269 635f 6f6e 6c79 5f6b 7761  numeric_only_kwa
-000142d0: 7267 7328 6e75 6d65 7269 635f 6f6e 6c79  rgs(numeric_only
-000142e0: 290a 2020 2020 2020 2020 6178 6973 203d  ).        axis =
-000142f0: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-00014300: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
-00014310: 2020 2074 6f6b 656e 203d 2073 656c 662e     token = self.
-00014320: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
-00014330: 2263 6f75 6e74 220a 2020 2020 2020 2020  "count".        
-00014340: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
-00014350: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
-00014360: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
-00014370: 6d70 7479 2e63 6f75 6e74 2861 7869 733d  mpty.count(axis=
-00014380: 6178 6973 2c20 2a2a 6e75 6d65 7269 635f  axis, **numeric_
-00014390: 6f6e 6c79 5f6b 7761 7267 7329 0a20 2020  only_kwargs).   
-000143a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000143b0: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-000143c0: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-000143d0: 2020 2020 204d 2e63 6f75 6e74 2c0a 2020       M.count,.  
-000143e0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-000143f0: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
-00014400: 2020 2020 2020 2020 2074 6f6b 656e 3d74           token=t
-00014410: 6f6b 656e 2c0a 2020 2020 2020 2020 2020  oken,.          
-00014420: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
-00014430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014440: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-00014450: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
-00014460: 2020 2020 2020 2020 202a 2a6e 756d 6572           **numer
-00014470: 6963 5f6f 6e6c 795f 6b77 6172 6773 2c0a  ic_only_kwargs,.
-00014480: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00014490: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000144a0: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
-000144b0: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
-000144c0: 7479 2e63 6f75 6e74 2829 0a0a 2020 2020  ty.count()..    
-000144d0: 2020 2020 2020 2020 2320 4e65 6564 2074          # Need t
-000144e0: 6865 2061 7374 7970 6528 696e 7429 2066  he astype(int) f
-000144f0: 6f72 2065 6d70 7479 2064 6174 6166 7261  or empty datafra
-00014500: 6d65 732c 2077 6869 6368 2073 756d 2074  mes, which sum t
-00014510: 6f20 666c 6f61 7420 6474 7970 650a 2020  o float dtype.  
-00014520: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00014530: 203d 2073 656c 662e 7265 6475 6374 696f   = self.reductio
-00014540: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00014550: 2020 204d 2e63 6f75 6e74 2c0a 2020 2020     M.count,.    
-00014560: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
-00014570: 6567 6174 653d 5f63 6f75 6e74 5f61 6767  egate=_count_agg
-00014580: 7265 6761 7465 2c0a 2020 2020 2020 2020  regate,.        
-00014590: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
-000145a0: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-000145b0: 2020 2074 6f6b 656e 3d74 6f6b 656e 2c0a     token=token,.
-000145c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000145d0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-000145e0: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
-000145f0: 2020 2020 2020 2020 2063 6875 6e6b 5f6b           chunk_k
-00014600: 7761 7267 733d 6e75 6d65 7269 635f 6f6e  wargs=numeric_on
-00014610: 6c79 5f6b 7761 7267 732c 0a20 2020 2020  ly_kwargs,.     
-00014620: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00014630: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00014640: 6365 2873 656c 662c 2044 6174 6146 7261  ce(self, DataFra
-00014650: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-00014660: 2020 2020 2072 6573 756c 742e 6469 7669       result.divi
-00014670: 7369 6f6e 7320 3d20 2873 656c 662e 636f  sions = (self.co
-00014680: 6c75 6d6e 732e 6d69 6e28 292c 2073 656c  lumns.min(), sel
-00014690: 662e 636f 6c75 6d6e 732e 6d61 7828 2929  f.columns.max())
-000146a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000146b0: 7572 6e20 7265 7375 6c74 0a0a 2020 2020  urn result..    
-000146c0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-000146d0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-000146e0: 6465 6620 6d6f 6465 2873 656c 662c 2064  def mode(self, d
-000146f0: 726f 706e 613d 5472 7565 2c20 7370 6c69  ropna=True, spli
-00014700: 745f 6576 6572 793d 4661 6c73 6529 3a0a  t_every=False):.
-00014710: 2020 2020 2020 2020 6d6f 6465 5f73 6572          mode_ser
-00014720: 6965 7320 3d20 7365 6c66 2e72 6564 7563  ies = self.reduc
-00014730: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-00014740: 2020 6368 756e 6b3d 4d2e 7661 6c75 655f    chunk=M.value_
-00014750: 636f 756e 7473 2c0a 2020 2020 2020 2020  counts,.        
-00014760: 2020 2020 636f 6d62 696e 653d 4d2e 7375      combine=M.su
-00014770: 6d2c 0a20 2020 2020 2020 2020 2020 2061  m,.            a
-00014780: 6767 7265 6761 7465 3d5f 6d6f 6465 5f61  ggregate=_mode_a
-00014790: 6767 7265 6761 7465 2c0a 2020 2020 2020  ggregate,.      
-000147a0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-000147b0: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
-000147c0: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
-000147d0: 5f6b 7761 7267 733d 7b22 6472 6f70 6e61  _kwargs={"dropna
-000147e0: 223a 2064 726f 706e 617d 2c0a 2020 2020  ": dropna},.    
-000147f0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-00014800: 655f 6b77 6172 6773 3d7b 2264 726f 706e  e_kwargs={"dropn
-00014810: 6122 3a20 6472 6f70 6e61 7d2c 0a20 2020  a": dropna},.   
-00014820: 2020 2020 2029 0a20 2020 2020 2020 206d       ).        m
-00014830: 6f64 655f 7365 7269 6573 2e6e 616d 6520  ode_series.name 
-00014840: 3d20 7365 6c66 2e6e 616d 650a 2020 2020  = self.name.    
-00014850: 2020 2020 7265 7475 726e 206d 6f64 655f      return mode_
-00014860: 7365 7269 6573 0a0a 2020 2020 405f 6e75  series..    @_nu
-00014870: 6d65 7269 635f 6f6e 6c79 0a20 2020 2040  meric_only.    @
-00014880: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00014890: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-000148a0: 6566 206d 6561 6e28 0a20 2020 2020 2020  ef mean(.       
-000148b0: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
-000148c0: 7869 733d 302c 0a20 2020 2020 2020 2073  xis=0,.        s
-000148d0: 6b69 706e 613d 5472 7565 2c0a 2020 2020  kipna=True,.    
-000148e0: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
-000148f0: 4661 6c73 652c 0a20 2020 2020 2020 2064  False,.        d
-00014900: 7479 7065 3d4e 6f6e 652c 0a20 2020 2020  type=None,.     
-00014910: 2020 206f 7574 3d4e 6f6e 652c 0a20 2020     out=None,.   
-00014920: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-00014930: 793d 4e6f 6e65 2c0a 2020 2020 293a 0a20  y=None,.    ):. 
-00014940: 2020 2020 2020 2069 6620 280a 2020 2020         if (.    
-00014950: 2020 2020 2020 2020 5041 4e44 4153 5f47          PANDAS_G
-00014960: 545f 3134 300a 2020 2020 2020 2020 2020  T_140.          
-00014970: 2020 616e 6420 6e6f 7420 5041 4e44 4153    and not PANDAS
-00014980: 5f47 545f 3230 300a 2020 2020 2020 2020  _GT_200.        
-00014990: 2020 2020 616e 6420 6178 6973 2069 7320      and axis is 
-000149a0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-000149b0: 2061 6e64 2069 7369 6e73 7461 6e63 6528   and isinstance(
-000149c0: 7365 6c66 2c20 4461 7461 4672 616d 6529  self, DataFrame)
-000149d0: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-000149e0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-000149f0: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-00014a00: 2020 2020 2020 2022 496e 2061 2066 7574         "In a fut
-00014a10: 7572 6520 7665 7273 696f 6e2c 2044 6174  ure version, Dat
-00014a20: 6146 7261 6d65 2e6d 6561 6e28 6178 6973  aFrame.mean(axis
-00014a30: 3d4e 6f6e 6529 2077 696c 6c20 7265 7475  =None) will retu
-00014a40: 726e 2061 2073 6361 6c61 7220 6d65 616e  rn a scalar mean
-00014a50: 206f 7665 7220 7468 6520 656e 7469 7265   over the entire
-00014a60: 2044 6174 6146 7261 6d65 2e20 220a 2020   DataFrame. ".  
-00014a70: 2020 2020 2020 2020 2020 2020 2020 2254                "T
-00014a80: 6f20 7265 7461 696e 2074 6865 206f 6c64  o retain the old
-00014a90: 2062 6568 6176 696f 722c 2075 7365 2027   behavior, use '
-00014aa0: 6672 616d 652e 6d65 616e 2861 7869 733d  frame.mean(axis=
-00014ab0: 3029 2720 6f72 206a 7573 7420 2766 7261  0)' or just 'fra
-00014ac0: 6d65 2e6d 6561 6e28 2927 222c 0a20 2020  me.mean()'",.   
-00014ad0: 2020 2020 2020 2020 2020 2020 2046 7574               Fut
-00014ae0: 7572 6557 6172 6e69 6e67 2c0a 2020 2020  ureWarning,.    
-00014af0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00014b00: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
-00014b10: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
-00014b20: 732c 206e 6f6e 655f 6973 5f7a 6572 6f3d  s, none_is_zero=
-00014b30: 6e6f 7420 5041 4e44 4153 5f47 545f 3230  not PANDAS_GT_20
-00014b40: 3029 0a20 2020 2020 2020 205f 7261 6973  0).        _rais
-00014b50: 655f 6966 5f6f 626a 6563 745f 7365 7269  e_if_object_seri
-00014b60: 6573 2873 656c 662c 2022 6d65 616e 2229  es(self, "mean")
-00014b70: 0a20 2020 2020 2020 2023 204e 4f54 453a  .        # NOTE:
-00014b80: 2044 6f20 7765 2077 616e 7420 746f 2077   Do we want to w
-00014b90: 6172 6e20 6865 7265 3f0a 2020 2020 2020  arn here?.      
-00014ba0: 2020 7769 7468 2063 6865 636b 5f6e 756d    with check_num
-00014bb0: 6572 6963 5f6f 6e6c 795f 6465 7072 6563  eric_only_deprec
-00014bc0: 6174 696f 6e28 292c 2063 6865 636b 5f6e  ation(), check_n
-00014bd0: 7569 7361 6e63 655f 636f 6c75 6d6e 735f  uisance_columns_
-00014be0: 7761 726e 696e 6728 293a 0a20 2020 2020  warning():.     
-00014bf0: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
-00014c00: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
-00014c10: 792e 6d65 616e 280a 2020 2020 2020 2020  y.mean(.        
-00014c20: 2020 2020 2020 2020 6178 6973 3d61 7869          axis=axi
-00014c30: 732c 2073 6b69 706e 613d 736b 6970 6e61  s, skipna=skipna
-00014c40: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d6e  , numeric_only=n
-00014c50: 756d 6572 6963 5f6f 6e6c 790a 2020 2020  umeric_only.    
-00014c60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00014c70: 2020 6966 2061 7869 7320 3d3d 2031 3a0a    if axis == 1:.
-00014c80: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00014c90: 6c74 203d 206d 6170 5f70 6172 7469 7469  lt = map_partiti
-00014ca0: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-00014cb0: 2020 2020 204d 2e6d 6561 6e2c 0a20 2020       M.mean,.   
-00014cc0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00014cd0: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
-00014ce0: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
-00014cf0: 2020 2020 2020 2020 2020 2020 2020 746f                to
-00014d00: 6b65 6e3d 7365 6c66 2e5f 746f 6b65 6e5f  ken=self._token_
-00014d10: 7072 6566 6978 202b 2022 6d65 616e 222c  prefix + "mean",
-00014d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014d30: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
-00014d40: 2020 2020 2020 2020 2020 2020 736b 6970              skip
-00014d50: 6e61 3d73 6b69 706e 612c 0a20 2020 2020  na=skipna,.     
-00014d60: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
-00014d70: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-00014d80: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00014d90: 2020 206e 756d 6572 6963 5f6f 6e6c 793d     numeric_only=
-00014da0: 6e75 6d65 7269 635f 6f6e 6c79 2c0a 2020  numeric_only,.  
-00014db0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00014dc0: 2020 2020 2020 2020 7265 7475 726e 2068          return h
-00014dd0: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
-00014de0: 6573 756c 7429 0a20 2020 2020 2020 2065  esult).        e
-00014df0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00014e00: 206e 756d 203d 2073 656c 662e 5f67 6574   num = self._get
-00014e10: 5f6e 756d 6572 6963 5f64 6174 6128 290a  _numeric_data().
-00014e20: 2020 2020 2020 2020 2020 2020 7320 3d20              s = 
-00014e30: 6e75 6d2e 7375 6d28 736b 6970 6e61 3d73  num.sum(skipna=s
-00014e40: 6b69 706e 612c 2073 706c 6974 5f65 7665  kipna, split_eve
-00014e50: 7279 3d73 706c 6974 5f65 7665 7279 290a  ry=split_every).
-00014e60: 2020 2020 2020 2020 2020 2020 6e20 3d20              n = 
-00014e70: 6e75 6d2e 636f 756e 7428 7370 6c69 745f  num.count(split_
-00014e80: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-00014e90: 7929 0a20 2020 2020 2020 2020 2020 2023  y).            #
-00014ea0: 2053 7461 7274 696e 6720 696e 2070 616e   Starting in pan
-00014eb0: 6461 7320 322e 302c 2060 6178 6973 3d4e  das 2.0, `axis=N
-00014ec0: 6f6e 6560 2064 6f65 7320 6120 6675 6c6c  one` does a full
-00014ed0: 2061 6767 7265 6761 7469 6f6e 2061 6372   aggregation acr
-00014ee0: 6f73 7320 626f 7468 2061 7865 730a 2020  oss both axes.  
-00014ef0: 2020 2020 2020 2020 2020 6966 2050 414e            if PAN
-00014f00: 4441 535f 4754 5f32 3030 2061 6e64 2061  DAS_GT_200 and a
-00014f10: 7869 7320 6973 204e 6f6e 6520 616e 6420  xis is None and 
-00014f20: 6973 696e 7374 616e 6365 2873 656c 662c  isinstance(self,
-00014f30: 2044 6174 6146 7261 6d65 293a 0a20 2020   DataFrame):.   
-00014f40: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00014f50: 756c 7420 3d20 732e 7375 6d28 2920 2f20  ult = s.sum() / 
-00014f60: 6e2e 7375 6d28 290a 2020 2020 2020 2020  n.sum().        
-00014f70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00014f80: 2020 2020 2020 2020 2020 6e61 6d65 203d            name =
-00014f90: 2073 656c 662e 5f74 6f6b 656e 5f70 7265   self._token_pre
-00014fa0: 6669 7820 2b20 226d 6561 6e2d 2573 2220  fix + "mean-%s" 
-00014fb0: 2520 746f 6b65 6e69 7a65 2873 656c 662c  % tokenize(self,
-00014fc0: 2061 7869 732c 2073 6b69 706e 6129 0a20   axis, skipna). 
-00014fd0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00014fe0: 6573 756c 7420 3d20 6d61 705f 7061 7274  esult = map_part
-00014ff0: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-00015000: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-00015010: 6f64 732e 6d65 616e 5f61 6767 7265 6761  ods.mean_aggrega
-00015020: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
-00015030: 2020 2020 2020 2020 732c 0a20 2020 2020          s,.     
-00015040: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00015050: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015060: 2020 2020 2020 746f 6b65 6e3d 6e61 6d65        token=name
-00015070: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015080: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
-00015090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000150a0: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
-000150b0: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
-000150c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000150d0: 2070 6172 656e 745f 6d65 7461 3d73 656c   parent_meta=sel
-000150e0: 662e 5f6d 6574 612c 0a20 2020 2020 2020  f._meta,.       
-000150f0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00015100: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-00015110: 696e 7374 616e 6365 2873 656c 662c 2044  instance(self, D
-00015120: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
-00015130: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00015140: 6573 756c 742e 6469 7669 7369 6f6e 7320  esult.divisions 
-00015150: 3d20 2873 656c 662e 636f 6c75 6d6e 732e  = (self.columns.
-00015160: 6d69 6e28 292c 2073 656c 662e 636f 6c75  min(), self.colu
-00015170: 6d6e 732e 6d61 7828 2929 0a20 2020 2020  mns.max()).     
-00015180: 2020 2020 2020 2072 6574 7572 6e20 6861         return ha
-00015190: 6e64 6c65 5f6f 7574 286f 7574 2c20 7265  ndle_out(out, re
-000151a0: 7375 6c74 290a 0a20 2020 2064 6566 206d  sult)..    def m
-000151b0: 6564 6961 6e5f 6170 7072 6f78 696d 6174  edian_approximat
-000151c0: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
-000151d0: 0a20 2020 2020 2020 2061 7869 733d 4e6f  .        axis=No
-000151e0: 6e65 2c0a 2020 2020 2020 2020 6d65 7468  ne,.        meth
-000151f0: 6f64 3d22 6465 6661 756c 7422 2c0a 2020  od="default",.  
-00015200: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-00015210: 5265 7475 726e 2074 6865 2061 7070 726f  Return the appro
-00015220: 7869 6d61 7465 206d 6564 6961 6e20 6f66  ximate median of
-00015230: 2074 6865 2076 616c 7565 7320 6f76 6572   the values over
-00015240: 2074 6865 2072 6571 7565 7374 6564 2061   the requested a
-00015250: 7869 732e 0a0a 2020 2020 2020 2020 5061  xis...        Pa
-00015260: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00015270: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00015280: 2020 2020 6178 6973 203a 207b 302c 2031      axis : {0, 1
-00015290: 2c20 2269 6e64 6578 222c 2022 636f 6c75  , "index", "colu
-000152a0: 6d6e 7322 7d20 2864 6566 6175 6c74 2030  mns"} (default 0
-000152b0: 290a 2020 2020 2020 2020 2020 2020 3020  ).            0 
-000152c0: 6f72 2060 6022 696e 6465 7822 6060 2066  or ``"index"`` f
-000152d0: 6f72 2072 6f77 2d77 6973 652c 2031 206f  or row-wise, 1 o
-000152e0: 7220 6060 2263 6f6c 756d 6e73 2260 6020  r ``"columns"`` 
-000152f0: 666f 7220 636f 6c75 6d6e 2d77 6973 650a  for column-wise.
-00015300: 2020 2020 2020 2020 6d65 7468 6f64 203a          method :
-00015310: 207b 2764 6566 6175 6c74 272c 2027 7464   {'default', 'td
-00015320: 6967 6573 7427 2c20 2764 6173 6b27 7d2c  igest', 'dask'},
-00015330: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00015340: 2020 2020 2020 5768 6174 206d 6574 686f        What metho
-00015350: 6420 746f 2075 7365 2e20 4279 2064 6566  d to use. By def
-00015360: 6175 6c74 2077 696c 6c20 7573 6520 4461  ault will use Da
-00015370: 736b 2773 2069 6e74 6572 6e61 6c20 6375  sk's internal cu
-00015380: 7374 6f6d 0a20 2020 2020 2020 2020 2020  stom.           
-00015390: 2061 6c67 6f72 6974 686d 2028 6060 2264   algorithm (``"d
-000153a0: 6173 6b22 6060 292e 2020 4966 2073 6574  ask"``).  If set
-000153b0: 2074 6f20 6060 2274 6469 6765 7374 2260   to ``"tdigest"`
-000153c0: 6020 7769 6c6c 2075 7365 2074 6469 6765  ` will use tdige
-000153d0: 7374 0a20 2020 2020 2020 2020 2020 2066  st.            f
-000153e0: 6f72 2066 6c6f 6174 7320 616e 6420 696e  or floats and in
-000153f0: 7473 2061 6e64 2066 616c 6c62 6163 6b20  ts and fallback 
-00015400: 746f 2074 6865 2060 6022 6461 736b 2260  to the ``"dask"`
-00015410: 6020 6f74 6865 7277 6973 652e 0a20 2020  ` otherwise..   
-00015420: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00015430: 2072 6574 7572 6e20 7365 6c66 2e71 7561   return self.qua
-00015440: 6e74 696c 6528 713d 302e 352c 2061 7869  ntile(q=0.5, axi
-00015450: 733d 6178 6973 2c20 6d65 7468 6f64 3d6d  s=axis, method=m
-00015460: 6574 686f 6429 2e72 656e 616d 6528 4e6f  ethod).rename(No
-00015470: 6e65 290a 0a20 2020 2040 6465 7269 7665  ne)..    @derive
-00015480: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-00015490: 616d 6529 0a20 2020 2064 6566 206d 6564  ame).    def med
-000154a0: 6961 6e28 7365 6c66 2c20 6178 6973 3d4e  ian(self, axis=N
-000154b0: 6f6e 652c 206d 6574 686f 643d 2264 6566  one, method="def
-000154c0: 6175 6c74 2229 3a0a 2020 2020 2020 2020  ault"):.        
-000154d0: 6966 2061 7869 7320 696e 2028 312c 2022  if axis in (1, "
-000154e0: 636f 6c75 6d6e 7322 2920 6f72 2073 656c  columns") or sel
-000154f0: 662e 6e70 6172 7469 7469 6f6e 7320 3d3d  f.npartitions ==
-00015500: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00015510: 2320 4361 6e20 7072 6f76 6964 6520 616e  # Can provide an
-00015520: 2065 7861 6374 206d 6564 6961 6e20 696e   exact median in
-00015530: 2074 6865 7365 2063 6173 6573 0a20 2020   these cases.   
-00015540: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00015550: 7365 6c66 2e6d 6564 6961 6e5f 6170 7072  self.median_appr
-00015560: 6f78 696d 6174 6528 6178 6973 3d61 7869  oximate(axis=axi
-00015570: 732c 206d 6574 686f 643d 6d65 7468 6f64  s, method=method
-00015580: 290a 2020 2020 2020 2020 7261 6973 6520  ).        raise 
-00015590: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-000155a0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-000155b0: 2022 4461 736b 2064 6f65 736e 2774 2069   "Dask doesn't i
-000155c0: 6d70 6c65 6d65 6e74 2061 6e20 6578 6163  mplement an exac
-000155d0: 7420 6d65 6469 616e 2069 6e20 616c 6c20  t median in all 
-000155e0: 6361 7365 7320 6173 2074 6869 7320 6973  cases as this is
-000155f0: 2068 6172 6420 746f 2064 6f20 696e 2070   hard to do in p
-00015600: 6172 616c 6c65 6c2e 2022 0a20 2020 2020  arallel. ".     
-00015610: 2020 2020 2020 2022 5365 6520 7468 6520         "See the 
-00015620: 606d 6564 6961 6e5f 6170 7072 6f78 696d  `median_approxim
-00015630: 6174 6560 206d 6574 686f 6420 696e 7374  ate` method inst
-00015640: 6561 642c 2077 6869 6368 2075 7365 7320  ead, which uses 
-00015650: 616e 2061 7070 726f 7869 6d61 7465 2061  an approximate a
-00015660: 6c67 6f72 6974 686d 2e22 0a20 2020 2020  lgorithm.".     
-00015670: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
-00015680: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-00015690: 7261 6d65 290a 2020 2020 6465 6620 7661  rame).    def va
-000156a0: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
-000156b0: 0a20 2020 2020 2020 2061 7869 733d 4e6f  .        axis=No
-000156c0: 6e65 2c0a 2020 2020 2020 2020 736b 6970  ne,.        skip
-000156d0: 6e61 3d54 7275 652c 0a20 2020 2020 2020  na=True,.       
-000156e0: 2064 646f 663d 312c 0a20 2020 2020 2020   ddof=1,.       
-000156f0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-00015700: 7365 2c0a 2020 2020 2020 2020 6474 7970  se,.        dtyp
-00015710: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-00015720: 6f75 743d 4e6f 6e65 2c0a 2020 2020 2020  out=None,.      
-00015730: 2020 6e75 6d65 7269 635f 6f6e 6c79 3d6e    numeric_only=n
-00015740: 6f5f 6465 6661 756c 742c 0a20 2020 2029  o_default,.    )
-00015750: 3a0a 2020 2020 2020 2020 6178 6973 203d  :.        axis =
-00015760: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-00015770: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
-00015780: 2020 205f 7261 6973 655f 6966 5f6f 626a     _raise_if_obj
-00015790: 6563 745f 7365 7269 6573 2873 656c 662c  ect_series(self,
-000157a0: 2022 7661 7222 290a 2020 2020 2020 2020   "var").        
-000157b0: 6e75 6d65 7269 635f 6f6e 6c79 5f6b 7761  numeric_only_kwa
-000157c0: 7267 7320 3d20 6765 745f 6e75 6d65 7269  rgs = get_numeri
-000157d0: 635f 6f6e 6c79 5f6b 7761 7267 7328 6e75  c_only_kwargs(nu
-000157e0: 6d65 7269 635f 6f6e 6c79 290a 2020 2020  meric_only).    
-000157f0: 2020 2020 7769 7468 2063 6865 636b 5f6e      with check_n
-00015800: 756d 6572 6963 5f6f 6e6c 795f 6465 7072  umeric_only_depr
-00015810: 6563 6174 696f 6e28 0a20 2020 2020 2020  ecation(.       
-00015820: 2020 2020 2022 7661 7222 2c20 5472 7565       "var", True
-00015830: 0a20 2020 2020 2020 2029 2c20 6368 6563  .        ), chec
-00015840: 6b5f 7265 6475 6374 696f 6e73 5f72 756e  k_reductions_run
-00015850: 7469 6d65 5f77 6172 6e69 6e67 2829 3a0a  time_warning():.
-00015860: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00015870: 203d 2073 656c 662e 5f6d 6574 615f 6e6f   = self._meta_no
-00015880: 6e65 6d70 7479 2e76 6172 280a 2020 2020  nempty.var(.    
-00015890: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-000158a0: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
-000158b0: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
-000158c0: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
-000158d0: 2020 2020 2020 2a2a 6e75 6d65 7269 635f        **numeric_
-000158e0: 6f6e 6c79 5f6b 7761 7267 732c 0a20 2020  only_kwargs,.   
-000158f0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00015900: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
-00015910: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00015920: 756c 7420 3d20 6d61 705f 7061 7274 6974  ult = map_partit
-00015930: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
-00015940: 2020 2020 2020 4d2e 7661 722c 0a20 2020        M.var,.   
-00015950: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00015960: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
-00015970: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
-00015980: 2020 2020 2020 2020 2020 2020 2020 746f                to
-00015990: 6b65 6e3d 7365 6c66 2e5f 746f 6b65 6e5f  ken=self._token_
-000159a0: 7072 6566 6978 202b 2022 7661 7222 2c0a  prefix + "var",.
-000159b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000159c0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
-000159d0: 2020 2020 2020 2020 2020 2073 6b69 706e             skipn
-000159e0: 613d 736b 6970 6e61 2c0a 2020 2020 2020  a=skipna,.      
-000159f0: 2020 2020 2020 2020 2020 6464 6f66 3d64            ddof=d
-00015a00: 646f 662c 0a20 2020 2020 2020 2020 2020  dof,.           
-00015a10: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
-00015a20: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
-00015a30: 2020 2020 2020 2020 2020 2020 202a 2a6e               **n
-00015a40: 756d 6572 6963 5f6f 6e6c 795f 6b77 6172  umeric_only_kwar
-00015a50: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-00015a60: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00015a70: 7475 726e 2068 616e 646c 655f 6f75 7428  turn handle_out(
-00015a80: 6f75 742c 2072 6573 756c 7429 0a20 2020  out, result).   
-00015a90: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00015aa0: 2020 2020 2020 2069 6620 7365 6c66 2e6e         if self.n
-00015ab0: 6469 6d20 3d3d 2031 3a0a 2020 2020 2020  dim == 1:.      
-00015ac0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00015ad0: 203d 2073 656c 662e 5f76 6172 5f31 6428   = self._var_1d(
-00015ae0: 7365 6c66 2c20 736b 6970 6e61 2c20 6464  self, skipna, dd
-00015af0: 6f66 2c20 7370 6c69 745f 6576 6572 7929  of, split_every)
-00015b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015b10: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
-00015b20: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
-00015b30: 0a20 2020 2020 2020 2020 2020 2023 2070  .            # p
-00015b40: 616e 6461 7320 312e 302b 2064 6f65 7320  andas 1.0+ does 
-00015b50: 6e6f 7420 696d 706c 656d 656e 7420 7661  not implement va
-00015b60: 7220 6f6e 2074 696d 6564 656c 7461 0a20  r on timedelta. 
-00015b70: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00015b80: 7420 3d20 7365 6c66 2e5f 7661 725f 6e75  t = self._var_nu
-00015b90: 6d65 7269 6328 736b 6970 6e61 2c20 6464  meric(skipna, dd
-00015ba0: 6f66 2c20 7370 6c69 745f 6576 6572 7929  of, split_every)
-00015bb0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00015bc0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
-00015bd0: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
-00015be0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00015bf0: 7375 6c74 2e64 6976 6973 696f 6e73 203d  sult.divisions =
-00015c00: 2028 7365 6c66 2e63 6f6c 756d 6e73 2e6d   (self.columns.m
-00015c10: 696e 2829 2c20 7365 6c66 2e63 6f6c 756d  in(), self.colum
-00015c20: 6e73 2e6d 6178 2829 290a 2020 2020 2020  ns.max()).      
-00015c30: 2020 2020 2020 7265 7475 726e 2068 616e        return han
-00015c40: 646c 655f 6f75 7428 6f75 742c 2072 6573  dle_out(out, res
-00015c50: 756c 7429 0a0a 2020 2020 6465 6620 5f76  ult)..    def _v
-00015c60: 6172 5f6e 756d 6572 6963 2873 656c 662c  ar_numeric(self,
-00015c70: 2073 6b69 706e 613d 5472 7565 2c20 6464   skipna=True, dd
-00015c80: 6f66 3d31 2c20 7370 6c69 745f 6576 6572  of=1, split_ever
-00015c90: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
-00015ca0: 2020 6e75 6d20 3d20 7365 6c66 2e73 656c    num = self.sel
-00015cb0: 6563 745f 6474 7970 6573 2869 6e63 6c75  ect_dtypes(inclu
-00015cc0: 6465 3d5b 226e 756d 6265 7222 2c20 2262  de=["number", "b
-00015cd0: 6f6f 6c22 5d2c 2065 7863 6c75 6465 3d5b  ool"], exclude=[
-00015ce0: 6e70 2e74 696d 6564 656c 7461 3634 5d29  np.timedelta64])
-00015cf0: 0a0a 2020 2020 2020 2020 7661 6c75 6573  ..        values
-00015d00: 5f64 7479 7065 203d 206e 756d 2e76 616c  _dtype = num.val
-00015d10: 7565 732e 6474 7970 650a 2020 2020 2020  ues.dtype.      
-00015d20: 2020 6172 7261 795f 7661 6c75 6573 203d    array_values =
-00015d30: 206e 756d 2e76 616c 7565 730a 0a20 2020   num.values..   
-00015d40: 2020 2020 2069 6620 6e6f 7420 6e70 2e69       if not np.i
-00015d50: 7373 7562 6474 7970 6528 7661 6c75 6573  ssubdtype(values
-00015d60: 5f64 7479 7065 2c20 6e70 2e6e 756d 6265  _dtype, np.numbe
-00015d70: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-00015d80: 6172 7261 795f 7661 6c75 6573 203d 206e  array_values = n
-00015d90: 756d 2e76 616c 7565 732e 6173 7479 7065  um.values.astype
-00015da0: 2822 6638 2229 0a0a 2020 2020 2020 2020  ("f8")..        
-00015db0: 7661 7220 3d20 6461 2e6e 616e 7661 7220  var = da.nanvar 
-00015dc0: 6966 2073 6b69 706e 6120 6f72 2073 6b69  if skipna or ski
-00015dd0: 706e 6120 6973 204e 6f6e 6520 656c 7365  pna is None else
-00015de0: 2064 612e 7661 720a 2020 2020 2020 2020   da.var.        
-00015df0: 6172 7261 795f 7661 7220 3d20 7661 7228  array_var = var(
-00015e00: 6172 7261 795f 7661 6c75 6573 2c20 6178  array_values, ax
-00015e10: 6973 3d30 2c20 6464 6f66 3d64 646f 662c  is=0, ddof=ddof,
-00015e20: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-00015e30: 6974 5f65 7665 7279 290a 0a20 2020 2020  it_every)..     
-00015e40: 2020 206e 616d 6520 3d20 7365 6c66 2e5f     name = self._
-00015e50: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
-00015e60: 7661 722d 6e75 6d65 7269 6322 202b 2074  var-numeric" + t
-00015e70: 6f6b 656e 697a 6528 6e75 6d2c 2073 706c  okenize(num, spl
-00015e80: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
-00015e90: 2020 636f 6c73 203d 206e 756d 2e5f 6d65    cols = num._me
-00015ea0: 7461 2e63 6f6c 756d 6e73 2069 6620 6973  ta.columns if is
-00015eb0: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
-00015ec0: 6e75 6d29 2065 6c73 6520 4e6f 6e65 0a0a  num) else None..
-00015ed0: 2020 2020 2020 2020 7769 7468 2063 6865          with che
-00015ee0: 636b 5f72 6564 7563 7469 6f6e 735f 7275  ck_reductions_ru
-00015ef0: 6e74 696d 655f 7761 726e 696e 6728 293a  ntime_warning():
-00015f00: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00015f10: 615f 636f 6d70 7574 6174 696f 6e20 3d20  a_computation = 
-00015f20: 6e75 6d2e 5f6d 6574 615f 6e6f 6e65 6d70  num._meta_nonemp
-00015f30: 7479 2e76 6172 2861 7869 733d 3029 0a20  ty.var(axis=0). 
-00015f40: 2020 2020 2020 2076 6172 5f73 6861 7065         var_shape
-00015f50: 203d 206d 6574 615f 636f 6d70 7574 6174   = meta_computat
-00015f60: 696f 6e2e 7368 6170 650a 2020 2020 2020  ion.shape.      
-00015f70: 2020 6172 7261 795f 7661 725f 6e61 6d65    array_var_name
-00015f80: 203d 2028 6172 7261 795f 7661 722e 5f6e   = (array_var._n
-00015f90: 616d 652c 2920 2b20 2830 2c29 202a 206c  ame,) + (0,) * l
-00015fa0: 656e 2876 6172 5f73 6861 7065 290a 0a20  en(var_shape).. 
-00015fb0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
-00015fc0: 286e 616d 652c 2030 293a 2028 6d65 7468  (name, 0): (meth
-00015fd0: 6f64 732e 7772 6170 5f76 6172 5f72 6564  ods.wrap_var_red
-00015fe0: 7563 7469 6f6e 2c20 6172 7261 795f 7661  uction, array_va
-00015ff0: 725f 6e61 6d65 2c20 636f 6c73 297d 0a20  r_name, cols)}. 
-00016000: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
-00016010: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-00016020: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
-00016030: 616d 652c 206c 6179 6572 2c20 6465 7065  ame, layer, depe
-00016040: 6e64 656e 6369 6573 3d5b 6172 7261 795f  ndencies=[array_
-00016050: 7661 725d 290a 0a20 2020 2020 2020 2072  var])..        r
-00016060: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
-00016070: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
-00016080: 206d 6574 615f 636f 6d70 7574 6174 696f   meta_computatio
-00016090: 6e2c 2064 6976 6973 696f 6e73 3d5b 4e6f  n, divisions=[No
-000160a0: 6e65 2c20 4e6f 6e65 5d29 0a0a 2020 2020  ne, None])..    
-000160b0: 6465 6620 5f76 6172 5f31 6428 7365 6c66  def _var_1d(self
-000160c0: 2c20 636f 6c75 6d6e 2c20 736b 6970 6e61  , column, skipna
-000160d0: 3d54 7275 652c 2064 646f 663d 312c 2073  =True, ddof=1, s
-000160e0: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-000160f0: 293a 0a20 2020 2020 2020 2069 735f 7469  ):.        is_ti
-00016100: 6d65 6465 6c74 6120 3d20 6973 5f74 696d  medelta = is_tim
-00016110: 6564 656c 7461 3634 5f64 7479 7065 2863  edelta64_dtype(c
-00016120: 6f6c 756d 6e2e 5f6d 6574 6129 0a0a 2020  olumn._meta)..  
-00016130: 2020 2020 2020 6966 2069 735f 7469 6d65        if is_time
-00016140: 6465 6c74 613a 0a20 2020 2020 2020 2020  delta:.         
-00016150: 2020 2069 6620 6e6f 7420 736b 6970 6e61     if not skipna
-00016160: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00016170: 2020 6973 5f6e 616e 203d 2063 6f6c 756d    is_nan = colum
-00016180: 6e2e 6973 6e61 2829 0a20 2020 2020 2020  n.isna().       
-00016190: 2020 2020 2020 2020 2063 6f6c 756d 6e20           column 
-000161a0: 3d20 636f 6c75 6d6e 2e61 7374 7970 6528  = column.astype(
-000161b0: 2269 3822 290a 2020 2020 2020 2020 2020  "i8").          
-000161c0: 2020 2020 2020 636f 6c75 6d6e 203d 2063        column = c
-000161d0: 6f6c 756d 6e2e 6d61 736b 2869 735f 6e61  olumn.mask(is_na
-000161e0: 6e29 0a20 2020 2020 2020 2020 2020 2065  n).            e
-000161f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00016200: 2020 2020 2063 6f6c 756d 6e20 3d20 636f       column = co
-00016210: 6c75 6d6e 2e64 726f 706e 6128 292e 6173  lumn.dropna().as
-00016220: 7479 7065 2822 6938 2229 0a0a 2020 2020  type("i8")..    
-00016230: 2020 2020 6966 2070 642e 496e 7436 3444      if pd.Int64D
-00016240: 7479 7065 2e69 735f 6474 7970 6528 636f  type.is_dtype(co
-00016250: 6c75 6d6e 2e5f 6d65 7461 5f6e 6f6e 656d  lumn._meta_nonem
-00016260: 7074 7929 3a0a 2020 2020 2020 2020 2020  pty):.          
-00016270: 2020 636f 6c75 6d6e 203d 2063 6f6c 756d    column = colum
-00016280: 6e2e 6173 7479 7065 2822 6638 2229 0a0a  n.astype("f8")..
-00016290: 2020 2020 2020 2020 6966 206e 6f74 206e          if not n
-000162a0: 702e 6973 7375 6264 7479 7065 2863 6f6c  p.issubdtype(col
-000162b0: 756d 6e2e 6474 7970 652c 206e 702e 6e75  umn.dtype, np.nu
-000162c0: 6d62 6572 293a 0a20 2020 2020 2020 2020  mber):.         
-000162d0: 2020 2063 6f6c 756d 6e20 3d20 636f 6c75     column = colu
-000162e0: 6d6e 2e61 7374 7970 6528 2266 3822 290a  mn.astype("f8").
-000162f0: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
-00016300: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
-00016310: 6978 202b 2022 7661 722d 3164 2d22 202b  ix + "var-1d-" +
-00016320: 2074 6f6b 656e 697a 6528 636f 6c75 6d6e   tokenize(column
-00016330: 2c20 7370 6c69 745f 6576 6572 7929 0a0a  , split_every)..
-00016340: 2020 2020 2020 2020 7661 7220 3d20 6461          var = da
-00016350: 2e6e 616e 7661 7220 6966 2073 6b69 706e  .nanvar if skipn
-00016360: 6120 6f72 2073 6b69 706e 6120 6973 204e  a or skipna is N
-00016370: 6f6e 6520 656c 7365 2064 612e 7661 720a  one else da.var.
-00016380: 2020 2020 2020 2020 6172 7261 795f 7661          array_va
-00016390: 7220 3d20 7661 7228 636f 6c75 6d6e 2e76  r = var(column.v
-000163a0: 616c 7565 732c 2061 7869 733d 302c 2064  alues, axis=0, d
-000163b0: 646f 663d 6464 6f66 2c20 7370 6c69 745f  dof=ddof, split_
-000163c0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-000163d0: 7929 0a0a 2020 2020 2020 2020 6c61 7965  y)..        laye
-000163e0: 7220 3d20 7b28 6e61 6d65 2c20 3029 3a20  r = {(name, 0): 
-000163f0: 286d 6574 686f 6473 2e77 7261 705f 7661  (methods.wrap_va
-00016400: 725f 7265 6475 6374 696f 6e2c 2028 6172  r_reduction, (ar
-00016410: 7261 795f 7661 722e 5f6e 616d 652c 292c  ray_var._name,),
-00016420: 204e 6f6e 6529 7d0a 2020 2020 2020 2020   None)}.        
-00016430: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
-00016440: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
-00016450: 6563 7469 6f6e 7328 6e61 6d65 2c20 6c61  ections(name, la
-00016460: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
-00016470: 733d 5b61 7272 6179 5f76 6172 5d29 0a0a  s=[array_var])..
-00016480: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-00016490: 6577 5f64 645f 6f62 6a65 6374 280a 2020  ew_dd_object(.  
-000164a0: 2020 2020 2020 2020 2020 6772 6170 682c            graph,
-000164b0: 206e 616d 652c 2063 6f6c 756d 6e2e 5f6d   name, column._m
-000164c0: 6574 615f 6e6f 6e65 6d70 7479 2e76 6172  eta_nonempty.var
-000164d0: 2829 2c20 6469 7669 7369 6f6e 733d 5b4e  (), divisions=[N
-000164e0: 6f6e 652c 204e 6f6e 655d 0a20 2020 2020  one, None].     
-000164f0: 2020 2029 0a0a 2020 2020 405f 6e75 6d65     )..    @_nume
-00016500: 7269 635f 6461 7461 0a20 2020 2040 6465  ric_data.    @de
-00016510: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-00016520: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-00016530: 2073 7464 280a 2020 2020 2020 2020 7365   std(.        se
-00016540: 6c66 2c0a 2020 2020 2020 2020 6178 6973  lf,.        axis
-00016550: 3d4e 6f6e 652c 0a20 2020 2020 2020 2073  =None,.        s
-00016560: 6b69 706e 613d 5472 7565 2c0a 2020 2020  kipna=True,.    
-00016570: 2020 2020 6464 6f66 3d31 2c0a 2020 2020      ddof=1,.    
-00016580: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
-00016590: 4661 6c73 652c 0a20 2020 2020 2020 2064  False,.        d
-000165a0: 7479 7065 3d4e 6f6e 652c 0a20 2020 2020  type=None,.     
-000165b0: 2020 206f 7574 3d4e 6f6e 652c 0a20 2020     out=None,.   
-000165c0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-000165d0: 793d 6e6f 5f64 6566 6175 6c74 2c0a 2020  y=no_default,.  
-000165e0: 2020 293a 0a20 2020 2020 2020 2061 7869    ):.        axi
-000165f0: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
-00016600: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
-00016610: 2020 2020 2020 5f72 6169 7365 5f69 665f        _raise_if_
-00016620: 6f62 6a65 6374 5f73 6572 6965 7328 7365  object_series(se
-00016630: 6c66 2c20 2273 7464 2229 0a20 2020 2020  lf, "std").     
-00016640: 2020 205f 7261 6973 655f 6966 5f6e 6f74     _raise_if_not
-00016650: 5f73 6572 6965 735f 6f72 5f64 6174 6166  _series_or_dataf
-00016660: 7261 6d65 2873 656c 662c 2022 7374 6422  rame(self, "std"
-00016670: 290a 2020 2020 2020 2020 6e75 6d65 7269  ).        numeri
-00016680: 635f 6b77 6172 6773 203d 205f 6e75 6d65  c_kwargs = _nume
-00016690: 7269 635f 6f6e 6c79 5f6d 6179 6265 5f77  ric_only_maybe_w
-000166a0: 6172 6e28 7365 6c66 2c20 6e75 6d65 7269  arn(self, numeri
-000166b0: 635f 6f6e 6c79 290a 0a20 2020 2020 2020  c_only)..       
-000166c0: 2077 6974 6820 6368 6563 6b5f 6e75 6d65   with check_nume
-000166d0: 7269 635f 6f6e 6c79 5f64 6570 7265 6361  ric_only_depreca
-000166e0: 7469 6f6e 2829 2c20 6368 6563 6b5f 6e75  tion(), check_nu
-000166f0: 6973 616e 6365 5f63 6f6c 756d 6e73 5f77  isance_columns_w
-00016700: 6172 6e69 6e67 2829 2c20 6368 6563 6b5f  arning(), check_
-00016710: 7265 6475 6374 696f 6e73 5f72 756e 7469  reductions_runti
-00016720: 6d65 5f77 6172 6e69 6e67 2829 3a0a 2020  me_warning():.  
-00016730: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
-00016740: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
-00016750: 6d70 7479 2e73 7464 2861 7869 733d 6178  mpty.std(axis=ax
-00016760: 6973 2c20 736b 6970 6e61 3d73 6b69 706e  is, skipna=skipn
-00016770: 612c 202a 2a6e 756d 6572 6963 5f6b 7761  a, **numeric_kwa
-00016780: 7267 7329 0a20 2020 2020 2020 2069 735f  rgs).        is_
-00016790: 6466 5f6c 696b 6520 3d20 6973 5f64 6174  df_like = is_dat
-000167a0: 6166 7261 6d65 5f6c 696b 6528 7365 6c66  aframe_like(self
-000167b0: 2e5f 6d65 7461 290a 2020 2020 2020 2020  ._meta).        
-000167c0: 6e65 6564 735f 7469 6d65 5f63 6f6e 7665  needs_time_conve
-000167d0: 7273 696f 6e20 3d20 4661 6c73 650a 2020  rsion = False.  
-000167e0: 2020 2020 2020 6e75 6d65 7269 635f 6464        numeric_dd
-000167f0: 203d 2073 656c 660a 0a20 2020 2020 2020   = self..       
-00016800: 2069 6620 6973 5f64 665f 6c69 6b65 3a0a   if is_df_like:.
-00016810: 2020 2020 2020 2020 2020 2020 7469 6d65              time
-00016820: 5f63 6f6c 7320 3d20 7365 6c66 2e5f 6d65  _cols = self._me
-00016830: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
-00016840: 2869 6e63 6c75 6465 3d22 6461 7465 7469  (include="dateti
-00016850: 6d65 2229 2e63 6f6c 756d 6e73 0a20 2020  me").columns.   
-00016860: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-00016870: 7469 6d65 5f63 6f6c 7329 203e 2030 3a0a  time_cols) > 0:.
-00016880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016890: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000168a0: 2020 2020 2020 6e75 6d65 7269 635f 6464        numeric_dd
-000168b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000168c0: 2020 2020 2020 6e65 6564 735f 7469 6d65        needs_time
-000168d0: 5f63 6f6e 7665 7273 696f 6e2c 0a20 2020  _conversion,.   
-000168e0: 2020 2020 2020 2020 2020 2020 2029 203d               ) =
-000168f0: 2073 656c 662e 5f63 6f6e 7665 7274 5f74   self._convert_t
-00016900: 696d 655f 636f 6c73 5f74 6f5f 6e75 6d65  ime_cols_to_nume
-00016910: 7269 6328 7469 6d65 5f63 6f6c 732c 2061  ric(time_cols, a
-00016920: 7869 732c 206d 6574 612c 2073 6b69 706e  xis, meta, skipn
-00016930: 6129 0a20 2020 2020 2020 2065 6c73 653a  a).        else:
-00016940: 0a20 2020 2020 2020 2020 2020 206e 6565  .            nee
-00016950: 6473 5f74 696d 655f 636f 6e76 6572 7369  ds_time_conversi
-00016960: 6f6e 203d 2069 735f 6461 7465 7469 6d65  on = is_datetime
-00016970: 3634 5f61 6e79 5f64 7479 7065 2873 656c  64_any_dtype(sel
-00016980: 662e 5f6d 6574 6129 0a20 2020 2020 2020  f._meta).       
-00016990: 2020 2020 2069 6620 6e65 6564 735f 7469       if needs_ti
-000169a0: 6d65 5f63 6f6e 7665 7273 696f 6e3a 0a20  me_conversion:. 
-000169b0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-000169c0: 756d 6572 6963 5f64 6420 3d20 5f63 6f6e  umeric_dd = _con
-000169d0: 7665 7274 5f74 6f5f 6e75 6d65 7269 6328  vert_to_numeric(
-000169e0: 7365 6c66 2c20 736b 6970 6e61 290a 0a20  self, skipna).. 
-000169f0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-00016a00: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00016a10: 2072 6573 756c 7420 3d20 6d61 705f 7061   result = map_pa
-00016a20: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-00016a30: 2020 2020 2020 2020 2020 4d2e 7374 6420            M.std 
-00016a40: 6966 206e 6f74 206e 6565 6473 5f74 696d  if not needs_tim
-00016a50: 655f 636f 6e76 6572 7369 6f6e 2065 6c73  e_conversion els
-00016a60: 6520 5f73 7172 745f 616e 645f 636f 6e76  e _sqrt_and_conv
-00016a70: 6572 745f 746f 5f74 696d 6564 656c 7461  ert_to_timedelta
-00016a80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00016a90: 2020 6e75 6d65 7269 635f 6464 2c0a 2020    numeric_dd,.  
-00016aa0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-00016ab0: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
-00016ac0: 2020 2020 2020 2020 2074 6f6b 656e 3d73           token=s
-00016ad0: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
-00016ae0: 7820 2b20 2273 7464 222c 0a20 2020 2020  x + "std",.     
-00016af0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-00016b00: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-00016b10: 2020 2020 2020 736b 6970 6e61 3d73 6b69        skipna=ski
-00016b20: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
-00016b30: 2020 2020 2064 646f 663d 6464 6f66 2c0a       ddof=ddof,.
-00016b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b50: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-00016b60: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00016b70: 2020 2020 2020 2020 2a2a 6e75 6d65 7269          **numeri
-00016b80: 635f 6b77 6172 6773 2c0a 2020 2020 2020  c_kwargs,.      
-00016b90: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
-00016ba0: 5f6d 6574 613d 7365 6c66 2e5f 6d65 7461  _meta=self._meta
-00016bb0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00016bc0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00016bd0: 726e 2068 616e 646c 655f 6f75 7428 6f75  rn handle_out(ou
-00016be0: 742c 2072 6573 756c 7429 0a0a 2020 2020  t, result)..    
-00016bf0: 2020 2020 2320 4361 7365 2077 6865 7265      # Case where
-00016c00: 2061 7869 733d 3020 6f72 2061 7869 733d   axis=0 or axis=
-00016c10: 4e6f 6e65 0a20 2020 2020 2020 2076 203d  None.        v =
-00016c20: 206e 756d 6572 6963 5f64 642e 7661 7228   numeric_dd.var(
-00016c30: 736b 6970 6e61 3d73 6b69 706e 612c 2064  skipna=skipna, d
-00016c40: 646f 663d 6464 6f66 2c20 7370 6c69 745f  dof=ddof, split_
-00016c50: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-00016c60: 7929 0a20 2020 2020 2020 206e 616d 6520  y).        name 
-00016c70: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
-00016c80: 6566 6978 202b 2022 7374 6422 0a0a 2020  efix + "std"..  
-00016c90: 2020 2020 2020 6966 206e 6565 6473 5f74        if needs_t
-00016ca0: 696d 655f 636f 6e76 6572 7369 6f6e 3a0a  ime_conversion:.
-00016cb0: 2020 2020 2020 2020 2020 2020 7371 7274              sqrt
-00016cc0: 5f66 756e 635f 6b77 6172 6773 203d 207b  _func_kwargs = {
-00016cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016ce0: 2022 6973 5f64 665f 6c69 6b65 223a 2069   "is_df_like": i
-00016cf0: 735f 6466 5f6c 696b 652c 0a20 2020 2020  s_df_like,.     
-00016d00: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
-00016d10: 5f63 6f6c 7322 3a20 7469 6d65 5f63 6f6c  _cols": time_col
-00016d20: 7320 6966 2069 735f 6466 5f6c 696b 6520  s if is_df_like 
-00016d30: 656c 7365 204e 6f6e 652c 0a20 2020 2020  else None,.     
-00016d40: 2020 2020 2020 2020 2020 2022 6178 6973             "axis
-00016d50: 223a 2061 7869 732c 0a20 2020 2020 2020  ": axis,.       
-00016d60: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-00016d70: 2020 2073 7172 745f 6675 6e63 203d 205f     sqrt_func = _
-00016d80: 7371 7274 5f61 6e64 5f63 6f6e 7665 7274  sqrt_and_convert
-00016d90: 5f74 6f5f 7469 6d65 6465 6c74 610a 2020  _to_timedelta.  
-00016da0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00016db0: 2020 2020 2020 2020 7371 7274 5f66 756e          sqrt_fun
-00016dc0: 635f 6b77 6172 6773 203d 207b 7d0a 2020  c_kwargs = {}.  
-00016dd0: 2020 2020 2020 2020 2020 7371 7274 5f66            sqrt_f
-00016de0: 756e 6320 3d20 6e70 2e73 7172 740a 0a20  unc = np.sqrt.. 
-00016df0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00016e00: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
-00016e10: 2020 2020 2020 2020 2020 2020 7371 7274              sqrt
-00016e20: 5f66 756e 632c 0a20 2020 2020 2020 2020  _func,.         
-00016e30: 2020 2076 2c0a 2020 2020 2020 2020 2020     v,.          
-00016e40: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
-00016e50: 2020 2020 2020 2020 2074 6f6b 656e 3d6e           token=n
-00016e60: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00016e70: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-00016e80: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
-00016e90: 2020 2020 2070 6172 656e 745f 6d65 7461       parent_meta
-00016ea0: 3d73 656c 662e 5f6d 6574 612c 0a20 2020  =self._meta,.   
-00016eb0: 2020 2020 2020 2020 202a 2a73 7172 745f           **sqrt_
-00016ec0: 6675 6e63 5f6b 7761 7267 732c 0a20 2020  func_kwargs,.   
-00016ed0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00016ee0: 2320 5472 7920 746f 206d 6174 6368 2074  # Try to match t
-00016ef0: 6865 2050 616e 6461 7320 7265 7375 6c74  he Pandas result
-00016f00: 2064 7479 7065 0a20 2020 2020 2020 2069   dtype.        i
-00016f10: 6620 6973 5f64 665f 6c69 6b65 2061 6e64  f is_df_like and
-00016f20: 2068 6173 6174 7472 286d 6574 612c 2022   hasattr(meta, "
-00016f30: 6474 7970 6522 293a 0a20 2020 2020 2020  dtype"):.       
-00016f40: 2020 2020 2072 6573 756c 7420 3d20 7265       result = re
-00016f50: 7375 6c74 2e61 7374 7970 6528 6d65 7461  sult.astype(meta
-00016f60: 2e64 7479 7065 290a 0a20 2020 2020 2020  .dtype)..       
-00016f70: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
-00016f80: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
-00016f90: 0a20 2020 2064 6566 205f 636f 6e76 6572  .    def _conver
-00016fa0: 745f 7469 6d65 5f63 6f6c 735f 746f 5f6e  t_time_cols_to_n
-00016fb0: 756d 6572 6963 2873 656c 662c 2074 696d  umeric(self, tim
-00016fc0: 655f 636f 6c73 2c20 6178 6973 2c20 6d65  e_cols, axis, me
-00016fd0: 7461 2c20 736b 6970 6e61 293a 0a20 2020  ta, skipna):.   
-00016fe0: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-00016ff0: 6174 6166 7261 6d65 2e69 6f20 696d 706f  ataframe.io impo
-00017000: 7274 2066 726f 6d5f 7061 6e64 6173 0a0a  rt from_pandas..
-00017010: 2020 2020 2020 2020 6e65 6564 735f 7469          needs_ti
-00017020: 6d65 5f63 6f6e 7665 7273 696f 6e20 3d20  me_conversion = 
-00017030: 5472 7565 0a0a 2020 2020 2020 2020 2320  True..        # 
-00017040: 456e 7375 7265 2061 6c6c 2063 6f6c 756d  Ensure all colum
-00017050: 6e73 2061 7265 2063 6f72 7265 6374 2074  ns are correct t
-00017060: 7970 652e 204e 6565 6420 746f 2073 6861  ype. Need to sha
-00017070: 6c6c 6f77 2063 6f70 7920 7369 6e63 6520  llow copy since 
-00017080: 636f 6c73 2077 696c 6c20 6265 206d 6f64  cols will be mod
-00017090: 6966 6965 640a 2020 2020 2020 2020 6966  ified.        if
-000170a0: 2061 7869 7320 3d3d 2030 3a0a 2020 2020   axis == 0:.    
-000170b0: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
-000170c0: 6464 203d 2073 656c 665b 6d65 7461 2e69  dd = self[meta.i
-000170d0: 6e64 6578 5d2e 636f 7079 2829 0a20 2020  ndex].copy().   
-000170e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000170f0: 2020 2020 2020 206e 756d 6572 6963 5f64         numeric_d
-00017100: 6420 3d20 7365 6c66 2e63 6f70 7928 290a  d = self.copy().
-00017110: 0a20 2020 2020 2020 2023 204d 6978 206f  .        # Mix o
-00017120: 6620 6461 7465 7469 6d65 7320 7769 7468  f datetimes with
-00017130: 206f 7468 6572 206e 756d 6572 6963 2074   other numeric t
-00017140: 7970 6573 2070 726f 6475 6365 7320 4e61  ypes produces Na
-00017150: 4e73 2066 6f72 2065 6163 6820 7661 6c75  Ns for each valu
-00017160: 6520 696e 2073 7464 2829 2073 6572 6965  e in std() serie
-00017170: 730a 2020 2020 2020 2020 6966 2061 7869  s.        if axi
-00017180: 7320 3d3d 2031 2061 6e64 206c 656e 2874  s == 1 and len(t
-00017190: 696d 655f 636f 6c73 2920 213d 206c 656e  ime_cols) != len
-000171a0: 2873 656c 662e 636f 6c75 6d6e 7329 3a0a  (self.columns):.
-000171b0: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
-000171c0: 6973 2069 7320 6661 7374 6572 2074 6861  is is faster tha
-000171d0: 6e20 636f 6e76 6572 7469 6e67 2065 6163  n converting eac
-000171e0: 6820 636f 6c75 6d6e 2074 6f20 6e75 6d65  h column to nume
-000171f0: 7269 6320 7768 656e 2069 7427 7320 6e6f  ric when it's no
-00017200: 7420 6e65 6365 7373 6172 790a 2020 2020  t necessary.    
-00017210: 2020 2020 2020 2020 2320 7369 6e63 6520          # since 
-00017220: 6561 6368 2073 7461 6e64 6172 6420 6465  each standard de
-00017230: 7669 6174 696f 6e20 7769 6c6c 206a 7573  viation will jus
-00017240: 7420 6265 204e 614e 0a20 2020 2020 2020  t be NaN.       
-00017250: 2020 2020 206e 6565 6473 5f74 696d 655f       needs_time_
-00017260: 636f 6e76 6572 7369 6f6e 203d 2046 616c  conversion = Fal
-00017270: 7365 0a20 2020 2020 2020 2020 2020 206e  se.            n
-00017280: 756d 6572 6963 5f64 6420 3d20 6672 6f6d  umeric_dd = from
-00017290: 5f70 616e 6461 7328 0a20 2020 2020 2020  _pandas(.       
-000172a0: 2020 2020 2020 2020 206d 6574 615f 6672           meta_fr
-000172b0: 616d 655f 636f 6e73 7472 7563 746f 7228  ame_constructor(
-000172c0: 7365 6c66 2928 0a20 2020 2020 2020 2020  self)(.         
-000172d0: 2020 2020 2020 2020 2020 207b 225f 223a             {"_":
-000172e0: 206d 6574 615f 7365 7269 6573 5f63 6f6e   meta_series_con
-000172f0: 7374 7275 6374 6f72 2873 656c 6629 285b  structor(self)([
-00017300: 6e70 2e6e 616e 5d29 7d2c 0a20 2020 2020  np.nan])},.     
-00017310: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00017320: 6e64 6578 3d73 656c 662e 696e 6465 782c  ndex=self.index,
-00017330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017340: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-00017350: 2020 2020 6e70 6172 7469 7469 6f6e 733d      npartitions=
-00017360: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
-00017370: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00017380: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00017390: 2020 2020 2020 2020 2020 2320 436f 6e76            # Conv
-000173a0: 6572 7420 7469 6d65 6465 6c74 6120 616e  ert timedelta an
-000173b0: 6420 6461 7465 7469 6d65 2063 6f6c 756d  d datetime colum
-000173c0: 6e73 2074 6f20 696e 7465 6765 7220 7479  ns to integer ty
-000173d0: 7065 7320 736f 2077 6520 6361 6e20 7573  pes so we can us
-000173e0: 6520 7661 720a 2020 2020 2020 2020 2020  e var.          
-000173f0: 2020 666f 7220 636f 6c20 696e 2074 696d    for col in tim
-00017400: 655f 636f 6c73 3a0a 2020 2020 2020 2020  e_cols:.        
-00017410: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
-00017420: 6464 5b63 6f6c 5d20 3d20 5f63 6f6e 7665  dd[col] = _conve
-00017430: 7274 5f74 6f5f 6e75 6d65 7269 6328 6e75  rt_to_numeric(nu
-00017440: 6d65 7269 635f 6464 5b63 6f6c 5d2c 2073  meric_dd[col], s
-00017450: 6b69 706e 6129 0a0a 2020 2020 2020 2020  kipna)..        
-00017460: 7265 7475 726e 206e 756d 6572 6963 5f64  return numeric_d
-00017470: 642c 206e 6565 6473 5f74 696d 655f 636f  d, needs_time_co
-00017480: 6e76 6572 7369 6f6e 0a0a 2020 2020 405f  nversion..    @_
-00017490: 6e75 6d65 7269 635f 6f6e 6c79 0a20 2020  numeric_only.   
-000174a0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-000174b0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-000174c0: 2064 6566 2073 6b65 7728 0a20 2020 2020   def skew(.     
-000174d0: 2020 2073 656c 662c 2061 7869 733d 302c     self, axis=0,
-000174e0: 2062 6961 733d 5472 7565 2c20 6e61 6e5f   bias=True, nan_
-000174f0: 706f 6c69 6379 3d22 7072 6f70 6167 6174  policy="propagat
-00017500: 6522 2c20 6f75 743d 4e6f 6e65 2c20 6e75  e", out=None, nu
-00017510: 6d65 7269 635f 6f6e 6c79 3d4e 6f6e 650a  meric_only=None.
-00017520: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-00017530: 2222 0a20 2020 2020 2020 202e 2e20 6e6f  "".        .. no
-00017540: 7465 3a3a 0a0a 2020 2020 2020 2020 2020  te::..          
-00017550: 2054 6869 7320 696d 706c 656d 656e 7461   This implementa
-00017560: 7469 6f6e 2066 6f6c 6c6f 7773 2074 6865  tion follows the
-00017570: 2064 6173 6b2e 6172 7261 792e 7374 6174   dask.array.stat
-00017580: 7320 696d 706c 656d 656e 7461 7469 6f6e  s implementation
-00017590: 0a20 2020 2020 2020 2020 2020 6f66 2073  .           of s
-000175a0: 6b65 776e 6573 7320 616e 6420 6361 6c63  kewness and calc
-000175b0: 756c 6174 6573 2073 6b65 776e 6573 7320  ulates skewness 
-000175c0: 7769 7468 6f75 7420 7461 6b69 6e67 2069  without taking i
-000175d0: 6e74 6f20 6163 636f 756e 740a 2020 2020  nto account.    
-000175e0: 2020 2020 2020 2061 2062 6961 7320 7465         a bias te
-000175f0: 726d 2066 6f72 2066 696e 6974 6520 7361  rm for finite sa
-00017600: 6d70 6c65 2073 697a 652c 2077 6869 6368  mple size, which
-00017610: 2063 6f72 7265 7370 6f6e 6473 2074 6f20   corresponds to 
-00017620: 7468 650a 2020 2020 2020 2020 2020 2064  the.           d
-00017630: 6566 6175 6c74 2073 6574 7469 6e67 7320  efault settings 
-00017640: 6f66 2074 6865 2073 6369 7079 2e73 7461  of the scipy.sta
-00017650: 7473 2073 6b65 776e 6573 7320 6361 6c63  ts skewness calc
-00017660: 756c 6174 696f 6e2e 2048 6f77 6576 6572  ulation. However
-00017670: 2c0a 2020 2020 2020 2020 2020 2050 616e  ,.           Pan
-00017680: 6461 7320 636f 7272 6563 7473 2066 6f72  das corrects for
-00017690: 2074 6869 732c 2073 6f20 7468 6520 7661   this, so the va
-000176a0: 6c75 6573 2064 6966 6665 7220 6279 2061  lues differ by a
-000176b0: 2066 6163 746f 7220 6f66 0a20 2020 2020   factor of.     
-000176c0: 2020 2020 2020 286e 202a 2028 6e20 2d20        (n * (n - 
-000176d0: 3129 2920 2a2a 2030 2e35 202f 2028 6e20  1)) ** 0.5 / (n 
-000176e0: 2d20 3229 2c20 7768 6572 6520 6e20 6973  - 2), where n is
-000176f0: 2074 6865 206e 756d 6265 7220 6f66 2073   the number of s
-00017700: 616d 706c 6573 2e0a 0a20 2020 2020 2020  amples...       
-00017710: 2020 2020 4675 7274 6865 722c 2074 6869      Further, thi
-00017720: 7320 6d65 7468 6f64 2063 7572 7265 6e74  s method current
-00017730: 6c79 2064 6f65 7320 6e6f 7420 7375 7070  ly does not supp
-00017740: 6f72 7420 6669 6c74 6572 696e 6720 6f75  ort filtering ou
-00017750: 7420 4e61 4e0a 2020 2020 2020 2020 2020  t NaN.          
-00017760: 2076 616c 7565 732c 2077 6869 6368 2069   values, which i
-00017770: 7320 6167 6169 6e20 6120 6469 6666 6572  s again a differ
-00017780: 656e 6365 2074 6f20 5061 6e64 6173 2e0a  ence to Pandas..
-00017790: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000177a0: 2020 2020 6966 2050 414e 4441 535f 4754      if PANDAS_GT
-000177b0: 5f32 3030 2061 6e64 2061 7869 7320 6973  _200 and axis is
-000177c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000177d0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000177e0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-000177f0: 2020 2020 2022 6061 7869 733d 4e6f 6e65       "`axis=None
-00017800: 6020 6973 6e27 7420 6375 7272 656e 746c  ` isn't currentl
-00017810: 7920 7375 7070 6f72 7465 6420 666f 7220  y supported for 
-00017820: 6073 6b65 7760 2077 6865 6e20 7573 696e  `skew` when usin
-00017830: 6720 6070 616e 6461 7320 3e3d 3260 2022  g `pandas >=2` "
-00017840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017850: 2066 2228 7061 6e64 6173 3d7b 7374 7228   f"(pandas={str(
-00017860: 5041 4e44 4153 5f56 4552 5349 4f4e 297d  PANDAS_VERSION)}
-00017870: 2069 7320 696e 7374 616c 6c65 6429 2e22   is installed)."
-00017880: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00017890: 2020 2020 2020 2061 7869 7320 3d20 7365         axis = se
-000178a0: 6c66 2e5f 7661 6c69 6461 7465 5f61 7869  lf._validate_axi
-000178b0: 7328 6178 6973 290a 2020 2020 2020 2020  s(axis).        
-000178c0: 5f72 6169 7365 5f69 665f 6f62 6a65 6374  _raise_if_object
-000178d0: 5f73 6572 6965 7328 7365 6c66 2c20 2273  _series(self, "s
-000178e0: 6b65 7722 290a 2020 2020 2020 2020 6d65  kew").        me
-000178f0: 7461 203d 2073 656c 662e 5f6d 6574 615f  ta = self._meta_
-00017900: 6e6f 6e65 6d70 7479 2e73 6b65 7728 290a  nonempty.skew().
-00017910: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-00017920: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-00017930: 2020 7265 7375 6c74 203d 206d 6170 5f70    result = map_p
-00017940: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-00017950: 2020 2020 2020 2020 2020 204d 2e73 6b65             M.ske
-00017960: 772c 0a20 2020 2020 2020 2020 2020 2020  w,.             
-00017970: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00017980: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
-00017990: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-000179a0: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
-000179b0: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
-000179c0: 736b 6577 222c 0a20 2020 2020 2020 2020  skew",.         
-000179d0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
-000179e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000179f0: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
-00017a00: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
-00017a10: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00017a20: 2020 2020 7265 7475 726e 2068 616e 646c      return handl
-00017a30: 655f 6f75 7428 6f75 742c 2072 6573 756c  e_out(out, resul
-00017a40: 7429 0a20 2020 2020 2020 2065 6c73 653a  t).        else:
-00017a50: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00017a60: 7365 6c66 2e6e 6469 6d20 3d3d 2031 3a0a  self.ndim == 1:.
-00017a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a80: 7265 7375 6c74 203d 2073 656c 662e 5f73  result = self._s
-00017a90: 6b65 775f 3164 2873 656c 662c 2062 6961  kew_1d(self, bia
-00017aa0: 733d 6269 6173 2c20 6e61 6e5f 706f 6c69  s=bias, nan_poli
-00017ab0: 6379 3d6e 616e 5f70 6f6c 6963 7929 0a20  cy=nan_policy). 
-00017ac0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00017ad0: 6574 7572 6e20 6861 6e64 6c65 5f6f 7574  eturn handle_out
-00017ae0: 286f 7574 2c20 7265 7375 6c74 290a 2020  (out, result).  
-00017af0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00017b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b10: 7265 7375 6c74 203d 2073 656c 662e 5f73  result = self._s
-00017b20: 6b65 775f 6e75 6d65 7269 6328 6269 6173  kew_numeric(bias
-00017b30: 3d62 6961 732c 206e 616e 5f70 6f6c 6963  =bias, nan_polic
-00017b40: 793d 6e61 6e5f 706f 6c69 6379 290a 0a20  y=nan_policy).. 
-00017b50: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-00017b60: 696e 7374 616e 6365 2873 656c 662c 2044  instance(self, D
-00017b70: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
-00017b80: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00017b90: 742e 6469 7669 7369 6f6e 7320 3d20 2873  t.divisions = (s
-00017ba0: 656c 662e 636f 6c75 6d6e 732e 6d69 6e28  elf.columns.min(
-00017bb0: 292c 2073 656c 662e 636f 6c75 6d6e 732e  ), self.columns.
-00017bc0: 6d61 7828 2929 0a0a 2020 2020 2020 2020  max())..        
-00017bd0: 2020 2020 7265 7475 726e 2068 616e 646c      return handl
-00017be0: 655f 6f75 7428 6f75 742c 2072 6573 756c  e_out(out, resul
-00017bf0: 7429 0a0a 2020 2020 6465 6620 5f73 6b65  t)..    def _ske
-00017c00: 775f 3164 2873 656c 662c 2063 6f6c 756d  w_1d(self, colum
-00017c10: 6e2c 2062 6961 733d 5472 7565 2c20 6e61  n, bias=True, na
-00017c20: 6e5f 706f 6c69 6379 3d22 7072 6f70 6167  n_policy="propag
-00017c30: 6174 6522 293a 0a20 2020 2020 2020 2022  ate"):.        "
-00017c40: 2222 3144 2076 6572 7369 6f6e 206f 6620  ""1D version of 
-00017c50: 7468 6520 736b 6577 2063 616c 6375 6c61  the skew calcula
-00017c60: 7469 6f6e 2e0a 0a20 2020 2020 2020 2055  tion...        U
-00017c70: 7365 7320 7468 6520 6172 7261 7920 7665  ses the array ve
-00017c80: 7273 696f 6e20 6672 6f6d 2064 612e 7374  rsion from da.st
-00017c90: 6174 7320 696e 2063 6173 6520 7765 2061  ats in case we a
-00017ca0: 7265 2070 6173 7369 6e67 2069 6e20 6120  re passing in a 
-00017cb0: 7369 6e67 6c65 2073 6572 6965 730a 2020  single series.  
-00017cc0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00017cd0: 2020 2320 696d 706f 7274 2064 6570 656e    # import depen
-00017ce0: 6473 206f 6e20 7363 6970 792c 206e 6f74  ds on scipy, not
-00017cf0: 2069 6e73 7461 6c6c 6564 2062 7920 6465   installed by de
-00017d00: 6661 756c 740a 2020 2020 2020 2020 6672  fault.        fr
-00017d10: 6f6d 2064 6173 6b2e 6172 7261 7920 696d  om dask.array im
-00017d20: 706f 7274 2073 7461 7473 2061 7320 6461  port stats as da
-00017d30: 5f73 7461 7473 0a0a 2020 2020 2020 2020  _stats..        
-00017d40: 6966 2070 642e 496e 7436 3444 7479 7065  if pd.Int64Dtype
-00017d50: 2e69 735f 6474 7970 6528 636f 6c75 6d6e  .is_dtype(column
-00017d60: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 7929  ._meta_nonempty)
-00017d70: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-00017d80: 6c75 6d6e 203d 2063 6f6c 756d 6e2e 6173  lumn = column.as
-00017d90: 7479 7065 2822 6638 2229 0a0a 2020 2020  type("f8")..    
-00017da0: 2020 2020 6966 206e 6f74 206e 702e 6973      if not np.is
-00017db0: 7375 6264 7479 7065 2863 6f6c 756d 6e2e  subdtype(column.
-00017dc0: 6474 7970 652c 206e 702e 6e75 6d62 6572  dtype, np.number
-00017dd0: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
-00017de0: 6f6c 756d 6e20 3d20 636f 6c75 6d6e 2e61  olumn = column.a
-00017df0: 7374 7970 6528 2266 3822 290a 0a20 2020  stype("f8")..   
-00017e00: 2020 2020 206e 616d 6520 3d20 7365 6c66       name = self
-00017e10: 2e5f 746f 6b65 6e5f 7072 6566 6978 202b  ._token_prefix +
-00017e20: 2022 736b 6577 2d31 642d 2220 2b20 746f   "skew-1d-" + to
-00017e30: 6b65 6e69 7a65 2863 6f6c 756d 6e29 0a0a  kenize(column)..
-00017e40: 2020 2020 2020 2020 6172 7261 795f 736b          array_sk
-00017e50: 6577 203d 2064 615f 7374 6174 732e 736b  ew = da_stats.sk
-00017e60: 6577 280a 2020 2020 2020 2020 2020 2020  ew(.            
-00017e70: 636f 6c75 6d6e 2e76 616c 7565 732c 2061  column.values, a
-00017e80: 7869 733d 302c 2062 6961 733d 6269 6173  xis=0, bias=bias
-00017e90: 2c20 6e61 6e5f 706f 6c69 6379 3d6e 616e  , nan_policy=nan
-00017ea0: 5f70 6f6c 6963 790a 2020 2020 2020 2020  _policy.        
-00017eb0: 290a 0a20 2020 2020 2020 206c 6179 6572  )..        layer
-00017ec0: 203d 207b 286e 616d 652c 2030 293a 2028   = {(name, 0): (
-00017ed0: 6d65 7468 6f64 732e 7772 6170 5f73 6b65  methods.wrap_ske
-00017ee0: 775f 7265 6475 6374 696f 6e2c 2028 6172  w_reduction, (ar
-00017ef0: 7261 795f 736b 6577 2e5f 6e61 6d65 2c29  ray_skew._name,)
-00017f00: 2c20 4e6f 6e65 297d 0a20 2020 2020 2020  , None)}.       
-00017f10: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-00017f20: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-00017f30: 6c65 6374 696f 6e73 286e 616d 652c 206c  lections(name, l
-00017f40: 6179 6572 2c20 6465 7065 6e64 656e 6369  ayer, dependenci
-00017f50: 6573 3d5b 6172 7261 795f 736b 6577 5d29  es=[array_skew])
-00017f60: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00017f70: 206e 6577 5f64 645f 6f62 6a65 6374 280a   new_dd_object(.
-00017f80: 2020 2020 2020 2020 2020 2020 6772 6170              grap
-00017f90: 682c 206e 616d 652c 2063 6f6c 756d 6e2e  h, name, column.
-00017fa0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e73  _meta_nonempty.s
-00017fb0: 6b65 7728 292c 2064 6976 6973 696f 6e73  kew(), divisions
-00017fc0: 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d0a 2020  =[None, None].  
-00017fd0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00017fe0: 205f 736b 6577 5f6e 756d 6572 6963 2873   _skew_numeric(s
-00017ff0: 656c 662c 2062 6961 733d 5472 7565 2c20  elf, bias=True, 
-00018000: 6e61 6e5f 706f 6c69 6379 3d22 7072 6f70  nan_policy="prop
-00018010: 6167 6174 6522 293a 0a20 2020 2020 2020  agate"):.       
-00018020: 2022 2222 4d65 7468 6f64 2066 6f72 2064   """Method for d
-00018030: 6174 6166 7261 6d65 7320 7769 7468 206e  ataframes with n
-00018040: 756d 6572 6963 2063 6f6c 756d 6e73 2e0a  umeric columns..
-00018050: 0a20 2020 2020 2020 204d 6170 7320 7468  .        Maps th
-00018060: 6520 6172 7261 7920 7665 7273 696f 6e20  e array version 
-00018070: 6672 6f6d 2064 612e 7374 6174 7320 6f6e  from da.stats on
-00018080: 746f 2074 6865 206e 756d 6572 6963 2061  to the numeric a
-00018090: 7272 6179 206f 6620 636f 6c75 6d6e 732e  rray of columns.
-000180a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000180b0: 2020 2020 2023 2069 6d70 6f72 7420 6465       # import de
-000180c0: 7065 6e64 7320 6f6e 2073 6369 7079 2c20  pends on scipy, 
-000180d0: 6e6f 7420 696e 7374 616c 6c65 6420 6279  not installed by
-000180e0: 2064 6566 6175 6c74 0a20 2020 2020 2020   default.       
-000180f0: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
-00018100: 2069 6d70 6f72 7420 7374 6174 7320 6173   import stats as
-00018110: 2064 615f 7374 6174 730a 0a20 2020 2020   da_stats..     
-00018120: 2020 206e 756d 203d 2073 656c 662e 7365     num = self.se
-00018130: 6c65 6374 5f64 7479 7065 7328 696e 636c  lect_dtypes(incl
-00018140: 7564 653d 5b22 6e75 6d62 6572 222c 2022  ude=["number", "
-00018150: 626f 6f6c 225d 2c20 6578 636c 7564 653d  bool"], exclude=
-00018160: 5b6e 702e 7469 6d65 6465 6c74 6136 345d  [np.timedelta64]
-00018170: 290a 0a20 2020 2020 2020 2076 616c 7565  )..        value
-00018180: 735f 6474 7970 6520 3d20 6e75 6d2e 7661  s_dtype = num.va
-00018190: 6c75 6573 2e64 7479 7065 0a20 2020 2020  lues.dtype.     
-000181a0: 2020 2061 7272 6179 5f76 616c 7565 7320     array_values 
-000181b0: 3d20 6e75 6d2e 7661 6c75 6573 0a0a 2020  = num.values..  
-000181c0: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
-000181d0: 6973 7375 6264 7479 7065 2876 616c 7565  issubdtype(value
-000181e0: 735f 6474 7970 652c 206e 702e 6e75 6d62  s_dtype, np.numb
-000181f0: 6572 293a 0a20 2020 2020 2020 2020 2020  er):.           
-00018200: 2061 7272 6179 5f76 616c 7565 7320 3d20   array_values = 
-00018210: 6e75 6d2e 7661 6c75 6573 2e61 7374 7970  num.values.astyp
-00018220: 6528 2266 3822 290a 0a20 2020 2020 2020  e("f8")..       
-00018230: 2061 7272 6179 5f73 6b65 7720 3d20 6461   array_skew = da
-00018240: 5f73 7461 7473 2e73 6b65 7728 0a20 2020  _stats.skew(.   
-00018250: 2020 2020 2020 2020 2061 7272 6179 5f76           array_v
-00018260: 616c 7565 732c 2061 7869 733d 302c 2062  alues, axis=0, b
-00018270: 6961 733d 6269 6173 2c20 6e61 6e5f 706f  ias=bias, nan_po
-00018280: 6c69 6379 3d6e 616e 5f70 6f6c 6963 790a  licy=nan_policy.
-00018290: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-000182a0: 2020 206e 616d 6520 3d20 7365 6c66 2e5f     name = self._
-000182b0: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
-000182c0: 7661 722d 6e75 6d65 7269 6322 202b 2074  var-numeric" + t
-000182d0: 6f6b 656e 697a 6528 6e75 6d29 0a20 2020  okenize(num).   
-000182e0: 2020 2020 2063 6f6c 7320 3d20 6e75 6d2e       cols = num.
-000182f0: 5f6d 6574 612e 636f 6c75 6d6e 7320 6966  _meta.columns if
-00018300: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
-00018310: 6b65 286e 756d 2920 656c 7365 204e 6f6e  ke(num) else Non
-00018320: 650a 0a20 2020 2020 2020 2077 6974 6820  e..        with 
-00018330: 6368 6563 6b5f 7265 6475 6374 696f 6e73  check_reductions
-00018340: 5f72 756e 7469 6d65 5f77 6172 6e69 6e67  _runtime_warning
-00018350: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00018360: 736b 6577 5f73 6861 7065 203d 206e 756d  skew_shape = num
-00018370: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-00018380: 7661 7228 6178 6973 3d30 292e 7368 6170  var(axis=0).shap
-00018390: 650a 2020 2020 2020 2020 6172 7261 795f  e.        array_
-000183a0: 736b 6577 5f6e 616d 6520 3d20 2861 7272  skew_name = (arr
-000183b0: 6179 5f73 6b65 772e 5f6e 616d 652c 2920  ay_skew._name,) 
-000183c0: 2b20 2830 2c29 202a 206c 656e 2873 6b65  + (0,) * len(ske
-000183d0: 775f 7368 6170 6529 0a0a 2020 2020 2020  w_shape)..      
-000183e0: 2020 6c61 7965 7220 3d20 7b28 6e61 6d65    layer = {(name
-000183f0: 2c20 3029 3a20 286d 6574 686f 6473 2e77  , 0): (methods.w
-00018400: 7261 705f 736b 6577 5f72 6564 7563 7469  rap_skew_reducti
-00018410: 6f6e 2c20 6172 7261 795f 736b 6577 5f6e  on, array_skew_n
-00018420: 616d 652c 2063 6f6c 7329 7d0a 2020 2020  ame, cols)}.    
-00018430: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
-00018440: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
-00018450: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
-00018460: 2c20 6c61 7965 722c 2064 6570 656e 6465  , layer, depende
-00018470: 6e63 6965 733d 5b61 7272 6179 5f73 6b65  ncies=[array_ske
-00018480: 775d 290a 0a20 2020 2020 2020 2072 6574  w])..        ret
-00018490: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
-000184a0: 7428 0a20 2020 2020 2020 2020 2020 2067  t(.            g
-000184b0: 7261 7068 2c20 6e61 6d65 2c20 6e75 6d2e  raph, name, num.
-000184c0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e73  _meta_nonempty.s
-000184d0: 6b65 7728 292c 2064 6976 6973 696f 6e73  kew(), divisions
-000184e0: 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d0a 2020  =[None, None].  
-000184f0: 2020 2020 2020 290a 0a20 2020 2040 5f6e        )..    @_n
-00018500: 756d 6572 6963 5f6f 6e6c 790a 2020 2020  umeric_only.    
-00018510: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00018520: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-00018530: 6465 6620 6b75 7274 6f73 6973 280a 2020  def kurtosis(.  
-00018540: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00018550: 2020 2020 6178 6973 3d30 2c0a 2020 2020      axis=0,.    
-00018560: 2020 2020 6669 7368 6572 3d54 7275 652c      fisher=True,
-00018570: 0a20 2020 2020 2020 2062 6961 733d 5472  .        bias=Tr
-00018580: 7565 2c0a 2020 2020 2020 2020 6e61 6e5f  ue,.        nan_
-00018590: 706f 6c69 6379 3d22 7072 6f70 6167 6174  policy="propagat
-000185a0: 6522 2c0a 2020 2020 2020 2020 6f75 743d  e",.        out=
-000185b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e75  None,.        nu
-000185c0: 6d65 7269 635f 6f6e 6c79 3d4e 6f6e 652c  meric_only=None,
-000185d0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-000185e0: 2222 220a 2020 2020 2020 2020 2e2e 206e  """.        .. n
-000185f0: 6f74 653a 3a0a 0a20 2020 2020 2020 2020  ote::..         
-00018600: 2020 5468 6973 2069 6d70 6c65 6d65 6e74    This implement
-00018610: 6174 696f 6e20 666f 6c6c 6f77 7320 7468  ation follows th
-00018620: 6520 6461 736b 2e61 7272 6179 2e73 7461  e dask.array.sta
-00018630: 7473 2069 6d70 6c65 6d65 6e74 6174 696f  ts implementatio
-00018640: 6e0a 2020 2020 2020 2020 2020 206f 6620  n.           of 
-00018650: 6b75 7274 6f73 6973 2061 6e64 2063 616c  kurtosis and cal
-00018660: 6375 6c61 7465 7320 6b75 7274 6f73 6973  culates kurtosis
-00018670: 2077 6974 686f 7574 2074 616b 696e 6720   without taking 
-00018680: 696e 746f 2061 6363 6f75 6e74 0a20 2020  into account.   
-00018690: 2020 2020 2020 2020 6120 6269 6173 2074          a bias t
-000186a0: 6572 6d20 666f 7220 6669 6e69 7465 2073  erm for finite s
-000186b0: 616d 706c 6520 7369 7a65 2c20 7768 6963  ample size, whic
-000186c0: 6820 636f 7272 6573 706f 6e64 7320 746f  h corresponds to
-000186d0: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-000186e0: 6465 6661 756c 7420 7365 7474 696e 6773  default settings
-000186f0: 206f 6620 7468 6520 7363 6970 792e 7374   of the scipy.st
-00018700: 6174 7320 6b75 7274 6f73 6973 2063 616c  ats kurtosis cal
-00018710: 6375 6c61 7469 6f6e 2e20 5468 6973 2064  culation. This d
-00018720: 6966 6665 7273 0a20 2020 2020 2020 2020  iffers.         
-00018730: 2020 6672 6f6d 2070 616e 6461 732e 0a0a    from pandas...
-00018740: 2020 2020 2020 2020 2020 2046 7572 7468             Furth
-00018750: 6572 2c20 7468 6973 206d 6574 686f 6420  er, this method 
-00018760: 6375 7272 656e 746c 7920 646f 6573 206e  currently does n
-00018770: 6f74 2073 7570 706f 7274 2066 696c 7465  ot support filte
-00018780: 7269 6e67 206f 7574 204e 614e 0a20 2020  ring out NaN.   
-00018790: 2020 2020 2020 2020 7661 6c75 6573 2c20          values, 
-000187a0: 7768 6963 6820 6973 2061 6761 696e 2061  which is again a
-000187b0: 2064 6966 6665 7265 6e63 6520 746f 2050   difference to P
-000187c0: 616e 6461 732e 0a20 2020 2020 2020 2022  andas..        "
-000187d0: 2222 0a20 2020 2020 2020 2069 6620 5041  "".        if PA
-000187e0: 4e44 4153 5f47 545f 3230 3020 616e 6420  NDAS_GT_200 and 
-000187f0: 6178 6973 2069 7320 4e6f 6e65 3a0a 2020  axis is None:.  
-00018800: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00018810: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00018820: 2020 2020 2020 2020 2020 2020 2260 6178              "`ax
-00018830: 6973 3d4e 6f6e 6560 2069 736e 2774 2063  is=None` isn't c
-00018840: 7572 7265 6e74 6c79 2073 7570 706f 7274  urrently support
-00018850: 6564 2066 6f72 2060 6b75 7274 6f73 6973  ed for `kurtosis
-00018860: 6020 7768 656e 2075 7369 6e67 2060 7061  ` when using `pa
-00018870: 6e64 6173 203e 3d32 6020 220a 2020 2020  ndas >=2` ".    
-00018880: 2020 2020 2020 2020 2020 2020 6622 2870              f"(p
-00018890: 616e 6461 733d 7b73 7472 2850 414e 4441  andas={str(PANDA
-000188a0: 535f 5645 5253 494f 4e29 7d20 6973 2069  S_VERSION)} is i
-000188b0: 6e73 7461 6c6c 6564 292e 220a 2020 2020  nstalled).".    
-000188c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000188d0: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
-000188e0: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
-000188f0: 7329 0a20 2020 2020 2020 205f 7261 6973  s).        _rais
-00018900: 655f 6966 5f6f 626a 6563 745f 7365 7269  e_if_object_seri
-00018910: 6573 2873 656c 662c 2022 6b75 7274 6f73  es(self, "kurtos
-00018920: 6973 2229 0a20 2020 2020 2020 206d 6574  is").        met
-00018930: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
-00018940: 6f6e 656d 7074 792e 6b75 7274 6f73 6973  onempty.kurtosis
-00018950: 2829 0a20 2020 2020 2020 2069 6620 6178  ().        if ax
-00018960: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
-00018970: 2020 2020 2072 6573 756c 7420 3d20 6d61       result = ma
-00018980: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-00018990: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
-000189a0: 6b75 7274 6f73 6973 2c0a 2020 2020 2020  kurtosis,.      
-000189b0: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-000189c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000189d0: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
-000189e0: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
-000189f0: 3d73 656c 662e 5f74 6f6b 656e 5f70 7265  =self._token_pre
-00018a00: 6669 7820 2b20 226b 7572 746f 7369 7322  fix + "kurtosis"
-00018a10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00018a20: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
-00018a30: 2020 2020 2020 2020 2020 2020 2065 6e66               enf
-00018a40: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-00018a50: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00018a60: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-00018a70: 6574 7572 6e20 6861 6e64 6c65 5f6f 7574  eturn handle_out
-00018a80: 286f 7574 2c20 7265 7375 6c74 290a 2020  (out, result).  
-00018a90: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00018aa0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00018ab0: 6e64 696d 203d 3d20 313a 0a20 2020 2020  ndim == 1:.     
-00018ac0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00018ad0: 7420 3d20 7365 6c66 2e5f 6b75 7274 6f73  t = self._kurtos
-00018ae0: 6973 5f31 6428 0a20 2020 2020 2020 2020  is_1d(.         
-00018af0: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-00018b00: 2066 6973 6865 723d 6669 7368 6572 2c20   fisher=fisher, 
-00018b10: 6269 6173 3d62 6961 732c 206e 616e 5f70  bias=bias, nan_p
-00018b20: 6f6c 6963 793d 6e61 6e5f 706f 6c69 6379  olicy=nan_policy
-00018b30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018b40: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00018b50: 2020 2072 6574 7572 6e20 6861 6e64 6c65     return handle
-00018b60: 5f6f 7574 286f 7574 2c20 7265 7375 6c74  _out(out, result
-00018b70: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00018b80: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00018b90: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
-00018ba0: 662e 5f6b 7572 746f 7369 735f 6e75 6d65  f._kurtosis_nume
-00018bb0: 7269 6328 0a20 2020 2020 2020 2020 2020  ric(.           
-00018bc0: 2020 2020 2020 2020 2066 6973 6865 723d           fisher=
-00018bd0: 6669 7368 6572 2c20 6269 6173 3d62 6961  fisher, bias=bia
-00018be0: 732c 206e 616e 5f70 6f6c 6963 793d 6e61  s, nan_policy=na
-00018bf0: 6e5f 706f 6c69 6379 0a20 2020 2020 2020  n_policy.       
-00018c00: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00018c10: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00018c20: 7461 6e63 6528 7365 6c66 2c20 4461 7461  tance(self, Data
-00018c30: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
-00018c40: 2020 2020 2020 2020 7265 7375 6c74 2e64          result.d
-00018c50: 6976 6973 696f 6e73 203d 2028 7365 6c66  ivisions = (self
-00018c60: 2e63 6f6c 756d 6e73 2e6d 696e 2829 2c20  .columns.min(), 
-00018c70: 7365 6c66 2e63 6f6c 756d 6e73 2e6d 6178  self.columns.max
-00018c80: 2829 290a 0a20 2020 2020 2020 2020 2020  ())..           
-00018c90: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
-00018ca0: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
-00018cb0: 0a20 2020 2064 6566 205f 6b75 7274 6f73  .    def _kurtos
-00018cc0: 6973 5f31 6428 7365 6c66 2c20 636f 6c75  is_1d(self, colu
-00018cd0: 6d6e 2c20 6669 7368 6572 3d54 7275 652c  mn, fisher=True,
-00018ce0: 2062 6961 733d 5472 7565 2c20 6e61 6e5f   bias=True, nan_
-00018cf0: 706f 6c69 6379 3d22 7072 6f70 6167 6174  policy="propagat
-00018d00: 6522 293a 0a20 2020 2020 2020 2022 2222  e"):.        """
-00018d10: 3144 2076 6572 7369 6f6e 206f 6620 7468  1D version of th
-00018d20: 6520 6b75 7274 6f73 6973 2063 616c 6375  e kurtosis calcu
-00018d30: 6c61 7469 6f6e 2e0a 0a20 2020 2020 2020  lation...       
-00018d40: 2055 7365 7320 7468 6520 6172 7261 7920   Uses the array 
-00018d50: 7665 7273 696f 6e20 6672 6f6d 2064 612e  version from da.
-00018d60: 7374 6174 7320 696e 2063 6173 6520 7765  stats in case we
-00018d70: 2061 7265 2070 6173 7369 6e67 2069 6e20   are passing in 
-00018d80: 6120 7369 6e67 6c65 2073 6572 6965 730a  a single series.
-00018d90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00018da0: 2020 2020 2320 696d 706f 7274 2064 6570      # import dep
-00018db0: 656e 6473 206f 6e20 7363 6970 792c 206e  ends on scipy, n
-00018dc0: 6f74 2069 6e73 7461 6c6c 6564 2062 7920  ot installed by 
-00018dd0: 6465 6661 756c 740a 2020 2020 2020 2020  default.        
-00018de0: 6672 6f6d 2064 6173 6b2e 6172 7261 7920  from dask.array 
-00018df0: 696d 706f 7274 2073 7461 7473 2061 7320  import stats as 
-00018e00: 6461 5f73 7461 7473 0a0a 2020 2020 2020  da_stats..      
-00018e10: 2020 6966 2070 642e 6170 692e 7479 7065    if pd.api.type
-00018e20: 732e 6973 5f69 6e74 6567 6572 5f64 7479  s.is_integer_dty
-00018e30: 7065 2863 6f6c 756d 6e2e 5f6d 6574 615f  pe(column._meta_
-00018e40: 6e6f 6e65 6d70 7479 293a 0a20 2020 2020  nonempty):.     
-00018e50: 2020 2020 2020 2063 6f6c 756d 6e20 3d20         column = 
-00018e60: 636f 6c75 6d6e 2e61 7374 7970 6528 2266  column.astype("f
-00018e70: 3822 290a 0a20 2020 2020 2020 2069 6620  8")..        if 
-00018e80: 6e6f 7420 6e70 2e69 7373 7562 6474 7970  not np.issubdtyp
-00018e90: 6528 636f 6c75 6d6e 2e64 7479 7065 2c20  e(column.dtype, 
-00018ea0: 6e70 2e6e 756d 6265 7229 3a0a 2020 2020  np.number):.    
-00018eb0: 2020 2020 2020 2020 636f 6c75 6d6e 203d          column =
-00018ec0: 2063 6f6c 756d 6e2e 6173 7479 7065 2822   column.astype("
-00018ed0: 6638 2229 0a0a 2020 2020 2020 2020 6e61  f8")..        na
-00018ee0: 6d65 203d 2073 656c 662e 5f74 6f6b 656e  me = self._token
-00018ef0: 5f70 7265 6669 7820 2b20 226b 7572 746f  _prefix + "kurto
-00018f00: 7369 732d 3164 2d22 202b 2074 6f6b 656e  sis-1d-" + token
-00018f10: 697a 6528 636f 6c75 6d6e 290a 0a20 2020  ize(column)..   
-00018f20: 2020 2020 2061 7272 6179 5f6b 7572 746f       array_kurto
-00018f30: 7369 7320 3d20 6461 5f73 7461 7473 2e6b  sis = da_stats.k
-00018f40: 7572 746f 7369 7328 0a20 2020 2020 2020  urtosis(.       
-00018f50: 2020 2020 2063 6f6c 756d 6e2e 7661 6c75       column.valu
-00018f60: 6573 2c20 6178 6973 3d30 2c20 6669 7368  es, axis=0, fish
-00018f70: 6572 3d66 6973 6865 722c 2062 6961 733d  er=fisher, bias=
-00018f80: 6269 6173 2c20 6e61 6e5f 706f 6c69 6379  bias, nan_policy
-00018f90: 3d6e 616e 5f70 6f6c 6963 790a 2020 2020  =nan_policy.    
-00018fa0: 2020 2020 290a 0a20 2020 2020 2020 206c      )..        l
-00018fb0: 6179 6572 203d 207b 0a20 2020 2020 2020  ayer = {.       
-00018fc0: 2020 2020 2028 6e61 6d65 2c20 3029 3a20       (name, 0): 
-00018fd0: 286d 6574 686f 6473 2e77 7261 705f 6b75  (methods.wrap_ku
-00018fe0: 7274 6f73 6973 5f72 6564 7563 7469 6f6e  rtosis_reduction
-00018ff0: 2c20 2861 7272 6179 5f6b 7572 746f 7369  , (array_kurtosi
-00019000: 732e 5f6e 616d 652c 292c 204e 6f6e 6529  s._name,), None)
-00019010: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-00019020: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-00019030: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-00019040: 6f6c 6c65 6374 696f 6e73 280a 2020 2020  ollections(.    
-00019050: 2020 2020 2020 2020 6e61 6d65 2c20 6c61          name, la
-00019060: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
-00019070: 733d 5b61 7272 6179 5f6b 7572 746f 7369  s=[array_kurtosi
-00019080: 735d 0a20 2020 2020 2020 2029 0a0a 2020  s].        )..  
-00019090: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-000190a0: 5f64 645f 6f62 6a65 6374 280a 2020 2020  _dd_object(.    
-000190b0: 2020 2020 2020 2020 6772 6170 682c 206e          graph, n
-000190c0: 616d 652c 2063 6f6c 756d 6e2e 5f6d 6574  ame, column._met
-000190d0: 615f 6e6f 6e65 6d70 7479 2e6b 7572 746f  a_nonempty.kurto
-000190e0: 7369 7328 292c 2064 6976 6973 696f 6e73  sis(), divisions
-000190f0: 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d0a 2020  =[None, None].  
-00019100: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00019110: 205f 6b75 7274 6f73 6973 5f6e 756d 6572   _kurtosis_numer
-00019120: 6963 2873 656c 662c 2066 6973 6865 723d  ic(self, fisher=
-00019130: 5472 7565 2c20 6269 6173 3d54 7275 652c  True, bias=True,
-00019140: 206e 616e 5f70 6f6c 6963 793d 2270 726f   nan_policy="pro
-00019150: 7061 6761 7465 2229 3a0a 2020 2020 2020  pagate"):.      
-00019160: 2020 2222 224d 6574 686f 6420 666f 7220    """Method for 
-00019170: 6461 7461 6672 616d 6573 2077 6974 6820  dataframes with 
-00019180: 6e75 6d65 7269 6320 636f 6c75 6d6e 732e  numeric columns.
-00019190: 0a0a 2020 2020 2020 2020 4d61 7073 2074  ..        Maps t
-000191a0: 6865 2061 7272 6179 2076 6572 7369 6f6e  he array version
-000191b0: 2066 726f 6d20 6461 2e73 7461 7473 206f   from da.stats o
-000191c0: 6e74 6f20 7468 6520 6e75 6d65 7269 6320  nto the numeric 
-000191d0: 6172 7261 7920 6f66 2063 6f6c 756d 6e73  array of columns
-000191e0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000191f0: 2020 2020 2020 2320 696d 706f 7274 2064        # import d
-00019200: 6570 656e 6473 206f 6e20 7363 6970 792c  epends on scipy,
-00019210: 206e 6f74 2069 6e73 7461 6c6c 6564 2062   not installed b
-00019220: 7920 6465 6661 756c 740a 2020 2020 2020  y default.      
-00019230: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-00019240: 7920 696d 706f 7274 2073 7461 7473 2061  y import stats a
-00019250: 7320 6461 5f73 7461 7473 0a0a 2020 2020  s da_stats..    
-00019260: 2020 2020 6e75 6d20 3d20 7365 6c66 2e73      num = self.s
-00019270: 656c 6563 745f 6474 7970 6573 2869 6e63  elect_dtypes(inc
-00019280: 6c75 6465 3d5b 226e 756d 6265 7222 2c20  lude=["number", 
-00019290: 2262 6f6f 6c22 5d2c 2065 7863 6c75 6465  "bool"], exclude
-000192a0: 3d5b 6e70 2e74 696d 6564 656c 7461 3634  =[np.timedelta64
-000192b0: 5d29 0a0a 2020 2020 2020 2020 7661 6c75  ])..        valu
-000192c0: 6573 5f64 7479 7065 203d 206e 756d 2e76  es_dtype = num.v
-000192d0: 616c 7565 732e 6474 7970 650a 2020 2020  alues.dtype.    
-000192e0: 2020 2020 6172 7261 795f 7661 6c75 6573      array_values
-000192f0: 203d 206e 756d 2e76 616c 7565 730a 0a20   = num.values.. 
-00019300: 2020 2020 2020 2069 6620 6e6f 7420 6e70         if not np
-00019310: 2e69 7373 7562 6474 7970 6528 7661 6c75  .issubdtype(valu
-00019320: 6573 5f64 7479 7065 2c20 6e70 2e6e 756d  es_dtype, np.num
-00019330: 6265 7229 3a0a 2020 2020 2020 2020 2020  ber):.          
-00019340: 2020 6172 7261 795f 7661 6c75 6573 203d    array_values =
-00019350: 206e 756d 2e76 616c 7565 732e 6173 7479   num.values.asty
-00019360: 7065 2822 6638 2229 0a0a 2020 2020 2020  pe("f8")..      
-00019370: 2020 6172 7261 795f 6b75 7274 6f73 6973    array_kurtosis
-00019380: 203d 2064 615f 7374 6174 732e 6b75 7274   = da_stats.kurt
-00019390: 6f73 6973 280a 2020 2020 2020 2020 2020  osis(.          
-000193a0: 2020 6172 7261 795f 7661 6c75 6573 2c20    array_values, 
-000193b0: 6178 6973 3d30 2c20 6669 7368 6572 3d66  axis=0, fisher=f
-000193c0: 6973 6865 722c 2062 6961 733d 6269 6173  isher, bias=bias
-000193d0: 2c20 6e61 6e5f 706f 6c69 6379 3d6e 616e  , nan_policy=nan
-000193e0: 5f70 6f6c 6963 790a 2020 2020 2020 2020  _policy.        
-000193f0: 290a 0a20 2020 2020 2020 206e 616d 6520  )..        name 
-00019400: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
-00019410: 6566 6978 202b 2022 6b75 7274 6f73 6973  efix + "kurtosis
-00019420: 2d6e 756d 6572 6963 2220 2b20 746f 6b65  -numeric" + toke
-00019430: 6e69 7a65 286e 756d 290a 2020 2020 2020  nize(num).      
-00019440: 2020 636f 6c73 203d 206e 756d 2e5f 6d65    cols = num._me
-00019450: 7461 2e63 6f6c 756d 6e73 2069 6620 6973  ta.columns if is
-00019460: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
-00019470: 6e75 6d29 2065 6c73 6520 4e6f 6e65 0a0a  num) else None..
-00019480: 2020 2020 2020 2020 7769 7468 2063 6865          with che
-00019490: 636b 5f72 6564 7563 7469 6f6e 735f 7275  ck_reductions_ru
-000194a0: 6e74 696d 655f 7761 726e 696e 6728 293a  ntime_warning():
-000194b0: 0a20 2020 2020 2020 2020 2020 206b 7572  .            kur
-000194c0: 746f 7369 735f 7368 6170 6520 3d20 6e75  tosis_shape = nu
-000194d0: 6d2e 5f6d 6574 615f 6e6f 6e65 6d70 7479  m._meta_nonempty
-000194e0: 2e76 6172 2861 7869 733d 3029 2e73 6861  .var(axis=0).sha
-000194f0: 7065 0a20 2020 2020 2020 2061 7272 6179  pe.        array
-00019500: 5f6b 7572 746f 7369 735f 6e61 6d65 203d  _kurtosis_name =
-00019510: 2028 6172 7261 795f 6b75 7274 6f73 6973   (array_kurtosis
-00019520: 2e5f 6e61 6d65 2c29 202b 2028 302c 2920  ._name,) + (0,) 
-00019530: 2a20 6c65 6e28 6b75 7274 6f73 6973 5f73  * len(kurtosis_s
-00019540: 6861 7065 290a 0a20 2020 2020 2020 206c  hape)..        l
-00019550: 6179 6572 203d 207b 0a20 2020 2020 2020  ayer = {.       
-00019560: 2020 2020 2028 6e61 6d65 2c20 3029 3a20       (name, 0): 
-00019570: 286d 6574 686f 6473 2e77 7261 705f 6b75  (methods.wrap_ku
-00019580: 7274 6f73 6973 5f72 6564 7563 7469 6f6e  rtosis_reduction
-00019590: 2c20 6172 7261 795f 6b75 7274 6f73 6973  , array_kurtosis
-000195a0: 5f6e 616d 652c 2063 6f6c 7329 0a20 2020  _name, cols).   
-000195b0: 2020 2020 207d 0a20 2020 2020 2020 2067       }.        g
-000195c0: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-000195d0: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-000195e0: 6374 696f 6e73 280a 2020 2020 2020 2020  ctions(.        
-000195f0: 2020 2020 6e61 6d65 2c20 6c61 7965 722c      name, layer,
-00019600: 2064 6570 656e 6465 6e63 6965 733d 5b61   dependencies=[a
-00019610: 7272 6179 5f6b 7572 746f 7369 735d 0a20  rray_kurtosis]. 
-00019620: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00019630: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
-00019640: 6f62 6a65 6374 280a 2020 2020 2020 2020  object(.        
-00019650: 2020 2020 6772 6170 682c 206e 616d 652c      graph, name,
-00019660: 206e 756d 2e5f 6d65 7461 5f6e 6f6e 656d   num._meta_nonem
-00019670: 7074 792e 6b75 7274 6f73 6973 2829 2c20  pty.kurtosis(), 
-00019680: 6469 7669 7369 6f6e 733d 5b4e 6f6e 652c  divisions=[None,
-00019690: 204e 6f6e 655d 0a20 2020 2020 2020 2029   None].        )
-000196a0: 0a0a 2020 2020 405f 6e75 6d65 7269 635f  ..    @_numeric_
-000196b0: 6f6e 6c79 0a20 2020 2040 6465 7269 7665  only.    @derive
-000196c0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-000196d0: 616d 6529 0a20 2020 2064 6566 2073 656d  ame).    def sem
-000196e0: 2873 656c 662c 2061 7869 733d 4e6f 6e65  (self, axis=None
-000196f0: 2c20 736b 6970 6e61 3d54 7275 652c 2064  , skipna=True, d
-00019700: 646f 663d 312c 2073 706c 6974 5f65 7665  dof=1, split_eve
-00019710: 7279 3d46 616c 7365 2c20 6e75 6d65 7269  ry=False, numeri
-00019720: 635f 6f6e 6c79 3d4e 6f6e 6529 3a0a 2020  c_only=None):.  
-00019730: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
-00019740: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
-00019750: 2861 7869 7329 0a20 2020 2020 2020 205f  (axis).        _
-00019760: 7261 6973 655f 6966 5f6f 626a 6563 745f  raise_if_object_
-00019770: 7365 7269 6573 2873 656c 662c 2022 7365  series(self, "se
-00019780: 6d22 290a 2020 2020 2020 2020 7769 7468  m").        with
-00019790: 2063 6865 636b 5f6e 756d 6572 6963 5f6f   check_numeric_o
-000197a0: 6e6c 795f 6465 7072 6563 6174 696f 6e28  nly_deprecation(
-000197b0: 293a 0a20 2020 2020 2020 2020 2020 206d  ):.            m
-000197c0: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
-000197d0: 5f6e 6f6e 656d 7074 792e 7365 6d28 0a20  _nonempty.sem(. 
-000197e0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000197f0: 7869 733d 6178 6973 2c20 736b 6970 6e61  xis=axis, skipna
-00019800: 3d73 6b69 706e 612c 2064 646f 663d 6464  =skipna, ddof=dd
-00019810: 6f66 2c20 6e75 6d65 7269 635f 6f6e 6c79  of, numeric_only
-00019820: 3d6e 756d 6572 6963 5f6f 6e6c 790a 2020  =numeric_only.  
-00019830: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00019840: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
-00019850: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00019860: 7475 726e 206d 6170 5f70 6172 7469 7469  turn map_partiti
-00019870: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-00019880: 2020 2020 204d 2e73 656d 2c0a 2020 2020       M.sem,.    
-00019890: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000198a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000198b0: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
-000198c0: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
-000198d0: 656e 3d73 656c 662e 5f74 6f6b 656e 5f70  en=self._token_p
-000198e0: 7265 6669 7820 2b20 2273 656d 222c 0a20  refix + "sem",. 
-000198f0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00019900: 7869 733d 6178 6973 2c0a 2020 2020 2020  xis=axis,.      
-00019910: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
-00019920: 3d73 6b69 706e 612c 0a20 2020 2020 2020  =skipna,.       
-00019930: 2020 2020 2020 2020 2064 646f 663d 6464           ddof=dd
-00019940: 6f66 2c0a 2020 2020 2020 2020 2020 2020  of,.            
-00019950: 2020 2020 7061 7265 6e74 5f6d 6574 613d      parent_meta=
-00019960: 7365 6c66 2e5f 6d65 7461 2c0a 2020 2020  self._meta,.    
-00019970: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
-00019980: 7269 635f 6f6e 6c79 3d6e 756d 6572 6963  ric_only=numeric
-00019990: 5f6f 6e6c 792c 0a20 2020 2020 2020 2020  _only,.         
-000199a0: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
-000199b0: 653a 0a20 2020 2020 2020 2020 2020 206e  e:.            n
-000199c0: 756d 203d 2073 656c 662e 5f67 6574 5f6e  um = self._get_n
-000199d0: 756d 6572 6963 5f64 6174 6128 290a 2020  umeric_data().  
-000199e0: 2020 2020 2020 2020 2020 7620 3d20 6e75            v = nu
-000199f0: 6d2e 7661 7228 736b 6970 6e61 3d73 6b69  m.var(skipna=ski
-00019a00: 706e 612c 2064 646f 663d 6464 6f66 2c20  pna, ddof=ddof, 
-00019a10: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00019a20: 745f 6576 6572 7929 0a20 2020 2020 2020  t_every).       
-00019a30: 2020 2020 206e 203d 206e 756d 2e63 6f75       n = num.cou
-00019a40: 6e74 2873 706c 6974 5f65 7665 7279 3d73  nt(split_every=s
-00019a50: 706c 6974 5f65 7665 7279 290a 2020 2020  plit_every).    
-00019a60: 2020 2020 2020 2020 6e61 6d65 203d 2073          name = s
-00019a70: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
-00019a80: 7820 2b20 2273 656d 220a 2020 2020 2020  x + "sem".      
-00019a90: 2020 2020 2020 7265 7375 6c74 203d 206d        result = m
-00019aa0: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-00019ab0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00019ac0: 702e 7371 7274 2c0a 2020 2020 2020 2020  p.sqrt,.        
-00019ad0: 2020 2020 2020 2020 7620 2f20 6e2c 0a20          v / n,. 
-00019ae0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00019af0: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
-00019b00: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
-00019b10: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00019b20: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
-00019b30: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
-00019b40: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00019b50: 7265 6e74 5f6d 6574 613d 7365 6c66 2e5f  rent_meta=self._
-00019b60: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-00019b70: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00019b80: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
-00019b90: 656c 662c 2044 6174 6146 7261 6d65 293a  elf, DataFrame):
-00019ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019bb0: 2072 6573 756c 742e 6469 7669 7369 6f6e   result.division
-00019bc0: 7320 3d20 2873 656c 662e 636f 6c75 6d6e  s = (self.column
-00019bd0: 732e 6d69 6e28 292c 2073 656c 662e 636f  s.min(), self.co
-00019be0: 6c75 6d6e 732e 6d61 7828 2929 0a20 2020  lumns.max()).   
-00019bf0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00019c00: 7265 7375 6c74 0a0a 2020 2020 405f 6e75  result..    @_nu
-00019c10: 6d65 7269 635f 6461 7461 0a20 2020 2064  meric_data.    d
-00019c20: 6566 2071 7561 6e74 696c 6528 7365 6c66  ef quantile(self
-00019c30: 2c20 713d 302e 352c 2061 7869 733d 302c  , q=0.5, axis=0,
-00019c40: 206e 756d 6572 6963 5f6f 6e6c 793d 6e6f   numeric_only=no
-00019c50: 5f64 6566 6175 6c74 2c20 6d65 7468 6f64  _default, method
-00019c60: 3d22 6465 6661 756c 7422 293a 0a20 2020  ="default"):.   
-00019c70: 2020 2020 2022 2222 4170 7072 6f78 696d       """Approxim
-00019c80: 6174 6520 726f 772d 7769 7365 2061 6e64  ate row-wise and
-00019c90: 2070 7265 6369 7365 2063 6f6c 756d 6e2d   precise column-
-00019ca0: 7769 7365 2071 7561 6e74 696c 6573 206f  wise quantiles o
-00019cb0: 6620 4461 7461 4672 616d 650a 0a20 2020  f DataFrame..   
-00019cc0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00019cd0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00019ce0: 2d2d 0a20 2020 2020 2020 2071 203a 206c  --.        q : l
-00019cf0: 6973 742f 6172 7261 7920 6f66 2066 6c6f  ist/array of flo
-00019d00: 6174 732c 2064 6566 6175 6c74 2030 2e35  ats, default 0.5
-00019d10: 2028 3530 2529 0a20 2020 2020 2020 2020   (50%).         
-00019d20: 2020 2049 7465 7261 626c 6520 6f66 206e     Iterable of n
-00019d30: 756d 6265 7273 2072 616e 6769 6e67 2066  umbers ranging f
-00019d40: 726f 6d20 3020 746f 2031 2066 6f72 2074  rom 0 to 1 for t
-00019d50: 6865 2064 6573 6972 6564 2071 7561 6e74  he desired quant
-00019d60: 696c 6573 0a20 2020 2020 2020 2061 7869  iles.        axi
-00019d70: 7320 3a20 7b30 2c20 312c 2027 696e 6465  s : {0, 1, 'inde
-00019d80: 7827 2c20 2763 6f6c 756d 6e73 277d 2028  x', 'columns'} (
-00019d90: 6465 6661 756c 7420 3029 0a20 2020 2020  default 0).     
-00019da0: 2020 2020 2020 2030 206f 7220 2769 6e64         0 or 'ind
-00019db0: 6578 2720 666f 7220 726f 772d 7769 7365  ex' for row-wise
-00019dc0: 2c20 3120 6f72 2027 636f 6c75 6d6e 7327  , 1 or 'columns'
-00019dd0: 2066 6f72 2063 6f6c 756d 6e2d 7769 7365   for column-wise
-00019de0: 0a20 2020 2020 2020 206d 6574 686f 6420  .        method 
-00019df0: 3a20 7b27 6465 6661 756c 7427 2c20 2774  : {'default', 't
-00019e00: 6469 6765 7374 272c 2027 6461 736b 277d  digest', 'dask'}
-00019e10: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00019e20: 2020 2020 2020 2057 6861 7420 6d65 7468         What meth
-00019e30: 6f64 2074 6f20 7573 652e 2042 7920 6465  od to use. By de
-00019e40: 6661 756c 7420 7769 6c6c 2075 7365 2064  fault will use d
-00019e50: 6173 6b27 7320 696e 7465 726e 616c 2063  ask's internal c
-00019e60: 7573 746f 6d0a 2020 2020 2020 2020 2020  ustom.          
-00019e70: 2020 616c 676f 7269 7468 6d20 2860 6027    algorithm (``'
-00019e80: 6461 736b 2760 6029 2e20 2049 6620 7365  dask'``).  If se
-00019e90: 7420 746f 2060 6027 7464 6967 6573 7427  t to ``'tdigest'
-00019ea0: 6060 2077 696c 6c20 7573 6520 7464 6967  `` will use tdig
-00019eb0: 6573 740a 2020 2020 2020 2020 2020 2020  est.            
-00019ec0: 666f 7220 666c 6f61 7473 2061 6e64 2069  for floats and i
-00019ed0: 6e74 7320 616e 6420 6661 6c6c 6261 636b  nts and fallback
-00019ee0: 2074 6f20 7468 6520 6060 2764 6173 6b27   to the ``'dask'
-00019ef0: 6060 206f 7468 6572 7769 7365 2e0a 2020  `` otherwise..  
-00019f00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00019f10: 2020 6e75 6d65 7269 635f 6b77 6172 6773    numeric_kwargs
-00019f20: 203d 205f 6e75 6d65 7269 635f 6f6e 6c79   = _numeric_only
-00019f30: 5f6d 6179 6265 5f77 6172 6e28 7365 6c66  _maybe_warn(self
-00019f40: 2c20 6e75 6d65 7269 635f 6f6e 6c79 2c20  , numeric_only, 
-00019f50: 6465 6661 756c 743d 5472 7565 290a 0a20  default=True).. 
-00019f60: 2020 2020 2020 2061 7869 7320 3d20 7365         axis = se
-00019f70: 6c66 2e5f 7661 6c69 6461 7465 5f61 7869  lf._validate_axi
-00019f80: 7328 6178 6973 290a 2020 2020 2020 2020  s(axis).        
-00019f90: 6b65 796e 616d 6520 3d20 2271 7561 6e74  keyname = "quant
-00019fa0: 696c 6573 2d63 6f6e 6361 742d 2d22 202b  iles-concat--" +
-00019fb0: 2074 6f6b 656e 697a 6528 7365 6c66 2c20   tokenize(self, 
-00019fc0: 712c 2061 7869 7329 0a0a 2020 2020 2020  q, axis)..      
-00019fd0: 2020 7769 7468 2063 6865 636b 5f6e 756d    with check_num
-00019fe0: 6572 6963 5f6f 6e6c 795f 6465 7072 6563  eric_only_deprec
-00019ff0: 6174 696f 6e28 293a 0a20 2020 2020 2020  ation():.       
-0001a000: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
-0001a010: 2e5f 6d65 7461 2e71 7561 6e74 696c 6528  ._meta.quantile(
-0001a020: 712c 2061 7869 733d 6178 6973 2c20 2a2a  q, axis=axis, **
-0001a030: 6e75 6d65 7269 635f 6b77 6172 6773 290a  numeric_kwargs).
-0001a040: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
-0001a050: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
-0001a060: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0001a070: 2871 2c20 6c69 7374 293a 0a20 2020 2020  (q, list):.     
-0001a080: 2020 2020 2020 2020 2020 2023 204e 6f74             # Not
-0001a090: 2073 7570 706f 7274 6564 2c20 7468 6520   supported, the 
-0001a0a0: 7265 7375 6c74 2077 696c 6c20 6861 7665  result will have
-0001a0b0: 2063 7572 7265 6e74 2069 6e64 6578 2061   current index a
-0001a0c0: 7320 636f 6c75 6d6e 730a 2020 2020 2020  s columns.      
-0001a0d0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001a0e0: 5661 6c75 6545 7272 6f72 2822 2771 2720  ValueError("'q' 
-0001a0f0: 6d75 7374 2062 6520 7363 616c 6172 2077  must be scalar w
-0001a100: 6865 6e20 6178 6973 3d31 2069 7320 7370  hen axis=1 is sp
-0001a110: 6563 6966 6965 6422 290a 0a20 2020 2020  ecified")..     
-0001a120: 2020 2020 2020 2072 6574 7572 6e20 6d61         return ma
-0001a130: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-0001a140: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
-0001a150: 7175 616e 7469 6c65 2c0a 2020 2020 2020  quantile,.      
-0001a160: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-0001a170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a180: 712c 0a20 2020 2020 2020 2020 2020 2020  q,.             
-0001a190: 2020 2061 7869 732c 0a20 2020 2020 2020     axis,.       
-0001a1a0: 2020 2020 2020 2020 2074 6f6b 656e 3d6b           token=k
-0001a1b0: 6579 6e61 6d65 2c0a 2020 2020 2020 2020  eyname,.        
-0001a1c0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
-0001a1d0: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
-0001a1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a1f0: 2a2a 6e75 6d65 7269 635f 6b77 6172 6773  **numeric_kwargs
-0001a200: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001a210: 2020 6d65 7461 3d28 712c 2022 6638 2229    meta=(q, "f8")
-0001a220: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001a230: 2020 7061 7265 6e74 5f6d 6574 613d 7365    parent_meta=se
-0001a240: 6c66 2e5f 6d65 7461 2c0a 2020 2020 2020  lf._meta,.      
-0001a250: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001a260: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001a270: 2020 5f72 6169 7365 5f69 665f 6f62 6a65    _raise_if_obje
-0001a280: 6374 5f73 6572 6965 7328 7365 6c66 2c20  ct_series(self, 
-0001a290: 2271 7561 6e74 696c 6522 290a 2020 2020  "quantile").    
-0001a2a0: 2020 2020 2020 2020 6e75 6d20 3d20 7365          num = se
-0001a2b0: 6c66 2e5f 6765 745f 6e75 6d65 7269 635f  lf._get_numeric_
-0001a2c0: 6461 7461 2829 0a20 2020 2020 2020 2020  data().         
-0001a2d0: 2020 2071 7561 6e74 696c 6573 203d 2074     quantiles = t
-0001a2e0: 7570 6c65 2871 7561 6e74 696c 6528 7365  uple(quantile(se
-0001a2f0: 6c66 5b63 5d2c 2071 2c20 6d65 7468 6f64  lf[c], q, method
-0001a300: 2920 666f 7220 6320 696e 206e 756d 2e63  ) for c in num.c
-0001a310: 6f6c 756d 6e73 290a 0a20 2020 2020 2020  olumns)..       
-0001a320: 2020 2020 2071 6e61 6d65 7320 3d20 5b28       qnames = [(
-0001a330: 5f71 2e5f 6e61 6d65 2c20 3029 2066 6f72  _q._name, 0) for
-0001a340: 205f 7120 696e 2071 7561 6e74 696c 6573   _q in quantiles
-0001a350: 5d0a 0a20 2020 2020 2020 2020 2020 2069  ]..            i
-0001a360: 6620 6973 696e 7374 616e 6365 2871 7561  f isinstance(qua
-0001a370: 6e74 696c 6573 5b30 5d2c 2053 6361 6c61  ntiles[0], Scala
-0001a380: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-0001a390: 2020 2020 6c61 7965 7220 3d20 7b0a 2020      layer = {.  
-0001a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a3b0: 2020 286b 6579 6e61 6d65 2c20 3029 3a20    (keyname, 0): 
-0001a3c0: 2874 7970 6528 6d65 7461 292c 2071 6e61  (type(meta), qna
-0001a3d0: 6d65 732c 206e 756d 2e63 6f6c 756d 6e73  mes, num.columns
-0001a3e0: 2c20 4e6f 6e65 2c20 6d65 7461 2e6e 616d  , None, meta.nam
-0001a3f0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-0001a400: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-0001a410: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
-0001a420: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-0001a430: 5f63 6f6c 6c65 6374 696f 6e73 280a 2020  _collections(.  
-0001a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a450: 2020 6b65 796e 616d 652c 206c 6179 6572    keyname, layer
-0001a460: 2c20 6465 7065 6e64 656e 6369 6573 3d71  , dependencies=q
-0001a470: 7561 6e74 696c 6573 0a20 2020 2020 2020  uantiles.       
-0001a480: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001a490: 2020 2020 2020 2020 2020 2064 6976 6973             divis
-0001a4a0: 696f 6e73 203d 2028 6d69 6e28 6e75 6d2e  ions = (min(num.
-0001a4b0: 636f 6c75 6d6e 7329 2c20 6d61 7828 6e75  columns), max(nu
-0001a4c0: 6d2e 636f 6c75 6d6e 7329 290a 2020 2020  m.columns)).    
-0001a4d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001a4e0: 726e 2053 6572 6965 7328 6772 6170 682c  rn Series(graph,
-0001a4f0: 206b 6579 6e61 6d65 2c20 6d65 7461 2c20   keyname, meta, 
-0001a500: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
-0001a510: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001a520: 2020 2020 2020 2020 2020 2020 206c 6179               lay
-0001a530: 6572 203d 207b 286b 6579 6e61 6d65 2c20  er = {(keyname, 
-0001a540: 3029 3a20 286d 6574 686f 6473 2e63 6f6e  0): (methods.con
-0001a550: 6361 742c 2071 6e61 6d65 732c 2031 297d  cat, qnames, 1)}
-0001a560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a570: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-0001a580: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-0001a590: 6c65 6374 696f 6e73 280a 2020 2020 2020  lections(.      
-0001a5a0: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-0001a5b0: 796e 616d 652c 206c 6179 6572 2c20 6465  yname, layer, de
-0001a5c0: 7065 6e64 656e 6369 6573 3d71 7561 6e74  pendencies=quant
-0001a5d0: 696c 6573 0a20 2020 2020 2020 2020 2020  iles.           
-0001a5e0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0001a5f0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-0001a600: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
-0001a610: 682c 206b 6579 6e61 6d65 2c20 6d65 7461  h, keyname, meta
-0001a620: 2c20 7175 616e 7469 6c65 735b 305d 2e64  , quantiles[0].d
-0001a630: 6976 6973 696f 6e73 290a 0a20 2020 2040  ivisions)..    @
-0001a640: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0001a650: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0001a660: 6566 2064 6573 6372 6962 6528 0a20 2020  ef describe(.   
-0001a670: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0001a680: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
-0001a690: 616c 7365 2c0a 2020 2020 2020 2020 7065  alse,.        pe
-0001a6a0: 7263 656e 7469 6c65 733d 4e6f 6e65 2c0a  rcentiles=None,.
-0001a6b0: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
-0001a6c0: 6c65 735f 6d65 7468 6f64 3d22 6465 6661  les_method="defa
-0001a6d0: 756c 7422 2c0a 2020 2020 2020 2020 696e  ult",.        in
-0001a6e0: 636c 7564 653d 4e6f 6e65 2c0a 2020 2020  clude=None,.    
-0001a6f0: 2020 2020 6578 636c 7564 653d 4e6f 6e65      exclude=None
-0001a700: 2c0a 2020 2020 2020 2020 6461 7465 7469  ,.        dateti
-0001a710: 6d65 5f69 735f 6e75 6d65 7269 633d 6e6f  me_is_numeric=no
-0001a720: 5f64 6566 6175 6c74 2c0a 2020 2020 293a  _default,.    ):
-0001a730: 0a20 2020 2020 2020 2069 6620 5041 4e44  .        if PAND
-0001a740: 4153 5f47 545f 3230 303a 0a20 2020 2020  AS_GT_200:.     
-0001a750: 2020 2020 2020 2069 6620 6461 7465 7469         if dateti
-0001a760: 6d65 5f69 735f 6e75 6d65 7269 6320 6973  me_is_numeric is
-0001a770: 206e 6f5f 6465 6661 756c 743a 0a20 2020   no_default:.   
-0001a780: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-0001a790: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
-0001a7a0: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
-0001a7b0: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
-0001a7c0: 5f69 735f 6e75 6d65 7269 635f 6b77 6172  _is_numeric_kwar
-0001a7d0: 6720 3d20 7b7d 0a20 2020 2020 2020 2020  g = {}.         
-0001a7e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001a7f0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0001a800: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
-0001a810: 2020 2020 2020 2020 2020 2020 2020 2264                "d
-0001a820: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
-0001a830: 6963 2069 7320 7265 6d6f 7665 6420 696e  ic is removed in
-0001a840: 2070 616e 6461 733e 3d32 2e30 2e30 2c20   pandas>=2.0.0, 
-0001a850: 6461 7465 7469 6d65 2064 6174 6120 7769  datetime data wi
-0001a860: 6c6c 2061 6c77 6179 7320 6265 2022 0a20  ll always be ". 
-0001a870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a880: 2020 2022 7375 6d6d 6172 697a 6564 2061     "summarized a
-0001a890: 7320 6e75 6d65 7269 6322 0a20 2020 2020  s numeric".     
-0001a8a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001a8b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001a8c0: 2020 2020 2020 2064 6174 6574 696d 655f         datetime_
-0001a8d0: 6973 5f6e 756d 6572 6963 203d 2028 0a20  is_numeric = (. 
-0001a8e0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-0001a8f0: 616c 7365 2069 6620 6461 7465 7469 6d65  alse if datetime
-0001a900: 5f69 735f 6e75 6d65 7269 6320 6973 206e  _is_numeric is n
-0001a910: 6f5f 6465 6661 756c 7420 656c 7365 2064  o_default else d
-0001a920: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
-0001a930: 6963 0a20 2020 2020 2020 2020 2020 2029  ic.            )
-0001a940: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-0001a950: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
-0001a960: 5f6b 7761 7267 203d 207b 2264 6174 6574  _kwarg = {"datet
-0001a970: 696d 655f 6973 5f6e 756d 6572 6963 223a  ime_is_numeric":
-0001a980: 2064 6174 6574 696d 655f 6973 5f6e 756d   datetime_is_num
-0001a990: 6572 6963 7d0a 0a20 2020 2020 2020 2069  eric}..        i
-0001a9a0: 6620 7365 6c66 2e5f 6d65 7461 2e6e 6469  f self._meta.ndi
-0001a9b0: 6d20 3d3d 2031 3a0a 2020 2020 2020 2020  m == 1:.        
-0001a9c0: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
-0001a9d0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e64  _meta_nonempty.d
-0001a9e0: 6573 6372 6962 6528 0a20 2020 2020 2020  escribe(.       
-0001a9f0: 2020 2020 2020 2020 2070 6572 6365 6e74           percent
-0001aa00: 696c 6573 3d70 6572 6365 6e74 696c 6573  iles=percentiles
-0001aa10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001aa20: 2020 696e 636c 7564 653d 696e 636c 7564    include=includ
-0001aa30: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0001aa40: 2020 2065 7863 6c75 6465 3d65 7863 6c75     exclude=exclu
-0001aa50: 6465 2c0a 2020 2020 2020 2020 2020 2020  de,.            
-0001aa60: 2020 2020 2a2a 6461 7465 7469 6d65 5f69      **datetime_i
-0001aa70: 735f 6e75 6d65 7269 635f 6b77 6172 672c  s_numeric_kwarg,
-0001aa80: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001aa90: 2020 2020 2020 2020 2020 206f 7574 7075             outpu
-0001aaa0: 7420 3d20 7365 6c66 2e5f 6465 7363 7269  t = self._descri
-0001aab0: 6265 5f31 6428 0a20 2020 2020 2020 2020  be_1d(.         
-0001aac0: 2020 2020 2020 2073 656c 662c 2073 706c         self, spl
-0001aad0: 6974 5f65 7665 7279 2c20 7065 7263 656e  it_every, percen
-0001aae0: 7469 6c65 732c 2070 6572 6365 6e74 696c  tiles, percentil
-0001aaf0: 6573 5f6d 6574 686f 642c 2064 6174 6574  es_method, datet
-0001ab00: 696d 655f 6973 5f6e 756d 6572 6963 0a20  ime_is_numeric. 
-0001ab10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001ab20: 2020 2020 2020 2020 206f 7574 7075 742e           output.
-0001ab30: 5f6d 6574 6120 3d20 6d65 7461 0a20 2020  _meta = meta.   
-0001ab40: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001ab50: 6f75 7470 7574 0a20 2020 2020 2020 2065  output.        e
-0001ab60: 6c69 6620 2869 6e63 6c75 6465 2069 7320  lif (include is 
-0001ab70: 4e6f 6e65 2920 616e 6420 2865 7863 6c75  None) and (exclu
-0001ab80: 6465 2069 7320 4e6f 6e65 293a 0a20 2020  de is None):.   
-0001ab90: 2020 2020 2020 2020 205f 696e 636c 7564           _includ
-0001aba0: 6520 3d20 5b6e 702e 6e75 6d62 6572 2c20  e = [np.number, 
-0001abb0: 6e70 2e74 696d 6564 656c 7461 3634 5d0a  np.timedelta64].
-0001abc0: 2020 2020 2020 2020 2020 2020 6966 2064              if d
-0001abd0: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
-0001abe0: 6963 3a0a 2020 2020 2020 2020 2020 2020  ic:.            
-0001abf0: 2020 2020 5f69 6e63 6c75 6465 2e61 7070      _include.app
-0001ac00: 656e 6428 6e70 2e64 6174 6574 696d 6536  end(np.datetime6
-0001ac10: 3429 0a20 2020 2020 2020 2020 2020 2064  4).            d
-0001ac20: 6174 6120 3d20 7365 6c66 2e5f 6d65 7461  ata = self._meta
-0001ac30: 2e73 656c 6563 745f 6474 7970 6573 2869  .select_dtypes(i
-0001ac40: 6e63 6c75 6465 3d5f 696e 636c 7564 6529  nclude=_include)
-0001ac50: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0001ac60: 7768 656e 2073 6f6d 6520 6e75 6d65 7269  when some numeri
-0001ac70: 6373 2f74 696d 6564 656c 7461 7320 6172  cs/timedeltas ar
-0001ac80: 6520 666f 756e 642c 2062 7920 6465 6661  e found, by defa
-0001ac90: 756c 7420 6b65 6570 2074 6865 6d0a 2020  ult keep them.  
-0001aca0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-0001acb0: 2864 6174 612e 636f 6c75 6d6e 7329 203d  (data.columns) =
-0001acc0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0001acd0: 2020 2020 2063 686f 7365 6e5f 636f 6c75       chosen_colu
-0001ace0: 6d6e 7320 3d20 7365 6c66 2e5f 6d65 7461  mns = self._meta
-0001acf0: 2e63 6f6c 756d 6e73 0a20 2020 2020 2020  .columns.       
-0001ad00: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001ad10: 2020 2020 2020 2020 2020 2023 2063 6865             # che
-0001ad20: 636b 2069 6620 7468 6572 6520 6172 6520  ck if there are 
-0001ad30: 7469 6d65 6465 6c74 612c 2062 6f6f 6c65  timedelta, boole
-0001ad40: 616e 2c20 6f72 2064 6174 6574 696d 6520  an, or datetime 
-0001ad50: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
-0001ad60: 2020 2020 2020 2020 5f69 6e63 6c75 6465          _include
-0001ad70: 203d 205b 6e70 2e74 696d 6564 656c 7461   = [np.timedelta
-0001ad80: 3634 2c20 626f 6f6c 5d0a 2020 2020 2020  64, bool].      
-0001ad90: 2020 2020 2020 2020 2020 6966 2064 6174            if dat
-0001ada0: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
-0001adb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001adc0: 2020 2020 2020 5f69 6e63 6c75 6465 2e61        _include.a
-0001add0: 7070 656e 6428 6e70 2e64 6174 6574 696d  ppend(np.datetim
-0001ade0: 6536 3429 0a20 2020 2020 2020 2020 2020  e64).           
-0001adf0: 2020 2020 2062 6f6f 6c73 5f61 6e64 5f74       bools_and_t
-0001ae00: 696d 6573 203d 2073 656c 662e 5f6d 6574  imes = self._met
-0001ae10: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
-0001ae20: 696e 636c 7564 653d 5f69 6e63 6c75 6465  include=_include
-0001ae30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001ae40: 2020 6966 206c 656e 2862 6f6f 6c73 5f61    if len(bools_a
-0001ae50: 6e64 5f74 696d 6573 2e63 6f6c 756d 6e73  nd_times.columns
-0001ae60: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
-0001ae70: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001ae80: 726e 2073 656c 662e 5f64 6573 6372 6962  rn self._describ
-0001ae90: 655f 6e75 6d65 7269 6328 0a20 2020 2020  e_numeric(.     
-0001aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aeb0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0001aec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aed0: 2073 706c 6974 5f65 7665 7279 2c0a 2020   split_every,.  
-0001aee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aef0: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
-0001af00: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0001af10: 2020 2020 2020 2020 2020 2070 6572 6365             perce
-0001af20: 6e74 696c 6573 5f6d 6574 686f 642c 0a20  ntiles_method,. 
-0001af30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af40: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001af50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001af60: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001af70: 686f 7365 6e5f 636f 6c75 6d6e 7320 3d20  hosen_columns = 
-0001af80: 6461 7461 2e63 6f6c 756d 6e73 0a20 2020  data.columns.   
-0001af90: 2020 2020 2065 6c69 6620 696e 636c 7564       elif includ
-0001afa0: 6520 3d3d 2022 616c 6c22 3a0a 2020 2020  e == "all":.    
-0001afb0: 2020 2020 2020 2020 6966 2065 7863 6c75          if exclu
-0001afc0: 6465 2069 7320 6e6f 7420 4e6f 6e65 3a0a  de is not None:.
-0001afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001afe0: 6d73 6720 3d20 2265 7863 6c75 6465 206d  msg = "exclude m
-0001aff0: 7573 7420 6265 204e 6f6e 6520 7768 656e  ust be None when
-0001b000: 2069 6e63 6c75 6465 2069 7320 2761 6c6c   include is 'all
-0001b010: 2722 0a20 2020 2020 2020 2020 2020 2020  '".             
-0001b020: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0001b030: 726f 7228 6d73 6729 0a20 2020 2020 2020  ror(msg).       
-0001b040: 2020 2020 2063 686f 7365 6e5f 636f 6c75       chosen_colu
-0001b050: 6d6e 7320 3d20 7365 6c66 2e5f 6d65 7461  mns = self._meta
-0001b060: 2e63 6f6c 756d 6e73 0a20 2020 2020 2020  .columns.       
-0001b070: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001b080: 2020 2063 686f 7365 6e5f 636f 6c75 6d6e     chosen_column
-0001b090: 7320 3d20 7365 6c66 2e5f 6d65 7461 2e73  s = self._meta.s
-0001b0a0: 656c 6563 745f 6474 7970 6573 2869 6e63  elect_dtypes(inc
-0001b0b0: 6c75 6465 3d69 6e63 6c75 6465 2c20 6578  lude=include, ex
-0001b0c0: 636c 7564 653d 6578 636c 7564 6529 0a0a  clude=exclude)..
-0001b0d0: 2020 2020 2020 2020 7374 6174 7320 3d20          stats = 
-0001b0e0: 5b0a 2020 2020 2020 2020 2020 2020 7365  [.            se
-0001b0f0: 6c66 2e5f 6465 7363 7269 6265 5f31 6428  lf._describe_1d(
-0001b100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b110: 2073 656c 665b 636f 6c5f 6964 785d 2c0a   self[col_idx],.
-0001b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b130: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
-0001b140: 2020 2020 2020 2020 2020 2020 2070 6572               per
-0001b150: 6365 6e74 696c 6573 2c0a 2020 2020 2020  centiles,.      
-0001b160: 2020 2020 2020 2020 2020 7065 7263 656e            percen
-0001b170: 7469 6c65 735f 6d65 7468 6f64 2c0a 2020  tiles_method,.  
-0001b180: 2020 2020 2020 2020 2020 2020 2020 6461                da
-0001b190: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
-0001b1a0: 632c 0a20 2020 2020 2020 2020 2020 2029  c,.            )
-0001b1b0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0001b1c0: 2063 6f6c 5f69 6478 2069 6e20 6368 6f73   col_idx in chos
-0001b1d0: 656e 5f63 6f6c 756d 6e73 0a20 2020 2020  en_columns.     
-0001b1e0: 2020 205d 0a20 2020 2020 2020 2073 7461     ].        sta
-0001b1f0: 7473 5f6e 616d 6573 203d 205b 2873 2e5f  ts_names = [(s._
-0001b200: 6e61 6d65 2c20 3029 2066 6f72 2073 2069  name, 0) for s i
-0001b210: 6e20 7374 6174 735d 0a0a 2020 2020 2020  n stats]..      
-0001b220: 2020 6e61 6d65 203d 2022 6465 7363 7269    name = "descri
-0001b230: 6265 2d2d 2220 2b20 746f 6b65 6e69 7a65  be--" + tokenize
-0001b240: 2873 656c 662c 2073 706c 6974 5f65 7665  (self, split_eve
-0001b250: 7279 290a 2020 2020 2020 2020 6c61 7965  ry).        laye
-0001b260: 7220 3d20 7b28 6e61 6d65 2c20 3029 3a20  r = {(name, 0): 
-0001b270: 286d 6574 686f 6473 2e64 6573 6372 6962  (methods.describ
-0001b280: 655f 6167 6772 6567 6174 652c 2073 7461  e_aggregate, sta
-0001b290: 7473 5f6e 616d 6573 297d 0a20 2020 2020  ts_names)}.     
-0001b2a0: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-0001b2b0: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-0001b2c0: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
-0001b2d0: 206c 6179 6572 2c20 6465 7065 6e64 656e   layer, dependen
-0001b2e0: 6369 6573 3d73 7461 7473 290a 2020 2020  cies=stats).    
-0001b2f0: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
-0001b300: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e64  _meta_nonempty.d
-0001b310: 6573 6372 6962 6528 0a20 2020 2020 2020  escribe(.       
-0001b320: 2020 2020 2069 6e63 6c75 6465 3d69 6e63       include=inc
-0001b330: 6c75 6465 2c20 6578 636c 7564 653d 6578  lude, exclude=ex
-0001b340: 636c 7564 652c 202a 2a64 6174 6574 696d  clude, **datetim
-0001b350: 655f 6973 5f6e 756d 6572 6963 5f6b 7761  e_is_numeric_kwa
-0001b360: 7267 0a20 2020 2020 2020 2029 0a20 2020  rg.        ).   
-0001b370: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-0001b380: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
-0001b390: 206e 616d 652c 206d 6574 612c 2064 6976   name, meta, div
-0001b3a0: 6973 696f 6e73 3d5b 4e6f 6e65 2c20 4e6f  isions=[None, No
-0001b3b0: 6e65 5d29 0a0a 2020 2020 6465 6620 5f64  ne])..    def _d
-0001b3c0: 6573 6372 6962 655f 3164 280a 2020 2020  escribe_1d(.    
-0001b3d0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0001b3e0: 2020 6461 7461 2c0a 2020 2020 2020 2020    data,.        
-0001b3f0: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
-0001b400: 652c 0a20 2020 2020 2020 2070 6572 6365  e,.        perce
-0001b410: 6e74 696c 6573 3d4e 6f6e 652c 0a20 2020  ntiles=None,.   
-0001b420: 2020 2020 2070 6572 6365 6e74 696c 6573       percentiles
-0001b430: 5f6d 6574 686f 643d 2264 6566 6175 6c74  _method="default
-0001b440: 222c 0a20 2020 2020 2020 2064 6174 6574  ",.        datet
-0001b450: 696d 655f 6973 5f6e 756d 6572 6963 3d46  ime_is_numeric=F
-0001b460: 616c 7365 2c0a 2020 2020 293a 0a20 2020  alse,.    ):.   
-0001b470: 2020 2020 2069 6620 6973 5f62 6f6f 6c5f       if is_bool_
-0001b480: 6474 7970 6528 6461 7461 2e5f 6d65 7461  dtype(data._meta
-0001b490: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0001b4a0: 6574 7572 6e20 7365 6c66 2e5f 6465 7363  eturn self._desc
-0001b4b0: 7269 6265 5f6e 6f6e 6e75 6d65 7269 635f  ribe_nonnumeric_
-0001b4c0: 3164 280a 2020 2020 2020 2020 2020 2020  1d(.            
-0001b4d0: 2020 2020 6461 7461 2c20 7370 6c69 745f      data, split_
-0001b4e0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-0001b4f0: 792c 2064 6174 6574 696d 655f 6973 5f6e  y, datetime_is_n
-0001b500: 756d 6572 6963 3d64 6174 6574 696d 655f  umeric=datetime_
-0001b510: 6973 5f6e 756d 6572 6963 0a20 2020 2020  is_numeric.     
-0001b520: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001b530: 2065 6c69 6620 6973 5f6e 756d 6572 6963   elif is_numeric
-0001b540: 5f64 7479 7065 2864 6174 612e 5f6d 6574  _dtype(data._met
-0001b550: 6129 3a0a 2020 2020 2020 2020 2020 2020  a):.            
-0001b560: 7265 7475 726e 2073 656c 662e 5f64 6573  return self._des
-0001b570: 6372 6962 655f 6e75 6d65 7269 6328 0a20  cribe_numeric(. 
-0001b580: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0001b590: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
-0001b5a0: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-0001b5b0: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
-0001b5c0: 2020 2020 2020 2020 2020 2020 2020 7065                pe
-0001b5d0: 7263 656e 7469 6c65 733d 7065 7263 656e  rcentiles=percen
-0001b5e0: 7469 6c65 732c 0a20 2020 2020 2020 2020  tiles,.         
-0001b5f0: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
-0001b600: 6573 5f6d 6574 686f 643d 7065 7263 656e  es_method=percen
-0001b610: 7469 6c65 735f 6d65 7468 6f64 2c0a 2020  tiles_method,.  
-0001b620: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0001b630: 2020 2020 656c 6966 2069 735f 7469 6d65      elif is_time
-0001b640: 6465 6c74 6136 345f 6474 7970 6528 6461  delta64_dtype(da
-0001b650: 7461 2e5f 6d65 7461 293a 0a20 2020 2020  ta._meta):.     
-0001b660: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001b670: 6c66 2e5f 6465 7363 7269 6265 5f6e 756d  lf._describe_num
-0001b680: 6572 6963 280a 2020 2020 2020 2020 2020  eric(.          
-0001b690: 2020 2020 2020 6461 7461 2e64 726f 706e        data.dropn
-0001b6a0: 6128 292c 0a20 2020 2020 2020 2020 2020  a(),.           
-0001b6b0: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-0001b6c0: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
-0001b6d0: 2020 2020 2020 2020 2020 2020 2020 7065                pe
-0001b6e0: 7263 656e 7469 6c65 733d 7065 7263 656e  rcentiles=percen
-0001b6f0: 7469 6c65 732c 0a20 2020 2020 2020 2020  tiles,.         
-0001b700: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
-0001b710: 6573 5f6d 6574 686f 643d 7065 7263 656e  es_method=percen
-0001b720: 7469 6c65 735f 6d65 7468 6f64 2c0a 2020  tiles_method,.  
-0001b730: 2020 2020 2020 2020 2020 2020 2020 6973                is
-0001b740: 5f74 696d 6564 656c 7461 5f63 6f6c 756d  _timedelta_colum
-0001b750: 6e3d 5472 7565 2c0a 2020 2020 2020 2020  n=True,.        
-0001b760: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-0001b770: 6966 2069 735f 6461 7465 7469 6d65 3634  if is_datetime64
-0001b780: 5f61 6e79 5f64 7479 7065 2864 6174 612e  _any_dtype(data.
-0001b790: 5f6d 6574 6129 2061 6e64 2064 6174 6574  _meta) and datet
-0001b7a0: 696d 655f 6973 5f6e 756d 6572 6963 3a0a  ime_is_numeric:.
-0001b7b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001b7c0: 726e 2073 656c 662e 5f64 6573 6372 6962  rn self._describ
-0001b7d0: 655f 6e75 6d65 7269 6328 0a20 2020 2020  e_numeric(.     
-0001b7e0: 2020 2020 2020 2020 2020 2064 6174 612e             data.
-0001b7f0: 6472 6f70 6e61 2829 2c0a 2020 2020 2020  dropna(),.      
-0001b800: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
-0001b810: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-0001b820: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-0001b830: 2020 2070 6572 6365 6e74 696c 6573 3d70     percentiles=p
-0001b840: 6572 6365 6e74 696c 6573 2c0a 2020 2020  ercentiles,.    
-0001b850: 2020 2020 2020 2020 2020 2020 7065 7263              perc
-0001b860: 656e 7469 6c65 735f 6d65 7468 6f64 3d70  entiles_method=p
-0001b870: 6572 6365 6e74 696c 6573 5f6d 6574 686f  ercentiles_metho
-0001b880: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
-0001b890: 2020 2069 735f 6461 7465 7469 6d65 5f63     is_datetime_c
-0001b8a0: 6f6c 756d 6e3d 5472 7565 2c0a 2020 2020  olumn=True,.    
-0001b8b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001b8c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001b8d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001b8e0: 5f64 6573 6372 6962 655f 6e6f 6e6e 756d  _describe_nonnum
-0001b8f0: 6572 6963 5f31 6428 0a20 2020 2020 2020  eric_1d(.       
-0001b900: 2020 2020 2020 2020 2064 6174 612c 2073           data, s
-0001b910: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-0001b920: 5f65 7665 7279 2c20 6461 7465 7469 6d65  _every, datetime
-0001b930: 5f69 735f 6e75 6d65 7269 633d 6461 7465  _is_numeric=date
-0001b940: 7469 6d65 5f69 735f 6e75 6d65 7269 630a  time_is_numeric.
-0001b950: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0001b960: 2020 2064 6566 205f 6465 7363 7269 6265     def _describe
-0001b970: 5f6e 756d 6572 6963 280a 2020 2020 2020  _numeric(.      
-0001b980: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0001b990: 6461 7461 2c0a 2020 2020 2020 2020 7370  data,.        sp
-0001b9a0: 6c69 745f 6576 6572 793d 4661 6c73 652c  lit_every=False,
-0001b9b0: 0a20 2020 2020 2020 2070 6572 6365 6e74  .        percent
-0001b9c0: 696c 6573 3d4e 6f6e 652c 0a20 2020 2020  iles=None,.     
-0001b9d0: 2020 2070 6572 6365 6e74 696c 6573 5f6d     percentiles_m
-0001b9e0: 6574 686f 643d 2264 6566 6175 6c74 222c  ethod="default",
-0001b9f0: 0a20 2020 2020 2020 2069 735f 7469 6d65  .        is_time
-0001ba00: 6465 6c74 615f 636f 6c75 6d6e 3d46 616c  delta_column=Fal
-0001ba10: 7365 2c0a 2020 2020 2020 2020 6973 5f64  se,.        is_d
-0001ba20: 6174 6574 696d 655f 636f 6c75 6d6e 3d46  atetime_column=F
-0001ba30: 616c 7365 2c0a 2020 2020 293a 0a20 2020  alse,.    ):.   
-0001ba40: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-0001ba50: 6174 6166 7261 6d65 2e6e 756d 6572 6963  ataframe.numeric
-0001ba60: 2069 6d70 6f72 7420 746f 5f6e 756d 6572   import to_numer
-0001ba70: 6963 0a0a 2020 2020 2020 2020 6966 2069  ic..        if i
-0001ba80: 735f 7469 6d65 6465 6c74 615f 636f 6c75  s_timedelta_colu
-0001ba90: 6d6e 206f 7220 6973 5f64 6174 6574 696d  mn or is_datetim
-0001baa0: 655f 636f 6c75 6d6e 3a0a 2020 2020 2020  e_column:.      
-0001bab0: 2020 2020 2020 6e75 6d20 3d20 746f 5f6e        num = to_n
-0001bac0: 756d 6572 6963 2864 6174 6129 0a20 2020  umeric(data).   
-0001bad0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001bae0: 2020 2020 2020 206e 756d 203d 2064 6174         num = dat
-0001baf0: 612e 5f67 6574 5f6e 756d 6572 6963 5f64  a._get_numeric_d
-0001bb00: 6174 6128 290a 0a20 2020 2020 2020 2069  ata()..        i
-0001bb10: 6620 6461 7461 2e6e 6469 6d20 3d3d 2032  f data.ndim == 2
-0001bb20: 2061 6e64 206c 656e 286e 756d 2e63 6f6c   and len(num.col
-0001bb30: 756d 6e73 2920 3d3d 2030 3a0a 2020 2020  umns) == 0:.    
-0001bb40: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0001bb50: 6c75 6545 7272 6f72 2822 4461 7461 4672  lueError("DataFr
-0001bb60: 616d 6520 636f 6e74 6169 6e73 206f 6e6c  ame contains onl
-0001bb70: 7920 6e6f 6e2d 6e75 6d65 7269 6320 6461  y non-numeric da
-0001bb80: 7461 2e22 290a 2020 2020 2020 2020 656c  ta.").        el
-0001bb90: 6966 2064 6174 612e 6e64 696d 203d 3d20  if data.ndim == 
-0001bba0: 3120 616e 6420 6461 7461 2e64 7479 7065  1 and data.dtype
-0001bbb0: 203d 3d20 226f 626a 6563 7422 3a0a 2020   == "object":.  
-0001bbc0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001bbd0: 5661 6c75 6545 7272 6f72 2822 4361 6e6e  ValueError("Cann
-0001bbe0: 6f74 2063 6f6d 7075 7465 2060 6064 6573  ot compute ``des
-0001bbf0: 6372 6962 6560 6020 6f6e 206f 626a 6563  cribe`` on objec
-0001bc00: 7420 6474 7970 652e 2229 0a20 2020 2020  t dtype.").     
-0001bc10: 2020 2069 6620 7065 7263 656e 7469 6c65     if percentile
-0001bc20: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-0001bc30: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
-0001bc40: 6573 203d 205b 302e 3235 2c20 302e 352c  es = [0.25, 0.5,
-0001bc50: 2030 2e37 355d 0a20 2020 2020 2020 2065   0.75].        e
-0001bc60: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001bc70: 2023 2061 6c77 6179 7320 696e 636c 7564   # always includ
-0001bc80: 6520 7468 6520 7468 6520 3530 2574 6c65  e the the 50%tle
-0001bc90: 2074 6f20 6361 6c63 756c 6174 6520 7468   to calculate th
-0001bca0: 6520 6d65 6469 616e 0a20 2020 2020 2020  e median.       
-0001bcb0: 2020 2020 2023 2075 6e69 7175 6520 7265       # unique re
-0001bcc0: 6d6f 7665 7320 6475 706c 6963 6174 6573  moves duplicates
-0001bcd0: 2061 6e64 2073 6f72 7473 2071 7561 6e74   and sorts quant
-0001bce0: 696c 6573 0a20 2020 2020 2020 2020 2020  iles.           
-0001bcf0: 2070 6572 6365 6e74 696c 6573 203d 206e   percentiles = n
-0001bd00: 702e 6172 7261 7928 7065 7263 656e 7469  p.array(percenti
-0001bd10: 6c65 7329 0a20 2020 2020 2020 2020 2020  les).           
-0001bd20: 2070 6572 6365 6e74 696c 6573 203d 206e   percentiles = n
-0001bd30: 702e 6170 7065 6e64 2870 6572 6365 6e74  p.append(percent
-0001bd40: 696c 6573 2c20 302e 3529 0a20 2020 2020  iles, 0.5).     
-0001bd50: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
-0001bd60: 6573 203d 206e 702e 756e 6971 7565 2870  es = np.unique(p
-0001bd70: 6572 6365 6e74 696c 6573 290a 2020 2020  ercentiles).    
-0001bd80: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
-0001bd90: 6c65 7320 3d20 6c69 7374 2870 6572 6365  les = list(perce
-0001bda0: 6e74 696c 6573 290a 2020 2020 2020 2020  ntiles).        
-0001bdb0: 7374 6174 7320 3d20 5b0a 2020 2020 2020  stats = [.      
-0001bdc0: 2020 2020 2020 6e75 6d2e 636f 756e 7428        num.count(
-0001bdd0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-0001bde0: 745f 6576 6572 7929 2c0a 2020 2020 2020  t_every),.      
-0001bdf0: 2020 2020 2020 6e75 6d2e 6d65 616e 2873        num.mean(s
-0001be00: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-0001be10: 5f65 7665 7279 292c 0a20 2020 2020 2020  _every),.       
-0001be20: 2020 2020 206e 756d 2e73 7464 2873 706c       num.std(spl
-0001be30: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-0001be40: 7665 7279 292c 0a20 2020 2020 2020 2020  very),.         
-0001be50: 2020 206e 756d 2e6d 696e 2873 706c 6974     num.min(split
-0001be60: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-0001be70: 7279 292c 0a20 2020 2020 2020 2020 2020  ry),.           
-0001be80: 206e 756d 2e71 7561 6e74 696c 6528 7065   num.quantile(pe
-0001be90: 7263 656e 7469 6c65 732c 206d 6574 686f  rcentiles, metho
-0001bea0: 643d 7065 7263 656e 7469 6c65 735f 6d65  d=percentiles_me
-0001beb0: 7468 6f64 292c 0a20 2020 2020 2020 2020  thod),.         
-0001bec0: 2020 206e 756d 2e6d 6178 2873 706c 6974     num.max(split
-0001bed0: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-0001bee0: 7279 292c 0a20 2020 2020 2020 205d 0a20  ry),.        ]. 
-0001bef0: 2020 2020 2020 2073 7461 7473 5f6e 616d         stats_nam
-0001bf00: 6573 203d 205b 2873 2e5f 6e61 6d65 2c20  es = [(s._name, 
-0001bf10: 3029 2066 6f72 2073 2069 6e20 7374 6174  0) for s in stat
-0001bf20: 735d 0a0a 2020 2020 2020 2020 636f 6c6e  s]..        coln
-0001bf30: 616d 6520 3d20 6461 7461 2e5f 6d65 7461  ame = data._meta
-0001bf40: 2e6e 616d 6520 6966 2069 735f 7365 7269  .name if is_seri
-0001bf50: 6573 5f6c 696b 6528 6461 7461 2e5f 6d65  es_like(data._me
-0001bf60: 7461 2920 656c 7365 204e 6f6e 650a 0a20  ta) else None.. 
-0001bf70: 2020 2020 2020 206e 616d 6520 3d20 2264         name = "d
-0001bf80: 6573 6372 6962 652d 6e75 6d65 7269 632d  escribe-numeric-
-0001bf90: 2d22 202b 2074 6f6b 656e 697a 6528 6e75  -" + tokenize(nu
-0001bfa0: 6d2c 2073 706c 6974 5f65 7665 7279 290a  m, split_every).
-0001bfb0: 2020 2020 2020 2020 6c61 7965 7220 3d20          layer = 
-0001bfc0: 7b0a 2020 2020 2020 2020 2020 2020 286e  {.            (n
-0001bfd0: 616d 652c 2030 293a 2028 0a20 2020 2020  ame, 0): (.     
-0001bfe0: 2020 2020 2020 2020 2020 206d 6574 686f             metho
-0001bff0: 6473 2e64 6573 6372 6962 655f 6e75 6d65  ds.describe_nume
-0001c000: 7269 635f 6167 6772 6567 6174 652c 0a20  ric_aggregate,. 
-0001c010: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001c020: 7461 7473 5f6e 616d 6573 2c0a 2020 2020  tats_names,.    
-0001c030: 2020 2020 2020 2020 2020 2020 636f 6c6e              coln
-0001c040: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-0001c050: 2020 2020 2069 735f 7469 6d65 6465 6c74       is_timedelt
-0001c060: 615f 636f 6c75 6d6e 2c0a 2020 2020 2020  a_column,.      
-0001c070: 2020 2020 2020 2020 2020 6973 5f64 6174            is_dat
-0001c080: 6574 696d 655f 636f 6c75 6d6e 2c0a 2020  etime_column,.  
-0001c090: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0001c0a0: 2020 2020 7d0a 2020 2020 2020 2020 6772      }.        gr
-0001c0b0: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
-0001c0c0: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
-0001c0d0: 7469 6f6e 7328 6e61 6d65 2c20 6c61 7965  tions(name, laye
-0001c0e0: 722c 2064 6570 656e 6465 6e63 6965 733d  r, dependencies=
-0001c0f0: 7374 6174 7329 0a20 2020 2020 2020 206d  stats).        m
-0001c100: 6574 6120 3d20 6e75 6d2e 5f6d 6574 615f  eta = num._meta_
-0001c110: 6e6f 6e65 6d70 7479 2e64 6573 6372 6962  nonempty.describ
-0001c120: 6528 290a 2020 2020 2020 2020 7265 7475  e().        retu
-0001c130: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
-0001c140: 2867 7261 7068 2c20 6e61 6d65 2c20 6d65  (graph, name, me
-0001c150: 7461 2c20 6469 7669 7369 6f6e 733d 5b4e  ta, divisions=[N
-0001c160: 6f6e 652c 204e 6f6e 655d 290a 0a20 2020  one, None])..   
-0001c170: 2064 6566 205f 6465 7363 7269 6265 5f6e   def _describe_n
-0001c180: 6f6e 6e75 6d65 7269 635f 3164 280a 2020  onnumeric_1d(.  
-0001c190: 2020 2020 2020 7365 6c66 2c20 6461 7461        self, data
-0001c1a0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
-0001c1b0: 6c73 652c 2064 6174 6574 696d 655f 6973  lse, datetime_is
-0001c1c0: 5f6e 756d 6572 6963 3d46 616c 7365 0a20  _numeric=False. 
-0001c1d0: 2020 2029 3a0a 2020 2020 2020 2020 6672     ):.        fr
-0001c1e0: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
-0001c1f0: 652e 6e75 6d65 7269 6320 696d 706f 7274  e.numeric import
-0001c200: 2074 6f5f 6e75 6d65 7269 630a 0a20 2020   to_numeric..   
-0001c210: 2020 2020 2076 636f 756e 7473 203d 2064       vcounts = d
-0001c220: 6174 612e 7661 6c75 655f 636f 756e 7473  ata.value_counts
-0001c230: 2873 706c 6974 5f65 7665 7279 3d73 706c  (split_every=spl
-0001c240: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
-0001c250: 2020 636f 756e 745f 6e6f 6e7a 6572 6f20    count_nonzero 
-0001c260: 3d20 7663 6f75 6e74 735b 7663 6f75 6e74  = vcounts[vcount
-0001c270: 7320 213d 2030 5d0a 2020 2020 2020 2020  s != 0].        
-0001c280: 636f 756e 745f 756e 6971 7565 203d 2063  count_unique = c
-0001c290: 6f75 6e74 5f6e 6f6e 7a65 726f 2e73 697a  ount_nonzero.siz
-0001c2a0: 650a 0a20 2020 2020 2020 2073 7461 7473  e..        stats
-0001c2b0: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
-0001c2c0: 2023 206e 756e 6971 7565 0a20 2020 2020   # nunique.     
-0001c2d0: 2020 2020 2020 2063 6f75 6e74 5f75 6e69         count_uni
-0001c2e0: 7175 652c 0a20 2020 2020 2020 2020 2020  que,.           
-0001c2f0: 2023 2063 6f75 6e74 0a20 2020 2020 2020   # count.       
-0001c300: 2020 2020 2064 6174 612e 636f 756e 7428       data.count(
-0001c310: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-0001c320: 745f 6576 6572 7929 2c0a 2020 2020 2020  t_every),.      
-0001c330: 2020 2020 2020 2320 6d6f 7374 2063 6f6d        # most com
-0001c340: 6d6f 6e20 7661 6c75 650a 2020 2020 2020  mon value.      
-0001c350: 2020 2020 2020 7663 6f75 6e74 732e 5f68        vcounts._h
-0001c360: 6561 6428 312c 206e 7061 7274 6974 696f  ead(1, npartitio
-0001c370: 6e73 3d31 2c20 636f 6d70 7574 653d 4661  ns=1, compute=Fa
-0001c380: 6c73 652c 2073 6166 653d 4661 6c73 6529  lse, safe=False)
-0001c390: 2c0a 2020 2020 2020 2020 5d0a 0a20 2020  ,.        ]..   
-0001c3a0: 2020 2020 2069 6620 6973 5f64 6174 6574       if is_datet
-0001c3b0: 696d 6536 345f 616e 795f 6474 7970 6528  ime64_any_dtype(
-0001c3c0: 6461 7461 2e5f 6d65 7461 2920 616e 6420  data._meta) and 
-0001c3d0: 6e6f 7420 6461 7465 7469 6d65 5f69 735f  not datetime_is_
-0001c3e0: 6e75 6d65 7269 633a 0a20 2020 2020 2020  numeric:.       
-0001c3f0: 2020 2020 206d 696e 5f74 7320 3d20 746f       min_ts = to
-0001c400: 5f6e 756d 6572 6963 2864 6174 612e 6472  _numeric(data.dr
-0001c410: 6f70 6e61 2829 292e 6d69 6e28 7370 6c69  opna()).min(spli
-0001c420: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-0001c430: 6572 7929 0a20 2020 2020 2020 2020 2020  ery).           
-0001c440: 206d 6178 5f74 7320 3d20 746f 5f6e 756d   max_ts = to_num
-0001c450: 6572 6963 2864 6174 612e 6472 6f70 6e61  eric(data.dropna
-0001c460: 2829 292e 6d61 7828 7370 6c69 745f 6576  ()).max(split_ev
-0001c470: 6572 793d 7370 6c69 745f 6576 6572 7929  ery=split_every)
-0001c480: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-0001c490: 7473 2e65 7874 656e 6428 5b6d 696e 5f74  ts.extend([min_t
-0001c4a0: 732c 206d 6178 5f74 735d 290a 0a20 2020  s, max_ts])..   
-0001c4b0: 2020 2020 2073 7461 7473 5f6e 616d 6573       stats_names
-0001c4c0: 203d 205b 2873 2e5f 6e61 6d65 2c20 3029   = [(s._name, 0)
-0001c4d0: 2066 6f72 2073 2069 6e20 7374 6174 735d   for s in stats]
-0001c4e0: 0a20 2020 2020 2020 2063 6f6c 6e61 6d65  .        colname
-0001c4f0: 203d 2064 6174 612e 5f6d 6574 612e 6e61   = data._meta.na
-0001c500: 6d65 0a0a 2020 2020 2020 2020 6e61 6d65  me..        name
-0001c510: 203d 2022 6465 7363 7269 6265 2d6e 6f6e   = "describe-non
-0001c520: 6e75 6d65 7269 632d 3164 2d2d 2220 2b20  numeric-1d--" + 
-0001c530: 746f 6b65 6e69 7a65 2864 6174 612c 2073  tokenize(data, s
-0001c540: 706c 6974 5f65 7665 7279 290a 2020 2020  plit_every).    
-0001c550: 2020 2020 6c61 7965 7220 3d20 7b0a 2020      layer = {.  
-0001c560: 2020 2020 2020 2020 2020 286e 616d 652c            (name,
-0001c570: 2030 293a 2028 6d65 7468 6f64 732e 6465   0): (methods.de
-0001c580: 7363 7269 6265 5f6e 6f6e 6e75 6d65 7269  scribe_nonnumeri
-0001c590: 635f 6167 6772 6567 6174 652c 2073 7461  c_aggregate, sta
-0001c5a0: 7473 5f6e 616d 6573 2c20 636f 6c6e 616d  ts_names, colnam
-0001c5b0: 6529 0a20 2020 2020 2020 207d 0a20 2020  e).        }.   
-0001c5c0: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
-0001c5d0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-0001c5e0: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
-0001c5f0: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
-0001c600: 656e 6369 6573 3d73 7461 7473 290a 0a20  encies=stats).. 
-0001c610: 2020 2020 2020 2069 6620 6e6f 7420 5041         if not PA
-0001c620: 4e44 4153 5f47 545f 3230 303a 0a20 2020  NDAS_GT_200:.   
-0001c630: 2020 2020 2020 2020 2064 6174 6574 696d           datetim
-0001c640: 655f 6973 5f6e 756d 6572 6963 5f6b 7761  e_is_numeric_kwa
-0001c650: 7267 203d 207b 2264 6174 6574 696d 655f  rg = {"datetime_
-0001c660: 6973 5f6e 756d 6572 6963 223a 2064 6174  is_numeric": dat
-0001c670: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
-0001c680: 7d0a 2020 2020 2020 2020 656c 7365 3a0a  }.        else:.
-0001c690: 2020 2020 2020 2020 2020 2020 6461 7465              date
-0001c6a0: 7469 6d65 5f69 735f 6e75 6d65 7269 635f  time_is_numeric_
-0001c6b0: 6b77 6172 6720 3d20 7b7d 0a20 2020 2020  kwarg = {}.     
-0001c6c0: 2020 206d 6574 6120 3d20 6461 7461 2e5f     meta = data._
-0001c6d0: 6d65 7461 5f6e 6f6e 656d 7074 792e 6465  meta_nonempty.de
-0001c6e0: 7363 7269 6265 282a 2a64 6174 6574 696d  scribe(**datetim
-0001c6f0: 655f 6973 5f6e 756d 6572 6963 5f6b 7761  e_is_numeric_kwa
-0001c700: 7267 290a 2020 2020 2020 2020 7265 7475  rg).        retu
-0001c710: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
-0001c720: 2867 7261 7068 2c20 6e61 6d65 2c20 6d65  (graph, name, me
-0001c730: 7461 2c20 6469 7669 7369 6f6e 733d 5b4e  ta, divisions=[N
-0001c740: 6f6e 652c 204e 6f6e 655d 290a 0a20 2020  one, None])..   
-0001c750: 2064 6566 205f 6375 6d5f 6167 6728 0a20   def _cum_agg(. 
-0001c760: 2020 2020 2020 2073 656c 662c 206f 705f         self, op_
-0001c770: 6e61 6d65 2c20 6368 756e 6b2c 2061 6767  name, chunk, agg
-0001c780: 7265 6761 7465 2c20 6178 6973 2c20 736b  regate, axis, sk
-0001c790: 6970 6e61 3d54 7275 652c 2063 6875 6e6b  ipna=True, chunk
-0001c7a0: 5f6b 7761 7267 733d 4e6f 6e65 2c20 6f75  _kwargs=None, ou
-0001c7b0: 743d 4e6f 6e65 0a20 2020 2029 3a0a 2020  t=None.    ):.  
-0001c7c0: 2020 2020 2020 2222 2257 7261 7070 6572        """Wrapper
-0001c7d0: 2066 6f72 2063 756d 756c 6174 6976 6520   for cumulative 
-0001c7e0: 6f70 6572 6174 696f 6e22 2222 0a0a 2020  operation"""..  
-0001c7f0: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
-0001c800: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
-0001c810: 2861 7869 7329 0a0a 2020 2020 2020 2020  (axis)..        
-0001c820: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
-0001c830: 2020 2020 2020 2020 2020 6e61 6d65 203d            name =
-0001c840: 2066 227b 7365 6c66 2e5f 746f 6b65 6e5f   f"{self._token_
-0001c850: 7072 6566 6978 7d7b 6f70 5f6e 616d 657d  prefix}{op_name}
-0001c860: 2861 7869 733d 3129 220a 2020 2020 2020  (axis=1)".      
-0001c870: 2020 2020 2020 7265 7375 6c74 203d 2073        result = s
-0001c880: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-0001c890: 6e73 2863 6875 6e6b 2c20 746f 6b65 6e3d  ns(chunk, token=
-0001c8a0: 6e61 6d65 2c20 2a2a 6368 756e 6b5f 6b77  name, **chunk_kw
-0001c8b0: 6172 6773 290a 2020 2020 2020 2020 2020  args).          
-0001c8c0: 2020 7265 7475 726e 2068 616e 646c 655f    return handle_
-0001c8d0: 6f75 7428 6f75 742c 2072 6573 756c 7429  out(out, result)
-0001c8e0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0001c8f0: 2020 2020 2020 2020 2020 2023 2063 756d             # cum
-0001c900: 756c 6174 6520 6561 6368 2070 6172 7469  ulate each parti
-0001c910: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
-0001c920: 2020 6e61 6d65 3120 3d20 6622 7b73 656c    name1 = f"{sel
-0001c930: 662e 5f74 6f6b 656e 5f70 7265 6669 787d  f._token_prefix}
-0001c940: 7b6f 705f 6e61 6d65 7d2d 6d61 7022 0a20  {op_name}-map". 
-0001c950: 2020 2020 2020 2020 2020 2063 756d 7061             cumpa
-0001c960: 7274 203d 206d 6170 5f70 6172 7469 7469  rt = map_partiti
-0001c970: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-0001c980: 2020 2020 2063 6875 6e6b 2c20 7365 6c66       chunk, self
-0001c990: 2c20 746f 6b65 6e3d 6e61 6d65 312c 206d  , token=name1, m
-0001c9a0: 6574 613d 7365 6c66 2c20 2a2a 6368 756e  eta=self, **chun
-0001c9b0: 6b5f 6b77 6172 6773 0a20 2020 2020 2020  k_kwargs.       
-0001c9c0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0001c9d0: 2020 2020 6e61 6d65 3220 3d20 6622 7b73      name2 = f"{s
-0001c9e0: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
-0001c9f0: 787d 7b6f 705f 6e61 6d65 7d2d 7461 6b65  x}{op_name}-take
-0001ca00: 2d6c 6173 7422 0a20 2020 2020 2020 2020  -last".         
-0001ca10: 2020 2063 756d 6c61 7374 203d 206d 6170     cumlast = map
-0001ca20: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-0001ca30: 2020 2020 2020 2020 2020 2020 205f 7461               _ta
-0001ca40: 6b65 5f6c 6173 742c 0a20 2020 2020 2020  ke_last,.       
-0001ca50: 2020 2020 2020 2020 2063 756d 7061 7274           cumpart
-0001ca60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001ca70: 2020 736b 6970 6e61 2c0a 2020 2020 2020    skipna,.      
-0001ca80: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
-0001ca90: 6574 615f 7365 7269 6573 5f63 6f6e 7374  eta_series_const
-0001caa0: 7275 6374 6f72 2873 656c 6629 285b 5d2c  ructor(self)([],
-0001cab0: 2064 7479 7065 3d22 666c 6f61 7422 292c   dtype="float"),
-0001cac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001cad0: 2074 6f6b 656e 3d6e 616d 6532 2c0a 2020   token=name2,.  
-0001cae0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0001caf0: 2020 2020 2020 2020 2073 7566 6669 7820           suffix 
-0001cb00: 3d20 746f 6b65 6e69 7a65 2873 656c 6629  = tokenize(self)
-0001cb10: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-0001cb20: 6520 3d20 6622 7b73 656c 662e 5f74 6f6b  e = f"{self._tok
-0001cb30: 656e 5f70 7265 6669 787d 7b6f 705f 6e61  en_prefix}{op_na
-0001cb40: 6d65 7d2d 7b73 7566 6669 787d 220a 2020  me}-{suffix}".  
-0001cb50: 2020 2020 2020 2020 2020 636e 616d 6520            cname 
-0001cb60: 3d20 6622 7b73 656c 662e 5f74 6f6b 656e  = f"{self._token
-0001cb70: 5f70 7265 6669 787d 7b6f 705f 6e61 6d65  _prefix}{op_name
-0001cb80: 7d2d 6375 6d2d 6c61 7374 2d7b 7375 6666  }-cum-last-{suff
-0001cb90: 6978 7d22 0a0a 2020 2020 2020 2020 2020  ix}"..          
-0001cba0: 2020 2320 6167 6772 6567 6174 6520 6375    # aggregate cu
-0001cbb0: 6d75 6c61 7465 6420 7061 7274 6973 696f  mulated partisio
-0001cbc0: 6e73 2061 6e64 2069 7473 2070 7265 7669  ns and its previ
-0001cbd0: 6f75 7320 6c61 7374 2065 6c65 6d65 6e74  ous last element
-0001cbe0: 0a20 2020 2020 2020 2020 2020 206c 6179  .            lay
-0001cbf0: 6572 203d 207b 7d0a 2020 2020 2020 2020  er = {}.        
-0001cc00: 2020 2020 6c61 7965 725b 286e 616d 652c      layer[(name,
-0001cc10: 2030 295d 203d 2028 6375 6d70 6172 742e   0)] = (cumpart.
-0001cc20: 5f6e 616d 652c 2030 290a 0a20 2020 2020  _name, 0)..     
-0001cc30: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-0001cc40: 7261 6e67 6528 312c 2073 656c 662e 6e70  range(1, self.np
-0001cc50: 6172 7469 7469 6f6e 7329 3a0a 2020 2020  artitions):.    
-0001cc60: 2020 2020 2020 2020 2020 2020 2320 7374              # st
-0001cc70: 6f72 6520 6561 6368 2063 756d 756c 6174  ore each cumulat
-0001cc80: 6976 6520 7374 6570 2074 6f20 6772 6170  ive step to grap
-0001cc90: 6820 746f 2072 6564 7563 6520 636f 6d70  h to reduce comp
-0001cca0: 7574 6174 696f 6e0a 2020 2020 2020 2020  utation.        
-0001ccb0: 2020 2020 2020 2020 6966 2069 203d 3d20          if i == 
-0001ccc0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-0001ccd0: 2020 2020 2020 206c 6179 6572 5b28 636e         layer[(cn
-0001cce0: 616d 652c 2069 295d 203d 2028 6375 6d6c  ame, i)] = (cuml
-0001ccf0: 6173 742e 5f6e 616d 652c 2069 202d 2031  ast._name, i - 1
-0001cd00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001cd10: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001cd20: 2020 2020 2020 2020 2020 2020 2320 6167              # ag
-0001cd30: 6772 6567 6174 6520 7769 7468 2070 7265  gregate with pre
-0001cd40: 7669 6f75 7320 6375 6d75 6c61 7469 6f6e  vious cumulation
-0001cd50: 2072 6573 756c 7473 0a20 2020 2020 2020   results.       
-0001cd60: 2020 2020 2020 2020 2020 2020 206c 6179               lay
-0001cd70: 6572 5b28 636e 616d 652c 2069 295d 203d  er[(cname, i)] =
-0001cd80: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0001cd90: 2020 2020 2020 2020 2020 206d 6574 686f             metho
-0001cda0: 6473 2e5f 6375 6d5f 6167 6772 6567 6174  ds._cum_aggregat
-0001cdb0: 655f 6170 706c 792c 0a20 2020 2020 2020  e_apply,.       
-0001cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cdd0: 2061 6767 7265 6761 7465 2c0a 2020 2020   aggregate,.    
-0001cde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cdf0: 2020 2020 2863 6e61 6d65 2c20 6920 2d20      (cname, i - 
-0001ce00: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
-0001ce10: 2020 2020 2020 2020 2020 2020 2863 756d              (cum
-0001ce20: 6c61 7374 2e5f 6e61 6d65 2c20 6920 2d20  last._name, i - 
-0001ce30: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
-0001ce40: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001ce50: 2020 2020 2020 2020 2020 6c61 7965 725b            layer[
-0001ce60: 286e 616d 652c 2069 295d 203d 2028 6167  (name, i)] = (ag
-0001ce70: 6772 6567 6174 652c 2028 6375 6d70 6172  gregate, (cumpar
-0001ce80: 742e 5f6e 616d 652c 2069 292c 2028 636e  t._name, i), (cn
-0001ce90: 616d 652c 2069 2929 0a20 2020 2020 2020  ame, i)).       
-0001cea0: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
-0001ceb0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-0001cec0: 5f63 6f6c 6c65 6374 696f 6e73 280a 2020  _collections(.  
-0001ced0: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-0001cee0: 6d65 2c20 6c61 7965 722c 2064 6570 656e  me, layer, depen
-0001cef0: 6465 6e63 6965 733d 5b63 756d 7061 7274  dencies=[cumpart
-0001cf00: 2c20 6375 6d6c 6173 745d 0a20 2020 2020  , cumlast].     
-0001cf10: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001cf20: 2020 2020 2072 6573 756c 7420 3d20 6e65       result = ne
-0001cf30: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
-0001cf40: 682c 206e 616d 652c 2063 6875 6e6b 2873  h, name, chunk(s
-0001cf50: 656c 662e 5f6d 6574 6129 2c20 7365 6c66  elf._meta), self
-0001cf60: 2e64 6976 6973 696f 6e73 290a 2020 2020  .divisions).    
-0001cf70: 2020 2020 2020 2020 7265 7475 726e 2068          return h
-0001cf80: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
-0001cf90: 6573 756c 7429 0a0a 2020 2020 4064 6572  esult)..    @der
-0001cfa0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-0001cfb0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-0001cfc0: 6375 6d73 756d 2873 656c 662c 2061 7869  cumsum(self, axi
-0001cfd0: 733d 4e6f 6e65 2c20 736b 6970 6e61 3d54  s=None, skipna=T
-0001cfe0: 7275 652c 2064 7479 7065 3d4e 6f6e 652c  rue, dtype=None,
-0001cff0: 206f 7574 3d4e 6f6e 6529 3a0a 2020 2020   out=None):.    
-0001d000: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001d010: 5f63 756d 5f61 6767 280a 2020 2020 2020  _cum_agg(.      
-0001d020: 2020 2020 2020 2263 756d 7375 6d22 2c0a        "cumsum",.
-0001d030: 2020 2020 2020 2020 2020 2020 6368 756e              chun
-0001d040: 6b3d 4d2e 6375 6d73 756d 2c0a 2020 2020  k=M.cumsum,.    
-0001d050: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-0001d060: 653d 6d65 7468 6f64 732e 6375 6d73 756d  e=methods.cumsum
-0001d070: 5f61 6767 7265 6761 7465 2c0a 2020 2020  _aggregate,.    
-0001d080: 2020 2020 2020 2020 6178 6973 3d61 7869          axis=axi
-0001d090: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
-0001d0a0: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
-0001d0b0: 2020 2020 2020 2020 2020 6368 756e 6b5f            chunk_
-0001d0c0: 6b77 6172 6773 3d64 6963 7428 6178 6973  kwargs=dict(axis
-0001d0d0: 3d61 7869 732c 2073 6b69 706e 613d 736b  =axis, skipna=sk
-0001d0e0: 6970 6e61 292c 0a20 2020 2020 2020 2020  ipna),.         
-0001d0f0: 2020 206f 7574 3d6f 7574 2c0a 2020 2020     out=out,.    
-0001d100: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
-0001d110: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0001d120: 4672 616d 6529 0a20 2020 2064 6566 2063  Frame).    def c
-0001d130: 756d 7072 6f64 2873 656c 662c 2061 7869  umprod(self, axi
-0001d140: 733d 4e6f 6e65 2c20 736b 6970 6e61 3d54  s=None, skipna=T
-0001d150: 7275 652c 2064 7479 7065 3d4e 6f6e 652c  rue, dtype=None,
-0001d160: 206f 7574 3d4e 6f6e 6529 3a0a 2020 2020   out=None):.    
-0001d170: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001d180: 5f63 756d 5f61 6767 280a 2020 2020 2020  _cum_agg(.      
-0001d190: 2020 2020 2020 2263 756d 7072 6f64 222c        "cumprod",
-0001d1a0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-0001d1b0: 6e6b 3d4d 2e63 756d 7072 6f64 2c0a 2020  nk=M.cumprod,.  
-0001d1c0: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
-0001d1d0: 6174 653d 6d65 7468 6f64 732e 6375 6d70  ate=methods.cump
-0001d1e0: 726f 645f 6167 6772 6567 6174 652c 0a20  rod_aggregate,. 
-0001d1f0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-0001d200: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-0001d210: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
-0001d220: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-0001d230: 6e6b 5f6b 7761 7267 733d 6469 6374 2861  nk_kwargs=dict(a
-0001d240: 7869 733d 6178 6973 2c20 736b 6970 6e61  xis=axis, skipna
-0001d250: 3d73 6b69 706e 6129 2c0a 2020 2020 2020  =skipna),.      
-0001d260: 2020 2020 2020 6f75 743d 6f75 742c 0a20        out=out,. 
-0001d270: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-0001d280: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0001d290: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0001d2a0: 6620 6375 6d6d 6178 2873 656c 662c 2061  f cummax(self, a
-0001d2b0: 7869 733d 4e6f 6e65 2c20 736b 6970 6e61  xis=None, skipna
-0001d2c0: 3d54 7275 652c 206f 7574 3d4e 6f6e 6529  =True, out=None)
-0001d2d0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0001d2e0: 2073 656c 662e 5f63 756d 5f61 6767 280a   self._cum_agg(.
-0001d2f0: 2020 2020 2020 2020 2020 2020 2263 756d              "cum
-0001d300: 6d61 7822 2c0a 2020 2020 2020 2020 2020  max",.          
-0001d310: 2020 6368 756e 6b3d 4d2e 6375 6d6d 6178    chunk=M.cummax
-0001d320: 2c0a 2020 2020 2020 2020 2020 2020 6167  ,.            ag
-0001d330: 6772 6567 6174 653d 6d65 7468 6f64 732e  gregate=methods.
-0001d340: 6375 6d6d 6178 5f61 6767 7265 6761 7465  cummax_aggregate
-0001d350: 2c0a 2020 2020 2020 2020 2020 2020 6178  ,.            ax
-0001d360: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
-0001d370: 2020 2020 2073 6b69 706e 613d 736b 6970       skipna=skip
-0001d380: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
-0001d390: 6368 756e 6b5f 6b77 6172 6773 3d64 6963  chunk_kwargs=dic
-0001d3a0: 7428 6178 6973 3d61 7869 732c 2073 6b69  t(axis=axis, ski
-0001d3b0: 706e 613d 736b 6970 6e61 292c 0a20 2020  pna=skipna),.   
-0001d3c0: 2020 2020 2020 2020 206f 7574 3d6f 7574           out=out
-0001d3d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0001d3e0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0001d3f0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0001d400: 2064 6566 2063 756d 6d69 6e28 7365 6c66   def cummin(self
-0001d410: 2c20 6178 6973 3d4e 6f6e 652c 2073 6b69  , axis=None, ski
-0001d420: 706e 613d 5472 7565 2c20 6f75 743d 4e6f  pna=True, out=No
-0001d430: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
-0001d440: 7572 6e20 7365 6c66 2e5f 6375 6d5f 6167  urn self._cum_ag
-0001d450: 6728 0a20 2020 2020 2020 2020 2020 2022  g(.            "
-0001d460: 6375 6d6d 696e 222c 0a20 2020 2020 2020  cummin",.       
-0001d470: 2020 2020 2063 6875 6e6b 3d4d 2e63 756d       chunk=M.cum
-0001d480: 6d69 6e2c 0a20 2020 2020 2020 2020 2020  min,.           
-0001d490: 2061 6767 7265 6761 7465 3d6d 6574 686f   aggregate=metho
-0001d4a0: 6473 2e63 756d 6d69 6e5f 6167 6772 6567  ds.cummin_aggreg
-0001d4b0: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
-0001d4c0: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
-0001d4d0: 2020 2020 2020 2020 736b 6970 6e61 3d73          skipna=s
-0001d4e0: 6b69 706e 612c 0a20 2020 2020 2020 2020  kipna,.         
-0001d4f0: 2020 2063 6875 6e6b 5f6b 7761 7267 733d     chunk_kwargs=
-0001d500: 6469 6374 2861 7869 733d 6178 6973 2c20  dict(axis=axis, 
-0001d510: 736b 6970 6e61 3d73 6b69 706e 6129 2c0a  skipna=skipna),.
-0001d520: 2020 2020 2020 2020 2020 2020 6f75 743d              out=
-0001d530: 6f75 742c 0a20 2020 2020 2020 2029 0a0a  out,.        )..
-0001d540: 2020 2020 6465 6620 5f76 616c 6964 6174      def _validat
-0001d550: 655f 636f 6e64 6974 696f 6e28 7365 6c66  e_condition(self
-0001d560: 2c20 636f 6e64 293a 0a20 2020 2020 2020  , cond):.       
-0001d570: 2069 6620 6e6f 7420 280a 2020 2020 2020   if not (.      
-0001d580: 2020 2020 2020 6973 5f64 6173 6b5f 636f        is_dask_co
-0001d590: 6c6c 6563 7469 6f6e 2863 6f6e 6429 0a20  llection(cond). 
-0001d5a0: 2020 2020 2020 2020 2020 206f 7220 6973             or is
-0001d5b0: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
-0001d5c0: 636f 6e64 290a 2020 2020 2020 2020 2020  cond).          
-0001d5d0: 2020 6f72 2069 735f 7365 7269 6573 5f6c    or is_series_l
-0001d5e0: 696b 6528 636f 6e64 290a 2020 2020 2020  ike(cond).      
-0001d5f0: 2020 2020 2020 6f72 2069 735f 696e 6465        or is_inde
-0001d600: 785f 6c69 6b65 2863 6f6e 6429 0a20 2020  x_like(cond).   
-0001d610: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-0001d620: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001d630: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0001d640: 2020 2020 2020 6622 436f 6e64 6974 696f        f"Conditio
-0001d650: 6e20 7368 6f75 6c64 2062 6520 616e 206f  n should be an o
-0001d660: 626a 6563 7420 7468 6174 2063 616e 2062  bject that can b
-0001d670: 6520 616c 6967 6e65 6420 7769 7468 207b  e aligned with {
-0001d680: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 7d2c  self.__class__},
-0001d690: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0001d6a0: 2020 2066 2220 7768 6963 6820 696e 636c     f" which incl
-0001d6b0: 7564 6573 2044 6173 6b20 6f72 2070 616e  udes Dask or pan
-0001d6c0: 6461 7320 636f 6c6c 6563 7469 6f6e 732c  das collections,
-0001d6d0: 2044 6174 6146 7261 6d65 7320 6f72 2053   DataFrames or S
-0001d6e0: 6572 6965 732e 220a 2020 2020 2020 2020  eries.".        
-0001d6f0: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
-0001d700: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0001d710: 4672 616d 6529 0a20 2020 2064 6566 2077  Frame).    def w
-0001d720: 6865 7265 2873 656c 662c 2063 6f6e 642c  here(self, cond,
-0001d730: 206f 7468 6572 3d6e 702e 6e61 6e29 3a0a   other=np.nan):.
-0001d740: 2020 2020 2020 2020 2320 636f 6e64 2061          # cond a
-0001d750: 6e64 206f 7468 6572 206d 6179 2062 6520  nd other may be 
-0001d760: 6461 736b 2069 6e73 7461 6e63 652c 0a20  dask instance,. 
-0001d770: 2020 2020 2020 2023 2070 6173 7369 6e67         # passing
-0001d780: 206d 6170 5f70 6172 7469 7469 6f6e 7320   map_partitions 
-0001d790: 7669 6120 6b65 7977 6f72 6420 7769 6c6c  via keyword will
-0001d7a0: 206e 6f74 2062 6520 616c 6967 6e65 640a   not be aligned.
-0001d7b0: 2020 2020 2020 2020 7365 6c66 2e5f 7661          self._va
-0001d7c0: 6c69 6461 7465 5f63 6f6e 6469 7469 6f6e  lidate_condition
-0001d7d0: 2863 6f6e 6429 0a20 2020 2020 2020 2072  (cond).        r
-0001d7e0: 6574 7572 6e20 6d61 705f 7061 7274 6974  eturn map_partit
-0001d7f0: 696f 6e73 284d 2e77 6865 7265 2c20 7365  ions(M.where, se
-0001d800: 6c66 2c20 636f 6e64 2c20 6f74 6865 722c  lf, cond, other,
-0001d810: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-0001d820: 613d 4661 6c73 6529 0a0a 2020 2020 4064  a=False)..    @d
-0001d830: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0001d840: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0001d850: 6620 6d61 736b 2873 656c 662c 2063 6f6e  f mask(self, con
-0001d860: 642c 206f 7468 6572 3d6e 702e 6e61 6e29  d, other=np.nan)
-0001d870: 3a0a 2020 2020 2020 2020 7365 6c66 2e5f  :.        self._
-0001d880: 7661 6c69 6461 7465 5f63 6f6e 6469 7469  validate_conditi
-0001d890: 6f6e 2863 6f6e 6429 0a20 2020 2020 2020  on(cond).       
-0001d8a0: 2072 6574 7572 6e20 6d61 705f 7061 7274   return map_part
-0001d8b0: 6974 696f 6e73 284d 2e6d 6173 6b2c 2073  itions(M.mask, s
-0001d8c0: 656c 662c 2063 6f6e 642c 206f 7468 6572  elf, cond, other
-0001d8d0: 2c20 656e 666f 7263 655f 6d65 7461 6461  , enforce_metada
-0001d8e0: 7461 3d46 616c 7365 290a 0a20 2020 2040  ta=False)..    @
-0001d8f0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0001d900: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0001d910: 6566 206e 6f74 6e75 6c6c 2873 656c 6629  ef notnull(self)
-0001d920: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0001d930: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-0001d940: 696f 6e73 284d 2e6e 6f74 6e75 6c6c 2c20  ions(M.notnull, 
-0001d950: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-0001d960: 3d46 616c 7365 290a 0a20 2020 2040 6465  =False)..    @de
-0001d970: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0001d980: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0001d990: 2069 736e 756c 6c28 7365 6c66 293a 0a20   isnull(self):. 
-0001d9a0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001d9b0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-0001d9c0: 7328 4d2e 6973 6e75 6c6c 2c20 656e 666f  s(M.isnull, enfo
-0001d9d0: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
-0001d9e0: 7365 290a 0a20 2020 2040 6465 7269 7665  se)..    @derive
-0001d9f0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-0001da00: 616d 6529 0a20 2020 2064 6566 2069 736e  ame).    def isn
-0001da10: 6128 7365 6c66 293a 0a20 2020 2020 2020  a(self):.       
-0001da20: 2069 6620 6861 7361 7474 7228 7064 2c20   if hasattr(pd, 
-0001da30: 2269 736e 6122 293a 0a20 2020 2020 2020  "isna"):.       
-0001da40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001da50: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-0001da60: 4d2e 6973 6e61 2c20 656e 666f 7263 655f  M.isna, enforce_
-0001da70: 6d65 7461 6461 7461 3d46 616c 7365 290a  metadata=False).
-0001da80: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001da90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001daa0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-0001dab0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0001dac0: 2020 2020 2022 4e65 6564 206d 6f72 6520       "Need more 
-0001dad0: 7265 6365 6e74 2076 6572 7369 6f6e 206f  recent version o
-0001dae0: 6620 5061 6e64 6173 2022 0a20 2020 2020  f Pandas ".     
-0001daf0: 2020 2020 2020 2020 2020 2022 746f 2073             "to s
-0001db00: 7570 706f 7274 2069 736e 612e 2022 0a20  upport isna. ". 
-0001db10: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001db20: 506c 6561 7365 2075 7365 2069 736e 756c  Please use isnul
-0001db30: 6c20 696e 7374 6561 642e 220a 2020 2020  l instead.".    
-0001db40: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-0001db50: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0001db60: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0001db70: 6566 2069 7369 6e28 7365 6c66 2c20 7661  ef isin(self, va
-0001db80: 6c75 6573 293a 0a20 2020 2020 2020 2069  lues):.        i
-0001db90: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
-0001dba0: 696b 6528 7365 6c66 2e5f 6d65 7461 293a  ike(self._meta):
-0001dbb0: 0a20 2020 2020 2020 2020 2020 2023 2044  .            # D
-0001dbc0: 6174 6146 7261 6d65 2e69 7369 6e20 646f  ataFrame.isin do
-0001dbd0: 6573 2077 6569 7264 2061 6c69 676e 6d65  es weird alignme
-0001dbe0: 6e74 2073 7475 6666 0a20 2020 2020 2020  nt stuff.       
-0001dbf0: 2020 2020 2062 6164 5f74 7970 6573 203d       bad_types =
-0001dc00: 2028 5f46 7261 6d65 2c20 7064 2e53 6572   (_Frame, pd.Ser
-0001dc10: 6965 732c 2070 642e 4461 7461 4672 616d  ies, pd.DataFram
-0001dc20: 6529 0a20 2020 2020 2020 2065 6c73 653a  e).        else:
-0001dc30: 0a20 2020 2020 2020 2020 2020 2062 6164  .            bad
-0001dc40: 5f74 7970 6573 203d 2028 5f46 7261 6d65  _types = (_Frame
-0001dc50: 2c29 0a20 2020 2020 2020 2069 6620 6973  ,).        if is
-0001dc60: 696e 7374 616e 6365 2876 616c 7565 732c  instance(values,
-0001dc70: 2062 6164 5f74 7970 6573 293a 0a20 2020   bad_types):.   
-0001dc80: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0001dc90: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0001dca0: 6f72 2822 5061 7373 696e 6720 6120 2572  or("Passing a %r
-0001dcb0: 2074 6f20 6069 7369 6e60 2220 2520 7479   to `isin`" % ty
-0001dcc0: 7065 6e61 6d65 2874 7970 6528 7661 6c75  pename(type(valu
-0001dcd0: 6573 2929 290a 2020 2020 2020 2020 6d65  es))).        me
-0001dce0: 7461 203d 2073 656c 662e 5f6d 6574 615f  ta = self._meta_
-0001dcf0: 6e6f 6e65 6d70 7479 2e69 7369 6e28 7661  nonempty.isin(va
-0001dd00: 6c75 6573 290a 2020 2020 2020 2020 2320  lues).        # 
-0001dd10: 5765 2077 7261 7020 7661 6c75 6573 2069  We wrap values i
-0001dd20: 6e20 6120 6465 6c61 7965 6420 666f 7220  n a delayed for 
-0001dd30: 7477 6f20 7265 6173 6f6e 733a 0a20 2020  two reasons:.   
-0001dd40: 2020 2020 2023 202d 2061 766f 6964 2073       # - avoid s
-0001dd50: 6572 6961 6c69 7a69 6e67 2064 6174 6120  erializing data 
-0001dd60: 696e 2065 7665 7279 2074 6173 6b0a 2020  in every task.  
-0001dd70: 2020 2020 2020 2320 2d20 6176 6f69 6420        # - avoid 
-0001dd80: 636f 7374 206f 6620 7472 6176 6572 7361  cost of traversa
-0001dd90: 6c20 6f66 206c 6172 6765 206c 6973 7420  l of large list 
-0001dda0: 696e 206f 7074 696d 697a 6174 696f 6e73  in optimizations
-0001ddb0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0001ddc0: 7374 616e 6365 2876 616c 7565 732c 206c  stance(values, l
-0001ddd0: 6973 7429 3a0a 2020 2020 2020 2020 2020  ist):.          
-0001dde0: 2020 2320 4d6f 7469 7661 7465 6420 6279    # Motivated by
-0001ddf0: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
-0001de00: 636f 6d2f 6461 736b 2f64 6173 6b2f 6973  com/dask/dask/is
-0001de10: 7375 6573 2f39 3431 312e 2020 5468 6973  sues/9411.  This
-0001de20: 2061 7070 6561 7273 2074 6f20 6265 0a20   appears to be. 
-0001de30: 2020 2020 2020 2020 2020 2023 2063 6175             # cau
-0001de40: 7365 6420 6279 2068 7474 7073 3a2f 2f67  sed by https://g
-0001de50: 6974 6875 622e 636f 6d2f 6461 736b 2f64  ithub.com/dask/d
-0001de60: 6973 7472 6962 7574 6564 2f69 7373 7565  istributed/issue
-0001de70: 732f 3633 3638 2c20 616e 6420 6675 7274  s/6368, and furt
-0001de80: 6865 720a 2020 2020 2020 2020 2020 2020  her.            
-0001de90: 2320 6578 6163 6572 6261 7465 6420 6279  # exacerbated by
-0001dea0: 2074 6865 2066 6163 7420 7468 6174 2074   the fact that t
-0001deb0: 6865 206c 6973 7420 636f 6e74 6169 6e73  he list contains
-0001dec0: 2064 7570 6c69 6361 7465 732e 2020 5468   duplicates.  Th
-0001ded0: 6973 2069 7320 6120 7061 7463 6820 756e  is is a patch un
-0001dee0: 7469 6c0a 2020 2020 2020 2020 2020 2020  til.            
-0001def0: 2320 7765 2063 616e 2063 7265 6174 6520  # we can create 
-0001df00: 6120 6265 7474 6572 2066 6978 2066 6f72  a better fix for
-0001df10: 2053 6572 6961 6c69 7a61 7469 6f6e 2e0a   Serialization..
-0001df20: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-0001df30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001df40: 2076 616c 7565 7320 3d20 6c69 7374 2873   values = list(s
-0001df50: 6574 2876 616c 7565 7329 290a 2020 2020  et(values)).    
-0001df60: 2020 2020 2020 2020 6578 6365 7074 2054          except T
-0001df70: 7970 6545 7272 6f72 3a0a 2020 2020 2020  ypeError:.      
-0001df80: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
-0001df90: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-0001dfa0: 7420 616e 7928 6973 5f64 6173 6b5f 636f  t any(is_dask_co
-0001dfb0: 6c6c 6563 7469 6f6e 2876 2920 666f 7220  llection(v) for 
-0001dfc0: 7620 696e 2076 616c 7565 7329 3a0a 2020  v in values):.  
-0001dfd0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-0001dfe0: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-0001dff0: 2020 2020 2020 2076 616c 7565 7320 3d20         values = 
-0001e000: 6e70 2e66 726f 6d69 7465 7228 7661 6c75  np.fromiter(valu
-0001e010: 6573 2c20 6474 7970 653d 6f62 6a65 6374  es, dtype=object
-0001e020: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001e030: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
-0001e040: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-0001e050: 2020 2020 2020 2020 2023 204e 756d 7079           # Numpy
-0001e060: 2031 2e32 3320 7375 7070 6f72 7473 2063   1.23 supports c
-0001e070: 7265 6174 696e 6720 6172 7261 7973 206f  reating arrays o
-0001e080: 6620 6974 6572 6162 6c65 732c 2077 6869  f iterables, whi
-0001e090: 6c65 206c 6f77 6572 0a20 2020 2020 2020  le lower.       
-0001e0a0: 2020 2020 2020 2020 2020 2020 2023 2076               # v
-0001e0b0: 6572 7369 6f6e 2031 2e32 312e 7820 616e  ersion 1.21.x an
-0001e0c0: 6420 312e 3232 2e78 2064 6f20 6e6f 740a  d 1.22.x do not.
-0001e0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e0e0: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
-0001e0f0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-0001e100: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-0001e110: 2020 2020 2020 2020 204d 2e69 7369 6e2c           M.isin,
-0001e120: 2064 656c 6179 6564 2876 616c 7565 7329   delayed(values)
-0001e130: 2c20 6d65 7461 3d6d 6574 612c 2065 6e66  , meta=meta, enf
-0001e140: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-0001e150: 6c73 650a 2020 2020 2020 2020 290a 0a20  lse.        ).. 
-0001e160: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0001e170: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0001e180: 2020 2064 6566 2061 7374 7970 6528 7365     def astype(se
-0001e190: 6c66 2c20 6474 7970 6529 3a0a 2020 2020  lf, dtype):.    
-0001e1a0: 2020 2020 2320 5858 583a 2050 616e 6461      # XXX: Panda
-0001e1b0: 7320 7769 6c6c 2073 6567 6661 756c 7420  s will segfault 
-0001e1c0: 666f 7220 656d 7074 7920 6461 7461 6672  for empty datafr
-0001e1d0: 616d 6573 2077 6865 6e20 7365 7474 696e  ames when settin
-0001e1e0: 670a 2020 2020 2020 2020 2320 6361 7465  g.        # cate
-0001e1f0: 676f 7269 6361 6c20 6474 7970 6573 2e20  gorical dtypes. 
-0001e200: 5468 6973 206f 7065 7261 7469 6f6e 2069  This operation i
-0001e210: 736e 2774 2061 6c6c 6f77 6564 2063 7572  sn't allowed cur
-0001e220: 7265 6e74 6c79 2061 6e79 7761 792e 2057  rently anyway. W
-0001e230: 650a 2020 2020 2020 2020 2320 6765 7420  e.        # get 
-0001e240: 7468 6520 6d65 7461 6461 7461 2077 6974  the metadata wit
-0001e250: 6820 6120 6e6f 6e2d 656d 7074 7920 6672  h a non-empty fr
-0001e260: 616d 6520 746f 2074 6872 6f77 2074 6865  ame to throw the
-0001e270: 2065 7272 6f72 2069 6e73 7465 6164 206f   error instead o
-0001e280: 660a 2020 2020 2020 2020 2320 7365 6766  f.        # segf
-0001e290: 6175 6c74 696e 672e 0a20 2020 2020 2020  aulting..       
-0001e2a0: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
-0001e2b0: 2020 6973 5f64 6174 6166 7261 6d65 5f6c    is_dataframe_l
-0001e2c0: 696b 6528 7365 6c66 2e5f 6d65 7461 290a  ike(self._meta).
-0001e2d0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-0001e2e0: 6e6f 7420 6861 7361 7474 7228 6474 7970  not hasattr(dtyp
-0001e2f0: 652c 2022 6974 656d 7322 290a 2020 2020  e, "items").    
-0001e300: 2020 2020 2020 2020 616e 6420 6973 696e          and isin
-0001e310: 7374 616e 6365 2870 642e 6170 692e 7479  stance(pd.api.ty
-0001e320: 7065 732e 7061 6e64 6173 5f64 7479 7065  pes.pandas_dtype
-0001e330: 2864 7479 7065 292c 2070 642e 4361 7465  (dtype), pd.Cate
-0001e340: 676f 7269 6361 6c44 7479 7065 290a 2020  goricalDtype).  
-0001e350: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-0001e360: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
-0001e370: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-0001e380: 6173 7479 7065 2864 7479 7065 290a 2020  astype(dtype).  
-0001e390: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001e3a0: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
-0001e3b0: 656c 662e 5f6d 6574 612e 6173 7479 7065  elf._meta.astype
-0001e3c0: 2864 7479 7065 290a 2020 2020 2020 2020  (dtype).        
-0001e3d0: 6966 2068 6173 6174 7472 2864 7479 7065  if hasattr(dtype
-0001e3e0: 2c20 2269 7465 6d73 2229 3a0a 2020 2020  , "items"):.    
-0001e3f0: 2020 2020 2020 2020 7365 745f 756e 6b6e          set_unkn
-0001e400: 6f77 6e20 3d20 5b0a 2020 2020 2020 2020  own = [.        
-0001e410: 2020 2020 2020 2020 6b0a 2020 2020 2020          k.      
-0001e420: 2020 2020 2020 2020 2020 666f 7220 6b2c            for k,
-0001e430: 2076 2069 6e20 6474 7970 652e 6974 656d   v in dtype.item
-0001e440: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
-0001e450: 2020 2020 6966 2028 6973 696e 7374 616e      if (isinstan
-0001e460: 6365 2870 642e 6170 692e 7479 7065 732e  ce(pd.api.types.
-0001e470: 7061 6e64 6173 5f64 7479 7065 2876 292c  pandas_dtype(v),
-0001e480: 2070 642e 4361 7465 676f 7269 6361 6c44   pd.CategoricalD
-0001e490: 7479 7065 2929 0a20 2020 2020 2020 2020  type)).         
-0001e4a0: 2020 2020 2020 2061 6e64 2067 6574 6174         and getat
-0001e4b0: 7472 2876 2c20 2263 6174 6567 6f72 6965  tr(v, "categorie
-0001e4c0: 7322 2c20 4e6f 6e65 2920 6973 204e 6f6e  s", None) is Non
-0001e4d0: 650a 2020 2020 2020 2020 2020 2020 5d0a  e.            ].
-0001e4e0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-0001e4f0: 203d 2063 6c65 6172 5f6b 6e6f 776e 5f63   = clear_known_c
-0001e500: 6174 6567 6f72 6965 7328 6d65 7461 2c20  ategories(meta, 
-0001e510: 636f 6c73 3d73 6574 5f75 6e6b 6e6f 776e  cols=set_unknown
-0001e520: 290a 2020 2020 2020 2020 656c 6966 2028  ).        elif (
-0001e530: 0a20 2020 2020 2020 2020 2020 2069 7369  .            isi
-0001e540: 6e73 7461 6e63 6528 7064 2e61 7069 2e74  nstance(pd.api.t
-0001e550: 7970 6573 2e70 616e 6461 735f 6474 7970  ypes.pandas_dtyp
-0001e560: 6528 6474 7970 6529 2c20 7064 2e43 6174  e(dtype), pd.Cat
-0001e570: 6567 6f72 6963 616c 4474 7970 6529 0a20  egoricalDtype). 
-0001e580: 2020 2020 2020 2029 2061 6e64 2067 6574         ) and get
-0001e590: 6174 7472 2864 7479 7065 2c20 2263 6174  attr(dtype, "cat
-0001e5a0: 6567 6f72 6965 7322 2c20 4e6f 6e65 2920  egories", None) 
-0001e5b0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0001e5c0: 2020 2020 206d 6574 6120 3d20 636c 6561       meta = clea
-0001e5d0: 725f 6b6e 6f77 6e5f 6361 7465 676f 7269  r_known_categori
-0001e5e0: 6573 286d 6574 6129 0a20 2020 2020 2020  es(meta).       
-0001e5f0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-0001e600: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-0001e610: 2020 2020 2020 2020 204d 2e61 7374 7970           M.astyp
-0001e620: 652c 2064 7479 7065 3d64 7479 7065 2c20  e, dtype=dtype, 
-0001e630: 6d65 7461 3d6d 6574 612c 2065 6e66 6f72  meta=meta, enfor
-0001e640: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-0001e650: 650a 2020 2020 2020 2020 290a 0a20 2020  e.        )..   
-0001e660: 2069 6620 6e6f 7420 5041 4e44 4153 5f47   if not PANDAS_G
-0001e670: 545f 3230 303a 0a0a 2020 2020 2020 2020  T_200:..        
-0001e680: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-0001e690: 2e53 6572 6965 7329 0a20 2020 2020 2020  .Series).       
-0001e6a0: 2064 6566 2061 7070 656e 6428 7365 6c66   def append(self
-0001e6b0: 2c20 6f74 6865 722c 2069 6e74 6572 6c65  , other, interle
-0001e6c0: 6176 655f 7061 7274 6974 696f 6e73 3d46  ave_partitions=F
-0001e6d0: 616c 7365 293a 0a20 2020 2020 2020 2020  alse):.         
-0001e6e0: 2020 2069 6620 5041 4e44 4153 5f47 545f     if PANDAS_GT_
-0001e6f0: 3134 303a 0a20 2020 2020 2020 2020 2020  140:.           
-0001e700: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-0001e710: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
-0001e720: 2020 2020 2020 2020 2254 6865 2066 7261          "The fra
-0001e730: 6d65 2e61 7070 656e 6420 6d65 7468 6f64  me.append method
-0001e740: 2069 7320 6465 7072 6563 6174 6564 2061   is deprecated a
-0001e750: 6e64 2077 696c 6c20 6265 2072 656d 6f76  nd will be remov
-0001e760: 6564 2066 726f 6d22 0a20 2020 2020 2020  ed from".       
-0001e770: 2020 2020 2020 2020 2020 2020 2022 6461               "da
-0001e780: 736b 2069 6e20 6120 6675 7475 7265 2076  sk in a future v
-0001e790: 6572 7369 6f6e 2e20 5573 6520 6461 736b  ersion. Use dask
-0001e7a0: 2e64 6174 6166 7261 6d65 2e63 6f6e 6361  .dataframe.conca
-0001e7b0: 7420 696e 7374 6561 642e 222c 0a20 2020  t instead.",.   
-0001e7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e7d0: 2046 7574 7572 6557 6172 6e69 6e67 2c0a   FutureWarning,.
-0001e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e7f0: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-0001e800: 6265 6361 7573 6520 4461 7461 4672 616d  because DataFram
-0001e810: 652e 6170 7065 6e64 2077 696c 6c20 6f76  e.append will ov
-0001e820: 6572 7269 6465 2074 6865 206d 6574 686f  erride the metho
-0001e830: 642c 0a20 2020 2020 2020 2020 2020 2023  d,.            #
-0001e840: 2077 7261 7020 6279 2070 642e 5365 7269   wrap by pd.Seri
-0001e850: 6573 2e61 7070 656e 6420 646f 6373 7472  es.append docstr
-0001e860: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
-0001e870: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
-0001e880: 616d 652e 6d75 6c74 6920 696d 706f 7274  ame.multi import
-0001e890: 2063 6f6e 6361 740a 0a20 2020 2020 2020   concat..       
-0001e8a0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0001e8b0: 6365 286f 7468 6572 2c20 286c 6973 742c  ce(other, (list,
-0001e8c0: 2064 6963 7429 293a 0a20 2020 2020 2020   dict)):.       
-0001e8d0: 2020 2020 2020 2020 206d 7367 203d 2022           msg = "
-0001e8e0: 6170 7065 6e64 2064 6f65 736e 2774 2073  append doesn't s
-0001e8f0: 7570 706f 7274 206c 6973 7420 6f72 2064  upport list or d
-0001e900: 6963 7420 696e 7075 7422 0a20 2020 2020  ict input".     
-0001e910: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001e920: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-0001e930: 7272 6f72 286d 7367 290a 0a20 2020 2020  rror(msg)..     
-0001e940: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
-0001e950: 6e63 6174 280a 2020 2020 2020 2020 2020  ncat(.          
-0001e960: 2020 2020 2020 5b73 656c 662c 206f 7468        [self, oth
-0001e970: 6572 5d2c 206a 6f69 6e3d 226f 7574 6572  er], join="outer
-0001e980: 222c 2069 6e74 6572 6c65 6176 655f 7061  ", interleave_pa
-0001e990: 7274 6974 696f 6e73 3d69 6e74 6572 6c65  rtitions=interle
-0001e9a0: 6176 655f 7061 7274 6974 696f 6e73 0a20  ave_partitions. 
-0001e9b0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0001e9c0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-0001e9d0: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-0001e9e0: 6566 2064 6f74 2873 656c 662c 206f 7468  ef dot(self, oth
-0001e9f0: 6572 2c20 6d65 7461 3d6e 6f5f 6465 6661  er, meta=no_defa
-0001ea00: 756c 7429 3a0a 2020 2020 2020 2020 6966  ult):.        if
-0001ea10: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0001ea20: 6f74 6865 722c 205f 4672 616d 6529 3a0a  other, _Frame):.
-0001ea30: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001ea40: 6520 5479 7065 4572 726f 7228 2254 6865  e TypeError("The
-0001ea50: 2073 6563 6f6e 6420 6f70 6572 616e 6420   second operand 
-0001ea60: 6d75 7374 2062 6520 6120 6461 736b 2061  must be a dask a
-0001ea70: 7272 6179 206f 7220 6461 736b 2064 6174  rray or dask dat
-0001ea80: 6166 7261 6d65 2229 0a0a 2020 2020 2020  aframe")..      
-0001ea90: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0001eaa0: 6f74 6865 722c 2044 6174 6146 7261 6d65  other, DataFrame
-0001eab0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-0001eac0: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
-0001ead0: 6974 696f 6e73 284d 2e64 6f74 2c20 6f74  itions(M.dot, ot
-0001eae0: 6865 722c 2074 6f6b 656e 3d22 646f 7422  her, token="dot"
-0001eaf0: 2c20 6d65 7461 3d6d 6574 6129 0a20 2020  , meta=meta).   
-0001eb00: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001eb10: 732e 6772 6f75 7062 7928 6279 3d73 2e69  s.groupby(by=s.i
-0001eb20: 6e64 6578 292e 6170 706c 7928 0a20 2020  ndex).apply(.   
-0001eb30: 2020 2020 2020 2020 2020 2020 206c 616d               lam
-0001eb40: 6264 6120 783a 2078 2e73 756d 2873 6b69  bda x: x.sum(ski
-0001eb50: 706e 613d 4661 6c73 6529 2c20 6d65 7461  pna=False), meta
-0001eb60: 3d73 2e5f 6d65 7461 5f6e 6f6e 656d 7074  =s._meta_nonempt
-0001eb70: 790a 2020 2020 2020 2020 2020 2020 290a  y.            ).
-0001eb80: 0a20 2020 2020 2020 2064 6566 205f 646f  .        def _do
-0001eb90: 745f 7365 7269 6573 282a 6172 6773 2c20  t_series(*args, 
-0001eba0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-0001ebb0: 2020 2020 2020 2023 202e 7375 6d28 2920         # .sum() 
-0001ebc0: 6973 2069 6e76 6f6b 6564 206f 6e20 6561  is invoked on ea
-0001ebd0: 6368 2070 6172 7469 7469 6f6e 2062 6566  ch partition bef
-0001ebe0: 6f72 6520 6265 696e 6720 6170 706c 6965  ore being applie
-0001ebf0: 6420 746f 2061 6c6c 0a20 2020 2020 2020  d to all.       
-0001ec00: 2020 2020 2023 2070 6172 7469 7469 6f6e       # partition
-0001ec10: 732e 2054 6865 2072 6574 7572 6e20 7479  s. The return ty
-0001ec20: 7065 2069 7320 6578 7065 6374 6564 2074  pe is expected t
-0001ec30: 6f20 6265 2061 2073 6572 6965 732c 206e  o be a series, n
-0001ec40: 6f74 2061 206e 756d 7079 206f 626a 6563  ot a numpy objec
-0001ec50: 740a 2020 2020 2020 2020 2020 2020 7265  t.            re
-0001ec60: 7475 726e 206d 6574 615f 7365 7269 6573  turn meta_series
-0001ec70: 5f63 6f6e 7374 7275 6374 6f72 2873 656c  _constructor(sel
-0001ec80: 6629 284d 2e64 6f74 282a 6172 6773 2c20  f)(M.dot(*args, 
-0001ec90: 2a2a 6b77 6172 6773 2929 0a0a 2020 2020  **kwargs))..    
-0001eca0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001ecb0: 6d61 705f 7061 7274 6974 696f 6e73 285f  map_partitions(_
-0001ecc0: 646f 745f 7365 7269 6573 2c20 6f74 6865  dot_series, othe
-0001ecd0: 722c 2074 6f6b 656e 3d22 646f 7422 2c20  r, token="dot", 
-0001ece0: 6d65 7461 3d6d 6574 6129 2e73 756d 280a  meta=meta).sum(.
-0001ecf0: 2020 2020 2020 2020 2020 2020 736b 6970              skip
-0001ed00: 6e61 3d46 616c 7365 0a20 2020 2020 2020  na=False.       
-0001ed10: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
-0001ed20: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0001ed30: 6d65 290a 2020 2020 6465 6620 616c 6967  me).    def alig
-0001ed40: 6e28 7365 6c66 2c20 6f74 6865 722c 206a  n(self, other, j
-0001ed50: 6f69 6e3d 226f 7574 6572 222c 2061 7869  oin="outer", axi
-0001ed60: 733d 4e6f 6e65 2c20 6669 6c6c 5f76 616c  s=None, fill_val
-0001ed70: 7565 3d4e 6f6e 6529 3a0a 2020 2020 2020  ue=None):.      
-0001ed80: 2020 6d65 7461 312c 206d 6574 6132 203d    meta1, meta2 =
-0001ed90: 205f 656d 756c 6174 6528 0a20 2020 2020   _emulate(.     
-0001eda0: 2020 2020 2020 204d 2e61 6c69 676e 2c20         M.align, 
-0001edb0: 7365 6c66 2c20 6f74 6865 722c 206a 6f69  self, other, joi
-0001edc0: 6e2c 2061 7869 733d 6178 6973 2c20 6669  n, axis=axis, fi
-0001edd0: 6c6c 5f76 616c 7565 3d66 696c 6c5f 7661  ll_value=fill_va
-0001ede0: 6c75 650a 2020 2020 2020 2020 290a 2020  lue.        ).  
-0001edf0: 2020 2020 2020 616c 6967 6e65 6420 3d20        aligned = 
-0001ee00: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-0001ee10: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-0001ee20: 204d 2e61 6c69 676e 2c0a 2020 2020 2020   M.align,.      
-0001ee30: 2020 2020 2020 6f74 6865 722c 0a20 2020        other,.   
-0001ee40: 2020 2020 2020 2020 206a 6f69 6e3d 6a6f           join=jo
-0001ee50: 696e 2c0a 2020 2020 2020 2020 2020 2020  in,.            
-0001ee60: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
-0001ee70: 2020 2020 2020 2066 696c 6c5f 7661 6c75         fill_valu
-0001ee80: 653d 6669 6c6c 5f76 616c 7565 2c0a 2020  e=fill_value,.  
-0001ee90: 2020 2020 2020 2020 2020 656e 666f 7263            enforc
-0001eea0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-0001eeb0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0001eec0: 2020 2020 2074 6f6b 656e 203d 2074 6f6b       token = tok
-0001eed0: 656e 697a 6528 7365 6c66 2c20 6f74 6865  enize(self, othe
-0001eee0: 722c 206a 6f69 6e2c 2061 7869 732c 2066  r, join, axis, f
-0001eef0: 696c 6c5f 7661 6c75 6529 0a0a 2020 2020  ill_value)..    
-0001ef00: 2020 2020 6e61 6d65 3120 3d20 2261 6c69      name1 = "ali
-0001ef10: 676e 312d 2220 2b20 746f 6b65 6e0a 2020  gn1-" + token.  
-0001ef20: 2020 2020 2020 6473 6b31 203d 207b 0a20        dsk1 = {. 
-0001ef30: 2020 2020 2020 2020 2020 2028 6e61 6d65             (name
-0001ef40: 312c 2069 293a 2028 6765 7469 7465 6d2c  1, i): (getitem,
-0001ef50: 206b 6579 2c20 3029 0a20 2020 2020 2020   key, 0).       
-0001ef60: 2020 2020 2066 6f72 2069 2c20 6b65 7920       for i, key 
-0001ef70: 696e 2065 6e75 6d65 7261 7465 2861 6c69  in enumerate(ali
-0001ef80: 676e 6564 2e5f 5f64 6173 6b5f 6b65 7973  gned.__dask_keys
-0001ef90: 5f5f 2829 290a 2020 2020 2020 2020 7d0a  __()).        }.
-0001efa0: 2020 2020 2020 2020 6473 6b31 2e75 7064          dsk1.upd
-0001efb0: 6174 6528 616c 6967 6e65 642e 6461 736b  ate(aligned.dask
-0001efc0: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
-0001efd0: 3120 3d20 6e65 775f 6464 5f6f 626a 6563  1 = new_dd_objec
-0001efe0: 7428 6473 6b31 2c20 6e61 6d65 312c 206d  t(dsk1, name1, m
-0001eff0: 6574 6131 2c20 616c 6967 6e65 642e 6469  eta1, aligned.di
-0001f000: 7669 7369 6f6e 7329 0a0a 2020 2020 2020  visions)..      
-0001f010: 2020 6e61 6d65 3220 3d20 2261 6c69 676e    name2 = "align
-0001f020: 322d 2220 2b20 746f 6b65 6e0a 2020 2020  2-" + token.    
-0001f030: 2020 2020 6473 6b32 203d 207b 0a20 2020      dsk2 = {.   
-0001f040: 2020 2020 2020 2020 2028 6e61 6d65 322c           (name2,
-0001f050: 2069 293a 2028 6765 7469 7465 6d2c 206b   i): (getitem, k
-0001f060: 6579 2c20 3129 0a20 2020 2020 2020 2020  ey, 1).         
-0001f070: 2020 2066 6f72 2069 2c20 6b65 7920 696e     for i, key in
-0001f080: 2065 6e75 6d65 7261 7465 2861 6c69 676e   enumerate(align
-0001f090: 6564 2e5f 5f64 6173 6b5f 6b65 7973 5f5f  ed.__dask_keys__
-0001f0a0: 2829 290a 2020 2020 2020 2020 7d0a 2020  ()).        }.  
-0001f0b0: 2020 2020 2020 6473 6b32 2e75 7064 6174        dsk2.updat
-0001f0c0: 6528 616c 6967 6e65 642e 6461 736b 290a  e(aligned.dask).
-0001f0d0: 2020 2020 2020 2020 7265 7375 6c74 3220          result2 
-0001f0e0: 3d20 6e65 775f 6464 5f6f 626a 6563 7428  = new_dd_object(
-0001f0f0: 6473 6b32 2c20 6e61 6d65 322c 206d 6574  dsk2, name2, met
-0001f100: 6132 2c20 616c 6967 6e65 642e 6469 7669  a2, aligned.divi
-0001f110: 7369 6f6e 7329 0a0a 2020 2020 2020 2020  sions)..        
-0001f120: 7265 7475 726e 2072 6573 756c 7431 2c20  return result1, 
-0001f130: 7265 7375 6c74 320a 0a20 2020 2040 6465  result2..    @de
-0001f140: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0001f150: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0001f160: 2063 6f6d 6269 6e65 2873 656c 662c 206f   combine(self, o
-0001f170: 7468 6572 2c20 6675 6e63 2c20 6669 6c6c  ther, func, fill
-0001f180: 5f76 616c 7565 3d4e 6f6e 652c 206f 7665  _value=None, ove
-0001f190: 7277 7269 7465 3d54 7275 6529 3a0a 2020  rwrite=True):.  
-0001f1a0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0001f1b0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-0001f1c0: 280a 2020 2020 2020 2020 2020 2020 4d2e  (.            M.
-0001f1d0: 636f 6d62 696e 652c 206f 7468 6572 2c20  combine, other, 
-0001f1e0: 6675 6e63 2c20 6669 6c6c 5f76 616c 7565  func, fill_value
-0001f1f0: 3d66 696c 6c5f 7661 6c75 652c 206f 7665  =fill_value, ove
-0001f200: 7277 7269 7465 3d6f 7665 7277 7269 7465  rwrite=overwrite
-0001f210: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0001f220: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-0001f230: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-0001f240: 6465 6620 636f 6d62 696e 655f 6669 7273  def combine_firs
-0001f250: 7428 7365 6c66 2c20 6f74 6865 7229 3a0a  t(self, other):.
-0001f260: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001f270: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-0001f280: 6e73 284d 2e63 6f6d 6269 6e65 5f66 6972  ns(M.combine_fir
-0001f290: 7374 2c20 6f74 6865 7229 0a0a 2020 2020  st, other)..    
-0001f2a0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
-0001f2b0: 2064 6566 205f 6269 6e64 5f6f 7065 7261   def _bind_opera
-0001f2c0: 746f 725f 6d65 7468 6f64 2863 6c73 2c20  tor_method(cls, 
-0001f2d0: 6e61 6d65 2c20 6f70 2c20 6f72 6967 696e  name, op, origin
-0001f2e0: 616c 3d70 642e 4461 7461 4672 616d 6529  al=pd.DataFrame)
-0001f2f0: 3a0a 2020 2020 2020 2020 2222 2262 696e  :.        """bin
-0001f300: 6420 6f70 6572 6174 6f72 206d 6574 686f  d operator metho
-0001f310: 6420 6c69 6b65 2044 6174 6146 7261 6d65  d like DataFrame
-0001f320: 2e61 6464 2074 6f20 7468 6973 2063 6c61  .add to this cla
-0001f330: 7373 2222 220a 2020 2020 2020 2020 7261  ss""".        ra
-0001f340: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-0001f350: 6564 4572 726f 720a 0a20 2020 2040 6465  edError..    @de
-0001f360: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0001f370: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0001f380: 2072 6573 616d 706c 6528 7365 6c66 2c20   resample(self, 
-0001f390: 7275 6c65 2c20 636c 6f73 6564 3d4e 6f6e  rule, closed=Non
-0001f3a0: 652c 206c 6162 656c 3d4e 6f6e 6529 3a0a  e, label=None):.
-0001f3b0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-0001f3c0: 6b2e 6461 7461 6672 616d 652e 7473 6572  k.dataframe.tser
-0001f3d0: 6965 732e 7265 7361 6d70 6c65 2069 6d70  ies.resample imp
-0001f3e0: 6f72 7420 5265 7361 6d70 6c65 720a 0a20  ort Resampler.. 
-0001f3f0: 2020 2020 2020 2072 6574 7572 6e20 5265         return Re
-0001f400: 7361 6d70 6c65 7228 7365 6c66 2c20 7275  sampler(self, ru
-0001f410: 6c65 2c20 636c 6f73 6564 3d63 6c6f 7365  le, closed=close
-0001f420: 642c 206c 6162 656c 3d6c 6162 656c 290a  d, label=label).
-0001f430: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0001f440: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0001f450: 0a20 2020 2064 6566 2066 6972 7374 2873  .    def first(s
-0001f460: 656c 662c 206f 6666 7365 7429 3a0a 2020  elf, offset):.  
-0001f470: 2020 2020 2020 2320 4c65 7420 7061 6e64        # Let pand
-0001f480: 6173 2065 7272 6f72 206f 6e20 6261 6420  as error on bad 
-0001f490: 6172 6773 0a20 2020 2020 2020 2073 656c  args.        sel
-0001f4a0: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
-0001f4b0: 2e66 6972 7374 286f 6666 7365 7429 0a0a  .first(offset)..
-0001f4c0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-0001f4d0: 656c 662e 6b6e 6f77 6e5f 6469 7669 7369  elf.known_divisi
-0001f4e0: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
-0001f4f0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0001f500: 7228 2260 6669 7273 7460 2069 7320 6e6f  r("`first` is no
-0001f510: 7420 696d 706c 656d 656e 7465 6420 666f  t implemented fo
-0001f520: 7220 756e 6b6e 6f77 6e20 6469 7669 7369  r unknown divisi
-0001f530: 6f6e 7322 290a 0a20 2020 2020 2020 206f  ons")..        o
-0001f540: 6666 7365 7420 3d20 7064 2e74 7365 7269  ffset = pd.tseri
-0001f550: 6573 2e66 7265 7175 656e 6369 6573 2e74  es.frequencies.t
-0001f560: 6f5f 6f66 6673 6574 286f 6666 7365 7429  o_offset(offset)
-0001f570: 0a20 2020 2020 2020 2064 6174 6520 3d20  .        date = 
-0001f580: 7365 6c66 2e64 6976 6973 696f 6e73 5b30  self.divisions[0
-0001f590: 5d20 2b20 6f66 6673 6574 0a20 2020 2020  ] + offset.     
-0001f5a0: 2020 2065 6e64 203d 2073 656c 662e 6c6f     end = self.lo
-0001f5b0: 632e 5f67 6574 5f70 6172 7469 7469 6f6e  c._get_partition
-0001f5c0: 7328 6461 7465 290a 0a20 2020 2020 2020  s(date)..       
-0001f5d0: 2069 735f 616e 6368 6f72 6564 203d 206f   is_anchored = o
-0001f5e0: 6666 7365 742e 6973 5f61 6e63 686f 7265  ffset.is_anchore
-0001f5f0: 6428 290a 0a20 2020 2020 2020 2069 6e63  d()..        inc
-0001f600: 6c75 6465 5f72 6967 6874 203d 2069 735f  lude_right = is_
-0001f610: 616e 6368 6f72 6564 206f 7220 6e6f 7420  anchored or not 
-0001f620: 6861 7361 7474 7228 6f66 6673 6574 2c20  hasattr(offset, 
-0001f630: 2264 656c 7461 2229 0a0a 2020 2020 2020  "delta")..      
-0001f640: 2020 6966 2065 6e64 203d 3d20 7365 6c66    if end == self
-0001f650: 2e6e 7061 7274 6974 696f 6e73 202d 2031  .npartitions - 1
-0001f660: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-0001f670: 7673 203d 2073 656c 662e 6469 7669 7369  vs = self.divisi
-0001f680: 6f6e 730a 2020 2020 2020 2020 656c 7365  ons.        else
-0001f690: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-0001f6a0: 7673 203d 2073 656c 662e 6469 7669 7369  vs = self.divisi
-0001f6b0: 6f6e 735b 3a20 656e 6420 2b20 315d 202b  ons[: end + 1] +
-0001f6c0: 2028 6461 7465 2c29 0a0a 2020 2020 2020   (date,)..      
-0001f6d0: 2020 6e61 6d65 203d 2022 6669 7273 742d    name = "first-
-0001f6e0: 2220 2b20 746f 6b65 6e69 7a65 2873 656c  " + tokenize(sel
-0001f6f0: 662c 206f 6666 7365 7429 0a20 2020 2020  f, offset).     
-0001f700: 2020 2064 736b 203d 207b 286e 616d 652c     dsk = {(name,
-0001f710: 2069 293a 2028 7365 6c66 2e5f 6e61 6d65   i): (self._name
-0001f720: 2c20 6929 2066 6f72 2069 2069 6e20 7261  , i) for i in ra
-0001f730: 6e67 6528 656e 6429 7d0a 2020 2020 2020  nge(end)}.      
-0001f740: 2020 6473 6b5b 286e 616d 652c 2065 6e64    dsk[(name, end
-0001f750: 295d 203d 2028 0a20 2020 2020 2020 2020  )] = (.         
-0001f760: 2020 206d 6574 686f 6473 2e62 6f75 6e64     methods.bound
-0001f770: 6172 795f 736c 6963 652c 0a20 2020 2020  ary_slice,.     
-0001f780: 2020 2020 2020 2028 7365 6c66 2e5f 6e61         (self._na
-0001f790: 6d65 2c20 656e 6429 2c0a 2020 2020 2020  me, end),.      
-0001f7a0: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-0001f7b0: 2020 2020 2020 2020 6461 7465 2c0a 2020          date,.  
-0001f7c0: 2020 2020 2020 2020 2020 696e 636c 7564            includ
-0001f7d0: 655f 7269 6768 742c 0a20 2020 2020 2020  e_right,.       
-0001f7e0: 2020 2020 2054 7275 652c 0a20 2020 2020       True,.     
-0001f7f0: 2020 2029 0a20 2020 2020 2020 2067 7261     ).        gra
-0001f800: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
-0001f810: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
-0001f820: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
-0001f830: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
-0001f840: 6c66 5d29 0a20 2020 2020 2020 2072 6574  lf]).        ret
-0001f850: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
-0001f860: 7428 6772 6170 682c 206e 616d 652c 2073  t(graph, name, s
-0001f870: 656c 662c 2064 6976 7329 0a0a 2020 2020  elf, divs)..    
-0001f880: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-0001f890: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-0001f8a0: 6465 6620 6c61 7374 2873 656c 662c 206f  def last(self, o
-0001f8b0: 6666 7365 7429 3a0a 2020 2020 2020 2020  ffset):.        
-0001f8c0: 2320 4c65 7420 7061 6e64 6173 2065 7272  # Let pandas err
-0001f8d0: 6f72 206f 6e20 6261 6420 6172 6773 0a20  or on bad args. 
-0001f8e0: 2020 2020 2020 2073 656c 662e 5f6d 6574         self._met
-0001f8f0: 615f 6e6f 6e65 6d70 7479 2e66 6972 7374  a_nonempty.first
-0001f900: 286f 6666 7365 7429 0a0a 2020 2020 2020  (offset)..      
-0001f910: 2020 6966 206e 6f74 2073 656c 662e 6b6e    if not self.kn
-0001f920: 6f77 6e5f 6469 7669 7369 6f6e 733a 0a20  own_divisions:. 
-0001f930: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001f940: 2056 616c 7565 4572 726f 7228 2260 6c61   ValueError("`la
-0001f950: 7374 6020 6973 206e 6f74 2069 6d70 6c65  st` is not imple
-0001f960: 6d65 6e74 6564 2066 6f72 2075 6e6b 6e6f  mented for unkno
-0001f970: 776e 2064 6976 6973 696f 6e73 2229 0a0a  wn divisions")..
-0001f980: 2020 2020 2020 2020 6f66 6673 6574 203d          offset =
-0001f990: 2070 642e 7473 6572 6965 732e 6672 6571   pd.tseries.freq
-0001f9a0: 7565 6e63 6965 732e 746f 5f6f 6666 7365  uencies.to_offse
-0001f9b0: 7428 6f66 6673 6574 290a 2020 2020 2020  t(offset).      
-0001f9c0: 2020 6461 7465 203d 2073 656c 662e 6469    date = self.di
-0001f9d0: 7669 7369 6f6e 735b 2d31 5d20 2d20 6f66  visions[-1] - of
-0001f9e0: 6673 6574 0a20 2020 2020 2020 2073 7461  fset.        sta
-0001f9f0: 7274 203d 2073 656c 662e 6c6f 632e 5f67  rt = self.loc._g
-0001fa00: 6574 5f70 6172 7469 7469 6f6e 7328 6461  et_partitions(da
-0001fa10: 7465 290a 0a20 2020 2020 2020 2069 6620  te)..        if 
-0001fa20: 7374 6172 7420 3d3d 2030 3a0a 2020 2020  start == 0:.    
-0001fa30: 2020 2020 2020 2020 6469 7673 203d 2073          divs = s
-0001fa40: 656c 662e 6469 7669 7369 6f6e 730a 2020  elf.divisions.  
-0001fa50: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001fa60: 2020 2020 2020 2020 6469 7673 203d 2028          divs = (
-0001fa70: 6461 7465 2c29 202b 2073 656c 662e 6469  date,) + self.di
-0001fa80: 7669 7369 6f6e 735b 7374 6172 7420 2b20  visions[start + 
-0001fa90: 3120 3a5d 0a0a 2020 2020 2020 2020 6e61  1 :]..        na
-0001faa0: 6d65 203d 2022 6c61 7374 2d22 202b 2074  me = "last-" + t
-0001fab0: 6f6b 656e 697a 6528 7365 6c66 2c20 6f66  okenize(self, of
-0001fac0: 6673 6574 290a 2020 2020 2020 2020 6473  fset).        ds
-0001fad0: 6b20 3d20 7b0a 2020 2020 2020 2020 2020  k = {.          
-0001fae0: 2020 286e 616d 652c 2069 202b 2031 293a    (name, i + 1):
-0001faf0: 2028 7365 6c66 2e5f 6e61 6d65 2c20 6a20   (self._name, j 
-0001fb00: 2b20 3129 0a20 2020 2020 2020 2020 2020  + 1).           
-0001fb10: 2066 6f72 2069 2c20 6a20 696e 2065 6e75   for i, j in enu
-0001fb20: 6d65 7261 7465 2872 616e 6765 2873 7461  merate(range(sta
-0001fb30: 7274 2c20 7365 6c66 2e6e 7061 7274 6974  rt, self.npartit
-0001fb40: 696f 6e73 2929 0a20 2020 2020 2020 207d  ions)).        }
-0001fb50: 0a20 2020 2020 2020 2064 736b 5b28 6e61  .        dsk[(na
-0001fb60: 6d65 2c20 3029 5d20 3d20 280a 2020 2020  me, 0)] = (.    
-0001fb70: 2020 2020 2020 2020 6d65 7468 6f64 732e          methods.
-0001fb80: 626f 756e 6461 7279 5f73 6c69 6365 2c0a  boundary_slice,.
-0001fb90: 2020 2020 2020 2020 2020 2020 2873 656c              (sel
-0001fba0: 662e 5f6e 616d 652c 2073 7461 7274 292c  f._name, start),
-0001fbb0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-0001fbc0: 652c 0a20 2020 2020 2020 2020 2020 204e  e,.            N
-0001fbd0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0001fbe0: 2054 7275 652c 0a20 2020 2020 2020 2020   True,.         
-0001fbf0: 2020 2046 616c 7365 2c0a 2020 2020 2020     False,.      
-0001fc00: 2020 290a 2020 2020 2020 2020 6772 6170    ).        grap
-0001fc10: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
-0001fc20: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
-0001fc30: 6f6e 7328 6e61 6d65 2c20 6473 6b2c 2064  ons(name, dsk, d
-0001fc40: 6570 656e 6465 6e63 6965 733d 5b73 656c  ependencies=[sel
-0001fc50: 665d 290a 2020 2020 2020 2020 7265 7475  f]).        retu
-0001fc60: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
-0001fc70: 2867 7261 7068 2c20 6e61 6d65 2c20 7365  (graph, name, se
-0001fc80: 6c66 2c20 6469 7673 290a 0a20 2020 2064  lf, divs)..    d
-0001fc90: 6566 206e 756e 6971 7565 5f61 7070 726f  ef nunique_appro
-0001fca0: 7828 7365 6c66 2c20 7370 6c69 745f 6576  x(self, split_ev
-0001fcb0: 6572 793d 4e6f 6e65 293a 0a20 2020 2020  ery=None):.     
-0001fcc0: 2020 2022 2222 4170 7072 6f78 696d 6174     """Approximat
-0001fcd0: 6520 6e75 6d62 6572 206f 6620 756e 6971  e number of uniq
-0001fce0: 7565 2072 6f77 732e 0a0a 2020 2020 2020  ue rows...      
-0001fcf0: 2020 5468 6973 206d 6574 686f 6420 7573    This method us
-0001fd00: 6573 2074 6865 2048 7970 6572 4c6f 674c  es the HyperLogL
-0001fd10: 6f67 2061 6c67 6f72 6974 686d 2066 6f72  og algorithm for
-0001fd20: 2063 6172 6469 6e61 6c69 7479 0a20 2020   cardinality.   
-0001fd30: 2020 2020 2065 7374 696d 6174 696f 6e20       estimation 
-0001fd40: 746f 2063 6f6d 7075 7465 2074 6865 2061  to compute the a
-0001fd50: 7070 726f 7869 6d61 7465 206e 756d 6265  pproximate numbe
-0001fd60: 7220 6f66 2075 6e69 7175 6520 726f 7773  r of unique rows
-0001fd70: 2e0a 2020 2020 2020 2020 5468 6520 6170  ..        The ap
-0001fd80: 7072 6f78 696d 6174 6520 6572 726f 7220  proximate error 
-0001fd90: 6973 2030 2e34 3036 252e 0a0a 2020 2020  is 0.406%...    
-0001fda0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-0001fdb0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0001fdc0: 2d0a 2020 2020 2020 2020 7370 6c69 745f  -.        split_
-0001fdd0: 6576 6572 7920 3a20 696e 742c 206f 7074  every : int, opt
-0001fde0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0001fdf0: 2020 4772 6f75 7020 7061 7274 6974 696f    Group partitio
-0001fe00: 6e73 2069 6e74 6f20 6772 6f75 7073 206f  ns into groups o
-0001fe10: 6620 7468 6973 2073 697a 6520 7768 696c  f this size whil
-0001fe20: 6520 7065 7266 6f72 6d69 6e67 2061 0a20  e performing a. 
-0001fe30: 2020 2020 2020 2020 2020 2074 7265 652d             tree-
-0001fe40: 7265 6475 6374 696f 6e2e 2049 6620 7365  reduction. If se
-0001fe50: 7420 746f 2046 616c 7365 2c20 6e6f 2074  t to False, no t
-0001fe60: 7265 652d 7265 6475 6374 696f 6e20 7769  ree-reduction wi
-0001fe70: 6c6c 2062 6520 7573 6564 2e0a 2020 2020  ll be used..    
-0001fe80: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
-0001fe90: 6973 2038 2e0a 0a20 2020 2020 2020 2052  is 8...        R
-0001fea0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-0001feb0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2061  ------.        a
-0001fec0: 2066 6c6f 6174 2072 6570 7265 7365 6e74   float represent
-0001fed0: 696e 6720 7468 6520 6170 7072 6f78 696d  ing the approxim
-0001fee0: 6174 6520 6e75 6d62 6572 206f 6620 656c  ate number of el
-0001fef0: 656d 656e 7473 0a20 2020 2020 2020 2022  ements.        "
-0001ff00: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
-0001ff10: 6461 736b 2e64 6174 6166 7261 6d65 2069  dask.dataframe i
-0001ff20: 6d70 6f72 7420 6879 7065 726c 6f67 6c6f  mport hyperloglo
-0001ff30: 6720 2023 2068 6572 6520 746f 2061 766f  g  # here to avo
-0001ff40: 6964 2063 6972 6375 6c61 7220 696d 706f  id circular impo
-0001ff50: 7274 2069 7373 7565 730a 0a20 2020 2020  rt issues..     
-0001ff60: 2020 2072 6574 7572 6e20 6163 6128 0a20     return aca(. 
-0001ff70: 2020 2020 2020 2020 2020 205b 7365 6c66             [self
-0001ff80: 5d2c 0a20 2020 2020 2020 2020 2020 2063  ],.            c
-0001ff90: 6875 6e6b 3d68 7970 6572 6c6f 676c 6f67  hunk=hyperloglog
-0001ffa0: 2e63 6f6d 7075 7465 5f68 6c6c 5f61 7272  .compute_hll_arr
-0001ffb0: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
-0001ffc0: 636f 6d62 696e 653d 6879 7065 726c 6f67  combine=hyperlog
-0001ffd0: 6c6f 672e 7265 6475 6365 5f73 7461 7465  log.reduce_state
-0001ffe0: 2c0a 2020 2020 2020 2020 2020 2020 6167  ,.            ag
-0001fff0: 6772 6567 6174 653d 6879 7065 726c 6f67  gregate=hyperlog
-00020000: 6c6f 672e 6573 7469 6d61 7465 5f63 6f75  log.estimate_cou
-00020010: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-00020020: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00020030: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
-00020040: 2020 2020 2062 3d31 362c 0a20 2020 2020       b=16,.     
-00020050: 2020 2020 2020 206d 6574 613d 666c 6f61         meta=floa
-00020060: 742c 0a20 2020 2020 2020 2029 0a0a 2020  t,.        )..  
-00020070: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00020080: 6465 6620 7661 6c75 6573 2873 656c 6629  def values(self)
-00020090: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-000200a0: 7572 6e20 6120 6461 736b 2e61 7272 6179  urn a dask.array
-000200b0: 206f 6620 7468 6520 7661 6c75 6573 206f   of the values o
-000200c0: 6620 7468 6973 2064 6174 6166 7261 6d65  f this dataframe
-000200d0: 0a0a 2020 2020 2020 2020 5761 726e 696e  ..        Warnin
-000200e0: 673a 2054 6869 7320 6372 6561 7465 7320  g: This creates 
-000200f0: 6120 6461 736b 2e61 7272 6179 2077 6974  a dask.array wit
-00020100: 686f 7574 2070 7265 6369 7365 2073 6861  hout precise sha
-00020110: 7065 2069 6e66 6f72 6d61 7469 6f6e 2e0a  pe information..
-00020120: 2020 2020 2020 2020 4f70 6572 6174 696f          Operatio
-00020130: 6e73 2074 6861 7420 6465 7065 6e64 206f  ns that depend o
-00020140: 6e20 7368 6170 6520 696e 666f 726d 6174  n shape informat
-00020150: 696f 6e2c 206c 696b 6520 736c 6963 696e  ion, like slicin
-00020160: 6720 6f72 2072 6573 6861 7069 6e67 2c0a  g or reshaping,.
-00020170: 2020 2020 2020 2020 7769 6c6c 206e 6f74          will not
-00020180: 2077 6f72 6b2e 0a20 2020 2020 2020 2022   work..        "
-00020190: 2222 0a20 2020 2020 2020 2069 6620 6973  "".        if is
-000201a0: 5f65 7874 656e 7369 6f6e 5f61 7272 6179  _extension_array
-000201b0: 5f64 7479 7065 2873 656c 662e 5f6d 6574  _dtype(self._met
-000201c0: 612e 7661 6c75 6573 293a 0a20 2020 2020  a.values):.     
-000201d0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-000201e0: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
-000201f0: 2020 2020 2020 2244 6173 6b20 6375 7272        "Dask curr
-00020200: 656e 746c 7920 6861 7320 6c69 6d69 7465  ently has limite
-00020210: 6420 7375 7070 6f72 7420 666f 7220 636f  d support for co
-00020220: 6e76 6572 7469 6e67 2070 616e 6461 7320  nverting pandas 
-00020230: 6578 7465 6e73 696f 6e20 6474 7970 6573  extension dtypes
-00020240: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00020250: 2020 2066 2274 6f20 6172 7261 7973 2e20     f"to arrays. 
-00020260: 436f 6e76 6572 7469 6e67 207b 7365 6c66  Converting {self
-00020270: 2e5f 6d65 7461 2e76 616c 7565 732e 6474  ._meta.values.dt
-00020280: 7970 657d 2074 6f20 6f62 6a65 6374 2064  ype} to object d
-00020290: 7479 7065 2e22 2c0a 2020 2020 2020 2020  type.",.        
-000202a0: 2020 2020 2020 2020 5573 6572 5761 726e          UserWarn
-000202b0: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
-000202c0: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-000202d0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
-000202e0: 7469 6f6e 7328 6d65 7468 6f64 732e 7661  tions(methods.va
-000202f0: 6c75 6573 290a 0a20 2020 2064 6566 205f  lues)..    def _
-00020300: 7661 6c69 6461 7465 5f63 6875 6e6b 7328  validate_chunks(
-00020310: 7365 6c66 2c20 6172 722c 206c 656e 6774  self, arr, lengt
-00020320: 6873 293a 0a20 2020 2020 2020 2066 726f  hs):.        fro
-00020330: 6d20 6461 736b 2e61 7272 6179 2e63 6f72  m dask.array.cor
-00020340: 6520 696d 706f 7274 206e 6f72 6d61 6c69  e import normali
-00020350: 7a65 5f63 6875 6e6b 730a 0a20 2020 2020  ze_chunks..     
-00020360: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00020370: 286c 656e 6774 6873 2c20 5365 7175 656e  (lengths, Sequen
-00020380: 6365 293a 0a20 2020 2020 2020 2020 2020  ce):.           
-00020390: 206c 656e 6774 6873 203d 2074 7570 6c65   lengths = tuple
-000203a0: 286c 656e 6774 6873 290a 0a20 2020 2020  (lengths)..     
-000203b0: 2020 2020 2020 2069 6620 6c65 6e28 6c65         if len(le
-000203c0: 6e67 7468 7329 2021 3d20 7365 6c66 2e6e  ngths) != self.n
-000203d0: 7061 7274 6974 696f 6e73 3a0a 2020 2020  partitions:.    
-000203e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000203f0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-00020400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020410: 2020 2254 6865 206e 756d 6265 7220 6f66    "The number of
-00020420: 2069 7465 6d73 2069 6e20 276c 656e 6774   items in 'lengt
-00020430: 6873 2720 646f 6573 206e 6f74 206d 6174  hs' does not mat
-00020440: 6368 2074 6865 206e 756d 6265 7220 6f66  ch the number of
-00020450: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00020460: 2020 2020 2020 2066 2270 6172 7469 7469         f"partiti
-00020470: 6f6e 732e 207b 6c65 6e28 6c65 6e67 7468  ons. {len(length
-00020480: 7329 7d20 213d 207b 7365 6c66 2e6e 7061  s)} != {self.npa
-00020490: 7274 6974 696f 6e73 7d22 0a20 2020 2020  rtitions}".     
-000204a0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-000204b0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-000204c0: 662e 6e64 696d 203d 3d20 313a 0a20 2020  f.ndim == 1:.   
-000204d0: 2020 2020 2020 2020 2020 2020 2063 6875               chu
-000204e0: 6e6b 7320 3d20 6e6f 726d 616c 697a 655f  nks = normalize_
-000204f0: 6368 756e 6b73 2828 6c65 6e67 7468 732c  chunks((lengths,
-00020500: 2929 0a20 2020 2020 2020 2020 2020 2065  )).            e
-00020510: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00020520: 2020 2020 2063 6875 6e6b 7320 3d20 6e6f       chunks = no
-00020530: 726d 616c 697a 655f 6368 756e 6b73 2828  rmalize_chunks((
-00020540: 6c65 6e67 7468 732c 2028 6c65 6e28 7365  lengths, (len(se
-00020550: 6c66 2e63 6f6c 756d 6e73 292c 2929 290a  lf.columns),))).
-00020560: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00020570: 7572 6e20 6368 756e 6b73 0a20 2020 2020  urn chunks.     
-00020580: 2020 2065 6c69 6620 6c65 6e67 7468 7320     elif lengths 
-00020590: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-000205a0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-000205b0: 616c 7565 4572 726f 7228 6622 556e 6578  alueError(f"Unex
-000205c0: 7065 6374 6564 2076 616c 7565 2066 6f72  pected value for
-000205d0: 2027 6c65 6e67 7468 7327 3a20 277b 6c65   'lengths': '{le
-000205e0: 6e67 7468 737d 2722 290a 0a20 2020 2020  ngths}'")..     
-000205f0: 2020 2072 6574 7572 6e20 6172 722e 5f63     return arr._c
-00020600: 6875 6e6b 730a 0a20 2020 2064 6566 205f  hunks..    def _
-00020610: 6973 5f69 6e64 6578 5f6c 6576 656c 5f72  is_index_level_r
-00020620: 6566 6572 656e 6365 2873 656c 662c 206b  eference(self, k
-00020630: 6579 293a 0a20 2020 2020 2020 2022 2222  ey):.        """
-00020640: 0a20 2020 2020 2020 2054 6573 7420 7768  .        Test wh
-00020650: 6574 6865 7220 6120 6b65 7920 6973 2061  ether a key is a
-00020660: 6e20 696e 6465 7820 6c65 7665 6c20 7265  n index level re
-00020670: 6665 7265 6e63 650a 0a20 2020 2020 2020  ference..       
-00020680: 2054 6f20 6265 2063 6f6e 7369 6465 7265   To be considere
-00020690: 6420 616e 2069 6e64 6578 206c 6576 656c  d an index level
-000206a0: 2072 6566 6572 656e 6365 2c20 606b 6579   reference, `key
-000206b0: 6020 6d75 7374 206d 6174 6368 2074 6865  ` must match the
-000206c0: 2069 6e64 6578 206e 616d 650a 2020 2020   index name.    
-000206d0: 2020 2020 616e 6420 6d75 7374 204e 4f54      and must NOT
-000206e0: 206d 6174 6368 2074 6865 206e 616d 6520   match the name 
-000206f0: 6f66 2061 6e79 2063 6f6c 756d 6e20 2869  of any column (i
-00020700: 6620 6120 6461 7461 6672 616d 6529 2e0a  f a dataframe)..
-00020710: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00020720: 2020 2020 7265 7475 726e 2028 0a20 2020      return (.   
-00020730: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
-00020740: 6465 782e 6e61 6d65 2069 7320 6e6f 7420  dex.name is not 
-00020750: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00020760: 2061 6e64 206e 6f74 2069 735f 6461 736b   and not is_dask
-00020770: 5f63 6f6c 6c65 6374 696f 6e28 6b65 7929  _collection(key)
-00020780: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00020790: 2028 6e70 2e69 7373 6361 6c61 7228 6b65   (np.isscalar(ke
-000207a0: 7929 206f 7220 6973 696e 7374 616e 6365  y) or isinstance
-000207b0: 286b 6579 2c20 7475 706c 6529 290a 2020  (key, tuple)).  
-000207c0: 2020 2020 2020 2020 2020 616e 6420 6b65            and ke
-000207d0: 7920 3d3d 2073 656c 662e 696e 6465 782e  y == self.index.
-000207e0: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
-000207f0: 2061 6e64 206b 6579 206e 6f74 2069 6e20   and key not in 
-00020800: 6765 7461 7474 7228 7365 6c66 2c20 2263  getattr(self, "c
-00020810: 6f6c 756d 6e73 222c 2028 2929 0a20 2020  olumns", ()).   
-00020820: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00020830: 5f63 6f6e 7461 696e 735f 696e 6465 785f  _contains_index_
-00020840: 6e61 6d65 2873 656c 662c 2063 6f6c 756d  name(self, colum
-00020850: 6e73 5f6f 725f 696e 6465 7829 3a0a 2020  ns_or_index):.  
-00020860: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00020870: 2020 5465 7374 2077 6865 7468 6572 2074    Test whether t
-00020880: 6865 2069 6e70 7574 2063 6f6e 7461 696e  he input contain
-00020890: 7320 6120 7265 6665 7265 6e63 6520 746f  s a reference to
-000208a0: 2074 6865 2069 6e64 6578 206f 6620 7468   the index of th
-000208b0: 6520 4461 7461 4672 616d 652f 5365 7269  e DataFrame/Seri
-000208c0: 6573 0a20 2020 2020 2020 2022 2222 0a20  es.        """. 
-000208d0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-000208e0: 616e 6365 2863 6f6c 756d 6e73 5f6f 725f  ance(columns_or_
-000208f0: 696e 6465 782c 206c 6973 7429 3a0a 2020  index, list):.  
-00020900: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00020910: 2061 6e79 2873 656c 662e 5f69 735f 696e   any(self._is_in
-00020920: 6465 785f 6c65 7665 6c5f 7265 6665 7265  dex_level_refere
-00020930: 6e63 6528 6e29 2066 6f72 206e 2069 6e20  nce(n) for n in 
-00020940: 636f 6c75 6d6e 735f 6f72 5f69 6e64 6578  columns_or_index
-00020950: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00020960: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00020970: 726e 2073 656c 662e 5f69 735f 696e 6465  rn self._is_inde
-00020980: 785f 6c65 7665 6c5f 7265 6665 7265 6e63  x_level_referenc
-00020990: 6528 636f 6c75 6d6e 735f 6f72 5f69 6e64  e(columns_or_ind
-000209a0: 6578 290a 0a0a 6465 6620 5f72 6169 7365  ex)...def _raise
-000209b0: 5f69 665f 6f62 6a65 6374 5f73 6572 6965  _if_object_serie
-000209c0: 7328 782c 2066 756e 636e 616d 6529 3a0a  s(x, funcname):.
-000209d0: 2020 2020 2222 220a 2020 2020 5574 696c      """.    Util
-000209e0: 6974 7920 6675 6e63 7469 6f6e 2074 6f20  ity function to 
-000209f0: 7261 6973 6520 616e 2065 7272 6f72 2069  raise an error i
-00020a00: 6620 616e 206f 626a 6563 7420 636f 6c75  f an object colu
-00020a10: 6d6e 2064 6f65 7320 6e6f 7420 7375 7070  mn does not supp
-00020a20: 6f72 740a 2020 2020 6120 6365 7274 6169  ort.    a certai
-00020a30: 6e20 6f70 6572 6174 696f 6e20 6c69 6b65  n operation like
-00020a40: 2060 6d65 616e 602e 0a20 2020 2022 2222   `mean`..    """
-00020a50: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
-00020a60: 6365 2878 2c20 5365 7269 6573 2920 616e  ce(x, Series) an
-00020a70: 6420 6861 7361 7474 7228 782c 2022 6474  d hasattr(x, "dt
-00020a80: 7970 6522 293a 0a20 2020 2020 2020 2069  ype"):.        i
-00020a90: 6620 782e 6474 7970 6520 3d3d 206f 626a  f x.dtype == obj
-00020aa0: 6563 743a 0a20 2020 2020 2020 2020 2020  ect:.           
-00020ab0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00020ac0: 7228 2260 2573 6020 6e6f 7420 7375 7070  r("`%s` not supp
-00020ad0: 6f72 7465 6420 7769 7468 206f 626a 6563  orted with objec
-00020ae0: 7420 7365 7269 6573 2220 2520 6675 6e63  t series" % func
-00020af0: 6e61 6d65 290a 2020 2020 2020 2020 656c  name).        el
-00020b00: 6966 2070 642e 6170 692e 7479 7065 732e  if pd.api.types.
-00020b10: 6973 5f64 7479 7065 5f65 7175 616c 2878  is_dtype_equal(x
-00020b20: 2e64 7479 7065 2c20 2273 7472 696e 6722  .dtype, "string"
-00020b30: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00020b40: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00020b50: 2260 2573 6020 6e6f 7420 7375 7070 6f72  "`%s` not suppor
-00020b60: 7465 6420 7769 7468 2073 7472 696e 6720  ted with string 
-00020b70: 7365 7269 6573 2220 2520 6675 6e63 6e61  series" % funcna
-00020b80: 6d65 290a 0a0a 636c 6173 7320 5365 7269  me)...class Seri
-00020b90: 6573 285f 4672 616d 6529 3a0a 2020 2020  es(_Frame):.    
-00020ba0: 2222 2250 6172 616c 6c65 6c20 5061 6e64  """Parallel Pand
-00020bb0: 6173 2053 6572 6965 730a 0a20 2020 2044  as Series..    D
-00020bc0: 6f20 6e6f 7420 7573 6520 7468 6973 2063  o not use this c
-00020bd0: 6c61 7373 2064 6972 6563 746c 792e 2020  lass directly.  
-00020be0: 496e 7374 6561 6420 7573 6520 6675 6e63  Instead use func
-00020bf0: 7469 6f6e 7320 6c69 6b65 0a20 2020 2060  tions like.    `
-00020c00: 6064 642e 7265 6164 5f63 7376 6060 2c20  `dd.read_csv``, 
-00020c10: 6060 6464 2e72 6561 645f 7061 7271 7565  ``dd.read_parque
-00020c20: 7460 602c 206f 7220 6060 6464 2e66 726f  t``, or ``dd.fro
-00020c30: 6d5f 7061 6e64 6173 6060 2e0a 0a20 2020  m_pandas``...   
-00020c40: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00020c50: 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020  ----------..    
-00020c60: 6473 6b3a 2064 6963 740a 2020 2020 2020  dsk: dict.      
-00020c70: 2020 5468 6520 6461 736b 2067 7261 7068    The dask graph
-00020c80: 2074 6f20 636f 6d70 7574 6520 7468 6973   to compute this
-00020c90: 2053 6572 6965 730a 2020 2020 5f6e 616d   Series.    _nam
-00020ca0: 653a 2073 7472 0a20 2020 2020 2020 2054  e: str.        T
-00020cb0: 6865 206b 6579 2070 7265 6669 7820 7468  he key prefix th
-00020cc0: 6174 2073 7065 6369 6669 6573 2077 6869  at specifies whi
-00020cd0: 6368 206b 6579 7320 696e 2074 6865 2064  ch keys in the d
-00020ce0: 6173 6b20 636f 6d70 7269 7365 2074 6869  ask comprise thi
-00020cf0: 730a 2020 2020 2020 2020 7061 7274 6963  s.        partic
-00020d00: 756c 6172 2053 6572 6965 730a 2020 2020  ular Series.    
-00020d10: 6d65 7461 3a20 7061 6e64 6173 2e53 6572  meta: pandas.Ser
-00020d20: 6965 730a 2020 2020 2020 2020 416e 2065  ies.        An e
-00020d30: 6d70 7479 2060 6070 616e 6461 732e 5365  mpty ``pandas.Se
-00020d40: 7269 6573 6060 2077 6974 6820 6e61 6d65  ries`` with name
-00020d50: 732c 2064 7479 7065 732c 2061 6e64 2069  s, dtypes, and i
-00020d60: 6e64 6578 206d 6174 6368 696e 6720 7468  ndex matching th
-00020d70: 650a 2020 2020 2020 2020 6578 7065 6374  e.        expect
-00020d80: 6564 206f 7574 7075 742e 0a20 2020 2064  ed output..    d
-00020d90: 6976 6973 696f 6e73 3a20 7475 706c 6520  ivisions: tuple 
-00020da0: 6f66 2069 6e64 6578 2076 616c 7565 730a  of index values.
-00020db0: 2020 2020 2020 2020 5661 6c75 6573 2061          Values a
-00020dc0: 6c6f 6e67 2077 6869 6368 2077 6520 7061  long which we pa
-00020dd0: 7274 6974 696f 6e20 6f75 7220 626c 6f63  rtition our bloc
-00020de0: 6b73 206f 6e20 7468 6520 696e 6465 780a  ks on the index.
-00020df0: 0a20 2020 2053 6565 2041 6c73 6f0a 2020  .    See Also.  
-00020e00: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064    --------.    d
-00020e10: 6173 6b2e 6461 7461 6672 616d 652e 4461  ask.dataframe.Da
-00020e20: 7461 4672 616d 650a 2020 2020 2222 220a  taFrame.    """.
-00020e30: 0a20 2020 205f 7061 7274 6974 696f 6e5f  .    _partition_
-00020e40: 7479 7065 203d 2070 642e 5365 7269 6573  type = pd.Series
-00020e50: 0a20 2020 205f 6973 5f70 6172 7469 7469  .    _is_partiti
-00020e60: 6f6e 5f74 7970 6520 3d20 7374 6174 6963  on_type = static
-00020e70: 6d65 7468 6f64 2869 735f 7365 7269 6573  method(is_series
-00020e80: 5f6c 696b 6529 0a20 2020 205f 746f 6b65  _like).    _toke
-00020e90: 6e5f 7072 6566 6978 203d 2022 7365 7269  n_prefix = "seri
-00020ea0: 6573 2d22 0a20 2020 205f 6163 6365 7373  es-".    _access
-00020eb0: 6f72 733a 2043 6c61 7373 5661 725b 7365  ors: ClassVar[se
-00020ec0: 745b 7374 725d 5d20 3d20 7365 7428 290a  t[str]] = set().
-00020ed0: 0a20 2020 2064 6566 205f 5f61 7272 6179  .    def __array
-00020ee0: 5f77 7261 705f 5f28 7365 6c66 2c20 6172  _wrap__(self, ar
-00020ef0: 7261 792c 2063 6f6e 7465 7874 3d4e 6f6e  ray, context=Non
-00020f00: 6529 3a0a 2020 2020 2020 2020 6966 2069  e):.        if i
-00020f10: 7369 6e73 7461 6e63 6528 636f 6e74 6578  sinstance(contex
-00020f20: 742c 2074 7570 6c65 2920 616e 6420 6c65  t, tuple) and le
-00020f30: 6e28 636f 6e74 6578 7429 203e 2030 3a0a  n(context) > 0:.
-00020f40: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00020f50: 7369 6e73 7461 6e63 6528 636f 6e74 6578  sinstance(contex
-00020f60: 745b 315d 5b30 5d2c 206e 702e 6e64 6172  t[1][0], np.ndar
-00020f70: 7261 7929 2061 6e64 2063 6f6e 7465 7874  ray) and context
-00020f80: 5b31 5d5b 305d 2e73 6861 7065 203d 3d20  [1][0].shape == 
-00020f90: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00020fa0: 2020 2020 696e 6465 7820 3d20 4e6f 6e65      index = None
-00020fb0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00020fc0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00020fd0: 2020 2069 6e64 6578 203d 2063 6f6e 7465     index = conte
-00020fe0: 7874 5b31 5d5b 305d 2e69 6e64 6578 0a20  xt[1][0].index. 
-00020ff0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00021000: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-00021010: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00021020: 706f 7274 2069 6e73 7065 6374 0a0a 2020  port inspect..  
-00021030: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-00021040: 7468 6f64 5f6e 616d 6520 3d20 6622 607b  thod_name = f"`{
-00021050: 696e 7370 6563 742e 7374 6163 6b28 295b  inspect.stack()[
-00021060: 335d 5b33 5d7d 6022 0a20 2020 2020 2020  3][3]}`".       
-00021070: 2020 2020 2065 7863 6570 7420 496e 6465       except Inde
-00021080: 7845 7272 6f72 3a0a 2020 2020 2020 2020  xError:.        
-00021090: 2020 2020 2020 2020 6d65 7468 6f64 5f6e          method_n
-000210a0: 616d 6520 3d20 2254 6869 7320 6d65 7468  ame = "This meth
-000210b0: 6f64 220a 2020 2020 2020 2020 2020 2020  od".            
-000210c0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-000210d0: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
-000210e0: 2020 2020 2020 2020 2020 2066 227b 6d65             f"{me
-000210f0: 7468 6f64 5f6e 616d 657d 2069 7320 6e6f  thod_name} is no
-00021100: 7420 696d 706c 656d 656e 7465 6420 666f  t implemented fo
-00021110: 7220 6064 6173 6b2e 6461 7461 6672 616d  r `dask.datafram
-00021120: 652e 5365 7269 6573 602e 220a 2020 2020  e.Series`.".    
-00021130: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00021140: 2020 2072 6574 7572 6e20 6d65 7461 5f73     return meta_s
-00021150: 6572 6965 735f 636f 6e73 7472 7563 746f  eries_constructo
-00021160: 7228 7365 6c66 2928 6172 7261 792c 2069  r(self)(array, i
-00021170: 6e64 6578 3d69 6e64 6578 2c20 6e61 6d65  ndex=index, name
-00021180: 3d73 656c 662e 6e61 6d65 290a 0a20 2020  =self.name)..   
-00021190: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-000211a0: 6566 2061 7865 7328 7365 6c66 293a 0a20  ef axes(self):. 
-000211b0: 2020 2020 2020 2072 6574 7572 6e20 5b73         return [s
-000211c0: 656c 662e 696e 6465 785d 0a0a 2020 2020  elf.index]..    
-000211d0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-000211e0: 6620 6e61 6d65 2873 656c 6629 3a0a 2020  f name(self):.  
-000211f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00021200: 662e 5f6d 6574 612e 6e61 6d65 0a0a 2020  f._meta.name..  
-00021210: 2020 406e 616d 652e 7365 7474 6572 0a20    @name.setter. 
-00021220: 2020 2064 6566 206e 616d 6528 7365 6c66     def name(self
-00021230: 2c20 6e61 6d65 293a 0a20 2020 2020 2020  , name):.       
-00021240: 2073 656c 662e 5f6d 6574 612e 6e61 6d65   self._meta.name
-00021250: 203d 206e 616d 650a 2020 2020 2020 2020   = name.        
-00021260: 7265 6e61 6d65 6420 3d20 5f72 656e 616d  renamed = _renam
-00021270: 655f 6461 736b 2873 656c 662c 206e 616d  e_dask(self, nam
-00021280: 6529 0a20 2020 2020 2020 2023 2075 7064  e).        # upd
-00021290: 6174 6520 6d79 7365 6c66 0a20 2020 2020  ate myself.     
-000212a0: 2020 2073 656c 662e 6461 736b 203d 2072     self.dask = r
-000212b0: 656e 616d 6564 2e64 6173 6b0a 2020 2020  enamed.dask.    
-000212c0: 2020 2020 7365 6c66 2e5f 6e61 6d65 203d      self._name =
-000212d0: 2072 656e 616d 6564 2e5f 6e61 6d65 0a0a   renamed._name..
-000212e0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-000212f0: 2020 6465 6620 6e64 696d 2873 656c 6629    def ndim(self)
-00021300: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00021310: 7572 6e20 6469 6d65 6e73 696f 6e61 6c69  urn dimensionali
-00021320: 7479 2222 220a 2020 2020 2020 2020 7265  ty""".        re
-00021330: 7475 726e 2031 0a0a 2020 2020 4070 726f  turn 1..    @pro
-00021340: 7065 7274 790a 2020 2020 6465 6620 7368  perty.    def sh
-00021350: 6170 6528 7365 6c66 293a 0a20 2020 2020  ape(self):.     
-00021360: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-00021370: 6574 7572 6e20 6120 7475 706c 6520 7265  eturn a tuple re
-00021380: 7072 6573 656e 7469 6e67 2074 6865 2064  presenting the d
-00021390: 696d 656e 7369 6f6e 616c 6974 7920 6f66  imensionality of
-000213a0: 2061 2053 6572 6965 732e 0a0a 2020 2020   a Series...    
-000213b0: 2020 2020 5468 6520 7369 6e67 6c65 2065      The single e
-000213c0: 6c65 6d65 6e74 206f 6620 7468 6520 7475  lement of the tu
-000213d0: 706c 6520 6973 2061 2044 656c 6179 6564  ple is a Delayed
-000213e0: 2072 6573 756c 742e 0a0a 2020 2020 2020   result...      
-000213f0: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
-00021400: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00021410: 2020 2020 3e3e 3e20 7365 7269 6573 2e73      >>> series.s
-00021420: 6861 7065 2020 2320 646f 6374 6573 743a  hape  # doctest:
-00021430: 202b 534b 4950 0a20 2020 2020 2020 2028   +SKIP.        (
-00021440: 6464 2e53 6361 6c61 723c 7369 7a65 2d61  dd.Scalar<size-a
-00021450: 672e 2e2e 2c20 6474 7970 653d 696e 7436  g..., dtype=int6
-00021460: 343e 2c29 0a20 2020 2020 2020 2022 2222  4>,).        """
-00021470: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00021480: 2873 656c 662e 7369 7a65 2c29 0a0a 2020  (self.size,)..  
-00021490: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-000214a0: 6465 6620 6474 7970 6528 7365 6c66 293a  def dtype(self):
-000214b0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-000214c0: 726e 2064 6174 6120 7479 7065 2222 220a  rn data type""".
-000214d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000214e0: 656c 662e 5f6d 6574 612e 6474 7970 650a  elf._meta.dtype.
-000214f0: 0a20 2020 2064 7420 3d20 4361 6368 6564  .    dt = Cached
-00021500: 4163 6365 7373 6f72 2822 6474 222c 2044  Accessor("dt", D
-00021510: 6174 6574 696d 6541 6363 6573 736f 7229  atetimeAccessor)
-00021520: 0a0a 2020 2020 6361 7420 3d20 4361 6368  ..    cat = Cach
-00021530: 6564 4163 6365 7373 6f72 2822 6361 7422  edAccessor("cat"
-00021540: 2c20 4361 7465 676f 7269 6361 6c41 6363  , CategoricalAcc
-00021550: 6573 736f 7229 0a0a 2020 2020 7374 7220  essor)..    str 
-00021560: 3d20 4361 6368 6564 4163 6365 7373 6f72  = CachedAccessor
-00021570: 2822 7374 7222 2c20 5374 7269 6e67 4163  ("str", StringAc
-00021580: 6365 7373 6f72 290a 0a20 2020 2064 6566  cessor)..    def
-00021590: 205f 5f64 6972 5f5f 2873 656c 6629 3a0a   __dir__(self):.
-000215a0: 2020 2020 2020 2020 6f20 3d20 7365 7428          o = set(
-000215b0: 6469 7228 7479 7065 2873 656c 6629 2929  dir(type(self)))
-000215c0: 0a20 2020 2020 2020 206f 2e75 7064 6174  .        o.updat
-000215d0: 6528 7365 6c66 2e5f 5f64 6963 745f 5f29  e(self.__dict__)
-000215e0: 0a20 2020 2020 2020 2023 2052 656d 6f76  .        # Remov
-000215f0: 6520 7468 6520 6063 6174 6020 616e 6420  e the `cat` and 
-00021600: 6073 7472 6020 6163 6365 7373 6f72 7320  `str` accessors 
-00021610: 6966 206e 6f74 2061 7661 696c 6162 6c65  if not available
-00021620: 2e20 5765 2063 616e 2774 0a20 2020 2020  . We can't.     
-00021630: 2020 2023 2064 6563 6964 6520 7468 6973     # decide this
-00021640: 2073 7461 7469 6361 6c6c 7920 666f 7220   statically for 
-00021650: 7468 6520 6064 7460 2061 6363 6573 736f  the `dt` accesso
-00021660: 722c 2061 7320 6974 2077 6f72 6b73 206f  r, as it works o
-00021670: 6e0a 2020 2020 2020 2020 2320 6461 7465  n.        # date
-00021680: 7469 6d65 2d6c 696b 6520 7468 696e 6773  time-like things
-00021690: 2061 7320 7765 6c6c 2e0a 2020 2020 2020   as well..      
-000216a0: 2020 666f 7220 6163 6365 7373 6f72 2069    for accessor i
-000216b0: 6e20 5b22 6361 7422 2c20 2273 7472 225d  n ["cat", "str"]
-000216c0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-000216d0: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
-000216e0: 662e 5f6d 6574 612c 2061 6363 6573 736f  f._meta, accesso
-000216f0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-00021700: 2020 2020 6f2e 7265 6d6f 7665 2861 6363      o.remove(acc
-00021710: 6573 736f 7229 0a20 2020 2020 2020 2072  essor).        r
-00021720: 6574 7572 6e20 6c69 7374 286f 290a 0a20  eturn list(o).. 
-00021730: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00021740: 2064 6566 206e 6279 7465 7328 7365 6c66   def nbytes(self
-00021750: 293a 0a20 2020 2020 2020 2022 2222 4e75  ):.        """Nu
-00021760: 6d62 6572 206f 6620 6279 7465 7322 2222  mber of bytes"""
-00021770: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00021780: 7365 6c66 2e72 6564 7563 7469 6f6e 280a  self.reduction(.
-00021790: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-000217a0: 6f64 732e 6e62 7974 6573 2c20 6e70 2e73  ods.nbytes, np.s
-000217b0: 756d 2c20 746f 6b65 6e3d 226e 6279 7465  um, token="nbyte
-000217c0: 7322 2c20 6d65 7461 3d69 6e74 2c20 7370  s", meta=int, sp
-000217d0: 6c69 745f 6576 6572 793d 4661 6c73 650a  lit_every=False.
-000217e0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-000217f0: 6566 205f 7265 7072 5f64 6174 6128 7365  ef _repr_data(se
-00021800: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00021810: 7572 6e20 5f72 6570 725f 6461 7461 5f73  urn _repr_data_s
-00021820: 6572 6965 7328 7365 6c66 2e5f 6d65 7461  eries(self._meta
-00021830: 2c20 7365 6c66 2e5f 7265 7072 5f64 6976  , self._repr_div
-00021840: 6973 696f 6e73 290a 0a20 2020 2064 6566  isions)..    def
-00021850: 205f 5f72 6570 725f 5f28 7365 6c66 293a   __repr__(self):
-00021860: 0a20 2020 2020 2020 2022 2222 6861 7665  .        """have
-00021870: 2074 6f20 6f76 6572 7772 6974 6520 666f   to overwrite fo
-00021880: 6f74 6572 2222 220a 2020 2020 2020 2020  oter""".        
-00021890: 6966 2073 656c 662e 6e61 6d65 2069 7320  if self.name is 
-000218a0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-000218b0: 2020 2020 2020 666f 6f74 6572 203d 2066        footer = f
-000218c0: 224e 616d 653a 207b 7365 6c66 2e6e 616d  "Name: {self.nam
-000218d0: 657d 2c20 6474 7970 653a 207b 7365 6c66  e}, dtype: {self
-000218e0: 2e64 7479 7065 7d22 0a20 2020 2020 2020  .dtype}".       
-000218f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00021900: 2020 2066 6f6f 7465 7220 3d20 6622 6474     footer = f"dt
-00021910: 7970 653a 207b 7365 6c66 2e64 7479 7065  ype: {self.dtype
-00021920: 7d22 0a0a 2020 2020 2020 2020 7265 7475  }"..        retu
-00021930: 726e 2022 2222 4461 736b 207b 6b6c 6173  rn """Dask {klas
-00021940: 737d 2053 7472 7563 7475 7265 3a0a 7b64  s} Structure:.{d
-00021950: 6174 617d 0a7b 666f 6f74 6572 7d0a 4461  ata}.{footer}.Da
-00021960: 736b 204e 616d 653a 207b 6e61 6d65 7d2c  sk Name: {name},
-00021970: 207b 6c61 7965 7273 7d22 2222 2e66 6f72   {layers}""".for
-00021980: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
-00021990: 206b 6c61 7373 3d73 656c 662e 5f5f 636c   klass=self.__cl
-000219a0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2c0a  ass__.__name__,.
-000219b0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-000219c0: 3d73 656c 662e 746f 5f73 7472 696e 6728  =self.to_string(
-000219d0: 292c 0a20 2020 2020 2020 2020 2020 2066  ),.            f
-000219e0: 6f6f 7465 723d 666f 6f74 6572 2c0a 2020  ooter=footer,.  
-000219f0: 2020 2020 2020 2020 2020 6e61 6d65 3d6b            name=k
-00021a00: 6579 5f73 706c 6974 2873 656c 662e 5f6e  ey_split(self._n
-00021a10: 616d 6529 2c0a 2020 2020 2020 2020 2020  ame),.          
-00021a20: 2020 6c61 7965 7273 3d6d 6179 6265 5f70    layers=maybe_p
-00021a30: 6c75 7261 6c69 7a65 286c 656e 2873 656c  luralize(len(sel
-00021a40: 662e 6461 736b 2e6c 6179 6572 7329 2c20  f.dask.layers), 
-00021a50: 2267 7261 7068 206c 6179 6572 2229 2c0a  "graph layer"),.
-00021a60: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00021a70: 6566 2072 656e 616d 6528 7365 6c66 2c20  ef rename(self, 
-00021a80: 696e 6465 783d 4e6f 6e65 2c20 696e 706c  index=None, inpl
-00021a90: 6163 653d 4661 6c73 652c 2073 6f72 7465  ace=False, sorte
-00021aa0: 645f 696e 6465 783d 4661 6c73 6529 3a0a  d_index=False):.
-00021ab0: 2020 2020 2020 2020 2222 2241 6c74 6572          """Alter
-00021ac0: 2053 6572 6965 7320 696e 6465 7820 6c61   Series index la
-00021ad0: 6265 6c73 206f 7220 6e61 6d65 0a0a 2020  bels or name..  
-00021ae0: 2020 2020 2020 4675 6e63 7469 6f6e 202f        Function /
-00021af0: 2064 6963 7420 7661 6c75 6573 206d 7573   dict values mus
-00021b00: 7420 6265 2075 6e69 7175 6520 2831 2d74  t be unique (1-t
-00021b10: 6f2d 3129 2e20 4c61 6265 6c73 206e 6f74  o-1). Labels not
-00021b20: 2063 6f6e 7461 696e 6564 2069 6e0a 2020   contained in.  
-00021b30: 2020 2020 2020 6120 6469 6374 202f 2053        a dict / S
-00021b40: 6572 6965 7320 7769 6c6c 2062 6520 6c65  eries will be le
-00021b50: 6674 2061 732d 6973 2e20 4578 7472 6120  ft as-is. Extra 
-00021b60: 6c61 6265 6c73 206c 6973 7465 6420 646f  labels listed do
-00021b70: 6e27 7420 7468 726f 7720 616e 0a20 2020  n't throw an.   
-00021b80: 2020 2020 2065 7272 6f72 2e0a 0a20 2020       error...   
-00021b90: 2020 2020 2041 6c74 6572 6e61 7469 7665       Alternative
-00021ba0: 6c79 2c20 6368 616e 6765 2060 6053 6572  ly, change ``Ser
-00021bb0: 6965 732e 6e61 6d65 6060 2077 6974 6820  ies.name`` with 
-00021bc0: 6120 7363 616c 6172 2076 616c 7565 2e0a  a scalar value..
-00021bd0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00021be0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00021bf0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2069  ------.        i
-00021c00: 6e64 6578 203a 2073 6361 6c61 722c 2068  ndex : scalar, h
-00021c10: 6173 6861 626c 6520 7365 7175 656e 6365  ashable sequence
-00021c20: 2c20 6469 6374 2d6c 696b 6520 6f72 2063  , dict-like or c
-00021c30: 616c 6c61 626c 652c 206f 7074 696f 6e61  allable, optiona
-00021c40: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
-00021c50: 2064 6963 742d 6c69 6b65 206f 7220 6361   dict-like or ca
-00021c60: 6c6c 6162 6c65 2c20 7468 6520 7472 616e  llable, the tran
-00021c70: 7366 6f72 6d61 7469 6f6e 2069 7320 6170  sformation is ap
-00021c80: 706c 6965 6420 746f 2074 6865 0a20 2020  plied to the.   
-00021c90: 2020 2020 2020 2020 2069 6e64 6578 2e20           index. 
-00021ca0: 5363 616c 6172 206f 7220 6861 7368 6162  Scalar or hashab
-00021cb0: 6c65 2073 6571 7565 6e63 652d 6c69 6b65  le sequence-like
-00021cc0: 2077 696c 6c20 616c 7465 7220 7468 650a   will alter the.
-00021cd0: 2020 2020 2020 2020 2020 2020 6060 5365              ``Se
-00021ce0: 7269 6573 2e6e 616d 6560 6020 6174 7472  ries.name`` attr
-00021cf0: 6962 7574 652e 0a20 2020 2020 2020 2069  ibute..        i
-00021d00: 6e70 6c61 6365 203a 2062 6f6f 6c65 616e  nplace : boolean
-00021d10: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
-00021d20: 2020 2020 2020 2020 2020 2020 5768 6574              Whet
-00021d30: 6865 7220 746f 2072 6574 7572 6e20 6120  her to return a 
-00021d40: 6e65 7720 5365 7269 6573 206f 7220 6d6f  new Series or mo
-00021d50: 6469 6679 2074 6869 7320 6f6e 6520 696e  dify this one in
-00021d60: 706c 6163 652e 0a20 2020 2020 2020 2073  place..        s
-00021d70: 6f72 7465 645f 696e 6465 7820 3a20 626f  orted_index : bo
-00021d80: 6f6c 2c20 6465 6661 756c 7420 4661 6c73  ol, default Fals
-00021d90: 650a 2020 2020 2020 2020 2020 2020 4966  e.            If
-00021da0: 2074 7275 652c 2074 6865 206f 7574 7075   true, the outpu
-00021db0: 7420 6060 5365 7269 6573 6060 2077 696c  t ``Series`` wil
-00021dc0: 6c20 6861 7665 206b 6e6f 776e 2064 6976  l have known div
-00021dd0: 6973 696f 6e73 2069 6e66 6572 7265 640a  isions inferred.
-00021de0: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
-00021df0: 2074 6865 2069 6e70 7574 2073 6572 6965   the input serie
-00021e00: 7320 616e 6420 7468 6520 7472 616e 7366  s and the transf
-00021e10: 6f72 6d61 7469 6f6e 2e20 4967 6e6f 7265  ormation. Ignore
-00021e20: 6420 666f 720a 2020 2020 2020 2020 2020  d for.          
-00021e30: 2020 6e6f 6e2d 6361 6c6c 6162 6c65 2f64    non-callable/d
-00021e40: 6963 742d 6c69 6b65 2060 6069 6e64 6578  ict-like ``index
-00021e50: 6060 206f 7220 7768 656e 2074 6865 2069  `` or when the i
-00021e60: 6e70 7574 2073 6572 6965 7320 6861 730a  nput series has.
-00021e70: 2020 2020 2020 2020 2020 2020 756e 6b6e              unkn
-00021e80: 6f77 6e20 6469 7669 7369 6f6e 732e 204e  own divisions. N
-00021e90: 6f74 6520 7468 6174 2074 6869 7320 6d61  ote that this ma
-00021ea0: 7920 6f6e 6c79 2062 6520 7365 7420 746f  y only be set to
-00021eb0: 2060 6054 7275 6560 6020 6966 0a20 2020   ``True`` if.   
-00021ec0: 2020 2020 2020 2020 2079 6f75 206b 6e6f           you kno
-00021ed0: 7720 7468 6174 2074 6865 2074 7261 6e73  w that the trans
-00021ee0: 666f 726d 6564 2069 6e64 6578 2069 7320  formed index is 
-00021ef0: 6d6f 6e6f 746f 6e69 6361 6c6c 7920 696e  monotonically in
-00021f00: 6372 6561 7369 6e67 2e20 4461 736b 0a20  creasing. Dask. 
-00021f10: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
-00021f20: 6368 6563 6b20 7468 6174 2074 7261 6e73  check that trans
-00021f30: 666f 726d 6564 2064 6976 6973 696f 6e73  formed divisions
-00021f40: 2061 7265 206d 6f6e 6f74 6f6e 6963 2c20   are monotonic, 
-00021f50: 6275 7420 6361 6e6e 6f74 0a20 2020 2020  but cannot.     
-00021f60: 2020 2020 2020 2063 6865 636b 2061 6c6c         check all
-00021f70: 2074 6865 2076 616c 7565 7320 6265 7477   the values betw
-00021f80: 6565 6e20 6469 7669 7369 6f6e 732c 2073  een divisions, s
-00021f90: 6f20 696e 636f 7272 6563 746c 7920 7365  o incorrectly se
-00021fa0: 7474 696e 6720 7468 6973 0a20 2020 2020  tting this.     
-00021fb0: 2020 2020 2020 2063 616e 2072 6573 756c         can resul
-00021fc0: 7420 696e 2062 7567 732e 0a0a 2020 2020  t in bugs...    
-00021fd0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-00021fe0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00021ff0: 2020 2020 7265 6e61 6d65 6420 3a20 5365      renamed : Se
-00022000: 7269 6573 0a0a 2020 2020 2020 2020 5365  ries..        Se
-00022010: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
-00022020: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00022030: 7061 6e64 6173 2e53 6572 6965 732e 7265  pandas.Series.re
-00022040: 6e61 6d65 0a20 2020 2020 2020 2022 2222  name.        """
-00022050: 0a20 2020 2020 2020 2066 726f 6d20 7061  .        from pa
-00022060: 6e64 6173 2e61 7069 2e74 7970 6573 2069  ndas.api.types i
-00022070: 6d70 6f72 7420 6973 5f64 6963 745f 6c69  mport is_dict_li
-00022080: 6b65 2c20 6973 5f6c 6973 745f 6c69 6b65  ke, is_list_like
-00022090: 2c20 6973 5f73 6361 6c61 720a 0a20 2020  , is_scalar..   
-000220a0: 2020 2020 2069 6d70 6f72 7420 6461 736b       import dask
-000220b0: 2e64 6174 6166 7261 6d65 2061 7320 6464  .dataframe as dd
-000220c0: 0a0a 2020 2020 2020 2020 6966 2069 735f  ..        if is_
-000220d0: 7363 616c 6172 2869 6e64 6578 2920 6f72  scalar(index) or
-000220e0: 2028 0a20 2020 2020 2020 2020 2020 2069   (.            i
-000220f0: 735f 6c69 7374 5f6c 696b 6528 696e 6465  s_list_like(inde
-00022100: 7829 0a20 2020 2020 2020 2020 2020 2061  x).            a
-00022110: 6e64 206e 6f74 2069 735f 6469 6374 5f6c  nd not is_dict_l
-00022120: 696b 6528 696e 6465 7829 0a20 2020 2020  ike(index).     
-00022130: 2020 2020 2020 2061 6e64 206e 6f74 2069         and not i
-00022140: 7369 6e73 7461 6e63 6528 696e 6465 782c  sinstance(index,
-00022150: 2064 642e 5365 7269 6573 290a 2020 2020   dd.Series).    
-00022160: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00022170: 2020 2069 6620 696e 706c 6163 653a 0a20     if inplace:. 
-00022180: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-00022190: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-000221a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000221b0: 2020 2227 696e 706c 6163 6527 2061 7267    "'inplace' arg
-000221c0: 756d 656e 7420 666f 7220 6461 736b 2073  ument for dask s
-000221d0: 6572 6965 7320 7769 6c6c 2062 6520 7265  eries will be re
-000221e0: 6d6f 7665 6420 696e 2066 7574 7572 6520  moved in future 
-000221f0: 7665 7273 696f 6e73 222c 0a20 2020 2020  versions",.     
-00022200: 2020 2020 2020 2020 2020 2020 2020 2050                 P
-00022210: 656e 6469 6e67 4465 7072 6563 6174 696f  endingDeprecatio
-00022220: 6e57 6172 6e69 6e67 2c0a 2020 2020 2020  nWarning,.      
-00022230: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00022240: 2020 2020 2020 2020 7265 7320 3d20 7365          res = se
-00022250: 6c66 2069 6620 696e 706c 6163 6520 656c  lf if inplace el
-00022260: 7365 2073 656c 662e 636f 7079 2829 0a20  se self.copy(). 
-00022270: 2020 2020 2020 2020 2020 2072 6573 2e6e             res.n
-00022280: 616d 6520 3d20 696e 6465 780a 2020 2020  ame = index.    
-00022290: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000222a0: 2020 2020 2020 7265 7320 3d20 7365 6c66        res = self
-000222b0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-000222c0: 4d2e 7265 6e61 6d65 2c20 696e 6465 782c  M.rename, index,
-000222d0: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-000222e0: 613d 4661 6c73 6529 0a20 2020 2020 2020  a=False).       
-000222f0: 2020 2020 2069 6620 7365 6c66 2e6b 6e6f       if self.kno
-00022300: 776e 5f64 6976 6973 696f 6e73 3a0a 2020  wn_divisions:.  
-00022310: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00022320: 2073 6f72 7465 645f 696e 6465 7820 616e   sorted_index an
-00022330: 6420 2863 616c 6c61 626c 6528 696e 6465  d (callable(inde
-00022340: 7829 206f 7220 6973 5f64 6963 745f 6c69  x) or is_dict_li
-00022350: 6b65 2869 6e64 6578 2929 3a0a 2020 2020  ke(index)):.    
-00022360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022370: 6f6c 6420 3d20 7064 2e53 6572 6965 7328  old = pd.Series(
-00022380: 7261 6e67 6528 7365 6c66 2e6e 7061 7274  range(self.npart
-00022390: 6974 696f 6e73 202b 2031 292c 2069 6e64  itions + 1), ind
-000223a0: 6578 3d73 656c 662e 6469 7669 7369 6f6e  ex=self.division
-000223b0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-000223c0: 2020 2020 2020 206e 6577 203d 206f 6c64         new = old
-000223d0: 2e72 656e 616d 6528 696e 6465 7829 2e69  .rename(index).i
-000223e0: 6e64 6578 0a20 2020 2020 2020 2020 2020  ndex.           
-000223f0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00022400: 6e65 772e 6973 5f6d 6f6e 6f74 6f6e 6963  new.is_monotonic
-00022410: 5f69 6e63 7265 6173 696e 673a 0a20 2020  _increasing:.   
-00022420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022430: 2020 2020 206d 7367 203d 2028 0a20 2020       msg = (.   
-00022440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022450: 2020 2020 2020 2020 2022 736f 7274 6564           "sorted
-00022460: 5f69 6e64 6578 3d54 7275 652c 2062 7574  _index=True, but
-00022470: 2074 6865 2074 7261 6e73 666f 726d 6564   the transformed
-00022480: 2069 6e64 6578 2022 0a20 2020 2020 2020   index ".       
-00022490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000224a0: 2020 2020 2022 6973 6e27 7420 6d6f 6e6f       "isn't mono
-000224b0: 746f 6e69 635f 696e 6372 6561 7369 6e67  tonic_increasing
-000224c0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-000224d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000224e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000224f0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00022500: 7272 6f72 286d 7367 290a 2020 2020 2020  rror(msg).      
-00022510: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00022520: 732e 5f64 6976 6973 696f 6e73 203d 2074  s._divisions = t
-00022530: 7570 6c65 286d 6574 686f 6473 2e74 6f6c  uple(methods.tol
-00022540: 6973 7428 6e65 7729 290a 2020 2020 2020  ist(new)).      
-00022550: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00022560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022570: 2020 2020 7265 7320 3d20 7265 732e 636c      res = res.cl
-00022580: 6561 725f 6469 7669 7369 6f6e 7328 290a  ear_divisions().
-00022590: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-000225a0: 6e70 6c61 6365 3a0a 2020 2020 2020 2020  nplace:.        
-000225b0: 2020 2020 2020 2020 7365 6c66 2e64 6173          self.das
-000225c0: 6b20 3d20 7265 732e 6461 736b 0a20 2020  k = res.dask.   
-000225d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000225e0: 662e 5f6e 616d 6520 3d20 7265 732e 5f6e  f._name = res._n
-000225f0: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
-00022600: 2020 2020 7365 6c66 2e5f 6469 7669 7369      self._divisi
-00022610: 6f6e 7320 3d20 7265 732e 6469 7669 7369  ons = res.divisi
-00022620: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
-00022630: 2020 2020 7365 6c66 2e5f 6d65 7461 203d      self._meta =
-00022640: 2072 6573 2e5f 6d65 7461 0a20 2020 2020   res._meta.     
-00022650: 2020 2020 2020 2020 2020 2072 6573 203d             res =
-00022660: 2073 656c 660a 2020 2020 2020 2020 7265   self.        re
-00022670: 7475 726e 2072 6573 0a0a 2020 2020 4064  turn res..    @d
-00022680: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
-00022690: 6572 6965 7329 0a20 2020 2064 6566 2072  eries).    def r
-000226a0: 6f75 6e64 2873 656c 662c 2064 6563 696d  ound(self, decim
-000226b0: 616c 733d 3029 3a0a 2020 2020 2020 2020  als=0):.        
-000226c0: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
-000226d0: 4d2e 726f 756e 642c 2073 656c 662c 2064  M.round, self, d
-000226e0: 6563 696d 616c 7329 0a0a 2020 2020 4064  ecimals)..    @d
-000226f0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00022700: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00022710: 6620 746f 5f74 696d 6573 7461 6d70 2873  f to_timestamp(s
-00022720: 656c 662c 2066 7265 713d 4e6f 6e65 2c20  elf, freq=None, 
-00022730: 686f 773d 2273 7461 7274 222c 2061 7869  how="start", axi
-00022740: 733d 3029 3a0a 2020 2020 2020 2020 6466  s=0):.        df
-00022750: 203d 2065 6c65 6d77 6973 6528 4d2e 746f   = elemwise(M.to
-00022760: 5f74 696d 6573 7461 6d70 2c20 7365 6c66  _timestamp, self
-00022770: 2c20 6672 6571 2c20 686f 772c 2061 7869  , freq, how, axi
-00022780: 7329 0a20 2020 2020 2020 2064 662e 6469  s).        df.di
-00022790: 7669 7369 6f6e 7320 3d20 7475 706c 6528  visions = tuple(
-000227a0: 7064 2e49 6e64 6578 2873 656c 662e 6469  pd.Index(self.di
-000227b0: 7669 7369 6f6e 7329 2e74 6f5f 7469 6d65  visions).to_time
-000227c0: 7374 616d 7028 2929 0a20 2020 2020 2020  stamp()).       
-000227d0: 2072 6574 7572 6e20 6466 0a0a 2020 2020   return df..    
-000227e0: 6465 6620 7175 616e 7469 6c65 2873 656c  def quantile(sel
-000227f0: 662c 2071 3d30 2e35 2c20 6d65 7468 6f64  f, q=0.5, method
-00022800: 3d22 6465 6661 756c 7422 293a 0a20 2020  ="default"):.   
-00022810: 2020 2020 2022 2222 4170 7072 6f78 696d       """Approxim
-00022820: 6174 6520 7175 616e 7469 6c65 7320 6f66  ate quantiles of
-00022830: 2053 6572 6965 730a 0a20 2020 2020 2020   Series..       
-00022840: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00022850: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00022860: 2020 2020 2020 2071 203a 206c 6973 742f         q : list/
-00022870: 6172 7261 7920 6f66 2066 6c6f 6174 732c  array of floats,
-00022880: 2064 6566 6175 6c74 2030 2e35 2028 3530   default 0.5 (50
-00022890: 2529 0a20 2020 2020 2020 2020 2020 2049  %).            I
-000228a0: 7465 7261 626c 6520 6f66 206e 756d 6265  terable of numbe
-000228b0: 7273 2072 616e 6769 6e67 2066 726f 6d20  rs ranging from 
-000228c0: 3020 746f 2031 2066 6f72 2074 6865 2064  0 to 1 for the d
-000228d0: 6573 6972 6564 2071 7561 6e74 696c 6573  esired quantiles
-000228e0: 0a20 2020 2020 2020 206d 6574 686f 6420  .        method 
-000228f0: 3a20 7b27 6465 6661 756c 7427 2c20 2774  : {'default', 't
-00022900: 6469 6765 7374 272c 2027 6461 736b 277d  digest', 'dask'}
-00022910: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00022920: 2020 2020 2020 2057 6861 7420 6d65 7468         What meth
-00022930: 6f64 2074 6f20 7573 652e 2042 7920 6465  od to use. By de
-00022940: 6661 756c 7420 7769 6c6c 2075 7365 2064  fault will use d
-00022950: 6173 6b27 7320 696e 7465 726e 616c 2063  ask's internal c
-00022960: 7573 746f 6d0a 2020 2020 2020 2020 2020  ustom.          
-00022970: 2020 616c 676f 7269 7468 6d20 2860 6027    algorithm (``'
-00022980: 6461 736b 2760 6029 2e20 2049 6620 7365  dask'``).  If se
-00022990: 7420 746f 2060 6027 7464 6967 6573 7427  t to ``'tdigest'
-000229a0: 6060 2077 696c 6c20 7573 6520 7464 6967  `` will use tdig
-000229b0: 6573 740a 2020 2020 2020 2020 2020 2020  est.            
-000229c0: 666f 7220 666c 6f61 7473 2061 6e64 2069  for floats and i
-000229d0: 6e74 7320 616e 6420 6661 6c6c 6261 636b  nts and fallback
-000229e0: 2074 6f20 7468 6520 6060 2764 6173 6b27   to the ``'dask'
-000229f0: 6060 206f 7468 6572 7769 7365 2e0a 2020  `` otherwise..  
-00022a00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00022a10: 2020 7265 7475 726e 2071 7561 6e74 696c    return quantil
-00022a20: 6528 7365 6c66 2c20 712c 206d 6574 686f  e(self, q, metho
-00022a30: 643d 6d65 7468 6f64 290a 0a20 2020 2064  d=method)..    d
-00022a40: 6566 206d 6564 6961 6e5f 6170 7072 6f78  ef median_approx
-00022a50: 696d 6174 6528 7365 6c66 2c20 6d65 7468  imate(self, meth
-00022a60: 6f64 3d22 6465 6661 756c 7422 293a 0a20  od="default"):. 
-00022a70: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00022a80: 2074 6865 2061 7070 726f 7869 6d61 7465   the approximate
-00022a90: 206d 6564 6961 6e20 6f66 2074 6865 2076   median of the v
-00022aa0: 616c 7565 7320 6f76 6572 2074 6865 2072  alues over the r
-00022ab0: 6571 7565 7374 6564 2061 7869 732e 0a0a  equested axis...
-00022ac0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00022ad0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00022ae0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6d65  -----.        me
-00022af0: 7468 6f64 203a 207b 2764 6566 6175 6c74  thod : {'default
-00022b00: 272c 2027 7464 6967 6573 7427 2c20 2764  ', 'tdigest', 'd
-00022b10: 6173 6b27 7d2c 206f 7074 696f 6e61 6c0a  ask'}, optional.
-00022b20: 2020 2020 2020 2020 2020 2020 5768 6174              What
-00022b30: 206d 6574 686f 6420 746f 2075 7365 2e20   method to use. 
-00022b40: 4279 2064 6566 6175 6c74 2077 696c 6c20  By default will 
-00022b50: 7573 6520 4461 736b 2773 2069 6e74 6572  use Dask's inter
-00022b60: 6e61 6c20 6375 7374 6f6d 0a20 2020 2020  nal custom.     
-00022b70: 2020 2020 2020 2061 6c67 6f72 6974 686d         algorithm
-00022b80: 2028 6060 2264 6173 6b22 6060 292e 2020   (``"dask"``).  
-00022b90: 4966 2073 6574 2074 6f20 6060 2274 6469  If set to ``"tdi
-00022ba0: 6765 7374 2260 6020 7769 6c6c 2075 7365  gest"`` will use
-00022bb0: 2074 6469 6765 7374 0a20 2020 2020 2020   tdigest.       
-00022bc0: 2020 2020 2066 6f72 2066 6c6f 6174 7320       for floats 
-00022bd0: 616e 6420 696e 7473 2061 6e64 2066 616c  and ints and fal
-00022be0: 6c62 6163 6b20 746f 2074 6865 2060 6022  lback to the ``"
-00022bf0: 6461 736b 2260 6020 6f74 6865 7277 6973  dask"`` otherwis
-00022c00: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
-00022c10: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00022c20: 6c66 2e71 7561 6e74 696c 6528 713d 302e  lf.quantile(q=0.
-00022c30: 352c 206d 6574 686f 643d 6d65 7468 6f64  5, method=method
-00022c40: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00022c50: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
-00022c60: 2020 2020 6465 6620 6d65 6469 616e 2873      def median(s
-00022c70: 656c 662c 206d 6574 686f 643d 2264 6566  elf, method="def
-00022c80: 6175 6c74 2229 3a0a 2020 2020 2020 2020  ault"):.        
-00022c90: 6966 2073 656c 662e 6e70 6172 7469 7469  if self.npartiti
-00022ca0: 6f6e 7320 3d3d 2031 3a0a 2020 2020 2020  ons == 1:.      
-00022cb0: 2020 2020 2020 2320 4361 6e20 7072 6f76        # Can prov
-00022cc0: 6964 6520 616e 2065 7861 6374 206d 6564  ide an exact med
-00022cd0: 6961 6e20 696e 2074 6865 7365 2063 6173  ian in these cas
-00022ce0: 6573 0a20 2020 2020 2020 2020 2020 2072  es.            r
-00022cf0: 6574 7572 6e20 7365 6c66 2e6d 6564 6961  eturn self.media
-00022d00: 6e5f 6170 7072 6f78 696d 6174 6528 6d65  n_approximate(me
-00022d10: 7468 6f64 3d6d 6574 686f 6429 0a20 2020  thod=method).   
-00022d20: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-00022d30: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
-00022d40: 2020 2020 2020 2020 2020 2020 2244 6173              "Das
-00022d50: 6b20 646f 6573 6e27 7420 696d 706c 656d  k doesn't implem
-00022d60: 656e 7420 616e 2065 7861 6374 206d 6564  ent an exact med
-00022d70: 6961 6e20 696e 2061 6c6c 2063 6173 6573  ian in all cases
-00022d80: 2061 7320 7468 6973 2069 7320 6861 7264   as this is hard
-00022d90: 2074 6f20 646f 2069 6e20 7061 7261 6c6c   to do in parall
-00022da0: 656c 2e20 220a 2020 2020 2020 2020 2020  el. ".          
-00022db0: 2020 2253 6565 2074 6865 2060 6d65 6469    "See the `medi
-00022dc0: 616e 5f61 7070 726f 7869 6d61 7465 6020  an_approximate` 
-00022dd0: 6d65 7468 6f64 2069 6e73 7465 6164 2c20  method instead, 
-00022de0: 7768 6963 6820 7573 6573 2061 6e20 6170  which uses an ap
-00022df0: 7072 6f78 696d 6174 6520 616c 676f 7269  proximate algori
-00022e00: 7468 6d2e 220a 2020 2020 2020 2020 290a  thm.".        ).
-00022e10: 0a20 2020 2064 6566 205f 7265 7061 7274  .    def _repart
-00022e20: 6974 696f 6e5f 7175 616e 7469 6c65 7328  ition_quantiles(
-00022e30: 7365 6c66 2c20 6e70 6172 7469 7469 6f6e  self, npartition
-00022e40: 732c 2075 7073 616d 706c 653d 312e 3029  s, upsample=1.0)
-00022e50: 3a0a 2020 2020 2020 2020 2222 2241 7070  :.        """App
-00022e60: 726f 7869 6d61 7465 2071 7561 6e74 696c  roximate quantil
-00022e70: 6573 206f 6620 5365 7269 6573 2075 7365  es of Series use
-00022e80: 6420 666f 7220 7265 7061 7274 6974 696f  d for repartitio
-00022e90: 6e69 6e67 2222 220a 2020 2020 2020 2020  ning""".        
-00022ea0: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
-00022eb0: 616d 652e 7061 7274 6974 696f 6e71 7561  ame.partitionqua
-00022ec0: 6e74 696c 6573 2069 6d70 6f72 7420 7061  ntiles import pa
-00022ed0: 7274 6974 696f 6e5f 7175 616e 7469 6c65  rtition_quantile
-00022ee0: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
-00022ef0: 6e20 7061 7274 6974 696f 6e5f 7175 616e  n partition_quan
-00022f00: 7469 6c65 7328 7365 6c66 2c20 6e70 6172  tiles(self, npar
-00022f10: 7469 7469 6f6e 732c 2075 7073 616d 706c  titions, upsampl
-00022f20: 653d 7570 7361 6d70 6c65 290a 0a20 2020  e=upsample)..   
-00022f30: 2064 6566 205f 5f67 6574 6974 656d 5f5f   def __getitem__
-00022f40: 2873 656c 662c 206b 6579 293a 0a20 2020  (self, key):.   
-00022f50: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00022f60: 6365 286b 6579 2c20 5365 7269 6573 2920  ce(key, Series) 
-00022f70: 616e 6420 7365 6c66 2e64 6976 6973 696f  and self.divisio
-00022f80: 6e73 203d 3d20 6b65 792e 6469 7669 7369  ns == key.divisi
-00022f90: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
-00022fa0: 206e 616d 6520 3d20 2269 6e64 6578 2d25   name = "index-%
-00022fb0: 7322 2025 2074 6f6b 656e 697a 6528 7365  s" % tokenize(se
-00022fc0: 6c66 2c20 6b65 7929 0a20 2020 2020 2020  lf, key).       
-00022fd0: 2020 2020 2064 736b 203d 2070 6172 7469       dsk = parti
-00022fe0: 7469 6f6e 7769 7365 5f67 7261 7068 286f  tionwise_graph(o
-00022ff0: 7065 7261 746f 722e 6765 7469 7465 6d2c  perator.getitem,
-00023000: 206e 616d 652c 2073 656c 662c 206b 6579   name, self, key
-00023010: 290a 2020 2020 2020 2020 2020 2020 6772  ).            gr
-00023020: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
-00023030: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
-00023040: 7469 6f6e 7328 6e61 6d65 2c20 6473 6b2c  tions(name, dsk,
-00023050: 2064 6570 656e 6465 6e63 6965 733d 5b73   dependencies=[s
-00023060: 656c 662c 206b 6579 5d29 0a20 2020 2020  elf, key]).     
-00023070: 2020 2020 2020 2072 6574 7572 6e20 5365         return Se
-00023080: 7269 6573 2867 7261 7068 2c20 6e61 6d65  ries(graph, name
-00023090: 2c20 7365 6c66 2e5f 6d65 7461 2c20 7365  , self._meta, se
-000230a0: 6c66 2e64 6976 6973 696f 6e73 290a 2020  lf.divisions).  
-000230b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000230c0: 662e 6c6f 635b 6b65 795d 0a0a 2020 2020  f.loc[key]..    
-000230d0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-000230e0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-000230f0: 6465 6620 5f67 6574 5f6e 756d 6572 6963  def _get_numeric
-00023100: 5f64 6174 6128 7365 6c66 2c20 686f 773d  _data(self, how=
-00023110: 2261 6e79 222c 2073 7562 7365 743d 4e6f  "any", subset=No
-00023120: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
-00023130: 7572 6e20 7365 6c66 0a0a 2020 2020 6966  urn self..    if
-00023140: 206e 6f74 2050 414e 4441 535f 4754 5f32   not PANDAS_GT_2
-00023150: 3030 3a0a 0a20 2020 2020 2020 2040 6465  00:..        @de
-00023160: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00023170: 7269 6573 290a 2020 2020 2020 2020 6465  ries).        de
-00023180: 6620 6974 6572 6974 656d 7328 7365 6c66  f iteritems(self
-00023190: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-000231a0: 6620 5041 4e44 4153 5f47 545f 3135 303a  f PANDAS_GT_150:
-000231b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000231c0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-000231d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000231e0: 2020 2020 2269 7465 7269 7465 6d73 2069      "iteritems i
-000231f0: 7320 6465 7072 6563 6174 6564 2061 6e64  s deprecated and
-00023200: 2077 696c 6c20 6265 2072 656d 6f76 6564   will be removed
-00023210: 2069 6e20 6120 6675 7475 7265 2076 6572   in a future ver
-00023220: 7369 6f6e 2e20 220a 2020 2020 2020 2020  sion. ".        
-00023230: 2020 2020 2020 2020 2020 2020 2255 7365              "Use
-00023240: 202e 6974 656d 7320 696e 7374 6561 642e   .items instead.
-00023250: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00023260: 2020 2020 2020 2046 7574 7572 6557 6172         FutureWar
-00023270: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
-00023280: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00023290: 2020 2020 2320 5765 2075 7365 2074 6865      # We use the
-000232a0: 2060 5f60 2067 656e 6572 6174 6f72 2062   `_` generator b
-000232b0: 656c 6f77 2074 6f20 656e 7375 7265 2074  elow to ensure t
-000232c0: 6865 2064 6570 7265 6361 7469 6f6e 2077  he deprecation w
-000232d0: 6172 6e69 6e67 2061 626f 7665 0a20 2020  arning above.   
-000232e0: 2020 2020 2020 2020 2023 2069 7320 7261           # is ra
-000232f0: 6973 6564 2077 6865 6e20 602e 6974 6572  ised when `.iter
-00023300: 6974 656d 7328 2960 2069 7320 6361 6c6c  items()` is call
-00023310: 6564 2c20 6e6f 7420 7768 656e 2074 6865  ed, not when the
-00023320: 2066 6972 7374 2060 6e65 7874 283c 6765   first `next(<ge
-00023330: 6e65 7261 746f 723e 2960 0a20 2020 2020  nerator>)`.     
-00023340: 2020 2020 2020 2023 2069 7465 7261 7469         # iterati
-00023350: 6f6e 2068 6170 7065 6e73 0a0a 2020 2020  on happens..    
-00023360: 2020 2020 2020 2020 6465 6620 5f28 7365          def _(se
-00023370: 6c66 293a 0a20 2020 2020 2020 2020 2020  lf):.           
-00023380: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00023390: 6e67 6528 7365 6c66 2e6e 7061 7274 6974  nge(self.npartit
-000233a0: 696f 6e73 293a 0a20 2020 2020 2020 2020  ions):.         
-000233b0: 2020 2020 2020 2020 2020 2073 203d 2073             s = s
-000233c0: 656c 662e 6765 745f 7061 7274 6974 696f  elf.get_partitio
-000233d0: 6e28 6929 2e63 6f6d 7075 7465 2829 0a20  n(i).compute(). 
-000233e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000233f0: 2020 2079 6965 6c64 2066 726f 6d20 732e     yield from s.
-00023400: 6974 656d 7328 290a 0a20 2020 2020 2020  items()..       
-00023410: 2020 2020 2072 6574 7572 6e20 5f28 7365       return _(se
-00023420: 6c66 290a 0a20 2020 2040 6465 7269 7665  lf)..    @derive
-00023430: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
-00023440: 290a 2020 2020 6465 6620 5f5f 6974 6572  ).    def __iter
-00023450: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00023460: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00023470: 2873 656c 662e 6e70 6172 7469 7469 6f6e  (self.npartition
-00023480: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00023490: 7320 3d20 7365 6c66 2e67 6574 5f70 6172  s = self.get_par
-000234a0: 7469 7469 6f6e 2869 292e 636f 6d70 7574  tition(i).comput
-000234b0: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-000234c0: 7969 656c 6420 6672 6f6d 2073 0a0a 2020  yield from s..  
-000234d0: 2020 405f 6465 7072 6563 6174 6564 280a    @_deprecated(.
-000234e0: 2020 2020 2020 2020 6d65 7373 6167 653d          message=
-000234f0: 280a 2020 2020 2020 2020 2020 2020 2255  (.            "U
-00023500: 7369 6e67 2074 6865 2060 6069 6e60 6020  sing the ``in`` 
-00023510: 6f70 6572 6174 6f72 2074 6f20 7465 7374  operator to test
-00023520: 2066 6f72 206d 656d 6265 7273 6869 7020   for membership 
-00023530: 696e 2053 6572 6965 7320 6973 2022 0a20  in Series is ". 
-00023540: 2020 2020 2020 2020 2020 2022 6465 7072             "depr
-00023550: 6563 6174 6564 2e20 546f 2074 6573 7420  ecated. To test 
-00023560: 666f 7220 6d65 6d62 6572 7368 6970 2069  for membership i
-00023570: 6e20 7468 6520 696e 6465 7820 7573 6520  n the index use 
-00023580: 220a 2020 2020 2020 2020 2020 2020 2260  ".            "`
-00023590: 6028 732e 696e 6465 7820 3d3d 206b 6579  `(s.index == key
-000235a0: 292e 616e 7928 2960 602e 2053 696d 696c  ).any()``. Simil
-000235b0: 6172 6c79 2074 6f20 7465 7374 2066 6f72  arly to test for
-000235c0: 206d 656d 6265 7273 6869 7020 696e 2022   membership in "
-000235d0: 0a20 2020 2020 2020 2020 2020 2022 7468  .            "th
-000235e0: 6520 7661 6c75 6573 2075 7365 2060 6028  e values use ``(
-000235f0: 7320 3d3d 206b 6579 292e 616e 7928 2960  s == key).any()`
-00023600: 6022 0a20 2020 2020 2020 2029 0a20 2020  `".        ).   
-00023610: 2029 0a20 2020 2064 6566 205f 5f63 6f6e   ).    def __con
-00023620: 7461 696e 735f 5f28 7365 6c66 2c20 6b65  tains__(self, ke
-00023630: 7929 3a0a 2020 2020 2020 2020 7265 7475  y):.        retu
-00023640: 726e 2028 7365 6c66 203d 3d20 6b65 7929  rn (self == key)
-00023650: 2e61 6e79 2829 2e63 6f6d 7075 7465 2829  .any().compute()
-00023660: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
-00023670: 6f64 0a20 2020 2064 6566 205f 7661 6c69  od.    def _vali
-00023680: 6461 7465 5f61 7869 7328 636c 732c 2061  date_axis(cls, a
-00023690: 7869 733d 302c 206e 6f6e 655f 6973 5f7a  xis=0, none_is_z
-000236a0: 6572 6f3a 2062 6f6f 6c20 3d20 5472 7565  ero: bool = True
-000236b0: 2920 2d3e 204e 6f6e 6520 7c20 4c69 7465  ) -> None | Lite
-000236c0: 7261 6c5b 302c 2031 5d3a 0a20 2020 2020  ral[0, 1]:.     
-000236d0: 2020 2069 6620 6178 6973 206e 6f74 2069     if axis not i
-000236e0: 6e20 2830 2c20 2269 6e64 6578 222c 204e  n (0, "index", N
-000236f0: 6f6e 6529 3a0a 2020 2020 2020 2020 2020  one):.          
-00023700: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00023710: 6f72 2866 224e 6f20 6178 6973 206e 616d  or(f"No axis nam
-00023720: 6564 207b 6178 6973 7d22 290a 2020 2020  ed {axis}").    
-00023730: 2020 2020 2320 636f 6e76 6572 7420 746f      # convert to
-00023740: 206e 756d 6572 6963 2061 7869 730a 2020   numeric axis.  
-00023750: 2020 2020 2020 6e75 6d65 7269 635f 6178        numeric_ax
-00023760: 6973 3a20 6469 6374 5b73 7472 207c 204e  is: dict[str | N
-00023770: 6f6e 652c 204c 6974 6572 616c 5b30 2c20  one, Literal[0, 
-00023780: 315d 5d20 3d20 7b22 696e 6465 7822 3a20  1]] = {"index": 
-00023790: 307d 0a20 2020 2020 2020 2069 6620 6e6f  0}.        if no
-000237a0: 6e65 5f69 735f 7a65 726f 3a0a 2020 2020  ne_is_zero:.    
-000237b0: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
-000237c0: 6178 6973 5b4e 6f6e 655d 203d 2030 0a20  axis[None] = 0. 
-000237d0: 2020 2020 2020 2072 6574 7572 6e20 6e75         return nu
-000237e0: 6d65 7269 635f 6178 6973 2e67 6574 2861  meric_axis.get(a
-000237f0: 7869 732c 2061 7869 7329 0a0a 2020 2020  xis, axis)..    
-00023800: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00023810: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
-00023820: 2067 726f 7570 6279 280a 2020 2020 2020   groupby(.      
-00023830: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00023840: 6279 3d4e 6f6e 652c 0a20 2020 2020 2020  by=None,.       
-00023850: 2067 726f 7570 5f6b 6579 733d 4752 4f55   group_keys=GROU
-00023860: 505f 4b45 5953 5f44 4546 4155 4c54 2c0a  P_KEYS_DEFAULT,.
-00023870: 2020 2020 2020 2020 736f 7274 3d4e 6f6e          sort=Non
-00023880: 652c 0a20 2020 2020 2020 206f 6273 6572  e,.        obser
-00023890: 7665 643d 4e6f 6e65 2c0a 2020 2020 2020  ved=None,.      
-000238a0: 2020 6472 6f70 6e61 3d4e 6f6e 652c 0a20    dropna=None,. 
-000238b0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
-000238c0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-000238d0: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
-000238e0: 616d 652e 6772 6f75 7062 7920 696d 706f  ame.groupby impo
-000238f0: 7274 2053 6572 6965 7347 726f 7570 4279  rt SeriesGroupBy
-00023900: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00023910: 2053 6572 6965 7347 726f 7570 4279 280a   SeriesGroupBy(.
-00023920: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00023930: 2c0a 2020 2020 2020 2020 2020 2020 6279  ,.            by
-00023940: 3d62 792c 0a20 2020 2020 2020 2020 2020  =by,.           
-00023950: 2067 726f 7570 5f6b 6579 733d 6772 6f75   group_keys=grou
-00023960: 705f 6b65 7973 2c0a 2020 2020 2020 2020  p_keys,.        
-00023970: 2020 2020 736f 7274 3d73 6f72 742c 0a20      sort=sort,. 
-00023980: 2020 2020 2020 2020 2020 206f 6273 6572             obser
-00023990: 7665 643d 6f62 7365 7276 6564 2c0a 2020  ved=observed,.  
-000239a0: 2020 2020 2020 2020 2020 6472 6f70 6e61            dropna
-000239b0: 3d64 726f 706e 612c 0a20 2020 2020 2020  =dropna,.       
-000239c0: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
-000239d0: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-000239e0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
-000239f0: 6572 6965 7329 0a20 2020 2064 6566 2063  eries).    def c
-00023a00: 6f75 6e74 2873 656c 662c 2073 706c 6974  ount(self, split
-00023a10: 5f65 7665 7279 3d46 616c 7365 293a 0a20  _every=False):. 
-00023a20: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
-00023a30: 7065 7228 292e 636f 756e 7428 7370 6c69  per().count(spli
-00023a40: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-00023a50: 6572 7929 0a0a 2020 2020 4064 6572 6976  ery)..    @deriv
-00023a60: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-00023a70: 7329 0a20 2020 2064 6566 206d 6f64 6528  s).    def mode(
-00023a80: 7365 6c66 2c20 6472 6f70 6e61 3d54 7275  self, dropna=Tru
-00023a90: 652c 2073 706c 6974 5f65 7665 7279 3d46  e, split_every=F
-00023aa0: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
-00023ab0: 6574 7572 6e20 7375 7065 7228 292e 6d6f  eturn super().mo
-00023ac0: 6465 2864 726f 706e 613d 6472 6f70 6e61  de(dropna=dropna
-00023ad0: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
-00023ae0: 6c69 745f 6576 6572 7929 0a0a 2020 2020  lit_every)..    
-00023af0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00023b00: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
-00023b10: 2065 7870 6c6f 6465 2873 656c 6629 3a0a   explode(self):.
-00023b20: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
-00023b30: 656c 662e 5f6d 6574 612e 6578 706c 6f64  elf._meta.explod
-00023b40: 6528 290a 2020 2020 2020 2020 7265 7475  e().        retu
-00023b50: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-00023b60: 6974 696f 6e73 284d 2e65 7870 6c6f 6465  itions(M.explode
-00023b70: 2c20 6d65 7461 3d6d 6574 612c 2065 6e66  , meta=meta, enf
-00023b80: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-00023b90: 6c73 6529 0a0a 2020 2020 6465 6620 756e  lse)..    def un
-00023ba0: 6971 7565 2873 656c 662c 2073 706c 6974  ique(self, split
-00023bb0: 5f65 7665 7279 3d4e 6f6e 652c 2073 706c  _every=None, spl
-00023bc0: 6974 5f6f 7574 3d31 293a 0a20 2020 2020  it_out=1):.     
-00023bd0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-00023be0: 6574 7572 6e20 5365 7269 6573 206f 6620  eturn Series of 
-00023bf0: 756e 6971 7565 2076 616c 7565 7320 696e  unique values in
-00023c00: 2074 6865 206f 626a 6563 742e 2049 6e63   the object. Inc
-00023c10: 6c75 6465 7320 4e41 2076 616c 7565 732e  ludes NA values.
-00023c20: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00023c30: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00023c40: 2d0a 2020 2020 2020 2020 756e 6971 7565  -.        unique
-00023c50: 7320 3a20 5365 7269 6573 0a20 2020 2020  s : Series.     
-00023c60: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-00023c70: 6574 7572 6e20 6163 6128 0a20 2020 2020  eturn aca(.     
-00023c80: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00023c90: 2020 2020 2020 2020 2063 6875 6e6b 3d6d           chunk=m
-00023ca0: 6574 686f 6473 2e75 6e69 7175 652c 0a20  ethods.unique,. 
-00023cb0: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
-00023cc0: 6761 7465 3d6d 6574 686f 6473 2e75 6e69  gate=methods.uni
-00023cd0: 7175 652c 0a20 2020 2020 2020 2020 2020  que,.           
-00023ce0: 206d 6574 613d 7365 6c66 2e5f 6d65 7461   meta=self._meta
-00023cf0: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
-00023d00: 6b65 6e3d 2275 6e69 7175 6522 2c0a 2020  ken="unique",.  
-00023d10: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
-00023d20: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-00023d30: 792c 0a20 2020 2020 2020 2020 2020 2073  y,.            s
-00023d40: 6572 6965 735f 6e61 6d65 3d73 656c 662e  eries_name=self.
-00023d50: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00023d60: 2020 7370 6c69 745f 6f75 743d 7370 6c69    split_out=spli
-00023d70: 745f 6f75 742c 0a20 2020 2020 2020 2029  t_out,.        )
-00023d80: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00023d90: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00023da0: 2020 2064 6566 206e 756e 6971 7565 2873     def nunique(s
-00023db0: 656c 662c 2073 706c 6974 5f65 7665 7279  elf, split_every
-00023dc0: 3d4e 6f6e 652c 2064 726f 706e 613d 5472  =None, dropna=Tr
-00023dd0: 7565 293a 0a20 2020 2020 2020 2075 6e69  ue):.        uni
-00023de0: 7173 203d 2073 656c 662e 6472 6f70 5f64  qs = self.drop_d
-00023df0: 7570 6c69 6361 7465 7328 7370 6c69 745f  uplicates(split_
-00023e00: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-00023e10: 7929 0a20 2020 2020 2020 2069 6620 6472  y).        if dr
-00023e20: 6f70 6e61 3a0a 2020 2020 2020 2020 2020  opna:.          
-00023e30: 2020 2320 636f 756e 7420 6d69 6d69 6373    # count mimics
-00023e40: 2070 616e 6461 7320 6265 6861 7669 6f72   pandas behavior
-00023e50: 2061 6e64 2065 7863 6c75 6465 7320 4e41   and excludes NA
-00023e60: 2076 616c 7565 730a 2020 2020 2020 2020   values.        
-00023e70: 2020 2020 7265 7475 726e 2075 6e69 7173      return uniqs
-00023e80: 2e63 6f75 6e74 2829 0a20 2020 2020 2020  .count().       
-00023e90: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00023ea0: 2020 2072 6574 7572 6e20 756e 6971 732e     return uniqs.
-00023eb0: 7369 7a65 0a0a 2020 2020 4064 6572 6976  size..    @deriv
-00023ec0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-00023ed0: 7329 0a20 2020 2064 6566 2076 616c 7565  s).    def value
-00023ee0: 5f63 6f75 6e74 7328 0a20 2020 2020 2020  _counts(.       
-00023ef0: 2073 656c 662c 0a20 2020 2020 2020 2073   self,.        s
-00023f00: 6f72 743d 4e6f 6e65 2c0a 2020 2020 2020  ort=None,.      
-00023f10: 2020 6173 6365 6e64 696e 673d 4661 6c73    ascending=Fals
-00023f20: 652c 0a20 2020 2020 2020 2064 726f 706e  e,.        dropn
-00023f30: 613d 4e6f 6e65 2c0a 2020 2020 2020 2020  a=None,.        
-00023f40: 6e6f 726d 616c 697a 653d 4661 6c73 652c  normalize=False,
-00023f50: 0a20 2020 2020 2020 2073 706c 6974 5f65  .        split_e
-00023f60: 7665 7279 3d4e 6f6e 652c 0a20 2020 2020  very=None,.     
-00023f70: 2020 2073 706c 6974 5f6f 7574 3d31 2c0a     split_out=1,.
-00023f80: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-00023f90: 2222 0a20 2020 2020 2020 204e 6f74 653a  "".        Note:
-00023fa0: 2064 726f 706e 6120 6973 206f 6e6c 7920   dropna is only 
-00023fb0: 7375 7070 6f72 7465 6420 696e 2070 616e  supported in pan
-00023fc0: 6461 7320 3e3d 2031 2e31 2e30 2c20 696e  das >= 1.1.0, in
-00023fd0: 2077 6869 6368 2063 6173 6520 6974 2064   which case it d
-00023fe0: 6566 6175 6c74 7320 746f 0a20 2020 2020  efaults to.     
-00023ff0: 2020 2054 7275 652e 0a20 2020 2020 2020     True..       
-00024000: 2022 2222 0a20 2020 2020 2020 206b 7761   """.        kwa
-00024010: 7267 7320 3d20 7b22 736f 7274 223a 2073  rgs = {"sort": s
-00024020: 6f72 742c 2022 6173 6365 6e64 696e 6722  ort, "ascending"
-00024030: 3a20 6173 6365 6e64 696e 677d 0a20 2020  : ascending}.   
-00024040: 2020 2020 2069 6620 6472 6f70 6e61 2069       if dropna i
-00024050: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00024060: 2020 2020 2020 2020 6b77 6172 6773 5b22          kwargs["
-00024070: 6472 6f70 6e61 225d 203d 2064 726f 706e  dropna"] = dropn
-00024080: 610a 2020 2020 2020 2020 6167 6772 6567  a.        aggreg
-00024090: 6174 655f 6b77 6172 6773 203d 207b 226e  ate_kwargs = {"n
-000240a0: 6f72 6d61 6c69 7a65 223a 206e 6f72 6d61  ormalize": norma
-000240b0: 6c69 7a65 7d0a 2020 2020 2020 2020 6966  lize}.        if
-000240c0: 2073 706c 6974 5f6f 7574 203e 2031 3a0a   split_out > 1:.
-000240d0: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
-000240e0: 6567 6174 655f 6b77 6172 6773 5b22 746f  egate_kwargs["to
-000240f0: 7461 6c5f 6c65 6e67 7468 225d 203d 2028  tal_length"] = (
-00024100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024110: 206c 656e 2873 656c 6629 2069 6620 6472   len(self) if dr
-00024120: 6f70 6e61 2069 7320 4661 6c73 6520 656c  opna is False el
-00024130: 7365 206c 656e 2873 656c 662e 6472 6f70  se len(self.drop
-00024140: 6e61 2829 290a 2020 2020 2020 2020 2020  na()).          
-00024150: 2020 290a 0a20 2020 2020 2020 2072 6574    )..        ret
-00024160: 7572 6e20 6163 6128 0a20 2020 2020 2020  urn aca(.       
-00024170: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00024180: 2020 2020 2020 2063 6875 6e6b 3d4d 2e76         chunk=M.v
-00024190: 616c 7565 5f63 6f75 6e74 732c 0a20 2020  alue_counts,.   
-000241a0: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
-000241b0: 7465 3d6d 6574 686f 6473 2e76 616c 7565  te=methods.value
-000241c0: 5f63 6f75 6e74 735f 6167 6772 6567 6174  _counts_aggregat
-000241d0: 652c 0a20 2020 2020 2020 2020 2020 2063  e,.            c
-000241e0: 6f6d 6269 6e65 3d6d 6574 686f 6473 2e76  ombine=methods.v
-000241f0: 616c 7565 5f63 6f75 6e74 735f 636f 6d62  alue_counts_comb
-00024200: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
-00024210: 206d 6574 613d 7365 6c66 2e5f 6d65 7461   meta=self._meta
-00024220: 2e76 616c 7565 5f63 6f75 6e74 7328 6e6f  .value_counts(no
-00024230: 726d 616c 697a 653d 6e6f 726d 616c 697a  rmalize=normaliz
-00024240: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-00024250: 746f 6b65 6e3d 2276 616c 7565 2d63 6f75  token="value-cou
-00024260: 6e74 7322 2c0a 2020 2020 2020 2020 2020  nts",.          
-00024270: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
-00024280: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
-00024290: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
-000242a0: 3d73 706c 6974 5f6f 7574 2c0a 2020 2020  =split_out,.    
-000242b0: 2020 2020 2020 2020 7370 6c69 745f 6f75          split_ou
-000242c0: 745f 7365 7475 703d 7370 6c69 745f 6f75  t_setup=split_ou
-000242d0: 745f 6f6e 5f69 6e64 6578 2c0a 2020 2020  t_on_index,.    
-000242e0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-000242f0: 655f 6b77 6172 6773 3d61 6767 7265 6761  e_kwargs=aggrega
-00024300: 7465 5f6b 7761 7267 732c 0a20 2020 2020  te_kwargs,.     
-00024310: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
-00024320: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00024330: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00024340: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
-00024350: 206e 6c61 7267 6573 7428 7365 6c66 2c20   nlargest(self, 
-00024360: 6e3d 352c 2073 706c 6974 5f65 7665 7279  n=5, split_every
-00024370: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00024380: 7265 7475 726e 2061 6361 280a 2020 2020  return aca(.    
-00024390: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000243a0: 2020 2020 2020 2020 2020 6368 756e 6b3d            chunk=
-000243b0: 4d2e 6e6c 6172 6765 7374 2c0a 2020 2020  M.nlargest,.    
-000243c0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-000243d0: 653d 4d2e 6e6c 6172 6765 7374 2c0a 2020  e=M.nlargest,.  
-000243e0: 2020 2020 2020 2020 2020 6d65 7461 3d73            meta=s
-000243f0: 656c 662e 5f6d 6574 612c 0a20 2020 2020  elf._meta,.     
-00024400: 2020 2020 2020 2074 6f6b 656e 3d22 7365         token="se
-00024410: 7269 6573 2d6e 6c61 7267 6573 7422 2c0a  ries-nlargest",.
-00024420: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-00024430: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-00024440: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
-00024450: 206e 3d6e 2c0a 2020 2020 2020 2020 290a   n=n,.        ).
-00024460: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00024470: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-00024480: 2020 6465 6620 6e73 6d61 6c6c 6573 7428    def nsmallest(
-00024490: 7365 6c66 2c20 6e3d 352c 2073 706c 6974  self, n=5, split
-000244a0: 5f65 7665 7279 3d4e 6f6e 6529 3a0a 2020  _every=None):.  
-000244b0: 2020 2020 2020 7265 7475 726e 2061 6361        return aca
-000244c0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-000244d0: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
-000244e0: 6368 756e 6b3d 4d2e 6e73 6d61 6c6c 6573  chunk=M.nsmalles
-000244f0: 742c 0a20 2020 2020 2020 2020 2020 2061  t,.            a
-00024500: 6767 7265 6761 7465 3d4d 2e6e 736d 616c  ggregate=M.nsmal
-00024510: 6c65 7374 2c0a 2020 2020 2020 2020 2020  lest,.          
-00024520: 2020 6d65 7461 3d73 656c 662e 5f6d 6574    meta=self._met
-00024530: 612c 0a20 2020 2020 2020 2020 2020 2074  a,.            t
-00024540: 6f6b 656e 3d22 7365 7269 6573 2d6e 736d  oken="series-nsm
-00024550: 616c 6c65 7374 222c 0a20 2020 2020 2020  allest",.       
-00024560: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-00024570: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
-00024580: 2020 2020 2020 2020 2020 6e3d 6e2c 0a20            n=n,. 
-00024590: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-000245a0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
-000245b0: 6572 6965 7329 0a20 2020 2064 6566 2069  eries).    def i
-000245c0: 7369 6e28 7365 6c66 2c20 7661 6c75 6573  sin(self, values
-000245d0: 293a 0a20 2020 2020 2020 2023 2041 6464  ):.        # Add
-000245e0: 6564 206a 7573 7420 746f 2067 6574 2074  ed just to get t
-000245f0: 6865 2064 6966 6665 7265 6e74 2064 6f63  he different doc
-00024600: 7374 7269 6e67 2066 6f72 2053 6572 6965  string for Serie
-00024610: 730a 2020 2020 2020 2020 7265 7475 726e  s.        return
-00024620: 2073 7570 6572 2829 2e69 7369 6e28 7661   super().isin(va
-00024630: 6c75 6573 290a 0a20 2020 2040 696e 7365  lues)..    @inse
-00024640: 7274 5f6d 6574 615f 7061 7261 6d5f 6465  rt_meta_param_de
-00024650: 7363 7269 7074 696f 6e28 7061 643d 3132  scription(pad=12
-00024660: 290a 2020 2020 4064 6572 6976 6564 5f66  ).    @derived_f
-00024670: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00024680: 2020 2064 6566 206d 6170 2873 656c 662c     def map(self,
-00024690: 2061 7267 2c20 6e61 5f61 6374 696f 6e3d   arg, na_action=
-000246a0: 4e6f 6e65 2c20 6d65 7461 3d6e 6f5f 6465  None, meta=no_de
-000246b0: 6661 756c 7429 3a0a 2020 2020 2020 2020  fault):.        
-000246c0: 6966 2069 735f 7365 7269 6573 5f6c 696b  if is_series_lik
-000246d0: 6528 6172 6729 2061 6e64 2069 735f 6461  e(arg) and is_da
-000246e0: 736b 5f63 6f6c 6c65 6374 696f 6e28 6172  sk_collection(ar
-000246f0: 6729 3a0a 2020 2020 2020 2020 2020 2020  g):.            
-00024700: 7265 7475 726e 2073 6572 6965 735f 6d61  return series_ma
-00024710: 7028 7365 6c66 2c20 6172 6729 0a20 2020  p(self, arg).   
-00024720: 2020 2020 2069 6620 6e6f 7420 280a 2020       if not (.  
-00024730: 2020 2020 2020 2020 2020 6973 696e 7374            isinst
-00024740: 616e 6365 2861 7267 2c20 6469 6374 290a  ance(arg, dict).
-00024750: 2020 2020 2020 2020 2020 2020 6f72 2063              or c
-00024760: 616c 6c61 626c 6528 6172 6729 0a20 2020  allable(arg).   
-00024770: 2020 2020 2020 2020 206f 7220 6973 5f73           or is_s
-00024780: 6572 6965 735f 6c69 6b65 2861 7267 290a  eries_like(arg).
-00024790: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-000247a0: 6e6f 7420 6973 5f64 6173 6b5f 636f 6c6c  not is_dask_coll
-000247b0: 6563 7469 6f6e 2861 7267 290a 2020 2020  ection(arg).    
-000247c0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-000247d0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-000247e0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-000247f0: 2020 2020 6622 6172 6720 6d75 7374 2062      f"arg must b
-00024800: 6520 7061 6e64 6173 2e53 6572 6965 732c  e pandas.Series,
-00024810: 2064 6963 7420 6f72 2063 616c 6c61 626c   dict or callabl
-00024820: 652e 2047 6f74 207b 7479 7065 2861 7267  e. Got {type(arg
-00024830: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
-00024840: 290a 2020 2020 2020 2020 6e61 6d65 203d  ).        name =
-00024850: 2022 6d61 702d 2220 2b20 746f 6b65 6e69   "map-" + tokeni
-00024860: 7a65 2873 656c 662c 2061 7267 2c20 6e61  ze(self, arg, na
-00024870: 5f61 6374 696f 6e29 0a20 2020 2020 2020  _action).       
-00024880: 2064 736b 203d 207b 0a20 2020 2020 2020   dsk = {.       
-00024890: 2020 2020 2028 6e61 6d65 2c20 6929 3a20       (name, i): 
-000248a0: 284d 2e6d 6170 2c20 6b2c 2061 7267 2c20  (M.map, k, arg, 
-000248b0: 6e61 5f61 6374 696f 6e29 0a20 2020 2020  na_action).     
-000248c0: 2020 2020 2020 2066 6f72 2069 2c20 6b20         for i, k 
-000248d0: 696e 2065 6e75 6d65 7261 7465 2873 656c  in enumerate(sel
-000248e0: 662e 5f5f 6461 736b 5f6b 6579 735f 5f28  f.__dask_keys__(
-000248f0: 2929 0a20 2020 2020 2020 207d 0a20 2020  )).        }.   
-00024900: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
-00024910: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-00024920: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
-00024930: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
-00024940: 6369 6573 3d5b 7365 6c66 5d29 0a20 2020  cies=[self]).   
-00024950: 2020 2020 2069 6620 6d65 7461 2069 7320       if meta is 
-00024960: 6e6f 5f64 6566 6175 6c74 3a0a 2020 2020  no_default:.    
-00024970: 2020 2020 2020 2020 6d65 7461 203d 205f          meta = _
-00024980: 656d 756c 6174 6528 4d2e 6d61 702c 2073  emulate(M.map, s
-00024990: 656c 662c 2061 7267 2c20 6e61 5f61 6374  elf, arg, na_act
-000249a0: 696f 6e3d 6e61 5f61 6374 696f 6e2c 2075  ion=na_action, u
-000249b0: 6466 3d54 7275 6529 0a20 2020 2020 2020  df=True).       
-000249c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000249d0: 2020 206d 6574 6120 3d20 6d61 6b65 5f6d     meta = make_m
-000249e0: 6574 6128 0a20 2020 2020 2020 2020 2020  eta(.           
-000249f0: 2020 2020 206d 6574 612c 0a20 2020 2020       meta,.     
-00024a00: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-00024a10: 3d67 6574 6174 7472 286d 616b 655f 6d65  =getattr(make_me
-00024a20: 7461 2873 656c 6629 2c20 2269 6e64 6578  ta(self), "index
-00024a30: 222c 204e 6f6e 6529 2c0a 2020 2020 2020  ", None),.      
-00024a40: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
-00024a50: 5f6d 6574 613d 7365 6c66 2e5f 6d65 7461  _meta=self._meta
-00024a60: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00024a70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00024a80: 7479 7065 2873 656c 6629 2867 7261 7068  type(self)(graph
-00024a90: 2c20 6e61 6d65 2c20 6d65 7461 2c20 7365  , name, meta, se
-00024aa0: 6c66 2e64 6976 6973 696f 6e73 290a 0a20  lf.divisions).. 
-00024ab0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00024ac0: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
-00024ad0: 6465 6620 6472 6f70 6e61 2873 656c 6629  def dropna(self)
-00024ae0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00024af0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-00024b00: 696f 6e73 284d 2e64 726f 706e 612c 2065  ions(M.dropna, e
-00024b10: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
-00024b20: 4661 6c73 6529 0a0a 2020 2020 4064 6572  False)..    @der
-00024b30: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
-00024b40: 6965 7329 0a20 2020 2064 6566 2062 6574  ies).    def bet
-00024b50: 7765 656e 2873 656c 662c 206c 6566 742c  ween(self, left,
-00024b60: 2072 6967 6874 2c20 696e 636c 7573 6976   right, inclusiv
-00024b70: 653d 2262 6f74 6822 293a 0a20 2020 2020  e="both"):.     
-00024b80: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00024b90: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-00024ba0: 2020 2020 2020 2020 2020 204d 2e62 6574             M.bet
-00024bb0: 7765 656e 2c20 6c65 6674 3d6c 6566 742c  ween, left=left,
-00024bc0: 2072 6967 6874 3d72 6967 6874 2c20 696e   right=right, in
-00024bd0: 636c 7573 6976 653d 696e 636c 7573 6976  clusive=inclusiv
-00024be0: 650a 2020 2020 2020 2020 290a 0a20 2020  e.        )..   
-00024bf0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00024c00: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
-00024c10: 6620 636c 6970 2873 656c 662c 206c 6f77  f clip(self, low
-00024c20: 6572 3d4e 6f6e 652c 2075 7070 6572 3d4e  er=None, upper=N
-00024c30: 6f6e 652c 206f 7574 3d4e 6f6e 6529 3a0a  one, out=None):.
-00024c40: 2020 2020 2020 2020 6966 206f 7574 2069          if out i
-00024c50: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00024c60: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00024c70: 6c75 6545 7272 6f72 2822 276f 7574 2720  lueError("'out' 
-00024c80: 6d75 7374 2062 6520 4e6f 6e65 2229 0a20  must be None"). 
-00024c90: 2020 2020 2020 2023 206e 702e 636c 6970         # np.clip
-00024ca0: 206d 6179 2070 6173 7320 6f75 740a 2020   may pass out.  
-00024cb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00024cc0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-00024cd0: 280a 2020 2020 2020 2020 2020 2020 4d2e  (.            M.
-00024ce0: 636c 6970 2c20 6c6f 7765 723d 6c6f 7765  clip, lower=lowe
-00024cf0: 722c 2075 7070 6572 3d75 7070 6572 2c20  r, upper=upper, 
-00024d00: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-00024d10: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
-00024d20: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00024d30: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00024d40: 2020 2064 6566 2063 6c69 705f 6c6f 7765     def clip_lowe
-00024d50: 7228 7365 6c66 2c20 7468 7265 7368 6f6c  r(self, threshol
-00024d60: 6429 3a0a 2020 2020 2020 2020 7265 7475  d):.        retu
-00024d70: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-00024d80: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-00024d90: 2020 2020 4d2e 636c 6970 5f6c 6f77 6572      M.clip_lower
-00024da0: 2c20 7468 7265 7368 6f6c 643d 7468 7265  , threshold=thre
-00024db0: 7368 6f6c 642c 2065 6e66 6f72 6365 5f6d  shold, enforce_m
-00024dc0: 6574 6164 6174 613d 4661 6c73 650a 2020  etadata=False.  
-00024dd0: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
-00024de0: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00024df0: 7269 6573 290a 2020 2020 6465 6620 636c  ries).    def cl
-00024e00: 6970 5f75 7070 6572 2873 656c 662c 2074  ip_upper(self, t
-00024e10: 6872 6573 686f 6c64 293a 0a20 2020 2020  hreshold):.     
-00024e20: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00024e30: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-00024e40: 2020 2020 2020 2020 2020 204d 2e63 6c69             M.cli
-00024e50: 705f 7570 7065 722c 2074 6872 6573 686f  p_upper, thresho
-00024e60: 6c64 3d74 6872 6573 686f 6c64 2c20 656e  ld=threshold, en
-00024e70: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
-00024e80: 616c 7365 0a20 2020 2020 2020 2029 0a0a  alse.        )..
-00024e90: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00024ea0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-00024eb0: 2064 6566 2061 6c69 676e 2873 656c 662c   def align(self,
-00024ec0: 206f 7468 6572 2c20 6a6f 696e 3d22 6f75   other, join="ou
-00024ed0: 7465 7222 2c20 6178 6973 3d4e 6f6e 652c  ter", axis=None,
-00024ee0: 2066 696c 6c5f 7661 6c75 653d 4e6f 6e65   fill_value=None
-00024ef0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00024f00: 6e20 7375 7065 7228 292e 616c 6967 6e28  n super().align(
-00024f10: 6f74 6865 722c 206a 6f69 6e3d 6a6f 696e  other, join=join
-00024f20: 2c20 6178 6973 3d61 7869 732c 2066 696c  , axis=axis, fil
-00024f30: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
-00024f40: 7565 290a 0a20 2020 2040 6465 7269 7665  ue)..    @derive
-00024f50: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
-00024f60: 290a 2020 2020 6465 6620 636f 6d62 696e  ).    def combin
-00024f70: 6528 7365 6c66 2c20 6f74 6865 722c 2066  e(self, other, f
-00024f80: 756e 632c 2066 696c 6c5f 7661 6c75 653d  unc, fill_value=
-00024f90: 4e6f 6e65 293a 0a20 2020 2020 2020 2072  None):.        r
-00024fa0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-00024fb0: 6172 7469 7469 6f6e 7328 4d2e 636f 6d62  artitions(M.comb
-00024fc0: 696e 652c 206f 7468 6572 2c20 6675 6e63  ine, other, func
-00024fd0: 2c20 6669 6c6c 5f76 616c 7565 3d66 696c  , fill_value=fil
-00024fe0: 6c5f 7661 6c75 6529 0a0a 2020 2020 4064  l_value)..    @d
-00024ff0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
-00025000: 6572 6965 7329 0a20 2020 2064 6566 2073  eries).    def s
-00025010: 7175 6565 7a65 2873 656c 6629 3a0a 2020  queeze(self):.  
-00025020: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00025030: 660a 0a20 2020 2040 6465 7269 7665 645f  f..    @derived_
-00025040: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
-00025050: 2020 2020 6465 6620 636f 6d62 696e 655f      def combine_
-00025060: 6669 7273 7428 7365 6c66 2c20 6f74 6865  first(self, othe
-00025070: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
-00025080: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-00025090: 6974 696f 6e73 284d 2e63 6f6d 6269 6e65  itions(M.combine
-000250a0: 5f66 6972 7374 2c20 6f74 6865 7229 0a0a  _first, other)..
-000250b0: 2020 2020 6465 6620 746f 5f62 6167 2873      def to_bag(s
-000250c0: 656c 662c 2069 6e64 6578 3d46 616c 7365  elf, index=False
-000250d0: 2c20 666f 726d 6174 3d22 7475 706c 6522  , format="tuple"
-000250e0: 293a 0a20 2020 2020 2020 2022 2222 4372  ):.        """Cr
-000250f0: 6561 7465 2061 2044 6173 6b20 4261 6720  eate a Dask Bag 
-00025100: 6672 6f6d 2061 2053 6572 6965 7322 2222  from a Series"""
-00025110: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-00025120: 736b 2e64 6174 6166 7261 6d65 2e69 6f20  sk.dataframe.io 
-00025130: 696d 706f 7274 2074 6f5f 6261 670a 0a20  import to_bag.. 
-00025140: 2020 2020 2020 2072 6574 7572 6e20 746f         return to
-00025150: 5f62 6167 2873 656c 662c 2069 6e64 6578  _bag(self, index
-00025160: 2c20 666f 726d 6174 3d66 6f72 6d61 7429  , format=format)
-00025170: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00025180: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00025190: 2020 2064 6566 2074 6f5f 6672 616d 6528     def to_frame(
-000251a0: 7365 6c66 2c20 6e61 6d65 3d4e 6f6e 6529  self, name=None)
-000251b0: 3a0a 2020 2020 2020 2020 6172 6773 203d  :.        args =
-000251c0: 205b 5d20 6966 206e 616d 6520 6973 204e   [] if name is N
-000251d0: 6f6e 6520 656c 7365 205b 6e61 6d65 5d0a  one else [name].
-000251e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000251f0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-00025200: 6e73 284d 2e74 6f5f 6672 616d 652c 202a  ns(M.to_frame, *
-00025210: 6172 6773 2c20 6d65 7461 3d73 656c 662e  args, meta=self.
-00025220: 5f6d 6574 612e 746f 5f66 7261 6d65 282a  _meta.to_frame(*
-00025230: 6172 6773 2929 0a0a 2020 2020 4064 6572  args))..    @der
-00025240: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
-00025250: 6965 7329 0a20 2020 2064 6566 2074 6f5f  ies).    def to_
-00025260: 7374 7269 6e67 2873 656c 662c 206d 6178  string(self, max
-00025270: 5f72 6f77 733d 3529 3a0a 2020 2020 2020  _rows=5):.      
-00025280: 2020 2320 6f70 7469 6f6e 5f63 6f6e 7465    # option_conte
-00025290: 7874 2064 6f65 736e 2774 2061 6666 6563  xt doesn't affec
-000252a0: 740a 2020 2020 2020 2020 7265 7475 726e  t.        return
-000252b0: 2073 656c 662e 5f72 6570 725f 6461 7461   self._repr_data
-000252c0: 2829 2e74 6f5f 7374 7269 6e67 286d 6178  ().to_string(max
-000252d0: 5f72 6f77 733d 6d61 785f 726f 7773 290a  _rows=max_rows).
-000252e0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-000252f0: 640a 2020 2020 6465 6620 5f62 696e 645f  d.    def _bind_
-00025300: 6f70 6572 6174 6f72 5f6d 6574 686f 6428  operator_method(
-00025310: 636c 732c 206e 616d 652c 206f 702c 206f  cls, name, op, o
-00025320: 7269 6769 6e61 6c3d 7064 2e53 6572 6965  riginal=pd.Serie
-00025330: 7329 3a0a 2020 2020 2020 2020 2222 2262  s):.        """b
-00025340: 696e 6420 6f70 6572 6174 6f72 206d 6574  ind operator met
-00025350: 686f 6420 6c69 6b65 2053 6572 6965 732e  hod like Series.
-00025360: 6164 6420 746f 2074 6869 7320 636c 6173  add to this clas
-00025370: 7322 2222 0a0a 2020 2020 2020 2020 6465  s"""..        de
-00025380: 6620 6d65 7468 2873 656c 662c 206f 7468  f meth(self, oth
-00025390: 6572 2c20 6c65 7665 6c3d 4e6f 6e65 2c20  er, level=None, 
-000253a0: 6669 6c6c 5f76 616c 7565 3d4e 6f6e 652c  fill_value=None,
-000253b0: 2061 7869 733d 3029 3a0a 2020 2020 2020   axis=0):.      
-000253c0: 2020 2020 2020 6966 206c 6576 656c 2069        if level i
-000253d0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-000253e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000253f0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-00025400: 4572 726f 7228 226c 6576 656c 206d 7573  Error("level mus
-00025410: 7420 6265 204e 6f6e 6522 290a 2020 2020  t be None").    
-00025420: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
-00025430: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
-00025440: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
-00025450: 2020 2020 206d 6574 6120 3d20 5f65 6d75       meta = _emu
-00025460: 6c61 7465 286f 702c 2073 656c 662c 206f  late(op, self, o
-00025470: 7468 6572 2c20 6178 6973 3d61 7869 732c  ther, axis=axis,
-00025480: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
-00025490: 5f76 616c 7565 290a 2020 2020 2020 2020  _value).        
-000254a0: 2020 2020 7265 7475 726e 206d 6170 5f70      return map_p
-000254b0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-000254c0: 2020 2020 2020 2020 2020 206f 702c 2073             op, s
-000254d0: 656c 662c 206f 7468 6572 2c20 6d65 7461  elf, other, meta
-000254e0: 3d6d 6574 612c 2061 7869 733d 6178 6973  =meta, axis=axis
-000254f0: 2c20 6669 6c6c 5f76 616c 7565 3d66 696c  , fill_value=fil
-00025500: 6c5f 7661 6c75 650a 2020 2020 2020 2020  l_value.        
-00025510: 2020 2020 290a 0a20 2020 2020 2020 206d      )..        m
-00025520: 6574 682e 5f5f 6e61 6d65 5f5f 203d 206e  eth.__name__ = n
-00025530: 616d 650a 2020 2020 2020 2020 7365 7461  ame.        seta
-00025540: 7474 7228 636c 732c 206e 616d 652c 2064  ttr(cls, name, d
-00025550: 6572 6976 6564 5f66 726f 6d28 6f72 6967  erived_from(orig
-00025560: 696e 616c 2928 6d65 7468 2929 0a0a 2020  inal)(meth))..  
-00025570: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
-00025580: 2020 2064 6566 205f 6269 6e64 5f63 6f6d     def _bind_com
-00025590: 7061 7269 736f 6e5f 6d65 7468 6f64 2863  parison_method(c
-000255a0: 6c73 2c20 6e61 6d65 2c20 636f 6d70 6172  ls, name, compar
-000255b0: 6973 6f6e 2c20 6f72 6967 696e 616c 3d70  ison, original=p
-000255c0: 642e 5365 7269 6573 293a 0a20 2020 2020  d.Series):.     
-000255d0: 2020 2022 2222 6269 6e64 2063 6f6d 7061     """bind compa
-000255e0: 7269 736f 6e20 6d65 7468 6f64 206c 696b  rison method lik
-000255f0: 6520 5365 7269 6573 2e65 7120 746f 2074  e Series.eq to t
-00025600: 6869 7320 636c 6173 7322 2222 0a0a 2020  his class"""..  
-00025610: 2020 2020 2020 6465 6620 6d65 7468 2873        def meth(s
-00025620: 656c 662c 206f 7468 6572 2c20 6c65 7665  elf, other, leve
-00025630: 6c3d 4e6f 6e65 2c20 6669 6c6c 5f76 616c  l=None, fill_val
-00025640: 7565 3d4e 6f6e 652c 2061 7869 733d 3029  ue=None, axis=0)
-00025650: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00025660: 206c 6576 656c 2069 7320 6e6f 7420 4e6f   level is not No
-00025670: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00025680: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-00025690: 6c65 6d65 6e74 6564 4572 726f 7228 226c  lementedError("l
-000256a0: 6576 656c 206d 7573 7420 6265 204e 6f6e  evel must be Non
-000256b0: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
-000256c0: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
-000256d0: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
-000256e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000256f0: 6669 6c6c 5f76 616c 7565 2069 7320 4e6f  fill_value is No
-00025700: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00025710: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
-00025720: 6973 6528 636f 6d70 6172 6973 6f6e 2c20  ise(comparison, 
-00025730: 7365 6c66 2c20 6f74 6865 722c 2061 7869  self, other, axi
-00025740: 733d 6178 6973 290a 2020 2020 2020 2020  s=axis).        
-00025750: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00025760: 2020 2020 2020 2020 2020 6f70 203d 2070            op = p
-00025770: 6172 7469 616c 2863 6f6d 7061 7269 736f  artial(compariso
-00025780: 6e2c 2066 696c 6c5f 7661 6c75 653d 6669  n, fill_value=fi
-00025790: 6c6c 5f76 616c 7565 290a 2020 2020 2020  ll_value).      
-000257a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000257b0: 2065 6c65 6d77 6973 6528 6f70 2c20 7365   elemwise(op, se
-000257c0: 6c66 2c20 6f74 6865 722c 2061 7869 733d  lf, other, axis=
-000257d0: 6178 6973 290a 0a20 2020 2020 2020 206d  axis)..        m
-000257e0: 6574 682e 5f5f 6e61 6d65 5f5f 203d 206e  eth.__name__ = n
-000257f0: 616d 650a 2020 2020 2020 2020 7365 7461  ame.        seta
-00025800: 7474 7228 636c 732c 206e 616d 652c 2064  ttr(cls, name, d
-00025810: 6572 6976 6564 5f66 726f 6d28 6f72 6967  erived_from(orig
-00025820: 696e 616c 2928 6d65 7468 2929 0a0a 2020  inal)(meth))..  
-00025830: 2020 4069 6e73 6572 745f 6d65 7461 5f70    @insert_meta_p
-00025840: 6172 616d 5f64 6573 6372 6970 7469 6f6e  aram_description
-00025850: 2870 6164 3d31 3229 0a20 2020 2064 6566  (pad=12).    def
-00025860: 2061 7070 6c79 2873 656c 662c 2066 756e   apply(self, fun
-00025870: 632c 2063 6f6e 7665 7274 5f64 7479 7065  c, convert_dtype
-00025880: 3d6e 6f5f 6465 6661 756c 742c 206d 6574  =no_default, met
-00025890: 613d 6e6f 5f64 6566 6175 6c74 2c20 6172  a=no_default, ar
-000258a0: 6773 3d28 292c 202a 2a6b 7764 7329 3a0a  gs=(), **kwds):.
-000258b0: 2020 2020 2020 2020 2222 2250 6172 616c          """Paral
-000258c0: 6c65 6c20 7665 7273 696f 6e20 6f66 2070  lel version of p
-000258d0: 616e 6461 732e 5365 7269 6573 2e61 7070  andas.Series.app
-000258e0: 6c79 0a0a 2020 2020 2020 2020 5061 7261  ly..        Para
-000258f0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-00025900: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00025910: 2020 6675 6e63 203a 2066 756e 6374 696f    func : functio
-00025920: 6e0a 2020 2020 2020 2020 2020 2020 4675  n.            Fu
-00025930: 6e63 7469 6f6e 2074 6f20 6170 706c 790a  nction to apply.
-00025940: 2020 2020 2020 2020 636f 6e76 6572 745f          convert_
-00025950: 6474 7970 6520 3a20 626f 6f6c 6561 6e2c  dtype : boolean,
-00025960: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
-00025970: 2020 2020 2020 2020 2020 5472 7920 746f            Try to
-00025980: 2066 696e 6420 6265 7474 6572 2064 7479   find better dty
-00025990: 7065 2066 6f72 2065 6c65 6d65 6e74 7769  pe for elementwi
-000259a0: 7365 2066 756e 6374 696f 6e20 7265 7375  se function resu
-000259b0: 6c74 732e 0a20 2020 2020 2020 2020 2020  lts..           
-000259c0: 2049 6620 4661 6c73 652c 206c 6561 7665   If False, leave
-000259d0: 2061 7320 6474 7970 653d 6f62 6a65 6374   as dtype=object
-000259e0: 2e0a 2020 2020 2020 2020 244d 4554 410a  ..        $META.
-000259f0: 2020 2020 2020 2020 6172 6773 203a 2074          args : t
-00025a00: 7570 6c65 0a20 2020 2020 2020 2020 2020  uple.           
-00025a10: 2050 6f73 6974 696f 6e61 6c20 6172 6775   Positional argu
-00025a20: 6d65 6e74 7320 746f 2070 6173 7320 746f  ments to pass to
-00025a30: 2066 756e 6374 696f 6e20 696e 2061 6464   function in add
-00025a40: 6974 696f 6e20 746f 2074 6865 2076 616c  ition to the val
-00025a50: 7565 2e0a 0a20 2020 2020 2020 2041 6464  ue...        Add
-00025a60: 6974 696f 6e61 6c20 6b65 7977 6f72 6420  itional keyword 
-00025a70: 6172 6775 6d65 6e74 7320 7769 6c6c 2062  arguments will b
-00025a80: 6520 7061 7373 6564 2061 7320 6b65 7977  e passed as keyw
-00025a90: 6f72 6473 2074 6f20 7468 6520 6675 6e63  ords to the func
-00025aa0: 7469 6f6e 2e0a 0a20 2020 2020 2020 2052  tion...        R
-00025ab0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-00025ac0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2061  ------.        a
-00025ad0: 7070 6c69 6564 203a 2053 6572 6965 7320  pplied : Series 
-00025ae0: 6f72 2044 6174 6146 7261 6d65 2069 6620  or DataFrame if 
-00025af0: 6675 6e63 2072 6574 7572 6e73 2061 2053  func returns a S
-00025b00: 6572 6965 732e 0a0a 2020 2020 2020 2020  eries...        
-00025b10: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-00025b20: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00025b30: 2020 3e3e 3e20 696d 706f 7274 2064 6173    >>> import das
-00025b40: 6b2e 6461 7461 6672 616d 6520 6173 2064  k.dataframe as d
-00025b50: 640a 2020 2020 2020 2020 3e3e 3e20 7320  d.        >>> s 
-00025b60: 3d20 7064 2e53 6572 6965 7328 7261 6e67  = pd.Series(rang
-00025b70: 6528 3529 2c20 6e61 6d65 3d27 7827 290a  e(5), name='x').
-00025b80: 2020 2020 2020 2020 3e3e 3e20 6473 203d          >>> ds =
-00025b90: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
-00025ba0: 732c 206e 7061 7274 6974 696f 6e73 3d32  s, npartitions=2
-00025bb0: 290a 0a20 2020 2020 2020 2041 7070 6c79  )..        Apply
-00025bc0: 2061 2066 756e 6374 696f 6e20 656c 656d   a function elem
-00025bd0: 656e 7477 6973 6520 6163 726f 7373 2074  entwise across t
-00025be0: 6865 2053 6572 6965 732c 2070 6173 7369  he Series, passi
-00025bf0: 6e67 2069 6e20 6578 7472 610a 2020 2020  ng in extra.    
-00025c00: 2020 2020 6172 6775 6d65 6e74 7320 696e      arguments in
-00025c10: 2060 6061 7267 7360 6020 616e 6420 6060   ``args`` and ``
-00025c20: 6b77 6172 6773 6060 3a0a 0a20 2020 2020  kwargs``:..     
-00025c30: 2020 203e 3e3e 2064 6566 206d 7961 6464     >>> def myadd
-00025c40: 2878 2c20 612c 2062 3d31 293a 0a20 2020  (x, a, b=1):.   
-00025c50: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
-00025c60: 7572 6e20 7820 2b20 6120 2b20 620a 2020  urn x + a + b.  
-00025c70: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
-00025c80: 6473 2e61 7070 6c79 286d 7961 6464 2c20  ds.apply(myadd, 
-00025c90: 6172 6773 3d28 322c 292c 2062 3d31 2e35  args=(2,), b=1.5
-00025ca0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-00025cb0: 4b49 500a 0a20 2020 2020 2020 2042 7920  KIP..        By 
-00025cc0: 6465 6661 756c 742c 2064 6173 6b20 7472  default, dask tr
-00025cd0: 6965 7320 746f 2069 6e66 6572 2074 6865  ies to infer the
-00025ce0: 206f 7574 7075 7420 6d65 7461 6461 7461   output metadata
-00025cf0: 2062 7920 7275 6e6e 696e 6720 796f 7572   by running your
-00025d00: 0a20 2020 2020 2020 2070 726f 7669 6465  .        provide
-00025d10: 6420 6675 6e63 7469 6f6e 206f 6e20 736f  d function on so
-00025d20: 6d65 2066 616b 6520 6461 7461 2e20 5468  me fake data. Th
-00025d30: 6973 2077 6f72 6b73 2077 656c 6c20 696e  is works well in
-00025d40: 206d 616e 7920 6361 7365 732c 2062 7574   many cases, but
-00025d50: 0a20 2020 2020 2020 2063 616e 2073 6f6d  .        can som
-00025d60: 6574 696d 6573 2062 6520 6578 7065 6e73  etimes be expens
-00025d70: 6976 652c 206f 7220 6576 656e 2066 6169  ive, or even fai
-00025d80: 6c2e 2054 6f20 6176 6f69 6420 7468 6973  l. To avoid this
-00025d90: 2c20 796f 7520 6361 6e0a 2020 2020 2020  , you can.      
-00025da0: 2020 6d61 6e75 616c 6c79 2073 7065 6369    manually speci
-00025db0: 6679 2074 6865 206f 7574 7075 7420 6d65  fy the output me
-00025dc0: 7461 6461 7461 2077 6974 6820 7468 6520  tadata with the 
-00025dd0: 6060 6d65 7461 6060 206b 6579 776f 7264  ``meta`` keyword
-00025de0: 2e20 5468 6973 0a20 2020 2020 2020 2063  . This.        c
-00025df0: 616e 2062 6520 7370 6563 6966 6965 6420  an be specified 
-00025e00: 696e 206d 616e 7920 666f 726d 732c 2066  in many forms, f
-00025e10: 6f72 206d 6f72 6520 696e 666f 726d 6174  or more informat
-00025e20: 696f 6e20 7365 650a 2020 2020 2020 2020  ion see.        
-00025e30: 6060 6461 736b 2e64 6174 6166 7261 6d65  ``dask.dataframe
-00025e40: 2e75 7469 6c73 2e6d 616b 655f 6d65 7461  .utils.make_meta
-00025e50: 6060 2e0a 0a20 2020 2020 2020 2048 6572  ``...        Her
-00025e60: 6520 7765 2073 7065 6369 6679 2074 6865  e we specify the
-00025e70: 206f 7574 7075 7420 6973 2061 2053 6572   output is a Ser
-00025e80: 6965 7320 7769 7468 206e 616d 6520 6060  ies with name ``
-00025e90: 2778 2760 602c 2061 6e64 2064 7479 7065  'x'``, and dtype
-00025ea0: 0a20 2020 2020 2020 2060 6066 6c6f 6174  .        ``float
-00025eb0: 3634 6060 3a0a 0a20 2020 2020 2020 203e  64``:..        >
-00025ec0: 3e3e 2072 6573 203d 2064 732e 6170 706c  >> res = ds.appl
-00025ed0: 7928 6d79 6164 642c 2061 7267 733d 2832  y(myadd, args=(2
-00025ee0: 2c29 2c20 623d 312e 352c 206d 6574 613d  ,), b=1.5, meta=
-00025ef0: 2827 7827 2c20 2766 3827 2929 0a0a 2020  ('x', 'f8'))..  
-00025f00: 2020 2020 2020 496e 2074 6865 2063 6173        In the cas
-00025f10: 6520 7768 6572 6520 7468 6520 6d65 7461  e where the meta
-00025f20: 6461 7461 2064 6f65 736e 2774 2063 6861  data doesn't cha
-00025f30: 6e67 652c 2079 6f75 2063 616e 2061 6c73  nge, you can als
-00025f40: 6f20 7061 7373 2069 6e0a 2020 2020 2020  o pass in.      
-00025f50: 2020 7468 6520 6f62 6a65 6374 2069 7473    the object its
-00025f60: 656c 6620 6469 7265 6374 6c79 3a0a 0a20  elf directly:.. 
-00025f70: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
-00025f80: 2064 732e 6170 706c 7928 6c61 6d62 6461   ds.apply(lambda
-00025f90: 2078 3a20 7820 2b20 312c 206d 6574 613d   x: x + 1, meta=
-00025fa0: 6473 290a 0a20 2020 2020 2020 2053 6565  ds)..        See
-00025fb0: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-00025fc0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
-00025fd0: 6173 6b2e 5365 7269 6573 2e6d 6170 5f70  ask.Series.map_p
-00025fe0: 6172 7469 7469 6f6e 730a 2020 2020 2020  artitions.      
-00025ff0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00026000: 2063 6f6e 7665 7274 5f64 7479 7065 2069   convert_dtype i
-00026010: 7320 6e6f 7420 6e6f 5f64 6566 6175 6c74  s not no_default
-00026020: 3a0a 2020 2020 2020 2020 2020 2020 6b77  :.            kw
-00026030: 6473 5b22 636f 6e76 6572 745f 6474 7970  ds["convert_dtyp
-00026040: 6522 5d20 3d20 636f 6e76 6572 745f 6474  e"] = convert_dt
-00026050: 7970 650a 0a20 2020 2020 2020 2023 206c  ype..        # l
-00026060: 6574 2070 616e 6461 7320 7472 6967 6765  et pandas trigge
-00026070: 7220 616e 7920 7761 726e 696e 6773 2c20  r any warnings, 
-00026080: 7375 6368 2061 7320 636f 6e76 6572 745f  such as convert_
-00026090: 6474 7970 6520 7761 726e 696e 670a 2020  dtype warning.  
-000260a0: 2020 2020 2020 7365 6c66 2e5f 6d65 7461        self._meta
-000260b0: 2e61 7070 6c79 2866 756e 632c 2061 7267  .apply(func, arg
-000260c0: 733d 6172 6773 2c20 2a2a 6b77 6473 290a  s=args, **kwds).
-000260d0: 0a20 2020 2020 2020 2069 6620 6d65 7461  .        if meta
-000260e0: 2069 7320 6e6f 5f64 6566 6175 6c74 3a0a   is no_default:.
-000260f0: 2020 2020 2020 2020 2020 2020 7769 7468              with
-00026100: 2063 6865 636b 5f63 6f6e 7665 7274 5f64   check_convert_d
-00026110: 7479 7065 5f64 6570 7265 6361 7469 6f6e  type_deprecation
-00026120: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00026130: 2020 2020 6d65 7461 203d 205f 656d 756c      meta = _emul
-00026140: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
-00026150: 2020 2020 2020 2020 204d 2e61 7070 6c79           M.apply
-00026160: 2c20 7365 6c66 2e5f 6d65 7461 5f6e 6f6e  , self._meta_non
-00026170: 656d 7074 792c 2066 756e 632c 2061 7267  empty, func, arg
-00026180: 733d 6172 6773 2c20 7564 663d 5472 7565  s=args, udf=True
-00026190: 2c20 2a2a 6b77 6473 0a20 2020 2020 2020  , **kwds.       
-000261a0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000261b0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-000261c0: 7761 726e 286d 6574 615f 7761 726e 696e  warn(meta_warnin
-000261d0: 6728 6d65 7461 2929 0a20 2020 2020 2020  g(meta)).       
-000261e0: 2065 6c69 6620 5041 4e44 4153 5f47 545f   elif PANDAS_GT_
-000261f0: 3231 303a 0a20 2020 2020 2020 2020 2020  210:.           
-00026200: 2074 6573 745f 6d65 7461 203d 206d 616b   test_meta = mak
-00026210: 655f 6d65 7461 286d 6574 6129 0a20 2020  e_meta(meta).   
-00026220: 2020 2020 2020 2020 2069 6620 6973 5f64           if is_d
-00026230: 6174 6166 7261 6d65 5f6c 696b 6528 7465  ataframe_like(te
-00026240: 7374 5f6d 6574 6129 3a0a 2020 2020 2020  st_meta):.      
-00026250: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-00026260: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
-00026270: 2020 2020 2020 2020 2020 2020 2022 5265               "Re
-00026280: 7475 726e 696e 6720 6120 4461 7461 4672  turning a DataFr
-00026290: 616d 6520 6672 6f6d 2053 6572 6965 732e  ame from Series.
-000262a0: 6170 706c 7920 7768 656e 2074 6865 2073  apply when the s
-000262b0: 7570 706c 6965 6420 6675 6e63 7469 6f6e  upplied function
-000262c0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-000262d0: 2020 2020 2020 2022 7265 7475 726e 7320         "returns 
-000262e0: 6120 5365 7269 6573 2069 7320 6465 7072  a Series is depr
-000262f0: 6563 6174 6564 2061 6e64 2077 696c 6c20  ecated and will 
-00026300: 6265 2072 656d 6f76 6564 2069 6e20 6120  be removed in a 
-00026310: 6675 7475 7265 2076 6572 7369 6f6e 2e22  future version."
-00026320: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00026330: 2020 2020 2020 4675 7475 7265 5761 726e        FutureWarn
-00026340: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
-00026350: 2020 2020 2020 2020 2073 7461 636b 6c65           stackle
-00026360: 7665 6c3d 322c 0a20 2020 2020 2020 2020  vel=2,.         
-00026370: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00026380: 2020 7265 7475 726e 206d 6170 5f70 6172    return map_par
-00026390: 7469 7469 6f6e 7328 6d65 7468 6f64 732e  titions(methods.
-000263a0: 6170 706c 792c 2073 656c 662c 2066 756e  apply, self, fun
-000263b0: 632c 2061 7267 733d 6172 6773 2c20 6d65  c, args=args, me
-000263c0: 7461 3d6d 6574 612c 202a 2a6b 7764 7329  ta=meta, **kwds)
-000263d0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-000263e0: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-000263f0: 2020 2064 6566 2063 6f76 2873 656c 662c     def cov(self,
-00026400: 206f 7468 6572 2c20 6d69 6e5f 7065 7269   other, min_peri
-00026410: 6f64 733d 4e6f 6e65 2c20 7370 6c69 745f  ods=None, split_
-00026420: 6576 6572 793d 4661 6c73 6529 3a0a 2020  every=False):.  
-00026430: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-00026440: 6461 7461 6672 616d 652e 6d75 6c74 6920  dataframe.multi 
-00026450: 696d 706f 7274 2063 6f6e 6361 740a 0a20  import concat.. 
-00026460: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-00026470: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
-00026480: 5365 7269 6573 293a 0a20 2020 2020 2020  Series):.       
-00026490: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-000264a0: 7272 6f72 2822 6f74 6865 7220 6d75 7374  rror("other must
-000264b0: 2062 6520 6120 6461 736b 2e64 6174 6166   be a dask.dataf
-000264c0: 7261 6d65 2e53 6572 6965 7322 290a 2020  rame.Series").  
-000264d0: 2020 2020 2020 6466 203d 2063 6f6e 6361        df = conca
-000264e0: 7428 5b73 656c 662c 206f 7468 6572 5d2c  t([self, other],
-000264f0: 2061 7869 733d 3129 0a20 2020 2020 2020   axis=1).       
-00026500: 2072 6574 7572 6e20 5f63 6f76 5f63 6f72   return _cov_cor
-00026510: 7228 0a20 2020 2020 2020 2020 2020 2064  r(.            d
-00026520: 662c 206d 696e 5f70 6572 696f 6473 2c20  f, min_periods, 
-00026530: 7363 616c 6172 3d54 7275 652c 206e 756d  scalar=True, num
-00026540: 6572 6963 5f6f 6e6c 793d 4661 6c73 652c  eric_only=False,
-00026550: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-00026560: 6974 5f65 7665 7279 0a20 2020 2020 2020  it_every.       
-00026570: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
-00026580: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00026590: 0a20 2020 2064 6566 2063 6f72 7228 7365  .    def corr(se
-000265a0: 6c66 2c20 6f74 6865 722c 206d 6574 686f  lf, other, metho
-000265b0: 643d 2270 6561 7273 6f6e 222c 206d 696e  d="pearson", min
-000265c0: 5f70 6572 696f 6473 3d4e 6f6e 652c 2073  _periods=None, s
-000265d0: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-000265e0: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
-000265f0: 6461 736b 2e64 6174 6166 7261 6d65 2e6d  dask.dataframe.m
-00026600: 756c 7469 2069 6d70 6f72 7420 636f 6e63  ulti import conc
-00026610: 6174 0a0a 2020 2020 2020 2020 6966 206e  at..        if n
-00026620: 6f74 2069 7369 6e73 7461 6e63 6528 6f74  ot isinstance(ot
-00026630: 6865 722c 2053 6572 6965 7329 3a0a 2020  her, Series):.  
-00026640: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00026650: 5479 7065 4572 726f 7228 226f 7468 6572  TypeError("other
-00026660: 206d 7573 7420 6265 2061 2064 6173 6b2e   must be a dask.
-00026670: 6461 7461 6672 616d 652e 5365 7269 6573  dataframe.Series
-00026680: 2229 0a20 2020 2020 2020 2069 6620 6d65  ").        if me
-00026690: 7468 6f64 2021 3d20 2270 6561 7273 6f6e  thod != "pearson
-000266a0: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
-000266b0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-000266c0: 7465 6445 7272 6f72 2822 4f6e 6c79 2050  tedError("Only P
-000266d0: 6561 7273 6f6e 2063 6f72 7265 6c61 7469  earson correlati
-000266e0: 6f6e 2068 6173 2062 6565 6e20 696d 706c  on has been impl
-000266f0: 656d 656e 7465 6422 290a 2020 2020 2020  emented").      
-00026700: 2020 6466 203d 2063 6f6e 6361 7428 5b73    df = concat([s
-00026710: 656c 662c 206f 7468 6572 5d2c 2061 7869  elf, other], axi
-00026720: 733d 3129 0a20 2020 2020 2020 2072 6574  s=1).        ret
-00026730: 7572 6e20 5f63 6f76 5f63 6f72 7228 0a20  urn _cov_corr(. 
-00026740: 2020 2020 2020 2020 2020 2064 662c 0a20             df,. 
-00026750: 2020 2020 2020 2020 2020 206d 696e 5f70             min_p
-00026760: 6572 696f 6473 2c0a 2020 2020 2020 2020  eriods,.        
-00026770: 2020 2020 636f 7272 3d54 7275 652c 0a20      corr=True,. 
-00026780: 2020 2020 2020 2020 2020 2073 6361 6c61             scala
-00026790: 723d 5472 7565 2c0a 2020 2020 2020 2020  r=True,.        
-000267a0: 2020 2020 6e75 6d65 7269 635f 6f6e 6c79      numeric_only
-000267b0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-000267c0: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
-000267d0: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
-000267e0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
-000267f0: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
-00026800: 6965 7329 0a20 2020 2064 6566 2061 7574  ies).    def aut
-00026810: 6f63 6f72 7228 7365 6c66 2c20 6c61 673d  ocorr(self, lag=
-00026820: 312c 2073 706c 6974 5f65 7665 7279 3d46  1, split_every=F
-00026830: 616c 7365 293a 0a20 2020 2020 2020 2069  alse):.        i
-00026840: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-00026850: 286c 6167 2c20 496e 7465 6772 616c 293a  (lag, Integral):
-00026860: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00026870: 7365 2054 7970 6545 7272 6f72 2822 6c61  se TypeError("la
-00026880: 6720 6d75 7374 2062 6520 616e 2069 6e74  g must be an int
-00026890: 6567 6572 2229 0a20 2020 2020 2020 2072  eger").        r
-000268a0: 6574 7572 6e20 7365 6c66 2e63 6f72 7228  eturn self.corr(
-000268b0: 7365 6c66 2069 6620 6c61 6720 3d3d 2030  self if lag == 0
-000268c0: 2065 6c73 6520 7365 6c66 2e73 6869 6674   else self.shift
-000268d0: 286c 6167 292c 2073 706c 6974 5f65 7665  (lag), split_eve
-000268e0: 7279 3d73 706c 6974 5f65 7665 7279 290a  ry=split_every).
-000268f0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00026900: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-00026910: 2020 6465 6620 6d65 6d6f 7279 5f75 7361    def memory_usa
-00026920: 6765 2873 656c 662c 2069 6e64 6578 3d54  ge(self, index=T
-00026930: 7275 652c 2064 6565 703d 4661 6c73 6529  rue, deep=False)
-00026940: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00026950: 2073 656c 662e 7265 6475 6374 696f 6e28   self.reduction(
-00026960: 0a20 2020 2020 2020 2020 2020 204d 2e6d  .            M.m
-00026970: 656d 6f72 795f 7573 6167 652c 0a20 2020  emory_usage,.   
-00026980: 2020 2020 2020 2020 204d 2e73 756d 2c0a           M.sum,.
-00026990: 2020 2020 2020 2020 2020 2020 6368 756e              chun
-000269a0: 6b5f 6b77 6172 6773 3d7b 2269 6e64 6578  k_kwargs={"index
-000269b0: 223a 2069 6e64 6578 2c20 2264 6565 7022  ": index, "deep"
-000269c0: 3a20 6465 6570 7d2c 0a20 2020 2020 2020  : deep},.       
-000269d0: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-000269e0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-000269f0: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
-00026a00: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
-00026a10: 6d65 6d6f 7279 2d75 7361 6765 222c 0a20  memory-usage",. 
-00026a20: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00026a30: 6620 5f5f 6469 766d 6f64 5f5f 2873 656c  f __divmod__(sel
-00026a40: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
-00026a50: 2020 2072 6573 3120 3d20 7365 6c66 202f     res1 = self /
-00026a60: 2f20 6f74 6865 720a 2020 2020 2020 2020  / other.        
-00026a70: 7265 7332 203d 2073 656c 6620 2520 6f74  res2 = self % ot
-00026a80: 6865 720a 2020 2020 2020 2020 7265 7475  her.        retu
-00026a90: 726e 2072 6573 312c 2072 6573 320a 0a20  rn res1, res2.. 
-00026aa0: 2020 2064 6566 205f 5f72 6469 766d 6f64     def __rdivmod
-00026ab0: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
-00026ac0: 0a20 2020 2020 2020 2072 6573 3120 3d20  .        res1 = 
-00026ad0: 6f74 6865 7220 2f2f 2073 656c 660a 2020  other // self.  
-00026ae0: 2020 2020 2020 7265 7332 203d 206f 7468        res2 = oth
-00026af0: 6572 2025 2073 656c 660a 2020 2020 2020  er % self.      
-00026b00: 2020 7265 7475 726e 2072 6573 312c 2072    return res1, r
-00026b10: 6573 320a 0a20 2020 2069 6620 6e6f 7420  es2..    if not 
-00026b20: 5041 4e44 4153 5f47 545f 3230 303a 0a0a  PANDAS_GT_200:..
-00026b30: 2020 2020 2020 2020 4070 726f 7065 7274          @propert
-00026b40: 790a 2020 2020 2020 2020 4064 6572 6976  y.        @deriv
-00026b50: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-00026b60: 7329 0a20 2020 2020 2020 2064 6566 2069  s).        def i
-00026b70: 735f 6d6f 6e6f 746f 6e69 6328 7365 6c66  s_monotonic(self
-00026b80: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00026b90: 6620 5041 4e44 4153 5f47 545f 3135 303a  f PANDAS_GT_150:
-00026ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026bb0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-00026bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026bd0: 2020 2020 2269 735f 6d6f 6e6f 746f 6e69      "is_monotoni
-00026be0: 6320 6973 2064 6570 7265 6361 7465 6420  c is deprecated 
-00026bf0: 616e 6420 7769 6c6c 2062 6520 7265 6d6f  and will be remo
-00026c00: 7665 6420 696e 2061 2066 7574 7572 6520  ved in a future 
-00026c10: 7665 7273 696f 6e2e 2022 0a20 2020 2020  version. ".     
-00026c20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00026c30: 5573 6520 6973 5f6d 6f6e 6f74 6f6e 6963  Use is_monotonic
-00026c40: 5f69 6e63 7265 6173 696e 6720 696e 7374  _increasing inst
-00026c50: 6561 642e 222c 0a20 2020 2020 2020 2020  ead.",.         
-00026c60: 2020 2020 2020 2020 2020 2046 7574 7572             Futur
-00026c70: 6557 6172 6e69 6e67 2c0a 2020 2020 2020  eWarning,.      
-00026c80: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00026c90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00026ca0: 656c 662e 6973 5f6d 6f6e 6f74 6f6e 6963  elf.is_monotonic
-00026cb0: 5f69 6e63 7265 6173 696e 670a 0a20 2020  _increasing..   
-00026cc0: 2040 7072 6f70 6572 7479 0a20 2020 2040   @property.    @
-00026cd0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00026ce0: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
-00026cf0: 6973 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63  is_monotonic_inc
-00026d00: 7265 6173 696e 6728 7365 6c66 293a 0a20  reasing(self):. 
-00026d10: 2020 2020 2020 2072 6574 7572 6e20 6163         return ac
-00026d20: 6128 0a20 2020 2020 2020 2020 2020 2073  a(.            s
-00026d30: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-00026d40: 2063 6875 6e6b 3d6d 6574 686f 6473 2e6d   chunk=methods.m
-00026d50: 6f6e 6f74 6f6e 6963 5f69 6e63 7265 6173  onotonic_increas
-00026d60: 696e 675f 6368 756e 6b2c 0a20 2020 2020  ing_chunk,.     
-00026d70: 2020 2020 2020 2063 6f6d 6269 6e65 3d6d         combine=m
-00026d80: 6574 686f 6473 2e6d 6f6e 6f74 6f6e 6963  ethods.monotonic
-00026d90: 5f69 6e63 7265 6173 696e 675f 636f 6d62  _increasing_comb
-00026da0: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
-00026db0: 2061 6767 7265 6761 7465 3d6d 6574 686f   aggregate=metho
-00026dc0: 6473 2e6d 6f6e 6f74 6f6e 6963 5f69 6e63  ds.monotonic_inc
-00026dd0: 7265 6173 696e 675f 6167 6772 6567 6174  reasing_aggregat
-00026de0: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
-00026df0: 6574 613d 626f 6f6c 2c0a 2020 2020 2020  eta=bool,.      
-00026e00: 2020 2020 2020 746f 6b65 6e3d 226d 6f6e        token="mon
-00026e10: 6f74 6f6e 6963 5f69 6e63 7265 6173 696e  otonic_increasin
-00026e20: 6722 2c0a 2020 2020 2020 2020 290a 0a20  g",.        ).. 
-00026e30: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00026e40: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00026e50: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
-00026e60: 6620 6973 5f6d 6f6e 6f74 6f6e 6963 5f64  f is_monotonic_d
-00026e70: 6563 7265 6173 696e 6728 7365 6c66 293a  ecreasing(self):
-00026e80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00026e90: 6163 6128 0a20 2020 2020 2020 2020 2020  aca(.           
-00026ea0: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-00026eb0: 2020 2063 6875 6e6b 3d6d 6574 686f 6473     chunk=methods
-00026ec0: 2e6d 6f6e 6f74 6f6e 6963 5f64 6563 7265  .monotonic_decre
-00026ed0: 6173 696e 675f 6368 756e 6b2c 0a20 2020  asing_chunk,.   
-00026ee0: 2020 2020 2020 2020 2063 6f6d 6269 6e65           combine
-00026ef0: 3d6d 6574 686f 6473 2e6d 6f6e 6f74 6f6e  =methods.monoton
-00026f00: 6963 5f64 6563 7265 6173 696e 675f 636f  ic_decreasing_co
-00026f10: 6d62 696e 652c 0a20 2020 2020 2020 2020  mbine,.         
-00026f20: 2020 2061 6767 7265 6761 7465 3d6d 6574     aggregate=met
-00026f30: 686f 6473 2e6d 6f6e 6f74 6f6e 6963 5f64  hods.monotonic_d
-00026f40: 6563 7265 6173 696e 675f 6167 6772 6567  ecreasing_aggreg
-00026f50: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
-00026f60: 206d 6574 613d 626f 6f6c 2c0a 2020 2020   meta=bool,.    
-00026f70: 2020 2020 2020 2020 746f 6b65 6e3d 226d          token="m
-00026f80: 6f6e 6f74 6f6e 6963 5f64 6563 7265 6173  onotonic_decreas
-00026f90: 696e 6722 2c0a 2020 2020 2020 2020 290a  ing",.        ).
-00026fa0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00026fb0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-00026fc0: 2020 6465 6620 7669 6577 2873 656c 662c    def view(self,
-00026fd0: 2064 7479 7065 293a 0a20 2020 2020 2020   dtype):.       
-00026fe0: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
-00026ff0: 7461 2e76 6965 7728 6474 7970 6529 0a20  ta.view(dtype). 
-00027000: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00027010: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00027020: 7328 4d2e 7669 6577 2c20 6474 7970 652c  s(M.view, dtype,
-00027030: 206d 6574 613d 6d65 7461 290a 0a0a 636c   meta=meta)...cl
-00027040: 6173 7320 496e 6465 7828 5365 7269 6573  ass Index(Series
-00027050: 293a 0a20 2020 205f 7061 7274 6974 696f  ):.    _partitio
-00027060: 6e5f 7479 7065 203d 2070 642e 496e 6465  n_type = pd.Inde
-00027070: 780a 2020 2020 5f69 735f 7061 7274 6974  x.    _is_partit
-00027080: 696f 6e5f 7479 7065 203d 2073 7461 7469  ion_type = stati
-00027090: 636d 6574 686f 6428 6973 5f69 6e64 6578  cmethod(is_index
-000270a0: 5f6c 696b 6529 0a20 2020 205f 746f 6b65  _like).    _toke
-000270b0: 6e5f 7072 6566 6978 203d 2022 696e 6465  n_prefix = "inde
-000270c0: 782d 220a 2020 2020 5f61 6363 6573 736f  x-".    _accesso
-000270d0: 7273 3a20 436c 6173 7356 6172 5b73 6574  rs: ClassVar[set
-000270e0: 5b73 7472 5d5d 203d 2073 6574 2829 0a0a  [str]] = set()..
-000270f0: 2020 2020 5f64 745f 6174 7472 6962 7574      _dt_attribut
-00027100: 6573 203d 207b 0a20 2020 2020 2020 2022  es = {.        "
-00027110: 6e61 6e6f 7365 636f 6e64 222c 0a20 2020  nanosecond",.   
-00027120: 2020 2020 2022 6d69 6372 6f73 6563 6f6e       "microsecon
-00027130: 6422 2c0a 2020 2020 2020 2020 226d 696c  d",.        "mil
-00027140: 6c69 7365 636f 6e64 222c 0a20 2020 2020  lisecond",.     
-00027150: 2020 2022 6461 796f 6679 6561 7222 2c0a     "dayofyear",.
-00027160: 2020 2020 2020 2020 226d 696e 7574 6522          "minute"
-00027170: 2c0a 2020 2020 2020 2020 2268 6f75 7222  ,.        "hour"
-00027180: 2c0a 2020 2020 2020 2020 2264 6179 222c  ,.        "day",
-00027190: 0a20 2020 2020 2020 2022 6461 796f 6677  .        "dayofw
-000271a0: 6565 6b22 2c0a 2020 2020 2020 2020 2273  eek",.        "s
-000271b0: 6563 6f6e 6422 2c0a 2020 2020 2020 2020  econd",.        
-000271c0: 2277 6565 6b22 2c0a 2020 2020 2020 2020  "week",.        
-000271d0: 2277 6565 6b64 6179 222c 0a20 2020 2020  "weekday",.     
-000271e0: 2020 2022 7765 656b 6f66 7965 6172 222c     "weekofyear",
-000271f0: 0a20 2020 2020 2020 2022 6d6f 6e74 6822  .        "month"
-00027200: 2c0a 2020 2020 2020 2020 2271 7561 7274  ,.        "quart
-00027210: 6572 222c 0a20 2020 2020 2020 2022 7965  er",.        "ye
-00027220: 6172 222c 0a20 2020 207d 0a0a 2020 2020  ar",.    }..    
-00027230: 5f63 6174 5f61 7474 7269 6275 7465 7320  _cat_attributes 
-00027240: 3d20 7b0a 2020 2020 2020 2020 226b 6e6f  = {.        "kno
-00027250: 776e 222c 0a20 2020 2020 2020 2022 6173  wn",.        "as
-00027260: 5f6b 6e6f 776e 222c 0a20 2020 2020 2020  _known",.       
-00027270: 2022 6173 5f75 6e6b 6e6f 776e 222c 0a20   "as_unknown",. 
-00027280: 2020 2020 2020 2022 6164 645f 6361 7465         "add_cate
-00027290: 676f 7269 6573 222c 0a20 2020 2020 2020  gories",.       
-000272a0: 2022 6361 7465 676f 7269 6573 222c 0a20   "categories",. 
-000272b0: 2020 2020 2020 2022 7265 6d6f 7665 5f63         "remove_c
-000272c0: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
-000272d0: 2020 2020 2272 656f 7264 6572 5f63 6174      "reorder_cat
-000272e0: 6567 6f72 6965 7322 2c0a 2020 2020 2020  egories",.      
-000272f0: 2020 2261 735f 6f72 6465 7265 6422 2c0a    "as_ordered",.
-00027300: 2020 2020 2020 2020 2263 6f64 6573 222c          "codes",
-00027310: 0a20 2020 2020 2020 2022 7265 6d6f 7665  .        "remove
-00027320: 5f75 6e75 7365 645f 6361 7465 676f 7269  _unused_categori
-00027330: 6573 222c 0a20 2020 2020 2020 2022 7365  es",.        "se
-00027340: 745f 6361 7465 676f 7269 6573 222c 0a20  t_categories",. 
-00027350: 2020 2020 2020 2022 6173 5f75 6e6f 7264         "as_unord
-00027360: 6572 6564 222c 0a20 2020 2020 2020 2022  ered",.        "
-00027370: 6f72 6465 7265 6422 2c0a 2020 2020 2020  ordered",.      
-00027380: 2020 2272 656e 616d 655f 6361 7465 676f    "rename_catego
-00027390: 7269 6573 222c 0a20 2020 207d 0a0a 2020  ries",.    }..  
-000273a0: 2020 5f6d 6f6e 6f74 6f6e 6963 5f61 7474    _monotonic_att
-000273b0: 7269 6275 7465 7320 3d20 7b0a 2020 2020  ributes = {.    
-000273c0: 2020 2020 2269 735f 6d6f 6e6f 746f 6e69      "is_monotoni
-000273d0: 6322 2c0a 2020 2020 2020 2020 2269 735f  c",.        "is_
-000273e0: 6d6f 6e6f 746f 6e69 635f 696e 6372 6561  monotonic_increa
-000273f0: 7369 6e67 222c 0a20 2020 2020 2020 2022  sing",.        "
-00027400: 6973 5f6d 6f6e 6f74 6f6e 6963 5f64 6563  is_monotonic_dec
-00027410: 7265 6173 696e 6722 2c0a 2020 2020 7d0a  reasing",.    }.
-00027420: 0a20 2020 2064 6566 205f 5f67 6574 6174  .    def __getat
-00027430: 7472 5f5f 2873 656c 662c 206b 6579 293a  tr__(self, key):
-00027440: 0a20 2020 2020 2020 2069 6620 280a 2020  .        if (.  
-00027450: 2020 2020 2020 2020 2020 6973 696e 7374            isinst
-00027460: 616e 6365 2873 656c 662e 5f6d 6574 612e  ance(self._meta.
-00027470: 6474 7970 652c 2070 642e 4361 7465 676f  dtype, pd.Catego
-00027480: 7269 6361 6c44 7479 7065 290a 2020 2020  ricalDtype).    
-00027490: 2020 2020 2020 2020 616e 6420 6b65 7920          and key 
-000274a0: 696e 2073 656c 662e 5f63 6174 5f61 7474  in self._cat_att
-000274b0: 7269 6275 7465 730a 2020 2020 2020 2020  ributes.        
-000274c0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-000274d0: 6574 7572 6e20 6765 7461 7474 7228 7365  eturn getattr(se
-000274e0: 6c66 2e63 6174 2c20 6b65 7929 0a20 2020  lf.cat, key).   
-000274f0: 2020 2020 2065 6c69 6620 6b65 7920 696e       elif key in
-00027500: 2073 656c 662e 5f64 745f 6174 7472 6962   self._dt_attrib
-00027510: 7574 6573 3a0a 2020 2020 2020 2020 2020  utes:.          
-00027520: 2020 7265 7475 726e 2067 6574 6174 7472    return getattr
-00027530: 2873 656c 662e 6474 2c20 6b65 7929 0a20  (self.dt, key). 
-00027540: 2020 2020 2020 2065 6c69 6620 6b65 7920         elif key 
-00027550: 696e 2073 656c 662e 5f6d 6f6e 6f74 6f6e  in self._monoton
-00027560: 6963 5f61 7474 7269 6275 7465 733a 0a20  ic_attributes:. 
-00027570: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00027580: 6e20 6765 7461 7474 7228 7365 6c66 2c20  n getattr(self, 
-00027590: 6b65 7929 0a20 2020 2020 2020 2072 6169  key).        rai
-000275a0: 7365 2041 7474 7269 6275 7465 4572 726f  se AttributeErro
-000275b0: 7228 2227 496e 6465 7827 206f 626a 6563  r("'Index' objec
-000275c0: 7420 6861 7320 6e6f 2061 7474 7269 6275  t has no attribu
-000275d0: 7465 2025 7222 2025 206b 6579 290a 0a20  te %r" % key).. 
-000275e0: 2020 2064 6566 205f 5f64 6972 5f5f 2873     def __dir__(s
-000275f0: 656c 6629 3a0a 2020 2020 2020 2020 6f75  elf):.        ou
-00027600: 7420 3d20 7375 7065 7228 292e 5f5f 6469  t = super().__di
-00027610: 725f 5f28 290a 2020 2020 2020 2020 6f75  r__().        ou
-00027620: 742e 6578 7465 6e64 2873 656c 662e 5f64  t.extend(self._d
-00027630: 745f 6174 7472 6962 7574 6573 290a 2020  t_attributes).  
-00027640: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00027650: 6e63 6528 7365 6c66 2e64 7479 7065 2c20  nce(self.dtype, 
-00027660: 7064 2e43 6174 6567 6f72 6963 616c 4474  pd.CategoricalDt
-00027670: 7970 6529 3a0a 2020 2020 2020 2020 2020  ype):.          
-00027680: 2020 6f75 742e 6578 7465 6e64 2873 656c    out.extend(sel
-00027690: 662e 5f63 6174 5f61 7474 7269 6275 7465  f._cat_attribute
-000276a0: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
-000276b0: 6e20 6f75 740a 0a20 2020 2023 2054 7970  n out..    # Typ
-000276c0: 696e 673a 2068 7474 7073 3a2f 2f67 6974  ing: https://git
-000276d0: 6875 622e 636f 6d2f 7079 7468 6f6e 2f6d  hub.com/python/m
-000276e0: 7970 792f 6973 7375 6573 2f34 3132 350a  ypy/issues/4125.
-000276f0: 2020 2020 4070 726f 7065 7274 7920 2023      @property  #
-00027700: 2074 7970 653a 2069 676e 6f72 650a 2020   type: ignore.  
-00027710: 2020 6465 6620 696e 6465 7828 7365 6c66    def index(self
-00027720: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
-00027730: 2041 7474 7269 6275 7465 4572 726f 7228   AttributeError(
-00027740: 0a20 2020 2020 2020 2020 2020 2066 227b  .            f"{
-00027750: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
-00027760: 5f6e 616d 655f 5f21 727d 206f 626a 6563  _name__!r} objec
-00027770: 7420 6861 7320 6e6f 2061 7474 7269 6275  t has no attribu
-00027780: 7465 2027 696e 6465 7827 220a 2020 2020  te 'index'".    
-00027790: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
-000277a0: 5f61 7272 6179 5f77 7261 705f 5f28 7365  _array_wrap__(se
-000277b0: 6c66 2c20 6172 7261 792c 2063 6f6e 7465  lf, array, conte
-000277c0: 7874 3d4e 6f6e 6529 3a0a 2020 2020 2020  xt=None):.      
-000277d0: 2020 7265 7475 726e 2070 642e 496e 6465    return pd.Inde
-000277e0: 7828 6172 7261 792c 206e 616d 653d 7365  x(array, name=se
-000277f0: 6c66 2e6e 616d 6529 0a0a 2020 2020 6465  lf.name)..    de
-00027800: 6620 6865 6164 2873 656c 662c 206e 3d35  f head(self, n=5
-00027810: 2c20 636f 6d70 7574 653d 5472 7565 293a  , compute=True):
-00027820: 0a20 2020 2020 2020 2022 2222 4669 7273  .        """Firs
-00027830: 7420 6e20 6974 656d 7320 6f66 2074 6865  t n items of the
-00027840: 2049 6e64 6578 2e0a 0a20 2020 2020 2020   Index...       
-00027850: 2043 6176 6561 742c 2074 6869 7320 6f6e   Caveat, this on
-00027860: 6c79 2063 6865 636b 7320 7468 6520 6669  ly checks the fi
-00027870: 7273 7420 7061 7274 6974 696f 6e2e 0a20  rst partition.. 
-00027880: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00027890: 2020 206e 616d 6520 3d20 2268 6561 642d     name = "head-
-000278a0: 2564 2d25 7322 2025 2028 6e2c 2073 656c  %d-%s" % (n, sel
-000278b0: 662e 5f6e 616d 6529 0a20 2020 2020 2020  f._name).       
-000278c0: 2064 736b 203d 207b 286e 616d 652c 2030   dsk = {(name, 0
-000278d0: 293a 2028 6f70 6572 6174 6f72 2e67 6574  ): (operator.get
-000278e0: 6974 656d 2c20 2873 656c 662e 5f6e 616d  item, (self._nam
-000278f0: 652c 2030 292c 2073 6c69 6365 2830 2c20  e, 0), slice(0, 
-00027900: 6e29 297d 0a20 2020 2020 2020 2067 7261  n))}.        gra
-00027910: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
-00027920: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
-00027930: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
-00027940: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
-00027950: 6c66 5d29 0a0a 2020 2020 2020 2020 7265  lf])..        re
-00027960: 7375 6c74 203d 206e 6577 5f64 645f 6f62  sult = new_dd_ob
-00027970: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
-00027980: 2c20 7365 6c66 2e5f 6d65 7461 2c20 7365  , self._meta, se
-00027990: 6c66 2e64 6976 6973 696f 6e73 5b3a 325d  lf.divisions[:2]
-000279a0: 290a 0a20 2020 2020 2020 2069 6620 636f  )..        if co
-000279b0: 6d70 7574 653a 0a20 2020 2020 2020 2020  mpute:.         
-000279c0: 2020 2072 6573 756c 7420 3d20 7265 7375     result = resu
-000279d0: 6c74 2e63 6f6d 7075 7465 2829 0a20 2020  lt.compute().   
-000279e0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-000279f0: 6c74 0a0a 2020 2020 4064 6572 6976 6564  lt..    @derived
-00027a00: 5f66 726f 6d28 7064 2e49 6e64 6578 290a  _from(pd.Index).
-00027a10: 2020 2020 6465 6620 6d61 7828 7365 6c66      def max(self
-00027a20: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
-00027a30: 6c73 6529 3a0a 2020 2020 2020 2020 7265  lse):.        re
-00027a40: 7475 726e 2073 656c 662e 7265 6475 6374  turn self.reduct
-00027a50: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-00027a60: 204d 2e6d 6178 2c0a 2020 2020 2020 2020   M.max,.        
-00027a70: 2020 2020 6d65 7461 3d73 656c 662e 5f6d      meta=self._m
-00027a80: 6574 615f 6e6f 6e65 6d70 7479 2e6d 6178  eta_nonempty.max
-00027a90: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
-00027aa0: 746f 6b65 6e3d 7365 6c66 2e5f 746f 6b65  token=self._toke
-00027ab0: 6e5f 7072 6566 6978 202b 2022 6d61 7822  n_prefix + "max"
-00027ac0: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
-00027ad0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-00027ae0: 6576 6572 792c 0a20 2020 2020 2020 2029  every,.        )
-00027af0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00027b00: 726f 6d28 7064 2e49 6e64 6578 290a 2020  rom(pd.Index).  
-00027b10: 2020 6465 6620 6d69 6e28 7365 6c66 2c20    def min(self, 
-00027b20: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
-00027b30: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
-00027b40: 726e 2073 656c 662e 7265 6475 6374 696f  rn self.reductio
-00027b50: 6e28 0a20 2020 2020 2020 2020 2020 204d  n(.            M
-00027b60: 2e6d 696e 2c0a 2020 2020 2020 2020 2020  .min,.          
-00027b70: 2020 6d65 7461 3d73 656c 662e 5f6d 6574    meta=self._met
-00027b80: 615f 6e6f 6e65 6d70 7479 2e6d 696e 2829  a_nonempty.min()
-00027b90: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
-00027ba0: 6b65 6e3d 7365 6c66 2e5f 746f 6b65 6e5f  ken=self._token_
-00027bb0: 7072 6566 6978 202b 2022 6d69 6e22 2c0a  prefix + "min",.
-00027bc0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-00027bd0: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-00027be0: 6572 792c 0a20 2020 2020 2020 2029 0a0a  ery,.        )..
-00027bf0: 2020 2020 6465 6620 636f 756e 7428 7365      def count(se
-00027c00: 6c66 2c20 7370 6c69 745f 6576 6572 793d  lf, split_every=
-00027c10: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
-00027c20: 7265 7475 726e 2073 656c 662e 7265 6475  return self.redu
-00027c30: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
-00027c40: 2020 206d 6574 686f 6473 2e69 6e64 6578     methods.index
-00027c50: 5f63 6f75 6e74 2c0a 2020 2020 2020 2020  _count,.        
-00027c60: 2020 2020 6e70 2e73 756d 2c0a 2020 2020      np.sum,.    
-00027c70: 2020 2020 2020 2020 746f 6b65 6e3d 2269          token="i
-00027c80: 6e64 6578 2d63 6f75 6e74 222c 0a20 2020  ndex-count",.   
-00027c90: 2020 2020 2020 2020 206d 6574 613d 696e           meta=in
-00027ca0: 742c 0a20 2020 2020 2020 2020 2020 2073  t,.            s
-00027cb0: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-00027cc0: 5f65 7665 7279 2c0a 2020 2020 2020 2020  _every,.        
-00027cd0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00027ce0: 6672 6f6d 2870 642e 496e 6465 7829 0a20  from(pd.Index). 
-00027cf0: 2020 2064 6566 2073 6869 6674 2873 656c     def shift(sel
-00027d00: 662c 2070 6572 696f 6473 3d31 2c20 6672  f, periods=1, fr
-00027d10: 6571 3d4e 6f6e 6529 3a0a 2020 2020 2020  eq=None):.      
-00027d20: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00027d30: 7365 6c66 2e5f 6d65 7461 2c20 7064 2e50  self._meta, pd.P
-00027d40: 6572 696f 6449 6e64 6578 293a 0a20 2020  eriodIndex):.   
-00027d50: 2020 2020 2020 2020 2069 6620 6672 6571           if freq
-00027d60: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00027d70: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00027d80: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-00027d90: 5065 7269 6f64 496e 6465 7820 646f 6573  PeriodIndex does
-00027da0: 6e27 7420 6163 6365 7074 2060 6672 6571  n't accept `freq
-00027db0: 6020 6172 6775 6d65 6e74 2229 0a20 2020  ` argument").   
-00027dc0: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-00027dd0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-00027de0: 7074 792e 7368 6966 7428 7065 7269 6f64  pty.shift(period
-00027df0: 7329 0a20 2020 2020 2020 2020 2020 206f  s).            o
-00027e00: 7574 203d 2073 656c 662e 6d61 705f 7061  ut = self.map_pa
-00027e10: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-00027e20: 2020 2020 2020 2020 2020 4d2e 7368 6966            M.shif
-00027e30: 742c 2070 6572 696f 6473 2c20 6d65 7461  t, periods, meta
-00027e40: 3d6d 6574 612c 2074 6f6b 656e 3d22 7368  =meta, token="sh
-00027e50: 6966 7422 2c20 7472 616e 7366 6f72 6d5f  ift", transform_
-00027e60: 6469 7669 7369 6f6e 733d 4661 6c73 650a  divisions=False.
-00027e70: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00027e80: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00027e90: 2020 2020 2020 2020 2320 5061 6e64 6173          # Pandas
-00027ea0: 2077 696c 6c20 7261 6973 6520 666f 7220   will raise for 
-00027eb0: 6f74 6865 7220 696e 6465 7820 7479 7065  other index type
-00027ec0: 7320 7468 6174 2064 6f6e 2774 2069 6d70  s that don't imp
-00027ed0: 6c65 6d65 6e74 2073 6869 6674 0a20 2020  lement shift.   
-00027ee0: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-00027ef0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-00027f00: 7074 792e 7368 6966 7428 7065 7269 6f64  pty.shift(period
-00027f10: 732c 2066 7265 713d 6672 6571 290a 2020  s, freq=freq).  
-00027f20: 2020 2020 2020 2020 2020 6f75 7420 3d20            out = 
-00027f30: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-00027f40: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-00027f50: 2020 2020 204d 2e73 6869 6674 2c0a 2020       M.shift,.  
-00027f60: 2020 2020 2020 2020 2020 2020 2020 7065                pe
-00027f70: 7269 6f64 732c 0a20 2020 2020 2020 2020  riods,.         
-00027f80: 2020 2020 2020 2074 6f6b 656e 3d22 7368         token="sh
-00027f90: 6966 7422 2c0a 2020 2020 2020 2020 2020  ift",.          
-00027fa0: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
-00027fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027fc0: 2066 7265 713d 6672 6571 2c0a 2020 2020   freq=freq,.    
-00027fd0: 2020 2020 2020 2020 2020 2020 7472 616e              tran
-00027fe0: 7366 6f72 6d5f 6469 7669 7369 6f6e 733d  sform_divisions=
-00027ff0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00028000: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-00028010: 6672 6571 2069 7320 4e6f 6e65 3a0a 2020  freq is None:.  
-00028020: 2020 2020 2020 2020 2020 6672 6571 203d            freq =
-00028030: 206d 6574 612e 6672 6571 0a20 2020 2020   meta.freq.     
-00028040: 2020 2072 6574 7572 6e20 6d61 7962 655f     return maybe_
-00028050: 7368 6966 745f 6469 7669 7369 6f6e 7328  shift_divisions(
-00028060: 6f75 742c 2070 6572 696f 6473 2c20 6672  out, periods, fr
-00028070: 6571 3d66 7265 7129 0a0a 2020 2020 4064  eq=freq)..    @d
-00028080: 6572 6976 6564 5f66 726f 6d28 7064 2e49  erived_from(pd.I
-00028090: 6e64 6578 290a 2020 2020 6465 6620 746f  ndex).    def to
-000280a0: 5f73 6572 6965 7328 7365 6c66 293a 0a20  _series(self):. 
-000280b0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000280c0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-000280d0: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
-000280e0: 2e74 6f5f 7365 7269 6573 2c0a 2020 2020  .to_series,.    
-000280f0: 2020 2020 2020 2020 6d65 7461 3d73 656c          meta=sel
-00028100: 662e 5f6d 6574 612e 746f 5f73 6572 6965  f._meta.to_serie
-00028110: 7328 292c 0a20 2020 2020 2020 2020 2020  s(),.           
-00028120: 2074 7261 6e73 666f 726d 5f64 6976 6973   transform_divis
-00028130: 696f 6e73 3d46 616c 7365 2c0a 2020 2020  ions=False,.    
-00028140: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
-00028150: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
-00028160: 782c 2075 615f 6172 6773 3d5b 2269 6e64  x, ua_args=["ind
-00028170: 6578 225d 290a 2020 2020 6465 6620 746f  ex"]).    def to
-00028180: 5f66 7261 6d65 2873 656c 662c 2069 6e64  _frame(self, ind
-00028190: 6578 3d54 7275 652c 206e 616d 653d 4e6f  ex=True, name=No
-000281a0: 6e65 293a 0a20 2020 2020 2020 2069 6620  ne):.        if 
-000281b0: 6e6f 7420 696e 6465 783a 0a20 2020 2020  not index:.     
-000281c0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-000281d0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-000281e0: 2829 0a20 2020 2020 2020 2061 7267 7320  ().        args 
-000281f0: 3d20 5b69 6e64 6578 5d20 6966 206e 616d  = [index] if nam
-00028200: 6520 6973 204e 6f6e 6520 656c 7365 205b  e is None else [
-00028210: 696e 6465 782c 206e 616d 655d 0a0a 2020  index, name]..  
-00028220: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00028230: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-00028240: 280a 2020 2020 2020 2020 2020 2020 4d2e  (.            M.
-00028250: 746f 5f66 7261 6d65 2c0a 2020 2020 2020  to_frame,.      
-00028260: 2020 2020 2020 2a61 7267 732c 0a20 2020        *args,.   
-00028270: 2020 2020 2020 2020 206d 6574 613d 7365           meta=se
-00028280: 6c66 2e5f 6d65 7461 2e74 6f5f 6672 616d  lf._meta.to_fram
-00028290: 6528 2a61 7267 7329 2c0a 2020 2020 2020  e(*args),.      
-000282a0: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
-000282b0: 6469 7669 7369 6f6e 733d 4661 6c73 652c  divisions=False,
-000282c0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000282d0: 4069 6e73 6572 745f 6d65 7461 5f70 6172  @insert_meta_par
-000282e0: 616d 5f64 6573 6372 6970 7469 6f6e 2870  am_description(p
-000282f0: 6164 3d31 3229 0a20 2020 2040 6465 7269  ad=12).    @deri
-00028300: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
-00028310: 7829 0a20 2020 2064 6566 206d 6170 2873  x).    def map(s
-00028320: 656c 662c 2061 7267 2c20 6e61 5f61 6374  elf, arg, na_act
-00028330: 696f 6e3d 4e6f 6e65 2c20 6d65 7461 3d6e  ion=None, meta=n
-00028340: 6f5f 6465 6661 756c 742c 2069 735f 6d6f  o_default, is_mo
-00028350: 6e6f 746f 6e69 633d 4661 6c73 6529 3a0a  notonic=False):.
-00028360: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00028370: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
-00028380: 6973 206d 6574 686f 6420 636c 6561 7273  is method clears
-00028390: 2061 6e79 206b 6e6f 776e 2064 6976 6973   any known divis
-000283a0: 696f 6e73 2e0a 0a20 2020 2020 2020 2049  ions...        I
-000283b0: 6620 796f 7572 206d 6170 7069 6e67 2066  f your mapping f
-000283c0: 756e 6374 696f 6e20 6973 206d 6f6e 6f74  unction is monot
-000283d0: 6f6e 6963 616c 6c79 2069 6e63 7265 6173  onically increas
-000283e0: 696e 6720 7468 656e 2075 7365 2060 6973  ing then use `is
-000283f0: 5f6d 6f6e 6f74 6f6e 6963 600a 2020 2020  _monotonic`.    
-00028400: 2020 2020 746f 2061 7070 6c79 2074 6865      to apply the
-00028410: 206d 6170 696e 6720 6675 6e63 7469 6f6e   maping function
-00028420: 2074 6f20 7468 6520 6f6c 6420 6469 7669   to the old divi
-00028430: 7369 6f6e 7320 616e 6420 6173 7369 676e  sions and assign
-00028440: 2074 6865 206e 6577 0a20 2020 2020 2020   the new.       
-00028450: 2064 6976 6973 696f 6e73 2074 6f20 7468   divisions to th
-00028460: 6520 6f75 7470 7574 2e0a 0a20 2020 2020  e output...     
-00028470: 2020 2022 2222 0a20 2020 2020 2020 2061     """.        a
-00028480: 7070 6c69 6564 203d 2073 7570 6572 2829  pplied = super()
-00028490: 2e6d 6170 2861 7267 2c20 6e61 5f61 6374  .map(arg, na_act
-000284a0: 696f 6e3d 6e61 5f61 6374 696f 6e2c 206d  ion=na_action, m
-000284b0: 6574 613d 6d65 7461 290a 2020 2020 2020  eta=meta).      
-000284c0: 2020 6966 2069 735f 6d6f 6e6f 746f 6e69    if is_monotoni
-000284d0: 6320 616e 6420 7365 6c66 2e6b 6e6f 776e  c and self.known
-000284e0: 5f64 6976 6973 696f 6e73 3a0a 2020 2020  _divisions:.    
-000284f0: 2020 2020 2020 2020 6170 706c 6965 642e          applied.
-00028500: 6469 7669 7369 6f6e 7320 3d20 7475 706c  divisions = tupl
-00028510: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-00028520: 2020 2070 642e 5365 7269 6573 2873 656c     pd.Series(sel
-00028530: 662e 6469 7669 7369 6f6e 7329 2e6d 6170  f.divisions).map
-00028540: 2861 7267 2c20 6e61 5f61 6374 696f 6e3d  (arg, na_action=
-00028550: 6e61 5f61 6374 696f 6e29 0a20 2020 2020  na_action).     
-00028560: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00028570: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00028580: 2020 2061 7070 6c69 6564 203d 2061 7070     applied = app
-00028590: 6c69 6564 2e63 6c65 6172 5f64 6976 6973  lied.clear_divis
-000285a0: 696f 6e73 2829 0a20 2020 2020 2020 2072  ions().        r
-000285b0: 6574 7572 6e20 6170 706c 6965 640a 0a20  eturn applied.. 
-000285c0: 2020 2069 6620 6e6f 7420 5041 4e44 4153     if not PANDAS
-000285d0: 5f47 545f 3230 303a 0a0a 2020 2020 2020  _GT_200:..      
-000285e0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-000285f0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00028600: 6d28 7064 2e49 6e64 6578 290a 2020 2020  m(pd.Index).    
-00028610: 2020 2020 6465 6620 6973 5f6d 6f6e 6f74      def is_monot
-00028620: 6f6e 6963 2873 656c 6629 3a0a 2020 2020  onic(self):.    
-00028630: 2020 2020 2020 2020 6966 2050 414e 4441          if PANDA
-00028640: 535f 4754 5f31 3530 3a0a 2020 2020 2020  S_GT_150:.      
-00028650: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-00028660: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
-00028670: 2020 2020 2020 2020 2020 2020 2022 6973               "is
-00028680: 5f6d 6f6e 6f74 6f6e 6963 2069 7320 6465  _monotonic is de
-00028690: 7072 6563 6174 6564 2061 6e64 2077 696c  precated and wil
-000286a0: 6c20 6265 2072 656d 6f76 6564 2069 6e20  l be removed in 
-000286b0: 6120 6675 7475 7265 2076 6572 7369 6f6e  a future version
-000286c0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-000286d0: 2020 2020 2020 2020 2255 7365 2069 735f          "Use is_
-000286e0: 6d6f 6e6f 746f 6e69 635f 696e 6372 6561  monotonic_increa
-000286f0: 7369 6e67 2069 6e73 7465 6164 2e22 2c0a  sing instead.",.
-00028700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028710: 2020 2020 4675 7475 7265 5761 726e 696e      FutureWarnin
-00028720: 672c 0a20 2020 2020 2020 2020 2020 2020  g,.             
-00028730: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00028740: 2072 6574 7572 6e20 7375 7065 7228 292e   return super().
-00028750: 6973 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63  is_monotonic_inc
-00028760: 7265 6173 696e 670a 0a20 2020 2040 7072  reasing..    @pr
-00028770: 6f70 6572 7479 0a20 2020 2040 6465 7269  operty.    @deri
-00028780: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
-00028790: 7829 0a20 2020 2064 6566 2069 735f 6d6f  x).    def is_mo
-000287a0: 6e6f 746f 6e69 635f 696e 6372 6561 7369  notonic_increasi
-000287b0: 6e67 2873 656c 6629 3a0a 2020 2020 2020  ng(self):.      
-000287c0: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
-000287d0: 2e69 735f 6d6f 6e6f 746f 6e69 635f 696e  .is_monotonic_in
-000287e0: 6372 6561 7369 6e67 0a0a 2020 2020 4070  creasing..    @p
-000287f0: 726f 7065 7274 790a 2020 2020 4064 6572  roperty.    @der
-00028800: 6976 6564 5f66 726f 6d28 7064 2e49 6e64  ived_from(pd.Ind
-00028810: 6578 290a 2020 2020 6465 6620 6973 5f6d  ex).    def is_m
-00028820: 6f6e 6f74 6f6e 6963 5f64 6563 7265 6173  onotonic_decreas
-00028830: 696e 6728 7365 6c66 293a 0a20 2020 2020  ing(self):.     
-00028840: 2020 2072 6574 7572 6e20 7375 7065 7228     return super(
-00028850: 292e 6973 5f6d 6f6e 6f74 6f6e 6963 5f64  ).is_monotonic_d
-00028860: 6563 7265 6173 696e 670a 0a20 2020 2040  ecreasing..    @
-00028870: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00028880: 496e 6465 7829 0a20 2020 2064 6566 206d  Index).    def m
-00028890: 656d 6f72 795f 7573 6167 6528 7365 6c66  emory_usage(self
-000288a0: 2c20 6465 6570 3d46 616c 7365 293a 0a20  , deep=False):. 
-000288b0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000288c0: 6c66 2e72 6564 7563 7469 6f6e 280a 2020  lf.reduction(.  
-000288d0: 2020 2020 2020 2020 2020 4d2e 6d65 6d6f            M.memo
-000288e0: 7279 5f75 7361 6765 2c0a 2020 2020 2020  ry_usage,.      
-000288f0: 2020 2020 2020 4d2e 7375 6d2c 0a20 2020        M.sum,.   
-00028900: 2020 2020 2020 2020 2063 6875 6e6b 5f6b           chunk_k
-00028910: 7761 7267 733d 7b22 6465 6570 223a 2064  wargs={"deep": d
-00028920: 6565 707d 2c0a 2020 2020 2020 2020 2020  eep},.          
-00028930: 2020 7370 6c69 745f 6576 6572 793d 4661    split_every=Fa
-00028940: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00028950: 2074 6f6b 656e 3d73 656c 662e 5f74 6f6b   token=self._tok
-00028960: 656e 5f70 7265 6669 7820 2b20 226d 656d  en_prefix + "mem
-00028970: 6f72 792d 7573 6167 6522 2c0a 2020 2020  ory-usage",.    
-00028980: 2020 2020 290a 0a0a 636c 6173 7320 4461      )...class Da
-00028990: 7461 4672 616d 6528 5f46 7261 6d65 293a  taFrame(_Frame):
-000289a0: 0a20 2020 2022 2222 0a20 2020 2050 6172  .    """.    Par
-000289b0: 616c 6c65 6c20 5061 6e64 6173 2044 6174  allel Pandas Dat
-000289c0: 6146 7261 6d65 0a0a 2020 2020 446f 206e  aFrame..    Do n
-000289d0: 6f74 2075 7365 2074 6869 7320 636c 6173  ot use this clas
-000289e0: 7320 6469 7265 6374 6c79 2e20 2049 6e73  s directly.  Ins
-000289f0: 7465 6164 2075 7365 2066 756e 6374 696f  tead use functio
-00028a00: 6e73 206c 696b 650a 2020 2020 6060 6464  ns like.    ``dd
-00028a10: 2e72 6561 645f 6373 7660 602c 2060 6064  .read_csv``, ``d
-00028a20: 642e 7265 6164 5f70 6172 7175 6574 6060  d.read_parquet``
-00028a30: 2c20 6f72 2060 6064 642e 6672 6f6d 5f70  , or ``dd.from_p
-00028a40: 616e 6461 7360 602e 0a0a 2020 2020 5061  andas``...    Pa
-00028a50: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-00028a60: 2d2d 2d2d 2d2d 2d0a 2020 2020 6473 6b3a  -------.    dsk:
-00028a70: 2064 6963 740a 2020 2020 2020 2020 5468   dict.        Th
-00028a80: 6520 6461 736b 2067 7261 7068 2074 6f20  e dask graph to 
-00028a90: 636f 6d70 7574 6520 7468 6973 2044 6174  compute this Dat
-00028aa0: 6146 7261 6d65 0a20 2020 206e 616d 653a  aFrame.    name:
-00028ab0: 2073 7472 0a20 2020 2020 2020 2054 6865   str.        The
-00028ac0: 206b 6579 2070 7265 6669 7820 7468 6174   key prefix that
-00028ad0: 2073 7065 6369 6669 6573 2077 6869 6368   specifies which
-00028ae0: 206b 6579 7320 696e 2074 6865 2064 6173   keys in the das
-00028af0: 6b20 636f 6d70 7269 7365 2074 6869 730a  k comprise this.
-00028b00: 2020 2020 2020 2020 7061 7274 6963 756c          particul
-00028b10: 6172 2044 6174 6146 7261 6d65 0a20 2020  ar DataFrame.   
-00028b20: 206d 6574 613a 2070 616e 6461 732e 4461   meta: pandas.Da
-00028b30: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
-00028b40: 416e 2065 6d70 7479 2060 6070 616e 6461  An empty ``panda
-00028b50: 732e 4461 7461 4672 616d 6560 6020 7769  s.DataFrame`` wi
-00028b60: 7468 206e 616d 6573 2c20 6474 7970 6573  th names, dtypes
-00028b70: 2c20 616e 6420 696e 6465 7820 6d61 7463  , and index matc
-00028b80: 6869 6e67 0a20 2020 2020 2020 2074 6865  hing.        the
-00028b90: 2065 7870 6563 7465 6420 6f75 7470 7574   expected output
-00028ba0: 2e0a 2020 2020 6469 7669 7369 6f6e 733a  ..    divisions:
-00028bb0: 2074 7570 6c65 206f 6620 696e 6465 7820   tuple of index 
-00028bc0: 7661 6c75 6573 0a20 2020 2020 2020 2056  values.        V
-00028bd0: 616c 7565 7320 616c 6f6e 6720 7768 6963  alues along whic
-00028be0: 6820 7765 2070 6172 7469 7469 6f6e 206f  h we partition o
-00028bf0: 7572 2062 6c6f 636b 7320 6f6e 2074 6865  ur blocks on the
-00028c00: 2069 6e64 6578 0a20 2020 2022 2222 0a0a   index.    """..
-00028c10: 2020 2020 5f70 6172 7469 7469 6f6e 5f74      _partition_t
-00028c20: 7970 6520 3d20 7064 2e44 6174 6146 7261  ype = pd.DataFra
-00028c30: 6d65 0a20 2020 205f 6973 5f70 6172 7469  me.    _is_parti
-00028c40: 7469 6f6e 5f74 7970 6520 3d20 7374 6174  tion_type = stat
-00028c50: 6963 6d65 7468 6f64 2869 735f 6461 7461  icmethod(is_data
-00028c60: 6672 616d 655f 6c69 6b65 290a 2020 2020  frame_like).    
-00028c70: 5f74 6f6b 656e 5f70 7265 6669 7820 3d20  _token_prefix = 
-00028c80: 2264 6174 6166 7261 6d65 2d22 0a20 2020  "dataframe-".   
-00028c90: 205f 6163 6365 7373 6f72 733a 2043 6c61   _accessors: Cla
-00028ca0: 7373 5661 725b 7365 745b 7374 725d 5d20  ssVar[set[str]] 
-00028cb0: 3d20 7365 7428 290a 0a20 2020 2064 6566  = set()..    def
-00028cc0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-00028cd0: 6473 6b2c 206e 616d 652c 206d 6574 612c  dsk, name, meta,
-00028ce0: 2064 6976 6973 696f 6e73 293a 0a20 2020   divisions):.   
-00028cf0: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
-00028d00: 6e69 745f 5f28 6473 6b2c 206e 616d 652c  nit__(dsk, name,
-00028d10: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
-00028d20: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
-00028d30: 662e 6461 736b 2e6c 6179 6572 735b 6e61  f.dask.layers[na
-00028d40: 6d65 5d2e 636f 6c6c 6563 7469 6f6e 5f61  me].collection_a
-00028d50: 6e6e 6f74 6174 696f 6e73 2069 7320 4e6f  nnotations is No
-00028d60: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00028d70: 7365 6c66 2e64 6173 6b2e 6c61 7965 7273  self.dask.layers
-00028d80: 5b6e 616d 655d 2e63 6f6c 6c65 6374 696f  [name].collectio
-00028d90: 6e5f 616e 6e6f 7461 7469 6f6e 7320 3d20  n_annotations = 
-00028da0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00028db0: 2020 226e 7061 7274 6974 696f 6e73 223a    "npartitions":
-00028dc0: 2073 656c 662e 6e70 6172 7469 7469 6f6e   self.npartition
-00028dd0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00028de0: 2020 2022 636f 6c75 6d6e 7322 3a20 5b63     "columns": [c
-00028df0: 6f6c 2066 6f72 2063 6f6c 2069 6e20 7365  ol for col in se
-00028e00: 6c66 2e63 6f6c 756d 6e73 5d2c 0a20 2020  lf.columns],.   
-00028e10: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
-00028e20: 7065 223a 2074 7970 656e 616d 6528 7479  pe": typename(ty
-00028e30: 7065 2873 656c 6629 292c 0a20 2020 2020  pe(self)),.     
-00028e40: 2020 2020 2020 2020 2020 2022 6461 7461             "data
-00028e50: 6672 616d 655f 7479 7065 223a 2074 7970  frame_type": typ
-00028e60: 656e 616d 6528 7479 7065 2873 656c 662e  ename(type(self.
-00028e70: 5f6d 6574 6129 292c 0a20 2020 2020 2020  _meta)),.       
-00028e80: 2020 2020 2020 2020 2022 7365 7269 6573           "series
-00028e90: 5f64 7479 7065 7322 3a20 7b0a 2020 2020  _dtypes": {.    
-00028ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028eb0: 636f 6c3a 2073 656c 662e 5f6d 6574 615b  col: self._meta[
-00028ec0: 636f 6c5d 2e64 7479 7065 0a20 2020 2020  col].dtype.     
-00028ed0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00028ee0: 6620 6861 7361 7474 7228 7365 6c66 2e5f  f hasattr(self._
-00028ef0: 6d65 7461 5b63 6f6c 5d2c 2022 6474 7970  meta[col], "dtyp
-00028f00: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
-00028f10: 2020 2020 2020 2020 656c 7365 204e 6f6e          else Non
-00028f20: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00028f30: 2020 2020 2020 666f 7220 636f 6c20 696e        for col in
-00028f40: 2073 656c 662e 5f6d 6574 612e 636f 6c75   self._meta.colu
-00028f50: 6d6e 730a 2020 2020 2020 2020 2020 2020  mns.            
-00028f60: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-00028f70: 2020 207d 0a20 2020 2020 2020 2065 6c73     }.        els
-00028f80: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-00028f90: 656c 662e 6461 736b 2e6c 6179 6572 735b  elf.dask.layers[
-00028fa0: 6e61 6d65 5d2e 636f 6c6c 6563 7469 6f6e  name].collection
-00028fb0: 5f61 6e6e 6f74 6174 696f 6e73 2e75 7064  _annotations.upd
-00028fc0: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
-00028fd0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-00028fe0: 2020 2020 2020 2020 2020 2022 6e70 6172             "npar
-00028ff0: 7469 7469 6f6e 7322 3a20 7365 6c66 2e6e  titions": self.n
-00029000: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
-00029010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029020: 2263 6f6c 756d 6e73 223a 205b 636f 6c20  "columns": [col 
-00029030: 666f 7220 636f 6c20 696e 2073 656c 662e  for col in self.
-00029040: 636f 6c75 6d6e 735d 2c0a 2020 2020 2020  columns],.      
-00029050: 2020 2020 2020 2020 2020 2020 2020 2274                "t
-00029060: 7970 6522 3a20 7479 7065 6e61 6d65 2874  ype": typename(t
-00029070: 7970 6528 7365 6c66 2929 2c0a 2020 2020  ype(self)),.    
-00029080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029090: 2264 6174 6166 7261 6d65 5f74 7970 6522  "dataframe_type"
-000290a0: 3a20 7479 7065 6e61 6d65 2874 7970 6528  : typename(type(
-000290b0: 7365 6c66 2e5f 6d65 7461 2929 2c0a 2020  self._meta)),.  
-000290c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000290d0: 2020 2273 6572 6965 735f 6474 7970 6573    "series_dtypes
-000290e0: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
-000290f0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-00029100: 3a20 7365 6c66 2e5f 6d65 7461 5b63 6f6c  : self._meta[col
-00029110: 5d2e 6474 7970 650a 2020 2020 2020 2020  ].dtype.        
-00029120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029130: 6966 2068 6173 6174 7472 2873 656c 662e  if hasattr(self.
-00029140: 5f6d 6574 615b 636f 6c5d 2c20 2264 7479  _meta[col], "dty
-00029150: 7065 2229 0a20 2020 2020 2020 2020 2020  pe").           
-00029160: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00029170: 6520 4e6f 6e65 0a20 2020 2020 2020 2020  e None.         
-00029180: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00029190: 6f72 2063 6f6c 2069 6e20 7365 6c66 2e5f  or col in self._
-000291a0: 6d65 7461 2e63 6f6c 756d 6e73 0a20 2020  meta.columns.   
-000291b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000291c0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-000291d0: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-000291e0: 2020 290a 0a20 2020 2064 6566 205f 5f61    )..    def __a
-000291f0: 7272 6179 5f77 7261 705f 5f28 7365 6c66  rray_wrap__(self
-00029200: 2c20 6172 7261 792c 2063 6f6e 7465 7874  , array, context
-00029210: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00029220: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
-00029230: 6e74 6578 742c 2074 7570 6c65 2920 616e  ntext, tuple) an
-00029240: 6420 6c65 6e28 636f 6e74 6578 7429 203e  d len(context) >
-00029250: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-00029260: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
-00029270: 6e74 6578 745b 315d 5b30 5d2c 206e 702e  ntext[1][0], np.
-00029280: 6e64 6172 7261 7929 2061 6e64 2063 6f6e  ndarray) and con
-00029290: 7465 7874 5b31 5d5b 305d 2e73 6861 7065  text[1][0].shape
-000292a0: 203d 3d20 2829 3a0a 2020 2020 2020 2020   == ():.        
-000292b0: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
-000292c0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-000292d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000292e0: 2020 2020 2020 2069 6e64 6578 203d 2063         index = c
-000292f0: 6f6e 7465 7874 5b31 5d5b 305d 2e69 6e64  ontext[1][0].ind
-00029300: 6578 0a20 2020 2020 2020 2065 6c73 653a  ex.        else:
-00029310: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-00029320: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00029330: 2020 696d 706f 7274 2069 6e73 7065 6374    import inspect
-00029340: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00029350: 2020 6d65 7468 6f64 5f6e 616d 6520 3d20    method_name = 
-00029360: 6622 607b 696e 7370 6563 742e 7374 6163  f"`{inspect.stac
-00029370: 6b28 295b 335d 5b33 5d7d 6022 0a20 2020  k()[3][3]}`".   
-00029380: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-00029390: 496e 6465 7845 7272 6f72 3a0a 2020 2020  IndexError:.    
-000293a0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-000293b0: 6f64 5f6e 616d 6520 3d20 2254 6869 7320  od_name = "This 
-000293c0: 6d65 7468 6f64 220a 0a20 2020 2020 2020  method"..       
-000293d0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-000293e0: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
-000293f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029400: 6622 7b6d 6574 686f 645f 6e61 6d65 7d20  f"{method_name} 
-00029410: 6973 206e 6f74 2069 6d70 6c65 6d65 6e74  is not implement
-00029420: 6564 2066 6f72 2060 6461 736b 2e64 6174  ed for `dask.dat
-00029430: 6166 7261 6d65 2e44 6174 6146 7261 6d65  aframe.DataFrame
-00029440: 602e 220a 2020 2020 2020 2020 2020 2020  `.".            
-00029450: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00029460: 6e20 6d65 7461 5f66 7261 6d65 5f63 6f6e  n meta_frame_con
-00029470: 7374 7275 6374 6f72 2873 656c 6629 2861  structor(self)(a
-00029480: 7272 6179 2c20 696e 6465 783d 696e 6465  rray, index=inde
-00029490: 782c 2063 6f6c 756d 6e73 3d73 656c 662e  x, columns=self.
-000294a0: 636f 6c75 6d6e 7329 0a0a 2020 2020 4070  columns)..    @p
-000294b0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000294c0: 6178 6573 2873 656c 6629 3a0a 2020 2020  axes(self):.    
-000294d0: 2020 2020 7265 7475 726e 205b 7365 6c66      return [self
-000294e0: 2e69 6e64 6578 2c20 7365 6c66 2e63 6f6c  .index, self.col
-000294f0: 756d 6e73 5d0a 0a20 2020 2040 7072 6f70  umns]..    @prop
-00029500: 6572 7479 0a20 2020 2064 6566 2063 6f6c  erty.    def col
-00029510: 756d 6e73 2873 656c 6629 3a0a 2020 2020  umns(self):.    
-00029520: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00029530: 5f6d 6574 612e 636f 6c75 6d6e 730a 0a20  _meta.columns.. 
-00029540: 2020 2040 636f 6c75 6d6e 732e 7365 7474     @columns.sett
-00029550: 6572 0a20 2020 2064 6566 2063 6f6c 756d  er.    def colum
-00029560: 6e73 2873 656c 662c 2063 6f6c 756d 6e73  ns(self, columns
-00029570: 293a 0a20 2020 2020 2020 2072 656e 616d  ):.        renam
-00029580: 6564 203d 205f 7265 6e61 6d65 5f64 6173  ed = _rename_das
-00029590: 6b28 7365 6c66 2c20 636f 6c75 6d6e 7329  k(self, columns)
-000295a0: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
-000295b0: 6574 6120 3d20 7265 6e61 6d65 642e 5f6d  eta = renamed._m
-000295c0: 6574 610a 2020 2020 2020 2020 7365 6c66  eta.        self
-000295d0: 2e5f 6e61 6d65 203d 2072 656e 616d 6564  ._name = renamed
-000295e0: 2e5f 6e61 6d65 0a20 2020 2020 2020 2073  ._name.        s
-000295f0: 656c 662e 6461 736b 203d 2072 656e 616d  elf.dask = renam
-00029600: 6564 2e64 6173 6b0a 0a20 2020 2040 7072  ed.dask..    @pr
-00029610: 6f70 6572 7479 0a20 2020 2064 6566 2069  operty.    def i
-00029620: 6c6f 6328 7365 6c66 293a 0a20 2020 2020  loc(self):.     
-00029630: 2020 2022 2222 5075 7265 6c79 2069 6e74     """Purely int
-00029640: 6567 6572 2d6c 6f63 6174 696f 6e20 6261  eger-location ba
-00029650: 7365 6420 696e 6465 7869 6e67 2066 6f72  sed indexing for
-00029660: 2073 656c 6563 7469 6f6e 2062 7920 706f   selection by po
-00029670: 7369 7469 6f6e 2e0a 0a20 2020 2020 2020  sition...       
-00029680: 204f 6e6c 7920 696e 6465 7869 6e67 2074   Only indexing t
-00029690: 6865 2063 6f6c 756d 6e20 706f 7369 7469  he column positi
-000296a0: 6f6e 7320 6973 2073 7570 706f 7274 6564  ons is supported
-000296b0: 2e20 5472 7969 6e67 2074 6f20 7365 6c65  . Trying to sele
-000296c0: 6374 0a20 2020 2020 2020 2072 6f77 2070  ct.        row p
-000296d0: 6f73 6974 696f 6e73 2077 696c 6c20 7261  ositions will ra
-000296e0: 6973 6520 6120 5661 6c75 6545 7272 6f72  ise a ValueError
-000296f0: 2e0a 0a20 2020 2020 2020 2053 6565 203a  ...        See :
-00029700: 7265 663a 6064 6174 6166 7261 6d65 2e69  ref:`dataframe.i
-00029710: 6e64 6578 696e 6760 2066 6f72 206d 6f72  ndexing` for mor
-00029720: 652e 0a0a 2020 2020 2020 2020 4578 616d  e...        Exam
-00029730: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
-00029740: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
-00029750: 3e20 6466 2e69 6c6f 635b 3a2c 205b 322c  > df.iloc[:, [2,
-00029760: 2030 2c20 315d 5d20 2023 2064 6f63 7465   0, 1]]  # docte
-00029770: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
-00029780: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
-00029790: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
-000297a0: 652e 696e 6465 7869 6e67 2069 6d70 6f72  e.indexing impor
-000297b0: 7420 5f69 4c6f 6349 6e64 6578 6572 0a0a  t _iLocIndexer..
-000297c0: 2020 2020 2020 2020 2320 466f 7220 6461          # For da
-000297d0: 7461 6672 616d 6573 2077 6974 6820 756e  taframes with un
-000297e0: 6971 7565 2063 6f6c 756d 6e20 6e61 6d65  ique column name
-000297f0: 732c 2074 6869 7320 7769 6c6c 2062 6520  s, this will be 
-00029800: 7472 616e 7366 6f72 6d65 6420 696e 746f  transformed into
-00029810: 2061 205f 5f67 6574 6974 656d 5f5f 2063   a __getitem__ c
-00029820: 616c 6c0a 2020 2020 2020 2020 7265 7475  all.        retu
-00029830: 726e 205f 694c 6f63 496e 6465 7865 7228  rn _iLocIndexer(
-00029840: 7365 6c66 290a 0a20 2020 2064 6566 205f  self)..    def _
-00029850: 5f6c 656e 5f5f 2873 656c 6629 3a0a 2020  _len__(self):.  
-00029860: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-00029870: 2020 2020 2020 2073 203d 2073 656c 662e         s = self.
-00029880: 696c 6f63 5b3a 2c20 305d 0a20 2020 2020  iloc[:, 0].     
-00029890: 2020 2065 7863 6570 7420 496e 6465 7845     except IndexE
-000298a0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
-000298b0: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
-000298c0: 2e5f 5f6c 656e 5f5f 2829 0a20 2020 2020  .__len__().     
-000298d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000298e0: 2020 2020 2072 6574 7572 6e20 6c65 6e28       return len(
-000298f0: 7329 0a0a 2020 2020 6465 6620 5f5f 636f  s)..    def __co
-00029900: 6e74 6169 6e73 5f5f 2873 656c 662c 206b  ntains__(self, k
-00029910: 6579 293a 0a20 2020 2020 2020 2072 6574  ey):.        ret
-00029920: 7572 6e20 6b65 7920 696e 2073 656c 662e  urn key in self.
-00029930: 5f6d 6574 610a 0a20 2020 2040 7072 6f70  _meta..    @prop
-00029940: 6572 7479 0a20 2020 2064 6566 2065 6d70  erty.    def emp
-00029950: 7479 2873 656c 6629 3a0a 2020 2020 2020  ty(self):.      
-00029960: 2020 2320 5f5f 6765 7461 7474 725f 5f20    # __getattr__ 
-00029970: 7769 6c6c 2062 6520 6361 6c6c 6564 2061  will be called a
-00029980: 6674 6572 2077 6520 7261 6973 6520 7468  fter we raise th
-00029990: 6973 2c20 736f 2077 6527 6c6c 2072 6169  is, so we'll rai
-000299a0: 7365 2069 7420 6167 6169 6e20 6672 6f6d  se it again from
-000299b0: 2074 6865 7265 0a20 2020 2020 2020 2072   there.        r
-000299c0: 6169 7365 2041 7474 7269 6275 7465 4e6f  aise AttributeNo
-000299d0: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-000299e0: 7228 0a20 2020 2020 2020 2020 2020 2022  r(.            "
-000299f0: 4368 6563 6b69 6e67 2077 6865 7468 6572  Checking whether
-00029a00: 2061 2044 6173 6b20 4461 7461 4672 616d   a Dask DataFram
-00029a10: 6520 6861 7320 616e 7920 726f 7773 206d  e has any rows m
-00029a20: 6179 2062 6520 6578 7065 6e73 6976 652e  ay be expensive.
-00029a30: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
-00029a40: 486f 7765 7665 722c 2063 6865 636b 696e  However, checkin
-00029a50: 6720 7468 6520 6e75 6d62 6572 206f 6620  g the number of 
-00029a60: 636f 6c75 6d6e 7320 6973 2066 6173 742e  columns is fast.
-00029a70: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
-00029a80: 4465 7065 6e64 696e 6720 6f6e 2077 6869  Depending on whi
-00029a90: 6368 206f 6620 7468 6573 6520 7265 7375  ch of these resu
-00029aa0: 6c74 7320 796f 7520 6e65 6564 2c20 7573  lts you need, us
-00029ab0: 6520 6569 7468 6572 2022 0a20 2020 2020  e either ".     
-00029ac0: 2020 2020 2020 2022 606c 656e 2864 662e         "`len(df.
-00029ad0: 696e 6465 7829 203d 3d20 3060 206f 7220  index) == 0` or 
-00029ae0: 606c 656e 2864 662e 636f 6c75 6d6e 7329  `len(df.columns)
-00029af0: 203d 3d20 3060 220a 2020 2020 2020 2020   == 0`".        
-00029b00: 290a 0a20 2020 2064 6566 205f 5f67 6574  )..    def __get
-00029b10: 6974 656d 5f5f 2873 656c 662c 206b 6579  item__(self, key
-00029b20: 293a 0a20 2020 2020 2020 206e 616d 6520  ):.        name 
-00029b30: 3d20 2267 6574 6974 656d 2d25 7322 2025  = "getitem-%s" %
-00029b40: 2074 6f6b 656e 697a 6528 7365 6c66 2c20   tokenize(self, 
-00029b50: 6b65 7929 0a20 2020 2020 2020 2069 6620  key).        if 
-00029b60: 6e70 2e69 7373 6361 6c61 7228 6b65 7929  np.isscalar(key)
-00029b70: 206f 7220 6973 696e 7374 616e 6365 286b   or isinstance(k
-00029b80: 6579 2c20 2874 7570 6c65 2c20 7374 7229  ey, (tuple, str)
-00029b90: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00029ba0: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
-00029bb0: 662e 5f6d 6574 612e 696e 6465 782c 2028  f._meta.index, (
-00029bc0: 7064 2e44 6174 6574 696d 6549 6e64 6578  pd.DatetimeIndex
-00029bd0: 2c20 7064 2e50 6572 696f 6449 6e64 6578  , pd.PeriodIndex
-00029be0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00029bf0: 2020 2020 6966 206b 6579 206e 6f74 2069      if key not i
-00029c00: 6e20 7365 6c66 2e5f 6d65 7461 2e63 6f6c  n self._meta.col
-00029c10: 756d 6e73 3a0a 2020 2020 2020 2020 2020  umns:.          
-00029c20: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-00029c30: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
-00029c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c50: 2022 496e 6465 7869 6e67 2061 2044 6174   "Indexing a Dat
-00029c60: 6146 7261 6d65 2077 6974 6820 6120 6461  aFrame with a da
-00029c70: 7465 7469 6d65 6c69 6b65 2069 6e64 6578  tetimelike index
-00029c80: 2075 7369 6e67 2061 2073 696e 676c 6520   using a single 
-00029c90: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00029ca0: 2020 2020 2020 2020 2020 2273 7472 696e            "strin
-00029cb0: 6720 746f 2073 6c69 6365 2074 6865 2072  g to slice the r
-00029cc0: 6f77 732c 206c 696b 6520 6066 7261 6d65  ows, like `frame
-00029cd0: 5b73 7472 696e 675d 602c 2069 7320 6465  [string]`, is de
-00029ce0: 7072 6563 6174 6564 2022 0a20 2020 2020  precated ".     
-00029cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d00: 2020 2022 616e 6420 7769 6c6c 2062 6520     "and will be 
-00029d10: 7265 6d6f 7665 6420 696e 2061 2066 7574  removed in a fut
-00029d20: 7572 6520 7665 7273 696f 6e2e 2055 7365  ure version. Use
-00029d30: 2060 6672 616d 652e 6c6f 635b 7374 7269   `frame.loc[stri
-00029d40: 6e67 5d60 2022 0a20 2020 2020 2020 2020  ng]` ".         
-00029d50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00029d60: 696e 7374 6561 642e 222c 0a20 2020 2020  instead.",.     
-00029d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d80: 2020 2046 7574 7572 6557 6172 6e69 6e67     FutureWarning
-00029d90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00029da0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00029db0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00029dc0: 726e 2073 656c 662e 6c6f 635b 6b65 795d  rn self.loc[key]
-00029dd0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00029de0: 6572 726f 7220 6973 2072 6169 7365 6420  error is raised 
-00029df0: 6672 6f6d 2070 616e 6461 730a 2020 2020  from pandas.    
-00029e00: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
-00029e10: 656c 662e 5f6d 6574 615b 5f65 7874 7261  elf._meta[_extra
-00029e20: 6374 5f6d 6574 6128 6b65 7929 5d0a 2020  ct_meta(key)].  
-00029e30: 2020 2020 2020 2020 2020 6473 6b20 3d20            dsk = 
-00029e40: 7061 7274 6974 696f 6e77 6973 655f 6772  partitionwise_gr
-00029e50: 6170 6828 6f70 6572 6174 6f72 2e67 6574  aph(operator.get
-00029e60: 6974 656d 2c20 6e61 6d65 2c20 7365 6c66  item, name, self
-00029e70: 2c20 6b65 7929 0a20 2020 2020 2020 2020  , key).         
-00029e80: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-00029e90: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-00029ea0: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
-00029eb0: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-00029ec0: 6573 3d5b 7365 6c66 5d29 0a20 2020 2020  es=[self]).     
-00029ed0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00029ee0: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
-00029ef0: 682c 206e 616d 652c 206d 6574 612c 2073  h, name, meta, s
-00029f00: 656c 662e 6469 7669 7369 6f6e 7329 0a20  elf.divisions). 
-00029f10: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-00029f20: 7374 616e 6365 286b 6579 2c20 736c 6963  stance(key, slic
-00029f30: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00029f40: 6672 6f6d 2070 616e 6461 732e 6170 692e  from pandas.api.
-00029f50: 7479 7065 7320 696d 706f 7274 2069 735f  types import is_
-00029f60: 666c 6f61 745f 6474 7970 650a 0a20 2020  float_dtype..   
-00029f70: 2020 2020 2020 2020 2069 735f 696e 7465           is_inte
-00029f80: 6765 725f 736c 6963 6520 3d20 616e 7928  ger_slice = any(
-00029f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029fa0: 2069 7369 6e73 7461 6e63 6528 692c 2049   isinstance(i, I
-00029fb0: 6e74 6567 7261 6c29 2066 6f72 2069 2069  ntegral) for i i
-00029fc0: 6e20 286b 6579 2e73 7461 7274 2c20 6b65  n (key.start, ke
-00029fd0: 792e 7374 6570 2c20 6b65 792e 7374 6f70  y.step, key.stop
-00029fe0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-00029ff0: 2020 2020 2020 2020 2020 2020 2320 536c              # Sl
-0002a000: 6963 696e 6720 7769 7468 2069 6e74 6567  icing with integ
-0002a010: 6572 206c 6162 656c 7320 6973 2061 6c77  er labels is alw
-0002a020: 6179 7320 696c 6f63 2062 6173 6564 2065  ays iloc based e
-0002a030: 7863 6570 7420 666f 7220 610a 2020 2020  xcept for a.    
-0002a040: 2020 2020 2020 2020 2320 666c 6f61 7420          # float 
-0002a050: 696e 6465 7865 7220 666f 7220 736f 6d65  indexer for some
-0002a060: 2072 6561 736f 6e0a 2020 2020 2020 2020   reason.        
-0002a070: 2020 2020 6966 2069 735f 696e 7465 6765      if is_intege
-0002a080: 725f 736c 6963 6520 616e 6420 6e6f 7420  r_slice and not 
-0002a090: 6973 5f66 6c6f 6174 5f64 7479 7065 2873  is_float_dtype(s
-0002a0a0: 656c 662e 696e 6465 782e 6474 7970 6529  elf.index.dtype)
-0002a0b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002a0c0: 2020 2320 4e4f 5445 3a20 7468 6973 2061    # NOTE: this a
-0002a0d0: 6c77 6179 7320 6661 696c 7320 6375 7272  lways fails curr
-0002a0e0: 656e 746c 792c 2061 7320 696c 6f63 2069  ently, as iloc i
-0002a0f0: 7320 6d6f 7374 6c79 0a20 2020 2020 2020  s mostly.       
-0002a100: 2020 2020 2020 2020 2023 2075 6e73 7570           # unsup
-0002a110: 706f 7274 6564 2c20 6275 7420 7765 2063  ported, but we c
-0002a120: 616c 6c20 6974 2061 6e79 7761 7920 6865  all it anyway he
-0002a130: 7265 2066 6f72 2066 7574 7572 652d 7072  re for future-pr
-0002a140: 6f6f 6669 6e67 0a20 2020 2020 2020 2020  oofing.         
-0002a150: 2020 2020 2020 2023 2061 6e64 2065 7272         # and err
-0002a160: 6f72 2d61 7474 7269 6275 7469 6f6e 2070  or-attribution p
-0002a170: 7572 706f 7365 730a 2020 2020 2020 2020  urposes.        
-0002a180: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002a190: 656c 662e 696c 6f63 5b6b 6579 5d0a 2020  elf.iloc[key].  
-0002a1a0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0002a1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a1c0: 7265 7475 726e 2073 656c 662e 6c6f 635b  return self.loc[
-0002a1d0: 6b65 795d 0a0a 2020 2020 2020 2020 6966  key]..        if
-0002a1e0: 2069 7369 6e73 7461 6e63 6528 6b65 792c   isinstance(key,
-0002a1f0: 2028 6e70 2e6e 6461 7272 6179 2c20 6c69   (np.ndarray, li
-0002a200: 7374 2929 206f 7220 280a 2020 2020 2020  st)) or (.      
-0002a210: 2020 2020 2020 6e6f 7420 6973 5f64 6173        not is_das
-0002a220: 6b5f 636f 6c6c 6563 7469 6f6e 286b 6579  k_collection(key
-0002a230: 2920 616e 6420 2869 735f 7365 7269 6573  ) and (is_series
-0002a240: 5f6c 696b 6528 6b65 7929 206f 7220 6973  _like(key) or is
-0002a250: 5f69 6e64 6578 5f6c 696b 6528 6b65 7929  _index_like(key)
-0002a260: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
-0002a270: 2020 2020 2020 2020 2023 2065 7272 6f72           # error
-0002a280: 2069 7320 7261 6973 6564 2066 726f 6d20   is raised from 
-0002a290: 7061 6e64 6173 0a20 2020 2020 2020 2020  pandas.         
-0002a2a0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
-0002a2b0: 6d65 7461 5b5f 6578 7472 6163 745f 6d65  meta[_extract_me
-0002a2c0: 7461 286b 6579 295d 0a0a 2020 2020 2020  ta(key)]..      
-0002a2d0: 2020 2020 2020 6473 6b20 3d20 7061 7274        dsk = part
-0002a2e0: 6974 696f 6e77 6973 655f 6772 6170 6828  itionwise_graph(
-0002a2f0: 6f70 6572 6174 6f72 2e67 6574 6974 656d  operator.getitem
-0002a300: 2c20 6e61 6d65 2c20 7365 6c66 2c20 6b65  , name, self, ke
-0002a310: 7929 0a20 2020 2020 2020 2020 2020 2067  y).            g
-0002a320: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-0002a330: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-0002a340: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
-0002a350: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
-0002a360: 7365 6c66 5d29 0a20 2020 2020 2020 2020  self]).         
-0002a370: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
-0002a380: 5f6f 626a 6563 7428 6772 6170 682c 206e  _object(graph, n
-0002a390: 616d 652c 206d 6574 612c 2073 656c 662e  ame, meta, self.
-0002a3a0: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
-0002a3b0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0002a3c0: 286b 6579 2c20 5365 7269 6573 293a 0a20  (key, Series):. 
-0002a3d0: 2020 2020 2020 2020 2020 2023 2064 6f20             # do 
-0002a3e0: 6e6f 7420 7065 7266 6f72 6d20 6475 6d6d  not perform dumm
-0002a3f0: 7920 6361 6c63 756c 6174 696f 6e2c 2061  y calculation, a
-0002a400: 7320 636f 6c75 6d6e 7320 7769 6c6c 206e  s columns will n
-0002a410: 6f74 2062 6520 6368 616e 6765 642e 0a20  ot be changed.. 
-0002a420: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0002a430: 6c66 2e64 6976 6973 696f 6e73 2021 3d20  lf.divisions != 
-0002a440: 6b65 792e 6469 7669 7369 6f6e 733a 0a20  key.divisions:. 
-0002a450: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0002a460: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-0002a470: 6d65 2e6d 756c 7469 2069 6d70 6f72 7420  me.multi import 
-0002a480: 5f6d 6179 6265 5f61 6c69 676e 5f70 6172  _maybe_align_par
-0002a490: 7469 7469 6f6e 730a 0a20 2020 2020 2020  titions..       
-0002a4a0: 2020 2020 2020 2020 2073 656c 662c 206b           self, k
-0002a4b0: 6579 203d 205f 6d61 7962 655f 616c 6967  ey = _maybe_alig
-0002a4c0: 6e5f 7061 7274 6974 696f 6e73 285b 7365  n_partitions([se
-0002a4d0: 6c66 2c20 6b65 795d 290a 2020 2020 2020  lf, key]).      
-0002a4e0: 2020 2020 2020 6473 6b20 3d20 7061 7274        dsk = part
-0002a4f0: 6974 696f 6e77 6973 655f 6772 6170 6828  itionwise_graph(
-0002a500: 6f70 6572 6174 6f72 2e67 6574 6974 656d  operator.getitem
-0002a510: 2c20 6e61 6d65 2c20 7365 6c66 2c20 6b65  , name, self, ke
-0002a520: 7929 0a20 2020 2020 2020 2020 2020 2067  y).            g
-0002a530: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-0002a540: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-0002a550: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
-0002a560: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
-0002a570: 7365 6c66 2c20 6b65 795d 290a 2020 2020  self, key]).    
-0002a580: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-0002a590: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
-0002a5a0: 7068 2c20 6e61 6d65 2c20 7365 6c66 2c20  ph, name, self, 
-0002a5b0: 7365 6c66 2e64 6976 6973 696f 6e73 290a  self.divisions).
-0002a5c0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0002a5d0: 7461 6e63 6528 6b65 792c 2044 6174 6146  tance(key, DataF
-0002a5e0: 7261 6d65 293a 0a20 2020 2020 2020 2020  rame):.         
-0002a5f0: 2020 2072 6574 7572 6e20 7365 6c66 2e77     return self.w
-0002a600: 6865 7265 286b 6579 2c20 6e70 2e6e 616e  here(key, np.nan
-0002a610: 290a 0a20 2020 2020 2020 2072 6169 7365  )..        raise
-0002a620: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-0002a630: 7272 6f72 286b 6579 290a 0a20 2020 2064  rror(key)..    d
-0002a640: 6566 205f 5f73 6574 6974 656d 5f5f 2873  ef __setitem__(s
-0002a650: 656c 662c 206b 6579 2c20 7661 6c75 6529  elf, key, value)
-0002a660: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
-0002a670: 6e73 7461 6e63 6528 6b65 792c 2028 7475  nstance(key, (tu
-0002a680: 706c 652c 206c 6973 7429 2920 616e 6420  ple, list)) and 
-0002a690: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
-0002a6a0: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
-0002a6b0: 2020 2020 2020 2020 2020 6466 203d 2073            df = s
-0002a6c0: 656c 662e 6173 7369 676e 282a 2a7b 6b3a  elf.assign(**{k:
-0002a6d0: 2076 616c 7565 5b63 5d20 666f 7220 6b2c   value[c] for k,
-0002a6e0: 2063 2069 6e20 7a69 7028 6b65 792c 2076   c in zip(key, v
-0002a6f0: 616c 7565 2e63 6f6c 756d 6e73 297d 290a  alue.columns)}).
-0002a700: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
-0002a710: 696e 7374 616e 6365 286b 6579 2c20 7064  instance(key, pd
-0002a720: 2e49 6e64 6578 2920 616e 6420 6e6f 7420  .Index) and not 
-0002a730: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
-0002a740: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
-0002a750: 2020 2020 2020 2020 2020 6b65 7920 3d20            key = 
-0002a760: 6c69 7374 286b 6579 290a 2020 2020 2020  list(key).      
-0002a770: 2020 2020 2020 6466 203d 2073 656c 662e        df = self.
-0002a780: 6173 7369 676e 282a 2a7b 6b3a 2076 616c  assign(**{k: val
-0002a790: 7565 2066 6f72 206b 2069 6e20 6b65 797d  ue for k in key}
-0002a7a0: 290a 2020 2020 2020 2020 656c 6966 2028  ).        elif (
-0002a7b0: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
-0002a7c0: 6461 7461 6672 616d 655f 6c69 6b65 286b  dataframe_like(k
-0002a7d0: 6579 290a 2020 2020 2020 2020 2020 2020  ey).            
-0002a7e0: 6f72 2069 735f 7365 7269 6573 5f6c 696b  or is_series_lik
-0002a7f0: 6528 6b65 7929 0a20 2020 2020 2020 2020  e(key).         
-0002a800: 2020 206f 7220 6973 696e 7374 616e 6365     or isinstance
-0002a810: 286b 6579 2c20 2844 6174 6146 7261 6d65  (key, (DataFrame
-0002a820: 2c20 5365 7269 6573 2929 0a20 2020 2020  , Series)).     
-0002a830: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-0002a840: 2020 6466 203d 2073 656c 662e 7768 6572    df = self.wher
-0002a850: 6528 7e6b 6579 2c20 7661 6c75 6529 0a20  e(~key, value). 
-0002a860: 2020 2020 2020 2065 6c69 6620 6e6f 7420         elif not 
-0002a870: 6973 696e 7374 616e 6365 286b 6579 2c20  isinstance(key, 
-0002a880: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
-0002a890: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-0002a8a0: 6d65 6e74 6564 4572 726f 7228 6622 4974  mentedError(f"It
-0002a8b0: 656d 2061 7373 6967 6e6d 656e 7420 7769  em assignment wi
-0002a8c0: 7468 207b 7479 7065 286b 6579 297d 206e  th {type(key)} n
-0002a8d0: 6f74 2073 7570 706f 7274 6564 2229 0a20  ot supported"). 
-0002a8e0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002a8f0: 2020 2020 2020 2020 2064 6620 3d20 7365           df = se
-0002a900: 6c66 2e61 7373 6967 6e28 2a2a 7b6b 6579  lf.assign(**{key
-0002a910: 3a20 7661 6c75 657d 290a 0a20 2020 2020  : value})..     
-0002a920: 2020 2073 656c 662e 6461 736b 203d 2064     self.dask = d
-0002a930: 662e 6461 736b 0a20 2020 2020 2020 2073  f.dask.        s
-0002a940: 656c 662e 5f6e 616d 6520 3d20 6466 2e5f  elf._name = df._
-0002a950: 6e61 6d65 0a20 2020 2020 2020 2073 656c  name.        sel
-0002a960: 662e 5f6d 6574 6120 3d20 6466 2e5f 6d65  f._meta = df._me
-0002a970: 7461 0a20 2020 2020 2020 2073 656c 662e  ta.        self.
-0002a980: 5f64 6976 6973 696f 6e73 203d 2064 662e  _divisions = df.
-0002a990: 6469 7669 7369 6f6e 730a 0a20 2020 2064  divisions..    d
-0002a9a0: 6566 205f 5f64 656c 6974 656d 5f5f 2873  ef __delitem__(s
-0002a9b0: 656c 662c 206b 6579 293a 0a20 2020 2020  elf, key):.     
-0002a9c0: 2020 2072 6573 756c 7420 3d20 7365 6c66     result = self
-0002a9d0: 2e64 726f 7028 5b6b 6579 5d2c 2061 7869  .drop([key], axi
-0002a9e0: 733d 3129 0a20 2020 2020 2020 2073 656c  s=1).        sel
-0002a9f0: 662e 6461 736b 203d 2072 6573 756c 742e  f.dask = result.
-0002aa00: 6461 736b 0a20 2020 2020 2020 2073 656c  dask.        sel
-0002aa10: 662e 5f6e 616d 6520 3d20 7265 7375 6c74  f._name = result
-0002aa20: 2e5f 6e61 6d65 0a20 2020 2020 2020 2073  ._name.        s
-0002aa30: 656c 662e 5f6d 6574 6120 3d20 7265 7375  elf._meta = resu
-0002aa40: 6c74 2e5f 6d65 7461 0a0a 2020 2020 6465  lt._meta..    de
-0002aa50: 6620 5f5f 7365 7461 7474 725f 5f28 7365  f __setattr__(se
-0002aa60: 6c66 2c20 6b65 792c 2076 616c 7565 293a  lf, key, value):
-0002aa70: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
-0002aa80: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-0002aa90: 7320 3d20 6f62 6a65 6374 2e5f 5f67 6574  s = object.__get
-0002aaa0: 6174 7472 6962 7574 655f 5f28 7365 6c66  attribute__(self
-0002aab0: 2c20 225f 6d65 7461 2229 2e63 6f6c 756d  , "_meta").colum
-0002aac0: 6e73 0a20 2020 2020 2020 2065 7863 6570  ns.        excep
-0002aad0: 7420 4174 7472 6962 7574 6545 7272 6f72  t AttributeError
-0002aae0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-0002aaf0: 6c75 6d6e 7320 3d20 2829 0a0a 2020 2020  lumns = ()..    
-0002ab00: 2020 2020 2320 6578 636c 7564 6520 7072      # exclude pr
-0002ab10: 6f74 6563 7465 6420 6174 7472 6962 7574  otected attribut
-0002ab20: 6573 2066 726f 6d20 7365 7469 7465 6d0a  es from setitem.
-0002ab30: 2020 2020 2020 2020 6966 206b 6579 2069          if key i
-0002ab40: 6e20 636f 6c75 6d6e 7320 616e 6420 6b65  n columns and ke
-0002ab50: 7920 6e6f 7420 696e 205b 2264 6976 6973  y not in ["divis
-0002ab60: 696f 6e73 222c 2022 6461 736b 222c 2022  ions", "dask", "
-0002ab70: 5f6e 616d 6522 2c20 225f 6d65 7461 225d  _name", "_meta"]
-0002ab80: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0002ab90: 6c66 5b6b 6579 5d20 3d20 7661 6c75 650a  lf[key] = value.
-0002aba0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002abb0: 2020 2020 2020 2020 2020 6f62 6a65 6374            object
-0002abc0: 2e5f 5f73 6574 6174 7472 5f5f 2873 656c  .__setattr__(sel
-0002abd0: 662c 206b 6579 2c20 7661 6c75 6529 0a0a  f, key, value)..
-0002abe0: 2020 2020 6465 6620 5f5f 6765 7461 7474      def __getatt
-0002abf0: 725f 5f28 7365 6c66 2c20 6b65 7929 3a0a  r__(self, key):.
-0002ac00: 2020 2020 2020 2020 6966 206b 6579 2069          if key i
-0002ac10: 6e20 7365 6c66 2e63 6f6c 756d 6e73 3a0a  n self.columns:.
-0002ac20: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0002ac30: 726e 2073 656c 665b 6b65 795d 0a20 2020  rn self[key].   
-0002ac40: 2020 2020 2065 6c69 6620 6b65 7920 3d3d       elif key ==
-0002ac50: 2022 656d 7074 7922 3a0a 2020 2020 2020   "empty":.      
-0002ac60: 2020 2020 2020 2320 7365 6c66 2e65 6d70        # self.emp
-0002ac70: 7479 2072 6169 7365 7320 4174 7472 6962  ty raises Attrib
-0002ac80: 7574 654e 6f74 496d 706c 656d 656e 7465  uteNotImplemente
-0002ac90: 6445 7272 6f72 2c20 7768 6963 6820 696e  dError, which in
-0002aca0: 636c 7564 6573 0a20 2020 2020 2020 2020  cludes.         
-0002acb0: 2020 2023 2041 7474 7269 6275 7465 4572     # AttributeEr
-0002acc0: 726f 722c 2077 6869 6368 206d 6561 6e73  ror, which means
-0002acd0: 2077 6520 656e 6420 7570 2068 6572 6520   we end up here 
-0002ace0: 696e 2073 656c 662e 5f5f 6765 7461 7474  in self.__getatt
-0002acf0: 725f 5f2c 0a20 2020 2020 2020 2020 2020  r__,.           
-0002ad00: 2023 2062 6563 6175 7365 2044 6174 6146   # because DataF
-0002ad10: 7261 6d65 2e5f 5f67 6574 6174 7472 6962  rame.__getattrib
-0002ad20: 7574 655f 5f20 646f 6573 6e27 7420 7468  ute__ doesn't th
-0002ad30: 696e 6b20 7468 6520 6174 7472 6962 7574  ink the attribut
-0002ad40: 6520 6578 6973 7473 0a20 2020 2020 2020  e exists.       
-0002ad50: 2020 2020 2023 2061 6e64 2075 7365 7320       # and uses 
-0002ad60: 5f5f 6765 7461 7474 725f 5f20 6173 2074  __getattr__ as t
-0002ad70: 6865 2066 616c 6c62 6163 6b2e 2053 6f2c  he fallback. So,
-0002ad80: 2067 6574 2060 7365 6c66 2e65 6d70 7479   get `self.empty
-0002ad90: 6020 6d6f 7265 0a20 2020 2020 2020 2020  ` more.         
-0002ada0: 2020 2023 2066 6f72 6365 6675 6c6c 7920     # forcefully 
-0002adb0: 7669 6120 6f62 6a65 6374 2e5f 5f67 6574  via object.__get
-0002adc0: 6174 7472 6962 7574 655f 5f20 746f 2072  attribute__ to r
-0002add0: 6169 7365 2069 6e66 6f72 6d61 7469 7665  aise informative
-0002ade0: 2065 7272 6f72 2e0a 2020 2020 2020 2020   error..        
-0002adf0: 2020 2020 6f62 6a65 6374 2e5f 5f67 6574      object.__get
-0002ae00: 6174 7472 6962 7574 655f 5f28 7365 6c66  attribute__(self
-0002ae10: 2c20 6b65 7929 0a20 2020 2020 2020 2065  , key).        e
-0002ae20: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0002ae30: 2072 6169 7365 2041 7474 7269 6275 7465   raise Attribute
-0002ae40: 4572 726f 7228 2227 4461 7461 4672 616d  Error("'DataFram
-0002ae50: 6527 206f 626a 6563 7420 6861 7320 6e6f  e' object has no
-0002ae60: 2061 7474 7269 6275 7465 2025 7222 2025   attribute %r" %
-0002ae70: 206b 6579 290a 0a20 2020 2064 6566 205f   key)..    def _
-0002ae80: 5f64 6972 5f5f 2873 656c 6629 3a0a 2020  _dir__(self):.  
-0002ae90: 2020 2020 2020 6f20 3d20 7365 7428 6469        o = set(di
-0002aea0: 7228 7479 7065 2873 656c 6629 2929 0a20  r(type(self))). 
-0002aeb0: 2020 2020 2020 206f 2e75 7064 6174 6528         o.update(
-0002aec0: 7365 6c66 2e5f 5f64 6963 745f 5f29 0a20  self.__dict__). 
-0002aed0: 2020 2020 2020 206f 2e75 7064 6174 6528         o.update(
-0002aee0: 6320 666f 7220 6320 696e 2073 656c 662e  c for c in self.
-0002aef0: 636f 6c75 6d6e 7320 6966 2028 6973 696e  columns if (isin
-0002af00: 7374 616e 6365 2863 2c20 7374 7229 2061  stance(c, str) a
-0002af10: 6e64 2063 2e69 7369 6465 6e74 6966 6965  nd c.isidentifie
-0002af20: 7228 2929 290a 2020 2020 2020 2020 7265  r())).        re
-0002af30: 7475 726e 206c 6973 7428 6f29 0a0a 2020  turn list(o)..  
-0002af40: 2020 6465 6620 5f5f 6974 6572 5f5f 2873    def __iter__(s
-0002af50: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-0002af60: 7475 726e 2069 7465 7228 7365 6c66 2e5f  turn iter(self._
-0002af70: 6d65 7461 290a 0a20 2020 2064 6566 205f  meta)..    def _
-0002af80: 6970 7974 686f 6e5f 6b65 795f 636f 6d70  ipython_key_comp
-0002af90: 6c65 7469 6f6e 735f 2873 656c 6629 3a0a  letions_(self):.
-0002afa0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-0002afb0: 6574 686f 6473 2e74 6f6c 6973 7428 7365  ethods.tolist(se
-0002afc0: 6c66 2e63 6f6c 756d 6e73 290a 0a20 2020  lf.columns)..   
-0002afd0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0002afe0: 6566 206e 6469 6d28 7365 6c66 293a 0a20  ef ndim(self):. 
-0002aff0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-0002b000: 2064 696d 656e 7369 6f6e 616c 6974 7922   dimensionality"
-0002b010: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-0002b020: 6e20 320a 0a20 2020 2040 7072 6f70 6572  n 2..    @proper
-0002b030: 7479 0a20 2020 2064 6566 2073 6861 7065  ty.    def shape
-0002b040: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0002b050: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
-0002b060: 726e 2061 2074 7570 6c65 2072 6570 7265  rn a tuple repre
-0002b070: 7365 6e74 696e 6720 7468 6520 6469 6d65  senting the dime
-0002b080: 6e73 696f 6e61 6c69 7479 206f 6620 7468  nsionality of th
-0002b090: 6520 4461 7461 4672 616d 652e 0a0a 2020  e DataFrame...  
-0002b0a0: 2020 2020 2020 5468 6520 6e75 6d62 6572        The number
-0002b0b0: 206f 6620 726f 7773 2069 7320 6120 4465   of rows is a De
-0002b0c0: 6c61 7965 6420 7265 7375 6c74 2e20 5468  layed result. Th
-0002b0d0: 6520 6e75 6d62 6572 206f 6620 636f 6c75  e number of colu
-0002b0e0: 6d6e 730a 2020 2020 2020 2020 6973 2061  mns.        is a
-0002b0f0: 2063 6f6e 6372 6574 6520 696e 7465 6765   concrete intege
-0002b100: 722e 0a0a 2020 2020 2020 2020 4578 616d  r...        Exam
-0002b110: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
-0002b120: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
-0002b130: 3e20 6466 2e73 697a 6520 2023 2064 6f63  > df.size  # doc
-0002b140: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
-0002b150: 2020 2020 2844 656c 6179 6564 2827 696e      (Delayed('in
-0002b160: 742d 3037 6630 3630 3735 2d35 6563 632d  t-07f06075-5ecc-
-0002b170: 3464 3737 2d38 3137 652d 3633 6336 3961  4d77-817e-63c69a
-0002b180: 3931 3838 6138 2729 2c20 3229 0a20 2020  9188a8'), 2).   
-0002b190: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002b1a0: 2063 6f6c 5f73 697a 6520 3d20 6c65 6e28   col_size = len(
-0002b1b0: 7365 6c66 2e63 6f6c 756d 6e73 290a 2020  self.columns).  
-0002b1c0: 2020 2020 2020 6966 2063 6f6c 5f73 697a        if col_siz
-0002b1d0: 6520 3d3d 2030 3a0a 2020 2020 2020 2020  e == 0:.        
-0002b1e0: 2020 2020 7265 7475 726e 2028 7365 6c66      return (self
-0002b1f0: 2e69 6e64 6578 2e73 6861 7065 5b30 5d2c  .index.shape[0],
-0002b200: 2030 290a 2020 2020 2020 2020 726f 775f   0).        row_
-0002b210: 7369 7a65 203d 2064 656c 6179 6564 2869  size = delayed(i
-0002b220: 6e74 2928 7365 6c66 2e73 697a 6520 2f20  nt)(self.size / 
-0002b230: 636f 6c5f 7369 7a65 290a 2020 2020 2020  col_size).      
-0002b240: 2020 7265 7475 726e 2028 726f 775f 7369    return (row_si
-0002b250: 7a65 2c20 636f 6c5f 7369 7a65 290a 0a20  ze, col_size).. 
-0002b260: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0002b270: 2064 6566 2064 7479 7065 7328 7365 6c66   def dtypes(self
-0002b280: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-0002b290: 7475 726e 2064 6174 6120 7479 7065 7322  turn data types"
-0002b2a0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-0002b2b0: 6e20 7365 6c66 2e5f 6d65 7461 2e64 7479  n self._meta.dty
-0002b2c0: 7065 730a 0a20 2020 2040 6465 7269 7665  pes..    @derive
-0002b2d0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-0002b2e0: 616d 6529 0a20 2020 2064 6566 2067 6574  ame).    def get
-0002b2f0: 5f64 7479 7065 5f63 6f75 6e74 7328 7365  _dtype_counts(se
-0002b300: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-0002b310: 7572 6e20 7365 6c66 2e5f 6d65 7461 2e67  urn self._meta.g
-0002b320: 6574 5f64 7479 7065 5f63 6f75 6e74 7328  et_dtype_counts(
-0002b330: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-0002b340: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-0002b350: 6529 0a20 2020 2064 6566 2067 6574 5f66  e).    def get_f
-0002b360: 7479 7065 5f63 6f75 6e74 7328 7365 6c66  type_counts(self
-0002b370: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0002b380: 6e20 7365 6c66 2e5f 6d65 7461 2e67 6574  n self._meta.get
-0002b390: 5f66 7479 7065 5f63 6f75 6e74 7328 290a  _ftype_counts().
-0002b3a0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0002b3b0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0002b3c0: 0a20 2020 2064 6566 2073 656c 6563 745f  .    def select_
-0002b3d0: 6474 7970 6573 2873 656c 662c 2069 6e63  dtypes(self, inc
-0002b3e0: 6c75 6465 3d4e 6f6e 652c 2065 7863 6c75  lude=None, exclu
-0002b3f0: 6465 3d4e 6f6e 6529 3a0a 2020 2020 2020  de=None):.      
-0002b400: 2020 6373 203d 2073 656c 662e 5f6d 6574    cs = self._met
-0002b410: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
-0002b420: 696e 636c 7564 653d 696e 636c 7564 652c  include=include,
-0002b430: 2065 7863 6c75 6465 3d65 7863 6c75 6465   exclude=exclude
-0002b440: 292e 636f 6c75 6d6e 730a 2020 2020 2020  ).columns.      
-0002b450: 2020 7265 7475 726e 2073 656c 665b 6c69    return self[li
-0002b460: 7374 2863 7329 5d0a 0a20 2020 2064 6566  st(cs)]..    def
-0002b470: 2073 6f72 745f 7661 6c75 6573 280a 2020   sort_values(.  
-0002b480: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0002b490: 2020 2020 6279 3a20 7374 7220 7c20 6c69      by: str | li
-0002b4a0: 7374 5b73 7472 5d2c 0a20 2020 2020 2020  st[str],.       
-0002b4b0: 206e 7061 7274 6974 696f 6e73 3a20 696e   npartitions: in
-0002b4c0: 7420 7c20 4c69 7465 7261 6c5b 2261 7574  t | Literal["aut
-0002b4d0: 6f22 5d20 7c20 4e6f 6e65 203d 204e 6f6e  o"] | None = Non
-0002b4e0: 652c 0a20 2020 2020 2020 2061 7363 656e  e,.        ascen
-0002b4f0: 6469 6e67 3a20 626f 6f6c 203d 2054 7275  ding: bool = Tru
-0002b500: 652c 0a20 2020 2020 2020 206e 615f 706f  e,.        na_po
-0002b510: 7369 7469 6f6e 3a20 4c69 7465 7261 6c5b  sition: Literal[
-0002b520: 2266 6972 7374 225d 207c 204c 6974 6572  "first"] | Liter
-0002b530: 616c 5b22 6c61 7374 225d 203d 2022 6c61  al["last"] = "la
-0002b540: 7374 222c 0a20 2020 2020 2020 2073 6f72  st",.        sor
-0002b550: 745f 6675 6e63 7469 6f6e 3a20 4361 6c6c  t_function: Call
-0002b560: 6162 6c65 5b5b 7064 2e44 6174 6146 7261  able[[pd.DataFra
-0002b570: 6d65 5d2c 2070 642e 4461 7461 4672 616d  me], pd.DataFram
-0002b580: 655d 207c 204e 6f6e 6520 3d20 4e6f 6e65  e] | None = None
-0002b590: 2c0a 2020 2020 2020 2020 736f 7274 5f66  ,.        sort_f
-0002b5a0: 756e 6374 696f 6e5f 6b77 6172 6773 3a20  unction_kwargs: 
-0002b5b0: 4d61 7070 696e 675b 7374 722c 2041 6e79  Mapping[str, Any
-0002b5c0: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
-0002b5d0: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-0002b5e0: 732c 0a20 2020 2029 202d 3e20 4461 7461  s,.    ) -> Data
-0002b5f0: 4672 616d 653a 0a20 2020 2020 2020 2022  Frame:.        "
-0002b600: 2222 536f 7274 2074 6865 2064 6174 6173  ""Sort the datas
-0002b610: 6574 2062 7920 6120 7369 6e67 6c65 2063  et by a single c
-0002b620: 6f6c 756d 6e2e 0a0a 2020 2020 2020 2020  olumn...        
-0002b630: 536f 7274 696e 6720 6120 7061 7261 6c6c  Sorting a parall
-0002b640: 656c 2064 6174 6173 6574 2072 6571 7569  el dataset requi
-0002b650: 7265 7320 6578 7065 6e73 6976 6520 7368  res expensive sh
-0002b660: 7566 666c 6573 2061 6e64 2069 7320 6765  uffles and is ge
-0002b670: 6e65 7261 6c6c 790a 2020 2020 2020 2020  nerally.        
-0002b680: 6e6f 7420 7265 636f 6d6d 656e 6465 642e  not recommended.
-0002b690: 2053 6565 2060 6073 6574 5f69 6e64 6578   See ``set_index
-0002b6a0: 6060 2066 6f72 2069 6d70 6c65 6d65 6e74  `` for implement
-0002b6b0: 6174 696f 6e20 6465 7461 696c 732e 0a0a  ation details...
-0002b6c0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0002b6d0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0002b6e0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6279  -----.        by
-0002b6f0: 3a20 7374 7220 6f72 206c 6973 745b 7374  : str or list[st
-0002b700: 725d 0a20 2020 2020 2020 2020 2020 2043  r].            C
-0002b710: 6f6c 756d 6e28 7329 2074 6f20 736f 7274  olumn(s) to sort
-0002b720: 2062 792e 0a20 2020 2020 2020 206e 7061   by..        npa
-0002b730: 7274 6974 696f 6e73 3a20 696e 742c 204e  rtitions: int, N
-0002b740: 6f6e 652c 206f 7220 2761 7574 6f27 0a20  one, or 'auto'. 
-0002b750: 2020 2020 2020 2020 2020 2054 6865 2069             The i
-0002b760: 6465 616c 206e 756d 6265 7220 6f66 206f  deal number of o
-0002b770: 7574 7075 7420 7061 7274 6974 696f 6e73  utput partitions
-0002b780: 2e20 4966 204e 6f6e 652c 2075 7365 2074  . If None, use t
-0002b790: 6865 2073 616d 6520 6173 0a20 2020 2020  he same as.     
-0002b7a0: 2020 2020 2020 2074 6865 2069 6e70 7574         the input
-0002b7b0: 2e20 4966 2027 6175 746f 2720 7468 656e  . If 'auto' then
-0002b7c0: 2064 6563 6964 6520 6279 206d 656d 6f72   decide by memor
-0002b7d0: 7920 7573 652e 0a20 2020 2020 2020 2061  y use..        a
-0002b7e0: 7363 656e 6469 6e67 3a20 626f 6f6c 2c20  scending: bool, 
-0002b7f0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-0002b800: 2020 2020 2053 6f72 7420 6173 6365 6e64       Sort ascend
-0002b810: 696e 6720 7673 2e20 6465 7363 656e 6469  ing vs. descendi
-0002b820: 6e67 2e0a 2020 2020 2020 2020 2020 2020  ng..            
-0002b830: 4465 6661 756c 7473 2074 6f20 5472 7565  Defaults to True
-0002b840: 2e0a 2020 2020 2020 2020 6e61 5f70 6f73  ..        na_pos
-0002b850: 6974 696f 6e3a 207b 276c 6173 7427 2c20  ition: {'last', 
-0002b860: 2766 6972 7374 277d 2c20 6f70 7469 6f6e  'first'}, option
-0002b870: 616c 0a20 2020 2020 2020 2020 2020 2050  al.            P
-0002b880: 7574 7320 4e61 4e73 2061 7420 7468 6520  uts NaNs at the 
-0002b890: 6265 6769 6e6e 696e 6720 6966 2027 6669  beginning if 'fi
-0002b8a0: 7273 7427 2c20 7075 7473 204e 614e 2061  rst', puts NaN a
-0002b8b0: 7420 7468 6520 656e 6420 6966 2027 6c61  t the end if 'la
-0002b8c0: 7374 272e 0a20 2020 2020 2020 2020 2020  st'..           
-0002b8d0: 2044 6566 6175 6c74 7320 746f 2027 6c61   Defaults to 'la
-0002b8e0: 7374 272e 0a20 2020 2020 2020 2073 6f72  st'..        sor
-0002b8f0: 745f 6675 6e63 7469 6f6e 3a20 6675 6e63  t_function: func
-0002b900: 7469 6f6e 2c20 6f70 7469 6f6e 616c 0a20  tion, optional. 
-0002b910: 2020 2020 2020 2020 2020 2053 6f72 7469             Sorti
-0002b920: 6e67 2066 756e 6374 696f 6e20 746f 2075  ng function to u
-0002b930: 7365 2077 6865 6e20 736f 7274 696e 6720  se when sorting 
-0002b940: 756e 6465 726c 7969 6e67 2070 6172 7469  underlying parti
-0002b950: 7469 6f6e 732e 0a20 2020 2020 2020 2020  tions..         
-0002b960: 2020 2049 6620 4e6f 6e65 2c20 6465 6661     If None, defa
-0002b970: 756c 7473 2074 6f20 6060 4d2e 736f 7274  ults to ``M.sort
-0002b980: 5f76 616c 7565 7360 6020 2874 6865 2070  _values`` (the p
-0002b990: 6172 7469 7469 6f6e 206c 6962 7261 7279  artition library
-0002b9a0: 2773 0a20 2020 2020 2020 2020 2020 2069  's.            i
-0002b9b0: 6d70 6c65 6d65 6e74 6174 696f 6e20 6f66  mplementation of
-0002b9c0: 2060 6073 6f72 745f 7661 6c75 6573 6060   ``sort_values``
-0002b9d0: 292e 0a20 2020 2020 2020 2073 6f72 745f  )..        sort_
-0002b9e0: 6675 6e63 7469 6f6e 5f6b 7761 7267 733a  function_kwargs:
-0002b9f0: 2064 6963 742c 206f 7074 696f 6e61 6c0a   dict, optional.
-0002ba00: 2020 2020 2020 2020 2020 2020 4164 6469              Addi
-0002ba10: 7469 6f6e 616c 206b 6579 776f 7264 2061  tional keyword a
-0002ba20: 7267 756d 656e 7473 2074 6f20 7061 7373  rguments to pass
-0002ba30: 2074 6f20 7468 6520 7061 7274 6974 696f   to the partitio
-0002ba40: 6e20 736f 7274 696e 6720 6675 6e63 7469  n sorting functi
-0002ba50: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
-0002ba60: 4279 2064 6566 6175 6c74 2c20 6060 6279  By default, ``by
-0002ba70: 6060 2c20 6060 6173 6365 6e64 696e 6760  ``, ``ascending`
-0002ba80: 602c 2061 6e64 2060 606e 615f 706f 7369  `, and ``na_posi
-0002ba90: 7469 6f6e 6060 2061 7265 2070 726f 7669  tion`` are provi
-0002baa0: 6465 642e 0a0a 2020 2020 2020 2020 4578  ded...        Ex
-0002bab0: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
-0002bac0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0002bad0: 3e3e 3e20 6466 3220 3d20 6466 2e73 6f72  >>> df2 = df.sor
-0002bae0: 745f 7661 6c75 6573 2827 7827 2920 2023  t_values('x')  #
-0002baf0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-0002bb00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002bb10: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-0002bb20: 7461 6672 616d 652e 7368 7566 666c 6520  taframe.shuffle 
-0002bb30: 696d 706f 7274 2073 6f72 745f 7661 6c75  import sort_valu
-0002bb40: 6573 0a0a 2020 2020 2020 2020 7265 7475  es..        retu
-0002bb50: 726e 2073 6f72 745f 7661 6c75 6573 280a  rn sort_values(.
-0002bb60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002bb70: 2c0a 2020 2020 2020 2020 2020 2020 6279  ,.            by
-0002bb80: 2c0a 2020 2020 2020 2020 2020 2020 6173  ,.            as
-0002bb90: 6365 6e64 696e 673d 6173 6365 6e64 696e  cending=ascendin
-0002bba0: 672c 0a20 2020 2020 2020 2020 2020 206e  g,.            n
-0002bbb0: 7061 7274 6974 696f 6e73 3d6e 7061 7274  partitions=npart
-0002bbc0: 6974 696f 6e73 2c0a 2020 2020 2020 2020  itions,.        
-0002bbd0: 2020 2020 6e61 5f70 6f73 6974 696f 6e3d      na_position=
-0002bbe0: 6e61 5f70 6f73 6974 696f 6e2c 0a20 2020  na_position,.   
-0002bbf0: 2020 2020 2020 2020 2073 6f72 745f 6675           sort_fu
-0002bc00: 6e63 7469 6f6e 3d73 6f72 745f 6675 6e63  nction=sort_func
-0002bc10: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-0002bc20: 2020 736f 7274 5f66 756e 6374 696f 6e5f    sort_function_
-0002bc30: 6b77 6172 6773 3d73 6f72 745f 6675 6e63  kwargs=sort_func
-0002bc40: 7469 6f6e 5f6b 7761 7267 732c 0a20 2020  tion_kwargs,.   
-0002bc50: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
-0002bc60: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
-0002bc70: 2020 6465 6620 7365 745f 696e 6465 7828    def set_index(
-0002bc80: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0002bc90: 2020 2020 2020 206f 7468 6572 3a20 7374         other: st
-0002bca0: 7220 7c20 5365 7269 6573 2c0a 2020 2020  r | Series,.    
-0002bcb0: 2020 2020 6472 6f70 3a20 626f 6f6c 203d      drop: bool =
-0002bcc0: 2054 7275 652c 0a20 2020 2020 2020 2073   True,.        s
-0002bcd0: 6f72 7465 643a 2062 6f6f 6c20 3d20 4661  orted: bool = Fa
-0002bce0: 6c73 652c 0a20 2020 2020 2020 206e 7061  lse,.        npa
-0002bcf0: 7274 6974 696f 6e73 3a20 696e 7420 7c20  rtitions: int | 
-0002bd00: 4c69 7465 7261 6c5b 2261 7574 6f22 5d20  Literal["auto"] 
-0002bd10: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-0002bd20: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
-0002bd30: 3a20 5365 7175 656e 6365 207c 204e 6f6e  : Sequence | Non
-0002bd40: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-0002bd50: 2020 696e 706c 6163 653a 2062 6f6f 6c20    inplace: bool 
-0002bd60: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
-0002bd70: 202a 2a6b 7761 7267 732c 0a20 2020 2029   **kwargs,.    )
-0002bd80: 3a0a 2020 2020 2020 2020 2222 2253 6574  :.        """Set
-0002bd90: 2074 6865 2044 6174 6146 7261 6d65 2069   the DataFrame i
-0002bda0: 6e64 6578 2028 726f 7720 6c61 6265 6c73  ndex (row labels
-0002bdb0: 2920 7573 696e 6720 616e 2065 7869 7374  ) using an exist
-0002bdc0: 696e 6720 636f 6c75 6d6e 2e0a 0a20 2020  ing column...   
-0002bdd0: 2020 2020 2054 6869 7320 7265 616c 6967       This realig
-0002bde0: 6e73 2074 6865 2064 6174 6173 6574 2074  ns the dataset t
-0002bdf0: 6f20 6265 2073 6f72 7465 6420 6279 2061  o be sorted by a
-0002be00: 206e 6577 2063 6f6c 756d 6e2e 2054 6869   new column. Thi
-0002be10: 7320 6361 6e20 6861 7665 2061 0a20 2020  s can have a.   
-0002be20: 2020 2020 2073 6967 6e69 6669 6361 6e74       significant
-0002be30: 2069 6d70 6163 7420 6f6e 2070 6572 666f   impact on perfo
-0002be40: 726d 616e 6365 2c20 6265 6361 7573 6520  rmance, because 
-0002be50: 6a6f 696e 732c 2067 726f 7570 6279 732c  joins, groupbys,
-0002be60: 206c 6f6f 6b75 7073 2c20 6574 632e 0a20   lookups, etc.. 
-0002be70: 2020 2020 2020 2061 7265 2061 6c6c 206d         are all m
-0002be80: 7563 6820 6661 7374 6572 206f 6e20 7468  uch faster on th
-0002be90: 6174 2063 6f6c 756d 6e2e 2048 6f77 6576  at column. Howev
-0002bea0: 6572 2c20 7468 6973 2070 6572 666f 726d  er, this perform
-0002beb0: 616e 6365 2069 6e63 7265 6173 650a 2020  ance increase.  
-0002bec0: 2020 2020 2020 636f 6d65 7320 7769 7468        comes with
-0002bed0: 2061 2063 6f73 742c 2073 6f72 7469 6e67   a cost, sorting
-0002bee0: 2061 2070 6172 616c 6c65 6c20 6461 7461   a parallel data
-0002bef0: 7365 7420 7265 7175 6972 6573 2065 7870  set requires exp
-0002bf00: 656e 7369 7665 2073 6875 6666 6c65 732e  ensive shuffles.
-0002bf10: 0a20 2020 2020 2020 204f 6674 656e 2077  .        Often w
-0002bf20: 6520 6060 7365 745f 696e 6465 7860 6020  e ``set_index`` 
-0002bf30: 6f6e 6365 2064 6972 6563 746c 7920 6166  once directly af
-0002bf40: 7465 7220 6461 7461 2069 6e67 6573 7420  ter data ingest 
-0002bf50: 616e 6420 6669 6c74 6572 696e 6720 616e  and filtering an
-0002bf60: 640a 2020 2020 2020 2020 7468 656e 2070  d.        then p
-0002bf70: 6572 666f 726d 206d 616e 7920 6368 6561  erform many chea
-0002bf80: 7020 636f 6d70 7574 6174 696f 6e73 206f  p computations o
-0002bf90: 6666 206f 6620 7468 6520 736f 7274 6564  ff of the sorted
-0002bfa0: 2064 6174 6173 6574 2e0a 0a20 2020 2020   dataset...     
-0002bfb0: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
-0002bfc0: 206f 7065 7261 7465 7320 6578 6163 746c   operates exactl
-0002bfd0: 7920 6c69 6b65 2060 6070 616e 6461 732e  y like ``pandas.
-0002bfe0: 7365 745f 696e 6465 7860 6020 6578 6365  set_index`` exce
-0002bff0: 7074 2077 6974 680a 2020 2020 2020 2020  pt with.        
-0002c000: 6469 6666 6572 656e 7420 7065 7266 6f72  different perfor
-0002c010: 6d61 6e63 6520 636f 7374 7320 2864 6173  mance costs (das
-0002c020: 6b20 6461 7461 6672 616d 6520 6060 7365  k dataframe ``se
-0002c030: 745f 696e 6465 7860 6020 6973 206d 7563  t_index`` is muc
-0002c040: 6820 6d6f 7265 2065 7870 656e 7369 7665  h more expensive
-0002c050: 292e 0a20 2020 2020 2020 2055 6e64 6572  )..        Under
-0002c060: 206e 6f72 6d61 6c20 6f70 6572 6174 696f   normal operatio
-0002c070: 6e20 7468 6973 2066 756e 6374 696f 6e20  n this function 
-0002c080: 646f 6573 2061 6e20 696e 6974 6961 6c20  does an initial 
-0002c090: 7061 7373 206f 7665 7220 7468 6520 696e  pass over the in
-0002c0a0: 6465 7820 636f 6c75 6d6e 0a20 2020 2020  dex column.     
-0002c0b0: 2020 2074 6f20 636f 6d70 7574 6520 6170     to compute ap
-0002c0c0: 7072 6f78 696d 6174 6520 7175 616e 7469  proximate quanti
-0002c0d0: 6c65 7320 746f 2073 6572 7665 2061 7320  les to serve as 
-0002c0e0: 6675 7475 7265 2064 6976 6973 696f 6e73  future divisions
-0002c0f0: 2e20 4974 2074 6865 6e20 7061 7373 6573  . It then passes
-0002c100: 0a20 2020 2020 2020 206f 7665 7220 7468  .        over th
-0002c110: 6520 6461 7461 2061 2073 6563 6f6e 6420  e data a second 
-0002c120: 7469 6d65 2c20 7370 6c69 7474 696e 6720  time, splitting 
-0002c130: 7570 2065 6163 6820 696e 7075 7420 7061  up each input pa
-0002c140: 7274 6974 696f 6e20 696e 746f 2073 6576  rtition into sev
-0002c150: 6572 616c 0a20 2020 2020 2020 2070 6965  eral.        pie
-0002c160: 6365 7320 616e 6420 7368 6172 696e 6720  ces and sharing 
-0002c170: 7468 6f73 6520 7069 6563 6573 2074 6f20  those pieces to 
-0002c180: 616c 6c20 6f66 2074 6865 206f 7574 7075  all of the outpu
-0002c190: 7420 7061 7274 6974 696f 6e73 206e 6f77  t partitions now
-0002c1a0: 2069 6e0a 2020 2020 2020 2020 736f 7274   in.        sort
-0002c1b0: 6564 206f 7264 6572 2e0a 0a20 2020 2020  ed order...     
-0002c1c0: 2020 2049 6e20 736f 6d65 2063 6173 6573     In some cases
-0002c1d0: 2077 6520 6361 6e20 616c 6c65 7669 6174   we can alleviat
-0002c1e0: 6520 7468 6f73 6520 636f 7374 732c 2066  e those costs, f
-0002c1f0: 6f72 2065 7861 6d70 6c65 2069 6620 796f  or example if yo
-0002c200: 7572 2064 6174 6173 6574 2069 730a 2020  ur dataset is.  
-0002c210: 2020 2020 2020 736f 7274 6564 2061 6c72        sorted alr
-0002c220: 6561 6479 2074 6865 6e20 7765 2063 616e  eady then we can
-0002c230: 2061 766f 6964 206d 616b 696e 6720 6d61   avoid making ma
-0002c240: 6e79 2073 6d61 6c6c 2070 6965 6365 7320  ny small pieces 
-0002c250: 6f72 2069 6620 796f 7520 6b6e 6f77 0a20  or if you know. 
-0002c260: 2020 2020 2020 2067 6f6f 6420 7661 6c75         good valu
-0002c270: 6573 2074 6f20 7370 6c69 7420 7468 6520  es to split the 
-0002c280: 6e65 7720 696e 6465 7820 636f 6c75 6d6e  new index column
-0002c290: 2074 6865 6e20 7765 2063 616e 2061 766f   then we can avo
-0002c2a0: 6964 2074 6865 2069 6e69 7469 616c 0a20  id the initial. 
-0002c2b0: 2020 2020 2020 2070 6173 7320 6f76 6572         pass over
-0002c2c0: 2074 6865 2064 6174 612e 2046 6f72 2065   the data. For e
-0002c2d0: 7861 6d70 6c65 2069 6620 796f 7572 206e  xample if your n
-0002c2e0: 6577 2069 6e64 6578 2069 7320 6120 6461  ew index is a da
-0002c2f0: 7465 7469 6d65 2069 6e64 6578 2061 6e64  tetime index and
-0002c300: 0a20 2020 2020 2020 2079 6f75 7220 6461  .        your da
-0002c310: 7461 2069 7320 616c 7265 6164 7920 736f  ta is already so
-0002c320: 7274 6564 2062 7920 6461 7920 7468 656e  rted by day then
-0002c330: 2074 6869 7320 656e 7469 7265 206f 7065   this entire ope
-0002c340: 7261 7469 6f6e 2063 616e 2062 6520 646f  ration can be do
-0002c350: 6e65 0a20 2020 2020 2020 2066 6f72 2066  ne.        for f
-0002c360: 7265 652e 2059 6f75 2063 616e 2063 6f6e  ree. You can con
-0002c370: 7472 6f6c 2074 6865 7365 206f 7074 696f  trol these optio
-0002c380: 6e73 2077 6974 6820 7468 6520 666f 6c6c  ns with the foll
-0002c390: 6f77 696e 6720 7061 7261 6d65 7465 7273  owing parameters
-0002c3a0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0002c3b0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-0002c3c0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0002c3d0: 206f 7468 6572 3a20 7374 7269 6e67 206f   other: string o
-0002c3e0: 7220 4461 736b 2053 6572 6965 730a 2020  r Dask Series.  
-0002c3f0: 2020 2020 2020 2020 2020 436f 6c75 6d6e            Column
-0002c400: 2074 6f20 7573 6520 6173 2069 6e64 6578   to use as index
-0002c410: 2e0a 2020 2020 2020 2020 6472 6f70 3a20  ..        drop: 
-0002c420: 626f 6f6c 6561 6e2c 2064 6566 6175 6c74  boolean, default
-0002c430: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-0002c440: 2020 4465 6c65 7465 2063 6f6c 756d 6e20    Delete column 
-0002c450: 746f 2062 6520 7573 6564 2061 7320 7468  to be used as th
-0002c460: 6520 6e65 7720 696e 6465 782e 0a20 2020  e new index..   
-0002c470: 2020 2020 2073 6f72 7465 643a 2062 6f6f       sorted: boo
-0002c480: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-0002c490: 2020 2020 2020 2020 4966 2074 6865 2069          If the i
-0002c4a0: 6e64 6578 2063 6f6c 756d 6e20 6973 2061  ndex column is a
-0002c4b0: 6c72 6561 6479 2073 6f72 7465 6420 696e  lready sorted in
-0002c4c0: 2069 6e63 7265 6173 696e 6720 6f72 6465   increasing orde
-0002c4d0: 722e 0a20 2020 2020 2020 2020 2020 2044  r..            D
-0002c4e0: 6566 6175 6c74 7320 746f 2046 616c 7365  efaults to False
-0002c4f0: 0a20 2020 2020 2020 206e 7061 7274 6974  .        npartit
-0002c500: 696f 6e73 3a20 696e 742c 204e 6f6e 652c  ions: int, None,
-0002c510: 206f 7220 2761 7574 6f27 0a20 2020 2020   or 'auto'.     
-0002c520: 2020 2020 2020 2054 6865 2069 6465 616c         The ideal
-0002c530: 206e 756d 6265 7220 6f66 206f 7574 7075   number of outpu
-0002c540: 7420 7061 7274 6974 696f 6e73 2e20 4966  t partitions. If
-0002c550: 204e 6f6e 652c 2075 7365 2074 6865 2073   None, use the s
-0002c560: 616d 6520 6173 0a20 2020 2020 2020 2020  ame as.         
-0002c570: 2020 2074 6865 2069 6e70 7574 2e20 4966     the input. If
-0002c580: 2027 6175 746f 2720 7468 656e 2064 6563   'auto' then dec
-0002c590: 6964 6520 6279 206d 656d 6f72 7920 7573  ide by memory us
-0002c5a0: 652e 0a20 2020 2020 2020 2020 2020 204f  e..            O
-0002c5b0: 6e6c 7920 7573 6564 2077 6865 6e20 6060  nly used when ``
-0002c5c0: 6469 7669 7369 6f6e 7360 6020 6973 206e  divisions`` is n
-0002c5d0: 6f74 2067 6976 656e 2e20 4966 2060 6064  ot given. If ``d
-0002c5e0: 6976 6973 696f 6e73 6060 2069 7320 6769  ivisions`` is gi
-0002c5f0: 7665 6e2c 0a20 2020 2020 2020 2020 2020  ven,.           
-0002c600: 2074 6865 206e 756d 6265 7220 6f66 206f   the number of o
-0002c610: 7574 7075 7420 7061 7274 6974 696f 6e73  utput partitions
-0002c620: 2077 696c 6c20 6265 2060 606c 656e 2864   will be ``len(d
-0002c630: 6976 6973 696f 6e73 2920 2d20 3160 602e  ivisions) - 1``.
-0002c640: 0a20 2020 2020 2020 2064 6976 6973 696f  .        divisio
-0002c650: 6e73 3a20 6c69 7374 2c20 6f70 7469 6f6e  ns: list, option
-0002c660: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
-0002c670: 6865 2022 6469 7669 6469 6e67 206c 696e  he "dividing lin
-0002c680: 6573 2220 7573 6564 2074 6f20 7370 6c69  es" used to spli
-0002c690: 7420 7468 6520 6e65 7720 696e 6465 7820  t the new index 
-0002c6a0: 696e 746f 2070 6172 7469 7469 6f6e 732e  into partitions.
-0002c6b0: 0a20 2020 2020 2020 2020 2020 2046 6f72  .            For
-0002c6c0: 2060 6064 6976 6973 696f 6e73 3d5b 302c   ``divisions=[0,
-0002c6d0: 2031 302c 2035 302c 2031 3030 5d60 602c   10, 50, 100]``,
-0002c6e0: 2074 6865 7265 2077 6f75 6c64 2062 6520   there would be 
-0002c6f0: 7468 7265 6520 6f75 7470 7574 2070 6172  three output par
-0002c700: 7469 7469 6f6e 732c 0a20 2020 2020 2020  titions,.       
-0002c710: 2020 2020 2077 6865 7265 2074 6865 206e       where the n
-0002c720: 6577 2069 6e64 6578 2063 6f6e 7461 696e  ew index contain
-0002c730: 6564 205b 302c 2031 3029 2c20 5b31 302c  ed [0, 10), [10,
-0002c740: 2035 3029 2c20 616e 6420 5b35 302c 2031   50), and [50, 1
-0002c750: 3030 292c 2072 6573 7065 6374 6976 656c  00), respectivel
-0002c760: 792e 0a20 2020 2020 2020 2020 2020 2053  y..            S
-0002c770: 6565 2068 7474 7073 3a2f 2f64 6f63 732e  ee https://docs.
-0002c780: 6461 736b 2e6f 7267 2f65 6e2f 6c61 7465  dask.org/en/late
-0002c790: 7374 2f64 6174 6166 7261 6d65 2d64 6573  st/dataframe-des
-0002c7a0: 6967 6e2e 6874 6d6c 2370 6172 7469 7469  ign.html#partiti
-0002c7b0: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
-0002c7c0: 2049 6620 6e6f 7420 6769 7665 6e20 2864   If not given (d
-0002c7d0: 6566 6175 6c74 292c 2067 6f6f 6420 6469  efault), good di
-0002c7e0: 7669 7369 6f6e 7320 6172 6520 6361 6c63  visions are calc
-0002c7f0: 756c 6174 6564 2062 7920 696d 6d65 6469  ulated by immedi
-0002c800: 6174 656c 7920 636f 6d70 7574 696e 670a  ately computing.
-0002c810: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-0002c820: 6461 7461 2061 6e64 206c 6f6f 6b69 6e67  data and looking
-0002c830: 2061 7420 7468 6520 6469 7374 7269 6275   at the distribu
-0002c840: 7469 6f6e 206f 6620 6974 7320 7661 6c75  tion of its valu
-0002c850: 6573 2e20 466f 7220 6c61 7267 6520 6461  es. For large da
-0002c860: 7461 7365 7473 2c0a 2020 2020 2020 2020  tasets,.        
-0002c870: 2020 2020 7468 6973 2063 616e 2062 6520      this can be 
-0002c880: 6578 7065 6e73 6976 652e 0a20 2020 2020  expensive..     
-0002c890: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
-0002c8a0: 2069 6620 6060 736f 7274 6564 3d54 7275   if ``sorted=Tru
-0002c8b0: 6560 602c 2073 7065 6369 6669 6564 2064  e``, specified d
-0002c8c0: 6976 6973 696f 6e73 2061 7265 2061 7373  ivisions are ass
-0002c8d0: 756d 6564 2074 6f20 6d61 7463 680a 2020  umed to match.  
-0002c8e0: 2020 2020 2020 2020 2020 7468 6520 6578            the ex
-0002c8f0: 6973 7469 6e67 2070 6172 7469 7469 6f6e  isting partition
-0002c900: 7320 696e 2074 6865 2064 6174 613b 2069  s in the data; i
-0002c910: 6620 7468 6973 2069 7320 756e 7472 7565  f this is untrue
-0002c920: 2079 6f75 2073 686f 756c 640a 2020 2020   you should.    
-0002c930: 2020 2020 2020 2020 6c65 6176 6520 6469          leave di
-0002c940: 7669 7369 6f6e 7320 656d 7074 7920 616e  visions empty an
-0002c950: 6420 6361 6c6c 2060 6072 6570 6172 7469  d call ``reparti
-0002c960: 7469 6f6e 6060 2061 6674 6572 2060 6073  tion`` after ``s
-0002c970: 6574 5f69 6e64 6578 6060 2e0a 2020 2020  et_index``..    
-0002c980: 2020 2020 696e 706c 6163 653a 2062 6f6f      inplace: boo
-0002c990: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-0002c9a0: 2020 2020 2020 2020 4d6f 6469 6679 696e          Modifyin
-0002c9b0: 6720 7468 6520 4461 7461 4672 616d 6520  g the DataFrame 
-0002c9c0: 696e 2070 6c61 6365 2069 7320 6e6f 7420  in place is not 
-0002c9d0: 7375 7070 6f72 7465 6420 6279 2044 6173  supported by Das
-0002c9e0: 6b2e 0a20 2020 2020 2020 2020 2020 2044  k..            D
-0002c9f0: 6566 6175 6c74 7320 746f 2046 616c 7365  efaults to False
-0002ca00: 2e0a 2020 2020 2020 2020 7368 7566 666c  ..        shuffl
-0002ca10: 653a 2073 7472 696e 672c 2027 6469 736b  e: string, 'disk
-0002ca20: 2720 6f72 2027 7461 736b 7327 2c20 6f70  ' or 'tasks', op
-0002ca30: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0002ca40: 2020 2045 6974 6865 7220 6060 2764 6973     Either ``'dis
-0002ca50: 6b27 6060 2066 6f72 2073 696e 676c 652d  k'`` for single-
-0002ca60: 6e6f 6465 206f 7065 7261 7469 6f6e 206f  node operation o
-0002ca70: 7220 6060 2774 6173 6b73 2760 6020 666f  r ``'tasks'`` fo
-0002ca80: 720a 2020 2020 2020 2020 2020 2020 6469  r.            di
-0002ca90: 7374 7269 6275 7465 6420 6f70 6572 6174  stributed operat
-0002caa0: 696f 6e2e 2020 5769 6c6c 2062 6520 696e  ion.  Will be in
-0002cab0: 6665 7272 6564 2062 7920 796f 7572 2063  ferred by your c
-0002cac0: 7572 7265 6e74 2073 6368 6564 756c 6572  urrent scheduler
-0002cad0: 2e0a 2020 2020 2020 2020 636f 6d70 7574  ..        comput
-0002cae0: 653a 2062 6f6f 6c2c 2064 6566 6175 6c74  e: bool, default
-0002caf0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-0002cb00: 2020 2057 6865 7468 6572 206f 7220 6e6f     Whether or no
-0002cb10: 7420 746f 2074 7269 6767 6572 2061 6e20  t to trigger an 
-0002cb20: 696d 6d65 6469 6174 6520 636f 6d70 7574  immediate comput
-0002cb30: 6174 696f 6e2e 2044 6566 6175 6c74 7320  ation. Defaults 
-0002cb40: 746f 2046 616c 7365 2e0a 2020 2020 2020  to False..      
-0002cb50: 2020 2020 2020 4e6f 7465 2c20 7468 6174        Note, that
-0002cb60: 2065 7665 6e20 6966 2079 6f75 2073 6574   even if you set
-0002cb70: 2060 6063 6f6d 7075 7465 3d46 616c 7365   ``compute=False
-0002cb80: 6060 2c20 616e 2069 6d6d 6564 6961 7465  ``, an immediate
-0002cb90: 2063 6f6d 7075 7461 7469 6f6e 0a20 2020   computation.   
-0002cba0: 2020 2020 2020 2020 2077 696c 6c20 7374           will st
-0002cbb0: 696c 6c20 6265 2074 7269 6767 6572 6564  ill be triggered
-0002cbc0: 2069 6620 6060 6469 7669 7369 6f6e 7360   if ``divisions`
-0002cbd0: 6020 6973 2060 604e 6f6e 6560 602e 0a20  ` is ``None``.. 
-0002cbe0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-0002cbf0: 5f73 697a 653a 2069 6e74 2c20 6f70 7469  _size: int, opti
-0002cc00: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0002cc10: 2044 6573 6972 6564 2073 697a 6520 6f66   Desired size of
-0002cc20: 2065 6163 6820 7061 7274 6974 696f 6e73   each partitions
-0002cc30: 2069 6e20 6279 7465 732e 0a20 2020 2020   in bytes..     
-0002cc40: 2020 2020 2020 204f 6e6c 7920 7573 6564         Only used
-0002cc50: 2077 6865 6e20 6060 6e70 6172 7469 7469   when ``npartiti
-0002cc60: 6f6e 733d 2761 7574 6f27 6060 0a0a 2020  ons='auto'``..  
-0002cc70: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
-0002cc80: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-0002cc90: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-0002cca0: 7274 2064 6173 6b0a 2020 2020 2020 2020  rt dask.        
-0002ccb0: 3e3e 3e20 6464 6620 3d20 6461 736b 2e64  >>> ddf = dask.d
-0002ccc0: 6174 6173 6574 732e 7469 6d65 7365 7269  atasets.timeseri
-0002ccd0: 6573 2873 7461 7274 3d22 3230 3231 2d30  es(start="2021-0
-0002cce0: 312d 3031 222c 2065 6e64 3d22 3230 3231  1-01", end="2021
-0002ccf0: 2d30 312d 3037 222c 2066 7265 713d 2231  -01-07", freq="1
-0002cd00: 4822 292e 7265 7365 745f 696e 6465 7828  H").reset_index(
-0002cd10: 290a 2020 2020 2020 2020 3e3e 3e20 6464  ).        >>> dd
-0002cd20: 6632 203d 2064 6466 2e73 6574 5f69 6e64  f2 = ddf.set_ind
-0002cd30: 6578 2822 7822 290a 2020 2020 2020 2020  ex("x").        
-0002cd40: 3e3e 3e20 6464 6632 203d 2064 6466 2e73  >>> ddf2 = ddf.s
-0002cd50: 6574 5f69 6e64 6578 2864 6466 2e78 290a  et_index(ddf.x).
-0002cd60: 2020 2020 2020 2020 3e3e 3e20 6464 6632          >>> ddf2
-0002cd70: 203d 2064 6466 2e73 6574 5f69 6e64 6578   = ddf.set_index
-0002cd80: 2864 6466 2e74 696d 6573 7461 6d70 2c20  (ddf.timestamp, 
-0002cd90: 736f 7274 6564 3d54 7275 6529 0a0a 2020  sorted=True)..  
-0002cda0: 2020 2020 2020 4120 636f 6d6d 6f6e 2063        A common c
-0002cdb0: 6173 6520 6973 2077 6865 6e20 7765 2068  ase is when we h
-0002cdc0: 6176 6520 6120 6461 7465 7469 6d65 2063  ave a datetime c
-0002cdd0: 6f6c 756d 6e20 7468 6174 2077 6520 6b6e  olumn that we kn
-0002cde0: 6f77 2074 6f20 6265 0a20 2020 2020 2020  ow to be.       
-0002cdf0: 2073 6f72 7465 6420 616e 6420 6973 2063   sorted and is c
-0002ce00: 6c65 616e 6c79 2064 6976 6964 6564 2062  leanly divided b
-0002ce10: 7920 6461 792e 2020 5765 2063 616e 2073  y day.  We can s
-0002ce20: 6574 2074 6869 7320 696e 6465 7820 666f  et this index fo
-0002ce30: 7220 6672 6565 0a20 2020 2020 2020 2062  r free.        b
-0002ce40: 7920 7370 6563 6966 7969 6e67 2062 6f74  y specifying bot
-0002ce50: 6820 7468 6174 2074 6865 2063 6f6c 756d  h that the colum
-0002ce60: 6e20 6973 2070 7265 2d73 6f72 7465 6420  n is pre-sorted 
-0002ce70: 616e 6420 7468 6520 7061 7274 6963 756c  and the particul
-0002ce80: 6172 0a20 2020 2020 2020 2064 6976 6973  ar.        divis
-0002ce90: 696f 6e73 2061 6c6f 6e67 2077 6869 6368  ions along which
-0002cea0: 2069 7320 6973 2073 6570 6172 6174 6564   is is separated
-0002ceb0: 0a0a 2020 2020 2020 2020 3e3e 3e20 696d  ..        >>> im
-0002cec0: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
-0002ced0: 640a 2020 2020 2020 2020 3e3e 3e20 6469  d.        >>> di
-0002cee0: 7669 7369 6f6e 7320 3d20 7064 2e64 6174  visions = pd.dat
-0002cef0: 655f 7261 6e67 6528 7374 6172 743d 2232  e_range(start="2
-0002cf00: 3032 312d 3031 2d30 3122 2c20 656e 643d  021-01-01", end=
-0002cf10: 2232 3032 312d 3031 2d30 3722 2c20 6672  "2021-01-07", fr
-0002cf20: 6571 3d27 3144 2729 0a20 2020 2020 2020  eq='1D').       
-0002cf30: 203e 3e3e 2064 6976 6973 696f 6e73 0a20   >>> divisions. 
-0002cf40: 2020 2020 2020 2044 6174 6574 696d 6549         DatetimeI
-0002cf50: 6e64 6578 285b 2732 3032 312d 3031 2d30  ndex(['2021-01-0
-0002cf60: 3127 2c20 2732 3032 312d 3031 2d30 3227  1', '2021-01-02'
-0002cf70: 2c20 2732 3032 312d 3031 2d30 3327 2c20  , '2021-01-03', 
-0002cf80: 2732 3032 312d 3031 2d30 3427 2c0a 2020  '2021-01-04',.  
-0002cf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cfa0: 2020 2020 2027 3230 3231 2d30 312d 3035       '2021-01-05
-0002cfb0: 272c 2027 3230 3231 2d30 312d 3036 272c  ', '2021-01-06',
-0002cfc0: 2027 3230 3231 2d30 312d 3037 275d 2c0a   '2021-01-07'],.
-0002cfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cfe0: 2020 2020 2020 6474 7970 653d 2764 6174        dtype='dat
-0002cff0: 6574 696d 6536 345b 6e73 5d27 2c20 6672  etime64[ns]', fr
-0002d000: 6571 3d27 4427 290a 0a20 2020 2020 2020  eq='D')..       
-0002d010: 204e 6f74 6520 7468 6174 2060 606c 656e   Note that ``len
-0002d020: 2864 6976 6973 6f6e 7329 6060 2069 7320  (divisons)`` is 
-0002d030: 6571 7561 6c20 746f 2060 606e 7061 7274  equal to ``npart
-0002d040: 6974 696f 6e73 202b 2031 6060 2e20 5468  itions + 1``. Th
-0002d050: 6973 2069 7320 6265 6361 7573 6520 6060  is is because ``
-0002d060: 6469 7669 7369 6f6e 7360 600a 2020 2020  divisions``.    
-0002d070: 2020 2020 7265 7072 6573 656e 7473 2074      represents t
-0002d080: 6865 2075 7070 6572 2061 6e64 206c 6f77  he upper and low
-0002d090: 6572 2062 6f75 6e64 7320 6f66 2065 6163  er bounds of eac
-0002d0a0: 6820 7061 7274 6974 696f 6e2e 2054 6865  h partition. The
-0002d0b0: 2066 6972 7374 2069 7465 6d20 6973 2074   first item is t
-0002d0c0: 6865 0a20 2020 2020 2020 206c 6f77 6572  he.        lower
-0002d0d0: 2062 6f75 6e64 206f 6620 7468 6520 6669   bound of the fi
-0002d0e0: 7273 7420 7061 7274 6974 696f 6e2c 2074  rst partition, t
-0002d0f0: 6865 2073 6563 6f6e 6420 6974 656d 2069  he second item i
-0002d100: 7320 7468 6520 6c6f 7765 7220 626f 756e  s the lower boun
-0002d110: 6420 6f66 2074 6865 0a20 2020 2020 2020  d of the.       
-0002d120: 2073 6563 6f6e 6420 7061 7274 6974 696f   second partitio
-0002d130: 6e20 616e 6420 7468 6520 7570 7065 7220  n and the upper 
-0002d140: 626f 756e 6420 6f66 2074 6865 2066 6972  bound of the fir
-0002d150: 7374 2070 6172 7469 7469 6f6e 2c20 616e  st partition, an
-0002d160: 6420 736f 206f 6e2e 0a20 2020 2020 2020  d so on..       
-0002d170: 2054 6865 2073 6563 6f6e 642d 746f 2d6c   The second-to-l
-0002d180: 6173 7420 6974 656d 2069 7320 7468 6520  ast item is the 
-0002d190: 6c6f 7765 7220 626f 756e 6420 6f66 2074  lower bound of t
-0002d1a0: 6865 206c 6173 7420 7061 7274 6974 696f  he last partitio
-0002d1b0: 6e2c 2061 6e64 2074 6865 206c 6173 740a  n, and the last.
-0002d1c0: 2020 2020 2020 2020 2865 7874 7261 2920          (extra) 
-0002d1d0: 6974 656d 2069 7320 7468 6520 7570 7065  item is the uppe
-0002d1e0: 7220 626f 756e 6420 6f66 2074 6865 206c  r bound of the l
-0002d1f0: 6173 7420 7061 7274 6974 696f 6e2e 0a0a  ast partition...
-0002d200: 2020 2020 2020 2020 3e3e 3e20 6464 6632          >>> ddf2
-0002d210: 203d 2064 6466 2e73 6574 5f69 6e64 6578   = ddf.set_index
-0002d220: 2822 7469 6d65 7374 616d 7022 2c20 736f  ("timestamp", so
-0002d230: 7274 6564 3d54 7275 652c 2064 6976 6973  rted=True, divis
-0002d240: 696f 6e73 3d64 6976 6973 696f 6e73 2e74  ions=divisions.t
-0002d250: 6f6c 6973 7428 2929 0a0a 2020 2020 2020  olist())..      
-0002d260: 2020 4966 2079 6f75 276c 6c20 6265 2072    If you'll be r
-0002d270: 756e 6e69 6e67 2060 7365 745f 696e 6465  unning `set_inde
-0002d280: 7860 206f 6e20 7468 6520 7361 6d65 2028  x` on the same (
-0002d290: 6f72 2073 696d 696c 6172 2920 6461 7461  or similar) data
-0002d2a0: 7365 7473 2072 6570 6561 7465 646c 792c  sets repeatedly,
-0002d2b0: 0a20 2020 2020 2020 2079 6f75 2063 6f75  .        you cou
-0002d2c0: 6c64 2073 6176 6520 7469 6d65 2062 7920  ld save time by 
-0002d2d0: 6c65 7474 696e 6720 4461 736b 2063 616c  letting Dask cal
-0002d2e0: 6375 6c61 7465 2067 6f6f 6420 6469 7669  culate good divi
-0002d2f0: 7369 6f6e 7320 6f6e 6365 2c20 7468 656e  sions once, then
-0002d300: 2063 6f70 792d 7061 7374 696e 670a 2020   copy-pasting.  
-0002d310: 2020 2020 2020 7468 656d 2074 6f20 7265        them to re
-0002d320: 7573 652e 2054 6869 7320 6973 2065 7370  use. This is esp
-0002d330: 6563 6961 6c6c 7920 6865 6c70 6675 6c20  ecially helpful 
-0002d340: 7275 6e6e 696e 6720 696e 2061 204a 7570  running in a Jup
-0002d350: 7974 6572 206e 6f74 6562 6f6f 6b3a 0a0a  yter notebook:..
-0002d360: 2020 2020 2020 2020 3e3e 3e20 6464 6632          >>> ddf2
-0002d370: 203d 2064 6466 2e73 6574 5f69 6e64 6578   = ddf.set_index
-0002d380: 2822 6e61 6d65 2229 2020 2320 736c 6f77  ("name")  # slow
-0002d390: 2c20 6361 6c63 756c 6174 6573 2064 6174  , calculates dat
-0002d3a0: 6120 6469 7374 7269 6275 7469 6f6e 0a20  a distribution. 
-0002d3b0: 2020 2020 2020 203e 3e3e 2064 6466 322e         >>> ddf2.
-0002d3c0: 6469 7669 7369 6f6e 7320 2023 2064 6f63  divisions  # doc
-0002d3d0: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
-0002d3e0: 2020 2020 5b22 416c 6963 6522 2c20 224c      ["Alice", "L
-0002d3f0: 6175 7261 222c 2022 5572 7375 6c61 222c  aura", "Ursula",
-0002d400: 2022 5a65 6c64 6122 5d0a 2020 2020 2020   "Zelda"].      
-0002d410: 2020 3e3e 3e20 2320 5e20 4e6f 7720 636f    >>> # ^ Now co
-0002d420: 7079 2d70 6173 7465 2074 6869 7320 616e  py-paste this an
-0002d430: 6420 6564 6974 2074 6865 206c 696e 6520  d edit the line 
-0002d440: 6162 6f76 6520 746f 3a0a 2020 2020 2020  above to:.      
-0002d450: 2020 3e3e 3e20 2320 6464 6632 203d 2064    >>> # ddf2 = d
-0002d460: 6466 2e73 6574 5f69 6e64 6578 2822 6e61  df.set_index("na
-0002d470: 6d65 222c 2064 6976 6973 696f 6e73 3d5b  me", divisions=[
-0002d480: 2241 6c69 6365 222c 2022 4c61 7572 6122  "Alice", "Laura"
-0002d490: 2c20 2255 7273 756c 6122 2c20 225a 656c  , "Ursula", "Zel
-0002d4a0: 6461 225d 290a 2020 2020 2020 2020 2222  da"]).        ""
-0002d4b0: 220a 0a20 2020 2020 2020 2069 6620 696e  "..        if in
-0002d4c0: 706c 6163 653a 0a20 2020 2020 2020 2020  place:.         
-0002d4d0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-0002d4e0: 656d 656e 7465 6445 7272 6f72 2822 5468  ementedError("Th
-0002d4f0: 6520 696e 706c 6163 653d 206b 6579 776f  e inplace= keywo
-0002d500: 7264 2069 7320 6e6f 7420 7375 7070 6f72  rd is not suppor
-0002d510: 7465 6422 290a 2020 2020 2020 2020 7072  ted").        pr
-0002d520: 655f 736f 7274 6564 203d 2073 6f72 7465  e_sorted = sorte
-0002d530: 640a 2020 2020 2020 2020 6465 6c20 736f  d.        del so
-0002d540: 7274 6564 0a0a 2020 2020 2020 2020 2320  rted..        # 
-0002d550: 4368 6563 6b20 6f74 6865 7220 6361 6e20  Check other can 
-0002d560: 6265 2074 7261 6e73 6c61 7465 6420 746f  be translated to
-0002d570: 2063 6f6c 756d 6e20 6e61 6d65 206f 7220   column name or 
-0002d580: 636f 6c75 6d6e 206f 626a 6563 742c 2070  column object, p
-0002d590: 6f73 7369 626c 7920 666c 6174 7465 6e69  ossibly flatteni
-0002d5a0: 6e67 2069 740a 2020 2020 2020 2020 6966  ng it.        if
-0002d5b0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0002d5c0: 6f74 6865 722c 2073 7472 293a 0a20 2020  other, str):.   
-0002d5d0: 2020 2020 2020 2020 2023 2049 7420 6d61           # It ma
-0002d5e0: 7920 7265 6665 7220 746f 2073 6576 6572  y refer to sever
-0002d5f0: 616c 2063 6f6c 756d 6e73 0a20 2020 2020  al columns.     
-0002d600: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0002d610: 616e 6365 286f 7468 6572 2c20 5365 7175  ance(other, Sequ
-0002d620: 656e 6365 293a 2020 2320 7479 7065 3a20  ence):  # type: 
-0002d630: 6967 6e6f 7265 5b75 6e72 6561 6368 6162  ignore[unreachab
-0002d640: 6c65 5d0a 2020 2020 2020 2020 2020 2020  le].            
-0002d650: 2020 2020 2320 4163 6365 7074 205b 2261      # Accept ["a
-0002d660: 225d 2c20 6275 7420 6e6f 7420 5b5b 2261  "], but not [["a
-0002d670: 225d 5d0a 2020 2020 2020 2020 2020 2020  "]].            
-0002d680: 2020 2020 6966 206c 656e 286f 7468 6572      if len(other
-0002d690: 2920 3d3d 2031 2061 6e64 2028 2020 2320  ) == 1 and (  # 
-0002d6a0: 7479 7065 3a20 6967 6e6f 7265 5b75 6e72  type: ignore[unr
-0002d6b0: 6561 6368 6162 6c65 5d0a 2020 2020 2020  eachable].      
-0002d6c0: 2020 2020 2020 2020 2020 2020 2020 6973                is
-0002d6d0: 696e 7374 616e 6365 286f 7468 6572 5b30  instance(other[0
-0002d6e0: 5d2c 2073 7472 2920 6f72 206e 6f74 2069  ], str) or not i
-0002d6f0: 7369 6e73 7461 6e63 6528 6f74 6865 725b  sinstance(other[
-0002d700: 305d 2c20 5365 7175 656e 6365 290a 2020  0], Sequence).  
-0002d710: 2020 2020 2020 2020 2020 2020 2020 293a                ):
-0002d720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d730: 2020 2020 206f 7468 6572 203d 206f 7468       other = oth
-0002d740: 6572 5b30 5d0a 2020 2020 2020 2020 2020  er[0].          
-0002d750: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002d760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d770: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-0002d780: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
+00012de0: 2020 206c 616d 6264 6120 782c 2079 3a20     lambda x, y: 
+00012df0: 7265 7375 6c74 2069 6620 7820 6973 2079  result if x is y
+00012e00: 2065 6c73 6520 6e70 2e4e 614e 2c20 636f   else np.NaN, co
+00012e10: 6e64 2c20 5472 7565 0a20 2020 2020 2020  nd, True.       
+00012e20: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00012e30: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00012e40: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+00012e50: 6c74 0a0a 2020 2020 4064 6572 6976 6564  lt..    @derived
+00012e60: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00012e70: 6d65 290a 2020 2020 6465 6620 7072 6f64  me).    def prod
+00012e80: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00012e90: 2020 2020 2020 2020 6178 6973 3d4e 6f6e          axis=Non
+00012ea0: 652c 0a20 2020 2020 2020 2073 6b69 706e  e,.        skipn
+00012eb0: 613d 5472 7565 2c0a 2020 2020 2020 2020  a=True,.        
+00012ec0: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+00012ed0: 652c 0a20 2020 2020 2020 2064 7479 7065  e,.        dtype
+00012ee0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206f  =None,.        o
+00012ef0: 7574 3d4e 6f6e 652c 0a20 2020 2020 2020  ut=None,.       
+00012f00: 206d 696e 5f63 6f75 6e74 3d4e 6f6e 652c   min_count=None,
+00012f10: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
+00012f20: 5f6f 6e6c 793d 4e6f 6e65 2c0a 2020 2020  _only=None,.    
+00012f30: 293a 0a20 2020 2020 2020 2072 6573 756c  ):.        resul
+00012f40: 7420 3d20 7365 6c66 2e5f 7265 6475 6374  t = self._reduct
+00012f50: 696f 6e5f 6167 6728 0a20 2020 2020 2020  ion_agg(.       
+00012f60: 2020 2020 2022 7072 6f64 222c 0a20 2020       "prod",.   
+00012f70: 2020 2020 2020 2020 2061 7869 733d 6178           axis=ax
+00012f80: 6973 2c0a 2020 2020 2020 2020 2020 2020  is,.            
+00012f90: 736b 6970 6e61 3d73 6b69 706e 612c 0a20  skipna=skipna,. 
+00012fa0: 2020 2020 2020 2020 2020 2073 706c 6974             split
+00012fb0: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+00012fc0: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
+00012fd0: 6f75 743d 6f75 742c 0a20 2020 2020 2020  out=out,.       
+00012fe0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+00012ff0: 793d 6e75 6d65 7269 635f 6f6e 6c79 2c0a  y=numeric_only,.
+00013000: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00013010: 2020 6966 206d 696e 5f63 6f75 6e74 3a0a    if min_count:.
+00013020: 2020 2020 2020 2020 2020 2020 636f 6e64              cond
+00013030: 203d 2073 656c 662e 6e6f 746e 756c 6c28   = self.notnull(
+00013040: 292e 7375 6d28 6178 6973 3d61 7869 7329  ).sum(axis=axis)
+00013050: 203e 3d20 6d69 6e5f 636f 756e 740a 2020   >= min_count.  
+00013060: 2020 2020 2020 2020 2020 6966 2069 735f            if is_
+00013070: 7365 7269 6573 5f6c 696b 6528 636f 6e64  series_like(cond
+00013080: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00013090: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+000130a0: 2e77 6865 7265 2863 6f6e 642c 206f 7468  .where(cond, oth
+000130b0: 6572 3d6e 702e 4e61 4e29 0a20 2020 2020  er=np.NaN).     
+000130c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000130d0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+000130e0: 7572 6e20 5f73 6361 6c61 725f 6269 6e61  urn _scalar_bina
+000130f0: 7279 280a 2020 2020 2020 2020 2020 2020  ry(.            
+00013100: 2020 2020 2020 2020 6c61 6d62 6461 2078          lambda x
+00013110: 2c20 793a 2072 6573 756c 7420 6966 2078  , y: result if x
+00013120: 2069 7320 7920 656c 7365 206e 702e 4e61   is y else np.Na
+00013130: 4e2c 2063 6f6e 642c 2054 7275 650a 2020  N, cond, True.  
+00013140: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00013150: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00013160: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00013170: 2072 6573 756c 740a 0a20 2020 2070 726f   result..    pro
+00013180: 6475 6374 203d 2070 726f 6420 2023 2061  duct = prod  # a
+00013190: 6c69 6173 6564 2064 642e 7072 6f64 7563  liased dd.produc
+000131a0: 740a 0a20 2020 2040 6465 7269 7665 645f  t..    @derived_
+000131b0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+000131c0: 6529 0a20 2020 2064 6566 206d 6178 2873  e).    def max(s
+000131d0: 656c 662c 2061 7869 733d 302c 2073 6b69  elf, axis=0, ski
+000131e0: 706e 613d 5472 7565 2c20 7370 6c69 745f  pna=True, split_
+000131f0: 6576 6572 793d 4661 6c73 652c 206f 7574  every=False, out
+00013200: 3d4e 6f6e 652c 206e 756d 6572 6963 5f6f  =None, numeric_o
+00013210: 6e6c 793d 4e6f 6e65 293a 0a20 2020 2020  nly=None):.     
+00013220: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+00013230: 2020 2020 5041 4e44 4153 5f47 545f 3134      PANDAS_GT_14
+00013240: 300a 2020 2020 2020 2020 2020 2020 616e  0.            an
+00013250: 6420 6e6f 7420 5041 4e44 4153 5f47 545f  d not PANDAS_GT_
+00013260: 3230 300a 2020 2020 2020 2020 2020 2020  200.            
+00013270: 616e 6420 6178 6973 2069 7320 4e6f 6e65  and axis is None
+00013280: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00013290: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+000132a0: 2c20 4461 7461 4672 616d 6529 0a20 2020  , DataFrame).   
+000132b0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+000132c0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+000132d0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+000132e0: 2020 2022 496e 2061 2066 7574 7572 6520     "In a future 
+000132f0: 7665 7273 696f 6e2c 2044 6174 6146 7261  version, DataFra
+00013300: 6d65 2e6d 6178 2861 7869 733d 4e6f 6e65  me.max(axis=None
+00013310: 2920 7769 6c6c 2072 6574 7572 6e20 6120  ) will return a 
+00013320: 7363 616c 6172 206d 6178 206f 7665 7220  scalar max over 
+00013330: 7468 6520 656e 7469 7265 2044 6174 6146  the entire DataF
+00013340: 7261 6d65 2e20 220a 2020 2020 2020 2020  rame. ".        
+00013350: 2020 2020 2020 2020 2254 6f20 7265 7461          "To reta
+00013360: 696e 2074 6865 206f 6c64 2062 6568 6176  in the old behav
+00013370: 696f 722c 2075 7365 2027 6672 616d 652e  ior, use 'frame.
+00013380: 6d61 7828 6178 6973 3d30 2927 206f 7220  max(axis=0)' or 
+00013390: 6a75 7374 2027 6672 616d 652e 6d61 7828  just 'frame.max(
+000133a0: 2927 222c 0a20 2020 2020 2020 2020 2020  )'",.           
+000133b0: 2020 2020 2046 7574 7572 6557 6172 6e69       FutureWarni
+000133c0: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
+000133d0: 290a 2020 2020 2020 2020 2020 2020 6178  ).            ax
+000133e0: 6973 203d 2030 0a0a 2020 2020 2020 2020  is = 0..        
+000133f0: 7265 7475 726e 2073 656c 662e 5f72 6564  return self._red
+00013400: 7563 7469 6f6e 5f61 6767 280a 2020 2020  uction_agg(.    
+00013410: 2020 2020 2020 2020 226d 6178 222c 0a20          "max",. 
+00013420: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+00013430: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+00013440: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
+00013450: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+00013460: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+00013470: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
+00013480: 2020 6f75 743d 6f75 742c 0a20 2020 2020    out=out,.     
+00013490: 2020 2020 2020 2023 2053 7461 7274 696e         # Startin
+000134a0: 6720 696e 2070 616e 6461 7320 322e 302c  g in pandas 2.0,
+000134b0: 2060 6178 6973 3d4e 6f6e 6560 2064 6f65   `axis=None` doe
+000134c0: 7320 6120 6675 6c6c 2061 6767 7265 6761  s a full aggrega
+000134d0: 7469 6f6e 2061 6372 6f73 7320 626f 7468  tion across both
+000134e0: 2061 7865 730a 2020 2020 2020 2020 2020   axes.          
+000134f0: 2020 6e6f 6e65 5f69 735f 7a65 726f 3d6e    none_is_zero=n
+00013500: 6f74 2050 414e 4441 535f 4754 5f32 3030  ot PANDAS_GT_200
+00013510: 2c0a 2020 2020 2020 2020 2020 2020 6e75  ,.            nu
+00013520: 6d65 7269 635f 6f6e 6c79 3d6e 756d 6572  meric_only=numer
+00013530: 6963 5f6f 6e6c 792c 0a20 2020 2020 2020  ic_only,.       
+00013540: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
+00013550: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00013560: 6d65 290a 2020 2020 6465 6620 6d69 6e28  me).    def min(
+00013570: 7365 6c66 2c20 6178 6973 3d30 2c20 736b  self, axis=0, sk
+00013580: 6970 6e61 3d54 7275 652c 2073 706c 6974  ipna=True, split
+00013590: 5f65 7665 7279 3d46 616c 7365 2c20 6f75  _every=False, ou
+000135a0: 743d 4e6f 6e65 2c20 6e75 6d65 7269 635f  t=None, numeric_
+000135b0: 6f6e 6c79 3d4e 6f6e 6529 3a0a 2020 2020  only=None):.    
+000135c0: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
+000135d0: 2020 2020 2050 414e 4441 535f 4754 5f31       PANDAS_GT_1
+000135e0: 3430 0a20 2020 2020 2020 2020 2020 2061  40.            a
+000135f0: 6e64 206e 6f74 2050 414e 4441 535f 4754  nd not PANDAS_GT
+00013600: 5f32 3030 0a20 2020 2020 2020 2020 2020  _200.           
+00013610: 2061 6e64 2061 7869 7320 6973 204e 6f6e   and axis is Non
+00013620: 650a 2020 2020 2020 2020 2020 2020 616e  e.            an
+00013630: 6420 6973 696e 7374 616e 6365 2873 656c  d isinstance(sel
+00013640: 662c 2044 6174 6146 7261 6d65 290a 2020  f, DataFrame).  
+00013650: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00013660: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00013670: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+00013680: 2020 2020 2249 6e20 6120 6675 7475 7265      "In a future
+00013690: 2076 6572 7369 6f6e 2c20 4461 7461 4672   version, DataFr
+000136a0: 616d 652e 6d69 6e28 6178 6973 3d4e 6f6e  ame.min(axis=Non
+000136b0: 6529 2077 696c 6c20 7265 7475 726e 2061  e) will return a
+000136c0: 2073 6361 6c61 7220 6d69 6e20 6f76 6572   scalar min over
+000136d0: 2074 6865 2065 6e74 6972 6520 4461 7461   the entire Data
+000136e0: 4672 616d 652e 2022 0a20 2020 2020 2020  Frame. ".       
+000136f0: 2020 2020 2020 2020 2022 546f 2072 6574           "To ret
+00013700: 6169 6e20 7468 6520 6f6c 6420 6265 6861  ain the old beha
+00013710: 7669 6f72 2c20 7573 6520 2766 7261 6d65  vior, use 'frame
+00013720: 2e6d 696e 2861 7869 733d 3029 2720 6f72  .min(axis=0)' or
+00013730: 206a 7573 7420 2766 7261 6d65 2e6d 696e   just 'frame.min
+00013740: 2829 2722 2c0a 2020 2020 2020 2020 2020  ()'",.          
+00013750: 2020 2020 2020 4675 7475 7265 5761 726e        FutureWarn
+00013760: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
+00013770: 2029 0a20 2020 2020 2020 2020 2020 2061   ).            a
+00013780: 7869 7320 3d20 300a 0a20 2020 2020 2020  xis = 0..       
+00013790: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
+000137a0: 6475 6374 696f 6e5f 6167 6728 0a20 2020  duction_agg(.   
+000137b0: 2020 2020 2020 2020 2022 6d69 6e22 2c0a           "min",.
+000137c0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+000137d0: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
+000137e0: 2020 2073 6b69 706e 613d 736b 6970 6e61     skipna=skipna
+000137f0: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+00013800: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+00013810: 6576 6572 792c 0a20 2020 2020 2020 2020  every,.         
+00013820: 2020 206f 7574 3d6f 7574 2c0a 2020 2020     out=out,.    
+00013830: 2020 2020 2020 2020 2320 5374 6172 7469          # Starti
+00013840: 6e67 2069 6e20 7061 6e64 6173 2032 2e30  ng in pandas 2.0
+00013850: 2c20 6061 7869 733d 4e6f 6e65 6020 646f  , `axis=None` do
+00013860: 6573 2061 2066 756c 6c20 6167 6772 6567  es a full aggreg
+00013870: 6174 696f 6e20 6163 726f 7373 2062 6f74  ation across bot
+00013880: 6820 6178 6573 0a20 2020 2020 2020 2020  h axes.         
+00013890: 2020 206e 6f6e 655f 6973 5f7a 6572 6f3d     none_is_zero=
+000138a0: 6e6f 7420 5041 4e44 4153 5f47 545f 3230  not PANDAS_GT_20
+000138b0: 302c 0a20 2020 2020 2020 2020 2020 206e  0,.            n
+000138c0: 756d 6572 6963 5f6f 6e6c 793d 6e75 6d65  umeric_only=nume
+000138d0: 7269 635f 6f6e 6c79 2c0a 2020 2020 2020  ric_only,.      
+000138e0: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
+000138f0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00013900: 616d 6529 0a20 2020 2064 6566 2069 6478  ame).    def idx
+00013910: 6d61 7828 0a20 2020 2020 2020 2073 656c  max(.        sel
+00013920: 662c 2061 7869 733d 4e6f 6e65 2c20 736b  f, axis=None, sk
+00013930: 6970 6e61 3d54 7275 652c 2073 706c 6974  ipna=True, split
+00013940: 5f65 7665 7279 3d46 616c 7365 2c20 6e75  _every=False, nu
+00013950: 6d65 7269 635f 6f6e 6c79 3d6e 6f5f 6465  meric_only=no_de
+00013960: 6661 756c 740a 2020 2020 293a 0a20 2020  fault.    ):.   
+00013970: 2020 2020 2066 6e20 3d20 2269 6478 6d61       fn = "idxma
+00013980: 7822 0a20 2020 2020 2020 2061 7869 7320  x".        axis 
+00013990: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
+000139a0: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
+000139b0: 2020 2020 6e75 6d65 7269 635f 6f6e 6c79      numeric_only
+000139c0: 5f6b 7761 7267 7320 3d20 6368 6563 6b5f  _kwargs = check_
+000139d0: 6e75 6d65 7269 635f 6f6e 6c79 5f76 616c  numeric_only_val
+000139e0: 6964 286e 756d 6572 6963 5f6f 6e6c 792c  id(numeric_only,
+000139f0: 2022 6964 786d 6178 2229 0a20 2020 2020   "idxmax").     
+00013a00: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+00013a10: 6d65 7461 5f6e 6f6e 656d 7074 792e 6964  meta_nonempty.id
+00013a20: 786d 6178 280a 2020 2020 2020 2020 2020  xmax(.          
+00013a30: 2020 6178 6973 3d61 7869 732c 2073 6b69    axis=axis, ski
+00013a40: 706e 613d 736b 6970 6e61 2c20 2a2a 6e75  pna=skipna, **nu
+00013a50: 6d65 7269 635f 6f6e 6c79 5f6b 7761 7267  meric_only_kwarg
+00013a60: 730a 2020 2020 2020 2020 290a 2020 2020  s.        ).    
+00013a70: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
+00013a80: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00013a90: 7475 726e 206d 6170 5f70 6172 7469 7469  turn map_partiti
+00013aa0: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+00013ab0: 2020 2020 204d 2e69 6478 6d61 782c 0a20       M.idxmax,. 
+00013ac0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00013ad0: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+00013ae0: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
+00013af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013b00: 746f 6b65 6e3d 7365 6c66 2e5f 746f 6b65  token=self._toke
+00013b10: 6e5f 7072 6566 6978 202b 2066 6e2c 0a20  n_prefix + fn,. 
+00013b20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00013b30: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
+00013b40: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00013b50: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+00013b60: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
+00013b70: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
+00013b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013b90: 202a 2a6e 756d 6572 6963 5f6f 6e6c 795f   **numeric_only_
+00013ba0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+00013bb0: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
+00013bc0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00013bd0: 7363 616c 6172 203d 206e 6f74 2069 735f  scalar = not is_
+00013be0: 7365 7269 6573 5f6c 696b 6528 6d65 7461  series_like(meta
+00013bf0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00013c00: 7375 6c74 203d 2061 6361 280a 2020 2020  sult = aca(.    
+00013c10: 2020 2020 2020 2020 2020 2020 5b73 656c              [sel
+00013c20: 665d 2c0a 2020 2020 2020 2020 2020 2020  f],.            
+00013c30: 2020 2020 6368 756e 6b3d 6964 786d 6178      chunk=idxmax
+00013c40: 6d69 6e5f 6368 756e 6b2c 0a20 2020 2020  min_chunk,.     
+00013c50: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
+00013c60: 6761 7465 3d69 6478 6d61 786d 696e 5f61  gate=idxmaxmin_a
+00013c70: 6767 2c0a 2020 2020 2020 2020 2020 2020  gg,.            
+00013c80: 2020 2020 636f 6d62 696e 653d 6964 786d      combine=idxm
+00013c90: 6178 6d69 6e5f 636f 6d62 696e 652c 0a20  axmin_combine,. 
+00013ca0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00013cb0: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
+00013cc0: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
+00013cd0: 6174 655f 6b77 6172 6773 3d7b 2273 6361  ate_kwargs={"sca
+00013ce0: 6c61 7222 3a20 7363 616c 6172 7d2c 0a20  lar": scalar},. 
+00013cf0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00013d00: 6f6b 656e 3d73 656c 662e 5f74 6f6b 656e  oken=self._token
+00013d10: 5f70 7265 6669 7820 2b20 666e 2c0a 2020  _prefix + fn,.  
+00013d20: 2020 2020 2020 2020 2020 2020 2020 7370                sp
+00013d30: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+00013d40: 6576 6572 792c 0a20 2020 2020 2020 2020  every,.         
+00013d50: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
+00013d60: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
+00013d70: 2020 2020 2020 666e 3d66 6e2c 0a20 2020        fn=fn,.   
+00013d80: 2020 2020 2020 2020 2020 2020 202a 2a6e               **n
+00013d90: 756d 6572 6963 5f6f 6e6c 795f 6b77 6172  umeric_only_kwar
+00013da0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+00013db0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00013dc0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+00013dd0: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
+00013de0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00013df0: 7375 6c74 2e64 6976 6973 696f 6e73 203d  sult.divisions =
+00013e00: 2028 6d69 6e28 7365 6c66 2e63 6f6c 756d   (min(self.colum
+00013e10: 6e73 292c 206d 6178 2873 656c 662e 636f  ns), max(self.co
+00013e20: 6c75 6d6e 7329 290a 2020 2020 2020 2020  lumns)).        
+00013e30: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
+00013e40: 740a 0a20 2020 2040 6465 7269 7665 645f  t..    @derived_
+00013e50: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00013e60: 6529 0a20 2020 2064 6566 2069 6478 6d69  e).    def idxmi
+00013e70: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
+00013e80: 2061 7869 733d 4e6f 6e65 2c20 736b 6970   axis=None, skip
+00013e90: 6e61 3d54 7275 652c 2073 706c 6974 5f65  na=True, split_e
+00013ea0: 7665 7279 3d46 616c 7365 2c20 6e75 6d65  very=False, nume
+00013eb0: 7269 635f 6f6e 6c79 3d6e 6f5f 6465 6661  ric_only=no_defa
+00013ec0: 756c 740a 2020 2020 293a 0a20 2020 2020  ult.    ):.     
+00013ed0: 2020 2066 6e20 3d20 2269 6478 6d69 6e22     fn = "idxmin"
+00013ee0: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
+00013ef0: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
+00013f00: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
+00013f10: 2020 6e75 6d65 7269 635f 6f6e 6c79 5f6b    numeric_only_k
+00013f20: 7761 7267 7320 3d20 6368 6563 6b5f 6e75  wargs = check_nu
+00013f30: 6d65 7269 635f 6f6e 6c79 5f76 616c 6964  meric_only_valid
+00013f40: 286e 756d 6572 6963 5f6f 6e6c 792c 2022  (numeric_only, "
+00013f50: 6964 786d 6178 2229 0a20 2020 2020 2020  idxmax").       
+00013f60: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+00013f70: 7461 5f6e 6f6e 656d 7074 792e 6964 786d  ta_nonempty.idxm
+00013f80: 6178 280a 2020 2020 2020 2020 2020 2020  ax(.            
+00013f90: 6178 6973 3d61 7869 732c 2073 6b69 706e  axis=axis, skipn
+00013fa0: 613d 736b 6970 6e61 2c20 2a2a 6e75 6d65  a=skipna, **nume
+00013fb0: 7269 635f 6f6e 6c79 5f6b 7761 7267 730a  ric_only_kwargs.
+00013fc0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00013fd0: 2020 6966 2061 7869 7320 3d3d 2031 3a0a    if axis == 1:.
+00013fe0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00013ff0: 726e 206d 6170 5f70 6172 7469 7469 6f6e  rn map_partition
+00014000: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00014010: 2020 204d 2e69 6478 6d69 6e2c 0a20 2020     M.idxmin,.   
+00014020: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00014030: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
+00014040: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
+00014050: 2020 2020 2020 2020 2020 2020 2020 746f                to
+00014060: 6b65 6e3d 7365 6c66 2e5f 746f 6b65 6e5f  ken=self._token_
+00014070: 7072 6566 6978 202b 2066 6e2c 0a20 2020  prefix + fn,.   
+00014080: 2020 2020 2020 2020 2020 2020 2073 6b69               ski
+00014090: 706e 613d 736b 6970 6e61 2c0a 2020 2020  pna=skipna,.    
+000140a0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+000140b0: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
+000140c0: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
+000140d0: 6574 6164 6174 613d 4661 6c73 652c 0a20  etadata=False,. 
+000140e0: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+000140f0: 2a6e 756d 6572 6963 5f6f 6e6c 795f 6b77  *numeric_only_kw
+00014100: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
+00014110: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+00014120: 3a0a 2020 2020 2020 2020 2020 2020 7363  :.            sc
+00014130: 616c 6172 203d 206e 6f74 2069 735f 7365  alar = not is_se
+00014140: 7269 6573 5f6c 696b 6528 6d65 7461 290a  ries_like(meta).
+00014150: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00014160: 6c74 203d 2061 6361 280a 2020 2020 2020  lt = aca(.      
+00014170: 2020 2020 2020 2020 2020 5b73 656c 665d            [self]
+00014180: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00014190: 2020 6368 756e 6b3d 6964 786d 6178 6d69    chunk=idxmaxmi
+000141a0: 6e5f 6368 756e 6b2c 0a20 2020 2020 2020  n_chunk,.       
+000141b0: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
+000141c0: 7465 3d69 6478 6d61 786d 696e 5f61 6767  te=idxmaxmin_agg
+000141d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000141e0: 2020 636f 6d62 696e 653d 6964 786d 6178    combine=idxmax
+000141f0: 6d69 6e5f 636f 6d62 696e 652c 0a20 2020  min_combine,.   
+00014200: 2020 2020 2020 2020 2020 2020 206d 6574               met
+00014210: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
+00014220: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+00014230: 655f 6b77 6172 6773 3d7b 2273 6361 6c61  e_kwargs={"scala
+00014240: 7222 3a20 7363 616c 6172 7d2c 0a20 2020  r": scalar},.   
+00014250: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
+00014260: 656e 3d73 656c 662e 5f74 6f6b 656e 5f70  en=self._token_p
+00014270: 7265 6669 7820 2b20 666e 2c0a 2020 2020  refix + fn,.    
+00014280: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+00014290: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+000142a0: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+000142b0: 2020 2020 2073 6b69 706e 613d 736b 6970       skipna=skip
+000142c0: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
+000142d0: 2020 2020 666e 3d66 6e2c 0a20 2020 2020      fn=fn,.     
+000142e0: 2020 2020 2020 2020 2020 202a 2a6e 756d             **num
+000142f0: 6572 6963 5f6f 6e6c 795f 6b77 6172 6773  eric_only_kwargs
+00014300: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00014310: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00014320: 7369 6e73 7461 6e63 6528 7365 6c66 2c20  sinstance(self, 
+00014330: 4461 7461 4672 616d 6529 3a0a 2020 2020  DataFrame):.    
+00014340: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00014350: 6c74 2e64 6976 6973 696f 6e73 203d 2028  lt.divisions = (
+00014360: 6d69 6e28 7365 6c66 2e63 6f6c 756d 6e73  min(self.columns
+00014370: 292c 206d 6178 2873 656c 662e 636f 6c75  ), max(self.colu
+00014380: 6d6e 7329 290a 2020 2020 2020 2020 2020  mns)).          
+00014390: 2020 7265 7475 726e 2072 6573 756c 740a    return result.
+000143a0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+000143b0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+000143c0: 0a20 2020 2064 6566 2063 6f75 6e74 2873  .    def count(s
+000143d0: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
+000143e0: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+000143f0: 652c 206e 756d 6572 6963 5f6f 6e6c 793d  e, numeric_only=
+00014400: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00014410: 2320 5468 6973 206d 6574 686f 6420 6973  # This method is
+00014420: 2073 6861 7265 6420 6279 2044 6174 6146   shared by DataF
+00014430: 7261 6d65 202f 2053 6572 6965 732c 2062  rame / Series, b
+00014440: 7574 206f 6e6c 7920 4461 7461 4672 616d  ut only DataFram
+00014450: 650a 2020 2020 2020 2020 2320 7375 7070  e.        # supp
+00014460: 6f72 7473 2060 6e75 6d65 7269 635f 6f6e  orts `numeric_on
+00014470: 6c79 3d60 2e20 4861 6e64 6c65 2061 6363  ly=`. Handle acc
+00014480: 6f72 6469 6e67 6c79 2068 6572 652e 0a20  ordingly here.. 
+00014490: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
+000144a0: 6e6c 795f 6b77 6172 6773 203d 207b 7d0a  nly_kwargs = {}.
+000144b0: 2020 2020 2020 2020 6966 2069 735f 6461          if is_da
+000144c0: 7461 6672 616d 655f 6c69 6b65 2873 656c  taframe_like(sel
+000144d0: 6629 3a0a 2020 2020 2020 2020 2020 2020  f):.            
+000144e0: 6e75 6d65 7269 635f 6f6e 6c79 5f6b 7761  numeric_only_kwa
+000144f0: 7267 7320 3d20 6765 745f 6e75 6d65 7269  rgs = get_numeri
+00014500: 635f 6f6e 6c79 5f6b 7761 7267 7328 6e75  c_only_kwargs(nu
+00014510: 6d65 7269 635f 6f6e 6c79 290a 2020 2020  meric_only).    
+00014520: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
+00014530: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
+00014540: 7869 7329 0a20 2020 2020 2020 2074 6f6b  xis).        tok
+00014550: 656e 203d 2073 656c 662e 5f74 6f6b 656e  en = self._token
+00014560: 5f70 7265 6669 7820 2b20 2263 6f75 6e74  _prefix + "count
+00014570: 220a 2020 2020 2020 2020 6966 2061 7869  ".        if axi
+00014580: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
+00014590: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
+000145a0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e63  _meta_nonempty.c
+000145b0: 6f75 6e74 2861 7869 733d 6178 6973 2c20  ount(axis=axis, 
+000145c0: 2a2a 6e75 6d65 7269 635f 6f6e 6c79 5f6b  **numeric_only_k
+000145d0: 7761 7267 7329 0a20 2020 2020 2020 2020  wargs).         
+000145e0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+000145f0: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+00014600: 2020 2020 2020 2020 2020 2020 2020 204d                 M
+00014610: 2e63 6f75 6e74 2c0a 2020 2020 2020 2020  .count,.        
+00014620: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
+00014630: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+00014640: 2020 2074 6f6b 656e 3d74 6f6b 656e 2c0a     token=token,.
+00014650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014660: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
+00014670: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
+00014680: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+00014690: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+000146a0: 2020 202a 2a6e 756d 6572 6963 5f6f 6e6c     **numeric_onl
+000146b0: 795f 6b77 6172 6773 2c0a 2020 2020 2020  y_kwargs,.      
+000146c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000146d0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000146e0: 2020 6d65 7461 203d 2073 656c 662e 5f6d    meta = self._m
+000146f0: 6574 615f 6e6f 6e65 6d70 7479 2e63 6f75  eta_nonempty.cou
+00014700: 6e74 2829 0a0a 2020 2020 2020 2020 2020  nt()..          
+00014710: 2020 2320 4e65 6564 2074 6865 2061 7374    # Need the ast
+00014720: 7970 6528 696e 7429 2066 6f72 2065 6d70  ype(int) for emp
+00014730: 7479 2064 6174 6166 7261 6d65 732c 2077  ty dataframes, w
+00014740: 6869 6368 2073 756d 2074 6f20 666c 6f61  hich sum to floa
+00014750: 7420 6474 7970 650a 2020 2020 2020 2020  t dtype.        
+00014760: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
+00014770: 662e 7265 6475 6374 696f 6e28 0a20 2020  f.reduction(.   
+00014780: 2020 2020 2020 2020 2020 2020 204d 2e63               M.c
+00014790: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
+000147a0: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
+000147b0: 5f63 6f75 6e74 5f61 6767 7265 6761 7465  _count_aggregate
+000147c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000147d0: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
+000147e0: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
+000147f0: 656e 3d74 6f6b 656e 2c0a 2020 2020 2020  en=token,.      
+00014800: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
+00014810: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00014820: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00014830: 2020 2063 6875 6e6b 5f6b 7761 7267 733d     chunk_kwargs=
+00014840: 6e75 6d65 7269 635f 6f6e 6c79 5f6b 7761  numeric_only_kwa
+00014850: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+00014860: 2029 0a20 2020 2020 2020 2020 2020 2069   ).            i
+00014870: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
+00014880: 662c 2044 6174 6146 7261 6d65 293a 0a20  f, DataFrame):. 
+00014890: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000148a0: 6573 756c 742e 6469 7669 7369 6f6e 7320  esult.divisions 
+000148b0: 3d20 2873 656c 662e 636f 6c75 6d6e 732e  = (self.columns.
+000148c0: 6d69 6e28 292c 2073 656c 662e 636f 6c75  min(), self.colu
+000148d0: 6d6e 732e 6d61 7828 2929 0a20 2020 2020  mns.max()).     
+000148e0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+000148f0: 7375 6c74 0a0a 2020 2020 4064 6572 6976  sult..    @deriv
+00014900: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00014910: 7261 6d65 290a 2020 2020 6465 6620 6d6f  rame).    def mo
+00014920: 6465 2873 656c 662c 2064 726f 706e 613d  de(self, dropna=
+00014930: 5472 7565 2c20 7370 6c69 745f 6576 6572  True, split_ever
+00014940: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
+00014950: 2020 6d6f 6465 5f73 6572 6965 7320 3d20    mode_series = 
+00014960: 7365 6c66 2e72 6564 7563 7469 6f6e 280a  self.reduction(.
+00014970: 2020 2020 2020 2020 2020 2020 6368 756e              chun
+00014980: 6b3d 4d2e 7661 6c75 655f 636f 756e 7473  k=M.value_counts
+00014990: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+000149a0: 6d62 696e 653d 4d2e 7375 6d2c 0a20 2020  mbine=M.sum,.   
+000149b0: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
+000149c0: 7465 3d5f 6d6f 6465 5f61 6767 7265 6761  te=_mode_aggrega
+000149d0: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+000149e0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+000149f0: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
+00014a00: 2020 2020 2063 6875 6e6b 5f6b 7761 7267       chunk_kwarg
+00014a10: 733d 7b22 6472 6f70 6e61 223a 2064 726f  s={"dropna": dro
+00014a20: 706e 617d 2c0a 2020 2020 2020 2020 2020  pna},.          
+00014a30: 2020 6167 6772 6567 6174 655f 6b77 6172    aggregate_kwar
+00014a40: 6773 3d7b 2264 726f 706e 6122 3a20 6472  gs={"dropna": dr
+00014a50: 6f70 6e61 7d2c 0a20 2020 2020 2020 2029  opna},.        )
+00014a60: 0a20 2020 2020 2020 206d 6f64 655f 7365  .        mode_se
+00014a70: 7269 6573 2e6e 616d 6520 3d20 7365 6c66  ries.name = self
+00014a80: 2e6e 616d 650a 2020 2020 2020 2020 7265  .name.        re
+00014a90: 7475 726e 206d 6f64 655f 7365 7269 6573  turn mode_series
+00014aa0: 0a0a 2020 2020 405f 6e75 6d65 7269 635f  ..    @_numeric_
+00014ab0: 6f6e 6c79 0a20 2020 2040 6465 7269 7665  only.    @derive
+00014ac0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00014ad0: 616d 6529 0a20 2020 2064 6566 206d 6561  ame).    def mea
+00014ae0: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
+00014af0: 0a20 2020 2020 2020 2061 7869 733d 302c  .        axis=0,
+00014b00: 0a20 2020 2020 2020 2073 6b69 706e 613d  .        skipna=
+00014b10: 5472 7565 2c0a 2020 2020 2020 2020 7370  True,.        sp
+00014b20: 6c69 745f 6576 6572 793d 4661 6c73 652c  lit_every=False,
+00014b30: 0a20 2020 2020 2020 2064 7479 7065 3d4e  .        dtype=N
+00014b40: 6f6e 652c 0a20 2020 2020 2020 206f 7574  one,.        out
+00014b50: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
+00014b60: 756d 6572 6963 5f6f 6e6c 793d 4e6f 6e65  umeric_only=None
+00014b70: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+00014b80: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
+00014b90: 2020 5041 4e44 4153 5f47 545f 3134 300a    PANDAS_GT_140.
+00014ba0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00014bb0: 6e6f 7420 5041 4e44 4153 5f47 545f 3230  not PANDAS_GT_20
+00014bc0: 300a 2020 2020 2020 2020 2020 2020 616e  0.            an
+00014bd0: 6420 6178 6973 2069 7320 4e6f 6e65 0a20  d axis is None. 
+00014be0: 2020 2020 2020 2020 2020 2061 6e64 2069             and i
+00014bf0: 7369 6e73 7461 6e63 6528 7365 6c66 2c20  sinstance(self, 
+00014c00: 4461 7461 4672 616d 6529 0a20 2020 2020  DataFrame).     
+00014c10: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00014c20: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+00014c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014c40: 2022 496e 2061 2066 7574 7572 6520 7665   "In a future ve
+00014c50: 7273 696f 6e2c 2044 6174 6146 7261 6d65  rsion, DataFrame
+00014c60: 2e6d 6561 6e28 6178 6973 3d4e 6f6e 6529  .mean(axis=None)
+00014c70: 2077 696c 6c20 7265 7475 726e 2061 2073   will return a s
+00014c80: 6361 6c61 7220 6d65 616e 206f 7665 7220  calar mean over 
+00014c90: 7468 6520 656e 7469 7265 2044 6174 6146  the entire DataF
+00014ca0: 7261 6d65 2e20 220a 2020 2020 2020 2020  rame. ".        
+00014cb0: 2020 2020 2020 2020 2254 6f20 7265 7461          "To reta
+00014cc0: 696e 2074 6865 206f 6c64 2062 6568 6176  in the old behav
+00014cd0: 696f 722c 2075 7365 2027 6672 616d 652e  ior, use 'frame.
+00014ce0: 6d65 616e 2861 7869 733d 3029 2720 6f72  mean(axis=0)' or
+00014cf0: 206a 7573 7420 2766 7261 6d65 2e6d 6561   just 'frame.mea
+00014d00: 6e28 2927 222c 0a20 2020 2020 2020 2020  n()'",.         
+00014d10: 2020 2020 2020 2046 7574 7572 6557 6172         FutureWar
+00014d20: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
+00014d30: 2020 290a 2020 2020 2020 2020 6178 6973    ).        axis
+00014d40: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
+00014d50: 655f 6178 6973 2861 7869 732c 206e 6f6e  e_axis(axis, non
+00014d60: 655f 6973 5f7a 6572 6f3d 6e6f 7420 5041  e_is_zero=not PA
+00014d70: 4e44 4153 5f47 545f 3230 3029 0a20 2020  NDAS_GT_200).   
+00014d80: 2020 2020 205f 7261 6973 655f 6966 5f6f       _raise_if_o
+00014d90: 626a 6563 745f 7365 7269 6573 2873 656c  bject_series(sel
+00014da0: 662c 2022 6d65 616e 2229 0a20 2020 2020  f, "mean").     
+00014db0: 2020 2023 204e 4f54 453a 2044 6f20 7765     # NOTE: Do we
+00014dc0: 2077 616e 7420 746f 2077 6172 6e20 6865   want to warn he
+00014dd0: 7265 3f0a 2020 2020 2020 2020 7769 7468  re?.        with
+00014de0: 2063 6865 636b 5f6e 756d 6572 6963 5f6f   check_numeric_o
+00014df0: 6e6c 795f 6465 7072 6563 6174 696f 6e28  nly_deprecation(
+00014e00: 292c 2063 6865 636b 5f6e 7569 7361 6e63  ), check_nuisanc
+00014e10: 655f 636f 6c75 6d6e 735f 7761 726e 696e  e_columns_warnin
+00014e20: 6728 293a 0a20 2020 2020 2020 2020 2020  g():.           
+00014e30: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+00014e40: 7461 5f6e 6f6e 656d 7074 792e 6d65 616e  ta_nonempty.mean
+00014e50: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00014e60: 2020 6178 6973 3d61 7869 732c 2073 6b69    axis=axis, ski
+00014e70: 706e 613d 736b 6970 6e61 2c20 6e75 6d65  pna=skipna, nume
+00014e80: 7269 635f 6f6e 6c79 3d6e 756d 6572 6963  ric_only=numeric
+00014e90: 5f6f 6e6c 790a 2020 2020 2020 2020 2020  _only.          
+00014ea0: 2020 290a 2020 2020 2020 2020 6966 2061    ).        if a
+00014eb0: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
+00014ec0: 2020 2020 2020 7265 7375 6c74 203d 206d        result = m
+00014ed0: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+00014ee0: 2020 2020 2020 2020 2020 2020 2020 204d                 M
+00014ef0: 2e6d 6561 6e2c 0a20 2020 2020 2020 2020  .mean,.         
+00014f00: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00014f10: 2020 2020 2020 2020 2020 2020 206d 6574               met
+00014f20: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
+00014f30: 2020 2020 2020 2020 746f 6b65 6e3d 7365          token=se
+00014f40: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
+00014f50: 202b 2022 6d65 616e 222c 0a20 2020 2020   + "mean",.     
+00014f60: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+00014f70: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+00014f80: 2020 2020 2020 736b 6970 6e61 3d73 6b69        skipna=ski
+00014f90: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
+00014fa0: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
+00014fb0: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
+00014fc0: 2020 2020 2020 2020 2020 2020 206e 756d               num
+00014fd0: 6572 6963 5f6f 6e6c 793d 6e75 6d65 7269  eric_only=numeri
+00014fe0: 635f 6f6e 6c79 2c0a 2020 2020 2020 2020  c_only,.        
+00014ff0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00015000: 2020 7265 7475 726e 2068 616e 646c 655f    return handle_
+00015010: 6f75 7428 6f75 742c 2072 6573 756c 7429  out(out, result)
+00015020: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00015030: 2020 2020 2020 2020 2020 206e 756d 203d             num =
+00015040: 2073 656c 662e 5f67 6574 5f6e 756d 6572   self._get_numer
+00015050: 6963 5f64 6174 6128 290a 2020 2020 2020  ic_data().      
+00015060: 2020 2020 2020 7320 3d20 6e75 6d2e 7375        s = num.su
+00015070: 6d28 736b 6970 6e61 3d73 6b69 706e 612c  m(skipna=skipna,
+00015080: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+00015090: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
+000150a0: 2020 2020 2020 6e20 3d20 6e75 6d2e 636f        n = num.co
+000150b0: 756e 7428 7370 6c69 745f 6576 6572 793d  unt(split_every=
+000150c0: 7370 6c69 745f 6576 6572 7929 0a20 2020  split_every).   
+000150d0: 2020 2020 2020 2020 2023 2053 7461 7274           # Start
+000150e0: 696e 6720 696e 2070 616e 6461 7320 322e  ing in pandas 2.
+000150f0: 302c 2060 6178 6973 3d4e 6f6e 6560 2064  0, `axis=None` d
+00015100: 6f65 7320 6120 6675 6c6c 2061 6767 7265  oes a full aggre
+00015110: 6761 7469 6f6e 2061 6372 6f73 7320 626f  gation across bo
+00015120: 7468 2061 7865 730a 2020 2020 2020 2020  th axes.        
+00015130: 2020 2020 6966 2050 414e 4441 535f 4754      if PANDAS_GT
+00015140: 5f32 3030 2061 6e64 2061 7869 7320 6973  _200 and axis is
+00015150: 204e 6f6e 6520 616e 6420 6973 696e 7374   None and isinst
+00015160: 616e 6365 2873 656c 662c 2044 6174 6146  ance(self, DataF
+00015170: 7261 6d65 293a 0a20 2020 2020 2020 2020  rame):.         
+00015180: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00015190: 732e 7375 6d28 2920 2f20 6e2e 7375 6d28  s.sum() / n.sum(
+000151a0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+000151b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000151c0: 2020 2020 6e61 6d65 203d 2073 656c 662e      name = self.
+000151d0: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
+000151e0: 226d 6561 6e2d 2573 2220 2520 746f 6b65  "mean-%s" % toke
+000151f0: 6e69 7a65 2873 656c 662c 2061 7869 732c  nize(self, axis,
+00015200: 2073 6b69 706e 6129 0a20 2020 2020 2020   skipna).       
+00015210: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+00015220: 3d20 6d61 705f 7061 7274 6974 696f 6e73  = map_partitions
+00015230: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00015240: 2020 2020 2020 6d65 7468 6f64 732e 6d65        methods.me
+00015250: 616e 5f61 6767 7265 6761 7465 2c0a 2020  an_aggregate,.  
+00015260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015270: 2020 732c 0a20 2020 2020 2020 2020 2020    s,.           
+00015280: 2020 2020 2020 2020 206e 2c0a 2020 2020           n,.    
+00015290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000152a0: 746f 6b65 6e3d 6e61 6d65 2c0a 2020 2020  token=name,.    
+000152b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000152c0: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
+000152d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000152e0: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+000152f0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+00015300: 2020 2020 2020 2020 2020 2070 6172 656e             paren
+00015310: 745f 6d65 7461 3d73 656c 662e 5f6d 6574  t_meta=self._met
+00015320: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+00015330: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00015340: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00015350: 6365 2873 656c 662c 2044 6174 6146 7261  ce(self, DataFra
+00015360: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
+00015370: 2020 2020 2020 2020 2072 6573 756c 742e           result.
+00015380: 6469 7669 7369 6f6e 7320 3d20 2873 656c  divisions = (sel
+00015390: 662e 636f 6c75 6d6e 732e 6d69 6e28 292c  f.columns.min(),
+000153a0: 2073 656c 662e 636f 6c75 6d6e 732e 6d61   self.columns.ma
+000153b0: 7828 2929 0a20 2020 2020 2020 2020 2020  x()).           
+000153c0: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
+000153d0: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
+000153e0: 0a20 2020 2064 6566 206d 6564 6961 6e5f  .    def median_
+000153f0: 6170 7072 6f78 696d 6174 6528 0a20 2020  approximate(.   
+00015400: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00015410: 2020 2061 7869 733d 4e6f 6e65 2c0a 2020     axis=None,.  
+00015420: 2020 2020 2020 6d65 7468 6f64 3d22 6465        method="de
+00015430: 6661 756c 7422 2c0a 2020 2020 293a 0a20  fault",.    ):. 
+00015440: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+00015450: 2074 6865 2061 7070 726f 7869 6d61 7465   the approximate
+00015460: 206d 6564 6961 6e20 6f66 2074 6865 2076   median of the v
+00015470: 616c 7565 7320 6f76 6572 2074 6865 2072  alues over the r
+00015480: 6571 7565 7374 6564 2061 7869 732e 0a0a  equested axis...
+00015490: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+000154a0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+000154b0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6178  -----.        ax
+000154c0: 6973 203a 207b 302c 2031 2c20 2269 6e64  is : {0, 1, "ind
+000154d0: 6578 222c 2022 636f 6c75 6d6e 7322 7d20  ex", "columns"} 
+000154e0: 2864 6566 6175 6c74 2030 290a 2020 2020  (default 0).    
+000154f0: 2020 2020 2020 2020 3020 6f72 2060 6022          0 or ``"
+00015500: 696e 6465 7822 6060 2066 6f72 2072 6f77  index"`` for row
+00015510: 2d77 6973 652c 2031 206f 7220 6060 2263  -wise, 1 or ``"c
+00015520: 6f6c 756d 6e73 2260 6020 666f 7220 636f  olumns"`` for co
+00015530: 6c75 6d6e 2d77 6973 650a 2020 2020 2020  lumn-wise.      
+00015540: 2020 6d65 7468 6f64 203a 207b 2764 6566    method : {'def
+00015550: 6175 6c74 272c 2027 7464 6967 6573 7427  ault', 'tdigest'
+00015560: 2c20 2764 6173 6b27 7d2c 206f 7074 696f  , 'dask'}, optio
+00015570: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00015580: 5768 6174 206d 6574 686f 6420 746f 2075  What method to u
+00015590: 7365 2e20 4279 2064 6566 6175 6c74 2077  se. By default w
+000155a0: 696c 6c20 7573 6520 4461 736b 2773 2069  ill use Dask's i
+000155b0: 6e74 6572 6e61 6c20 6375 7374 6f6d 0a20  nternal custom. 
+000155c0: 2020 2020 2020 2020 2020 2061 6c67 6f72             algor
+000155d0: 6974 686d 2028 6060 2264 6173 6b22 6060  ithm (``"dask"``
+000155e0: 292e 2020 4966 2073 6574 2074 6f20 6060  ).  If set to ``
+000155f0: 2274 6469 6765 7374 2260 6020 7769 6c6c  "tdigest"`` will
+00015600: 2075 7365 2074 6469 6765 7374 0a20 2020   use tdigest.   
+00015610: 2020 2020 2020 2020 2066 6f72 2066 6c6f           for flo
+00015620: 6174 7320 616e 6420 696e 7473 2061 6e64  ats and ints and
+00015630: 2066 616c 6c62 6163 6b20 746f 2074 6865   fallback to the
+00015640: 2060 6022 6461 736b 2260 6020 6f74 6865   ``"dask"`` othe
+00015650: 7277 6973 652e 0a20 2020 2020 2020 2022  rwise..        "
+00015660: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00015670: 6e20 7365 6c66 2e71 7561 6e74 696c 6528  n self.quantile(
+00015680: 713d 302e 352c 2061 7869 733d 6178 6973  q=0.5, axis=axis
+00015690: 2c20 6d65 7468 6f64 3d6d 6574 686f 6429  , method=method)
+000156a0: 2e72 656e 616d 6528 4e6f 6e65 290a 0a20  .rename(None).. 
+000156b0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+000156c0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+000156d0: 2020 2064 6566 206d 6564 6961 6e28 7365     def median(se
+000156e0: 6c66 2c20 6178 6973 3d4e 6f6e 652c 206d  lf, axis=None, m
+000156f0: 6574 686f 643d 2264 6566 6175 6c74 2229  ethod="default")
+00015700: 3a0a 2020 2020 2020 2020 6966 2061 7869  :.        if axi
+00015710: 7320 696e 2028 312c 2022 636f 6c75 6d6e  s in (1, "column
+00015720: 7322 2920 6f72 2073 656c 662e 6e70 6172  s") or self.npar
+00015730: 7469 7469 6f6e 7320 3d3d 2031 3a0a 2020  titions == 1:.  
+00015740: 2020 2020 2020 2020 2020 2320 4361 6e20            # Can 
+00015750: 7072 6f76 6964 6520 616e 2065 7861 6374  provide an exact
+00015760: 206d 6564 6961 6e20 696e 2074 6865 7365   median in these
+00015770: 2063 6173 6573 0a20 2020 2020 2020 2020   cases.         
+00015780: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+00015790: 6564 6961 6e5f 6170 7072 6f78 696d 6174  edian_approximat
+000157a0: 6528 6178 6973 3d61 7869 732c 206d 6574  e(axis=axis, met
+000157b0: 686f 643d 6d65 7468 6f64 290a 2020 2020  hod=method).    
+000157c0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+000157d0: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
+000157e0: 2020 2020 2020 2020 2020 2022 4461 736b             "Dask
+000157f0: 2064 6f65 736e 2774 2069 6d70 6c65 6d65   doesn't impleme
+00015800: 6e74 2061 6e20 6578 6163 7420 6d65 6469  nt an exact medi
+00015810: 616e 2069 6e20 616c 6c20 6361 7365 7320  an in all cases 
+00015820: 6173 2074 6869 7320 6973 2068 6172 6420  as this is hard 
+00015830: 746f 2064 6f20 696e 2070 6172 616c 6c65  to do in paralle
+00015840: 6c2e 2022 0a20 2020 2020 2020 2020 2020  l. ".           
+00015850: 2022 5365 6520 7468 6520 606d 6564 6961   "See the `media
+00015860: 6e5f 6170 7072 6f78 696d 6174 6560 206d  n_approximate` m
+00015870: 6574 686f 6420 696e 7374 6561 642c 2077  ethod instead, w
+00015880: 6869 6368 2075 7365 7320 616e 2061 7070  hich uses an app
+00015890: 726f 7869 6d61 7465 2061 6c67 6f72 6974  roximate algorit
+000158a0: 686d 2e22 0a20 2020 2020 2020 2029 0a0a  hm.".        )..
+000158b0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+000158c0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+000158d0: 2020 2020 6465 6620 7661 7228 0a20 2020      def var(.   
+000158e0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000158f0: 2020 2061 7869 733d 4e6f 6e65 2c0a 2020     axis=None,.  
+00015900: 2020 2020 2020 736b 6970 6e61 3d54 7275        skipna=Tru
+00015910: 652c 0a20 2020 2020 2020 2064 646f 663d  e,.        ddof=
+00015920: 312c 0a20 2020 2020 2020 2073 706c 6974  1,.        split
+00015930: 5f65 7665 7279 3d46 616c 7365 2c0a 2020  _every=False,.  
+00015940: 2020 2020 2020 6474 7970 653d 4e6f 6e65        dtype=None
+00015950: 2c0a 2020 2020 2020 2020 6f75 743d 4e6f  ,.        out=No
+00015960: 6e65 2c0a 2020 2020 2020 2020 6e75 6d65  ne,.        nume
+00015970: 7269 635f 6f6e 6c79 3d6e 6f5f 6465 6661  ric_only=no_defa
+00015980: 756c 742c 0a20 2020 2029 3a0a 2020 2020  ult,.    ):.    
+00015990: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
+000159a0: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
+000159b0: 7869 7329 0a20 2020 2020 2020 205f 7261  xis).        _ra
+000159c0: 6973 655f 6966 5f6f 626a 6563 745f 7365  ise_if_object_se
+000159d0: 7269 6573 2873 656c 662c 2022 7661 7222  ries(self, "var"
+000159e0: 290a 2020 2020 2020 2020 6e75 6d65 7269  ).        numeri
+000159f0: 635f 6f6e 6c79 5f6b 7761 7267 7320 3d20  c_only_kwargs = 
+00015a00: 6765 745f 6e75 6d65 7269 635f 6f6e 6c79  get_numeric_only
+00015a10: 5f6b 7761 7267 7328 6e75 6d65 7269 635f  _kwargs(numeric_
+00015a20: 6f6e 6c79 290a 2020 2020 2020 2020 7769  only).        wi
+00015a30: 7468 2063 6865 636b 5f6e 756d 6572 6963  th check_numeric
+00015a40: 5f6f 6e6c 795f 6465 7072 6563 6174 696f  _only_deprecatio
+00015a50: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
+00015a60: 7661 7222 2c20 5472 7565 0a20 2020 2020  var", True.     
+00015a70: 2020 2029 2c20 6368 6563 6b5f 7265 6475     ), check_redu
+00015a80: 6374 696f 6e73 5f72 756e 7469 6d65 5f77  ctions_runtime_w
+00015a90: 6172 6e69 6e67 2829 3a0a 2020 2020 2020  arning():.      
+00015aa0: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
+00015ab0: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
+00015ac0: 2e76 6172 280a 2020 2020 2020 2020 2020  .var(.          
+00015ad0: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
+00015ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015af0: 2073 6b69 706e 613d 736b 6970 6e61 2c0a   skipna=skipna,.
+00015b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b10: 2a2a 6e75 6d65 7269 635f 6f6e 6c79 5f6b  **numeric_only_k
+00015b20: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
+00015b30: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+00015b40: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
+00015b50: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00015b60: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+00015b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b80: 4d2e 7661 722c 0a20 2020 2020 2020 2020  M.var,.         
+00015b90: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00015ba0: 2020 2020 2020 2020 2020 2020 206d 6574               met
+00015bb0: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
+00015bc0: 2020 2020 2020 2020 746f 6b65 6e3d 7365          token=se
+00015bd0: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
+00015be0: 202b 2022 7661 7222 2c0a 2020 2020 2020   + "var",.      
+00015bf0: 2020 2020 2020 2020 2020 6178 6973 3d61            axis=a
+00015c00: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
+00015c10: 2020 2020 2073 6b69 706e 613d 736b 6970       skipna=skip
+00015c20: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
+00015c30: 2020 2020 6464 6f66 3d64 646f 662c 0a20      ddof=ddof,. 
+00015c40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00015c50: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+00015c60: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+00015c70: 2020 2020 2020 202a 2a6e 756d 6572 6963         **numeric
+00015c80: 5f6f 6e6c 795f 6b77 6172 6773 2c0a 2020  _only_kwargs,.  
+00015c90: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00015ca0: 2020 2020 2020 2020 7265 7475 726e 2068          return h
+00015cb0: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
+00015cc0: 6573 756c 7429 0a20 2020 2020 2020 2065  esult).        e
+00015cd0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00015ce0: 2069 6620 7365 6c66 2e6e 6469 6d20 3d3d   if self.ndim ==
+00015cf0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00015d00: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
+00015d10: 662e 5f76 6172 5f31 6428 7365 6c66 2c20  f._var_1d(self, 
+00015d20: 736b 6970 6e61 2c20 6464 6f66 2c20 7370  skipna, ddof, sp
+00015d30: 6c69 745f 6576 6572 7929 0a20 2020 2020  lit_every).     
+00015d40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00015d50: 6e20 6861 6e64 6c65 5f6f 7574 286f 7574  n handle_out(out
+00015d60: 2c20 7265 7375 6c74 290a 0a20 2020 2020  , result)..     
+00015d70: 2020 2020 2020 2023 2070 616e 6461 7320         # pandas 
+00015d80: 312e 302b 2064 6f65 7320 6e6f 7420 696d  1.0+ does not im
+00015d90: 706c 656d 656e 7420 7661 7220 6f6e 2074  plement var on t
+00015da0: 696d 6564 656c 7461 0a20 2020 2020 2020  imedelta.       
+00015db0: 2020 2020 2072 6573 756c 7420 3d20 7365       result = se
+00015dc0: 6c66 2e5f 7661 725f 6e75 6d65 7269 6328  lf._var_numeric(
+00015dd0: 736b 6970 6e61 2c20 6464 6f66 2c20 7370  skipna, ddof, sp
+00015de0: 6c69 745f 6576 6572 7929 0a0a 2020 2020  lit_every)..    
+00015df0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00015e00: 7461 6e63 6528 7365 6c66 2c20 4461 7461  tance(self, Data
+00015e10: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
+00015e20: 2020 2020 2020 2020 7265 7375 6c74 2e64          result.d
+00015e30: 6976 6973 696f 6e73 203d 2028 7365 6c66  ivisions = (self
+00015e40: 2e63 6f6c 756d 6e73 2e6d 696e 2829 2c20  .columns.min(), 
+00015e50: 7365 6c66 2e63 6f6c 756d 6e73 2e6d 6178  self.columns.max
+00015e60: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
+00015e70: 7265 7475 726e 2068 616e 646c 655f 6f75  return handle_ou
+00015e80: 7428 6f75 742c 2072 6573 756c 7429 0a0a  t(out, result)..
+00015e90: 2020 2020 6465 6620 5f76 6172 5f6e 756d      def _var_num
+00015ea0: 6572 6963 2873 656c 662c 2073 6b69 706e  eric(self, skipn
+00015eb0: 613d 5472 7565 2c20 6464 6f66 3d31 2c20  a=True, ddof=1, 
+00015ec0: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+00015ed0: 6529 3a0a 2020 2020 2020 2020 6e75 6d20  e):.        num 
+00015ee0: 3d20 7365 6c66 2e73 656c 6563 745f 6474  = self.select_dt
+00015ef0: 7970 6573 2869 6e63 6c75 6465 3d5b 226e  ypes(include=["n
+00015f00: 756d 6265 7222 2c20 2262 6f6f 6c22 5d2c  umber", "bool"],
+00015f10: 2065 7863 6c75 6465 3d5b 6e70 2e74 696d   exclude=[np.tim
+00015f20: 6564 656c 7461 3634 5d29 0a0a 2020 2020  edelta64])..    
+00015f30: 2020 2020 7661 6c75 6573 5f64 7479 7065      values_dtype
+00015f40: 203d 206e 756d 2e76 616c 7565 732e 6474   = num.values.dt
+00015f50: 7970 650a 2020 2020 2020 2020 6172 7261  ype.        arra
+00015f60: 795f 7661 6c75 6573 203d 206e 756d 2e76  y_values = num.v
+00015f70: 616c 7565 730a 0a20 2020 2020 2020 2069  alues..        i
+00015f80: 6620 6e6f 7420 6e70 2e69 7373 7562 6474  f not np.issubdt
+00015f90: 7970 6528 7661 6c75 6573 5f64 7479 7065  ype(values_dtype
+00015fa0: 2c20 6e70 2e6e 756d 6265 7229 3a0a 2020  , np.number):.  
+00015fb0: 2020 2020 2020 2020 2020 6172 7261 795f            array_
+00015fc0: 7661 6c75 6573 203d 206e 756d 2e76 616c  values = num.val
+00015fd0: 7565 732e 6173 7479 7065 2822 6638 2229  ues.astype("f8")
+00015fe0: 0a0a 2020 2020 2020 2020 7661 7220 3d20  ..        var = 
+00015ff0: 6461 2e6e 616e 7661 7220 6966 2073 6b69  da.nanvar if ski
+00016000: 706e 6120 6f72 2073 6b69 706e 6120 6973  pna or skipna is
+00016010: 204e 6f6e 6520 656c 7365 2064 612e 7661   None else da.va
+00016020: 720a 2020 2020 2020 2020 6172 7261 795f  r.        array_
+00016030: 7661 7220 3d20 7661 7228 6172 7261 795f  var = var(array_
+00016040: 7661 6c75 6573 2c20 6178 6973 3d30 2c20  values, axis=0, 
+00016050: 6464 6f66 3d64 646f 662c 2073 706c 6974  ddof=ddof, split
+00016060: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+00016070: 7279 290a 0a20 2020 2020 2020 206e 616d  ry)..        nam
+00016080: 6520 3d20 7365 6c66 2e5f 746f 6b65 6e5f  e = self._token_
+00016090: 7072 6566 6978 202b 2022 7661 722d 6e75  prefix + "var-nu
+000160a0: 6d65 7269 6322 202b 2074 6f6b 656e 697a  meric" + tokeniz
+000160b0: 6528 6e75 6d2c 2073 706c 6974 5f65 7665  e(num, split_eve
+000160c0: 7279 290a 2020 2020 2020 2020 636f 6c73  ry).        cols
+000160d0: 203d 206e 756d 2e5f 6d65 7461 2e63 6f6c   = num._meta.col
+000160e0: 756d 6e73 2069 6620 6973 5f64 6174 6166  umns if is_dataf
+000160f0: 7261 6d65 5f6c 696b 6528 6e75 6d29 2065  rame_like(num) e
+00016100: 6c73 6520 4e6f 6e65 0a0a 2020 2020 2020  lse None..      
+00016110: 2020 7769 7468 2063 6865 636b 5f72 6564    with check_red
+00016120: 7563 7469 6f6e 735f 7275 6e74 696d 655f  uctions_runtime_
+00016130: 7761 726e 696e 6728 293a 0a20 2020 2020  warning():.     
+00016140: 2020 2020 2020 206d 6574 615f 636f 6d70         meta_comp
+00016150: 7574 6174 696f 6e20 3d20 6e75 6d2e 5f6d  utation = num._m
+00016160: 6574 615f 6e6f 6e65 6d70 7479 2e76 6172  eta_nonempty.var
+00016170: 2861 7869 733d 3029 0a20 2020 2020 2020  (axis=0).       
+00016180: 2076 6172 5f73 6861 7065 203d 206d 6574   var_shape = met
+00016190: 615f 636f 6d70 7574 6174 696f 6e2e 7368  a_computation.sh
+000161a0: 6170 650a 2020 2020 2020 2020 6172 7261  ape.        arra
+000161b0: 795f 7661 725f 6e61 6d65 203d 2028 6172  y_var_name = (ar
+000161c0: 7261 795f 7661 722e 5f6e 616d 652c 2920  ray_var._name,) 
+000161d0: 2b20 2830 2c29 202a 206c 656e 2876 6172  + (0,) * len(var
+000161e0: 5f73 6861 7065 290a 0a20 2020 2020 2020  _shape)..       
+000161f0: 206c 6179 6572 203d 207b 286e 616d 652c   layer = {(name,
+00016200: 2030 293a 2028 6d65 7468 6f64 732e 7772   0): (methods.wr
+00016210: 6170 5f76 6172 5f72 6564 7563 7469 6f6e  ap_var_reduction
+00016220: 2c20 6172 7261 795f 7661 725f 6e61 6d65  , array_var_name
+00016230: 2c20 636f 6c73 297d 0a20 2020 2020 2020  , cols)}.       
+00016240: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+00016250: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+00016260: 6c65 6374 696f 6e73 286e 616d 652c 206c  lections(name, l
+00016270: 6179 6572 2c20 6465 7065 6e64 656e 6369  ayer, dependenci
+00016280: 6573 3d5b 6172 7261 795f 7661 725d 290a  es=[array_var]).
+00016290: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000162a0: 6e65 775f 6464 5f6f 626a 6563 7428 6772  new_dd_object(gr
+000162b0: 6170 682c 206e 616d 652c 206d 6574 615f  aph, name, meta_
+000162c0: 636f 6d70 7574 6174 696f 6e2c 2064 6976  computation, div
+000162d0: 6973 696f 6e73 3d5b 4e6f 6e65 2c20 4e6f  isions=[None, No
+000162e0: 6e65 5d29 0a0a 2020 2020 6465 6620 5f76  ne])..    def _v
+000162f0: 6172 5f31 6428 7365 6c66 2c20 636f 6c75  ar_1d(self, colu
+00016300: 6d6e 2c20 736b 6970 6e61 3d54 7275 652c  mn, skipna=True,
+00016310: 2064 646f 663d 312c 2073 706c 6974 5f65   ddof=1, split_e
+00016320: 7665 7279 3d46 616c 7365 293a 0a20 2020  very=False):.   
+00016330: 2020 2020 2069 735f 7469 6d65 6465 6c74       is_timedelt
+00016340: 6120 3d20 6973 5f74 696d 6564 656c 7461  a = is_timedelta
+00016350: 3634 5f64 7479 7065 2863 6f6c 756d 6e2e  64_dtype(column.
+00016360: 5f6d 6574 6129 0a0a 2020 2020 2020 2020  _meta)..        
+00016370: 6966 2069 735f 7469 6d65 6465 6c74 613a  if is_timedelta:
+00016380: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00016390: 6e6f 7420 736b 6970 6e61 3a0a 2020 2020  not skipna:.    
+000163a0: 2020 2020 2020 2020 2020 2020 6973 5f6e              is_n
+000163b0: 616e 203d 2063 6f6c 756d 6e2e 6973 6e61  an = column.isna
+000163c0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+000163d0: 2020 2063 6f6c 756d 6e20 3d20 636f 6c75     column = colu
+000163e0: 6d6e 2e61 7374 7970 6528 2269 3822 290a  mn.astype("i8").
+000163f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016400: 636f 6c75 6d6e 203d 2063 6f6c 756d 6e2e  column = column.
+00016410: 6d61 736b 2869 735f 6e61 6e29 0a20 2020  mask(is_nan).   
+00016420: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00016430: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00016440: 6f6c 756d 6e20 3d20 636f 6c75 6d6e 2e64  olumn = column.d
+00016450: 726f 706e 6128 292e 6173 7479 7065 2822  ropna().astype("
+00016460: 6938 2229 0a0a 2020 2020 2020 2020 6966  i8")..        if
+00016470: 2070 642e 6170 692e 7479 7065 732e 6973   pd.api.types.is
+00016480: 5f65 7874 656e 7369 6f6e 5f61 7272 6179  _extension_array
+00016490: 5f64 7479 7065 2863 6f6c 756d 6e2e 5f6d  _dtype(column._m
+000164a0: 6574 615f 6e6f 6e65 6d70 7479 293a 0a20  eta_nonempty):. 
+000164b0: 2020 2020 2020 2020 2020 2023 2044 6f6e             # Don
+000164c0: 2774 2068 6176 6520 746f 2077 6f72 7279  't have to worry
+000164d0: 2061 626f 7574 206e 6f6e 2d6e 756d 6572   about non-numer
+000164e0: 6963 2c20 7468 6973 2072 6169 7365 7320  ic, this raises 
+000164f0: 6561 726c 6965 720a 2020 2020 2020 2020  earlier.        
+00016500: 2020 2020 636f 6c75 6d6e 203d 2063 6f6c      column = col
+00016510: 756d 6e2e 6173 7479 7065 2822 6638 2229  umn.astype("f8")
+00016520: 0a0a 2020 2020 2020 2020 656c 6966 206e  ..        elif n
+00016530: 6f74 206e 702e 6973 7375 6264 7479 7065  ot np.issubdtype
+00016540: 2863 6f6c 756d 6e2e 6474 7970 652c 206e  (column.dtype, n
+00016550: 702e 6e75 6d62 6572 293a 0a20 2020 2020  p.number):.     
+00016560: 2020 2020 2020 2063 6f6c 756d 6e20 3d20         column = 
+00016570: 636f 6c75 6d6e 2e61 7374 7970 6528 2266  column.astype("f
+00016580: 3822 290a 0a20 2020 2020 2020 206e 616d  8")..        nam
+00016590: 6520 3d20 7365 6c66 2e5f 746f 6b65 6e5f  e = self._token_
+000165a0: 7072 6566 6978 202b 2022 7661 722d 3164  prefix + "var-1d
+000165b0: 2d22 202b 2074 6f6b 656e 697a 6528 636f  -" + tokenize(co
+000165c0: 6c75 6d6e 2c20 7370 6c69 745f 6576 6572  lumn, split_ever
+000165d0: 7929 0a0a 2020 2020 2020 2020 7661 7220  y)..        var 
+000165e0: 3d20 6461 2e6e 616e 7661 7220 6966 2073  = da.nanvar if s
+000165f0: 6b69 706e 6120 6f72 2073 6b69 706e 6120  kipna or skipna 
+00016600: 6973 204e 6f6e 6520 656c 7365 2064 612e  is None else da.
+00016610: 7661 720a 2020 2020 2020 2020 6172 7261  var.        arra
+00016620: 795f 7661 7220 3d20 7661 7228 636f 6c75  y_var = var(colu
+00016630: 6d6e 2e76 616c 7565 732c 2061 7869 733d  mn.values, axis=
+00016640: 302c 2064 646f 663d 6464 6f66 2c20 7370  0, ddof=ddof, sp
+00016650: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+00016660: 6576 6572 7929 0a0a 2020 2020 2020 2020  every)..        
+00016670: 6c61 7965 7220 3d20 7b28 6e61 6d65 2c20  layer = {(name, 
+00016680: 3029 3a20 286d 6574 686f 6473 2e77 7261  0): (methods.wra
+00016690: 705f 7661 725f 7265 6475 6374 696f 6e2c  p_var_reduction,
+000166a0: 2028 6172 7261 795f 7661 722e 5f6e 616d   (array_var._nam
+000166b0: 652c 292c 204e 6f6e 6529 7d0a 2020 2020  e,), None)}.    
+000166c0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
+000166d0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+000166e0: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
+000166f0: 2c20 6c61 7965 722c 2064 6570 656e 6465  , layer, depende
+00016700: 6e63 6965 733d 5b61 7272 6179 5f76 6172  ncies=[array_var
+00016710: 5d29 0a0a 2020 2020 2020 2020 7265 7475  ])..        retu
+00016720: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
+00016730: 280a 2020 2020 2020 2020 2020 2020 6772  (.            gr
+00016740: 6170 682c 206e 616d 652c 2063 6f6c 756d  aph, name, colum
+00016750: 6e2e 5f6d 6574 615f 6e6f 6e65 6d70 7479  n._meta_nonempty
+00016760: 2e76 6172 2829 2c20 6469 7669 7369 6f6e  .var(), division
+00016770: 733d 5b4e 6f6e 652c 204e 6f6e 655d 0a20  s=[None, None]. 
+00016780: 2020 2020 2020 2029 0a0a 2020 2020 405f         )..    @_
+00016790: 6e75 6d65 7269 635f 6461 7461 0a20 2020  numeric_data.   
+000167a0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+000167b0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+000167c0: 2064 6566 2073 7464 280a 2020 2020 2020   def std(.      
+000167d0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+000167e0: 6178 6973 3d4e 6f6e 652c 0a20 2020 2020  axis=None,.     
+000167f0: 2020 2073 6b69 706e 613d 5472 7565 2c0a     skipna=True,.
+00016800: 2020 2020 2020 2020 6464 6f66 3d31 2c0a          ddof=1,.
+00016810: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+00016820: 6572 793d 4661 6c73 652c 0a20 2020 2020  ery=False,.     
+00016830: 2020 2064 7479 7065 3d4e 6f6e 652c 0a20     dtype=None,. 
+00016840: 2020 2020 2020 206f 7574 3d4e 6f6e 652c         out=None,
+00016850: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
+00016860: 5f6f 6e6c 793d 6e6f 5f64 6566 6175 6c74  _only=no_default
+00016870: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+00016880: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
+00016890: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
+000168a0: 290a 2020 2020 2020 2020 5f72 6169 7365  ).        _raise
+000168b0: 5f69 665f 6f62 6a65 6374 5f73 6572 6965  _if_object_serie
+000168c0: 7328 7365 6c66 2c20 2273 7464 2229 0a20  s(self, "std"). 
+000168d0: 2020 2020 2020 205f 7261 6973 655f 6966         _raise_if
+000168e0: 5f6e 6f74 5f73 6572 6965 735f 6f72 5f64  _not_series_or_d
+000168f0: 6174 6166 7261 6d65 2873 656c 662c 2022  ataframe(self, "
+00016900: 7374 6422 290a 2020 2020 2020 2020 6e75  std").        nu
+00016910: 6d65 7269 635f 6b77 6172 6773 203d 2067  meric_kwargs = g
+00016920: 6574 5f6e 756d 6572 6963 5f6f 6e6c 795f  et_numeric_only_
+00016930: 6b77 6172 6773 286e 756d 6572 6963 5f6f  kwargs(numeric_o
+00016940: 6e6c 7929 0a0a 2020 2020 2020 2020 7769  nly)..        wi
+00016950: 7468 2063 6865 636b 5f6e 756d 6572 6963  th check_numeric
+00016960: 5f6f 6e6c 795f 6465 7072 6563 6174 696f  _only_deprecatio
+00016970: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
+00016980: 7374 6422 2c20 5472 7565 0a20 2020 2020  std", True.     
+00016990: 2020 2029 2c20 6368 6563 6b5f 7265 6475     ), check_redu
+000169a0: 6374 696f 6e73 5f72 756e 7469 6d65 5f77  ctions_runtime_w
+000169b0: 6172 6e69 6e67 2829 3a0a 2020 2020 2020  arning():.      
+000169c0: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
+000169d0: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
+000169e0: 2e73 7464 2861 7869 733d 6178 6973 2c20  .std(axis=axis, 
+000169f0: 736b 6970 6e61 3d73 6b69 706e 612c 202a  skipna=skipna, *
+00016a00: 2a6e 756d 6572 6963 5f6b 7761 7267 7329  *numeric_kwargs)
+00016a10: 0a20 2020 2020 2020 2069 735f 6466 5f6c  .        is_df_l
+00016a20: 696b 6520 3d20 6973 5f64 6174 6166 7261  ike = is_datafra
+00016a30: 6d65 5f6c 696b 6528 7365 6c66 2e5f 6d65  me_like(self._me
+00016a40: 7461 290a 2020 2020 2020 2020 6e65 6564  ta).        need
+00016a50: 735f 7469 6d65 5f63 6f6e 7665 7273 696f  s_time_conversio
+00016a60: 6e20 3d20 4661 6c73 650a 2020 2020 2020  n = False.      
+00016a70: 2020 6e75 6d65 7269 635f 6464 203d 2073    numeric_dd = s
+00016a80: 656c 660a 0a20 2020 2020 2020 2069 6620  elf..        if 
+00016a90: 6973 5f64 665f 6c69 6b65 3a0a 2020 2020  is_df_like:.    
+00016aa0: 2020 2020 2020 2020 7469 6d65 5f63 6f6c          time_col
+00016ab0: 7320 3d20 7365 6c66 2e5f 6d65 7461 2e73  s = self._meta.s
+00016ac0: 656c 6563 745f 6474 7970 6573 280a 2020  elect_dtypes(.  
+00016ad0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00016ae0: 636c 7564 653d 5b22 6461 7465 7469 6d65  clude=["datetime
+00016af0: 222c 2022 7469 6d65 6465 6c74 6122 5d0a  ", "timedelta"].
+00016b00: 2020 2020 2020 2020 2020 2020 292e 636f              ).co
+00016b10: 6c75 6d6e 730a 2020 2020 2020 2020 2020  lumns.          
+00016b20: 2020 6966 206c 656e 2874 696d 655f 636f    if len(time_co
+00016b30: 6c73 2920 3e20 303a 0a20 2020 2020 2020  ls) > 0:.       
+00016b40: 2020 2020 2020 2020 2028 0a20 2020 2020           (.     
+00016b50: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00016b60: 756d 6572 6963 5f64 642c 0a20 2020 2020  umeric_dd,.     
+00016b70: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00016b80: 6565 6473 5f74 696d 655f 636f 6e76 6572  eeds_time_conver
+00016b90: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
+00016ba0: 2020 2020 2020 2920 3d20 7365 6c66 2e5f        ) = self._
+00016bb0: 636f 6e76 6572 745f 7469 6d65 5f63 6f6c  convert_time_col
+00016bc0: 735f 746f 5f6e 756d 6572 6963 2874 696d  s_to_numeric(tim
+00016bd0: 655f 636f 6c73 2c20 6178 6973 2c20 6d65  e_cols, axis, me
+00016be0: 7461 2c20 736b 6970 6e61 290a 2020 2020  ta, skipna).    
+00016bf0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00016c00: 2020 2020 2020 6e65 6564 735f 7469 6d65        needs_time
+00016c10: 5f63 6f6e 7665 7273 696f 6e20 3d20 6973  _conversion = is
+00016c20: 5f64 6174 6574 696d 6536 345f 616e 795f  _datetime64_any_
+00016c30: 6474 7970 6528 7365 6c66 2e5f 6d65 7461  dtype(self._meta
+00016c40: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00016c50: 206e 6565 6473 5f74 696d 655f 636f 6e76   needs_time_conv
+00016c60: 6572 7369 6f6e 3a0a 2020 2020 2020 2020  ersion:.        
+00016c70: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
+00016c80: 6464 203d 205f 636f 6e76 6572 745f 746f  dd = _convert_to
+00016c90: 5f6e 756d 6572 6963 2873 656c 662c 2073  _numeric(self, s
+00016ca0: 6b69 706e 6129 0a0a 2020 2020 2020 2020  kipna)..        
+00016cb0: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
+00016cc0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00016cd0: 203d 206d 6170 5f70 6172 7469 7469 6f6e   = map_partition
+00016ce0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00016cf0: 2020 204d 2e73 7464 2069 6620 6e6f 7420     M.std if not 
+00016d00: 6e65 6564 735f 7469 6d65 5f63 6f6e 7665  needs_time_conve
+00016d10: 7273 696f 6e20 656c 7365 205f 7371 7274  rsion else _sqrt
+00016d20: 5f61 6e64 5f63 6f6e 7665 7274 5f74 6f5f  _and_convert_to_
+00016d30: 7469 6d65 6465 6c74 612c 0a20 2020 2020  timedelta,.     
+00016d40: 2020 2020 2020 2020 2020 206e 756d 6572             numer
+00016d50: 6963 5f64 642c 0a20 2020 2020 2020 2020  ic_dd,.         
+00016d60: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
+00016d70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00016d80: 2020 746f 6b65 6e3d 7365 6c66 2e5f 746f    token=self._to
+00016d90: 6b65 6e5f 7072 6566 6978 202b 2022 7374  ken_prefix + "st
+00016da0: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+00016db0: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
+00016dc0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00016dd0: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
+00016de0: 2020 2020 2020 2020 2020 2020 2020 6464                dd
+00016df0: 6f66 3d64 646f 662c 0a20 2020 2020 2020  of=ddof,.       
+00016e00: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
+00016e10: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
+00016e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016e30: 202a 2a6e 756d 6572 6963 5f6b 7761 7267   **numeric_kwarg
+00016e40: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00016e50: 2020 2070 6172 656e 745f 6d65 7461 3d73     parent_meta=s
+00016e60: 656c 662e 5f6d 6574 612c 0a20 2020 2020  elf._meta,.     
+00016e70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00016e80: 2020 2020 2072 6574 7572 6e20 6861 6e64       return hand
+00016e90: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
+00016ea0: 6c74 290a 0a20 2020 2020 2020 2023 2043  lt)..        # C
+00016eb0: 6173 6520 7768 6572 6520 6178 6973 3d30  ase where axis=0
+00016ec0: 206f 7220 6178 6973 3d4e 6f6e 650a 2020   or axis=None.  
+00016ed0: 2020 2020 2020 7620 3d20 6e75 6d65 7269        v = numeri
+00016ee0: 635f 6464 2e76 6172 2873 6b69 706e 613d  c_dd.var(skipna=
+00016ef0: 736b 6970 6e61 2c20 6464 6f66 3d64 646f  skipna, ddof=ddo
+00016f00: 662c 2073 706c 6974 5f65 7665 7279 3d73  f, split_every=s
+00016f10: 706c 6974 5f65 7665 7279 290a 2020 2020  plit_every).    
+00016f20: 2020 2020 6e61 6d65 203d 2073 656c 662e      name = self.
+00016f30: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
+00016f40: 2273 7464 220a 0a20 2020 2020 2020 2069  "std"..        i
+00016f50: 6620 6e65 6564 735f 7469 6d65 5f63 6f6e  f needs_time_con
+00016f60: 7665 7273 696f 6e3a 0a20 2020 2020 2020  version:.       
+00016f70: 2020 2020 2073 7172 745f 6675 6e63 5f6b       sqrt_func_k
+00016f80: 7761 7267 7320 3d20 7b0a 2020 2020 2020  wargs = {.      
+00016f90: 2020 2020 2020 2020 2020 2269 735f 6466            "is_df
+00016fa0: 5f6c 696b 6522 3a20 6973 5f64 665f 6c69  _like": is_df_li
+00016fb0: 6b65 2c0a 2020 2020 2020 2020 2020 2020  ke,.            
+00016fc0: 2020 2020 2274 696d 655f 636f 6c73 223a      "time_cols":
+00016fd0: 2074 696d 655f 636f 6c73 2069 6620 6973   time_cols if is
+00016fe0: 5f64 665f 6c69 6b65 2065 6c73 6520 4e6f  _df_like else No
+00016ff0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+00017000: 2020 2020 2261 7869 7322 3a20 6178 6973      "axis": axis
+00017010: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017020: 2020 2264 7479 7065 223a 2067 6574 6174    "dtype": getat
+00017030: 7472 286d 6574 612c 2022 6474 7970 6522  tr(meta, "dtype"
+00017040: 2c20 4e6f 6e65 292c 0a20 2020 2020 2020  , None),.       
+00017050: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+00017060: 2020 2073 7172 745f 6675 6e63 203d 205f     sqrt_func = _
+00017070: 7371 7274 5f61 6e64 5f63 6f6e 7665 7274  sqrt_and_convert
+00017080: 5f74 6f5f 7469 6d65 6465 6c74 610a 2020  _to_timedelta.  
+00017090: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000170a0: 2020 2020 2020 2020 7371 7274 5f66 756e          sqrt_fun
+000170b0: 635f 6b77 6172 6773 203d 207b 7d0a 2020  c_kwargs = {}.  
+000170c0: 2020 2020 2020 2020 2020 7371 7274 5f66            sqrt_f
+000170d0: 756e 6320 3d20 6e70 2e73 7172 740a 0a20  unc = np.sqrt.. 
+000170e0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+000170f0: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+00017100: 2020 2020 2020 2020 2020 2020 7371 7274              sqrt
+00017110: 5f66 756e 632c 0a20 2020 2020 2020 2020  _func,.         
+00017120: 2020 2076 2c0a 2020 2020 2020 2020 2020     v,.          
+00017130: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
+00017140: 2020 2020 2020 2020 2074 6f6b 656e 3d6e           token=n
+00017150: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00017160: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+00017170: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
+00017180: 2020 2020 2070 6172 656e 745f 6d65 7461       parent_meta
+00017190: 3d73 656c 662e 5f6d 6574 612c 0a20 2020  =self._meta,.   
+000171a0: 2020 2020 2020 2020 202a 2a73 7172 745f           **sqrt_
+000171b0: 6675 6e63 5f6b 7761 7267 732c 0a20 2020  func_kwargs,.   
+000171c0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+000171d0: 2320 5472 7920 746f 206d 6174 6368 2074  # Try to match t
+000171e0: 6865 2050 616e 6461 7320 7265 7375 6c74  he Pandas result
+000171f0: 2064 7479 7065 0a20 2020 2020 2020 2069   dtype.        i
+00017200: 6620 6973 5f64 665f 6c69 6b65 2061 6e64  f is_df_like and
+00017210: 2068 6173 6174 7472 286d 6574 612c 2022   hasattr(meta, "
+00017220: 6474 7970 6522 293a 0a20 2020 2020 2020  dtype"):.       
+00017230: 2020 2020 2072 6573 756c 7420 3d20 7265       result = re
+00017240: 7375 6c74 2e61 7374 7970 6528 6d65 7461  sult.astype(meta
+00017250: 2e64 7479 7065 290a 0a20 2020 2020 2020  .dtype)..       
+00017260: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
+00017270: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
+00017280: 0a20 2020 2064 6566 205f 636f 6e76 6572  .    def _conver
+00017290: 745f 7469 6d65 5f63 6f6c 735f 746f 5f6e  t_time_cols_to_n
+000172a0: 756d 6572 6963 2873 656c 662c 2074 696d  umeric(self, tim
+000172b0: 655f 636f 6c73 2c20 6178 6973 2c20 6d65  e_cols, axis, me
+000172c0: 7461 2c20 736b 6970 6e61 293a 0a20 2020  ta, skipna):.   
+000172d0: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
+000172e0: 6174 6166 7261 6d65 2e69 6f20 696d 706f  ataframe.io impo
+000172f0: 7274 2066 726f 6d5f 7061 6e64 6173 0a0a  rt from_pandas..
+00017300: 2020 2020 2020 2020 6e65 6564 735f 7469          needs_ti
+00017310: 6d65 5f63 6f6e 7665 7273 696f 6e20 3d20  me_conversion = 
+00017320: 5472 7565 0a0a 2020 2020 2020 2020 2320  True..        # 
+00017330: 456e 7375 7265 2061 6c6c 2063 6f6c 756d  Ensure all colum
+00017340: 6e73 2061 7265 2063 6f72 7265 6374 2074  ns are correct t
+00017350: 7970 652e 204e 6565 6420 746f 2073 6861  ype. Need to sha
+00017360: 6c6c 6f77 2063 6f70 7920 7369 6e63 6520  llow copy since 
+00017370: 636f 6c73 2077 696c 6c20 6265 206d 6f64  cols will be mod
+00017380: 6966 6965 640a 2020 2020 2020 2020 6966  ified.        if
+00017390: 2061 7869 7320 3d3d 2030 3a0a 2020 2020   axis == 0:.    
+000173a0: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
+000173b0: 6464 203d 2073 656c 665b 6d65 7461 2e69  dd = self[meta.i
+000173c0: 6e64 6578 5d2e 636f 7079 2829 0a20 2020  ndex].copy().   
+000173d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000173e0: 2020 2020 2020 206e 756d 6572 6963 5f64         numeric_d
+000173f0: 6420 3d20 7365 6c66 2e63 6f70 7928 290a  d = self.copy().
+00017400: 0a20 2020 2020 2020 2023 204d 6978 206f  .        # Mix o
+00017410: 6620 6461 7465 7469 6d65 7320 7769 7468  f datetimes with
+00017420: 206f 7468 6572 206e 756d 6572 6963 2074   other numeric t
+00017430: 7970 6573 2070 726f 6475 6365 7320 4e61  ypes produces Na
+00017440: 4e73 2066 6f72 2065 6163 6820 7661 6c75  Ns for each valu
+00017450: 6520 696e 2073 7464 2829 2073 6572 6965  e in std() serie
+00017460: 730a 2020 2020 2020 2020 6966 2061 7869  s.        if axi
+00017470: 7320 3d3d 2031 2061 6e64 206c 656e 2874  s == 1 and len(t
+00017480: 696d 655f 636f 6c73 2920 213d 206c 656e  ime_cols) != len
+00017490: 2873 656c 662e 636f 6c75 6d6e 7329 3a0a  (self.columns):.
+000174a0: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
+000174b0: 6973 2069 7320 6661 7374 6572 2074 6861  is is faster tha
+000174c0: 6e20 636f 6e76 6572 7469 6e67 2065 6163  n converting eac
+000174d0: 6820 636f 6c75 6d6e 2074 6f20 6e75 6d65  h column to nume
+000174e0: 7269 6320 7768 656e 2069 7427 7320 6e6f  ric when it's no
+000174f0: 7420 6e65 6365 7373 6172 790a 2020 2020  t necessary.    
+00017500: 2020 2020 2020 2020 2320 7369 6e63 6520          # since 
+00017510: 6561 6368 2073 7461 6e64 6172 6420 6465  each standard de
+00017520: 7669 6174 696f 6e20 7769 6c6c 206a 7573  viation will jus
+00017530: 7420 6265 204e 614e 0a20 2020 2020 2020  t be NaN.       
+00017540: 2020 2020 206e 6565 6473 5f74 696d 655f       needs_time_
+00017550: 636f 6e76 6572 7369 6f6e 203d 2046 616c  conversion = Fal
+00017560: 7365 0a20 2020 2020 2020 2020 2020 206e  se.            n
+00017570: 756d 6572 6963 5f64 6420 3d20 6672 6f6d  umeric_dd = from
+00017580: 5f70 616e 6461 7328 0a20 2020 2020 2020  _pandas(.       
+00017590: 2020 2020 2020 2020 206d 6574 615f 6672           meta_fr
+000175a0: 616d 655f 636f 6e73 7472 7563 746f 7228  ame_constructor(
+000175b0: 7365 6c66 2928 0a20 2020 2020 2020 2020  self)(.         
+000175c0: 2020 2020 2020 2020 2020 207b 225f 223a             {"_":
+000175d0: 206d 6574 615f 7365 7269 6573 5f63 6f6e   meta_series_con
+000175e0: 7374 7275 6374 6f72 2873 656c 6629 285b  structor(self)([
+000175f0: 6e70 2e6e 616e 5d29 7d2c 0a20 2020 2020  np.nan])},.     
+00017600: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00017610: 6e64 6578 3d73 656c 662e 696e 6465 782c  ndex=self.index,
+00017620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017630: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+00017640: 2020 2020 6e70 6172 7469 7469 6f6e 733d      npartitions=
+00017650: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
+00017660: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00017670: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00017680: 2020 2020 2020 2020 2020 2320 436f 6e76            # Conv
+00017690: 6572 7420 7469 6d65 6465 6c74 6120 616e  ert timedelta an
+000176a0: 6420 6461 7465 7469 6d65 2063 6f6c 756d  d datetime colum
+000176b0: 6e73 2074 6f20 696e 7465 6765 7220 7479  ns to integer ty
+000176c0: 7065 7320 736f 2077 6520 6361 6e20 7573  pes so we can us
+000176d0: 6520 7661 720a 2020 2020 2020 2020 2020  e var.          
+000176e0: 2020 666f 7220 636f 6c20 696e 2074 696d    for col in tim
+000176f0: 655f 636f 6c73 3a0a 2020 2020 2020 2020  e_cols:.        
+00017700: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
+00017710: 6464 5b63 6f6c 5d20 3d20 5f63 6f6e 7665  dd[col] = _conve
+00017720: 7274 5f74 6f5f 6e75 6d65 7269 6328 6e75  rt_to_numeric(nu
+00017730: 6d65 7269 635f 6464 5b63 6f6c 5d2c 2073  meric_dd[col], s
+00017740: 6b69 706e 6129 0a0a 2020 2020 2020 2020  kipna)..        
+00017750: 7265 7475 726e 206e 756d 6572 6963 5f64  return numeric_d
+00017760: 642c 206e 6565 6473 5f74 696d 655f 636f  d, needs_time_co
+00017770: 6e76 6572 7369 6f6e 0a0a 2020 2020 4064  nversion..    @d
+00017780: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00017790: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+000177a0: 6620 736b 6577 280a 2020 2020 2020 2020  f skew(.        
+000177b0: 7365 6c66 2c0a 2020 2020 2020 2020 6178  self,.        ax
+000177c0: 6973 3d30 2c0a 2020 2020 2020 2020 6269  is=0,.        bi
+000177d0: 6173 3d54 7275 652c 0a20 2020 2020 2020  as=True,.       
+000177e0: 206e 616e 5f70 6f6c 6963 793d 2270 726f   nan_policy="pro
+000177f0: 7061 6761 7465 222c 0a20 2020 2020 2020  pagate",.       
+00017800: 206f 7574 3d4e 6f6e 652c 0a20 2020 2020   out=None,.     
+00017810: 2020 206e 756d 6572 6963 5f6f 6e6c 793d     numeric_only=
+00017820: 6e6f 5f64 6566 6175 6c74 2c0a 2020 2020  no_default,.    
+00017830: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00017840: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+00017850: 0a0a 2020 2020 2020 2020 2020 2054 6869  ..           Thi
+00017860: 7320 696d 706c 656d 656e 7461 7469 6f6e  s implementation
+00017870: 2066 6f6c 6c6f 7773 2074 6865 2064 6173   follows the das
+00017880: 6b2e 6172 7261 792e 7374 6174 7320 696d  k.array.stats im
+00017890: 706c 656d 656e 7461 7469 6f6e 0a20 2020  plementation.   
+000178a0: 2020 2020 2020 2020 6f66 2073 6b65 776e          of skewn
+000178b0: 6573 7320 616e 6420 6361 6c63 756c 6174  ess and calculat
+000178c0: 6573 2073 6b65 776e 6573 7320 7769 7468  es skewness with
+000178d0: 6f75 7420 7461 6b69 6e67 2069 6e74 6f20  out taking into 
+000178e0: 6163 636f 756e 740a 2020 2020 2020 2020  account.        
+000178f0: 2020 2061 2062 6961 7320 7465 726d 2066     a bias term f
+00017900: 6f72 2066 696e 6974 6520 7361 6d70 6c65  or finite sample
+00017910: 2073 697a 652c 2077 6869 6368 2063 6f72   size, which cor
+00017920: 7265 7370 6f6e 6473 2074 6f20 7468 650a  responds to the.
+00017930: 2020 2020 2020 2020 2020 2064 6566 6175             defau
+00017940: 6c74 2073 6574 7469 6e67 7320 6f66 2074  lt settings of t
+00017950: 6865 2073 6369 7079 2e73 7461 7473 2073  he scipy.stats s
+00017960: 6b65 776e 6573 7320 6361 6c63 756c 6174  kewness calculat
+00017970: 696f 6e2e 2048 6f77 6576 6572 2c0a 2020  ion. However,.  
+00017980: 2020 2020 2020 2020 2050 616e 6461 7320           Pandas 
+00017990: 636f 7272 6563 7473 2066 6f72 2074 6869  corrects for thi
+000179a0: 732c 2073 6f20 7468 6520 7661 6c75 6573  s, so the values
+000179b0: 2064 6966 6665 7220 6279 2061 2066 6163   differ by a fac
+000179c0: 746f 7220 6f66 0a20 2020 2020 2020 2020  tor of.         
+000179d0: 2020 286e 202a 2028 6e20 2d20 3129 2920    (n * (n - 1)) 
+000179e0: 2a2a 2030 2e35 202f 2028 6e20 2d20 3229  ** 0.5 / (n - 2)
+000179f0: 2c20 7768 6572 6520 6e20 6973 2074 6865  , where n is the
+00017a00: 206e 756d 6265 7220 6f66 2073 616d 706c   number of sampl
+00017a10: 6573 2e0a 0a20 2020 2020 2020 2020 2020  es...           
+00017a20: 4675 7274 6865 722c 2074 6869 7320 6d65  Further, this me
+00017a30: 7468 6f64 2063 7572 7265 6e74 6c79 2064  thod currently d
+00017a40: 6f65 7320 6e6f 7420 7375 7070 6f72 7420  oes not support 
+00017a50: 6669 6c74 6572 696e 6720 6f75 7420 4e61  filtering out Na
+00017a60: 4e0a 2020 2020 2020 2020 2020 2076 616c  N.           val
+00017a70: 7565 732c 2077 6869 6368 2069 7320 6167  ues, which is ag
+00017a80: 6169 6e20 6120 6469 6666 6572 656e 6365  ain a difference
+00017a90: 2074 6f20 5061 6e64 6173 2e0a 2020 2020   to Pandas..    
+00017aa0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00017ab0: 6966 2050 414e 4441 535f 4754 5f32 3030  if PANDAS_GT_200
+00017ac0: 2061 6e64 2061 7869 7320 6973 204e 6f6e   and axis is Non
+00017ad0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00017ae0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00017af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017b00: 2022 6061 7869 733d 4e6f 6e65 6020 6973   "`axis=None` is
+00017b10: 6e27 7420 6375 7272 656e 746c 7920 7375  n't currently su
+00017b20: 7070 6f72 7465 6420 666f 7220 6073 6b65  pported for `ske
+00017b30: 7760 2077 6865 6e20 7573 696e 6720 6070  w` when using `p
+00017b40: 616e 6461 7320 3e3d 3260 2022 0a20 2020  andas >=2` ".   
+00017b50: 2020 2020 2020 2020 2020 2020 2066 2228               f"(
+00017b60: 7061 6e64 6173 3d7b 7374 7228 5041 4e44  pandas={str(PAND
+00017b70: 4153 5f56 4552 5349 4f4e 297d 2069 7320  AS_VERSION)} is 
+00017b80: 696e 7374 616c 6c65 6429 2e22 0a20 2020  installed).".   
+00017b90: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00017ba0: 2020 2061 7869 7320 3d20 7365 6c66 2e5f     axis = self._
+00017bb0: 7661 6c69 6461 7465 5f61 7869 7328 6178  validate_axis(ax
+00017bc0: 6973 290a 2020 2020 2020 2020 5f72 6169  is).        _rai
+00017bd0: 7365 5f69 665f 6f62 6a65 6374 5f73 6572  se_if_object_ser
+00017be0: 6965 7328 7365 6c66 2c20 2273 6b65 7722  ies(self, "skew"
+00017bf0: 290a 2020 2020 2020 2020 6e75 6d65 7269  ).        numeri
+00017c00: 635f 6f6e 6c79 5f6b 7761 7267 7320 3d20  c_only_kwargs = 
+00017c10: 6765 745f 6e75 6d65 7269 635f 6f6e 6c79  get_numeric_only
+00017c20: 5f6b 7761 7267 7328 6e75 6d65 7269 635f  _kwargs(numeric_
+00017c30: 6f6e 6c79 290a 0a20 2020 2020 2020 2069  only)..        i
+00017c40: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
+00017c50: 696b 6528 7365 6c66 293a 0a20 2020 2020  ike(self):.     
+00017c60: 2020 2020 2020 2023 204c 6574 2070 616e         # Let pan
+00017c70: 6461 7320 7261 6973 6520 6572 726f 7273  das raise errors
+00017c80: 2069 6620 6e65 6365 7373 6172 790a 2020   if necessary.  
+00017c90: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
+00017ca0: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
+00017cb0: 6d70 7479 2e73 6b65 7728 6178 6973 3d61  mpty.skew(axis=a
+00017cc0: 7869 732c 202a 2a6e 756d 6572 6963 5f6f  xis, **numeric_o
+00017cd0: 6e6c 795f 6b77 6172 6773 290a 2020 2020  nly_kwargs).    
+00017ce0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00017cf0: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
+00017d00: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
+00017d10: 2e73 6b65 7728 290a 0a20 2020 2020 2020  .skew()..       
+00017d20: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
+00017d30: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00017d40: 7420 3d20 6d61 705f 7061 7274 6974 696f  t = map_partitio
+00017d50: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+00017d60: 2020 2020 4d2e 736b 6577 2c0a 2020 2020      M.skew,.    
+00017d70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017d80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017d90: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
+00017da0: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
+00017db0: 656e 3d73 656c 662e 5f74 6f6b 656e 5f70  en=self._token_p
+00017dc0: 7265 6669 7820 2b20 2273 6b65 7722 2c0a  refix + "skew",.
+00017dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017de0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
+00017df0: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
+00017e00: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+00017e10: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
+00017e20: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00017e30: 7572 6e20 6861 6e64 6c65 5f6f 7574 286f  urn handle_out(o
+00017e40: 7574 2c20 7265 7375 6c74 290a 2020 2020  ut, result).    
+00017e50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00017e60: 2020 2020 2020 6966 2073 656c 662e 6e64        if self.nd
+00017e70: 696d 203d 3d20 313a 0a20 2020 2020 2020  im == 1:.       
+00017e80: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+00017e90: 3d20 7365 6c66 2e5f 736b 6577 5f31 6428  = self._skew_1d(
+00017ea0: 7365 6c66 2c20 6269 6173 3d62 6961 732c  self, bias=bias,
+00017eb0: 206e 616e 5f70 6f6c 6963 793d 6e61 6e5f   nan_policy=nan_
+00017ec0: 706f 6c69 6379 290a 2020 2020 2020 2020  policy).        
+00017ed0: 2020 2020 2020 2020 7265 7475 726e 2068          return h
+00017ee0: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
+00017ef0: 6573 756c 7429 0a20 2020 2020 2020 2020  esult).         
+00017f00: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00017f10: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+00017f20: 3d20 7365 6c66 2e5f 736b 6577 5f6e 756d  = self._skew_num
+00017f30: 6572 6963 2862 6961 733d 6269 6173 2c20  eric(bias=bias, 
+00017f40: 6e61 6e5f 706f 6c69 6379 3d6e 616e 5f70  nan_policy=nan_p
+00017f50: 6f6c 6963 7929 0a0a 2020 2020 2020 2020  olicy)..        
+00017f60: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00017f70: 6528 7365 6c66 2c20 4461 7461 4672 616d  e(self, DataFram
+00017f80: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00017f90: 2020 2020 7265 7375 6c74 2e64 6976 6973      result.divis
+00017fa0: 696f 6e73 203d 2028 7365 6c66 2e63 6f6c  ions = (self.col
+00017fb0: 756d 6e73 2e6d 696e 2829 2c20 7365 6c66  umns.min(), self
+00017fc0: 2e63 6f6c 756d 6e73 2e6d 6178 2829 290a  .columns.max()).
+00017fd0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00017fe0: 7572 6e20 6861 6e64 6c65 5f6f 7574 286f  urn handle_out(o
+00017ff0: 7574 2c20 7265 7375 6c74 290a 0a20 2020  ut, result)..   
+00018000: 2064 6566 205f 736b 6577 5f31 6428 7365   def _skew_1d(se
+00018010: 6c66 2c20 636f 6c75 6d6e 2c20 6269 6173  lf, column, bias
+00018020: 3d54 7275 652c 206e 616e 5f70 6f6c 6963  =True, nan_polic
+00018030: 793d 2270 726f 7061 6761 7465 2229 3a0a  y="propagate"):.
+00018040: 2020 2020 2020 2020 2222 2231 4420 7665          """1D ve
+00018050: 7273 696f 6e20 6f66 2074 6865 2073 6b65  rsion of the ske
+00018060: 7720 6361 6c63 756c 6174 696f 6e2e 0a0a  w calculation...
+00018070: 2020 2020 2020 2020 5573 6573 2074 6865          Uses the
+00018080: 2061 7272 6179 2076 6572 7369 6f6e 2066   array version f
+00018090: 726f 6d20 6461 2e73 7461 7473 2069 6e20  rom da.stats in 
+000180a0: 6361 7365 2077 6520 6172 6520 7061 7373  case we are pass
+000180b0: 696e 6720 696e 2061 2073 696e 676c 6520  ing in a single 
+000180c0: 7365 7269 6573 0a20 2020 2020 2020 2022  series.        "
+000180d0: 2222 0a20 2020 2020 2020 2023 2069 6d70  "".        # imp
+000180e0: 6f72 7420 6465 7065 6e64 7320 6f6e 2073  ort depends on s
+000180f0: 6369 7079 2c20 6e6f 7420 696e 7374 616c  cipy, not instal
+00018100: 6c65 6420 6279 2064 6566 6175 6c74 0a20  led by default. 
+00018110: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00018120: 2e61 7272 6179 2069 6d70 6f72 7420 7374  .array import st
+00018130: 6174 7320 6173 2064 615f 7374 6174 730a  ats as da_stats.
+00018140: 0a20 2020 2020 2020 2069 6620 7064 2e61  .        if pd.a
+00018150: 7069 2e74 7970 6573 2e69 735f 6578 7465  pi.types.is_exte
+00018160: 6e73 696f 6e5f 6172 7261 795f 6474 7970  nsion_array_dtyp
+00018170: 6528 636f 6c75 6d6e 2e5f 6d65 7461 5f6e  e(column._meta_n
+00018180: 6f6e 656d 7074 7929 3a0a 2020 2020 2020  onempty):.      
+00018190: 2020 2020 2020 636f 6c75 6d6e 203d 2063        column = c
+000181a0: 6f6c 756d 6e2e 6173 7479 7065 2822 6638  olumn.astype("f8
+000181b0: 2229 0a0a 2020 2020 2020 2020 656c 6966  ")..        elif
+000181c0: 206e 6f74 206e 702e 6973 7375 6264 7479   not np.issubdty
+000181d0: 7065 2863 6f6c 756d 6e2e 6474 7970 652c  pe(column.dtype,
+000181e0: 206e 702e 6e75 6d62 6572 293a 0a20 2020   np.number):.   
+000181f0: 2020 2020 2020 2020 2063 6f6c 756d 6e20           column 
+00018200: 3d20 636f 6c75 6d6e 2e61 7374 7970 6528  = column.astype(
+00018210: 2266 3822 290a 0a20 2020 2020 2020 206e  "f8")..        n
+00018220: 616d 6520 3d20 7365 6c66 2e5f 746f 6b65  ame = self._toke
+00018230: 6e5f 7072 6566 6978 202b 2022 736b 6577  n_prefix + "skew
+00018240: 2d31 642d 2220 2b20 746f 6b65 6e69 7a65  -1d-" + tokenize
+00018250: 2863 6f6c 756d 6e29 0a0a 2020 2020 2020  (column)..      
+00018260: 2020 6172 7261 795f 736b 6577 203d 2064    array_skew = d
+00018270: 615f 7374 6174 732e 736b 6577 280a 2020  a_stats.skew(.  
+00018280: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+00018290: 2e76 616c 7565 732c 2061 7869 733d 302c  .values, axis=0,
+000182a0: 2062 6961 733d 6269 6173 2c20 6e61 6e5f   bias=bias, nan_
+000182b0: 706f 6c69 6379 3d6e 616e 5f70 6f6c 6963  policy=nan_polic
+000182c0: 790a 2020 2020 2020 2020 290a 0a20 2020  y.        )..   
+000182d0: 2020 2020 206c 6179 6572 203d 207b 286e       layer = {(n
+000182e0: 616d 652c 2030 293a 2028 6d65 7468 6f64  ame, 0): (method
+000182f0: 732e 7772 6170 5f73 6b65 775f 7265 6475  s.wrap_skew_redu
+00018300: 6374 696f 6e2c 2028 6172 7261 795f 736b  ction, (array_sk
+00018310: 6577 2e5f 6e61 6d65 2c29 2c20 4e6f 6e65  ew._name,), None
+00018320: 297d 0a20 2020 2020 2020 2067 7261 7068  )}.        graph
+00018330: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+00018340: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+00018350: 6e73 286e 616d 652c 206c 6179 6572 2c20  ns(name, layer, 
+00018360: 6465 7065 6e64 656e 6369 6573 3d5b 6172  dependencies=[ar
+00018370: 7261 795f 736b 6577 5d29 0a0a 2020 2020  ray_skew])..    
+00018380: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
+00018390: 645f 6f62 6a65 6374 280a 2020 2020 2020  d_object(.      
+000183a0: 2020 2020 2020 6772 6170 682c 206e 616d        graph, nam
+000183b0: 652c 2063 6f6c 756d 6e2e 5f6d 6574 615f  e, column._meta_
+000183c0: 6e6f 6e65 6d70 7479 2e73 6b65 7728 292c  nonempty.skew(),
+000183d0: 2064 6976 6973 696f 6e73 3d5b 4e6f 6e65   divisions=[None
+000183e0: 2c20 4e6f 6e65 5d0a 2020 2020 2020 2020  , None].        
+000183f0: 290a 0a20 2020 2064 6566 205f 736b 6577  )..    def _skew
+00018400: 5f6e 756d 6572 6963 2873 656c 662c 2062  _numeric(self, b
+00018410: 6961 733d 5472 7565 2c20 6e61 6e5f 706f  ias=True, nan_po
+00018420: 6c69 6379 3d22 7072 6f70 6167 6174 6522  licy="propagate"
+00018430: 293a 0a20 2020 2020 2020 2022 2222 4d65  ):.        """Me
+00018440: 7468 6f64 2066 6f72 2064 6174 6166 7261  thod for datafra
+00018450: 6d65 7320 7769 7468 206e 756d 6572 6963  mes with numeric
+00018460: 2063 6f6c 756d 6e73 2e0a 0a20 2020 2020   columns...     
+00018470: 2020 204d 6170 7320 7468 6520 6172 7261     Maps the arra
+00018480: 7920 7665 7273 696f 6e20 6672 6f6d 2064  y version from d
+00018490: 612e 7374 6174 7320 6f6e 746f 2074 6865  a.stats onto the
+000184a0: 206e 756d 6572 6963 2061 7272 6179 206f   numeric array o
+000184b0: 6620 636f 6c75 6d6e 732e 0a20 2020 2020  f columns..     
+000184c0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+000184d0: 2069 6d70 6f72 7420 6465 7065 6e64 7320   import depends 
+000184e0: 6f6e 2073 6369 7079 2c20 6e6f 7420 696e  on scipy, not in
+000184f0: 7374 616c 6c65 6420 6279 2064 6566 6175  stalled by defau
+00018500: 6c74 0a20 2020 2020 2020 2066 726f 6d20  lt.        from 
+00018510: 6461 736b 2e61 7272 6179 2069 6d70 6f72  dask.array impor
+00018520: 7420 7374 6174 7320 6173 2064 615f 7374  t stats as da_st
+00018530: 6174 730a 0a20 2020 2020 2020 206e 756d  ats..        num
+00018540: 203d 2073 656c 662e 7365 6c65 6374 5f64   = self.select_d
+00018550: 7479 7065 7328 696e 636c 7564 653d 5b22  types(include=["
+00018560: 6e75 6d62 6572 222c 2022 626f 6f6c 225d  number", "bool"]
+00018570: 2c20 6578 636c 7564 653d 5b6e 702e 7469  , exclude=[np.ti
+00018580: 6d65 6465 6c74 6136 345d 290a 0a20 2020  medelta64])..   
+00018590: 2020 2020 2076 616c 7565 735f 6474 7970       values_dtyp
+000185a0: 6520 3d20 6e75 6d2e 7661 6c75 6573 2e64  e = num.values.d
+000185b0: 7479 7065 0a20 2020 2020 2020 2061 7272  type.        arr
+000185c0: 6179 5f76 616c 7565 7320 3d20 6e75 6d2e  ay_values = num.
+000185d0: 7661 6c75 6573 0a0a 2020 2020 2020 2020  values..        
+000185e0: 6966 206e 6f74 206e 702e 6973 7375 6264  if not np.issubd
+000185f0: 7479 7065 2876 616c 7565 735f 6474 7970  type(values_dtyp
+00018600: 652c 206e 702e 6e75 6d62 6572 293a 0a20  e, np.number):. 
+00018610: 2020 2020 2020 2020 2020 2061 7272 6179             array
+00018620: 5f76 616c 7565 7320 3d20 6e75 6d2e 7661  _values = num.va
+00018630: 6c75 6573 2e61 7374 7970 6528 2266 3822  lues.astype("f8"
+00018640: 290a 0a20 2020 2020 2020 2061 7272 6179  )..        array
+00018650: 5f73 6b65 7720 3d20 6461 5f73 7461 7473  _skew = da_stats
+00018660: 2e73 6b65 7728 0a20 2020 2020 2020 2020  .skew(.         
+00018670: 2020 2061 7272 6179 5f76 616c 7565 732c     array_values,
+00018680: 2061 7869 733d 302c 2062 6961 733d 6269   axis=0, bias=bi
+00018690: 6173 2c20 6e61 6e5f 706f 6c69 6379 3d6e  as, nan_policy=n
+000186a0: 616e 5f70 6f6c 6963 790a 2020 2020 2020  an_policy.      
+000186b0: 2020 290a 0a20 2020 2020 2020 206e 616d    )..        nam
+000186c0: 6520 3d20 7365 6c66 2e5f 746f 6b65 6e5f  e = self._token_
+000186d0: 7072 6566 6978 202b 2022 7661 722d 6e75  prefix + "var-nu
+000186e0: 6d65 7269 6322 202b 2074 6f6b 656e 697a  meric" + tokeniz
+000186f0: 6528 6e75 6d29 0a20 2020 2020 2020 2063  e(num).        c
+00018700: 6f6c 7320 3d20 6e75 6d2e 5f6d 6574 612e  ols = num._meta.
+00018710: 636f 6c75 6d6e 7320 6966 2069 735f 6461  columns if is_da
+00018720: 7461 6672 616d 655f 6c69 6b65 286e 756d  taframe_like(num
+00018730: 2920 656c 7365 204e 6f6e 650a 0a20 2020  ) else None..   
+00018740: 2020 2020 2077 6974 6820 6368 6563 6b5f       with check_
+00018750: 7265 6475 6374 696f 6e73 5f72 756e 7469  reductions_runti
+00018760: 6d65 5f77 6172 6e69 6e67 2829 3a0a 2020  me_warning():.  
+00018770: 2020 2020 2020 2020 2020 736b 6577 5f73            skew_s
+00018780: 6861 7065 203d 206e 756d 2e5f 6d65 7461  hape = num._meta
+00018790: 5f6e 6f6e 656d 7074 792e 7661 7228 6178  _nonempty.var(ax
+000187a0: 6973 3d30 292e 7368 6170 650a 2020 2020  is=0).shape.    
+000187b0: 2020 2020 6172 7261 795f 736b 6577 5f6e      array_skew_n
+000187c0: 616d 6520 3d20 2861 7272 6179 5f73 6b65  ame = (array_ske
+000187d0: 772e 5f6e 616d 652c 2920 2b20 2830 2c29  w._name,) + (0,)
+000187e0: 202a 206c 656e 2873 6b65 775f 7368 6170   * len(skew_shap
+000187f0: 6529 0a0a 2020 2020 2020 2020 6c61 7965  e)..        laye
+00018800: 7220 3d20 7b28 6e61 6d65 2c20 3029 3a20  r = {(name, 0): 
+00018810: 286d 6574 686f 6473 2e77 7261 705f 736b  (methods.wrap_sk
+00018820: 6577 5f72 6564 7563 7469 6f6e 2c20 6172  ew_reduction, ar
+00018830: 7261 795f 736b 6577 5f6e 616d 652c 2063  ray_skew_name, c
+00018840: 6f6c 7329 7d0a 2020 2020 2020 2020 6772  ols)}.        gr
+00018850: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+00018860: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+00018870: 7469 6f6e 7328 6e61 6d65 2c20 6c61 7965  tions(name, laye
+00018880: 722c 2064 6570 656e 6465 6e63 6965 733d  r, dependencies=
+00018890: 5b61 7272 6179 5f73 6b65 775d 290a 0a20  [array_skew]).. 
+000188a0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+000188b0: 775f 6464 5f6f 626a 6563 7428 0a20 2020  w_dd_object(.   
+000188c0: 2020 2020 2020 2020 2067 7261 7068 2c20           graph, 
+000188d0: 6e61 6d65 2c20 6e75 6d2e 5f6d 6574 615f  name, num._meta_
+000188e0: 6e6f 6e65 6d70 7479 2e73 6b65 7728 292c  nonempty.skew(),
+000188f0: 2064 6976 6973 696f 6e73 3d5b 4e6f 6e65   divisions=[None
+00018900: 2c20 4e6f 6e65 5d0a 2020 2020 2020 2020  , None].        
+00018910: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00018920: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00018930: 6529 0a20 2020 2064 6566 206b 7572 746f  e).    def kurto
+00018940: 7369 7328 0a20 2020 2020 2020 2073 656c  sis(.        sel
+00018950: 662c 0a20 2020 2020 2020 2061 7869 733d  f,.        axis=
+00018960: 302c 0a20 2020 2020 2020 2066 6973 6865  0,.        fishe
+00018970: 723d 5472 7565 2c0a 2020 2020 2020 2020  r=True,.        
+00018980: 6269 6173 3d54 7275 652c 0a20 2020 2020  bias=True,.     
+00018990: 2020 206e 616e 5f70 6f6c 6963 793d 2270     nan_policy="p
+000189a0: 726f 7061 6761 7465 222c 0a20 2020 2020  ropagate",.     
+000189b0: 2020 206f 7574 3d4e 6f6e 652c 0a20 2020     out=None,.   
+000189c0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+000189d0: 793d 6e6f 5f64 6566 6175 6c74 2c0a 2020  y=no_default,.  
+000189e0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+000189f0: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
+00018a00: 3a3a 0a0a 2020 2020 2020 2020 2020 2054  ::..           T
+00018a10: 6869 7320 696d 706c 656d 656e 7461 7469  his implementati
+00018a20: 6f6e 2066 6f6c 6c6f 7773 2074 6865 2064  on follows the d
+00018a30: 6173 6b2e 6172 7261 792e 7374 6174 7320  ask.array.stats 
+00018a40: 696d 706c 656d 656e 7461 7469 6f6e 0a20  implementation. 
+00018a50: 2020 2020 2020 2020 2020 6f66 206b 7572            of kur
+00018a60: 746f 7369 7320 616e 6420 6361 6c63 756c  tosis and calcul
+00018a70: 6174 6573 206b 7572 746f 7369 7320 7769  ates kurtosis wi
+00018a80: 7468 6f75 7420 7461 6b69 6e67 2069 6e74  thout taking int
+00018a90: 6f20 6163 636f 756e 740a 2020 2020 2020  o account.      
+00018aa0: 2020 2020 2061 2062 6961 7320 7465 726d       a bias term
+00018ab0: 2066 6f72 2066 696e 6974 6520 7361 6d70   for finite samp
+00018ac0: 6c65 2073 697a 652c 2077 6869 6368 2063  le size, which c
+00018ad0: 6f72 7265 7370 6f6e 6473 2074 6f20 7468  orresponds to th
+00018ae0: 650a 2020 2020 2020 2020 2020 2064 6566  e.           def
+00018af0: 6175 6c74 2073 6574 7469 6e67 7320 6f66  ault settings of
+00018b00: 2074 6865 2073 6369 7079 2e73 7461 7473   the scipy.stats
+00018b10: 206b 7572 746f 7369 7320 6361 6c63 756c   kurtosis calcul
+00018b20: 6174 696f 6e2e 2054 6869 7320 6469 6666  ation. This diff
+00018b30: 6572 730a 2020 2020 2020 2020 2020 2066  ers.           f
+00018b40: 726f 6d20 7061 6e64 6173 2e0a 0a20 2020  rom pandas...   
+00018b50: 2020 2020 2020 2020 4675 7274 6865 722c          Further,
+00018b60: 2074 6869 7320 6d65 7468 6f64 2063 7572   this method cur
+00018b70: 7265 6e74 6c79 2064 6f65 7320 6e6f 7420  rently does not 
+00018b80: 7375 7070 6f72 7420 6669 6c74 6572 696e  support filterin
+00018b90: 6720 6f75 7420 4e61 4e0a 2020 2020 2020  g out NaN.      
+00018ba0: 2020 2020 2076 616c 7565 732c 2077 6869       values, whi
+00018bb0: 6368 2069 7320 6167 6169 6e20 6120 6469  ch is again a di
+00018bc0: 6666 6572 656e 6365 2074 6f20 5061 6e64  fference to Pand
+00018bd0: 6173 2e0a 2020 2020 2020 2020 2222 220a  as..        """.
+00018be0: 2020 2020 2020 2020 6966 2050 414e 4441          if PANDA
+00018bf0: 535f 4754 5f32 3030 2061 6e64 2061 7869  S_GT_200 and axi
+00018c00: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
+00018c10: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00018c20: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+00018c30: 2020 2020 2020 2020 2022 6061 7869 733d           "`axis=
+00018c40: 4e6f 6e65 6020 6973 6e27 7420 6375 7272  None` isn't curr
+00018c50: 656e 746c 7920 7375 7070 6f72 7465 6420  ently supported 
+00018c60: 666f 7220 606b 7572 746f 7369 7360 2077  for `kurtosis` w
+00018c70: 6865 6e20 7573 696e 6720 6070 616e 6461  hen using `panda
+00018c80: 7320 3e3d 3260 2022 0a20 2020 2020 2020  s >=2` ".       
+00018c90: 2020 2020 2020 2020 2066 2228 7061 6e64           f"(pand
+00018ca0: 6173 3d7b 7374 7228 5041 4e44 4153 5f56  as={str(PANDAS_V
+00018cb0: 4552 5349 4f4e 297d 2069 7320 696e 7374  ERSION)} is inst
+00018cc0: 616c 6c65 6429 2e22 0a20 2020 2020 2020  alled).".       
+00018cd0: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
+00018ce0: 7869 7320 3d20 7365 6c66 2e5f 7661 6c69  xis = self._vali
+00018cf0: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
+00018d00: 2020 2020 2020 2020 5f72 6169 7365 5f69          _raise_i
+00018d10: 665f 6f62 6a65 6374 5f73 6572 6965 7328  f_object_series(
+00018d20: 7365 6c66 2c20 226b 7572 746f 7369 7322  self, "kurtosis"
+00018d30: 290a 2020 2020 2020 2020 6e75 6d65 7269  ).        numeri
+00018d40: 635f 6f6e 6c79 5f6b 7761 7267 7320 3d20  c_only_kwargs = 
+00018d50: 6765 745f 6e75 6d65 7269 635f 6f6e 6c79  get_numeric_only
+00018d60: 5f6b 7761 7267 7328 6e75 6d65 7269 635f  _kwargs(numeric_
+00018d70: 6f6e 6c79 290a 0a20 2020 2020 2020 2069  only)..        i
+00018d80: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
+00018d90: 696b 6528 7365 6c66 293a 0a20 2020 2020  ike(self):.     
+00018da0: 2020 2020 2020 2023 204c 6574 2070 616e         # Let pan
+00018db0: 6461 7320 7261 6973 6520 6572 726f 7273  das raise errors
+00018dc0: 2069 6620 6e65 6365 7373 6172 790a 2020   if necessary.  
+00018dd0: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
+00018de0: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
+00018df0: 6d70 7479 2e6b 7572 746f 7369 7328 6178  mpty.kurtosis(ax
+00018e00: 6973 3d61 7869 732c 202a 2a6e 756d 6572  is=axis, **numer
+00018e10: 6963 5f6f 6e6c 795f 6b77 6172 6773 290a  ic_only_kwargs).
+00018e20: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00018e30: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
+00018e40: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
+00018e50: 6d70 7479 2e6b 7572 746f 7369 7328 290a  mpty.kurtosis().
+00018e60: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
+00018e70: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00018e80: 2020 2072 6573 756c 7420 3d20 6d61 705f     result = map_
+00018e90: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+00018ea0: 2020 2020 2020 2020 2020 2020 4d2e 6b75              M.ku
+00018eb0: 7274 6f73 6973 2c0a 2020 2020 2020 2020  rtosis,.        
+00018ec0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00018ed0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00018ee0: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
+00018ef0: 2020 2020 2020 2020 2074 6f6b 656e 3d73           token=s
+00018f00: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
+00018f10: 7820 2b20 226b 7572 746f 7369 7322 2c0a  x + "kurtosis",.
+00018f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f30: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
+00018f40: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
+00018f50: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+00018f60: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
+00018f70: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00018f80: 7572 6e20 6861 6e64 6c65 5f6f 7574 286f  urn handle_out(o
+00018f90: 7574 2c20 7265 7375 6c74 290a 2020 2020  ut, result).    
+00018fa0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00018fb0: 2020 2020 2020 6966 2073 656c 662e 6e64        if self.nd
+00018fc0: 696d 203d 3d20 313a 0a20 2020 2020 2020  im == 1:.       
+00018fd0: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+00018fe0: 3d20 7365 6c66 2e5f 6b75 7274 6f73 6973  = self._kurtosis
+00018ff0: 5f31 6428 0a20 2020 2020 2020 2020 2020  _1d(.           
+00019000: 2020 2020 2020 2020 2073 656c 662c 2066           self, f
+00019010: 6973 6865 723d 6669 7368 6572 2c20 6269  isher=fisher, bi
+00019020: 6173 3d62 6961 732c 206e 616e 5f70 6f6c  as=bias, nan_pol
+00019030: 6963 793d 6e61 6e5f 706f 6c69 6379 0a20  icy=nan_policy. 
+00019040: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00019050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019060: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
+00019070: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
+00019080: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00019090: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000190a0: 2020 7265 7375 6c74 203d 2073 656c 662e    result = self.
+000190b0: 5f6b 7572 746f 7369 735f 6e75 6d65 7269  _kurtosis_numeri
+000190c0: 6328 0a20 2020 2020 2020 2020 2020 2020  c(.             
+000190d0: 2020 2020 2020 2066 6973 6865 723d 6669         fisher=fi
+000190e0: 7368 6572 2c20 6269 6173 3d62 6961 732c  sher, bias=bias,
+000190f0: 206e 616e 5f70 6f6c 6963 793d 6e61 6e5f   nan_policy=nan_
+00019100: 706f 6c69 6379 0a20 2020 2020 2020 2020  policy.         
+00019110: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00019120: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00019130: 6e63 6528 7365 6c66 2c20 4461 7461 4672  nce(self, DataFr
+00019140: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
+00019150: 2020 2020 2020 7265 7375 6c74 2e64 6976        result.div
+00019160: 6973 696f 6e73 203d 2028 7365 6c66 2e63  isions = (self.c
+00019170: 6f6c 756d 6e73 2e6d 696e 2829 2c20 7365  olumns.min(), se
+00019180: 6c66 2e63 6f6c 756d 6e73 2e6d 6178 2829  lf.columns.max()
+00019190: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
+000191a0: 6574 7572 6e20 6861 6e64 6c65 5f6f 7574  eturn handle_out
+000191b0: 286f 7574 2c20 7265 7375 6c74 290a 0a20  (out, result).. 
+000191c0: 2020 2064 6566 205f 6b75 7274 6f73 6973     def _kurtosis
+000191d0: 5f31 6428 7365 6c66 2c20 636f 6c75 6d6e  _1d(self, column
+000191e0: 2c20 6669 7368 6572 3d54 7275 652c 2062  , fisher=True, b
+000191f0: 6961 733d 5472 7565 2c20 6e61 6e5f 706f  ias=True, nan_po
+00019200: 6c69 6379 3d22 7072 6f70 6167 6174 6522  licy="propagate"
+00019210: 293a 0a20 2020 2020 2020 2022 2222 3144  ):.        """1D
+00019220: 2076 6572 7369 6f6e 206f 6620 7468 6520   version of the 
+00019230: 6b75 7274 6f73 6973 2063 616c 6375 6c61  kurtosis calcula
+00019240: 7469 6f6e 2e0a 0a20 2020 2020 2020 2055  tion...        U
+00019250: 7365 7320 7468 6520 6172 7261 7920 7665  ses the array ve
+00019260: 7273 696f 6e20 6672 6f6d 2064 612e 7374  rsion from da.st
+00019270: 6174 7320 696e 2063 6173 6520 7765 2061  ats in case we a
+00019280: 7265 2070 6173 7369 6e67 2069 6e20 6120  re passing in a 
+00019290: 7369 6e67 6c65 2073 6572 6965 730a 2020  single series.  
+000192a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000192b0: 2020 2320 696d 706f 7274 2064 6570 656e    # import depen
+000192c0: 6473 206f 6e20 7363 6970 792c 206e 6f74  ds on scipy, not
+000192d0: 2069 6e73 7461 6c6c 6564 2062 7920 6465   installed by de
+000192e0: 6661 756c 740a 2020 2020 2020 2020 6672  fault.        fr
+000192f0: 6f6d 2064 6173 6b2e 6172 7261 7920 696d  om dask.array im
+00019300: 706f 7274 2073 7461 7473 2061 7320 6461  port stats as da
+00019310: 5f73 7461 7473 0a0a 2020 2020 2020 2020  _stats..        
+00019320: 6966 2070 642e 6170 692e 7479 7065 732e  if pd.api.types.
+00019330: 6973 5f65 7874 656e 7369 6f6e 5f61 7272  is_extension_arr
+00019340: 6179 5f64 7479 7065 2863 6f6c 756d 6e2e  ay_dtype(column.
+00019350: 5f6d 6574 615f 6e6f 6e65 6d70 7479 293a  _meta_nonempty):
+00019360: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00019370: 756d 6e20 3d20 636f 6c75 6d6e 2e61 7374  umn = column.ast
+00019380: 7970 6528 2266 3822 290a 0a20 2020 2020  ype("f8")..     
+00019390: 2020 2065 6c69 6620 6e6f 7420 6e70 2e69     elif not np.i
+000193a0: 7373 7562 6474 7970 6528 636f 6c75 6d6e  ssubdtype(column
+000193b0: 2e64 7479 7065 2c20 6e70 2e6e 756d 6265  .dtype, np.numbe
+000193c0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+000193d0: 636f 6c75 6d6e 203d 2063 6f6c 756d 6e2e  column = column.
+000193e0: 6173 7479 7065 2822 6638 2229 0a0a 2020  astype("f8")..  
+000193f0: 2020 2020 2020 6e61 6d65 203d 2073 656c        name = sel
+00019400: 662e 5f74 6f6b 656e 5f70 7265 6669 7820  f._token_prefix 
+00019410: 2b20 226b 7572 746f 7369 732d 3164 2d22  + "kurtosis-1d-"
+00019420: 202b 2074 6f6b 656e 697a 6528 636f 6c75   + tokenize(colu
+00019430: 6d6e 290a 0a20 2020 2020 2020 2061 7272  mn)..        arr
+00019440: 6179 5f6b 7572 746f 7369 7320 3d20 6461  ay_kurtosis = da
+00019450: 5f73 7461 7473 2e6b 7572 746f 7369 7328  _stats.kurtosis(
+00019460: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00019470: 756d 6e2e 7661 6c75 6573 2c20 6178 6973  umn.values, axis
+00019480: 3d30 2c20 6669 7368 6572 3d66 6973 6865  =0, fisher=fishe
+00019490: 722c 2062 6961 733d 6269 6173 2c20 6e61  r, bias=bias, na
+000194a0: 6e5f 706f 6c69 6379 3d6e 616e 5f70 6f6c  n_policy=nan_pol
+000194b0: 6963 790a 2020 2020 2020 2020 290a 0a20  icy.        ).. 
+000194c0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
+000194d0: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
+000194e0: 6d65 2c20 3029 3a20 286d 6574 686f 6473  me, 0): (methods
+000194f0: 2e77 7261 705f 6b75 7274 6f73 6973 5f72  .wrap_kurtosis_r
+00019500: 6564 7563 7469 6f6e 2c20 2861 7272 6179  eduction, (array
+00019510: 5f6b 7572 746f 7369 732e 5f6e 616d 652c  _kurtosis._name,
+00019520: 292c 204e 6f6e 6529 0a20 2020 2020 2020  ), None).       
+00019530: 207d 0a20 2020 2020 2020 2067 7261 7068   }.        graph
+00019540: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+00019550: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+00019560: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+00019570: 6e61 6d65 2c20 6c61 7965 722c 2064 6570  name, layer, dep
+00019580: 656e 6465 6e63 6965 733d 5b61 7272 6179  endencies=[array
+00019590: 5f6b 7572 746f 7369 735d 0a20 2020 2020  _kurtosis].     
+000195a0: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
+000195b0: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
+000195c0: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
+000195d0: 6772 6170 682c 206e 616d 652c 2063 6f6c  graph, name, col
+000195e0: 756d 6e2e 5f6d 6574 615f 6e6f 6e65 6d70  umn._meta_nonemp
+000195f0: 7479 2e6b 7572 746f 7369 7328 292c 2064  ty.kurtosis(), d
+00019600: 6976 6973 696f 6e73 3d5b 4e6f 6e65 2c20  ivisions=[None, 
+00019610: 4e6f 6e65 5d0a 2020 2020 2020 2020 290a  None].        ).
+00019620: 0a20 2020 2064 6566 205f 6b75 7274 6f73  .    def _kurtos
+00019630: 6973 5f6e 756d 6572 6963 2873 656c 662c  is_numeric(self,
+00019640: 2066 6973 6865 723d 5472 7565 2c20 6269   fisher=True, bi
+00019650: 6173 3d54 7275 652c 206e 616e 5f70 6f6c  as=True, nan_pol
+00019660: 6963 793d 2270 726f 7061 6761 7465 2229  icy="propagate")
+00019670: 3a0a 2020 2020 2020 2020 2222 224d 6574  :.        """Met
+00019680: 686f 6420 666f 7220 6461 7461 6672 616d  hod for datafram
+00019690: 6573 2077 6974 6820 6e75 6d65 7269 6320  es with numeric 
+000196a0: 636f 6c75 6d6e 732e 0a0a 2020 2020 2020  columns...      
+000196b0: 2020 4d61 7073 2074 6865 2061 7272 6179    Maps the array
+000196c0: 2076 6572 7369 6f6e 2066 726f 6d20 6461   version from da
+000196d0: 2e73 7461 7473 206f 6e74 6f20 7468 6520  .stats onto the 
+000196e0: 6e75 6d65 7269 6320 6172 7261 7920 6f66  numeric array of
+000196f0: 2063 6f6c 756d 6e73 2e0a 2020 2020 2020   columns..      
+00019700: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+00019710: 696d 706f 7274 2064 6570 656e 6473 206f  import depends o
+00019720: 6e20 7363 6970 792c 206e 6f74 2069 6e73  n scipy, not ins
+00019730: 7461 6c6c 6564 2062 7920 6465 6661 756c  talled by defaul
+00019740: 740a 2020 2020 2020 2020 6672 6f6d 2064  t.        from d
+00019750: 6173 6b2e 6172 7261 7920 696d 706f 7274  ask.array import
+00019760: 2073 7461 7473 2061 7320 6461 5f73 7461   stats as da_sta
+00019770: 7473 0a0a 2020 2020 2020 2020 6e75 6d20  ts..        num 
+00019780: 3d20 7365 6c66 2e73 656c 6563 745f 6474  = self.select_dt
+00019790: 7970 6573 2869 6e63 6c75 6465 3d5b 226e  ypes(include=["n
+000197a0: 756d 6265 7222 2c20 2262 6f6f 6c22 5d2c  umber", "bool"],
+000197b0: 2065 7863 6c75 6465 3d5b 6e70 2e74 696d   exclude=[np.tim
+000197c0: 6564 656c 7461 3634 5d29 0a0a 2020 2020  edelta64])..    
+000197d0: 2020 2020 7661 6c75 6573 5f64 7479 7065      values_dtype
+000197e0: 203d 206e 756d 2e76 616c 7565 732e 6474   = num.values.dt
+000197f0: 7970 650a 2020 2020 2020 2020 6172 7261  ype.        arra
+00019800: 795f 7661 6c75 6573 203d 206e 756d 2e76  y_values = num.v
+00019810: 616c 7565 730a 0a20 2020 2020 2020 2069  alues..        i
+00019820: 6620 6e6f 7420 6e70 2e69 7373 7562 6474  f not np.issubdt
+00019830: 7970 6528 7661 6c75 6573 5f64 7479 7065  ype(values_dtype
+00019840: 2c20 6e70 2e6e 756d 6265 7229 3a0a 2020  , np.number):.  
+00019850: 2020 2020 2020 2020 2020 6172 7261 795f            array_
+00019860: 7661 6c75 6573 203d 206e 756d 2e76 616c  values = num.val
+00019870: 7565 732e 6173 7479 7065 2822 6638 2229  ues.astype("f8")
+00019880: 0a0a 2020 2020 2020 2020 6172 7261 795f  ..        array_
+00019890: 6b75 7274 6f73 6973 203d 2064 615f 7374  kurtosis = da_st
+000198a0: 6174 732e 6b75 7274 6f73 6973 280a 2020  ats.kurtosis(.  
+000198b0: 2020 2020 2020 2020 2020 6172 7261 795f            array_
+000198c0: 7661 6c75 6573 2c20 6178 6973 3d30 2c20  values, axis=0, 
+000198d0: 6669 7368 6572 3d66 6973 6865 722c 2062  fisher=fisher, b
+000198e0: 6961 733d 6269 6173 2c20 6e61 6e5f 706f  ias=bias, nan_po
+000198f0: 6c69 6379 3d6e 616e 5f70 6f6c 6963 790a  licy=nan_policy.
+00019900: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00019910: 2020 206e 616d 6520 3d20 7365 6c66 2e5f     name = self._
+00019920: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
+00019930: 6b75 7274 6f73 6973 2d6e 756d 6572 6963  kurtosis-numeric
+00019940: 2220 2b20 746f 6b65 6e69 7a65 286e 756d  " + tokenize(num
+00019950: 290a 2020 2020 2020 2020 636f 6c73 203d  ).        cols =
+00019960: 206e 756d 2e5f 6d65 7461 2e63 6f6c 756d   num._meta.colum
+00019970: 6e73 2069 6620 6973 5f64 6174 6166 7261  ns if is_datafra
+00019980: 6d65 5f6c 696b 6528 6e75 6d29 2065 6c73  me_like(num) els
+00019990: 6520 4e6f 6e65 0a0a 2020 2020 2020 2020  e None..        
+000199a0: 7769 7468 2063 6865 636b 5f72 6564 7563  with check_reduc
+000199b0: 7469 6f6e 735f 7275 6e74 696d 655f 7761  tions_runtime_wa
+000199c0: 726e 696e 6728 293a 0a20 2020 2020 2020  rning():.       
+000199d0: 2020 2020 206b 7572 746f 7369 735f 7368       kurtosis_sh
+000199e0: 6170 6520 3d20 6e75 6d2e 5f6d 6574 615f  ape = num._meta_
+000199f0: 6e6f 6e65 6d70 7479 2e76 6172 2861 7869  nonempty.var(axi
+00019a00: 733d 3029 2e73 6861 7065 0a20 2020 2020  s=0).shape.     
+00019a10: 2020 2061 7272 6179 5f6b 7572 746f 7369     array_kurtosi
+00019a20: 735f 6e61 6d65 203d 2028 6172 7261 795f  s_name = (array_
+00019a30: 6b75 7274 6f73 6973 2e5f 6e61 6d65 2c29  kurtosis._name,)
+00019a40: 202b 2028 302c 2920 2a20 6c65 6e28 6b75   + (0,) * len(ku
+00019a50: 7274 6f73 6973 5f73 6861 7065 290a 0a20  rtosis_shape).. 
+00019a60: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
+00019a70: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
+00019a80: 6d65 2c20 3029 3a20 286d 6574 686f 6473  me, 0): (methods
+00019a90: 2e77 7261 705f 6b75 7274 6f73 6973 5f72  .wrap_kurtosis_r
+00019aa0: 6564 7563 7469 6f6e 2c20 6172 7261 795f  eduction, array_
+00019ab0: 6b75 7274 6f73 6973 5f6e 616d 652c 2063  kurtosis_name, c
+00019ac0: 6f6c 7329 0a20 2020 2020 2020 207d 0a20  ols).        }. 
+00019ad0: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
+00019ae0: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+00019af0: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 280a  om_collections(.
+00019b00: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00019b10: 2c20 6c61 7965 722c 2064 6570 656e 6465  , layer, depende
+00019b20: 6e63 6965 733d 5b61 7272 6179 5f6b 7572  ncies=[array_kur
+00019b30: 746f 7369 735d 0a20 2020 2020 2020 2029  tosis].        )
+00019b40: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00019b50: 206e 6577 5f64 645f 6f62 6a65 6374 280a   new_dd_object(.
+00019b60: 2020 2020 2020 2020 2020 2020 6772 6170              grap
+00019b70: 682c 206e 616d 652c 206e 756d 2e5f 6d65  h, name, num._me
+00019b80: 7461 5f6e 6f6e 656d 7074 792e 6b75 7274  ta_nonempty.kurt
+00019b90: 6f73 6973 2829 2c20 6469 7669 7369 6f6e  osis(), division
+00019ba0: 733d 5b4e 6f6e 652c 204e 6f6e 655d 0a20  s=[None, None]. 
+00019bb0: 2020 2020 2020 2029 0a0a 2020 2020 405f         )..    @_
+00019bc0: 6e75 6d65 7269 635f 6f6e 6c79 0a20 2020  numeric_only.   
+00019bd0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00019be0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00019bf0: 2064 6566 2073 656d 2873 656c 662c 2061   def sem(self, a
+00019c00: 7869 733d 4e6f 6e65 2c20 736b 6970 6e61  xis=None, skipna
+00019c10: 3d54 7275 652c 2064 646f 663d 312c 2073  =True, ddof=1, s
+00019c20: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+00019c30: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d4e  , numeric_only=N
+00019c40: 6f6e 6529 3a0a 2020 2020 2020 2020 6178  one):.        ax
+00019c50: 6973 203d 2073 656c 662e 5f76 616c 6964  is = self._valid
+00019c60: 6174 655f 6178 6973 2861 7869 7329 0a20  ate_axis(axis). 
+00019c70: 2020 2020 2020 205f 7261 6973 655f 6966         _raise_if
+00019c80: 5f6f 626a 6563 745f 7365 7269 6573 2873  _object_series(s
+00019c90: 656c 662c 2022 7365 6d22 290a 2020 2020  elf, "sem").    
+00019ca0: 2020 2020 7769 7468 2063 6865 636b 5f6e      with check_n
+00019cb0: 756d 6572 6963 5f6f 6e6c 795f 6465 7072  umeric_only_depr
+00019cc0: 6563 6174 696f 6e28 293a 0a20 2020 2020  ecation():.     
+00019cd0: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
+00019ce0: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
+00019cf0: 792e 7365 6d28 0a20 2020 2020 2020 2020  y.sem(.         
+00019d00: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+00019d10: 2c20 736b 6970 6e61 3d73 6b69 706e 612c  , skipna=skipna,
+00019d20: 2064 646f 663d 6464 6f66 2c20 6e75 6d65   ddof=ddof, nume
+00019d30: 7269 635f 6f6e 6c79 3d6e 756d 6572 6963  ric_only=numeric
+00019d40: 5f6f 6e6c 790a 2020 2020 2020 2020 2020  _only.          
+00019d50: 2020 290a 2020 2020 2020 2020 6966 2061    ).        if a
+00019d60: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
+00019d70: 2020 2020 2020 7265 7475 726e 206d 6170        return map
+00019d80: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+00019d90: 2020 2020 2020 2020 2020 2020 204d 2e73               M.s
+00019da0: 656d 2c0a 2020 2020 2020 2020 2020 2020  em,.            
+00019db0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00019dc0: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
+00019dd0: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
+00019de0: 2020 2020 2074 6f6b 656e 3d73 656c 662e       token=self.
+00019df0: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
+00019e00: 2273 656d 222c 0a20 2020 2020 2020 2020  "sem",.         
+00019e10: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+00019e20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019e30: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
+00019e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019e50: 2064 646f 663d 6464 6f66 2c0a 2020 2020   ddof=ddof,.    
+00019e60: 2020 2020 2020 2020 2020 2020 7061 7265              pare
+00019e70: 6e74 5f6d 6574 613d 7365 6c66 2e5f 6d65  nt_meta=self._me
+00019e80: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+00019e90: 2020 2020 6e75 6d65 7269 635f 6f6e 6c79      numeric_only
+00019ea0: 3d6e 756d 6572 6963 5f6f 6e6c 792c 0a20  =numeric_only,. 
+00019eb0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00019ec0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00019ed0: 2020 2020 2020 206e 756d 203d 2073 656c         num = sel
+00019ee0: 662e 5f67 6574 5f6e 756d 6572 6963 5f64  f._get_numeric_d
+00019ef0: 6174 6128 290a 2020 2020 2020 2020 2020  ata().          
+00019f00: 2020 7620 3d20 6e75 6d2e 7661 7228 736b    v = num.var(sk
+00019f10: 6970 6e61 3d73 6b69 706e 612c 2064 646f  ipna=skipna, ddo
+00019f20: 663d 6464 6f66 2c20 7370 6c69 745f 6576  f=ddof, split_ev
+00019f30: 6572 793d 7370 6c69 745f 6576 6572 7929  ery=split_every)
+00019f40: 0a20 2020 2020 2020 2020 2020 206e 203d  .            n =
+00019f50: 206e 756d 2e63 6f75 6e74 2873 706c 6974   num.count(split
+00019f60: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+00019f70: 7279 290a 2020 2020 2020 2020 2020 2020  ry).            
+00019f80: 6e61 6d65 203d 2073 656c 662e 5f74 6f6b  name = self._tok
+00019f90: 656e 5f70 7265 6669 7820 2b20 2273 656d  en_prefix + "sem
+00019fa0: 220a 2020 2020 2020 2020 2020 2020 7265  ".            re
+00019fb0: 7375 6c74 203d 206d 6170 5f70 6172 7469  sult = map_parti
+00019fc0: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+00019fd0: 2020 2020 2020 206e 702e 7371 7274 2c0a         np.sqrt,.
+00019fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ff0: 7620 2f20 6e2c 0a20 2020 2020 2020 2020  v / n,.         
+0001a000: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
+0001a010: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001a020: 2020 746f 6b65 6e3d 6e61 6d65 2c0a 2020    token=name,.  
+0001a030: 2020 2020 2020 2020 2020 2020 2020 656e                en
+0001a040: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+0001a050: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+0001a060: 2020 2020 2020 7061 7265 6e74 5f6d 6574        parent_met
+0001a070: 613d 7365 6c66 2e5f 6d65 7461 2c0a 2020  a=self._meta,.  
+0001a080: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0001a090: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+0001a0a0: 7374 616e 6365 2873 656c 662c 2044 6174  stance(self, Dat
+0001a0b0: 6146 7261 6d65 293a 0a20 2020 2020 2020  aFrame):.       
+0001a0c0: 2020 2020 2020 2020 2072 6573 756c 742e           result.
+0001a0d0: 6469 7669 7369 6f6e 7320 3d20 2873 656c  divisions = (sel
+0001a0e0: 662e 636f 6c75 6d6e 732e 6d69 6e28 292c  f.columns.min(),
+0001a0f0: 2073 656c 662e 636f 6c75 6d6e 732e 6d61   self.columns.ma
+0001a100: 7828 2929 0a20 2020 2020 2020 2020 2020  x()).           
+0001a110: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
+0001a120: 2020 2020 6465 6620 7175 616e 7469 6c65      def quantile
+0001a130: 2873 656c 662c 2071 3d30 2e35 2c20 6178  (self, q=0.5, ax
+0001a140: 6973 3d30 2c20 6e75 6d65 7269 635f 6f6e  is=0, numeric_on
+0001a150: 6c79 3d6e 6f5f 6465 6661 756c 742c 206d  ly=no_default, m
+0001a160: 6574 686f 643d 2264 6566 6175 6c74 2229  ethod="default")
+0001a170: 3a0a 2020 2020 2020 2020 2222 2241 7070  :.        """App
+0001a180: 726f 7869 6d61 7465 2072 6f77 2d77 6973  roximate row-wis
+0001a190: 6520 616e 6420 7072 6563 6973 6520 636f  e and precise co
+0001a1a0: 6c75 6d6e 2d77 6973 6520 7175 616e 7469  lumn-wise quanti
+0001a1b0: 6c65 7320 6f66 2044 6174 6146 7261 6d65  les of DataFrame
+0001a1c0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0001a1d0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+0001a1e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001a1f0: 7120 3a20 6c69 7374 2f61 7272 6179 206f  q : list/array o
+0001a200: 6620 666c 6f61 7473 2c20 6465 6661 756c  f floats, defaul
+0001a210: 7420 302e 3520 2835 3025 290a 2020 2020  t 0.5 (50%).    
+0001a220: 2020 2020 2020 2020 4974 6572 6162 6c65          Iterable
+0001a230: 206f 6620 6e75 6d62 6572 7320 7261 6e67   of numbers rang
+0001a240: 696e 6720 6672 6f6d 2030 2074 6f20 3120  ing from 0 to 1 
+0001a250: 666f 7220 7468 6520 6465 7369 7265 6420  for the desired 
+0001a260: 7175 616e 7469 6c65 730a 2020 2020 2020  quantiles.      
+0001a270: 2020 6178 6973 203a 207b 302c 2031 2c20    axis : {0, 1, 
+0001a280: 2769 6e64 6578 272c 2027 636f 6c75 6d6e  'index', 'column
+0001a290: 7327 7d20 2864 6566 6175 6c74 2030 290a  s'} (default 0).
+0001a2a0: 2020 2020 2020 2020 2020 2020 3020 6f72              0 or
+0001a2b0: 2027 696e 6465 7827 2066 6f72 2072 6f77   'index' for row
+0001a2c0: 2d77 6973 652c 2031 206f 7220 2763 6f6c  -wise, 1 or 'col
+0001a2d0: 756d 6e73 2720 666f 7220 636f 6c75 6d6e  umns' for column
+0001a2e0: 2d77 6973 650a 2020 2020 2020 2020 6d65  -wise.        me
+0001a2f0: 7468 6f64 203a 207b 2764 6566 6175 6c74  thod : {'default
+0001a300: 272c 2027 7464 6967 6573 7427 2c20 2764  ', 'tdigest', 'd
+0001a310: 6173 6b27 7d2c 206f 7074 696f 6e61 6c0a  ask'}, optional.
+0001a320: 2020 2020 2020 2020 2020 2020 5768 6174              What
+0001a330: 206d 6574 686f 6420 746f 2075 7365 2e20   method to use. 
+0001a340: 4279 2064 6566 6175 6c74 2077 696c 6c20  By default will 
+0001a350: 7573 6520 6461 736b 2773 2069 6e74 6572  use dask's inter
+0001a360: 6e61 6c20 6375 7374 6f6d 0a20 2020 2020  nal custom.     
+0001a370: 2020 2020 2020 2061 6c67 6f72 6974 686d         algorithm
+0001a380: 2028 6060 2764 6173 6b27 6060 292e 2020   (``'dask'``).  
+0001a390: 4966 2073 6574 2074 6f20 6060 2774 6469  If set to ``'tdi
+0001a3a0: 6765 7374 2760 6020 7769 6c6c 2075 7365  gest'`` will use
+0001a3b0: 2074 6469 6765 7374 0a20 2020 2020 2020   tdigest.       
+0001a3c0: 2020 2020 2066 6f72 2066 6c6f 6174 7320       for floats 
+0001a3d0: 616e 6420 696e 7473 2061 6e64 2066 616c  and ints and fal
+0001a3e0: 6c62 6163 6b20 746f 2074 6865 2060 6027  lback to the ``'
+0001a3f0: 6461 736b 2760 6020 6f74 6865 7277 6973  dask'`` otherwis
+0001a400: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+0001a410: 2020 2020 2020 2061 7869 7320 3d20 7365         axis = se
+0001a420: 6c66 2e5f 7661 6c69 6461 7465 5f61 7869  lf._validate_axi
+0001a430: 7328 6178 6973 290a 2020 2020 2020 2020  s(axis).        
+0001a440: 6b65 796e 616d 6520 3d20 2271 7561 6e74  keyname = "quant
+0001a450: 696c 6573 2d63 6f6e 6361 742d 2d22 202b  iles-concat--" +
+0001a460: 2074 6f6b 656e 697a 6528 7365 6c66 2c20   tokenize(self, 
+0001a470: 712c 2061 7869 7329 0a20 2020 2020 2020  q, axis).       
+0001a480: 206e 756d 6572 6963 5f6b 7761 7267 7320   numeric_kwargs 
+0001a490: 3d20 6765 745f 6e75 6d65 7269 635f 6f6e  = get_numeric_on
+0001a4a0: 6c79 5f6b 7761 7267 7328 6e75 6d65 7269  ly_kwargs(numeri
+0001a4b0: 635f 6f6e 6c79 290a 0a20 2020 2020 2020  c_only)..       
+0001a4c0: 2077 6974 6820 6368 6563 6b5f 6e75 6d65   with check_nume
+0001a4d0: 7269 635f 6f6e 6c79 5f64 6570 7265 6361  ric_only_depreca
+0001a4e0: 7469 6f6e 2822 7175 616e 7469 6c65 222c  tion("quantile",
+0001a4f0: 2054 7275 6529 3a0a 2020 2020 2020 2020   True):.        
+0001a500: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
+0001a510: 5f6d 6574 612e 7175 616e 7469 6c65 2871  _meta.quantile(q
+0001a520: 2c20 6178 6973 3d61 7869 732c 202a 2a6e  , axis=axis, **n
+0001a530: 756d 6572 6963 5f6b 7761 7267 7329 0a0a  umeric_kwargs)..
+0001a540: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
+0001a550: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+0001a560: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0001a570: 712c 206c 6973 7429 3a0a 2020 2020 2020  q, list):.      
+0001a580: 2020 2020 2020 2020 2020 2320 4e6f 7420            # Not 
+0001a590: 7375 7070 6f72 7465 642c 2074 6865 2072  supported, the r
+0001a5a0: 6573 756c 7420 7769 6c6c 2068 6176 6520  esult will have 
+0001a5b0: 6375 7272 656e 7420 696e 6465 7820 6173  current index as
+0001a5c0: 2063 6f6c 756d 6e73 0a20 2020 2020 2020   columns.       
+0001a5d0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0001a5e0: 616c 7565 4572 726f 7228 2227 7127 206d  alueError("'q' m
+0001a5f0: 7573 7420 6265 2073 6361 6c61 7220 7768  ust be scalar wh
+0001a600: 656e 2061 7869 733d 3120 6973 2073 7065  en axis=1 is spe
+0001a610: 6369 6669 6564 2229 0a0a 2020 2020 2020  cified")..      
+0001a620: 2020 2020 2020 7265 7475 726e 206d 6170        return map
+0001a630: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+0001a640: 2020 2020 2020 2020 2020 2020 205f 6765               _ge
+0001a650: 7461 7474 725f 6e75 6d65 7269 635f 6f6e  tattr_numeric_on
+0001a660: 6c79 2c0a 2020 2020 2020 2020 2020 2020  ly,.            
+0001a670: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0001a680: 2020 2020 2020 2020 2020 712c 0a20 2020            q,.   
+0001a690: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+0001a6a0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0001a6b0: 2020 2074 6f6b 656e 3d6b 6579 6e61 6d65     token=keyname
+0001a6c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001a6d0: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
+0001a6e0: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
+0001a6f0: 2020 2020 2020 2020 2020 2a2a 6e75 6d65            **nume
+0001a700: 7269 635f 6b77 6172 6773 2c0a 2020 2020  ric_kwargs,.    
+0001a710: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+0001a720: 3d28 712c 2022 6638 2229 2c0a 2020 2020  =(q, "f8"),.    
+0001a730: 2020 2020 2020 2020 2020 2020 7061 7265              pare
+0001a740: 6e74 5f6d 6574 613d 7365 6c66 2e5f 6d65  nt_meta=self._me
+0001a750: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+0001a760: 2020 2020 5f64 6173 6b5f 6d65 7468 6f64      _dask_method
+0001a770: 5f6e 616d 653d 2271 7561 6e74 696c 6522  _name="quantile"
+0001a780: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0001a790: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001a7a0: 2020 2020 2020 2020 2020 5f72 6169 7365            _raise
+0001a7b0: 5f69 665f 6f62 6a65 6374 5f73 6572 6965  _if_object_serie
+0001a7c0: 7328 7365 6c66 2c20 2271 7561 6e74 696c  s(self, "quantil
+0001a7d0: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+0001a7e0: 6e75 6d20 3d20 280a 2020 2020 2020 2020  num = (.        
+0001a7f0: 2020 2020 2020 2020 7365 6c66 2e5f 6765          self._ge
+0001a800: 745f 6e75 6d65 7269 635f 6461 7461 2829  t_numeric_data()
+0001a810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a820: 2069 6620 6e75 6d65 7269 635f 6f6e 6c79   if numeric_only
+0001a830: 2069 7320 5472 7565 0a20 2020 2020 2020   is True.       
+0001a840: 2020 2020 2020 2020 206f 7220 286e 6f74           or (not
+0001a850: 2050 414e 4441 535f 4754 5f32 3030 2061   PANDAS_GT_200 a
+0001a860: 6e64 206e 756d 6572 6963 5f6f 6e6c 7920  nd numeric_only 
+0001a870: 6973 206e 6f5f 6465 6661 756c 7429 0a20  is no_default). 
+0001a880: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001a890: 6c73 6520 7365 6c66 0a20 2020 2020 2020  lse self.       
+0001a8a0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0001a8b0: 2020 2071 7561 6e74 696c 6573 203d 2074     quantiles = t
+0001a8c0: 7570 6c65 280a 2020 2020 2020 2020 2020  uple(.          
+0001a8d0: 2020 2020 2020 7175 616e 7469 6c65 286e        quantile(n
+0001a8e0: 756d 2e69 6c6f 635b 3a2c 2069 5d2c 2071  um.iloc[:, i], q
+0001a8f0: 2c20 6d65 7468 6f64 2920 666f 7220 6920  , method) for i 
+0001a900: 696e 2072 616e 6765 286c 656e 286e 756d  in range(len(num
+0001a910: 2e63 6f6c 756d 6e73 2929 0a20 2020 2020  .columns)).     
+0001a920: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0001a930: 2020 2020 2020 716e 616d 6573 203d 205b        qnames = [
+0001a940: 285f 712e 5f6e 616d 652c 2030 2920 666f  (_q._name, 0) fo
+0001a950: 7220 5f71 2069 6e20 7175 616e 7469 6c65  r _q in quantile
+0001a960: 735d 0a0a 2020 2020 2020 2020 2020 2020  s]..            
+0001a970: 6966 2069 7369 6e73 7461 6e63 6528 7175  if isinstance(qu
+0001a980: 616e 7469 6c65 735b 305d 2c20 5363 616c  antiles[0], Scal
+0001a990: 6172 293a 0a20 2020 2020 2020 2020 2020  ar):.           
+0001a9a0: 2020 2020 206c 6179 6572 203d 207b 0a20       layer = {. 
+0001a9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a9c0: 2020 2028 6b65 796e 616d 652c 2030 293a     (keyname, 0):
+0001a9d0: 2028 7479 7065 286d 6574 6129 2c20 716e   (type(meta), qn
+0001a9e0: 616d 6573 2c20 6e75 6d2e 636f 6c75 6d6e  ames, num.column
+0001a9f0: 732c 204e 6f6e 652c 206d 6574 612e 6e61  s, None, meta.na
+0001aa00: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
+0001aa10: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+0001aa20: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
+0001aa30: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+0001aa40: 6d5f 636f 6c6c 6563 7469 6f6e 7328 0a20  m_collections(. 
+0001aa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aa60: 2020 206b 6579 6e61 6d65 2c20 6c61 7965     keyname, laye
+0001aa70: 722c 2064 6570 656e 6465 6e63 6965 733d  r, dependencies=
+0001aa80: 7175 616e 7469 6c65 730a 2020 2020 2020  quantiles.      
+0001aa90: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001aaa0: 2020 2020 2020 2020 2020 2020 6469 7669              divi
+0001aab0: 7369 6f6e 7320 3d20 286d 696e 286e 756d  sions = (min(num
+0001aac0: 2e63 6f6c 756d 6e73 292c 206d 6178 286e  .columns), max(n
+0001aad0: 756d 2e63 6f6c 756d 6e73 2929 0a20 2020  um.columns)).   
+0001aae0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0001aaf0: 7572 6e20 5365 7269 6573 2867 7261 7068  urn Series(graph
+0001ab00: 2c20 6b65 796e 616d 652c 206d 6574 612c  , keyname, meta,
+0001ab10: 2064 6976 6973 696f 6e73 290a 2020 2020   divisions).    
+0001ab20: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001ab30: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+0001ab40: 7965 7220 3d20 7b28 6b65 796e 616d 652c  yer = {(keyname,
+0001ab50: 2030 293a 2028 6d65 7468 6f64 732e 636f   0): (methods.co
+0001ab60: 6e63 6174 2c20 716e 616d 6573 2c20 3129  ncat, qnames, 1)
+0001ab70: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+0001ab80: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+0001ab90: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+0001aba0: 6c6c 6563 7469 6f6e 7328 0a20 2020 2020  llections(.     
+0001abb0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+0001abc0: 6579 6e61 6d65 2c20 6c61 7965 722c 2064  eyname, layer, d
+0001abd0: 6570 656e 6465 6e63 6965 733d 7175 616e  ependencies=quan
+0001abe0: 7469 6c65 730a 2020 2020 2020 2020 2020  tiles.          
+0001abf0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001ac00: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0001ac10: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
+0001ac20: 7068 2c20 6b65 796e 616d 652c 206d 6574  ph, keyname, met
+0001ac30: 612c 2071 7561 6e74 696c 6573 5b30 5d2e  a, quantiles[0].
+0001ac40: 6469 7669 7369 6f6e 7329 0a0a 2020 2020  divisions)..    
+0001ac50: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0001ac60: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+0001ac70: 6465 6620 6465 7363 7269 6265 280a 2020  def describe(.  
+0001ac80: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0001ac90: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+0001aca0: 4661 6c73 652c 0a20 2020 2020 2020 2070  False,.        p
+0001acb0: 6572 6365 6e74 696c 6573 3d4e 6f6e 652c  ercentiles=None,
+0001acc0: 0a20 2020 2020 2020 2070 6572 6365 6e74  .        percent
+0001acd0: 696c 6573 5f6d 6574 686f 643d 2264 6566  iles_method="def
+0001ace0: 6175 6c74 222c 0a20 2020 2020 2020 2069  ault",.        i
+0001acf0: 6e63 6c75 6465 3d4e 6f6e 652c 0a20 2020  nclude=None,.   
+0001ad00: 2020 2020 2065 7863 6c75 6465 3d4e 6f6e       exclude=Non
+0001ad10: 652c 0a20 2020 2020 2020 2064 6174 6574  e,.        datet
+0001ad20: 696d 655f 6973 5f6e 756d 6572 6963 3d6e  ime_is_numeric=n
+0001ad30: 6f5f 6465 6661 756c 742c 0a20 2020 2029  o_default,.    )
+0001ad40: 3a0a 2020 2020 2020 2020 6966 2050 414e  :.        if PAN
+0001ad50: 4441 535f 4754 5f32 3030 3a0a 2020 2020  DAS_GT_200:.    
+0001ad60: 2020 2020 2020 2020 6966 2064 6174 6574          if datet
+0001ad70: 696d 655f 6973 5f6e 756d 6572 6963 2069  ime_is_numeric i
+0001ad80: 7320 6e6f 5f64 6566 6175 6c74 3a0a 2020  s no_default:.  
+0001ad90: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0001ada0: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
+0001adb0: 6320 3d20 5472 7565 0a20 2020 2020 2020  c = True.       
+0001adc0: 2020 2020 2020 2020 2064 6174 6574 696d           datetim
+0001add0: 655f 6973 5f6e 756d 6572 6963 5f6b 7761  e_is_numeric_kwa
+0001ade0: 7267 203d 207b 7d0a 2020 2020 2020 2020  rg = {}.        
+0001adf0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001ae00: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001ae10: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+0001ae20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001ae30: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
+0001ae40: 7269 6320 6973 2072 656d 6f76 6564 2069  ric is removed i
+0001ae50: 6e20 7061 6e64 6173 3e3d 322e 302e 302c  n pandas>=2.0.0,
+0001ae60: 2064 6174 6574 696d 6520 6461 7461 2077   datetime data w
+0001ae70: 696c 6c20 616c 7761 7973 2062 6520 220a  ill always be ".
+0001ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae90: 2020 2020 2273 756d 6d61 7269 7a65 6420      "summarized 
+0001aea0: 6173 206e 756d 6572 6963 220a 2020 2020  as numeric".    
+0001aeb0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001aec0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001aed0: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
+0001aee0: 5f69 735f 6e75 6d65 7269 6320 3d20 280a  _is_numeric = (.
+0001aef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af00: 4661 6c73 6520 6966 2064 6174 6574 696d  False if datetim
+0001af10: 655f 6973 5f6e 756d 6572 6963 2069 7320  e_is_numeric is 
+0001af20: 6e6f 5f64 6566 6175 6c74 2065 6c73 6520  no_default else 
+0001af30: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
+0001af40: 7269 630a 2020 2020 2020 2020 2020 2020  ric.            
+0001af50: 290a 2020 2020 2020 2020 2020 2020 6461  ).            da
+0001af60: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
+0001af70: 635f 6b77 6172 6720 3d20 7b22 6461 7465  c_kwarg = {"date
+0001af80: 7469 6d65 5f69 735f 6e75 6d65 7269 6322  time_is_numeric"
+0001af90: 3a20 6461 7465 7469 6d65 5f69 735f 6e75  : datetime_is_nu
+0001afa0: 6d65 7269 637d 0a0a 2020 2020 2020 2020  meric}..        
+0001afb0: 6966 2073 656c 662e 5f6d 6574 612e 6e64  if self._meta.nd
+0001afc0: 696d 203d 3d20 313a 0a20 2020 2020 2020  im == 1:.       
+0001afd0: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
+0001afe0: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
+0001aff0: 6465 7363 7269 6265 280a 2020 2020 2020  describe(.      
+0001b000: 2020 2020 2020 2020 2020 7065 7263 656e            percen
+0001b010: 7469 6c65 733d 7065 7263 656e 7469 6c65  tiles=percentile
+0001b020: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0001b030: 2020 2069 6e63 6c75 6465 3d69 6e63 6c75     include=inclu
+0001b040: 6465 2c0a 2020 2020 2020 2020 2020 2020  de,.            
+0001b050: 2020 2020 6578 636c 7564 653d 6578 636c      exclude=excl
+0001b060: 7564 652c 0a20 2020 2020 2020 2020 2020  ude,.           
+0001b070: 2020 2020 202a 2a64 6174 6574 696d 655f       **datetime_
+0001b080: 6973 5f6e 756d 6572 6963 5f6b 7761 7267  is_numeric_kwarg
+0001b090: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0001b0a0: 2020 2020 2020 2020 2020 2020 6f75 7470              outp
+0001b0b0: 7574 203d 2073 656c 662e 5f64 6573 6372  ut = self._descr
+0001b0c0: 6962 655f 3164 280a 2020 2020 2020 2020  ibe_1d(.        
+0001b0d0: 2020 2020 2020 2020 7365 6c66 2c20 7370          self, sp
+0001b0e0: 6c69 745f 6576 6572 792c 2070 6572 6365  lit_every, perce
+0001b0f0: 6e74 696c 6573 2c20 7065 7263 656e 7469  ntiles, percenti
+0001b100: 6c65 735f 6d65 7468 6f64 2c20 6461 7465  les_method, date
+0001b110: 7469 6d65 5f69 735f 6e75 6d65 7269 630a  time_is_numeric.
+0001b120: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001b130: 2020 2020 2020 2020 2020 6f75 7470 7574            output
+0001b140: 2e5f 6d65 7461 203d 206d 6574 610a 2020  ._meta = meta.  
+0001b150: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001b160: 206f 7574 7075 740a 2020 2020 2020 2020   output.        
+0001b170: 656c 6966 2028 696e 636c 7564 6520 6973  elif (include is
+0001b180: 204e 6f6e 6529 2061 6e64 2028 6578 636c   None) and (excl
+0001b190: 7564 6520 6973 204e 6f6e 6529 3a0a 2020  ude is None):.  
+0001b1a0: 2020 2020 2020 2020 2020 5f69 6e63 6c75            _inclu
+0001b1b0: 6465 203d 205b 6e70 2e6e 756d 6265 722c  de = [np.number,
+0001b1c0: 206e 702e 7469 6d65 6465 6c74 6136 345d   np.timedelta64]
+0001b1d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001b1e0: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
+0001b1f0: 7269 633a 0a20 2020 2020 2020 2020 2020  ric:.           
+0001b200: 2020 2020 205f 696e 636c 7564 652e 6170       _include.ap
+0001b210: 7065 6e64 286e 702e 6461 7465 7469 6d65  pend(np.datetime
+0001b220: 3634 290a 2020 2020 2020 2020 2020 2020  64).            
+0001b230: 6461 7461 203d 2073 656c 662e 5f6d 6574  data = self._met
+0001b240: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
+0001b250: 696e 636c 7564 653d 5f69 6e63 6c75 6465  include=_include
+0001b260: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+0001b270: 2077 6865 6e20 736f 6d65 206e 756d 6572   when some numer
+0001b280: 6963 732f 7469 6d65 6465 6c74 6173 2061  ics/timedeltas a
+0001b290: 7265 2066 6f75 6e64 2c20 6279 2064 6566  re found, by def
+0001b2a0: 6175 6c74 206b 6565 7020 7468 656d 0a20  ault keep them. 
+0001b2b0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+0001b2c0: 6e28 6461 7461 2e63 6f6c 756d 6e73 2920  n(data.columns) 
+0001b2d0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+0001b2e0: 2020 2020 2020 6368 6f73 656e 5f63 6f6c        chosen_col
+0001b2f0: 756d 6e73 5f69 6e64 6578 6573 203d 206c  umns_indexes = l
+0001b300: 6973 7428 7261 6e67 6528 6c65 6e28 7365  ist(range(len(se
+0001b310: 6c66 2e5f 6d65 7461 2e63 6f6c 756d 6e73  lf._meta.columns
+0001b320: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+0001b330: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001b340: 2020 2020 2020 2320 6368 6563 6b20 6966        # check if
+0001b350: 2074 6865 7265 2061 7265 2074 696d 6564   there are timed
+0001b360: 656c 7461 2c20 626f 6f6c 6561 6e2c 206f  elta, boolean, o
+0001b370: 7220 6461 7465 7469 6d65 2063 6f6c 756d  r datetime colum
+0001b380: 6e73 0a20 2020 2020 2020 2020 2020 2020  ns.             
+0001b390: 2020 205f 696e 636c 7564 6520 3d20 5b6e     _include = [n
+0001b3a0: 702e 7469 6d65 6465 6c74 6136 342c 2062  p.timedelta64, b
+0001b3b0: 6f6f 6c5d 0a20 2020 2020 2020 2020 2020  ool].           
+0001b3c0: 2020 2020 2069 6620 6461 7465 7469 6d65       if datetime
+0001b3d0: 5f69 735f 6e75 6d65 7269 633a 0a20 2020  _is_numeric:.   
+0001b3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b3f0: 205f 696e 636c 7564 652e 6170 7065 6e64   _include.append
+0001b400: 286e 702e 6461 7465 7469 6d65 3634 290a  (np.datetime64).
+0001b410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b420: 626f 6f6c 735f 616e 645f 7469 6d65 7320  bools_and_times 
+0001b430: 3d20 7365 6c66 2e5f 6d65 7461 2e73 656c  = self._meta.sel
+0001b440: 6563 745f 6474 7970 6573 2869 6e63 6c75  ect_dtypes(inclu
+0001b450: 6465 3d5f 696e 636c 7564 6529 0a20 2020  de=_include).   
+0001b460: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001b470: 6c65 6e28 626f 6f6c 735f 616e 645f 7469  len(bools_and_ti
+0001b480: 6d65 732e 636f 6c75 6d6e 7329 203d 3d20  mes.columns) == 
+0001b490: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0001b4a0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001b4b0: 6c66 2e5f 6465 7363 7269 6265 5f6e 756d  lf._describe_num
+0001b4c0: 6572 6963 280a 2020 2020 2020 2020 2020  eric(.          
+0001b4d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001b4e0: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+0001b4f0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+0001b500: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
+0001b510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b520: 2070 6572 6365 6e74 696c 6573 2c0a 2020   percentiles,.  
+0001b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b540: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
+0001b550: 735f 6d65 7468 6f64 2c0a 2020 2020 2020  s_method,.      
+0001b560: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0001b570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b580: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001b590: 2020 2020 2020 2020 2020 6368 6f73 656e            chosen
+0001b5a0: 5f63 6f6c 756d 6e73 5f69 6e64 6578 6573  _columns_indexes
+0001b5b0: 203d 2073 656c 662e 5f67 6574 5f63 6f6c   = self._get_col
+0001b5c0: 756d 6e73 5f69 6e64 6578 6573 5f62 6173  umns_indexes_bas
+0001b5d0: 6564 5f6f 6e5f 6474 7970 6573 280a 2020  ed_on_dtypes(.  
+0001b5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5f0: 2020 2020 2020 6461 7461 0a20 2020 2020        data.     
+0001b600: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001b610: 0a20 2020 2020 2020 2065 6c69 6620 696e  .        elif in
+0001b620: 636c 7564 6520 3d3d 2022 616c 6c22 3a0a  clude == "all":.
+0001b630: 2020 2020 2020 2020 2020 2020 6966 2065              if e
+0001b640: 7863 6c75 6465 2069 7320 6e6f 7420 4e6f  xclude is not No
+0001b650: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0001b660: 2020 2020 6d73 6720 3d20 2265 7863 6c75      msg = "exclu
+0001b670: 6465 206d 7573 7420 6265 204e 6f6e 6520  de must be None 
+0001b680: 7768 656e 2069 6e63 6c75 6465 2069 7320  when include is 
+0001b690: 2761 6c6c 2722 0a20 2020 2020 2020 2020  'all'".         
+0001b6a0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0001b6b0: 7565 4572 726f 7228 6d73 6729 0a20 2020  ueError(msg).   
+0001b6c0: 2020 2020 2020 2020 2063 686f 7365 6e5f           chosen_
+0001b6d0: 636f 6c75 6d6e 735f 696e 6465 7865 7320  columns_indexes 
+0001b6e0: 3d20 6c69 7374 2872 616e 6765 286c 656e  = list(range(len
+0001b6f0: 2873 656c 662e 5f6d 6574 612e 636f 6c75  (self._meta.colu
+0001b700: 6d6e 7329 2929 0a20 2020 2020 2020 2065  mns))).        e
+0001b710: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001b720: 2064 6174 6120 3d20 7365 6c66 2e5f 6d65   data = self._me
+0001b730: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
+0001b740: 2869 6e63 6c75 6465 3d69 6e63 6c75 6465  (include=include
+0001b750: 2c20 6578 636c 7564 653d 6578 636c 7564  , exclude=exclud
+0001b760: 6529 0a20 2020 2020 2020 2020 2020 2063  e).            c
+0001b770: 686f 7365 6e5f 636f 6c75 6d6e 735f 696e  hosen_columns_in
+0001b780: 6465 7865 7320 3d20 7365 6c66 2e5f 6765  dexes = self._ge
+0001b790: 745f 636f 6c75 6d6e 735f 696e 6465 7865  t_columns_indexe
+0001b7a0: 735f 6261 7365 645f 6f6e 5f64 7479 7065  s_based_on_dtype
+0001b7b0: 7328 6461 7461 290a 0a20 2020 2020 2020  s(data)..       
+0001b7c0: 2073 7461 7473 203d 205b 0a20 2020 2020   stats = [.     
+0001b7d0: 2020 2020 2020 2073 656c 662e 5f64 6573         self._des
+0001b7e0: 6372 6962 655f 3164 280a 2020 2020 2020  cribe_1d(.      
+0001b7f0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
+0001b800: 6c6f 635b 3a2c 2063 6f6c 5f69 6478 5d2c  loc[:, col_idx],
+0001b810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b820: 2073 706c 6974 5f65 7665 7279 2c0a 2020   split_every,.  
+0001b830: 2020 2020 2020 2020 2020 2020 2020 7065                pe
+0001b840: 7263 656e 7469 6c65 732c 0a20 2020 2020  rcentiles,.     
+0001b850: 2020 2020 2020 2020 2020 2070 6572 6365             perce
+0001b860: 6e74 696c 6573 5f6d 6574 686f 642c 0a20  ntiles_method,. 
+0001b870: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0001b880: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
+0001b890: 6963 2c0a 2020 2020 2020 2020 2020 2020  ic,.            
+0001b8a0: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+0001b8b0: 7220 636f 6c5f 6964 7820 696e 2063 686f  r col_idx in cho
+0001b8c0: 7365 6e5f 636f 6c75 6d6e 735f 696e 6465  sen_columns_inde
+0001b8d0: 7865 730a 2020 2020 2020 2020 5d0a 2020  xes.        ].  
+0001b8e0: 2020 2020 2020 7374 6174 735f 6e61 6d65        stats_name
+0001b8f0: 7320 3d20 5b28 732e 5f6e 616d 652c 2030  s = [(s._name, 0
+0001b900: 2920 666f 7220 7320 696e 2073 7461 7473  ) for s in stats
+0001b910: 5d0a 0a20 2020 2020 2020 206e 616d 6520  ]..        name 
+0001b920: 3d20 2264 6573 6372 6962 652d 2d22 202b  = "describe--" +
+0001b930: 2074 6f6b 656e 697a 6528 7365 6c66 2c20   tokenize(self, 
+0001b940: 7370 6c69 745f 6576 6572 7929 0a20 2020  split_every).   
+0001b950: 2020 2020 206c 6179 6572 203d 207b 286e       layer = {(n
+0001b960: 616d 652c 2030 293a 2028 6d65 7468 6f64  ame, 0): (method
+0001b970: 732e 6465 7363 7269 6265 5f61 6767 7265  s.describe_aggre
+0001b980: 6761 7465 2c20 7374 6174 735f 6e61 6d65  gate, stats_name
+0001b990: 7329 7d0a 2020 2020 2020 2020 6772 6170  s)}.        grap
+0001b9a0: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
+0001b9b0: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
+0001b9c0: 6f6e 7328 6e61 6d65 2c20 6c61 7965 722c  ons(name, layer,
+0001b9d0: 2064 6570 656e 6465 6e63 6965 733d 7374   dependencies=st
+0001b9e0: 6174 7329 0a20 2020 2020 2020 206d 6574  ats).        met
+0001b9f0: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
+0001ba00: 6f6e 656d 7074 792e 6465 7363 7269 6265  onempty.describe
+0001ba10: 280a 2020 2020 2020 2020 2020 2020 696e  (.            in
+0001ba20: 636c 7564 653d 696e 636c 7564 652c 2065  clude=include, e
+0001ba30: 7863 6c75 6465 3d65 7863 6c75 6465 2c20  xclude=exclude, 
+0001ba40: 2a2a 6461 7465 7469 6d65 5f69 735f 6e75  **datetime_is_nu
+0001ba50: 6d65 7269 635f 6b77 6172 670a 2020 2020  meric_kwarg.    
+0001ba60: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+0001ba70: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
+0001ba80: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
+0001ba90: 6d65 7461 2c20 6469 7669 7369 6f6e 733d  meta, divisions=
+0001baa0: 5b4e 6f6e 652c 204e 6f6e 655d 290a 0a20  [None, None]).. 
+0001bab0: 2020 2064 6566 205f 6765 745f 636f 6c75     def _get_colu
+0001bac0: 6d6e 735f 696e 6465 7865 735f 6261 7365  mns_indexes_base
+0001bad0: 645f 6f6e 5f64 7479 7065 7328 7365 6c66  d_on_dtypes(self
+0001bae0: 2c20 7375 6273 6574 293a 0a20 2020 2020  , subset):.     
+0001baf0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+0001bb00: 6d65 7461 2e64 7479 7065 732e 7265 7365  meta.dtypes.rese
+0001bb10: 745f 696e 6465 7828 290a 2020 2020 2020  t_index().      
+0001bb20: 2020 6d65 7461 2e69 6e64 6578 2e6e 616d    meta.index.nam
+0001bb30: 6520 3d20 2269 6e64 6578 6572 220a 2020  e = "indexer".  
+0001bb40: 2020 2020 2020 7265 7475 726e 2028 0a20        return (. 
+0001bb50: 2020 2020 2020 2020 2020 206d 6574 612e             meta.
+0001bb60: 7265 7365 745f 696e 6465 7828 290a 2020  reset_index().  
+0001bb70: 2020 2020 2020 2020 2020 2e6d 6572 6765            .merge
+0001bb80: 2873 7562 7365 742e 6474 7970 6573 2e72  (subset.dtypes.r
+0001bb90: 6573 6574 5f69 6e64 6578 2829 2c20 686f  eset_index(), ho
+0001bba0: 773d 2269 6e6e 6572 2229 5b22 696e 6465  w="inner")["inde
+0001bbb0: 7865 7222 5d0a 2020 2020 2020 2020 2020  xer"].          
+0001bbc0: 2020 2e76 616c 7565 730a 2020 2020 2020    .values.      
+0001bbd0: 2020 290a 0a20 2020 2064 6566 205f 6465    )..    def _de
+0001bbe0: 7363 7269 6265 5f31 6428 0a20 2020 2020  scribe_1d(.     
+0001bbf0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0001bc00: 2064 6174 612c 0a20 2020 2020 2020 2073   data,.        s
+0001bc10: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+0001bc20: 2c0a 2020 2020 2020 2020 7065 7263 656e  ,.        percen
+0001bc30: 7469 6c65 733d 4e6f 6e65 2c0a 2020 2020  tiles=None,.    
+0001bc40: 2020 2020 7065 7263 656e 7469 6c65 735f      percentiles_
+0001bc50: 6d65 7468 6f64 3d22 6465 6661 756c 7422  method="default"
+0001bc60: 2c0a 2020 2020 2020 2020 6461 7465 7469  ,.        dateti
+0001bc70: 6d65 5f69 735f 6e75 6d65 7269 633d 4661  me_is_numeric=Fa
+0001bc80: 6c73 652c 0a20 2020 2029 3a0a 2020 2020  lse,.    ):.    
+0001bc90: 2020 2020 6966 2069 735f 626f 6f6c 5f64      if is_bool_d
+0001bca0: 7479 7065 2864 6174 612e 5f6d 6574 6129  type(data._meta)
+0001bcb0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0001bcc0: 7475 726e 2073 656c 662e 5f64 6573 6372  turn self._descr
+0001bcd0: 6962 655f 6e6f 6e6e 756d 6572 6963 5f31  ibe_nonnumeric_1
+0001bce0: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
+0001bcf0: 2020 2064 6174 612c 2073 706c 6974 5f65     data, split_e
+0001bd00: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+0001bd10: 2c20 6461 7465 7469 6d65 5f69 735f 6e75  , datetime_is_nu
+0001bd20: 6d65 7269 633d 6461 7465 7469 6d65 5f69  meric=datetime_i
+0001bd30: 735f 6e75 6d65 7269 630a 2020 2020 2020  s_numeric.      
+0001bd40: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001bd50: 656c 6966 2069 735f 6e75 6d65 7269 635f  elif is_numeric_
+0001bd60: 6474 7970 6528 6461 7461 2e5f 6d65 7461  dtype(data._meta
+0001bd70: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0001bd80: 6574 7572 6e20 7365 6c66 2e5f 6465 7363  eturn self._desc
+0001bd90: 7269 6265 5f6e 756d 6572 6963 280a 2020  ribe_numeric(.  
+0001bda0: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0001bdb0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+0001bdc0: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+0001bdd0: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
+0001bde0: 2020 2020 2020 2020 2020 2020 2070 6572               per
+0001bdf0: 6365 6e74 696c 6573 3d70 6572 6365 6e74  centiles=percent
+0001be00: 696c 6573 2c0a 2020 2020 2020 2020 2020  iles,.          
+0001be10: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
+0001be20: 735f 6d65 7468 6f64 3d70 6572 6365 6e74  s_method=percent
+0001be30: 696c 6573 5f6d 6574 686f 642c 0a20 2020  iles_method,.   
+0001be40: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001be50: 2020 2065 6c69 6620 6973 5f74 696d 6564     elif is_timed
+0001be60: 656c 7461 3634 5f64 7479 7065 2864 6174  elta64_dtype(dat
+0001be70: 612e 5f6d 6574 6129 3a0a 2020 2020 2020  a._meta):.      
+0001be80: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001be90: 662e 5f64 6573 6372 6962 655f 6e75 6d65  f._describe_nume
+0001bea0: 7269 6328 0a20 2020 2020 2020 2020 2020  ric(.           
+0001beb0: 2020 2020 2064 6174 612e 6472 6f70 6e61       data.dropna
+0001bec0: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
+0001bed0: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+0001bee0: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
+0001bef0: 2020 2020 2020 2020 2020 2020 2070 6572               per
+0001bf00: 6365 6e74 696c 6573 3d70 6572 6365 6e74  centiles=percent
+0001bf10: 696c 6573 2c0a 2020 2020 2020 2020 2020  iles,.          
+0001bf20: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
+0001bf30: 735f 6d65 7468 6f64 3d70 6572 6365 6e74  s_method=percent
+0001bf40: 696c 6573 5f6d 6574 686f 642c 0a20 2020  iles_method,.   
+0001bf50: 2020 2020 2020 2020 2020 2020 2069 735f               is_
+0001bf60: 7469 6d65 6465 6c74 615f 636f 6c75 6d6e  timedelta_column
+0001bf70: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
+0001bf80: 2020 2029 0a20 2020 2020 2020 2065 6c69     ).        eli
+0001bf90: 6620 6973 5f64 6174 6574 696d 6536 345f  f is_datetime64_
+0001bfa0: 616e 795f 6474 7970 6528 6461 7461 2e5f  any_dtype(data._
+0001bfb0: 6d65 7461 2920 616e 6420 6461 7465 7469  meta) and dateti
+0001bfc0: 6d65 5f69 735f 6e75 6d65 7269 633a 0a20  me_is_numeric:. 
+0001bfd0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001bfe0: 6e20 7365 6c66 2e5f 6465 7363 7269 6265  n self._describe
+0001bff0: 5f6e 756d 6572 6963 280a 2020 2020 2020  _numeric(.      
+0001c000: 2020 2020 2020 2020 2020 6461 7461 2e64            data.d
+0001c010: 726f 706e 6128 292c 0a20 2020 2020 2020  ropna(),.       
+0001c020: 2020 2020 2020 2020 2073 706c 6974 5f65           split_e
+0001c030: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+0001c040: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c050: 2020 7065 7263 656e 7469 6c65 733d 7065    percentiles=pe
+0001c060: 7263 656e 7469 6c65 732c 0a20 2020 2020  rcentiles,.     
+0001c070: 2020 2020 2020 2020 2020 2070 6572 6365             perce
+0001c080: 6e74 696c 6573 5f6d 6574 686f 643d 7065  ntiles_method=pe
+0001c090: 7263 656e 7469 6c65 735f 6d65 7468 6f64  rcentiles_method
+0001c0a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c0b0: 2020 6973 5f64 6174 6574 696d 655f 636f    is_datetime_co
+0001c0c0: 6c75 6d6e 3d54 7275 652c 0a20 2020 2020  lumn=True,.     
+0001c0d0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001c0e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001c0f0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0001c100: 6465 7363 7269 6265 5f6e 6f6e 6e75 6d65  describe_nonnume
+0001c110: 7269 635f 3164 280a 2020 2020 2020 2020  ric_1d(.        
+0001c120: 2020 2020 2020 2020 6461 7461 2c20 7370          data, sp
+0001c130: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+0001c140: 6576 6572 792c 2064 6174 6574 696d 655f  every, datetime_
+0001c150: 6973 5f6e 756d 6572 6963 3d64 6174 6574  is_numeric=datet
+0001c160: 696d 655f 6973 5f6e 756d 6572 6963 0a20  ime_is_numeric. 
+0001c170: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0001c180: 2020 6465 6620 5f64 6573 6372 6962 655f    def _describe_
+0001c190: 6e75 6d65 7269 6328 0a20 2020 2020 2020  numeric(.       
+0001c1a0: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
+0001c1b0: 6174 612c 0a20 2020 2020 2020 2073 706c  ata,.        spl
+0001c1c0: 6974 5f65 7665 7279 3d46 616c 7365 2c0a  it_every=False,.
+0001c1d0: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
+0001c1e0: 6c65 733d 4e6f 6e65 2c0a 2020 2020 2020  les=None,.      
+0001c1f0: 2020 7065 7263 656e 7469 6c65 735f 6d65    percentiles_me
+0001c200: 7468 6f64 3d22 6465 6661 756c 7422 2c0a  thod="default",.
+0001c210: 2020 2020 2020 2020 6973 5f74 696d 6564          is_timed
+0001c220: 656c 7461 5f63 6f6c 756d 6e3d 4661 6c73  elta_column=Fals
+0001c230: 652c 0a20 2020 2020 2020 2069 735f 6461  e,.        is_da
+0001c240: 7465 7469 6d65 5f63 6f6c 756d 6e3d 4661  tetime_column=Fa
+0001c250: 6c73 652c 0a20 2020 2029 3a0a 2020 2020  lse,.    ):.    
+0001c260: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+0001c270: 7461 6672 616d 652e 6e75 6d65 7269 6320  taframe.numeric 
+0001c280: 696d 706f 7274 2074 6f5f 6e75 6d65 7269  import to_numeri
+0001c290: 630a 0a20 2020 2020 2020 2069 6620 6973  c..        if is
+0001c2a0: 5f74 696d 6564 656c 7461 5f63 6f6c 756d  _timedelta_colum
+0001c2b0: 6e20 6f72 2069 735f 6461 7465 7469 6d65  n or is_datetime
+0001c2c0: 5f63 6f6c 756d 6e3a 0a20 2020 2020 2020  _column:.       
+0001c2d0: 2020 2020 206e 756d 203d 2074 6f5f 6e75       num = to_nu
+0001c2e0: 6d65 7269 6328 6461 7461 290a 2020 2020  meric(data).    
+0001c2f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001c300: 2020 2020 2020 6e75 6d20 3d20 6461 7461        num = data
+0001c310: 2e5f 6765 745f 6e75 6d65 7269 635f 6461  ._get_numeric_da
+0001c320: 7461 2829 0a0a 2020 2020 2020 2020 6966  ta()..        if
+0001c330: 2064 6174 612e 6e64 696d 203d 3d20 3220   data.ndim == 2 
+0001c340: 616e 6420 6c65 6e28 6e75 6d2e 636f 6c75  and len(num.colu
+0001c350: 6d6e 7329 203d 3d20 303a 0a20 2020 2020  mns) == 0:.     
+0001c360: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0001c370: 7565 4572 726f 7228 2244 6174 6146 7261  ueError("DataFra
+0001c380: 6d65 2063 6f6e 7461 696e 7320 6f6e 6c79  me contains only
+0001c390: 206e 6f6e 2d6e 756d 6572 6963 2064 6174   non-numeric dat
+0001c3a0: 612e 2229 0a20 2020 2020 2020 2065 6c69  a.").        eli
+0001c3b0: 6620 6461 7461 2e6e 6469 6d20 3d3d 2031  f data.ndim == 1
+0001c3c0: 2061 6e64 2064 6174 612e 6474 7970 6520   and data.dtype 
+0001c3d0: 3d3d 2022 6f62 6a65 6374 223a 0a20 2020  == "object":.   
+0001c3e0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0001c3f0: 616c 7565 4572 726f 7228 2243 616e 6e6f  alueError("Canno
+0001c400: 7420 636f 6d70 7574 6520 6060 6465 7363  t compute ``desc
+0001c410: 7269 6265 6060 206f 6e20 6f62 6a65 6374  ribe`` on object
+0001c420: 2064 7479 7065 2e22 290a 2020 2020 2020   dtype.").      
+0001c430: 2020 6966 2070 6572 6365 6e74 696c 6573    if percentiles
+0001c440: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0001c450: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
+0001c460: 7320 3d20 5b30 2e32 352c 2030 2e35 2c20  s = [0.25, 0.5, 
+0001c470: 302e 3735 5d0a 2020 2020 2020 2020 656c  0.75].        el
+0001c480: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001c490: 2320 616c 7761 7973 2069 6e63 6c75 6465  # always include
+0001c4a0: 2074 6865 2074 6865 2035 3025 746c 6520   the the 50%tle 
+0001c4b0: 746f 2063 616c 6375 6c61 7465 2074 6865  to calculate the
+0001c4c0: 206d 6564 6961 6e0a 2020 2020 2020 2020   median.        
+0001c4d0: 2020 2020 2320 756e 6971 7565 2072 656d      # unique rem
+0001c4e0: 6f76 6573 2064 7570 6c69 6361 7465 7320  oves duplicates 
+0001c4f0: 616e 6420 736f 7274 7320 7175 616e 7469  and sorts quanti
+0001c500: 6c65 730a 2020 2020 2020 2020 2020 2020  les.            
+0001c510: 7065 7263 656e 7469 6c65 7320 3d20 6e70  percentiles = np
+0001c520: 2e61 7272 6179 2870 6572 6365 6e74 696c  .array(percentil
+0001c530: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+0001c540: 7065 7263 656e 7469 6c65 7320 3d20 6e70  percentiles = np
+0001c550: 2e61 7070 656e 6428 7065 7263 656e 7469  .append(percenti
+0001c560: 6c65 732c 2030 2e35 290a 2020 2020 2020  les, 0.5).      
+0001c570: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
+0001c580: 7320 3d20 6e70 2e75 6e69 7175 6528 7065  s = np.unique(pe
+0001c590: 7263 656e 7469 6c65 7329 0a20 2020 2020  rcentiles).     
+0001c5a0: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
+0001c5b0: 6573 203d 206c 6973 7428 7065 7263 656e  es = list(percen
+0001c5c0: 7469 6c65 7329 0a20 2020 2020 2020 2073  tiles).        s
+0001c5d0: 7461 7473 203d 205b 0a20 2020 2020 2020  tats = [.       
+0001c5e0: 2020 2020 206e 756d 2e63 6f75 6e74 2873       num.count(s
+0001c5f0: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+0001c600: 5f65 7665 7279 292c 0a20 2020 2020 2020  _every),.       
+0001c610: 2020 2020 206e 756d 2e6d 6561 6e28 7370       num.mean(sp
+0001c620: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+0001c630: 6576 6572 7929 2c0a 2020 2020 2020 2020  every),.        
+0001c640: 2020 2020 6e75 6d2e 7374 6428 7370 6c69      num.std(spli
+0001c650: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+0001c660: 6572 7929 2c0a 2020 2020 2020 2020 2020  ery),.          
+0001c670: 2020 6e75 6d2e 6d69 6e28 7370 6c69 745f    num.min(split_
+0001c680: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+0001c690: 7929 2c0a 2020 2020 2020 2020 2020 2020  y),.            
+0001c6a0: 6e75 6d2e 7175 616e 7469 6c65 2870 6572  num.quantile(per
+0001c6b0: 6365 6e74 696c 6573 2c20 6d65 7468 6f64  centiles, method
+0001c6c0: 3d70 6572 6365 6e74 696c 6573 5f6d 6574  =percentiles_met
+0001c6d0: 686f 6429 2c0a 2020 2020 2020 2020 2020  hod),.          
+0001c6e0: 2020 6e75 6d2e 6d61 7828 7370 6c69 745f    num.max(split_
+0001c6f0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+0001c700: 7929 2c0a 2020 2020 2020 2020 5d0a 2020  y),.        ].  
+0001c710: 2020 2020 2020 7374 6174 735f 6e61 6d65        stats_name
+0001c720: 7320 3d20 5b28 732e 5f6e 616d 652c 2030  s = [(s._name, 0
+0001c730: 2920 666f 7220 7320 696e 2073 7461 7473  ) for s in stats
+0001c740: 5d0a 0a20 2020 2020 2020 2063 6f6c 6e61  ]..        colna
+0001c750: 6d65 203d 2064 6174 612e 5f6d 6574 612e  me = data._meta.
+0001c760: 6e61 6d65 2069 6620 6973 5f73 6572 6965  name if is_serie
+0001c770: 735f 6c69 6b65 2864 6174 612e 5f6d 6574  s_like(data._met
+0001c780: 6129 2065 6c73 6520 4e6f 6e65 0a0a 2020  a) else None..  
+0001c790: 2020 2020 2020 6e61 6d65 203d 2022 6465        name = "de
+0001c7a0: 7363 7269 6265 2d6e 756d 6572 6963 2d2d  scribe-numeric--
+0001c7b0: 2220 2b20 746f 6b65 6e69 7a65 286e 756d  " + tokenize(num
+0001c7c0: 2c20 7370 6c69 745f 6576 6572 7929 0a20  , split_every). 
+0001c7d0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
+0001c7e0: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
+0001c7f0: 6d65 2c20 3029 3a20 280a 2020 2020 2020  me, 0): (.      
+0001c800: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+0001c810: 732e 6465 7363 7269 6265 5f6e 756d 6572  s.describe_numer
+0001c820: 6963 5f61 6767 7265 6761 7465 2c0a 2020  ic_aggregate,.  
+0001c830: 2020 2020 2020 2020 2020 2020 2020 7374                st
+0001c840: 6174 735f 6e61 6d65 732c 0a20 2020 2020  ats_names,.     
+0001c850: 2020 2020 2020 2020 2020 2063 6f6c 6e61             colna
+0001c860: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0001c870: 2020 2020 6973 5f74 696d 6564 656c 7461      is_timedelta
+0001c880: 5f63 6f6c 756d 6e2c 0a20 2020 2020 2020  _column,.       
+0001c890: 2020 2020 2020 2020 2069 735f 6461 7465           is_date
+0001c8a0: 7469 6d65 5f63 6f6c 756d 6e2c 0a20 2020  time_column,.   
+0001c8b0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001c8c0: 2020 207d 0a20 2020 2020 2020 2067 7261     }.        gra
+0001c8d0: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+0001c8e0: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+0001c8f0: 696f 6e73 286e 616d 652c 206c 6179 6572  ions(name, layer
+0001c900: 2c20 6465 7065 6e64 656e 6369 6573 3d73  , dependencies=s
+0001c910: 7461 7473 290a 2020 2020 2020 2020 6d65  tats).        me
+0001c920: 7461 203d 206e 756d 2e5f 6d65 7461 5f6e  ta = num._meta_n
+0001c930: 6f6e 656d 7074 792e 6465 7363 7269 6265  onempty.describe
+0001c940: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
+0001c950: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
+0001c960: 6772 6170 682c 206e 616d 652c 206d 6574  graph, name, met
+0001c970: 612c 2064 6976 6973 696f 6e73 3d5b 4e6f  a, divisions=[No
+0001c980: 6e65 2c20 4e6f 6e65 5d29 0a0a 2020 2020  ne, None])..    
+0001c990: 6465 6620 5f64 6573 6372 6962 655f 6e6f  def _describe_no
+0001c9a0: 6e6e 756d 6572 6963 5f31 6428 0a20 2020  nnumeric_1d(.   
+0001c9b0: 2020 2020 2073 656c 662c 2064 6174 612c       self, data,
+0001c9c0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+0001c9d0: 7365 2c20 6461 7465 7469 6d65 5f69 735f  se, datetime_is_
+0001c9e0: 6e75 6d65 7269 633d 4661 6c73 650a 2020  numeric=False.  
+0001c9f0: 2020 293a 0a20 2020 2020 2020 2066 726f    ):.        fro
+0001ca00: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
+0001ca10: 2e6e 756d 6572 6963 2069 6d70 6f72 7420  .numeric import 
+0001ca20: 746f 5f6e 756d 6572 6963 0a0a 2020 2020  to_numeric..    
+0001ca30: 2020 2020 7663 6f75 6e74 7320 3d20 6461      vcounts = da
+0001ca40: 7461 2e76 616c 7565 5f63 6f75 6e74 7328  ta.value_counts(
+0001ca50: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+0001ca60: 745f 6576 6572 7929 0a20 2020 2020 2020  t_every).       
+0001ca70: 2063 6f75 6e74 5f6e 6f6e 7a65 726f 203d   count_nonzero =
+0001ca80: 2076 636f 756e 7473 5b76 636f 756e 7473   vcounts[vcounts
+0001ca90: 2021 3d20 305d 0a20 2020 2020 2020 2063   != 0].        c
+0001caa0: 6f75 6e74 5f75 6e69 7175 6520 3d20 636f  ount_unique = co
+0001cab0: 756e 745f 6e6f 6e7a 6572 6f2e 7369 7a65  unt_nonzero.size
+0001cac0: 0a0a 2020 2020 2020 2020 7374 6174 7320  ..        stats 
+0001cad0: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
+0001cae0: 2320 6e75 6e69 7175 650a 2020 2020 2020  # nunique.      
+0001caf0: 2020 2020 2020 636f 756e 745f 756e 6971        count_uniq
+0001cb00: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+0001cb10: 2320 636f 756e 740a 2020 2020 2020 2020  # count.        
+0001cb20: 2020 2020 6461 7461 2e63 6f75 6e74 2873      data.count(s
+0001cb30: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+0001cb40: 5f65 7665 7279 292c 0a20 2020 2020 2020  _every),.       
+0001cb50: 2020 2020 2023 206d 6f73 7420 636f 6d6d       # most comm
+0001cb60: 6f6e 2076 616c 7565 0a20 2020 2020 2020  on value.       
+0001cb70: 2020 2020 2076 636f 756e 7473 2e5f 6865       vcounts._he
+0001cb80: 6164 2831 2c20 6e70 6172 7469 7469 6f6e  ad(1, npartition
+0001cb90: 733d 312c 2063 6f6d 7075 7465 3d46 616c  s=1, compute=Fal
+0001cba0: 7365 2c20 7361 6665 3d46 616c 7365 292c  se, safe=False),
+0001cbb0: 0a20 2020 2020 2020 205d 0a0a 2020 2020  .        ]..    
+0001cbc0: 2020 2020 6966 2069 735f 6461 7465 7469      if is_dateti
+0001cbd0: 6d65 3634 5f61 6e79 5f64 7479 7065 2864  me64_any_dtype(d
+0001cbe0: 6174 612e 5f6d 6574 6129 2061 6e64 206e  ata._meta) and n
+0001cbf0: 6f74 2064 6174 6574 696d 655f 6973 5f6e  ot datetime_is_n
+0001cc00: 756d 6572 6963 3a0a 2020 2020 2020 2020  umeric:.        
+0001cc10: 2020 2020 6d69 6e5f 7473 203d 2074 6f5f      min_ts = to_
+0001cc20: 6e75 6d65 7269 6328 6461 7461 2e64 726f  numeric(data.dro
+0001cc30: 706e 6128 2929 2e6d 696e 2873 706c 6974  pna()).min(split
+0001cc40: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+0001cc50: 7279 290a 2020 2020 2020 2020 2020 2020  ry).            
+0001cc60: 6d61 785f 7473 203d 2074 6f5f 6e75 6d65  max_ts = to_nume
+0001cc70: 7269 6328 6461 7461 2e64 726f 706e 6128  ric(data.dropna(
+0001cc80: 2929 2e6d 6178 2873 706c 6974 5f65 7665  )).max(split_eve
+0001cc90: 7279 3d73 706c 6974 5f65 7665 7279 290a  ry=split_every).
+0001cca0: 2020 2020 2020 2020 2020 2020 7374 6174              stat
+0001ccb0: 732e 6578 7465 6e64 285b 6d69 6e5f 7473  s.extend([min_ts
+0001ccc0: 2c20 6d61 785f 7473 5d29 0a0a 2020 2020  , max_ts])..    
+0001ccd0: 2020 2020 7374 6174 735f 6e61 6d65 7320      stats_names 
+0001cce0: 3d20 5b28 732e 5f6e 616d 652c 2030 2920  = [(s._name, 0) 
+0001ccf0: 666f 7220 7320 696e 2073 7461 7473 5d0a  for s in stats].
+0001cd00: 2020 2020 2020 2020 636f 6c6e 616d 6520          colname 
+0001cd10: 3d20 6461 7461 2e5f 6d65 7461 2e6e 616d  = data._meta.nam
+0001cd20: 650a 0a20 2020 2020 2020 206e 616d 6520  e..        name 
+0001cd30: 3d20 2264 6573 6372 6962 652d 6e6f 6e6e  = "describe-nonn
+0001cd40: 756d 6572 6963 2d31 642d 2d22 202b 2074  umeric-1d--" + t
+0001cd50: 6f6b 656e 697a 6528 6461 7461 2c20 7370  okenize(data, sp
+0001cd60: 6c69 745f 6576 6572 7929 0a20 2020 2020  lit_every).     
+0001cd70: 2020 206c 6179 6572 203d 207b 0a20 2020     layer = {.   
+0001cd80: 2020 2020 2020 2020 2028 6e61 6d65 2c20           (name, 
+0001cd90: 3029 3a20 286d 6574 686f 6473 2e64 6573  0): (methods.des
+0001cda0: 6372 6962 655f 6e6f 6e6e 756d 6572 6963  cribe_nonnumeric
+0001cdb0: 5f61 6767 7265 6761 7465 2c20 7374 6174  _aggregate, stat
+0001cdc0: 735f 6e61 6d65 732c 2063 6f6c 6e61 6d65  s_names, colname
+0001cdd0: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
+0001cde0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
+0001cdf0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+0001ce00: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
+0001ce10: 2c20 6c61 7965 722c 2064 6570 656e 6465  , layer, depende
+0001ce20: 6e63 6965 733d 7374 6174 7329 0a0a 2020  ncies=stats)..  
+0001ce30: 2020 2020 2020 6966 206e 6f74 2050 414e        if not PAN
+0001ce40: 4441 535f 4754 5f32 3030 3a0a 2020 2020  DAS_GT_200:.    
+0001ce50: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
+0001ce60: 5f69 735f 6e75 6d65 7269 635f 6b77 6172  _is_numeric_kwar
+0001ce70: 6720 3d20 7b22 6461 7465 7469 6d65 5f69  g = {"datetime_i
+0001ce80: 735f 6e75 6d65 7269 6322 3a20 6461 7465  s_numeric": date
+0001ce90: 7469 6d65 5f69 735f 6e75 6d65 7269 637d  time_is_numeric}
+0001cea0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0001ceb0: 2020 2020 2020 2020 2020 2064 6174 6574             datet
+0001cec0: 696d 655f 6973 5f6e 756d 6572 6963 5f6b  ime_is_numeric_k
+0001ced0: 7761 7267 203d 207b 7d0a 2020 2020 2020  warg = {}.      
+0001cee0: 2020 6d65 7461 203d 2064 6174 612e 5f6d    meta = data._m
+0001cef0: 6574 615f 6e6f 6e65 6d70 7479 2e64 6573  eta_nonempty.des
+0001cf00: 6372 6962 6528 2a2a 6461 7465 7469 6d65  cribe(**datetime
+0001cf10: 5f69 735f 6e75 6d65 7269 635f 6b77 6172  _is_numeric_kwar
+0001cf20: 6729 0a20 2020 2020 2020 2072 6574 7572  g).        retur
+0001cf30: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
+0001cf40: 6772 6170 682c 206e 616d 652c 206d 6574  graph, name, met
+0001cf50: 612c 2064 6976 6973 696f 6e73 3d5b 4e6f  a, divisions=[No
+0001cf60: 6e65 2c20 4e6f 6e65 5d29 0a0a 2020 2020  ne, None])..    
+0001cf70: 6465 6620 5f63 756d 5f61 6767 280a 2020  def _cum_agg(.  
+0001cf80: 2020 2020 2020 7365 6c66 2c20 6f70 5f6e        self, op_n
+0001cf90: 616d 652c 2063 6875 6e6b 2c20 6167 6772  ame, chunk, aggr
+0001cfa0: 6567 6174 652c 2061 7869 732c 2073 6b69  egate, axis, ski
+0001cfb0: 706e 613d 5472 7565 2c20 6368 756e 6b5f  pna=True, chunk_
+0001cfc0: 6b77 6172 6773 3d4e 6f6e 652c 206f 7574  kwargs=None, out
+0001cfd0: 3d4e 6f6e 650a 2020 2020 293a 0a20 2020  =None.    ):.   
+0001cfe0: 2020 2020 2022 2222 5772 6170 7065 7220       """Wrapper 
+0001cff0: 666f 7220 6375 6d75 6c61 7469 7665 206f  for cumulative o
+0001d000: 7065 7261 7469 6f6e 2222 220a 0a20 2020  peration"""..   
+0001d010: 2020 2020 2061 7869 7320 3d20 7365 6c66       axis = self
+0001d020: 2e5f 7661 6c69 6461 7465 5f61 7869 7328  ._validate_axis(
+0001d030: 6178 6973 290a 0a20 2020 2020 2020 2069  axis)..        i
+0001d040: 6620 6178 6973 203d 3d20 313a 0a20 2020  f axis == 1:.   
+0001d050: 2020 2020 2020 2020 206e 616d 6520 3d20           name = 
+0001d060: 6622 7b73 656c 662e 5f74 6f6b 656e 5f70  f"{self._token_p
+0001d070: 7265 6669 787d 7b6f 705f 6e61 6d65 7d28  refix}{op_name}(
+0001d080: 6178 6973 3d31 2922 0a20 2020 2020 2020  axis=1)".       
+0001d090: 2020 2020 2072 6573 756c 7420 3d20 7365       result = se
+0001d0a0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+0001d0b0: 7328 6368 756e 6b2c 2074 6f6b 656e 3d6e  s(chunk, token=n
+0001d0c0: 616d 652c 202a 2a63 6875 6e6b 5f6b 7761  ame, **chunk_kwa
+0001d0d0: 7267 7329 0a20 2020 2020 2020 2020 2020  rgs).           
+0001d0e0: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
+0001d0f0: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
+0001d100: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001d110: 2020 2020 2020 2020 2020 2320 6375 6d75            # cumu
+0001d120: 6c61 7465 2065 6163 6820 7061 7274 6974  late each partit
+0001d130: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
+0001d140: 206e 616d 6531 203d 2066 227b 7365 6c66   name1 = f"{self
+0001d150: 2e5f 746f 6b65 6e5f 7072 6566 6978 7d7b  ._token_prefix}{
+0001d160: 6f70 5f6e 616d 657d 2d6d 6170 220a 2020  op_name}-map".  
+0001d170: 2020 2020 2020 2020 2020 6375 6d70 6172            cumpar
+0001d180: 7420 3d20 6d61 705f 7061 7274 6974 696f  t = map_partitio
+0001d190: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+0001d1a0: 2020 2020 6368 756e 6b2c 2073 656c 662c      chunk, self,
+0001d1b0: 2074 6f6b 656e 3d6e 616d 6531 2c20 6d65   token=name1, me
+0001d1c0: 7461 3d73 656c 662c 202a 2a63 6875 6e6b  ta=self, **chunk
+0001d1d0: 5f6b 7761 7267 730a 2020 2020 2020 2020  _kwargs.        
+0001d1e0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+0001d1f0: 2020 206e 616d 6532 203d 2066 227b 7365     name2 = f"{se
+0001d200: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
+0001d210: 7d7b 6f70 5f6e 616d 657d 2d74 616b 652d  }{op_name}-take-
+0001d220: 6c61 7374 220a 2020 2020 2020 2020 2020  last".          
+0001d230: 2020 6375 6d6c 6173 7420 3d20 6d61 705f    cumlast = map_
+0001d240: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+0001d250: 2020 2020 2020 2020 2020 2020 5f74 616b              _tak
+0001d260: 655f 6c61 7374 2c0a 2020 2020 2020 2020  e_last,.        
+0001d270: 2020 2020 2020 2020 6375 6d70 6172 742c          cumpart,
+0001d280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d290: 2073 6b69 706e 612c 0a20 2020 2020 2020   skipna,.       
+0001d2a0: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
+0001d2b0: 7461 5f73 6572 6965 735f 636f 6e73 7472  ta_series_constr
+0001d2c0: 7563 746f 7228 7365 6c66 2928 5b5d 2c20  uctor(self)([], 
+0001d2d0: 6474 7970 653d 2266 6c6f 6174 2229 2c0a  dtype="float"),.
+0001d2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d2f0: 746f 6b65 6e3d 6e61 6d65 322c 0a20 2020  token=name2,.   
+0001d300: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0001d310: 2020 2020 2020 2020 7375 6666 6978 203d          suffix =
+0001d320: 2074 6f6b 656e 697a 6528 7365 6c66 290a   tokenize(self).
+0001d330: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0001d340: 203d 2066 227b 7365 6c66 2e5f 746f 6b65   = f"{self._toke
+0001d350: 6e5f 7072 6566 6978 7d7b 6f70 5f6e 616d  n_prefix}{op_nam
+0001d360: 657d 2d7b 7375 6666 6978 7d22 0a20 2020  e}-{suffix}".   
+0001d370: 2020 2020 2020 2020 2063 6e61 6d65 203d           cname =
+0001d380: 2066 227b 7365 6c66 2e5f 746f 6b65 6e5f   f"{self._token_
+0001d390: 7072 6566 6978 7d7b 6f70 5f6e 616d 657d  prefix}{op_name}
+0001d3a0: 2d63 756d 2d6c 6173 742d 7b73 7566 6669  -cum-last-{suffi
+0001d3b0: 787d 220a 0a20 2020 2020 2020 2020 2020  x}"..           
+0001d3c0: 2023 2061 6767 7265 6761 7465 2063 756d   # aggregate cum
+0001d3d0: 756c 6174 6564 2070 6172 7469 7369 6f6e  ulated partision
+0001d3e0: 7320 616e 6420 6974 7320 7072 6576 696f  s and its previo
+0001d3f0: 7573 206c 6173 7420 656c 656d 656e 740a  us last element.
+0001d400: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
+0001d410: 7220 3d20 7b7d 0a20 2020 2020 2020 2020  r = {}.         
+0001d420: 2020 206c 6179 6572 5b28 6e61 6d65 2c20     layer[(name, 
+0001d430: 3029 5d20 3d20 2863 756d 7061 7274 2e5f  0)] = (cumpart._
+0001d440: 6e61 6d65 2c20 3029 0a0a 2020 2020 2020  name, 0)..      
+0001d450: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+0001d460: 616e 6765 2831 2c20 7365 6c66 2e6e 7061  ange(1, self.npa
+0001d470: 7274 6974 696f 6e73 293a 0a20 2020 2020  rtitions):.     
+0001d480: 2020 2020 2020 2020 2020 2023 2073 746f             # sto
+0001d490: 7265 2065 6163 6820 6375 6d75 6c61 7469  re each cumulati
+0001d4a0: 7665 2073 7465 7020 746f 2067 7261 7068  ve step to graph
+0001d4b0: 2074 6f20 7265 6475 6365 2063 6f6d 7075   to reduce compu
+0001d4c0: 7461 7469 6f6e 0a20 2020 2020 2020 2020  tation.         
+0001d4d0: 2020 2020 2020 2069 6620 6920 3d3d 2031         if i == 1
+0001d4e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001d4f0: 2020 2020 2020 6c61 7965 725b 2863 6e61        layer[(cna
+0001d500: 6d65 2c20 6929 5d20 3d20 2863 756d 6c61  me, i)] = (cumla
+0001d510: 7374 2e5f 6e61 6d65 2c20 6920 2d20 3129  st._name, i - 1)
+0001d520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d530: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001d540: 2020 2020 2020 2020 2020 2023 2061 6767             # agg
+0001d550: 7265 6761 7465 2077 6974 6820 7072 6576  regate with prev
+0001d560: 696f 7573 2063 756d 756c 6174 696f 6e20  ious cumulation 
+0001d570: 7265 7375 6c74 730a 2020 2020 2020 2020  results.        
+0001d580: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
+0001d590: 725b 2863 6e61 6d65 2c20 6929 5d20 3d20  r[(cname, i)] = 
+0001d5a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001d5b0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+0001d5c0: 732e 5f63 756d 5f61 6767 7265 6761 7465  s._cum_aggregate
+0001d5d0: 5f61 7070 6c79 2c0a 2020 2020 2020 2020  _apply,.        
+0001d5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5f0: 6167 6772 6567 6174 652c 0a20 2020 2020  aggregate,.     
+0001d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d610: 2020 2028 636e 616d 652c 2069 202d 2031     (cname, i - 1
+0001d620: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0001d630: 2020 2020 2020 2020 2020 2028 6375 6d6c             (cuml
+0001d640: 6173 742e 5f6e 616d 652c 2069 202d 2031  ast._name, i - 1
+0001d650: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0001d660: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001d670: 2020 2020 2020 2020 206c 6179 6572 5b28           layer[(
+0001d680: 6e61 6d65 2c20 6929 5d20 3d20 2861 6767  name, i)] = (agg
+0001d690: 7265 6761 7465 2c20 2863 756d 7061 7274  regate, (cumpart
+0001d6a0: 2e5f 6e61 6d65 2c20 6929 2c20 2863 6e61  ._name, i), (cna
+0001d6b0: 6d65 2c20 6929 290a 2020 2020 2020 2020  me, i)).        
+0001d6c0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
+0001d6d0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+0001d6e0: 636f 6c6c 6563 7469 6f6e 7328 0a20 2020  collections(.   
+0001d6f0: 2020 2020 2020 2020 2020 2020 206e 616d               nam
+0001d700: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
+0001d710: 656e 6369 6573 3d5b 6375 6d70 6172 742c  encies=[cumpart,
+0001d720: 2063 756d 6c61 7374 5d0a 2020 2020 2020   cumlast].      
+0001d730: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001d740: 2020 2020 7265 7375 6c74 203d 206e 6577      result = new
+0001d750: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
+0001d760: 2c20 6e61 6d65 2c20 6368 756e 6b28 7365  , name, chunk(se
+0001d770: 6c66 2e5f 6d65 7461 292c 2073 656c 662e  lf._meta), self.
+0001d780: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
+0001d790: 2020 2020 2020 2072 6574 7572 6e20 6861         return ha
+0001d7a0: 6e64 6c65 5f6f 7574 286f 7574 2c20 7265  ndle_out(out, re
+0001d7b0: 7375 6c74 290a 0a20 2020 2040 6465 7269  sult)..    @deri
+0001d7c0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0001d7d0: 4672 616d 6529 0a20 2020 2064 6566 2063  Frame).    def c
+0001d7e0: 756d 7375 6d28 7365 6c66 2c20 6178 6973  umsum(self, axis
+0001d7f0: 3d4e 6f6e 652c 2073 6b69 706e 613d 5472  =None, skipna=Tr
+0001d800: 7565 2c20 6474 7970 653d 4e6f 6e65 2c20  ue, dtype=None, 
+0001d810: 6f75 743d 4e6f 6e65 293a 0a20 2020 2020  out=None):.     
+0001d820: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0001d830: 6375 6d5f 6167 6728 0a20 2020 2020 2020  cum_agg(.       
+0001d840: 2020 2020 2022 6375 6d73 756d 222c 0a20       "cumsum",. 
+0001d850: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+0001d860: 3d4d 2e63 756d 7375 6d2c 0a20 2020 2020  =M.cumsum,.     
+0001d870: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
+0001d880: 3d6d 6574 686f 6473 2e63 756d 7375 6d5f  =methods.cumsum_
+0001d890: 6167 6772 6567 6174 652c 0a20 2020 2020  aggregate,.     
+0001d8a0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+0001d8b0: 2c0a 2020 2020 2020 2020 2020 2020 736b  ,.            sk
+0001d8c0: 6970 6e61 3d73 6b69 706e 612c 0a20 2020  ipna=skipna,.   
+0001d8d0: 2020 2020 2020 2020 2063 6875 6e6b 5f6b           chunk_k
+0001d8e0: 7761 7267 733d 6469 6374 2861 7869 733d  wargs=dict(axis=
+0001d8f0: 6178 6973 2c20 736b 6970 6e61 3d73 6b69  axis, skipna=ski
+0001d900: 706e 6129 2c0a 2020 2020 2020 2020 2020  pna),.          
+0001d910: 2020 6f75 743d 6f75 742c 0a20 2020 2020    out=out,.     
+0001d920: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
+0001d930: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+0001d940: 7261 6d65 290a 2020 2020 6465 6620 6375  rame).    def cu
+0001d950: 6d70 726f 6428 7365 6c66 2c20 6178 6973  mprod(self, axis
+0001d960: 3d4e 6f6e 652c 2073 6b69 706e 613d 5472  =None, skipna=Tr
+0001d970: 7565 2c20 6474 7970 653d 4e6f 6e65 2c20  ue, dtype=None, 
+0001d980: 6f75 743d 4e6f 6e65 293a 0a20 2020 2020  out=None):.     
+0001d990: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0001d9a0: 6375 6d5f 6167 6728 0a20 2020 2020 2020  cum_agg(.       
+0001d9b0: 2020 2020 2022 6375 6d70 726f 6422 2c0a       "cumprod",.
+0001d9c0: 2020 2020 2020 2020 2020 2020 6368 756e              chun
+0001d9d0: 6b3d 4d2e 6375 6d70 726f 642c 0a20 2020  k=M.cumprod,.   
+0001d9e0: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
+0001d9f0: 7465 3d6d 6574 686f 6473 2e63 756d 7072  te=methods.cumpr
+0001da00: 6f64 5f61 6767 7265 6761 7465 2c0a 2020  od_aggregate,.  
+0001da10: 2020 2020 2020 2020 2020 6178 6973 3d61            axis=a
+0001da20: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
+0001da30: 2073 6b69 706e 613d 736b 6970 6e61 2c0a   skipna=skipna,.
+0001da40: 2020 2020 2020 2020 2020 2020 6368 756e              chun
+0001da50: 6b5f 6b77 6172 6773 3d64 6963 7428 6178  k_kwargs=dict(ax
+0001da60: 6973 3d61 7869 732c 2073 6b69 706e 613d  is=axis, skipna=
+0001da70: 736b 6970 6e61 292c 0a20 2020 2020 2020  skipna),.       
+0001da80: 2020 2020 206f 7574 3d6f 7574 2c0a 2020       out=out,.  
+0001da90: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
+0001daa0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0001dab0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0001dac0: 2063 756d 6d61 7828 7365 6c66 2c20 6178   cummax(self, ax
+0001dad0: 6973 3d4e 6f6e 652c 2073 6b69 706e 613d  is=None, skipna=
+0001dae0: 5472 7565 2c20 6f75 743d 4e6f 6e65 293a  True, out=None):
+0001daf0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001db00: 7365 6c66 2e5f 6375 6d5f 6167 6728 0a20  self._cum_agg(. 
+0001db10: 2020 2020 2020 2020 2020 2022 6375 6d6d             "cumm
+0001db20: 6178 222c 0a20 2020 2020 2020 2020 2020  ax",.           
+0001db30: 2063 6875 6e6b 3d4d 2e63 756d 6d61 782c   chunk=M.cummax,
+0001db40: 0a20 2020 2020 2020 2020 2020 2061 6767  .            agg
+0001db50: 7265 6761 7465 3d6d 6574 686f 6473 2e63  regate=methods.c
+0001db60: 756d 6d61 785f 6167 6772 6567 6174 652c  ummax_aggregate,
+0001db70: 0a20 2020 2020 2020 2020 2020 2061 7869  .            axi
+0001db80: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
+0001db90: 2020 2020 736b 6970 6e61 3d73 6b69 706e      skipna=skipn
+0001dba0: 612c 0a20 2020 2020 2020 2020 2020 2063  a,.            c
+0001dbb0: 6875 6e6b 5f6b 7761 7267 733d 6469 6374  hunk_kwargs=dict
+0001dbc0: 2861 7869 733d 6178 6973 2c20 736b 6970  (axis=axis, skip
+0001dbd0: 6e61 3d73 6b69 706e 6129 2c0a 2020 2020  na=skipna),.    
+0001dbe0: 2020 2020 2020 2020 6f75 743d 6f75 742c          out=out,
+0001dbf0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0001dc00: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0001dc10: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+0001dc20: 6465 6620 6375 6d6d 696e 2873 656c 662c  def cummin(self,
+0001dc30: 2061 7869 733d 4e6f 6e65 2c20 736b 6970   axis=None, skip
+0001dc40: 6e61 3d54 7275 652c 206f 7574 3d4e 6f6e  na=True, out=Non
+0001dc50: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
+0001dc60: 726e 2073 656c 662e 5f63 756d 5f61 6767  rn self._cum_agg
+0001dc70: 280a 2020 2020 2020 2020 2020 2020 2263  (.            "c
+0001dc80: 756d 6d69 6e22 2c0a 2020 2020 2020 2020  ummin",.        
+0001dc90: 2020 2020 6368 756e 6b3d 4d2e 6375 6d6d      chunk=M.cumm
+0001dca0: 696e 2c0a 2020 2020 2020 2020 2020 2020  in,.            
+0001dcb0: 6167 6772 6567 6174 653d 6d65 7468 6f64  aggregate=method
+0001dcc0: 732e 6375 6d6d 696e 5f61 6767 7265 6761  s.cummin_aggrega
+0001dcd0: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+0001dce0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
+0001dcf0: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
+0001dd00: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
+0001dd10: 2020 6368 756e 6b5f 6b77 6172 6773 3d64    chunk_kwargs=d
+0001dd20: 6963 7428 6178 6973 3d61 7869 732c 2073  ict(axis=axis, s
+0001dd30: 6b69 706e 613d 736b 6970 6e61 292c 0a20  kipna=skipna),. 
+0001dd40: 2020 2020 2020 2020 2020 206f 7574 3d6f             out=o
+0001dd50: 7574 2c0a 2020 2020 2020 2020 290a 0a20  ut,.        ).. 
+0001dd60: 2020 2064 6566 205f 7661 6c69 6461 7465     def _validate
+0001dd70: 5f63 6f6e 6469 7469 6f6e 2873 656c 662c  _condition(self,
+0001dd80: 2063 6f6e 6429 3a0a 2020 2020 2020 2020   cond):.        
+0001dd90: 636f 6e64 5f72 6573 203d 2063 6f6e 6428  cond_res = cond(
+0001dda0: 7365 6c66 2e5f 6d65 7461 2920 6966 2063  self._meta) if c
+0001ddb0: 616c 6c61 626c 6528 636f 6e64 2920 656c  allable(cond) el
+0001ddc0: 7365 2063 6f6e 640a 2020 2020 2020 2020  se cond.        
+0001ddd0: 6966 206e 6f74 2028 0a20 2020 2020 2020  if not (.       
+0001dde0: 2020 2020 2069 735f 6461 736b 5f63 6f6c       is_dask_col
+0001ddf0: 6c65 6374 696f 6e28 636f 6e64 5f72 6573  lection(cond_res
+0001de00: 290a 2020 2020 2020 2020 2020 2020 6f72  ).            or
+0001de10: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
+0001de20: 6b65 2863 6f6e 645f 7265 7329 0a20 2020  ke(cond_res).   
+0001de30: 2020 2020 2020 2020 206f 7220 6973 5f73           or is_s
+0001de40: 6572 6965 735f 6c69 6b65 2863 6f6e 645f  eries_like(cond_
+0001de50: 7265 7329 0a20 2020 2020 2020 2020 2020  res).           
+0001de60: 206f 7220 6973 5f69 6e64 6578 5f6c 696b   or is_index_lik
+0001de70: 6528 636f 6e64 5f72 6573 290a 2020 2020  e(cond_res).    
+0001de80: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+0001de90: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0001dea0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0001deb0: 2020 2020 2066 2243 6f6e 6469 7469 6f6e       f"Condition
+0001dec0: 2073 686f 756c 6420 6265 2061 6e20 6f62   should be an ob
+0001ded0: 6a65 6374 2074 6861 7420 6361 6e20 6265  ject that can be
+0001dee0: 2061 6c69 676e 6564 2077 6974 6820 7b73   aligned with {s
+0001def0: 656c 662e 5f5f 636c 6173 735f 5f7d 2c20  elf.__class__}, 
+0001df00: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0001df10: 2020 6622 2077 6869 6368 2069 6e63 6c75    f" which inclu
+0001df20: 6465 7320 4461 736b 206f 7220 7061 6e64  des Dask or pand
+0001df30: 6173 2063 6f6c 6c65 6374 696f 6e73 2c20  as collections, 
+0001df40: 4461 7461 4672 616d 6573 206f 7220 5365  DataFrames or Se
+0001df50: 7269 6573 2c20 6f72 2061 2043 616c 6c61  ries, or a Calla
+0001df60: 626c 652e 220a 2020 2020 2020 2020 2020  ble.".          
+0001df70: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
+0001df80: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+0001df90: 616d 6529 0a20 2020 2064 6566 2077 6865  ame).    def whe
+0001dfa0: 7265 2873 656c 662c 2063 6f6e 642c 206f  re(self, cond, o
+0001dfb0: 7468 6572 3d6e 702e 6e61 6e29 3a0a 2020  ther=np.nan):.  
+0001dfc0: 2020 2020 2020 2320 636f 6e64 2061 6e64        # cond and
+0001dfd0: 206f 7468 6572 206d 6179 2062 6520 6461   other may be da
+0001dfe0: 736b 2069 6e73 7461 6e63 652c 0a20 2020  sk instance,.   
+0001dff0: 2020 2020 2023 2070 6173 7369 6e67 206d       # passing m
+0001e000: 6170 5f70 6172 7469 7469 6f6e 7320 7669  ap_partitions vi
+0001e010: 6120 6b65 7977 6f72 6420 7769 6c6c 206e  a keyword will n
+0001e020: 6f74 2062 6520 616c 6967 6e65 640a 2020  ot be aligned.  
+0001e030: 2020 2020 2020 7365 6c66 2e5f 7661 6c69        self._vali
+0001e040: 6461 7465 5f63 6f6e 6469 7469 6f6e 2863  date_condition(c
+0001e050: 6f6e 6429 0a20 2020 2020 2020 2072 6574  ond).        ret
+0001e060: 7572 6e20 6d61 705f 7061 7274 6974 696f  urn map_partitio
+0001e070: 6e73 284d 2e77 6865 7265 2c20 7365 6c66  ns(M.where, self
+0001e080: 2c20 636f 6e64 2c20 6f74 6865 722c 2065  , cond, other, e
+0001e090: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+0001e0a0: 4661 6c73 6529 0a0a 2020 2020 4064 6572  False)..    @der
+0001e0b0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+0001e0c0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+0001e0d0: 6d61 736b 2873 656c 662c 2063 6f6e 642c  mask(self, cond,
+0001e0e0: 206f 7468 6572 3d6e 702e 6e61 6e29 3a0a   other=np.nan):.
+0001e0f0: 2020 2020 2020 2020 7365 6c66 2e5f 7661          self._va
+0001e100: 6c69 6461 7465 5f63 6f6e 6469 7469 6f6e  lidate_condition
+0001e110: 2863 6f6e 6429 0a20 2020 2020 2020 2072  (cond).        r
+0001e120: 6574 7572 6e20 6d61 705f 7061 7274 6974  eturn map_partit
+0001e130: 696f 6e73 284d 2e6d 6173 6b2c 2073 656c  ions(M.mask, sel
+0001e140: 662c 2063 6f6e 642c 206f 7468 6572 2c20  f, cond, other, 
+0001e150: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+0001e160: 3d46 616c 7365 290a 0a20 2020 2040 6465  =False)..    @de
+0001e170: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0001e180: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0001e190: 206e 6f74 6e75 6c6c 2873 656c 6629 3a0a   notnull(self):.
+0001e1a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001e1b0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+0001e1c0: 6e73 284d 2e6e 6f74 6e75 6c6c 2c20 656e  ns(M.notnull, en
+0001e1d0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+0001e1e0: 616c 7365 290a 0a20 2020 2040 6465 7269  alse)..    @deri
+0001e1f0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0001e200: 4672 616d 6529 0a20 2020 2064 6566 2069  Frame).    def i
+0001e210: 736e 756c 6c28 7365 6c66 293a 0a20 2020  snull(self):.   
+0001e220: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001e230: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+0001e240: 4d2e 6973 6e75 6c6c 2c20 656e 666f 7263  M.isnull, enforc
+0001e250: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+0001e260: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0001e270: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0001e280: 6529 0a20 2020 2064 6566 2069 736e 6128  e).    def isna(
+0001e290: 7365 6c66 293a 0a20 2020 2020 2020 2069  self):.        i
+0001e2a0: 6620 6861 7361 7474 7228 7064 2c20 2269  f hasattr(pd, "i
+0001e2b0: 736e 6122 293a 0a20 2020 2020 2020 2020  sna"):.         
+0001e2c0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+0001e2d0: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
+0001e2e0: 6973 6e61 2c20 656e 666f 7263 655f 6d65  isna, enforce_me
+0001e2f0: 7461 6461 7461 3d46 616c 7365 290a 2020  tadata=False).  
+0001e300: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001e310: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+0001e320: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+0001e330: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0001e340: 2020 2022 4e65 6564 206d 6f72 6520 7265     "Need more re
+0001e350: 6365 6e74 2076 6572 7369 6f6e 206f 6620  cent version of 
+0001e360: 5061 6e64 6173 2022 0a20 2020 2020 2020  Pandas ".       
+0001e370: 2020 2020 2020 2020 2022 746f 2073 7570           "to sup
+0001e380: 706f 7274 2069 736e 612e 2022 0a20 2020  port isna. ".   
+0001e390: 2020 2020 2020 2020 2020 2020 2022 506c               "Pl
+0001e3a0: 6561 7365 2075 7365 2069 736e 756c 6c20  ease use isnull 
+0001e3b0: 696e 7374 6561 642e 220a 2020 2020 2020  instead.".      
+0001e3c0: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
+0001e3d0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0001e3e0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0001e3f0: 2069 7369 6e28 7365 6c66 2c20 7661 6c75   isin(self, valu
+0001e400: 6573 293a 0a20 2020 2020 2020 2069 6620  es):.        if 
+0001e410: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+0001e420: 6528 7365 6c66 2e5f 6d65 7461 293a 0a20  e(self._meta):. 
+0001e430: 2020 2020 2020 2020 2020 2023 2044 6174             # Dat
+0001e440: 6146 7261 6d65 2e69 7369 6e20 646f 6573  aFrame.isin does
+0001e450: 2077 6569 7264 2061 6c69 676e 6d65 6e74   weird alignment
+0001e460: 2073 7475 6666 0a20 2020 2020 2020 2020   stuff.         
+0001e470: 2020 2062 6164 5f74 7970 6573 203d 2028     bad_types = (
+0001e480: 5f46 7261 6d65 2c20 7064 2e53 6572 6965  _Frame, pd.Serie
+0001e490: 732c 2070 642e 4461 7461 4672 616d 6529  s, pd.DataFrame)
+0001e4a0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0001e4b0: 2020 2020 2020 2020 2020 2062 6164 5f74             bad_t
+0001e4c0: 7970 6573 203d 2028 5f46 7261 6d65 2c29  ypes = (_Frame,)
+0001e4d0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0001e4e0: 7374 616e 6365 2876 616c 7565 732c 2062  stance(values, b
+0001e4f0: 6164 5f74 7970 6573 293a 0a20 2020 2020  ad_types):.     
+0001e500: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+0001e510: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+0001e520: 2822 5061 7373 696e 6720 6120 2572 2074  ("Passing a %r t
+0001e530: 6f20 6069 7369 6e60 2220 2520 7479 7065  o `isin`" % type
+0001e540: 6e61 6d65 2874 7970 6528 7661 6c75 6573  name(type(values
+0001e550: 2929 290a 2020 2020 2020 2020 6d65 7461  ))).        meta
+0001e560: 203d 2073 656c 662e 5f6d 6574 615f 6e6f   = self._meta_no
+0001e570: 6e65 6d70 7479 2e69 7369 6e28 7661 6c75  nempty.isin(valu
+0001e580: 6573 290a 2020 2020 2020 2020 2320 5765  es).        # We
+0001e590: 2077 7261 7020 7661 6c75 6573 2069 6e20   wrap values in 
+0001e5a0: 6120 6465 6c61 7965 6420 666f 7220 7477  a delayed for tw
+0001e5b0: 6f20 7265 6173 6f6e 733a 0a20 2020 2020  o reasons:.     
+0001e5c0: 2020 2023 202d 2061 766f 6964 2073 6572     # - avoid ser
+0001e5d0: 6961 6c69 7a69 6e67 2064 6174 6120 696e  ializing data in
+0001e5e0: 2065 7665 7279 2074 6173 6b0a 2020 2020   every task.    
+0001e5f0: 2020 2020 2320 2d20 6176 6f69 6420 636f      # - avoid co
+0001e600: 7374 206f 6620 7472 6176 6572 7361 6c20  st of traversal 
+0001e610: 6f66 206c 6172 6765 206c 6973 7420 696e  of large list in
+0001e620: 206f 7074 696d 697a 6174 696f 6e73 0a20   optimizations. 
+0001e630: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0001e640: 616e 6365 2876 616c 7565 732c 206c 6973  ance(values, lis
+0001e650: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0001e660: 2320 4d6f 7469 7661 7465 6420 6279 2068  # Motivated by h
+0001e670: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+0001e680: 6d2f 6461 736b 2f64 6173 6b2f 6973 7375  m/dask/dask/issu
+0001e690: 6573 2f39 3431 312e 2020 5468 6973 2061  es/9411.  This a
+0001e6a0: 7070 6561 7273 2074 6f20 6265 0a20 2020  ppears to be.   
+0001e6b0: 2020 2020 2020 2020 2023 2063 6175 7365           # cause
+0001e6c0: 6420 6279 2068 7474 7073 3a2f 2f67 6974  d by https://git
+0001e6d0: 6875 622e 636f 6d2f 6461 736b 2f64 6973  hub.com/dask/dis
+0001e6e0: 7472 6962 7574 6564 2f69 7373 7565 732f  tributed/issues/
+0001e6f0: 3633 3638 2c20 616e 6420 6675 7274 6865  6368, and furthe
+0001e700: 720a 2020 2020 2020 2020 2020 2020 2320  r.            # 
+0001e710: 6578 6163 6572 6261 7465 6420 6279 2074  exacerbated by t
+0001e720: 6865 2066 6163 7420 7468 6174 2074 6865  he fact that the
+0001e730: 206c 6973 7420 636f 6e74 6169 6e73 2064   list contains d
+0001e740: 7570 6c69 6361 7465 732e 2020 5468 6973  uplicates.  This
+0001e750: 2069 7320 6120 7061 7463 6820 756e 7469   is a patch unti
+0001e760: 6c0a 2020 2020 2020 2020 2020 2020 2320  l.            # 
+0001e770: 7765 2063 616e 2063 7265 6174 6520 6120  we can create a 
+0001e780: 6265 7474 6572 2066 6978 2066 6f72 2053  better fix for S
+0001e790: 6572 6961 6c69 7a61 7469 6f6e 2e0a 2020  erialization..  
+0001e7a0: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
+0001e7b0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0001e7c0: 616c 7565 7320 3d20 6c69 7374 2873 6574  alues = list(set
+0001e7d0: 2876 616c 7565 7329 290a 2020 2020 2020  (values)).      
+0001e7e0: 2020 2020 2020 6578 6365 7074 2054 7970        except Typ
+0001e7f0: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
+0001e800: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
+0001e810: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0001e820: 616e 7928 6973 5f64 6173 6b5f 636f 6c6c  any(is_dask_coll
+0001e830: 6563 7469 6f6e 2876 2920 666f 7220 7620  ection(v) for v 
+0001e840: 696e 2076 616c 7565 7329 3a0a 2020 2020  in values):.    
+0001e850: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+0001e860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e870: 2020 2020 2076 616c 7565 7320 3d20 6e70       values = np
+0001e880: 2e66 726f 6d69 7465 7228 7661 6c75 6573  .fromiter(values
+0001e890: 2c20 6474 7970 653d 6f62 6a65 6374 290a  , dtype=object).
+0001e8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e8b0: 6578 6365 7074 2056 616c 7565 4572 726f  except ValueErro
+0001e8c0: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+0001e8d0: 2020 2020 2020 2023 204e 756d 7079 2031         # Numpy 1
+0001e8e0: 2e32 3320 7375 7070 6f72 7473 2063 7265  .23 supports cre
+0001e8f0: 6174 696e 6720 6172 7261 7973 206f 6620  ating arrays of 
+0001e900: 6974 6572 6162 6c65 732c 2077 6869 6c65  iterables, while
+0001e910: 206c 6f77 6572 0a20 2020 2020 2020 2020   lower.         
+0001e920: 2020 2020 2020 2020 2020 2023 2076 6572             # ver
+0001e930: 7369 6f6e 2031 2e32 312e 7820 616e 6420  sion 1.21.x and 
+0001e940: 312e 3232 2e78 2064 6f20 6e6f 740a 2020  1.22.x do not.  
+0001e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e960: 2020 7061 7373 0a20 2020 2020 2020 2072    pass.        r
+0001e970: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+0001e980: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0001e990: 2020 2020 2020 204d 2e69 7369 6e2c 2064         M.isin, d
+0001e9a0: 656c 6179 6564 2876 616c 7565 7329 2c20  elayed(values), 
+0001e9b0: 6d65 7461 3d6d 6574 612c 2065 6e66 6f72  meta=meta, enfor
+0001e9c0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+0001e9d0: 650a 2020 2020 2020 2020 290a 0a20 2020  e.        )..   
+0001e9e0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+0001e9f0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+0001ea00: 2064 6566 2061 7374 7970 6528 7365 6c66   def astype(self
+0001ea10: 2c20 6474 7970 6529 3a0a 2020 2020 2020  , dtype):.      
+0001ea20: 2020 2320 5858 583a 2050 616e 6461 7320    # XXX: Pandas 
+0001ea30: 7769 6c6c 2073 6567 6661 756c 7420 666f  will segfault fo
+0001ea40: 7220 656d 7074 7920 6461 7461 6672 616d  r empty datafram
+0001ea50: 6573 2077 6865 6e20 7365 7474 696e 670a  es when setting.
+0001ea60: 2020 2020 2020 2020 2320 6361 7465 676f          # catego
+0001ea70: 7269 6361 6c20 6474 7970 6573 2e20 5468  rical dtypes. Th
+0001ea80: 6973 206f 7065 7261 7469 6f6e 2069 736e  is operation isn
+0001ea90: 2774 2061 6c6c 6f77 6564 2063 7572 7265  't allowed curre
+0001eaa0: 6e74 6c79 2061 6e79 7761 792e 2057 650a  ntly anyway. We.
+0001eab0: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+0001eac0: 6520 6d65 7461 6461 7461 2077 6974 6820  e metadata with 
+0001ead0: 6120 6e6f 6e2d 656d 7074 7920 6672 616d  a non-empty fram
+0001eae0: 6520 746f 2074 6872 6f77 2074 6865 2065  e to throw the e
+0001eaf0: 7272 6f72 2069 6e73 7465 6164 206f 660a  rror instead of.
+0001eb00: 2020 2020 2020 2020 2320 7365 6766 6175          # segfau
+0001eb10: 6c74 696e 672e 0a20 2020 2020 2020 2069  lting..        i
+0001eb20: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+0001eb30: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+0001eb40: 6528 7365 6c66 2e5f 6d65 7461 290a 2020  e(self._meta).  
+0001eb50: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
+0001eb60: 7420 6861 7361 7474 7228 6474 7970 652c  t hasattr(dtype,
+0001eb70: 2022 6974 656d 7322 290a 2020 2020 2020   "items").      
+0001eb80: 2020 2020 2020 616e 6420 6973 696e 7374        and isinst
+0001eb90: 616e 6365 2870 642e 6170 692e 7479 7065  ance(pd.api.type
+0001eba0: 732e 7061 6e64 6173 5f64 7479 7065 2864  s.pandas_dtype(d
+0001ebb0: 7479 7065 292c 2070 642e 4361 7465 676f  type), pd.Catego
+0001ebc0: 7269 6361 6c44 7479 7065 290a 2020 2020  ricalDtype).    
+0001ebd0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+0001ebe0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+0001ebf0: 6d65 7461 5f6e 6f6e 656d 7074 792e 6173  meta_nonempty.as
+0001ec00: 7479 7065 2864 7479 7065 290a 2020 2020  type(dtype).    
+0001ec10: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001ec20: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
+0001ec30: 662e 5f6d 6574 612e 6173 7479 7065 2864  f._meta.astype(d
+0001ec40: 7479 7065 290a 2020 2020 2020 2020 6966  type).        if
+0001ec50: 2068 6173 6174 7472 2864 7479 7065 2c20   hasattr(dtype, 
+0001ec60: 2269 7465 6d73 2229 3a0a 2020 2020 2020  "items"):.      
+0001ec70: 2020 2020 2020 7365 745f 756e 6b6e 6f77        set_unknow
+0001ec80: 6e20 3d20 5b0a 2020 2020 2020 2020 2020  n = [.          
+0001ec90: 2020 2020 2020 6b0a 2020 2020 2020 2020        k.        
+0001eca0: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
+0001ecb0: 2069 6e20 6474 7970 652e 6974 656d 7328   in dtype.items(
+0001ecc0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001ecd0: 2020 6966 2028 6973 696e 7374 616e 6365    if (isinstance
+0001ece0: 2870 642e 6170 692e 7479 7065 732e 7061  (pd.api.types.pa
+0001ecf0: 6e64 6173 5f64 7479 7065 2876 292c 2070  ndas_dtype(v), p
+0001ed00: 642e 4361 7465 676f 7269 6361 6c44 7479  d.CategoricalDty
+0001ed10: 7065 2929 0a20 2020 2020 2020 2020 2020  pe)).           
+0001ed20: 2020 2020 2061 6e64 2067 6574 6174 7472       and getattr
+0001ed30: 2876 2c20 2263 6174 6567 6f72 6965 7322  (v, "categories"
+0001ed40: 2c20 4e6f 6e65 2920 6973 204e 6f6e 650a  , None) is None.
+0001ed50: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+0001ed60: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
+0001ed70: 2063 6c65 6172 5f6b 6e6f 776e 5f63 6174   clear_known_cat
+0001ed80: 6567 6f72 6965 7328 6d65 7461 2c20 636f  egories(meta, co
+0001ed90: 6c73 3d73 6574 5f75 6e6b 6e6f 776e 290a  ls=set_unknown).
+0001eda0: 2020 2020 2020 2020 656c 6966 2028 0a20          elif (. 
+0001edb0: 2020 2020 2020 2020 2020 2069 7369 6e73             isins
+0001edc0: 7461 6e63 6528 7064 2e61 7069 2e74 7970  tance(pd.api.typ
+0001edd0: 6573 2e70 616e 6461 735f 6474 7970 6528  es.pandas_dtype(
+0001ede0: 6474 7970 6529 2c20 7064 2e43 6174 6567  dtype), pd.Categ
+0001edf0: 6f72 6963 616c 4474 7970 6529 0a20 2020  oricalDtype).   
+0001ee00: 2020 2020 2029 2061 6e64 2067 6574 6174       ) and getat
+0001ee10: 7472 2864 7479 7065 2c20 2263 6174 6567  tr(dtype, "categ
+0001ee20: 6f72 6965 7322 2c20 4e6f 6e65 2920 6973  ories", None) is
+0001ee30: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0001ee40: 2020 206d 6574 6120 3d20 636c 6561 725f     meta = clear_
+0001ee50: 6b6e 6f77 6e5f 6361 7465 676f 7269 6573  known_categories
+0001ee60: 286d 6574 6129 0a20 2020 2020 2020 2072  (meta).        r
+0001ee70: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+0001ee80: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0001ee90: 2020 2020 2020 204d 2e61 7374 7970 652c         M.astype,
+0001eea0: 2064 7479 7065 3d64 7479 7065 2c20 6d65   dtype=dtype, me
+0001eeb0: 7461 3d6d 6574 612c 2065 6e66 6f72 6365  ta=meta, enforce
+0001eec0: 5f6d 6574 6164 6174 613d 4661 6c73 650a  _metadata=False.
+0001eed0: 2020 2020 2020 2020 290a 0a20 2020 2069          )..    i
+0001eee0: 6620 6e6f 7420 5041 4e44 4153 5f47 545f  f not PANDAS_GT_
+0001eef0: 3230 303a 0a0a 2020 2020 2020 2020 4064  200:..        @d
+0001ef00: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+0001ef10: 6572 6965 7329 0a20 2020 2020 2020 2064  eries).        d
+0001ef20: 6566 2061 7070 656e 6428 7365 6c66 2c20  ef append(self, 
+0001ef30: 6f74 6865 722c 2069 6e74 6572 6c65 6176  other, interleav
+0001ef40: 655f 7061 7274 6974 696f 6e73 3d46 616c  e_partitions=Fal
+0001ef50: 7365 293a 0a20 2020 2020 2020 2020 2020  se):.           
+0001ef60: 2069 6620 5041 4e44 4153 5f47 545f 3134   if PANDAS_GT_14
+0001ef70: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0001ef80: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+0001ef90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001efa0: 2020 2020 2020 2254 6865 2066 7261 6d65        "The frame
+0001efb0: 2e61 7070 656e 6420 6d65 7468 6f64 2069  .append method i
+0001efc0: 7320 6465 7072 6563 6174 6564 2061 6e64  s deprecated and
+0001efd0: 2077 696c 6c20 6265 2072 656d 6f76 6564   will be removed
+0001efe0: 2066 726f 6d22 0a20 2020 2020 2020 2020   from".         
+0001eff0: 2020 2020 2020 2020 2020 2022 6461 736b             "dask
+0001f000: 2069 6e20 6120 6675 7475 7265 2076 6572   in a future ver
+0001f010: 7369 6f6e 2e20 5573 6520 6461 736b 2e64  sion. Use dask.d
+0001f020: 6174 6166 7261 6d65 2e63 6f6e 6361 7420  ataframe.concat 
+0001f030: 696e 7374 6561 642e 222c 0a20 2020 2020  instead.",.     
+0001f040: 2020 2020 2020 2020 2020 2020 2020 2046                 F
+0001f050: 7574 7572 6557 6172 6e69 6e67 2c0a 2020  utureWarning,.  
+0001f060: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0001f070: 2020 2020 2020 2020 2020 2020 2320 6265              # be
+0001f080: 6361 7573 6520 4461 7461 4672 616d 652e  cause DataFrame.
+0001f090: 6170 7065 6e64 2077 696c 6c20 6f76 6572  append will over
+0001f0a0: 7269 6465 2074 6865 206d 6574 686f 642c  ride the method,
+0001f0b0: 0a20 2020 2020 2020 2020 2020 2023 2077  .            # w
+0001f0c0: 7261 7020 6279 2070 642e 5365 7269 6573  rap by pd.Series
+0001f0d0: 2e61 7070 656e 6420 646f 6373 7472 696e  .append docstrin
+0001f0e0: 670a 2020 2020 2020 2020 2020 2020 6672  g.            fr
+0001f0f0: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+0001f100: 652e 6d75 6c74 6920 696d 706f 7274 2063  e.multi import c
+0001f110: 6f6e 6361 740a 0a20 2020 2020 2020 2020  oncat..         
+0001f120: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0001f130: 286f 7468 6572 2c20 286c 6973 742c 2064  (other, (list, d
+0001f140: 6963 7429 293a 0a20 2020 2020 2020 2020  ict)):.         
+0001f150: 2020 2020 2020 206d 7367 203d 2022 6170         msg = "ap
+0001f160: 7065 6e64 2064 6f65 736e 2774 2073 7570  pend doesn't sup
+0001f170: 706f 7274 206c 6973 7420 6f72 2064 6963  port list or dic
+0001f180: 7420 696e 7075 7422 0a20 2020 2020 2020  t input".       
+0001f190: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+0001f1a0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0001f1b0: 6f72 286d 7367 290a 0a20 2020 2020 2020  or(msg)..       
+0001f1c0: 2020 2020 2072 6574 7572 6e20 636f 6e63       return conc
+0001f1d0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+0001f1e0: 2020 2020 5b73 656c 662c 206f 7468 6572      [self, other
+0001f1f0: 5d2c 206a 6f69 6e3d 226f 7574 6572 222c  ], join="outer",
+0001f200: 2069 6e74 6572 6c65 6176 655f 7061 7274   interleave_part
+0001f210: 6974 696f 6e73 3d69 6e74 6572 6c65 6176  itions=interleav
+0001f220: 655f 7061 7274 6974 696f 6e73 0a20 2020  e_partitions.   
+0001f230: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0001f240: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0001f250: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+0001f260: 2064 6f74 2873 656c 662c 206f 7468 6572   dot(self, other
+0001f270: 2c20 6d65 7461 3d6e 6f5f 6465 6661 756c  , meta=no_defaul
+0001f280: 7429 3a0a 2020 2020 2020 2020 6966 206e  t):.        if n
+0001f290: 6f74 2069 7369 6e73 7461 6e63 6528 6f74  ot isinstance(ot
+0001f2a0: 6865 722c 205f 4672 616d 6529 3a0a 2020  her, _Frame):.  
+0001f2b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001f2c0: 5479 7065 4572 726f 7228 2254 6865 2073  TypeError("The s
+0001f2d0: 6563 6f6e 6420 6f70 6572 616e 6420 6d75  econd operand mu
+0001f2e0: 7374 2062 6520 6120 6461 736b 2061 7272  st be a dask arr
+0001f2f0: 6179 206f 7220 6461 736b 2064 6174 6166  ay or dask dataf
+0001f300: 7261 6d65 2229 0a0a 2020 2020 2020 2020  rame")..        
+0001f310: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
+0001f320: 6865 722c 2044 6174 6146 7261 6d65 293a  her, DataFrame):
+0001f330: 0a20 2020 2020 2020 2020 2020 2073 203d  .            s =
+0001f340: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+0001f350: 696f 6e73 284d 2e64 6f74 2c20 6f74 6865  ions(M.dot, othe
+0001f360: 722c 2074 6f6b 656e 3d22 646f 7422 2c20  r, token="dot", 
+0001f370: 6d65 7461 3d6d 6574 6129 0a20 2020 2020  meta=meta).     
+0001f380: 2020 2020 2020 2072 6574 7572 6e20 732e         return s.
+0001f390: 6772 6f75 7062 7928 6279 3d73 2e69 6e64  groupby(by=s.ind
+0001f3a0: 6578 292e 6170 706c 7928 0a20 2020 2020  ex).apply(.     
+0001f3b0: 2020 2020 2020 2020 2020 206c 616d 6264             lambd
+0001f3c0: 6120 783a 2078 2e73 756d 2873 6b69 706e  a x: x.sum(skipn
+0001f3d0: 613d 4661 6c73 6529 2c20 6d65 7461 3d73  a=False), meta=s
+0001f3e0: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 790a  ._meta_nonempty.
+0001f3f0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0001f400: 2020 2020 2020 2064 6566 205f 646f 745f         def _dot_
+0001f410: 7365 7269 6573 282a 6172 6773 2c20 2a2a  series(*args, **
+0001f420: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+0001f430: 2020 2020 2023 202e 7375 6d28 2920 6973       # .sum() is
+0001f440: 2069 6e76 6f6b 6564 206f 6e20 6561 6368   invoked on each
+0001f450: 2070 6172 7469 7469 6f6e 2062 6566 6f72   partition befor
+0001f460: 6520 6265 696e 6720 6170 706c 6965 6420  e being applied 
+0001f470: 746f 2061 6c6c 0a20 2020 2020 2020 2020  to all.         
+0001f480: 2020 2023 2070 6172 7469 7469 6f6e 732e     # partitions.
+0001f490: 2054 6865 2072 6574 7572 6e20 7479 7065   The return type
+0001f4a0: 2069 7320 6578 7065 6374 6564 2074 6f20   is expected to 
+0001f4b0: 6265 2061 2073 6572 6965 732c 206e 6f74  be a series, not
+0001f4c0: 2061 206e 756d 7079 206f 626a 6563 740a   a numpy object.
+0001f4d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001f4e0: 726e 206d 6574 615f 7365 7269 6573 5f63  rn meta_series_c
+0001f4f0: 6f6e 7374 7275 6374 6f72 2873 656c 6629  onstructor(self)
+0001f500: 284d 2e64 6f74 282a 6172 6773 2c20 2a2a  (M.dot(*args, **
+0001f510: 6b77 6172 6773 2929 0a0a 2020 2020 2020  kwargs))..      
+0001f520: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
+0001f530: 705f 7061 7274 6974 696f 6e73 285f 646f  p_partitions(_do
+0001f540: 745f 7365 7269 6573 2c20 6f74 6865 722c  t_series, other,
+0001f550: 2074 6f6b 656e 3d22 646f 7422 2c20 6d65   token="dot", me
+0001f560: 7461 3d6d 6574 6129 2e73 756d 280a 2020  ta=meta).sum(.  
+0001f570: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
+0001f580: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
+0001f590: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+0001f5a0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+0001f5b0: 290a 2020 2020 6465 6620 616c 6967 6e28  ).    def align(
+0001f5c0: 7365 6c66 2c20 6f74 6865 722c 206a 6f69  self, other, joi
+0001f5d0: 6e3d 226f 7574 6572 222c 2061 7869 733d  n="outer", axis=
+0001f5e0: 4e6f 6e65 2c20 6669 6c6c 5f76 616c 7565  None, fill_value
+0001f5f0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+0001f600: 6d65 7461 312c 206d 6574 6132 203d 205f  meta1, meta2 = _
+0001f610: 656d 756c 6174 6528 0a20 2020 2020 2020  emulate(.       
+0001f620: 2020 2020 204d 2e61 6c69 676e 2c20 7365       M.align, se
+0001f630: 6c66 2c20 6f74 6865 722c 206a 6f69 6e2c  lf, other, join,
+0001f640: 2061 7869 733d 6178 6973 2c20 6669 6c6c   axis=axis, fill
+0001f650: 5f76 616c 7565 3d66 696c 6c5f 7661 6c75  _value=fill_valu
+0001f660: 650a 2020 2020 2020 2020 290a 2020 2020  e.        ).    
+0001f670: 2020 2020 616c 6967 6e65 6420 3d20 7365      aligned = se
+0001f680: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+0001f690: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
+0001f6a0: 2e61 6c69 676e 2c0a 2020 2020 2020 2020  .align,.        
+0001f6b0: 2020 2020 6f74 6865 722c 0a20 2020 2020      other,.     
+0001f6c0: 2020 2020 2020 206a 6f69 6e3d 6a6f 696e         join=join
+0001f6d0: 2c0a 2020 2020 2020 2020 2020 2020 6178  ,.            ax
+0001f6e0: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+0001f6f0: 2020 2020 2066 696c 6c5f 7661 6c75 653d       fill_value=
+0001f700: 6669 6c6c 5f76 616c 7565 2c0a 2020 2020  fill_value,.    
+0001f710: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
+0001f720: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
+0001f730: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0001f740: 2020 2074 6f6b 656e 203d 2074 6f6b 656e     token = token
+0001f750: 697a 6528 7365 6c66 2c20 6f74 6865 722c  ize(self, other,
+0001f760: 206a 6f69 6e2c 2061 7869 732c 2066 696c   join, axis, fil
+0001f770: 6c5f 7661 6c75 6529 0a0a 2020 2020 2020  l_value)..      
+0001f780: 2020 6e61 6d65 3120 3d20 2261 6c69 676e    name1 = "align
+0001f790: 312d 2220 2b20 746f 6b65 6e0a 2020 2020  1-" + token.    
+0001f7a0: 2020 2020 6473 6b31 203d 207b 0a20 2020      dsk1 = {.   
+0001f7b0: 2020 2020 2020 2020 2028 6e61 6d65 312c           (name1,
+0001f7c0: 2069 293a 2028 6765 7469 7465 6d2c 206b   i): (getitem, k
+0001f7d0: 6579 2c20 3029 0a20 2020 2020 2020 2020  ey, 0).         
+0001f7e0: 2020 2066 6f72 2069 2c20 6b65 7920 696e     for i, key in
+0001f7f0: 2065 6e75 6d65 7261 7465 2861 6c69 676e   enumerate(align
+0001f800: 6564 2e5f 5f64 6173 6b5f 6b65 7973 5f5f  ed.__dask_keys__
+0001f810: 2829 290a 2020 2020 2020 2020 7d0a 2020  ()).        }.  
+0001f820: 2020 2020 2020 6473 6b31 2e75 7064 6174        dsk1.updat
+0001f830: 6528 616c 6967 6e65 642e 6461 736b 290a  e(aligned.dask).
+0001f840: 2020 2020 2020 2020 7265 7375 6c74 3120          result1 
+0001f850: 3d20 6e65 775f 6464 5f6f 626a 6563 7428  = new_dd_object(
+0001f860: 6473 6b31 2c20 6e61 6d65 312c 206d 6574  dsk1, name1, met
+0001f870: 6131 2c20 616c 6967 6e65 642e 6469 7669  a1, aligned.divi
+0001f880: 7369 6f6e 7329 0a0a 2020 2020 2020 2020  sions)..        
+0001f890: 6e61 6d65 3220 3d20 2261 6c69 676e 322d  name2 = "align2-
+0001f8a0: 2220 2b20 746f 6b65 6e0a 2020 2020 2020  " + token.      
+0001f8b0: 2020 6473 6b32 203d 207b 0a20 2020 2020    dsk2 = {.     
+0001f8c0: 2020 2020 2020 2028 6e61 6d65 322c 2069         (name2, i
+0001f8d0: 293a 2028 6765 7469 7465 6d2c 206b 6579  ): (getitem, key
+0001f8e0: 2c20 3129 0a20 2020 2020 2020 2020 2020  , 1).           
+0001f8f0: 2066 6f72 2069 2c20 6b65 7920 696e 2065   for i, key in e
+0001f900: 6e75 6d65 7261 7465 2861 6c69 676e 6564  numerate(aligned
+0001f910: 2e5f 5f64 6173 6b5f 6b65 7973 5f5f 2829  .__dask_keys__()
+0001f920: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
+0001f930: 2020 2020 6473 6b32 2e75 7064 6174 6528      dsk2.update(
+0001f940: 616c 6967 6e65 642e 6461 736b 290a 2020  aligned.dask).  
+0001f950: 2020 2020 2020 7265 7375 6c74 3220 3d20        result2 = 
+0001f960: 6e65 775f 6464 5f6f 626a 6563 7428 6473  new_dd_object(ds
+0001f970: 6b32 2c20 6e61 6d65 322c 206d 6574 6132  k2, name2, meta2
+0001f980: 2c20 616c 6967 6e65 642e 6469 7669 7369  , aligned.divisi
+0001f990: 6f6e 7329 0a0a 2020 2020 2020 2020 7265  ons)..        re
+0001f9a0: 7475 726e 2072 6573 756c 7431 2c20 7265  turn result1, re
+0001f9b0: 7375 6c74 320a 0a20 2020 2040 6465 7269  sult2..    @deri
+0001f9c0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0001f9d0: 4672 616d 6529 0a20 2020 2064 6566 2063  Frame).    def c
+0001f9e0: 6f6d 6269 6e65 2873 656c 662c 206f 7468  ombine(self, oth
+0001f9f0: 6572 2c20 6675 6e63 2c20 6669 6c6c 5f76  er, func, fill_v
+0001fa00: 616c 7565 3d4e 6f6e 652c 206f 7665 7277  alue=None, overw
+0001fa10: 7269 7465 3d54 7275 6529 3a0a 2020 2020  rite=True):.    
+0001fa20: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001fa30: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+0001fa40: 2020 2020 2020 2020 2020 2020 4d2e 636f              M.co
+0001fa50: 6d62 696e 652c 206f 7468 6572 2c20 6675  mbine, other, fu
+0001fa60: 6e63 2c20 6669 6c6c 5f76 616c 7565 3d66  nc, fill_value=f
+0001fa70: 696c 6c5f 7661 6c75 652c 206f 7665 7277  ill_value, overw
+0001fa80: 7269 7465 3d6f 7665 7277 7269 7465 0a20  rite=overwrite. 
+0001fa90: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+0001faa0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0001fab0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0001fac0: 6620 636f 6d62 696e 655f 6669 7273 7428  f combine_first(
+0001fad0: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
+0001fae0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001faf0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+0001fb00: 284d 2e63 6f6d 6269 6e65 5f66 6972 7374  (M.combine_first
+0001fb10: 2c20 6f74 6865 7229 0a0a 2020 2020 4063  , other)..    @c
+0001fb20: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
+0001fb30: 6566 205f 6269 6e64 5f6f 7065 7261 746f  ef _bind_operato
+0001fb40: 725f 6d65 7468 6f64 2863 6c73 2c20 6e61  r_method(cls, na
+0001fb50: 6d65 2c20 6f70 2c20 6f72 6967 696e 616c  me, op, original
+0001fb60: 3d70 642e 4461 7461 4672 616d 6529 3a0a  =pd.DataFrame):.
+0001fb70: 2020 2020 2020 2020 2222 2262 696e 6420          """bind 
+0001fb80: 6f70 6572 6174 6f72 206d 6574 686f 6420  operator method 
+0001fb90: 6c69 6b65 2044 6174 6146 7261 6d65 2e61  like DataFrame.a
+0001fba0: 6464 2074 6f20 7468 6973 2063 6c61 7373  dd to this class
+0001fbb0: 2222 220a 2020 2020 2020 2020 7261 6973  """.        rais
+0001fbc0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+0001fbd0: 4572 726f 720a 0a20 2020 2040 6465 7269  Error..    @deri
+0001fbe0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0001fbf0: 4672 616d 6529 0a20 2020 2064 6566 2072  Frame).    def r
+0001fc00: 6573 616d 706c 6528 7365 6c66 2c20 7275  esample(self, ru
+0001fc10: 6c65 2c20 636c 6f73 6564 3d4e 6f6e 652c  le, closed=None,
+0001fc20: 206c 6162 656c 3d4e 6f6e 6529 3a0a 2020   label=None):.  
+0001fc30: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+0001fc40: 6461 7461 6672 616d 652e 7473 6572 6965  dataframe.tserie
+0001fc50: 732e 7265 7361 6d70 6c65 2069 6d70 6f72  s.resample impor
+0001fc60: 7420 5265 7361 6d70 6c65 720a 0a20 2020  t Resampler..   
+0001fc70: 2020 2020 2072 6574 7572 6e20 5265 7361       return Resa
+0001fc80: 6d70 6c65 7228 7365 6c66 2c20 7275 6c65  mpler(self, rule
+0001fc90: 2c20 636c 6f73 6564 3d63 6c6f 7365 642c  , closed=closed,
+0001fca0: 206c 6162 656c 3d6c 6162 656c 290a 0a20   label=label).. 
+0001fcb0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0001fcc0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0001fcd0: 2020 2064 6566 2066 6972 7374 2873 656c     def first(sel
+0001fce0: 662c 206f 6666 7365 7429 3a0a 2020 2020  f, offset):.    
+0001fcf0: 2020 2020 2320 4c65 7420 7061 6e64 6173      # Let pandas
+0001fd00: 2065 7272 6f72 206f 6e20 6261 6420 6172   error on bad ar
+0001fd10: 6773 0a20 2020 2020 2020 2073 656c 662e  gs.        self.
+0001fd20: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e66  _meta_nonempty.f
+0001fd30: 6972 7374 286f 6666 7365 7429 0a0a 2020  irst(offset)..  
+0001fd40: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+0001fd50: 662e 6b6e 6f77 6e5f 6469 7669 7369 6f6e  f.known_division
+0001fd60: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+0001fd70: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0001fd80: 2260 6669 7273 7460 2069 7320 6e6f 7420  "`first` is not 
+0001fd90: 696d 706c 656d 656e 7465 6420 666f 7220  implemented for 
+0001fda0: 756e 6b6e 6f77 6e20 6469 7669 7369 6f6e  unknown division
+0001fdb0: 7322 290a 0a20 2020 2020 2020 206f 6666  s")..        off
+0001fdc0: 7365 7420 3d20 7064 2e74 7365 7269 6573  set = pd.tseries
+0001fdd0: 2e66 7265 7175 656e 6369 6573 2e74 6f5f  .frequencies.to_
+0001fde0: 6f66 6673 6574 286f 6666 7365 7429 0a20  offset(offset). 
+0001fdf0: 2020 2020 2020 2064 6174 6520 3d20 7365         date = se
+0001fe00: 6c66 2e64 6976 6973 696f 6e73 5b30 5d20  lf.divisions[0] 
+0001fe10: 2b20 6f66 6673 6574 0a20 2020 2020 2020  + offset.       
+0001fe20: 2065 6e64 203d 2073 656c 662e 6c6f 632e   end = self.loc.
+0001fe30: 5f67 6574 5f70 6172 7469 7469 6f6e 7328  _get_partitions(
+0001fe40: 6461 7465 290a 0a20 2020 2020 2020 2069  date)..        i
+0001fe50: 735f 616e 6368 6f72 6564 203d 206f 6666  s_anchored = off
+0001fe60: 7365 742e 6973 5f61 6e63 686f 7265 6428  set.is_anchored(
+0001fe70: 290a 0a20 2020 2020 2020 2069 6e63 6c75  )..        inclu
+0001fe80: 6465 5f72 6967 6874 203d 2069 735f 616e  de_right = is_an
+0001fe90: 6368 6f72 6564 206f 7220 6e6f 7420 6861  chored or not ha
+0001fea0: 7361 7474 7228 6f66 6673 6574 2c20 2264  sattr(offset, "d
+0001feb0: 656c 7461 2229 0a0a 2020 2020 2020 2020  elta")..        
+0001fec0: 6966 2065 6e64 203d 3d20 7365 6c66 2e6e  if end == self.n
+0001fed0: 7061 7274 6974 696f 6e73 202d 2031 3a0a  partitions - 1:.
+0001fee0: 2020 2020 2020 2020 2020 2020 6469 7673              divs
+0001fef0: 203d 2073 656c 662e 6469 7669 7369 6f6e   = self.division
+0001ff00: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
+0001ff10: 2020 2020 2020 2020 2020 2020 6469 7673              divs
+0001ff20: 203d 2073 656c 662e 6469 7669 7369 6f6e   = self.division
+0001ff30: 735b 3a20 656e 6420 2b20 315d 202b 2028  s[: end + 1] + (
+0001ff40: 6461 7465 2c29 0a0a 2020 2020 2020 2020  date,)..        
+0001ff50: 6e61 6d65 203d 2022 6669 7273 742d 2220  name = "first-" 
+0001ff60: 2b20 746f 6b65 6e69 7a65 2873 656c 662c  + tokenize(self,
+0001ff70: 206f 6666 7365 7429 0a20 2020 2020 2020   offset).       
+0001ff80: 2064 736b 203d 207b 286e 616d 652c 2069   dsk = {(name, i
+0001ff90: 293a 2028 7365 6c66 2e5f 6e61 6d65 2c20  ): (self._name, 
+0001ffa0: 6929 2066 6f72 2069 2069 6e20 7261 6e67  i) for i in rang
+0001ffb0: 6528 656e 6429 7d0a 2020 2020 2020 2020  e(end)}.        
+0001ffc0: 6473 6b5b 286e 616d 652c 2065 6e64 295d  dsk[(name, end)]
+0001ffd0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+0001ffe0: 206d 6574 686f 6473 2e62 6f75 6e64 6172   methods.boundar
+0001fff0: 795f 736c 6963 652c 0a20 2020 2020 2020  y_slice,.       
+00020000: 2020 2020 2028 7365 6c66 2e5f 6e61 6d65       (self._name
+00020010: 2c20 656e 6429 2c0a 2020 2020 2020 2020  , end),.        
+00020020: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
+00020030: 2020 2020 2020 6461 7465 2c0a 2020 2020        date,.    
+00020040: 2020 2020 2020 2020 696e 636c 7564 655f          include_
+00020050: 7269 6768 742c 0a20 2020 2020 2020 2020  right,.         
+00020060: 2020 2054 7275 652c 0a20 2020 2020 2020     True,.       
+00020070: 2029 0a20 2020 2020 2020 2067 7261 7068   ).        graph
+00020080: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+00020090: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+000200a0: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
+000200b0: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
+000200c0: 5d29 0a20 2020 2020 2020 2072 6574 7572  ]).        retur
+000200d0: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
+000200e0: 6772 6170 682c 206e 616d 652c 2073 656c  graph, name, sel
+000200f0: 662c 2064 6976 7329 0a0a 2020 2020 4064  f, divs)..    @d
+00020100: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00020110: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+00020120: 6620 6c61 7374 2873 656c 662c 206f 6666  f last(self, off
+00020130: 7365 7429 3a0a 2020 2020 2020 2020 2320  set):.        # 
+00020140: 4c65 7420 7061 6e64 6173 2065 7272 6f72  Let pandas error
+00020150: 206f 6e20 6261 6420 6172 6773 0a20 2020   on bad args.   
+00020160: 2020 2020 2073 656c 662e 5f6d 6574 615f       self._meta_
+00020170: 6e6f 6e65 6d70 7479 2e66 6972 7374 286f  nonempty.first(o
+00020180: 6666 7365 7429 0a0a 2020 2020 2020 2020  ffset)..        
+00020190: 6966 206e 6f74 2073 656c 662e 6b6e 6f77  if not self.know
+000201a0: 6e5f 6469 7669 7369 6f6e 733a 0a20 2020  n_divisions:.   
+000201b0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000201c0: 616c 7565 4572 726f 7228 2260 6c61 7374  alueError("`last
+000201d0: 6020 6973 206e 6f74 2069 6d70 6c65 6d65  ` is not impleme
+000201e0: 6e74 6564 2066 6f72 2075 6e6b 6e6f 776e  nted for unknown
+000201f0: 2064 6976 6973 696f 6e73 2229 0a0a 2020   divisions")..  
+00020200: 2020 2020 2020 6f66 6673 6574 203d 2070        offset = p
+00020210: 642e 7473 6572 6965 732e 6672 6571 7565  d.tseries.freque
+00020220: 6e63 6965 732e 746f 5f6f 6666 7365 7428  ncies.to_offset(
+00020230: 6f66 6673 6574 290a 2020 2020 2020 2020  offset).        
+00020240: 6461 7465 203d 2073 656c 662e 6469 7669  date = self.divi
+00020250: 7369 6f6e 735b 2d31 5d20 2d20 6f66 6673  sions[-1] - offs
+00020260: 6574 0a20 2020 2020 2020 2073 7461 7274  et.        start
+00020270: 203d 2073 656c 662e 6c6f 632e 5f67 6574   = self.loc._get
+00020280: 5f70 6172 7469 7469 6f6e 7328 6461 7465  _partitions(date
+00020290: 290a 0a20 2020 2020 2020 2069 6620 7374  )..        if st
+000202a0: 6172 7420 3d3d 2030 3a0a 2020 2020 2020  art == 0:.      
+000202b0: 2020 2020 2020 6469 7673 203d 2073 656c        divs = sel
+000202c0: 662e 6469 7669 7369 6f6e 730a 2020 2020  f.divisions.    
+000202d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000202e0: 2020 2020 2020 6469 7673 203d 2028 6461        divs = (da
+000202f0: 7465 2c29 202b 2073 656c 662e 6469 7669  te,) + self.divi
+00020300: 7369 6f6e 735b 7374 6172 7420 2b20 3120  sions[start + 1 
+00020310: 3a5d 0a0a 2020 2020 2020 2020 6e61 6d65  :]..        name
+00020320: 203d 2022 6c61 7374 2d22 202b 2074 6f6b   = "last-" + tok
+00020330: 656e 697a 6528 7365 6c66 2c20 6f66 6673  enize(self, offs
+00020340: 6574 290a 2020 2020 2020 2020 6473 6b20  et).        dsk 
+00020350: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00020360: 286e 616d 652c 2069 202b 2031 293a 2028  (name, i + 1): (
+00020370: 7365 6c66 2e5f 6e61 6d65 2c20 6a20 2b20  self._name, j + 
+00020380: 3129 0a20 2020 2020 2020 2020 2020 2066  1).            f
+00020390: 6f72 2069 2c20 6a20 696e 2065 6e75 6d65  or i, j in enume
+000203a0: 7261 7465 2872 616e 6765 2873 7461 7274  rate(range(start
+000203b0: 2c20 7365 6c66 2e6e 7061 7274 6974 696f  , self.npartitio
+000203c0: 6e73 2929 0a20 2020 2020 2020 207d 0a20  ns)).        }. 
+000203d0: 2020 2020 2020 2064 736b 5b28 6e61 6d65         dsk[(name
+000203e0: 2c20 3029 5d20 3d20 280a 2020 2020 2020  , 0)] = (.      
+000203f0: 2020 2020 2020 6d65 7468 6f64 732e 626f        methods.bo
+00020400: 756e 6461 7279 5f73 6c69 6365 2c0a 2020  undary_slice,.  
+00020410: 2020 2020 2020 2020 2020 2873 656c 662e            (self.
+00020420: 5f6e 616d 652c 2073 7461 7274 292c 0a20  _name, start),. 
+00020430: 2020 2020 2020 2020 2020 2064 6174 652c             date,
+00020440: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
+00020450: 652c 0a20 2020 2020 2020 2020 2020 2054  e,.            T
+00020460: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+00020470: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+00020480: 290a 2020 2020 2020 2020 6772 6170 6820  ).        graph 
+00020490: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
+000204a0: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
+000204b0: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
+000204c0: 656e 6465 6e63 6965 733d 5b73 656c 665d  endencies=[self]
+000204d0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000204e0: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
+000204f0: 7261 7068 2c20 6e61 6d65 2c20 7365 6c66  raph, name, self
+00020500: 2c20 6469 7673 290a 0a20 2020 2064 6566  , divs)..    def
+00020510: 206e 756e 6971 7565 5f61 7070 726f 7828   nunique_approx(
+00020520: 7365 6c66 2c20 7370 6c69 745f 6576 6572  self, split_ever
+00020530: 793d 4e6f 6e65 293a 0a20 2020 2020 2020  y=None):.       
+00020540: 2022 2222 4170 7072 6f78 696d 6174 6520   """Approximate 
+00020550: 6e75 6d62 6572 206f 6620 756e 6971 7565  number of unique
+00020560: 2072 6f77 732e 0a0a 2020 2020 2020 2020   rows...        
+00020570: 5468 6973 206d 6574 686f 6420 7573 6573  This method uses
+00020580: 2074 6865 2048 7970 6572 4c6f 674c 6f67   the HyperLogLog
+00020590: 2061 6c67 6f72 6974 686d 2066 6f72 2063   algorithm for c
+000205a0: 6172 6469 6e61 6c69 7479 0a20 2020 2020  ardinality.     
+000205b0: 2020 2065 7374 696d 6174 696f 6e20 746f     estimation to
+000205c0: 2063 6f6d 7075 7465 2074 6865 2061 7070   compute the app
+000205d0: 726f 7869 6d61 7465 206e 756d 6265 7220  roximate number 
+000205e0: 6f66 2075 6e69 7175 6520 726f 7773 2e0a  of unique rows..
+000205f0: 2020 2020 2020 2020 5468 6520 6170 7072          The appr
+00020600: 6f78 696d 6174 6520 6572 726f 7220 6973  oximate error is
+00020610: 2030 2e34 3036 252e 0a0a 2020 2020 2020   0.406%...      
+00020620: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00020630: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00020640: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+00020650: 6572 7920 3a20 696e 742c 206f 7074 696f  ery : int, optio
+00020660: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00020670: 4772 6f75 7020 7061 7274 6974 696f 6e73  Group partitions
+00020680: 2069 6e74 6f20 6772 6f75 7073 206f 6620   into groups of 
+00020690: 7468 6973 2073 697a 6520 7768 696c 6520  this size while 
+000206a0: 7065 7266 6f72 6d69 6e67 2061 0a20 2020  performing a.   
+000206b0: 2020 2020 2020 2020 2074 7265 652d 7265           tree-re
+000206c0: 6475 6374 696f 6e2e 2049 6620 7365 7420  duction. If set 
+000206d0: 746f 2046 616c 7365 2c20 6e6f 2074 7265  to False, no tre
+000206e0: 652d 7265 6475 6374 696f 6e20 7769 6c6c  e-reduction will
+000206f0: 2062 6520 7573 6564 2e0a 2020 2020 2020   be used..      
+00020700: 2020 2020 2020 4465 6661 756c 7420 6973        Default is
+00020710: 2038 2e0a 0a20 2020 2020 2020 2052 6574   8...        Ret
+00020720: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+00020730: 2d2d 2d2d 0a20 2020 2020 2020 2061 2066  ----.        a f
+00020740: 6c6f 6174 2072 6570 7265 7365 6e74 696e  loat representin
+00020750: 6720 7468 6520 6170 7072 6f78 696d 6174  g the approximat
+00020760: 6520 6e75 6d62 6572 206f 6620 656c 656d  e number of elem
+00020770: 656e 7473 0a20 2020 2020 2020 2022 2222  ents.        """
+00020780: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+00020790: 736b 2e64 6174 6166 7261 6d65 2069 6d70  sk.dataframe imp
+000207a0: 6f72 7420 6879 7065 726c 6f67 6c6f 6720  ort hyperloglog 
+000207b0: 2023 2068 6572 6520 746f 2061 766f 6964   # here to avoid
+000207c0: 2063 6972 6375 6c61 7220 696d 706f 7274   circular import
+000207d0: 2069 7373 7565 730a 0a20 2020 2020 2020   issues..       
+000207e0: 2072 6574 7572 6e20 6163 6128 0a20 2020   return aca(.   
+000207f0: 2020 2020 2020 2020 205b 7365 6c66 5d2c           [self],
+00020800: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
+00020810: 6e6b 3d68 7970 6572 6c6f 676c 6f67 2e63  nk=hyperloglog.c
+00020820: 6f6d 7075 7465 5f68 6c6c 5f61 7272 6179  ompute_hll_array
+00020830: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+00020840: 6d62 696e 653d 6879 7065 726c 6f67 6c6f  mbine=hyperloglo
+00020850: 672e 7265 6475 6365 5f73 7461 7465 2c0a  g.reduce_state,.
+00020860: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
+00020870: 6567 6174 653d 6879 7065 726c 6f67 6c6f  egate=hyperloglo
+00020880: 672e 6573 7469 6d61 7465 5f63 6f75 6e74  g.estimate_count
+00020890: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+000208a0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+000208b0: 6576 6572 792c 0a20 2020 2020 2020 2020  every,.         
+000208c0: 2020 2062 3d31 362c 0a20 2020 2020 2020     b=16,.       
+000208d0: 2020 2020 206d 6574 613d 666c 6f61 742c       meta=float,
+000208e0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000208f0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00020900: 6620 7661 6c75 6573 2873 656c 6629 3a0a  f values(self):.
+00020910: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00020920: 6e20 6120 6461 736b 2e61 7272 6179 206f  n a dask.array o
+00020930: 6620 7468 6520 7661 6c75 6573 206f 6620  f the values of 
+00020940: 7468 6973 2064 6174 6166 7261 6d65 0a0a  this dataframe..
+00020950: 2020 2020 2020 2020 5761 726e 696e 673a          Warning:
+00020960: 2054 6869 7320 6372 6561 7465 7320 6120   This creates a 
+00020970: 6461 736b 2e61 7272 6179 2077 6974 686f  dask.array witho
+00020980: 7574 2070 7265 6369 7365 2073 6861 7065  ut precise shape
+00020990: 2069 6e66 6f72 6d61 7469 6f6e 2e0a 2020   information..  
+000209a0: 2020 2020 2020 4f70 6572 6174 696f 6e73        Operations
+000209b0: 2074 6861 7420 6465 7065 6e64 206f 6e20   that depend on 
+000209c0: 7368 6170 6520 696e 666f 726d 6174 696f  shape informatio
+000209d0: 6e2c 206c 696b 6520 736c 6963 696e 6720  n, like slicing 
+000209e0: 6f72 2072 6573 6861 7069 6e67 2c0a 2020  or reshaping,.  
+000209f0: 2020 2020 2020 7769 6c6c 206e 6f74 2077        will not w
+00020a00: 6f72 6b2e 0a20 2020 2020 2020 2022 2222  ork..        """
+00020a10: 0a20 2020 2020 2020 2069 6620 6973 5f65  .        if is_e
+00020a20: 7874 656e 7369 6f6e 5f61 7272 6179 5f64  xtension_array_d
+00020a30: 7479 7065 2873 656c 662e 5f6d 6574 612e  type(self._meta.
+00020a40: 7661 6c75 6573 293a 0a20 2020 2020 2020  values):.       
+00020a50: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00020a60: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+00020a70: 2020 2020 2244 6173 6b20 6375 7272 656e      "Dask curren
+00020a80: 746c 7920 6861 7320 6c69 6d69 7465 6420  tly has limited 
+00020a90: 7375 7070 6f72 7420 666f 7220 636f 6e76  support for conv
+00020aa0: 6572 7469 6e67 2070 616e 6461 7320 6578  erting pandas ex
+00020ab0: 7465 6e73 696f 6e20 6474 7970 6573 2022  tension dtypes "
+00020ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020ad0: 2066 2274 6f20 6172 7261 7973 2e20 436f   f"to arrays. Co
+00020ae0: 6e76 6572 7469 6e67 207b 7365 6c66 2e5f  nverting {self._
+00020af0: 6d65 7461 2e76 616c 7565 732e 6474 7970  meta.values.dtyp
+00020b00: 657d 2074 6f20 6f62 6a65 6374 2064 7479  e} to object dty
+00020b10: 7065 2e22 2c0a 2020 2020 2020 2020 2020  pe.",.          
+00020b20: 2020 2020 2020 5573 6572 5761 726e 696e        UserWarnin
+00020b30: 672c 0a20 2020 2020 2020 2020 2020 2029  g,.            )
+00020b40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00020b50: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
+00020b60: 6f6e 7328 6d65 7468 6f64 732e 7661 6c75  ons(methods.valu
+00020b70: 6573 290a 0a20 2020 2064 6566 205f 7661  es)..    def _va
+00020b80: 6c69 6461 7465 5f63 6875 6e6b 7328 7365  lidate_chunks(se
+00020b90: 6c66 2c20 6172 722c 206c 656e 6774 6873  lf, arr, lengths
+00020ba0: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
+00020bb0: 6461 736b 2e61 7272 6179 2e63 6f72 6520  dask.array.core 
+00020bc0: 696d 706f 7274 206e 6f72 6d61 6c69 7a65  import normalize
+00020bd0: 5f63 6875 6e6b 730a 0a20 2020 2020 2020  _chunks..       
+00020be0: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
+00020bf0: 656e 6774 6873 2c20 5365 7175 656e 6365  engths, Sequence
+00020c00: 293a 0a20 2020 2020 2020 2020 2020 206c  ):.            l
+00020c10: 656e 6774 6873 203d 2074 7570 6c65 286c  engths = tuple(l
+00020c20: 656e 6774 6873 290a 0a20 2020 2020 2020  engths)..       
+00020c30: 2020 2020 2069 6620 6c65 6e28 6c65 6e67       if len(leng
+00020c40: 7468 7329 2021 3d20 7365 6c66 2e6e 7061  ths) != self.npa
+00020c50: 7274 6974 696f 6e73 3a0a 2020 2020 2020  rtitions:.      
+00020c60: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00020c70: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00020c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020c90: 2254 6865 206e 756d 6265 7220 6f66 2069  "The number of i
+00020ca0: 7465 6d73 2069 6e20 276c 656e 6774 6873  tems in 'lengths
+00020cb0: 2720 646f 6573 206e 6f74 206d 6174 6368  ' does not match
+00020cc0: 2074 6865 206e 756d 6265 7220 6f66 2022   the number of "
+00020cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020ce0: 2020 2020 2066 2270 6172 7469 7469 6f6e       f"partition
+00020cf0: 732e 207b 6c65 6e28 6c65 6e67 7468 7329  s. {len(lengths)
+00020d00: 7d20 213d 207b 7365 6c66 2e6e 7061 7274  } != {self.npart
+00020d10: 6974 696f 6e73 7d22 0a20 2020 2020 2020  itions}".       
+00020d20: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00020d30: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00020d40: 6e64 696d 203d 3d20 313a 0a20 2020 2020  ndim == 1:.     
+00020d50: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+00020d60: 7320 3d20 6e6f 726d 616c 697a 655f 6368  s = normalize_ch
+00020d70: 756e 6b73 2828 6c65 6e67 7468 732c 2929  unks((lengths,))
+00020d80: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00020d90: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00020da0: 2020 2063 6875 6e6b 7320 3d20 6e6f 726d     chunks = norm
+00020db0: 616c 697a 655f 6368 756e 6b73 2828 6c65  alize_chunks((le
+00020dc0: 6e67 7468 732c 2028 6c65 6e28 7365 6c66  ngths, (len(self
+00020dd0: 2e63 6f6c 756d 6e73 292c 2929 290a 0a20  .columns),))).. 
+00020de0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00020df0: 6e20 6368 756e 6b73 0a20 2020 2020 2020  n chunks.       
+00020e00: 2065 6c69 6620 6c65 6e67 7468 7320 6973   elif lengths is
+00020e10: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00020e20: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00020e30: 7565 4572 726f 7228 6622 556e 6578 7065  ueError(f"Unexpe
+00020e40: 6374 6564 2076 616c 7565 2066 6f72 2027  cted value for '
+00020e50: 6c65 6e67 7468 7327 3a20 277b 6c65 6e67  lengths': '{leng
+00020e60: 7468 737d 2722 290a 0a20 2020 2020 2020  ths}'")..       
+00020e70: 2072 6574 7572 6e20 6172 722e 5f63 6875   return arr._chu
+00020e80: 6e6b 730a 0a20 2020 2064 6566 205f 6973  nks..    def _is
+00020e90: 5f69 6e64 6578 5f6c 6576 656c 5f72 6566  _index_level_ref
+00020ea0: 6572 656e 6365 2873 656c 662c 206b 6579  erence(self, key
+00020eb0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00020ec0: 2020 2020 2020 2054 6573 7420 7768 6574         Test whet
+00020ed0: 6865 7220 6120 6b65 7920 6973 2061 6e20  her a key is an 
+00020ee0: 696e 6465 7820 6c65 7665 6c20 7265 6665  index level refe
+00020ef0: 7265 6e63 650a 0a20 2020 2020 2020 2054  rence..        T
+00020f00: 6f20 6265 2063 6f6e 7369 6465 7265 6420  o be considered 
+00020f10: 616e 2069 6e64 6578 206c 6576 656c 2072  an index level r
+00020f20: 6566 6572 656e 6365 2c20 606b 6579 6020  eference, `key` 
+00020f30: 6d75 7374 206d 6174 6368 2074 6865 2069  must match the i
+00020f40: 6e64 6578 206e 616d 650a 2020 2020 2020  ndex name.      
+00020f50: 2020 616e 6420 6d75 7374 204e 4f54 206d    and must NOT m
+00020f60: 6174 6368 2074 6865 206e 616d 6520 6f66  atch the name of
+00020f70: 2061 6e79 2063 6f6c 756d 6e20 2869 6620   any column (if 
+00020f80: 6120 6461 7461 6672 616d 6529 2e0a 2020  a dataframe)..  
+00020f90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00020fa0: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
+00020fb0: 2020 2020 2020 2073 656c 662e 696e 6465         self.inde
+00020fc0: 782e 6e61 6d65 2069 7320 6e6f 7420 4e6f  x.name is not No
+00020fd0: 6e65 0a20 2020 2020 2020 2020 2020 2061  ne.            a
+00020fe0: 6e64 206e 6f74 2069 735f 6461 736b 5f63  nd not is_dask_c
+00020ff0: 6f6c 6c65 6374 696f 6e28 6b65 7929 0a20  ollection(key). 
+00021000: 2020 2020 2020 2020 2020 2061 6e64 2028             and (
+00021010: 6e70 2e69 7373 6361 6c61 7228 6b65 7929  np.isscalar(key)
+00021020: 206f 7220 6973 696e 7374 616e 6365 286b   or isinstance(k
+00021030: 6579 2c20 7475 706c 6529 290a 2020 2020  ey, tuple)).    
+00021040: 2020 2020 2020 2020 616e 6420 6b65 7920          and key 
+00021050: 3d3d 2073 656c 662e 696e 6465 782e 6e61  == self.index.na
+00021060: 6d65 0a20 2020 2020 2020 2020 2020 2061  me.            a
+00021070: 6e64 206b 6579 206e 6f74 2069 6e20 6765  nd key not in ge
+00021080: 7461 7474 7228 7365 6c66 2c20 2263 6f6c  tattr(self, "col
+00021090: 756d 6e73 222c 2028 2929 0a20 2020 2020  umns", ()).     
+000210a0: 2020 2029 0a0a 2020 2020 6465 6620 5f63     )..    def _c
+000210b0: 6f6e 7461 696e 735f 696e 6465 785f 6e61  ontains_index_na
+000210c0: 6d65 2873 656c 662c 2063 6f6c 756d 6e73  me(self, columns
+000210d0: 5f6f 725f 696e 6465 7829 3a0a 2020 2020  _or_index):.    
+000210e0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000210f0: 5465 7374 2077 6865 7468 6572 2074 6865  Test whether the
+00021100: 2069 6e70 7574 2063 6f6e 7461 696e 7320   input contains 
+00021110: 6120 7265 6665 7265 6e63 6520 746f 2074  a reference to t
+00021120: 6865 2069 6e64 6578 206f 6620 7468 6520  he index of the 
+00021130: 4461 7461 4672 616d 652f 5365 7269 6573  DataFrame/Series
+00021140: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00021150: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00021160: 6365 2863 6f6c 756d 6e73 5f6f 725f 696e  ce(columns_or_in
+00021170: 6465 782c 206c 6973 7429 3a0a 2020 2020  dex, list):.    
+00021180: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00021190: 6e79 2873 656c 662e 5f69 735f 696e 6465  ny(self._is_inde
+000211a0: 785f 6c65 7665 6c5f 7265 6665 7265 6e63  x_level_referenc
+000211b0: 6528 6e29 2066 6f72 206e 2069 6e20 636f  e(n) for n in co
+000211c0: 6c75 6d6e 735f 6f72 5f69 6e64 6578 290a  lumns_or_index).
+000211d0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000211e0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000211f0: 2073 656c 662e 5f69 735f 696e 6465 785f   self._is_index_
+00021200: 6c65 7665 6c5f 7265 6665 7265 6e63 6528  level_reference(
+00021210: 636f 6c75 6d6e 735f 6f72 5f69 6e64 6578  columns_or_index
+00021220: 290a 0a0a 6465 6620 5f72 6169 7365 5f69  )...def _raise_i
+00021230: 665f 6f62 6a65 6374 5f73 6572 6965 7328  f_object_series(
+00021240: 782c 2066 756e 636e 616d 6529 3a0a 2020  x, funcname):.  
+00021250: 2020 2222 220a 2020 2020 5574 696c 6974    """.    Utilit
+00021260: 7920 6675 6e63 7469 6f6e 2074 6f20 7261  y function to ra
+00021270: 6973 6520 616e 2065 7272 6f72 2069 6620  ise an error if 
+00021280: 616e 206f 626a 6563 7420 636f 6c75 6d6e  an object column
+00021290: 2064 6f65 7320 6e6f 7420 7375 7070 6f72   does not suppor
+000212a0: 740a 2020 2020 6120 6365 7274 6169 6e20  t.    a certain 
+000212b0: 6f70 6572 6174 696f 6e20 6c69 6b65 2060  operation like `
+000212c0: 6d65 616e 602e 0a20 2020 2022 2222 0a20  mean`..    """. 
+000212d0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+000212e0: 2878 2c20 5365 7269 6573 2920 616e 6420  (x, Series) and 
+000212f0: 6861 7361 7474 7228 782c 2022 6474 7970  hasattr(x, "dtyp
+00021300: 6522 293a 0a20 2020 2020 2020 2069 6620  e"):.        if 
+00021310: 782e 6474 7970 6520 3d3d 206f 626a 6563  x.dtype == objec
+00021320: 743a 0a20 2020 2020 2020 2020 2020 2072  t:.            r
+00021330: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00021340: 2260 2573 6020 6e6f 7420 7375 7070 6f72  "`%s` not suppor
+00021350: 7465 6420 7769 7468 206f 626a 6563 7420  ted with object 
+00021360: 7365 7269 6573 2220 2520 6675 6e63 6e61  series" % funcna
+00021370: 6d65 290a 2020 2020 2020 2020 656c 6966  me).        elif
+00021380: 2069 735f 7374 7269 6e67 5f64 7479 7065   is_string_dtype
+00021390: 2878 293a 0a20 2020 2020 2020 2020 2020  (x):.           
+000213a0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+000213b0: 7228 2260 2573 6020 6e6f 7420 7375 7070  r("`%s` not supp
+000213c0: 6f72 7465 6420 7769 7468 2073 7472 696e  orted with strin
+000213d0: 6720 7365 7269 6573 2220 2520 6675 6e63  g series" % func
+000213e0: 6e61 6d65 290a 0a0a 636c 6173 7320 5365  name)...class Se
+000213f0: 7269 6573 285f 4672 616d 6529 3a0a 2020  ries(_Frame):.  
+00021400: 2020 2222 2250 6172 616c 6c65 6c20 5061    """Parallel Pa
+00021410: 6e64 6173 2053 6572 6965 730a 0a20 2020  ndas Series..   
+00021420: 2044 6f20 6e6f 7420 7573 6520 7468 6973   Do not use this
+00021430: 2063 6c61 7373 2064 6972 6563 746c 792e   class directly.
+00021440: 2020 496e 7374 6561 6420 7573 6520 6675    Instead use fu
+00021450: 6e63 7469 6f6e 7320 6c69 6b65 0a20 2020  nctions like.   
+00021460: 2060 6064 642e 7265 6164 5f63 7376 6060   ``dd.read_csv``
+00021470: 2c20 6060 6464 2e72 6561 645f 7061 7271  , ``dd.read_parq
+00021480: 7565 7460 602c 206f 7220 6060 6464 2e66  uet``, or ``dd.f
+00021490: 726f 6d5f 7061 6e64 6173 6060 2e0a 0a20  rom_pandas``... 
+000214a0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+000214b0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a 2020    ----------..  
+000214c0: 2020 6473 6b3a 2064 6963 740a 2020 2020    dsk: dict.    
+000214d0: 2020 2020 5468 6520 6461 736b 2067 7261      The dask gra
+000214e0: 7068 2074 6f20 636f 6d70 7574 6520 7468  ph to compute th
+000214f0: 6973 2053 6572 6965 730a 2020 2020 5f6e  is Series.    _n
+00021500: 616d 653a 2073 7472 0a20 2020 2020 2020  ame: str.       
+00021510: 2054 6865 206b 6579 2070 7265 6669 7820   The key prefix 
+00021520: 7468 6174 2073 7065 6369 6669 6573 2077  that specifies w
+00021530: 6869 6368 206b 6579 7320 696e 2074 6865  hich keys in the
+00021540: 2064 6173 6b20 636f 6d70 7269 7365 2074   dask comprise t
+00021550: 6869 730a 2020 2020 2020 2020 7061 7274  his.        part
+00021560: 6963 756c 6172 2053 6572 6965 730a 2020  icular Series.  
+00021570: 2020 6d65 7461 3a20 7061 6e64 6173 2e53    meta: pandas.S
+00021580: 6572 6965 730a 2020 2020 2020 2020 416e  eries.        An
+00021590: 2065 6d70 7479 2060 6070 616e 6461 732e   empty ``pandas.
+000215a0: 5365 7269 6573 6060 2077 6974 6820 6e61  Series`` with na
+000215b0: 6d65 732c 2064 7479 7065 732c 2061 6e64  mes, dtypes, and
+000215c0: 2069 6e64 6578 206d 6174 6368 696e 6720   index matching 
+000215d0: 7468 650a 2020 2020 2020 2020 6578 7065  the.        expe
+000215e0: 6374 6564 206f 7574 7075 742e 0a20 2020  cted output..   
+000215f0: 2064 6976 6973 696f 6e73 3a20 7475 706c   divisions: tupl
+00021600: 6520 6f66 2069 6e64 6578 2076 616c 7565  e of index value
+00021610: 730a 2020 2020 2020 2020 5661 6c75 6573  s.        Values
+00021620: 2061 6c6f 6e67 2077 6869 6368 2077 6520   along which we 
+00021630: 7061 7274 6974 696f 6e20 6f75 7220 626c  partition our bl
+00021640: 6f63 6b73 206f 6e20 7468 6520 696e 6465  ocks on the inde
+00021650: 780a 0a20 2020 2053 6565 2041 6c73 6f0a  x..    See Also.
+00021660: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+00021670: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+00021680: 4461 7461 4672 616d 650a 2020 2020 2222  DataFrame.    ""
+00021690: 220a 0a20 2020 205f 7061 7274 6974 696f  "..    _partitio
+000216a0: 6e5f 7479 7065 203d 2070 642e 5365 7269  n_type = pd.Seri
+000216b0: 6573 0a20 2020 205f 6973 5f70 6172 7469  es.    _is_parti
+000216c0: 7469 6f6e 5f74 7970 6520 3d20 7374 6174  tion_type = stat
+000216d0: 6963 6d65 7468 6f64 2869 735f 7365 7269  icmethod(is_seri
+000216e0: 6573 5f6c 696b 6529 0a20 2020 205f 746f  es_like).    _to
+000216f0: 6b65 6e5f 7072 6566 6978 203d 2022 7365  ken_prefix = "se
+00021700: 7269 6573 2d22 0a20 2020 205f 6163 6365  ries-".    _acce
+00021710: 7373 6f72 733a 2043 6c61 7373 5661 725b  ssors: ClassVar[
+00021720: 7365 745b 7374 725d 5d20 3d20 7365 7428  set[str]] = set(
+00021730: 290a 0a20 2020 2064 6566 205f 5f61 7272  )..    def __arr
+00021740: 6179 5f77 7261 705f 5f28 7365 6c66 2c20  ay_wrap__(self, 
+00021750: 6172 7261 792c 2063 6f6e 7465 7874 3d4e  array, context=N
+00021760: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
+00021770: 2069 7369 6e73 7461 6e63 6528 636f 6e74   isinstance(cont
+00021780: 6578 742c 2074 7570 6c65 2920 616e 6420  ext, tuple) and 
+00021790: 6c65 6e28 636f 6e74 6578 7429 203e 2030  len(context) > 0
+000217a0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000217b0: 2069 7369 6e73 7461 6e63 6528 636f 6e74   isinstance(cont
+000217c0: 6578 745b 315d 5b30 5d2c 206e 702e 6e64  ext[1][0], np.nd
+000217d0: 6172 7261 7929 2061 6e64 2063 6f6e 7465  array) and conte
+000217e0: 7874 5b31 5d5b 305d 2e73 6861 7065 203d  xt[1][0].shape =
+000217f0: 3d20 2829 3a0a 2020 2020 2020 2020 2020  = ():.          
+00021800: 2020 2020 2020 696e 6465 7820 3d20 4e6f        index = No
+00021810: 6e65 0a20 2020 2020 2020 2020 2020 2065  ne.            e
+00021820: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00021830: 2020 2020 2069 6e64 6578 203d 2063 6f6e       index = con
+00021840: 7465 7874 5b31 5d5b 305d 2e69 6e64 6578  text[1][0].index
+00021850: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00021860: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+00021870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021880: 696d 706f 7274 2069 6e73 7065 6374 0a0a  import inspect..
+00021890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000218a0: 6d65 7468 6f64 5f6e 616d 6520 3d20 6622  method_name = f"
+000218b0: 607b 696e 7370 6563 742e 7374 6163 6b28  `{inspect.stack(
+000218c0: 295b 335d 5b33 5d7d 6022 0a20 2020 2020  )[3][3]}`".     
+000218d0: 2020 2020 2020 2065 7863 6570 7420 496e         except In
+000218e0: 6465 7845 7272 6f72 3a0a 2020 2020 2020  dexError:.      
+000218f0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00021900: 5f6e 616d 6520 3d20 2254 6869 7320 6d65  _name = "This me
+00021910: 7468 6f64 220a 2020 2020 2020 2020 2020  thod".          
+00021920: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+00021930: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
+00021940: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
+00021950: 6d65 7468 6f64 5f6e 616d 657d 2069 7320  method_name} is 
+00021960: 6e6f 7420 696d 706c 656d 656e 7465 6420  not implemented 
+00021970: 666f 7220 6064 6173 6b2e 6461 7461 6672  for `dask.datafr
+00021980: 616d 652e 5365 7269 6573 602e 220a 2020  ame.Series`.".  
+00021990: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+000219a0: 2020 2020 2072 6574 7572 6e20 6d65 7461       return meta
+000219b0: 5f73 6572 6965 735f 636f 6e73 7472 7563  _series_construc
+000219c0: 746f 7228 7365 6c66 2928 6172 7261 792c  tor(self)(array,
+000219d0: 2069 6e64 6578 3d69 6e64 6578 2c20 6e61   index=index, na
+000219e0: 6d65 3d73 656c 662e 6e61 6d65 290a 0a20  me=self.name).. 
+000219f0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00021a00: 2064 6566 2061 7865 7328 7365 6c66 293a   def axes(self):
+00021a10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00021a20: 5b73 656c 662e 696e 6465 785d 0a0a 2020  [self.index]..  
+00021a30: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00021a40: 6465 6620 6e61 6d65 2873 656c 6629 3a0a  def name(self):.
+00021a50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00021a60: 656c 662e 5f6d 6574 612e 6e61 6d65 0a0a  elf._meta.name..
+00021a70: 2020 2020 406e 616d 652e 7365 7474 6572      @name.setter
+00021a80: 0a20 2020 2064 6566 206e 616d 6528 7365  .    def name(se
+00021a90: 6c66 2c20 6e61 6d65 293a 0a20 2020 2020  lf, name):.     
+00021aa0: 2020 2073 656c 662e 5f6d 6574 612e 6e61     self._meta.na
+00021ab0: 6d65 203d 206e 616d 650a 2020 2020 2020  me = name.      
+00021ac0: 2020 7265 6e61 6d65 6420 3d20 5f72 656e    renamed = _ren
+00021ad0: 616d 655f 6461 736b 2873 656c 662c 206e  ame_dask(self, n
+00021ae0: 616d 6529 0a20 2020 2020 2020 2023 2075  ame).        # u
+00021af0: 7064 6174 6520 6d79 7365 6c66 0a20 2020  pdate myself.   
+00021b00: 2020 2020 2073 656c 662e 6461 736b 203d       self.dask =
+00021b10: 2072 656e 616d 6564 2e64 6173 6b0a 2020   renamed.dask.  
+00021b20: 2020 2020 2020 7365 6c66 2e5f 6e61 6d65        self._name
+00021b30: 203d 2072 656e 616d 6564 2e5f 6e61 6d65   = renamed._name
+00021b40: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00021b50: 2020 2020 6465 6620 6e64 696d 2873 656c      def ndim(sel
+00021b60: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+00021b70: 6574 7572 6e20 6469 6d65 6e73 696f 6e61  eturn dimensiona
+00021b80: 6c69 7479 2222 220a 2020 2020 2020 2020  lity""".        
+00021b90: 7265 7475 726e 2031 0a0a 2020 2020 4070  return 1..    @p
+00021ba0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00021bb0: 7368 6170 6528 7365 6c66 293a 0a20 2020  shape(self):.   
+00021bc0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00021bd0: 2052 6574 7572 6e20 6120 7475 706c 6520   Return a tuple 
+00021be0: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
+00021bf0: 2064 696d 656e 7369 6f6e 616c 6974 7920   dimensionality 
+00021c00: 6f66 2061 2053 6572 6965 732e 0a0a 2020  of a Series...  
+00021c10: 2020 2020 2020 5468 6520 7369 6e67 6c65        The single
+00021c20: 2065 6c65 6d65 6e74 206f 6620 7468 6520   element of the 
+00021c30: 7475 706c 6520 6973 2061 2044 656c 6179  tuple is a Delay
+00021c40: 6564 2072 6573 756c 742e 0a0a 2020 2020  ed result...    
+00021c50: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+00021c60: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00021c70: 2020 2020 2020 3e3e 3e20 7365 7269 6573        >>> series
+00021c80: 2e73 6861 7065 2020 2320 646f 6374 6573  .shape  # doctes
+00021c90: 743a 202b 534b 4950 0a20 2020 2020 2020  t: +SKIP.       
+00021ca0: 2028 6464 2e53 6361 6c61 723c 7369 7a65   (dd.Scalar<size
+00021cb0: 2d61 672e 2e2e 2c20 6474 7970 653d 696e  -ag..., dtype=in
+00021cc0: 7436 343e 2c29 0a20 2020 2020 2020 2022  t64>,).        "
+00021cd0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00021ce0: 6e20 2873 656c 662e 7369 7a65 2c29 0a0a  n (self.size,)..
+00021cf0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00021d00: 2020 6465 6620 6474 7970 6528 7365 6c66    def dtype(self
+00021d10: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+00021d20: 7475 726e 2064 6174 6120 7479 7065 2222  turn data type""
+00021d30: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00021d40: 2073 656c 662e 5f6d 6574 612e 6474 7970   self._meta.dtyp
+00021d50: 650a 0a20 2020 2064 7420 3d20 4361 6368  e..    dt = Cach
+00021d60: 6564 4163 6365 7373 6f72 2822 6474 222c  edAccessor("dt",
+00021d70: 2044 6174 6574 696d 6541 6363 6573 736f   DatetimeAccesso
+00021d80: 7229 0a0a 2020 2020 6361 7420 3d20 4361  r)..    cat = Ca
+00021d90: 6368 6564 4163 6365 7373 6f72 2822 6361  chedAccessor("ca
+00021da0: 7422 2c20 4361 7465 676f 7269 6361 6c41  t", CategoricalA
+00021db0: 6363 6573 736f 7229 0a0a 2020 2020 7374  ccessor)..    st
+00021dc0: 7220 3d20 4361 6368 6564 4163 6365 7373  r = CachedAccess
+00021dd0: 6f72 2822 7374 7222 2c20 5374 7269 6e67  or("str", String
+00021de0: 4163 6365 7373 6f72 290a 0a20 2020 2064  Accessor)..    d
+00021df0: 6566 205f 5f64 6972 5f5f 2873 656c 6629  ef __dir__(self)
+00021e00: 3a0a 2020 2020 2020 2020 6f20 3d20 7365  :.        o = se
+00021e10: 7428 6469 7228 7479 7065 2873 656c 6629  t(dir(type(self)
+00021e20: 2929 0a20 2020 2020 2020 206f 2e75 7064  )).        o.upd
+00021e30: 6174 6528 7365 6c66 2e5f 5f64 6963 745f  ate(self.__dict_
+00021e40: 5f29 0a20 2020 2020 2020 2023 2052 656d  _).        # Rem
+00021e50: 6f76 6520 7468 6520 6063 6174 6020 616e  ove the `cat` an
+00021e60: 6420 6073 7472 6020 6163 6365 7373 6f72  d `str` accessor
+00021e70: 7320 6966 206e 6f74 2061 7661 696c 6162  s if not availab
+00021e80: 6c65 2e20 5765 2063 616e 2774 0a20 2020  le. We can't.   
+00021e90: 2020 2020 2023 2064 6563 6964 6520 7468       # decide th
+00021ea0: 6973 2073 7461 7469 6361 6c6c 7920 666f  is statically fo
+00021eb0: 7220 7468 6520 6064 7460 2061 6363 6573  r the `dt` acces
+00021ec0: 736f 722c 2061 7320 6974 2077 6f72 6b73  sor, as it works
+00021ed0: 206f 6e0a 2020 2020 2020 2020 2320 6461   on.        # da
+00021ee0: 7465 7469 6d65 2d6c 696b 6520 7468 696e  tetime-like thin
+00021ef0: 6773 2061 7320 7765 6c6c 2e0a 2020 2020  gs as well..    
+00021f00: 2020 2020 666f 7220 6163 6365 7373 6f72      for accessor
+00021f10: 2069 6e20 5b22 6361 7422 2c20 2273 7472   in ["cat", "str
+00021f20: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
+00021f30: 6966 206e 6f74 2068 6173 6174 7472 2873  if not hasattr(s
+00021f40: 656c 662e 5f6d 6574 612c 2061 6363 6573  elf._meta, acces
+00021f50: 736f 7229 3a0a 2020 2020 2020 2020 2020  sor):.          
+00021f60: 2020 2020 2020 6f2e 7265 6d6f 7665 2861        o.remove(a
+00021f70: 6363 6573 736f 7229 0a20 2020 2020 2020  ccessor).       
+00021f80: 2072 6574 7572 6e20 6c69 7374 286f 290a   return list(o).
+00021f90: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00021fa0: 2020 2064 6566 206e 6279 7465 7328 7365     def nbytes(se
+00021fb0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00021fc0: 4e75 6d62 6572 206f 6620 6279 7465 7322  Number of bytes"
+00021fd0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00021fe0: 6e20 7365 6c66 2e72 6564 7563 7469 6f6e  n self.reduction
+00021ff0: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
+00022000: 7468 6f64 732e 6e62 7974 6573 2c20 6e70  thods.nbytes, np
+00022010: 2e73 756d 2c20 746f 6b65 6e3d 226e 6279  .sum, token="nby
+00022020: 7465 7322 2c20 6d65 7461 3d69 6e74 2c20  tes", meta=int, 
+00022030: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+00022040: 650a 2020 2020 2020 2020 290a 0a20 2020  e.        )..   
+00022050: 2064 6566 205f 7265 7072 5f64 6174 6128   def _repr_data(
+00022060: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00022070: 6574 7572 6e20 5f72 6570 725f 6461 7461  eturn _repr_data
+00022080: 5f73 6572 6965 7328 7365 6c66 2e5f 6d65  _series(self._me
+00022090: 7461 2c20 7365 6c66 2e5f 7265 7072 5f64  ta, self._repr_d
+000220a0: 6976 6973 696f 6e73 290a 0a20 2020 2064  ivisions)..    d
+000220b0: 6566 205f 5f72 6570 725f 5f28 7365 6c66  ef __repr__(self
+000220c0: 293a 0a20 2020 2020 2020 2022 2222 6861  ):.        """ha
+000220d0: 7665 2074 6f20 6f76 6572 7772 6974 6520  ve to overwrite 
+000220e0: 666f 6f74 6572 2222 220a 2020 2020 2020  footer""".      
+000220f0: 2020 6966 2073 656c 662e 6e61 6d65 2069    if self.name i
+00022100: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00022110: 2020 2020 2020 2020 666f 6f74 6572 203d          footer =
+00022120: 2066 224e 616d 653a 207b 7365 6c66 2e6e   f"Name: {self.n
+00022130: 616d 657d 2c20 6474 7970 653a 207b 7365  ame}, dtype: {se
+00022140: 6c66 2e64 7479 7065 7d22 0a20 2020 2020  lf.dtype}".     
+00022150: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00022160: 2020 2020 2066 6f6f 7465 7220 3d20 6622       footer = f"
+00022170: 6474 7970 653a 207b 7365 6c66 2e64 7479  dtype: {self.dty
+00022180: 7065 7d22 0a0a 2020 2020 2020 2020 7265  pe}"..        re
+00022190: 7475 726e 2022 2222 4461 736b 207b 6b6c  turn """Dask {kl
+000221a0: 6173 737d 2053 7472 7563 7475 7265 3a0a  ass} Structure:.
+000221b0: 7b64 6174 617d 0a7b 666f 6f74 6572 7d0a  {data}.{footer}.
+000221c0: 4461 736b 204e 616d 653a 207b 6e61 6d65  Dask Name: {name
+000221d0: 7d2c 207b 6c61 7965 7273 7d22 2222 2e66  }, {layers}""".f
+000221e0: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
+000221f0: 2020 206b 6c61 7373 3d73 656c 662e 5f5f     klass=self.__
+00022200: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+00022210: 2c0a 2020 2020 2020 2020 2020 2020 6461  ,.            da
+00022220: 7461 3d73 656c 662e 746f 5f73 7472 696e  ta=self.to_strin
+00022230: 6728 292c 0a20 2020 2020 2020 2020 2020  g(),.           
+00022240: 2066 6f6f 7465 723d 666f 6f74 6572 2c0a   footer=footer,.
+00022250: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00022260: 3d6b 6579 5f73 706c 6974 2873 656c 662e  =key_split(self.
+00022270: 5f6e 616d 6529 2c0a 2020 2020 2020 2020  _name),.        
+00022280: 2020 2020 6c61 7965 7273 3d6d 6179 6265      layers=maybe
+00022290: 5f70 6c75 7261 6c69 7a65 286c 656e 2873  _pluralize(len(s
+000222a0: 656c 662e 6461 736b 2e6c 6179 6572 7329  elf.dask.layers)
+000222b0: 2c20 2267 7261 7068 206c 6179 6572 2229  , "graph layer")
+000222c0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+000222d0: 2064 6566 2072 656e 616d 6528 7365 6c66   def rename(self
+000222e0: 2c20 696e 6465 783d 4e6f 6e65 2c20 696e  , index=None, in
+000222f0: 706c 6163 653d 4661 6c73 652c 2073 6f72  place=False, sor
+00022300: 7465 645f 696e 6465 783d 4661 6c73 6529  ted_index=False)
+00022310: 3a0a 2020 2020 2020 2020 2222 2241 6c74  :.        """Alt
+00022320: 6572 2053 6572 6965 7320 696e 6465 7820  er Series index 
+00022330: 6c61 6265 6c73 206f 7220 6e61 6d65 0a0a  labels or name..
+00022340: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
+00022350: 202f 2064 6963 7420 7661 6c75 6573 206d   / dict values m
+00022360: 7573 7420 6265 2075 6e69 7175 6520 2831  ust be unique (1
+00022370: 2d74 6f2d 3129 2e20 4c61 6265 6c73 206e  -to-1). Labels n
+00022380: 6f74 2063 6f6e 7461 696e 6564 2069 6e0a  ot contained in.
+00022390: 2020 2020 2020 2020 6120 6469 6374 202f          a dict /
+000223a0: 2053 6572 6965 7320 7769 6c6c 2062 6520   Series will be 
+000223b0: 6c65 6674 2061 732d 6973 2e20 4578 7472  left as-is. Extr
+000223c0: 6120 6c61 6265 6c73 206c 6973 7465 6420  a labels listed 
+000223d0: 646f 6e27 7420 7468 726f 7720 616e 0a20  don't throw an. 
+000223e0: 2020 2020 2020 2065 7272 6f72 2e0a 0a20         error... 
+000223f0: 2020 2020 2020 2041 6c74 6572 6e61 7469         Alternati
+00022400: 7665 6c79 2c20 6368 616e 6765 2060 6053  vely, change ``S
+00022410: 6572 6965 732e 6e61 6d65 6060 2077 6974  eries.name`` wit
+00022420: 6820 6120 7363 616c 6172 2076 616c 7565  h a scalar value
+00022430: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00022440: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00022450: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00022460: 2069 6e64 6578 203a 2073 6361 6c61 722c   index : scalar,
+00022470: 2068 6173 6861 626c 6520 7365 7175 656e   hashable sequen
+00022480: 6365 2c20 6469 6374 2d6c 696b 6520 6f72  ce, dict-like or
+00022490: 2063 616c 6c61 626c 652c 206f 7074 696f   callable, optio
+000224a0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+000224b0: 4966 2064 6963 742d 6c69 6b65 206f 7220  If dict-like or 
+000224c0: 6361 6c6c 6162 6c65 2c20 7468 6520 7472  callable, the tr
+000224d0: 616e 7366 6f72 6d61 7469 6f6e 2069 7320  ansformation is 
+000224e0: 6170 706c 6965 6420 746f 2074 6865 0a20  applied to the. 
+000224f0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+00022500: 2e20 5363 616c 6172 206f 7220 6861 7368  . Scalar or hash
+00022510: 6162 6c65 2073 6571 7565 6e63 652d 6c69  able sequence-li
+00022520: 6b65 2077 696c 6c20 616c 7465 7220 7468  ke will alter th
+00022530: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
+00022540: 5365 7269 6573 2e6e 616d 6560 6020 6174  Series.name`` at
+00022550: 7472 6962 7574 652e 0a20 2020 2020 2020  tribute..       
+00022560: 2069 6e70 6c61 6365 203a 2062 6f6f 6c65   inplace : boole
+00022570: 616e 2c20 6465 6661 756c 7420 4661 6c73  an, default Fals
+00022580: 650a 2020 2020 2020 2020 2020 2020 5768  e.            Wh
+00022590: 6574 6865 7220 746f 2072 6574 7572 6e20  ether to return 
+000225a0: 6120 6e65 7720 5365 7269 6573 206f 7220  a new Series or 
+000225b0: 6d6f 6469 6679 2074 6869 7320 6f6e 6520  modify this one 
+000225c0: 696e 706c 6163 652e 0a20 2020 2020 2020  inplace..       
+000225d0: 2073 6f72 7465 645f 696e 6465 7820 3a20   sorted_index : 
+000225e0: 626f 6f6c 2c20 6465 6661 756c 7420 4661  bool, default Fa
+000225f0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00022600: 4966 2074 7275 652c 2074 6865 206f 7574  If true, the out
+00022610: 7075 7420 6060 5365 7269 6573 6060 2077  put ``Series`` w
+00022620: 696c 6c20 6861 7665 206b 6e6f 776e 2064  ill have known d
+00022630: 6976 6973 696f 6e73 2069 6e66 6572 7265  ivisions inferre
+00022640: 640a 2020 2020 2020 2020 2020 2020 6672  d.            fr
+00022650: 6f6d 2074 6865 2069 6e70 7574 2073 6572  om the input ser
+00022660: 6965 7320 616e 6420 7468 6520 7472 616e  ies and the tran
+00022670: 7366 6f72 6d61 7469 6f6e 2e20 4967 6e6f  sformation. Igno
+00022680: 7265 6420 666f 720a 2020 2020 2020 2020  red for.        
+00022690: 2020 2020 6e6f 6e2d 6361 6c6c 6162 6c65      non-callable
+000226a0: 2f64 6963 742d 6c69 6b65 2060 6069 6e64  /dict-like ``ind
+000226b0: 6578 6060 206f 7220 7768 656e 2074 6865  ex`` or when the
+000226c0: 2069 6e70 7574 2073 6572 6965 7320 6861   input series ha
+000226d0: 730a 2020 2020 2020 2020 2020 2020 756e  s.            un
+000226e0: 6b6e 6f77 6e20 6469 7669 7369 6f6e 732e  known divisions.
+000226f0: 204e 6f74 6520 7468 6174 2074 6869 7320   Note that this 
+00022700: 6d61 7920 6f6e 6c79 2062 6520 7365 7420  may only be set 
+00022710: 746f 2060 6054 7275 6560 6020 6966 0a20  to ``True`` if. 
+00022720: 2020 2020 2020 2020 2020 2079 6f75 206b             you k
+00022730: 6e6f 7720 7468 6174 2074 6865 2074 7261  now that the tra
+00022740: 6e73 666f 726d 6564 2069 6e64 6578 2069  nsformed index i
+00022750: 7320 6d6f 6e6f 746f 6e69 6361 6c6c 7920  s monotonically 
+00022760: 696e 6372 6561 7369 6e67 2e20 4461 736b  increasing. Dask
+00022770: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
+00022780: 6c20 6368 6563 6b20 7468 6174 2074 7261  l check that tra
+00022790: 6e73 666f 726d 6564 2064 6976 6973 696f  nsformed divisio
+000227a0: 6e73 2061 7265 206d 6f6e 6f74 6f6e 6963  ns are monotonic
+000227b0: 2c20 6275 7420 6361 6e6e 6f74 0a20 2020  , but cannot.   
+000227c0: 2020 2020 2020 2020 2063 6865 636b 2061           check a
+000227d0: 6c6c 2074 6865 2076 616c 7565 7320 6265  ll the values be
+000227e0: 7477 6565 6e20 6469 7669 7369 6f6e 732c  tween divisions,
+000227f0: 2073 6f20 696e 636f 7272 6563 746c 7920   so incorrectly 
+00022800: 7365 7474 696e 6720 7468 6973 0a20 2020  setting this.   
+00022810: 2020 2020 2020 2020 2063 616e 2072 6573           can res
+00022820: 756c 7420 696e 2062 7567 732e 0a0a 2020  ult in bugs...  
+00022830: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00022840: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00022850: 2020 2020 2020 7265 6e61 6d65 6420 3a20        renamed : 
+00022860: 5365 7269 6573 0a0a 2020 2020 2020 2020  Series..        
+00022870: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+00022880: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00022890: 2020 7061 6e64 6173 2e53 6572 6965 732e    pandas.Series.
+000228a0: 7265 6e61 6d65 0a20 2020 2020 2020 2022  rename.        "
+000228b0: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+000228c0: 7061 6e64 6173 2e61 7069 2e74 7970 6573  pandas.api.types
+000228d0: 2069 6d70 6f72 7420 6973 5f64 6963 745f   import is_dict_
+000228e0: 6c69 6b65 2c20 6973 5f6c 6973 745f 6c69  like, is_list_li
+000228f0: 6b65 2c20 6973 5f73 6361 6c61 720a 0a20  ke, is_scalar.. 
+00022900: 2020 2020 2020 2069 6d70 6f72 7420 6461         import da
+00022910: 736b 2e64 6174 6166 7261 6d65 2061 7320  sk.dataframe as 
+00022920: 6464 0a0a 2020 2020 2020 2020 6966 2069  dd..        if i
+00022930: 735f 7363 616c 6172 2869 6e64 6578 2920  s_scalar(index) 
+00022940: 6f72 2028 0a20 2020 2020 2020 2020 2020  or (.           
+00022950: 2069 735f 6c69 7374 5f6c 696b 6528 696e   is_list_like(in
+00022960: 6465 7829 0a20 2020 2020 2020 2020 2020  dex).           
+00022970: 2061 6e64 206e 6f74 2069 735f 6469 6374   and not is_dict
+00022980: 5f6c 696b 6528 696e 6465 7829 0a20 2020  _like(index).   
+00022990: 2020 2020 2020 2020 2061 6e64 206e 6f74           and not
+000229a0: 2069 7369 6e73 7461 6e63 6528 696e 6465   isinstance(inde
+000229b0: 782c 2064 642e 5365 7269 6573 290a 2020  x, dd.Series).  
+000229c0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+000229d0: 2020 2020 2069 6620 696e 706c 6163 653a       if inplace:
+000229e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000229f0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
+00022a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022a10: 2020 2020 2227 696e 706c 6163 6527 2061      "'inplace' a
+00022a20: 7267 756d 656e 7420 666f 7220 6461 736b  rgument for dask
+00022a30: 2073 6572 6965 7320 7769 6c6c 2062 6520   series will be 
+00022a40: 7265 6d6f 7665 6420 696e 2066 7574 7572  removed in futur
+00022a50: 6520 7665 7273 696f 6e73 222c 0a20 2020  e versions",.   
+00022a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022a70: 2050 656e 6469 6e67 4465 7072 6563 6174   PendingDeprecat
+00022a80: 696f 6e57 6172 6e69 6e67 2c0a 2020 2020  ionWarning,.    
+00022a90: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00022aa0: 2020 2020 2020 2020 2020 7265 7320 3d20            res = 
+00022ab0: 7365 6c66 2069 6620 696e 706c 6163 6520  self if inplace 
+00022ac0: 656c 7365 2073 656c 662e 636f 7079 2829  else self.copy()
+00022ad0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00022ae0: 2e6e 616d 6520 3d20 696e 6465 780a 2020  .name = index.  
+00022af0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00022b00: 2020 2020 2020 2020 7265 7320 3d20 7365          res = se
+00022b10: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00022b20: 7328 4d2e 7265 6e61 6d65 2c20 696e 6465  s(M.rename, inde
+00022b30: 782c 2065 6e66 6f72 6365 5f6d 6574 6164  x, enforce_metad
+00022b40: 6174 613d 4661 6c73 6529 0a20 2020 2020  ata=False).     
+00022b50: 2020 2020 2020 2069 6620 7365 6c66 2e6b         if self.k
+00022b60: 6e6f 776e 5f64 6976 6973 696f 6e73 3a0a  nown_divisions:.
+00022b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022b80: 6966 2073 6f72 7465 645f 696e 6465 7820  if sorted_index 
+00022b90: 616e 6420 2863 616c 6c61 626c 6528 696e  and (callable(in
+00022ba0: 6465 7829 206f 7220 6973 5f64 6963 745f  dex) or is_dict_
+00022bb0: 6c69 6b65 2869 6e64 6578 2929 3a0a 2020  like(index)):.  
+00022bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022bd0: 2020 6f6c 6420 3d20 7064 2e53 6572 6965    old = pd.Serie
+00022be0: 7328 7261 6e67 6528 7365 6c66 2e6e 7061  s(range(self.npa
+00022bf0: 7274 6974 696f 6e73 202b 2031 292c 2069  rtitions + 1), i
+00022c00: 6e64 6578 3d73 656c 662e 6469 7669 7369  ndex=self.divisi
+00022c10: 6f6e 7329 0a20 2020 2020 2020 2020 2020  ons).           
+00022c20: 2020 2020 2020 2020 206e 6577 203d 206f           new = o
+00022c30: 6c64 2e72 656e 616d 6528 696e 6465 7829  ld.rename(index)
+00022c40: 2e69 6e64 6578 0a20 2020 2020 2020 2020  .index.         
+00022c50: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00022c60: 7420 6e65 772e 6973 5f6d 6f6e 6f74 6f6e  t new.is_monoton
+00022c70: 6963 5f69 6e63 7265 6173 696e 673a 0a20  ic_increasing:. 
+00022c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c90: 2020 2020 2020 206d 7367 203d 2028 0a20         msg = (. 
+00022ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022cb0: 2020 2020 2020 2020 2020 2022 736f 7274             "sort
+00022cc0: 6564 5f69 6e64 6578 3d54 7275 652c 2062  ed_index=True, b
+00022cd0: 7574 2074 6865 2074 7261 6e73 666f 726d  ut the transform
+00022ce0: 6564 2069 6e64 6578 2022 0a20 2020 2020  ed index ".     
+00022cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022d00: 2020 2020 2020 2022 6973 6e27 7420 6d6f         "isn't mo
+00022d10: 6e6f 746f 6e69 635f 696e 6372 6561 7369  notonic_increasi
+00022d20: 6e67 220a 2020 2020 2020 2020 2020 2020  ng".            
+00022d30: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00022d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022d50: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00022d60: 6545 7272 6f72 286d 7367 290a 2020 2020  eError(msg).    
+00022d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022d80: 7265 732e 5f64 6976 6973 696f 6e73 203d  res._divisions =
+00022d90: 2074 7570 6c65 286d 6574 686f 6473 2e74   tuple(methods.t
+00022da0: 6f6c 6973 7428 6e65 7729 290a 2020 2020  olist(new)).    
+00022db0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00022dc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00022dd0: 2020 2020 2020 7265 7320 3d20 7265 732e        res = res.
+00022de0: 636c 6561 725f 6469 7669 7369 6f6e 7328  clear_divisions(
+00022df0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00022e00: 2069 6e70 6c61 6365 3a0a 2020 2020 2020   inplace:.      
+00022e10: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
+00022e20: 6173 6b20 3d20 7265 732e 6461 736b 0a20  ask = res.dask. 
+00022e30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00022e40: 656c 662e 5f6e 616d 6520 3d20 7265 732e  elf._name = res.
+00022e50: 5f6e 616d 650a 2020 2020 2020 2020 2020  _name.          
+00022e60: 2020 2020 2020 7365 6c66 2e5f 6469 7669        self._divi
+00022e70: 7369 6f6e 7320 3d20 7265 732e 6469 7669  sions = res.divi
+00022e80: 7369 6f6e 730a 2020 2020 2020 2020 2020  sions.          
+00022e90: 2020 2020 2020 7365 6c66 2e5f 6d65 7461        self._meta
+00022ea0: 203d 2072 6573 2e5f 6d65 7461 0a20 2020   = res._meta.   
+00022eb0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00022ec0: 203d 2073 656c 660a 2020 2020 2020 2020   = self.        
+00022ed0: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
+00022ee0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00022ef0: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+00022f00: 2072 6f75 6e64 2873 656c 662c 2064 6563   round(self, dec
+00022f10: 696d 616c 733d 3029 3a0a 2020 2020 2020  imals=0):.      
+00022f20: 2020 7265 7475 726e 2065 6c65 6d77 6973    return elemwis
+00022f30: 6528 4d2e 726f 756e 642c 2073 656c 662c  e(M.round, self,
+00022f40: 2064 6563 696d 616c 7329 0a0a 2020 2020   decimals)..    
+00022f50: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00022f60: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+00022f70: 2074 6f5f 7469 6d65 7374 616d 7028 7365   to_timestamp(se
+00022f80: 6c66 2c20 6672 6571 3d4e 6f6e 652c 2068  lf, freq=None, h
+00022f90: 6f77 3d22 7374 6172 7422 2c20 6178 6973  ow="start", axis
+00022fa0: 3d30 293a 0a20 2020 2020 2020 2064 6620  =0):.        df 
+00022fb0: 3d20 656c 656d 7769 7365 284d 2e74 6f5f  = elemwise(M.to_
+00022fc0: 7469 6d65 7374 616d 702c 2073 656c 662c  timestamp, self,
+00022fd0: 2066 7265 712c 2068 6f77 2c20 6178 6973   freq, how, axis
+00022fe0: 290a 2020 2020 2020 2020 6466 2e64 6976  ).        df.div
+00022ff0: 6973 696f 6e73 203d 2074 7570 6c65 2870  isions = tuple(p
+00023000: 642e 496e 6465 7828 7365 6c66 2e64 6976  d.Index(self.div
+00023010: 6973 696f 6e73 292e 746f 5f74 696d 6573  isions).to_times
+00023020: 7461 6d70 2866 7265 713d 6672 6571 2c20  tamp(freq=freq, 
+00023030: 686f 773d 686f 7729 290a 2020 2020 2020  how=how)).      
+00023040: 2020 7265 7475 726e 2064 660a 0a20 2020    return df..   
+00023050: 2064 6566 2071 7561 6e74 696c 6528 7365   def quantile(se
+00023060: 6c66 2c20 713d 302e 352c 206d 6574 686f  lf, q=0.5, metho
+00023070: 643d 2264 6566 6175 6c74 2229 3a0a 2020  d="default"):.  
+00023080: 2020 2020 2020 2222 2241 7070 726f 7869        """Approxi
+00023090: 6d61 7465 2071 7561 6e74 696c 6573 206f  mate quantiles o
+000230a0: 6620 5365 7269 6573 0a0a 2020 2020 2020  f Series..      
+000230b0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+000230c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+000230d0: 2020 2020 2020 2020 7120 3a20 6c69 7374          q : list
+000230e0: 2f61 7272 6179 206f 6620 666c 6f61 7473  /array of floats
+000230f0: 2c20 6465 6661 756c 7420 302e 3520 2835  , default 0.5 (5
+00023100: 3025 290a 2020 2020 2020 2020 2020 2020  0%).            
+00023110: 4974 6572 6162 6c65 206f 6620 6e75 6d62  Iterable of numb
+00023120: 6572 7320 7261 6e67 696e 6720 6672 6f6d  ers ranging from
+00023130: 2030 2074 6f20 3120 666f 7220 7468 6520   0 to 1 for the 
+00023140: 6465 7369 7265 6420 7175 616e 7469 6c65  desired quantile
+00023150: 730a 2020 2020 2020 2020 6d65 7468 6f64  s.        method
+00023160: 203a 207b 2764 6566 6175 6c74 272c 2027   : {'default', '
+00023170: 7464 6967 6573 7427 2c20 2764 6173 6b27  tdigest', 'dask'
+00023180: 7d2c 206f 7074 696f 6e61 6c0a 2020 2020  }, optional.    
+00023190: 2020 2020 2020 2020 5768 6174 206d 6574          What met
+000231a0: 686f 6420 746f 2075 7365 2e20 4279 2064  hod to use. By d
+000231b0: 6566 6175 6c74 2077 696c 6c20 7573 6520  efault will use 
+000231c0: 6461 736b 2773 2069 6e74 6572 6e61 6c20  dask's internal 
+000231d0: 6375 7374 6f6d 0a20 2020 2020 2020 2020  custom.         
+000231e0: 2020 2061 6c67 6f72 6974 686d 2028 6060     algorithm (``
+000231f0: 2764 6173 6b27 6060 292e 2020 4966 2073  'dask'``).  If s
+00023200: 6574 2074 6f20 6060 2774 6469 6765 7374  et to ``'tdigest
+00023210: 2760 6020 7769 6c6c 2075 7365 2074 6469  '`` will use tdi
+00023220: 6765 7374 0a20 2020 2020 2020 2020 2020  gest.           
+00023230: 2066 6f72 2066 6c6f 6174 7320 616e 6420   for floats and 
+00023240: 696e 7473 2061 6e64 2066 616c 6c62 6163  ints and fallbac
+00023250: 6b20 746f 2074 6865 2060 6027 6461 736b  k to the ``'dask
+00023260: 2760 6020 6f74 6865 7277 6973 652e 0a20  '`` otherwise.. 
+00023270: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00023280: 2020 2072 6574 7572 6e20 7175 616e 7469     return quanti
+00023290: 6c65 2873 656c 662c 2071 2c20 6d65 7468  le(self, q, meth
+000232a0: 6f64 3d6d 6574 686f 6429 0a0a 2020 2020  od=method)..    
+000232b0: 6465 6620 6d65 6469 616e 5f61 7070 726f  def median_appro
+000232c0: 7869 6d61 7465 2873 656c 662c 206d 6574  ximate(self, met
+000232d0: 686f 643d 2264 6566 6175 6c74 2229 3a0a  hod="default"):.
+000232e0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+000232f0: 6e20 7468 6520 6170 7072 6f78 696d 6174  n the approximat
+00023300: 6520 6d65 6469 616e 206f 6620 7468 6520  e median of the 
+00023310: 7661 6c75 6573 206f 7665 7220 7468 6520  values over the 
+00023320: 7265 7175 6573 7465 6420 6178 6973 2e0a  requested axis..
+00023330: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00023340: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00023350: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206d  ------.        m
+00023360: 6574 686f 6420 3a20 7b27 6465 6661 756c  ethod : {'defaul
+00023370: 7427 2c20 2774 6469 6765 7374 272c 2027  t', 'tdigest', '
+00023380: 6461 736b 277d 2c20 6f70 7469 6f6e 616c  dask'}, optional
+00023390: 0a20 2020 2020 2020 2020 2020 2057 6861  .            Wha
+000233a0: 7420 6d65 7468 6f64 2074 6f20 7573 652e  t method to use.
+000233b0: 2042 7920 6465 6661 756c 7420 7769 6c6c   By default will
+000233c0: 2075 7365 2044 6173 6b27 7320 696e 7465   use Dask's inte
+000233d0: 726e 616c 2063 7573 746f 6d0a 2020 2020  rnal custom.    
+000233e0: 2020 2020 2020 2020 616c 676f 7269 7468          algorith
+000233f0: 6d20 2860 6022 6461 736b 2260 6029 2e20  m (``"dask"``). 
+00023400: 2049 6620 7365 7420 746f 2060 6022 7464   If set to ``"td
+00023410: 6967 6573 7422 6060 2077 696c 6c20 7573  igest"`` will us
+00023420: 6520 7464 6967 6573 740a 2020 2020 2020  e tdigest.      
+00023430: 2020 2020 2020 666f 7220 666c 6f61 7473        for floats
+00023440: 2061 6e64 2069 6e74 7320 616e 6420 6661   and ints and fa
+00023450: 6c6c 6261 636b 2074 6f20 7468 6520 6060  llback to the ``
+00023460: 2264 6173 6b22 6060 206f 7468 6572 7769  "dask"`` otherwi
+00023470: 7365 2e0a 2020 2020 2020 2020 2222 220a  se..        """.
+00023480: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00023490: 656c 662e 7175 616e 7469 6c65 2871 3d30  elf.quantile(q=0
+000234a0: 2e35 2c20 6d65 7468 6f64 3d6d 6574 686f  .5, method=metho
+000234b0: 6429 0a0a 2020 2020 4064 6572 6976 6564  d)..    @derived
+000234c0: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
+000234d0: 0a20 2020 2064 6566 206d 6564 6961 6e28  .    def median(
+000234e0: 7365 6c66 2c20 6d65 7468 6f64 3d22 6465  self, method="de
+000234f0: 6661 756c 7422 293a 0a20 2020 2020 2020  fault"):.       
+00023500: 2069 6620 7365 6c66 2e6e 7061 7274 6974   if self.npartit
+00023510: 696f 6e73 203d 3d20 313a 0a20 2020 2020  ions == 1:.     
+00023520: 2020 2020 2020 2023 2043 616e 2070 726f         # Can pro
+00023530: 7669 6465 2061 6e20 6578 6163 7420 6d65  vide an exact me
+00023540: 6469 616e 2069 6e20 7468 6573 6520 6361  dian in these ca
+00023550: 7365 730a 2020 2020 2020 2020 2020 2020  ses.            
+00023560: 7265 7475 726e 2073 656c 662e 6d65 6469  return self.medi
+00023570: 616e 5f61 7070 726f 7869 6d61 7465 286d  an_approximate(m
+00023580: 6574 686f 643d 6d65 7468 6f64 290a 2020  ethod=method).  
+00023590: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+000235a0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+000235b0: 0a20 2020 2020 2020 2020 2020 2022 4461  .            "Da
+000235c0: 736b 2064 6f65 736e 2774 2069 6d70 6c65  sk doesn't imple
+000235d0: 6d65 6e74 2061 6e20 6578 6163 7420 6d65  ment an exact me
+000235e0: 6469 616e 2069 6e20 616c 6c20 6361 7365  dian in all case
+000235f0: 7320 6173 2074 6869 7320 6973 2068 6172  s as this is har
+00023600: 6420 746f 2064 6f20 696e 2070 6172 616c  d to do in paral
+00023610: 6c65 6c2e 2022 0a20 2020 2020 2020 2020  lel. ".         
+00023620: 2020 2022 5365 6520 7468 6520 606d 6564     "See the `med
+00023630: 6961 6e5f 6170 7072 6f78 696d 6174 6560  ian_approximate`
+00023640: 206d 6574 686f 6420 696e 7374 6561 642c   method instead,
+00023650: 2077 6869 6368 2075 7365 7320 616e 2061   which uses an a
+00023660: 7070 726f 7869 6d61 7465 2061 6c67 6f72  pproximate algor
+00023670: 6974 686d 2e22 0a20 2020 2020 2020 2029  ithm.".        )
+00023680: 0a0a 2020 2020 6465 6620 5f72 6570 6172  ..    def _repar
+00023690: 7469 7469 6f6e 5f71 7561 6e74 696c 6573  tition_quantiles
+000236a0: 2873 656c 662c 206e 7061 7274 6974 696f  (self, npartitio
+000236b0: 6e73 2c20 7570 7361 6d70 6c65 3d31 2e30  ns, upsample=1.0
+000236c0: 293a 0a20 2020 2020 2020 2022 2222 4170  ):.        """Ap
+000236d0: 7072 6f78 696d 6174 6520 7175 616e 7469  proximate quanti
+000236e0: 6c65 7320 6f66 2053 6572 6965 7320 7573  les of Series us
+000236f0: 6564 2066 6f72 2072 6570 6172 7469 7469  ed for repartiti
+00023700: 6f6e 696e 6722 2222 0a20 2020 2020 2020  oning""".       
+00023710: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+00023720: 7261 6d65 2e70 6172 7469 7469 6f6e 7175  rame.partitionqu
+00023730: 616e 7469 6c65 7320 696d 706f 7274 2070  antiles import p
+00023740: 6172 7469 7469 6f6e 5f71 7561 6e74 696c  artition_quantil
+00023750: 6573 0a0a 2020 2020 2020 2020 7265 7475  es..        retu
+00023760: 726e 2070 6172 7469 7469 6f6e 5f71 7561  rn partition_qua
+00023770: 6e74 696c 6573 2873 656c 662c 206e 7061  ntiles(self, npa
+00023780: 7274 6974 696f 6e73 2c20 7570 7361 6d70  rtitions, upsamp
+00023790: 6c65 3d75 7073 616d 706c 6529 0a0a 2020  le=upsample)..  
+000237a0: 2020 6465 6620 5f5f 6765 7469 7465 6d5f    def __getitem_
+000237b0: 5f28 7365 6c66 2c20 6b65 7929 3a0a 2020  _(self, key):.  
+000237c0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+000237d0: 6e63 6528 6b65 792c 2053 6572 6965 7329  nce(key, Series)
+000237e0: 2061 6e64 2073 656c 662e 6469 7669 7369   and self.divisi
+000237f0: 6f6e 7320 3d3d 206b 6579 2e64 6976 6973  ons == key.divis
+00023800: 696f 6e73 3a0a 2020 2020 2020 2020 2020  ions:.          
+00023810: 2020 6e61 6d65 203d 2022 696e 6465 782d    name = "index-
+00023820: 2573 2220 2520 746f 6b65 6e69 7a65 2873  %s" % tokenize(s
+00023830: 656c 662c 206b 6579 290a 2020 2020 2020  elf, key).      
+00023840: 2020 2020 2020 6473 6b20 3d20 7061 7274        dsk = part
+00023850: 6974 696f 6e77 6973 655f 6772 6170 6828  itionwise_graph(
+00023860: 6f70 6572 6174 6f72 2e67 6574 6974 656d  operator.getitem
+00023870: 2c20 6e61 6d65 2c20 7365 6c66 2c20 6b65  , name, self, ke
+00023880: 7929 0a20 2020 2020 2020 2020 2020 2067  y).            g
+00023890: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
+000238a0: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+000238b0: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
+000238c0: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
+000238d0: 7365 6c66 2c20 6b65 795d 290a 2020 2020  self, key]).    
+000238e0: 2020 2020 2020 2020 7265 7475 726e 2053          return S
+000238f0: 6572 6965 7328 6772 6170 682c 206e 616d  eries(graph, nam
+00023900: 652c 2073 656c 662e 5f6d 6574 612c 2073  e, self._meta, s
+00023910: 656c 662e 6469 7669 7369 6f6e 7329 0a20  elf.divisions). 
+00023920: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00023930: 6c66 2e6c 6f63 5b6b 6579 5d0a 0a20 2020  lf.loc[key]..   
+00023940: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00023950: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00023960: 2064 6566 205f 6765 745f 6e75 6d65 7269   def _get_numeri
+00023970: 635f 6461 7461 2873 656c 662c 2068 6f77  c_data(self, how
+00023980: 3d22 616e 7922 2c20 7375 6273 6574 3d4e  ="any", subset=N
+00023990: 6f6e 6529 3a0a 2020 2020 2020 2020 7265  one):.        re
+000239a0: 7475 726e 2073 656c 660a 0a20 2020 2069  turn self..    i
+000239b0: 6620 6e6f 7420 5041 4e44 4153 5f47 545f  f not PANDAS_GT_
+000239c0: 3230 303a 0a0a 2020 2020 2020 2020 4064  200:..        @d
+000239d0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+000239e0: 6572 6965 7329 0a20 2020 2020 2020 2064  eries).        d
+000239f0: 6566 2069 7465 7269 7465 6d73 2873 656c  ef iteritems(sel
+00023a00: 6629 3a0a 2020 2020 2020 2020 2020 2020  f):.            
+00023a10: 6966 2050 414e 4441 535f 4754 5f31 3530  if PANDAS_GT_150
+00023a20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00023a30: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+00023a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023a50: 2020 2020 2022 6974 6572 6974 656d 7320       "iteritems 
+00023a60: 6973 2064 6570 7265 6361 7465 6420 616e  is deprecated an
+00023a70: 6420 7769 6c6c 2062 6520 7265 6d6f 7665  d will be remove
+00023a80: 6420 696e 2061 2066 7574 7572 6520 7665  d in a future ve
+00023a90: 7273 696f 6e2e 2022 0a20 2020 2020 2020  rsion. ".       
+00023aa0: 2020 2020 2020 2020 2020 2020 2022 5573               "Us
+00023ab0: 6520 2e69 7465 6d73 2069 6e73 7465 6164  e .items instead
+00023ac0: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
+00023ad0: 2020 2020 2020 2020 4675 7475 7265 5761          FutureWa
+00023ae0: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
+00023af0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00023b00: 2020 2020 2023 2057 6520 7573 6520 7468       # We use th
+00023b10: 6520 605f 6020 6765 6e65 7261 746f 7220  e `_` generator 
+00023b20: 6265 6c6f 7720 746f 2065 6e73 7572 6520  below to ensure 
+00023b30: 7468 6520 6465 7072 6563 6174 696f 6e20  the deprecation 
+00023b40: 7761 726e 696e 6720 6162 6f76 650a 2020  warning above.  
+00023b50: 2020 2020 2020 2020 2020 2320 6973 2072            # is r
+00023b60: 6169 7365 6420 7768 656e 2060 2e69 7465  aised when `.ite
+00023b70: 7269 7465 6d73 2829 6020 6973 2063 616c  ritems()` is cal
+00023b80: 6c65 642c 206e 6f74 2077 6865 6e20 7468  led, not when th
+00023b90: 6520 6669 7273 7420 606e 6578 7428 3c67  e first `next(<g
+00023ba0: 656e 6572 6174 6f72 3e29 600a 2020 2020  enerator>)`.    
+00023bb0: 2020 2020 2020 2020 2320 6974 6572 6174          # iterat
+00023bc0: 696f 6e20 6861 7070 656e 730a 0a20 2020  ion happens..   
+00023bd0: 2020 2020 2020 2020 2064 6566 205f 2873           def _(s
+00023be0: 656c 6629 3a0a 2020 2020 2020 2020 2020  elf):.          
+00023bf0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00023c00: 616e 6765 2873 656c 662e 6e70 6172 7469  ange(self.nparti
+00023c10: 7469 6f6e 7329 3a0a 2020 2020 2020 2020  tions):.        
+00023c20: 2020 2020 2020 2020 2020 2020 7320 3d20              s = 
+00023c30: 7365 6c66 2e67 6574 5f70 6172 7469 7469  self.get_partiti
+00023c40: 6f6e 2869 292e 636f 6d70 7574 6528 290a  on(i).compute().
+00023c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c60: 2020 2020 7969 656c 6420 6672 6f6d 2073      yield from s
+00023c70: 2e69 7465 6d73 2829 0a0a 2020 2020 2020  .items()..      
+00023c80: 2020 2020 2020 7265 7475 726e 205f 2873        return _(s
+00023c90: 656c 6629 0a0a 2020 2020 4064 6572 6976  elf)..    @deriv
+00023ca0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
+00023cb0: 7329 0a20 2020 2064 6566 205f 5f69 7465  s).    def __ite
+00023cc0: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
+00023cd0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00023ce0: 6528 7365 6c66 2e6e 7061 7274 6974 696f  e(self.npartitio
+00023cf0: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
+00023d00: 2073 203d 2073 656c 662e 6765 745f 7061   s = self.get_pa
+00023d10: 7274 6974 696f 6e28 6929 2e63 6f6d 7075  rtition(i).compu
+00023d20: 7465 2829 0a20 2020 2020 2020 2020 2020  te().           
+00023d30: 2079 6965 6c64 2066 726f 6d20 730a 0a20   yield from s.. 
+00023d40: 2020 2040 5f64 6570 7265 6361 7465 6428     @_deprecated(
+00023d50: 0a20 2020 2020 2020 206d 6573 7361 6765  .        message
+00023d60: 3d28 0a20 2020 2020 2020 2020 2020 2022  =(.            "
+00023d70: 5573 696e 6720 7468 6520 6060 696e 6060  Using the ``in``
+00023d80: 206f 7065 7261 746f 7220 746f 2074 6573   operator to tes
+00023d90: 7420 666f 7220 6d65 6d62 6572 7368 6970  t for membership
+00023da0: 2069 6e20 5365 7269 6573 2069 7320 220a   in Series is ".
+00023db0: 2020 2020 2020 2020 2020 2020 2264 6570              "dep
+00023dc0: 7265 6361 7465 642e 2054 6f20 7465 7374  recated. To test
+00023dd0: 2066 6f72 206d 656d 6265 7273 6869 7020   for membership 
+00023de0: 696e 2074 6865 2069 6e64 6578 2075 7365  in the index use
+00023df0: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+00023e00: 6060 2873 2e69 6e64 6578 203d 3d20 6b65  ``(s.index == ke
+00023e10: 7929 2e61 6e79 2829 6060 2e20 5369 6d69  y).any()``. Simi
+00023e20: 6c61 726c 7920 746f 2074 6573 7420 666f  larly to test fo
+00023e30: 7220 6d65 6d62 6572 7368 6970 2069 6e20  r membership in 
+00023e40: 220a 2020 2020 2020 2020 2020 2020 2274  ".            "t
+00023e50: 6865 2076 616c 7565 7320 7573 6520 6060  he values use ``
+00023e60: 2873 203d 3d20 6b65 7929 2e61 6e79 2829  (s == key).any()
+00023e70: 6060 220a 2020 2020 2020 2020 290a 2020  ``".        ).  
+00023e80: 2020 290a 2020 2020 6465 6620 5f5f 636f    ).    def __co
+00023e90: 6e74 6169 6e73 5f5f 2873 656c 662c 206b  ntains__(self, k
+00023ea0: 6579 293a 0a20 2020 2020 2020 2072 6574  ey):.        ret
+00023eb0: 7572 6e20 2873 656c 6620 3d3d 206b 6579  urn (self == key
+00023ec0: 292e 616e 7928 292e 636f 6d70 7574 6528  ).any().compute(
+00023ed0: 290a 0a20 2020 2040 636c 6173 736d 6574  )..    @classmet
+00023ee0: 686f 640a 2020 2020 6465 6620 5f76 616c  hod.    def _val
+00023ef0: 6964 6174 655f 6178 6973 2863 6c73 2c20  idate_axis(cls, 
+00023f00: 6178 6973 3d30 2c20 6e6f 6e65 5f69 735f  axis=0, none_is_
+00023f10: 7a65 726f 3a20 626f 6f6c 203d 2054 7275  zero: bool = Tru
+00023f20: 6529 202d 3e20 4e6f 6e65 207c 204c 6974  e) -> None | Lit
+00023f30: 6572 616c 5b30 2c20 315d 3a0a 2020 2020  eral[0, 1]:.    
+00023f40: 2020 2020 6966 2061 7869 7320 6e6f 7420      if axis not 
+00023f50: 696e 2028 302c 2022 696e 6465 7822 2c20  in (0, "index", 
+00023f60: 4e6f 6e65 293a 0a20 2020 2020 2020 2020  None):.         
+00023f70: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00023f80: 726f 7228 6622 4e6f 2061 7869 7320 6e61  ror(f"No axis na
+00023f90: 6d65 6420 7b61 7869 737d 2229 0a20 2020  med {axis}").   
+00023fa0: 2020 2020 2023 2063 6f6e 7665 7274 2074       # convert t
+00023fb0: 6f20 6e75 6d65 7269 6320 6178 6973 0a20  o numeric axis. 
+00023fc0: 2020 2020 2020 206e 756d 6572 6963 5f61         numeric_a
+00023fd0: 7869 733a 2064 6963 745b 7374 7220 7c20  xis: dict[str | 
+00023fe0: 4e6f 6e65 2c20 4c69 7465 7261 6c5b 302c  None, Literal[0,
+00023ff0: 2031 5d5d 203d 207b 2269 6e64 6578 223a   1]] = {"index":
+00024000: 2030 7d0a 2020 2020 2020 2020 6966 206e   0}.        if n
+00024010: 6f6e 655f 6973 5f7a 6572 6f3a 0a20 2020  one_is_zero:.   
+00024020: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
+00024030: 5f61 7869 735b 4e6f 6e65 5d20 3d20 300a  _axis[None] = 0.
+00024040: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00024050: 756d 6572 6963 5f61 7869 732e 6765 7428  umeric_axis.get(
+00024060: 6178 6973 2c20 6178 6973 290a 0a20 2020  axis, axis)..   
+00024070: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00024080: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
+00024090: 6620 6772 6f75 7062 7928 0a20 2020 2020  f groupby(.     
+000240a0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000240b0: 2062 793d 4e6f 6e65 2c0a 2020 2020 2020   by=None,.      
+000240c0: 2020 6772 6f75 705f 6b65 7973 3d47 524f    group_keys=GRO
+000240d0: 5550 5f4b 4559 535f 4445 4641 554c 542c  UP_KEYS_DEFAULT,
+000240e0: 0a20 2020 2020 2020 2073 6f72 743d 4e6f  .        sort=No
+000240f0: 6e65 2c0a 2020 2020 2020 2020 6f62 7365  ne,.        obse
+00024100: 7276 6564 3d4e 6f6e 652c 0a20 2020 2020  rved=None,.     
+00024110: 2020 2064 726f 706e 613d 4e6f 6e65 2c0a     dropna=None,.
+00024120: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+00024130: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+00024140: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+00024150: 7261 6d65 2e67 726f 7570 6279 2069 6d70  rame.groupby imp
+00024160: 6f72 7420 5365 7269 6573 4772 6f75 7042  ort SeriesGroupB
+00024170: 790a 0a20 2020 2020 2020 2072 6574 7572  y..        retur
+00024180: 6e20 5365 7269 6573 4772 6f75 7042 7928  n SeriesGroupBy(
+00024190: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000241a0: 662c 0a20 2020 2020 2020 2020 2020 2062  f,.            b
+000241b0: 793d 6279 2c0a 2020 2020 2020 2020 2020  y=by,.          
+000241c0: 2020 6772 6f75 705f 6b65 7973 3d67 726f    group_keys=gro
+000241d0: 7570 5f6b 6579 732c 0a20 2020 2020 2020  up_keys,.       
+000241e0: 2020 2020 2073 6f72 743d 736f 7274 2c0a       sort=sort,.
+000241f0: 2020 2020 2020 2020 2020 2020 6f62 7365              obse
+00024200: 7276 6564 3d6f 6273 6572 7665 642c 0a20  rved=observed,. 
+00024210: 2020 2020 2020 2020 2020 2064 726f 706e             dropn
+00024220: 613d 6472 6f70 6e61 2c0a 2020 2020 2020  a=dropna,.      
+00024230: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
+00024240: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+00024250: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00024260: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
+00024270: 636f 756e 7428 7365 6c66 2c20 7370 6c69  count(self, spli
+00024280: 745f 6576 6572 793d 4661 6c73 6529 3a0a  t_every=False):.
+00024290: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000242a0: 7570 6572 2829 2e63 6f75 6e74 2873 706c  uper().count(spl
+000242b0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+000242c0: 7665 7279 290a 0a20 2020 2040 6465 7269  very)..    @deri
+000242d0: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
+000242e0: 6573 290a 2020 2020 6465 6620 6d6f 6465  es).    def mode
+000242f0: 2873 656c 662c 2064 726f 706e 613d 5472  (self, dropna=Tr
+00024300: 7565 2c20 7370 6c69 745f 6576 6572 793d  ue, split_every=
+00024310: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00024320: 7265 7475 726e 2073 7570 6572 2829 2e6d  return super().m
+00024330: 6f64 6528 6472 6f70 6e61 3d64 726f 706e  ode(dropna=dropn
+00024340: 612c 2073 706c 6974 5f65 7665 7279 3d73  a, split_every=s
+00024350: 706c 6974 5f65 7665 7279 290a 0a20 2020  plit_every)..   
+00024360: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00024370: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
+00024380: 6620 6578 706c 6f64 6528 7365 6c66 293a  f explode(self):
+00024390: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
+000243a0: 7365 6c66 2e5f 6d65 7461 2e65 7870 6c6f  self._meta.explo
+000243b0: 6465 2829 0a20 2020 2020 2020 2072 6574  de().        ret
+000243c0: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
+000243d0: 7469 7469 6f6e 7328 4d2e 6578 706c 6f64  titions(M.explod
+000243e0: 652c 206d 6574 613d 6d65 7461 2c20 656e  e, meta=meta, en
+000243f0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+00024400: 616c 7365 290a 0a20 2020 2064 6566 2075  alse)..    def u
+00024410: 6e69 7175 6528 7365 6c66 2c20 7370 6c69  nique(self, spli
+00024420: 745f 6576 6572 793d 4e6f 6e65 2c20 7370  t_every=None, sp
+00024430: 6c69 745f 6f75 743d 3129 3a0a 2020 2020  lit_out=1):.    
+00024440: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00024450: 5265 7475 726e 2053 6572 6965 7320 6f66  Return Series of
+00024460: 2075 6e69 7175 6520 7661 6c75 6573 2069   unique values i
+00024470: 6e20 7468 6520 6f62 6a65 6374 2e20 496e  n the object. In
+00024480: 636c 7564 6573 204e 4120 7661 6c75 6573  cludes NA values
+00024490: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+000244a0: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
+000244b0: 2d2d 0a20 2020 2020 2020 2075 6e69 7175  --.        uniqu
+000244c0: 6573 203a 2053 6572 6965 730a 2020 2020  es : Series.    
+000244d0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000244e0: 7265 7475 726e 2061 6361 280a 2020 2020  return aca(.    
+000244f0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00024500: 2020 2020 2020 2020 2020 6368 756e 6b3d            chunk=
+00024510: 6d65 7468 6f64 732e 756e 6971 7565 2c0a  methods.unique,.
+00024520: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
+00024530: 6567 6174 653d 6d65 7468 6f64 732e 756e  egate=methods.un
+00024540: 6971 7565 2c0a 2020 2020 2020 2020 2020  ique,.          
+00024550: 2020 6d65 7461 3d73 656c 662e 5f6d 6574    meta=self._met
+00024560: 612c 0a20 2020 2020 2020 2020 2020 2074  a,.            t
+00024570: 6f6b 656e 3d22 756e 6971 7565 222c 0a20  oken="unique",. 
+00024580: 2020 2020 2020 2020 2020 2073 706c 6974             split
+00024590: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+000245a0: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
+000245b0: 7365 7269 6573 5f6e 616d 653d 7365 6c66  series_name=self
+000245c0: 2e6e 616d 652c 0a20 2020 2020 2020 2020  .name,.         
+000245d0: 2020 2073 706c 6974 5f6f 7574 3d73 706c     split_out=spl
+000245e0: 6974 5f6f 7574 2c0a 2020 2020 2020 2020  it_out,.        
+000245f0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00024600: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
+00024610: 2020 2020 6465 6620 6e75 6e69 7175 6528      def nunique(
+00024620: 7365 6c66 2c20 7370 6c69 745f 6576 6572  self, split_ever
+00024630: 793d 4e6f 6e65 2c20 6472 6f70 6e61 3d54  y=None, dropna=T
+00024640: 7275 6529 3a0a 2020 2020 2020 2020 756e  rue):.        un
+00024650: 6971 7320 3d20 7365 6c66 2e64 726f 705f  iqs = self.drop_
+00024660: 6475 706c 6963 6174 6573 2873 706c 6974  duplicates(split
+00024670: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+00024680: 7279 290a 2020 2020 2020 2020 6966 2064  ry).        if d
+00024690: 726f 706e 613a 0a20 2020 2020 2020 2020  ropna:.         
+000246a0: 2020 2023 2063 6f75 6e74 206d 696d 6963     # count mimic
+000246b0: 7320 7061 6e64 6173 2062 6568 6176 696f  s pandas behavio
+000246c0: 7220 616e 6420 6578 636c 7564 6573 204e  r and excludes N
+000246d0: 4120 7661 6c75 6573 0a20 2020 2020 2020  A values.       
+000246e0: 2020 2020 2072 6574 7572 6e20 756e 6971       return uniq
+000246f0: 732e 636f 756e 7428 290a 2020 2020 2020  s.count().      
+00024700: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00024710: 2020 2020 7265 7475 726e 2075 6e69 7173      return uniqs
+00024720: 2e73 697a 650a 0a20 2020 2040 6465 7269  .size..    @deri
+00024730: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
+00024740: 6573 290a 2020 2020 6465 6620 7661 6c75  es).    def valu
+00024750: 655f 636f 756e 7473 280a 2020 2020 2020  e_counts(.      
+00024760: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00024770: 736f 7274 3d4e 6f6e 652c 0a20 2020 2020  sort=None,.     
+00024780: 2020 2061 7363 656e 6469 6e67 3d46 616c     ascending=Fal
+00024790: 7365 2c0a 2020 2020 2020 2020 6472 6f70  se,.        drop
+000247a0: 6e61 3d54 7275 652c 0a20 2020 2020 2020  na=True,.       
+000247b0: 206e 6f72 6d61 6c69 7a65 3d46 616c 7365   normalize=False
+000247c0: 2c0a 2020 2020 2020 2020 7370 6c69 745f  ,.        split_
+000247d0: 6576 6572 793d 4e6f 6e65 2c0a 2020 2020  every=None,.    
+000247e0: 2020 2020 7370 6c69 745f 6f75 743d 312c      split_out=1,
+000247f0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00024800: 6b77 6172 6773 203d 207b 2273 6f72 7422  kwargs = {"sort"
+00024810: 3a20 736f 7274 2c20 2261 7363 656e 6469  : sort, "ascendi
+00024820: 6e67 223a 2061 7363 656e 6469 6e67 2c20  ng": ascending, 
+00024830: 2264 726f 706e 6122 3a20 6472 6f70 6e61  "dropna": dropna
+00024840: 7d0a 2020 2020 2020 2020 6167 6772 6567  }.        aggreg
+00024850: 6174 655f 6b77 6172 6773 203d 207b 226e  ate_kwargs = {"n
+00024860: 6f72 6d61 6c69 7a65 223a 206e 6f72 6d61  ormalize": norma
+00024870: 6c69 7a65 7d0a 2020 2020 2020 2020 6966  lize}.        if
+00024880: 2073 706c 6974 5f6f 7574 203e 2031 3a0a   split_out > 1:.
+00024890: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
+000248a0: 6567 6174 655f 6b77 6172 6773 5b22 746f  egate_kwargs["to
+000248b0: 7461 6c5f 6c65 6e67 7468 225d 203d 2028  tal_length"] = (
+000248c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000248d0: 206c 656e 2873 656c 6629 2069 6620 6472   len(self) if dr
+000248e0: 6f70 6e61 2069 7320 4661 6c73 6520 656c  opna is False el
+000248f0: 7365 206c 656e 2873 656c 662e 6472 6f70  se len(self.drop
+00024900: 6e61 2829 290a 2020 2020 2020 2020 2020  na()).          
+00024910: 2020 290a 0a20 2020 2020 2020 2072 6574    )..        ret
+00024920: 7572 6e20 6163 6128 0a20 2020 2020 2020  urn aca(.       
+00024930: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00024940: 2020 2020 2020 2063 6875 6e6b 3d4d 2e76         chunk=M.v
+00024950: 616c 7565 5f63 6f75 6e74 732c 0a20 2020  alue_counts,.   
+00024960: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
+00024970: 7465 3d6d 6574 686f 6473 2e76 616c 7565  te=methods.value
+00024980: 5f63 6f75 6e74 735f 6167 6772 6567 6174  _counts_aggregat
+00024990: 652c 0a20 2020 2020 2020 2020 2020 2063  e,.            c
+000249a0: 6f6d 6269 6e65 3d6d 6574 686f 6473 2e76  ombine=methods.v
+000249b0: 616c 7565 5f63 6f75 6e74 735f 636f 6d62  alue_counts_comb
+000249c0: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
+000249d0: 206d 6574 613d 7365 6c66 2e5f 6d65 7461   meta=self._meta
+000249e0: 2e76 616c 7565 5f63 6f75 6e74 7328 6e6f  .value_counts(no
+000249f0: 726d 616c 697a 653d 6e6f 726d 616c 697a  rmalize=normaliz
+00024a00: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+00024a10: 746f 6b65 6e3d 2276 616c 7565 2d63 6f75  token="value-cou
+00024a20: 6e74 7322 2c0a 2020 2020 2020 2020 2020  nts",.          
+00024a30: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
+00024a40: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
+00024a50: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
+00024a60: 3d73 706c 6974 5f6f 7574 2c0a 2020 2020  =split_out,.    
+00024a70: 2020 2020 2020 2020 7370 6c69 745f 6f75          split_ou
+00024a80: 745f 7365 7475 703d 7370 6c69 745f 6f75  t_setup=split_ou
+00024a90: 745f 6f6e 5f69 6e64 6578 2c0a 2020 2020  t_on_index,.    
+00024aa0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+00024ab0: 655f 6b77 6172 6773 3d61 6767 7265 6761  e_kwargs=aggrega
+00024ac0: 7465 5f6b 7761 7267 732c 0a20 2020 2020  te_kwargs,.     
+00024ad0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+00024ae0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00024af0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00024b00: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+00024b10: 206e 6c61 7267 6573 7428 7365 6c66 2c20   nlargest(self, 
+00024b20: 6e3d 352c 2073 706c 6974 5f65 7665 7279  n=5, split_every
+00024b30: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00024b40: 7265 7475 726e 2061 6361 280a 2020 2020  return aca(.    
+00024b50: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00024b60: 2020 2020 2020 2020 2020 6368 756e 6b3d            chunk=
+00024b70: 4d2e 6e6c 6172 6765 7374 2c0a 2020 2020  M.nlargest,.    
+00024b80: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+00024b90: 653d 4d2e 6e6c 6172 6765 7374 2c0a 2020  e=M.nlargest,.  
+00024ba0: 2020 2020 2020 2020 2020 6d65 7461 3d73            meta=s
+00024bb0: 656c 662e 5f6d 6574 612c 0a20 2020 2020  elf._meta,.     
+00024bc0: 2020 2020 2020 2074 6f6b 656e 3d22 7365         token="se
+00024bd0: 7269 6573 2d6e 6c61 7267 6573 7422 2c0a  ries-nlargest",.
+00024be0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+00024bf0: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00024c00: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+00024c10: 206e 3d6e 2c0a 2020 2020 2020 2020 290a   n=n,.        ).
+00024c20: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00024c30: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
+00024c40: 2020 6465 6620 6e73 6d61 6c6c 6573 7428    def nsmallest(
+00024c50: 7365 6c66 2c20 6e3d 352c 2073 706c 6974  self, n=5, split
+00024c60: 5f65 7665 7279 3d4e 6f6e 6529 3a0a 2020  _every=None):.  
+00024c70: 2020 2020 2020 7265 7475 726e 2061 6361        return aca
+00024c80: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00024c90: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00024ca0: 6368 756e 6b3d 4d2e 6e73 6d61 6c6c 6573  chunk=M.nsmalles
+00024cb0: 742c 0a20 2020 2020 2020 2020 2020 2061  t,.            a
+00024cc0: 6767 7265 6761 7465 3d4d 2e6e 736d 616c  ggregate=M.nsmal
+00024cd0: 6c65 7374 2c0a 2020 2020 2020 2020 2020  lest,.          
+00024ce0: 2020 6d65 7461 3d73 656c 662e 5f6d 6574    meta=self._met
+00024cf0: 612c 0a20 2020 2020 2020 2020 2020 2074  a,.            t
+00024d00: 6f6b 656e 3d22 7365 7269 6573 2d6e 736d  oken="series-nsm
+00024d10: 616c 6c65 7374 222c 0a20 2020 2020 2020  allest",.       
+00024d20: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+00024d30: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
+00024d40: 2020 2020 2020 2020 2020 6e3d 6e2c 0a20            n=n,. 
+00024d50: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+00024d60: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+00024d70: 6572 6965 7329 0a20 2020 2064 6566 2069  eries).    def i
+00024d80: 7369 6e28 7365 6c66 2c20 7661 6c75 6573  sin(self, values
+00024d90: 293a 0a20 2020 2020 2020 2023 2041 6464  ):.        # Add
+00024da0: 6564 206a 7573 7420 746f 2067 6574 2074  ed just to get t
+00024db0: 6865 2064 6966 6665 7265 6e74 2064 6f63  he different doc
+00024dc0: 7374 7269 6e67 2066 6f72 2053 6572 6965  string for Serie
+00024dd0: 730a 2020 2020 2020 2020 7265 7475 726e  s.        return
+00024de0: 2073 7570 6572 2829 2e69 7369 6e28 7661   super().isin(va
+00024df0: 6c75 6573 290a 0a20 2020 2040 696e 7365  lues)..    @inse
+00024e00: 7274 5f6d 6574 615f 7061 7261 6d5f 6465  rt_meta_param_de
+00024e10: 7363 7269 7074 696f 6e28 7061 643d 3132  scription(pad=12
+00024e20: 290a 2020 2020 4064 6572 6976 6564 5f66  ).    @derived_f
+00024e30: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00024e40: 2020 2064 6566 206d 6170 2873 656c 662c     def map(self,
+00024e50: 2061 7267 2c20 6e61 5f61 6374 696f 6e3d   arg, na_action=
+00024e60: 4e6f 6e65 2c20 6d65 7461 3d6e 6f5f 6465  None, meta=no_de
+00024e70: 6661 756c 7429 3a0a 2020 2020 2020 2020  fault):.        
+00024e80: 6966 2069 735f 7365 7269 6573 5f6c 696b  if is_series_lik
+00024e90: 6528 6172 6729 2061 6e64 2069 735f 6461  e(arg) and is_da
+00024ea0: 736b 5f63 6f6c 6c65 6374 696f 6e28 6172  sk_collection(ar
+00024eb0: 6729 3a0a 2020 2020 2020 2020 2020 2020  g):.            
+00024ec0: 7265 7475 726e 2073 6572 6965 735f 6d61  return series_ma
+00024ed0: 7028 7365 6c66 2c20 6172 6729 0a20 2020  p(self, arg).   
+00024ee0: 2020 2020 2069 6620 6e6f 7420 280a 2020       if not (.  
+00024ef0: 2020 2020 2020 2020 2020 6973 696e 7374            isinst
+00024f00: 616e 6365 2861 7267 2c20 6469 6374 290a  ance(arg, dict).
+00024f10: 2020 2020 2020 2020 2020 2020 6f72 2063              or c
+00024f20: 616c 6c61 626c 6528 6172 6729 0a20 2020  allable(arg).   
+00024f30: 2020 2020 2020 2020 206f 7220 6973 5f73           or is_s
+00024f40: 6572 6965 735f 6c69 6b65 2861 7267 290a  eries_like(arg).
+00024f50: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00024f60: 6e6f 7420 6973 5f64 6173 6b5f 636f 6c6c  not is_dask_coll
+00024f70: 6563 7469 6f6e 2861 7267 290a 2020 2020  ection(arg).    
+00024f80: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+00024f90: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00024fa0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00024fb0: 2020 2020 6622 6172 6720 6d75 7374 2062      f"arg must b
+00024fc0: 6520 7061 6e64 6173 2e53 6572 6965 732c  e pandas.Series,
+00024fd0: 2064 6963 7420 6f72 2063 616c 6c61 626c   dict or callabl
+00024fe0: 652e 2047 6f74 207b 7479 7065 2861 7267  e. Got {type(arg
+00024ff0: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00025000: 290a 2020 2020 2020 2020 6e61 6d65 203d  ).        name =
+00025010: 2022 6d61 702d 2220 2b20 746f 6b65 6e69   "map-" + tokeni
+00025020: 7a65 2873 656c 662c 2061 7267 2c20 6e61  ze(self, arg, na
+00025030: 5f61 6374 696f 6e29 0a20 2020 2020 2020  _action).       
+00025040: 2064 736b 203d 207b 0a20 2020 2020 2020   dsk = {.       
+00025050: 2020 2020 2028 6e61 6d65 2c20 6929 3a20       (name, i): 
+00025060: 284d 2e6d 6170 2c20 6b2c 2061 7267 2c20  (M.map, k, arg, 
+00025070: 6e61 5f61 6374 696f 6e29 0a20 2020 2020  na_action).     
+00025080: 2020 2020 2020 2066 6f72 2069 2c20 6b20         for i, k 
+00025090: 696e 2065 6e75 6d65 7261 7465 2873 656c  in enumerate(sel
+000250a0: 662e 5f5f 6461 736b 5f6b 6579 735f 5f28  f.__dask_keys__(
+000250b0: 2929 0a20 2020 2020 2020 207d 0a20 2020  )).        }.   
+000250c0: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+000250d0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+000250e0: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+000250f0: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
+00025100: 6369 6573 3d5b 7365 6c66 5d29 0a20 2020  cies=[self]).   
+00025110: 2020 2020 2069 6620 6d65 7461 2069 7320       if meta is 
+00025120: 6e6f 5f64 6566 6175 6c74 3a0a 2020 2020  no_default:.    
+00025130: 2020 2020 2020 2020 6d65 7461 203d 205f          meta = _
+00025140: 656d 756c 6174 6528 4d2e 6d61 702c 2073  emulate(M.map, s
+00025150: 656c 662c 2061 7267 2c20 6e61 5f61 6374  elf, arg, na_act
+00025160: 696f 6e3d 6e61 5f61 6374 696f 6e2c 2075  ion=na_action, u
+00025170: 6466 3d54 7275 6529 0a20 2020 2020 2020  df=True).       
+00025180: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00025190: 2020 206d 6574 6120 3d20 6d61 6b65 5f6d     meta = make_m
+000251a0: 6574 6128 0a20 2020 2020 2020 2020 2020  eta(.           
+000251b0: 2020 2020 206d 6574 612c 0a20 2020 2020       meta,.     
+000251c0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+000251d0: 3d67 6574 6174 7472 286d 616b 655f 6d65  =getattr(make_me
+000251e0: 7461 2873 656c 6629 2c20 2269 6e64 6578  ta(self), "index
+000251f0: 222c 204e 6f6e 6529 2c0a 2020 2020 2020  ", None),.      
+00025200: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
+00025210: 5f6d 6574 613d 7365 6c66 2e5f 6d65 7461  _meta=self._meta
+00025220: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00025230: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00025240: 7479 7065 2873 656c 6629 2867 7261 7068  type(self)(graph
+00025250: 2c20 6e61 6d65 2c20 6d65 7461 2c20 7365  , name, meta, se
+00025260: 6c66 2e64 6976 6973 696f 6e73 290a 0a20  lf.divisions).. 
+00025270: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00025280: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
+00025290: 6465 6620 6472 6f70 6e61 2873 656c 6629  def dropna(self)
+000252a0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000252b0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+000252c0: 696f 6e73 284d 2e64 726f 706e 612c 2065  ions(M.dropna, e
+000252d0: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+000252e0: 4661 6c73 6529 0a0a 2020 2020 4064 6572  False)..    @der
+000252f0: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+00025300: 6965 7329 0a20 2020 2064 6566 2062 6574  ies).    def bet
+00025310: 7765 656e 2873 656c 662c 206c 6566 742c  ween(self, left,
+00025320: 2072 6967 6874 2c20 696e 636c 7573 6976   right, inclusiv
+00025330: 653d 2262 6f74 6822 293a 0a20 2020 2020  e="both"):.     
+00025340: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+00025350: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+00025360: 2020 2020 2020 2020 2020 204d 2e62 6574             M.bet
+00025370: 7765 656e 2c20 6c65 6674 3d6c 6566 742c  ween, left=left,
+00025380: 2072 6967 6874 3d72 6967 6874 2c20 696e   right=right, in
+00025390: 636c 7573 6976 653d 696e 636c 7573 6976  clusive=inclusiv
+000253a0: 650a 2020 2020 2020 2020 290a 0a20 2020  e.        )..   
+000253b0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+000253c0: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
+000253d0: 6620 636c 6970 2873 656c 662c 206c 6f77  f clip(self, low
+000253e0: 6572 3d4e 6f6e 652c 2075 7070 6572 3d4e  er=None, upper=N
+000253f0: 6f6e 652c 206f 7574 3d4e 6f6e 6529 3a0a  one, out=None):.
+00025400: 2020 2020 2020 2020 6966 206f 7574 2069          if out i
+00025410: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00025420: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00025430: 6c75 6545 7272 6f72 2822 276f 7574 2720  lueError("'out' 
+00025440: 6d75 7374 2062 6520 4e6f 6e65 2229 0a20  must be None"). 
+00025450: 2020 2020 2020 2023 206e 702e 636c 6970         # np.clip
+00025460: 206d 6179 2070 6173 7320 6f75 740a 2020   may pass out.  
+00025470: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00025480: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+00025490: 280a 2020 2020 2020 2020 2020 2020 4d2e  (.            M.
+000254a0: 636c 6970 2c20 6c6f 7765 723d 6c6f 7765  clip, lower=lowe
+000254b0: 722c 2075 7070 6572 3d75 7070 6572 2c20  r, upper=upper, 
+000254c0: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+000254d0: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
+000254e0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+000254f0: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00025500: 2020 2064 6566 2063 6c69 705f 6c6f 7765     def clip_lowe
+00025510: 7228 7365 6c66 2c20 7468 7265 7368 6f6c  r(self, threshol
+00025520: 6429 3a0a 2020 2020 2020 2020 7265 7475  d):.        retu
+00025530: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+00025540: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+00025550: 2020 2020 4d2e 636c 6970 5f6c 6f77 6572      M.clip_lower
+00025560: 2c20 7468 7265 7368 6f6c 643d 7468 7265  , threshold=thre
+00025570: 7368 6f6c 642c 2065 6e66 6f72 6365 5f6d  shold, enforce_m
+00025580: 6574 6164 6174 613d 4661 6c73 650a 2020  etadata=False.  
+00025590: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
+000255a0: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
+000255b0: 7269 6573 290a 2020 2020 6465 6620 636c  ries).    def cl
+000255c0: 6970 5f75 7070 6572 2873 656c 662c 2074  ip_upper(self, t
+000255d0: 6872 6573 686f 6c64 293a 0a20 2020 2020  hreshold):.     
+000255e0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+000255f0: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+00025600: 2020 2020 2020 2020 2020 204d 2e63 6c69             M.cli
+00025610: 705f 7570 7065 722c 2074 6872 6573 686f  p_upper, thresho
+00025620: 6c64 3d74 6872 6573 686f 6c64 2c20 656e  ld=threshold, en
+00025630: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+00025640: 616c 7365 0a20 2020 2020 2020 2029 0a0a  alse.        )..
+00025650: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00025660: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+00025670: 2064 6566 2061 6c69 676e 2873 656c 662c   def align(self,
+00025680: 206f 7468 6572 2c20 6a6f 696e 3d22 6f75   other, join="ou
+00025690: 7465 7222 2c20 6178 6973 3d4e 6f6e 652c  ter", axis=None,
+000256a0: 2066 696c 6c5f 7661 6c75 653d 4e6f 6e65   fill_value=None
+000256b0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000256c0: 6e20 7375 7065 7228 292e 616c 6967 6e28  n super().align(
+000256d0: 6f74 6865 722c 206a 6f69 6e3d 6a6f 696e  other, join=join
+000256e0: 2c20 6178 6973 3d61 7869 732c 2066 696c  , axis=axis, fil
+000256f0: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
+00025700: 7565 290a 0a20 2020 2040 6465 7269 7665  ue)..    @derive
+00025710: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
+00025720: 290a 2020 2020 6465 6620 636f 6d62 696e  ).    def combin
+00025730: 6528 7365 6c66 2c20 6f74 6865 722c 2066  e(self, other, f
+00025740: 756e 632c 2066 696c 6c5f 7661 6c75 653d  unc, fill_value=
+00025750: 4e6f 6e65 293a 0a20 2020 2020 2020 2072  None):.        r
+00025760: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+00025770: 6172 7469 7469 6f6e 7328 4d2e 636f 6d62  artitions(M.comb
+00025780: 696e 652c 206f 7468 6572 2c20 6675 6e63  ine, other, func
+00025790: 2c20 6669 6c6c 5f76 616c 7565 3d66 696c  , fill_value=fil
+000257a0: 6c5f 7661 6c75 6529 0a0a 2020 2020 4064  l_value)..    @d
+000257b0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+000257c0: 6572 6965 7329 0a20 2020 2064 6566 2073  eries).    def s
+000257d0: 7175 6565 7a65 2873 656c 6629 3a0a 2020  queeze(self):.  
+000257e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000257f0: 660a 0a20 2020 2040 6465 7269 7665 645f  f..    @derived_
+00025800: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
+00025810: 2020 2020 6465 6620 636f 6d62 696e 655f      def combine_
+00025820: 6669 7273 7428 7365 6c66 2c20 6f74 6865  first(self, othe
+00025830: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
+00025840: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+00025850: 6974 696f 6e73 284d 2e63 6f6d 6269 6e65  itions(M.combine
+00025860: 5f66 6972 7374 2c20 6f74 6865 7229 0a0a  _first, other)..
+00025870: 2020 2020 6465 6620 746f 5f62 6167 2873      def to_bag(s
+00025880: 656c 662c 2069 6e64 6578 3d46 616c 7365  elf, index=False
+00025890: 2c20 666f 726d 6174 3d22 7475 706c 6522  , format="tuple"
+000258a0: 293a 0a20 2020 2020 2020 2022 2222 4372  ):.        """Cr
+000258b0: 6561 7465 2061 2044 6173 6b20 4261 6720  eate a Dask Bag 
+000258c0: 6672 6f6d 2061 2053 6572 6965 7322 2222  from a Series"""
+000258d0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+000258e0: 736b 2e64 6174 6166 7261 6d65 2e69 6f20  sk.dataframe.io 
+000258f0: 696d 706f 7274 2074 6f5f 6261 670a 0a20  import to_bag.. 
+00025900: 2020 2020 2020 2072 6574 7572 6e20 746f         return to
+00025910: 5f62 6167 2873 656c 662c 2069 6e64 6578  _bag(self, index
+00025920: 2c20 666f 726d 6174 3d66 6f72 6d61 7429  , format=format)
+00025930: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00025940: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00025950: 2020 2064 6566 2074 6f5f 6672 616d 6528     def to_frame(
+00025960: 7365 6c66 2c20 6e61 6d65 3d4e 6f6e 6529  self, name=None)
+00025970: 3a0a 2020 2020 2020 2020 6172 6773 203d  :.        args =
+00025980: 205b 5d20 6966 206e 616d 6520 6973 204e   [] if name is N
+00025990: 6f6e 6520 656c 7365 205b 6e61 6d65 5d0a  one else [name].
+000259a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000259b0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+000259c0: 6e73 284d 2e74 6f5f 6672 616d 652c 202a  ns(M.to_frame, *
+000259d0: 6172 6773 2c20 6d65 7461 3d73 656c 662e  args, meta=self.
+000259e0: 5f6d 6574 612e 746f 5f66 7261 6d65 282a  _meta.to_frame(*
+000259f0: 6172 6773 2929 0a0a 2020 2020 4064 6572  args))..    @der
+00025a00: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+00025a10: 6965 7329 0a20 2020 2064 6566 2074 6f5f  ies).    def to_
+00025a20: 7374 7269 6e67 2873 656c 662c 206d 6178  string(self, max
+00025a30: 5f72 6f77 733d 3529 3a0a 2020 2020 2020  _rows=5):.      
+00025a40: 2020 2320 6f70 7469 6f6e 5f63 6f6e 7465    # option_conte
+00025a50: 7874 2064 6f65 736e 2774 2061 6666 6563  xt doesn't affec
+00025a60: 740a 2020 2020 2020 2020 7265 7475 726e  t.        return
+00025a70: 2073 656c 662e 5f72 6570 725f 6461 7461   self._repr_data
+00025a80: 2829 2e74 6f5f 7374 7269 6e67 286d 6178  ().to_string(max
+00025a90: 5f72 6f77 733d 6d61 785f 726f 7773 290a  _rows=max_rows).
+00025aa0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
+00025ab0: 640a 2020 2020 6465 6620 5f62 696e 645f  d.    def _bind_
+00025ac0: 6f70 6572 6174 6f72 5f6d 6574 686f 6428  operator_method(
+00025ad0: 636c 732c 206e 616d 652c 206f 702c 206f  cls, name, op, o
+00025ae0: 7269 6769 6e61 6c3d 7064 2e53 6572 6965  riginal=pd.Serie
+00025af0: 7329 3a0a 2020 2020 2020 2020 2222 2262  s):.        """b
+00025b00: 696e 6420 6f70 6572 6174 6f72 206d 6574  ind operator met
+00025b10: 686f 6420 6c69 6b65 2053 6572 6965 732e  hod like Series.
+00025b20: 6164 6420 746f 2074 6869 7320 636c 6173  add to this clas
+00025b30: 7322 2222 0a0a 2020 2020 2020 2020 6465  s"""..        de
+00025b40: 6620 6d65 7468 2873 656c 662c 206f 7468  f meth(self, oth
+00025b50: 6572 2c20 6c65 7665 6c3d 4e6f 6e65 2c20  er, level=None, 
+00025b60: 6669 6c6c 5f76 616c 7565 3d4e 6f6e 652c  fill_value=None,
+00025b70: 2061 7869 733d 3029 3a0a 2020 2020 2020   axis=0):.      
+00025b80: 2020 2020 2020 6966 206c 6576 656c 2069        if level i
+00025b90: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00025ba0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00025bb0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+00025bc0: 4572 726f 7228 226c 6576 656c 206d 7573  Error("level mus
+00025bd0: 7420 6265 204e 6f6e 6522 290a 2020 2020  t be None").    
+00025be0: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+00025bf0: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+00025c00: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+00025c10: 2020 2020 206d 6574 6120 3d20 5f65 6d75       meta = _emu
+00025c20: 6c61 7465 286f 702c 2073 656c 662c 206f  late(op, self, o
+00025c30: 7468 6572 2c20 6178 6973 3d61 7869 732c  ther, axis=axis,
+00025c40: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
+00025c50: 5f76 616c 7565 290a 2020 2020 2020 2020  _value).        
+00025c60: 2020 2020 7265 7475 726e 206d 6170 5f70      return map_p
+00025c70: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+00025c80: 2020 2020 2020 2020 2020 206f 702c 2073             op, s
+00025c90: 656c 662c 206f 7468 6572 2c20 6d65 7461  elf, other, meta
+00025ca0: 3d6d 6574 612c 2061 7869 733d 6178 6973  =meta, axis=axis
+00025cb0: 2c20 6669 6c6c 5f76 616c 7565 3d66 696c  , fill_value=fil
+00025cc0: 6c5f 7661 6c75 650a 2020 2020 2020 2020  l_value.        
+00025cd0: 2020 2020 290a 0a20 2020 2020 2020 206d      )..        m
+00025ce0: 6574 682e 5f5f 6e61 6d65 5f5f 203d 206e  eth.__name__ = n
+00025cf0: 616d 650a 2020 2020 2020 2020 7365 7461  ame.        seta
+00025d00: 7474 7228 636c 732c 206e 616d 652c 2064  ttr(cls, name, d
+00025d10: 6572 6976 6564 5f66 726f 6d28 6f72 6967  erived_from(orig
+00025d20: 696e 616c 2928 6d65 7468 2929 0a0a 2020  inal)(meth))..  
+00025d30: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
+00025d40: 2020 2064 6566 205f 6269 6e64 5f63 6f6d     def _bind_com
+00025d50: 7061 7269 736f 6e5f 6d65 7468 6f64 2863  parison_method(c
+00025d60: 6c73 2c20 6e61 6d65 2c20 636f 6d70 6172  ls, name, compar
+00025d70: 6973 6f6e 2c20 6f72 6967 696e 616c 3d70  ison, original=p
+00025d80: 642e 5365 7269 6573 293a 0a20 2020 2020  d.Series):.     
+00025d90: 2020 2022 2222 6269 6e64 2063 6f6d 7061     """bind compa
+00025da0: 7269 736f 6e20 6d65 7468 6f64 206c 696b  rison method lik
+00025db0: 6520 5365 7269 6573 2e65 7120 746f 2074  e Series.eq to t
+00025dc0: 6869 7320 636c 6173 7322 2222 0a0a 2020  his class"""..  
+00025dd0: 2020 2020 2020 6465 6620 6d65 7468 2873        def meth(s
+00025de0: 656c 662c 206f 7468 6572 2c20 6c65 7665  elf, other, leve
+00025df0: 6c3d 4e6f 6e65 2c20 6669 6c6c 5f76 616c  l=None, fill_val
+00025e00: 7565 3d4e 6f6e 652c 2061 7869 733d 3029  ue=None, axis=0)
+00025e10: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00025e20: 206c 6576 656c 2069 7320 6e6f 7420 4e6f   level is not No
+00025e30: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00025e40: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+00025e50: 6c65 6d65 6e74 6564 4572 726f 7228 226c  lementedError("l
+00025e60: 6576 656c 206d 7573 7420 6265 204e 6f6e  evel must be Non
+00025e70: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+00025e80: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
+00025e90: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
+00025ea0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00025eb0: 6669 6c6c 5f76 616c 7565 2069 7320 4e6f  fill_value is No
+00025ec0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00025ed0: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
+00025ee0: 6973 6528 636f 6d70 6172 6973 6f6e 2c20  ise(comparison, 
+00025ef0: 7365 6c66 2c20 6f74 6865 722c 2061 7869  self, other, axi
+00025f00: 733d 6178 6973 290a 2020 2020 2020 2020  s=axis).        
+00025f10: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00025f20: 2020 2020 2020 2020 2020 6f70 203d 2070            op = p
+00025f30: 6172 7469 616c 2863 6f6d 7061 7269 736f  artial(compariso
+00025f40: 6e2c 2066 696c 6c5f 7661 6c75 653d 6669  n, fill_value=fi
+00025f50: 6c6c 5f76 616c 7565 290a 2020 2020 2020  ll_value).      
+00025f60: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00025f70: 2065 6c65 6d77 6973 6528 6f70 2c20 7365   elemwise(op, se
+00025f80: 6c66 2c20 6f74 6865 722c 2061 7869 733d  lf, other, axis=
+00025f90: 6178 6973 290a 0a20 2020 2020 2020 206d  axis)..        m
+00025fa0: 6574 682e 5f5f 6e61 6d65 5f5f 203d 206e  eth.__name__ = n
+00025fb0: 616d 650a 2020 2020 2020 2020 7365 7461  ame.        seta
+00025fc0: 7474 7228 636c 732c 206e 616d 652c 2064  ttr(cls, name, d
+00025fd0: 6572 6976 6564 5f66 726f 6d28 6f72 6967  erived_from(orig
+00025fe0: 696e 616c 2928 6d65 7468 2929 0a0a 2020  inal)(meth))..  
+00025ff0: 2020 4069 6e73 6572 745f 6d65 7461 5f70    @insert_meta_p
+00026000: 6172 616d 5f64 6573 6372 6970 7469 6f6e  aram_description
+00026010: 2870 6164 3d31 3229 0a20 2020 2064 6566  (pad=12).    def
+00026020: 2061 7070 6c79 2873 656c 662c 2066 756e   apply(self, fun
+00026030: 632c 2063 6f6e 7665 7274 5f64 7479 7065  c, convert_dtype
+00026040: 3d6e 6f5f 6465 6661 756c 742c 206d 6574  =no_default, met
+00026050: 613d 6e6f 5f64 6566 6175 6c74 2c20 6172  a=no_default, ar
+00026060: 6773 3d28 292c 202a 2a6b 7764 7329 3a0a  gs=(), **kwds):.
+00026070: 2020 2020 2020 2020 2222 2250 6172 616c          """Paral
+00026080: 6c65 6c20 7665 7273 696f 6e20 6f66 2070  lel version of p
+00026090: 616e 6461 732e 5365 7269 6573 2e61 7070  andas.Series.app
+000260a0: 6c79 0a0a 2020 2020 2020 2020 5061 7261  ly..        Para
+000260b0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+000260c0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+000260d0: 2020 6675 6e63 203a 2066 756e 6374 696f    func : functio
+000260e0: 6e0a 2020 2020 2020 2020 2020 2020 4675  n.            Fu
+000260f0: 6e63 7469 6f6e 2074 6f20 6170 706c 790a  nction to apply.
+00026100: 2020 2020 2020 2020 636f 6e76 6572 745f          convert_
+00026110: 6474 7970 6520 3a20 626f 6f6c 6561 6e2c  dtype : boolean,
+00026120: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
+00026130: 2020 2020 2020 2020 2020 5472 7920 746f            Try to
+00026140: 2066 696e 6420 6265 7474 6572 2064 7479   find better dty
+00026150: 7065 2066 6f72 2065 6c65 6d65 6e74 7769  pe for elementwi
+00026160: 7365 2066 756e 6374 696f 6e20 7265 7375  se function resu
+00026170: 6c74 732e 0a20 2020 2020 2020 2020 2020  lts..           
+00026180: 2049 6620 4661 6c73 652c 206c 6561 7665   If False, leave
+00026190: 2061 7320 6474 7970 653d 6f62 6a65 6374   as dtype=object
+000261a0: 2e0a 2020 2020 2020 2020 244d 4554 410a  ..        $META.
+000261b0: 2020 2020 2020 2020 6172 6773 203a 2074          args : t
+000261c0: 7570 6c65 0a20 2020 2020 2020 2020 2020  uple.           
+000261d0: 2050 6f73 6974 696f 6e61 6c20 6172 6775   Positional argu
+000261e0: 6d65 6e74 7320 746f 2070 6173 7320 746f  ments to pass to
+000261f0: 2066 756e 6374 696f 6e20 696e 2061 6464   function in add
+00026200: 6974 696f 6e20 746f 2074 6865 2076 616c  ition to the val
+00026210: 7565 2e0a 0a20 2020 2020 2020 2041 6464  ue...        Add
+00026220: 6974 696f 6e61 6c20 6b65 7977 6f72 6420  itional keyword 
+00026230: 6172 6775 6d65 6e74 7320 7769 6c6c 2062  arguments will b
+00026240: 6520 7061 7373 6564 2061 7320 6b65 7977  e passed as keyw
+00026250: 6f72 6473 2074 6f20 7468 6520 6675 6e63  ords to the func
+00026260: 7469 6f6e 2e0a 0a20 2020 2020 2020 2052  tion...        R
+00026270: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+00026280: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2061  ------.        a
+00026290: 7070 6c69 6564 203a 2053 6572 6965 7320  pplied : Series 
+000262a0: 6f72 2044 6174 6146 7261 6d65 2069 6620  or DataFrame if 
+000262b0: 6675 6e63 2072 6574 7572 6e73 2061 2053  func returns a S
+000262c0: 6572 6965 732e 0a0a 2020 2020 2020 2020  eries...        
+000262d0: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+000262e0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+000262f0: 2020 3e3e 3e20 696d 706f 7274 2064 6173    >>> import das
+00026300: 6b2e 6461 7461 6672 616d 6520 6173 2064  k.dataframe as d
+00026310: 640a 2020 2020 2020 2020 3e3e 3e20 7320  d.        >>> s 
+00026320: 3d20 7064 2e53 6572 6965 7328 7261 6e67  = pd.Series(rang
+00026330: 6528 3529 2c20 6e61 6d65 3d27 7827 290a  e(5), name='x').
+00026340: 2020 2020 2020 2020 3e3e 3e20 6473 203d          >>> ds =
+00026350: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
+00026360: 732c 206e 7061 7274 6974 696f 6e73 3d32  s, npartitions=2
+00026370: 290a 0a20 2020 2020 2020 2041 7070 6c79  )..        Apply
+00026380: 2061 2066 756e 6374 696f 6e20 656c 656d   a function elem
+00026390: 656e 7477 6973 6520 6163 726f 7373 2074  entwise across t
+000263a0: 6865 2053 6572 6965 732c 2070 6173 7369  he Series, passi
+000263b0: 6e67 2069 6e20 6578 7472 610a 2020 2020  ng in extra.    
+000263c0: 2020 2020 6172 6775 6d65 6e74 7320 696e      arguments in
+000263d0: 2060 6061 7267 7360 6020 616e 6420 6060   ``args`` and ``
+000263e0: 6b77 6172 6773 6060 3a0a 0a20 2020 2020  kwargs``:..     
+000263f0: 2020 203e 3e3e 2064 6566 206d 7961 6464     >>> def myadd
+00026400: 2878 2c20 612c 2062 3d31 293a 0a20 2020  (x, a, b=1):.   
+00026410: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
+00026420: 7572 6e20 7820 2b20 6120 2b20 620a 2020  urn x + a + b.  
+00026430: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
+00026440: 6473 2e61 7070 6c79 286d 7961 6464 2c20  ds.apply(myadd, 
+00026450: 6172 6773 3d28 322c 292c 2062 3d31 2e35  args=(2,), b=1.5
+00026460: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+00026470: 4b49 500a 0a20 2020 2020 2020 2042 7920  KIP..        By 
+00026480: 6465 6661 756c 742c 2064 6173 6b20 7472  default, dask tr
+00026490: 6965 7320 746f 2069 6e66 6572 2074 6865  ies to infer the
+000264a0: 206f 7574 7075 7420 6d65 7461 6461 7461   output metadata
+000264b0: 2062 7920 7275 6e6e 696e 6720 796f 7572   by running your
+000264c0: 0a20 2020 2020 2020 2070 726f 7669 6465  .        provide
+000264d0: 6420 6675 6e63 7469 6f6e 206f 6e20 736f  d function on so
+000264e0: 6d65 2066 616b 6520 6461 7461 2e20 5468  me fake data. Th
+000264f0: 6973 2077 6f72 6b73 2077 656c 6c20 696e  is works well in
+00026500: 206d 616e 7920 6361 7365 732c 2062 7574   many cases, but
+00026510: 0a20 2020 2020 2020 2063 616e 2073 6f6d  .        can som
+00026520: 6574 696d 6573 2062 6520 6578 7065 6e73  etimes be expens
+00026530: 6976 652c 206f 7220 6576 656e 2066 6169  ive, or even fai
+00026540: 6c2e 2054 6f20 6176 6f69 6420 7468 6973  l. To avoid this
+00026550: 2c20 796f 7520 6361 6e0a 2020 2020 2020  , you can.      
+00026560: 2020 6d61 6e75 616c 6c79 2073 7065 6369    manually speci
+00026570: 6679 2074 6865 206f 7574 7075 7420 6d65  fy the output me
+00026580: 7461 6461 7461 2077 6974 6820 7468 6520  tadata with the 
+00026590: 6060 6d65 7461 6060 206b 6579 776f 7264  ``meta`` keyword
+000265a0: 2e20 5468 6973 0a20 2020 2020 2020 2063  . This.        c
+000265b0: 616e 2062 6520 7370 6563 6966 6965 6420  an be specified 
+000265c0: 696e 206d 616e 7920 666f 726d 732c 2066  in many forms, f
+000265d0: 6f72 206d 6f72 6520 696e 666f 726d 6174  or more informat
+000265e0: 696f 6e20 7365 650a 2020 2020 2020 2020  ion see.        
+000265f0: 6060 6461 736b 2e64 6174 6166 7261 6d65  ``dask.dataframe
+00026600: 2e75 7469 6c73 2e6d 616b 655f 6d65 7461  .utils.make_meta
+00026610: 6060 2e0a 0a20 2020 2020 2020 2048 6572  ``...        Her
+00026620: 6520 7765 2073 7065 6369 6679 2074 6865  e we specify the
+00026630: 206f 7574 7075 7420 6973 2061 2053 6572   output is a Ser
+00026640: 6965 7320 7769 7468 206e 616d 6520 6060  ies with name ``
+00026650: 2778 2760 602c 2061 6e64 2064 7479 7065  'x'``, and dtype
+00026660: 0a20 2020 2020 2020 2060 6066 6c6f 6174  .        ``float
+00026670: 3634 6060 3a0a 0a20 2020 2020 2020 203e  64``:..        >
+00026680: 3e3e 2072 6573 203d 2064 732e 6170 706c  >> res = ds.appl
+00026690: 7928 6d79 6164 642c 2061 7267 733d 2832  y(myadd, args=(2
+000266a0: 2c29 2c20 623d 312e 352c 206d 6574 613d  ,), b=1.5, meta=
+000266b0: 2827 7827 2c20 2766 3827 2929 0a0a 2020  ('x', 'f8'))..  
+000266c0: 2020 2020 2020 496e 2074 6865 2063 6173        In the cas
+000266d0: 6520 7768 6572 6520 7468 6520 6d65 7461  e where the meta
+000266e0: 6461 7461 2064 6f65 736e 2774 2063 6861  data doesn't cha
+000266f0: 6e67 652c 2079 6f75 2063 616e 2061 6c73  nge, you can als
+00026700: 6f20 7061 7373 2069 6e0a 2020 2020 2020  o pass in.      
+00026710: 2020 7468 6520 6f62 6a65 6374 2069 7473    the object its
+00026720: 656c 6620 6469 7265 6374 6c79 3a0a 0a20  elf directly:.. 
+00026730: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
+00026740: 2064 732e 6170 706c 7928 6c61 6d62 6461   ds.apply(lambda
+00026750: 2078 3a20 7820 2b20 312c 206d 6574 613d   x: x + 1, meta=
+00026760: 6473 290a 0a20 2020 2020 2020 2053 6565  ds)..        See
+00026770: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
+00026780: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
+00026790: 6173 6b2e 5365 7269 6573 2e6d 6170 5f70  ask.Series.map_p
+000267a0: 6172 7469 7469 6f6e 730a 2020 2020 2020  artitions.      
+000267b0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+000267c0: 2063 6f6e 7665 7274 5f64 7479 7065 2069   convert_dtype i
+000267d0: 7320 6e6f 7420 6e6f 5f64 6566 6175 6c74  s not no_default
+000267e0: 3a0a 2020 2020 2020 2020 2020 2020 6b77  :.            kw
+000267f0: 6473 5b22 636f 6e76 6572 745f 6474 7970  ds["convert_dtyp
+00026800: 6522 5d20 3d20 636f 6e76 6572 745f 6474  e"] = convert_dt
+00026810: 7970 650a 0a20 2020 2020 2020 2023 206c  ype..        # l
+00026820: 6574 2070 616e 6461 7320 7472 6967 6765  et pandas trigge
+00026830: 7220 616e 7920 7761 726e 696e 6773 2c20  r any warnings, 
+00026840: 7375 6368 2061 7320 636f 6e76 6572 745f  such as convert_
+00026850: 6474 7970 6520 7761 726e 696e 670a 2020  dtype warning.  
+00026860: 2020 2020 2020 7365 6c66 2e5f 6d65 7461        self._meta
+00026870: 2e61 7070 6c79 2866 756e 632c 2061 7267  .apply(func, arg
+00026880: 733d 6172 6773 2c20 2a2a 6b77 6473 290a  s=args, **kwds).
+00026890: 0a20 2020 2020 2020 2069 6620 6d65 7461  .        if meta
+000268a0: 2069 7320 6e6f 5f64 6566 6175 6c74 3a0a   is no_default:.
+000268b0: 2020 2020 2020 2020 2020 2020 7769 7468              with
+000268c0: 2063 6865 636b 5f63 6f6e 7665 7274 5f64   check_convert_d
+000268d0: 7479 7065 5f64 6570 7265 6361 7469 6f6e  type_deprecation
+000268e0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+000268f0: 2020 2020 6d65 7461 203d 205f 656d 756c      meta = _emul
+00026900: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
+00026910: 2020 2020 2020 2020 204d 2e61 7070 6c79           M.apply
+00026920: 2c20 7365 6c66 2e5f 6d65 7461 5f6e 6f6e  , self._meta_non
+00026930: 656d 7074 792c 2066 756e 632c 2061 7267  empty, func, arg
+00026940: 733d 6172 6773 2c20 7564 663d 5472 7565  s=args, udf=True
+00026950: 2c20 2a2a 6b77 6473 0a20 2020 2020 2020  , **kwds.       
+00026960: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00026970: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+00026980: 7761 726e 286d 6574 615f 7761 726e 696e  warn(meta_warnin
+00026990: 6728 6d65 7461 2929 0a20 2020 2020 2020  g(meta)).       
+000269a0: 2065 6c69 6620 5041 4e44 4153 5f47 545f   elif PANDAS_GT_
+000269b0: 3231 303a 0a20 2020 2020 2020 2020 2020  210:.           
+000269c0: 2074 6573 745f 6d65 7461 203d 206d 616b   test_meta = mak
+000269d0: 655f 6d65 7461 286d 6574 6129 0a20 2020  e_meta(meta).   
+000269e0: 2020 2020 2020 2020 2069 6620 6973 5f64           if is_d
+000269f0: 6174 6166 7261 6d65 5f6c 696b 6528 7465  ataframe_like(te
+00026a00: 7374 5f6d 6574 6129 3a0a 2020 2020 2020  st_meta):.      
+00026a10: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+00026a20: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+00026a30: 2020 2020 2020 2020 2020 2020 2022 5265               "Re
+00026a40: 7475 726e 696e 6720 6120 4461 7461 4672  turning a DataFr
+00026a50: 616d 6520 6672 6f6d 2053 6572 6965 732e  ame from Series.
+00026a60: 6170 706c 7920 7768 656e 2074 6865 2073  apply when the s
+00026a70: 7570 706c 6965 6420 6675 6e63 7469 6f6e  upplied function
+00026a80: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+00026a90: 2020 2020 2020 2022 7265 7475 726e 7320         "returns 
+00026aa0: 6120 5365 7269 6573 2069 7320 6465 7072  a Series is depr
+00026ab0: 6563 6174 6564 2061 6e64 2077 696c 6c20  ecated and will 
+00026ac0: 6265 2072 656d 6f76 6564 2069 6e20 6120  be removed in a 
+00026ad0: 6675 7475 7265 2076 6572 7369 6f6e 2e22  future version."
+00026ae0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00026af0: 2020 2020 2020 4675 7475 7265 5761 726e        FutureWarn
+00026b00: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
+00026b10: 2020 2020 2020 2020 2073 7461 636b 6c65           stackle
+00026b20: 7665 6c3d 322c 0a20 2020 2020 2020 2020  vel=2,.         
+00026b30: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00026b40: 2020 7265 7475 726e 206d 6170 5f70 6172    return map_par
+00026b50: 7469 7469 6f6e 7328 6d65 7468 6f64 732e  titions(methods.
+00026b60: 6170 706c 792c 2073 656c 662c 2066 756e  apply, self, fun
+00026b70: 632c 2061 7267 733d 6172 6773 2c20 6d65  c, args=args, me
+00026b80: 7461 3d6d 6574 612c 202a 2a6b 7764 7329  ta=meta, **kwds)
+00026b90: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00026ba0: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00026bb0: 2020 2064 6566 2063 6f76 2873 656c 662c     def cov(self,
+00026bc0: 206f 7468 6572 2c20 6d69 6e5f 7065 7269   other, min_peri
+00026bd0: 6f64 733d 4e6f 6e65 2c20 7370 6c69 745f  ods=None, split_
+00026be0: 6576 6572 793d 4661 6c73 6529 3a0a 2020  every=False):.  
+00026bf0: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+00026c00: 6461 7461 6672 616d 652e 6d75 6c74 6920  dataframe.multi 
+00026c10: 696d 706f 7274 2063 6f6e 6361 740a 0a20  import concat.. 
+00026c20: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00026c30: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
+00026c40: 5365 7269 6573 293a 0a20 2020 2020 2020  Series):.       
+00026c50: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00026c60: 7272 6f72 2822 6f74 6865 7220 6d75 7374  rror("other must
+00026c70: 2062 6520 6120 6461 736b 2e64 6174 6166   be a dask.dataf
+00026c80: 7261 6d65 2e53 6572 6965 7322 290a 2020  rame.Series").  
+00026c90: 2020 2020 2020 6466 203d 2063 6f6e 6361        df = conca
+00026ca0: 7428 5b73 656c 662c 206f 7468 6572 5d2c  t([self, other],
+00026cb0: 2061 7869 733d 3129 0a20 2020 2020 2020   axis=1).       
+00026cc0: 2072 6574 7572 6e20 5f63 6f76 5f63 6f72   return _cov_cor
+00026cd0: 7228 0a20 2020 2020 2020 2020 2020 2064  r(.            d
+00026ce0: 662c 206d 696e 5f70 6572 696f 6473 2c20  f, min_periods, 
+00026cf0: 7363 616c 6172 3d54 7275 652c 206e 756d  scalar=True, num
+00026d00: 6572 6963 5f6f 6e6c 793d 4661 6c73 652c  eric_only=False,
+00026d10: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+00026d20: 6974 5f65 7665 7279 0a20 2020 2020 2020  it_every.       
+00026d30: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
+00026d40: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
+00026d50: 0a20 2020 2064 6566 2063 6f72 7228 7365  .    def corr(se
+00026d60: 6c66 2c20 6f74 6865 722c 206d 6574 686f  lf, other, metho
+00026d70: 643d 2270 6561 7273 6f6e 222c 206d 696e  d="pearson", min
+00026d80: 5f70 6572 696f 6473 3d4e 6f6e 652c 2073  _periods=None, s
+00026d90: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+00026da0: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
+00026db0: 6461 736b 2e64 6174 6166 7261 6d65 2e6d  dask.dataframe.m
+00026dc0: 756c 7469 2069 6d70 6f72 7420 636f 6e63  ulti import conc
+00026dd0: 6174 0a0a 2020 2020 2020 2020 6966 206e  at..        if n
+00026de0: 6f74 2069 7369 6e73 7461 6e63 6528 6f74  ot isinstance(ot
+00026df0: 6865 722c 2053 6572 6965 7329 3a0a 2020  her, Series):.  
+00026e00: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00026e10: 5479 7065 4572 726f 7228 226f 7468 6572  TypeError("other
+00026e20: 206d 7573 7420 6265 2061 2064 6173 6b2e   must be a dask.
+00026e30: 6461 7461 6672 616d 652e 5365 7269 6573  dataframe.Series
+00026e40: 2229 0a20 2020 2020 2020 2069 6620 6d65  ").        if me
+00026e50: 7468 6f64 2021 3d20 2270 6561 7273 6f6e  thod != "pearson
+00026e60: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
+00026e70: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+00026e80: 7465 6445 7272 6f72 2822 4f6e 6c79 2050  tedError("Only P
+00026e90: 6561 7273 6f6e 2063 6f72 7265 6c61 7469  earson correlati
+00026ea0: 6f6e 2068 6173 2062 6565 6e20 696d 706c  on has been impl
+00026eb0: 656d 656e 7465 6422 290a 2020 2020 2020  emented").      
+00026ec0: 2020 6466 203d 2063 6f6e 6361 7428 5b73    df = concat([s
+00026ed0: 656c 662c 206f 7468 6572 5d2c 2061 7869  elf, other], axi
+00026ee0: 733d 3129 0a20 2020 2020 2020 2072 6574  s=1).        ret
+00026ef0: 7572 6e20 5f63 6f76 5f63 6f72 7228 0a20  urn _cov_corr(. 
+00026f00: 2020 2020 2020 2020 2020 2064 662c 0a20             df,. 
+00026f10: 2020 2020 2020 2020 2020 206d 696e 5f70             min_p
+00026f20: 6572 696f 6473 2c0a 2020 2020 2020 2020  eriods,.        
+00026f30: 2020 2020 636f 7272 3d54 7275 652c 0a20      corr=True,. 
+00026f40: 2020 2020 2020 2020 2020 2073 6361 6c61             scala
+00026f50: 723d 5472 7565 2c0a 2020 2020 2020 2020  r=True,.        
+00026f60: 2020 2020 6e75 6d65 7269 635f 6f6e 6c79      numeric_only
+00026f70: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00026f80: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+00026f90: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
+00026fa0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+00026fb0: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+00026fc0: 6965 7329 0a20 2020 2064 6566 2061 7574  ies).    def aut
+00026fd0: 6f63 6f72 7228 7365 6c66 2c20 6c61 673d  ocorr(self, lag=
+00026fe0: 312c 2073 706c 6974 5f65 7665 7279 3d46  1, split_every=F
+00026ff0: 616c 7365 293a 0a20 2020 2020 2020 2069  alse):.        i
+00027000: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+00027010: 286c 6167 2c20 496e 7465 6772 616c 293a  (lag, Integral):
+00027020: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00027030: 7365 2054 7970 6545 7272 6f72 2822 6c61  se TypeError("la
+00027040: 6720 6d75 7374 2062 6520 616e 2069 6e74  g must be an int
+00027050: 6567 6572 2229 0a20 2020 2020 2020 2072  eger").        r
+00027060: 6574 7572 6e20 7365 6c66 2e63 6f72 7228  eturn self.corr(
+00027070: 7365 6c66 2069 6620 6c61 6720 3d3d 2030  self if lag == 0
+00027080: 2065 6c73 6520 7365 6c66 2e73 6869 6674   else self.shift
+00027090: 286c 6167 292c 2073 706c 6974 5f65 7665  (lag), split_eve
+000270a0: 7279 3d73 706c 6974 5f65 7665 7279 290a  ry=split_every).
+000270b0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+000270c0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
+000270d0: 2020 6465 6620 6d65 6d6f 7279 5f75 7361    def memory_usa
+000270e0: 6765 2873 656c 662c 2069 6e64 6578 3d54  ge(self, index=T
+000270f0: 7275 652c 2064 6565 703d 4661 6c73 6529  rue, deep=False)
+00027100: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00027110: 2073 656c 662e 7265 6475 6374 696f 6e28   self.reduction(
+00027120: 0a20 2020 2020 2020 2020 2020 204d 2e6d  .            M.m
+00027130: 656d 6f72 795f 7573 6167 652c 0a20 2020  emory_usage,.   
+00027140: 2020 2020 2020 2020 204d 2e73 756d 2c0a           M.sum,.
+00027150: 2020 2020 2020 2020 2020 2020 6368 756e              chun
+00027160: 6b5f 6b77 6172 6773 3d7b 2269 6e64 6578  k_kwargs={"index
+00027170: 223a 2069 6e64 6578 2c20 2264 6565 7022  ": index, "deep"
+00027180: 3a20 6465 6570 7d2c 0a20 2020 2020 2020  : deep},.       
+00027190: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+000271a0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+000271b0: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
+000271c0: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
+000271d0: 6d65 6d6f 7279 2d75 7361 6765 222c 0a20  memory-usage",. 
+000271e0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+000271f0: 6620 5f5f 6469 766d 6f64 5f5f 2873 656c  f __divmod__(sel
+00027200: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
+00027210: 2020 2072 6573 3120 3d20 7365 6c66 202f     res1 = self /
+00027220: 2f20 6f74 6865 720a 2020 2020 2020 2020  / other.        
+00027230: 7265 7332 203d 2073 656c 6620 2520 6f74  res2 = self % ot
+00027240: 6865 720a 2020 2020 2020 2020 7265 7475  her.        retu
+00027250: 726e 2072 6573 312c 2072 6573 320a 0a20  rn res1, res2.. 
+00027260: 2020 2064 6566 205f 5f72 6469 766d 6f64     def __rdivmod
+00027270: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
+00027280: 0a20 2020 2020 2020 2072 6573 3120 3d20  .        res1 = 
+00027290: 6f74 6865 7220 2f2f 2073 656c 660a 2020  other // self.  
+000272a0: 2020 2020 2020 7265 7332 203d 206f 7468        res2 = oth
+000272b0: 6572 2025 2073 656c 660a 2020 2020 2020  er % self.      
+000272c0: 2020 7265 7475 726e 2072 6573 312c 2072    return res1, r
+000272d0: 6573 320a 0a20 2020 2069 6620 6e6f 7420  es2..    if not 
+000272e0: 5041 4e44 4153 5f47 545f 3230 303a 0a0a  PANDAS_GT_200:..
+000272f0: 2020 2020 2020 2020 4070 726f 7065 7274          @propert
+00027300: 790a 2020 2020 2020 2020 4064 6572 6976  y.        @deriv
+00027310: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
+00027320: 7329 0a20 2020 2020 2020 2064 6566 2069  s).        def i
+00027330: 735f 6d6f 6e6f 746f 6e69 6328 7365 6c66  s_monotonic(self
+00027340: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00027350: 6620 5041 4e44 4153 5f47 545f 3135 303a  f PANDAS_GT_150:
+00027360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027370: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
+00027380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027390: 2020 2020 2269 735f 6d6f 6e6f 746f 6e69      "is_monotoni
+000273a0: 6320 6973 2064 6570 7265 6361 7465 6420  c is deprecated 
+000273b0: 616e 6420 7769 6c6c 2062 6520 7265 6d6f  and will be remo
+000273c0: 7665 6420 696e 2061 2066 7574 7572 6520  ved in a future 
+000273d0: 7665 7273 696f 6e2e 2022 0a20 2020 2020  version. ".     
+000273e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000273f0: 5573 6520 6973 5f6d 6f6e 6f74 6f6e 6963  Use is_monotonic
+00027400: 5f69 6e63 7265 6173 696e 6720 696e 7374  _increasing inst
+00027410: 6561 642e 222c 0a20 2020 2020 2020 2020  ead.",.         
+00027420: 2020 2020 2020 2020 2020 2046 7574 7572             Futur
+00027430: 6557 6172 6e69 6e67 2c0a 2020 2020 2020  eWarning,.      
+00027440: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00027450: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00027460: 656c 662e 6973 5f6d 6f6e 6f74 6f6e 6963  elf.is_monotonic
+00027470: 5f69 6e63 7265 6173 696e 670a 0a20 2020  _increasing..   
+00027480: 2040 7072 6f70 6572 7479 0a20 2020 2040   @property.    @
+00027490: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+000274a0: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
+000274b0: 6973 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63  is_monotonic_inc
+000274c0: 7265 6173 696e 6728 7365 6c66 293a 0a20  reasing(self):. 
+000274d0: 2020 2020 2020 2072 6574 7572 6e20 6163         return ac
+000274e0: 6128 0a20 2020 2020 2020 2020 2020 2073  a(.            s
+000274f0: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+00027500: 2063 6875 6e6b 3d6d 6574 686f 6473 2e6d   chunk=methods.m
+00027510: 6f6e 6f74 6f6e 6963 5f69 6e63 7265 6173  onotonic_increas
+00027520: 696e 675f 6368 756e 6b2c 0a20 2020 2020  ing_chunk,.     
+00027530: 2020 2020 2020 2063 6f6d 6269 6e65 3d6d         combine=m
+00027540: 6574 686f 6473 2e6d 6f6e 6f74 6f6e 6963  ethods.monotonic
+00027550: 5f69 6e63 7265 6173 696e 675f 636f 6d62  _increasing_comb
+00027560: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
+00027570: 2061 6767 7265 6761 7465 3d6d 6574 686f   aggregate=metho
+00027580: 6473 2e6d 6f6e 6f74 6f6e 6963 5f69 6e63  ds.monotonic_inc
+00027590: 7265 6173 696e 675f 6167 6772 6567 6174  reasing_aggregat
+000275a0: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
+000275b0: 6574 613d 626f 6f6c 2c0a 2020 2020 2020  eta=bool,.      
+000275c0: 2020 2020 2020 746f 6b65 6e3d 226d 6f6e        token="mon
+000275d0: 6f74 6f6e 6963 5f69 6e63 7265 6173 696e  otonic_increasin
+000275e0: 6722 2c0a 2020 2020 2020 2020 290a 0a20  g",.        ).. 
+000275f0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00027600: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00027610: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
+00027620: 6620 6973 5f6d 6f6e 6f74 6f6e 6963 5f64  f is_monotonic_d
+00027630: 6563 7265 6173 696e 6728 7365 6c66 293a  ecreasing(self):
+00027640: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00027650: 6163 6128 0a20 2020 2020 2020 2020 2020  aca(.           
+00027660: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
+00027670: 2020 2063 6875 6e6b 3d6d 6574 686f 6473     chunk=methods
+00027680: 2e6d 6f6e 6f74 6f6e 6963 5f64 6563 7265  .monotonic_decre
+00027690: 6173 696e 675f 6368 756e 6b2c 0a20 2020  asing_chunk,.   
+000276a0: 2020 2020 2020 2020 2063 6f6d 6269 6e65           combine
+000276b0: 3d6d 6574 686f 6473 2e6d 6f6e 6f74 6f6e  =methods.monoton
+000276c0: 6963 5f64 6563 7265 6173 696e 675f 636f  ic_decreasing_co
+000276d0: 6d62 696e 652c 0a20 2020 2020 2020 2020  mbine,.         
+000276e0: 2020 2061 6767 7265 6761 7465 3d6d 6574     aggregate=met
+000276f0: 686f 6473 2e6d 6f6e 6f74 6f6e 6963 5f64  hods.monotonic_d
+00027700: 6563 7265 6173 696e 675f 6167 6772 6567  ecreasing_aggreg
+00027710: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+00027720: 206d 6574 613d 626f 6f6c 2c0a 2020 2020   meta=bool,.    
+00027730: 2020 2020 2020 2020 746f 6b65 6e3d 226d          token="m
+00027740: 6f6e 6f74 6f6e 6963 5f64 6563 7265 6173  onotonic_decreas
+00027750: 696e 6722 2c0a 2020 2020 2020 2020 290a  ing",.        ).
+00027760: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00027770: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
+00027780: 2020 6465 6620 7669 6577 2873 656c 662c    def view(self,
+00027790: 2064 7479 7065 293a 0a20 2020 2020 2020   dtype):.       
+000277a0: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+000277b0: 7461 2e76 6965 7728 6474 7970 6529 0a20  ta.view(dtype). 
+000277c0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000277d0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+000277e0: 7328 4d2e 7669 6577 2c20 6474 7970 652c  s(M.view, dtype,
+000277f0: 206d 6574 613d 6d65 7461 290a 0a0a 636c   meta=meta)...cl
+00027800: 6173 7320 496e 6465 7828 5365 7269 6573  ass Index(Series
+00027810: 293a 0a20 2020 205f 7061 7274 6974 696f  ):.    _partitio
+00027820: 6e5f 7479 7065 203d 2070 642e 496e 6465  n_type = pd.Inde
+00027830: 780a 2020 2020 5f69 735f 7061 7274 6974  x.    _is_partit
+00027840: 696f 6e5f 7479 7065 203d 2073 7461 7469  ion_type = stati
+00027850: 636d 6574 686f 6428 6973 5f69 6e64 6578  cmethod(is_index
+00027860: 5f6c 696b 6529 0a20 2020 205f 746f 6b65  _like).    _toke
+00027870: 6e5f 7072 6566 6978 203d 2022 696e 6465  n_prefix = "inde
+00027880: 782d 220a 2020 2020 5f61 6363 6573 736f  x-".    _accesso
+00027890: 7273 3a20 436c 6173 7356 6172 5b73 6574  rs: ClassVar[set
+000278a0: 5b73 7472 5d5d 203d 2073 6574 2829 0a0a  [str]] = set()..
+000278b0: 2020 2020 5f64 745f 6174 7472 6962 7574      _dt_attribut
+000278c0: 6573 203d 207b 0a20 2020 2020 2020 2022  es = {.        "
+000278d0: 6e61 6e6f 7365 636f 6e64 222c 0a20 2020  nanosecond",.   
+000278e0: 2020 2020 2022 6d69 6372 6f73 6563 6f6e       "microsecon
+000278f0: 6422 2c0a 2020 2020 2020 2020 226d 696c  d",.        "mil
+00027900: 6c69 7365 636f 6e64 222c 0a20 2020 2020  lisecond",.     
+00027910: 2020 2022 6461 796f 6679 6561 7222 2c0a     "dayofyear",.
+00027920: 2020 2020 2020 2020 226d 696e 7574 6522          "minute"
+00027930: 2c0a 2020 2020 2020 2020 2268 6f75 7222  ,.        "hour"
+00027940: 2c0a 2020 2020 2020 2020 2264 6179 222c  ,.        "day",
+00027950: 0a20 2020 2020 2020 2022 6461 796f 6677  .        "dayofw
+00027960: 6565 6b22 2c0a 2020 2020 2020 2020 2273  eek",.        "s
+00027970: 6563 6f6e 6422 2c0a 2020 2020 2020 2020  econd",.        
+00027980: 2277 6565 6b22 2c0a 2020 2020 2020 2020  "week",.        
+00027990: 2277 6565 6b64 6179 222c 0a20 2020 2020  "weekday",.     
+000279a0: 2020 2022 7765 656b 6f66 7965 6172 222c     "weekofyear",
+000279b0: 0a20 2020 2020 2020 2022 6d6f 6e74 6822  .        "month"
+000279c0: 2c0a 2020 2020 2020 2020 2271 7561 7274  ,.        "quart
+000279d0: 6572 222c 0a20 2020 2020 2020 2022 7965  er",.        "ye
+000279e0: 6172 222c 0a20 2020 207d 0a0a 2020 2020  ar",.    }..    
+000279f0: 5f63 6174 5f61 7474 7269 6275 7465 7320  _cat_attributes 
+00027a00: 3d20 7b0a 2020 2020 2020 2020 226b 6e6f  = {.        "kno
+00027a10: 776e 222c 0a20 2020 2020 2020 2022 6173  wn",.        "as
+00027a20: 5f6b 6e6f 776e 222c 0a20 2020 2020 2020  _known",.       
+00027a30: 2022 6173 5f75 6e6b 6e6f 776e 222c 0a20   "as_unknown",. 
+00027a40: 2020 2020 2020 2022 6164 645f 6361 7465         "add_cate
+00027a50: 676f 7269 6573 222c 0a20 2020 2020 2020  gories",.       
+00027a60: 2022 6361 7465 676f 7269 6573 222c 0a20   "categories",. 
+00027a70: 2020 2020 2020 2022 7265 6d6f 7665 5f63         "remove_c
+00027a80: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
+00027a90: 2020 2020 2272 656f 7264 6572 5f63 6174      "reorder_cat
+00027aa0: 6567 6f72 6965 7322 2c0a 2020 2020 2020  egories",.      
+00027ab0: 2020 2261 735f 6f72 6465 7265 6422 2c0a    "as_ordered",.
+00027ac0: 2020 2020 2020 2020 2263 6f64 6573 222c          "codes",
+00027ad0: 0a20 2020 2020 2020 2022 7265 6d6f 7665  .        "remove
+00027ae0: 5f75 6e75 7365 645f 6361 7465 676f 7269  _unused_categori
+00027af0: 6573 222c 0a20 2020 2020 2020 2022 7365  es",.        "se
+00027b00: 745f 6361 7465 676f 7269 6573 222c 0a20  t_categories",. 
+00027b10: 2020 2020 2020 2022 6173 5f75 6e6f 7264         "as_unord
+00027b20: 6572 6564 222c 0a20 2020 2020 2020 2022  ered",.        "
+00027b30: 6f72 6465 7265 6422 2c0a 2020 2020 2020  ordered",.      
+00027b40: 2020 2272 656e 616d 655f 6361 7465 676f    "rename_catego
+00027b50: 7269 6573 222c 0a20 2020 207d 0a0a 2020  ries",.    }..  
+00027b60: 2020 5f6d 6f6e 6f74 6f6e 6963 5f61 7474    _monotonic_att
+00027b70: 7269 6275 7465 7320 3d20 7b0a 2020 2020  ributes = {.    
+00027b80: 2020 2020 2269 735f 6d6f 6e6f 746f 6e69      "is_monotoni
+00027b90: 6322 2c0a 2020 2020 2020 2020 2269 735f  c",.        "is_
+00027ba0: 6d6f 6e6f 746f 6e69 635f 696e 6372 6561  monotonic_increa
+00027bb0: 7369 6e67 222c 0a20 2020 2020 2020 2022  sing",.        "
+00027bc0: 6973 5f6d 6f6e 6f74 6f6e 6963 5f64 6563  is_monotonic_dec
+00027bd0: 7265 6173 696e 6722 2c0a 2020 2020 7d0a  reasing",.    }.
+00027be0: 0a20 2020 2064 6566 205f 5f67 6574 6174  .    def __getat
+00027bf0: 7472 5f5f 2873 656c 662c 206b 6579 293a  tr__(self, key):
+00027c00: 0a20 2020 2020 2020 2069 6620 280a 2020  .        if (.  
+00027c10: 2020 2020 2020 2020 2020 6973 696e 7374            isinst
+00027c20: 616e 6365 2873 656c 662e 5f6d 6574 612e  ance(self._meta.
+00027c30: 6474 7970 652c 2070 642e 4361 7465 676f  dtype, pd.Catego
+00027c40: 7269 6361 6c44 7479 7065 290a 2020 2020  ricalDtype).    
+00027c50: 2020 2020 2020 2020 616e 6420 6b65 7920          and key 
+00027c60: 696e 2073 656c 662e 5f63 6174 5f61 7474  in self._cat_att
+00027c70: 7269 6275 7465 730a 2020 2020 2020 2020  ributes.        
+00027c80: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00027c90: 6574 7572 6e20 6765 7461 7474 7228 7365  eturn getattr(se
+00027ca0: 6c66 2e63 6174 2c20 6b65 7929 0a20 2020  lf.cat, key).   
+00027cb0: 2020 2020 2065 6c69 6620 6b65 7920 696e       elif key in
+00027cc0: 2073 656c 662e 5f64 745f 6174 7472 6962   self._dt_attrib
+00027cd0: 7574 6573 3a0a 2020 2020 2020 2020 2020  utes:.          
+00027ce0: 2020 7265 7475 726e 2067 6574 6174 7472    return getattr
+00027cf0: 2873 656c 662e 6474 2c20 6b65 7929 0a20  (self.dt, key). 
+00027d00: 2020 2020 2020 2065 6c69 6620 6b65 7920         elif key 
+00027d10: 696e 2073 656c 662e 5f6d 6f6e 6f74 6f6e  in self._monoton
+00027d20: 6963 5f61 7474 7269 6275 7465 733a 0a20  ic_attributes:. 
+00027d30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00027d40: 6e20 6765 7461 7474 7228 7365 6c66 2c20  n getattr(self, 
+00027d50: 6b65 7929 0a20 2020 2020 2020 2072 6169  key).        rai
+00027d60: 7365 2041 7474 7269 6275 7465 4572 726f  se AttributeErro
+00027d70: 7228 2227 496e 6465 7827 206f 626a 6563  r("'Index' objec
+00027d80: 7420 6861 7320 6e6f 2061 7474 7269 6275  t has no attribu
+00027d90: 7465 2025 7222 2025 206b 6579 290a 0a20  te %r" % key).. 
+00027da0: 2020 2064 6566 205f 5f64 6972 5f5f 2873     def __dir__(s
+00027db0: 656c 6629 3a0a 2020 2020 2020 2020 6f75  elf):.        ou
+00027dc0: 7420 3d20 7375 7065 7228 292e 5f5f 6469  t = super().__di
+00027dd0: 725f 5f28 290a 2020 2020 2020 2020 6f75  r__().        ou
+00027de0: 742e 6578 7465 6e64 2873 656c 662e 5f64  t.extend(self._d
+00027df0: 745f 6174 7472 6962 7574 6573 290a 2020  t_attributes).  
+00027e00: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00027e10: 6e63 6528 7365 6c66 2e64 7479 7065 2c20  nce(self.dtype, 
+00027e20: 7064 2e43 6174 6567 6f72 6963 616c 4474  pd.CategoricalDt
+00027e30: 7970 6529 3a0a 2020 2020 2020 2020 2020  ype):.          
+00027e40: 2020 6f75 742e 6578 7465 6e64 2873 656c    out.extend(sel
+00027e50: 662e 5f63 6174 5f61 7474 7269 6275 7465  f._cat_attribute
+00027e60: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
+00027e70: 6e20 6f75 740a 0a20 2020 2023 2054 7970  n out..    # Typ
+00027e80: 696e 673a 2068 7474 7073 3a2f 2f67 6974  ing: https://git
+00027e90: 6875 622e 636f 6d2f 7079 7468 6f6e 2f6d  hub.com/python/m
+00027ea0: 7970 792f 6973 7375 6573 2f34 3132 350a  ypy/issues/4125.
+00027eb0: 2020 2020 4070 726f 7065 7274 7920 2023      @property  #
+00027ec0: 2074 7970 653a 2069 676e 6f72 650a 2020   type: ignore.  
+00027ed0: 2020 6465 6620 696e 6465 7828 7365 6c66    def index(self
+00027ee0: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+00027ef0: 2041 7474 7269 6275 7465 4572 726f 7228   AttributeError(
+00027f00: 0a20 2020 2020 2020 2020 2020 2066 227b  .            f"{
+00027f10: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
+00027f20: 5f6e 616d 655f 5f21 727d 206f 626a 6563  _name__!r} objec
+00027f30: 7420 6861 7320 6e6f 2061 7474 7269 6275  t has no attribu
+00027f40: 7465 2027 696e 6465 7827 220a 2020 2020  te 'index'".    
+00027f50: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
+00027f60: 5f61 7272 6179 5f77 7261 705f 5f28 7365  _array_wrap__(se
+00027f70: 6c66 2c20 6172 7261 792c 2063 6f6e 7465  lf, array, conte
+00027f80: 7874 3d4e 6f6e 6529 3a0a 2020 2020 2020  xt=None):.      
+00027f90: 2020 7265 7475 726e 2070 642e 496e 6465    return pd.Inde
+00027fa0: 7828 6172 7261 792c 206e 616d 653d 7365  x(array, name=se
+00027fb0: 6c66 2e6e 616d 6529 0a0a 2020 2020 6465  lf.name)..    de
+00027fc0: 6620 6865 6164 2873 656c 662c 206e 3d35  f head(self, n=5
+00027fd0: 2c20 636f 6d70 7574 653d 5472 7565 293a  , compute=True):
+00027fe0: 0a20 2020 2020 2020 2022 2222 4669 7273  .        """Firs
+00027ff0: 7420 6e20 6974 656d 7320 6f66 2074 6865  t n items of the
+00028000: 2049 6e64 6578 2e0a 0a20 2020 2020 2020   Index...       
+00028010: 2043 6176 6561 742c 2074 6869 7320 6f6e   Caveat, this on
+00028020: 6c79 2063 6865 636b 7320 7468 6520 6669  ly checks the fi
+00028030: 7273 7420 7061 7274 6974 696f 6e2e 0a20  rst partition.. 
+00028040: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00028050: 2020 206e 616d 6520 3d20 2268 6561 642d     name = "head-
+00028060: 2564 2d25 7322 2025 2028 6e2c 2073 656c  %d-%s" % (n, sel
+00028070: 662e 5f6e 616d 6529 0a20 2020 2020 2020  f._name).       
+00028080: 2064 736b 203d 207b 286e 616d 652c 2030   dsk = {(name, 0
+00028090: 293a 2028 6f70 6572 6174 6f72 2e67 6574  ): (operator.get
+000280a0: 6974 656d 2c20 2873 656c 662e 5f6e 616d  item, (self._nam
+000280b0: 652c 2030 292c 2073 6c69 6365 2830 2c20  e, 0), slice(0, 
+000280c0: 6e29 297d 0a20 2020 2020 2020 2067 7261  n))}.        gra
+000280d0: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+000280e0: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+000280f0: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
+00028100: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
+00028110: 6c66 5d29 0a0a 2020 2020 2020 2020 7265  lf])..        re
+00028120: 7375 6c74 203d 206e 6577 5f64 645f 6f62  sult = new_dd_ob
+00028130: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
+00028140: 2c20 7365 6c66 2e5f 6d65 7461 2c20 7365  , self._meta, se
+00028150: 6c66 2e64 6976 6973 696f 6e73 5b3a 325d  lf.divisions[:2]
+00028160: 290a 0a20 2020 2020 2020 2069 6620 636f  )..        if co
+00028170: 6d70 7574 653a 0a20 2020 2020 2020 2020  mpute:.         
+00028180: 2020 2072 6573 756c 7420 3d20 7265 7375     result = resu
+00028190: 6c74 2e63 6f6d 7075 7465 2829 0a20 2020  lt.compute().   
+000281a0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+000281b0: 6c74 0a0a 2020 2020 4064 6572 6976 6564  lt..    @derived
+000281c0: 5f66 726f 6d28 7064 2e49 6e64 6578 290a  _from(pd.Index).
+000281d0: 2020 2020 6465 6620 6d61 7828 7365 6c66      def max(self
+000281e0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+000281f0: 6c73 6529 3a0a 2020 2020 2020 2020 7265  lse):.        re
+00028200: 7475 726e 2073 656c 662e 7265 6475 6374  turn self.reduct
+00028210: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+00028220: 204d 2e6d 6178 2c0a 2020 2020 2020 2020   M.max,.        
+00028230: 2020 2020 6d65 7461 3d73 656c 662e 5f6d      meta=self._m
+00028240: 6574 615f 6e6f 6e65 6d70 7479 2e6d 6178  eta_nonempty.max
+00028250: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
+00028260: 746f 6b65 6e3d 7365 6c66 2e5f 746f 6b65  token=self._toke
+00028270: 6e5f 7072 6566 6978 202b 2022 6d61 7822  n_prefix + "max"
+00028280: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+00028290: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+000282a0: 6576 6572 792c 0a20 2020 2020 2020 2029  every,.        )
+000282b0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+000282c0: 726f 6d28 7064 2e49 6e64 6578 290a 2020  rom(pd.Index).  
+000282d0: 2020 6465 6620 6d69 6e28 7365 6c66 2c20    def min(self, 
+000282e0: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+000282f0: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
+00028300: 726e 2073 656c 662e 7265 6475 6374 696f  rn self.reductio
+00028310: 6e28 0a20 2020 2020 2020 2020 2020 204d  n(.            M
+00028320: 2e6d 696e 2c0a 2020 2020 2020 2020 2020  .min,.          
+00028330: 2020 6d65 7461 3d73 656c 662e 5f6d 6574    meta=self._met
+00028340: 615f 6e6f 6e65 6d70 7479 2e6d 696e 2829  a_nonempty.min()
+00028350: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
+00028360: 6b65 6e3d 7365 6c66 2e5f 746f 6b65 6e5f  ken=self._token_
+00028370: 7072 6566 6978 202b 2022 6d69 6e22 2c0a  prefix + "min",.
+00028380: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+00028390: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+000283a0: 6572 792c 0a20 2020 2020 2020 2029 0a0a  ery,.        )..
+000283b0: 2020 2020 6465 6620 636f 756e 7428 7365      def count(se
+000283c0: 6c66 2c20 7370 6c69 745f 6576 6572 793d  lf, split_every=
+000283d0: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+000283e0: 7265 7475 726e 2073 656c 662e 7265 6475  return self.redu
+000283f0: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+00028400: 2020 206d 6574 686f 6473 2e69 6e64 6578     methods.index
+00028410: 5f63 6f75 6e74 2c0a 2020 2020 2020 2020  _count,.        
+00028420: 2020 2020 6e70 2e73 756d 2c0a 2020 2020      np.sum,.    
+00028430: 2020 2020 2020 2020 746f 6b65 6e3d 2269          token="i
+00028440: 6e64 6578 2d63 6f75 6e74 222c 0a20 2020  ndex-count",.   
+00028450: 2020 2020 2020 2020 206d 6574 613d 696e           meta=in
+00028460: 742c 0a20 2020 2020 2020 2020 2020 2073  t,.            s
+00028470: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+00028480: 5f65 7665 7279 2c0a 2020 2020 2020 2020  _every,.        
+00028490: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+000284a0: 6672 6f6d 2870 642e 496e 6465 7829 0a20  from(pd.Index). 
+000284b0: 2020 2064 6566 2073 6869 6674 2873 656c     def shift(sel
+000284c0: 662c 2070 6572 696f 6473 3d31 2c20 6672  f, periods=1, fr
+000284d0: 6571 3d4e 6f6e 6529 3a0a 2020 2020 2020  eq=None):.      
+000284e0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+000284f0: 7365 6c66 2e5f 6d65 7461 2c20 7064 2e50  self._meta, pd.P
+00028500: 6572 696f 6449 6e64 6578 293a 0a20 2020  eriodIndex):.   
+00028510: 2020 2020 2020 2020 2069 6620 6672 6571           if freq
+00028520: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00028530: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00028540: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00028550: 5065 7269 6f64 496e 6465 7820 646f 6573  PeriodIndex does
+00028560: 6e27 7420 6163 6365 7074 2060 6672 6571  n't accept `freq
+00028570: 6020 6172 6775 6d65 6e74 2229 0a20 2020  ` argument").   
+00028580: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
+00028590: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
+000285a0: 7074 792e 7368 6966 7428 7065 7269 6f64  pty.shift(period
+000285b0: 7329 0a20 2020 2020 2020 2020 2020 206f  s).            o
+000285c0: 7574 203d 2073 656c 662e 6d61 705f 7061  ut = self.map_pa
+000285d0: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+000285e0: 2020 2020 2020 2020 2020 4d2e 7368 6966            M.shif
+000285f0: 742c 2070 6572 696f 6473 2c20 6d65 7461  t, periods, meta
+00028600: 3d6d 6574 612c 2074 6f6b 656e 3d22 7368  =meta, token="sh
+00028610: 6966 7422 2c20 7472 616e 7366 6f72 6d5f  ift", transform_
+00028620: 6469 7669 7369 6f6e 733d 4661 6c73 650a  divisions=False.
+00028630: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00028640: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00028650: 2020 2020 2020 2020 2320 5061 6e64 6173          # Pandas
+00028660: 2077 696c 6c20 7261 6973 6520 666f 7220   will raise for 
+00028670: 6f74 6865 7220 696e 6465 7820 7479 7065  other index type
+00028680: 7320 7468 6174 2064 6f6e 2774 2069 6d70  s that don't imp
+00028690: 6c65 6d65 6e74 2073 6869 6674 0a20 2020  lement shift.   
+000286a0: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
+000286b0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
+000286c0: 7074 792e 7368 6966 7428 7065 7269 6f64  pty.shift(period
+000286d0: 732c 2066 7265 713d 6672 6571 290a 2020  s, freq=freq).  
+000286e0: 2020 2020 2020 2020 2020 6f75 7420 3d20            out = 
+000286f0: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
+00028700: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+00028710: 2020 2020 204d 2e73 6869 6674 2c0a 2020       M.shift,.  
+00028720: 2020 2020 2020 2020 2020 2020 2020 7065                pe
+00028730: 7269 6f64 732c 0a20 2020 2020 2020 2020  riods,.         
+00028740: 2020 2020 2020 2074 6f6b 656e 3d22 7368         token="sh
+00028750: 6966 7422 2c0a 2020 2020 2020 2020 2020  ift",.          
+00028760: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
+00028770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028780: 2066 7265 713d 6672 6571 2c0a 2020 2020   freq=freq,.    
+00028790: 2020 2020 2020 2020 2020 2020 7472 616e              tran
+000287a0: 7366 6f72 6d5f 6469 7669 7369 6f6e 733d  sform_divisions=
+000287b0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+000287c0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+000287d0: 6672 6571 2069 7320 4e6f 6e65 3a0a 2020  freq is None:.  
+000287e0: 2020 2020 2020 2020 2020 6672 6571 203d            freq =
+000287f0: 206d 6574 612e 6672 6571 0a20 2020 2020   meta.freq.     
+00028800: 2020 2072 6574 7572 6e20 6d61 7962 655f     return maybe_
+00028810: 7368 6966 745f 6469 7669 7369 6f6e 7328  shift_divisions(
+00028820: 6f75 742c 2070 6572 696f 6473 2c20 6672  out, periods, fr
+00028830: 6571 3d66 7265 7129 0a0a 2020 2020 4064  eq=freq)..    @d
+00028840: 6572 6976 6564 5f66 726f 6d28 7064 2e49  erived_from(pd.I
+00028850: 6e64 6578 290a 2020 2020 6465 6620 746f  ndex).    def to
+00028860: 5f73 6572 6965 7328 7365 6c66 293a 0a20  _series(self):. 
+00028870: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00028880: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00028890: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
+000288a0: 2e74 6f5f 7365 7269 6573 2c0a 2020 2020  .to_series,.    
+000288b0: 2020 2020 2020 2020 6d65 7461 3d73 656c          meta=sel
+000288c0: 662e 5f6d 6574 612e 746f 5f73 6572 6965  f._meta.to_serie
+000288d0: 7328 292c 0a20 2020 2020 2020 2020 2020  s(),.           
+000288e0: 2074 7261 6e73 666f 726d 5f64 6976 6973   transform_divis
+000288f0: 696f 6e73 3d46 616c 7365 2c0a 2020 2020  ions=False,.    
+00028900: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
+00028910: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
+00028920: 782c 2075 615f 6172 6773 3d5b 2269 6e64  x, ua_args=["ind
+00028930: 6578 225d 290a 2020 2020 6465 6620 746f  ex"]).    def to
+00028940: 5f66 7261 6d65 2873 656c 662c 2069 6e64  _frame(self, ind
+00028950: 6578 3d54 7275 652c 206e 616d 653d 4e6f  ex=True, name=No
+00028960: 6e65 293a 0a20 2020 2020 2020 2069 6620  ne):.        if 
+00028970: 6e6f 7420 696e 6465 783a 0a20 2020 2020  not index:.     
+00028980: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00028990: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+000289a0: 2829 0a20 2020 2020 2020 2061 7267 7320  ().        args 
+000289b0: 3d20 5b69 6e64 6578 5d20 6966 206e 616d  = [index] if nam
+000289c0: 6520 6973 204e 6f6e 6520 656c 7365 205b  e is None else [
+000289d0: 696e 6465 782c 206e 616d 655d 0a0a 2020  index, name]..  
+000289e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000289f0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+00028a00: 280a 2020 2020 2020 2020 2020 2020 4d2e  (.            M.
+00028a10: 746f 5f66 7261 6d65 2c0a 2020 2020 2020  to_frame,.      
+00028a20: 2020 2020 2020 2a61 7267 732c 0a20 2020        *args,.   
+00028a30: 2020 2020 2020 2020 206d 6574 613d 7365           meta=se
+00028a40: 6c66 2e5f 6d65 7461 2e74 6f5f 6672 616d  lf._meta.to_fram
+00028a50: 6528 2a61 7267 7329 2c0a 2020 2020 2020  e(*args),.      
+00028a60: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
+00028a70: 6469 7669 7369 6f6e 733d 4661 6c73 652c  divisions=False,
+00028a80: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00028a90: 4069 6e73 6572 745f 6d65 7461 5f70 6172  @insert_meta_par
+00028aa0: 616d 5f64 6573 6372 6970 7469 6f6e 2870  am_description(p
+00028ab0: 6164 3d31 3229 0a20 2020 2040 6465 7269  ad=12).    @deri
+00028ac0: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
+00028ad0: 7829 0a20 2020 2064 6566 206d 6170 2873  x).    def map(s
+00028ae0: 656c 662c 2061 7267 2c20 6e61 5f61 6374  elf, arg, na_act
+00028af0: 696f 6e3d 4e6f 6e65 2c20 6d65 7461 3d6e  ion=None, meta=n
+00028b00: 6f5f 6465 6661 756c 742c 2069 735f 6d6f  o_default, is_mo
+00028b10: 6e6f 746f 6e69 633d 4661 6c73 6529 3a0a  notonic=False):.
+00028b20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00028b30: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
+00028b40: 6973 206d 6574 686f 6420 636c 6561 7273  is method clears
+00028b50: 2061 6e79 206b 6e6f 776e 2064 6976 6973   any known divis
+00028b60: 696f 6e73 2e0a 0a20 2020 2020 2020 2049  ions...        I
+00028b70: 6620 796f 7572 206d 6170 7069 6e67 2066  f your mapping f
+00028b80: 756e 6374 696f 6e20 6973 206d 6f6e 6f74  unction is monot
+00028b90: 6f6e 6963 616c 6c79 2069 6e63 7265 6173  onically increas
+00028ba0: 696e 6720 7468 656e 2075 7365 2060 6973  ing then use `is
+00028bb0: 5f6d 6f6e 6f74 6f6e 6963 600a 2020 2020  _monotonic`.    
+00028bc0: 2020 2020 746f 2061 7070 6c79 2074 6865      to apply the
+00028bd0: 206d 6170 696e 6720 6675 6e63 7469 6f6e   maping function
+00028be0: 2074 6f20 7468 6520 6f6c 6420 6469 7669   to the old divi
+00028bf0: 7369 6f6e 7320 616e 6420 6173 7369 676e  sions and assign
+00028c00: 2074 6865 206e 6577 0a20 2020 2020 2020   the new.       
+00028c10: 2064 6976 6973 696f 6e73 2074 6f20 7468   divisions to th
+00028c20: 6520 6f75 7470 7574 2e0a 0a20 2020 2020  e output...     
+00028c30: 2020 2022 2222 0a20 2020 2020 2020 2061     """.        a
+00028c40: 7070 6c69 6564 203d 2073 7570 6572 2829  pplied = super()
+00028c50: 2e6d 6170 2861 7267 2c20 6e61 5f61 6374  .map(arg, na_act
+00028c60: 696f 6e3d 6e61 5f61 6374 696f 6e2c 206d  ion=na_action, m
+00028c70: 6574 613d 6d65 7461 290a 2020 2020 2020  eta=meta).      
+00028c80: 2020 6966 2069 735f 6d6f 6e6f 746f 6e69    if is_monotoni
+00028c90: 6320 616e 6420 7365 6c66 2e6b 6e6f 776e  c and self.known
+00028ca0: 5f64 6976 6973 696f 6e73 3a0a 2020 2020  _divisions:.    
+00028cb0: 2020 2020 2020 2020 6170 706c 6965 642e          applied.
+00028cc0: 6469 7669 7369 6f6e 7320 3d20 7475 706c  divisions = tupl
+00028cd0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00028ce0: 2020 2070 642e 5365 7269 6573 2873 656c     pd.Series(sel
+00028cf0: 662e 6469 7669 7369 6f6e 7329 2e6d 6170  f.divisions).map
+00028d00: 2861 7267 2c20 6e61 5f61 6374 696f 6e3d  (arg, na_action=
+00028d10: 6e61 5f61 6374 696f 6e29 0a20 2020 2020  na_action).     
+00028d20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00028d30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00028d40: 2020 2061 7070 6c69 6564 203d 2061 7070     applied = app
+00028d50: 6c69 6564 2e63 6c65 6172 5f64 6976 6973  lied.clear_divis
+00028d60: 696f 6e73 2829 0a20 2020 2020 2020 2072  ions().        r
+00028d70: 6574 7572 6e20 6170 706c 6965 640a 0a20  eturn applied.. 
+00028d80: 2020 2069 6620 6e6f 7420 5041 4e44 4153     if not PANDAS
+00028d90: 5f47 545f 3230 303a 0a0a 2020 2020 2020  _GT_200:..      
+00028da0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00028db0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00028dc0: 6d28 7064 2e49 6e64 6578 290a 2020 2020  m(pd.Index).    
+00028dd0: 2020 2020 6465 6620 6973 5f6d 6f6e 6f74      def is_monot
+00028de0: 6f6e 6963 2873 656c 6629 3a0a 2020 2020  onic(self):.    
+00028df0: 2020 2020 2020 2020 6966 2050 414e 4441          if PANDA
+00028e00: 535f 4754 5f31 3530 3a0a 2020 2020 2020  S_GT_150:.      
+00028e10: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+00028e20: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+00028e30: 2020 2020 2020 2020 2020 2020 2022 6973               "is
+00028e40: 5f6d 6f6e 6f74 6f6e 6963 2069 7320 6465  _monotonic is de
+00028e50: 7072 6563 6174 6564 2061 6e64 2077 696c  precated and wil
+00028e60: 6c20 6265 2072 656d 6f76 6564 2069 6e20  l be removed in 
+00028e70: 6120 6675 7475 7265 2076 6572 7369 6f6e  a future version
+00028e80: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
+00028e90: 2020 2020 2020 2020 2255 7365 2069 735f          "Use is_
+00028ea0: 6d6f 6e6f 746f 6e69 635f 696e 6372 6561  monotonic_increa
+00028eb0: 7369 6e67 2069 6e73 7465 6164 2e22 2c0a  sing instead.",.
+00028ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ed0: 2020 2020 4675 7475 7265 5761 726e 696e      FutureWarnin
+00028ee0: 672c 0a20 2020 2020 2020 2020 2020 2020  g,.             
+00028ef0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00028f00: 2072 6574 7572 6e20 7375 7065 7228 292e   return super().
+00028f10: 6973 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63  is_monotonic_inc
+00028f20: 7265 6173 696e 670a 0a20 2020 2040 7072  reasing..    @pr
+00028f30: 6f70 6572 7479 0a20 2020 2040 6465 7269  operty.    @deri
+00028f40: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
+00028f50: 7829 0a20 2020 2064 6566 2069 735f 6d6f  x).    def is_mo
+00028f60: 6e6f 746f 6e69 635f 696e 6372 6561 7369  notonic_increasi
+00028f70: 6e67 2873 656c 6629 3a0a 2020 2020 2020  ng(self):.      
+00028f80: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
+00028f90: 2e69 735f 6d6f 6e6f 746f 6e69 635f 696e  .is_monotonic_in
+00028fa0: 6372 6561 7369 6e67 0a0a 2020 2020 4070  creasing..    @p
+00028fb0: 726f 7065 7274 790a 2020 2020 4064 6572  roperty.    @der
+00028fc0: 6976 6564 5f66 726f 6d28 7064 2e49 6e64  ived_from(pd.Ind
+00028fd0: 6578 290a 2020 2020 6465 6620 6973 5f6d  ex).    def is_m
+00028fe0: 6f6e 6f74 6f6e 6963 5f64 6563 7265 6173  onotonic_decreas
+00028ff0: 696e 6728 7365 6c66 293a 0a20 2020 2020  ing(self):.     
+00029000: 2020 2072 6574 7572 6e20 7375 7065 7228     return super(
+00029010: 292e 6973 5f6d 6f6e 6f74 6f6e 6963 5f64  ).is_monotonic_d
+00029020: 6563 7265 6173 696e 670a 0a20 2020 2040  ecreasing..    @
+00029030: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00029040: 496e 6465 7829 0a20 2020 2064 6566 206d  Index).    def m
+00029050: 656d 6f72 795f 7573 6167 6528 7365 6c66  emory_usage(self
+00029060: 2c20 6465 6570 3d46 616c 7365 293a 0a20  , deep=False):. 
+00029070: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00029080: 6c66 2e72 6564 7563 7469 6f6e 280a 2020  lf.reduction(.  
+00029090: 2020 2020 2020 2020 2020 4d2e 6d65 6d6f            M.memo
+000290a0: 7279 5f75 7361 6765 2c0a 2020 2020 2020  ry_usage,.      
+000290b0: 2020 2020 2020 4d2e 7375 6d2c 0a20 2020        M.sum,.   
+000290c0: 2020 2020 2020 2020 2063 6875 6e6b 5f6b           chunk_k
+000290d0: 7761 7267 733d 7b22 6465 6570 223a 2064  wargs={"deep": d
+000290e0: 6565 707d 2c0a 2020 2020 2020 2020 2020  eep},.          
+000290f0: 2020 7370 6c69 745f 6576 6572 793d 4661    split_every=Fa
+00029100: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00029110: 2074 6f6b 656e 3d73 656c 662e 5f74 6f6b   token=self._tok
+00029120: 656e 5f70 7265 6669 7820 2b20 226d 656d  en_prefix + "mem
+00029130: 6f72 792d 7573 6167 6522 2c0a 2020 2020  ory-usage",.    
+00029140: 2020 2020 290a 0a0a 636c 6173 7320 4461      )...class Da
+00029150: 7461 4672 616d 6528 5f46 7261 6d65 293a  taFrame(_Frame):
+00029160: 0a20 2020 2022 2222 0a20 2020 2050 6172  .    """.    Par
+00029170: 616c 6c65 6c20 5061 6e64 6173 2044 6174  allel Pandas Dat
+00029180: 6146 7261 6d65 0a0a 2020 2020 446f 206e  aFrame..    Do n
+00029190: 6f74 2075 7365 2074 6869 7320 636c 6173  ot use this clas
+000291a0: 7320 6469 7265 6374 6c79 2e20 2049 6e73  s directly.  Ins
+000291b0: 7465 6164 2075 7365 2066 756e 6374 696f  tead use functio
+000291c0: 6e73 206c 696b 650a 2020 2020 6060 6464  ns like.    ``dd
+000291d0: 2e72 6561 645f 6373 7660 602c 2060 6064  .read_csv``, ``d
+000291e0: 642e 7265 6164 5f70 6172 7175 6574 6060  d.read_parquet``
+000291f0: 2c20 6f72 2060 6064 642e 6672 6f6d 5f70  , or ``dd.from_p
+00029200: 616e 6461 7360 602e 0a0a 2020 2020 5061  andas``...    Pa
+00029210: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+00029220: 2d2d 2d2d 2d2d 2d0a 2020 2020 6473 6b3a  -------.    dsk:
+00029230: 2064 6963 740a 2020 2020 2020 2020 5468   dict.        Th
+00029240: 6520 6461 736b 2067 7261 7068 2074 6f20  e dask graph to 
+00029250: 636f 6d70 7574 6520 7468 6973 2044 6174  compute this Dat
+00029260: 6146 7261 6d65 0a20 2020 206e 616d 653a  aFrame.    name:
+00029270: 2073 7472 0a20 2020 2020 2020 2054 6865   str.        The
+00029280: 206b 6579 2070 7265 6669 7820 7468 6174   key prefix that
+00029290: 2073 7065 6369 6669 6573 2077 6869 6368   specifies which
+000292a0: 206b 6579 7320 696e 2074 6865 2064 6173   keys in the das
+000292b0: 6b20 636f 6d70 7269 7365 2074 6869 730a  k comprise this.
+000292c0: 2020 2020 2020 2020 7061 7274 6963 756c          particul
+000292d0: 6172 2044 6174 6146 7261 6d65 0a20 2020  ar DataFrame.   
+000292e0: 206d 6574 613a 2070 616e 6461 732e 4461   meta: pandas.Da
+000292f0: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
+00029300: 416e 2065 6d70 7479 2060 6070 616e 6461  An empty ``panda
+00029310: 732e 4461 7461 4672 616d 6560 6020 7769  s.DataFrame`` wi
+00029320: 7468 206e 616d 6573 2c20 6474 7970 6573  th names, dtypes
+00029330: 2c20 616e 6420 696e 6465 7820 6d61 7463  , and index matc
+00029340: 6869 6e67 0a20 2020 2020 2020 2074 6865  hing.        the
+00029350: 2065 7870 6563 7465 6420 6f75 7470 7574   expected output
+00029360: 2e0a 2020 2020 6469 7669 7369 6f6e 733a  ..    divisions:
+00029370: 2074 7570 6c65 206f 6620 696e 6465 7820   tuple of index 
+00029380: 7661 6c75 6573 0a20 2020 2020 2020 2056  values.        V
+00029390: 616c 7565 7320 616c 6f6e 6720 7768 6963  alues along whic
+000293a0: 6820 7765 2070 6172 7469 7469 6f6e 206f  h we partition o
+000293b0: 7572 2062 6c6f 636b 7320 6f6e 2074 6865  ur blocks on the
+000293c0: 2069 6e64 6578 0a20 2020 2022 2222 0a0a   index.    """..
+000293d0: 2020 2020 5f70 6172 7469 7469 6f6e 5f74      _partition_t
+000293e0: 7970 6520 3d20 7064 2e44 6174 6146 7261  ype = pd.DataFra
+000293f0: 6d65 0a20 2020 205f 6973 5f70 6172 7469  me.    _is_parti
+00029400: 7469 6f6e 5f74 7970 6520 3d20 7374 6174  tion_type = stat
+00029410: 6963 6d65 7468 6f64 2869 735f 6461 7461  icmethod(is_data
+00029420: 6672 616d 655f 6c69 6b65 290a 2020 2020  frame_like).    
+00029430: 5f74 6f6b 656e 5f70 7265 6669 7820 3d20  _token_prefix = 
+00029440: 2264 6174 6166 7261 6d65 2d22 0a20 2020  "dataframe-".   
+00029450: 205f 6163 6365 7373 6f72 733a 2043 6c61   _accessors: Cla
+00029460: 7373 5661 725b 7365 745b 7374 725d 5d20  ssVar[set[str]] 
+00029470: 3d20 7365 7428 290a 0a20 2020 2064 6566  = set()..    def
+00029480: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00029490: 6473 6b2c 206e 616d 652c 206d 6574 612c  dsk, name, meta,
+000294a0: 2064 6976 6973 696f 6e73 293a 0a20 2020   divisions):.   
+000294b0: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
+000294c0: 6e69 745f 5f28 6473 6b2c 206e 616d 652c  nit__(dsk, name,
+000294d0: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
+000294e0: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
+000294f0: 662e 6461 736b 2e6c 6179 6572 735b 6e61  f.dask.layers[na
+00029500: 6d65 5d2e 636f 6c6c 6563 7469 6f6e 5f61  me].collection_a
+00029510: 6e6e 6f74 6174 696f 6e73 2069 7320 4e6f  nnotations is No
+00029520: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00029530: 7365 6c66 2e64 6173 6b2e 6c61 7965 7273  self.dask.layers
+00029540: 5b6e 616d 655d 2e63 6f6c 6c65 6374 696f  [name].collectio
+00029550: 6e5f 616e 6e6f 7461 7469 6f6e 7320 3d20  n_annotations = 
+00029560: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00029570: 2020 226e 7061 7274 6974 696f 6e73 223a    "npartitions":
+00029580: 2073 656c 662e 6e70 6172 7469 7469 6f6e   self.npartition
+00029590: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+000295a0: 2020 2022 636f 6c75 6d6e 7322 3a20 5b63     "columns": [c
+000295b0: 6f6c 2066 6f72 2063 6f6c 2069 6e20 7365  ol for col in se
+000295c0: 6c66 2e63 6f6c 756d 6e73 5d2c 0a20 2020  lf.columns],.   
+000295d0: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
+000295e0: 7065 223a 2074 7970 656e 616d 6528 7479  pe": typename(ty
+000295f0: 7065 2873 656c 6629 292c 0a20 2020 2020  pe(self)),.     
+00029600: 2020 2020 2020 2020 2020 2022 6461 7461             "data
+00029610: 6672 616d 655f 7479 7065 223a 2074 7970  frame_type": typ
+00029620: 656e 616d 6528 7479 7065 2873 656c 662e  ename(type(self.
+00029630: 5f6d 6574 6129 292c 0a20 2020 2020 2020  _meta)),.       
+00029640: 2020 2020 2020 2020 2022 7365 7269 6573           "series
+00029650: 5f64 7479 7065 7322 3a20 7b0a 2020 2020  _dtypes": {.    
+00029660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029670: 636f 6c3a 2073 656c 662e 5f6d 6574 615b  col: self._meta[
+00029680: 636f 6c5d 2e64 7479 7065 0a20 2020 2020  col].dtype.     
+00029690: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000296a0: 6620 6861 7361 7474 7228 7365 6c66 2e5f  f hasattr(self._
+000296b0: 6d65 7461 5b63 6f6c 5d2c 2022 6474 7970  meta[col], "dtyp
+000296c0: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+000296d0: 2020 2020 2020 2020 656c 7365 204e 6f6e          else Non
+000296e0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+000296f0: 2020 2020 2020 666f 7220 636f 6c20 696e        for col in
+00029700: 2073 656c 662e 5f6d 6574 612e 636f 6c75   self._meta.colu
+00029710: 6d6e 730a 2020 2020 2020 2020 2020 2020  mns.            
+00029720: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+00029730: 2020 207d 0a20 2020 2020 2020 2065 6c73     }.        els
+00029740: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00029750: 656c 662e 6461 736b 2e6c 6179 6572 735b  elf.dask.layers[
+00029760: 6e61 6d65 5d2e 636f 6c6c 6563 7469 6f6e  name].collection
+00029770: 5f61 6e6e 6f74 6174 696f 6e73 2e75 7064  _annotations.upd
+00029780: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
+00029790: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+000297a0: 2020 2020 2020 2020 2020 2022 6e70 6172             "npar
+000297b0: 7469 7469 6f6e 7322 3a20 7365 6c66 2e6e  titions": self.n
+000297c0: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
+000297d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000297e0: 2263 6f6c 756d 6e73 223a 205b 636f 6c20  "columns": [col 
+000297f0: 666f 7220 636f 6c20 696e 2073 656c 662e  for col in self.
+00029800: 636f 6c75 6d6e 735d 2c0a 2020 2020 2020  columns],.      
+00029810: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+00029820: 7970 6522 3a20 7479 7065 6e61 6d65 2874  ype": typename(t
+00029830: 7970 6528 7365 6c66 2929 2c0a 2020 2020  ype(self)),.    
+00029840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029850: 2264 6174 6166 7261 6d65 5f74 7970 6522  "dataframe_type"
+00029860: 3a20 7479 7065 6e61 6d65 2874 7970 6528  : typename(type(
+00029870: 7365 6c66 2e5f 6d65 7461 2929 2c0a 2020  self._meta)),.  
+00029880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029890: 2020 2273 6572 6965 735f 6474 7970 6573    "series_dtypes
+000298a0: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
+000298b0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+000298c0: 3a20 7365 6c66 2e5f 6d65 7461 5b63 6f6c  : self._meta[col
+000298d0: 5d2e 6474 7970 650a 2020 2020 2020 2020  ].dtype.        
+000298e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000298f0: 6966 2068 6173 6174 7472 2873 656c 662e  if hasattr(self.
+00029900: 5f6d 6574 615b 636f 6c5d 2c20 2264 7479  _meta[col], "dty
+00029910: 7065 2229 0a20 2020 2020 2020 2020 2020  pe").           
+00029920: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00029930: 6520 4e6f 6e65 0a20 2020 2020 2020 2020  e None.         
+00029940: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00029950: 6f72 2063 6f6c 2069 6e20 7365 6c66 2e5f  or col in self._
+00029960: 6d65 7461 2e63 6f6c 756d 6e73 0a20 2020  meta.columns.   
+00029970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029980: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+00029990: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+000299a0: 2020 290a 0a20 2020 2064 6566 205f 5f61    )..    def __a
+000299b0: 7272 6179 5f77 7261 705f 5f28 7365 6c66  rray_wrap__(self
+000299c0: 2c20 6172 7261 792c 2063 6f6e 7465 7874  , array, context
+000299d0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+000299e0: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
+000299f0: 6e74 6578 742c 2074 7570 6c65 2920 616e  ntext, tuple) an
+00029a00: 6420 6c65 6e28 636f 6e74 6578 7429 203e  d len(context) >
+00029a10: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00029a20: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
+00029a30: 6e74 6578 745b 315d 5b30 5d2c 206e 702e  ntext[1][0], np.
+00029a40: 6e64 6172 7261 7929 2061 6e64 2063 6f6e  ndarray) and con
+00029a50: 7465 7874 5b31 5d5b 305d 2e73 6861 7065  text[1][0].shape
+00029a60: 203d 3d20 2829 3a0a 2020 2020 2020 2020   == ():.        
+00029a70: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
+00029a80: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+00029a90: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00029aa0: 2020 2020 2020 2069 6e64 6578 203d 2063         index = c
+00029ab0: 6f6e 7465 7874 5b31 5d5b 305d 2e69 6e64  ontext[1][0].ind
+00029ac0: 6578 0a20 2020 2020 2020 2065 6c73 653a  ex.        else:
+00029ad0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
+00029ae0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00029af0: 2020 696d 706f 7274 2069 6e73 7065 6374    import inspect
+00029b00: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029b10: 2020 6d65 7468 6f64 5f6e 616d 6520 3d20    method_name = 
+00029b20: 6622 607b 696e 7370 6563 742e 7374 6163  f"`{inspect.stac
+00029b30: 6b28 295b 335d 5b33 5d7d 6022 0a20 2020  k()[3][3]}`".   
+00029b40: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+00029b50: 496e 6465 7845 7272 6f72 3a0a 2020 2020  IndexError:.    
+00029b60: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
+00029b70: 6f64 5f6e 616d 6520 3d20 2254 6869 7320  od_name = "This 
+00029b80: 6d65 7468 6f64 220a 0a20 2020 2020 2020  method"..       
+00029b90: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00029ba0: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
+00029bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029bc0: 6622 7b6d 6574 686f 645f 6e61 6d65 7d20  f"{method_name} 
+00029bd0: 6973 206e 6f74 2069 6d70 6c65 6d65 6e74  is not implement
+00029be0: 6564 2066 6f72 2060 6461 736b 2e64 6174  ed for `dask.dat
+00029bf0: 6166 7261 6d65 2e44 6174 6146 7261 6d65  aframe.DataFrame
+00029c00: 602e 220a 2020 2020 2020 2020 2020 2020  `.".            
+00029c10: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00029c20: 6e20 6d65 7461 5f66 7261 6d65 5f63 6f6e  n meta_frame_con
+00029c30: 7374 7275 6374 6f72 2873 656c 6629 2861  structor(self)(a
+00029c40: 7272 6179 2c20 696e 6465 783d 696e 6465  rray, index=inde
+00029c50: 782c 2063 6f6c 756d 6e73 3d73 656c 662e  x, columns=self.
+00029c60: 636f 6c75 6d6e 7329 0a0a 2020 2020 4070  columns)..    @p
+00029c70: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00029c80: 6178 6573 2873 656c 6629 3a0a 2020 2020  axes(self):.    
+00029c90: 2020 2020 7265 7475 726e 205b 7365 6c66      return [self
+00029ca0: 2e69 6e64 6578 2c20 7365 6c66 2e63 6f6c  .index, self.col
+00029cb0: 756d 6e73 5d0a 0a20 2020 2040 7072 6f70  umns]..    @prop
+00029cc0: 6572 7479 0a20 2020 2064 6566 2063 6f6c  erty.    def col
+00029cd0: 756d 6e73 2873 656c 6629 3a0a 2020 2020  umns(self):.    
+00029ce0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00029cf0: 5f6d 6574 612e 636f 6c75 6d6e 730a 0a20  _meta.columns.. 
+00029d00: 2020 2040 636f 6c75 6d6e 732e 7365 7474     @columns.sett
+00029d10: 6572 0a20 2020 2064 6566 2063 6f6c 756d  er.    def colum
+00029d20: 6e73 2873 656c 662c 2063 6f6c 756d 6e73  ns(self, columns
+00029d30: 293a 0a20 2020 2020 2020 2072 656e 616d  ):.        renam
+00029d40: 6564 203d 205f 7265 6e61 6d65 5f64 6173  ed = _rename_das
+00029d50: 6b28 7365 6c66 2c20 636f 6c75 6d6e 7329  k(self, columns)
+00029d60: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
+00029d70: 6574 6120 3d20 7265 6e61 6d65 642e 5f6d  eta = renamed._m
+00029d80: 6574 610a 2020 2020 2020 2020 7365 6c66  eta.        self
+00029d90: 2e5f 6e61 6d65 203d 2072 656e 616d 6564  ._name = renamed
+00029da0: 2e5f 6e61 6d65 0a20 2020 2020 2020 2073  ._name.        s
+00029db0: 656c 662e 6461 736b 203d 2072 656e 616d  elf.dask = renam
+00029dc0: 6564 2e64 6173 6b0a 0a20 2020 2040 7072  ed.dask..    @pr
+00029dd0: 6f70 6572 7479 0a20 2020 2064 6566 2069  operty.    def i
+00029de0: 6c6f 6328 7365 6c66 293a 0a20 2020 2020  loc(self):.     
+00029df0: 2020 2022 2222 5075 7265 6c79 2069 6e74     """Purely int
+00029e00: 6567 6572 2d6c 6f63 6174 696f 6e20 6261  eger-location ba
+00029e10: 7365 6420 696e 6465 7869 6e67 2066 6f72  sed indexing for
+00029e20: 2073 656c 6563 7469 6f6e 2062 7920 706f   selection by po
+00029e30: 7369 7469 6f6e 2e0a 0a20 2020 2020 2020  sition...       
+00029e40: 204f 6e6c 7920 696e 6465 7869 6e67 2074   Only indexing t
+00029e50: 6865 2063 6f6c 756d 6e20 706f 7369 7469  he column positi
+00029e60: 6f6e 7320 6973 2073 7570 706f 7274 6564  ons is supported
+00029e70: 2e20 5472 7969 6e67 2074 6f20 7365 6c65  . Trying to sele
+00029e80: 6374 0a20 2020 2020 2020 2072 6f77 2070  ct.        row p
+00029e90: 6f73 6974 696f 6e73 2077 696c 6c20 7261  ositions will ra
+00029ea0: 6973 6520 6120 5661 6c75 6545 7272 6f72  ise a ValueError
+00029eb0: 2e0a 0a20 2020 2020 2020 2053 6565 203a  ...        See :
+00029ec0: 7265 663a 6064 6174 6166 7261 6d65 2e69  ref:`dataframe.i
+00029ed0: 6e64 6578 696e 6760 2066 6f72 206d 6f72  ndexing` for mor
+00029ee0: 652e 0a0a 2020 2020 2020 2020 4578 616d  e...        Exam
+00029ef0: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
+00029f00: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
+00029f10: 3e20 6466 2e69 6c6f 635b 3a2c 205b 322c  > df.iloc[:, [2,
+00029f20: 2030 2c20 315d 5d20 2023 2064 6f63 7465   0, 1]]  # docte
+00029f30: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
+00029f40: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
+00029f50: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+00029f60: 652e 696e 6465 7869 6e67 2069 6d70 6f72  e.indexing impor
+00029f70: 7420 5f69 4c6f 6349 6e64 6578 6572 0a0a  t _iLocIndexer..
+00029f80: 2020 2020 2020 2020 2320 466f 7220 6461          # For da
+00029f90: 7461 6672 616d 6573 2077 6974 6820 756e  taframes with un
+00029fa0: 6971 7565 2063 6f6c 756d 6e20 6e61 6d65  ique column name
+00029fb0: 732c 2074 6869 7320 7769 6c6c 2062 6520  s, this will be 
+00029fc0: 7472 616e 7366 6f72 6d65 6420 696e 746f  transformed into
+00029fd0: 2061 205f 5f67 6574 6974 656d 5f5f 2063   a __getitem__ c
+00029fe0: 616c 6c0a 2020 2020 2020 2020 7265 7475  all.        retu
+00029ff0: 726e 205f 694c 6f63 496e 6465 7865 7228  rn _iLocIndexer(
+0002a000: 7365 6c66 290a 0a20 2020 2064 6566 205f  self)..    def _
+0002a010: 5f6c 656e 5f5f 2873 656c 6629 3a0a 2020  _len__(self):.  
+0002a020: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+0002a030: 2020 2020 2020 2073 203d 2073 656c 662e         s = self.
+0002a040: 696c 6f63 5b3a 2c20 305d 0a20 2020 2020  iloc[:, 0].     
+0002a050: 2020 2065 7863 6570 7420 496e 6465 7845     except IndexE
+0002a060: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+0002a070: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
+0002a080: 2e5f 5f6c 656e 5f5f 2829 0a20 2020 2020  .__len__().     
+0002a090: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002a0a0: 2020 2020 2072 6574 7572 6e20 6c65 6e28       return len(
+0002a0b0: 7329 0a0a 2020 2020 6465 6620 5f5f 636f  s)..    def __co
+0002a0c0: 6e74 6169 6e73 5f5f 2873 656c 662c 206b  ntains__(self, k
+0002a0d0: 6579 293a 0a20 2020 2020 2020 2072 6574  ey):.        ret
+0002a0e0: 7572 6e20 6b65 7920 696e 2073 656c 662e  urn key in self.
+0002a0f0: 5f6d 6574 610a 0a20 2020 2040 7072 6f70  _meta..    @prop
+0002a100: 6572 7479 0a20 2020 2064 6566 2065 6d70  erty.    def emp
+0002a110: 7479 2873 656c 6629 3a0a 2020 2020 2020  ty(self):.      
+0002a120: 2020 2320 5f5f 6765 7461 7474 725f 5f20    # __getattr__ 
+0002a130: 7769 6c6c 2062 6520 6361 6c6c 6564 2061  will be called a
+0002a140: 6674 6572 2077 6520 7261 6973 6520 7468  fter we raise th
+0002a150: 6973 2c20 736f 2077 6527 6c6c 2072 6169  is, so we'll rai
+0002a160: 7365 2069 7420 6167 6169 6e20 6672 6f6d  se it again from
+0002a170: 2074 6865 7265 0a20 2020 2020 2020 2072   there.        r
+0002a180: 6169 7365 2041 7474 7269 6275 7465 4e6f  aise AttributeNo
+0002a190: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+0002a1a0: 7228 0a20 2020 2020 2020 2020 2020 2022  r(.            "
+0002a1b0: 4368 6563 6b69 6e67 2077 6865 7468 6572  Checking whether
+0002a1c0: 2061 2044 6173 6b20 4461 7461 4672 616d   a Dask DataFram
+0002a1d0: 6520 6861 7320 616e 7920 726f 7773 206d  e has any rows m
+0002a1e0: 6179 2062 6520 6578 7065 6e73 6976 652e  ay be expensive.
+0002a1f0: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+0002a200: 486f 7765 7665 722c 2063 6865 636b 696e  However, checkin
+0002a210: 6720 7468 6520 6e75 6d62 6572 206f 6620  g the number of 
+0002a220: 636f 6c75 6d6e 7320 6973 2066 6173 742e  columns is fast.
+0002a230: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+0002a240: 4465 7065 6e64 696e 6720 6f6e 2077 6869  Depending on whi
+0002a250: 6368 206f 6620 7468 6573 6520 7265 7375  ch of these resu
+0002a260: 6c74 7320 796f 7520 6e65 6564 2c20 7573  lts you need, us
+0002a270: 6520 6569 7468 6572 2022 0a20 2020 2020  e either ".     
+0002a280: 2020 2020 2020 2022 606c 656e 2864 662e         "`len(df.
+0002a290: 696e 6465 7829 203d 3d20 3060 206f 7220  index) == 0` or 
+0002a2a0: 606c 656e 2864 662e 636f 6c75 6d6e 7329  `len(df.columns)
+0002a2b0: 203d 3d20 3060 220a 2020 2020 2020 2020   == 0`".        
+0002a2c0: 290a 0a20 2020 2064 6566 205f 5f67 6574  )..    def __get
+0002a2d0: 6974 656d 5f5f 2873 656c 662c 206b 6579  item__(self, key
+0002a2e0: 293a 0a20 2020 2020 2020 206e 616d 6520  ):.        name 
+0002a2f0: 3d20 2267 6574 6974 656d 2d25 7322 2025  = "getitem-%s" %
+0002a300: 2074 6f6b 656e 697a 6528 7365 6c66 2c20   tokenize(self, 
+0002a310: 6b65 7929 0a20 2020 2020 2020 2069 6620  key).        if 
+0002a320: 6e70 2e69 7373 6361 6c61 7228 6b65 7929  np.isscalar(key)
+0002a330: 206f 7220 6973 696e 7374 616e 6365 286b   or isinstance(k
+0002a340: 6579 2c20 2874 7570 6c65 2c20 7374 7229  ey, (tuple, str)
+0002a350: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+0002a360: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
+0002a370: 662e 5f6d 6574 612e 696e 6465 782c 2028  f._meta.index, (
+0002a380: 7064 2e44 6174 6574 696d 6549 6e64 6578  pd.DatetimeIndex
+0002a390: 2c20 7064 2e50 6572 696f 6449 6e64 6578  , pd.PeriodIndex
+0002a3a0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+0002a3b0: 2020 2020 6966 206b 6579 206e 6f74 2069      if key not i
+0002a3c0: 6e20 7365 6c66 2e5f 6d65 7461 2e63 6f6c  n self._meta.col
+0002a3d0: 756d 6e73 3a0a 2020 2020 2020 2020 2020  umns:.          
+0002a3e0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+0002a3f0: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+0002a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a410: 2022 496e 6465 7869 6e67 2061 2044 6174   "Indexing a Dat
+0002a420: 6146 7261 6d65 2077 6974 6820 6120 6461  aFrame with a da
+0002a430: 7465 7469 6d65 6c69 6b65 2069 6e64 6578  tetimelike index
+0002a440: 2075 7369 6e67 2061 2073 696e 676c 6520   using a single 
+0002a450: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0002a460: 2020 2020 2020 2020 2020 2273 7472 696e            "strin
+0002a470: 6720 746f 2073 6c69 6365 2074 6865 2072  g to slice the r
+0002a480: 6f77 732c 206c 696b 6520 6066 7261 6d65  ows, like `frame
+0002a490: 5b73 7472 696e 675d 602c 2069 7320 6465  [string]`, is de
+0002a4a0: 7072 6563 6174 6564 2022 0a20 2020 2020  precated ".     
+0002a4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a4c0: 2020 2022 616e 6420 7769 6c6c 2062 6520     "and will be 
+0002a4d0: 7265 6d6f 7665 6420 696e 2061 2066 7574  removed in a fut
+0002a4e0: 7572 6520 7665 7273 696f 6e2e 2055 7365  ure version. Use
+0002a4f0: 2060 6672 616d 652e 6c6f 635b 7374 7269   `frame.loc[stri
+0002a500: 6e67 5d60 2022 0a20 2020 2020 2020 2020  ng]` ".         
+0002a510: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002a520: 696e 7374 6561 642e 222c 0a20 2020 2020  instead.",.     
+0002a530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a540: 2020 2046 7574 7572 6557 6172 6e69 6e67     FutureWarning
+0002a550: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002a560: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0002a570: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002a580: 726e 2073 656c 662e 6c6f 635b 6b65 795d  rn self.loc[key]
+0002a590: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0002a5a0: 6572 726f 7220 6973 2072 6169 7365 6420  error is raised 
+0002a5b0: 6672 6f6d 2070 616e 6461 730a 2020 2020  from pandas.    
+0002a5c0: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
+0002a5d0: 656c 662e 5f6d 6574 615b 5f65 7874 7261  elf._meta[_extra
+0002a5e0: 6374 5f6d 6574 6128 6b65 7929 5d0a 2020  ct_meta(key)].  
+0002a5f0: 2020 2020 2020 2020 2020 6473 6b20 3d20            dsk = 
+0002a600: 7061 7274 6974 696f 6e77 6973 655f 6772  partitionwise_gr
+0002a610: 6170 6828 6f70 6572 6174 6f72 2e67 6574  aph(operator.get
+0002a620: 6974 656d 2c20 6e61 6d65 2c20 7365 6c66  item, name, self
+0002a630: 2c20 6b65 7929 0a20 2020 2020 2020 2020  , key).         
+0002a640: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+0002a650: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+0002a660: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
+0002a670: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+0002a680: 6573 3d5b 7365 6c66 5d29 0a20 2020 2020  es=[self]).     
+0002a690: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+0002a6a0: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
+0002a6b0: 682c 206e 616d 652c 206d 6574 612c 2073  h, name, meta, s
+0002a6c0: 656c 662e 6469 7669 7369 6f6e 7329 0a20  elf.divisions). 
+0002a6d0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+0002a6e0: 7374 616e 6365 286b 6579 2c20 736c 6963  stance(key, slic
+0002a6f0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0002a700: 6672 6f6d 2070 616e 6461 732e 6170 692e  from pandas.api.
+0002a710: 7479 7065 7320 696d 706f 7274 2069 735f  types import is_
+0002a720: 666c 6f61 745f 6474 7970 650a 0a20 2020  float_dtype..   
+0002a730: 2020 2020 2020 2020 2069 735f 696e 7465           is_inte
+0002a740: 6765 725f 736c 6963 6520 3d20 616e 7928  ger_slice = any(
+0002a750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a760: 2069 7369 6e73 7461 6e63 6528 692c 2049   isinstance(i, I
+0002a770: 6e74 6567 7261 6c29 2066 6f72 2069 2069  ntegral) for i i
+0002a780: 6e20 286b 6579 2e73 7461 7274 2c20 6b65  n (key.start, ke
+0002a790: 792e 7374 6570 2c20 6b65 792e 7374 6f70  y.step, key.stop
+0002a7a0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+0002a7b0: 2020 2020 2020 2020 2020 2020 2320 536c              # Sl
+0002a7c0: 6963 696e 6720 7769 7468 2069 6e74 6567  icing with integ
+0002a7d0: 6572 206c 6162 656c 7320 6973 2061 6c77  er labels is alw
+0002a7e0: 6179 7320 696c 6f63 2062 6173 6564 2065  ays iloc based e
+0002a7f0: 7863 6570 7420 666f 7220 610a 2020 2020  xcept for a.    
+0002a800: 2020 2020 2020 2020 2320 666c 6f61 7420          # float 
+0002a810: 696e 6465 7865 7220 666f 7220 736f 6d65  indexer for some
+0002a820: 2072 6561 736f 6e0a 2020 2020 2020 2020   reason.        
+0002a830: 2020 2020 6966 2069 735f 696e 7465 6765      if is_intege
+0002a840: 725f 736c 6963 6520 616e 6420 6e6f 7420  r_slice and not 
+0002a850: 6973 5f66 6c6f 6174 5f64 7479 7065 2873  is_float_dtype(s
+0002a860: 656c 662e 696e 6465 782e 6474 7970 6529  elf.index.dtype)
+0002a870: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002a880: 2020 2320 4e4f 5445 3a20 7468 6973 2061    # NOTE: this a
+0002a890: 6c77 6179 7320 6661 696c 7320 6375 7272  lways fails curr
+0002a8a0: 656e 746c 792c 2061 7320 696c 6f63 2069  ently, as iloc i
+0002a8b0: 7320 6d6f 7374 6c79 0a20 2020 2020 2020  s mostly.       
+0002a8c0: 2020 2020 2020 2020 2023 2075 6e73 7570           # unsup
+0002a8d0: 706f 7274 6564 2c20 6275 7420 7765 2063  ported, but we c
+0002a8e0: 616c 6c20 6974 2061 6e79 7761 7920 6865  all it anyway he
+0002a8f0: 7265 2066 6f72 2066 7574 7572 652d 7072  re for future-pr
+0002a900: 6f6f 6669 6e67 0a20 2020 2020 2020 2020  oofing.         
+0002a910: 2020 2020 2020 2023 2061 6e64 2065 7272         # and err
+0002a920: 6f72 2d61 7474 7269 6275 7469 6f6e 2070  or-attribution p
+0002a930: 7572 706f 7365 730a 2020 2020 2020 2020  urposes.        
+0002a940: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0002a950: 656c 662e 696c 6f63 5b6b 6579 5d0a 2020  elf.iloc[key].  
+0002a960: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0002a970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a980: 7265 7475 726e 2073 656c 662e 6c6f 635b  return self.loc[
+0002a990: 6b65 795d 0a0a 2020 2020 2020 2020 6966  key]..        if
+0002a9a0: 2069 7369 6e73 7461 6e63 6528 6b65 792c   isinstance(key,
+0002a9b0: 2028 6e70 2e6e 6461 7272 6179 2c20 6c69   (np.ndarray, li
+0002a9c0: 7374 2929 206f 7220 280a 2020 2020 2020  st)) or (.      
+0002a9d0: 2020 2020 2020 6e6f 7420 6973 5f64 6173        not is_das
+0002a9e0: 6b5f 636f 6c6c 6563 7469 6f6e 286b 6579  k_collection(key
+0002a9f0: 2920 616e 6420 2869 735f 7365 7269 6573  ) and (is_series
+0002aa00: 5f6c 696b 6528 6b65 7929 206f 7220 6973  _like(key) or is
+0002aa10: 5f69 6e64 6578 5f6c 696b 6528 6b65 7929  _index_like(key)
+0002aa20: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
+0002aa30: 2020 2020 2020 2020 2023 2065 7272 6f72           # error
+0002aa40: 2069 7320 7261 6973 6564 2066 726f 6d20   is raised from 
+0002aa50: 7061 6e64 6173 0a20 2020 2020 2020 2020  pandas.         
+0002aa60: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+0002aa70: 6d65 7461 5b5f 6578 7472 6163 745f 6d65  meta[_extract_me
+0002aa80: 7461 286b 6579 295d 0a0a 2020 2020 2020  ta(key)]..      
+0002aa90: 2020 2020 2020 6473 6b20 3d20 7061 7274        dsk = part
+0002aaa0: 6974 696f 6e77 6973 655f 6772 6170 6828  itionwise_graph(
+0002aab0: 6f70 6572 6174 6f72 2e67 6574 6974 656d  operator.getitem
+0002aac0: 2c20 6e61 6d65 2c20 7365 6c66 2c20 6b65  , name, self, ke
+0002aad0: 7929 0a20 2020 2020 2020 2020 2020 2067  y).            g
+0002aae0: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
+0002aaf0: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+0002ab00: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
+0002ab10: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
+0002ab20: 7365 6c66 5d29 0a20 2020 2020 2020 2020  self]).         
+0002ab30: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
+0002ab40: 5f6f 626a 6563 7428 6772 6170 682c 206e  _object(graph, n
+0002ab50: 616d 652c 206d 6574 612c 2073 656c 662e  ame, meta, self.
+0002ab60: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
+0002ab70: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0002ab80: 286b 6579 2c20 5365 7269 6573 293a 0a20  (key, Series):. 
+0002ab90: 2020 2020 2020 2020 2020 2023 2064 6f20             # do 
+0002aba0: 6e6f 7420 7065 7266 6f72 6d20 6475 6d6d  not perform dumm
+0002abb0: 7920 6361 6c63 756c 6174 696f 6e2c 2061  y calculation, a
+0002abc0: 7320 636f 6c75 6d6e 7320 7769 6c6c 206e  s columns will n
+0002abd0: 6f74 2062 6520 6368 616e 6765 642e 0a20  ot be changed.. 
+0002abe0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0002abf0: 6c66 2e64 6976 6973 696f 6e73 2021 3d20  lf.divisions != 
+0002ac00: 6b65 792e 6469 7669 7369 6f6e 733a 0a20  key.divisions:. 
+0002ac10: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002ac20: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+0002ac30: 6d65 2e6d 756c 7469 2069 6d70 6f72 7420  me.multi import 
+0002ac40: 5f6d 6179 6265 5f61 6c69 676e 5f70 6172  _maybe_align_par
+0002ac50: 7469 7469 6f6e 730a 0a20 2020 2020 2020  titions..       
+0002ac60: 2020 2020 2020 2020 2073 656c 662c 206b           self, k
+0002ac70: 6579 203d 205f 6d61 7962 655f 616c 6967  ey = _maybe_alig
+0002ac80: 6e5f 7061 7274 6974 696f 6e73 285b 7365  n_partitions([se
+0002ac90: 6c66 2c20 6b65 795d 290a 2020 2020 2020  lf, key]).      
+0002aca0: 2020 2020 2020 6473 6b20 3d20 7061 7274        dsk = part
+0002acb0: 6974 696f 6e77 6973 655f 6772 6170 6828  itionwise_graph(
+0002acc0: 6f70 6572 6174 6f72 2e67 6574 6974 656d  operator.getitem
+0002acd0: 2c20 6e61 6d65 2c20 7365 6c66 2c20 6b65  , name, self, ke
+0002ace0: 7929 0a20 2020 2020 2020 2020 2020 2067  y).            g
+0002acf0: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
+0002ad00: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+0002ad10: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
+0002ad20: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
+0002ad30: 7365 6c66 2c20 6b65 795d 290a 2020 2020  self, key]).    
+0002ad40: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0002ad50: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
+0002ad60: 7068 2c20 6e61 6d65 2c20 7365 6c66 2c20  ph, name, self, 
+0002ad70: 7365 6c66 2e64 6976 6973 696f 6e73 290a  self.divisions).
+0002ad80: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0002ad90: 7461 6e63 6528 6b65 792c 2044 6174 6146  tance(key, DataF
+0002ada0: 7261 6d65 293a 0a20 2020 2020 2020 2020  rame):.         
+0002adb0: 2020 2072 6574 7572 6e20 7365 6c66 2e77     return self.w
+0002adc0: 6865 7265 286b 6579 2c20 6e70 2e6e 616e  here(key, np.nan
+0002add0: 290a 0a20 2020 2020 2020 2072 6169 7365  )..        raise
+0002ade0: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+0002adf0: 7272 6f72 286b 6579 290a 0a20 2020 2064  rror(key)..    d
+0002ae00: 6566 205f 5f73 6574 6974 656d 5f5f 2873  ef __setitem__(s
+0002ae10: 656c 662c 206b 6579 2c20 7661 6c75 6529  elf, key, value)
+0002ae20: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
+0002ae30: 6e73 7461 6e63 6528 6b65 792c 2028 7475  nstance(key, (tu
+0002ae40: 706c 652c 206c 6973 7429 2920 616e 6420  ple, list)) and 
+0002ae50: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
+0002ae60: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
+0002ae70: 2020 2020 2020 2020 2020 6466 203d 2073            df = s
+0002ae80: 656c 662e 6173 7369 676e 282a 2a7b 6b3a  elf.assign(**{k:
+0002ae90: 2076 616c 7565 5b63 5d20 666f 7220 6b2c   value[c] for k,
+0002aea0: 2063 2069 6e20 7a69 7028 6b65 792c 2076   c in zip(key, v
+0002aeb0: 616c 7565 2e63 6f6c 756d 6e73 297d 290a  alue.columns)}).
+0002aec0: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
+0002aed0: 696e 7374 616e 6365 286b 6579 2c20 7064  instance(key, pd
+0002aee0: 2e49 6e64 6578 2920 616e 6420 6e6f 7420  .Index) and not 
+0002aef0: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
+0002af00: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
+0002af10: 2020 2020 2020 2020 2020 6b65 7920 3d20            key = 
+0002af20: 6c69 7374 286b 6579 290a 2020 2020 2020  list(key).      
+0002af30: 2020 2020 2020 6466 203d 2073 656c 662e        df = self.
+0002af40: 6173 7369 676e 282a 2a7b 6b3a 2076 616c  assign(**{k: val
+0002af50: 7565 2066 6f72 206b 2069 6e20 6b65 797d  ue for k in key}
+0002af60: 290a 2020 2020 2020 2020 656c 6966 2028  ).        elif (
+0002af70: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
+0002af80: 6461 7461 6672 616d 655f 6c69 6b65 286b  dataframe_like(k
+0002af90: 6579 290a 2020 2020 2020 2020 2020 2020  ey).            
+0002afa0: 6f72 2069 735f 7365 7269 6573 5f6c 696b  or is_series_lik
+0002afb0: 6528 6b65 7929 0a20 2020 2020 2020 2020  e(key).         
+0002afc0: 2020 206f 7220 6973 696e 7374 616e 6365     or isinstance
+0002afd0: 286b 6579 2c20 2844 6174 6146 7261 6d65  (key, (DataFrame
+0002afe0: 2c20 5365 7269 6573 2929 0a20 2020 2020  , Series)).     
+0002aff0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+0002b000: 2020 6466 203d 2073 656c 662e 7768 6572    df = self.wher
+0002b010: 6528 7e6b 6579 2c20 7661 6c75 6529 0a20  e(~key, value). 
+0002b020: 2020 2020 2020 2065 6c69 6620 6e6f 7420         elif not 
+0002b030: 6973 696e 7374 616e 6365 286b 6579 2c20  isinstance(key, 
+0002b040: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
+0002b050: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+0002b060: 6d65 6e74 6564 4572 726f 7228 6622 4974  mentedError(f"It
+0002b070: 656d 2061 7373 6967 6e6d 656e 7420 7769  em assignment wi
+0002b080: 7468 207b 7479 7065 286b 6579 297d 206e  th {type(key)} n
+0002b090: 6f74 2073 7570 706f 7274 6564 2229 0a20  ot supported"). 
+0002b0a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0002b0b0: 2020 2020 2020 2020 2064 6620 3d20 7365           df = se
+0002b0c0: 6c66 2e61 7373 6967 6e28 2a2a 7b6b 6579  lf.assign(**{key
+0002b0d0: 3a20 7661 6c75 657d 290a 0a20 2020 2020  : value})..     
+0002b0e0: 2020 2073 656c 662e 6461 736b 203d 2064     self.dask = d
+0002b0f0: 662e 6461 736b 0a20 2020 2020 2020 2073  f.dask.        s
+0002b100: 656c 662e 5f6e 616d 6520 3d20 6466 2e5f  elf._name = df._
+0002b110: 6e61 6d65 0a20 2020 2020 2020 2073 656c  name.        sel
+0002b120: 662e 5f6d 6574 6120 3d20 6466 2e5f 6d65  f._meta = df._me
+0002b130: 7461 0a20 2020 2020 2020 2073 656c 662e  ta.        self.
+0002b140: 5f64 6976 6973 696f 6e73 203d 2064 662e  _divisions = df.
+0002b150: 6469 7669 7369 6f6e 730a 0a20 2020 2064  divisions..    d
+0002b160: 6566 205f 5f64 656c 6974 656d 5f5f 2873  ef __delitem__(s
+0002b170: 656c 662c 206b 6579 293a 0a20 2020 2020  elf, key):.     
+0002b180: 2020 2072 6573 756c 7420 3d20 7365 6c66     result = self
+0002b190: 2e64 726f 7028 5b6b 6579 5d2c 2061 7869  .drop([key], axi
+0002b1a0: 733d 3129 0a20 2020 2020 2020 2073 656c  s=1).        sel
+0002b1b0: 662e 6461 736b 203d 2072 6573 756c 742e  f.dask = result.
+0002b1c0: 6461 736b 0a20 2020 2020 2020 2073 656c  dask.        sel
+0002b1d0: 662e 5f6e 616d 6520 3d20 7265 7375 6c74  f._name = result
+0002b1e0: 2e5f 6e61 6d65 0a20 2020 2020 2020 2073  ._name.        s
+0002b1f0: 656c 662e 5f6d 6574 6120 3d20 7265 7375  elf._meta = resu
+0002b200: 6c74 2e5f 6d65 7461 0a0a 2020 2020 6465  lt._meta..    de
+0002b210: 6620 5f5f 7365 7461 7474 725f 5f28 7365  f __setattr__(se
+0002b220: 6c66 2c20 6b65 792c 2076 616c 7565 293a  lf, key, value):
+0002b230: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+0002b240: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+0002b250: 7320 3d20 6f62 6a65 6374 2e5f 5f67 6574  s = object.__get
+0002b260: 6174 7472 6962 7574 655f 5f28 7365 6c66  attribute__(self
+0002b270: 2c20 225f 6d65 7461 2229 2e63 6f6c 756d  , "_meta").colum
+0002b280: 6e73 0a20 2020 2020 2020 2065 7863 6570  ns.        excep
+0002b290: 7420 4174 7472 6962 7574 6545 7272 6f72  t AttributeError
+0002b2a0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+0002b2b0: 6c75 6d6e 7320 3d20 2829 0a0a 2020 2020  lumns = ()..    
+0002b2c0: 2020 2020 2320 6578 636c 7564 6520 7072      # exclude pr
+0002b2d0: 6f74 6563 7465 6420 6174 7472 6962 7574  otected attribut
+0002b2e0: 6573 2066 726f 6d20 7365 7469 7465 6d0a  es from setitem.
+0002b2f0: 2020 2020 2020 2020 6966 206b 6579 2069          if key i
+0002b300: 6e20 636f 6c75 6d6e 7320 616e 6420 6b65  n columns and ke
+0002b310: 7920 6e6f 7420 696e 205b 2264 6976 6973  y not in ["divis
+0002b320: 696f 6e73 222c 2022 6461 736b 222c 2022  ions", "dask", "
+0002b330: 5f6e 616d 6522 2c20 225f 6d65 7461 225d  _name", "_meta"]
+0002b340: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0002b350: 6c66 5b6b 6579 5d20 3d20 7661 6c75 650a  lf[key] = value.
+0002b360: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002b370: 2020 2020 2020 2020 2020 6f62 6a65 6374            object
+0002b380: 2e5f 5f73 6574 6174 7472 5f5f 2873 656c  .__setattr__(sel
+0002b390: 662c 206b 6579 2c20 7661 6c75 6529 0a0a  f, key, value)..
+0002b3a0: 2020 2020 6465 6620 5f5f 6765 7461 7474      def __getatt
+0002b3b0: 725f 5f28 7365 6c66 2c20 6b65 7929 3a0a  r__(self, key):.
+0002b3c0: 2020 2020 2020 2020 6966 206b 6579 2069          if key i
+0002b3d0: 6e20 7365 6c66 2e63 6f6c 756d 6e73 3a0a  n self.columns:.
+0002b3e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002b3f0: 726e 2073 656c 665b 6b65 795d 0a20 2020  rn self[key].   
+0002b400: 2020 2020 2065 6c69 6620 6b65 7920 3d3d       elif key ==
+0002b410: 2022 656d 7074 7922 3a0a 2020 2020 2020   "empty":.      
+0002b420: 2020 2020 2020 2320 7365 6c66 2e65 6d70        # self.emp
+0002b430: 7479 2072 6169 7365 7320 4174 7472 6962  ty raises Attrib
+0002b440: 7574 654e 6f74 496d 706c 656d 656e 7465  uteNotImplemente
+0002b450: 6445 7272 6f72 2c20 7768 6963 6820 696e  dError, which in
+0002b460: 636c 7564 6573 0a20 2020 2020 2020 2020  cludes.         
+0002b470: 2020 2023 2041 7474 7269 6275 7465 4572     # AttributeEr
+0002b480: 726f 722c 2077 6869 6368 206d 6561 6e73  ror, which means
+0002b490: 2077 6520 656e 6420 7570 2068 6572 6520   we end up here 
+0002b4a0: 696e 2073 656c 662e 5f5f 6765 7461 7474  in self.__getatt
+0002b4b0: 725f 5f2c 0a20 2020 2020 2020 2020 2020  r__,.           
+0002b4c0: 2023 2062 6563 6175 7365 2044 6174 6146   # because DataF
+0002b4d0: 7261 6d65 2e5f 5f67 6574 6174 7472 6962  rame.__getattrib
+0002b4e0: 7574 655f 5f20 646f 6573 6e27 7420 7468  ute__ doesn't th
+0002b4f0: 696e 6b20 7468 6520 6174 7472 6962 7574  ink the attribut
+0002b500: 6520 6578 6973 7473 0a20 2020 2020 2020  e exists.       
+0002b510: 2020 2020 2023 2061 6e64 2075 7365 7320       # and uses 
+0002b520: 5f5f 6765 7461 7474 725f 5f20 6173 2074  __getattr__ as t
+0002b530: 6865 2066 616c 6c62 6163 6b2e 2053 6f2c  he fallback. So,
+0002b540: 2067 6574 2060 7365 6c66 2e65 6d70 7479   get `self.empty
+0002b550: 6020 6d6f 7265 0a20 2020 2020 2020 2020  ` more.         
+0002b560: 2020 2023 2066 6f72 6365 6675 6c6c 7920     # forcefully 
+0002b570: 7669 6120 6f62 6a65 6374 2e5f 5f67 6574  via object.__get
+0002b580: 6174 7472 6962 7574 655f 5f20 746f 2072  attribute__ to r
+0002b590: 6169 7365 2069 6e66 6f72 6d61 7469 7665  aise informative
+0002b5a0: 2065 7272 6f72 2e0a 2020 2020 2020 2020   error..        
+0002b5b0: 2020 2020 6f62 6a65 6374 2e5f 5f67 6574      object.__get
+0002b5c0: 6174 7472 6962 7574 655f 5f28 7365 6c66  attribute__(self
+0002b5d0: 2c20 6b65 7929 0a20 2020 2020 2020 2065  , key).        e
+0002b5e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002b5f0: 2072 6169 7365 2041 7474 7269 6275 7465   raise Attribute
+0002b600: 4572 726f 7228 2227 4461 7461 4672 616d  Error("'DataFram
+0002b610: 6527 206f 626a 6563 7420 6861 7320 6e6f  e' object has no
+0002b620: 2061 7474 7269 6275 7465 2025 7222 2025   attribute %r" %
+0002b630: 206b 6579 290a 0a20 2020 2064 6566 205f   key)..    def _
+0002b640: 5f64 6972 5f5f 2873 656c 6629 3a0a 2020  _dir__(self):.  
+0002b650: 2020 2020 2020 6f20 3d20 7365 7428 6469        o = set(di
+0002b660: 7228 7479 7065 2873 656c 6629 2929 0a20  r(type(self))). 
+0002b670: 2020 2020 2020 206f 2e75 7064 6174 6528         o.update(
+0002b680: 7365 6c66 2e5f 5f64 6963 745f 5f29 0a20  self.__dict__). 
+0002b690: 2020 2020 2020 206f 2e75 7064 6174 6528         o.update(
+0002b6a0: 6320 666f 7220 6320 696e 2073 656c 662e  c for c in self.
+0002b6b0: 636f 6c75 6d6e 7320 6966 2028 6973 696e  columns if (isin
+0002b6c0: 7374 616e 6365 2863 2c20 7374 7229 2061  stance(c, str) a
+0002b6d0: 6e64 2063 2e69 7369 6465 6e74 6966 6965  nd c.isidentifie
+0002b6e0: 7228 2929 290a 2020 2020 2020 2020 7265  r())).        re
+0002b6f0: 7475 726e 206c 6973 7428 6f29 0a0a 2020  turn list(o)..  
+0002b700: 2020 6465 6620 5f5f 6974 6572 5f5f 2873    def __iter__(s
+0002b710: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+0002b720: 7475 726e 2069 7465 7228 7365 6c66 2e5f  turn iter(self._
+0002b730: 6d65 7461 290a 0a20 2020 2064 6566 205f  meta)..    def _
+0002b740: 6970 7974 686f 6e5f 6b65 795f 636f 6d70  ipython_key_comp
+0002b750: 6c65 7469 6f6e 735f 2873 656c 6629 3a0a  letions_(self):.
+0002b760: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+0002b770: 6574 686f 6473 2e74 6f6c 6973 7428 7365  ethods.tolist(se
+0002b780: 6c66 2e63 6f6c 756d 6e73 290a 0a20 2020  lf.columns)..   
+0002b790: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0002b7a0: 6566 206e 6469 6d28 7365 6c66 293a 0a20  ef ndim(self):. 
+0002b7b0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0002b7c0: 2064 696d 656e 7369 6f6e 616c 6974 7922   dimensionality"
+0002b7d0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0002b7e0: 6e20 320a 0a20 2020 2040 7072 6f70 6572  n 2..    @proper
+0002b7f0: 7479 0a20 2020 2064 6566 2073 6861 7065  ty.    def shape
+0002b800: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0002b810: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+0002b820: 726e 2061 2074 7570 6c65 2072 6570 7265  rn a tuple repre
+0002b830: 7365 6e74 696e 6720 7468 6520 6469 6d65  senting the dime
+0002b840: 6e73 696f 6e61 6c69 7479 206f 6620 7468  nsionality of th
+0002b850: 6520 4461 7461 4672 616d 652e 0a0a 2020  e DataFrame...  
+0002b860: 2020 2020 2020 5468 6520 6e75 6d62 6572        The number
+0002b870: 206f 6620 726f 7773 2069 7320 6120 4465   of rows is a De
+0002b880: 6c61 7965 6420 7265 7375 6c74 2e20 5468  layed result. Th
+0002b890: 6520 6e75 6d62 6572 206f 6620 636f 6c75  e number of colu
+0002b8a0: 6d6e 730a 2020 2020 2020 2020 6973 2061  mns.        is a
+0002b8b0: 2063 6f6e 6372 6574 6520 696e 7465 6765   concrete intege
+0002b8c0: 722e 0a0a 2020 2020 2020 2020 4578 616d  r...        Exam
+0002b8d0: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
+0002b8e0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
+0002b8f0: 3e20 6466 2e73 697a 6520 2023 2064 6f63  > df.size  # doc
+0002b900: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
+0002b910: 2020 2020 2844 656c 6179 6564 2827 696e      (Delayed('in
+0002b920: 742d 3037 6630 3630 3735 2d35 6563 632d  t-07f06075-5ecc-
+0002b930: 3464 3737 2d38 3137 652d 3633 6336 3961  4d77-817e-63c69a
+0002b940: 3931 3838 6138 2729 2c20 3229 0a20 2020  9188a8'), 2).   
+0002b950: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0002b960: 2063 6f6c 5f73 697a 6520 3d20 6c65 6e28   col_size = len(
+0002b970: 7365 6c66 2e63 6f6c 756d 6e73 290a 2020  self.columns).  
+0002b980: 2020 2020 2020 6966 2063 6f6c 5f73 697a        if col_siz
+0002b990: 6520 3d3d 2030 3a0a 2020 2020 2020 2020  e == 0:.        
+0002b9a0: 2020 2020 7265 7475 726e 2028 7365 6c66      return (self
+0002b9b0: 2e69 6e64 6578 2e73 6861 7065 5b30 5d2c  .index.shape[0],
+0002b9c0: 2030 290a 2020 2020 2020 2020 726f 775f   0).        row_
+0002b9d0: 7369 7a65 203d 2064 656c 6179 6564 2869  size = delayed(i
+0002b9e0: 6e74 2928 7365 6c66 2e73 697a 6520 2f20  nt)(self.size / 
+0002b9f0: 636f 6c5f 7369 7a65 290a 2020 2020 2020  col_size).      
+0002ba00: 2020 7265 7475 726e 2028 726f 775f 7369    return (row_si
+0002ba10: 7a65 2c20 636f 6c5f 7369 7a65 290a 0a20  ze, col_size).. 
+0002ba20: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0002ba30: 2064 6566 2064 7479 7065 7328 7365 6c66   def dtypes(self
+0002ba40: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+0002ba50: 7475 726e 2064 6174 6120 7479 7065 7322  turn data types"
+0002ba60: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0002ba70: 6e20 7365 6c66 2e5f 6d65 7461 2e64 7479  n self._meta.dty
+0002ba80: 7065 730a 0a20 2020 2040 6465 7269 7665  pes..    @derive
+0002ba90: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+0002baa0: 616d 6529 0a20 2020 2064 6566 2067 6574  ame).    def get
+0002bab0: 5f64 7479 7065 5f63 6f75 6e74 7328 7365  _dtype_counts(se
+0002bac0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+0002bad0: 7572 6e20 7365 6c66 2e5f 6d65 7461 2e67  urn self._meta.g
+0002bae0: 6574 5f64 7479 7065 5f63 6f75 6e74 7328  et_dtype_counts(
+0002baf0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0002bb00: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0002bb10: 6529 0a20 2020 2064 6566 2067 6574 5f66  e).    def get_f
+0002bb20: 7479 7065 5f63 6f75 6e74 7328 7365 6c66  type_counts(self
+0002bb30: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0002bb40: 6e20 7365 6c66 2e5f 6d65 7461 2e67 6574  n self._meta.get
+0002bb50: 5f66 7479 7065 5f63 6f75 6e74 7328 290a  _ftype_counts().
+0002bb60: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+0002bb70: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+0002bb80: 0a20 2020 2064 6566 2073 656c 6563 745f  .    def select_
+0002bb90: 6474 7970 6573 2873 656c 662c 2069 6e63  dtypes(self, inc
+0002bba0: 6c75 6465 3d4e 6f6e 652c 2065 7863 6c75  lude=None, exclu
+0002bbb0: 6465 3d4e 6f6e 6529 3a0a 2020 2020 2020  de=None):.      
+0002bbc0: 2020 6373 203d 2073 656c 662e 5f6d 6574    cs = self._met
+0002bbd0: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
+0002bbe0: 696e 636c 7564 653d 696e 636c 7564 652c  include=include,
+0002bbf0: 2065 7863 6c75 6465 3d65 7863 6c75 6465   exclude=exclude
+0002bc00: 290a 2020 2020 2020 2020 696e 6465 7865  ).        indexe
+0002bc10: 7220 3d20 7365 6c66 2e5f 6765 745f 636f  r = self._get_co
+0002bc20: 6c75 6d6e 735f 696e 6465 7865 735f 6261  lumns_indexes_ba
+0002bc30: 7365 645f 6f6e 5f64 7479 7065 7328 6373  sed_on_dtypes(cs
+0002bc40: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0002bc50: 2073 656c 662e 696c 6f63 5b3a 2c20 696e   self.iloc[:, in
+0002bc60: 6465 7865 725d 0a0a 2020 2020 6465 6620  dexer]..    def 
+0002bc70: 736f 7274 5f76 616c 7565 7328 0a20 2020  sort_values(.   
+0002bc80: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0002bc90: 2020 2062 793a 2073 7472 207c 206c 6973     by: str | lis
+0002bca0: 745b 7374 725d 2c0a 2020 2020 2020 2020  t[str],.        
+0002bcb0: 6e70 6172 7469 7469 6f6e 733a 2069 6e74  npartitions: int
+0002bcc0: 207c 204c 6974 6572 616c 5b22 6175 746f   | Literal["auto
+0002bcd0: 225d 207c 204e 6f6e 6520 3d20 4e6f 6e65  "] | None = None
+0002bce0: 2c0a 2020 2020 2020 2020 6173 6365 6e64  ,.        ascend
+0002bcf0: 696e 673a 2062 6f6f 6c20 3d20 5472 7565  ing: bool = True
+0002bd00: 2c0a 2020 2020 2020 2020 6e61 5f70 6f73  ,.        na_pos
+0002bd10: 6974 696f 6e3a 204c 6974 6572 616c 5b22  ition: Literal["
+0002bd20: 6669 7273 7422 5d20 7c20 4c69 7465 7261  first"] | Litera
+0002bd30: 6c5b 226c 6173 7422 5d20 3d20 226c 6173  l["last"] = "las
+0002bd40: 7422 2c0a 2020 2020 2020 2020 736f 7274  t",.        sort
+0002bd50: 5f66 756e 6374 696f 6e3a 2043 616c 6c61  _function: Calla
+0002bd60: 626c 655b 5b70 642e 4461 7461 4672 616d  ble[[pd.DataFram
+0002bd70: 655d 2c20 7064 2e44 6174 6146 7261 6d65  e], pd.DataFrame
+0002bd80: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
+0002bd90: 0a20 2020 2020 2020 2073 6f72 745f 6675  .        sort_fu
+0002bda0: 6e63 7469 6f6e 5f6b 7761 7267 733a 204d  nction_kwargs: M
+0002bdb0: 6170 7069 6e67 5b73 7472 2c20 416e 795d  apping[str, Any]
+0002bdc0: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
+0002bdd0: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+0002bde0: 2c0a 2020 2020 2920 2d3e 2044 6174 6146  ,.    ) -> DataF
+0002bdf0: 7261 6d65 3a0a 2020 2020 2020 2020 2222  rame:.        ""
+0002be00: 2253 6f72 7420 7468 6520 6461 7461 7365  "Sort the datase
+0002be10: 7420 6279 2061 2073 696e 676c 6520 636f  t by a single co
+0002be20: 6c75 6d6e 2e0a 0a20 2020 2020 2020 2053  lumn...        S
+0002be30: 6f72 7469 6e67 2061 2070 6172 616c 6c65  orting a paralle
+0002be40: 6c20 6461 7461 7365 7420 7265 7175 6972  l dataset requir
+0002be50: 6573 2065 7870 656e 7369 7665 2073 6875  es expensive shu
+0002be60: 6666 6c65 7320 616e 6420 6973 2067 656e  ffles and is gen
+0002be70: 6572 616c 6c79 0a20 2020 2020 2020 206e  erally.        n
+0002be80: 6f74 2072 6563 6f6d 6d65 6e64 6564 2e20  ot recommended. 
+0002be90: 5365 6520 6060 7365 745f 696e 6465 7860  See ``set_index`
+0002bea0: 6020 666f 7220 696d 706c 656d 656e 7461  ` for implementa
+0002beb0: 7469 6f6e 2064 6574 6169 6c73 2e0a 0a20  tion details... 
+0002bec0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0002bed0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0002bee0: 2d2d 2d2d 0a20 2020 2020 2020 2062 793a  ----.        by:
+0002bef0: 2073 7472 206f 7220 6c69 7374 5b73 7472   str or list[str
+0002bf00: 5d0a 2020 2020 2020 2020 2020 2020 436f  ].            Co
+0002bf10: 6c75 6d6e 2873 2920 746f 2073 6f72 7420  lumn(s) to sort 
+0002bf20: 6279 2e0a 2020 2020 2020 2020 6e70 6172  by..        npar
+0002bf30: 7469 7469 6f6e 733a 2069 6e74 2c20 4e6f  titions: int, No
+0002bf40: 6e65 2c20 6f72 2027 6175 746f 270a 2020  ne, or 'auto'.  
+0002bf50: 2020 2020 2020 2020 2020 5468 6520 6964            The id
+0002bf60: 6561 6c20 6e75 6d62 6572 206f 6620 6f75  eal number of ou
+0002bf70: 7470 7574 2070 6172 7469 7469 6f6e 732e  tput partitions.
+0002bf80: 2049 6620 4e6f 6e65 2c20 7573 6520 7468   If None, use th
+0002bf90: 6520 7361 6d65 2061 730a 2020 2020 2020  e same as.      
+0002bfa0: 2020 2020 2020 7468 6520 696e 7075 742e        the input.
+0002bfb0: 2049 6620 2761 7574 6f27 2074 6865 6e20   If 'auto' then 
+0002bfc0: 6465 6369 6465 2062 7920 6d65 6d6f 7279  decide by memory
+0002bfd0: 2075 7365 2e0a 2020 2020 2020 2020 6173   use..        as
+0002bfe0: 6365 6e64 696e 673a 2062 6f6f 6c2c 206f  cending: bool, o
+0002bff0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0002c000: 2020 2020 536f 7274 2061 7363 656e 6469      Sort ascendi
+0002c010: 6e67 2076 732e 2064 6573 6365 6e64 696e  ng vs. descendin
+0002c020: 672e 0a20 2020 2020 2020 2020 2020 2044  g..            D
+0002c030: 6566 6175 6c74 7320 746f 2054 7275 652e  efaults to True.
+0002c040: 0a20 2020 2020 2020 206e 615f 706f 7369  .        na_posi
+0002c050: 7469 6f6e 3a20 7b27 6c61 7374 272c 2027  tion: {'last', '
+0002c060: 6669 7273 7427 7d2c 206f 7074 696f 6e61  first'}, optiona
+0002c070: 6c0a 2020 2020 2020 2020 2020 2020 5075  l.            Pu
+0002c080: 7473 204e 614e 7320 6174 2074 6865 2062  ts NaNs at the b
+0002c090: 6567 696e 6e69 6e67 2069 6620 2766 6972  eginning if 'fir
+0002c0a0: 7374 272c 2070 7574 7320 4e61 4e20 6174  st', puts NaN at
+0002c0b0: 2074 6865 2065 6e64 2069 6620 276c 6173   the end if 'las
+0002c0c0: 7427 2e0a 2020 2020 2020 2020 2020 2020  t'..            
+0002c0d0: 4465 6661 756c 7473 2074 6f20 276c 6173  Defaults to 'las
+0002c0e0: 7427 2e0a 2020 2020 2020 2020 736f 7274  t'..        sort
+0002c0f0: 5f66 756e 6374 696f 6e3a 2066 756e 6374  _function: funct
+0002c100: 696f 6e2c 206f 7074 696f 6e61 6c0a 2020  ion, optional.  
+0002c110: 2020 2020 2020 2020 2020 536f 7274 696e            Sortin
+0002c120: 6720 6675 6e63 7469 6f6e 2074 6f20 7573  g function to us
+0002c130: 6520 7768 656e 2073 6f72 7469 6e67 2075  e when sorting u
+0002c140: 6e64 6572 6c79 696e 6720 7061 7274 6974  nderlying partit
+0002c150: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
+0002c160: 2020 4966 204e 6f6e 652c 2064 6566 6175    If None, defau
+0002c170: 6c74 7320 746f 2060 604d 2e73 6f72 745f  lts to ``M.sort_
+0002c180: 7661 6c75 6573 6060 2028 7468 6520 7061  values`` (the pa
+0002c190: 7274 6974 696f 6e20 6c69 6272 6172 7927  rtition library'
+0002c1a0: 730a 2020 2020 2020 2020 2020 2020 696d  s.            im
+0002c1b0: 706c 656d 656e 7461 7469 6f6e 206f 6620  plementation of 
+0002c1c0: 6060 736f 7274 5f76 616c 7565 7360 6029  ``sort_values``)
+0002c1d0: 2e0a 2020 2020 2020 2020 736f 7274 5f66  ..        sort_f
+0002c1e0: 756e 6374 696f 6e5f 6b77 6172 6773 3a20  unction_kwargs: 
+0002c1f0: 6469 6374 2c20 6f70 7469 6f6e 616c 0a20  dict, optional. 
+0002c200: 2020 2020 2020 2020 2020 2041 6464 6974             Addit
+0002c210: 696f 6e61 6c20 6b65 7977 6f72 6420 6172  ional keyword ar
+0002c220: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
+0002c230: 746f 2074 6865 2070 6172 7469 7469 6f6e  to the partition
+0002c240: 2073 6f72 7469 6e67 2066 756e 6374 696f   sorting functio
+0002c250: 6e2e 0a20 2020 2020 2020 2020 2020 2042  n..            B
+0002c260: 7920 6465 6661 756c 742c 2060 6062 7960  y default, ``by`
+0002c270: 602c 2060 6061 7363 656e 6469 6e67 6060  `, ``ascending``
+0002c280: 2c20 616e 6420 6060 6e61 5f70 6f73 6974  , and ``na_posit
+0002c290: 696f 6e60 6020 6172 6520 7072 6f76 6964  ion`` are provid
+0002c2a0: 6564 2e0a 0a20 2020 2020 2020 2045 7861  ed...        Exa
+0002c2b0: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+0002c2c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+0002c2d0: 3e3e 2064 6632 203d 2064 662e 736f 7274  >> df2 = df.sort
+0002c2e0: 5f76 616c 7565 7328 2778 2729 2020 2320  _values('x')  # 
+0002c2f0: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
+0002c300: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0002c310: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
+0002c320: 6166 7261 6d65 2e73 6875 6666 6c65 2069  aframe.shuffle i
+0002c330: 6d70 6f72 7420 736f 7274 5f76 616c 7565  mport sort_value
+0002c340: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
+0002c350: 6e20 736f 7274 5f76 616c 7565 7328 0a20  n sort_values(. 
+0002c360: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+0002c370: 0a20 2020 2020 2020 2020 2020 2062 792c  .            by,
+0002c380: 0a20 2020 2020 2020 2020 2020 2061 7363  .            asc
+0002c390: 656e 6469 6e67 3d61 7363 656e 6469 6e67  ending=ascending
+0002c3a0: 2c0a 2020 2020 2020 2020 2020 2020 6e70  ,.            np
+0002c3b0: 6172 7469 7469 6f6e 733d 6e70 6172 7469  artitions=nparti
+0002c3c0: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+0002c3d0: 2020 206e 615f 706f 7369 7469 6f6e 3d6e     na_position=n
+0002c3e0: 615f 706f 7369 7469 6f6e 2c0a 2020 2020  a_position,.    
+0002c3f0: 2020 2020 2020 2020 736f 7274 5f66 756e          sort_fun
+0002c400: 6374 696f 6e3d 736f 7274 5f66 756e 6374  ction=sort_funct
+0002c410: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0002c420: 2073 6f72 745f 6675 6e63 7469 6f6e 5f6b   sort_function_k
+0002c430: 7761 7267 733d 736f 7274 5f66 756e 6374  wargs=sort_funct
+0002c440: 696f 6e5f 6b77 6172 6773 2c0a 2020 2020  ion_kwargs,.    
+0002c450: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+0002c460: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0002c470: 2064 6566 2073 6574 5f69 6e64 6578 280a   def set_index(.
+0002c480: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0002c490: 2020 2020 2020 6f74 6865 723a 2073 7472        other: str
+0002c4a0: 207c 2053 6572 6965 732c 0a20 2020 2020   | Series,.     
+0002c4b0: 2020 2064 726f 703a 2062 6f6f 6c20 3d20     drop: bool = 
+0002c4c0: 5472 7565 2c0a 2020 2020 2020 2020 736f  True,.        so
+0002c4d0: 7274 6564 3a20 626f 6f6c 203d 2046 616c  rted: bool = Fal
+0002c4e0: 7365 2c0a 2020 2020 2020 2020 6e70 6172  se,.        npar
+0002c4f0: 7469 7469 6f6e 733a 2069 6e74 207c 204c  titions: int | L
+0002c500: 6974 6572 616c 5b22 6175 746f 225d 207c  iteral["auto"] |
+0002c510: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
+0002c520: 2020 2020 2020 6469 7669 7369 6f6e 733a        divisions:
+0002c530: 2053 6571 7565 6e63 6520 7c20 4e6f 6e65   Sequence | None
+0002c540: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0002c550: 2069 6e70 6c61 6365 3a20 626f 6f6c 203d   inplace: bool =
+0002c560: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+0002c570: 2a2a 6b77 6172 6773 2c0a 2020 2020 293a  **kwargs,.    ):
+0002c580: 0a20 2020 2020 2020 2022 2222 5365 7420  .        """Set 
+0002c590: 7468 6520 4461 7461 4672 616d 6520 696e  the DataFrame in
+0002c5a0: 6465 7820 2872 6f77 206c 6162 656c 7329  dex (row labels)
+0002c5b0: 2075 7369 6e67 2061 6e20 6578 6973 7469   using an existi
+0002c5c0: 6e67 2063 6f6c 756d 6e2e 0a0a 2020 2020  ng column...    
+0002c5d0: 2020 2020 5468 6973 2072 6561 6c69 676e      This realign
+0002c5e0: 7320 7468 6520 6461 7461 7365 7420 746f  s the dataset to
+0002c5f0: 2062 6520 736f 7274 6564 2062 7920 6120   be sorted by a 
+0002c600: 6e65 7720 636f 6c75 6d6e 2e20 5468 6973  new column. This
+0002c610: 2063 616e 2068 6176 6520 610a 2020 2020   can have a.    
+0002c620: 2020 2020 7369 676e 6966 6963 616e 7420      significant 
+0002c630: 696d 7061 6374 206f 6e20 7065 7266 6f72  impact on perfor
+0002c640: 6d61 6e63 652c 2062 6563 6175 7365 206a  mance, because j
+0002c650: 6f69 6e73 2c20 6772 6f75 7062 7973 2c20  oins, groupbys, 
+0002c660: 6c6f 6f6b 7570 732c 2065 7463 2e0a 2020  lookups, etc..  
+0002c670: 2020 2020 2020 6172 6520 616c 6c20 6d75        are all mu
+0002c680: 6368 2066 6173 7465 7220 6f6e 2074 6861  ch faster on tha
+0002c690: 7420 636f 6c75 6d6e 2e20 486f 7765 7665  t column. Howeve
+0002c6a0: 722c 2074 6869 7320 7065 7266 6f72 6d61  r, this performa
+0002c6b0: 6e63 6520 696e 6372 6561 7365 0a20 2020  nce increase.   
+0002c6c0: 2020 2020 2063 6f6d 6573 2077 6974 6820       comes with 
+0002c6d0: 6120 636f 7374 2c20 736f 7274 696e 6720  a cost, sorting 
+0002c6e0: 6120 7061 7261 6c6c 656c 2064 6174 6173  a parallel datas
+0002c6f0: 6574 2072 6571 7569 7265 7320 6578 7065  et requires expe
+0002c700: 6e73 6976 6520 7368 7566 666c 6573 2e0a  nsive shuffles..
+0002c710: 2020 2020 2020 2020 4f66 7465 6e20 7765          Often we
+0002c720: 2060 6073 6574 5f69 6e64 6578 6060 206f   ``set_index`` o
+0002c730: 6e63 6520 6469 7265 6374 6c79 2061 6674  nce directly aft
+0002c740: 6572 2064 6174 6120 696e 6765 7374 2061  er data ingest a
+0002c750: 6e64 2066 696c 7465 7269 6e67 2061 6e64  nd filtering and
+0002c760: 0a20 2020 2020 2020 2074 6865 6e20 7065  .        then pe
+0002c770: 7266 6f72 6d20 6d61 6e79 2063 6865 6170  rform many cheap
+0002c780: 2063 6f6d 7075 7461 7469 6f6e 7320 6f66   computations of
+0002c790: 6620 6f66 2074 6865 2073 6f72 7465 6420  f of the sorted 
+0002c7a0: 6461 7461 7365 742e 0a0a 2020 2020 2020  dataset...      
+0002c7b0: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
+0002c7c0: 6f70 6572 6174 6573 2065 7861 6374 6c79  operates exactly
+0002c7d0: 206c 696b 6520 6060 7061 6e64 6173 2e73   like ``pandas.s
+0002c7e0: 6574 5f69 6e64 6578 6060 2065 7863 6570  et_index`` excep
+0002c7f0: 7420 7769 7468 0a20 2020 2020 2020 2064  t with.        d
+0002c800: 6966 6665 7265 6e74 2070 6572 666f 726d  ifferent perform
+0002c810: 616e 6365 2063 6f73 7473 2028 6461 736b  ance costs (dask
+0002c820: 2064 6174 6166 7261 6d65 2060 6073 6574   dataframe ``set
+0002c830: 5f69 6e64 6578 6060 2069 7320 6d75 6368  _index`` is much
+0002c840: 206d 6f72 6520 6578 7065 6e73 6976 6529   more expensive)
+0002c850: 2e0a 2020 2020 2020 2020 556e 6465 7220  ..        Under 
+0002c860: 6e6f 726d 616c 206f 7065 7261 7469 6f6e  normal operation
+0002c870: 2074 6869 7320 6675 6e63 7469 6f6e 2064   this function d
+0002c880: 6f65 7320 616e 2069 6e69 7469 616c 2070  oes an initial p
+0002c890: 6173 7320 6f76 6572 2074 6865 2069 6e64  ass over the ind
+0002c8a0: 6578 2063 6f6c 756d 6e0a 2020 2020 2020  ex column.      
+0002c8b0: 2020 746f 2063 6f6d 7075 7465 2061 7070    to compute app
+0002c8c0: 726f 7869 6d61 7465 2071 7561 6e74 696c  roximate quantil
+0002c8d0: 6573 2074 6f20 7365 7276 6520 6173 2066  es to serve as f
+0002c8e0: 7574 7572 6520 6469 7669 7369 6f6e 732e  uture divisions.
+0002c8f0: 2049 7420 7468 656e 2070 6173 7365 730a   It then passes.
+0002c900: 2020 2020 2020 2020 6f76 6572 2074 6865          over the
+0002c910: 2064 6174 6120 6120 7365 636f 6e64 2074   data a second t
+0002c920: 696d 652c 2073 706c 6974 7469 6e67 2075  ime, splitting u
+0002c930: 7020 6561 6368 2069 6e70 7574 2070 6172  p each input par
+0002c940: 7469 7469 6f6e 2069 6e74 6f20 7365 7665  tition into seve
+0002c950: 7261 6c0a 2020 2020 2020 2020 7069 6563  ral.        piec
+0002c960: 6573 2061 6e64 2073 6861 7269 6e67 2074  es and sharing t
+0002c970: 686f 7365 2070 6965 6365 7320 746f 2061  hose pieces to a
+0002c980: 6c6c 206f 6620 7468 6520 6f75 7470 7574  ll of the output
+0002c990: 2070 6172 7469 7469 6f6e 7320 6e6f 7720   partitions now 
+0002c9a0: 696e 0a20 2020 2020 2020 2073 6f72 7465  in.        sorte
+0002c9b0: 6420 6f72 6465 722e 0a0a 2020 2020 2020  d order...      
+0002c9c0: 2020 496e 2073 6f6d 6520 6361 7365 7320    In some cases 
+0002c9d0: 7765 2063 616e 2061 6c6c 6576 6961 7465  we can alleviate
+0002c9e0: 2074 686f 7365 2063 6f73 7473 2c20 666f   those costs, fo
+0002c9f0: 7220 6578 616d 706c 6520 6966 2079 6f75  r example if you
+0002ca00: 7220 6461 7461 7365 7420 6973 0a20 2020  r dataset is.   
+0002ca10: 2020 2020 2073 6f72 7465 6420 616c 7265       sorted alre
+0002ca20: 6164 7920 7468 656e 2077 6520 6361 6e20  ady then we can 
+0002ca30: 6176 6f69 6420 6d61 6b69 6e67 206d 616e  avoid making man
+0002ca40: 7920 736d 616c 6c20 7069 6563 6573 206f  y small pieces o
+0002ca50: 7220 6966 2079 6f75 206b 6e6f 770a 2020  r if you know.  
+0002ca60: 2020 2020 2020 676f 6f64 2076 616c 7565        good value
+0002ca70: 7320 746f 2073 706c 6974 2074 6865 206e  s to split the n
+0002ca80: 6577 2069 6e64 6578 2063 6f6c 756d 6e20  ew index column 
+0002ca90: 7468 656e 2077 6520 6361 6e20 6176 6f69  then we can avoi
+0002caa0: 6420 7468 6520 696e 6974 6961 6c0a 2020  d the initial.  
+0002cab0: 2020 2020 2020 7061 7373 206f 7665 7220        pass over 
+0002cac0: 7468 6520 6461 7461 2e20 466f 7220 6578  the data. For ex
+0002cad0: 616d 706c 6520 6966 2079 6f75 7220 6e65  ample if your ne
+0002cae0: 7720 696e 6465 7820 6973 2061 2064 6174  w index is a dat
+0002caf0: 6574 696d 6520 696e 6465 7820 616e 640a  etime index and.
+0002cb00: 2020 2020 2020 2020 796f 7572 2064 6174          your dat
+0002cb10: 6120 6973 2061 6c72 6561 6479 2073 6f72  a is already sor
+0002cb20: 7465 6420 6279 2064 6179 2074 6865 6e20  ted by day then 
+0002cb30: 7468 6973 2065 6e74 6972 6520 6f70 6572  this entire oper
+0002cb40: 6174 696f 6e20 6361 6e20 6265 2064 6f6e  ation can be don
+0002cb50: 650a 2020 2020 2020 2020 666f 7220 6672  e.        for fr
+0002cb60: 6565 2e20 596f 7520 6361 6e20 636f 6e74  ee. You can cont
+0002cb70: 726f 6c20 7468 6573 6520 6f70 7469 6f6e  rol these option
+0002cb80: 7320 7769 7468 2074 6865 2066 6f6c 6c6f  s with the follo
+0002cb90: 7769 6e67 2070 6172 616d 6574 6572 732e  wing parameters.
+0002cba0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0002cbb0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+0002cbc0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002cbd0: 6f74 6865 723a 2073 7472 696e 6720 6f72  other: string or
+0002cbe0: 2044 6173 6b20 5365 7269 6573 0a20 2020   Dask Series.   
+0002cbf0: 2020 2020 2020 2020 2043 6f6c 756d 6e20           Column 
+0002cc00: 746f 2075 7365 2061 7320 696e 6465 782e  to use as index.
+0002cc10: 0a20 2020 2020 2020 2064 726f 703a 2062  .        drop: b
+0002cc20: 6f6f 6c65 616e 2c20 6465 6661 756c 7420  oolean, default 
+0002cc30: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+0002cc40: 2044 656c 6574 6520 636f 6c75 6d6e 2074   Delete column t
+0002cc50: 6f20 6265 2075 7365 6420 6173 2074 6865  o be used as the
+0002cc60: 206e 6577 2069 6e64 6578 2e0a 2020 2020   new index..    
+0002cc70: 2020 2020 736f 7274 6564 3a20 626f 6f6c      sorted: bool
+0002cc80: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0002cc90: 2020 2020 2020 2049 6620 7468 6520 696e         If the in
+0002cca0: 6465 7820 636f 6c75 6d6e 2069 7320 616c  dex column is al
+0002ccb0: 7265 6164 7920 736f 7274 6564 2069 6e20  ready sorted in 
+0002ccc0: 696e 6372 6561 7369 6e67 206f 7264 6572  increasing order
+0002ccd0: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
+0002cce0: 6661 756c 7473 2074 6f20 4661 6c73 650a  faults to False.
+0002ccf0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+0002cd00: 6f6e 733a 2069 6e74 2c20 4e6f 6e65 2c20  ons: int, None, 
+0002cd10: 6f72 2027 6175 746f 270a 2020 2020 2020  or 'auto'.      
+0002cd20: 2020 2020 2020 5468 6520 6964 6561 6c20        The ideal 
+0002cd30: 6e75 6d62 6572 206f 6620 6f75 7470 7574  number of output
+0002cd40: 2070 6172 7469 7469 6f6e 732e 2049 6620   partitions. If 
+0002cd50: 4e6f 6e65 2c20 7573 6520 7468 6520 7361  None, use the sa
+0002cd60: 6d65 2061 730a 2020 2020 2020 2020 2020  me as.          
+0002cd70: 2020 7468 6520 696e 7075 742e 2049 6620    the input. If 
+0002cd80: 2761 7574 6f27 2074 6865 6e20 6465 6369  'auto' then deci
+0002cd90: 6465 2062 7920 6d65 6d6f 7279 2075 7365  de by memory use
+0002cda0: 2e0a 2020 2020 2020 2020 2020 2020 4f6e  ..            On
+0002cdb0: 6c79 2075 7365 6420 7768 656e 2060 6064  ly used when ``d
+0002cdc0: 6976 6973 696f 6e73 6060 2069 7320 6e6f  ivisions`` is no
+0002cdd0: 7420 6769 7665 6e2e 2049 6620 6060 6469  t given. If ``di
+0002cde0: 7669 7369 6f6e 7360 6020 6973 2067 6976  visions`` is giv
+0002cdf0: 656e 2c0a 2020 2020 2020 2020 2020 2020  en,.            
+0002ce00: 7468 6520 6e75 6d62 6572 206f 6620 6f75  the number of ou
+0002ce10: 7470 7574 2070 6172 7469 7469 6f6e 7320  tput partitions 
+0002ce20: 7769 6c6c 2062 6520 6060 6c65 6e28 6469  will be ``len(di
+0002ce30: 7669 7369 6f6e 7329 202d 2031 6060 2e0a  visions) - 1``..
+0002ce40: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+0002ce50: 733a 206c 6973 742c 206f 7074 696f 6e61  s: list, optiona
+0002ce60: 6c0a 2020 2020 2020 2020 2020 2020 5468  l.            Th
+0002ce70: 6520 2264 6976 6964 696e 6720 6c69 6e65  e "dividing line
+0002ce80: 7322 2075 7365 6420 746f 2073 706c 6974  s" used to split
+0002ce90: 2074 6865 206e 6577 2069 6e64 6578 2069   the new index i
+0002cea0: 6e74 6f20 7061 7274 6974 696f 6e73 2e0a  nto partitions..
+0002ceb0: 2020 2020 2020 2020 2020 2020 466f 7220              For 
+0002cec0: 6060 6469 7669 7369 6f6e 733d 5b30 2c20  ``divisions=[0, 
+0002ced0: 3130 2c20 3530 2c20 3130 305d 6060 2c20  10, 50, 100]``, 
+0002cee0: 7468 6572 6520 776f 756c 6420 6265 2074  there would be t
+0002cef0: 6872 6565 206f 7574 7075 7420 7061 7274  hree output part
+0002cf00: 6974 696f 6e73 2c0a 2020 2020 2020 2020  itions,.        
+0002cf10: 2020 2020 7768 6572 6520 7468 6520 6e65      where the ne
+0002cf20: 7720 696e 6465 7820 636f 6e74 6169 6e65  w index containe
+0002cf30: 6420 5b30 2c20 3130 292c 205b 3130 2c20  d [0, 10), [10, 
+0002cf40: 3530 292c 2061 6e64 205b 3530 2c20 3130  50), and [50, 10
+0002cf50: 3029 2c20 7265 7370 6563 7469 7665 6c79  0), respectively
+0002cf60: 2e0a 2020 2020 2020 2020 2020 2020 5365  ..            Se
+0002cf70: 6520 6874 7470 733a 2f2f 646f 6373 2e64  e https://docs.d
+0002cf80: 6173 6b2e 6f72 672f 656e 2f6c 6174 6573  ask.org/en/lates
+0002cf90: 742f 6461 7461 6672 616d 652d 6465 7369  t/dataframe-desi
+0002cfa0: 676e 2e68 746d 6c23 7061 7274 6974 696f  gn.html#partitio
+0002cfb0: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
+0002cfc0: 4966 206e 6f74 2067 6976 656e 2028 6465  If not given (de
+0002cfd0: 6661 756c 7429 2c20 676f 6f64 2064 6976  fault), good div
+0002cfe0: 6973 696f 6e73 2061 7265 2063 616c 6375  isions are calcu
+0002cff0: 6c61 7465 6420 6279 2069 6d6d 6564 6961  lated by immedia
+0002d000: 7465 6c79 2063 6f6d 7075 7469 6e67 0a20  tely computing. 
+0002d010: 2020 2020 2020 2020 2020 2074 6865 2064             the d
+0002d020: 6174 6120 616e 6420 6c6f 6f6b 696e 6720  ata and looking 
+0002d030: 6174 2074 6865 2064 6973 7472 6962 7574  at the distribut
+0002d040: 696f 6e20 6f66 2069 7473 2076 616c 7565  ion of its value
+0002d050: 732e 2046 6f72 206c 6172 6765 2064 6174  s. For large dat
+0002d060: 6173 6574 732c 0a20 2020 2020 2020 2020  asets,.         
+0002d070: 2020 2074 6869 7320 6361 6e20 6265 2065     this can be e
+0002d080: 7870 656e 7369 7665 2e0a 2020 2020 2020  xpensive..      
+0002d090: 2020 2020 2020 4e6f 7465 2074 6861 7420        Note that 
+0002d0a0: 6966 2060 6073 6f72 7465 643d 5472 7565  if ``sorted=True
+0002d0b0: 6060 2c20 7370 6563 6966 6965 6420 6469  ``, specified di
+0002d0c0: 7669 7369 6f6e 7320 6172 6520 6173 7375  visions are assu
+0002d0d0: 6d65 6420 746f 206d 6174 6368 0a20 2020  med to match.   
+0002d0e0: 2020 2020 2020 2020 2074 6865 2065 7869           the exi
+0002d0f0: 7374 696e 6720 7061 7274 6974 696f 6e73  sting partitions
+0002d100: 2069 6e20 7468 6520 6461 7461 3b20 6966   in the data; if
+0002d110: 2074 6869 7320 6973 2075 6e74 7275 6520   this is untrue 
+0002d120: 796f 7520 7368 6f75 6c64 0a20 2020 2020  you should.     
+0002d130: 2020 2020 2020 206c 6561 7665 2064 6976         leave div
+0002d140: 6973 696f 6e73 2065 6d70 7479 2061 6e64  isions empty and
+0002d150: 2063 616c 6c20 6060 7265 7061 7274 6974   call ``repartit
+0002d160: 696f 6e60 6020 6166 7465 7220 6060 7365  ion`` after ``se
+0002d170: 745f 696e 6465 7860 602e 0a20 2020 2020  t_index``..     
+0002d180: 2020 2069 6e70 6c61 6365 3a20 626f 6f6c     inplace: bool
+0002d190: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0002d1a0: 2020 2020 2020 204d 6f64 6966 7969 6e67         Modifying
+0002d1b0: 2074 6865 2044 6174 6146 7261 6d65 2069   the DataFrame i
+0002d1c0: 6e20 706c 6163 6520 6973 206e 6f74 2073  n place is not s
+0002d1d0: 7570 706f 7274 6564 2062 7920 4461 736b  upported by Dask
+0002d1e0: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
+0002d1f0: 6661 756c 7473 2074 6f20 4661 6c73 652e  faults to False.
+0002d200: 0a20 2020 2020 2020 2073 6875 6666 6c65  .        shuffle
+0002d210: 3a20 7374 7269 6e67 2c20 2764 6973 6b27  : string, 'disk'
+0002d220: 206f 7220 2774 6173 6b73 272c 206f 7074   or 'tasks', opt
+0002d230: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0002d240: 2020 4569 7468 6572 2060 6027 6469 736b    Either ``'disk
+0002d250: 2760 6020 666f 7220 7369 6e67 6c65 2d6e  '`` for single-n
+0002d260: 6f64 6520 6f70 6572 6174 696f 6e20 6f72  ode operation or
+0002d270: 2060 6027 7461 736b 7327 6060 2066 6f72   ``'tasks'`` for
+0002d280: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+0002d290: 7472 6962 7574 6564 206f 7065 7261 7469  tributed operati
+0002d2a0: 6f6e 2e20 2057 696c 6c20 6265 2069 6e66  on.  Will be inf
+0002d2b0: 6572 7265 6420 6279 2079 6f75 7220 6375  erred by your cu
+0002d2c0: 7272 656e 7420 7363 6865 6475 6c65 722e  rrent scheduler.
+0002d2d0: 0a20 2020 2020 2020 2063 6f6d 7075 7465  .        compute
+0002d2e0: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
+0002d2f0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+0002d300: 2020 5768 6574 6865 7220 6f72 206e 6f74    Whether or not
+0002d310: 2074 6f20 7472 6967 6765 7220 616e 2069   to trigger an i
+0002d320: 6d6d 6564 6961 7465 2063 6f6d 7075 7461  mmediate computa
+0002d330: 7469 6f6e 2e20 4465 6661 756c 7473 2074  tion. Defaults t
+0002d340: 6f20 4661 6c73 652e 0a20 2020 2020 2020  o False..       
+0002d350: 2020 2020 204e 6f74 652c 2074 6861 7420       Note, that 
+0002d360: 6576 656e 2069 6620 796f 7520 7365 7420  even if you set 
+0002d370: 6060 636f 6d70 7574 653d 4661 6c73 6560  ``compute=False`
+0002d380: 602c 2061 6e20 696d 6d65 6469 6174 6520  `, an immediate 
+0002d390: 636f 6d70 7574 6174 696f 6e0a 2020 2020  computation.    
+0002d3a0: 2020 2020 2020 2020 7769 6c6c 2073 7469          will sti
+0002d3b0: 6c6c 2062 6520 7472 6967 6765 7265 6420  ll be triggered 
+0002d3c0: 6966 2060 6064 6976 6973 696f 6e73 6060  if ``divisions``
+0002d3d0: 2069 7320 6060 4e6f 6e65 6060 2e0a 2020   is ``None``..  
+0002d3e0: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
+0002d3f0: 7369 7a65 3a20 696e 742c 206f 7074 696f  size: int, optio
+0002d400: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0002d410: 4465 7369 7265 6420 7369 7a65 206f 6620  Desired size of 
+0002d420: 6561 6368 2070 6172 7469 7469 6f6e 7320  each partitions 
+0002d430: 696e 2062 7974 6573 2e0a 2020 2020 2020  in bytes..      
+0002d440: 2020 2020 2020 4f6e 6c79 2075 7365 6420        Only used 
+0002d450: 7768 656e 2060 606e 7061 7274 6974 696f  when ``npartitio
+0002d460: 6e73 3d27 6175 746f 2760 600a 0a20 2020  ns='auto'``..   
+0002d470: 2020 2020 2045 7861 6d70 6c65 730a 2020       Examples.  
+0002d480: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+0002d490: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
+0002d4a0: 7420 6461 736b 0a20 2020 2020 2020 203e  t dask.        >
+0002d4b0: 3e3e 2064 6466 203d 2064 6173 6b2e 6461  >> ddf = dask.da
+0002d4c0: 7461 7365 7473 2e74 696d 6573 6572 6965  tasets.timeserie
+0002d4d0: 7328 7374 6172 743d 2232 3032 312d 3031  s(start="2021-01
+0002d4e0: 2d30 3122 2c20 656e 643d 2232 3032 312d  -01", end="2021-
+0002d4f0: 3031 2d30 3722 2c20 6672 6571 3d22 3148  01-07", freq="1H
+0002d500: 2229 2e72 6573 6574 5f69 6e64 6578 2829  ").reset_index()
+0002d510: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
+0002d520: 3220 3d20 6464 662e 7365 745f 696e 6465  2 = ddf.set_inde
+0002d530: 7828 2278 2229 0a20 2020 2020 2020 203e  x("x").        >
+0002d540: 3e3e 2064 6466 3220 3d20 6464 662e 7365  >> ddf2 = ddf.se
+0002d550: 745f 696e 6465 7828 6464 662e 7829 0a20  t_index(ddf.x). 
+0002d560: 2020 2020 2020 203e 3e3e 2064 6466 3220         >>> ddf2 
+0002d570: 3d20 6464 662e 7365 745f 696e 6465 7828  = ddf.set_index(
+0002d580: 6464 662e 7469 6d65 7374 616d 702c 2073  ddf.timestamp, s
+0002d590: 6f72 7465 643d 5472 7565 290a 0a20 2020  orted=True)..   
+0002d5a0: 2020 2020 2041 2063 6f6d 6d6f 6e20 6361       A common ca
+0002d5b0: 7365 2069 7320 7768 656e 2077 6520 6861  se is when we ha
+0002d5c0: 7665 2061 2064 6174 6574 696d 6520 636f  ve a datetime co
+0002d5d0: 6c75 6d6e 2074 6861 7420 7765 206b 6e6f  lumn that we kno
+0002d5e0: 7720 746f 2062 650a 2020 2020 2020 2020  w to be.        
+0002d5f0: 736f 7274 6564 2061 6e64 2069 7320 636c  sorted and is cl
+0002d600: 6561 6e6c 7920 6469 7669 6465 6420 6279  eanly divided by
+0002d610: 2064 6179 2e20 2057 6520 6361 6e20 7365   day.  We can se
+0002d620: 7420 7468 6973 2069 6e64 6578 2066 6f72  t this index for
+0002d630: 2066 7265 650a 2020 2020 2020 2020 6279   free.        by
+0002d640: 2073 7065 6369 6679 696e 6720 626f 7468   specifying both
+0002d650: 2074 6861 7420 7468 6520 636f 6c75 6d6e   that the column
+0002d660: 2069 7320 7072 652d 736f 7274 6564 2061   is pre-sorted a
+0002d670: 6e64 2074 6865 2070 6172 7469 6375 6c61  nd the particula
+0002d680: 720a 2020 2020 2020 2020 6469 7669 7369  r.        divisi
+0002d690: 6f6e 7320 616c 6f6e 6720 7768 6963 6820  ons along which 
+0002d6a0: 6973 2069 7320 7365 7061 7261 7465 640a  is is separated.
+0002d6b0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+0002d6c0: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
+0002d6d0: 0a20 2020 2020 2020 203e 3e3e 2064 6976  .        >>> div
+0002d6e0: 6973 696f 6e73 203d 2070 642e 6461 7465  isions = pd.date
+0002d6f0: 5f72 616e 6765 2873 7461 7274 3d22 3230  _range(start="20
+0002d700: 3231 2d30 312d 3031 222c 2065 6e64 3d22  21-01-01", end="
+0002d710: 3230 3231 2d30 312d 3037 222c 2066 7265  2021-01-07", fre
+0002d720: 713d 2731 4427 290a 2020 2020 2020 2020  q='1D').        
+0002d730: 3e3e 3e20 6469 7669 7369 6f6e 730a 2020  >>> divisions.  
+0002d740: 2020 2020 2020 4461 7465 7469 6d65 496e        DatetimeIn
+0002d750: 6465 7828 5b27 3230 3231 2d30 312d 3031  dex(['2021-01-01
+0002d760: 272c 2027 3230 3231 2d30 312d 3032 272c  ', '2021-01-02',
+0002d770: 2027 3230 3231 2d30 312d 3033 272c 2027   '2021-01-03', '
+0002d780: 3230 3231 2d30 312d 3034 272c 0a20 2020  2021-01-04',.   
 0002d790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d7a0: 2020 2022 4461 736b 2064 6174 6166 7261     "Dask datafra
-0002d7b0: 6d65 2064 6f65 7320 6e6f 7420 7965 7420  me does not yet 
-0002d7c0: 7375 7070 6f72 7420 6d75 6c74 692d 696e  support multi-in
-0002d7d0: 6465 7865 732e 5c6e 220a 2020 2020 2020  dexes.\n".      
-0002d7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d7f0: 2020 6622 596f 7520 7472 6965 6420 746f    f"You tried to
-0002d800: 2069 6e64 6578 2077 6974 6820 7468 6973   index with this
-0002d810: 2069 6e64 6578 3a20 7b6f 7468 6572 7d5c   index: {other}\
-0002d820: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
-0002d830: 2020 2020 2020 2020 2020 2022 496e 6465             "Inde
-0002d840: 7865 7320 6d75 7374 2062 6520 7369 6e67  xes must be sing
-0002d850: 6c65 2063 6f6c 756d 6e73 206f 6e6c 792e  le columns only.
-0002d860: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0002d870: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0002d880: 2020 2020 2023 204f 7220 6265 2061 2066       # Or be a f
-0002d890: 7261 6d65 2064 6972 6563 746c 790a 2020  rame directly.  
-0002d8a0: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
-0002d8b0: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
-0002d8c0: 2044 6174 6146 7261 6d65 293a 2020 2320   DataFrame):  # 
-0002d8d0: 7479 7065 3a20 6967 6e6f 7265 5b75 6e72  type: ignore[unr
-0002d8e0: 6561 6368 6162 6c65 5d0a 2020 2020 2020  eachable].      
-0002d8f0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0002d900: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-0002d910: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0002d920: 2020 2020 2020 2020 2022 4461 736b 2064           "Dask d
-0002d930: 6174 6166 7261 6d65 2064 6f65 7320 6e6f  ataframe does no
-0002d940: 7420 7965 7420 7375 7070 6f72 7420 6d75  t yet support mu
-0002d950: 6c74 692d 696e 6465 7865 732e 5c6e 220a  lti-indexes.\n".
-0002d960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d970: 2020 2020 6622 596f 7520 7472 6965 6420      f"You tried 
-0002d980: 746f 2069 6e64 6578 2077 6974 6820 6120  to index with a 
-0002d990: 6672 616d 6520 7769 7468 2074 6865 7365  frame with these
-0002d9a0: 2063 6f6c 756d 6e73 3a20 7b6c 6973 7428   columns: {list(
-0002d9b0: 6f74 6865 722e 636f 6c75 6d6e 7329 7d5c  other.columns)}\
-0002d9c0: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
-0002d9d0: 2020 2020 2020 2022 496e 6465 7865 7320         "Indexes 
-0002d9e0: 6d75 7374 2062 6520 7369 6e67 6c65 2063  must be single c
-0002d9f0: 6f6c 756d 6e73 206f 6e6c 792e 220a 2020  olumns only.".  
-0002da00: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0002da10: 0a20 2020 2020 2020 2023 2049 6620 616c  .        # If al
-0002da20: 7265 6164 7920 6120 7365 7269 6573 0a20  ready a series. 
-0002da30: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0002da40: 616e 6365 286f 7468 6572 2c20 5365 7269  ance(other, Seri
-0002da50: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
-0002da60: 2023 2049 6620 6974 2773 2061 6c72 6561   # If it's alrea
-0002da70: 6479 2074 6865 2069 6e64 6578 2c20 7468  dy the index, th
-0002da80: 6572 6527 7320 6e6f 7468 696e 6720 746f  ere's nothing to
-0002da90: 2064 6f0a 2020 2020 2020 2020 2020 2020   do.            
-0002daa0: 6966 206f 7468 6572 2e5f 6e61 6d65 203d  if other._name =
-0002dab0: 3d20 7365 6c66 2e69 6e64 6578 2e5f 6e61  = self.index._na
-0002dac0: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
-0002dad0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-0002dae0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-0002daf0: 2020 2020 2020 2022 4e65 7720 696e 6465         "New inde
-0002db00: 7820 6861 7320 7361 6d65 206e 616d 6520  x has same name 
-0002db10: 6173 2065 7869 7374 696e 672c 2074 6869  as existing, thi
-0002db20: 7320 6973 2061 206e 6f2d 6f70 2e22 2c20  s is a no-op.", 
-0002db30: 5573 6572 5761 726e 696e 670a 2020 2020  UserWarning.    
-0002db40: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0002db50: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0002db60: 7475 726e 2073 656c 660a 0a20 2020 2020  turn self..     
-0002db70: 2020 2023 2049 6620 7468 6520 6e61 6d65     # If the name
-0002db80: 206f 6620 6120 636f 6c75 6d6e 2f69 6e64   of a column/ind
-0002db90: 6578 0a20 2020 2020 2020 2065 6c73 653a  ex.        else:
-0002dba0: 0a20 2020 2020 2020 2020 2020 2023 2057  .            # W
-0002dbb0: 6974 6820 7468 6520 7361 6d65 206e 616d  ith the same nam
-0002dbc0: 6520 6173 2074 6865 2069 6e64 6578 2c20  e as the index, 
-0002dbd0: 7468 6572 6527 7320 6e6f 7468 696e 6720  there's nothing 
-0002dbe0: 746f 2064 6f20 6569 7468 6572 0a20 2020  to do either.   
-0002dbf0: 2020 2020 2020 2020 2069 6620 6f74 6865           if othe
-0002dc00: 7220 3d3d 2073 656c 662e 696e 6465 782e  r == self.index.
-0002dc10: 6e61 6d65 3a0a 2020 2020 2020 2020 2020  name:.          
-0002dc20: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-0002dc30: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-0002dc40: 2020 2020 2020 2020 2022 4e65 7720 696e           "New in
-0002dc50: 6465 7820 6861 7320 7361 6d65 206e 616d  dex has same nam
-0002dc60: 6520 6173 2065 7869 7374 696e 672c 2074  e as existing, t
-0002dc70: 6869 7320 6973 2061 206e 6f2d 6f70 2e22  his is a no-op."
-0002dc80: 2c20 5573 6572 5761 726e 696e 670a 2020  , UserWarning.  
-0002dc90: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0002dca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dcb0: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
-0002dcc0: 2020 2020 2020 2020 2023 2049 6620 6120           # If a 
-0002dcd0: 6d69 7373 696e 6720 636f 6c75 6d6e 2c20  missing column, 
-0002dce0: 4b65 7945 7272 6f72 0a20 2020 2020 2020  KeyError.       
-0002dcf0: 2020 2020 2069 6620 6f74 6865 7220 6e6f       if other no
-0002dd00: 7420 696e 2073 656c 662e 636f 6c75 6d6e  t in self.column
-0002dd10: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-0002dd20: 2020 2072 6169 7365 204b 6579 4572 726f     raise KeyErro
-0002dd30: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0002dd40: 2020 2020 2020 2066 2244 6174 6120 6861         f"Data ha
-0002dd50: 7320 6e6f 2063 6f6c 756d 6e20 277b 6f74  s no column '{ot
-0002dd60: 6865 727d 273a 2075 7365 2061 6e79 2063  her}': use any c
-0002dd70: 6f6c 756d 6e20 6f66 207b 6c69 7374 2873  olumn of {list(s
-0002dd80: 656c 662e 636f 6c75 6d6e 7329 7d22 0a20  elf.columns)}". 
-0002dd90: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0002dda0: 0a0a 2020 2020 2020 2020 2320 4368 6563  ..        # Chec
-0002ddb0: 6b20 6469 7669 7369 6f6e 730a 2020 2020  k divisions.    
-0002ddc0: 2020 2020 6966 2064 6976 6973 696f 6e73      if divisions
-0002ddd0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0002dde0: 2020 2020 2020 2020 2020 6368 6563 6b5f            check_
-0002ddf0: 6469 7669 7369 6f6e 7328 6469 7669 7369  divisions(divisi
-0002de00: 6f6e 7329 0a20 2020 2020 2020 2065 6c69  ons).        eli
-0002de10: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-0002de20: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
-0002de30: 2c20 496e 6465 7829 0a20 2020 2020 2020  , Index).       
-0002de40: 2020 2020 2061 6e64 206f 7468 6572 2e6b       and other.k
-0002de50: 6e6f 776e 5f64 6976 6973 696f 6e73 0a20  nown_divisions. 
-0002de60: 2020 2020 2020 2020 2020 2061 6e64 206f             and o
-0002de70: 7468 6572 2e6e 7061 7274 6974 696f 6e73  ther.npartitions
-0002de80: 203d 3d20 7365 6c66 2e6e 7061 7274 6974   == self.npartit
-0002de90: 696f 6e73 0a20 2020 2020 2020 2029 3a0a  ions.        ):.
-0002dea0: 2020 2020 2020 2020 2020 2020 2320 4966              # If
-0002deb0: 2074 6865 2069 6e64 6578 2068 6173 2074   the index has t
-0002dec0: 6865 2073 616d 6520 6e75 6d62 6572 206f  he same number o
-0002ded0: 6620 7061 7274 6974 696f 6e73 2061 6e64  f partitions and
-0002dee0: 206b 6e6f 776e 0a20 2020 2020 2020 2020   known.         
-0002def0: 2020 2023 2064 6976 6973 696f 6e73 2c20     # divisions, 
-0002df00: 7468 656e 2077 6520 6361 6e20 7472 6561  then we can trea
-0002df10: 7420 6974 2061 7320 7072 652d 736f 7274  t it as pre-sort
-0002df20: 6564 2077 6974 6820 6b6e 6f77 6e0a 2020  ed with known.  
-0002df30: 2020 2020 2020 2020 2020 2320 6469 7669            # divi
-0002df40: 7369 6f6e 730a 2020 2020 2020 2020 2020  sions.          
-0002df50: 2020 7072 655f 736f 7274 6564 203d 2054    pre_sorted = T
-0002df60: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-0002df70: 6469 7669 7369 6f6e 7320 3d20 6f74 6865  divisions = othe
-0002df80: 722e 6469 7669 7369 6f6e 730a 0a20 2020  r.divisions..   
-0002df90: 2020 2020 2023 2049 6620 696e 6465 7820       # If index 
-0002dfa0: 6973 2061 6c72 6561 6479 2073 6f72 7465  is already sorte
-0002dfb0: 642c 2074 616b 6520 6164 7661 6e74 6167  d, take advantag
-0002dfc0: 6520 6f66 2074 6861 7420 7769 7468 2073  e of that with s
-0002dfd0: 6574 5f73 6f72 7465 645f 696e 6465 780a  et_sorted_index.
-0002dfe0: 2020 2020 2020 2020 6966 2070 7265 5f73          if pre_s
-0002dff0: 6f72 7465 643a 0a20 2020 2020 2020 2020  orted:.         
-0002e000: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-0002e010: 6166 7261 6d65 2e73 6875 6666 6c65 2069  aframe.shuffle i
-0002e020: 6d70 6f72 7420 7365 745f 736f 7274 6564  mport set_sorted
-0002e030: 5f69 6e64 6578 0a0a 2020 2020 2020 2020  _index..        
-0002e040: 2020 2020 7265 7475 726e 2073 6574 5f73      return set_s
-0002e050: 6f72 7465 645f 696e 6465 7828 0a20 2020  orted_index(.   
-0002e060: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0002e070: 662c 206f 7468 6572 2c20 6472 6f70 3d64  f, other, drop=d
-0002e080: 726f 702c 2064 6976 6973 696f 6e73 3d64  rop, divisions=d
-0002e090: 6976 6973 696f 6e73 2c20 2a2a 6b77 6172  ivisions, **kwar
-0002e0a0: 6773 0a20 2020 2020 2020 2020 2020 2029  gs.            )
-0002e0b0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0002e0c0: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-0002e0d0: 6461 736b 2e64 6174 6166 7261 6d65 2e73  dask.dataframe.s
-0002e0e0: 6875 6666 6c65 2069 6d70 6f72 7420 7365  huffle import se
-0002e0f0: 745f 696e 6465 780a 0a20 2020 2020 2020  t_index..       
-0002e100: 2020 2020 2072 6574 7572 6e20 7365 745f       return set_
-0002e110: 696e 6465 7828 0a20 2020 2020 2020 2020  index(.         
-0002e120: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0002e130: 2020 2020 2020 2020 2020 2020 206f 7468               oth
-0002e140: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-0002e150: 2020 2020 6472 6f70 3d64 726f 702c 0a20      drop=drop,. 
-0002e160: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0002e170: 7061 7274 6974 696f 6e73 3d6e 7061 7274  partitions=npart
-0002e180: 6974 696f 6e73 2c0a 2020 2020 2020 2020  itions,.        
-0002e190: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
-0002e1a0: 733d 6469 7669 7369 6f6e 732c 0a20 2020  s=divisions,.   
-0002e1b0: 2020 2020 2020 2020 2020 2020 202a 2a6b               **k
-0002e1c0: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
-0002e1d0: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
-0002e1e0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-0002e1f0: 7261 6d65 290a 2020 2020 6465 6620 706f  rame).    def po
-0002e200: 7028 7365 6c66 2c20 6974 656d 293a 0a20  p(self, item):. 
-0002e210: 2020 2020 2020 206f 7574 203d 2073 656c         out = sel
-0002e220: 665b 6974 656d 5d0a 2020 2020 2020 2020  f[item].        
-0002e230: 6465 6c20 7365 6c66 5b69 7465 6d5d 0a20  del self[item]. 
-0002e240: 2020 2020 2020 2072 6574 7572 6e20 6f75         return ou
-0002e250: 740a 0a20 2020 2040 6465 7269 7665 645f  t..    @derived_
-0002e260: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-0002e270: 6529 0a20 2020 2064 6566 206e 6c61 7267  e).    def nlarg
-0002e280: 6573 7428 7365 6c66 2c20 6e3d 352c 2063  est(self, n=5, c
-0002e290: 6f6c 756d 6e73 3d4e 6f6e 652c 2073 706c  olumns=None, spl
-0002e2a0: 6974 5f65 7665 7279 3d4e 6f6e 6529 3a0a  it_every=None):.
-0002e2b0: 2020 2020 2020 2020 746f 6b65 6e20 3d20          token = 
-0002e2c0: 2264 6174 6166 7261 6d65 2d6e 6c61 7267  "dataframe-nlarg
-0002e2d0: 6573 7422 0a20 2020 2020 2020 2072 6574  est".        ret
-0002e2e0: 7572 6e20 6163 6128 0a20 2020 2020 2020  urn aca(.       
-0002e2f0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0002e300: 2020 2020 2020 2063 6875 6e6b 3d4d 2e6e         chunk=M.n
-0002e310: 6c61 7267 6573 742c 0a20 2020 2020 2020  largest,.       
-0002e320: 2020 2020 2061 6767 7265 6761 7465 3d4d       aggregate=M
-0002e330: 2e6e 6c61 7267 6573 742c 0a20 2020 2020  .nlargest,.     
-0002e340: 2020 2020 2020 206d 6574 613d 7365 6c66         meta=self
-0002e350: 2e5f 6d65 7461 2c0a 2020 2020 2020 2020  ._meta,.        
-0002e360: 2020 2020 746f 6b65 6e3d 746f 6b65 6e2c      token=token,
-0002e370: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-0002e380: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-0002e390: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
-0002e3a0: 2020 6e3d 6e2c 0a20 2020 2020 2020 2020    n=n,.         
-0002e3b0: 2020 2063 6f6c 756d 6e73 3d63 6f6c 756d     columns=colum
-0002e3c0: 6e73 2c0a 2020 2020 2020 2020 290a 0a20  ns,.        ).. 
-0002e3d0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0002e3e0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0002e3f0: 2020 2064 6566 206e 736d 616c 6c65 7374     def nsmallest
-0002e400: 2873 656c 662c 206e 3d35 2c20 636f 6c75  (self, n=5, colu
-0002e410: 6d6e 733d 4e6f 6e65 2c20 7370 6c69 745f  mns=None, split_
-0002e420: 6576 6572 793d 4e6f 6e65 293a 0a20 2020  every=None):.   
-0002e430: 2020 2020 2074 6f6b 656e 203d 2022 6461       token = "da
-0002e440: 7461 6672 616d 652d 6e73 6d61 6c6c 6573  taframe-nsmalles
-0002e450: 7422 0a20 2020 2020 2020 2072 6574 7572  t".        retur
-0002e460: 6e20 6163 6128 0a20 2020 2020 2020 2020  n aca(.         
-0002e470: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0002e480: 2020 2020 2063 6875 6e6b 3d4d 2e6e 736d       chunk=M.nsm
-0002e490: 616c 6c65 7374 2c0a 2020 2020 2020 2020  allest,.        
-0002e4a0: 2020 2020 6167 6772 6567 6174 653d 4d2e      aggregate=M.
-0002e4b0: 6e73 6d61 6c6c 6573 742c 0a20 2020 2020  nsmallest,.     
-0002e4c0: 2020 2020 2020 206d 6574 613d 7365 6c66         meta=self
-0002e4d0: 2e5f 6d65 7461 2c0a 2020 2020 2020 2020  ._meta,.        
-0002e4e0: 2020 2020 746f 6b65 6e3d 746f 6b65 6e2c      token=token,
-0002e4f0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-0002e500: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-0002e510: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
-0002e520: 2020 6e3d 6e2c 0a20 2020 2020 2020 2020    n=n,.         
-0002e530: 2020 2063 6f6c 756d 6e73 3d63 6f6c 756d     columns=colum
-0002e540: 6e73 2c0a 2020 2020 2020 2020 290a 0a20  ns,.        ).. 
-0002e550: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0002e560: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0002e570: 2020 2064 6566 2067 726f 7570 6279 280a     def groupby(.
-0002e580: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0002e590: 2020 2020 2020 6279 3d4e 6f6e 652c 0a20        by=None,. 
-0002e5a0: 2020 2020 2020 2067 726f 7570 5f6b 6579         group_key
-0002e5b0: 733d 4752 4f55 505f 4b45 5953 5f44 4546  s=GROUP_KEYS_DEF
-0002e5c0: 4155 4c54 2c0a 2020 2020 2020 2020 736f  AULT,.        so
-0002e5d0: 7274 3d4e 6f6e 652c 0a20 2020 2020 2020  rt=None,.       
-0002e5e0: 206f 6273 6572 7665 643d 4e6f 6e65 2c0a   observed=None,.
-0002e5f0: 2020 2020 2020 2020 6472 6f70 6e61 3d4e          dropna=N
-0002e600: 6f6e 652c 0a20 2020 2020 2020 202a 2a6b  one,.        **k
-0002e610: 7761 7267 732c 0a20 2020 2029 3a0a 2020  wargs,.    ):.  
-0002e620: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-0002e630: 6461 7461 6672 616d 652e 6772 6f75 7062  dataframe.groupb
-0002e640: 7920 696d 706f 7274 2044 6174 6146 7261  y import DataFra
-0002e650: 6d65 4772 6f75 7042 790a 0a20 2020 2020  meGroupBy..     
-0002e660: 2020 2072 6574 7572 6e20 4461 7461 4672     return DataFr
-0002e670: 616d 6547 726f 7570 4279 280a 2020 2020  ameGroupBy(.    
-0002e680: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0002e690: 2020 2020 2020 2020 2020 6279 3d62 792c            by=by,
-0002e6a0: 0a20 2020 2020 2020 2020 2020 2067 726f  .            gro
-0002e6b0: 7570 5f6b 6579 733d 6772 6f75 705f 6b65  up_keys=group_ke
-0002e6c0: 7973 2c0a 2020 2020 2020 2020 2020 2020  ys,.            
-0002e6d0: 736f 7274 3d73 6f72 742c 0a20 2020 2020  sort=sort,.     
-0002e6e0: 2020 2020 2020 206f 6273 6572 7665 643d         observed=
-0002e6f0: 6f62 7365 7276 6564 2c0a 2020 2020 2020  observed,.      
-0002e700: 2020 2020 2020 6472 6f70 6e61 3d64 726f        dropna=dro
-0002e710: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
-0002e720: 202a 2a6b 7761 7267 732c 0a20 2020 2020   **kwargs,.     
-0002e730: 2020 2029 0a0a 2020 2020 4077 7261 7073     )..    @wraps
-0002e740: 2863 6174 6567 6f72 697a 6529 0a20 2020  (categorize).   
-0002e750: 2064 6566 2063 6174 6567 6f72 697a 6528   def categorize(
-0002e760: 7365 6c66 2c20 636f 6c75 6d6e 733d 4e6f  self, columns=No
-0002e770: 6e65 2c20 696e 6465 783d 4e6f 6e65 2c20  ne, index=None, 
-0002e780: 7370 6c69 745f 6576 6572 793d 4e6f 6e65  split_every=None
-0002e790: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-0002e7a0: 2020 2020 2072 6574 7572 6e20 6361 7465       return cate
-0002e7b0: 676f 7269 7a65 280a 2020 2020 2020 2020  gorize(.        
-0002e7c0: 2020 2020 7365 6c66 2c20 636f 6c75 6d6e      self, column
-0002e7d0: 733d 636f 6c75 6d6e 732c 2069 6e64 6578  s=columns, index
-0002e7e0: 3d69 6e64 6578 2c20 7370 6c69 745f 6576  =index, split_ev
-0002e7f0: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
-0002e800: 202a 2a6b 7761 7267 730a 2020 2020 2020   **kwargs.      
-0002e810: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
-0002e820: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-0002e830: 616d 6529 0a20 2020 2064 6566 2061 7373  ame).    def ass
-0002e840: 6967 6e28 7365 6c66 2c20 2a2a 6b77 6172  ign(self, **kwar
-0002e850: 6773 293a 0a20 2020 2020 2020 2064 6174  gs):.        dat
-0002e860: 6120 3d20 7365 6c66 2e63 6f70 7928 290a  a = self.copy().
-0002e870: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
-0002e880: 2069 6e20 6b77 6172 6773 2e69 7465 6d73   in kwargs.items
-0002e890: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0002e8a0: 6966 206e 6f74 2028 0a20 2020 2020 2020  if not (.       
-0002e8b0: 2020 2020 2020 2020 2069 7369 6e73 7461           isinsta
-0002e8c0: 6e63 6528 762c 2053 6361 6c61 7229 0a20  nce(v, Scalar). 
-0002e8d0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0002e8e0: 7220 6973 5f73 6572 6965 735f 6c69 6b65  r is_series_like
-0002e8f0: 2876 290a 2020 2020 2020 2020 2020 2020  (v).            
-0002e900: 2020 2020 6f72 2063 616c 6c61 626c 6528      or callable(
-0002e910: 7629 0a20 2020 2020 2020 2020 2020 2020  v).             
-0002e920: 2020 206f 7220 7064 2e61 7069 2e74 7970     or pd.api.typ
-0002e930: 6573 2e69 735f 7363 616c 6172 2876 290a  es.is_scalar(v).
-0002e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e950: 6f72 2069 735f 696e 6465 785f 6c69 6b65  or is_index_like
-0002e960: 2876 290a 2020 2020 2020 2020 2020 2020  (v).            
-0002e970: 2020 2020 6f72 2069 7369 6e73 7461 6e63      or isinstanc
-0002e980: 6528 762c 2041 7272 6179 290a 2020 2020  e(v, Array).    
-0002e990: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-0002e9a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0002e9b0: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
-0002e9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e9d0: 6622 436f 6c75 6d6e 2061 7373 6967 6e6d  f"Column assignm
-0002e9e0: 656e 7420 646f 6573 6e27 7420 7375 7070  ent doesn't supp
-0002e9f0: 6f72 7420 7479 7065 207b 7479 7065 6e61  ort type {typena
-0002ea00: 6d65 2874 7970 6528 7629 297d 220a 2020  me(type(v))}".  
-0002ea10: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0002ea20: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-0002ea30: 616c 6c61 626c 6528 7629 3a0a 2020 2020  allable(v):.    
-0002ea40: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
-0002ea50: 6773 5b6b 5d20 3d20 7628 6461 7461 290a  gs[k] = v(data).
-0002ea60: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0002ea70: 7369 6e73 7461 6e63 6528 762c 2041 7272  sinstance(v, Arr
-0002ea80: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
-0002ea90: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-0002eaa0: 6174 6166 7261 6d65 2e69 6f20 696d 706f  ataframe.io impo
-0002eab0: 7274 2066 726f 6d5f 6461 736b 5f61 7272  rt from_dask_arr
-0002eac0: 6179 0a0a 2020 2020 2020 2020 2020 2020  ay..            
-0002ead0: 2020 2020 6966 206c 656e 2876 2e73 6861      if len(v.sha
-0002eae0: 7065 2920 3e20 313a 0a20 2020 2020 2020  pe) > 1:.       
-0002eaf0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0002eb00: 7365 2056 616c 7565 4572 726f 7228 2241  se ValueError("A
-0002eb10: 7272 6179 2061 7373 6967 6e6d 656e 7420  rray assignment 
-0002eb20: 6f6e 6c79 2073 7570 706f 7274 7320 312d  only supports 1-
-0002eb30: 4420 6172 7261 7973 2229 0a20 2020 2020  D arrays").     
-0002eb40: 2020 2020 2020 2020 2020 2069 6620 762e             if v.
-0002eb50: 6e70 6172 7469 7469 6f6e 7320 213d 2064  npartitions != d
-0002eb60: 6174 612e 6e70 6172 7469 7469 6f6e 733a  ata.npartitions:
-0002eb70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002eb80: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0002eb90: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0002eba0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002ebb0: 4e75 6d62 6572 206f 6620 7061 7274 6974  Number of partit
-0002ebc0: 696f 6e73 2064 6f20 6e6f 7420 6d61 7463  ions do not matc
-0002ebd0: 6820 220a 2020 2020 2020 2020 2020 2020  h ".            
-0002ebe0: 2020 2020 2020 2020 2020 2020 6622 287b              f"({
-0002ebf0: 762e 6e70 6172 7469 7469 6f6e 737d 2021  v.npartitions} !
-0002ec00: 3d20 7b64 6174 612e 6e70 6172 7469 7469  = {data.npartiti
-0002ec10: 6f6e 737d 2922 0a20 2020 2020 2020 2020  ons})".         
-0002ec20: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0002ec30: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
-0002ec40: 7267 735b 6b5d 203d 2066 726f 6d5f 6461  rgs[k] = from_da
-0002ec50: 736b 5f61 7272 6179 2876 2c20 696e 6465  sk_array(v, inde
-0002ec60: 783d 6461 7461 2e69 6e64 6578 2c20 6d65  x=data.index, me
-0002ec70: 7461 3d64 6174 612e 5f6d 6574 6129 0a0a  ta=data._meta)..
-0002ec80: 2020 2020 2020 2020 2020 2020 7061 6972              pair
-0002ec90: 7320 3d20 5b6b 2c20 6b77 6172 6773 5b6b  s = [k, kwargs[k
-0002eca0: 5d5d 0a0a 2020 2020 2020 2020 2020 2020  ]]..            
-0002ecb0: 2320 4669 6775 7265 206f 7574 2063 6f6c  # Figure out col
-0002ecc0: 756d 6e73 206f 6620 7468 6520 6f75 7470  umns of the outp
-0002ecd0: 7574 0a20 2020 2020 2020 2020 2020 2064  ut.            d
-0002ece0: 6632 203d 2064 6174 612e 5f6d 6574 615f  f2 = data._meta_
-0002ecf0: 6e6f 6e65 6d70 7479 2e61 7373 6967 6e28  nonempty.assign(
-0002ed00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ed10: 202a 2a5f 6578 7472 6163 745f 6d65 7461   **_extract_meta
-0002ed20: 287b 6b3a 206b 7761 7267 735b 6b5d 7d2c  ({k: kwargs[k]},
-0002ed30: 206e 6f6e 656d 7074 793d 5472 7565 290a   nonempty=True).
-0002ed40: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0002ed50: 2020 2020 2020 2020 2020 6461 7461 203d            data =
-0002ed60: 2065 6c65 6d77 6973 6528 6d65 7468 6f64   elemwise(method
-0002ed70: 732e 6173 7369 676e 2c20 6461 7461 2c20  s.assign, data, 
-0002ed80: 2a70 6169 7273 2c20 6d65 7461 3d64 6632  *pairs, meta=df2
-0002ed90: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-0002eda0: 6e20 6461 7461 0a0a 2020 2020 4064 6572  n data..    @der
-0002edb0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-0002edc0: 6146 7261 6d65 2c20 7561 5f61 7267 733d  aFrame, ua_args=
-0002edd0: 5b22 696e 6465 7822 5d29 0a20 2020 2064  ["index"]).    d
-0002ede0: 6566 2072 656e 616d 6528 7365 6c66 2c20  ef rename(self, 
-0002edf0: 696e 6465 783d 4e6f 6e65 2c20 636f 6c75  index=None, colu
-0002ee00: 6d6e 733d 4e6f 6e65 293a 0a20 2020 2020  mns=None):.     
-0002ee10: 2020 2069 6620 696e 6465 7820 6973 206e     if index is n
-0002ee20: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0002ee30: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0002ee40: 4572 726f 7228 2243 616e 6e6f 7420 7265  Error("Cannot re
-0002ee50: 6e61 6d65 2069 6e64 6578 2e22 290a 0a20  name index.").. 
-0002ee60: 2020 2020 2020 2023 202a 6172 6773 2068         # *args h
-0002ee70: 6572 6520 6973 2069 6e64 6578 2c20 636f  ere is index, co
-0002ee80: 6c75 6d6e 7320 6275 7420 636f 6c75 6d6e  lumns but column
-0002ee90: 7320 6172 6720 6973 2061 6c72 6561 6479  s arg is already
-0002eea0: 2075 7365 640a 2020 2020 2020 2020 7265   used.        re
-0002eeb0: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
-0002eec0: 7274 6974 696f 6e73 284d 2e72 656e 616d  rtitions(M.renam
-0002eed0: 652c 204e 6f6e 652c 2063 6f6c 756d 6e73  e, None, columns
-0002eee0: 3d63 6f6c 756d 6e73 290a 0a20 2020 2064  =columns)..    d
-0002eef0: 6566 2071 7565 7279 2873 656c 662c 2065  ef query(self, e
-0002ef00: 7870 722c 202a 2a6b 7761 7267 7329 3a0a  xpr, **kwargs):.
-0002ef10: 2020 2020 2020 2020 2222 2246 696c 7465          """Filte
-0002ef20: 7220 6461 7461 6672 616d 6520 7769 7468  r dataframe with
-0002ef30: 2063 6f6d 706c 6578 2065 7870 7265 7373   complex express
-0002ef40: 696f 6e0a 0a20 2020 2020 2020 2042 6c6f  ion..        Blo
-0002ef50: 636b 6564 2076 6572 7369 6f6e 206f 6620  cked version of 
-0002ef60: 7064 2e44 6174 6146 7261 6d65 2e71 7565  pd.DataFrame.que
-0002ef70: 7279 0a0a 2020 2020 2020 2020 5061 7261  ry..        Para
-0002ef80: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-0002ef90: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0002efa0: 2020 6578 7072 3a20 7374 720a 2020 2020    expr: str.    
-0002efb0: 2020 2020 2020 2020 5468 6520 7175 6572          The quer
-0002efc0: 7920 7374 7269 6e67 2074 6f20 6576 616c  y string to eval
-0002efd0: 7561 7465 2e0a 2020 2020 2020 2020 2020  uate..          
-0002efe0: 2020 596f 7520 6361 6e20 7265 6665 7220    You can refer 
-0002eff0: 746f 2063 6f6c 756d 6e20 6e61 6d65 7320  to column names 
-0002f000: 7468 6174 2061 7265 206e 6f74 2076 616c  that are not val
-0002f010: 6964 2050 7974 686f 6e20 7661 7269 6162  id Python variab
-0002f020: 6c65 206e 616d 6573 0a20 2020 2020 2020  le names.       
-0002f030: 2020 2020 2062 7920 7375 7272 6f75 6e64       by surround
-0002f040: 696e 6720 7468 656d 2069 6e20 6261 636b  ing them in back
-0002f050: 7469 636b 732e 0a20 2020 2020 2020 2020  ticks..         
-0002f060: 2020 2044 6173 6b20 646f 6573 206e 6f74     Dask does not
-0002f070: 2066 756c 6c79 2073 7570 706f 7274 2072   fully support r
-0002f080: 6566 6572 7269 6e67 2074 6f20 7661 7269  eferring to vari
-0002f090: 6162 6c65 7320 7573 696e 6720 7468 6520  ables using the 
-0002f0a0: 2740 2720 6368 6172 6163 7465 722c 0a20  '@' character,. 
-0002f0b0: 2020 2020 2020 2020 2020 2075 7365 2066             use f
-0002f0c0: 2d73 7472 696e 6773 206f 7220 7468 6520  -strings or the 
-0002f0d0: 6060 6c6f 6361 6c5f 6469 6374 6060 206b  ``local_dict`` k
-0002f0e0: 6579 776f 7264 2061 7267 756d 656e 7420  eyword argument 
-0002f0f0: 696e 7374 6561 642e 0a0a 2020 2020 2020  instead...      
-0002f100: 2020 4e6f 7465 730a 2020 2020 2020 2020    Notes.        
-0002f110: 2d2d 2d2d 2d0a 2020 2020 2020 2020 5468  -----.        Th
-0002f120: 6973 2069 7320 6c69 6b65 2074 6865 2073  is is like the s
-0002f130: 6571 7565 6e74 6961 6c20 7665 7273 696f  equential versio
-0002f140: 6e20 6578 6365 7074 2074 6861 7420 7468  n except that th
-0002f150: 6973 2077 696c 6c20 616c 736f 2068 6170  is will also hap
-0002f160: 7065 6e0a 2020 2020 2020 2020 696e 206d  pen.        in m
-0002f170: 616e 7920 7468 7265 6164 732e 2020 5468  any threads.  Th
-0002f180: 6973 206d 6179 2063 6f6e 666c 6963 7420  is may conflict 
-0002f190: 7769 7468 2060 606e 756d 6578 7072 6060  with ``numexpr``
-0002f1a0: 2077 6869 6368 2077 696c 6c20 7573 650a   which will use.
-0002f1b0: 2020 2020 2020 2020 6d75 6c74 6970 6c65          multiple
-0002f1c0: 2074 6872 6561 6473 2069 7473 656c 662e   threads itself.
-0002f1d0: 2020 5765 2072 6563 6f6d 6d65 6e64 2074    We recommend t
-0002f1e0: 6861 7420 796f 7520 7365 7420 6060 6e75  hat you set ``nu
-0002f1f0: 6d65 7870 7260 6020 746f 2075 7365 2061  mexpr`` to use a
-0002f200: 0a20 2020 2020 2020 2073 696e 676c 6520  .        single 
-0002f210: 7468 7265 6164 3a0a 0a20 2020 2020 2020  thread:..       
-0002f220: 202e 2e20 636f 6465 2d62 6c6f 636b 3a3a   .. code-block::
-0002f230: 2070 7974 686f 6e0a 0a20 2020 2020 2020   python..       
-0002f240: 2020 2020 2069 6d70 6f72 7420 6e75 6d65       import nume
-0002f250: 7870 720a 2020 2020 2020 2020 2020 2020  xpr.            
-0002f260: 6e75 6d65 7870 722e 7365 745f 6e75 6d5f  numexpr.set_num_
-0002f270: 7468 7265 6164 7328 3129 0a0a 2020 2020  threads(1)..    
-0002f280: 2020 2020 5365 6520 616c 736f 0a20 2020      See also.   
-0002f290: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-0002f2a0: 2020 2020 2020 7061 6e64 6173 2e44 6174        pandas.Dat
-0002f2b0: 6146 7261 6d65 2e71 7565 7279 0a20 2020  aFrame.query.   
-0002f2c0: 2020 2020 2070 616e 6461 732e 6576 616c       pandas.eval
-0002f2d0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-0002f2e0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-0002f2f0: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
-0002f300: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
-0002f310: 2070 640a 2020 2020 2020 2020 3e3e 3e20   pd.        >>> 
-0002f320: 696d 706f 7274 2064 6173 6b2e 6461 7461  import dask.data
-0002f330: 6672 616d 6520 6173 2064 640a 2020 2020  frame as dd.    
-0002f340: 2020 2020 3e3e 3e20 6466 203d 2070 642e      >>> df = pd.
-0002f350: 4461 7461 4672 616d 6528 7b27 7827 3a20  DataFrame({'x': 
-0002f360: 5b31 2c20 322c 2031 2c20 325d 2c0a 2020  [1, 2, 1, 2],.  
-0002f370: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0002f380: 2020 2020 2020 2020 2020 2020 2027 7927               'y'
-0002f390: 3a20 5b31 2c20 322c 2033 2c20 345d 2c0a  : [1, 2, 3, 4],.
-0002f3a0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0002f3b0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0002f3c0: 7a20 7a27 3a20 5b34 2c20 332c 2032 2c20  z z': [4, 3, 2, 
-0002f3d0: 315d 7d29 0a20 2020 2020 2020 203e 3e3e  1]}).        >>>
-0002f3e0: 2064 6466 203d 2064 642e 6672 6f6d 5f70   ddf = dd.from_p
-0002f3f0: 616e 6461 7328 6466 2c20 6e70 6172 7469  andas(df, nparti
-0002f400: 7469 6f6e 733d 3229 0a0a 2020 2020 2020  tions=2)..      
-0002f410: 2020 5265 6665 7220 746f 2063 6f6c 756d    Refer to colum
-0002f420: 6e20 6e61 6d65 7320 6469 7265 6374 6c79  n names directly
-0002f430: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-0002f440: 6466 2e71 7565 7279 2827 7920 3e20 7827  df.query('y > x'
-0002f450: 292e 636f 6d70 7574 6528 290a 2020 2020  ).compute().    
-0002f460: 2020 2020 2020 2078 2020 7920 207a 207a         x  y  z z
-0002f470: 0a20 2020 2020 2020 2032 2020 3120 2033  .        2  1  3
-0002f480: 2020 2020 320a 2020 2020 2020 2020 3320      2.        3 
-0002f490: 2032 2020 3420 2020 2031 0a0a 2020 2020   2  4    1..    
-0002f4a0: 2020 2020 5265 6665 7220 746f 2063 6f6c      Refer to col
-0002f4b0: 756d 6e20 6e61 6d65 2075 7369 6e67 2062  umn name using b
-0002f4c0: 6163 6b74 6963 6b73 3a0a 0a20 2020 2020  ackticks:..     
-0002f4d0: 2020 203e 3e3e 2064 6466 2e71 7565 7279     >>> ddf.query
-0002f4e0: 2827 607a 207a 6020 3e20 7827 292e 636f  ('`z z` > x').co
-0002f4f0: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
-0002f500: 2020 2078 2020 7920 207a 207a 0a20 2020     x  y  z z.   
-0002f510: 2020 2020 2030 2020 3120 2031 2020 2020       0  1  1    
-0002f520: 340a 2020 2020 2020 2020 3120 2032 2020  4.        1  2  
-0002f530: 3220 2020 2033 0a20 2020 2020 2020 2032  2    3.        2
-0002f540: 2020 3120 2033 2020 2020 320a 0a20 2020    1  3    2..   
-0002f550: 2020 2020 2052 6566 6572 2074 6f20 7661       Refer to va
-0002f560: 7269 6162 6c65 206e 616d 6520 7573 696e  riable name usin
-0002f570: 6720 662d 7374 7269 6e67 733a 0a0a 2020  g f-strings:..  
-0002f580: 2020 2020 2020 3e3e 3e20 7661 6c75 6520        >>> value 
-0002f590: 3d20 310a 2020 2020 2020 2020 3e3e 3e20  = 1.        >>> 
-0002f5a0: 6464 662e 7175 6572 7928 6627 7820 3d3d  ddf.query(f'x ==
-0002f5b0: 207b 7661 6c75 657d 2729 2e63 6f6d 7075   {value}').compu
-0002f5c0: 7465 2829 0a20 2020 2020 2020 2020 2020  te().           
-0002f5d0: 7820 2079 2020 7a20 7a0a 2020 2020 2020  x  y  z z.      
-0002f5e0: 2020 3020 2031 2020 3120 2020 2034 0a20    0  1  1    4. 
-0002f5f0: 2020 2020 2020 2032 2020 3120 2033 2020         2  1  3  
-0002f600: 2020 320a 0a20 2020 2020 2020 2052 6566    2..        Ref
-0002f610: 6572 2074 6f20 7661 7269 6162 6c65 206e  er to variable n
-0002f620: 616d 6520 7573 696e 6720 6060 6c6f 6361  ame using ``loca
-0002f630: 6c5f 6469 6374 6060 3a0a 0a20 2020 2020  l_dict``:..     
-0002f640: 2020 203e 3e3e 2064 6466 2e71 7565 7279     >>> ddf.query
-0002f650: 2827 7820 3d3d 2040 7661 6c75 6527 2c20  ('x == @value', 
-0002f660: 6c6f 6361 6c5f 6469 6374 3d7b 2276 616c  local_dict={"val
-0002f670: 7565 223a 2076 616c 7565 7d29 2e63 6f6d  ue": value}).com
-0002f680: 7075 7465 2829 0a20 2020 2020 2020 2020  pute().         
-0002f690: 2020 7820 2079 2020 7a20 7a0a 2020 2020    x  y  z z.    
-0002f6a0: 2020 2020 3020 2031 2020 3120 2020 2034      0  1  1    4
-0002f6b0: 0a20 2020 2020 2020 2032 2020 3120 2033  .        2  1  3
-0002f6c0: 2020 2020 320a 2020 2020 2020 2020 2222      2.        ""
-0002f6d0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-0002f6e0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-0002f6f0: 696f 6e73 284d 2e71 7565 7279 2c20 6578  ions(M.query, ex
-0002f700: 7072 2c20 2a2a 6b77 6172 6773 290a 0a20  pr, **kwargs).. 
-0002f710: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0002f720: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0002f730: 2020 2064 6566 2065 7661 6c28 7365 6c66     def eval(self
-0002f740: 2c20 6578 7072 2c20 696e 706c 6163 653d  , expr, inplace=
-0002f750: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 293a  None, **kwargs):
-0002f760: 0a20 2020 2020 2020 2069 6620 696e 706c  .        if inpl
-0002f770: 6163 6520 6973 204e 6f6e 653a 0a20 2020  ace is None:.   
-0002f780: 2020 2020 2020 2020 2069 6e70 6c61 6365           inplace
-0002f790: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-0002f7a0: 2069 6620 223d 2220 696e 2065 7870 7220   if "=" in expr 
-0002f7b0: 616e 6420 696e 706c 6163 6520 696e 2028  and inplace in (
-0002f7c0: 5472 7565 2c20 4e6f 6e65 293a 0a20 2020  True, None):.   
-0002f7d0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0002f7e0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0002f7f0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0002f800: 2020 2020 2249 6e70 6c61 6365 2065 7661      "Inplace eva
-0002f810: 6c20 6e6f 7420 7375 7070 6f72 7465 642e  l not supported.
-0002f820: 2050 6c65 6173 6520 7573 6520 696e 706c   Please use inpl
-0002f830: 6163 653d 4661 6c73 6522 0a20 2020 2020  ace=False".     
-0002f840: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002f850: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
-0002f860: 7461 2e65 7661 6c28 6578 7072 2c20 696e  ta.eval(expr, in
-0002f870: 706c 6163 653d 696e 706c 6163 652c 202a  place=inplace, *
-0002f880: 2a6b 7761 7267 7329 0a20 2020 2020 2020  *kwargs).       
-0002f890: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-0002f8a0: 5f70 6172 7469 7469 6f6e 7328 4d2e 6576  _partitions(M.ev
-0002f8b0: 616c 2c20 6578 7072 2c20 6d65 7461 3d6d  al, expr, meta=m
-0002f8c0: 6574 612c 2069 6e70 6c61 6365 3d69 6e70  eta, inplace=inp
-0002f8d0: 6c61 6365 2c20 2a2a 6b77 6172 6773 290a  lace, **kwargs).
-0002f8e0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0002f8f0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0002f900: 0a20 2020 2064 6566 2064 726f 706e 6128  .    def dropna(
-0002f910: 7365 6c66 2c20 686f 773d 6e6f 5f64 6566  self, how=no_def
-0002f920: 6175 6c74 2c20 7375 6273 6574 3d4e 6f6e  ault, subset=Non
-0002f930: 652c 2074 6872 6573 683d 6e6f 5f64 6566  e, thresh=no_def
-0002f940: 6175 6c74 293a 0a20 2020 2020 2020 2023  ault):.        #
-0002f950: 2054 6865 7365 206b 6579 776f 7264 7320   These keywords 
-0002f960: 6172 6520 696e 636f 6d70 6174 6962 6c65  are incompatible
-0002f970: 2077 6974 6820 6561 6368 206f 7468 6572   with each other
-0002f980: 2e0a 2020 2020 2020 2020 2320 446f 6e27  ..        # Don'
-0002f990: 7420 616c 6c6f 7720 7468 656d 2062 6f74  t allow them bot
-0002f9a0: 6820 746f 2062 6520 7365 742e 0a20 2020  h to be set..   
-0002f9b0: 2020 2020 2069 6620 686f 7720 6973 206e       if how is n
-0002f9c0: 6f74 206e 6f5f 6465 6661 756c 7420 616e  ot no_default an
-0002f9d0: 6420 7468 7265 7368 2069 7320 6e6f 7420  d thresh is not 
-0002f9e0: 6e6f 5f64 6566 6175 6c74 3a0a 2020 2020  no_default:.    
-0002f9f0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-0002fa00: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
-0002fa10: 2020 2020 2020 2020 2022 596f 7520 6361           "You ca
-0002fa20: 6e6e 6f74 2073 6574 2062 6f74 6820 7468  nnot set both th
-0002fa30: 6520 686f 7720 616e 6420 7468 7265 7368  e how and thresh
-0002fa40: 2061 7267 756d 656e 7473 2061 7420 7468   arguments at th
-0002fa50: 6520 7361 6d65 2074 696d 652e 220a 2020  e same time.".  
-0002fa60: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0002fa70: 2020 2020 2023 204f 6e6c 7920 7370 6563       # Only spec
-0002fa80: 6966 7920 6068 6f77 6020 6f72 2060 7468  ify `how` or `th
-0002fa90: 7265 7368 6020 6b65 7977 6f72 6420 6966  resh` keyword if
-0002faa0: 2073 7065 6369 6669 6564 2062 7920 7468   specified by th
-0002fab0: 6520 7573 6572 0a20 2020 2020 2020 2023  e user.        #
-0002fac0: 2073 6f20 7765 2075 7469 6c69 7a65 206f   so we utilize o
-0002fad0: 7468 6572 2060 6472 6f70 6e61 6020 6b65  ther `dropna` ke
-0002fae0: 7977 6f72 6420 6465 6661 756c 7473 2061  yword defaults a
-0002faf0: 7070 726f 7072 6961 7465 6c79 0a20 2020  ppropriately.   
-0002fb00: 2020 2020 206b 7761 7267 7320 3d20 7b22       kwargs = {"
-0002fb10: 7375 6273 6574 223a 2073 7562 7365 747d  subset": subset}
-0002fb20: 0a20 2020 2020 2020 2069 6620 686f 7720  .        if how 
-0002fb30: 6973 206e 6f74 206e 6f5f 6465 6661 756c  is not no_defaul
-0002fb40: 743a 0a20 2020 2020 2020 2020 2020 206b  t:.            k
-0002fb50: 7761 7267 735b 2268 6f77 225d 203d 2068  wargs["how"] = h
-0002fb60: 6f77 0a20 2020 2020 2020 2065 6c69 6620  ow.        elif 
-0002fb70: 7468 7265 7368 2069 7320 6e6f 7420 6e6f  thresh is not no
-0002fb80: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
-0002fb90: 2020 2020 2020 6b77 6172 6773 5b22 7468        kwargs["th
-0002fba0: 7265 7368 225d 203d 2074 6872 6573 680a  resh"] = thresh.
-0002fbb0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002fbc0: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-0002fbd0: 6f6e 7328 4d2e 6472 6f70 6e61 2c20 2a2a  ons(M.dropna, **
-0002fbe0: 6b77 6172 6773 2c20 656e 666f 7263 655f  kwargs, enforce_
-0002fbf0: 6d65 7461 6461 7461 3d46 616c 7365 290a  metadata=False).
-0002fc00: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0002fc10: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0002fc20: 0a20 2020 2064 6566 2063 6c69 7028 7365  .    def clip(se
-0002fc30: 6c66 2c20 6c6f 7765 723d 4e6f 6e65 2c20  lf, lower=None, 
-0002fc40: 7570 7065 723d 4e6f 6e65 2c20 6f75 743d  upper=None, out=
-0002fc50: 4e6f 6e65 293a 0a20 2020 2020 2020 2069  None):.        i
-0002fc60: 6620 6f75 7420 6973 206e 6f74 204e 6f6e  f out is not Non
-0002fc70: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0002fc80: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0002fc90: 2227 6f75 7427 206d 7573 7420 6265 204e  "'out' must be N
-0002fca0: 6f6e 6522 290a 2020 2020 2020 2020 7265  one").        re
-0002fcb0: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
-0002fcc0: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-0002fcd0: 2020 2020 2020 4d2e 636c 6970 2c20 6c6f        M.clip, lo
-0002fce0: 7765 723d 6c6f 7765 722c 2075 7070 6572  wer=lower, upper
-0002fcf0: 3d75 7070 6572 2c20 656e 666f 7263 655f  =upper, enforce_
-0002fd00: 6d65 7461 6461 7461 3d46 616c 7365 0a20  metadata=False. 
-0002fd10: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-0002fd20: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0002fd30: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0002fd40: 6620 636c 6970 5f6c 6f77 6572 2873 656c  f clip_lower(sel
-0002fd50: 662c 2074 6872 6573 686f 6c64 293a 0a20  f, threshold):. 
-0002fd60: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0002fd70: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-0002fd80: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
-0002fd90: 2e63 6c69 705f 6c6f 7765 722c 2074 6872  .clip_lower, thr
-0002fda0: 6573 686f 6c64 3d74 6872 6573 686f 6c64  eshold=threshold
-0002fdb0: 2c20 656e 666f 7263 655f 6d65 7461 6461  , enforce_metada
-0002fdc0: 7461 3d46 616c 7365 0a20 2020 2020 2020  ta=False.       
-0002fdd0: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
-0002fde0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0002fdf0: 6d65 290a 2020 2020 6465 6620 636c 6970  me).    def clip
-0002fe00: 5f75 7070 6572 2873 656c 662c 2074 6872  _upper(self, thr
-0002fe10: 6573 686f 6c64 293a 0a20 2020 2020 2020  eshold):.       
-0002fe20: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-0002fe30: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-0002fe40: 2020 2020 2020 2020 204d 2e63 6c69 705f           M.clip_
-0002fe50: 7570 7065 722c 2074 6872 6573 686f 6c64  upper, threshold
-0002fe60: 3d74 6872 6573 686f 6c64 2c20 656e 666f  =threshold, enfo
-0002fe70: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
-0002fe80: 7365 0a20 2020 2020 2020 2029 0a0a 2020  se.        )..  
-0002fe90: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-0002fea0: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-0002feb0: 2020 6465 6620 7371 7565 657a 6528 7365    def squeeze(se
-0002fec0: 6c66 2c20 6178 6973 3d4e 6f6e 6529 3a0a  lf, axis=None):.
-0002fed0: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-0002fee0: 696e 205b 4e6f 6e65 2c20 315d 3a0a 2020  in [None, 1]:.  
-0002fef0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-0002ff00: 2873 656c 662e 636f 6c75 6d6e 7329 203d  (self.columns) =
-0002ff10: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-0002ff20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0002ff30: 5b73 656c 662e 636f 6c75 6d6e 735b 305d  [self.columns[0]
-0002ff40: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
-0002ff50: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0002ff60: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
-0002ff70: 0a20 2020 2020 2020 2065 6c69 6620 6178  .        elif ax
-0002ff80: 6973 203d 3d20 303a 0a20 2020 2020 2020  is == 0:.       
-0002ff90: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-0002ffa0: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
-0002ffb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ffc0: 6622 7b74 7970 6528 7365 6c66 297d 2064  f"{type(self)} d
-0002ffd0: 6f65 7320 6e6f 7420 7375 7070 6f72 7420  oes not support 
-0002ffe0: 7371 7565 657a 6520 616c 6f6e 6720 6178  squeeze along ax
-0002fff0: 6973 2030 220a 2020 2020 2020 2020 2020  is 0".          
-00030000: 2020 290a 0a20 2020 2020 2020 2065 6c69    )..        eli
-00030010: 6620 6178 6973 206e 6f74 2069 6e20 5b30  f axis not in [0
-00030020: 2c20 312c 204e 6f6e 655d 3a0a 2020 2020  , 1, None]:.    
-00030030: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00030040: 6c75 6545 7272 6f72 2866 224e 6f20 6178  lueError(f"No ax
-00030050: 6973 207b 6178 6973 7d20 666f 7220 6f62  is {axis} for ob
-00030060: 6a65 6374 2074 7970 6520 7b74 7970 6528  ject type {type(
-00030070: 7365 6c66 297d 2229 0a0a 2020 2020 4064  self)}")..    @d
-00030080: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00030090: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-000300a0: 6620 746f 5f74 696d 6573 7461 6d70 2873  f to_timestamp(s
-000300b0: 656c 662c 2066 7265 713d 4e6f 6e65 2c20  elf, freq=None, 
-000300c0: 686f 773d 2273 7461 7274 222c 2061 7869  how="start", axi
-000300d0: 733d 3029 3a0a 2020 2020 2020 2020 6466  s=0):.        df
-000300e0: 203d 2065 6c65 6d77 6973 6528 4d2e 746f   = elemwise(M.to
-000300f0: 5f74 696d 6573 7461 6d70 2c20 7365 6c66  _timestamp, self
-00030100: 2c20 6672 6571 2c20 686f 772c 2061 7869  , freq, how, axi
-00030110: 7329 0a20 2020 2020 2020 2064 662e 6469  s).        df.di
-00030120: 7669 7369 6f6e 7320 3d20 7475 706c 6528  visions = tuple(
-00030130: 7064 2e49 6e64 6578 2873 656c 662e 6469  pd.Index(self.di
-00030140: 7669 7369 6f6e 7329 2e74 6f5f 7469 6d65  visions).to_time
-00030150: 7374 616d 7028 2929 0a20 2020 2020 2020  stamp()).       
-00030160: 2072 6574 7572 6e20 6466 0a0a 2020 2020   return df..    
-00030170: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00030180: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-00030190: 6465 6620 6578 706c 6f64 6528 7365 6c66  def explode(self
-000301a0: 2c20 636f 6c75 6d6e 293a 0a20 2020 2020  , column):.     
-000301b0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
-000301c0: 6d65 7461 2e65 7870 6c6f 6465 2863 6f6c  meta.explode(col
-000301d0: 756d 6e29 0a20 2020 2020 2020 2072 6574  umn).        ret
-000301e0: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
-000301f0: 7469 7469 6f6e 7328 4d2e 6578 706c 6f64  titions(M.explod
-00030200: 652c 2063 6f6c 756d 6e2c 206d 6574 613d  e, column, meta=
-00030210: 6d65 7461 2c20 656e 666f 7263 655f 6d65  meta, enforce_me
-00030220: 7461 6461 7461 3d46 616c 7365 290a 0a20  tadata=False).. 
-00030230: 2020 2064 6566 2074 6f5f 6261 6728 7365     def to_bag(se
-00030240: 6c66 2c20 696e 6465 783d 4661 6c73 652c  lf, index=False,
-00030250: 2066 6f72 6d61 743d 2274 7570 6c65 2229   format="tuple")
-00030260: 3a0a 2020 2020 2020 2020 2222 2243 6f6e  :.        """Con
-00030270: 7665 7274 2074 6f20 6120 6461 736b 2042  vert to a dask B
-00030280: 6167 206f 6620 7475 706c 6573 206f 6620  ag of tuples of 
-00030290: 6561 6368 2072 6f77 2e0a 0a20 2020 2020  each row...     
-000302a0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-000302b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-000302c0: 0a20 2020 2020 2020 2069 6e64 6578 203a  .        index :
-000302d0: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0a   bool, optional.
-000302e0: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-000302f0: 7275 652c 2074 6865 2069 6e64 6578 2069  rue, the index i
-00030300: 7320 696e 636c 7564 6564 2061 7320 7468  s included as th
-00030310: 6520 6669 7273 7420 656c 656d 656e 7420  e first element 
-00030320: 6f66 2065 6163 6820 7475 706c 652e 0a20  of each tuple.. 
-00030330: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-00030340: 6c74 2069 7320 4661 6c73 652e 0a20 2020  lt is False..   
-00030350: 2020 2020 2066 6f72 6d61 7420 3a20 7b22       format : {"
-00030360: 7475 706c 6522 2c20 2264 6963 7422 2c20  tuple", "dict", 
-00030370: 2266 7261 6d65 227d 2c20 6f70 7469 6f6e  "frame"}, option
-00030380: 616c 0a20 2020 2020 2020 2020 2020 2057  al.            W
-00030390: 6865 7468 6572 2074 6f20 7265 7475 726e  hether to return
-000303a0: 2061 2062 6167 206f 6620 7475 706c 6573   a bag of tuples
-000303b0: 2c20 6469 6374 696f 6e61 7269 6573 2c20  , dictionaries, 
-000303c0: 6f72 0a20 2020 2020 2020 2020 2020 2064  or.            d
-000303d0: 6174 6166 7261 6d65 2d6c 696b 6520 6f62  ataframe-like ob
-000303e0: 6a65 6374 732e 2044 6566 6175 6c74 2069  jects. Default i
-000303f0: 7320 2274 7570 6c65 222e 2049 6620 2266  s "tuple". If "f
-00030400: 7261 6d65 222c 0a20 2020 2020 2020 2020  rame",.         
-00030410: 2020 2074 6865 206f 7269 6769 6e61 6c20     the original 
-00030420: 7061 7274 6974 696f 6e73 206f 6620 6060  partitions of ``
-00030430: 6466 6060 2077 696c 6c20 6e6f 7420 6265  df`` will not be
-00030440: 2074 7261 6e73 666f 726d 6564 0a20 2020   transformed.   
-00030450: 2020 2020 2020 2020 2069 6e20 616e 7920           in any 
-00030460: 7761 792e 0a20 2020 2020 2020 2022 2222  way..        """
-00030470: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-00030480: 736b 2e64 6174 6166 7261 6d65 2e69 6f20  sk.dataframe.io 
-00030490: 696d 706f 7274 2074 6f5f 6261 670a 0a20  import to_bag.. 
-000304a0: 2020 2020 2020 2072 6574 7572 6e20 746f         return to
-000304b0: 5f62 6167 2873 656c 662c 2069 6e64 6578  _bag(self, index
-000304c0: 2c20 666f 726d 6174 290a 0a20 2020 2064  , format)..    d
-000304d0: 6566 2074 6f5f 7061 7271 7565 7428 7365  ef to_parquet(se
-000304e0: 6c66 2c20 7061 7468 2c20 2a61 7267 732c  lf, path, *args,
-000304f0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00030500: 2020 2020 2222 2253 6565 2064 642e 746f      """See dd.to
-00030510: 5f70 6172 7175 6574 2064 6f63 7374 7269  _parquet docstri
-00030520: 6e67 2066 6f72 206d 6f72 6520 696e 666f  ng for more info
-00030530: 726d 6174 696f 6e22 2222 0a20 2020 2020  rmation""".     
-00030540: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-00030550: 6166 7261 6d65 2e69 6f20 696d 706f 7274  aframe.io import
-00030560: 2074 6f5f 7061 7271 7565 740a 0a20 2020   to_parquet..   
-00030570: 2020 2020 2072 6574 7572 6e20 746f 5f70       return to_p
-00030580: 6172 7175 6574 2873 656c 662c 2070 6174  arquet(self, pat
-00030590: 682c 202a 6172 6773 2c20 2a2a 6b77 6172  h, *args, **kwar
-000305a0: 6773 290a 0a20 2020 2064 6566 2074 6f5f  gs)..    def to_
-000305b0: 6f72 6328 7365 6c66 2c20 7061 7468 2c20  orc(self, path, 
-000305c0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-000305d0: 3a0a 2020 2020 2020 2020 2222 2253 6565  :.        """See
-000305e0: 2064 642e 746f 5f6f 7263 2064 6f63 7374   dd.to_orc docst
-000305f0: 7269 6e67 2066 6f72 206d 6f72 6520 696e  ring for more in
-00030600: 666f 726d 6174 696f 6e22 2222 0a20 2020  formation""".   
-00030610: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-00030620: 6174 6166 7261 6d65 2e69 6f20 696d 706f  ataframe.io impo
-00030630: 7274 2074 6f5f 6f72 630a 0a20 2020 2020  rt to_orc..     
-00030640: 2020 2072 6574 7572 6e20 746f 5f6f 7263     return to_orc
-00030650: 2873 656c 662c 2070 6174 682c 202a 6172  (self, path, *ar
-00030660: 6773 2c20 2a2a 6b77 6172 6773 290a 0a20  gs, **kwargs).. 
-00030670: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00030680: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-00030690: 2020 2064 6566 2074 6f5f 7374 7269 6e67     def to_string
-000306a0: 2873 656c 662c 206d 6178 5f72 6f77 733d  (self, max_rows=
-000306b0: 3529 3a0a 2020 2020 2020 2020 2320 6f70  5):.        # op
-000306c0: 7469 6f6e 5f63 6f6e 7465 7874 2064 6f65  tion_context doe
-000306d0: 736e 2774 2061 6666 6563 740a 2020 2020  sn't affect.    
-000306e0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000306f0: 5f72 6570 725f 6461 7461 2829 2e74 6f5f  _repr_data().to_
-00030700: 7374 7269 6e67 286d 6178 5f72 6f77 733d  string(max_rows=
-00030710: 6d61 785f 726f 7773 2c20 7368 6f77 5f64  max_rows, show_d
-00030720: 696d 656e 7369 6f6e 733d 4661 6c73 6529  imensions=False)
-00030730: 0a0a 2020 2020 6465 6620 5f67 6574 5f6e  ..    def _get_n
-00030740: 756d 6572 6963 5f64 6174 6128 7365 6c66  umeric_data(self
-00030750: 2c20 686f 773d 2261 6e79 222c 2073 7562  , how="any", sub
-00030760: 7365 743d 4e6f 6e65 293a 0a20 2020 2020  set=None):.     
-00030770: 2020 2023 2063 616c 6375 6c61 7465 2063     # calculate c
-00030780: 6f6c 756d 6e73 2074 6f20 6176 6f69 6420  olumns to avoid 
-00030790: 756e 6e65 6365 7373 6172 7920 6361 6c63  unnecessary calc
-000307a0: 756c 6174 696f 6e0a 2020 2020 2020 2020  ulation.        
-000307b0: 6e75 6d65 7269 6373 203d 2073 656c 662e  numerics = self.
-000307c0: 5f6d 6574 612e 5f67 6574 5f6e 756d 6572  _meta._get_numer
-000307d0: 6963 5f64 6174 6128 290a 0a20 2020 2020  ic_data()..     
-000307e0: 2020 2069 6620 6c65 6e28 6e75 6d65 7269     if len(numeri
-000307f0: 6373 2e63 6f6c 756d 6e73 2920 3c20 6c65  cs.columns) < le
-00030800: 6e28 7365 6c66 2e63 6f6c 756d 6e73 293a  n(self.columns):
-00030810: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00030820: 6520 3d20 7365 6c66 2e5f 746f 6b65 6e5f  e = self._token_
-00030830: 7072 6566 6978 202b 2022 2d67 6574 5f6e  prefix + "-get_n
-00030840: 756d 6572 6963 5f64 6174 6122 0a20 2020  umeric_data".   
-00030850: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00030860: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-00030870: 6f6e 7328 4d2e 5f67 6574 5f6e 756d 6572  ons(M._get_numer
-00030880: 6963 5f64 6174 612c 206d 6574 613d 6e75  ic_data, meta=nu
-00030890: 6d65 7269 6373 2c20 746f 6b65 6e3d 6e61  merics, token=na
-000308a0: 6d65 290a 2020 2020 2020 2020 656c 7365  me).        else
-000308b0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-000308c0: 7573 6520 6d79 7365 6c66 2069 6620 616c  use myself if al
-000308d0: 6c20 6e75 6d65 7269 6373 0a20 2020 2020  l numerics.     
-000308e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000308f0: 6c66 0a0a 2020 2020 4063 6c61 7373 6d65  lf..    @classme
-00030900: 7468 6f64 0a20 2020 2064 6566 205f 7661  thod.    def _va
-00030910: 6c69 6461 7465 5f61 7869 7328 636c 732c  lidate_axis(cls,
-00030920: 2061 7869 733d 302c 206e 6f6e 655f 6973   axis=0, none_is
-00030930: 5f7a 6572 6f3a 2062 6f6f 6c20 3d20 5472  _zero: bool = Tr
-00030940: 7565 2920 2d3e 204e 6f6e 6520 7c20 4c69  ue) -> None | Li
-00030950: 7465 7261 6c5b 302c 2031 5d3a 0a20 2020  teral[0, 1]:.   
-00030960: 2020 2020 2069 6620 6178 6973 206e 6f74       if axis not
-00030970: 2069 6e20 2830 2c20 312c 2022 696e 6465   in (0, 1, "inde
-00030980: 7822 2c20 2263 6f6c 756d 6e73 222c 204e  x", "columns", N
-00030990: 6f6e 6529 3a0a 2020 2020 2020 2020 2020  one):.          
-000309a0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000309b0: 6f72 2866 224e 6f20 6178 6973 206e 616d  or(f"No axis nam
-000309c0: 6564 207b 6178 6973 7d22 290a 2020 2020  ed {axis}").    
-000309d0: 2020 2020 2320 636f 6e76 6572 7420 746f      # convert to
-000309e0: 206e 756d 6572 6963 2061 7869 730a 2020   numeric axis.  
-000309f0: 2020 2020 2020 6e75 6d65 7269 635f 6178        numeric_ax
-00030a00: 6973 3a20 6469 6374 5b73 7472 207c 204e  is: dict[str | N
-00030a10: 6f6e 652c 204c 6974 6572 616c 5b30 2c20  one, Literal[0, 
-00030a20: 315d 5d20 3d20 7b22 696e 6465 7822 3a20  1]] = {"index": 
-00030a30: 302c 2022 636f 6c75 6d6e 7322 3a20 317d  0, "columns": 1}
-00030a40: 0a20 2020 2020 2020 2069 6620 6e6f 6e65  .        if none
-00030a50: 5f69 735f 7a65 726f 3a0a 2020 2020 2020  _is_zero:.      
-00030a60: 2020 2020 2020 6e75 6d65 7269 635f 6178        numeric_ax
-00030a70: 6973 5b4e 6f6e 655d 203d 2030 0a0a 2020  is[None] = 0..  
-00030a80: 2020 2020 2020 7265 7475 726e 206e 756d        return num
-00030a90: 6572 6963 5f61 7869 732e 6765 7428 6178  eric_axis.get(ax
-00030aa0: 6973 2c20 6178 6973 290a 0a20 2020 2040  is, axis)..    @
-00030ab0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00030ac0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00030ad0: 6566 2064 726f 7028 7365 6c66 2c20 6c61  ef drop(self, la
-00030ae0: 6265 6c73 3d4e 6f6e 652c 2061 7869 733d  bels=None, axis=
-00030af0: 302c 2063 6f6c 756d 6e73 3d4e 6f6e 652c  0, columns=None,
-00030b00: 2065 7272 6f72 733d 2272 6169 7365 2229   errors="raise")
-00030b10: 3a0a 2020 2020 2020 2020 6178 6973 203d  :.        axis =
-00030b20: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-00030b30: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
-00030b40: 2020 2069 6620 6178 6973 203d 3d20 3020     if axis == 0 
-00030b50: 616e 6420 636f 6c75 6d6e 7320 6973 206e  and columns is n
-00030b60: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00030b70: 2020 2020 2023 2043 6f6c 756d 6e73 206d       # Columns m
-00030b80: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
-00030b90: 2069 6620 6178 6973 3d3d 300a 2020 2020   if axis==0.    
-00030ba0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00030bb0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-00030bc0: 6e73 2864 726f 705f 6279 5f73 6861 6c6c  ns(drop_by_shall
-00030bd0: 6f77 5f63 6f70 792c 2063 6f6c 756d 6e73  ow_copy, columns
-00030be0: 2c20 6572 726f 7273 3d65 7272 6f72 7329  , errors=errors)
-00030bf0: 0a20 2020 2020 2020 2065 6c69 6620 6178  .        elif ax
-00030c00: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
-00030c10: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00030c20: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-00030c30: 6472 6f70 5f62 795f 7368 616c 6c6f 775f  drop_by_shallow_
-00030c40: 636f 7079 2c20 6c61 6265 6c73 2c20 6572  copy, labels, er
-00030c50: 726f 7273 3d65 7272 6f72 7329 0a20 2020  rors=errors).   
-00030c60: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-00030c70: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
-00030c80: 2020 2020 2020 2020 2020 2020 2244 726f              "Dro
-00030c90: 7020 6375 7272 656e 746c 7920 6f6e 6c79  p currently only
-00030ca0: 2077 6f72 6b73 2066 6f72 2061 7869 733d   works for axis=
-00030cb0: 3120 6f72 2077 6865 6e20 636f 6c75 6d6e  1 or when column
-00030cc0: 7320 6973 206e 6f74 204e 6f6e 6522 0a20  s is not None". 
-00030cd0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00030ce0: 6620 6d65 7267 6528 0a20 2020 2020 2020  f merge(.       
-00030cf0: 2073 656c 662c 0a20 2020 2020 2020 2072   self,.        r
-00030d00: 6967 6874 2c0a 2020 2020 2020 2020 686f  ight,.        ho
-00030d10: 773d 2269 6e6e 6572 222c 0a20 2020 2020  w="inner",.     
-00030d20: 2020 206f 6e3d 4e6f 6e65 2c0a 2020 2020     on=None,.    
-00030d30: 2020 2020 6c65 6674 5f6f 6e3d 4e6f 6e65      left_on=None
-00030d40: 2c0a 2020 2020 2020 2020 7269 6768 745f  ,.        right_
-00030d50: 6f6e 3d4e 6f6e 652c 0a20 2020 2020 2020  on=None,.       
-00030d60: 206c 6566 745f 696e 6465 783d 4661 6c73   left_index=Fals
-00030d70: 652c 0a20 2020 2020 2020 2072 6967 6874  e,.        right
-00030d80: 5f69 6e64 6578 3d46 616c 7365 2c0a 2020  _index=False,.  
-00030d90: 2020 2020 2020 7375 6666 6978 6573 3d28        suffixes=(
-00030da0: 225f 7822 2c20 225f 7922 292c 0a20 2020  "_x", "_y"),.   
-00030db0: 2020 2020 2069 6e64 6963 6174 6f72 3d46       indicator=F
-00030dc0: 616c 7365 2c0a 2020 2020 2020 2020 6e70  alse,.        np
-00030dd0: 6172 7469 7469 6f6e 733d 4e6f 6e65 2c0a  artitions=None,.
-00030de0: 2020 2020 2020 2020 7368 7566 666c 653d          shuffle=
-00030df0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6272  None,.        br
-00030e00: 6f61 6463 6173 743d 4e6f 6e65 2c0a 2020  oadcast=None,.  
-00030e10: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-00030e20: 4d65 7267 6520 7468 6520 4461 7461 4672  Merge the DataFr
-00030e30: 616d 6520 7769 7468 2061 6e6f 7468 6572  ame with another
-00030e40: 2044 6174 6146 7261 6d65 0a0a 2020 2020   DataFrame..    
-00030e50: 2020 2020 5468 6973 2077 696c 6c20 6d65      This will me
-00030e60: 7267 6520 7468 6520 7477 6f20 6461 7461  rge the two data
-00030e70: 7365 7473 2c20 6569 7468 6572 206f 6e20  sets, either on 
-00030e80: 7468 6520 696e 6469 6365 732c 2061 2063  the indices, a c
-00030e90: 6572 7461 696e 2063 6f6c 756d 6e0a 2020  ertain column.  
-00030ea0: 2020 2020 2020 696e 2065 6163 6820 6461        in each da
-00030eb0: 7461 7365 7420 6f72 2074 6865 2069 6e64  taset or the ind
-00030ec0: 6578 2069 6e20 6f6e 6520 6461 7461 7365  ex in one datase
-00030ed0: 7420 616e 6420 7468 6520 636f 6c75 6d6e  t and the column
-00030ee0: 2069 6e20 616e 6f74 6865 722e 0a0a 2020   in another...  
-00030ef0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00030f00: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00030f10: 2d2d 2d0a 2020 2020 2020 2020 7269 6768  ---.        righ
-00030f20: 743a 2064 6173 6b2e 6461 7461 6672 616d  t: dask.datafram
-00030f30: 652e 4461 7461 4672 616d 650a 2020 2020  e.DataFrame.    
-00030f40: 2020 2020 686f 7720 3a20 7b27 6c65 6674      how : {'left
-00030f50: 272c 2027 7269 6768 7427 2c20 276f 7574  ', 'right', 'out
-00030f60: 6572 272c 2027 696e 6e65 7227 7d2c 2064  er', 'inner'}, d
-00030f70: 6566 6175 6c74 3a20 2769 6e6e 6572 270a  efault: 'inner'.
-00030f80: 2020 2020 2020 2020 2020 2020 486f 7720              How 
-00030f90: 746f 2068 616e 646c 6520 7468 6520 6f70  to handle the op
-00030fa0: 6572 6174 696f 6e20 6f66 2074 6865 2074  eration of the t
-00030fb0: 776f 206f 626a 6563 7473 3a0a 0a20 2020  wo objects:..   
-00030fc0: 2020 2020 2020 2020 202d 206c 6566 743a           - left:
-00030fd0: 2075 7365 2063 616c 6c69 6e67 2066 7261   use calling fra
-00030fe0: 6d65 2773 2069 6e64 6578 2028 6f72 2063  me's index (or c
-00030ff0: 6f6c 756d 6e20 6966 206f 6e20 6973 2073  olumn if on is s
-00031000: 7065 6369 6669 6564 290a 2020 2020 2020  pecified).      
-00031010: 2020 2020 2020 2d20 7269 6768 743a 2075        - right: u
-00031020: 7365 206f 7468 6572 2066 7261 6d65 2773  se other frame's
-00031030: 2069 6e64 6578 0a20 2020 2020 2020 2020   index.         
-00031040: 2020 202d 206f 7574 6572 3a20 666f 726d     - outer: form
-00031050: 2075 6e69 6f6e 206f 6620 6361 6c6c 696e   union of callin
-00031060: 6720 6672 616d 6527 7320 696e 6465 7820  g frame's index 
-00031070: 286f 7220 636f 6c75 6d6e 2069 6620 6f6e  (or column if on
-00031080: 2069 730a 2020 2020 2020 2020 2020 2020   is.            
-00031090: 2020 7370 6563 6966 6965 6429 2077 6974    specified) wit
-000310a0: 6820 6f74 6865 7220 6672 616d 6527 7320  h other frame's 
-000310b0: 696e 6465 782c 2061 6e64 2073 6f72 7420  index, and sort 
-000310c0: 6974 0a20 2020 2020 2020 2020 2020 2020  it.             
-000310d0: 206c 6578 6963 6f67 7261 7068 6963 616c   lexicographical
-000310e0: 6c79 0a20 2020 2020 2020 2020 2020 202d  ly.            -
-000310f0: 2069 6e6e 6572 3a20 666f 726d 2069 6e74   inner: form int
-00031100: 6572 7365 6374 696f 6e20 6f66 2063 616c  ersection of cal
-00031110: 6c69 6e67 2066 7261 6d65 2773 2069 6e64  ling frame's ind
-00031120: 6578 2028 6f72 2063 6f6c 756d 6e20 6966  ex (or column if
-00031130: 0a20 2020 2020 2020 2020 2020 2020 206f  .              o
-00031140: 6e20 6973 2073 7065 6369 6669 6564 2920  n is specified) 
-00031150: 7769 7468 206f 7468 6572 2066 7261 6d65  with other frame
-00031160: 2773 2069 6e64 6578 2c20 7072 6573 6572  's index, preser
-00031170: 7669 6e67 2074 6865 206f 7264 6572 0a20  ving the order. 
-00031180: 2020 2020 2020 2020 2020 2020 206f 6620               of 
-00031190: 7468 6520 6361 6c6c 696e 6727 7320 6f6e  the calling's on
-000311a0: 650a 0a20 2020 2020 2020 206f 6e20 3a20  e..        on : 
-000311b0: 6c61 6265 6c20 6f72 206c 6973 740a 2020  label or list.  
-000311c0: 2020 2020 2020 2020 2020 436f 6c75 6d6e            Column
-000311d0: 206f 7220 696e 6465 7820 6c65 7665 6c20   or index level 
-000311e0: 6e61 6d65 7320 746f 206a 6f69 6e20 6f6e  names to join on
-000311f0: 2e20 5468 6573 6520 6d75 7374 2062 6520  . These must be 
-00031200: 666f 756e 6420 696e 2062 6f74 680a 2020  found in both.  
-00031210: 2020 2020 2020 2020 2020 4461 7461 4672            DataFr
-00031220: 616d 6573 2e20 4966 206f 6e20 6973 204e  ames. If on is N
-00031230: 6f6e 6520 616e 6420 6e6f 7420 6d65 7267  one and not merg
-00031240: 696e 6720 6f6e 2069 6e64 6578 6573 2074  ing on indexes t
-00031250: 6865 6e20 7468 6973 0a20 2020 2020 2020  hen this.       
-00031260: 2020 2020 2064 6566 6175 6c74 7320 746f       defaults to
-00031270: 2074 6865 2069 6e74 6572 7365 6374 696f   the intersectio
-00031280: 6e20 6f66 2074 6865 2063 6f6c 756d 6e73  n of the columns
-00031290: 2069 6e20 626f 7468 2044 6174 6146 7261   in both DataFra
-000312a0: 6d65 732e 0a20 2020 2020 2020 206c 6566  mes..        lef
-000312b0: 745f 6f6e 203a 206c 6162 656c 206f 7220  t_on : label or 
-000312c0: 6c69 7374 2c20 6f72 2061 7272 6179 2d6c  list, or array-l
-000312d0: 696b 650a 2020 2020 2020 2020 2020 2020  ike.            
-000312e0: 436f 6c75 6d6e 2074 6f20 6a6f 696e 206f  Column to join o
-000312f0: 6e20 696e 2074 6865 206c 6566 7420 4461  n in the left Da
-00031300: 7461 4672 616d 652e 204f 7468 6572 2074  taFrame. Other t
-00031310: 6861 6e20 696e 2070 616e 6461 730a 2020  han in pandas.  
-00031320: 2020 2020 2020 2020 2020 6172 7261 7973            arrays
-00031330: 2061 6e64 206c 6973 7473 2061 7265 206f   and lists are o
-00031340: 6e6c 7920 7375 7070 6f72 7420 6966 2074  nly support if t
-00031350: 6865 6972 206c 656e 6774 6820 6973 2031  heir length is 1
-00031360: 2e0a 2020 2020 2020 2020 7269 6768 745f  ..        right_
-00031370: 6f6e 203a 206c 6162 656c 206f 7220 6c69  on : label or li
-00031380: 7374 2c20 6f72 2061 7272 6179 2d6c 696b  st, or array-lik
-00031390: 650a 2020 2020 2020 2020 2020 2020 436f  e.            Co
-000313a0: 6c75 6d6e 2074 6f20 6a6f 696e 206f 6e20  lumn to join on 
-000313b0: 696e 2074 6865 2072 6967 6874 2044 6174  in the right Dat
-000313c0: 6146 7261 6d65 2e20 4f74 6865 7220 7468  aFrame. Other th
-000313d0: 616e 2069 6e20 7061 6e64 6173 0a20 2020  an in pandas.   
-000313e0: 2020 2020 2020 2020 2061 7272 6179 7320           arrays 
-000313f0: 616e 6420 6c69 7374 7320 6172 6520 6f6e  and lists are on
-00031400: 6c79 2073 7570 706f 7274 2069 6620 7468  ly support if th
-00031410: 6569 7220 6c65 6e67 7468 2069 7320 312e  eir length is 1.
-00031420: 0a20 2020 2020 2020 206c 6566 745f 696e  .        left_in
-00031430: 6465 7820 3a20 626f 6f6c 6561 6e2c 2064  dex : boolean, d
-00031440: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
-00031450: 2020 2020 2020 2020 2055 7365 2074 6865           Use the
-00031460: 2069 6e64 6578 2066 726f 6d20 7468 6520   index from the 
-00031470: 6c65 6674 2044 6174 6146 7261 6d65 2061  left DataFrame a
-00031480: 7320 7468 6520 6a6f 696e 206b 6579 2e0a  s the join key..
-00031490: 2020 2020 2020 2020 7269 6768 745f 696e          right_in
-000314a0: 6465 7820 3a20 626f 6f6c 6561 6e2c 2064  dex : boolean, d
-000314b0: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
-000314c0: 2020 2020 2020 2020 2055 7365 2074 6865           Use the
-000314d0: 2069 6e64 6578 2066 726f 6d20 7468 6520   index from the 
-000314e0: 7269 6768 7420 4461 7461 4672 616d 6520  right DataFrame 
-000314f0: 6173 2074 6865 206a 6f69 6e20 6b65 792e  as the join key.
-00031500: 0a20 2020 2020 2020 2073 7566 6669 7865  .        suffixe
-00031510: 7320 3a20 322d 6c65 6e67 7468 2073 6571  s : 2-length seq
-00031520: 7565 6e63 6520 2874 7570 6c65 2c20 6c69  uence (tuple, li
-00031530: 7374 2c20 2e2e 2e29 0a20 2020 2020 2020  st, ...).       
-00031540: 2020 2020 2053 7566 6669 7820 746f 2061       Suffix to a
-00031550: 7070 6c79 2074 6f20 6f76 6572 6c61 7070  pply to overlapp
-00031560: 696e 6720 636f 6c75 6d6e 206e 616d 6573  ing column names
-00031570: 2069 6e20 7468 6520 6c65 6674 2061 6e64   in the left and
-00031580: 0a20 2020 2020 2020 2020 2020 2072 6967  .            rig
-00031590: 6874 2073 6964 652c 2072 6573 7065 6374  ht side, respect
-000315a0: 6976 656c 790a 2020 2020 2020 2020 696e  ively.        in
-000315b0: 6469 6361 746f 7220 3a20 626f 6f6c 6561  dicator : boolea
-000315c0: 6e20 6f72 2073 7472 696e 672c 2064 6566  n or string, def
-000315d0: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
-000315e0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-000315f0: 6164 6473 2061 2063 6f6c 756d 6e20 746f  adds a column to
-00031600: 206f 7574 7075 7420 4461 7461 4672 616d   output DataFram
-00031610: 6520 6361 6c6c 6564 2022 5f6d 6572 6765  e called "_merge
-00031620: 2220 7769 7468 0a20 2020 2020 2020 2020  " with.         
-00031630: 2020 2069 6e66 6f72 6d61 7469 6f6e 206f     information o
-00031640: 6e20 7468 6520 736f 7572 6365 206f 6620  n the source of 
-00031650: 6561 6368 2072 6f77 2e20 4966 2073 7472  each row. If str
-00031660: 696e 672c 2063 6f6c 756d 6e20 7769 7468  ing, column with
-00031670: 0a20 2020 2020 2020 2020 2020 2069 6e66  .            inf
-00031680: 6f72 6d61 7469 6f6e 206f 6e20 736f 7572  ormation on sour
-00031690: 6365 206f 6620 6561 6368 2072 6f77 2077  ce of each row w
-000316a0: 696c 6c20 6265 2061 6464 6564 2074 6f20  ill be added to 
-000316b0: 6f75 7470 7574 2044 6174 6146 7261 6d65  output DataFrame
-000316c0: 2c0a 2020 2020 2020 2020 2020 2020 616e  ,.            an
-000316d0: 6420 636f 6c75 6d6e 2077 696c 6c20 6265  d column will be
-000316e0: 206e 616d 6564 2076 616c 7565 206f 6620   named value of 
-000316f0: 7374 7269 6e67 2e20 496e 666f 726d 6174  string. Informat
-00031700: 696f 6e20 636f 6c75 6d6e 2069 730a 2020  ion column is.  
-00031710: 2020 2020 2020 2020 2020 4361 7465 676f            Catego
-00031720: 7269 6361 6c2d 7479 7065 2061 6e64 2074  rical-type and t
-00031730: 616b 6573 206f 6e20 6120 7661 6c75 6520  akes on a value 
-00031740: 6f66 2022 6c65 6674 5f6f 6e6c 7922 2066  of "left_only" f
-00031750: 6f72 206f 6273 6572 7661 7469 6f6e 730a  or observations.
-00031760: 2020 2020 2020 2020 2020 2020 7768 6f73              whos
-00031770: 6520 6d65 7267 6520 6b65 7920 6f6e 6c79  e merge key only
-00031780: 2061 7070 6561 7273 2069 6e20 606c 6566   appears in `lef
-00031790: 7460 2044 6174 6146 7261 6d65 2c20 2272  t` DataFrame, "r
-000317a0: 6967 6874 5f6f 6e6c 7922 2066 6f72 0a20  ight_only" for. 
-000317b0: 2020 2020 2020 2020 2020 206f 6273 6572             obser
-000317c0: 7661 7469 6f6e 7320 7768 6f73 6520 6d65  vations whose me
-000317d0: 7267 6520 6b65 7920 6f6e 6c79 2061 7070  rge key only app
-000317e0: 6561 7273 2069 6e20 6072 6967 6874 6020  ears in `right` 
-000317f0: 4461 7461 4672 616d 652c 0a20 2020 2020  DataFrame,.     
-00031800: 2020 2020 2020 2061 6e64 2022 626f 7468         and "both
-00031810: 2220 6966 2074 6865 206f 6273 6572 7661  " if the observa
-00031820: 7469 6f6e e280 9973 206d 6572 6765 206b  tion...s merge k
-00031830: 6579 2069 7320 666f 756e 6420 696e 2062  ey is found in b
-00031840: 6f74 682e 0a20 2020 2020 2020 206e 7061  oth..        npa
-00031850: 7274 6974 696f 6e73 3a20 696e 7420 6f72  rtitions: int or
-00031860: 204e 6f6e 652c 206f 7074 696f 6e61 6c0a   None, optional.
-00031870: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00031880: 6964 6561 6c20 6e75 6d62 6572 206f 6620  ideal number of 
-00031890: 6f75 7470 7574 2070 6172 7469 7469 6f6e  output partition
-000318a0: 732e 2054 6869 7320 6973 206f 6e6c 7920  s. This is only 
-000318b0: 7574 696c 6973 6564 2077 6865 6e0a 2020  utilised when.  
-000318c0: 2020 2020 2020 2020 2020 7065 7266 6f72            perfor
-000318d0: 6d69 6e67 2061 2068 6173 685f 6a6f 696e  ming a hash_join
-000318e0: 2028 6d65 7267 696e 6720 6f6e 2063 6f6c   (merging on col
-000318f0: 756d 6e73 206f 6e6c 7929 2e20 4966 2060  umns only). If `
-00031900: 604e 6f6e 6560 6020 7468 656e 0a20 2020  `None`` then.   
-00031910: 2020 2020 2020 2020 2060 606e 7061 7274           ``npart
-00031920: 6974 696f 6e73 203d 206d 6178 286c 6873  itions = max(lhs
-00031930: 2e6e 7061 7274 6974 696f 6e73 2c20 7268  .npartitions, rh
-00031940: 732e 6e70 6172 7469 7469 6f6e 7329 6060  s.npartitions)``
-00031950: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
-00031960: 6661 756c 7420 6973 2060 604e 6f6e 6560  fault is ``None`
-00031970: 602e 0a20 2020 2020 2020 2073 6875 6666  `..        shuff
-00031980: 6c65 3a20 7b27 6469 736b 272c 2027 7461  le: {'disk', 'ta
-00031990: 736b 7327 7d2c 206f 7074 696f 6e61 6c0a  sks'}, optional.
-000319a0: 2020 2020 2020 2020 2020 2020 4569 7468              Eith
-000319b0: 6572 2060 6027 6469 736b 2760 6020 666f  er ``'disk'`` fo
-000319c0: 7220 7369 6e67 6c65 2d6e 6f64 6520 6f70  r single-node op
-000319d0: 6572 6174 696f 6e20 6f72 2060 6027 7461  eration or ``'ta
-000319e0: 736b 7327 6060 2066 6f72 0a20 2020 2020  sks'`` for.     
-000319f0: 2020 2020 2020 2064 6973 7472 6962 7574         distribut
-00031a00: 6564 206f 7065 7261 7469 6f6e 2e20 2057  ed operation.  W
-00031a10: 696c 6c20 6265 2069 6e66 6572 7265 6420  ill be inferred 
-00031a20: 6279 2079 6f75 7220 6375 7272 656e 7420  by your current 
-00031a30: 7363 6865 6475 6c65 722e 0a20 2020 2020  scheduler..     
-00031a40: 2020 2062 726f 6164 6361 7374 3a20 626f     broadcast: bo
-00031a50: 6f6c 6561 6e20 6f72 2066 6c6f 6174 2c20  olean or float, 
-00031a60: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00031a70: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
-00031a80: 7573 6520 6120 6272 6f61 6463 6173 742d  use a broadcast-
-00031a90: 6261 7365 6420 6a6f 696e 2069 6e20 6c69  based join in li
-00031aa0: 6575 206f 6620 6120 7368 7566 666c 652d  eu of a shuffle-
-00031ab0: 6261 7365 640a 2020 2020 2020 2020 2020  based.          
-00031ac0: 2020 6a6f 696e 2066 6f72 2073 7570 706f    join for suppo
-00031ad0: 7274 6564 2063 6173 6573 2e20 2042 7920  rted cases.  By 
-00031ae0: 6465 6661 756c 742c 2061 2073 696d 706c  default, a simpl
-00031af0: 6520 6865 7572 6973 7469 6320 7769 6c6c  e heuristic will
-00031b00: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
-00031b10: 7573 6564 2074 6f20 7365 6c65 6374 2074  used to select t
-00031b20: 6865 2075 6e64 6572 6c79 696e 6720 616c  he underlying al
-00031b30: 676f 7269 7468 6d2e 2049 6620 6120 666c  gorithm. If a fl
-00031b40: 6f61 7469 6e67 2d70 6f69 6e74 2076 616c  oating-point val
-00031b50: 7565 0a20 2020 2020 2020 2020 2020 2069  ue.            i
-00031b60: 7320 7370 6563 6966 6965 642c 2074 6861  s specified, tha
-00031b70: 7420 6e75 6d62 6572 2077 696c 6c20 6265  t number will be
-00031b80: 2075 7365 6420 6173 2074 6865 2060 6062   used as the ``b
-00031b90: 726f 6164 6361 7374 5f62 6961 7360 600a  roadcast_bias``.
-00031ba0: 2020 2020 2020 2020 2020 2020 7769 7468              with
-00031bb0: 696e 2074 6865 2073 696d 706c 6520 6865  in the simple he
-00031bc0: 7572 6973 7469 6320 2861 206c 6172 6765  uristic (a large
-00031bd0: 206e 756d 6265 7220 6d61 6b65 7320 4461   number makes Da
-00031be0: 736b 206d 6f72 6520 6c69 6b65 6c79 0a20  sk more likely. 
-00031bf0: 2020 2020 2020 2020 2020 2074 6f20 6368             to ch
-00031c00: 6f6f 7365 2074 6865 2060 6062 726f 6163  oose the ``broac
-00031c10: 6173 745f 6a6f 696e 6060 2063 6f64 6520  ast_join`` code 
-00031c20: 7061 7468 292e 2053 6565 2060 6062 726f  path). See ``bro
-00031c30: 6164 6361 7374 5f6a 6f69 6e60 600a 2020  adcast_join``.  
-00031c40: 2020 2020 2020 2020 2020 666f 7220 6d6f            for mo
-00031c50: 7265 2069 6e66 6f72 6d61 7469 6f6e 2e0a  re information..
-00031c60: 0a20 2020 2020 2020 204e 6f74 6573 0a20  .        Notes. 
-00031c70: 2020 2020 2020 202d 2d2d 2d2d 0a0a 2020         -----..  
-00031c80: 2020 2020 2020 5468 6572 6520 6172 6520        There are 
-00031c90: 7468 7265 6520 7761 7973 2074 6f20 6a6f  three ways to jo
-00031ca0: 696e 2064 6174 6166 7261 6d65 733a 0a0a  in dataframes:..
-00031cb0: 2020 2020 2020 2020 312e 204a 6f69 6e69          1. Joini
-00031cc0: 6e67 206f 6e20 696e 6469 6365 732e 2049  ng on indices. I
-00031cd0: 6e20 7468 6973 2063 6173 6520 7468 6520  n this case the 
-00031ce0: 6469 7669 7369 6f6e 7320 6172 650a 2020  divisions are.  
-00031cf0: 2020 2020 2020 2020 2061 6c69 676e 6564           aligned
-00031d00: 2075 7369 6e67 2074 6865 2066 756e 6374   using the funct
-00031d10: 696f 6e20 6060 6461 736b 2e64 6174 6166  ion ``dask.dataf
-00031d20: 7261 6d65 2e6d 756c 7469 2e61 6c69 676e  rame.multi.align
-00031d30: 5f70 6172 7469 7469 6f6e 7360 602e 0a20  _partitions``.. 
-00031d40: 2020 2020 2020 2020 2020 4166 7465 7277            Afterw
-00031d50: 6172 6473 2c20 6561 6368 2070 6172 7469  ards, each parti
-00031d60: 7469 6f6e 2069 7320 6d65 7267 6564 2077  tion is merged w
-00031d70: 6974 6820 7468 6520 7061 6e64 6173 206d  ith the pandas m
-00031d80: 6572 6765 2066 756e 6374 696f 6e2e 0a0a  erge function...
-00031d90: 2020 2020 2020 2020 322e 204a 6f69 6e69          2. Joini
-00031da0: 6e67 206f 6e65 206f 6e20 696e 6465 7820  ng one on index 
-00031db0: 616e 6420 6f6e 6520 6f6e 2063 6f6c 756d  and one on colum
-00031dc0: 6e2e 2049 6e20 7468 6973 2063 6173 6520  n. In this case 
-00031dd0: 7468 6520 6469 7669 7369 6f6e 7320 6f66  the divisions of
-00031de0: 0a20 2020 2020 2020 2020 2020 6461 7461  .           data
-00031df0: 6672 616d 6520 6d65 7267 6564 2062 7920  frame merged by 
-00031e00: 696e 6465 7820 283a 6d61 7468 3a60 645f  index (:math:`d_
-00031e10: 6960 2920 6172 6520 7573 6564 2074 6f20  i`) are used to 
-00031e20: 6469 7669 6465 2074 6865 2063 6f6c 756d  divide the colum
-00031e30: 6e0a 2020 2020 2020 2020 2020 206d 6572  n.           mer
-00031e40: 6765 6420 6461 7461 6672 616d 6520 283a  ged dataframe (:
-00031e50: 6d61 7468 3a60 645f 6360 2920 6f6e 6520  math:`d_c`) one 
-00031e60: 7573 696e 670a 2020 2020 2020 2020 2020  using.          
-00031e70: 2060 6064 6173 6b2e 6461 7461 6672 616d   ``dask.datafram
-00031e80: 652e 6d75 6c74 692e 7265 6172 7261 6e67  e.multi.rearrang
-00031e90: 655f 6279 5f64 6976 6973 696f 6e73 6060  e_by_divisions``
-00031ea0: 2e20 496e 2074 6869 7320 6361 7365 2074  . In this case t
-00031eb0: 6865 0a20 2020 2020 2020 2020 2020 6d65  he.           me
-00031ec0: 7267 6564 2064 6174 6166 7261 6d65 2028  rged dataframe (
-00031ed0: 3a6d 6174 683a 6064 5f6d 6029 2068 6173  :math:`d_m`) has
-00031ee0: 2074 6865 2065 7861 6374 2073 616d 6520   the exact same 
-00031ef0: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
-00031f00: 2020 2020 2061 7320 283a 6d61 7468 3a60       as (:math:`
-00031f10: 645f 6960 292e 2054 6869 7320 6361 6e20  d_i`). This can 
-00031f20: 6c65 6164 2074 6f20 6973 7375 6573 2069  lead to issues i
-00031f30: 6620 796f 7520 6d65 7267 6520 6d75 6c74  f you merge mult
-00031f40: 6970 6c65 2072 6f77 7320 6672 6f6d 0a20  iple rows from. 
-00031f50: 2020 2020 2020 2020 2020 283a 6d61 7468            (:math
-00031f60: 3a60 645f 6360 2920 746f 206f 6e65 2072  :`d_c`) to one r
-00031f70: 6f77 2069 6e20 283a 6d61 7468 3a60 645f  ow in (:math:`d_
-00031f80: 6960 292e 0a0a 2020 2020 2020 2020 332e  i`)...        3.
-00031f90: 204a 6f69 6e69 6e67 2062 6f74 6820 6f6e   Joining both on
-00031fa0: 2063 6f6c 756d 6e73 2e20 496e 2074 6869   columns. In thi
-00031fb0: 7320 6361 7365 2061 2068 6173 6820 6a6f  s case a hash jo
-00031fc0: 696e 2069 7320 7065 7266 6f72 6d65 6420  in is performed 
-00031fd0: 7573 696e 670a 2020 2020 2020 2020 2020  using.          
-00031fe0: 2060 6064 6173 6b2e 6461 7461 6672 616d   ``dask.datafram
-00031ff0: 652e 6d75 6c74 692e 6861 7368 5f6a 6f69  e.multi.hash_joi
-00032000: 6e60 602e 0a0a 2020 2020 2020 2020 496e  n``...        In
-00032010: 2073 6f6d 6520 6361 7365 732c 2079 6f75   some cases, you
-00032020: 206d 6179 2073 6565 2061 2060 604d 656d   may see a ``Mem
-00032030: 6f72 7945 7272 6f72 6060 2069 6620 7468  oryError`` if th
-00032040: 6520 6060 6d65 7267 6560 6020 6f70 6572  e ``merge`` oper
-00032050: 6174 696f 6e20 7265 7175 6972 6573 0a20  ation requires. 
-00032060: 2020 2020 2020 2061 6e20 696e 7465 726e         an intern
-00032070: 616c 2060 6073 6875 6666 6c65 6060 2c20  al ``shuffle``, 
-00032080: 6265 6361 7573 6520 7368 7566 666c 696e  because shufflin
-00032090: 6720 706c 6163 6573 2061 6c6c 2072 6f77  g places all row
-000320a0: 7320 7468 6174 2068 6176 6520 7468 6520  s that have the 
-000320b0: 7361 6d65 0a20 2020 2020 2020 2069 6e64  same.        ind
-000320c0: 6578 2069 6e20 7468 6520 7361 6d65 2070  ex in the same p
-000320d0: 6172 7469 7469 6f6e 2e20 546f 2061 766f  artition. To avo
-000320e0: 6964 2074 6869 7320 6572 726f 722c 206d  id this error, m
-000320f0: 616b 6520 7375 7265 2061 6c6c 2072 6f77  ake sure all row
-00032100: 7320 7769 7468 2074 6865 0a20 2020 2020  s with the.     
-00032110: 2020 2073 616d 6520 6060 6f6e 6060 2d63     same ``on``-c
-00032120: 6f6c 756d 6e20 7661 6c75 6520 6361 6e20  olumn value can 
-00032130: 6669 7420 6f6e 2061 2073 696e 676c 6520  fit on a single 
-00032140: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
-00032150: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-00032160: 6966 206e 6f74 2069 735f 6461 7461 6672  if not is_datafr
-00032170: 616d 655f 6c69 6b65 2872 6967 6874 293a  ame_like(right):
-00032180: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00032190: 7365 2056 616c 7565 4572 726f 7228 2272  se ValueError("r
-000321a0: 6967 6874 206d 7573 7420 6265 2044 6174  ight must be Dat
-000321b0: 6146 7261 6d65 2229 0a0a 2020 2020 2020  aFrame")..      
-000321c0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
-000321d0: 6672 616d 652e 6d75 6c74 6920 696d 706f  frame.multi impo
-000321e0: 7274 206d 6572 6765 0a0a 2020 2020 2020  rt merge..      
-000321f0: 2020 7265 7475 726e 206d 6572 6765 280a    return merge(.
-00032200: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00032210: 2c0a 2020 2020 2020 2020 2020 2020 7269  ,.            ri
-00032220: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
-00032230: 2068 6f77 3d68 6f77 2c0a 2020 2020 2020   how=how,.      
-00032240: 2020 2020 2020 6f6e 3d6f 6e2c 0a20 2020        on=on,.   
-00032250: 2020 2020 2020 2020 206c 6566 745f 6f6e           left_on
-00032260: 3d6c 6566 745f 6f6e 2c0a 2020 2020 2020  =left_on,.      
-00032270: 2020 2020 2020 7269 6768 745f 6f6e 3d72        right_on=r
-00032280: 6967 6874 5f6f 6e2c 0a20 2020 2020 2020  ight_on,.       
-00032290: 2020 2020 206c 6566 745f 696e 6465 783d       left_index=
-000322a0: 6c65 6674 5f69 6e64 6578 2c0a 2020 2020  left_index,.    
-000322b0: 2020 2020 2020 2020 7269 6768 745f 696e          right_in
-000322c0: 6465 783d 7269 6768 745f 696e 6465 782c  dex=right_index,
-000322d0: 0a20 2020 2020 2020 2020 2020 2073 7566  .            suf
-000322e0: 6669 7865 733d 7375 6666 6978 6573 2c0a  fixes=suffixes,.
-000322f0: 2020 2020 2020 2020 2020 2020 6e70 6172              npar
-00032300: 7469 7469 6f6e 733d 6e70 6172 7469 7469  titions=npartiti
-00032310: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
-00032320: 2069 6e64 6963 6174 6f72 3d69 6e64 6963   indicator=indic
-00032330: 6174 6f72 2c0a 2020 2020 2020 2020 2020  ator,.          
-00032340: 2020 7368 7566 666c 653d 7368 7566 666c    shuffle=shuffl
-00032350: 652c 0a20 2020 2020 2020 2020 2020 2062  e,.            b
-00032360: 726f 6164 6361 7374 3d62 726f 6164 6361  roadcast=broadca
-00032370: 7374 2c0a 2020 2020 2020 2020 290a 0a20  st,.        ).. 
-00032380: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00032390: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-000323a0: 2020 2064 6566 206a 6f69 6e28 0a20 2020     def join(.   
-000323b0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-000323c0: 2020 206f 7468 6572 2c0a 2020 2020 2020     other,.      
-000323d0: 2020 6f6e 3d4e 6f6e 652c 0a20 2020 2020    on=None,.     
-000323e0: 2020 2068 6f77 3d22 6c65 6674 222c 0a20     how="left",. 
-000323f0: 2020 2020 2020 206c 7375 6666 6978 3d22         lsuffix="
-00032400: 222c 0a20 2020 2020 2020 2072 7375 6666  ",.        rsuff
-00032410: 6978 3d22 222c 0a20 2020 2020 2020 206e  ix="",.        n
-00032420: 7061 7274 6974 696f 6e73 3d4e 6f6e 652c  partitions=None,
-00032430: 0a20 2020 2020 2020 2073 6875 6666 6c65  .        shuffle
-00032440: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
-00032450: 2020 2020 2020 6966 2069 735f 7365 7269        if is_seri
-00032460: 6573 5f6c 696b 6528 6f74 6865 7229 2061  es_like(other) a
-00032470: 6e64 2068 6173 6174 7472 286f 7468 6572  nd hasattr(other
-00032480: 2c20 226e 616d 6522 293a 0a20 2020 2020  , "name"):.     
-00032490: 2020 2020 2020 206f 7468 6572 203d 206f         other = o
-000324a0: 7468 6572 2e74 6f5f 6672 616d 6528 290a  ther.to_frame().
-000324b0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-000324c0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-000324d0: 6528 6f74 6865 7229 3a0a 2020 2020 2020  e(other):.      
-000324e0: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-000324f0: 6e73 7461 6e63 6528 6f74 6865 722c 206c  nstance(other, l
-00032500: 6973 7429 206f 7220 6e6f 7420 616c 6c28  ist) or not all(
-00032510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032520: 205b 6973 5f64 6174 6166 7261 6d65 5f6c   [is_dataframe_l
-00032530: 696b 6528 6f29 2066 6f72 206f 2069 6e20  ike(o) for o in 
-00032540: 6f74 6865 725d 0a20 2020 2020 2020 2020  other].         
-00032550: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00032560: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00032570: 6545 7272 6f72 2822 6f74 6865 7220 6d75  eError("other mu
-00032580: 7374 2062 6520 4461 7461 4672 616d 6520  st be DataFrame 
-00032590: 6f72 206c 6973 7420 6f66 2044 6174 6146  or list of DataF
-000325a0: 7261 6d65 7322 290a 2020 2020 2020 2020  rames").        
-000325b0: 2020 2020 6966 2068 6f77 206e 6f74 2069      if how not i
-000325c0: 6e20 5b22 6f75 7465 7222 2c20 226c 6566  n ["outer", "lef
-000325d0: 7422 5d3a 0a20 2020 2020 2020 2020 2020  t"]:.           
-000325e0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000325f0: 4572 726f 7228 226d 6572 6765 5f6d 756c  Error("merge_mul
-00032600: 7469 206f 6e6c 7920 7375 7070 6f72 7473  ti only supports
-00032610: 206c 6566 7420 6f72 206f 7574 6572 206a   left or outer j
-00032620: 6f69 6e73 2229 0a0a 2020 2020 2020 2020  oins")..        
-00032630: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-00032640: 7461 6672 616d 652e 6d75 6c74 6920 696d  taframe.multi im
-00032650: 706f 7274 205f 7265 6375 7273 6976 655f  port _recursive_
-00032660: 7061 6972 7769 7365 5f6f 7574 6572 5f6a  pairwise_outer_j
-00032670: 6f69 6e0a 0a20 2020 2020 2020 2020 2020  oin..           
-00032680: 2023 2049 6620 6974 7320 616e 206f 7574   # If its an out
-00032690: 6572 206a 6f69 6e20 7765 2063 616e 2075  er join we can u
-000326a0: 7365 2074 6865 2066 756c 6c20 7265 6375  se the full recu
-000326b0: 7273 6976 6520 7061 6972 7769 7365 206a  rsive pairwise j
-000326c0: 6f69 6e2e 0a20 2020 2020 2020 2020 2020  oin..           
-000326d0: 2069 6620 686f 7720 3d3d 2022 6f75 7465   if how == "oute
-000326e0: 7222 3a0a 2020 2020 2020 2020 2020 2020  r":.            
-000326f0: 2020 2020 6675 6c6c 203d 205b 7365 6c66      full = [self
-00032700: 5d20 2b20 6f74 6865 720a 0a20 2020 2020  ] + other..     
-00032710: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00032720: 6e20 5f72 6563 7572 7369 7665 5f70 6169  n _recursive_pai
-00032730: 7277 6973 655f 6f75 7465 725f 6a6f 696e  rwise_outer_join
-00032740: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00032750: 2020 2020 2020 6675 6c6c 2c0a 2020 2020        full,.    
-00032760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032770: 6f6e 3d6f 6e2c 0a20 2020 2020 2020 2020  on=on,.         
-00032780: 2020 2020 2020 2020 2020 206c 7375 6666             lsuff
-00032790: 6978 3d6c 7375 6666 6978 2c0a 2020 2020  ix=lsuffix,.    
-000327a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000327b0: 7273 7566 6669 783d 7273 7566 6669 782c  rsuffix=rsuffix,
-000327c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000327d0: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
-000327e0: 3d6e 7061 7274 6974 696f 6e73 2c0a 2020  =npartitions,.  
-000327f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032800: 2020 7368 7566 666c 653d 7368 7566 666c    shuffle=shuffl
-00032810: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00032820: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00032830: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00032840: 2020 2020 2020 2023 2044 6f20 7265 6375         # Do recu
-00032850: 7273 6976 6520 7061 6972 7769 7365 206a  rsive pairwise j
-00032860: 6f69 6e20 6f6e 2065 7665 7279 7468 696e  oin on everythin
-00032870: 6720 5f65 7863 6570 745f 2074 6865 206c  g _except_ the l
-00032880: 6173 7420 6a6f 696e 0a20 2020 2020 2020  ast join.       
-00032890: 2020 2020 2020 2020 2023 2077 6865 7265           # where
-000328a0: 2077 6520 6e65 6564 2074 6f20 646f 2061   we need to do a
-000328b0: 206c 6566 7420 6a6f 696e 2e0a 2020 2020   left join..    
-000328c0: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
-000328d0: 7220 3d20 5f72 6563 7572 7369 7665 5f70  r = _recursive_p
-000328e0: 6169 7277 6973 655f 6f75 7465 725f 6a6f  airwise_outer_jo
-000328f0: 696e 280a 2020 2020 2020 2020 2020 2020  in(.            
-00032900: 2020 2020 2020 2020 6f74 6865 722c 0a20          other,. 
-00032910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032920: 2020 206f 6e3d 6f6e 2c0a 2020 2020 2020     on=on,.      
-00032930: 2020 2020 2020 2020 2020 2020 2020 6c73                ls
-00032940: 7566 6669 783d 6c73 7566 6669 782c 0a20  uffix=lsuffix,. 
-00032950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032960: 2020 2072 7375 6666 6978 3d72 7375 6666     rsuffix=rsuff
-00032970: 6978 2c0a 2020 2020 2020 2020 2020 2020  ix,.            
-00032980: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
-00032990: 6f6e 733d 6e70 6172 7469 7469 6f6e 732c  ons=npartitions,
-000329a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000329b0: 2020 2020 2073 6875 6666 6c65 3d73 6875       shuffle=shu
-000329c0: 6666 6c65 2c0a 2020 2020 2020 2020 2020  ffle,.          
-000329d0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-000329e0: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
-000329f0: 7261 6d65 2e6d 756c 7469 2069 6d70 6f72  rame.multi impor
-00032a00: 7420 6d65 7267 650a 0a20 2020 2020 2020  t merge..       
-00032a10: 2072 6574 7572 6e20 6d65 7267 6528 0a20   return merge(. 
-00032a20: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-00032a30: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
-00032a40: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-00032a50: 686f 773d 686f 772c 0a20 2020 2020 2020  how=how,.       
-00032a60: 2020 2020 206c 6566 745f 696e 6465 783d       left_index=
-00032a70: 6f6e 2069 7320 4e6f 6e65 2c0a 2020 2020  on is None,.    
-00032a80: 2020 2020 2020 2020 7269 6768 745f 696e          right_in
-00032a90: 6465 783d 5472 7565 2c0a 2020 2020 2020  dex=True,.      
-00032aa0: 2020 2020 2020 6c65 6674 5f6f 6e3d 6f6e        left_on=on
-00032ab0: 2c0a 2020 2020 2020 2020 2020 2020 7375  ,.            su
-00032ac0: 6666 6978 6573 3d28 6c73 7566 6669 782c  ffixes=(lsuffix,
-00032ad0: 2072 7375 6666 6978 292c 0a20 2020 2020   rsuffix),.     
-00032ae0: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
-00032af0: 6e73 3d6e 7061 7274 6974 696f 6e73 2c0a  ns=npartitions,.
-00032b00: 2020 2020 2020 2020 2020 2020 7368 7566              shuf
-00032b10: 666c 653d 7368 7566 666c 652c 0a20 2020  fle=shuffle,.   
-00032b20: 2020 2020 2029 0a0a 2020 2020 6966 206e       )..    if n
-00032b30: 6f74 2050 414e 4441 535f 4754 5f32 3030  ot PANDAS_GT_200
-00032b40: 3a0a 0a20 2020 2020 2020 2040 6465 7269  :..        @deri
-00032b50: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-00032b60: 4672 616d 6529 0a20 2020 2020 2020 2064  Frame).        d
-00032b70: 6566 2061 7070 656e 6428 7365 6c66 2c20  ef append(self, 
-00032b80: 6f74 6865 722c 2069 6e74 6572 6c65 6176  other, interleav
-00032b90: 655f 7061 7274 6974 696f 6e73 3d46 616c  e_partitions=Fal
-00032ba0: 7365 293a 0a20 2020 2020 2020 2020 2020  se):.           
-00032bb0: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
-00032bc0: 7468 6572 2c20 5365 7269 6573 293a 0a20  ther, Series):. 
-00032bd0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00032be0: 7367 203d 2028 0a20 2020 2020 2020 2020  sg = (.         
-00032bf0: 2020 2020 2020 2020 2020 2022 556e 6162             "Unab
-00032c00: 6c65 2074 6f20 6170 7065 6e64 696e 6720  le to appending 
-00032c10: 6464 2e53 6572 6965 7320 746f 2064 642e  dd.Series to dd.
-00032c20: 4461 7461 4672 616d 652e 220a 2020 2020  DataFrame.".    
-00032c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c40: 2255 7365 2070 642e 5365 7269 6573 2074  "Use pd.Series t
-00032c50: 6f20 6170 7065 6e64 2061 7320 726f 772e  o append as row.
-00032c60: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00032c70: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00032c80: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00032c90: 7272 6f72 286d 7367 290a 2020 2020 2020  rror(msg).      
-00032ca0: 2020 2020 2020 656c 6966 2069 735f 7365        elif is_se
-00032cb0: 7269 6573 5f6c 696b 6528 6f74 6865 7229  ries_like(other)
-00032cc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00032cd0: 2020 6f74 6865 7220 3d20 6f74 6865 722e    other = other.
-00032ce0: 746f 5f66 7261 6d65 2829 2e54 0a20 2020  to_frame().T.   
-00032cf0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00032d00: 7375 7065 7228 292e 6170 7065 6e64 286f  super().append(o
-00032d10: 7468 6572 2c20 696e 7465 726c 6561 7665  ther, interleave
-00032d20: 5f70 6172 7469 7469 6f6e 733d 696e 7465  _partitions=inte
-00032d30: 726c 6561 7665 5f70 6172 7469 7469 6f6e  rleave_partition
-00032d40: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
-00032d50: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-00032d60: 6d65 290a 2020 2020 6465 6620 6974 6572  me).    def iter
-00032d70: 726f 7773 2873 656c 6629 3a0a 2020 2020  rows(self):.    
-00032d80: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00032d90: 6765 2873 656c 662e 6e70 6172 7469 7469  ge(self.npartiti
-00032da0: 6f6e 7329 3a0a 2020 2020 2020 2020 2020  ons):.          
-00032db0: 2020 6466 203d 2073 656c 662e 6765 745f    df = self.get_
-00032dc0: 7061 7274 6974 696f 6e28 6929 2e63 6f6d  partition(i).com
-00032dd0: 7075 7465 2829 0a20 2020 2020 2020 2020  pute().         
-00032de0: 2020 2079 6965 6c64 2066 726f 6d20 6466     yield from df
-00032df0: 2e69 7465 7272 6f77 7328 290a 0a20 2020  .iterrows()..   
-00032e00: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00032e10: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-00032e20: 2064 6566 2069 7465 7274 7570 6c65 7328   def itertuples(
-00032e30: 7365 6c66 2c20 696e 6465 783d 5472 7565  self, index=True
-00032e40: 2c20 6e61 6d65 3d22 5061 6e64 6173 2229  , name="Pandas")
-00032e50: 3a0a 2020 2020 2020 2020 666f 7220 6920  :.        for i 
-00032e60: 696e 2072 616e 6765 2873 656c 662e 6e70  in range(self.np
-00032e70: 6172 7469 7469 6f6e 7329 3a0a 2020 2020  artitions):.    
-00032e80: 2020 2020 2020 2020 6466 203d 2073 656c          df = sel
-00032e90: 662e 6765 745f 7061 7274 6974 696f 6e28  f.get_partition(
-00032ea0: 6929 2e63 6f6d 7075 7465 2829 0a20 2020  i).compute().   
-00032eb0: 2020 2020 2020 2020 2079 6965 6c64 2066           yield f
-00032ec0: 726f 6d20 6466 2e69 7465 7274 7570 6c65  rom df.itertuple
-00032ed0: 7328 696e 6465 783d 696e 6465 782c 206e  s(index=index, n
-00032ee0: 616d 653d 6e61 6d65 290a 0a20 2020 2040  ame=name)..    @
-00032ef0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00032f00: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00032f10: 6566 2069 7465 6d73 2873 656c 6629 3a0a  ef items(self):.
-00032f20: 2020 2020 2020 2020 666f 7220 636f 6c5f          for col_
-00032f30: 6964 782c 206c 6162 656c 2069 6e20 656e  idx, label in en
-00032f40: 756d 6572 6174 6528 7365 6c66 2e63 6f6c  umerate(self.col
-00032f50: 756d 6e73 293a 0a20 2020 2020 2020 2020  umns):.         
-00032f60: 2020 2079 6965 6c64 206c 6162 656c 2c20     yield label, 
-00032f70: 7365 6c66 2e69 6c6f 635b 3a2c 2063 6f6c  self.iloc[:, col
-00032f80: 5f69 6478 5d0a 0a20 2020 2040 636c 6173  _idx]..    @clas
-00032f90: 736d 6574 686f 640a 2020 2020 6465 6620  smethod.    def 
-00032fa0: 5f62 696e 645f 6f70 6572 6174 6f72 5f6d  _bind_operator_m
-00032fb0: 6574 686f 6428 636c 732c 206e 616d 652c  ethod(cls, name,
-00032fc0: 206f 702c 206f 7269 6769 6e61 6c3d 7064   op, original=pd
-00032fd0: 2e44 6174 6146 7261 6d65 293a 0a20 2020  .DataFrame):.   
-00032fe0: 2020 2020 2022 2222 6269 6e64 206f 7065       """bind ope
-00032ff0: 7261 746f 7220 6d65 7468 6f64 206c 696b  rator method lik
-00033000: 6520 4461 7461 4672 616d 652e 6164 6420  e DataFrame.add 
-00033010: 746f 2074 6869 7320 636c 6173 7322 2222  to this class"""
-00033020: 0a0a 2020 2020 2020 2020 2320 6e61 6d65  ..        # name
-00033030: 206d 7573 7420 6265 2065 7870 6c69 6369   must be explici
-00033040: 746c 7920 7061 7373 6564 2066 6f72 2064  tly passed for d
-00033050: 6976 206d 6574 686f 6420 7768 6f73 6520  iv method whose 
-00033060: 6e61 6d65 2069 7320 7472 7565 6469 760a  name is truediv.
-00033070: 0a20 2020 2020 2020 2064 6566 206d 6574  .        def met
-00033080: 6828 7365 6c66 2c20 6f74 6865 722c 2061  h(self, other, a
-00033090: 7869 733d 2263 6f6c 756d 6e73 222c 206c  xis="columns", l
-000330a0: 6576 656c 3d4e 6f6e 652c 2066 696c 6c5f  evel=None, fill_
-000330b0: 7661 6c75 653d 4e6f 6e65 293a 0a20 2020  value=None):.   
-000330c0: 2020 2020 2020 2020 2069 6620 6c65 7665           if leve
-000330d0: 6c20 6973 206e 6f74 204e 6f6e 653a 0a20  l is not None:. 
-000330e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000330f0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-00033100: 7465 6445 7272 6f72 2822 6c65 7665 6c20  tedError("level 
-00033110: 6d75 7374 2062 6520 4e6f 6e65 2229 0a0a  must be None")..
-00033120: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00033130: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
-00033140: 655f 6178 6973 2861 7869 7329 0a0a 2020  e_axis(axis)..  
-00033150: 2020 2020 2020 2020 2020 6966 2061 7869            if axi
-00033160: 7320 696e 2028 312c 2022 636f 6c75 6d6e  s in (1, "column
-00033170: 7322 293a 0a20 2020 2020 2020 2020 2020  s"):.           
-00033180: 2020 2020 2023 2057 6865 6e20 6178 6973       # When axis
-00033190: 3d31 2061 6e64 206f 7468 6572 2069 7320  =1 and other is 
-000331a0: 6120 7365 7269 6573 2c20 606f 7468 6572  a series, `other
-000331b0: 6020 6973 2074 7261 6e73 706f 7365 640a  ` is transposed.
+0002d7a0: 2020 2020 2732 3032 312d 3031 2d30 3527      '2021-01-05'
+0002d7b0: 2c20 2732 3032 312d 3031 2d30 3627 2c20  , '2021-01-06', 
+0002d7c0: 2732 3032 312d 3031 2d30 3727 5d2c 0a20  '2021-01-07'],. 
+0002d7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d7e0: 2020 2020 2064 7479 7065 3d27 6461 7465       dtype='date
+0002d7f0: 7469 6d65 3634 5b6e 735d 272c 2066 7265  time64[ns]', fre
+0002d800: 713d 2744 2729 0a0a 2020 2020 2020 2020  q='D')..        
+0002d810: 4e6f 7465 2074 6861 7420 6060 6c65 6e28  Note that ``len(
+0002d820: 6469 7669 736f 6e73 2960 6020 6973 2065  divisons)`` is e
+0002d830: 7175 616c 2074 6f20 6060 6e70 6172 7469  qual to ``nparti
+0002d840: 7469 6f6e 7320 2b20 3160 602e 2054 6869  tions + 1``. Thi
+0002d850: 7320 6973 2062 6563 6175 7365 2060 6064  s is because ``d
+0002d860: 6976 6973 696f 6e73 6060 0a20 2020 2020  ivisions``.     
+0002d870: 2020 2072 6570 7265 7365 6e74 7320 7468     represents th
+0002d880: 6520 7570 7065 7220 616e 6420 6c6f 7765  e upper and lowe
+0002d890: 7220 626f 756e 6473 206f 6620 6561 6368  r bounds of each
+0002d8a0: 2070 6172 7469 7469 6f6e 2e20 5468 6520   partition. The 
+0002d8b0: 6669 7273 7420 6974 656d 2069 7320 7468  first item is th
+0002d8c0: 650a 2020 2020 2020 2020 6c6f 7765 7220  e.        lower 
+0002d8d0: 626f 756e 6420 6f66 2074 6865 2066 6972  bound of the fir
+0002d8e0: 7374 2070 6172 7469 7469 6f6e 2c20 7468  st partition, th
+0002d8f0: 6520 7365 636f 6e64 2069 7465 6d20 6973  e second item is
+0002d900: 2074 6865 206c 6f77 6572 2062 6f75 6e64   the lower bound
+0002d910: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+0002d920: 7365 636f 6e64 2070 6172 7469 7469 6f6e  second partition
+0002d930: 2061 6e64 2074 6865 2075 7070 6572 2062   and the upper b
+0002d940: 6f75 6e64 206f 6620 7468 6520 6669 7273  ound of the firs
+0002d950: 7420 7061 7274 6974 696f 6e2c 2061 6e64  t partition, and
+0002d960: 2073 6f20 6f6e 2e0a 2020 2020 2020 2020   so on..        
+0002d970: 5468 6520 7365 636f 6e64 2d74 6f2d 6c61  The second-to-la
+0002d980: 7374 2069 7465 6d20 6973 2074 6865 206c  st item is the l
+0002d990: 6f77 6572 2062 6f75 6e64 206f 6620 7468  ower bound of th
+0002d9a0: 6520 6c61 7374 2070 6172 7469 7469 6f6e  e last partition
+0002d9b0: 2c20 616e 6420 7468 6520 6c61 7374 0a20  , and the last. 
+0002d9c0: 2020 2020 2020 2028 6578 7472 6129 2069         (extra) i
+0002d9d0: 7465 6d20 6973 2074 6865 2075 7070 6572  tem is the upper
+0002d9e0: 2062 6f75 6e64 206f 6620 7468 6520 6c61   bound of the la
+0002d9f0: 7374 2070 6172 7469 7469 6f6e 2e0a 0a20  st partition... 
+0002da00: 2020 2020 2020 203e 3e3e 2064 6466 3220         >>> ddf2 
+0002da10: 3d20 6464 662e 7365 745f 696e 6465 7828  = ddf.set_index(
+0002da20: 2274 696d 6573 7461 6d70 222c 2073 6f72  "timestamp", sor
+0002da30: 7465 643d 5472 7565 2c20 6469 7669 7369  ted=True, divisi
+0002da40: 6f6e 733d 6469 7669 7369 6f6e 732e 746f  ons=divisions.to
+0002da50: 6c69 7374 2829 290a 0a20 2020 2020 2020  list())..       
+0002da60: 2049 6620 796f 7527 6c6c 2062 6520 7275   If you'll be ru
+0002da70: 6e6e 696e 6720 6073 6574 5f69 6e64 6578  nning `set_index
+0002da80: 6020 6f6e 2074 6865 2073 616d 6520 286f  ` on the same (o
+0002da90: 7220 7369 6d69 6c61 7229 2064 6174 6173  r similar) datas
+0002daa0: 6574 7320 7265 7065 6174 6564 6c79 2c0a  ets repeatedly,.
+0002dab0: 2020 2020 2020 2020 796f 7520 636f 756c          you coul
+0002dac0: 6420 7361 7665 2074 696d 6520 6279 206c  d save time by l
+0002dad0: 6574 7469 6e67 2044 6173 6b20 6361 6c63  etting Dask calc
+0002dae0: 756c 6174 6520 676f 6f64 2064 6976 6973  ulate good divis
+0002daf0: 696f 6e73 206f 6e63 652c 2074 6865 6e20  ions once, then 
+0002db00: 636f 7079 2d70 6173 7469 6e67 0a20 2020  copy-pasting.   
+0002db10: 2020 2020 2074 6865 6d20 746f 2072 6575       them to reu
+0002db20: 7365 2e20 5468 6973 2069 7320 6573 7065  se. This is espe
+0002db30: 6369 616c 6c79 2068 656c 7066 756c 2072  cially helpful r
+0002db40: 756e 6e69 6e67 2069 6e20 6120 4a75 7079  unning in a Jupy
+0002db50: 7465 7220 6e6f 7465 626f 6f6b 3a0a 0a20  ter notebook:.. 
+0002db60: 2020 2020 2020 203e 3e3e 2064 6466 3220         >>> ddf2 
+0002db70: 3d20 6464 662e 7365 745f 696e 6465 7828  = ddf.set_index(
+0002db80: 226e 616d 6522 2920 2023 2073 6c6f 772c  "name")  # slow,
+0002db90: 2063 616c 6375 6c61 7465 7320 6461 7461   calculates data
+0002dba0: 2064 6973 7472 6962 7574 696f 6e0a 2020   distribution.  
+0002dbb0: 2020 2020 2020 3e3e 3e20 6464 6632 2e64        >>> ddf2.d
+0002dbc0: 6976 6973 696f 6e73 2020 2320 646f 6374  ivisions  # doct
+0002dbd0: 6573 743a 202b 534b 4950 0a20 2020 2020  est: +SKIP.     
+0002dbe0: 2020 205b 2241 6c69 6365 222c 2022 4c61     ["Alice", "La
+0002dbf0: 7572 6122 2c20 2255 7273 756c 6122 2c20  ura", "Ursula", 
+0002dc00: 225a 656c 6461 225d 0a20 2020 2020 2020  "Zelda"].       
+0002dc10: 203e 3e3e 2023 205e 204e 6f77 2063 6f70   >>> # ^ Now cop
+0002dc20: 792d 7061 7374 6520 7468 6973 2061 6e64  y-paste this and
+0002dc30: 2065 6469 7420 7468 6520 6c69 6e65 2061   edit the line a
+0002dc40: 626f 7665 2074 6f3a 0a20 2020 2020 2020  bove to:.       
+0002dc50: 203e 3e3e 2023 2064 6466 3220 3d20 6464   >>> # ddf2 = dd
+0002dc60: 662e 7365 745f 696e 6465 7828 226e 616d  f.set_index("nam
+0002dc70: 6522 2c20 6469 7669 7369 6f6e 733d 5b22  e", divisions=["
+0002dc80: 416c 6963 6522 2c20 224c 6175 7261 222c  Alice", "Laura",
+0002dc90: 2022 5572 7375 6c61 222c 2022 5a65 6c64   "Ursula", "Zeld
+0002dca0: 6122 5d29 0a20 2020 2020 2020 2022 2222  a"]).        """
+0002dcb0: 0a0a 2020 2020 2020 2020 6966 2069 6e70  ..        if inp
+0002dcc0: 6c61 6365 3a0a 2020 2020 2020 2020 2020  lace:.          
+0002dcd0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+0002dce0: 6d65 6e74 6564 4572 726f 7228 2254 6865  mentedError("The
+0002dcf0: 2069 6e70 6c61 6365 3d20 6b65 7977 6f72   inplace= keywor
+0002dd00: 6420 6973 206e 6f74 2073 7570 706f 7274  d is not support
+0002dd10: 6564 2229 0a20 2020 2020 2020 2070 7265  ed").        pre
+0002dd20: 5f73 6f72 7465 6420 3d20 736f 7274 6564  _sorted = sorted
+0002dd30: 0a20 2020 2020 2020 2064 656c 2073 6f72  .        del sor
+0002dd40: 7465 640a 0a20 2020 2020 2020 2023 2043  ted..        # C
+0002dd50: 6865 636b 206f 7468 6572 2063 616e 2062  heck other can b
+0002dd60: 6520 7472 616e 736c 6174 6564 2074 6f20  e translated to 
+0002dd70: 636f 6c75 6d6e 206e 616d 6520 6f72 2063  column name or c
+0002dd80: 6f6c 756d 6e20 6f62 6a65 6374 2c20 706f  olumn object, po
+0002dd90: 7373 6962 6c79 2066 6c61 7474 656e 696e  ssibly flattenin
+0002dda0: 6720 6974 0a20 2020 2020 2020 2069 6620  g it.        if 
+0002ddb0: 6e6f 7420 6973 696e 7374 616e 6365 286f  not isinstance(o
+0002ddc0: 7468 6572 2c20 7374 7229 3a0a 2020 2020  ther, str):.    
+0002ddd0: 2020 2020 2020 2020 2320 4974 206d 6179          # It may
+0002dde0: 2072 6566 6572 2074 6f20 7365 7665 7261   refer to severa
+0002ddf0: 6c20 636f 6c75 6d6e 730a 2020 2020 2020  l columns.      
+0002de00: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0002de10: 6e63 6528 6f74 6865 722c 2053 6571 7565  nce(other, Seque
+0002de20: 6e63 6529 3a20 2023 2074 7970 653a 2069  nce):  # type: i
+0002de30: 676e 6f72 655b 756e 7265 6163 6861 626c  gnore[unreachabl
+0002de40: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
+0002de50: 2020 2023 2041 6363 6570 7420 5b22 6122     # Accept ["a"
+0002de60: 5d2c 2062 7574 206e 6f74 205b 5b22 6122  ], but not [["a"
+0002de70: 5d5d 0a20 2020 2020 2020 2020 2020 2020  ]].             
+0002de80: 2020 2069 6620 6c65 6e28 6f74 6865 7229     if len(other)
+0002de90: 203d 3d20 3120 616e 6420 2820 2023 2074   == 1 and (  # t
+0002dea0: 7970 653a 2069 676e 6f72 655b 756e 7265  ype: ignore[unre
+0002deb0: 6163 6861 626c 655d 0a20 2020 2020 2020  achable].       
+0002dec0: 2020 2020 2020 2020 2020 2020 2069 7369               isi
+0002ded0: 6e73 7461 6e63 6528 6f74 6865 725b 305d  nstance(other[0]
+0002dee0: 2c20 7374 7229 206f 7220 6e6f 7420 6973  , str) or not is
+0002def0: 696e 7374 616e 6365 286f 7468 6572 5b30  instance(other[0
+0002df00: 5d2c 2053 6571 7565 6e63 6529 0a20 2020  ], Sequence).   
+0002df10: 2020 2020 2020 2020 2020 2020 2029 3a0a               ):.
+0002df20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002df30: 2020 2020 6f74 6865 7220 3d20 6f74 6865      other = othe
+0002df40: 725b 305d 0a20 2020 2020 2020 2020 2020  r[0].           
+0002df50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0002df60: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0002df70: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+0002df80: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+0002df90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dfa0: 2020 2244 6173 6b20 6461 7461 6672 616d    "Dask datafram
+0002dfb0: 6520 646f 6573 206e 6f74 2079 6574 2073  e does not yet s
+0002dfc0: 7570 706f 7274 206d 756c 7469 2d69 6e64  upport multi-ind
+0002dfd0: 6578 6573 2e5c 6e22 0a20 2020 2020 2020  exes.\n".       
+0002dfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dff0: 2066 2259 6f75 2074 7269 6564 2074 6f20   f"You tried to 
+0002e000: 696e 6465 7820 7769 7468 2074 6869 7320  index with this 
+0002e010: 696e 6465 783a 207b 6f74 6865 727d 5c6e  index: {other}\n
+0002e020: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0002e030: 2020 2020 2020 2020 2020 2249 6e64 6578            "Index
+0002e040: 6573 206d 7573 7420 6265 2073 696e 676c  es must be singl
+0002e050: 6520 636f 6c75 6d6e 7320 6f6e 6c79 2e22  e columns only."
+0002e060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e070: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0002e080: 2020 2020 2320 4f72 2062 6520 6120 6672      # Or be a fr
+0002e090: 616d 6520 6469 7265 6374 6c79 0a20 2020  ame directly.   
+0002e0a0: 2020 2020 2020 2020 2065 6c69 6620 6973           elif is
+0002e0b0: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
+0002e0c0: 4461 7461 4672 616d 6529 3a20 2023 2074  DataFrame):  # t
+0002e0d0: 7970 653a 2069 676e 6f72 655b 756e 7265  ype: ignore[unre
+0002e0e0: 6163 6861 626c 655d 0a20 2020 2020 2020  achable].       
+0002e0f0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+0002e100: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0002e110: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0002e120: 2020 2020 2020 2020 2244 6173 6b20 6461          "Dask da
+0002e130: 7461 6672 616d 6520 646f 6573 206e 6f74  taframe does not
+0002e140: 2079 6574 2073 7570 706f 7274 206d 756c   yet support mul
+0002e150: 7469 2d69 6e64 6578 6573 2e5c 6e22 0a20  ti-indexes.\n". 
+0002e160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e170: 2020 2066 2259 6f75 2074 7269 6564 2074     f"You tried t
+0002e180: 6f20 696e 6465 7820 7769 7468 2061 2066  o index with a f
+0002e190: 7261 6d65 2077 6974 6820 7468 6573 6520  rame with these 
+0002e1a0: 636f 6c75 6d6e 733a 207b 6c69 7374 286f  columns: {list(o
+0002e1b0: 7468 6572 2e63 6f6c 756d 6e73 297d 5c6e  ther.columns)}\n
+0002e1c0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0002e1d0: 2020 2020 2020 2249 6e64 6578 6573 206d        "Indexes m
+0002e1e0: 7573 7420 6265 2073 696e 676c 6520 636f  ust be single co
+0002e1f0: 6c75 6d6e 7320 6f6e 6c79 2e22 0a20 2020  lumns only.".   
+0002e200: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0002e210: 2020 2020 2020 2020 2320 4966 2061 6c72          # If alr
+0002e220: 6561 6479 2061 2073 6572 6965 730a 2020  eady a series.  
+0002e230: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0002e240: 6e63 6528 6f74 6865 722c 2053 6572 6965  nce(other, Serie
+0002e250: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+0002e260: 2320 4966 2069 7427 7320 616c 7265 6164  # If it's alread
+0002e270: 7920 7468 6520 696e 6465 782c 2074 6865  y the index, the
+0002e280: 7265 2773 206e 6f74 6869 6e67 2074 6f20  re's nothing to 
+0002e290: 646f 0a20 2020 2020 2020 2020 2020 2069  do.            i
+0002e2a0: 6620 6f74 6865 722e 5f6e 616d 6520 3d3d  f other._name ==
+0002e2b0: 2073 656c 662e 696e 6465 782e 5f6e 616d   self.index._nam
+0002e2c0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002e2d0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+0002e2e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002e2f0: 2020 2020 2020 224e 6577 2069 6e64 6578        "New index
+0002e300: 2068 6173 2073 616d 6520 6e61 6d65 2061   has same name a
+0002e310: 7320 6578 6973 7469 6e67 2c20 7468 6973  s existing, this
+0002e320: 2069 7320 6120 6e6f 2d6f 702e 222c 2055   is a no-op.", U
+0002e330: 7365 7257 6172 6e69 6e67 0a20 2020 2020  serWarning.     
+0002e340: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0002e350: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0002e360: 7572 6e20 7365 6c66 0a0a 2020 2020 2020  urn self..      
+0002e370: 2020 2320 4966 2074 6865 206e 616d 6520    # If the name 
+0002e380: 6f66 2061 2063 6f6c 756d 6e2f 696e 6465  of a column/inde
+0002e390: 780a 2020 2020 2020 2020 656c 7365 3a0a  x.        else:.
+0002e3a0: 2020 2020 2020 2020 2020 2020 2320 5769              # Wi
+0002e3b0: 7468 2074 6865 2073 616d 6520 6e61 6d65  th the same name
+0002e3c0: 2061 7320 7468 6520 696e 6465 782c 2074   as the index, t
+0002e3d0: 6865 7265 2773 206e 6f74 6869 6e67 2074  here's nothing t
+0002e3e0: 6f20 646f 2065 6974 6865 720a 2020 2020  o do either.    
+0002e3f0: 2020 2020 2020 2020 6966 206f 7468 6572          if other
+0002e400: 203d 3d20 7365 6c66 2e69 6e64 6578 2e6e   == self.index.n
+0002e410: 616d 653a 0a20 2020 2020 2020 2020 2020  ame:.           
+0002e420: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+0002e430: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+0002e440: 2020 2020 2020 2020 224e 6577 2069 6e64          "New ind
+0002e450: 6578 2068 6173 2073 616d 6520 6e61 6d65  ex has same name
+0002e460: 2061 7320 6578 6973 7469 6e67 2c20 7468   as existing, th
+0002e470: 6973 2069 7320 6120 6e6f 2d6f 702e 222c  is is a no-op.",
+0002e480: 2055 7365 7257 6172 6e69 6e67 0a20 2020   UserWarning.   
+0002e490: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0002e4a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0002e4b0: 6574 7572 6e20 7365 6c66 0a0a 2020 2020  eturn self..    
+0002e4c0: 2020 2020 2020 2020 2320 4966 2061 206d          # If a m
+0002e4d0: 6973 7369 6e67 2063 6f6c 756d 6e2c 204b  issing column, K
+0002e4e0: 6579 4572 726f 720a 2020 2020 2020 2020  eyError.        
+0002e4f0: 2020 2020 6966 206f 7468 6572 206e 6f74      if other not
+0002e500: 2069 6e20 7365 6c66 2e63 6f6c 756d 6e73   in self.columns
+0002e510: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002e520: 2020 7261 6973 6520 4b65 7945 7272 6f72    raise KeyError
+0002e530: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002e540: 2020 2020 2020 6622 4461 7461 2068 6173        f"Data has
+0002e550: 206e 6f20 636f 6c75 6d6e 2027 7b6f 7468   no column '{oth
+0002e560: 6572 7d27 3a20 7573 6520 616e 7920 636f  er}': use any co
+0002e570: 6c75 6d6e 206f 6620 7b6c 6973 7428 7365  lumn of {list(se
+0002e580: 6c66 2e63 6f6c 756d 6e73 297d 220a 2020  lf.columns)}".  
+0002e590: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0002e5a0: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
+0002e5b0: 2064 6976 6973 696f 6e73 0a20 2020 2020   divisions.     
+0002e5c0: 2020 2069 6620 6469 7669 7369 6f6e 7320     if divisions 
+0002e5d0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0002e5e0: 2020 2020 2020 2020 2063 6865 636b 5f64           check_d
+0002e5f0: 6976 6973 696f 6e73 2864 6976 6973 696f  ivisions(divisio
+0002e600: 6e73 290a 2020 2020 2020 2020 656c 6966  ns).        elif
+0002e610: 2028 0a20 2020 2020 2020 2020 2020 2069   (.            i
+0002e620: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
+0002e630: 2049 6e64 6578 290a 2020 2020 2020 2020   Index).        
+0002e640: 2020 2020 616e 6420 6f74 6865 722e 6b6e      and other.kn
+0002e650: 6f77 6e5f 6469 7669 7369 6f6e 730a 2020  own_divisions.  
+0002e660: 2020 2020 2020 2020 2020 616e 6420 6f74            and ot
+0002e670: 6865 722e 6e70 6172 7469 7469 6f6e 7320  her.npartitions 
+0002e680: 3d3d 2073 656c 662e 6e70 6172 7469 7469  == self.npartiti
+0002e690: 6f6e 730a 2020 2020 2020 2020 293a 0a20  ons.        ):. 
+0002e6a0: 2020 2020 2020 2020 2020 2023 2049 6620             # If 
+0002e6b0: 7468 6520 696e 6465 7820 6861 7320 7468  the index has th
+0002e6c0: 6520 7361 6d65 206e 756d 6265 7220 6f66  e same number of
+0002e6d0: 2070 6172 7469 7469 6f6e 7320 616e 6420   partitions and 
+0002e6e0: 6b6e 6f77 6e0a 2020 2020 2020 2020 2020  known.          
+0002e6f0: 2020 2320 6469 7669 7369 6f6e 732c 2074    # divisions, t
+0002e700: 6865 6e20 7765 2063 616e 2074 7265 6174  hen we can treat
+0002e710: 2069 7420 6173 2070 7265 2d73 6f72 7465   it as pre-sorte
+0002e720: 6420 7769 7468 206b 6e6f 776e 0a20 2020  d with known.   
+0002e730: 2020 2020 2020 2020 2023 2064 6976 6973           # divis
+0002e740: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
+0002e750: 2070 7265 5f73 6f72 7465 6420 3d20 5472   pre_sorted = Tr
+0002e760: 7565 0a20 2020 2020 2020 2020 2020 2064  ue.            d
+0002e770: 6976 6973 696f 6e73 203d 206f 7468 6572  ivisions = other
+0002e780: 2e64 6976 6973 696f 6e73 0a0a 2020 2020  .divisions..    
+0002e790: 2020 2020 2320 4966 2069 6e64 6578 2069      # If index i
+0002e7a0: 7320 616c 7265 6164 7920 736f 7274 6564  s already sorted
+0002e7b0: 2c20 7461 6b65 2061 6476 616e 7461 6765  , take advantage
+0002e7c0: 206f 6620 7468 6174 2077 6974 6820 7365   of that with se
+0002e7d0: 745f 736f 7274 6564 5f69 6e64 6578 0a20  t_sorted_index. 
+0002e7e0: 2020 2020 2020 2069 6620 7072 655f 736f         if pre_so
+0002e7f0: 7274 6564 3a0a 2020 2020 2020 2020 2020  rted:.          
+0002e800: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+0002e810: 6672 616d 652e 7368 7566 666c 6520 696d  frame.shuffle im
+0002e820: 706f 7274 2073 6574 5f73 6f72 7465 645f  port set_sorted_
+0002e830: 696e 6465 780a 0a20 2020 2020 2020 2020  index..         
+0002e840: 2020 2072 6574 7572 6e20 7365 745f 736f     return set_so
+0002e850: 7274 6564 5f69 6e64 6578 280a 2020 2020  rted_index(.    
+0002e860: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002e870: 2c20 6f74 6865 722c 2064 726f 703d 6472  , other, drop=dr
+0002e880: 6f70 2c20 6469 7669 7369 6f6e 733d 6469  op, divisions=di
+0002e890: 7669 7369 6f6e 732c 202a 2a6b 7761 7267  visions, **kwarg
+0002e8a0: 730a 2020 2020 2020 2020 2020 2020 290a  s.            ).
+0002e8b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002e8c0: 2020 2020 2020 2020 2020 6672 6f6d 2064            from d
+0002e8d0: 6173 6b2e 6461 7461 6672 616d 652e 7368  ask.dataframe.sh
+0002e8e0: 7566 666c 6520 696d 706f 7274 2073 6574  uffle import set
+0002e8f0: 5f69 6e64 6578 0a0a 2020 2020 2020 2020  _index..        
+0002e900: 2020 2020 7265 7475 726e 2073 6574 5f69      return set_i
+0002e910: 6e64 6578 280a 2020 2020 2020 2020 2020  ndex(.          
+0002e920: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0002e930: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
+0002e940: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
+0002e950: 2020 2064 726f 703d 6472 6f70 2c0a 2020     drop=drop,.  
+0002e960: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+0002e970: 6172 7469 7469 6f6e 733d 6e70 6172 7469  artitions=nparti
+0002e980: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+0002e990: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+0002e9a0: 3d64 6976 6973 696f 6e73 2c0a 2020 2020  =divisions,.    
+0002e9b0: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
+0002e9c0: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
+0002e9d0: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
+0002e9e0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+0002e9f0: 616d 6529 0a20 2020 2064 6566 2070 6f70  ame).    def pop
+0002ea00: 2873 656c 662c 2069 7465 6d29 3a0a 2020  (self, item):.  
+0002ea10: 2020 2020 2020 6f75 7420 3d20 7365 6c66        out = self
+0002ea20: 5b69 7465 6d5d 0a20 2020 2020 2020 2064  [item].        d
+0002ea30: 656c 2073 656c 665b 6974 656d 5d0a 2020  el self[item].  
+0002ea40: 2020 2020 2020 7265 7475 726e 206f 7574        return out
+0002ea50: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+0002ea60: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+0002ea70: 290a 2020 2020 6465 6620 6e6c 6172 6765  ).    def nlarge
+0002ea80: 7374 2873 656c 662c 206e 3d35 2c20 636f  st(self, n=5, co
+0002ea90: 6c75 6d6e 733d 6e6f 5f64 6566 6175 6c74  lumns=no_default
+0002eaa0: 2c20 7370 6c69 745f 6576 6572 793d 4e6f  , split_every=No
+0002eab0: 6e65 293a 0a20 2020 2020 2020 2069 6620  ne):.        if 
+0002eac0: 636f 6c75 6d6e 7320 6973 206e 6f5f 6465  columns is no_de
+0002ead0: 6661 756c 743a 0a20 2020 2020 2020 2020  fault:.         
+0002eae0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+0002eaf0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0002eb00: 2020 2020 2244 6174 6146 7261 6d65 2e6e      "DataFrame.n
+0002eb10: 6c61 7267 6573 7428 2920 6d69 7373 696e  largest() missin
+0002eb20: 6720 7265 7175 6972 6564 2070 6f73 6974  g required posit
+0002eb30: 696f 6e61 6c20 6172 6775 6d65 6e74 3a20  ional argument: 
+0002eb40: 2763 6f6c 756d 6e73 2722 0a20 2020 2020  'columns'".     
+0002eb50: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0002eb60: 2074 6f6b 656e 203d 2022 6461 7461 6672   token = "datafr
+0002eb70: 616d 652d 6e6c 6172 6765 7374 220a 2020  ame-nlargest".  
+0002eb80: 2020 2020 2020 7265 7475 726e 2061 6361        return aca
+0002eb90: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0002eba0: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+0002ebb0: 6368 756e 6b3d 4d2e 6e6c 6172 6765 7374  chunk=M.nlargest
+0002ebc0: 2c0a 2020 2020 2020 2020 2020 2020 6167  ,.            ag
+0002ebd0: 6772 6567 6174 653d 4d2e 6e6c 6172 6765  gregate=M.nlarge
+0002ebe0: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+0002ebf0: 6d65 7461 3d73 656c 662e 5f6d 6574 612c  meta=self._meta,
+0002ec00: 0a20 2020 2020 2020 2020 2020 2074 6f6b  .            tok
+0002ec10: 656e 3d74 6f6b 656e 2c0a 2020 2020 2020  en=token,.      
+0002ec20: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
+0002ec30: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
+0002ec40: 2020 2020 2020 2020 2020 206e 3d6e 2c0a             n=n,.
+0002ec50: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+0002ec60: 6d6e 733d 636f 6c75 6d6e 732c 0a20 2020  mns=columns,.   
+0002ec70: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+0002ec80: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+0002ec90: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+0002eca0: 6e73 6d61 6c6c 6573 7428 7365 6c66 2c20  nsmallest(self, 
+0002ecb0: 6e3d 352c 2063 6f6c 756d 6e73 3d6e 6f5f  n=5, columns=no_
+0002ecc0: 6465 6661 756c 742c 2073 706c 6974 5f65  default, split_e
+0002ecd0: 7665 7279 3d4e 6f6e 6529 3a0a 2020 2020  very=None):.    
+0002ece0: 2020 2020 6966 2063 6f6c 756d 6e73 2069      if columns i
+0002ecf0: 7320 6e6f 5f64 6566 6175 6c74 3a0a 2020  s no_default:.  
+0002ed00: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0002ed10: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+0002ed20: 2020 2020 2020 2020 2020 2022 4461 7461             "Data
+0002ed30: 4672 616d 652e 6e73 6d61 6c6c 6573 7428  Frame.nsmallest(
+0002ed40: 2920 6d69 7373 696e 6720 7265 7175 6972  ) missing requir
+0002ed50: 6564 2070 6f73 6974 696f 6e61 6c20 6172  ed positional ar
+0002ed60: 6775 6d65 6e74 3a20 2763 6f6c 756d 6e73  gument: 'columns
+0002ed70: 2722 0a20 2020 2020 2020 2020 2020 2029  '".            )
+0002ed80: 0a20 2020 2020 2020 2074 6f6b 656e 203d  .        token =
+0002ed90: 2022 6461 7461 6672 616d 652d 6e73 6d61   "dataframe-nsma
+0002eda0: 6c6c 6573 7422 0a20 2020 2020 2020 2072  llest".        r
+0002edb0: 6574 7572 6e20 6163 6128 0a20 2020 2020  eturn aca(.     
+0002edc0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0002edd0: 2020 2020 2020 2020 2063 6875 6e6b 3d4d           chunk=M
+0002ede0: 2e6e 736d 616c 6c65 7374 2c0a 2020 2020  .nsmallest,.    
+0002edf0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+0002ee00: 653d 4d2e 6e73 6d61 6c6c 6573 742c 0a20  e=M.nsmallest,. 
+0002ee10: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
+0002ee20: 7365 6c66 2e5f 6d65 7461 2c0a 2020 2020  self._meta,.    
+0002ee30: 2020 2020 2020 2020 746f 6b65 6e3d 746f          token=to
+0002ee40: 6b65 6e2c 0a20 2020 2020 2020 2020 2020  ken,.           
+0002ee50: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+0002ee60: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
+0002ee70: 2020 2020 2020 6e3d 6e2c 0a20 2020 2020        n=n,.     
+0002ee80: 2020 2020 2020 2063 6f6c 756d 6e73 3d63         columns=c
+0002ee90: 6f6c 756d 6e73 2c0a 2020 2020 2020 2020  olumns,.        
+0002eea0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0002eeb0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0002eec0: 6529 0a20 2020 2064 6566 2067 726f 7570  e).    def group
+0002eed0: 6279 280a 2020 2020 2020 2020 7365 6c66  by(.        self
+0002eee0: 2c0a 2020 2020 2020 2020 6279 3d4e 6f6e  ,.        by=Non
+0002eef0: 652c 0a20 2020 2020 2020 2067 726f 7570  e,.        group
+0002ef00: 5f6b 6579 733d 4752 4f55 505f 4b45 5953  _keys=GROUP_KEYS
+0002ef10: 5f44 4546 4155 4c54 2c0a 2020 2020 2020  _DEFAULT,.      
+0002ef20: 2020 736f 7274 3d4e 6f6e 652c 0a20 2020    sort=None,.   
+0002ef30: 2020 2020 206f 6273 6572 7665 643d 4e6f       observed=No
+0002ef40: 6e65 2c0a 2020 2020 2020 2020 6472 6f70  ne,.        drop
+0002ef50: 6e61 3d4e 6f6e 652c 0a20 2020 2020 2020  na=None,.       
+0002ef60: 202a 2a6b 7761 7267 732c 0a20 2020 2029   **kwargs,.    )
+0002ef70: 3a0a 2020 2020 2020 2020 6672 6f6d 2064  :.        from d
+0002ef80: 6173 6b2e 6461 7461 6672 616d 652e 6772  ask.dataframe.gr
+0002ef90: 6f75 7062 7920 696d 706f 7274 2044 6174  oupby import Dat
+0002efa0: 6146 7261 6d65 4772 6f75 7042 790a 0a20  aFrameGroupBy.. 
+0002efb0: 2020 2020 2020 2072 6574 7572 6e20 4461         return Da
+0002efc0: 7461 4672 616d 6547 726f 7570 4279 280a  taFrameGroupBy(.
+0002efd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002efe0: 2c0a 2020 2020 2020 2020 2020 2020 6279  ,.            by
+0002eff0: 3d62 792c 0a20 2020 2020 2020 2020 2020  =by,.           
+0002f000: 2067 726f 7570 5f6b 6579 733d 6772 6f75   group_keys=grou
+0002f010: 705f 6b65 7973 2c0a 2020 2020 2020 2020  p_keys,.        
+0002f020: 2020 2020 736f 7274 3d73 6f72 742c 0a20      sort=sort,. 
+0002f030: 2020 2020 2020 2020 2020 206f 6273 6572             obser
+0002f040: 7665 643d 6f62 7365 7276 6564 2c0a 2020  ved=observed,.  
+0002f050: 2020 2020 2020 2020 2020 6472 6f70 6e61            dropna
+0002f060: 3d64 726f 706e 612c 0a20 2020 2020 2020  =dropna,.       
+0002f070: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
+0002f080: 2020 2020 2020 2029 0a0a 2020 2020 4077         )..    @w
+0002f090: 7261 7073 2863 6174 6567 6f72 697a 6529  raps(categorize)
+0002f0a0: 0a20 2020 2064 6566 2063 6174 6567 6f72  .    def categor
+0002f0b0: 697a 6528 7365 6c66 2c20 636f 6c75 6d6e  ize(self, column
+0002f0c0: 733d 4e6f 6e65 2c20 696e 6465 783d 4e6f  s=None, index=No
+0002f0d0: 6e65 2c20 7370 6c69 745f 6576 6572 793d  ne, split_every=
+0002f0e0: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 293a  None, **kwargs):
+0002f0f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002f100: 6361 7465 676f 7269 7a65 280a 2020 2020  categorize(.    
+0002f110: 2020 2020 2020 2020 7365 6c66 2c20 636f          self, co
+0002f120: 6c75 6d6e 733d 636f 6c75 6d6e 732c 2069  lumns=columns, i
+0002f130: 6e64 6578 3d69 6e64 6578 2c20 7370 6c69  ndex=index, spli
+0002f140: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+0002f150: 6572 792c 202a 2a6b 7761 7267 730a 2020  ery, **kwargs.  
+0002f160: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
+0002f170: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0002f180: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0002f190: 2061 7373 6967 6e28 7365 6c66 2c20 2a2a   assign(self, **
+0002f1a0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+0002f1b0: 2064 6174 6120 3d20 7365 6c66 2e63 6f70   data = self.cop
+0002f1c0: 7928 290a 2020 2020 2020 2020 666f 7220  y().        for 
+0002f1d0: 6b2c 2076 2069 6e20 6b77 6172 6773 2e69  k, v in kwargs.i
+0002f1e0: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+0002f1f0: 2020 2020 6966 206e 6f74 2028 0a20 2020      if not (.   
+0002f200: 2020 2020 2020 2020 2020 2020 2069 7369               isi
+0002f210: 6e73 7461 6e63 6528 762c 2053 6361 6c61  nstance(v, Scala
+0002f220: 7229 0a20 2020 2020 2020 2020 2020 2020  r).             
+0002f230: 2020 206f 7220 6973 5f73 6572 6965 735f     or is_series_
+0002f240: 6c69 6b65 2876 290a 2020 2020 2020 2020  like(v).        
+0002f250: 2020 2020 2020 2020 6f72 2063 616c 6c61          or calla
+0002f260: 626c 6528 7629 0a20 2020 2020 2020 2020  ble(v).         
+0002f270: 2020 2020 2020 206f 7220 7064 2e61 7069         or pd.api
+0002f280: 2e74 7970 6573 2e69 735f 7363 616c 6172  .types.is_scalar
+0002f290: 2876 290a 2020 2020 2020 2020 2020 2020  (v).            
+0002f2a0: 2020 2020 6f72 2069 735f 696e 6465 785f      or is_index_
+0002f2b0: 6c69 6b65 2876 290a 2020 2020 2020 2020  like(v).        
+0002f2c0: 2020 2020 2020 2020 6f72 2069 7369 6e73          or isins
+0002f2d0: 7461 6e63 6528 762c 2041 7272 6179 290a  tance(v, Array).
+0002f2e0: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
+0002f2f0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0002f300: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
+0002f310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f320: 2020 2020 6622 436f 6c75 6d6e 2061 7373      f"Column ass
+0002f330: 6967 6e6d 656e 7420 646f 6573 6e27 7420  ignment doesn't 
+0002f340: 7375 7070 6f72 7420 7479 7065 207b 7479  support type {ty
+0002f350: 7065 6e61 6d65 2874 7970 6528 7629 297d  pename(type(v))}
+0002f360: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0002f370: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0002f380: 6966 2063 616c 6c61 626c 6528 7629 3a0a  if callable(v):.
+0002f390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f3a0: 6b77 6172 6773 5b6b 5d20 3d20 7628 6461  kwargs[k] = v(da
+0002f3b0: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
+0002f3c0: 6966 2069 7369 6e73 7461 6e63 6528 762c  if isinstance(v,
+0002f3d0: 2041 7272 6179 293a 0a20 2020 2020 2020   Array):.       
+0002f3e0: 2020 2020 2020 2020 2066 726f 6d20 6461           from da
+0002f3f0: 736b 2e64 6174 6166 7261 6d65 2e69 6f20  sk.dataframe.io 
+0002f400: 696d 706f 7274 2066 726f 6d5f 6461 736b  import from_dask
+0002f410: 5f61 7272 6179 0a0a 2020 2020 2020 2020  _array..        
+0002f420: 2020 2020 2020 2020 6966 206c 656e 2876          if len(v
+0002f430: 2e73 6861 7065 2920 3e20 313a 0a20 2020  .shape) > 1:.   
+0002f440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f450: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0002f460: 7228 2241 7272 6179 2061 7373 6967 6e6d  r("Array assignm
+0002f470: 656e 7420 6f6e 6c79 2073 7570 706f 7274  ent only support
+0002f480: 7320 312d 4420 6172 7261 7973 2229 0a20  s 1-D arrays"). 
+0002f490: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002f4a0: 6620 762e 6e70 6172 7469 7469 6f6e 7320  f v.npartitions 
+0002f4b0: 213d 2064 6174 612e 6e70 6172 7469 7469  != data.npartiti
+0002f4c0: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
+0002f4d0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0002f4e0: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+0002f4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f500: 2020 2022 4e75 6d62 6572 206f 6620 7061     "Number of pa
+0002f510: 7274 6974 696f 6e73 2064 6f20 6e6f 7420  rtitions do not 
+0002f520: 6d61 7463 6820 220a 2020 2020 2020 2020  match ".        
+0002f530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f540: 6622 287b 762e 6e70 6172 7469 7469 6f6e  f"({v.npartition
+0002f550: 737d 2021 3d20 7b64 6174 612e 6e70 6172  s} != {data.npar
+0002f560: 7469 7469 6f6e 737d 2922 0a20 2020 2020  titions})".     
+0002f570: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0002f580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f590: 206b 7761 7267 735b 6b5d 203d 2066 726f   kwargs[k] = fro
+0002f5a0: 6d5f 6461 736b 5f61 7272 6179 2876 2c20  m_dask_array(v, 
+0002f5b0: 696e 6465 783d 6461 7461 2e69 6e64 6578  index=data.index
+0002f5c0: 2c20 6d65 7461 3d64 6174 612e 5f6d 6574  , meta=data._met
+0002f5d0: 6129 0a0a 2020 2020 2020 2020 2020 2020  a)..            
+0002f5e0: 7061 6972 7320 3d20 5b6b 2c20 6b77 6172  pairs = [k, kwar
+0002f5f0: 6773 5b6b 5d5d 0a0a 2020 2020 2020 2020  gs[k]]..        
+0002f600: 2020 2020 2320 4669 6775 7265 206f 7574      # Figure out
+0002f610: 2063 6f6c 756d 6e73 206f 6620 7468 6520   columns of the 
+0002f620: 6f75 7470 7574 0a20 2020 2020 2020 2020  output.         
+0002f630: 2020 2064 6632 203d 2064 6174 612e 5f6d     df2 = data._m
+0002f640: 6574 615f 6e6f 6e65 6d70 7479 2e61 7373  eta_nonempty.ass
+0002f650: 6967 6e28 0a20 2020 2020 2020 2020 2020  ign(.           
+0002f660: 2020 2020 202a 2a5f 6578 7472 6163 745f       **_extract_
+0002f670: 6d65 7461 287b 6b3a 206b 7761 7267 735b  meta({k: kwargs[
+0002f680: 6b5d 7d2c 206e 6f6e 656d 7074 793d 5472  k]}, nonempty=Tr
+0002f690: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
+0002f6a0: 290a 2020 2020 2020 2020 2020 2020 6461  ).            da
+0002f6b0: 7461 203d 2065 6c65 6d77 6973 6528 6d65  ta = elemwise(me
+0002f6c0: 7468 6f64 732e 6173 7369 676e 2c20 6461  thods.assign, da
+0002f6d0: 7461 2c20 2a70 6169 7273 2c20 6d65 7461  ta, *pairs, meta
+0002f6e0: 3d64 6632 290a 0a20 2020 2020 2020 2072  =df2)..        r
+0002f6f0: 6574 7572 6e20 6461 7461 0a0a 2020 2020  eturn data..    
+0002f700: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0002f710: 2e44 6174 6146 7261 6d65 2c20 7561 5f61  .DataFrame, ua_a
+0002f720: 7267 733d 5b22 696e 6465 7822 5d29 0a20  rgs=["index"]). 
+0002f730: 2020 2064 6566 2072 656e 616d 6528 7365     def rename(se
+0002f740: 6c66 2c20 696e 6465 783d 4e6f 6e65 2c20  lf, index=None, 
+0002f750: 636f 6c75 6d6e 733d 4e6f 6e65 293a 0a20  columns=None):. 
+0002f760: 2020 2020 2020 2069 6620 696e 6465 7820         if index 
+0002f770: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0002f780: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0002f790: 616c 7565 4572 726f 7228 2243 616e 6e6f  alueError("Canno
+0002f7a0: 7420 7265 6e61 6d65 2069 6e64 6578 2e22  t rename index."
+0002f7b0: 290a 0a20 2020 2020 2020 2023 202a 6172  )..        # *ar
+0002f7c0: 6773 2068 6572 6520 6973 2069 6e64 6578  gs here is index
+0002f7d0: 2c20 636f 6c75 6d6e 7320 6275 7420 636f  , columns but co
+0002f7e0: 6c75 6d6e 7320 6172 6720 6973 2061 6c72  lumns arg is alr
+0002f7f0: 6561 6479 2075 7365 640a 2020 2020 2020  eady used.      
+0002f800: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
+0002f810: 705f 7061 7274 6974 696f 6e73 284d 2e72  p_partitions(M.r
+0002f820: 656e 616d 652c 204e 6f6e 652c 2063 6f6c  ename, None, col
+0002f830: 756d 6e73 3d63 6f6c 756d 6e73 290a 0a20  umns=columns).. 
+0002f840: 2020 2064 6566 2071 7565 7279 2873 656c     def query(sel
+0002f850: 662c 2065 7870 722c 202a 2a6b 7761 7267  f, expr, **kwarg
+0002f860: 7329 3a0a 2020 2020 2020 2020 2222 2246  s):.        """F
+0002f870: 696c 7465 7220 6461 7461 6672 616d 6520  ilter dataframe 
+0002f880: 7769 7468 2063 6f6d 706c 6578 2065 7870  with complex exp
+0002f890: 7265 7373 696f 6e0a 0a20 2020 2020 2020  ression..       
+0002f8a0: 2042 6c6f 636b 6564 2076 6572 7369 6f6e   Blocked version
+0002f8b0: 206f 6620 7064 2e44 6174 6146 7261 6d65   of pd.DataFrame
+0002f8c0: 2e71 7565 7279 0a0a 2020 2020 2020 2020  .query..        
+0002f8d0: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+0002f8e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+0002f8f0: 2020 2020 2020 6578 7072 3a20 7374 720a        expr: str.
+0002f900: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+0002f910: 7175 6572 7920 7374 7269 6e67 2074 6f20  query string to 
+0002f920: 6576 616c 7561 7465 2e0a 2020 2020 2020  evaluate..      
+0002f930: 2020 2020 2020 596f 7520 6361 6e20 7265        You can re
+0002f940: 6665 7220 746f 2063 6f6c 756d 6e20 6e61  fer to column na
+0002f950: 6d65 7320 7468 6174 2061 7265 206e 6f74  mes that are not
+0002f960: 2076 616c 6964 2050 7974 686f 6e20 7661   valid Python va
+0002f970: 7269 6162 6c65 206e 616d 6573 0a20 2020  riable names.   
+0002f980: 2020 2020 2020 2020 2062 7920 7375 7272           by surr
+0002f990: 6f75 6e64 696e 6720 7468 656d 2069 6e20  ounding them in 
+0002f9a0: 6261 636b 7469 636b 732e 0a20 2020 2020  backticks..     
+0002f9b0: 2020 2020 2020 2044 6173 6b20 646f 6573         Dask does
+0002f9c0: 206e 6f74 2066 756c 6c79 2073 7570 706f   not fully suppo
+0002f9d0: 7274 2072 6566 6572 7269 6e67 2074 6f20  rt referring to 
+0002f9e0: 7661 7269 6162 6c65 7320 7573 696e 6720  variables using 
+0002f9f0: 7468 6520 2740 2720 6368 6172 6163 7465  the '@' characte
+0002fa00: 722c 0a20 2020 2020 2020 2020 2020 2075  r,.            u
+0002fa10: 7365 2066 2d73 7472 696e 6773 206f 7220  se f-strings or 
+0002fa20: 7468 6520 6060 6c6f 6361 6c5f 6469 6374  the ``local_dict
+0002fa30: 6060 206b 6579 776f 7264 2061 7267 756d  `` keyword argum
+0002fa40: 656e 7420 696e 7374 6561 642e 0a0a 2020  ent instead...  
+0002fa50: 2020 2020 2020 4e6f 7465 730a 2020 2020        Notes.    
+0002fa60: 2020 2020 2d2d 2d2d 2d0a 2020 2020 2020      -----.      
+0002fa70: 2020 5468 6973 2069 7320 6c69 6b65 2074    This is like t
+0002fa80: 6865 2073 6571 7565 6e74 6961 6c20 7665  he sequential ve
+0002fa90: 7273 696f 6e20 6578 6365 7074 2074 6861  rsion except tha
+0002faa0: 7420 7468 6973 2077 696c 6c20 616c 736f  t this will also
+0002fab0: 2068 6170 7065 6e0a 2020 2020 2020 2020   happen.        
+0002fac0: 696e 206d 616e 7920 7468 7265 6164 732e  in many threads.
+0002fad0: 2020 5468 6973 206d 6179 2063 6f6e 666c    This may confl
+0002fae0: 6963 7420 7769 7468 2060 606e 756d 6578  ict with ``numex
+0002faf0: 7072 6060 2077 6869 6368 2077 696c 6c20  pr`` which will 
+0002fb00: 7573 650a 2020 2020 2020 2020 6d75 6c74  use.        mult
+0002fb10: 6970 6c65 2074 6872 6561 6473 2069 7473  iple threads its
+0002fb20: 656c 662e 2020 5765 2072 6563 6f6d 6d65  elf.  We recomme
+0002fb30: 6e64 2074 6861 7420 796f 7520 7365 7420  nd that you set 
+0002fb40: 6060 6e75 6d65 7870 7260 6020 746f 2075  ``numexpr`` to u
+0002fb50: 7365 2061 0a20 2020 2020 2020 2073 696e  se a.        sin
+0002fb60: 676c 6520 7468 7265 6164 3a0a 0a20 2020  gle thread:..   
+0002fb70: 2020 2020 202e 2e20 636f 6465 2d62 6c6f       .. code-blo
+0002fb80: 636b 3a3a 2070 7974 686f 6e0a 0a20 2020  ck:: python..   
+0002fb90: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
+0002fba0: 6e75 6d65 7870 720a 2020 2020 2020 2020  numexpr.        
+0002fbb0: 2020 2020 6e75 6d65 7870 722e 7365 745f      numexpr.set_
+0002fbc0: 6e75 6d5f 7468 7265 6164 7328 3129 0a0a  num_threads(1)..
+0002fbd0: 2020 2020 2020 2020 5365 6520 616c 736f          See also
+0002fbe0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002fbf0: 2d0a 2020 2020 2020 2020 7061 6e64 6173  -.        pandas
+0002fc00: 2e44 6174 6146 7261 6d65 2e71 7565 7279  .DataFrame.query
+0002fc10: 0a20 2020 2020 2020 2070 616e 6461 732e  .        pandas.
+0002fc20: 6576 616c 0a0a 2020 2020 2020 2020 4578  eval..        Ex
+0002fc30: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
+0002fc40: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002fc50: 3e3e 3e20 696d 706f 7274 2070 616e 6461  >>> import panda
+0002fc60: 7320 6173 2070 640a 2020 2020 2020 2020  s as pd.        
+0002fc70: 3e3e 3e20 696d 706f 7274 2064 6173 6b2e  >>> import dask.
+0002fc80: 6461 7461 6672 616d 6520 6173 2064 640a  dataframe as dd.
+0002fc90: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0002fca0: 2070 642e 4461 7461 4672 616d 6528 7b27   pd.DataFrame({'
+0002fcb0: 7827 3a20 5b31 2c20 322c 2031 2c20 325d  x': [1, 2, 1, 2]
+0002fcc0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+0002fcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fce0: 2027 7927 3a20 5b31 2c20 322c 2033 2c20   'y': [1, 2, 3, 
+0002fcf0: 345d 2c0a 2020 2020 2020 2020 2e2e 2e20  4],.        ... 
+0002fd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd10: 2020 2027 7a20 7a27 3a20 5b34 2c20 332c     'z z': [4, 3,
+0002fd20: 2032 2c20 315d 7d29 0a20 2020 2020 2020   2, 1]}).       
+0002fd30: 203e 3e3e 2064 6466 203d 2064 642e 6672   >>> ddf = dd.fr
+0002fd40: 6f6d 5f70 616e 6461 7328 6466 2c20 6e70  om_pandas(df, np
+0002fd50: 6172 7469 7469 6f6e 733d 3229 0a0a 2020  artitions=2)..  
+0002fd60: 2020 2020 2020 5265 6665 7220 746f 2063        Refer to c
+0002fd70: 6f6c 756d 6e20 6e61 6d65 7320 6469 7265  olumn names dire
+0002fd80: 6374 6c79 3a0a 0a20 2020 2020 2020 203e  ctly:..        >
+0002fd90: 3e3e 2064 6466 2e71 7565 7279 2827 7920  >> ddf.query('y 
+0002fda0: 3e20 7827 292e 636f 6d70 7574 6528 290a  > x').compute().
+0002fdb0: 2020 2020 2020 2020 2020 2078 2020 7920             x  y 
+0002fdc0: 207a 207a 0a20 2020 2020 2020 2032 2020   z z.        2  
+0002fdd0: 3120 2033 2020 2020 320a 2020 2020 2020  1  3    2.      
+0002fde0: 2020 3320 2032 2020 3420 2020 2031 0a0a    3  2  4    1..
+0002fdf0: 2020 2020 2020 2020 5265 6665 7220 746f          Refer to
+0002fe00: 2063 6f6c 756d 6e20 6e61 6d65 2075 7369   column name usi
+0002fe10: 6e67 2062 6163 6b74 6963 6b73 3a0a 0a20  ng backticks:.. 
+0002fe20: 2020 2020 2020 203e 3e3e 2064 6466 2e71         >>> ddf.q
+0002fe30: 7565 7279 2827 607a 207a 6020 3e20 7827  uery('`z z` > x'
+0002fe40: 292e 636f 6d70 7574 6528 290a 2020 2020  ).compute().    
+0002fe50: 2020 2020 2020 2078 2020 7920 207a 207a         x  y  z z
+0002fe60: 0a20 2020 2020 2020 2030 2020 3120 2031  .        0  1  1
+0002fe70: 2020 2020 340a 2020 2020 2020 2020 3120      4.        1 
+0002fe80: 2032 2020 3220 2020 2033 0a20 2020 2020   2  2    3.     
+0002fe90: 2020 2032 2020 3120 2033 2020 2020 320a     2  1  3    2.
+0002fea0: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
+0002feb0: 6f20 7661 7269 6162 6c65 206e 616d 6520  o variable name 
+0002fec0: 7573 696e 6720 662d 7374 7269 6e67 733a  using f-strings:
+0002fed0: 0a0a 2020 2020 2020 2020 3e3e 3e20 7661  ..        >>> va
+0002fee0: 6c75 6520 3d20 310a 2020 2020 2020 2020  lue = 1.        
+0002fef0: 3e3e 3e20 6464 662e 7175 6572 7928 6627  >>> ddf.query(f'
+0002ff00: 7820 3d3d 207b 7661 6c75 657d 2729 2e63  x == {value}').c
+0002ff10: 6f6d 7075 7465 2829 0a20 2020 2020 2020  ompute().       
+0002ff20: 2020 2020 7820 2079 2020 7a20 7a0a 2020      x  y  z z.  
+0002ff30: 2020 2020 2020 3020 2031 2020 3120 2020        0  1  1   
+0002ff40: 2034 0a20 2020 2020 2020 2032 2020 3120   4.        2  1 
+0002ff50: 2033 2020 2020 320a 0a20 2020 2020 2020   3    2..       
+0002ff60: 2052 6566 6572 2074 6f20 7661 7269 6162   Refer to variab
+0002ff70: 6c65 206e 616d 6520 7573 696e 6720 6060  le name using ``
+0002ff80: 6c6f 6361 6c5f 6469 6374 6060 3a0a 0a20  local_dict``:.. 
+0002ff90: 2020 2020 2020 203e 3e3e 2064 6466 2e71         >>> ddf.q
+0002ffa0: 7565 7279 2827 7820 3d3d 2040 7661 6c75  uery('x == @valu
+0002ffb0: 6527 2c20 6c6f 6361 6c5f 6469 6374 3d7b  e', local_dict={
+0002ffc0: 2276 616c 7565 223a 2076 616c 7565 7d29  "value": value})
+0002ffd0: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+0002ffe0: 2020 2020 2020 7820 2079 2020 7a20 7a0a        x  y  z z.
+0002fff0: 2020 2020 2020 2020 3020 2031 2020 3120          0  1  1 
+00030000: 2020 2034 0a20 2020 2020 2020 2032 2020     4.        2  
+00030010: 3120 2033 2020 2020 320a 2020 2020 2020  1  3    2.      
+00030020: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00030030: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
+00030040: 7274 6974 696f 6e73 284d 2e71 7565 7279  rtitions(M.query
+00030050: 2c20 6578 7072 2c20 2a2a 6b77 6172 6773  , expr, **kwargs
+00030060: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00030070: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00030080: 6529 0a20 2020 2064 6566 2065 7661 6c28  e).    def eval(
+00030090: 7365 6c66 2c20 6578 7072 2c20 696e 706c  self, expr, inpl
+000300a0: 6163 653d 4e6f 6e65 2c20 2a2a 6b77 6172  ace=None, **kwar
+000300b0: 6773 293a 0a20 2020 2020 2020 2069 6620  gs):.        if 
+000300c0: 696e 706c 6163 6520 6973 204e 6f6e 653a  inplace is None:
+000300d0: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
+000300e0: 6c61 6365 203d 2046 616c 7365 0a20 2020  lace = False.   
+000300f0: 2020 2020 2069 6620 223d 2220 696e 2065       if "=" in e
+00030100: 7870 7220 616e 6420 696e 706c 6163 6520  xpr and inplace 
+00030110: 696e 2028 5472 7565 2c20 4e6f 6e65 293a  in (True, None):
+00030120: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00030130: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00030140: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
+00030150: 2020 2020 2020 2020 2249 6e70 6c61 6365          "Inplace
+00030160: 2065 7661 6c20 6e6f 7420 7375 7070 6f72   eval not suppor
+00030170: 7465 642e 2050 6c65 6173 6520 7573 6520  ted. Please use 
+00030180: 696e 706c 6163 653d 4661 6c73 6522 0a20  inplace=False". 
+00030190: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000301a0: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
+000301b0: 2e5f 6d65 7461 2e65 7661 6c28 6578 7072  ._meta.eval(expr
+000301c0: 2c20 696e 706c 6163 653d 696e 706c 6163  , inplace=inplac
+000301d0: 652c 202a 2a6b 7761 7267 7329 0a20 2020  e, **kwargs).   
+000301e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000301f0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+00030200: 4d2e 6576 616c 2c20 6578 7072 2c20 6d65  M.eval, expr, me
+00030210: 7461 3d6d 6574 612c 2069 6e70 6c61 6365  ta=meta, inplace
+00030220: 3d69 6e70 6c61 6365 2c20 2a2a 6b77 6172  =inplace, **kwar
+00030230: 6773 290a 0a20 2020 2040 6465 7269 7665  gs)..    @derive
+00030240: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00030250: 616d 6529 0a20 2020 2064 6566 2064 726f  ame).    def dro
+00030260: 706e 6128 7365 6c66 2c20 686f 773d 6e6f  pna(self, how=no
+00030270: 5f64 6566 6175 6c74 2c20 7375 6273 6574  _default, subset
+00030280: 3d4e 6f6e 652c 2074 6872 6573 683d 6e6f  =None, thresh=no
+00030290: 5f64 6566 6175 6c74 293a 0a20 2020 2020  _default):.     
+000302a0: 2020 2023 2054 6865 7365 206b 6579 776f     # These keywo
+000302b0: 7264 7320 6172 6520 696e 636f 6d70 6174  rds are incompat
+000302c0: 6962 6c65 2077 6974 6820 6561 6368 206f  ible with each o
+000302d0: 7468 6572 2e0a 2020 2020 2020 2020 2320  ther..        # 
+000302e0: 446f 6e27 7420 616c 6c6f 7720 7468 656d  Don't allow them
+000302f0: 2062 6f74 6820 746f 2062 6520 7365 742e   both to be set.
+00030300: 0a20 2020 2020 2020 2069 6620 686f 7720  .        if how 
+00030310: 6973 206e 6f74 206e 6f5f 6465 6661 756c  is not no_defaul
+00030320: 7420 616e 6420 7468 7265 7368 2069 7320  t and thresh is 
+00030330: 6e6f 7420 6e6f 5f64 6566 6175 6c74 3a0a  not no_default:.
+00030340: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00030350: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
+00030360: 2020 2020 2020 2020 2020 2020 2022 596f               "Yo
+00030370: 7520 6361 6e6e 6f74 2073 6574 2062 6f74  u cannot set bot
+00030380: 6820 7468 6520 686f 7720 616e 6420 7468  h the how and th
+00030390: 7265 7368 2061 7267 756d 656e 7473 2061  resh arguments a
+000303a0: 7420 7468 6520 7361 6d65 2074 696d 652e  t the same time.
+000303b0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+000303c0: 0a20 2020 2020 2020 2023 204f 6e6c 7920  .        # Only 
+000303d0: 7370 6563 6966 7920 6068 6f77 6020 6f72  specify `how` or
+000303e0: 2060 7468 7265 7368 6020 6b65 7977 6f72   `thresh` keywor
+000303f0: 6420 6966 2073 7065 6369 6669 6564 2062  d if specified b
+00030400: 7920 7468 6520 7573 6572 0a20 2020 2020  y the user.     
+00030410: 2020 2023 2073 6f20 7765 2075 7469 6c69     # so we utili
+00030420: 7a65 206f 7468 6572 2060 6472 6f70 6e61  ze other `dropna
+00030430: 6020 6b65 7977 6f72 6420 6465 6661 756c  ` keyword defaul
+00030440: 7473 2061 7070 726f 7072 6961 7465 6c79  ts appropriately
+00030450: 0a20 2020 2020 2020 206b 7761 7267 7320  .        kwargs 
+00030460: 3d20 7b22 7375 6273 6574 223a 2073 7562  = {"subset": sub
+00030470: 7365 747d 0a20 2020 2020 2020 2069 6620  set}.        if 
+00030480: 686f 7720 6973 206e 6f74 206e 6f5f 6465  how is not no_de
+00030490: 6661 756c 743a 0a20 2020 2020 2020 2020  fault:.         
+000304a0: 2020 206b 7761 7267 735b 2268 6f77 225d     kwargs["how"]
+000304b0: 203d 2068 6f77 0a20 2020 2020 2020 2065   = how.        e
+000304c0: 6c69 6620 7468 7265 7368 2069 7320 6e6f  lif thresh is no
+000304d0: 7420 6e6f 5f64 6566 6175 6c74 3a0a 2020  t no_default:.  
+000304e0: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
+000304f0: 5b22 7468 7265 7368 225d 203d 2074 6872  ["thresh"] = thr
+00030500: 6573 680a 0a20 2020 2020 2020 2072 6574  esh..        ret
+00030510: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
+00030520: 7469 7469 6f6e 7328 4d2e 6472 6f70 6e61  titions(M.dropna
+00030530: 2c20 2a2a 6b77 6172 6773 2c20 656e 666f  , **kwargs, enfo
+00030540: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
+00030550: 7365 290a 0a20 2020 2040 6465 7269 7665  se)..    @derive
+00030560: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00030570: 616d 6529 0a20 2020 2064 6566 2063 6c69  ame).    def cli
+00030580: 7028 7365 6c66 2c20 6c6f 7765 723d 4e6f  p(self, lower=No
+00030590: 6e65 2c20 7570 7065 723d 4e6f 6e65 2c20  ne, upper=None, 
+000305a0: 6f75 743d 4e6f 6e65 293a 0a20 2020 2020  out=None):.     
+000305b0: 2020 2069 6620 6f75 7420 6973 206e 6f74     if out is not
+000305c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000305d0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000305e0: 726f 7228 2227 6f75 7427 206d 7573 7420  ror("'out' must 
+000305f0: 6265 204e 6f6e 6522 290a 2020 2020 2020  be None").      
+00030600: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
+00030610: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
+00030620: 2020 2020 2020 2020 2020 4d2e 636c 6970            M.clip
+00030630: 2c20 6c6f 7765 723d 6c6f 7765 722c 2075  , lower=lower, u
+00030640: 7070 6572 3d75 7070 6572 2c20 656e 666f  pper=upper, enfo
+00030650: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
+00030660: 7365 0a20 2020 2020 2020 2029 0a0a 2020  se.        )..  
+00030670: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00030680: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+00030690: 2020 6465 6620 636c 6970 5f6c 6f77 6572    def clip_lower
+000306a0: 2873 656c 662c 2074 6872 6573 686f 6c64  (self, threshold
+000306b0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000306c0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+000306d0: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+000306e0: 2020 204d 2e63 6c69 705f 6c6f 7765 722c     M.clip_lower,
+000306f0: 2074 6872 6573 686f 6c64 3d74 6872 6573   threshold=thres
+00030700: 686f 6c64 2c20 656e 666f 7263 655f 6d65  hold, enforce_me
+00030710: 7461 6461 7461 3d46 616c 7365 0a20 2020  tadata=False.   
+00030720: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+00030730: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00030740: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00030750: 636c 6970 5f75 7070 6572 2873 656c 662c  clip_upper(self,
+00030760: 2074 6872 6573 686f 6c64 293a 0a20 2020   threshold):.   
+00030770: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00030780: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+00030790: 0a20 2020 2020 2020 2020 2020 204d 2e63  .            M.c
+000307a0: 6c69 705f 7570 7065 722c 2074 6872 6573  lip_upper, thres
+000307b0: 686f 6c64 3d74 6872 6573 686f 6c64 2c20  hold=threshold, 
+000307c0: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+000307d0: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
+000307e0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+000307f0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+00030800: 290a 2020 2020 6465 6620 7371 7565 657a  ).    def squeez
+00030810: 6528 7365 6c66 2c20 6178 6973 3d4e 6f6e  e(self, axis=Non
+00030820: 6529 3a0a 2020 2020 2020 2020 6966 2061  e):.        if a
+00030830: 7869 7320 696e 205b 4e6f 6e65 2c20 315d  xis in [None, 1]
+00030840: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00030850: 206c 656e 2873 656c 662e 636f 6c75 6d6e   len(self.column
+00030860: 7329 203d 3d20 313a 0a20 2020 2020 2020  s) == 1:.       
+00030870: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00030880: 7365 6c66 5b73 656c 662e 636f 6c75 6d6e  self[self.column
+00030890: 735b 305d 5d0a 2020 2020 2020 2020 2020  s[0]].          
+000308a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000308b0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000308c0: 656c 660a 0a20 2020 2020 2020 2065 6c69  elf..        eli
+000308d0: 6620 6178 6973 203d 3d20 303a 0a20 2020  f axis == 0:.   
+000308e0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+000308f0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00030900: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00030910: 2020 2020 6622 7b74 7970 6528 7365 6c66      f"{type(self
+00030920: 297d 2064 6f65 7320 6e6f 7420 7375 7070  )} does not supp
+00030930: 6f72 7420 7371 7565 657a 6520 616c 6f6e  ort squeeze alon
+00030940: 6720 6178 6973 2030 220a 2020 2020 2020  g axis 0".      
+00030950: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00030960: 2065 6c69 6620 6178 6973 206e 6f74 2069   elif axis not i
+00030970: 6e20 5b30 2c20 312c 204e 6f6e 655d 3a0a  n [0, 1, None]:.
+00030980: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00030990: 6520 5661 6c75 6545 7272 6f72 2866 224e  e ValueError(f"N
+000309a0: 6f20 6178 6973 207b 6178 6973 7d20 666f  o axis {axis} fo
+000309b0: 7220 6f62 6a65 6374 2074 7970 6520 7b74  r object type {t
+000309c0: 7970 6528 7365 6c66 297d 2229 0a0a 2020  ype(self)}")..  
+000309d0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+000309e0: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+000309f0: 2020 6465 6620 746f 5f74 696d 6573 7461    def to_timesta
+00030a00: 6d70 2873 656c 662c 2066 7265 713d 4e6f  mp(self, freq=No
+00030a10: 6e65 2c20 686f 773d 2273 7461 7274 222c  ne, how="start",
+00030a20: 2061 7869 733d 3029 3a0a 2020 2020 2020   axis=0):.      
+00030a30: 2020 6466 203d 2065 6c65 6d77 6973 6528    df = elemwise(
+00030a40: 4d2e 746f 5f74 696d 6573 7461 6d70 2c20  M.to_timestamp, 
+00030a50: 7365 6c66 2c20 6672 6571 2c20 686f 772c  self, freq, how,
+00030a60: 2061 7869 7329 0a20 2020 2020 2020 2064   axis).        d
+00030a70: 662e 6469 7669 7369 6f6e 7320 3d20 7475  f.divisions = tu
+00030a80: 706c 6528 7064 2e49 6e64 6578 2873 656c  ple(pd.Index(sel
+00030a90: 662e 6469 7669 7369 6f6e 7329 2e74 6f5f  f.divisions).to_
+00030aa0: 7469 6d65 7374 616d 7028 686f 773d 686f  timestamp(how=ho
+00030ab0: 772c 2066 7265 713d 6672 6571 2929 0a20  w, freq=freq)). 
+00030ac0: 2020 2020 2020 2072 6574 7572 6e20 6466         return df
+00030ad0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00030ae0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+00030af0: 290a 2020 2020 6465 6620 6578 706c 6f64  ).    def explod
+00030b00: 6528 7365 6c66 2c20 636f 6c75 6d6e 293a  e(self, column):
+00030b10: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
+00030b20: 7365 6c66 2e5f 6d65 7461 2e65 7870 6c6f  self._meta.explo
+00030b30: 6465 2863 6f6c 756d 6e29 0a20 2020 2020  de(column).     
+00030b40: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+00030b50: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
+00030b60: 6578 706c 6f64 652c 2063 6f6c 756d 6e2c  explode, column,
+00030b70: 206d 6574 613d 6d65 7461 2c20 656e 666f   meta=meta, enfo
+00030b80: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
+00030b90: 7365 290a 0a20 2020 2064 6566 2074 6f5f  se)..    def to_
+00030ba0: 6261 6728 7365 6c66 2c20 696e 6465 783d  bag(self, index=
+00030bb0: 4661 6c73 652c 2066 6f72 6d61 743d 2274  False, format="t
+00030bc0: 7570 6c65 2229 3a0a 2020 2020 2020 2020  uple"):.        
+00030bd0: 2222 2243 6f6e 7665 7274 2074 6f20 6120  """Convert to a 
+00030be0: 6461 736b 2042 6167 206f 6620 7475 706c  dask Bag of tupl
+00030bf0: 6573 206f 6620 6561 6368 2072 6f77 2e0a  es of each row..
+00030c00: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00030c10: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00030c20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2069  ------.        i
+00030c30: 6e64 6578 203a 2062 6f6f 6c2c 206f 7074  ndex : bool, opt
+00030c40: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00030c50: 2020 4966 2054 7275 652c 2074 6865 2069    If True, the i
+00030c60: 6e64 6578 2069 7320 696e 636c 7564 6564  ndex is included
+00030c70: 2061 7320 7468 6520 6669 7273 7420 656c   as the first el
+00030c80: 656d 656e 7420 6f66 2065 6163 6820 7475  ement of each tu
+00030c90: 706c 652e 0a20 2020 2020 2020 2020 2020  ple..           
+00030ca0: 2044 6566 6175 6c74 2069 7320 4661 6c73   Default is Fals
+00030cb0: 652e 0a20 2020 2020 2020 2066 6f72 6d61  e..        forma
+00030cc0: 7420 3a20 7b22 7475 706c 6522 2c20 2264  t : {"tuple", "d
+00030cd0: 6963 7422 2c20 2266 7261 6d65 227d 2c20  ict", "frame"}, 
+00030ce0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00030cf0: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+00030d00: 7265 7475 726e 2061 2062 6167 206f 6620  return a bag of 
+00030d10: 7475 706c 6573 2c20 6469 6374 696f 6e61  tuples, dictiona
+00030d20: 7269 6573 2c20 6f72 0a20 2020 2020 2020  ries, or.       
+00030d30: 2020 2020 2064 6174 6166 7261 6d65 2d6c       dataframe-l
+00030d40: 696b 6520 6f62 6a65 6374 732e 2044 6566  ike objects. Def
+00030d50: 6175 6c74 2069 7320 2274 7570 6c65 222e  ault is "tuple".
+00030d60: 2049 6620 2266 7261 6d65 222c 0a20 2020   If "frame",.   
+00030d70: 2020 2020 2020 2020 2074 6865 206f 7269           the ori
+00030d80: 6769 6e61 6c20 7061 7274 6974 696f 6e73  ginal partitions
+00030d90: 206f 6620 6060 6466 6060 2077 696c 6c20   of ``df`` will 
+00030da0: 6e6f 7420 6265 2074 7261 6e73 666f 726d  not be transform
+00030db0: 6564 0a20 2020 2020 2020 2020 2020 2069  ed.            i
+00030dc0: 6e20 616e 7920 7761 792e 0a20 2020 2020  n any way..     
+00030dd0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+00030de0: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+00030df0: 6d65 2e69 6f20 696d 706f 7274 2074 6f5f  me.io import to_
+00030e00: 6261 670a 0a20 2020 2020 2020 2072 6574  bag..        ret
+00030e10: 7572 6e20 746f 5f62 6167 2873 656c 662c  urn to_bag(self,
+00030e20: 2069 6e64 6578 2c20 666f 726d 6174 290a   index, format).
+00030e30: 0a20 2020 2064 6566 2074 6f5f 7061 7271  .    def to_parq
+00030e40: 7565 7428 7365 6c66 2c20 7061 7468 2c20  uet(self, path, 
+00030e50: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00030e60: 3a0a 2020 2020 2020 2020 2222 2253 6565  :.        """See
+00030e70: 2064 642e 746f 5f70 6172 7175 6574 2064   dd.to_parquet d
+00030e80: 6f63 7374 7269 6e67 2066 6f72 206d 6f72  ocstring for mor
+00030e90: 6520 696e 666f 726d 6174 696f 6e22 2222  e information"""
+00030ea0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+00030eb0: 736b 2e64 6174 6166 7261 6d65 2e69 6f20  sk.dataframe.io 
+00030ec0: 696d 706f 7274 2074 6f5f 7061 7271 7565  import to_parque
+00030ed0: 740a 0a20 2020 2020 2020 2072 6574 7572  t..        retur
+00030ee0: 6e20 746f 5f70 6172 7175 6574 2873 656c  n to_parquet(sel
+00030ef0: 662c 2070 6174 682c 202a 6172 6773 2c20  f, path, *args, 
+00030f00: 2a2a 6b77 6172 6773 290a 0a20 2020 2064  **kwargs)..    d
+00030f10: 6566 2074 6f5f 6f72 6328 7365 6c66 2c20  ef to_orc(self, 
+00030f20: 7061 7468 2c20 2a61 7267 732c 202a 2a6b  path, *args, **k
+00030f30: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00030f40: 2222 2253 6565 2064 642e 746f 5f6f 7263  """See dd.to_orc
+00030f50: 2064 6f63 7374 7269 6e67 2066 6f72 206d   docstring for m
+00030f60: 6f72 6520 696e 666f 726d 6174 696f 6e22  ore information"
+00030f70: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+00030f80: 6461 736b 2e64 6174 6166 7261 6d65 2e69  dask.dataframe.i
+00030f90: 6f20 696d 706f 7274 2074 6f5f 6f72 630a  o import to_orc.
+00030fa0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00030fb0: 746f 5f6f 7263 2873 656c 662c 2070 6174  to_orc(self, pat
+00030fc0: 682c 202a 6172 6773 2c20 2a2a 6b77 6172  h, *args, **kwar
+00030fd0: 6773 290a 0a20 2020 2040 6465 7269 7665  gs)..    @derive
+00030fe0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00030ff0: 616d 6529 0a20 2020 2064 6566 2074 6f5f  ame).    def to_
+00031000: 7374 7269 6e67 2873 656c 662c 206d 6178  string(self, max
+00031010: 5f72 6f77 733d 3529 3a0a 2020 2020 2020  _rows=5):.      
+00031020: 2020 2320 6f70 7469 6f6e 5f63 6f6e 7465    # option_conte
+00031030: 7874 2064 6f65 736e 2774 2061 6666 6563  xt doesn't affec
+00031040: 740a 2020 2020 2020 2020 7265 7475 726e  t.        return
+00031050: 2073 656c 662e 5f72 6570 725f 6461 7461   self._repr_data
+00031060: 2829 2e74 6f5f 7374 7269 6e67 286d 6178  ().to_string(max
+00031070: 5f72 6f77 733d 6d61 785f 726f 7773 2c20  _rows=max_rows, 
+00031080: 7368 6f77 5f64 696d 656e 7369 6f6e 733d  show_dimensions=
+00031090: 4661 6c73 6529 0a0a 2020 2020 6465 6620  False)..    def 
+000310a0: 5f67 6574 5f6e 756d 6572 6963 5f64 6174  _get_numeric_dat
+000310b0: 6128 7365 6c66 2c20 686f 773d 2261 6e79  a(self, how="any
+000310c0: 222c 2073 7562 7365 743d 4e6f 6e65 293a  ", subset=None):
+000310d0: 0a20 2020 2020 2020 2023 2063 616c 6375  .        # calcu
+000310e0: 6c61 7465 2063 6f6c 756d 6e73 2074 6f20  late columns to 
+000310f0: 6176 6f69 6420 756e 6e65 6365 7373 6172  avoid unnecessar
+00031100: 7920 6361 6c63 756c 6174 696f 6e0a 2020  y calculation.  
+00031110: 2020 2020 2020 6e75 6d65 7269 6373 203d        numerics =
+00031120: 2073 656c 662e 5f6d 6574 612e 5f67 6574   self._meta._get
+00031130: 5f6e 756d 6572 6963 5f64 6174 6128 290a  _numeric_data().
+00031140: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00031150: 6e75 6d65 7269 6373 2e63 6f6c 756d 6e73  numerics.columns
+00031160: 2920 3c20 6c65 6e28 7365 6c66 2e63 6f6c  ) < len(self.col
+00031170: 756d 6e73 293a 0a20 2020 2020 2020 2020  umns):.         
+00031180: 2020 206e 616d 6520 3d20 7365 6c66 2e5f     name = self._
+00031190: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
+000311a0: 2d67 6574 5f6e 756d 6572 6963 5f64 6174  -get_numeric_dat
+000311b0: 6122 0a20 2020 2020 2020 2020 2020 2072  a".            r
+000311c0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+000311d0: 6172 7469 7469 6f6e 7328 4d2e 5f67 6574  artitions(M._get
+000311e0: 5f6e 756d 6572 6963 5f64 6174 612c 206d  _numeric_data, m
+000311f0: 6574 613d 6e75 6d65 7269 6373 2c20 746f  eta=numerics, to
+00031200: 6b65 6e3d 6e61 6d65 290a 2020 2020 2020  ken=name).      
+00031210: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00031220: 2020 2020 2320 7573 6520 6d79 7365 6c66      # use myself
+00031230: 2069 6620 616c 6c20 6e75 6d65 7269 6373   if all numerics
+00031240: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00031250: 7572 6e20 7365 6c66 0a0a 2020 2020 4063  urn self..    @c
+00031260: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
+00031270: 6566 205f 7661 6c69 6461 7465 5f61 7869  ef _validate_axi
+00031280: 7328 636c 732c 2061 7869 733d 302c 206e  s(cls, axis=0, n
+00031290: 6f6e 655f 6973 5f7a 6572 6f3a 2062 6f6f  one_is_zero: boo
+000312a0: 6c20 3d20 5472 7565 2920 2d3e 204e 6f6e  l = True) -> Non
+000312b0: 6520 7c20 4c69 7465 7261 6c5b 302c 2031  e | Literal[0, 1
+000312c0: 5d3a 0a20 2020 2020 2020 2069 6620 6178  ]:.        if ax
+000312d0: 6973 206e 6f74 2069 6e20 2830 2c20 312c  is not in (0, 1,
+000312e0: 2022 696e 6465 7822 2c20 2263 6f6c 756d   "index", "colum
+000312f0: 6e73 222c 204e 6f6e 6529 3a0a 2020 2020  ns", None):.    
+00031300: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00031310: 6c75 6545 7272 6f72 2866 224e 6f20 6178  lueError(f"No ax
+00031320: 6973 206e 616d 6564 207b 6178 6973 7d22  is named {axis}"
+00031330: 290a 2020 2020 2020 2020 2320 636f 6e76  ).        # conv
+00031340: 6572 7420 746f 206e 756d 6572 6963 2061  ert to numeric a
+00031350: 7869 730a 2020 2020 2020 2020 6e75 6d65  xis.        nume
+00031360: 7269 635f 6178 6973 3a20 6469 6374 5b73  ric_axis: dict[s
+00031370: 7472 207c 204e 6f6e 652c 204c 6974 6572  tr | None, Liter
+00031380: 616c 5b30 2c20 315d 5d20 3d20 7b22 696e  al[0, 1]] = {"in
+00031390: 6465 7822 3a20 302c 2022 636f 6c75 6d6e  dex": 0, "column
+000313a0: 7322 3a20 317d 0a20 2020 2020 2020 2069  s": 1}.        i
+000313b0: 6620 6e6f 6e65 5f69 735f 7a65 726f 3a0a  f none_is_zero:.
+000313c0: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
+000313d0: 7269 635f 6178 6973 5b4e 6f6e 655d 203d  ric_axis[None] =
+000313e0: 2030 0a0a 2020 2020 2020 2020 7265 7475   0..        retu
+000313f0: 726e 206e 756d 6572 6963 5f61 7869 732e  rn numeric_axis.
+00031400: 6765 7428 6178 6973 2c20 6178 6973 290a  get(axis, axis).
+00031410: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00031420: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+00031430: 0a20 2020 2064 6566 2064 726f 7028 7365  .    def drop(se
+00031440: 6c66 2c20 6c61 6265 6c73 3d4e 6f6e 652c  lf, labels=None,
+00031450: 2061 7869 733d 302c 2063 6f6c 756d 6e73   axis=0, columns
+00031460: 3d4e 6f6e 652c 2065 7272 6f72 733d 2272  =None, errors="r
+00031470: 6169 7365 2229 3a0a 2020 2020 2020 2020  aise"):.        
+00031480: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
+00031490: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
+000314a0: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
+000314b0: 203d 3d20 3020 616e 6420 636f 6c75 6d6e   == 0 and column
+000314c0: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+000314d0: 2020 2020 2020 2020 2020 2023 2043 6f6c             # Col
+000314e0: 756d 6e73 206d 7573 7420 6265 2073 7065  umns must be spe
+000314f0: 6369 6669 6564 2069 6620 6178 6973 3d3d  cified if axis==
+00031500: 300a 2020 2020 2020 2020 2020 2020 7265  0.            re
+00031510: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
+00031520: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+00031530: 2020 2020 2020 2020 2020 6472 6f70 5f62            drop_b
+00031540: 795f 7368 616c 6c6f 775f 636f 7079 2c20  y_shallow_copy, 
+00031550: 636f 6c75 6d6e 732c 2065 7272 6f72 733d  columns, errors=
+00031560: 6572 726f 7273 2c20 656e 666f 7263 655f  errors, enforce_
+00031570: 6d65 7461 6461 7461 3d46 616c 7365 0a20  metadata=False. 
+00031580: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00031590: 2020 2020 2065 6c69 6620 6178 6973 203d       elif axis =
+000315a0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+000315b0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+000315c0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+000315d0: 2020 2020 2020 2020 2020 2020 2064 726f               dro
+000315e0: 705f 6279 5f73 6861 6c6c 6f77 5f63 6f70  p_by_shallow_cop
+000315f0: 792c 206c 6162 656c 732c 2065 7272 6f72  y, labels, error
+00031600: 733d 6572 726f 7273 2c20 656e 666f 7263  s=errors, enforc
+00031610: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+00031620: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00031630: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00031640: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00031650: 280a 2020 2020 2020 2020 2020 2020 2244  (.            "D
+00031660: 726f 7020 6375 7272 656e 746c 7920 6f6e  rop currently on
+00031670: 6c79 2077 6f72 6b73 2066 6f72 2061 7869  ly works for axi
+00031680: 733d 3120 6f72 2077 6865 6e20 636f 6c75  s=1 or when colu
+00031690: 6d6e 7320 6973 206e 6f74 204e 6f6e 6522  mns is not None"
+000316a0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000316b0: 6465 6620 6d65 7267 6528 0a20 2020 2020  def merge(.     
+000316c0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000316d0: 2072 6967 6874 2c0a 2020 2020 2020 2020   right,.        
+000316e0: 686f 773d 2269 6e6e 6572 222c 0a20 2020  how="inner",.   
+000316f0: 2020 2020 206f 6e3d 4e6f 6e65 2c0a 2020       on=None,.  
+00031700: 2020 2020 2020 6c65 6674 5f6f 6e3d 4e6f        left_on=No
+00031710: 6e65 2c0a 2020 2020 2020 2020 7269 6768  ne,.        righ
+00031720: 745f 6f6e 3d4e 6f6e 652c 0a20 2020 2020  t_on=None,.     
+00031730: 2020 206c 6566 745f 696e 6465 783d 4661     left_index=Fa
+00031740: 6c73 652c 0a20 2020 2020 2020 2072 6967  lse,.        rig
+00031750: 6874 5f69 6e64 6578 3d46 616c 7365 2c0a  ht_index=False,.
+00031760: 2020 2020 2020 2020 7375 6666 6978 6573          suffixes
+00031770: 3d28 225f 7822 2c20 225f 7922 292c 0a20  =("_x", "_y"),. 
+00031780: 2020 2020 2020 2069 6e64 6963 6174 6f72         indicator
+00031790: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+000317a0: 6e70 6172 7469 7469 6f6e 733d 4e6f 6e65  npartitions=None
+000317b0: 2c0a 2020 2020 2020 2020 7368 7566 666c  ,.        shuffl
+000317c0: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
+000317d0: 6272 6f61 6463 6173 743d 4e6f 6e65 2c0a  broadcast=None,.
+000317e0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+000317f0: 2222 4d65 7267 6520 7468 6520 4461 7461  ""Merge the Data
+00031800: 4672 616d 6520 7769 7468 2061 6e6f 7468  Frame with anoth
+00031810: 6572 2044 6174 6146 7261 6d65 0a0a 2020  er DataFrame..  
+00031820: 2020 2020 2020 5468 6973 2077 696c 6c20        This will 
+00031830: 6d65 7267 6520 7468 6520 7477 6f20 6461  merge the two da
+00031840: 7461 7365 7473 2c20 6569 7468 6572 206f  tasets, either o
+00031850: 6e20 7468 6520 696e 6469 6365 732c 2061  n the indices, a
+00031860: 2063 6572 7461 696e 2063 6f6c 756d 6e0a   certain column.
+00031870: 2020 2020 2020 2020 696e 2065 6163 6820          in each 
+00031880: 6461 7461 7365 7420 6f72 2074 6865 2069  dataset or the i
+00031890: 6e64 6578 2069 6e20 6f6e 6520 6461 7461  ndex in one data
+000318a0: 7365 7420 616e 6420 7468 6520 636f 6c75  set and the colu
+000318b0: 6d6e 2069 6e20 616e 6f74 6865 722e 0a0a  mn in another...
+000318c0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+000318d0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+000318e0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7269  -----.        ri
+000318f0: 6768 743a 2064 6173 6b2e 6461 7461 6672  ght: dask.datafr
+00031900: 616d 652e 4461 7461 4672 616d 650a 2020  ame.DataFrame.  
+00031910: 2020 2020 2020 686f 7720 3a20 7b27 6c65        how : {'le
+00031920: 6674 272c 2027 7269 6768 7427 2c20 276f  ft', 'right', 'o
+00031930: 7574 6572 272c 2027 696e 6e65 7227 7d2c  uter', 'inner'},
+00031940: 2064 6566 6175 6c74 3a20 2769 6e6e 6572   default: 'inner
+00031950: 270a 2020 2020 2020 2020 2020 2020 486f  '.            Ho
+00031960: 7720 746f 2068 616e 646c 6520 7468 6520  w to handle the 
+00031970: 6f70 6572 6174 696f 6e20 6f66 2074 6865  operation of the
+00031980: 2074 776f 206f 626a 6563 7473 3a0a 0a20   two objects:.. 
+00031990: 2020 2020 2020 2020 2020 202d 206c 6566             - lef
+000319a0: 743a 2075 7365 2063 616c 6c69 6e67 2066  t: use calling f
+000319b0: 7261 6d65 2773 2069 6e64 6578 2028 6f72  rame's index (or
+000319c0: 2063 6f6c 756d 6e20 6966 206f 6e20 6973   column if on is
+000319d0: 2073 7065 6369 6669 6564 290a 2020 2020   specified).    
+000319e0: 2020 2020 2020 2020 2d20 7269 6768 743a          - right:
+000319f0: 2075 7365 206f 7468 6572 2066 7261 6d65   use other frame
+00031a00: 2773 2069 6e64 6578 0a20 2020 2020 2020  's index.       
+00031a10: 2020 2020 202d 206f 7574 6572 3a20 666f       - outer: fo
+00031a20: 726d 2075 6e69 6f6e 206f 6620 6361 6c6c  rm union of call
+00031a30: 696e 6720 6672 616d 6527 7320 696e 6465  ing frame's inde
+00031a40: 7820 286f 7220 636f 6c75 6d6e 2069 6620  x (or column if 
+00031a50: 6f6e 2069 730a 2020 2020 2020 2020 2020  on is.          
+00031a60: 2020 2020 7370 6563 6966 6965 6429 2077      specified) w
+00031a70: 6974 6820 6f74 6865 7220 6672 616d 6527  ith other frame'
+00031a80: 7320 696e 6465 782c 2061 6e64 2073 6f72  s index, and sor
+00031a90: 7420 6974 0a20 2020 2020 2020 2020 2020  t it.           
+00031aa0: 2020 206c 6578 6963 6f67 7261 7068 6963     lexicographic
+00031ab0: 616c 6c79 0a20 2020 2020 2020 2020 2020  ally.           
+00031ac0: 202d 2069 6e6e 6572 3a20 666f 726d 2069   - inner: form i
+00031ad0: 6e74 6572 7365 6374 696f 6e20 6f66 2063  ntersection of c
+00031ae0: 616c 6c69 6e67 2066 7261 6d65 2773 2069  alling frame's i
+00031af0: 6e64 6578 2028 6f72 2063 6f6c 756d 6e20  ndex (or column 
+00031b00: 6966 0a20 2020 2020 2020 2020 2020 2020  if.             
+00031b10: 206f 6e20 6973 2073 7065 6369 6669 6564   on is specified
+00031b20: 2920 7769 7468 206f 7468 6572 2066 7261  ) with other fra
+00031b30: 6d65 2773 2069 6e64 6578 2c20 7072 6573  me's index, pres
+00031b40: 6572 7669 6e67 2074 6865 206f 7264 6572  erving the order
+00031b50: 0a20 2020 2020 2020 2020 2020 2020 206f  .              o
+00031b60: 6620 7468 6520 6361 6c6c 696e 6727 7320  f the calling's 
+00031b70: 6f6e 650a 0a20 2020 2020 2020 206f 6e20  one..        on 
+00031b80: 3a20 6c61 6265 6c20 6f72 206c 6973 740a  : label or list.
+00031b90: 2020 2020 2020 2020 2020 2020 436f 6c75              Colu
+00031ba0: 6d6e 206f 7220 696e 6465 7820 6c65 7665  mn or index leve
+00031bb0: 6c20 6e61 6d65 7320 746f 206a 6f69 6e20  l names to join 
+00031bc0: 6f6e 2e20 5468 6573 6520 6d75 7374 2062  on. These must b
+00031bd0: 6520 666f 756e 6420 696e 2062 6f74 680a  e found in both.
+00031be0: 2020 2020 2020 2020 2020 2020 4461 7461              Data
+00031bf0: 4672 616d 6573 2e20 4966 206f 6e20 6973  Frames. If on is
+00031c00: 204e 6f6e 6520 616e 6420 6e6f 7420 6d65   None and not me
+00031c10: 7267 696e 6720 6f6e 2069 6e64 6578 6573  rging on indexes
+00031c20: 2074 6865 6e20 7468 6973 0a20 2020 2020   then this.     
+00031c30: 2020 2020 2020 2064 6566 6175 6c74 7320         defaults 
+00031c40: 746f 2074 6865 2069 6e74 6572 7365 6374  to the intersect
+00031c50: 696f 6e20 6f66 2074 6865 2063 6f6c 756d  ion of the colum
+00031c60: 6e73 2069 6e20 626f 7468 2044 6174 6146  ns in both DataF
+00031c70: 7261 6d65 732e 0a20 2020 2020 2020 206c  rames..        l
+00031c80: 6566 745f 6f6e 203a 206c 6162 656c 206f  eft_on : label o
+00031c90: 7220 6c69 7374 2c20 6f72 2061 7272 6179  r list, or array
+00031ca0: 2d6c 696b 650a 2020 2020 2020 2020 2020  -like.          
+00031cb0: 2020 436f 6c75 6d6e 2074 6f20 6a6f 696e    Column to join
+00031cc0: 206f 6e20 696e 2074 6865 206c 6566 7420   on in the left 
+00031cd0: 4461 7461 4672 616d 652e 204f 7468 6572  DataFrame. Other
+00031ce0: 2074 6861 6e20 696e 2070 616e 6461 730a   than in pandas.
+00031cf0: 2020 2020 2020 2020 2020 2020 6172 7261              arra
+00031d00: 7973 2061 6e64 206c 6973 7473 2061 7265  ys and lists are
+00031d10: 206f 6e6c 7920 7375 7070 6f72 7420 6966   only support if
+00031d20: 2074 6865 6972 206c 656e 6774 6820 6973   their length is
+00031d30: 2031 2e0a 2020 2020 2020 2020 7269 6768   1..        righ
+00031d40: 745f 6f6e 203a 206c 6162 656c 206f 7220  t_on : label or 
+00031d50: 6c69 7374 2c20 6f72 2061 7272 6179 2d6c  list, or array-l
+00031d60: 696b 650a 2020 2020 2020 2020 2020 2020  ike.            
+00031d70: 436f 6c75 6d6e 2074 6f20 6a6f 696e 206f  Column to join o
+00031d80: 6e20 696e 2074 6865 2072 6967 6874 2044  n in the right D
+00031d90: 6174 6146 7261 6d65 2e20 4f74 6865 7220  ataFrame. Other 
+00031da0: 7468 616e 2069 6e20 7061 6e64 6173 0a20  than in pandas. 
+00031db0: 2020 2020 2020 2020 2020 2061 7272 6179             array
+00031dc0: 7320 616e 6420 6c69 7374 7320 6172 6520  s and lists are 
+00031dd0: 6f6e 6c79 2073 7570 706f 7274 2069 6620  only support if 
+00031de0: 7468 6569 7220 6c65 6e67 7468 2069 7320  their length is 
+00031df0: 312e 0a20 2020 2020 2020 206c 6566 745f  1..        left_
+00031e00: 696e 6465 7820 3a20 626f 6f6c 6561 6e2c  index : boolean,
+00031e10: 2064 6566 6175 6c74 2046 616c 7365 0a20   default False. 
+00031e20: 2020 2020 2020 2020 2020 2055 7365 2074             Use t
+00031e30: 6865 2069 6e64 6578 2066 726f 6d20 7468  he index from th
+00031e40: 6520 6c65 6674 2044 6174 6146 7261 6d65  e left DataFrame
+00031e50: 2061 7320 7468 6520 6a6f 696e 206b 6579   as the join key
+00031e60: 2e0a 2020 2020 2020 2020 7269 6768 745f  ..        right_
+00031e70: 696e 6465 7820 3a20 626f 6f6c 6561 6e2c  index : boolean,
+00031e80: 2064 6566 6175 6c74 2046 616c 7365 0a20   default False. 
+00031e90: 2020 2020 2020 2020 2020 2055 7365 2074             Use t
+00031ea0: 6865 2069 6e64 6578 2066 726f 6d20 7468  he index from th
+00031eb0: 6520 7269 6768 7420 4461 7461 4672 616d  e right DataFram
+00031ec0: 6520 6173 2074 6865 206a 6f69 6e20 6b65  e as the join ke
+00031ed0: 792e 0a20 2020 2020 2020 2073 7566 6669  y..        suffi
+00031ee0: 7865 7320 3a20 322d 6c65 6e67 7468 2073  xes : 2-length s
+00031ef0: 6571 7565 6e63 6520 2874 7570 6c65 2c20  equence (tuple, 
+00031f00: 6c69 7374 2c20 2e2e 2e29 0a20 2020 2020  list, ...).     
+00031f10: 2020 2020 2020 2053 7566 6669 7820 746f         Suffix to
+00031f20: 2061 7070 6c79 2074 6f20 6f76 6572 6c61   apply to overla
+00031f30: 7070 696e 6720 636f 6c75 6d6e 206e 616d  pping column nam
+00031f40: 6573 2069 6e20 7468 6520 6c65 6674 2061  es in the left a
+00031f50: 6e64 0a20 2020 2020 2020 2020 2020 2072  nd.            r
+00031f60: 6967 6874 2073 6964 652c 2072 6573 7065  ight side, respe
+00031f70: 6374 6976 656c 790a 2020 2020 2020 2020  ctively.        
+00031f80: 696e 6469 6361 746f 7220 3a20 626f 6f6c  indicator : bool
+00031f90: 6561 6e20 6f72 2073 7472 696e 672c 2064  ean or string, d
+00031fa0: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+00031fb0: 2020 2020 2020 2020 2049 6620 5472 7565           If True
+00031fc0: 2c20 6164 6473 2061 2063 6f6c 756d 6e20  , adds a column 
+00031fd0: 746f 206f 7574 7075 7420 4461 7461 4672  to output DataFr
+00031fe0: 616d 6520 6361 6c6c 6564 2022 5f6d 6572  ame called "_mer
+00031ff0: 6765 2220 7769 7468 0a20 2020 2020 2020  ge" with.       
+00032000: 2020 2020 2069 6e66 6f72 6d61 7469 6f6e       information
+00032010: 206f 6e20 7468 6520 736f 7572 6365 206f   on the source o
+00032020: 6620 6561 6368 2072 6f77 2e20 4966 2073  f each row. If s
+00032030: 7472 696e 672c 2063 6f6c 756d 6e20 7769  tring, column wi
+00032040: 7468 0a20 2020 2020 2020 2020 2020 2069  th.            i
+00032050: 6e66 6f72 6d61 7469 6f6e 206f 6e20 736f  nformation on so
+00032060: 7572 6365 206f 6620 6561 6368 2072 6f77  urce of each row
+00032070: 2077 696c 6c20 6265 2061 6464 6564 2074   will be added t
+00032080: 6f20 6f75 7470 7574 2044 6174 6146 7261  o output DataFra
+00032090: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+000320a0: 616e 6420 636f 6c75 6d6e 2077 696c 6c20  and column will 
+000320b0: 6265 206e 616d 6564 2076 616c 7565 206f  be named value o
+000320c0: 6620 7374 7269 6e67 2e20 496e 666f 726d  f string. Inform
+000320d0: 6174 696f 6e20 636f 6c75 6d6e 2069 730a  ation column is.
+000320e0: 2020 2020 2020 2020 2020 2020 4361 7465              Cate
+000320f0: 676f 7269 6361 6c2d 7479 7065 2061 6e64  gorical-type and
+00032100: 2074 616b 6573 206f 6e20 6120 7661 6c75   takes on a valu
+00032110: 6520 6f66 2022 6c65 6674 5f6f 6e6c 7922  e of "left_only"
+00032120: 2066 6f72 206f 6273 6572 7661 7469 6f6e   for observation
+00032130: 730a 2020 2020 2020 2020 2020 2020 7768  s.            wh
+00032140: 6f73 6520 6d65 7267 6520 6b65 7920 6f6e  ose merge key on
+00032150: 6c79 2061 7070 6561 7273 2069 6e20 606c  ly appears in `l
+00032160: 6566 7460 2044 6174 6146 7261 6d65 2c20  eft` DataFrame, 
+00032170: 2272 6967 6874 5f6f 6e6c 7922 2066 6f72  "right_only" for
+00032180: 0a20 2020 2020 2020 2020 2020 206f 6273  .            obs
+00032190: 6572 7661 7469 6f6e 7320 7768 6f73 6520  ervations whose 
+000321a0: 6d65 7267 6520 6b65 7920 6f6e 6c79 2061  merge key only a
+000321b0: 7070 6561 7273 2069 6e20 6072 6967 6874  ppears in `right
+000321c0: 6020 4461 7461 4672 616d 652c 0a20 2020  ` DataFrame,.   
+000321d0: 2020 2020 2020 2020 2061 6e64 2022 626f           and "bo
+000321e0: 7468 2220 6966 2074 6865 206f 6273 6572  th" if the obser
+000321f0: 7661 7469 6f6e e280 9973 206d 6572 6765  vation...s merge
+00032200: 206b 6579 2069 7320 666f 756e 6420 696e   key is found in
+00032210: 2062 6f74 682e 0a20 2020 2020 2020 206e   both..        n
+00032220: 7061 7274 6974 696f 6e73 3a20 696e 7420  partitions: int 
+00032230: 6f72 204e 6f6e 652c 206f 7074 696f 6e61  or None, optiona
+00032240: 6c0a 2020 2020 2020 2020 2020 2020 5468  l.            Th
+00032250: 6520 6964 6561 6c20 6e75 6d62 6572 206f  e ideal number o
+00032260: 6620 6f75 7470 7574 2070 6172 7469 7469  f output partiti
+00032270: 6f6e 732e 2054 6869 7320 6973 206f 6e6c  ons. This is onl
+00032280: 7920 7574 696c 6973 6564 2077 6865 6e0a  y utilised when.
+00032290: 2020 2020 2020 2020 2020 2020 7065 7266              perf
+000322a0: 6f72 6d69 6e67 2061 2068 6173 685f 6a6f  orming a hash_jo
+000322b0: 696e 2028 6d65 7267 696e 6720 6f6e 2063  in (merging on c
+000322c0: 6f6c 756d 6e73 206f 6e6c 7929 2e20 4966  olumns only). If
+000322d0: 2060 604e 6f6e 6560 6020 7468 656e 0a20   ``None`` then. 
+000322e0: 2020 2020 2020 2020 2020 2060 606e 7061             ``npa
+000322f0: 7274 6974 696f 6e73 203d 206d 6178 286c  rtitions = max(l
+00032300: 6873 2e6e 7061 7274 6974 696f 6e73 2c20  hs.npartitions, 
+00032310: 7268 732e 6e70 6172 7469 7469 6f6e 7329  rhs.npartitions)
+00032320: 6060 2e0a 2020 2020 2020 2020 2020 2020  ``..            
+00032330: 4465 6661 756c 7420 6973 2060 604e 6f6e  Default is ``Non
+00032340: 6560 602e 0a20 2020 2020 2020 2073 6875  e``..        shu
+00032350: 6666 6c65 3a20 7b27 6469 736b 272c 2027  ffle: {'disk', '
+00032360: 7461 736b 7327 7d2c 206f 7074 696f 6e61  tasks'}, optiona
+00032370: 6c0a 2020 2020 2020 2020 2020 2020 4569  l.            Ei
+00032380: 7468 6572 2060 6027 6469 736b 2760 6020  ther ``'disk'`` 
+00032390: 666f 7220 7369 6e67 6c65 2d6e 6f64 6520  for single-node 
+000323a0: 6f70 6572 6174 696f 6e20 6f72 2060 6027  operation or ``'
+000323b0: 7461 736b 7327 6060 2066 6f72 0a20 2020  tasks'`` for.   
+000323c0: 2020 2020 2020 2020 2064 6973 7472 6962           distrib
+000323d0: 7574 6564 206f 7065 7261 7469 6f6e 2e20  uted operation. 
+000323e0: 2057 696c 6c20 6265 2069 6e66 6572 7265   Will be inferre
+000323f0: 6420 6279 2079 6f75 7220 6375 7272 656e  d by your curren
+00032400: 7420 7363 6865 6475 6c65 722e 0a20 2020  t scheduler..   
+00032410: 2020 2020 2062 726f 6164 6361 7374 3a20       broadcast: 
+00032420: 626f 6f6c 6561 6e20 6f72 2066 6c6f 6174  boolean or float
+00032430: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00032440: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
+00032450: 6f20 7573 6520 6120 6272 6f61 6463 6173  o use a broadcas
+00032460: 742d 6261 7365 6420 6a6f 696e 2069 6e20  t-based join in 
+00032470: 6c69 6575 206f 6620 6120 7368 7566 666c  lieu of a shuffl
+00032480: 652d 6261 7365 640a 2020 2020 2020 2020  e-based.        
+00032490: 2020 2020 6a6f 696e 2066 6f72 2073 7570      join for sup
+000324a0: 706f 7274 6564 2063 6173 6573 2e20 2042  ported cases.  B
+000324b0: 7920 6465 6661 756c 742c 2061 2073 696d  y default, a sim
+000324c0: 706c 6520 6865 7572 6973 7469 6320 7769  ple heuristic wi
+000324d0: 6c6c 2062 650a 2020 2020 2020 2020 2020  ll be.          
+000324e0: 2020 7573 6564 2074 6f20 7365 6c65 6374    used to select
+000324f0: 2074 6865 2075 6e64 6572 6c79 696e 6720   the underlying 
+00032500: 616c 676f 7269 7468 6d2e 2049 6620 6120  algorithm. If a 
+00032510: 666c 6f61 7469 6e67 2d70 6f69 6e74 2076  floating-point v
+00032520: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
+00032530: 2069 7320 7370 6563 6966 6965 642c 2074   is specified, t
+00032540: 6861 7420 6e75 6d62 6572 2077 696c 6c20  hat number will 
+00032550: 6265 2075 7365 6420 6173 2074 6865 2060  be used as the `
+00032560: 6062 726f 6164 6361 7374 5f62 6961 7360  `broadcast_bias`
+00032570: 600a 2020 2020 2020 2020 2020 2020 7769  `.            wi
+00032580: 7468 696e 2074 6865 2073 696d 706c 6520  thin the simple 
+00032590: 6865 7572 6973 7469 6320 2861 206c 6172  heuristic (a lar
+000325a0: 6765 206e 756d 6265 7220 6d61 6b65 7320  ge number makes 
+000325b0: 4461 736b 206d 6f72 6520 6c69 6b65 6c79  Dask more likely
+000325c0: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
+000325d0: 6368 6f6f 7365 2074 6865 2060 6062 726f  choose the ``bro
+000325e0: 6163 6173 745f 6a6f 696e 6060 2063 6f64  acast_join`` cod
+000325f0: 6520 7061 7468 292e 2053 6565 2060 6062  e path). See ``b
+00032600: 726f 6164 6361 7374 5f6a 6f69 6e60 600a  roadcast_join``.
+00032610: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00032620: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
+00032630: 2e0a 0a20 2020 2020 2020 204e 6f74 6573  ...        Notes
+00032640: 0a20 2020 2020 2020 202d 2d2d 2d2d 0a0a  .        -----..
+00032650: 2020 2020 2020 2020 5468 6572 6520 6172          There ar
+00032660: 6520 7468 7265 6520 7761 7973 2074 6f20  e three ways to 
+00032670: 6a6f 696e 2064 6174 6166 7261 6d65 733a  join dataframes:
+00032680: 0a0a 2020 2020 2020 2020 312e 204a 6f69  ..        1. Joi
+00032690: 6e69 6e67 206f 6e20 696e 6469 6365 732e  ning on indices.
+000326a0: 2049 6e20 7468 6973 2063 6173 6520 7468   In this case th
+000326b0: 6520 6469 7669 7369 6f6e 7320 6172 650a  e divisions are.
+000326c0: 2020 2020 2020 2020 2020 2061 6c69 676e             align
+000326d0: 6564 2075 7369 6e67 2074 6865 2066 756e  ed using the fun
+000326e0: 6374 696f 6e20 6060 6461 736b 2e64 6174  ction ``dask.dat
+000326f0: 6166 7261 6d65 2e6d 756c 7469 2e61 6c69  aframe.multi.ali
+00032700: 676e 5f70 6172 7469 7469 6f6e 7360 602e  gn_partitions``.
+00032710: 0a20 2020 2020 2020 2020 2020 4166 7465  .           Afte
+00032720: 7277 6172 6473 2c20 6561 6368 2070 6172  rwards, each par
+00032730: 7469 7469 6f6e 2069 7320 6d65 7267 6564  tition is merged
+00032740: 2077 6974 6820 7468 6520 7061 6e64 6173   with the pandas
+00032750: 206d 6572 6765 2066 756e 6374 696f 6e2e   merge function.
+00032760: 0a0a 2020 2020 2020 2020 322e 204a 6f69  ..        2. Joi
+00032770: 6e69 6e67 206f 6e65 206f 6e20 696e 6465  ning one on inde
+00032780: 7820 616e 6420 6f6e 6520 6f6e 2063 6f6c  x and one on col
+00032790: 756d 6e2e 2049 6e20 7468 6973 2063 6173  umn. In this cas
+000327a0: 6520 7468 6520 6469 7669 7369 6f6e 7320  e the divisions 
+000327b0: 6f66 0a20 2020 2020 2020 2020 2020 6461  of.           da
+000327c0: 7461 6672 616d 6520 6d65 7267 6564 2062  taframe merged b
+000327d0: 7920 696e 6465 7820 283a 6d61 7468 3a60  y index (:math:`
+000327e0: 645f 6960 2920 6172 6520 7573 6564 2074  d_i`) are used t
+000327f0: 6f20 6469 7669 6465 2074 6865 2063 6f6c  o divide the col
+00032800: 756d 6e0a 2020 2020 2020 2020 2020 206d  umn.           m
+00032810: 6572 6765 6420 6461 7461 6672 616d 6520  erged dataframe 
+00032820: 283a 6d61 7468 3a60 645f 6360 2920 6f6e  (:math:`d_c`) on
+00032830: 6520 7573 696e 670a 2020 2020 2020 2020  e using.        
+00032840: 2020 2060 6064 6173 6b2e 6461 7461 6672     ``dask.datafr
+00032850: 616d 652e 6d75 6c74 692e 7265 6172 7261  ame.multi.rearra
+00032860: 6e67 655f 6279 5f64 6976 6973 696f 6e73  nge_by_divisions
+00032870: 6060 2e20 496e 2074 6869 7320 6361 7365  ``. In this case
+00032880: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+00032890: 6d65 7267 6564 2064 6174 6166 7261 6d65  merged dataframe
+000328a0: 2028 3a6d 6174 683a 6064 5f6d 6029 2068   (:math:`d_m`) h
+000328b0: 6173 2074 6865 2065 7861 6374 2073 616d  as the exact sam
+000328c0: 6520 6469 7669 7369 6f6e 730a 2020 2020  e divisions.    
+000328d0: 2020 2020 2020 2061 7320 283a 6d61 7468         as (:math
+000328e0: 3a60 645f 6960 292e 2054 6869 7320 6361  :`d_i`). This ca
+000328f0: 6e20 6c65 6164 2074 6f20 6973 7375 6573  n lead to issues
+00032900: 2069 6620 796f 7520 6d65 7267 6520 6d75   if you merge mu
+00032910: 6c74 6970 6c65 2072 6f77 7320 6672 6f6d  ltiple rows from
+00032920: 0a20 2020 2020 2020 2020 2020 283a 6d61  .           (:ma
+00032930: 7468 3a60 645f 6360 2920 746f 206f 6e65  th:`d_c`) to one
+00032940: 2072 6f77 2069 6e20 283a 6d61 7468 3a60   row in (:math:`
+00032950: 645f 6960 292e 0a0a 2020 2020 2020 2020  d_i`)...        
+00032960: 332e 204a 6f69 6e69 6e67 2062 6f74 6820  3. Joining both 
+00032970: 6f6e 2063 6f6c 756d 6e73 2e20 496e 2074  on columns. In t
+00032980: 6869 7320 6361 7365 2061 2068 6173 6820  his case a hash 
+00032990: 6a6f 696e 2069 7320 7065 7266 6f72 6d65  join is performe
+000329a0: 6420 7573 696e 670a 2020 2020 2020 2020  d using.        
+000329b0: 2020 2060 6064 6173 6b2e 6461 7461 6672     ``dask.datafr
+000329c0: 616d 652e 6d75 6c74 692e 6861 7368 5f6a  ame.multi.hash_j
+000329d0: 6f69 6e60 602e 0a0a 2020 2020 2020 2020  oin``...        
+000329e0: 496e 2073 6f6d 6520 6361 7365 732c 2079  In some cases, y
+000329f0: 6f75 206d 6179 2073 6565 2061 2060 604d  ou may see a ``M
+00032a00: 656d 6f72 7945 7272 6f72 6060 2069 6620  emoryError`` if 
+00032a10: 7468 6520 6060 6d65 7267 6560 6020 6f70  the ``merge`` op
+00032a20: 6572 6174 696f 6e20 7265 7175 6972 6573  eration requires
+00032a30: 0a20 2020 2020 2020 2061 6e20 696e 7465  .        an inte
+00032a40: 726e 616c 2060 6073 6875 6666 6c65 6060  rnal ``shuffle``
+00032a50: 2c20 6265 6361 7573 6520 7368 7566 666c  , because shuffl
+00032a60: 696e 6720 706c 6163 6573 2061 6c6c 2072  ing places all r
+00032a70: 6f77 7320 7468 6174 2068 6176 6520 7468  ows that have th
+00032a80: 6520 7361 6d65 0a20 2020 2020 2020 2069  e same.        i
+00032a90: 6e64 6578 2069 6e20 7468 6520 7361 6d65  ndex in the same
+00032aa0: 2070 6172 7469 7469 6f6e 2e20 546f 2061   partition. To a
+00032ab0: 766f 6964 2074 6869 7320 6572 726f 722c  void this error,
+00032ac0: 206d 616b 6520 7375 7265 2061 6c6c 2072   make sure all r
+00032ad0: 6f77 7320 7769 7468 2074 6865 0a20 2020  ows with the.   
+00032ae0: 2020 2020 2073 616d 6520 6060 6f6e 6060       same ``on``
+00032af0: 2d63 6f6c 756d 6e20 7661 6c75 6520 6361  -column value ca
+00032b00: 6e20 6669 7420 6f6e 2061 2073 696e 676c  n fit on a singl
+00032b10: 6520 7061 7274 6974 696f 6e2e 0a20 2020  e partition..   
+00032b20: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00032b30: 2020 6966 206e 6f74 2069 735f 6461 7461    if not is_data
+00032b40: 6672 616d 655f 6c69 6b65 2872 6967 6874  frame_like(right
+00032b50: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00032b60: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00032b70: 2272 6967 6874 206d 7573 7420 6265 2044  "right must be D
+00032b80: 6174 6146 7261 6d65 2229 0a0a 2020 2020  ataFrame")..    
+00032b90: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+00032ba0: 7461 6672 616d 652e 6d75 6c74 6920 696d  taframe.multi im
+00032bb0: 706f 7274 206d 6572 6765 0a0a 2020 2020  port merge..    
+00032bc0: 2020 2020 7265 7475 726e 206d 6572 6765      return merge
+00032bd0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00032be0: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00032bf0: 7269 6768 742c 0a20 2020 2020 2020 2020  right,.         
+00032c00: 2020 2068 6f77 3d68 6f77 2c0a 2020 2020     how=how,.    
+00032c10: 2020 2020 2020 2020 6f6e 3d6f 6e2c 0a20          on=on,. 
+00032c20: 2020 2020 2020 2020 2020 206c 6566 745f             left_
+00032c30: 6f6e 3d6c 6566 745f 6f6e 2c0a 2020 2020  on=left_on,.    
+00032c40: 2020 2020 2020 2020 7269 6768 745f 6f6e          right_on
+00032c50: 3d72 6967 6874 5f6f 6e2c 0a20 2020 2020  =right_on,.     
+00032c60: 2020 2020 2020 206c 6566 745f 696e 6465         left_inde
+00032c70: 783d 6c65 6674 5f69 6e64 6578 2c0a 2020  x=left_index,.  
+00032c80: 2020 2020 2020 2020 2020 7269 6768 745f            right_
+00032c90: 696e 6465 783d 7269 6768 745f 696e 6465  index=right_inde
+00032ca0: 782c 0a20 2020 2020 2020 2020 2020 2073  x,.            s
+00032cb0: 7566 6669 7865 733d 7375 6666 6978 6573  uffixes=suffixes
+00032cc0: 2c0a 2020 2020 2020 2020 2020 2020 6e70  ,.            np
+00032cd0: 6172 7469 7469 6f6e 733d 6e70 6172 7469  artitions=nparti
+00032ce0: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+00032cf0: 2020 2069 6e64 6963 6174 6f72 3d69 6e64     indicator=ind
+00032d00: 6963 6174 6f72 2c0a 2020 2020 2020 2020  icator,.        
+00032d10: 2020 2020 7368 7566 666c 653d 7368 7566      shuffle=shuf
+00032d20: 666c 652c 0a20 2020 2020 2020 2020 2020  fle,.           
+00032d30: 2062 726f 6164 6361 7374 3d62 726f 6164   broadcast=broad
+00032d40: 6361 7374 2c0a 2020 2020 2020 2020 290a  cast,.        ).
+00032d50: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00032d60: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+00032d70: 0a20 2020 2064 6566 206a 6f69 6e28 0a20  .    def join(. 
+00032d80: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00032d90: 2020 2020 206f 7468 6572 2c0a 2020 2020       other,.    
+00032da0: 2020 2020 6f6e 3d4e 6f6e 652c 0a20 2020      on=None,.   
+00032db0: 2020 2020 2068 6f77 3d22 6c65 6674 222c       how="left",
+00032dc0: 0a20 2020 2020 2020 206c 7375 6666 6978  .        lsuffix
+00032dd0: 3d22 222c 0a20 2020 2020 2020 2072 7375  ="",.        rsu
+00032de0: 6666 6978 3d22 222c 0a20 2020 2020 2020  ffix="",.       
+00032df0: 206e 7061 7274 6974 696f 6e73 3d4e 6f6e   npartitions=Non
+00032e00: 652c 0a20 2020 2020 2020 2073 6875 6666  e,.        shuff
+00032e10: 6c65 3d4e 6f6e 652c 0a20 2020 2029 3a0a  le=None,.    ):.
+00032e20: 2020 2020 2020 2020 6966 2069 735f 7365          if is_se
+00032e30: 7269 6573 5f6c 696b 6528 6f74 6865 7229  ries_like(other)
+00032e40: 2061 6e64 2068 6173 6174 7472 286f 7468   and hasattr(oth
+00032e50: 6572 2c20 226e 616d 6522 293a 0a20 2020  er, "name"):.   
+00032e60: 2020 2020 2020 2020 206f 7468 6572 203d           other =
+00032e70: 206f 7468 6572 2e74 6f5f 6672 616d 6528   other.to_frame(
+00032e80: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+00032e90: 7420 6973 5f64 6174 6166 7261 6d65 5f6c  t is_dataframe_l
+00032ea0: 696b 6528 6f74 6865 7229 3a0a 2020 2020  ike(other):.    
+00032eb0: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+00032ec0: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
+00032ed0: 206c 6973 7429 206f 7220 6e6f 7420 616c   list) or not al
+00032ee0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+00032ef0: 2020 205b 6973 5f64 6174 6166 7261 6d65     [is_dataframe
+00032f00: 5f6c 696b 6528 6f29 2066 6f72 206f 2069  _like(o) for o i
+00032f10: 6e20 6f74 6865 725d 0a20 2020 2020 2020  n other].       
+00032f20: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00032f30: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00032f40: 6c75 6545 7272 6f72 2822 6f74 6865 7220  lueError("other 
+00032f50: 6d75 7374 2062 6520 4461 7461 4672 616d  must be DataFram
+00032f60: 6520 6f72 206c 6973 7420 6f66 2044 6174  e or list of Dat
+00032f70: 6146 7261 6d65 7322 290a 2020 2020 2020  aFrames").      
+00032f80: 2020 2020 2020 6966 2068 6f77 206e 6f74        if how not
+00032f90: 2069 6e20 5b22 6f75 7465 7222 2c20 226c   in ["outer", "l
+00032fa0: 6566 7422 5d3a 0a20 2020 2020 2020 2020  eft"]:.         
+00032fb0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00032fc0: 7565 4572 726f 7228 226d 6572 6765 5f6d  ueError("merge_m
+00032fd0: 756c 7469 206f 6e6c 7920 7375 7070 6f72  ulti only suppor
+00032fe0: 7473 206c 6566 7420 6f72 206f 7574 6572  ts left or outer
+00032ff0: 206a 6f69 6e73 2229 0a0a 2020 2020 2020   joins")..      
+00033000: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+00033010: 6461 7461 6672 616d 652e 6d75 6c74 6920  dataframe.multi 
+00033020: 696d 706f 7274 205f 7265 6375 7273 6976  import _recursiv
+00033030: 655f 7061 6972 7769 7365 5f6f 7574 6572  e_pairwise_outer
+00033040: 5f6a 6f69 6e0a 0a20 2020 2020 2020 2020  _join..         
+00033050: 2020 2023 2049 6620 6974 7320 616e 206f     # If its an o
+00033060: 7574 6572 206a 6f69 6e20 7765 2063 616e  uter join we can
+00033070: 2075 7365 2074 6865 2066 756c 6c20 7265   use the full re
+00033080: 6375 7273 6976 6520 7061 6972 7769 7365  cursive pairwise
+00033090: 206a 6f69 6e2e 0a20 2020 2020 2020 2020   join..         
+000330a0: 2020 2069 6620 686f 7720 3d3d 2022 6f75     if how == "ou
+000330b0: 7465 7222 3a0a 2020 2020 2020 2020 2020  ter":.          
+000330c0: 2020 2020 2020 6675 6c6c 203d 205b 7365        full = [se
+000330d0: 6c66 5d20 2b20 6f74 6865 720a 0a20 2020  lf] + other..   
+000330e0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+000330f0: 7572 6e20 5f72 6563 7572 7369 7665 5f70  urn _recursive_p
+00033100: 6169 7277 6973 655f 6f75 7465 725f 6a6f  airwise_outer_jo
+00033110: 696e 280a 2020 2020 2020 2020 2020 2020  in(.            
+00033120: 2020 2020 2020 2020 6675 6c6c 2c0a 2020          full,.  
+00033130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033140: 2020 6f6e 3d6f 6e2c 0a20 2020 2020 2020    on=on,.       
+00033150: 2020 2020 2020 2020 2020 2020 206c 7375               lsu
+00033160: 6666 6978 3d6c 7375 6666 6978 2c0a 2020  ffix=lsuffix,.  
+00033170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033180: 2020 7273 7566 6669 783d 7273 7566 6669    rsuffix=rsuffi
+00033190: 782c 0a20 2020 2020 2020 2020 2020 2020  x,.             
+000331a0: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
+000331b0: 6e73 3d6e 7061 7274 6974 696f 6e73 2c0a  ns=npartitions,.
 000331c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000331d0: 2320 616e 6420 7468 6520 6f70 6572 6174  # and the operat
-000331e0: 6f72 2069 7320 6170 706c 6965 6420 6272  or is applied br
-000331f0: 6f61 6463 6173 7420 6163 726f 7373 2072  oadcast across r
-00033200: 6f77 732e 2054 6869 730a 2020 2020 2020  ows. This.      
-00033210: 2020 2020 2020 2020 2020 2320 6973 6e27            # isn'
-00033220: 7420 7375 7070 6f72 7465 6420 7769 7468  t supported with
-00033230: 2064 642e 5365 7269 6573 2e0a 2020 2020   dd.Series..    
-00033240: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00033250: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
-00033260: 2053 6572 6965 7329 3a0a 2020 2020 2020   Series):.      
-00033270: 2020 2020 2020 2020 2020 2020 2020 6d73                ms
-00033280: 6720 3d20 6622 556e 6162 6c65 2074 6f20  g = f"Unable to 
-00033290: 7b6e 616d 657d 2064 642e 5365 7269 6573  {name} dd.Series
-000332a0: 2077 6974 6820 6178 6973 3d31 220a 2020   with axis=1".  
-000332b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000332c0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000332d0: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
-000332e0: 2020 2020 2020 2020 656c 6966 2069 735f          elif is_
-000332f0: 7365 7269 6573 5f6c 696b 6528 6f74 6865  series_like(othe
-00033300: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-00033310: 2020 2020 2020 2020 2320 5370 6563 6961          # Specia
-00033320: 6c20 6361 7365 2066 6f72 2070 642e 5365  l case for pd.Se
-00033330: 7269 6573 2074 6f20 6176 6f69 6420 756e  ries to avoid un
-00033340: 7761 6e74 6564 2070 6172 7469 7469 6f6e  wanted partition
-00033350: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
-00033360: 2020 2020 2020 2020 2320 6f66 206f 7468          # of oth
-00033370: 6572 2e20 5765 2070 6173 7320 6974 2069  er. We pass it i
-00033380: 6e20 6173 2061 206b 7761 7267 2074 6f20  n as a kwarg to 
-00033390: 7072 6576 656e 7420 7468 6973 2e0a 2020  prevent this..  
-000333a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000333b0: 2020 6d65 7461 203d 205f 656d 756c 6174    meta = _emulat
-000333c0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-000333d0: 2020 2020 2020 2020 2020 206f 702c 2073             op, s
-000333e0: 656c 662c 206f 7468 6572 3d6f 7468 6572  elf, other=other
-000333f0: 2c20 6178 6973 3d61 7869 732c 2066 696c  , axis=axis, fil
-00033400: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
-00033410: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-00033420: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00033430: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00033440: 7572 6e20 6d61 705f 7061 7274 6974 696f  urn map_partitio
-00033450: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-00033460: 2020 2020 2020 2020 2020 2020 6f70 2c0a              op,.
-00033470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033480: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00033490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000334a0: 2020 2020 2020 6f74 6865 723d 6f74 6865        other=othe
-000334b0: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-000334c0: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
-000334d0: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-000334e0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-000334f0: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
-00033500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033510: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
-00033520: 5f76 616c 7565 2c0a 2020 2020 2020 2020  _value,.        
-00033530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033540: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-00033550: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00033560: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00033570: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
-00033580: 3d20 5f65 6d75 6c61 7465 286f 702c 2073  = _emulate(op, s
-00033590: 656c 662c 206f 7468 6572 2c20 6178 6973  elf, other, axis
-000335a0: 3d61 7869 732c 2066 696c 6c5f 7661 6c75  =axis, fill_valu
-000335b0: 653d 6669 6c6c 5f76 616c 7565 290a 2020  e=fill_value).  
-000335c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000335d0: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
-000335e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000335f0: 206f 702c 0a20 2020 2020 2020 2020 2020   op,.           
-00033600: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00033610: 2020 2020 2020 2020 2020 206f 7468 6572             other
-00033620: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00033630: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
-00033640: 2020 2020 2020 2020 2020 2020 2061 7869               axi
-00033650: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
-00033660: 2020 2020 2020 2020 6669 6c6c 5f76 616c          fill_val
-00033670: 7565 3d66 696c 6c5f 7661 6c75 652c 0a20  ue=fill_value,. 
-00033680: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00033690: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
-000336a0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-000336b0: 2020 2029 0a0a 2020 2020 2020 2020 6d65     )..        me
-000336c0: 7468 2e5f 5f6e 616d 655f 5f20 3d20 6e61  th.__name__ = na
-000336d0: 6d65 0a20 2020 2020 2020 2073 6574 6174  me.        setat
-000336e0: 7472 2863 6c73 2c20 6e61 6d65 2c20 6465  tr(cls, name, de
-000336f0: 7269 7665 645f 6672 6f6d 286f 7269 6769  rived_from(origi
-00033700: 6e61 6c29 286d 6574 6829 290a 0a20 2020  nal)(meth))..   
-00033710: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
-00033720: 2020 6465 6620 5f62 696e 645f 636f 6d70    def _bind_comp
-00033730: 6172 6973 6f6e 5f6d 6574 686f 6428 636c  arison_method(cl
-00033740: 732c 206e 616d 652c 2063 6f6d 7061 7269  s, name, compari
-00033750: 736f 6e2c 206f 7269 6769 6e61 6c3d 7064  son, original=pd
-00033760: 2e44 6174 6146 7261 6d65 293a 0a20 2020  .DataFrame):.   
-00033770: 2020 2020 2022 2222 6269 6e64 2063 6f6d       """bind com
-00033780: 7061 7269 736f 6e20 6d65 7468 6f64 206c  parison method l
-00033790: 696b 6520 4461 7461 4672 616d 652e 6571  ike DataFrame.eq
-000337a0: 2074 6f20 7468 6973 2063 6c61 7373 2222   to this class""
-000337b0: 220a 0a20 2020 2020 2020 2064 6566 206d  "..        def m
-000337c0: 6574 6828 7365 6c66 2c20 6f74 6865 722c  eth(self, other,
-000337d0: 2061 7869 733d 2263 6f6c 756d 6e73 222c   axis="columns",
-000337e0: 206c 6576 656c 3d4e 6f6e 6529 3a0a 2020   level=None):.  
-000337f0: 2020 2020 2020 2020 2020 6966 206c 6576            if lev
-00033800: 656c 2069 7320 6e6f 7420 4e6f 6e65 3a0a  el is not None:.
-00033810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033820: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00033830: 6e74 6564 4572 726f 7228 226c 6576 656c  ntedError("level
-00033840: 206d 7573 7420 6265 204e 6f6e 6522 290a   must be None").
-00033850: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00033860: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
-00033870: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
-00033880: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00033890: 656c 656d 7769 7365 2863 6f6d 7061 7269  elemwise(compari
-000338a0: 736f 6e2c 2073 656c 662c 206f 7468 6572  son, self, other
-000338b0: 2c20 6178 6973 3d61 7869 7329 0a0a 2020  , axis=axis)..  
-000338c0: 2020 2020 2020 6d65 7468 2e5f 5f6e 616d        meth.__nam
-000338d0: 655f 5f20 3d20 6e61 6d65 0a20 2020 2020  e__ = name.     
-000338e0: 2020 2073 6574 6174 7472 2863 6c73 2c20     setattr(cls, 
-000338f0: 6e61 6d65 2c20 6465 7269 7665 645f 6672  name, derived_fr
-00033900: 6f6d 286f 7269 6769 6e61 6c29 286d 6574  om(original)(met
-00033910: 6829 290a 0a20 2020 2040 696e 7365 7274  h))..    @insert
-00033920: 5f6d 6574 615f 7061 7261 6d5f 6465 7363  _meta_param_desc
-00033930: 7269 7074 696f 6e28 7061 643d 3132 290a  ription(pad=12).
-00033940: 2020 2020 6465 6620 6170 706c 7928 0a20      def apply(. 
-00033950: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00033960: 2020 2020 2066 756e 632c 0a20 2020 2020       func,.     
-00033970: 2020 2061 7869 733d 302c 0a20 2020 2020     axis=0,.     
-00033980: 2020 2062 726f 6164 6361 7374 3d4e 6f6e     broadcast=Non
-00033990: 652c 0a20 2020 2020 2020 2072 6177 3d46  e,.        raw=F
-000339a0: 616c 7365 2c0a 2020 2020 2020 2020 7265  alse,.        re
-000339b0: 6475 6365 3d4e 6f6e 652c 0a20 2020 2020  duce=None,.     
-000339c0: 2020 2061 7267 733d 2829 2c0a 2020 2020     args=(),.    
-000339d0: 2020 2020 6d65 7461 3d6e 6f5f 6465 6661      meta=no_defa
-000339e0: 756c 742c 0a20 2020 2020 2020 2072 6573  ult,.        res
-000339f0: 756c 745f 7479 7065 3d4e 6f6e 652c 0a20  ult_type=None,. 
-00033a00: 2020 2020 2020 202a 2a6b 7764 732c 0a20         **kwds,. 
-00033a10: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-00033a20: 2250 6172 616c 6c65 6c20 7665 7273 696f  "Parallel versio
-00033a30: 6e20 6f66 2070 616e 6461 732e 4461 7461  n of pandas.Data
-00033a40: 4672 616d 652e 6170 706c 790a 0a20 2020  Frame.apply..   
-00033a50: 2020 2020 2054 6869 7320 6d69 6d69 6373       This mimics
-00033a60: 2074 6865 2070 616e 6461 7320 7665 7273   the pandas vers
-00033a70: 696f 6e20 6578 6365 7074 2066 6f72 2074  ion except for t
-00033a80: 6865 2066 6f6c 6c6f 7769 6e67 3a0a 0a20  he following:.. 
-00033a90: 2020 2020 2020 2031 2e20 204f 6e6c 7920         1.  Only 
-00033aa0: 6060 6178 6973 3d31 6060 2069 7320 7375  ``axis=1`` is su
-00033ab0: 7070 6f72 7465 6420 2861 6e64 206d 7573  pported (and mus
-00033ac0: 7420 6265 2073 7065 6369 6669 6564 2065  t be specified e
-00033ad0: 7870 6c69 6369 746c 7929 2e0a 2020 2020  xplicitly)..    
-00033ae0: 2020 2020 322e 2020 5468 6520 7573 6572      2.  The user
-00033af0: 2073 686f 756c 6420 7072 6f76 6964 6520   should provide 
-00033b00: 6f75 7470 7574 206d 6574 6164 6174 6120  output metadata 
-00033b10: 7669 6120 7468 6520 606d 6574 6160 206b  via the `meta` k
-00033b20: 6579 776f 7264 2e0a 0a20 2020 2020 2020  eyword...       
-00033b30: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00033b40: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00033b50: 2020 2020 2020 2066 756e 6320 3a20 6675         func : fu
-00033b60: 6e63 7469 6f6e 0a20 2020 2020 2020 2020  nction.         
-00033b70: 2020 2046 756e 6374 696f 6e20 746f 2061     Function to a
-00033b80: 7070 6c79 2074 6f20 6561 6368 2063 6f6c  pply to each col
-00033b90: 756d 6e2f 726f 770a 2020 2020 2020 2020  umn/row.        
-00033ba0: 6178 6973 203a 207b 3020 6f72 2027 696e  axis : {0 or 'in
-00033bb0: 6465 7827 2c20 3120 6f72 2027 636f 6c75  dex', 1 or 'colu
-00033bc0: 6d6e 7327 7d2c 2064 6566 6175 6c74 2030  mns'}, default 0
-00033bd0: 0a20 2020 2020 2020 2020 2020 202d 2030  .            - 0
-00033be0: 206f 7220 2769 6e64 6578 273a 2061 7070   or 'index': app
-00033bf0: 6c79 2066 756e 6374 696f 6e20 746f 2065  ly function to e
-00033c00: 6163 6820 636f 6c75 6d6e 2028 4e4f 5420  ach column (NOT 
-00033c10: 5355 5050 4f52 5445 4429 0a20 2020 2020  SUPPORTED).     
-00033c20: 2020 2020 2020 202d 2031 206f 7220 2763         - 1 or 'c
-00033c30: 6f6c 756d 6e73 273a 2061 7070 6c79 2066  olumns': apply f
-00033c40: 756e 6374 696f 6e20 746f 2065 6163 6820  unction to each 
-00033c50: 726f 770a 2020 2020 2020 2020 244d 4554  row.        $MET
-00033c60: 410a 2020 2020 2020 2020 6172 6773 203a  A.        args :
-00033c70: 2074 7570 6c65 0a20 2020 2020 2020 2020   tuple.         
-00033c80: 2020 2050 6f73 6974 696f 6e61 6c20 6172     Positional ar
-00033c90: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
-00033ca0: 746f 2066 756e 6374 696f 6e20 696e 2061  to function in a
-00033cb0: 6464 6974 696f 6e20 746f 2074 6865 2061  ddition to the a
-00033cc0: 7272 6179 2f73 6572 6965 730a 0a20 2020  rray/series..   
-00033cd0: 2020 2020 2041 6464 6974 696f 6e61 6c20       Additional 
-00033ce0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-00033cf0: 7320 7769 6c6c 2062 6520 7061 7373 6564  s will be passed
-00033d00: 2061 7320 6b65 7977 6f72 6473 2074 6f20   as keywords to 
-00033d10: 7468 6520 6675 6e63 7469 6f6e 0a0a 2020  the function..  
-00033d20: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-00033d30: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-00033d40: 2020 2020 2020 6170 706c 6965 6420 3a20        applied : 
-00033d50: 5365 7269 6573 206f 7220 4461 7461 4672  Series or DataFr
-00033d60: 616d 650a 0a20 2020 2020 2020 2045 7861  ame..        Exa
-00033d70: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
-00033d80: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
-00033d90: 3e3e 2069 6d70 6f72 7420 7061 6e64 6173  >> import pandas
-00033da0: 2061 7320 7064 0a20 2020 2020 2020 203e   as pd.        >
-00033db0: 3e3e 2069 6d70 6f72 7420 6461 736b 2e64  >> import dask.d
-00033dc0: 6174 6166 7261 6d65 2061 7320 6464 0a20  ataframe as dd. 
-00033dd0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-00033de0: 7064 2e44 6174 6146 7261 6d65 287b 2778  pd.DataFrame({'x
-00033df0: 273a 205b 312c 2032 2c20 332c 2034 2c20  ': [1, 2, 3, 4, 
-00033e00: 355d 2c0a 2020 2020 2020 2020 2e2e 2e20  5],.        ... 
-00033e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033e20: 2020 2027 7927 3a20 5b31 2e2c 2032 2e2c     'y': [1., 2.,
-00033e30: 2033 2e2c 2034 2e2c 2035 2e5d 7d29 0a20   3., 4., 5.]}). 
-00033e40: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
-00033e50: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
-00033e60: 6466 2c20 6e70 6172 7469 7469 6f6e 733d  df, npartitions=
-00033e70: 3229 0a0a 2020 2020 2020 2020 4170 706c  2)..        Appl
-00033e80: 7920 6120 6675 6e63 7469 6f6e 2074 6f20  y a function to 
-00033e90: 726f 772d 7769 7365 2070 6173 7369 6e67  row-wise passing
-00033ea0: 2069 6e20 6578 7472 6120 6172 6775 6d65   in extra argume
-00033eb0: 6e74 7320 696e 2060 6061 7267 7360 6020  nts in ``args`` 
-00033ec0: 616e 640a 2020 2020 2020 2020 6060 6b77  and.        ``kw
-00033ed0: 6172 6773 6060 3a0a 0a20 2020 2020 2020  args``:..       
-00033ee0: 203e 3e3e 2064 6566 206d 7961 6464 2872   >>> def myadd(r
-00033ef0: 6f77 2c20 612c 2062 3d31 293a 0a20 2020  ow, a, b=1):.   
-00033f00: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
-00033f10: 7572 6e20 726f 772e 7375 6d28 2920 2b20  urn row.sum() + 
-00033f20: 6120 2b20 620a 2020 2020 2020 2020 3e3e  a + b.        >>
-00033f30: 3e20 7265 7320 3d20 6464 662e 6170 706c  > res = ddf.appl
-00033f40: 7928 6d79 6164 642c 2061 7869 733d 312c  y(myadd, axis=1,
-00033f50: 2061 7267 733d 2832 2c29 2c20 623d 312e   args=(2,), b=1.
-00033f60: 3529 2020 2320 646f 6374 6573 743a 202b  5)  # doctest: +
-00033f70: 534b 4950 0a0a 2020 2020 2020 2020 4279  SKIP..        By
-00033f80: 2064 6566 6175 6c74 2c20 6461 736b 2074   default, dask t
-00033f90: 7269 6573 2074 6f20 696e 6665 7220 7468  ries to infer th
-00033fa0: 6520 6f75 7470 7574 206d 6574 6164 6174  e output metadat
-00033fb0: 6120 6279 2072 756e 6e69 6e67 2079 6f75  a by running you
-00033fc0: 720a 2020 2020 2020 2020 7072 6f76 6964  r.        provid
-00033fd0: 6564 2066 756e 6374 696f 6e20 6f6e 2073  ed function on s
-00033fe0: 6f6d 6520 6661 6b65 2064 6174 612e 2054  ome fake data. T
-00033ff0: 6869 7320 776f 726b 7320 7765 6c6c 2069  his works well i
-00034000: 6e20 6d61 6e79 2063 6173 6573 2c20 6275  n many cases, bu
-00034010: 740a 2020 2020 2020 2020 6361 6e20 736f  t.        can so
-00034020: 6d65 7469 6d65 7320 6265 2065 7870 656e  metimes be expen
-00034030: 7369 7665 2c20 6f72 2065 7665 6e20 6661  sive, or even fa
-00034040: 696c 2e20 546f 2061 766f 6964 2074 6869  il. To avoid thi
-00034050: 732c 2079 6f75 2063 616e 0a20 2020 2020  s, you can.     
-00034060: 2020 206d 616e 7561 6c6c 7920 7370 6563     manually spec
-00034070: 6966 7920 7468 6520 6f75 7470 7574 206d  ify the output m
-00034080: 6574 6164 6174 6120 7769 7468 2074 6865  etadata with the
-00034090: 2060 606d 6574 6160 6020 6b65 7977 6f72   ``meta`` keywor
-000340a0: 642e 2054 6869 730a 2020 2020 2020 2020  d. This.        
-000340b0: 6361 6e20 6265 2073 7065 6369 6669 6564  can be specified
-000340c0: 2069 6e20 6d61 6e79 2066 6f72 6d73 2c20   in many forms, 
-000340d0: 666f 7220 6d6f 7265 2069 6e66 6f72 6d61  for more informa
-000340e0: 7469 6f6e 2073 6565 0a20 2020 2020 2020  tion see.       
-000340f0: 2060 6064 6173 6b2e 6461 7461 6672 616d   ``dask.datafram
-00034100: 652e 7574 696c 732e 6d61 6b65 5f6d 6574  e.utils.make_met
-00034110: 6160 602e 0a0a 2020 2020 2020 2020 4865  a``...        He
-00034120: 7265 2077 6520 7370 6563 6966 7920 7468  re we specify th
-00034130: 6520 6f75 7470 7574 2069 7320 6120 5365  e output is a Se
-00034140: 7269 6573 2077 6974 6820 6e61 6d65 2060  ries with name `
-00034150: 6027 7827 6060 2c20 616e 6420 6474 7970  `'x'``, and dtyp
-00034160: 650a 2020 2020 2020 2020 6060 666c 6f61  e.        ``floa
-00034170: 7436 3460 603a 0a0a 2020 2020 2020 2020  t64``:..        
-00034180: 3e3e 3e20 7265 7320 3d20 6464 662e 6170  >>> res = ddf.ap
-00034190: 706c 7928 6d79 6164 642c 2061 7869 733d  ply(myadd, axis=
-000341a0: 312c 2061 7267 733d 2832 2c29 2c20 623d  1, args=(2,), b=
-000341b0: 312e 352c 206d 6574 613d 2827 7827 2c20  1.5, meta=('x', 
-000341c0: 2766 3827 2929 0a0a 2020 2020 2020 2020  'f8'))..        
-000341d0: 496e 2074 6865 2063 6173 6520 7768 6572  In the case wher
-000341e0: 6520 7468 6520 6d65 7461 6461 7461 2064  e the metadata d
-000341f0: 6f65 736e 2774 2063 6861 6e67 652c 2079  oesn't change, y
-00034200: 6f75 2063 616e 2061 6c73 6f20 7061 7373  ou can also pass
-00034210: 2069 6e0a 2020 2020 2020 2020 7468 6520   in.        the 
-00034220: 6f62 6a65 6374 2069 7473 656c 6620 6469  object itself di
-00034230: 7265 6374 6c79 3a0a 0a20 2020 2020 2020  rectly:..       
-00034240: 203e 3e3e 2072 6573 203d 2064 6466 2e61   >>> res = ddf.a
-00034250: 7070 6c79 286c 616d 6264 6120 726f 773a  pply(lambda row:
-00034260: 2072 6f77 202b 2031 2c20 6178 6973 3d31   row + 1, axis=1
-00034270: 2c20 6d65 7461 3d64 6466 290a 0a20 2020  , meta=ddf)..   
-00034280: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
-00034290: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-000342a0: 2020 2020 2020 2064 6173 6b2e 4461 7461         dask.Data
-000342b0: 4672 616d 652e 6d61 705f 7061 7274 6974  Frame.map_partit
-000342c0: 696f 6e73 0a20 2020 2020 2020 2022 2222  ions.        """
-000342d0: 0a0a 2020 2020 2020 2020 6966 2062 726f  ..        if bro
-000342e0: 6164 6361 7374 2069 7320 6e6f 7420 4e6f  adcast is not No
-000342f0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00034300: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
-00034310: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00034320: 5468 6520 6062 726f 6164 6361 7374 6020  The `broadcast` 
-00034330: 6172 6775 6d65 6e74 2069 7320 6e6f 206c  argument is no l
-00034340: 6f6e 6765 7220 7573 6564 2f73 7570 706f  onger used/suppo
-00034350: 7274 6564 2e20 220a 2020 2020 2020 2020  rted. ".        
-00034360: 2020 2020 2020 2020 2249 7420 7769 6c6c          "It will
-00034370: 2062 6520 6472 6f70 7065 6420 696e 2061   be dropped in a
-00034380: 2066 7574 7572 6520 7265 6c65 6173 652e   future release.
-00034390: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000343a0: 2020 2063 6174 6567 6f72 793d 4675 7475     category=Futu
-000343b0: 7265 5761 726e 696e 672c 0a20 2020 2020  reWarning,.     
-000343c0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-000343d0: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
-000343e0: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
-000343f0: 7329 0a20 2020 2020 2020 2070 616e 6461  s).        panda
-00034400: 735f 6b77 6172 6773 203d 207b 2261 7869  s_kwargs = {"axi
-00034410: 7322 3a20 6178 6973 2c20 2272 6177 223a  s": axis, "raw":
-00034420: 2072 6177 2c20 2272 6573 756c 745f 7479   raw, "result_ty
-00034430: 7065 223a 2072 6573 756c 745f 7479 7065  pe": result_type
-00034440: 7d0a 0a20 2020 2020 2020 206b 7764 732e  }..        kwds.
-00034450: 7570 6461 7465 2870 616e 6461 735f 6b77  update(pandas_kw
-00034460: 6172 6773 290a 0a20 2020 2020 2020 2069  args)..        i
-00034470: 6620 6178 6973 203d 3d20 303a 0a20 2020  f axis == 0:.   
-00034480: 2020 2020 2020 2020 206d 7367 203d 2028           msg = (
-00034490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000344a0: 2022 6464 2e44 6174 6146 7261 6d65 2e61   "dd.DataFrame.a
-000344b0: 7070 6c79 206f 6e6c 7920 7375 7070 6f72  pply only suppor
-000344c0: 7473 2061 7869 733d 315c 6e22 0a20 2020  ts axis=1\n".   
-000344d0: 2020 2020 2020 2020 2020 2020 2022 2020               "  
-000344e0: 5472 793a 2064 662e 6170 706c 7928 6675  Try: df.apply(fu
-000344f0: 6e63 2c20 6178 6973 3d31 2922 0a20 2020  nc, axis=1)".   
-00034500: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00034510: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-00034520: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-00034530: 286d 7367 290a 0a20 2020 2020 2020 2069  (msg)..        i
-00034540: 6620 6d65 7461 2069 7320 6e6f 5f64 6566  f meta is no_def
-00034550: 6175 6c74 3a0a 2020 2020 2020 2020 2020  ault:.          
-00034560: 2020 6d65 7461 203d 205f 656d 756c 6174    meta = _emulat
-00034570: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-00034580: 2020 204d 2e61 7070 6c79 2c20 7365 6c66     M.apply, self
-00034590: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792c  ._meta_nonempty,
-000345a0: 2066 756e 632c 2061 7267 733d 6172 6773   func, args=args
-000345b0: 2c20 7564 663d 5472 7565 2c20 2a2a 6b77  , udf=True, **kw
-000345c0: 6473 0a20 2020 2020 2020 2020 2020 2029  ds.            )
-000345d0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-000345e0: 6e69 6e67 732e 7761 726e 286d 6574 615f  nings.warn(meta_
-000345f0: 7761 726e 696e 6728 6d65 7461 2929 0a20  warning(meta)). 
-00034600: 2020 2020 2020 206b 7764 732e 7570 6461         kwds.upda
-00034610: 7465 287b 2270 6172 656e 745f 6d65 7461  te({"parent_meta
-00034620: 223a 2073 656c 662e 5f6d 6574 617d 290a  ": self._meta}).
-00034630: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-00034640: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
-00034650: 6170 706c 792c 2073 656c 662c 2066 756e  apply, self, fun
-00034660: 632c 2061 7267 733d 6172 6773 2c20 6d65  c, args=args, me
-00034670: 7461 3d6d 6574 612c 202a 2a6b 7764 7329  ta=meta, **kwds)
-00034680: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00034690: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-000346a0: 290a 2020 2020 6465 6620 6170 706c 796d  ).    def applym
-000346b0: 6170 2873 656c 662c 2066 756e 632c 206d  ap(self, func, m
-000346c0: 6574 613d 6e6f 5f64 6566 6175 6c74 293a  eta=no_default):
-000346d0: 0a20 2020 2020 2020 2023 204c 6574 2070  .        # Let p
-000346e0: 616e 6461 7320 7261 6973 6520 6465 7072  andas raise depr
-000346f0: 6563 6174 696f 6e20 7761 726e 696e 6773  ecation warnings
-00034700: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
-00034710: 6574 612e 6170 706c 796d 6170 2866 756e  eta.applymap(fun
-00034720: 6329 0a20 2020 2020 2020 2072 6574 7572  c).        retur
-00034730: 6e20 656c 656d 7769 7365 286d 6574 686f  n elemwise(metho
-00034740: 6473 2e61 7070 6c79 6d61 702c 2073 656c  ds.applymap, sel
-00034750: 662c 2066 756e 632c 206d 6574 613d 6d65  f, func, meta=me
-00034760: 7461 290a 0a20 2020 2064 6566 206d 6170  ta)..    def map
-00034770: 2873 656c 662c 2066 756e 632c 206d 6574  (self, func, met
-00034780: 613d 6e6f 5f64 6566 6175 6c74 293a 0a20  a=no_default):. 
-00034790: 2020 2020 2020 2069 6620 6e6f 7420 5041         if not PA
-000347a0: 4e44 4153 5f47 545f 3231 303a 0a20 2020  NDAS_GT_210:.   
-000347b0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-000347c0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-000347d0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-000347e0: 2020 2020 6622 4461 7461 4672 616d 652e      f"DataFrame.
-000347f0: 6d61 7020 7265 7175 6972 6573 2070 616e  map requires pan
-00034800: 6461 733e 3d32 2e31 2e30 2c20 6275 7420  das>=2.1.0, but 
-00034810: 7061 6e64 6173 3d7b 5041 4e44 4153 5f56  pandas={PANDAS_V
-00034820: 4552 5349 4f4e 7d20 6973 2022 0a20 2020  ERSION} is ".   
-00034830: 2020 2020 2020 2020 2020 2020 2022 696e               "in
-00034840: 7374 616c 6c65 642e 220a 2020 2020 2020  stalled.".      
-00034850: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00034860: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
-00034870: 4d2e 6d61 702c 2073 656c 662c 2066 756e  M.map, self, fun
-00034880: 632c 206d 6574 613d 6d65 7461 290a 0a20  c, meta=meta).. 
-00034890: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-000348a0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-000348b0: 2020 2064 6566 2072 6f75 6e64 2873 656c     def round(sel
-000348c0: 662c 2064 6563 696d 616c 733d 3029 3a0a  f, decimals=0):.
-000348d0: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-000348e0: 6c65 6d77 6973 6528 4d2e 726f 756e 642c  lemwise(M.round,
-000348f0: 2073 656c 662c 2064 6563 696d 616c 7329   self, decimals)
-00034900: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00034910: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-00034920: 290a 2020 2020 6465 6620 6e75 6e69 7175  ).    def nuniqu
-00034930: 6528 7365 6c66 2c20 7370 6c69 745f 6576  e(self, split_ev
-00034940: 6572 793d 4661 6c73 652c 2064 726f 706e  ery=False, dropn
-00034950: 613d 5472 7565 2c20 6178 6973 3d30 293a  a=True, axis=0):
-00034960: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
-00034970: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
-00034980: 2020 2023 2073 706c 6974 5f65 7665 7279     # split_every
-00034990: 206e 6f74 2075 7365 6420 666f 7220 6178   not used for ax
-000349a0: 6973 3d31 0a20 2020 2020 2020 2020 2020  is=1.           
-000349b0: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
-000349c0: 7461 5f6e 6f6e 656d 7074 792e 6e75 6e69  ta_nonempty.nuni
-000349d0: 7175 6528 6178 6973 3d61 7869 7329 0a20  que(axis=axis). 
-000349e0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000349f0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
-00034a00: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
-00034a10: 2020 2020 2020 204d 2e6e 756e 6971 7565         M.nunique
-00034a20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00034a30: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
-00034a40: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
-00034a50: 656e 3d22 7365 7269 6573 2d6e 756e 6971  en="series-nuniq
-00034a60: 7565 222c 0a20 2020 2020 2020 2020 2020  ue",.           
-00034a70: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
-00034a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034a90: 6472 6f70 6e61 3d64 726f 706e 612c 0a20  dropna=dropna,. 
-00034aa0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00034ab0: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
-00034ac0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00034ad0: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
-00034ae0: 653a 0a20 2020 2020 2020 2020 2020 206e  e:.            n
-00034af0: 756e 6971 7565 5f6c 6973 7420 3d20 5b0a  unique_list = [.
-00034b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034b10: 7365 6c66 5b63 6f6c 5d2e 6e75 6e69 7175  self[col].nuniqu
-00034b20: 6528 7370 6c69 745f 6576 6572 793d 7370  e(split_every=sp
-00034b30: 6c69 745f 6576 6572 792c 2064 726f 706e  lit_every, dropn
-00034b40: 613d 6472 6f70 6e61 290a 2020 2020 2020  a=dropna).      
-00034b50: 2020 2020 2020 2020 2020 666f 7220 636f            for co
-00034b60: 6c20 696e 2073 656c 662e 636f 6c75 6d6e  l in self.column
-00034b70: 730a 2020 2020 2020 2020 2020 2020 5d0a  s.            ].
-00034b80: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00034b90: 203d 2022 7365 7269 6573 2d22 202b 2074   = "series-" + t
-00034ba0: 6f6b 656e 697a 6528 2a6e 756e 6971 7565  okenize(*nunique
-00034bb0: 5f6c 6973 7429 0a20 2020 2020 2020 2020  _list).         
-00034bc0: 2020 2064 736b 203d 207b 0a20 2020 2020     dsk = {.     
-00034bd0: 2020 2020 2020 2020 2020 2028 6e61 6d65             (name
-00034be0: 2c20 3029 3a20 280a 2020 2020 2020 2020  , 0): (.        
-00034bf0: 2020 2020 2020 2020 2020 2020 6170 706c              appl
-00034c00: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-00034c10: 2020 2020 2020 2070 642e 5365 7269 6573         pd.Series
-00034c20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00034c30: 2020 2020 2020 5b5b 2873 2e5f 6e61 6d65        [[(s._name
-00034c40: 2c20 3029 2066 6f72 2073 2069 6e20 6e75  , 0) for s in nu
-00034c50: 6e69 7175 655f 6c69 7374 5d5d 2c0a 2020  nique_list]],.  
-00034c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034c70: 2020 7b22 696e 6465 7822 3a20 7365 6c66    {"index": self
-00034c80: 2e63 6f6c 756d 6e73 7d2c 0a20 2020 2020  .columns},.     
-00034c90: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00034ca0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00034cb0: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
-00034cc0: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-00034cd0: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 280a  om_collections(.
-00034ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034cf0: 6e61 6d65 2c20 6473 6b2c 2064 6570 656e  name, dsk, depen
-00034d00: 6465 6e63 6965 733d 6e75 6e69 7175 655f  dencies=nunique_
-00034d10: 6c69 7374 0a20 2020 2020 2020 2020 2020  list.           
-00034d20: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-00034d30: 6574 7572 6e20 5365 7269 6573 2867 7261  eturn Series(gra
-00034d40: 7068 2c20 6e61 6d65 2c20 7365 6c66 2e5f  ph, name, self._
-00034d50: 6d65 7461 2e6e 756e 6971 7565 2829 2c20  meta.nunique(), 
-00034d60: 284e 6f6e 652c 204e 6f6e 6529 290a 0a20  (None, None)).. 
-00034d70: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00034d80: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-00034d90: 2020 2064 6566 206d 6f64 6528 7365 6c66     def mode(self
-00034da0: 2c20 6472 6f70 6e61 3d54 7275 652c 2073  , dropna=True, s
-00034db0: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-00034dc0: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d46  , numeric_only=F
-00034dd0: 616c 7365 293a 0a20 2020 2020 2020 206d  alse):.        m
-00034de0: 6f64 655f 7365 7269 6573 5f6c 6973 7420  ode_series_list 
-00034df0: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
-00034e00: 2063 6f6c 5f69 6e64 6578 2069 6e20 7261   col_index in ra
-00034e10: 6e67 6528 6c65 6e28 7365 6c66 2e63 6f6c  nge(len(self.col
-00034e20: 756d 6e73 2929 3a0a 2020 2020 2020 2020  umns)):.        
-00034e30: 2020 2020 636f 6c5f 7365 7269 6573 203d      col_series =
-00034e40: 2073 656c 662e 696c 6f63 5b3a 2c20 636f   self.iloc[:, co
-00034e50: 6c5f 696e 6465 785d 0a20 2020 2020 2020  l_index].       
-00034e60: 2020 2020 2069 6620 6e75 6d65 7269 635f       if numeric_
-00034e70: 6f6e 6c79 2061 6e64 206e 6f74 2070 642e  only and not pd.
-00034e80: 6170 692e 7479 7065 732e 6973 5f6e 756d  api.types.is_num
-00034e90: 6572 6963 5f64 7479 7065 2863 6f6c 5f73  eric_dtype(col_s
-00034ea0: 6572 6965 732e 6474 7970 6529 3a0a 2020  eries.dtype):.  
-00034eb0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00034ec0: 6e74 696e 7565 0a20 2020 2020 2020 2020  ntinue.         
-00034ed0: 2020 206d 6f64 655f 7365 7269 6573 203d     mode_series =
-00034ee0: 2053 6572 6965 732e 6d6f 6465 280a 2020   Series.mode(.  
-00034ef0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00034f00: 6c5f 7365 7269 6573 2c20 6472 6f70 6e61  l_series, dropna
-00034f10: 3d64 726f 706e 612c 2073 706c 6974 5f65  =dropna, split_e
-00034f20: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-00034f30: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00034f40: 2020 2020 2020 2020 2020 206d 6f64 655f             mode_
-00034f50: 7365 7269 6573 5f6c 6973 742e 6170 7065  series_list.appe
-00034f60: 6e64 286d 6f64 655f 7365 7269 6573 290a  nd(mode_series).
-00034f70: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
-00034f80: 2263 6f6e 6361 742d 2220 2b20 746f 6b65  "concat-" + toke
-00034f90: 6e69 7a65 282a 6d6f 6465 5f73 6572 6965  nize(*mode_serie
-00034fa0: 735f 6c69 7374 290a 0a20 2020 2020 2020  s_list)..       
-00034fb0: 2064 736b 203d 207b 0a20 2020 2020 2020   dsk = {.       
-00034fc0: 2020 2020 2028 6e61 6d65 2c20 3029 3a20       (name, 0): 
-00034fd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00034fe0: 2020 6170 706c 792c 0a20 2020 2020 2020    apply,.       
-00034ff0: 2020 2020 2020 2020 206d 6574 686f 6473           methods
-00035000: 2e63 6f6e 6361 742c 0a20 2020 2020 2020  .concat,.       
-00035010: 2020 2020 2020 2020 205b 5b28 6466 2e5f           [[(df._
-00035020: 6e61 6d65 2c20 3029 2066 6f72 2064 6620  name, 0) for df 
-00035030: 696e 206d 6f64 655f 7365 7269 6573 5f6c  in mode_series_l
-00035040: 6973 745d 5d2c 0a20 2020 2020 2020 2020  ist]],.         
-00035050: 2020 2020 2020 207b 2261 7869 7322 3a20         {"axis": 
-00035060: 317d 2c0a 2020 2020 2020 2020 2020 2020  1},.            
-00035070: 290a 2020 2020 2020 2020 7d0a 0a20 2020  ).        }..   
-00035080: 2020 2020 206d 6574 6120 3d20 6d65 7468       meta = meth
-00035090: 6f64 732e 636f 6e63 6174 285b 6466 2e5f  ods.concat([df._
-000350a0: 6d65 7461 2066 6f72 2064 6620 696e 206d  meta for df in m
-000350b0: 6f64 655f 7365 7269 6573 5f6c 6973 745d  ode_series_list]
-000350c0: 2c20 6178 6973 3d31 290a 2020 2020 2020  , axis=1).      
-000350d0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-000350e0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-000350f0: 6c6c 6563 7469 6f6e 7328 0a20 2020 2020  llections(.     
-00035100: 2020 2020 2020 206e 616d 652c 2064 736b         name, dsk
-00035110: 2c20 6465 7065 6e64 656e 6369 6573 3d6d  , dependencies=m
-00035120: 6f64 655f 7365 7269 6573 5f6c 6973 740a  ode_series_list.
-00035130: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00035140: 2020 6464 6620 3d20 6e65 775f 6464 5f6f    ddf = new_dd_o
-00035150: 626a 6563 7428 6772 6170 682c 206e 616d  bject(graph, nam
-00035160: 652c 206d 6574 612c 2064 6976 6973 696f  e, meta, divisio
-00035170: 6e73 3d28 4e6f 6e65 2c20 4e6f 6e65 2929  ns=(None, None))
-00035180: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00035190: 2064 6466 0a0a 2020 2020 4064 6572 6976   ddf..    @deriv
-000351a0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-000351b0: 7261 6d65 290a 2020 2020 6465 6620 636f  rame).    def co
-000351c0: 7628 7365 6c66 2c20 6d69 6e5f 7065 7269  v(self, min_peri
-000351d0: 6f64 733d 4e6f 6e65 2c20 6e75 6d65 7269  ods=None, numeri
-000351e0: 635f 6f6e 6c79 3d6e 6f5f 6465 6661 756c  c_only=no_defaul
-000351f0: 742c 2073 706c 6974 5f65 7665 7279 3d46  t, split_every=F
-00035200: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
-00035210: 6574 7572 6e20 5f63 6f76 5f63 6f72 7228  eturn _cov_corr(
-00035220: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00035230: 662c 206d 696e 5f70 6572 696f 6473 2c20  f, min_periods, 
-00035240: 6e75 6d65 7269 635f 6f6e 6c79 3d6e 756d  numeric_only=num
-00035250: 6572 6963 5f6f 6e6c 792c 2073 706c 6974  eric_only, split
-00035260: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-00035270: 7279 0a20 2020 2020 2020 2029 0a0a 2020  ry.        )..  
-00035280: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00035290: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-000352a0: 2020 6465 6620 636f 7272 280a 2020 2020    def corr(.    
-000352b0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000352c0: 2020 6d65 7468 6f64 3d22 7065 6172 736f    method="pearso
-000352d0: 6e22 2c0a 2020 2020 2020 2020 6d69 6e5f  n",.        min_
-000352e0: 7065 7269 6f64 733d 4e6f 6e65 2c0a 2020  periods=None,.  
-000352f0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
-00035300: 6c79 3d6e 6f5f 6465 6661 756c 742c 0a20  ly=no_default,. 
-00035310: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-00035320: 7279 3d46 616c 7365 2c0a 2020 2020 293a  ry=False,.    ):
-00035330: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
-00035340: 6f64 2021 3d20 2270 6561 7273 6f6e 223a  od != "pearson":
-00035350: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00035360: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-00035370: 6445 7272 6f72 2822 4f6e 6c79 2050 6561  dError("Only Pea
-00035380: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
-00035390: 2068 6173 2062 6565 6e20 696d 706c 656d   has been implem
-000353a0: 656e 7465 6422 290a 0a20 2020 2020 2020  ented")..       
-000353b0: 2072 6574 7572 6e20 5f63 6f76 5f63 6f72   return _cov_cor
-000353c0: 7228 0a20 2020 2020 2020 2020 2020 2073  r(.            s
-000353d0: 656c 662c 206d 696e 5f70 6572 696f 6473  elf, min_periods
-000353e0: 2c20 5472 7565 2c20 6e75 6d65 7269 635f  , True, numeric_
-000353f0: 6f6e 6c79 3d6e 756d 6572 6963 5f6f 6e6c  only=numeric_onl
-00035400: 792c 2073 706c 6974 5f65 7665 7279 3d73  y, split_every=s
-00035410: 706c 6974 5f65 7665 7279 0a20 2020 2020  plit_every.     
-00035420: 2020 2029 0a0a 2020 2020 6465 6620 696e     )..    def in
-00035430: 666f 2873 656c 662c 2062 7566 3d4e 6f6e  fo(self, buf=Non
-00035440: 652c 2076 6572 626f 7365 3d46 616c 7365  e, verbose=False
-00035450: 2c20 6d65 6d6f 7279 5f75 7361 6765 3d46  , memory_usage=F
-00035460: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
-00035470: 2222 0a20 2020 2020 2020 2043 6f6e 6369  "".        Conci
-00035480: 7365 2073 756d 6d61 7279 206f 6620 6120  se summary of a 
-00035490: 4461 736b 2044 6174 6146 7261 6d65 2e0a  Dask DataFrame..
-000354a0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-000354b0: 2020 2020 2069 6620 6275 6620 6973 204e       if buf is N
-000354c0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-000354d0: 2069 6d70 6f72 7420 7379 730a 0a20 2020   import sys..   
-000354e0: 2020 2020 2020 2020 2062 7566 203d 2073           buf = s
-000354f0: 7973 2e73 7464 6f75 740a 0a20 2020 2020  ys.stdout..     
-00035500: 2020 206c 696e 6573 203d 205b 7374 7228     lines = [str(
-00035510: 7479 7065 2873 656c 6629 295d 0a0a 2020  type(self))]..  
-00035520: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-00035530: 662e 636f 6c75 6d6e 7329 203d 3d20 303a  f.columns) == 0:
-00035540: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
-00035550: 6573 2e61 7070 656e 6428 6622 7b74 7970  es.append(f"{typ
-00035560: 6528 7365 6c66 2e69 6e64 6578 2e5f 6d65  e(self.index._me
-00035570: 7461 292e 5f5f 6e61 6d65 5f5f 7d3a 2030  ta).__name__}: 0
-00035580: 2065 6e74 7269 6573 2229 0a20 2020 2020   entries").     
-00035590: 2020 2020 2020 206c 696e 6573 2e61 7070         lines.app
-000355a0: 656e 6428 6622 456d 7074 7920 7b74 7970  end(f"Empty {typ
-000355b0: 6528 7365 6c66 292e 5f5f 6e61 6d65 5f5f  e(self).__name__
-000355c0: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
-000355d0: 6966 2050 414e 4441 535f 4754 5f31 3530  if PANDAS_GT_150
-000355e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000355f0: 2020 2320 7061 6e64 6173 2064 6174 6166    # pandas dataf
-00035600: 7261 6d65 2073 7461 7274 6564 2061 6464  rame started add
-00035610: 696e 6720 6120 6e65 776c 696e 6520 7768  ing a newline wh
-00035620: 656e 2069 6e66 6f20 6973 2063 616c 6c65  en info is calle
-00035630: 642e 0a20 2020 2020 2020 2020 2020 2020  d..             
-00035640: 2020 206c 696e 6573 2e61 7070 656e 6428     lines.append(
-00035650: 2222 290a 2020 2020 2020 2020 2020 2020  "").            
-00035660: 7075 745f 6c69 6e65 7328 6275 662c 206c  put_lines(buf, l
-00035670: 696e 6573 290a 2020 2020 2020 2020 2020  ines).          
-00035680: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
-00035690: 2020 2320 4772 6f75 7020 616e 6420 6578    # Group and ex
-000356a0: 6563 7574 6520 7468 6520 7265 7175 6972  ecute the requir
-000356b0: 6564 2063 6f6d 7075 7461 7469 6f6e 730a  ed computations.
-000356c0: 2020 2020 2020 2020 636f 6d70 7574 6174          computat
-000356d0: 696f 6e73 203d 207b 7d0a 2020 2020 2020  ions = {}.      
-000356e0: 2020 6966 2076 6572 626f 7365 3a0a 2020    if verbose:.  
-000356f0: 2020 2020 2020 2020 2020 6d65 6d6f 7279            memory
-00035700: 5f75 7361 6765 203d 2054 7275 650a 2020  _usage = True.  
-00035710: 2020 2020 2020 2020 2020 636f 6d70 7574            comput
-00035720: 6174 696f 6e73 2e75 7064 6174 6528 7b22  ations.update({"
-00035730: 696e 6465 7822 3a20 7365 6c66 2e69 6e64  index": self.ind
-00035740: 6578 2c20 2263 6f75 6e74 223a 2073 656c  ex, "count": sel
-00035750: 662e 636f 756e 7428 297d 290a 2020 2020  f.count()}).    
-00035760: 2020 2020 6966 206d 656d 6f72 795f 7573      if memory_us
-00035770: 6167 653a 0a20 2020 2020 2020 2020 2020  age:.           
-00035780: 2063 6f6d 7075 7461 7469 6f6e 732e 7570   computations.up
-00035790: 6461 7465 280a 2020 2020 2020 2020 2020  date(.          
-000357a0: 2020 2020 2020 7b22 6d65 6d6f 7279 5f75        {"memory_u
-000357b0: 7361 6765 223a 2073 656c 662e 6d61 705f  sage": self.map_
-000357c0: 7061 7274 6974 696f 6e73 284d 2e6d 656d  partitions(M.mem
-000357d0: 6f72 795f 7573 6167 652c 2069 6e64 6578  ory_usage, index
-000357e0: 3d54 7275 6529 7d0a 2020 2020 2020 2020  =True)}.        
-000357f0: 2020 2020 290a 2020 2020 2020 2020 636f      ).        co
-00035800: 6d70 7574 6174 696f 6e73 203d 2064 6963  mputations = dic
-00035810: 7428 0a20 2020 2020 2020 2020 2020 207a  t(.            z
-00035820: 6970 2863 6f6d 7075 7461 7469 6f6e 732e  ip(computations.
-00035830: 6b65 7973 2829 2c20 6461 2e63 6f6d 7075  keys(), da.compu
-00035840: 7465 282a 636f 6d70 7574 6174 696f 6e73  te(*computations
-00035850: 2e76 616c 7565 7328 2929 290a 2020 2020  .values())).    
-00035860: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-00035870: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
-00035880: 2020 2020 2020 2069 6d70 6f72 7420 7465         import te
-00035890: 7874 7772 6170 0a0a 2020 2020 2020 2020  xtwrap..        
-000358a0: 2020 2020 696e 6465 7820 3d20 636f 6d70      index = comp
-000358b0: 7574 6174 696f 6e73 5b22 696e 6465 7822  utations["index"
-000358c0: 5d0a 2020 2020 2020 2020 2020 2020 636f  ].            co
-000358d0: 756e 7473 203d 2063 6f6d 7075 7461 7469  unts = computati
-000358e0: 6f6e 735b 2263 6f75 6e74 225d 0a20 2020  ons["count"].   
-000358f0: 2020 2020 2020 2020 206c 696e 6573 2e61           lines.a
-00035900: 7070 656e 6428 696e 6465 785f 7375 6d6d  ppend(index_summ
-00035910: 6172 7928 696e 6465 7829 290a 2020 2020  ary(index)).    
-00035920: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
-00035930: 7065 6e64 2866 2244 6174 6120 636f 6c75  pend(f"Data colu
-00035940: 6d6e 7320 2874 6f74 616c 207b 6c65 6e28  mns (total {len(
-00035950: 7365 6c66 2e63 6f6c 756d 6e73 297d 2063  self.columns)} c
-00035960: 6f6c 756d 6e73 293a 2229 0a0a 2020 2020  olumns):")..    
-00035970: 2020 2020 2020 2020 6672 6f6d 2070 616e          from pan
-00035980: 6461 732e 696f 2e66 6f72 6d61 7473 2e70  das.io.formats.p
-00035990: 7269 6e74 696e 6720 696d 706f 7274 2070  rinting import p
-000359a0: 7072 696e 745f 7468 696e 670a 0a20 2020  print_thing..   
-000359b0: 2020 2020 2020 2020 2073 7061 6365 203d           space =
-000359c0: 206d 6178 286c 656e 2870 7072 696e 745f   max(len(pprint_
-000359d0: 7468 696e 6728 6b29 2920 666f 7220 6b20  thing(k)) for k 
-000359e0: 696e 2073 656c 662e 636f 6c75 6d6e 7329  in self.columns)
-000359f0: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
-00035a00: 2063 6f6c 756d 6e5f 7769 6474 6820 3d20   column_width = 
-00035a10: 6d61 7828 7370 6163 652c 2037 290a 0a20  max(space, 7).. 
-00035a20: 2020 2020 2020 2020 2020 2068 6561 6465             heade
-00035a30: 7220 3d20 280a 2020 2020 2020 2020 2020  r = (.          
-00035a40: 2020 2020 2020 7465 7874 7772 6170 2e64        textwrap.d
-00035a50: 6564 656e 7428 0a20 2020 2020 2020 2020  edent(.         
-00035a60: 2020 2020 2020 2020 2020 2022 2222 5c0a             """\.
-00035a70: 2020 2020 2020 2020 2020 2020 2023 2020               #  
-00035a80: 207b 7b63 6f6c 756d 6e3a 3c7b 636f 6c75   {{column:<{colu
-00035a90: 6d6e 5f77 6964 7468 7d7d 7d20 4e6f 6e2d  mn_width}}} Non-
-00035aa0: 4e75 6c6c 2043 6f75 6e74 2020 4474 7970  Null Count  Dtyp
-00035ab0: 650a 2020 2020 2020 2020 2020 2020 2d2d  e.            --
-00035ac0: 2d20 207b 7b75 6e64 6572 6c3a 3c7b 636f  -  {{underl:<{co
-00035ad0: 6c75 6d6e 5f77 6964 7468 7d7d 7d20 2d2d  lumn_width}}} --
-00035ae0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2020 2d2d  ------------  --
-00035af0: 2d2d 2d22 2222 0a20 2020 2020 2020 2020  ---""".         
-00035b00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00035b10: 2020 2020 2020 2020 202e 666f 726d 6174           .format
-00035b20: 2863 6f6c 756d 6e5f 7769 6474 683d 636f  (column_width=co
-00035b30: 6c75 6d6e 5f77 6964 7468 290a 2020 2020  lumn_width).    
-00035b40: 2020 2020 2020 2020 2020 2020 2e66 6f72              .for
-00035b50: 6d61 7428 636f 6c75 6d6e 3d22 436f 6c75  mat(column="Colu
-00035b60: 6d6e 222c 2075 6e64 6572 6c3d 222d 2d2d  mn", underl="---
-00035b70: 2d2d 2d22 290a 2020 2020 2020 2020 2020  ---").          
-00035b80: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00035b90: 636f 6c75 6d6e 5f74 656d 706c 6174 6520  column_template 
-00035ba0: 3d20 7465 7874 7772 6170 2e64 6564 656e  = textwrap.deden
-00035bb0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00035bc0: 2020 2022 2222 5c0a 2020 2020 2020 2020     """\.        
-00035bd0: 2020 2020 7b7b 693a 5e33 7d7d 2020 7b7b      {{i:^3}}  {{
-00035be0: 6e61 6d65 3a3c 7b63 6f6c 756d 6e5f 7769  name:<{column_wi
-00035bf0: 6474 687d 7d7d 207b 7b63 6f75 6e74 7d7d  dth}}} {{count}}
-00035c00: 206e 6f6e 2d6e 756c 6c20 2020 2020 207b   non-null      {
-00035c10: 7b64 7479 7065 7d7d 2222 222e 666f 726d  {dtype}}""".form
-00035c20: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-00035c30: 2020 2020 2020 2020 636f 6c75 6d6e 5f77          column_w
-00035c40: 6964 7468 3d63 6f6c 756d 6e5f 7769 6474  idth=column_widt
-00035c50: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
-00035c60: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00035c70: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-00035c80: 6c75 6d6e 5f69 6e66 6f20 3d20 5b0a 2020  lumn_info = [.  
-00035c90: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00035ca0: 6c75 6d6e 5f74 656d 706c 6174 652e 666f  lumn_template.fo
-00035cb0: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
-00035cc0: 2020 2020 2020 2020 2020 693d 7070 7269            i=ppri
-00035cd0: 6e74 5f74 6869 6e67 2869 292c 0a20 2020  nt_thing(i),.   
-00035ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035cf0: 206e 616d 653d 7070 7269 6e74 5f74 6869   name=pprint_thi
-00035d00: 6e67 286e 616d 6529 2c0a 2020 2020 2020  ng(name),.      
-00035d10: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00035d20: 756e 743d 7070 7269 6e74 5f74 6869 6e67  unt=pprint_thing
-00035d30: 2863 6f75 6e74 292c 0a20 2020 2020 2020  (count),.       
-00035d40: 2020 2020 2020 2020 2020 2020 2064 7479               dty
-00035d50: 7065 3d70 7072 696e 745f 7468 696e 6728  pe=pprint_thing(
-00035d60: 6474 7970 6529 2c0a 2020 2020 2020 2020  dtype),.        
-00035d70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00035d80: 2020 2020 2020 2020 2020 666f 7220 692c            for i,
-00035d90: 2028 6e61 6d65 2c20 636f 756e 742c 2064   (name, count, d
-00035da0: 7479 7065 2920 696e 2065 6e75 6d65 7261  type) in enumera
-00035db0: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
-00035dc0: 2020 2020 2020 2020 7a69 7028 7365 6c66          zip(self
-00035dd0: 2e63 6f6c 756d 6e73 2c20 636f 756e 7473  .columns, counts
-00035de0: 2c20 7365 6c66 2e64 7479 7065 7329 0a20  , self.dtypes). 
-00035df0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00035e00: 0a20 2020 2020 2020 2020 2020 205d 0a20  .            ]. 
-00035e10: 2020 2020 2020 2020 2020 206c 696e 6573             lines
-00035e20: 2e65 7874 656e 6428 6865 6164 6572 2e73  .extend(header.s
-00035e30: 706c 6974 2822 5c6e 2229 290a 2020 2020  plit("\n")).    
-00035e40: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00035e50: 2020 2020 2020 636f 6c75 6d6e 5f69 6e66        column_inf
-00035e60: 6f20 3d20 5b69 6e64 6578 5f73 756d 6d61  o = [index_summa
-00035e70: 7279 2873 656c 662e 636f 6c75 6d6e 732c  ry(self.columns,
-00035e80: 206e 616d 653d 2243 6f6c 756d 6e73 2229   name="Columns")
-00035e90: 5d0a 0a20 2020 2020 2020 206c 696e 6573  ]..        lines
-00035ea0: 2e65 7874 656e 6428 636f 6c75 6d6e 5f69  .extend(column_i
-00035eb0: 6e66 6f29 0a20 2020 2020 2020 2064 7479  nfo).        dty
-00035ec0: 7065 5f63 6f75 6e74 7320 3d20 5b0a 2020  pe_counts = [.  
-00035ed0: 2020 2020 2020 2020 2020 2225 7328 2564            "%s(%d
-00035ee0: 2922 2025 206b 2066 6f72 206b 2069 6e20  )" % k for k in 
-00035ef0: 736f 7274 6564 2873 656c 662e 6474 7970  sorted(self.dtyp
-00035f00: 6573 2e76 616c 7565 5f63 6f75 6e74 7328  es.value_counts(
-00035f10: 292e 6974 656d 7328 292c 206b 6579 3d73  ).items(), key=s
-00035f20: 7472 290a 2020 2020 2020 2020 5d0a 2020  tr).        ].  
-00035f30: 2020 2020 2020 6c69 6e65 732e 6170 7065        lines.appe
-00035f40: 6e64 2822 6474 7970 6573 3a20 7b7d 222e  nd("dtypes: {}".
-00035f50: 666f 726d 6174 2822 2c20 222e 6a6f 696e  format(", ".join
-00035f60: 2864 7479 7065 5f63 6f75 6e74 7329 2929  (dtype_counts)))
-00035f70: 0a0a 2020 2020 2020 2020 6966 206d 656d  ..        if mem
-00035f80: 6f72 795f 7573 6167 653a 0a20 2020 2020  ory_usage:.     
-00035f90: 2020 2020 2020 206d 656d 6f72 795f 696e         memory_in
-00035fa0: 7420 3d20 636f 6d70 7574 6174 696f 6e73  t = computations
-00035fb0: 5b22 6d65 6d6f 7279 5f75 7361 6765 225d  ["memory_usage"]
-00035fc0: 2e73 756d 2829 0a20 2020 2020 2020 2020  .sum().         
-00035fd0: 2020 206c 696e 6573 2e61 7070 656e 6428     lines.append(
-00035fe0: 6622 6d65 6d6f 7279 2075 7361 6765 3a20  f"memory usage: 
-00035ff0: 7b6d 656d 6f72 795f 7265 7072 286d 656d  {memory_repr(mem
-00036000: 6f72 795f 696e 7429 7d5c 6e22 290a 0a20  ory_int)}\n").. 
-00036010: 2020 2020 2020 2070 7574 5f6c 696e 6573         put_lines
-00036020: 2862 7566 2c20 6c69 6e65 7329 0a0a 2020  (buf, lines)..  
-00036030: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00036040: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00036050: 2020 6465 6620 6d65 6d6f 7279 5f75 7361    def memory_usa
-00036060: 6765 2873 656c 662c 2069 6e64 6578 3d54  ge(self, index=T
-00036070: 7275 652c 2064 6565 703d 4661 6c73 6529  rue, deep=False)
-00036080: 3a0a 2020 2020 2020 2020 7265 7375 6c74  :.        result
-00036090: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
-000360a0: 6974 696f 6e73 284d 2e6d 656d 6f72 795f  itions(M.memory_
-000360b0: 7573 6167 652c 2069 6e64 6578 3d69 6e64  usage, index=ind
-000360c0: 6578 2c20 6465 6570 3d64 6565 7029 0a20  ex, deep=deep). 
-000360d0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-000360e0: 7265 7375 6c74 2e67 726f 7570 6279 2872  result.groupby(r
-000360f0: 6573 756c 742e 696e 6465 7829 2e73 756d  esult.index).sum
-00036100: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
-00036110: 6e20 7265 7375 6c74 0a0a 2020 2020 6465  n result..    de
-00036120: 6620 7069 766f 745f 7461 626c 6528 7365  f pivot_table(se
-00036130: 6c66 2c20 696e 6465 783d 4e6f 6e65 2c20  lf, index=None, 
-00036140: 636f 6c75 6d6e 733d 4e6f 6e65 2c20 7661  columns=None, va
-00036150: 6c75 6573 3d4e 6f6e 652c 2061 6767 6675  lues=None, aggfu
-00036160: 6e63 3d22 6d65 616e 2229 3a0a 2020 2020  nc="mean"):.    
-00036170: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00036180: 4372 6561 7465 2061 2073 7072 6561 6473  Create a spreads
-00036190: 6865 6574 2d73 7479 6c65 2070 6976 6f74  heet-style pivot
-000361a0: 2074 6162 6c65 2061 7320 6120 4461 7461   table as a Data
-000361b0: 4672 616d 652e 2054 6172 6765 7420 6060  Frame. Target ``
-000361c0: 636f 6c75 6d6e 7360 600a 2020 2020 2020  columns``.      
-000361d0: 2020 6d75 7374 2068 6176 6520 6361 7465    must have cate
-000361e0: 676f 7279 2064 7479 7065 2074 6f20 696e  gory dtype to in
-000361f0: 6665 7220 7265 7375 6c74 2773 2060 6063  fer result's ``c
-00036200: 6f6c 756d 6e73 6060 2e0a 2020 2020 2020  olumns``..      
-00036210: 2020 6060 696e 6465 7860 602c 2060 6063    ``index``, ``c
-00036220: 6f6c 756d 6e73 6060 2c20 6060 7661 6c75  olumns``, ``valu
-00036230: 6573 6060 2061 6e64 2060 6061 6767 6675  es`` and ``aggfu
-00036240: 6e63 6060 206d 7573 7420 6265 2061 6c6c  nc`` must be all
-00036250: 2073 6361 6c61 722e 0a0a 2020 2020 2020   scalar...      
-00036260: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00036270: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00036280: 2020 2020 2020 2020 7661 6c75 6573 203a          values :
-00036290: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
-000362a0: 2020 2020 636f 6c75 6d6e 2074 6f20 6167      column to ag
-000362b0: 6772 6567 6174 650a 2020 2020 2020 2020  gregate.        
-000362c0: 696e 6465 7820 3a20 7363 616c 6172 0a20  index : scalar. 
-000362d0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-000362e0: 6e20 746f 2062 6520 696e 6465 780a 2020  n to be index.  
-000362f0: 2020 2020 2020 636f 6c75 6d6e 7320 3a20        columns : 
-00036300: 7363 616c 6172 0a20 2020 2020 2020 2020  scalar.         
-00036310: 2020 2063 6f6c 756d 6e20 746f 2062 6520     column to be 
-00036320: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
-00036330: 6167 6766 756e 6320 3a20 7b27 6d65 616e  aggfunc : {'mean
-00036340: 272c 2027 7375 6d27 2c20 2763 6f75 6e74  ', 'sum', 'count
-00036350: 277d 2c20 6465 6661 756c 7420 276d 6561  '}, default 'mea
-00036360: 6e27 0a0a 2020 2020 2020 2020 5265 7475  n'..        Retu
-00036370: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-00036380: 2d2d 2d0a 2020 2020 2020 2020 7461 626c  ---.        tabl
-00036390: 6520 3a20 4461 7461 4672 616d 650a 2020  e : DataFrame.  
-000363a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000363b0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
-000363c0: 6672 616d 652e 7265 7368 6170 6520 696d  frame.reshape im
-000363d0: 706f 7274 2070 6976 6f74 5f74 6162 6c65  port pivot_table
-000363e0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000363f0: 2070 6976 6f74 5f74 6162 6c65 280a 2020   pivot_table(.  
-00036400: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
-00036410: 696e 6465 783d 696e 6465 782c 2063 6f6c  index=index, col
-00036420: 756d 6e73 3d63 6f6c 756d 6e73 2c20 7661  umns=columns, va
-00036430: 6c75 6573 3d76 616c 7565 732c 2061 6767  lues=values, agg
-00036440: 6675 6e63 3d61 6767 6675 6e63 0a20 2020  func=aggfunc.   
-00036450: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00036460: 6d65 6c74 280a 2020 2020 2020 2020 7365  melt(.        se
-00036470: 6c66 2c0a 2020 2020 2020 2020 6964 5f76  lf,.        id_v
-00036480: 6172 733d 4e6f 6e65 2c0a 2020 2020 2020  ars=None,.      
-00036490: 2020 7661 6c75 655f 7661 7273 3d4e 6f6e    value_vars=Non
-000364a0: 652c 0a20 2020 2020 2020 2076 6172 5f6e  e,.        var_n
-000364b0: 616d 653d 4e6f 6e65 2c0a 2020 2020 2020  ame=None,.      
-000364c0: 2020 7661 6c75 655f 6e61 6d65 3d22 7661    value_name="va
-000364d0: 6c75 6522 2c0a 2020 2020 2020 2020 636f  lue",.        co
-000364e0: 6c5f 6c65 7665 6c3d 4e6f 6e65 2c0a 2020  l_level=None,.  
-000364f0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-00036500: 0a20 2020 2020 2020 2055 6e70 6976 6f74  .        Unpivot
-00036510: 7320 6120 4461 7461 4672 616d 6520 6672  s a DataFrame fr
-00036520: 6f6d 2077 6964 6520 666f 726d 6174 2074  om wide format t
-00036530: 6f20 6c6f 6e67 2066 6f72 6d61 742c 0a20  o long format,. 
-00036540: 2020 2020 2020 206f 7074 696f 6e61 6c6c         optionall
-00036550: 7920 6c65 6176 696e 6720 6964 656e 7469  y leaving identi
-00036560: 6669 6572 2076 6172 6961 626c 6573 2073  fier variables s
-00036570: 6574 2e0a 0a20 2020 2020 2020 2054 6869  et...        Thi
-00036580: 7320 6675 6e63 7469 6f6e 2069 7320 7573  s function is us
-00036590: 6566 756c 2074 6f20 6d61 7373 6167 6520  eful to massage 
-000365a0: 6120 4461 7461 4672 616d 6520 696e 746f  a DataFrame into
-000365b0: 2061 2066 6f72 6d61 7420 7768 6572 650a   a format where.
-000365c0: 2020 2020 2020 2020 6f6e 6520 6f72 206d          one or m
-000365d0: 6f72 6520 636f 6c75 6d6e 7320 6172 6520  ore columns are 
-000365e0: 6964 656e 7469 6669 6572 2076 6172 6961  identifier varia
-000365f0: 626c 6573 2028 6060 6964 5f76 6172 7360  bles (``id_vars`
-00036600: 6029 2c20 7768 696c 650a 2020 2020 2020  `), while.      
-00036610: 2020 616c 6c20 6f74 6865 7220 636f 6c75    all other colu
-00036620: 6d6e 732c 2063 6f6e 7369 6465 7265 6420  mns, considered 
-00036630: 6d65 6173 7572 6564 2076 6172 6961 626c  measured variabl
-00036640: 6573 2028 6060 7661 6c75 655f 7661 7273  es (``value_vars
-00036650: 6060 292c 0a20 2020 2020 2020 2061 7265  ``),.        are
-00036660: 2022 756e 7069 766f 7465 6422 2074 6f20   "unpivoted" to 
-00036670: 7468 6520 726f 7720 6178 6973 2c20 6c65  the row axis, le
-00036680: 6176 696e 6720 6a75 7374 2074 776f 206e  aving just two n
-00036690: 6f6e 2d69 6465 6e74 6966 6965 720a 2020  on-identifier.  
-000366a0: 2020 2020 2020 636f 6c75 6d6e 732c 2027        columns, '
-000366b0: 7661 7269 6162 6c65 2720 616e 6420 2776  variable' and 'v
-000366c0: 616c 7565 272e 0a0a 2020 2020 2020 2020  alue'...        
-000366d0: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-000366e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-000366f0: 2020 2020 2020 6672 616d 6520 3a20 4461        frame : Da
-00036700: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
-00036710: 6964 5f76 6172 7320 3a20 7475 706c 652c  id_vars : tuple,
-00036720: 206c 6973 742c 206f 7220 6e64 6172 7261   list, or ndarra
-00036730: 792c 206f 7074 696f 6e61 6c0a 2020 2020  y, optional.    
-00036740: 2020 2020 2020 2020 436f 6c75 6d6e 2873          Column(s
-00036750: 2920 746f 2075 7365 2061 7320 6964 656e  ) to use as iden
-00036760: 7469 6669 6572 2076 6172 6961 626c 6573  tifier variables
-00036770: 2e0a 2020 2020 2020 2020 7661 6c75 655f  ..        value_
-00036780: 7661 7273 203a 2074 7570 6c65 2c20 6c69  vars : tuple, li
-00036790: 7374 2c20 6f72 206e 6461 7272 6179 2c20  st, or ndarray, 
-000367a0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-000367b0: 2020 2020 2043 6f6c 756d 6e28 7329 2074       Column(s) t
-000367c0: 6f20 756e 7069 766f 742e 2049 6620 6e6f  o unpivot. If no
-000367d0: 7420 7370 6563 6966 6965 642c 2075 7365  t specified, use
-000367e0: 7320 616c 6c20 636f 6c75 6d6e 7320 7468  s all columns th
-000367f0: 6174 0a20 2020 2020 2020 2020 2020 2061  at.            a
-00036800: 7265 206e 6f74 2073 6574 2061 7320 6069  re not set as `i
-00036810: 645f 7661 7273 602e 0a20 2020 2020 2020  d_vars`..       
-00036820: 2076 6172 5f6e 616d 6520 3a20 7363 616c   var_name : scal
-00036830: 6172 0a20 2020 2020 2020 2020 2020 204e  ar.            N
-00036840: 616d 6520 746f 2075 7365 2066 6f72 2074  ame to use for t
-00036850: 6865 2027 7661 7269 6162 6c65 2720 636f  he 'variable' co
-00036860: 6c75 6d6e 2e20 4966 204e 6f6e 6520 6974  lumn. If None it
-00036870: 2075 7365 730a 2020 2020 2020 2020 2020   uses.          
-00036880: 2020 6060 6672 616d 652e 636f 6c75 6d6e    ``frame.column
-00036890: 732e 6e61 6d65 6060 206f 7220 2776 6172  s.name`` or 'var
-000368a0: 6961 626c 6527 2e0a 2020 2020 2020 2020  iable'..        
-000368b0: 7661 6c75 655f 6e61 6d65 203a 2073 6361  value_name : sca
-000368c0: 6c61 722c 2064 6566 6175 6c74 2027 7661  lar, default 'va
-000368d0: 6c75 6527 0a20 2020 2020 2020 2020 2020  lue'.           
-000368e0: 204e 616d 6520 746f 2075 7365 2066 6f72   Name to use for
-000368f0: 2074 6865 2027 7661 6c75 6527 2063 6f6c   the 'value' col
-00036900: 756d 6e2e 0a20 2020 2020 2020 2063 6f6c  umn..        col
-00036910: 5f6c 6576 656c 203a 2069 6e74 206f 7220  _level : int or 
-00036920: 7374 7269 6e67 2c20 6f70 7469 6f6e 616c  string, optional
-00036930: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00036940: 636f 6c75 6d6e 7320 6172 6520 6120 4d75  columns are a Mu
-00036950: 6c74 6949 6e64 6578 2074 6865 6e20 7573  ltiIndex then us
-00036960: 6520 7468 6973 206c 6576 656c 2074 6f20  e this level to 
-00036970: 6d65 6c74 2e0a 0a20 2020 2020 2020 2052  melt...        R
-00036980: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-00036990: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
-000369a0: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
-000369b0: 2020 2020 2055 6e70 6976 6f74 6564 2044       Unpivoted D
-000369c0: 6174 6146 7261 6d65 2e0a 0a20 2020 2020  ataFrame...     
-000369d0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-000369e0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-000369f0: 2020 2020 2070 616e 6461 732e 4461 7461       pandas.Data
-00036a00: 4672 616d 652e 6d65 6c74 0a20 2020 2020  Frame.melt.     
-00036a10: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-00036a20: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-00036a30: 6d65 2e72 6573 6861 7065 2069 6d70 6f72  me.reshape impor
-00036a40: 7420 6d65 6c74 0a0a 2020 2020 2020 2020  t melt..        
-00036a50: 7265 7475 726e 206d 656c 7428 0a20 2020  return melt(.   
-00036a60: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-00036a70: 2020 2020 2020 2020 2020 2069 645f 7661             id_va
-00036a80: 7273 3d69 645f 7661 7273 2c0a 2020 2020  rs=id_vars,.    
-00036a90: 2020 2020 2020 2020 7661 6c75 655f 7661          value_va
-00036aa0: 7273 3d76 616c 7565 5f76 6172 732c 0a20  rs=value_vars,. 
-00036ab0: 2020 2020 2020 2020 2020 2076 6172 5f6e             var_n
-00036ac0: 616d 653d 7661 725f 6e61 6d65 2c0a 2020  ame=var_name,.  
-00036ad0: 2020 2020 2020 2020 2020 7661 6c75 655f            value_
-00036ae0: 6e61 6d65 3d76 616c 7565 5f6e 616d 652c  name=value_name,
-00036af0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-00036b00: 5f6c 6576 656c 3d63 6f6c 5f6c 6576 656c  _level=col_level
-00036b10: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00036b20: 2064 6566 2074 6f5f 7265 636f 7264 7328   def to_records(
-00036b30: 7365 6c66 2c20 696e 6465 783d 4661 6c73  self, index=Fals
-00036b40: 652c 206c 656e 6774 6873 3d4e 6f6e 6529  e, lengths=None)
-00036b50: 3a0a 2020 2020 2020 2020 6672 6f6d 2064  :.        from d
-00036b60: 6173 6b2e 6461 7461 6672 616d 652e 696f  ask.dataframe.io
-00036b70: 2069 6d70 6f72 7420 746f 5f72 6563 6f72   import to_recor
-00036b80: 6473 0a0a 2020 2020 2020 2020 6966 206c  ds..        if l
-00036b90: 656e 6774 6873 2069 7320 5472 7565 3a0a  engths is True:.
-00036ba0: 2020 2020 2020 2020 2020 2020 6c65 6e67              leng
-00036bb0: 7468 7320 3d20 7475 706c 6528 7365 6c66  ths = tuple(self
-00036bc0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-00036bd0: 6c65 6e29 2e63 6f6d 7075 7465 2829 290a  len).compute()).
-00036be0: 0a20 2020 2020 2020 2072 6563 6f72 6473  .        records
-00036bf0: 203d 2074 6f5f 7265 636f 7264 7328 7365   = to_records(se
-00036c00: 6c66 290a 0a20 2020 2020 2020 2063 6875  lf)..        chu
-00036c10: 6e6b 7320 3d20 7365 6c66 2e5f 7661 6c69  nks = self._vali
-00036c20: 6461 7465 5f63 6875 6e6b 7328 7265 636f  date_chunks(reco
-00036c30: 7264 732c 206c 656e 6774 6873 290a 2020  rds, lengths).  
-00036c40: 2020 2020 2020 7265 636f 7264 732e 5f63        records._c
-00036c50: 6875 6e6b 7320 3d20 2863 6875 6e6b 735b  hunks = (chunks[
-00036c60: 305d 2c29 0a0a 2020 2020 2020 2020 7265  0],)..        re
-00036c70: 7475 726e 2072 6563 6f72 6473 0a0a 2020  turn records..  
-00036c80: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00036c90: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00036ca0: 2020 6465 6620 746f 5f68 746d 6c28 7365    def to_html(se
-00036cb0: 6c66 2c20 6d61 785f 726f 7773 3d35 293a  lf, max_rows=5):
-00036cc0: 0a20 2020 2020 2020 2023 2070 642e 5365  .        # pd.Se
-00036cd0: 7269 6573 2064 6f65 736e 2774 2068 6176  ries doesn't hav
-00036ce0: 6520 6874 6d6c 2072 6570 720a 2020 2020  e html repr.    
-00036cf0: 2020 2020 6461 7461 203d 2073 656c 662e      data = self.
-00036d00: 5f72 6570 725f 6461 7461 2829 2e74 6f5f  _repr_data().to_
-00036d10: 6874 6d6c 286d 6178 5f72 6f77 733d 6d61  html(max_rows=ma
-00036d20: 785f 726f 7773 2c20 7368 6f77 5f64 696d  x_rows, show_dim
-00036d30: 656e 7369 6f6e 733d 4661 6c73 6529 0a20  ensions=False). 
-00036d40: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
-00036d50: 745f 7465 6d70 6c61 7465 2822 6461 7461  t_template("data
-00036d60: 6672 616d 652e 6874 6d6c 2e6a 3222 292e  frame.html.j2").
-00036d70: 7265 6e64 6572 280a 2020 2020 2020 2020  render(.        
-00036d80: 2020 2020 6461 7461 3d64 6174 612c 0a20      data=data,. 
-00036d90: 2020 2020 2020 2020 2020 206e 616d 653d             name=
-00036da0: 7365 6c66 2e5f 6e61 6d65 2c0a 2020 2020  self._name,.    
-00036db0: 2020 2020 2020 2020 6c61 7965 7273 3d6d          layers=m
-00036dc0: 6179 6265 5f70 6c75 7261 6c69 7a65 286c  aybe_pluralize(l
-00036dd0: 656e 2873 656c 662e 6461 736b 2e6c 6179  en(self.dask.lay
-00036de0: 6572 7329 2c20 2267 7261 7068 206c 6179  ers), "graph lay
-00036df0: 6572 2229 2c0a 2020 2020 2020 2020 290a  er"),.        ).
-00036e00: 0a20 2020 2064 6566 205f 7265 7072 5f64  .    def _repr_d
-00036e10: 6174 6128 7365 6c66 293a 0a20 2020 2020  ata(self):.     
-00036e20: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
-00036e30: 6d65 7461 0a20 2020 2020 2020 2069 6e64  meta.        ind
-00036e40: 6578 203d 2073 656c 662e 5f72 6570 725f  ex = self._repr_
-00036e50: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
-00036e60: 2020 636f 6c73 203d 206d 6574 612e 636f    cols = meta.co
-00036e70: 6c75 6d6e 730a 2020 2020 2020 2020 6966  lumns.        if
-00036e80: 206c 656e 2863 6f6c 7329 203d 3d20 303a   len(cols) == 0:
-00036e90: 0a20 2020 2020 2020 2020 2020 2073 6572  .            ser
-00036ea0: 6965 735f 6466 203d 2070 642e 4461 7461  ies_df = pd.Data
-00036eb0: 4672 616d 6528 5b5b 5d5d 202a 206c 656e  Frame([[]] * len
-00036ec0: 2869 6e64 6578 292c 2063 6f6c 756d 6e73  (index), columns
-00036ed0: 3d63 6f6c 732c 2069 6e64 6578 3d69 6e64  =cols, index=ind
-00036ee0: 6578 290a 2020 2020 2020 2020 656c 7365  ex).        else
-00036ef0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00036f00: 7269 6573 5f64 6620 3d20 7064 2e63 6f6e  ries_df = pd.con
-00036f10: 6361 7428 0a20 2020 2020 2020 2020 2020  cat(.           
-00036f20: 2020 2020 205b 5f72 6570 725f 6461 7461       [_repr_data
-00036f30: 5f73 6572 6965 7328 732c 2069 6e64 6578  _series(s, index
-00036f40: 3d69 6e64 6578 2920 666f 7220 5f2c 2073  =index) for _, s
-00036f50: 2069 6e20 6d65 7461 2e69 7465 6d73 2829   in meta.items()
-00036f60: 5d2c 2061 7869 733d 310a 2020 2020 2020  ], axis=1.      
-00036f70: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00036f80: 7265 7475 726e 2073 6572 6965 735f 6466  return series_df
-00036f90: 0a0a 2020 2020 6465 6620 5f72 6570 725f  ..    def _repr_
-00036fa0: 6874 6d6c 5f28 7365 6c66 293a 0a20 2020  html_(self):.   
-00036fb0: 2020 2020 2064 6174 6120 3d20 7365 6c66       data = self
-00036fc0: 2e5f 7265 7072 5f64 6174 6128 292e 746f  ._repr_data().to
-00036fd0: 5f68 746d 6c28 0a20 2020 2020 2020 2020  _html(.         
-00036fe0: 2020 206d 6178 5f72 6f77 733d 352c 2073     max_rows=5, s
-00036ff0: 686f 775f 6469 6d65 6e73 696f 6e73 3d46  how_dimensions=F
-00037000: 616c 7365 2c20 6e6f 7465 626f 6f6b 3d54  alse, notebook=T
-00037010: 7275 650a 2020 2020 2020 2020 290a 2020  rue.        ).  
-00037020: 2020 2020 2020 7265 7475 726e 2067 6574        return get
-00037030: 5f74 656d 706c 6174 6528 2264 6174 6166  _template("dataf
-00037040: 7261 6d65 2e68 746d 6c2e 6a32 2229 2e72  rame.html.j2").r
-00037050: 656e 6465 7228 0a20 2020 2020 2020 2020  ender(.         
-00037060: 2020 2064 6174 613d 6461 7461 2c0a 2020     data=data,.  
-00037070: 2020 2020 2020 2020 2020 6e61 6d65 3d73            name=s
-00037080: 656c 662e 5f6e 616d 652c 0a20 2020 2020  elf._name,.     
-00037090: 2020 2020 2020 206c 6179 6572 733d 6d61         layers=ma
-000370a0: 7962 655f 706c 7572 616c 697a 6528 6c65  ybe_pluralize(le
-000370b0: 6e28 7365 6c66 2e64 6173 6b2e 6c61 7965  n(self.dask.laye
-000370c0: 7273 292c 2022 6772 6170 6820 6c61 7965  rs), "graph laye
-000370d0: 7222 292c 0a20 2020 2020 2020 2029 0a0a  r"),.        )..
-000370e0: 2020 2020 6465 6620 5f73 656c 6563 745f      def _select_
-000370f0: 636f 6c75 6d6e 735f 6f72 5f69 6e64 6578  columns_or_index
-00037100: 2873 656c 662c 2063 6f6c 756d 6e73 5f6f  (self, columns_o
-00037110: 725f 696e 6465 7829 3a0a 2020 2020 2020  r_index):.      
-00037120: 2020 2222 220a 2020 2020 2020 2020 5061    """.        Pa
-00037130: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00037140: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00037150: 2020 2020 636f 6c75 6d6e 735f 6f72 5f69      columns_or_i
-00037160: 6e64 6578 0a20 2020 2020 2020 2020 2020  ndex.           
-00037170: 2043 6f6c 756d 6e20 6f72 2069 6e64 6578   Column or index
-00037180: 206e 616d 652c 206f 7220 6120 6c69 7374   name, or a list
-00037190: 206f 6620 7468 6573 650a 0a20 2020 2020   of these..     
-000371a0: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-000371b0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-000371c0: 2020 2064 642e 4461 7461 4672 616d 650a     dd.DataFrame.
-000371d0: 2020 2020 2020 2020 2020 2020 4461 736b              Dask
-000371e0: 2044 6174 6146 7261 6d65 2077 6974 6820   DataFrame with 
-000371f0: 636f 6c75 6d6e 7320 636f 7272 6573 706f  columns correspo
-00037200: 6e64 696e 6720 746f 2065 6163 6820 636f  nding to each co
-00037210: 6c75 6d6e 206f 720a 2020 2020 2020 2020  lumn or.        
-00037220: 2020 2020 696e 6465 7820 6c65 7665 6c20      index level 
-00037230: 696e 2063 6f6c 756d 6e73 5f6f 725f 696e  in columns_or_in
-00037240: 6465 782e 2020 4966 2069 6e63 6c75 6465  dex.  If include
-00037250: 642c 2074 6865 2063 6f6c 756d 6e0a 2020  d, the column.  
-00037260: 2020 2020 2020 2020 2020 636f 7272 6573            corres
-00037270: 706f 6e64 696e 6720 746f 2074 6865 2069  ponding to the i
-00037280: 6e64 6578 206c 6576 656c 2069 7320 6e61  ndex level is na
-00037290: 6d65 6420 5f69 6e64 6578 0a20 2020 2020  med _index.     
-000372a0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-000372b0: 2320 456e 7375 7265 2063 6f6c 756d 6e73  # Ensure columns
-000372c0: 5f6f 725f 696e 6465 7820 6973 2061 206c  _or_index is a l
-000372d0: 6973 740a 2020 2020 2020 2020 636f 6c75  ist.        colu
-000372e0: 6d6e 735f 6f72 5f69 6e64 6578 203d 2028  mns_or_index = (
-000372f0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-00037300: 756d 6e73 5f6f 725f 696e 6465 780a 2020  umns_or_index.  
-00037310: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00037320: 6e73 7461 6e63 6528 636f 6c75 6d6e 735f  nstance(columns_
-00037330: 6f72 5f69 6e64 6578 2c20 6c69 7374 290a  or_index, list).
-00037340: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00037350: 205b 636f 6c75 6d6e 735f 6f72 5f69 6e64   [columns_or_ind
-00037360: 6578 5d0a 2020 2020 2020 2020 290a 0a20  ex].        ).. 
-00037370: 2020 2020 2020 2063 6f6c 756d 6e5f 6e61         column_na
-00037380: 6d65 7320 3d20 5b0a 2020 2020 2020 2020  mes = [.        
-00037390: 2020 2020 6e20 666f 7220 6e20 696e 2063      n for n in c
-000373a0: 6f6c 756d 6e73 5f6f 725f 696e 6465 7820  olumns_or_index 
-000373b0: 6966 2073 656c 662e 5f69 735f 636f 6c75  if self._is_colu
-000373c0: 6d6e 5f6c 6162 656c 5f72 6566 6572 656e  mn_label_referen
-000373d0: 6365 286e 290a 2020 2020 2020 2020 5d0a  ce(n).        ].
-000373e0: 0a20 2020 2020 2020 2073 656c 6563 7465  .        selecte
-000373f0: 645f 6466 203d 2073 656c 665b 636f 6c75  d_df = self[colu
-00037400: 6d6e 5f6e 616d 6573 5d0a 2020 2020 2020  mn_names].      
-00037410: 2020 6966 2073 656c 662e 5f63 6f6e 7461    if self._conta
-00037420: 696e 735f 696e 6465 785f 6e61 6d65 2863  ins_index_name(c
-00037430: 6f6c 756d 6e73 5f6f 725f 696e 6465 7829  olumns_or_index)
-00037440: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-00037450: 496e 6465 7820 6e61 6d65 2077 6173 2069  Index name was i
-00037460: 6e63 6c75 6465 640a 2020 2020 2020 2020  ncluded.        
-00037470: 2020 2020 7365 6c65 6374 6564 5f64 6620      selected_df 
-00037480: 3d20 7365 6c65 6374 6564 5f64 662e 6173  = selected_df.as
-00037490: 7369 676e 285f 696e 6465 783d 7365 6c66  sign(_index=self
-000374a0: 2e69 6e64 6578 290a 0a20 2020 2020 2020  .index)..       
-000374b0: 2072 6574 7572 6e20 7365 6c65 6374 6564   return selected
-000374c0: 5f64 660a 0a20 2020 2064 6566 205f 6973  _df..    def _is
-000374d0: 5f63 6f6c 756d 6e5f 6c61 6265 6c5f 7265  _column_label_re
-000374e0: 6665 7265 6e63 6528 7365 6c66 2c20 6b65  ference(self, ke
-000374f0: 7929 3a0a 2020 2020 2020 2020 2222 220a  y):.        """.
-00037500: 2020 2020 2020 2020 5465 7374 2077 6865          Test whe
-00037510: 7468 6572 2061 206b 6579 2069 7320 6120  ther a key is a 
-00037520: 636f 6c75 6d6e 206c 6162 656c 2072 6566  column label ref
-00037530: 6572 656e 6365 0a0a 2020 2020 2020 2020  erence..        
-00037540: 546f 2062 6520 636f 6e73 6964 6572 6564  To be considered
-00037550: 2061 2063 6f6c 756d 6e20 6c61 6265 6c20   a column label 
-00037560: 7265 6665 7265 6e63 652c 2060 6b65 7960  reference, `key`
-00037570: 206d 7573 7420 6d61 7463 6820 7468 6520   must match the 
-00037580: 6e61 6d65 206f 6620 6174 0a20 2020 2020  name of at.     
-00037590: 2020 206c 6561 7374 206f 6e65 2063 6f6c     least one col
-000375a0: 756d 6e2e 0a20 2020 2020 2020 2022 2222  umn..        """
-000375b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000375c0: 280a 2020 2020 2020 2020 2020 2020 6e6f  (.            no
-000375d0: 7420 6973 5f64 6173 6b5f 636f 6c6c 6563  t is_dask_collec
-000375e0: 7469 6f6e 286b 6579 290a 2020 2020 2020  tion(key).      
-000375f0: 2020 2020 2020 616e 6420 286e 702e 6973        and (np.is
-00037600: 7363 616c 6172 286b 6579 2920 6f72 2069  scalar(key) or i
-00037610: 7369 6e73 7461 6e63 6528 6b65 792c 2074  sinstance(key, t
-00037620: 7570 6c65 2929 0a20 2020 2020 2020 2020  uple)).         
-00037630: 2020 2061 6e64 206b 6579 2069 6e20 7365     and key in se
-00037640: 6c66 2e63 6f6c 756d 6e73 0a20 2020 2020  lf.columns.     
-00037650: 2020 2029 0a0a 2020 2020 4063 6c61 7373     )..    @class
-00037660: 6d65 7468 6f64 0a20 2020 2064 6566 2066  method.    def f
-00037670: 726f 6d5f 6469 6374 280a 2020 2020 2020  rom_dict(.      
-00037680: 2020 636c 732c 2064 6174 612c 202a 2c20    cls, data, *, 
-00037690: 6e70 6172 7469 7469 6f6e 732c 206f 7269  npartitions, ori
-000376a0: 656e 743d 2263 6f6c 756d 6e73 222c 2064  ent="columns", d
-000376b0: 7479 7065 3d4e 6f6e 652c 2063 6f6c 756d  type=None, colum
-000376c0: 6e73 3d4e 6f6e 650a 2020 2020 293a 0a20  ns=None.    ):. 
-000376d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000376e0: 2020 2043 6f6e 7374 7275 6374 2061 2044     Construct a D
-000376f0: 6173 6b20 4461 7461 4672 616d 6520 6672  ask DataFrame fr
-00037700: 6f6d 2061 2050 7974 686f 6e20 4469 6374  om a Python Dict
-00037710: 696f 6e61 7279 0a0a 2020 2020 2020 2020  ionary..        
-00037720: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-00037730: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00037740: 2020 6461 736b 2e64 6174 6166 7261 6d65    dask.dataframe
-00037750: 2e66 726f 6d5f 6469 6374 0a20 2020 2020  .from_dict.     
-00037760: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-00037770: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-00037780: 6d65 2e69 6f20 696d 706f 7274 2066 726f  me.io import fro
-00037790: 6d5f 6469 6374 0a0a 2020 2020 2020 2020  m_dict..        
-000377a0: 7265 7475 726e 2066 726f 6d5f 6469 6374  return from_dict
-000377b0: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
-000377c0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-000377d0: 6e70 6172 7469 7469 6f6e 732c 0a20 2020  npartitions,.   
-000377e0: 2020 2020 2020 2020 206f 7269 656e 743d           orient=
-000377f0: 6f72 6965 6e74 2c0a 2020 2020 2020 2020  orient,.        
-00037800: 2020 2020 6474 7970 653d 6474 7970 652c      dtype=dtype,
-00037810: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-00037820: 756d 6e73 3d63 6f6c 756d 6e73 2c0a 2020  umns=columns,.  
-00037830: 2020 2020 2020 2020 2020 636f 6e73 7472            constr
-00037840: 7563 746f 723d 636c 732e 5f70 6172 7469  uctor=cls._parti
-00037850: 7469 6f6e 5f74 7970 652c 0a20 2020 2020  tion_type,.     
-00037860: 2020 2029 0a0a 0a23 2062 696e 6420 6f70     )...# bind op
-00037870: 6572 6174 6f72 730a 2320 544f 444f 3a20  erators.# TODO: 
-00037880: 6479 6e61 6d69 6361 6c6c 7920 626f 756e  dynamically boun
-00037890: 6420 6f70 6572 6174 6f72 7320 6172 6520  d operators are 
-000378a0: 6465 6665 6174 696e 6720 7479 7065 2061  defeating type a
-000378b0: 6e6e 6f74 6174 696f 6e73 0a66 6f72 206f  nnotations.for o
-000378c0: 7020 696e 205b 0a20 2020 206f 7065 7261  p in [.    opera
-000378d0: 746f 722e 6162 732c 0a20 2020 206f 7065  tor.abs,.    ope
-000378e0: 7261 746f 722e 6164 642c 0a20 2020 206f  rator.add,.    o
-000378f0: 7065 7261 746f 722e 616e 645f 2c0a 2020  perator.and_,.  
-00037900: 2020 6f70 6572 6174 6f72 2e65 712c 0a20    operator.eq,. 
-00037910: 2020 206f 7065 7261 746f 722e 6774 2c0a     operator.gt,.
-00037920: 2020 2020 6f70 6572 6174 6f72 2e67 652c      operator.ge,
-00037930: 0a20 2020 206f 7065 7261 746f 722e 696e  .    operator.in
-00037940: 762c 0a20 2020 206f 7065 7261 746f 722e  v,.    operator.
-00037950: 6c74 2c0a 2020 2020 6f70 6572 6174 6f72  lt,.    operator
-00037960: 2e6c 652c 0a20 2020 206f 7065 7261 746f  .le,.    operato
-00037970: 722e 6d6f 642c 0a20 2020 206f 7065 7261  r.mod,.    opera
-00037980: 746f 722e 6d75 6c2c 0a20 2020 206f 7065  tor.mul,.    ope
-00037990: 7261 746f 722e 6e65 2c0a 2020 2020 6f70  rator.ne,.    op
-000379a0: 6572 6174 6f72 2e6e 6567 2c0a 2020 2020  erator.neg,.    
-000379b0: 6f70 6572 6174 6f72 2e6f 725f 2c0a 2020  operator.or_,.  
-000379c0: 2020 6f70 6572 6174 6f72 2e70 6f77 2c0a    operator.pow,.
-000379d0: 2020 2020 6f70 6572 6174 6f72 2e73 7562      operator.sub
-000379e0: 2c0a 2020 2020 6f70 6572 6174 6f72 2e74  ,.    operator.t
-000379f0: 7275 6564 6976 2c0a 2020 2020 6f70 6572  ruediv,.    oper
-00037a00: 6174 6f72 2e66 6c6f 6f72 6469 762c 0a20  ator.floordiv,. 
-00037a10: 2020 206f 7065 7261 746f 722e 786f 722c     operator.xor,
-00037a20: 0a5d 3a0a 2020 2020 5f46 7261 6d65 2e5f  .]:.    _Frame._
-00037a30: 6269 6e64 5f6f 7065 7261 746f 7228 6f70  bind_operator(op
-00037a40: 290a 2020 2020 5363 616c 6172 2e5f 6269  ).    Scalar._bi
-00037a50: 6e64 5f6f 7065 7261 746f 7228 6f70 290a  nd_operator(op).
-00037a60: 0a66 6f72 206e 616d 6520 696e 205b 0a20  .for name in [. 
-00037a70: 2020 2022 6164 6422 2c0a 2020 2020 2273     "add",.    "s
-00037a80: 7562 222c 0a20 2020 2022 6d75 6c22 2c0a  ub",.    "mul",.
-00037a90: 2020 2020 2264 6976 222c 0a20 2020 2022      "div",.    "
-00037aa0: 6469 7669 6465 222c 0a20 2020 2022 7472  divide",.    "tr
-00037ab0: 7565 6469 7622 2c0a 2020 2020 2266 6c6f  uediv",.    "flo
-00037ac0: 6f72 6469 7622 2c0a 2020 2020 226d 6f64  ordiv",.    "mod
-00037ad0: 222c 0a20 2020 2022 706f 7722 2c0a 2020  ",.    "pow",.  
-00037ae0: 2020 2272 6164 6422 2c0a 2020 2020 2272    "radd",.    "r
-00037af0: 7375 6222 2c0a 2020 2020 2272 6d75 6c22  sub",.    "rmul"
-00037b00: 2c0a 2020 2020 2272 6469 7622 2c0a 2020  ,.    "rdiv",.  
-00037b10: 2020 2272 7472 7565 6469 7622 2c0a 2020    "rtruediv",.  
-00037b20: 2020 2272 666c 6f6f 7264 6976 222c 0a20    "rfloordiv",. 
-00037b30: 2020 2022 726d 6f64 222c 0a20 2020 2022     "rmod",.    "
-00037b40: 7270 6f77 222c 0a5d 3a0a 2020 2020 6d65  rpow",.]:.    me
-00037b50: 7468 203d 2067 6574 6174 7472 2870 642e  th = getattr(pd.
-00037b60: 4461 7461 4672 616d 652c 206e 616d 6529  DataFrame, name)
-00037b70: 0a20 2020 2044 6174 6146 7261 6d65 2e5f  .    DataFrame._
-00037b80: 6269 6e64 5f6f 7065 7261 746f 725f 6d65  bind_operator_me
-00037b90: 7468 6f64 286e 616d 652c 206d 6574 6829  thod(name, meth)
-00037ba0: 0a0a 2020 2020 6d65 7468 203d 2067 6574  ..    meth = get
-00037bb0: 6174 7472 2870 642e 5365 7269 6573 2c20  attr(pd.Series, 
-00037bc0: 6e61 6d65 290a 2020 2020 5365 7269 6573  name).    Series
-00037bd0: 2e5f 6269 6e64 5f6f 7065 7261 746f 725f  ._bind_operator_
-00037be0: 6d65 7468 6f64 286e 616d 652c 206d 6574  method(name, met
-00037bf0: 6829 0a0a 666f 7220 6e61 6d65 2069 6e20  h)..for name in 
-00037c00: 5b22 6c74 222c 2022 6774 222c 2022 6c65  ["lt", "gt", "le
-00037c10: 222c 2022 6765 222c 2022 6e65 222c 2022  ", "ge", "ne", "
-00037c20: 6571 225d 3a0a 2020 2020 6d65 7468 203d  eq"]:.    meth =
-00037c30: 2067 6574 6174 7472 2870 642e 4461 7461   getattr(pd.Data
-00037c40: 4672 616d 652c 206e 616d 6529 0a20 2020  Frame, name).   
-00037c50: 2044 6174 6146 7261 6d65 2e5f 6269 6e64   DataFrame._bind
-00037c60: 5f63 6f6d 7061 7269 736f 6e5f 6d65 7468  _comparison_meth
-00037c70: 6f64 286e 616d 652c 206d 6574 6829 0a0a  od(name, meth)..
-00037c80: 2020 2020 6d65 7468 203d 2067 6574 6174      meth = getat
-00037c90: 7472 2870 642e 5365 7269 6573 2c20 6e61  tr(pd.Series, na
-00037ca0: 6d65 290a 2020 2020 5365 7269 6573 2e5f  me).    Series._
-00037cb0: 6269 6e64 5f63 6f6d 7061 7269 736f 6e5f  bind_comparison_
-00037cc0: 6d65 7468 6f64 286e 616d 652c 206d 6574  method(name, met
-00037cd0: 6829 0a0a 0a64 6566 2069 735f 6272 6f61  h)...def is_broa
-00037ce0: 6463 6173 7461 626c 6528 6466 732c 2073  dcastable(dfs, s
-00037cf0: 293a 0a20 2020 2022 2222 0a20 2020 2054  ):.    """.    T
-00037d00: 6869 7320 5365 7269 6573 2069 7320 6272  his Series is br
-00037d10: 6f61 6463 6173 7461 626c 6520 6167 6169  oadcastable agai
-00037d20: 6e73 7420 616e 6f74 6865 7220 6461 7461  nst another data
-00037d30: 6672 616d 6520 696e 2074 6865 2073 6571  frame in the seq
-00037d40: 7565 6e63 650a 2020 2020 2222 220a 0a20  uence.    """.. 
-00037d50: 2020 2064 6566 2063 6f6d 7061 7265 2873     def compare(s
-00037d60: 2c20 6466 293a 0a20 2020 2020 2020 2074  , df):.        t
-00037d70: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00037d80: 7265 7475 726e 2073 2e64 6976 6973 696f  return s.divisio
-00037d90: 6e73 203d 3d20 2864 662e 636f 6c75 6d6e  ns == (df.column
-00037da0: 732e 6d69 6e28 292c 2064 662e 636f 6c75  s.min(), df.colu
-00037db0: 6d6e 732e 6d61 7828 2929 0a20 2020 2020  mns.max()).     
-00037dc0: 2020 2065 7863 6570 7420 5479 7065 4572     except TypeEr
-00037dd0: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-00037de0: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
-00037df0: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
-00037e00: 2020 2020 6973 696e 7374 616e 6365 2873      isinstance(s
-00037e10: 2c20 5365 7269 6573 290a 2020 2020 2020  , Series).      
-00037e20: 2020 616e 6420 732e 6e70 6172 7469 7469    and s.npartiti
-00037e30: 6f6e 7320 3d3d 2031 0a20 2020 2020 2020  ons == 1.       
-00037e40: 2061 6e64 2073 2e6b 6e6f 776e 5f64 6976   and s.known_div
-00037e50: 6973 696f 6e73 0a20 2020 2020 2020 2061  isions.        a
-00037e60: 6e64 2061 6e79 2863 6f6d 7061 7265 2873  nd any(compare(s
-00037e70: 2c20 6466 2920 666f 7220 6466 2069 6e20  , df) for df in 
-00037e80: 6466 7320 6966 2069 7369 6e73 7461 6e63  dfs if isinstanc
-00037e90: 6528 6466 2c20 4461 7461 4672 616d 6529  e(df, DataFrame)
-00037ea0: 290a 2020 2020 290a 0a0a 6465 6620 656c  ).    )...def el
-00037eb0: 656d 7769 7365 286f 702c 202a 6172 6773  emwise(op, *args
-00037ec0: 2c20 6d65 7461 3d6e 6f5f 6465 6661 756c  , meta=no_defaul
-00037ed0: 742c 206f 7574 3d4e 6f6e 652c 2074 7261  t, out=None, tra
-00037ee0: 6e73 666f 726d 5f64 6976 6973 696f 6e73  nsform_divisions
-00037ef0: 3d54 7275 652c 202a 2a6b 7761 7267 7329  =True, **kwargs)
-00037f00: 3a0a 2020 2020 2222 2245 6c65 6d65 6e74  :.    """Element
-00037f10: 7769 7365 206f 7065 7261 7469 6f6e 2066  wise operation f
-00037f20: 6f72 2044 6173 6b20 6461 7461 6672 616d  or Dask datafram
-00037f30: 6573 0a0a 2020 2020 5061 7261 6d65 7465  es..    Paramete
-00037f40: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00037f50: 2d0a 2020 2020 6f70 3a20 6361 6c6c 6162  -.    op: callab
-00037f60: 6c65 0a20 2020 2020 2020 2046 756e 6374  le.        Funct
-00037f70: 696f 6e20 746f 2061 7070 6c79 2061 6372  ion to apply acr
-00037f80: 6f73 7320 696e 7075 7420 6461 7461 6672  oss input datafr
-00037f90: 616d 6573 0a20 2020 202a 6172 6773 3a20  ames.    *args: 
-00037fa0: 4461 7461 4672 616d 6573 2c20 5365 7269  DataFrames, Seri
-00037fb0: 6573 2c20 5363 616c 6172 732c 2041 7272  es, Scalars, Arr
-00037fc0: 6179 732c 0a20 2020 2020 2020 2054 6865  ays,.        The
-00037fd0: 2061 7267 756d 656e 7473 206f 6620 7468   arguments of th
-00037fe0: 6520 6f70 6572 6174 696f 6e0a 2020 2020  e operation.    
-00037ff0: 6d65 7461 3a20 7064 2e44 6174 6146 7261  meta: pd.DataFra
-00038000: 6d65 2c20 7064 2e53 6572 6965 7320 286f  me, pd.Series (o
-00038010: 7074 696f 6e61 6c29 0a20 2020 2020 2020  ptional).       
-00038020: 2056 616c 6964 206d 6574 6164 6174 6120   Valid metadata 
-00038030: 666f 7220 7468 6520 6f70 6572 6174 696f  for the operatio
-00038040: 6e2e 2020 5769 6c6c 2065 7661 6c75 6174  n.  Will evaluat
-00038050: 6520 6f6e 2061 2073 6d61 6c6c 2070 6965  e on a small pie
-00038060: 6365 206f 660a 2020 2020 2020 2020 6461  ce of.        da
-00038070: 7461 2069 6620 6e6f 7420 7072 6f76 6964  ta if not provid
-00038080: 6564 2e0a 2020 2020 7472 616e 7366 6f72  ed..    transfor
-00038090: 6d5f 6469 7669 7369 6f6e 733a 2062 6f6f  m_divisions: boo
-000380a0: 6c65 616e 0a20 2020 2020 2020 2049 6620  lean.        If 
-000380b0: 7468 6520 696e 7075 7420 6973 2061 2060  the input is a `
-000380c0: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
-000380d0: 496e 6465 7860 6020 7765 206e 6f72 6d61  Index`` we norma
-000380e0: 6c6c 7920 7769 6c6c 2061 6c73 6f20 6170  lly will also ap
-000380f0: 706c 790a 2020 2020 2020 2020 7468 6520  ply.        the 
-00038100: 6675 6e63 7469 6f6e 206f 6e74 6f20 7468  function onto th
-00038110: 6520 6469 7669 7369 6f6e 7320 616e 6420  e divisions and 
-00038120: 6170 706c 7920 7468 6f73 6520 7472 616e  apply those tran
-00038130: 7366 6f72 6d65 6420 6469 7669 7369 6f6e  sformed division
-00038140: 730a 2020 2020 2020 2020 746f 2074 6865  s.        to the
-00038150: 206f 7574 7075 742e 2020 596f 7520 6361   output.  You ca
-00038160: 6e20 7061 7373 2060 6074 7261 6e73 666f  n pass ``transfo
-00038170: 726d 5f64 6976 6973 696f 6e73 3d46 616c  rm_divisions=Fal
-00038180: 7365 6060 2074 6f20 6f76 6572 7269 6465  se`` to override
-00038190: 0a20 2020 2020 2020 2074 6869 7320 6265  .        this be
-000381a0: 6861 7669 6f72 0a20 2020 206f 7574 203a  havior.    out :
-000381b0: 2060 6064 6173 6b2e 6172 7261 7960 6020   ``dask.array`` 
-000381c0: 6f72 2060 604e 6f6e 6560 600a 2020 2020  or ``None``.    
-000381d0: 2020 2020 4966 206f 7574 2069 7320 6120      If out is a 
-000381e0: 6461 736b 2e44 6174 6146 7261 6d65 2c20  dask.DataFrame, 
-000381f0: 6461 736b 2e53 6572 6965 7320 6f72 2064  dask.Series or d
-00038200: 6173 6b2e 5363 616c 6172 2074 6865 6e0a  ask.Scalar then.
-00038210: 2020 2020 2020 2020 7468 6973 206f 7665          this ove
-00038220: 7277 7269 7465 7320 7468 6520 636f 6e74  rwrites the cont
-00038230: 656e 7473 206f 6620 6974 2077 6974 6820  ents of it with 
-00038240: 7468 6520 7265 7375 6c74 0a20 2020 202a  the result.    *
-00038250: 2a6b 7761 7267 733a 2073 6361 6c61 7273  *kwargs: scalars
-00038260: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
-00038270: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00038280: 3e3e 3e20 656c 656d 7769 7365 286f 7065  >>> elemwise(ope
-00038290: 7261 746f 722e 6164 642c 2064 662e 782c  rator.add, df.x,
-000382a0: 2064 662e 7929 2020 2320 646f 6374 6573   df.y)  # doctes
-000382b0: 743a 202b 534b 4950 0a20 2020 2022 2222  t: +SKIP.    """
-000382c0: 0a20 2020 205f 6e61 6d65 203d 2066 756e  .    _name = fun
-000382d0: 636e 616d 6528 6f70 2920 2b20 222d 2220  cname(op) + "-" 
-000382e0: 2b20 746f 6b65 6e69 7a65 286f 702c 202a  + tokenize(op, *
-000382f0: 6172 6773 2c20 2a2a 6b77 6172 6773 290a  args, **kwargs).
-00038300: 0a20 2020 2061 7267 7320 3d20 5f6d 6179  .    args = _may
-00038310: 6265 5f66 726f 6d5f 7061 6e64 6173 2861  be_from_pandas(a
-00038320: 7267 7329 0a0a 2020 2020 6672 6f6d 2064  rgs)..    from d
-00038330: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
-00038340: 6c74 6920 696d 706f 7274 205f 6d61 7962  lti import _mayb
-00038350: 655f 616c 6967 6e5f 7061 7274 6974 696f  e_align_partitio
-00038360: 6e73 0a0a 2020 2020 6172 6773 203d 205f  ns..    args = _
-00038370: 6d61 7962 655f 616c 6967 6e5f 7061 7274  maybe_align_part
-00038380: 6974 696f 6e73 2861 7267 7329 0a20 2020  itions(args).   
-00038390: 2064 6173 6b73 203d 205b 6172 6720 666f   dasks = [arg fo
-000383a0: 7220 6172 6720 696e 2061 7267 7320 6966  r arg in args if
-000383b0: 2069 7369 6e73 7461 6e63 6528 6172 672c   isinstance(arg,
-000383c0: 2028 5f46 7261 6d65 2c20 5363 616c 6172   (_Frame, Scalar
-000383d0: 2c20 4172 7261 7929 295d 0a20 2020 2064  , Array))].    d
-000383e0: 6673 203d 205b 6466 2066 6f72 2064 6620  fs = [df for df 
-000383f0: 696e 2064 6173 6b73 2069 6620 6973 696e  in dasks if isin
-00038400: 7374 616e 6365 2864 662c 205f 4672 616d  stance(df, _Fram
-00038410: 6529 5d0a 0a20 2020 2023 2043 6c65 616e  e)]..    # Clean
-00038420: 2075 7020 6461 736b 2061 7272 6179 7320   up dask arrays 
-00038430: 6966 2070 7265 7365 6e74 0a20 2020 2064  if present.    d
-00038440: 6570 7320 3d20 6461 736b 732e 636f 7079  eps = dasks.copy
-00038450: 2829 0a20 2020 2066 6f72 2069 2c20 6120  ().    for i, a 
-00038460: 696e 2065 6e75 6d65 7261 7465 2864 6173  in enumerate(das
-00038470: 6b73 293a 0a20 2020 2020 2020 2069 6620  ks):.        if 
-00038480: 6e6f 7420 6973 696e 7374 616e 6365 2861  not isinstance(a
-00038490: 2c20 4172 7261 7929 3a0a 2020 2020 2020  , Array):.      
-000384a0: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
-000384b0: 2020 2020 2020 2023 2045 6e73 7572 6520         # Ensure 
-000384c0: 7468 6174 2074 6865 7920 6861 7665 2073  that they have s
-000384d0: 696d 696c 6172 2d69 7368 2063 6875 6e6b  imilar-ish chunk
-000384e0: 2073 7472 7563 7475 7265 0a20 2020 2020   structure.     
-000384f0: 2020 2069 6620 6e6f 7420 616c 6c28 6e6f     if not all(no
-00038500: 7420 612e 6368 756e 6b73 206f 7220 6c65  t a.chunks or le
-00038510: 6e28 612e 6368 756e 6b73 5b30 5d29 203d  n(a.chunks[0]) =
-00038520: 3d20 6466 2e6e 7061 7274 6974 696f 6e73  = df.npartitions
-00038530: 2066 6f72 2064 6620 696e 2064 6673 293a   for df in dfs):
-00038540: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-00038550: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00038560: 2020 2020 2022 5768 656e 2063 6f6d 6269       "When combi
-00038570: 6e69 6e67 2064 6173 6b20 6172 7261 7973  ning dask arrays
-00038580: 2077 6974 6820 6461 7461 6672 616d 6573   with dataframes
-00038590: 2074 6865 7920 6d75 7374 2022 0a20 2020   they must ".   
-000385a0: 2020 2020 2020 2020 2020 2020 2022 6d61               "ma
-000385b0: 7463 6820 6368 756e 6b69 6e67 2065 7861  tch chunking exa
-000385c0: 6374 6c79 2e20 204f 7065 7261 7469 6f6e  ctly.  Operation
-000385d0: 3a20 2573 2220 2520 6675 6e63 6e61 6d65  : %s" % funcname
-000385e0: 286f 7029 0a20 2020 2020 2020 2020 2020  (op).           
-000385f0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-00038600: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00038610: 6d73 6729 0a20 2020 2020 2020 2023 2052  msg).        # R
-00038620: 6563 6875 6e6b 2074 6f20 6861 7665 2061  echunk to have a
-00038630: 2073 696e 676c 6520 6368 756e 6b20 616c   single chunk al
-00038640: 6f6e 6720 616c 6c20 6f74 6865 7220 6178  ong all other ax
-00038650: 6573 0a20 2020 2020 2020 2069 6620 612e  es.        if a.
-00038660: 6e64 696d 203e 2031 3a0a 2020 2020 2020  ndim > 1:.      
-00038670: 2020 2020 2020 6120 3d20 612e 7265 6368        a = a.rech
-00038680: 756e 6b28 7b69 202b 2031 3a20 6420 666f  unk({i + 1: d fo
-00038690: 7220 692c 2064 2069 6e20 656e 756d 6572  r i, d in enumer
-000386a0: 6174 6528 612e 7368 6170 655b 313a 5d29  ate(a.shape[1:])
-000386b0: 7d29 0a20 2020 2020 2020 2020 2020 2064  }).            d
-000386c0: 6173 6b73 5b69 5d20 3d20 610a 0a20 2020  asks[i] = a..   
-000386d0: 2064 6976 6973 696f 6e73 203d 2064 6673   divisions = dfs
-000386e0: 5b30 5d2e 6469 7669 7369 6f6e 730a 2020  [0].divisions.  
-000386f0: 2020 6966 2074 7261 6e73 666f 726d 5f64    if transform_d
-00038700: 6976 6973 696f 6e73 2061 6e64 2069 7369  ivisions and isi
-00038710: 6e73 7461 6e63 6528 6466 735b 305d 2c20  nstance(dfs[0], 
-00038720: 496e 6465 7829 2061 6e64 206c 656e 2864  Index) and len(d
-00038730: 6673 2920 3d3d 2031 3a0a 2020 2020 2020  fs) == 1:.      
-00038740: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00038750: 2020 2064 6976 6973 696f 6e73 203d 206f     divisions = o
-00038760: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
-00038770: 2020 202a 5b70 642e 496e 6465 7828 6172     *[pd.Index(ar
-00038780: 672e 6469 7669 7369 6f6e 7329 2069 6620  g.divisions) if 
-00038790: 6172 6720 6973 2064 6673 5b30 5d20 656c  arg is dfs[0] el
-000387a0: 7365 2061 7267 2066 6f72 2061 7267 2069  se arg for arg i
-000387b0: 6e20 6172 6773 5d2c 0a20 2020 2020 2020  n args],.       
-000387c0: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
-000387d0: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
-000387e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000387f0: 6973 696e 7374 616e 6365 2864 6976 6973  isinstance(divis
-00038800: 696f 6e73 2c20 7064 2e49 6e64 6578 293a  ions, pd.Index):
-00038810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038820: 2064 6976 6973 696f 6e73 203d 206d 6574   divisions = met
-00038830: 686f 6473 2e74 6f6c 6973 7428 6469 7669  hods.tolist(divi
-00038840: 7369 6f6e 7329 0a20 2020 2020 2020 2065  sions).        e
-00038850: 7863 6570 7420 4578 6365 7074 696f 6e3a  xcept Exception:
-00038860: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
-00038870: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
-00038880: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00038890: 6f74 2076 616c 6964 5f64 6976 6973 696f  ot valid_divisio
-000388a0: 6e73 2864 6976 6973 696f 6e73 293a 0a20  ns(divisions):. 
-000388b0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000388c0: 6976 6973 696f 6e73 203d 205b 4e6f 6e65  ivisions = [None
-000388d0: 5d20 2a20 2864 6673 5b30 5d2e 6e70 6172  ] * (dfs[0].npar
-000388e0: 7469 7469 6f6e 7320 2b20 3129 0a0a 2020  titions + 1)..  
-000388f0: 2020 5f69 735f 6272 6f61 6463 6173 7461    _is_broadcasta
-00038900: 626c 6520 3d20 7061 7274 6961 6c28 6973  ble = partial(is
-00038910: 5f62 726f 6164 6361 7374 6162 6c65 2c20  _broadcastable, 
-00038920: 6466 7329 0a20 2020 2064 6673 203d 206c  dfs).    dfs = l
-00038930: 6973 7428 7265 6d6f 7665 285f 6973 5f62  ist(remove(_is_b
-00038940: 726f 6164 6361 7374 6162 6c65 2c20 6466  roadcastable, df
-00038950: 7329 290a 0a20 2020 206f 7468 6572 203d  s))..    other =
-00038960: 205b 0a20 2020 2020 2020 2028 692c 2061   [.        (i, a
-00038970: 7267 290a 2020 2020 2020 2020 666f 7220  rg).        for 
-00038980: 692c 2061 7267 2069 6e20 656e 756d 6572  i, arg in enumer
-00038990: 6174 6528 6172 6773 290a 2020 2020 2020  ate(args).      
-000389a0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-000389b0: 6e63 6528 6172 672c 2028 5f46 7261 6d65  nce(arg, (_Frame
-000389c0: 2c20 5363 616c 6172 2c20 4172 7261 7929  , Scalar, Array)
-000389d0: 290a 2020 2020 5d0a 0a20 2020 2023 2061  ).    ]..    # a
-000389e0: 646a 7573 7420 7468 6520 6b65 7920 6c65  djust the key le
-000389f0: 6e67 7468 206f 6620 5363 616c 6172 0a20  ngth of Scalar. 
-00038a00: 2020 2064 736b 203d 2070 6172 7469 7469     dsk = partiti
-00038a10: 6f6e 7769 7365 5f67 7261 7068 286f 702c  onwise_graph(op,
-00038a20: 205f 6e61 6d65 2c20 2a61 7267 732c 202a   _name, *args, *
-00038a30: 2a6b 7761 7267 7329 0a0a 2020 2020 6772  *kwargs)..    gr
-00038a40: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
-00038a50: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
-00038a60: 7469 6f6e 7328 5f6e 616d 652c 2064 736b  tions(_name, dsk
-00038a70: 2c20 6465 7065 6e64 656e 6369 6573 3d64  , dependencies=d
-00038a80: 6570 7329 0a0a 2020 2020 6966 206d 6574  eps)..    if met
-00038a90: 6120 6973 206e 6f5f 6465 6661 756c 743a  a is no_default:
-00038aa0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-00038ab0: 6466 7329 203e 3d20 3220 616e 6420 6e6f  dfs) >= 2 and no
-00038ac0: 7420 616c 6c28 6861 7361 7474 7228 642c  t all(hasattr(d,
-00038ad0: 2022 6e70 6172 7469 7469 6f6e 7322 2920   "npartitions") 
-00038ae0: 666f 7220 6420 696e 2064 6173 6b73 293a  for d in dasks):
-00038af0: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
-00038b00: 686f 756c 6420 6e6f 7420 6f63 6375 7220  hould not occur 
-00038b10: 696e 2063 7572 7265 6e74 2066 756e 6373  in current funcs
-00038b20: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-00038b30: 203d 2022 656c 656d 7769 7365 2077 6974   = "elemwise wit
-00038b40: 6820 3220 6f72 206d 6f72 6520 4461 7461  h 2 or more Data
-00038b50: 4672 616d 6573 2061 6e64 2053 6361 6c61  Frames and Scala
-00038b60: 7220 6973 206e 6f74 2073 7570 706f 7274  r is not support
-00038b70: 6564 220a 2020 2020 2020 2020 2020 2020  ed".            
-00038b80: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00038b90: 6e74 6564 4572 726f 7228 6d73 6729 0a20  ntedError(msg). 
-00038ba0: 2020 2020 2020 2023 2046 6f72 2062 726f         # For bro
-00038bb0: 6164 6361 7374 6162 6c65 2073 6572 6965  adcastable serie
-00038bc0: 732c 2075 7365 206e 6f20 726f 7773 2e0a  s, use no rows..
-00038bd0: 2020 2020 2020 2020 7061 7274 7320 3d20          parts = 
-00038be0: 5b0a 2020 2020 2020 2020 2020 2020 642e  [.            d.
-00038bf0: 5f6d 6574 610a 2020 2020 2020 2020 2020  _meta.          
-00038c00: 2020 6966 205f 6973 5f62 726f 6164 6361    if _is_broadca
-00038c10: 7374 6162 6c65 2864 290a 2020 2020 2020  stable(d).      
-00038c20: 2020 2020 2020 656c 7365 206e 702e 656d        else np.em
-00038c30: 7074 7928 2829 2c20 6474 7970 653d 642e  pty((), dtype=d.
-00038c40: 6474 7970 6529 0a20 2020 2020 2020 2020  dtype).         
-00038c50: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00038c60: 2864 2c20 4172 7261 7929 0a20 2020 2020  (d, Array).     
-00038c70: 2020 2020 2020 2065 6c73 6520 642e 5f6d         else d._m
-00038c80: 6574 615f 6e6f 6e65 6d70 7479 0a20 2020  eta_nonempty.   
-00038c90: 2020 2020 2020 2020 2066 6f72 2064 2069           for d i
-00038ca0: 6e20 6461 736b 730a 2020 2020 2020 2020  n dasks.        
-00038cb0: 5d0a 2020 2020 2020 2020 7769 7468 2072  ].        with r
-00038cc0: 6169 7365 5f6f 6e5f 6d65 7461 5f65 7272  aise_on_meta_err
-00038cd0: 6f72 2866 756e 636e 616d 6528 6f70 2929  or(funcname(op))
-00038ce0: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
-00038cf0: 7461 203d 2070 6172 7469 616c 5f62 795f  ta = partial_by_
-00038d00: 6f72 6465 7228 2a70 6172 7473 2c20 6675  order(*parts, fu
-00038d10: 6e63 7469 6f6e 3d6f 702c 206f 7468 6572  nction=op, other
-00038d20: 3d6f 7468 6572 290a 0a20 2020 2072 6573  =other)..    res
-00038d30: 756c 7420 3d20 6e65 775f 6464 5f6f 626a  ult = new_dd_obj
-00038d40: 6563 7428 6772 6170 682c 205f 6e61 6d65  ect(graph, _name
-00038d50: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
-00038d60: 7329 0a20 2020 2072 6574 7572 6e20 6861  s).    return ha
-00038d70: 6e64 6c65 5f6f 7574 286f 7574 2c20 7265  ndle_out(out, re
-00038d80: 7375 6c74 290a 0a0a 6465 6620 6861 6e64  sult)...def hand
-00038d90: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
-00038da0: 6c74 293a 0a20 2020 2022 2222 4861 6e64  lt):.    """Hand
-00038db0: 6c65 206f 7574 2070 6172 616d 6574 6572  le out parameter
-00038dc0: 730a 0a20 2020 2049 6620 6f75 7420 6973  s..    If out is
-00038dd0: 2061 2064 6173 6b2e 4461 7461 4672 616d   a dask.DataFram
-00038de0: 652c 2064 6173 6b2e 5365 7269 6573 206f  e, dask.Series o
-00038df0: 7220 6461 736b 2e53 6361 6c61 7220 7468  r dask.Scalar th
-00038e00: 656e 0a20 2020 2074 6869 7320 6f76 6572  en.    this over
-00038e10: 7772 6974 6573 2074 6865 2063 6f6e 7465  writes the conte
-00038e20: 6e74 7320 6f66 2069 7420 7769 7468 2074  nts of it with t
-00038e30: 6865 2072 6573 756c 740a 2020 2020 2222  he result.    ""
-00038e40: 220a 2020 2020 6966 2069 7369 6e73 7461  ".    if isinsta
-00038e50: 6e63 6528 6f75 742c 2074 7570 6c65 293a  nce(out, tuple):
-00038e60: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-00038e70: 6f75 7429 203d 3d20 313a 0a20 2020 2020  out) == 1:.     
-00038e80: 2020 2020 2020 206f 7574 203d 206f 7574         out = out
-00038e90: 5b30 5d0a 2020 2020 2020 2020 656c 6966  [0].        elif
-00038ea0: 206c 656e 286f 7574 2920 3e20 313a 0a20   len(out) > 1:. 
-00038eb0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00038ec0: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-00038ed0: 7272 6f72 2822 5468 6520 6f75 7420 7061  rror("The out pa
-00038ee0: 7261 6d65 7465 7220 6973 206e 6f74 2066  rameter is not f
-00038ef0: 756c 6c79 2073 7570 706f 7274 6564 2229  ully supported")
-00038f00: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00038f10: 2020 2020 2020 2020 2020 206f 7574 203d             out =
-00038f20: 204e 6f6e 650a 0a20 2020 2023 204e 6f74   None..    # Not
-00038f30: 6963 652c 2077 6520 7573 6520 2e5f 5f63  ice, we use .__c
-00038f40: 6c61 7373 5f5f 2061 7320 6f70 706f 7365  lass__ as oppose
-00038f50: 6420 746f 2074 7970 6528 2920 696e 206f  d to type() in o
-00038f60: 7264 6572 2074 6f20 7375 7070 6f72 740a  rder to support.
-00038f70: 2020 2020 2320 6f62 6a65 6374 2070 726f      # object pro
-00038f80: 7869 6573 2073 6565 203c 6874 7470 733a  xies see <https:
-00038f90: 2f2f 6769 7468 7562 2e63 6f6d 2f64 6173  //github.com/das
-00038fa0: 6b2f 6461 736b 2f70 756c 6c2f 3639 3831  k/dask/pull/6981
-00038fb0: 3e0a 2020 2020 6966 206f 7574 2069 7320  >.    if out is 
-00038fc0: 6e6f 7420 4e6f 6e65 2061 6e64 206f 7574  not None and out
-00038fd0: 2e5f 5f63 6c61 7373 5f5f 2021 3d20 7265  .__class__ != re
-00038fe0: 7375 6c74 2e5f 5f63 6c61 7373 5f5f 3a0a  sult.__class__:.
-00038ff0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00039000: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
-00039010: 2020 2020 2022 4d69 736d 6174 6368 6564       "Mismatched
-00039020: 2074 7970 6573 2062 6574 7765 656e 2072   types between r
-00039030: 6573 756c 7420 616e 6420 6f75 7420 7061  esult and out pa
-00039040: 7261 6d65 7465 722e 2022 0a20 2020 2020  rameter. ".     
-00039050: 2020 2020 2020 2022 6f75 743d 2573 2c20         "out=%s, 
-00039060: 7265 7375 6c74 3d25 7322 2025 2028 7374  result=%s" % (st
-00039070: 7228 7479 7065 286f 7574 2929 2c20 7374  r(type(out)), st
-00039080: 7228 7479 7065 2872 6573 756c 7429 2929  r(type(result)))
-00039090: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000390a0: 6966 2069 7369 6e73 7461 6e63 6528 6f75  if isinstance(ou
-000390b0: 742c 2044 6174 6146 7261 6d65 293a 0a20  t, DataFrame):. 
-000390c0: 2020 2020 2020 2069 6620 6c65 6e28 6f75         if len(ou
-000390d0: 742e 636f 6c75 6d6e 7329 2021 3d20 6c65  t.columns) != le
-000390e0: 6e28 7265 7375 6c74 2e63 6f6c 756d 6e73  n(result.columns
-000390f0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00039100: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00039110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00039120: 2022 4d69 736d 6174 6368 6564 2063 6f6c   "Mismatched col
-00039130: 756d 6e73 2063 6f75 6e74 2062 6574 7765  umns count betwe
-00039140: 656e 2072 6573 756c 7420 616e 6420 6f75  en result and ou
-00039150: 7420 7061 7261 6d65 7465 722e 2022 0a20  t parameter. ". 
-00039160: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00039170: 6f75 743d 2573 2c20 7265 7375 6c74 3d25  out=%s, result=%
-00039180: 7322 2025 2028 7374 7228 6c65 6e28 6f75  s" % (str(len(ou
-00039190: 742e 636f 6c75 6d6e 7329 292c 2073 7472  t.columns)), str
-000391a0: 286c 656e 2872 6573 756c 742e 636f 6c75  (len(result.colu
-000391b0: 6d6e 7329 2929 0a20 2020 2020 2020 2020  mns))).         
-000391c0: 2020 2029 0a0a 2020 2020 6966 2069 7369     )..    if isi
-000391d0: 6e73 7461 6e63 6528 6f75 742c 2028 5365  nstance(out, (Se
-000391e0: 7269 6573 2c20 4461 7461 4672 616d 652c  ries, DataFrame,
-000391f0: 2053 6361 6c61 7229 293a 0a20 2020 2020   Scalar)):.     
-00039200: 2020 206f 7574 2e5f 6d65 7461 203d 2072     out._meta = r
-00039210: 6573 756c 742e 5f6d 6574 610a 2020 2020  esult._meta.    
-00039220: 2020 2020 6f75 742e 5f6e 616d 6520 3d20      out._name = 
-00039230: 7265 7375 6c74 2e5f 6e61 6d65 0a20 2020  result._name.   
-00039240: 2020 2020 206f 7574 2e64 6173 6b20 3d20       out.dask = 
-00039250: 7265 7375 6c74 2e64 6173 6b0a 0a20 2020  result.dask..   
-00039260: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00039270: 7374 616e 6365 286f 7574 2c20 5363 616c  stance(out, Scal
-00039280: 6172 293a 0a20 2020 2020 2020 2020 2020  ar):.           
-00039290: 206f 7574 2e5f 6469 7669 7369 6f6e 7320   out._divisions 
-000392a0: 3d20 7265 7375 6c74 2e64 6976 6973 696f  = result.divisio
-000392b0: 6e73 0a20 2020 2065 6c69 6620 6f75 7420  ns.    elif out 
-000392c0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-000392d0: 2020 2020 206d 7367 203d 2028 0a20 2020       msg = (.   
-000392e0: 2020 2020 2020 2020 2022 5468 6520 6f75           "The ou
-000392f0: 7420 7061 7261 6d65 7465 7220 6973 206e  t parameter is n
-00039300: 6f74 2066 756c 6c79 2073 7570 706f 7274  ot fully support
-00039310: 6564 2e22 0a20 2020 2020 2020 2020 2020  ed.".           
-00039320: 2022 2052 6563 6569 7665 6420 7479 7065   " Received type
-00039330: 2025 732c 2065 7870 6563 7465 6420 2573   %s, expected %s
-00039340: 2022 0a20 2020 2020 2020 2020 2020 2025   ".            %
-00039350: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00039360: 2020 2074 7970 656e 616d 6528 7479 7065     typename(type
-00039370: 286f 7574 2929 2c0a 2020 2020 2020 2020  (out)),.        
-00039380: 2020 2020 2020 2020 7479 7065 6e61 6d65          typename
-00039390: 2874 7970 6528 7265 7375 6c74 2929 2c0a  (type(result)),.
-000393a0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000393b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000393c0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-000393d0: 6e74 6564 4572 726f 7228 6d73 6729 0a20  ntedError(msg). 
-000393e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000393f0: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
-00039400: 0a64 6566 205f 6d61 7962 655f 6672 6f6d  .def _maybe_from
-00039410: 5f70 616e 6461 7328 6466 7329 3a0a 2020  _pandas(dfs):.  
-00039420: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
-00039430: 6672 616d 652e 696f 2069 6d70 6f72 7420  frame.io import 
-00039440: 6672 6f6d 5f70 616e 6461 730a 0a20 2020  from_pandas..   
-00039450: 2064 6673 203d 205b 0a20 2020 2020 2020   dfs = [.       
-00039460: 2066 726f 6d5f 7061 6e64 6173 2864 662c   from_pandas(df,
-00039470: 2031 290a 2020 2020 2020 2020 6966 2028   1).        if (
-00039480: 6973 5f73 6572 6965 735f 6c69 6b65 2864  is_series_like(d
-00039490: 6629 206f 7220 6973 5f64 6174 6166 7261  f) or is_datafra
-000394a0: 6d65 5f6c 696b 6528 6466 2929 2061 6e64  me_like(df)) and
-000394b0: 206e 6f74 2069 735f 6461 736b 5f63 6f6c   not is_dask_col
-000394c0: 6c65 6374 696f 6e28 6466 290a 2020 2020  lection(df).    
-000394d0: 2020 2020 656c 7365 2064 660a 2020 2020      else df.    
-000394e0: 2020 2020 666f 7220 6466 2069 6e20 6466      for df in df
-000394f0: 730a 2020 2020 5d0a 2020 2020 7265 7475  s.    ].    retu
-00039500: 726e 2064 6673 0a0a 0a64 6566 2068 6173  rn dfs...def has
-00039510: 685f 7368 6172 6428 0a20 2020 2064 662c  h_shard(.    df,
-00039520: 206e 7061 7274 732c 2073 706c 6974 5f6f   nparts, split_o
-00039530: 7574 5f73 6574 7570 3d4e 6f6e 652c 2073  ut_setup=None, s
-00039540: 706c 6974 5f6f 7574 5f73 6574 7570 5f6b  plit_out_setup_k
-00039550: 7761 7267 733d 4e6f 6e65 2c20 6967 6e6f  wargs=None, igno
-00039560: 7265 5f69 6e64 6578 3d46 616c 7365 0a29  re_index=False.)
-00039570: 3a0a 2020 2020 6966 2073 706c 6974 5f6f  :.    if split_o
-00039580: 7574 5f73 6574 7570 3a0a 2020 2020 2020  ut_setup:.      
-00039590: 2020 6820 3d20 7370 6c69 745f 6f75 745f    h = split_out_
-000395a0: 7365 7475 7028 6466 2c20 2a2a 2873 706c  setup(df, **(spl
-000395b0: 6974 5f6f 7574 5f73 6574 7570 5f6b 7761  it_out_setup_kwa
-000395c0: 7267 7320 6f72 207b 7d29 290a 2020 2020  rgs or {})).    
-000395d0: 656c 7365 3a0a 2020 2020 2020 2020 6820  else:.        h 
-000395e0: 3d20 6466 0a0a 2020 2020 6820 3d20 6861  = df..    h = ha
-000395f0: 7368 5f6f 626a 6563 745f 6469 7370 6174  sh_object_dispat
-00039600: 6368 2868 2c20 696e 6465 783d 4661 6c73  ch(h, index=Fals
-00039610: 6529 0a20 2020 2072 6574 7572 6e20 6772  e).    return gr
-00039620: 6f75 705f 7370 6c69 745f 6469 7370 6174  oup_split_dispat
-00039630: 6368 2864 662c 2068 2025 206e 7061 7274  ch(df, h % npart
-00039640: 732c 206e 7061 7274 732c 2069 676e 6f72  s, nparts, ignor
-00039650: 655f 696e 6465 783d 6967 6e6f 7265 5f69  e_index=ignore_i
-00039660: 6e64 6578 290a 0a0a 6465 6620 7370 6c69  ndex)...def spli
-00039670: 745f 6576 656e 6c79 2864 662c 206b 293a  t_evenly(df, k):
-00039680: 0a20 2020 2022 2222 5370 6c69 7420 6461  .    """Split da
-00039690: 7461 6672 616d 6520 696e 746f 206b 2072  taframe into k r
-000396a0: 6f75 6768 6c79 2065 7175 616c 2070 6172  oughly equal par
-000396b0: 7473 2222 220a 2020 2020 6469 7669 7369  ts""".    divisi
-000396c0: 6f6e 7320 3d20 6e70 2e6c 696e 7370 6163  ons = np.linspac
-000396d0: 6528 302c 206c 656e 2864 6629 2c20 6b20  e(0, len(df), k 
-000396e0: 2b20 3129 2e61 7374 7970 6528 696e 7429  + 1).astype(int)
-000396f0: 0a20 2020 2072 6574 7572 6e20 7b69 3a20  .    return {i: 
-00039700: 6466 2e69 6c6f 635b 6469 7669 7369 6f6e  df.iloc[division
-00039710: 735b 695d 203a 2064 6976 6973 696f 6e73  s[i] : divisions
-00039720: 5b69 202b 2031 5d5d 2066 6f72 2069 2069  [i + 1]] for i i
-00039730: 6e20 7261 6e67 6528 6b29 7d0a 0a0a 6465  n range(k)}...de
-00039740: 6620 7370 6c69 745f 6f75 745f 6f6e 5f69  f split_out_on_i
-00039750: 6e64 6578 2864 6629 3a0a 2020 2020 6820  ndex(df):.    h 
-00039760: 3d20 6466 2e69 6e64 6578 0a20 2020 2069  = df.index.    i
-00039770: 6620 6973 696e 7374 616e 6365 2868 2c20  f isinstance(h, 
-00039780: 7064 2e4d 756c 7469 496e 6465 7829 3a0a  pd.MultiIndex):.
-00039790: 2020 2020 2020 2020 6820 3d20 6d65 7461          h = meta
-000397a0: 5f66 7261 6d65 5f63 6f6e 7374 7275 6374  _frame_construct
-000397b0: 6f72 2864 6629 285b 5d2c 2069 6e64 6578  or(df)([], index
-000397c0: 3d68 292e 7265 7365 745f 696e 6465 7828  =h).reset_index(
-000397d0: 290a 2020 2020 7265 7475 726e 2068 0a0a  ).    return h..
-000397e0: 0a64 6566 2073 706c 6974 5f6f 7574 5f6f  .def split_out_o
-000397f0: 6e5f 636f 6c73 2864 662c 2063 6f6c 733d  n_cols(df, cols=
-00039800: 4e6f 6e65 293a 0a20 2020 2072 6574 7572  None):.    retur
-00039810: 6e20 6466 5b63 6f6c 735d 0a0a 0a40 696e  n df[cols]...@in
-00039820: 7365 7274 5f6d 6574 615f 7061 7261 6d5f  sert_meta_param_
-00039830: 6465 7363 7269 7074 696f 6e0a 6465 6620  description.def 
-00039840: 6170 706c 795f 636f 6e63 6174 5f61 7070  apply_concat_app
-00039850: 6c79 280a 2020 2020 6172 6773 2c0a 2020  ly(.    args,.  
-00039860: 2020 6368 756e 6b3d 4e6f 6e65 2c0a 2020    chunk=None,.  
-00039870: 2020 6167 6772 6567 6174 653d 4e6f 6e65    aggregate=None
-00039880: 2c0a 2020 2020 636f 6d62 696e 653d 4e6f  ,.    combine=No
-00039890: 6e65 2c0a 2020 2020 6d65 7461 3d6e 6f5f  ne,.    meta=no_
-000398a0: 6465 6661 756c 742c 0a20 2020 2074 6f6b  default,.    tok
-000398b0: 656e 3d4e 6f6e 652c 0a20 2020 2063 6875  en=None,.    chu
-000398c0: 6e6b 5f6b 7761 7267 733d 4e6f 6e65 2c0a  nk_kwargs=None,.
-000398d0: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
-000398e0: 6172 6773 3d4e 6f6e 652c 0a20 2020 2063  args=None,.    c
-000398f0: 6f6d 6269 6e65 5f6b 7761 7267 733d 4e6f  ombine_kwargs=No
-00039900: 6e65 2c0a 2020 2020 7370 6c69 745f 6576  ne,.    split_ev
-00039910: 6572 793d 4e6f 6e65 2c0a 2020 2020 7370  ery=None,.    sp
-00039920: 6c69 745f 6f75 743d 4e6f 6e65 2c0a 2020  lit_out=None,.  
-00039930: 2020 7370 6c69 745f 6f75 745f 7365 7475    split_out_setu
-00039940: 703d 4e6f 6e65 2c0a 2020 2020 7370 6c69  p=None,.    spli
-00039950: 745f 6f75 745f 7365 7475 705f 6b77 6172  t_out_setup_kwar
-00039960: 6773 3d4e 6f6e 652c 0a20 2020 2073 6f72  gs=None,.    sor
-00039970: 743d 4e6f 6e65 2c0a 2020 2020 6967 6e6f  t=None,.    igno
-00039980: 7265 5f69 6e64 6578 3d46 616c 7365 2c0a  re_index=False,.
-00039990: 2020 2020 2a2a 6b77 6172 6773 2c0a 293a      **kwargs,.):
-000399a0: 0a20 2020 2022 2222 4170 706c 7920 6120  .    """Apply a 
-000399b0: 6675 6e63 7469 6f6e 2074 6f20 626c 6f63  function to bloc
-000399c0: 6b73 2c20 7468 656e 2063 6f6e 6361 742c  ks, then concat,
-000399d0: 2074 6865 6e20 6170 706c 7920 6167 6169   then apply agai
-000399e0: 6e0a 0a20 2020 2050 6172 616d 6574 6572  n..    Parameter
-000399f0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00039a00: 0a20 2020 2061 7267 7320 3a0a 2020 2020  .    args :.    
-00039a10: 2020 2020 506f 7369 7469 6f6e 616c 2061      Positional a
-00039a20: 7267 756d 656e 7473 2066 6f72 2074 6865  rguments for the
-00039a30: 2060 6368 756e 6b60 2066 756e 6374 696f   `chunk` functio
-00039a40: 6e2e 2041 6c6c 2060 6461 736b 2e64 6174  n. All `dask.dat
-00039a50: 6166 7261 6d65 600a 2020 2020 2020 2020  aframe`.        
-00039a60: 6f62 6a65 6374 7320 7368 6f75 6c64 2062  objects should b
-00039a70: 6520 7061 7274 6974 696f 6e65 6420 616e  e partitioned an
-00039a80: 6420 696e 6465 7865 6420 6571 7569 7661  d indexed equiva
-00039a90: 6c65 6e74 6c79 2e0a 2020 2020 6368 756e  lently..    chun
-00039aa0: 6b20 3a20 6675 6e63 7469 6f6e 205b 626c  k : function [bl
-00039ab0: 6f63 6b2d 7065 722d 6172 675d 202d 3e20  ock-per-arg] -> 
-00039ac0: 626c 6f63 6b0a 2020 2020 2020 2020 4675  block.        Fu
-00039ad0: 6e63 7469 6f6e 2074 6f20 6f70 6572 6174  nction to operat
-00039ae0: 6520 6f6e 2065 6163 6820 626c 6f63 6b20  e on each block 
-00039af0: 6f66 2064 6174 610a 2020 2020 6167 6772  of data.    aggr
-00039b00: 6567 6174 6520 3a20 6675 6e63 7469 6f6e  egate : function
-00039b10: 2063 6f6e 6361 7465 6e61 7465 642d 626c   concatenated-bl
-00039b20: 6f63 6b20 2d3e 2062 6c6f 636b 0a20 2020  ock -> block.   
-00039b30: 2020 2020 2046 756e 6374 696f 6e20 746f       Function to
-00039b40: 206f 7065 7261 7465 206f 6e20 7468 6520   operate on the 
-00039b50: 636f 6e63 6174 656e 6174 6564 2072 6573  concatenated res
-00039b60: 756c 7420 6f66 2063 6875 6e6b 0a20 2020  ult of chunk.   
-00039b70: 2063 6f6d 6269 6e65 203a 2066 756e 6374   combine : funct
-00039b80: 696f 6e20 636f 6e63 6174 656e 6174 6564  ion concatenated
-00039b90: 2d62 6c6f 636b 202d 3e20 626c 6f63 6b2c  -block -> block,
-00039ba0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00039bb0: 2020 4675 6e63 7469 6f6e 2074 6f20 6f70    Function to op
-00039bc0: 6572 6174 6520 6f6e 2069 6e74 6572 6d65  erate on interme
-00039bd0: 6469 6174 6520 636f 6e63 6174 656e 6174  diate concatenat
-00039be0: 6564 2072 6573 756c 7473 206f 6620 6368  ed results of ch
-00039bf0: 756e 6b0a 2020 2020 2020 2020 696e 2061  unk.        in a
-00039c00: 2074 7265 652d 7265 6475 6374 696f 6e2e   tree-reduction.
-00039c10: 2049 6620 6e6f 7420 7072 6f76 6964 6564   If not provided
-00039c20: 2c20 6465 6661 756c 7473 2074 6f20 6167  , defaults to ag
-00039c30: 6772 6567 6174 652e 0a20 2020 2024 4d45  gregate..    $ME
-00039c40: 5441 0a20 2020 2074 6f6b 656e 203a 2073  TA.    token : s
-00039c50: 7472 2c20 6f70 7469 6f6e 616c 0a20 2020  tr, optional.   
-00039c60: 2020 2020 2054 6865 206e 616d 6520 746f       The name to
-00039c70: 2075 7365 2066 6f72 2074 6865 206f 7574   use for the out
-00039c80: 7075 7420 6b65 7973 2e0a 2020 2020 6368  put keys..    ch
-00039c90: 756e 6b5f 6b77 6172 6773 203a 2064 6963  unk_kwargs : dic
-00039ca0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00039cb0: 2020 2020 4b65 7977 6f72 6473 2066 6f72      Keywords for
-00039cc0: 2074 6865 2063 6875 6e6b 2066 756e 6374   the chunk funct
-00039cd0: 696f 6e20 6f6e 6c79 2e0a 2020 2020 6167  ion only..    ag
-00039ce0: 6772 6567 6174 655f 6b77 6172 6773 203a  gregate_kwargs :
-00039cf0: 2064 6963 742c 206f 7074 696f 6e61 6c0a   dict, optional.
-00039d00: 2020 2020 2020 2020 4b65 7977 6f72 6473          Keywords
-00039d10: 2066 6f72 2074 6865 2061 6767 7265 6761   for the aggrega
-00039d20: 7465 2066 756e 6374 696f 6e20 6f6e 6c79  te function only
-00039d30: 2e0a 2020 2020 636f 6d62 696e 655f 6b77  ..    combine_kw
-00039d40: 6172 6773 203a 2064 6963 742c 206f 7074  args : dict, opt
-00039d50: 696f 6e61 6c0a 2020 2020 2020 2020 4b65  ional.        Ke
-00039d60: 7977 6f72 6473 2066 6f72 2074 6865 2063  ywords for the c
-00039d70: 6f6d 6269 6e65 2066 756e 6374 696f 6e20  ombine function 
-00039d80: 6f6e 6c79 2e0a 2020 2020 7370 6c69 745f  only..    split_
-00039d90: 6576 6572 7920 3a20 696e 742c 206f 7074  every : int, opt
-00039da0: 696f 6e61 6c0a 2020 2020 2020 2020 4772  ional.        Gr
-00039db0: 6f75 7020 7061 7274 6974 696f 6e73 2069  oup partitions i
-00039dc0: 6e74 6f20 6772 6f75 7073 206f 6620 7468  nto groups of th
-00039dd0: 6973 2073 697a 6520 7768 696c 6520 7065  is size while pe
-00039de0: 7266 6f72 6d69 6e67 2061 0a20 2020 2020  rforming a.     
-00039df0: 2020 2074 7265 652d 7265 6475 6374 696f     tree-reductio
-00039e00: 6e2e 2049 6620 7365 7420 746f 2046 616c  n. If set to Fal
-00039e10: 7365 2c20 6e6f 2074 7265 652d 7265 6475  se, no tree-redu
-00039e20: 6374 696f 6e20 7769 6c6c 2062 6520 7573  ction will be us
-00039e30: 6564 2c0a 2020 2020 2020 2020 616e 6420  ed,.        and 
-00039e40: 616c 6c20 696e 7465 726d 6564 6961 7465  all intermediate
-00039e50: 7320 7769 6c6c 2062 6520 636f 6e63 6174  s will be concat
-00039e60: 656e 6174 6564 2061 6e64 2070 6173 7365  enated and passe
-00039e70: 6420 746f 2060 6061 6767 7265 6761 7465  d to ``aggregate
-00039e80: 6060 2e0a 2020 2020 2020 2020 4465 6661  ``..        Defa
-00039e90: 756c 7420 6973 2038 2e0a 2020 2020 7370  ult is 8..    sp
-00039ea0: 6c69 745f 6f75 7420 3a20 696e 742c 206f  lit_out : int, o
-00039eb0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00039ec0: 4e75 6d62 6572 206f 6620 6f75 7470 7574  Number of output
-00039ed0: 2070 6172 7469 7469 6f6e 732e 2053 706c   partitions. Spl
-00039ee0: 6974 206f 6363 7572 7320 6166 7465 7220  it occurs after 
-00039ef0: 6669 7273 7420 6368 756e 6b20 7265 6475  first chunk redu
-00039f00: 6374 696f 6e2e 0a20 2020 2073 706c 6974  ction..    split
-00039f10: 5f6f 7574 5f73 6574 7570 203a 2063 616c  _out_setup : cal
-00039f20: 6c61 626c 652c 206f 7074 696f 6e61 6c0a  lable, optional.
-00039f30: 2020 2020 2020 2020 4966 2070 726f 7669          If provi
-00039f40: 6465 642c 2074 6869 7320 6675 6e63 7469  ded, this functi
-00039f50: 6f6e 2069 7320 6361 6c6c 6564 206f 6e20  on is called on 
-00039f60: 6561 6368 2063 6875 6e6b 2062 6566 6f72  each chunk befor
-00039f70: 6520 7065 7266 6f72 6d69 6e67 0a20 2020  e performing.   
-00039f80: 2020 2020 2074 6865 2068 6173 682d 7370       the hash-sp
-00039f90: 6c69 742e 2049 7420 7368 6f75 6c64 2072  lit. It should r
-00039fa0: 6574 7572 6e20 6120 7061 6e64 6173 206f  eturn a pandas o
-00039fb0: 626a 6563 742c 2077 6865 7265 2065 6163  bject, where eac
-00039fc0: 6820 726f 770a 2020 2020 2020 2020 2865  h row.        (e
-00039fd0: 7863 6c75 6469 6e67 2074 6865 2069 6e64  xcluding the ind
-00039fe0: 6578 2920 6973 2068 6173 6865 642e 2049  ex) is hashed. I
-00039ff0: 6620 6e6f 7420 7072 6f76 6964 6564 2c20  f not provided, 
-0003a000: 7468 6520 6368 756e 6b20 6973 2068 6173  the chunk is has
-0003a010: 6865 640a 2020 2020 2020 2020 6173 2069  hed.        as i
-0003a020: 732e 0a20 2020 2073 706c 6974 5f6f 7574  s..    split_out
-0003a030: 5f73 6574 7570 5f6b 7761 7267 7320 3a20  _setup_kwargs : 
-0003a040: 6469 6374 2c20 6f70 7469 6f6e 616c 0a20  dict, optional. 
-0003a050: 2020 2020 2020 204b 6579 776f 7264 7320         Keywords 
-0003a060: 666f 7220 7468 6520 6073 706c 6974 5f6f  for the `split_o
-0003a070: 7574 5f73 6574 7570 6020 6675 6e63 7469  ut_setup` functi
-0003a080: 6f6e 206f 6e6c 792e 0a20 2020 2073 6f72  on only..    sor
-0003a090: 7420 3a20 626f 6f6c 2c20 6465 6661 756c  t : bool, defaul
-0003a0a0: 7420 4e6f 6e65 0a20 2020 2020 2020 2049  t None.        I
-0003a0b0: 6620 616c 6c6f 7765 642c 2073 6f72 7420  f allowed, sort 
-0003a0c0: 7468 6520 6b65 7973 206f 6620 7468 6520  the keys of the 
-0003a0d0: 6f75 7470 7574 2061 6767 7265 6761 7469  output aggregati
-0003a0e0: 6f6e 2e0a 2020 2020 6967 6e6f 7265 5f69  on..    ignore_i
-0003a0f0: 6e64 6578 203a 2062 6f6f 6c2c 2064 6566  ndex : bool, def
-0003a100: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
-0003a110: 2020 2049 6620 5472 7565 2c20 646f 206e     If True, do n
-0003a120: 6f74 2070 7265 7365 7276 6520 696e 6465  ot preserve inde
-0003a130: 7820 7661 6c75 6573 2074 6872 6f75 6768  x values through
-0003a140: 6f75 7420 4143 4120 6f70 6572 6174 696f  out ACA operatio
-0003a150: 6e73 2e0a 2020 2020 6b77 6172 6773 203a  ns..    kwargs :
-0003a160: 0a20 2020 2020 2020 2041 6c6c 2072 656d  .        All rem
-0003a170: 6169 6e69 6e67 206b 6579 776f 7264 7320  aining keywords 
-0003a180: 7769 6c6c 2062 6520 7061 7373 6564 2074  will be passed t
-0003a190: 6f20 6060 6368 756e 6b60 602c 2060 6061  o ``chunk``, ``a
-0003a1a0: 6767 7265 6761 7465 6060 2c20 616e 640a  ggregate``, and.
-0003a1b0: 2020 2020 2020 2020 6060 636f 6d62 696e          ``combin
-0003a1c0: 6560 602e 0a0a 2020 2020 4578 616d 706c  e``...    Exampl
-0003a1d0: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
-0003a1e0: 2020 2020 3e3e 3e20 6465 6620 6368 756e      >>> def chun
-0003a1f0: 6b28 615f 626c 6f63 6b2c 2062 5f62 6c6f  k(a_block, b_blo
-0003a200: 636b 293a 0a20 2020 202e 2e2e 2020 2020  ck):.    ...    
-0003a210: 2070 6173 730a 0a20 2020 203e 3e3e 2064   pass..    >>> d
-0003a220: 6566 2061 6767 2864 6629 3a0a 2020 2020  ef agg(df):.    
-0003a230: 2e2e 2e20 2020 2020 7061 7373 0a0a 2020  ...     pass..  
-0003a240: 2020 3e3e 3e20 6170 706c 795f 636f 6e63    >>> apply_conc
-0003a250: 6174 5f61 7070 6c79 285b 612c 2062 5d2c  at_apply([a, b],
-0003a260: 2063 6875 6e6b 3d63 6875 6e6b 2c20 6167   chunk=chunk, ag
-0003a270: 6772 6567 6174 653d 6167 6729 2020 2320  gregate=agg)  # 
-0003a280: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0003a290: 2020 2022 2222 0a20 2020 2069 6620 7370     """.    if sp
-0003a2a0: 6c69 745f 6f75 7420 6973 204e 6f6e 653a  lit_out is None:
-0003a2b0: 0a20 2020 2020 2020 2073 706c 6974 5f6f  .        split_o
-0003a2c0: 7574 203d 2031 0a20 2020 2069 6620 6368  ut = 1.    if ch
-0003a2d0: 756e 6b5f 6b77 6172 6773 2069 7320 4e6f  unk_kwargs is No
-0003a2e0: 6e65 3a0a 2020 2020 2020 2020 6368 756e  ne:.        chun
-0003a2f0: 6b5f 6b77 6172 6773 203d 2064 6963 7428  k_kwargs = dict(
-0003a300: 290a 2020 2020 6966 2061 6767 7265 6761  ).    if aggrega
-0003a310: 7465 5f6b 7761 7267 7320 6973 204e 6f6e  te_kwargs is Non
-0003a320: 653a 0a20 2020 2020 2020 2061 6767 7265  e:.        aggre
-0003a330: 6761 7465 5f6b 7761 7267 7320 3d20 6469  gate_kwargs = di
-0003a340: 6374 2829 0a20 2020 2063 6875 6e6b 5f6b  ct().    chunk_k
-0003a350: 7761 7267 732e 7570 6461 7465 286b 7761  wargs.update(kwa
-0003a360: 7267 7329 0a20 2020 2061 6767 7265 6761  rgs).    aggrega
-0003a370: 7465 5f6b 7761 7267 732e 7570 6461 7465  te_kwargs.update
-0003a380: 286b 7761 7267 7329 0a0a 2020 2020 6966  (kwargs)..    if
-0003a390: 2063 6f6d 6269 6e65 2069 7320 4e6f 6e65   combine is None
-0003a3a0: 3a0a 2020 2020 2020 2020 6966 2063 6f6d  :.        if com
-0003a3b0: 6269 6e65 5f6b 7761 7267 733a 0a20 2020  bine_kwargs:.   
-0003a3c0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0003a3d0: 616c 7565 4572 726f 7228 2260 636f 6d62  alueError("`comb
-0003a3e0: 696e 655f 6b77 6172 6773 6020 7072 6f76  ine_kwargs` prov
-0003a3f0: 6964 6564 2077 6974 6820 6e6f 2060 636f  ided with no `co
-0003a400: 6d62 696e 6560 2229 0a20 2020 2020 2020  mbine`").       
-0003a410: 2063 6f6d 6269 6e65 203d 2061 6767 7265   combine = aggre
-0003a420: 6761 7465 0a20 2020 2020 2020 2063 6f6d  gate.        com
-0003a430: 6269 6e65 5f6b 7761 7267 7320 3d20 6167  bine_kwargs = ag
-0003a440: 6772 6567 6174 655f 6b77 6172 6773 0a20  gregate_kwargs. 
-0003a450: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0003a460: 2069 6620 636f 6d62 696e 655f 6b77 6172   if combine_kwar
-0003a470: 6773 2069 7320 4e6f 6e65 3a0a 2020 2020  gs is None:.    
-0003a480: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
-0003a490: 6b77 6172 6773 203d 2064 6963 7428 290a  kwargs = dict().
-0003a4a0: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
-0003a4b0: 6b77 6172 6773 2e75 7064 6174 6528 6b77  kwargs.update(kw
-0003a4c0: 6172 6773 290a 0a20 2020 2069 6620 6e6f  args)..    if no
-0003a4d0: 7420 6973 696e 7374 616e 6365 2861 7267  t isinstance(arg
-0003a4e0: 732c 2028 7475 706c 652c 206c 6973 7429  s, (tuple, list)
-0003a4f0: 293a 0a20 2020 2020 2020 2061 7267 7320  ):.        args 
-0003a500: 3d20 5b61 7267 735d 0a0a 2020 2020 6466  = [args]..    df
-0003a510: 7320 3d20 5b61 7267 2066 6f72 2061 7267  s = [arg for arg
-0003a520: 2069 6e20 6172 6773 2069 6620 6973 696e   in args if isin
-0003a530: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
-0003a540: 6d65 295d 0a0a 2020 2020 6e70 6172 7469  me)]..    nparti
-0003a550: 7469 6f6e 7320 3d20 7b61 7267 2e6e 7061  tions = {arg.npa
-0003a560: 7274 6974 696f 6e73 2066 6f72 2061 7267  rtitions for arg
-0003a570: 2069 6e20 6466 737d 0a20 2020 2069 6620   in dfs}.    if 
-0003a580: 6c65 6e28 6e70 6172 7469 7469 6f6e 7329  len(npartitions)
-0003a590: 203e 2031 3a0a 2020 2020 2020 2020 7261   > 1:.        ra
-0003a5a0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-0003a5b0: 416c 6c20 6172 6775 6d65 6e74 7320 6d75  All arguments mu
-0003a5c0: 7374 2068 6176 6520 7361 6d65 206e 756d  st have same num
-0003a5d0: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
-0003a5e0: 7322 290a 2020 2020 6e70 6172 7469 7469  s").    npartiti
-0003a5f0: 6f6e 7320 3d20 6e70 6172 7469 7469 6f6e  ons = npartition
-0003a600: 732e 706f 7028 290a 0a20 2020 2069 6620  s.pop()..    if 
-0003a610: 7370 6c69 745f 6576 6572 7920 6973 204e  split_every is N
-0003a620: 6f6e 653a 0a20 2020 2020 2020 2073 706c  one:.        spl
-0003a630: 6974 5f65 7665 7279 203d 2038 0a20 2020  it_every = 8.   
-0003a640: 2065 6c69 6620 7370 6c69 745f 6576 6572   elif split_ever
-0003a650: 7920 6973 2046 616c 7365 3a0a 2020 2020  y is False:.    
-0003a660: 2020 2020 7370 6c69 745f 6576 6572 7920      split_every 
-0003a670: 3d20 6e70 6172 7469 7469 6f6e 730a 2020  = npartitions.  
-0003a680: 2020 656c 6966 2073 706c 6974 5f65 7665    elif split_eve
-0003a690: 7279 203c 2032 206f 7220 6e6f 7420 6973  ry < 2 or not is
-0003a6a0: 696e 7374 616e 6365 2873 706c 6974 5f65  instance(split_e
-0003a6b0: 7665 7279 2c20 496e 7465 6772 616c 293a  very, Integral):
-0003a6c0: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
-0003a6d0: 616c 7565 4572 726f 7228 2273 706c 6974  alueError("split
-0003a6e0: 5f65 7665 7279 206d 7573 7420 6265 2061  _every must be a
-0003a6f0: 6e20 696e 7465 6765 7220 3e3d 2032 2229  n integer >= 2")
-0003a700: 0a0a 2020 2020 746f 6b65 6e5f 6b65 7920  ..    token_key 
-0003a710: 3d20 746f 6b65 6e69 7a65 280a 2020 2020  = tokenize(.    
-0003a720: 2020 2020 746f 6b65 6e20 6f72 2028 6368      token or (ch
-0003a730: 756e 6b2c 2061 6767 7265 6761 7465 292c  unk, aggregate),
-0003a740: 0a20 2020 2020 2020 206d 6574 612c 0a20  .        meta,. 
-0003a750: 2020 2020 2020 2061 7267 732c 0a20 2020         args,.   
-0003a760: 2020 2020 2063 6875 6e6b 5f6b 7761 7267       chunk_kwarg
-0003a770: 732c 0a20 2020 2020 2020 2061 6767 7265  s,.        aggre
-0003a780: 6761 7465 5f6b 7761 7267 732c 0a20 2020  gate_kwargs,.   
-0003a790: 2020 2020 2063 6f6d 6269 6e65 5f6b 7761       combine_kwa
-0003a7a0: 7267 732c 0a20 2020 2020 2020 2073 706c  rgs,.        spl
-0003a7b0: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
-0003a7c0: 2020 7370 6c69 745f 6f75 742c 0a20 2020    split_out,.   
-0003a7d0: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
-0003a7e0: 6574 7570 2c0a 2020 2020 2020 2020 7370  etup,.        sp
-0003a7f0: 6c69 745f 6f75 745f 7365 7475 705f 6b77  lit_out_setup_kw
-0003a800: 6172 6773 2c0a 2020 2020 290a 0a20 2020  args,.    )..   
-0003a810: 2023 2042 6c6f 636b 7769 7365 2043 6875   # Blockwise Chu
-0003a820: 6e6b 204c 6179 6572 0a20 2020 2063 6875  nk Layer.    chu
-0003a830: 6e6b 5f6e 616d 6520 3d20 6622 7b74 6f6b  nk_name = f"{tok
-0003a840: 656e 206f 7220 6675 6e63 6e61 6d65 2863  en or funcname(c
-0003a850: 6875 6e6b 297d 2d63 6875 6e6b 2d7b 746f  hunk)}-chunk-{to
-0003a860: 6b65 6e5f 6b65 797d 220a 2020 2020 6368  ken_key}".    ch
-0003a870: 756e 6b65 6420 3d20 6d61 705f 6261 675f  unked = map_bag_
-0003a880: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-0003a890: 2020 2020 6368 756e 6b2c 0a20 2020 2020      chunk,.     
-0003a8a0: 2020 2023 2043 6f6e 7665 7274 205f 4672     # Convert _Fr
-0003a8b0: 616d 6520 636f 6c6c 6563 7469 6f6e 7320  ame collections 
-0003a8c0: 746f 2042 6167 0a20 2020 2020 2020 202a  to Bag.        *
-0003a8d0: 5b0a 2020 2020 2020 2020 2020 2020 6172  [.            ar
-0003a8e0: 672e 746f 5f62 6167 2866 6f72 6d61 743d  g.to_bag(format=
-0003a8f0: 2266 7261 6d65 2229 2069 6620 6973 696e  "frame") if isin
-0003a900: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
-0003a910: 6d65 2920 656c 7365 2061 7267 0a20 2020  me) else arg.   
-0003a920: 2020 2020 2020 2020 2066 6f72 2061 7267           for arg
-0003a930: 2069 6e20 6172 6773 0a20 2020 2020 2020   in args.       
-0003a940: 205d 2c0a 2020 2020 2020 2020 746f 6b65   ],.        toke
-0003a950: 6e3d 6368 756e 6b5f 6e61 6d65 2c0a 2020  n=chunk_name,.  
-0003a960: 2020 2020 2020 2a2a 6368 756e 6b5f 6b77        **chunk_kw
-0003a970: 6172 6773 2c0a 2020 2020 290a 0a20 2020  args,.    )..   
-0003a980: 2023 204e 4f54 453a 2060 6368 756e 6b65   # NOTE: `chunke
-0003a990: 6460 2069 7320 6e6f 7720 6120 4261 6720  d` is now a Bag 
-0003a9a0: 636f 6c6c 6563 7469 6f6e 2e0a 2020 2020  collection..    
-0003a9b0: 2320 5765 2064 6f6e 2774 2075 7365 2061  # We don't use a
-0003a9c0: 2044 6174 6146 7261 6d65 2063 6f6c 6c65   DataFrame colle
-0003a9d0: 6374 696f 6e2c 2062 6563 6175 7365 0a20  ction, because. 
-0003a9e0: 2020 2023 2074 6865 2070 6172 7469 7469     # the partiti
-0003a9f0: 6f6e 7320 6d61 7920 6e6f 7420 636f 6e74  ons may not cont
-0003aa00: 6169 6e20 6461 7461 6672 616d 652d 6c69  ain dataframe-li
-0003aa10: 6b65 0a20 2020 2023 206f 626a 6563 7473  ke.    # objects
-0003aa20: 2061 6e79 6d6f 7265 2e0a 0a20 2020 2023   anymore...    #
-0003aa30: 2042 6c6f 636b 7769 7365 2053 706c 6974   Blockwise Split
-0003aa40: 204c 6179 6572 0a20 2020 2069 6620 7370   Layer.    if sp
-0003aa50: 6c69 745f 6f75 7420 616e 6420 7370 6c69  lit_out and spli
-0003aa60: 745f 6f75 7420 3e20 313a 0a20 2020 2020  t_out > 1:.     
-0003aa70: 2020 2063 6875 6e6b 6564 203d 2063 6875     chunked = chu
-0003aa80: 6e6b 6564 2e6d 6170 5f70 6172 7469 7469  nked.map_partiti
-0003aa90: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-0003aaa0: 2068 6173 685f 7368 6172 642c 0a20 2020   hash_shard,.   
-0003aab0: 2020 2020 2020 2020 2073 706c 6974 5f6f           split_o
-0003aac0: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
-0003aad0: 7370 6c69 745f 6f75 745f 7365 7475 702c  split_out_setup,
-0003aae0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-0003aaf0: 6974 5f6f 7574 5f73 6574 7570 5f6b 7761  it_out_setup_kwa
-0003ab00: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-0003ab10: 2069 676e 6f72 655f 696e 6465 782c 0a20   ignore_index,. 
-0003ab20: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
-0003ab30: 3d22 7370 6c69 742d 2573 2220 2520 746f  ="split-%s" % to
-0003ab40: 6b65 6e5f 6b65 792c 0a20 2020 2020 2020  ken_key,.       
-0003ab50: 2029 0a0a 2020 2020 2320 4861 6e64 6c65   )..    # Handle
-0003ab60: 2073 6f72 7420 6265 6861 7669 6f72 0a20   sort behavior. 
-0003ab70: 2020 2069 6620 736f 7274 2069 7320 6e6f     if sort is no
-0003ab80: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0003ab90: 6966 2073 6f72 7420 616e 6420 7370 6c69  if sort and spli
-0003aba0: 745f 6f75 7420 3e20 313a 0a20 2020 2020  t_out > 1:.     
-0003abb0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-0003abc0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-0003abd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0003abe0: 2020 2243 616e 6e6f 7420 6775 6172 616e    "Cannot guaran
-0003abf0: 7465 6520 736f 7274 6564 206b 6579 7320  tee sorted keys 
-0003ac00: 666f 7220 6073 706c 6974 5f6f 7574 3e31  for `split_out>1
-0003ac10: 602e 220a 2020 2020 2020 2020 2020 2020  `.".            
-0003ac20: 2020 2020 2220 5472 7920 7573 696e 6720      " Try using 
-0003ac30: 7370 6c69 745f 6f75 743d 312c 206f 7220  split_out=1, or 
-0003ac40: 6772 6f75 7069 6e67 2077 6974 6820 736f  grouping with so
-0003ac50: 7274 3d46 616c 7365 2e22 0a20 2020 2020  rt=False.".     
-0003ac60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0003ac70: 2061 6767 7265 6761 7465 5f6b 7761 7267   aggregate_kwarg
-0003ac80: 7320 3d20 6167 6772 6567 6174 655f 6b77  s = aggregate_kw
-0003ac90: 6172 6773 206f 7220 7b7d 0a20 2020 2020  args or {}.     
-0003aca0: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
-0003acb0: 7267 735b 2273 6f72 7422 5d20 3d20 736f  rgs["sort"] = so
-0003acc0: 7274 0a0a 2020 2020 2320 5472 6565 2d52  rt..    # Tree-R
-0003acd0: 6564 7563 7469 6f6e 204c 6179 6572 0a20  eduction Layer. 
-0003ace0: 2020 2066 696e 616c 5f6e 616d 6520 3d20     final_name = 
-0003acf0: 6622 7b74 6f6b 656e 206f 7220 6675 6e63  f"{token or func
-0003ad00: 6e61 6d65 2861 6767 7265 6761 7465 297d  name(aggregate)}
-0003ad10: 2d61 6767 2d7b 746f 6b65 6e5f 6b65 797d  -agg-{token_key}
-0003ad20: 220a 2020 2020 6c61 7965 7220 3d20 4461  ".    layer = Da
-0003ad30: 7461 4672 616d 6554 7265 6552 6564 7563  taFrameTreeReduc
-0003ad40: 7469 6f6e 280a 2020 2020 2020 2020 6669  tion(.        fi
-0003ad50: 6e61 6c5f 6e61 6d65 2c0a 2020 2020 2020  nal_name,.      
-0003ad60: 2020 6368 756e 6b65 642e 6e61 6d65 2c0a    chunked.name,.
-0003ad70: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
-0003ad80: 6f6e 732c 0a20 2020 2020 2020 2070 6172  ons,.        par
-0003ad90: 7469 616c 285f 636f 6e63 6174 2c20 6967  tial(_concat, ig
-0003ada0: 6e6f 7265 5f69 6e64 6578 3d69 676e 6f72  nore_index=ignor
-0003adb0: 655f 696e 6465 7829 2c0a 2020 2020 2020  e_index),.      
-0003adc0: 2020 7061 7274 6961 6c28 636f 6d62 696e    partial(combin
-0003add0: 652c 202a 2a63 6f6d 6269 6e65 5f6b 7761  e, **combine_kwa
-0003ade0: 7267 7329 2069 6620 636f 6d62 696e 655f  rgs) if combine_
-0003adf0: 6b77 6172 6773 2065 6c73 6520 636f 6d62  kwargs else comb
-0003ae00: 696e 652c 0a20 2020 2020 2020 2066 696e  ine,.        fin
-0003ae10: 616c 697a 655f 6675 6e63 3d70 6172 7469  alize_func=parti
-0003ae20: 616c 2861 6767 7265 6761 7465 2c20 2a2a  al(aggregate, **
-0003ae30: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
-0003ae40: 290a 2020 2020 2020 2020 6966 2061 6767  ).        if agg
-0003ae50: 7265 6761 7465 5f6b 7761 7267 730a 2020  regate_kwargs.  
-0003ae60: 2020 2020 2020 656c 7365 2061 6767 7265        else aggre
-0003ae70: 6761 7465 2c0a 2020 2020 2020 2020 7370  gate,.        sp
-0003ae80: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-0003ae90: 6576 6572 792c 0a20 2020 2020 2020 2073  every,.        s
-0003aea0: 706c 6974 5f6f 7574 3d73 706c 6974 5f6f  plit_out=split_o
-0003aeb0: 7574 2069 6620 2873 706c 6974 5f6f 7574  ut if (split_out
-0003aec0: 2061 6e64 2073 706c 6974 5f6f 7574 203e   and split_out >
-0003aed0: 2031 2920 656c 7365 204e 6f6e 652c 0a20   1) else None,. 
-0003aee0: 2020 2020 2020 2074 7265 655f 6e6f 6465         tree_node
-0003aef0: 5f6e 616d 653d 6622 7b74 6f6b 656e 206f  _name=f"{token o
-0003af00: 7220 6675 6e63 6e61 6d65 2863 6f6d 6269  r funcname(combi
-0003af10: 6e65 297d 2d63 6f6d 6269 6e65 2d7b 746f  ne)}-combine-{to
-0003af20: 6b65 6e5f 6b65 797d 222c 0a20 2020 2029  ken_key}",.    )
-0003af30: 0a0a 2020 2020 6966 206d 6574 6120 6973  ..    if meta is
-0003af40: 206e 6f5f 6465 6661 756c 743a 0a20 2020   no_default:.   
-0003af50: 2020 2020 206d 6574 615f 6368 756e 6b20       meta_chunk 
-0003af60: 3d20 5f65 6d75 6c61 7465 2863 6875 6e6b  = _emulate(chunk
-0003af70: 2c20 2a61 7267 732c 2075 6466 3d54 7275  , *args, udf=Tru
-0003af80: 652c 202a 2a63 6875 6e6b 5f6b 7761 7267  e, **chunk_kwarg
-0003af90: 7329 0a20 2020 2020 2020 206d 6574 6120  s).        meta 
-0003afa0: 3d20 5f65 6d75 6c61 7465 280a 2020 2020  = _emulate(.    
-0003afb0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-0003afc0: 652c 205f 636f 6e63 6174 285b 6d65 7461  e, _concat([meta
-0003afd0: 5f63 6875 6e6b 5d2c 2069 676e 6f72 655f  _chunk], ignore_
-0003afe0: 696e 6465 7829 2c20 7564 663d 5472 7565  index), udf=True
-0003aff0: 2c20 2a2a 6167 6772 6567 6174 655f 6b77  , **aggregate_kw
-0003b000: 6172 6773 0a20 2020 2020 2020 2029 0a20  args.        ). 
-0003b010: 2020 206d 6574 6120 3d20 6d61 6b65 5f6d     meta = make_m
-0003b020: 6574 6128 0a20 2020 2020 2020 206d 6574  eta(.        met
-0003b030: 612c 0a20 2020 2020 2020 2069 6e64 6578  a,.        index
-0003b040: 3d28 6765 7461 7474 7228 6d61 6b65 5f6d  =(getattr(make_m
-0003b050: 6574 6128 6466 735b 305d 292c 2022 696e  eta(dfs[0]), "in
-0003b060: 6465 7822 2c20 4e6f 6e65 2920 6966 2064  dex", None) if d
-0003b070: 6673 2065 6c73 6520 4e6f 6e65 292c 0a20  fs else None),. 
-0003b080: 2020 2020 2020 2070 6172 656e 745f 6d65         parent_me
-0003b090: 7461 3d64 6673 5b30 5d2e 5f6d 6574 612c  ta=dfs[0]._meta,
-0003b0a0: 0a20 2020 2029 0a0a 2020 2020 6772 6170  .    )..    grap
-0003b0b0: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
-0003b0c0: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
-0003b0d0: 6f6e 7328 6669 6e61 6c5f 6e61 6d65 2c20  ons(final_name, 
-0003b0e0: 6c61 7965 722c 2064 6570 656e 6465 6e63  layer, dependenc
-0003b0f0: 6965 733d 2863 6875 6e6b 6564 2c29 290a  ies=(chunked,)).
-0003b100: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
-0003b110: 5b4e 6f6e 655d 202a 2028 2873 706c 6974  [None] * ((split
-0003b120: 5f6f 7574 206f 7220 3129 202b 2031 290a  _out or 1) + 1).
-0003b130: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
-0003b140: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
-0003b150: 6669 6e61 6c5f 6e61 6d65 2c20 6d65 7461  final_name, meta
-0003b160: 2c20 6469 7669 7369 6f6e 732c 2070 6172  , divisions, par
-0003b170: 656e 745f 6d65 7461 3d64 6673 5b30 5d2e  ent_meta=dfs[0].
-0003b180: 5f6d 6574 6129 0a0a 0a61 6361 203d 2061  _meta)...aca = a
-0003b190: 7070 6c79 5f63 6f6e 6361 745f 6170 706c  pply_concat_appl
-0003b1a0: 790a 0a0a 6465 6620 5f65 7874 7261 6374  y...def _extract
-0003b1b0: 5f6d 6574 6128 782c 206e 6f6e 656d 7074  _meta(x, nonempt
-0003b1c0: 793d 4661 6c73 6529 3a0a 2020 2020 2222  y=False):.    ""
-0003b1d0: 220a 2020 2020 4578 7472 6163 7420 696e  ".    Extract in
-0003b1e0: 7465 726e 616c 2063 6163 6865 2064 6174  ternal cache dat
-0003b1f0: 6120 2860 605f 6d65 7461 6060 2920 6672  a (``_meta``) fr
-0003b200: 6f6d 2064 642e 4461 7461 4672 616d 6520  om dd.DataFrame 
-0003b210: 2f20 6464 2e53 6572 6965 730a 2020 2020  / dd.Series.    
-0003b220: 2222 220a 2020 2020 6966 2069 7369 6e73  """.    if isins
-0003b230: 7461 6e63 6528 782c 2028 5363 616c 6172  tance(x, (Scalar
-0003b240: 2c20 5f46 7261 6d65 2929 3a0a 2020 2020  , _Frame)):.    
-0003b250: 2020 2020 7265 7475 726e 2078 2e5f 6d65      return x._me
-0003b260: 7461 5f6e 6f6e 656d 7074 7920 6966 206e  ta_nonempty if n
-0003b270: 6f6e 656d 7074 7920 656c 7365 2078 2e5f  onempty else x._
-0003b280: 6d65 7461 0a20 2020 2065 6c69 6620 6973  meta.    elif is
-0003b290: 696e 7374 616e 6365 2878 2c20 6c69 7374  instance(x, list
-0003b2a0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0003b2b0: 6e20 5b5f 6578 7472 6163 745f 6d65 7461  n [_extract_meta
-0003b2c0: 285f 782c 206e 6f6e 656d 7074 7929 2066  (_x, nonempty) f
-0003b2d0: 6f72 205f 7820 696e 2078 5d0a 2020 2020  or _x in x].    
-0003b2e0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-0003b2f0: 782c 2074 7570 6c65 293a 0a20 2020 2020  x, tuple):.     
-0003b300: 2020 2072 6574 7572 6e20 7475 706c 6528     return tuple(
-0003b310: 5f65 7874 7261 6374 5f6d 6574 6128 5f78  _extract_meta(_x
-0003b320: 2c20 6e6f 6e65 6d70 7479 2920 666f 7220  , nonempty) for 
-0003b330: 5f78 2069 6e20 7829 0a20 2020 2065 6c69  _x in x).    eli
-0003b340: 6620 6973 696e 7374 616e 6365 2878 2c20  f isinstance(x, 
-0003b350: 6469 6374 293a 0a20 2020 2020 2020 2072  dict):.        r
-0003b360: 6573 203d 207b 7d0a 2020 2020 2020 2020  es = {}.        
-0003b370: 666f 7220 6b20 696e 2078 3a0a 2020 2020  for k in x:.    
-0003b380: 2020 2020 2020 2020 7265 735b 6b5d 203d          res[k] =
-0003b390: 205f 6578 7472 6163 745f 6d65 7461 2878   _extract_meta(x
-0003b3a0: 5b6b 5d2c 206e 6f6e 656d 7074 7929 0a20  [k], nonempty). 
-0003b3b0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-0003b3c0: 730a 2020 2020 656c 6966 2069 7369 6e73  s.    elif isins
-0003b3d0: 7461 6e63 6528 782c 2044 656c 6179 6564  tance(x, Delayed
-0003b3e0: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
-0003b3f0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-0003b400: 2020 2020 2020 2020 2022 4361 6e6e 6f74           "Cannot
-0003b410: 2069 6e66 6572 2064 6174 6166 7261 6d65   infer dataframe
-0003b420: 206d 6574 6164 6174 6120 7769 7468 2061   metadata with a
-0003b430: 2060 6461 736b 2e64 656c 6179 6564 6020   `dask.delayed` 
-0003b440: 6172 6775 6d65 6e74 220a 2020 2020 2020  argument".      
-0003b450: 2020 290a 2020 2020 656c 7365 3a0a 2020    ).    else:.  
-0003b460: 2020 2020 2020 7265 7475 726e 2078 0a0a        return x..
-0003b470: 0a64 6566 205f 656d 756c 6174 6528 6675  .def _emulate(fu
-0003b480: 6e63 2c20 2a61 7267 732c 2075 6466 3d46  nc, *args, udf=F
-0003b490: 616c 7365 2c20 2a2a 6b77 6172 6773 293a  alse, **kwargs):
-0003b4a0: 0a20 2020 2022 2222 0a20 2020 2041 7070  .    """.    App
-0003b4b0: 6c79 2061 2066 756e 6374 696f 6e20 7573  ly a function us
-0003b4c0: 696e 6720 6172 6773 202f 206b 7761 7267  ing args / kwarg
-0003b4d0: 732e 2049 6620 6172 6775 6d65 6e74 7320  s. If arguments 
-0003b4e0: 636f 6e74 6169 6e20 6464 2e44 6174 6146  contain dd.DataF
-0003b4f0: 7261 6d65 202f 0a20 2020 2064 642e 5365  rame /.    dd.Se
-0003b500: 7269 6573 2c20 7573 696e 6720 696e 7465  ries, using inte
-0003b510: 726e 616c 2063 6163 6865 2028 6060 5f6d  rnal cache (``_m
-0003b520: 6574 6160 6029 2066 6f72 2063 616c 6375  eta``) for calcu
-0003b530: 6c61 7469 6f6e 0a20 2020 2022 2222 0a20  lation.    """. 
-0003b540: 2020 2077 6974 6820 7261 6973 655f 6f6e     with raise_on
-0003b550: 5f6d 6574 615f 6572 726f 7228 6675 6e63  _meta_error(func
-0003b560: 6e61 6d65 2866 756e 6329 2c20 7564 663d  name(func), udf=
-0003b570: 7564 6629 2c20 6368 6563 6b5f 6e75 6d65  udf), check_nume
-0003b580: 7269 635f 6f6e 6c79 5f64 6570 7265 6361  ric_only_depreca
-0003b590: 7469 6f6e 2829 3a0a 2020 2020 2020 2020  tion():.        
-0003b5a0: 7265 7475 726e 2066 756e 6328 2a5f 6578  return func(*_ex
-0003b5b0: 7472 6163 745f 6d65 7461 2861 7267 732c  tract_meta(args,
-0003b5c0: 2054 7275 6529 2c20 2a2a 5f65 7874 7261   True), **_extra
-0003b5d0: 6374 5f6d 6574 6128 6b77 6172 6773 2c20  ct_meta(kwargs, 
-0003b5e0: 5472 7565 2929 0a0a 0a40 696e 7365 7274  True))...@insert
-0003b5f0: 5f6d 6574 615f 7061 7261 6d5f 6465 7363  _meta_param_desc
-0003b600: 7269 7074 696f 6e0a 6465 6620 6d61 705f  ription.def map_
-0003b610: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-0003b620: 6675 6e63 2c0a 2020 2020 2a61 7267 732c  func,.    *args,
-0003b630: 0a20 2020 206d 6574 613d 6e6f 5f64 6566  .    meta=no_def
-0003b640: 6175 6c74 2c0a 2020 2020 656e 666f 7263  ault,.    enforc
-0003b650: 655f 6d65 7461 6461 7461 3d54 7275 652c  e_metadata=True,
-0003b660: 0a20 2020 2074 7261 6e73 666f 726d 5f64  .    transform_d
-0003b670: 6976 6973 696f 6e73 3d54 7275 652c 0a20  ivisions=True,. 
-0003b680: 2020 2061 6c69 676e 5f64 6174 6166 7261     align_datafra
-0003b690: 6d65 733d 5472 7565 2c0a 2020 2020 2a2a  mes=True,.    **
-0003b6a0: 6b77 6172 6773 2c0a 293a 0a20 2020 2022  kwargs,.):.    "
-0003b6b0: 2222 4170 706c 7920 5079 7468 6f6e 2066  ""Apply Python f
-0003b6c0: 756e 6374 696f 6e20 6f6e 2065 6163 6820  unction on each 
-0003b6d0: 4461 7461 4672 616d 6520 7061 7274 6974  DataFrame partit
-0003b6e0: 696f 6e2e 0a0a 2020 2020 5061 7261 6d65  ion...    Parame
-0003b6f0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-0003b700: 2d2d 2d0a 2020 2020 6675 6e63 203a 2066  ---.    func : f
-0003b710: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
-0003b720: 4675 6e63 7469 6f6e 2061 7070 6c69 6564  Function applied
-0003b730: 2074 6f20 6561 6368 2070 6172 7469 7469   to each partiti
-0003b740: 6f6e 2e0a 2020 2020 6172 6773 2c20 6b77  on..    args, kw
-0003b750: 6172 6773 203a 0a20 2020 2020 2020 2041  args :.        A
-0003b760: 7267 756d 656e 7473 2061 6e64 206b 6579  rguments and key
-0003b770: 776f 7264 7320 746f 2070 6173 7320 746f  words to pass to
-0003b780: 2074 6865 2066 756e 6374 696f 6e2e 2020   the function.  
-0003b790: 4174 206c 6561 7374 206f 6e65 206f 6620  At least one of 
-0003b7a0: 7468 650a 2020 2020 2020 2020 6172 6773  the.        args
-0003b7b0: 2073 686f 756c 6420 6265 2061 2044 6173   should be a Das
-0003b7c0: 6b2e 6461 7461 6672 616d 652e 2041 7267  k.dataframe. Arg
-0003b7d0: 756d 656e 7473 2061 6e64 206b 6579 776f  uments and keywo
-0003b7e0: 7264 7320 6d61 7920 636f 6e74 6169 6e0a  rds may contain.
-0003b7f0: 2020 2020 2020 2020 6060 5363 616c 6172          ``Scalar
-0003b800: 6060 2c20 6060 4465 6c61 7965 6460 6020  ``, ``Delayed`` 
-0003b810: 6f72 2072 6567 756c 6172 2070 7974 686f  or regular pytho
-0003b820: 6e20 6f62 6a65 6374 732e 2044 6174 6146  n objects. DataF
-0003b830: 7261 6d65 2d6c 696b 6520 6172 6773 0a20  rame-like args. 
-0003b840: 2020 2020 2020 2028 626f 7468 2064 6173         (both das
-0003b850: 6b20 616e 6420 7061 6e64 6173 2920 7769  k and pandas) wi
-0003b860: 6c6c 2062 6520 7265 7061 7274 6974 696f  ll be repartitio
-0003b870: 6e65 6420 746f 2061 6c69 676e 2028 6966  ned to align (if
-0003b880: 206e 6563 6573 7361 7279 290a 2020 2020   necessary).    
-0003b890: 2020 2020 6265 666f 7265 2061 7070 6c79      before apply
-0003b8a0: 696e 6720 7468 6520 6675 6e63 7469 6f6e  ing the function
-0003b8b0: 2028 7365 6520 6060 616c 6967 6e5f 6461   (see ``align_da
-0003b8c0: 7461 6672 616d 6573 6060 2074 6f20 636f  taframes`` to co
-0003b8d0: 6e74 726f 6c29 2e0a 2020 2020 656e 666f  ntrol)..    enfo
-0003b8e0: 7263 655f 6d65 7461 6461 7461 203a 2062  rce_metadata : b
-0003b8f0: 6f6f 6c2c 2064 6566 6175 6c74 2054 7275  ool, default Tru
-0003b900: 650a 2020 2020 2020 2020 5768 6574 6865  e.        Whethe
-0003b910: 7220 746f 2065 6e66 6f72 6365 2061 7420  r to enforce at 
-0003b920: 7275 6e74 696d 6520 7468 6174 2074 6865  runtime that the
-0003b930: 2073 7472 7563 7475 7265 206f 6620 7468   structure of th
-0003b940: 6520 4461 7461 4672 616d 650a 2020 2020  e DataFrame.    
-0003b950: 2020 2020 7072 6f64 7563 6564 2062 7920      produced by 
-0003b960: 6060 6675 6e63 6060 2061 6374 7561 6c6c  ``func`` actuall
-0003b970: 7920 6d61 7463 6865 7320 7468 6520 7374  y matches the st
-0003b980: 7275 6374 7572 6520 6f66 2060 606d 6574  ructure of ``met
-0003b990: 6160 602e 0a20 2020 2020 2020 2054 6869  a``..        Thi
-0003b9a0: 7320 7769 6c6c 2072 656e 616d 6520 616e  s will rename an
-0003b9b0: 6420 7265 6f72 6465 7220 636f 6c75 6d6e  d reorder column
-0003b9c0: 7320 666f 7220 6561 6368 2070 6172 7469  s for each parti
-0003b9d0: 7469 6f6e 2c0a 2020 2020 2020 2020 616e  tion,.        an
-0003b9e0: 6420 7769 6c6c 2072 6169 7365 2061 6e20  d will raise an 
-0003b9f0: 6572 726f 7220 6966 2074 6869 7320 646f  error if this do
-0003ba00: 6573 6e27 7420 776f 726b 2c0a 2020 2020  esn't work,.    
-0003ba10: 2020 2020 6275 7420 6974 2077 6f6e 2774      but it won't
-0003ba20: 2072 6169 7365 2069 6620 6474 7970 6573   raise if dtypes
-0003ba30: 2064 6f6e 2774 206d 6174 6368 2e0a 2020   don't match..  
-0003ba40: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
-0003ba50: 7369 6f6e 7320 3a20 626f 6f6c 2c20 6465  sions : bool, de
-0003ba60: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
-0003ba70: 2020 2057 6865 7468 6572 2074 6f20 6170     Whether to ap
-0003ba80: 706c 7920 7468 6520 6675 6e63 7469 6f6e  ply the function
-0003ba90: 206f 6e74 6f20 7468 6520 6469 7669 7369   onto the divisi
-0003baa0: 6f6e 7320 616e 6420 6170 706c 7920 7468  ons and apply th
-0003bab0: 6f73 650a 2020 2020 2020 2020 7472 616e  ose.        tran
-0003bac0: 7366 6f72 6d65 6420 6469 7669 7369 6f6e  sformed division
-0003bad0: 7320 746f 2074 6865 206f 7574 7075 742e  s to the output.
-0003bae0: 0a20 2020 2061 6c69 676e 5f64 6174 6166  .    align_dataf
-0003baf0: 7261 6d65 7320 3a20 626f 6f6c 2c20 6465  rames : bool, de
-0003bb00: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
-0003bb10: 2020 2057 6865 7468 6572 2074 6f20 7265     Whether to re
-0003bb20: 7061 7274 6974 696f 6e20 4461 7461 4672  partition DataFr
-0003bb30: 616d 652d 206f 7220 5365 7269 6573 2d6c  ame- or Series-l
-0003bb40: 696b 6520 6172 6773 0a20 2020 2020 2020  ike args.       
-0003bb50: 2028 626f 7468 2064 6173 6b20 616e 6420   (both dask and 
-0003bb60: 7061 6e64 6173 2920 736f 2074 6865 6972  pandas) so their
-0003bb70: 2064 6976 6973 696f 6e73 2061 6c69 676e   divisions align
-0003bb80: 2062 6566 6f72 6520 6170 706c 7969 6e67   before applying
-0003bb90: 0a20 2020 2020 2020 2074 6865 2066 756e  .        the fun
-0003bba0: 6374 696f 6e2e 2054 6869 7320 7265 7175  ction. This requ
-0003bbb0: 6972 6573 2061 6c6c 2069 6e70 7574 7320  ires all inputs 
-0003bbc0: 746f 2068 6176 6520 6b6e 6f77 6e20 6469  to have known di
-0003bbd0: 7669 7369 6f6e 732e 0a20 2020 2020 2020  visions..       
-0003bbe0: 2053 696e 676c 652d 7061 7274 6974 696f   Single-partitio
-0003bbf0: 6e20 696e 7075 7473 2077 696c 6c20 6265  n inputs will be
-0003bc00: 2073 706c 6974 2069 6e74 6f20 6d75 6c74   split into mult
-0003bc10: 6970 6c65 2070 6172 7469 7469 6f6e 732e  iple partitions.
-0003bc20: 0a0a 2020 2020 2020 2020 4966 2046 616c  ..        If Fal
-0003bc30: 7365 2c20 616c 6c20 696e 7075 7473 206d  se, all inputs m
-0003bc40: 7573 7420 6861 7665 2065 6974 6865 7220  ust have either 
-0003bc50: 7468 6520 7361 6d65 206e 756d 6265 7220  the same number 
-0003bc60: 6f66 2070 6172 7469 7469 6f6e 730a 2020  of partitions.  
-0003bc70: 2020 2020 2020 6f72 2061 2073 696e 676c        or a singl
-0003bc80: 6520 7061 7274 6974 696f 6e2e 2053 696e  e partition. Sin
-0003bc90: 676c 652d 7061 7274 6974 696f 6e20 696e  gle-partition in
-0003bca0: 7075 7473 2077 696c 6c20 6265 2062 726f  puts will be bro
-0003bcb0: 6164 6361 7374 2074 6f0a 2020 2020 2020  adcast to.      
-0003bcc0: 2020 6576 6572 7920 7061 7274 6974 696f    every partitio
-0003bcd0: 6e20 6f66 206d 756c 7469 2d70 6172 7469  n of multi-parti
-0003bce0: 7469 6f6e 2069 6e70 7574 732e 0a20 2020  tion inputs..   
-0003bcf0: 2024 4d45 5441 0a20 2020 2022 2222 0a20   $META.    """. 
-0003bd00: 2020 206e 616d 6520 3d20 6b77 6172 6773     name = kwargs
-0003bd10: 2e70 6f70 2822 746f 6b65 6e22 2c20 4e6f  .pop("token", No
-0003bd20: 6e65 290a 2020 2020 7061 7265 6e74 5f6d  ne).    parent_m
-0003bd30: 6574 6120 3d20 6b77 6172 6773 2e70 6f70  eta = kwargs.pop
-0003bd40: 2822 7061 7265 6e74 5f6d 6574 6122 2c20  ("parent_meta", 
-0003bd50: 4e6f 6e65 290a 0a20 2020 2061 7373 6572  None)..    asser
-0003bd60: 7420 6361 6c6c 6162 6c65 2866 756e 6329  t callable(func)
-0003bd70: 0a20 2020 2069 6620 6e61 6d65 2069 7320  .    if name is 
-0003bd80: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0003bd90: 2020 746f 6b65 6e20 3d20 746f 6b65 6e69    token = tokeni
-0003bda0: 7a65 286d 6574 612c 202a 6172 6773 2c20  ze(meta, *args, 
-0003bdb0: 2a2a 6b77 6172 6773 290a 2020 2020 656c  **kwargs).    el
-0003bdc0: 7365 3a0a 2020 2020 2020 2020 6e61 6d65  se:.        name
-0003bdd0: 203d 2066 756e 636e 616d 6528 6675 6e63   = funcname(func
-0003bde0: 290a 2020 2020 2020 2020 746f 6b65 6e20  ).        token 
-0003bdf0: 3d20 746f 6b65 6e69 7a65 2866 756e 632c  = tokenize(func,
-0003be00: 206d 6574 612c 202a 6172 6773 2c20 2a2a   meta, *args, **
-0003be10: 6b77 6172 6773 290a 2020 2020 6e61 6d65  kwargs).    name
-0003be20: 203d 2066 227b 6e61 6d65 7d2d 7b74 6f6b   = f"{name}-{tok
-0003be30: 656e 7d22 0a0a 2020 2020 6672 6f6d 2064  en}"..    from d
-0003be40: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
-0003be50: 6c74 6920 696d 706f 7274 205f 6d61 7962  lti import _mayb
-0003be60: 655f 616c 6967 6e5f 7061 7274 6974 696f  e_align_partitio
-0003be70: 6e73 0a0a 2020 2020 6966 2061 6c69 676e  ns..    if align
-0003be80: 5f64 6174 6166 7261 6d65 733a 0a20 2020  _dataframes:.   
-0003be90: 2020 2020 2061 7267 7320 3d20 5f6d 6179       args = _may
-0003bea0: 6265 5f66 726f 6d5f 7061 6e64 6173 2861  be_from_pandas(a
-0003beb0: 7267 7329 0a20 2020 2020 2020 2074 7279  rgs).        try
-0003bec0: 3a0a 2020 2020 2020 2020 2020 2020 6172  :.            ar
-0003bed0: 6773 203d 205f 6d61 7962 655f 616c 6967  gs = _maybe_alig
-0003bee0: 6e5f 7061 7274 6974 696f 6e73 2861 7267  n_partitions(arg
-0003bef0: 7329 0a20 2020 2020 2020 2065 7863 6570  s).        excep
-0003bf00: 7420 5661 6c75 6545 7272 6f72 2061 7320  t ValueError as 
-0003bf10: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0003bf20: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0003bf30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003bf40: 2066 227b 657d 2e20 4966 2079 6f75 2064   f"{e}. If you d
-0003bf50: 6f6e 2774 2077 616e 7420 7468 6520 7061  on't want the pa
-0003bf60: 7274 6974 696f 6e73 2074 6f20 6265 2061  rtitions to be a
-0003bf70: 6c69 676e 6564 2c20 616e 6420 6172 6520  ligned, and are 
-0003bf80: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0003bf90: 2020 2263 616c 6c69 6e67 2060 6d61 705f    "calling `map_
-0003bfa0: 7061 7274 6974 696f 6e73 6020 6469 7265  partitions` dire
-0003bfb0: 6374 6c79 2c20 7061 7373 2060 616c 6967  ctly, pass `alig
-0003bfc0: 6e5f 6461 7461 6672 616d 6573 3d46 616c  n_dataframes=Fal
-0003bfd0: 7365 602e 220a 2020 2020 2020 2020 2020  se`.".          
-0003bfe0: 2020 2920 6672 6f6d 2065 0a0a 2020 2020    ) from e..    
-0003bff0: 6466 7320 3d20 5b64 6620 666f 7220 6466  dfs = [df for df
-0003c000: 2069 6e20 6172 6773 2069 6620 6973 696e   in args if isin
-0003c010: 7374 616e 6365 2864 662c 205f 4672 616d  stance(df, _Fram
-0003c020: 6529 5d0a 0a20 2020 206d 6574 6120 3d20  e)]..    meta = 
-0003c030: 5f67 6574 5f6d 6574 615f 6d61 705f 7061  _get_meta_map_pa
-0003c040: 7274 6974 696f 6e73 2861 7267 732c 2064  rtitions(args, d
-0003c050: 6673 2c20 6675 6e63 2c20 6b77 6172 6773  fs, func, kwargs
-0003c060: 2c20 6d65 7461 2c20 7061 7265 6e74 5f6d  , meta, parent_m
-0003c070: 6574 6129 0a20 2020 2069 6620 616c 6c28  eta).    if all(
-0003c080: 6973 696e 7374 616e 6365 2861 7267 2c20  isinstance(arg, 
-0003c090: 5363 616c 6172 2920 666f 7220 6172 6720  Scalar) for arg 
-0003c0a0: 696e 2061 7267 7329 3a0a 2020 2020 2020  in args):.      
-0003c0b0: 2020 6c61 7965 7220 3d20 7b0a 2020 2020    layer = {.    
-0003c0c0: 2020 2020 2020 2020 286e 616d 652c 2030          (name, 0
-0003c0d0: 293a 2028 0a20 2020 2020 2020 2020 2020  ): (.           
-0003c0e0: 2020 2020 2061 7070 6c79 2c0a 2020 2020       apply,.    
-0003c0f0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-0003c100: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003c110: 2020 2874 7570 6c65 2c20 5b28 6172 672e    (tuple, [(arg.
-0003c120: 5f6e 616d 652c 2030 2920 666f 7220 6172  _name, 0) for ar
-0003c130: 6720 696e 2061 7267 735d 292c 0a20 2020  g in args]),.   
-0003c140: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
-0003c150: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-0003c160: 2029 0a20 2020 2020 2020 207d 0a20 2020   ).        }.   
-0003c170: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
-0003c180: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-0003c190: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
-0003c1a0: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
-0003c1b0: 656e 6369 6573 3d61 7267 7329 0a20 2020  encies=args).   
-0003c1c0: 2020 2020 2072 6574 7572 6e20 5363 616c       return Scal
-0003c1d0: 6172 2867 7261 7068 2c20 6e61 6d65 2c20  ar(graph, name, 
-0003c1e0: 6d65 7461 290a 0a20 2020 2061 7267 7332  meta)..    args2
-0003c1f0: 203d 205b 5d0a 2020 2020 6465 7065 6e64   = [].    depend
-0003c200: 656e 6369 6573 203d 205b 5d0a 2020 2020  encies = [].    
-0003c210: 666f 7220 6172 6720 696e 2061 7267 733a  for arg in args:
-0003c220: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0003c230: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
-0003c240: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-0003c250: 2061 7267 7332 2e61 7070 656e 6428 6172   args2.append(ar
-0003c260: 6729 0a20 2020 2020 2020 2020 2020 2064  g).            d
-0003c270: 6570 656e 6465 6e63 6965 732e 6170 7065  ependencies.appe
-0003c280: 6e64 2861 7267 290a 2020 2020 2020 2020  nd(arg).        
-0003c290: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
-0003c2a0: 2020 2020 2061 7267 203d 206e 6f72 6d61       arg = norma
-0003c2b0: 6c69 7a65 5f61 7267 2861 7267 290a 2020  lize_arg(arg).  
-0003c2c0: 2020 2020 2020 6172 6732 2c20 636f 6c6c        arg2, coll
-0003c2d0: 6563 7469 6f6e 7320 3d20 756e 7061 636b  ections = unpack
-0003c2e0: 5f63 6f6c 6c65 6374 696f 6e73 2861 7267  _collections(arg
-0003c2f0: 290a 2020 2020 2020 2020 6966 2063 6f6c  ).        if col
-0003c300: 6c65 6374 696f 6e73 3a0a 2020 2020 2020  lections:.      
-0003c310: 2020 2020 2020 6172 6773 322e 6170 7065        args2.appe
-0003c320: 6e64 2861 7267 3229 0a20 2020 2020 2020  nd(arg2).       
-0003c330: 2020 2020 2064 6570 656e 6465 6e63 6965       dependencie
-0003c340: 732e 6578 7465 6e64 2863 6f6c 6c65 6374  s.extend(collect
-0003c350: 696f 6e73 290a 2020 2020 2020 2020 656c  ions).        el
-0003c360: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0003c370: 6172 6773 322e 6170 7065 6e64 2861 7267  args2.append(arg
-0003c380: 290a 0a20 2020 206b 7761 7267 7333 203d  )..    kwargs3 =
-0003c390: 207b 7d0a 2020 2020 7369 6d70 6c65 203d   {}.    simple =
-0003c3a0: 2054 7275 650a 2020 2020 666f 7220 6b2c   True.    for k,
-0003c3b0: 2076 2069 6e20 6b77 6172 6773 2e69 7465   v in kwargs.ite
-0003c3c0: 6d73 2829 3a0a 2020 2020 2020 2020 7620  ms():.        v 
-0003c3d0: 3d20 6e6f 726d 616c 697a 655f 6172 6728  = normalize_arg(
-0003c3e0: 7629 0a20 2020 2020 2020 2076 2c20 636f  v).        v, co
-0003c3f0: 6c6c 6563 7469 6f6e 7320 3d20 756e 7061  llections = unpa
-0003c400: 636b 5f63 6f6c 6c65 6374 696f 6e73 2876  ck_collections(v
-0003c410: 290a 2020 2020 2020 2020 6465 7065 6e64  ).        depend
-0003c420: 656e 6369 6573 2e65 7874 656e 6428 636f  encies.extend(co
-0003c430: 6c6c 6563 7469 6f6e 7329 0a20 2020 2020  llections).     
-0003c440: 2020 206b 7761 7267 7333 5b6b 5d20 3d20     kwargs3[k] = 
-0003c450: 760a 2020 2020 2020 2020 6966 2063 6f6c  v.        if col
-0003c460: 6c65 6374 696f 6e73 3a0a 2020 2020 2020  lections:.      
-0003c470: 2020 2020 2020 7369 6d70 6c65 203d 2046        simple = F
-0003c480: 616c 7365 0a0a 2020 2020 6469 7669 7369  alse..    divisi
-0003c490: 6f6e 7320 3d20 5f67 6574 5f64 6976 6973  ons = _get_divis
-0003c4a0: 696f 6e73 5f6d 6170 5f70 6172 7469 7469  ions_map_partiti
-0003c4b0: 6f6e 7328 0a20 2020 2020 2020 2061 6c69  ons(.        ali
-0003c4c0: 676e 5f64 6174 6166 7261 6d65 732c 2074  gn_dataframes, t
-0003c4d0: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
-0003c4e0: 6e73 2c20 6466 732c 2066 756e 632c 2061  ns, dfs, func, a
-0003c4f0: 7267 732c 206b 7761 7267 730a 2020 2020  rgs, kwargs.    
-0003c500: 290a 0a20 2020 2069 6620 6861 735f 6b65  )..    if has_ke
-0003c510: 7977 6f72 6428 6675 6e63 2c20 2270 6172  yword(func, "par
-0003c520: 7469 7469 6f6e 5f69 6e66 6f22 293a 0a20  tition_info"):. 
-0003c530: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-0003c540: 5f69 6e66 6f20 3d20 7b0a 2020 2020 2020  _info = {.      
-0003c550: 2020 2020 2020 2869 2c29 3a20 7b22 6e75        (i,): {"nu
-0003c560: 6d62 6572 223a 2069 2c20 2264 6976 6973  mber": i, "divis
-0003c570: 696f 6e22 3a20 6469 7669 7369 6f6e 7d0a  ion": division}.
-0003c580: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0003c590: 692c 2064 6976 6973 696f 6e20 696e 2065  i, division in e
-0003c5a0: 6e75 6d65 7261 7465 2864 6976 6973 696f  numerate(divisio
-0003c5b0: 6e73 5b3a 2d31 5d29 0a20 2020 2020 2020  ns[:-1]).       
-0003c5c0: 207d 0a0a 2020 2020 2020 2020 6172 6773   }..        args
-0003c5d0: 322e 696e 7365 7274 2830 2c20 426c 6f63  2.insert(0, Bloc
-0003c5e0: 6b77 6973 6544 6570 4469 6374 2870 6172  kwiseDepDict(par
-0003c5f0: 7469 7469 6f6e 5f69 6e66 6f29 290a 2020  tition_info)).  
-0003c600: 2020 2020 2020 6f72 6967 5f66 756e 6320        orig_func 
-0003c610: 3d20 6675 6e63 0a0a 2020 2020 2020 2020  = func..        
-0003c620: 6465 6620 6675 6e63 2870 6172 7469 7469  def func(partiti
-0003c630: 6f6e 5f69 6e66 6f2c 202a 6172 6773 2c20  on_info, *args, 
-0003c640: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-0003c650: 2020 2020 2020 2072 6574 7572 6e20 6f72         return or
-0003c660: 6967 5f66 756e 6328 2a61 7267 732c 202a  ig_func(*args, *
-0003c670: 2a6b 7761 7267 732c 2070 6172 7469 7469  *kwargs, partiti
-0003c680: 6f6e 5f69 6e66 6f3d 7061 7274 6974 696f  on_info=partitio
-0003c690: 6e5f 696e 666f 290a 0a20 2020 2069 6620  n_info)..    if 
-0003c6a0: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-0003c6b0: 3a0a 2020 2020 2020 2020 6473 6b20 3d20  :.        dsk = 
-0003c6c0: 7061 7274 6974 696f 6e77 6973 655f 6772  partitionwise_gr
-0003c6d0: 6170 6828 0a20 2020 2020 2020 2020 2020  aph(.           
-0003c6e0: 2061 7070 6c79 5f61 6e64 5f65 6e66 6f72   apply_and_enfor
-0003c6f0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
-0003c700: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-0003c710: 2020 2a61 7267 7332 2c0a 2020 2020 2020    *args2,.      
-0003c720: 2020 2020 2020 6465 7065 6e64 656e 6369        dependenci
-0003c730: 6573 3d64 6570 656e 6465 6e63 6965 732c  es=dependencies,
-0003c740: 0a20 2020 2020 2020 2020 2020 205f 6675  .            _fu
-0003c750: 6e63 3d66 756e 632c 0a20 2020 2020 2020  nc=func,.       
-0003c760: 2020 2020 205f 6d65 7461 3d6d 6574 612c       _meta=meta,
-0003c770: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
-0003c780: 7761 7267 7333 2c0a 2020 2020 2020 2020  wargs3,.        
-0003c790: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
-0003c7a0: 2020 2020 6b77 6172 6773 3420 3d20 6b77      kwargs4 = kw
-0003c7b0: 6172 6773 2069 6620 7369 6d70 6c65 2065  args if simple e
-0003c7c0: 6c73 6520 6b77 6172 6773 330a 2020 2020  lse kwargs3.    
-0003c7d0: 2020 2020 6473 6b20 3d20 7061 7274 6974      dsk = partit
-0003c7e0: 696f 6e77 6973 655f 6772 6170 6828 0a20  ionwise_graph(. 
-0003c7f0: 2020 2020 2020 2020 2020 2066 756e 632c             func,
-0003c800: 206e 616d 652c 202a 6172 6773 322c 202a   name, *args2, *
-0003c810: 2a6b 7761 7267 7334 2c20 6465 7065 6e64  *kwargs4, depend
-0003c820: 656e 6369 6573 3d64 6570 656e 6465 6e63  encies=dependenc
-0003c830: 6965 730a 2020 2020 2020 2020 290a 0a20  ies.        ).. 
-0003c840: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-0003c850: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-0003c860: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
-0003c870: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-0003c880: 6573 3d64 6570 656e 6465 6e63 6965 7329  es=dependencies)
-0003c890: 0a20 2020 2072 6574 7572 6e20 6e65 775f  .    return new_
-0003c8a0: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
-0003c8b0: 206e 616d 652c 206d 6574 612c 2064 6976   name, meta, div
-0003c8c0: 6973 696f 6e73 290a 0a0a 6465 6620 5f67  isions)...def _g
-0003c8d0: 6574 5f64 6976 6973 696f 6e73 5f6d 6170  et_divisions_map
-0003c8e0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-0003c8f0: 2061 6c69 676e 5f64 6174 6166 7261 6d65   align_dataframe
-0003c900: 732c 2074 7261 6e73 666f 726d 5f64 6976  s, transform_div
-0003c910: 6973 696f 6e73 2c20 6466 732c 2066 756e  isions, dfs, fun
-0003c920: 632c 2061 7267 732c 206b 7761 7267 730a  c, args, kwargs.
-0003c930: 293a 0a20 2020 2022 2222 0a20 2020 2048  ):.    """.    H
-0003c940: 656c 7065 7220 746f 2067 6574 2064 6976  elper to get div
-0003c950: 6973 696f 6e73 2066 6f72 206d 6170 5f70  isions for map_p
-0003c960: 6172 7469 7469 6f6e 7320 616e 6420 6d61  artitions and ma
-0003c970: 705f 6f76 6572 6c61 7020 6f75 7470 7574  p_overlap output
-0003c980: 2e0a 2020 2020 2222 220a 2020 2020 6966  ..    """.    if
-0003c990: 2061 6c69 676e 5f64 6174 6166 7261 6d65   align_dataframe
-0003c9a0: 733a 0a20 2020 2020 2020 2064 6976 6973  s:.        divis
-0003c9b0: 696f 6e73 203d 2064 6673 5b30 5d2e 6469  ions = dfs[0].di
-0003c9c0: 7669 7369 6f6e 730a 2020 2020 656c 7365  visions.    else
-0003c9d0: 3a0a 2020 2020 2020 2020 2320 556e 616c  :.        # Unal
-0003c9e0: 6967 6e65 642c 2064 6673 2069 7320 6120  igned, dfs is a 
-0003c9f0: 6d69 7820 6f66 2031 2070 6172 7469 7469  mix of 1 partiti
-0003ca00: 6f6e 2061 6e64 2031 2b20 7061 7274 6974  on and 1+ partit
-0003ca10: 696f 6e20 6461 7461 6672 616d 6573 2c0a  ion dataframes,.
-0003ca20: 2020 2020 2020 2020 2320 7573 6520 6c6f          # use lo
-0003ca30: 6e67 6573 7420 6469 7669 7369 6f6e 7320  ngest divisions 
-0003ca40: 666f 756e 640a 2020 2020 2020 2020 6469  found.        di
-0003ca50: 7669 7369 6f6e 7320 3d20 6d61 7828 2864  visions = max((d
-0003ca60: 2e64 6976 6973 696f 6e73 2066 6f72 2064  .divisions for d
-0003ca70: 2069 6e20 6466 7329 2c20 6b65 793d 6c65   in dfs), key=le
-0003ca80: 6e29 0a20 2020 2069 6620 7472 616e 7366  n).    if transf
-0003ca90: 6f72 6d5f 6469 7669 7369 6f6e 7320 616e  orm_divisions an
-0003caa0: 6420 6973 696e 7374 616e 6365 2864 6673  d isinstance(dfs
-0003cab0: 5b30 5d2c 2049 6e64 6578 2920 616e 6420  [0], Index) and 
-0003cac0: 6c65 6e28 6466 7329 203d 3d20 313a 0a20  len(dfs) == 1:. 
-0003cad0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0003cae0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
-0003caf0: 7320 3d20 6675 6e63 280a 2020 2020 2020  s = func(.      
-0003cb00: 2020 2020 2020 2020 2020 2a5b 7064 2e49            *[pd.I
-0003cb10: 6e64 6578 2861 2e64 6976 6973 696f 6e73  ndex(a.divisions
-0003cb20: 2920 6966 2061 2069 7320 6466 735b 305d  ) if a is dfs[0]
-0003cb30: 2065 6c73 6520 6120 666f 7220 6120 696e   else a for a in
-0003cb40: 2061 7267 735d 2c20 2a2a 6b77 6172 6773   args], **kwargs
-0003cb50: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0003cb60: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0003cb70: 696e 7374 616e 6365 2864 6976 6973 696f  instance(divisio
-0003cb80: 6e73 2c20 7064 2e49 6e64 6578 293a 0a20  ns, pd.Index):. 
-0003cb90: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0003cba0: 6976 6973 696f 6e73 203d 206d 6574 686f  ivisions = metho
-0003cbb0: 6473 2e74 6f6c 6973 7428 6469 7669 7369  ds.tolist(divisi
-0003cbc0: 6f6e 7329 0a20 2020 2020 2020 2065 7863  ons).        exc
-0003cbd0: 6570 7420 4578 6365 7074 696f 6e3a 0a20  ept Exception:. 
-0003cbe0: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
-0003cbf0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0003cc00: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0003cc10: 2076 616c 6964 5f64 6976 6973 696f 6e73   valid_divisions
-0003cc20: 2864 6976 6973 696f 6e73 293a 0a20 2020  (divisions):.   
-0003cc30: 2020 2020 2020 2020 2020 2020 2064 6976               div
-0003cc40: 6973 696f 6e73 203d 205b 4e6f 6e65 5d20  isions = [None] 
-0003cc50: 2a20 2864 6673 5b30 5d2e 6e70 6172 7469  * (dfs[0].nparti
-0003cc60: 7469 6f6e 7320 2b20 3129 0a20 2020 2072  tions + 1).    r
-0003cc70: 6574 7572 6e20 6469 7669 7369 6f6e 730a  eturn divisions.
-0003cc80: 0a0a 6465 6620 5f67 6574 5f6d 6574 615f  ..def _get_meta_
-0003cc90: 6d61 705f 7061 7274 6974 696f 6e73 2861  map_partitions(a
-0003cca0: 7267 732c 2064 6673 2c20 6675 6e63 2c20  rgs, dfs, func, 
-0003ccb0: 6b77 6172 6773 2c20 6d65 7461 2c20 7061  kwargs, meta, pa
-0003ccc0: 7265 6e74 5f6d 6574 6129 3a0a 2020 2020  rent_meta):.    
-0003ccd0: 2222 220a 2020 2020 4865 6c70 6572 2074  """.    Helper t
-0003cce0: 6f20 6765 6e65 7261 7465 206d 6574 6164  o generate metad
-0003ccf0: 6174 6120 666f 7220 6d61 705f 7061 7274  ata for map_part
-0003cd00: 6974 696f 6e73 2061 6e64 206d 6170 5f6f  itions and map_o
-0003cd10: 7665 726c 6170 206f 7574 7075 742e 0a20  verlap output.. 
-0003cd20: 2020 2022 2222 0a20 2020 206d 6574 615f     """.    meta_
-0003cd30: 696e 6465 7820 3d20 6765 7461 7474 7228  index = getattr(
-0003cd40: 6d61 6b65 5f6d 6574 6128 6466 735b 305d  make_meta(dfs[0]
-0003cd50: 292c 2022 696e 6465 7822 2c20 4e6f 6e65  ), "index", None
-0003cd60: 2920 6966 2064 6673 2065 6c73 6520 4e6f  ) if dfs else No
-0003cd70: 6e65 0a20 2020 2069 6620 7061 7265 6e74  ne.    if parent
-0003cd80: 5f6d 6574 6120 6973 204e 6f6e 6520 616e  _meta is None an
-0003cd90: 6420 6466 733a 0a20 2020 2020 2020 2070  d dfs:.        p
-0003cda0: 6172 656e 745f 6d65 7461 203d 2064 6673  arent_meta = dfs
-0003cdb0: 5b30 5d2e 5f6d 6574 610a 2020 2020 6966  [0]._meta.    if
-0003cdc0: 206d 6574 6120 6973 206e 6f5f 6465 6661   meta is no_defa
-0003cdd0: 756c 743a 0a20 2020 2020 2020 2023 2055  ult:.        # U
-0003cde0: 7365 206e 6f6e 2d6e 6f72 6d61 6c69 7a65  se non-normalize
-0003cdf0: 6420 6b77 6172 6773 2068 6572 652c 2061  d kwargs here, a
-0003ce00: 7320 7765 2077 616e 7420 7468 6520 7265  s we want the re
-0003ce10: 616c 2076 616c 7565 7320 286e 6f74 0a20  al values (not. 
-0003ce20: 2020 2020 2020 2023 2064 656c 6179 6564         # delayed
-0003ce30: 2076 616c 7565 7329 0a20 2020 2020 2020   values).       
-0003ce40: 206d 6574 6120 3d20 5f65 6d75 6c61 7465   meta = _emulate
-0003ce50: 2866 756e 632c 202a 6172 6773 2c20 7564  (func, *args, ud
-0003ce60: 663d 5472 7565 2c20 2a2a 6b77 6172 6773  f=True, **kwargs
-0003ce70: 290a 2020 2020 2020 2020 6d65 7461 5f69  ).        meta_i
-0003ce80: 735f 656d 756c 6174 6564 203d 2054 7275  s_emulated = Tru
-0003ce90: 650a 2020 2020 656c 7365 3a0a 2020 2020  e.    else:.    
-0003cea0: 2020 2020 6d65 7461 203d 206d 616b 655f      meta = make_
-0003ceb0: 6d65 7461 286d 6574 612c 2069 6e64 6578  meta(meta, index
-0003cec0: 3d6d 6574 615f 696e 6465 782c 2070 6172  =meta_index, par
-0003ced0: 656e 745f 6d65 7461 3d70 6172 656e 745f  ent_meta=parent_
-0003cee0: 6d65 7461 290a 2020 2020 2020 2020 6d65  meta).        me
-0003cef0: 7461 5f69 735f 656d 756c 6174 6564 203d  ta_is_emulated =
-0003cf00: 2046 616c 7365 0a0a 2020 2020 6966 206e   False..    if n
-0003cf10: 6f74 2028 6861 735f 7061 7261 6c6c 656c  ot (has_parallel
-0003cf20: 5f74 7970 6528 6d65 7461 2920 6f72 2069  _type(meta) or i
-0003cf30: 735f 6172 7261 796c 696b 6528 6d65 7461  s_arraylike(meta
-0003cf40: 2920 616e 6420 6d65 7461 2e73 6861 7065  ) and meta.shape
-0003cf50: 2920 616e 6420 6e6f 7420 616c 6c28 0a20  ) and not all(. 
-0003cf60: 2020 2020 2020 2069 7369 6e73 7461 6e63         isinstanc
-0003cf70: 6528 6172 672c 2053 6361 6c61 7229 2066  e(arg, Scalar) f
-0003cf80: 6f72 2061 7267 2069 6e20 6172 6773 0a20  or arg in args. 
-0003cf90: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
-0003cfa0: 206e 6f74 206d 6574 615f 6973 5f65 6d75   not meta_is_emu
-0003cfb0: 6c61 7465 643a 0a20 2020 2020 2020 2020  lated:.         
-0003cfc0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-0003cfd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0003cfe0: 2020 224d 6574 6120 6973 206e 6f74 2076    "Meta is not v
-0003cff0: 616c 6964 2c20 606d 6170 5f70 6172 7469  alid, `map_parti
-0003d000: 7469 6f6e 7360 2061 6e64 2060 6d61 705f  tions` and `map_
-0003d010: 6f76 6572 6c61 7060 2065 7870 6563 7473  overlap` expects
-0003d020: 206f 7574 7075 7420 746f 2062 6520 6120   output to be a 
-0003d030: 7061 6e64 6173 206f 626a 6563 742e 2022  pandas object. "
-0003d040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003d050: 2022 5472 7920 7061 7373 696e 6720 6120   "Try passing a 
-0003d060: 7061 6e64 6173 206f 626a 6563 7420 6173  pandas object as
-0003d070: 206d 6574 6120 6f72 2061 2064 6963 7420   meta or a dict 
-0003d080: 6f72 2074 7570 6c65 2072 6570 7265 7365  or tuple represe
-0003d090: 6e74 696e 6720 7468 6520 220a 2020 2020  nting the ".    
-0003d0a0: 2020 2020 2020 2020 2020 2020 2228 6e61              "(na
-0003d0b0: 6d65 2c20 6474 7970 6529 206f 6620 7468  me, dtype) of th
-0003d0c0: 6520 636f 6c75 6d6e 732e 2049 6e20 7468  e columns. In th
-0003d0d0: 6520 6675 7475 7265 2074 6865 206d 6574  e future the met
-0003d0e0: 6120 796f 7520 7061 7373 6564 2077 696c  a you passed wil
-0003d0f0: 6c20 6e6f 7420 776f 726b 2e22 2c0a 2020  l not work.",.  
-0003d100: 2020 2020 2020 2020 2020 2020 2020 4675                Fu
-0003d110: 7475 7265 5761 726e 696e 672c 0a20 2020  tureWarning,.   
-0003d120: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0003d130: 2020 2023 2049 6620 606d 6574 6160 2069     # If `meta` i
-0003d140: 7320 6e6f 7420 6120 7061 6e64 6173 206f  s not a pandas o
-0003d150: 626a 6563 742c 2074 6865 2063 6f6e 6361  bject, the conca
-0003d160: 7465 6e61 7465 6420 7265 7375 6c74 7320  tenated results 
-0003d170: 7769 6c6c 2062 6520 610a 2020 2020 2020  will be a.      
-0003d180: 2020 2320 6469 6666 6572 656e 7420 7479    # different ty
-0003d190: 7065 0a20 2020 2020 2020 206d 6574 6120  pe.        meta 
-0003d1a0: 3d20 6d61 6b65 5f6d 6574 6128 5f63 6f6e  = make_meta(_con
-0003d1b0: 6361 7428 5b6d 6574 615d 292c 2069 6e64  cat([meta]), ind
-0003d1c0: 6578 3d6d 6574 615f 696e 6465 7829 0a0a  ex=meta_index)..
-0003d1d0: 2020 2020 2320 456e 7375 7265 206d 6574      # Ensure met
-0003d1e0: 6120 6973 2065 6d70 7479 2073 6572 6965  a is empty serie
-0003d1f0: 730a 2020 2020 6d65 7461 203d 206d 616b  s.    meta = mak
-0003d200: 655f 6d65 7461 286d 6574 612c 2070 6172  e_meta(meta, par
-0003d210: 656e 745f 6d65 7461 3d70 6172 656e 745f  ent_meta=parent_
-0003d220: 6d65 7461 290a 0a20 2020 2072 6574 7572  meta)..    retur
-0003d230: 6e20 6d65 7461 0a0a 0a64 6566 2061 7070  n meta...def app
-0003d240: 6c79 5f61 6e64 5f65 6e66 6f72 6365 282a  ly_and_enforce(*
-0003d250: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-0003d260: 0a20 2020 2022 2222 4170 706c 7920 6120  .    """Apply a 
-0003d270: 6675 6e63 7469 6f6e 2c20 616e 6420 656e  function, and en
-0003d280: 666f 7263 6520 7468 6520 6f75 7470 7574  force the output
-0003d290: 2074 6f20 6d61 7463 6820 6d65 7461 0a0a   to match meta..
-0003d2a0: 2020 2020 456e 7375 7265 7320 7468 6520      Ensures the 
-0003d2b0: 6f75 7470 7574 2068 6173 2074 6865 2073  output has the s
-0003d2c0: 616d 6520 636f 6c75 6d6e 732c 2065 7665  ame columns, eve
-0003d2d0: 6e20 6966 2065 6d70 7479 2e22 2222 0a20  n if empty.""". 
-0003d2e0: 2020 2066 756e 6320 3d20 6b77 6172 6773     func = kwargs
-0003d2f0: 2e70 6f70 2822 5f66 756e 6322 290a 2020  .pop("_func").  
-0003d300: 2020 6d65 7461 203d 206b 7761 7267 732e    meta = kwargs.
-0003d310: 706f 7028 225f 6d65 7461 2229 0a20 2020  pop("_meta").   
-0003d320: 2064 6620 3d20 6675 6e63 282a 6172 6773   df = func(*args
-0003d330: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
-0003d340: 6966 2069 735f 6461 7461 6672 616d 655f  if is_dataframe_
-0003d350: 6c69 6b65 2864 6629 206f 7220 6973 5f73  like(df) or is_s
-0003d360: 6572 6965 735f 6c69 6b65 2864 6629 206f  eries_like(df) o
-0003d370: 7220 6973 5f69 6e64 6578 5f6c 696b 6528  r is_index_like(
-0003d380: 6466 293a 0a20 2020 2020 2020 2069 6620  df):.        if 
-0003d390: 6e6f 7420 6c65 6e28 6466 293a 0a20 2020  not len(df):.   
-0003d3a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0003d3b0: 6d65 7461 0a20 2020 2020 2020 2069 6620  meta.        if 
-0003d3c0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-0003d3d0: 6528 6466 293a 0a20 2020 2020 2020 2020  e(df):.         
-0003d3e0: 2020 2063 6865 636b 5f6d 6174 6368 696e     check_matchin
-0003d3f0: 675f 636f 6c75 6d6e 7328 6d65 7461 2c20  g_columns(meta, 
-0003d400: 6466 290a 2020 2020 2020 2020 2020 2020  df).            
-0003d410: 6320 3d20 6d65 7461 2e63 6f6c 756d 6e73  c = meta.columns
-0003d420: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0003d430: 2020 2020 2020 2020 2020 2063 203d 206d             c = m
-0003d440: 6574 612e 6e61 6d65 0a20 2020 2020 2020  eta.name.       
-0003d450: 2072 6574 7572 6e20 5f72 656e 616d 6528   return _rename(
-0003d460: 632c 2064 6629 0a20 2020 2072 6574 7572  c, df).    retur
-0003d470: 6e20 6466 0a0a 0a64 6566 205f 7265 6e61  n df...def _rena
-0003d480: 6d65 2863 6f6c 756d 6e73 2c20 6466 293a  me(columns, df):
-0003d490: 0a20 2020 2022 2222 0a20 2020 2052 656e  .    """.    Ren
-0003d4a0: 616d 6520 636f 6c75 6d6e 7320 6f66 2070  ame columns of p
-0003d4b0: 642e 4461 7461 4672 616d 6520 6f72 206e  d.DataFrame or n
-0003d4c0: 616d 6520 6f66 2070 642e 5365 7269 6573  ame of pd.Series
-0003d4d0: 2e0a 2020 2020 4e6f 7420 666f 7220 6464  ..    Not for dd
-0003d4e0: 2e44 6174 6146 7261 6d65 206f 7220 6464  .DataFrame or dd
-0003d4f0: 2e53 6572 6965 732e 0a0a 2020 2020 5061  .Series...    Pa
-0003d500: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-0003d510: 2d2d 2d2d 2d2d 2d0a 2020 2020 636f 6c75  -------.    colu
-0003d520: 6d6e 7320 3a20 7475 706c 652c 2073 7472  mns : tuple, str
-0003d530: 696e 672c 2070 642e 4461 7461 4672 616d  ing, pd.DataFram
-0003d540: 6520 6f72 2070 642e 5365 7269 6573 0a20  e or pd.Series. 
-0003d550: 2020 2020 2020 2043 6f6c 756d 6e20 6e61         Column na
-0003d560: 6d65 732c 2053 6572 6965 7320 6e61 6d65  mes, Series name
-0003d570: 206f 7220 7061 6e64 6173 2069 6e73 7461   or pandas insta
-0003d580: 6e63 6520 7768 6963 6820 6861 7320 7468  nce which has th
-0003d590: 650a 2020 2020 2020 2020 7461 7267 6574  e.        target
-0003d5a0: 2063 6f6c 756d 6e20 6e61 6d65 7320 2f20   column names / 
-0003d5b0: 6e61 6d65 2e0a 2020 2020 6466 203a 2070  name..    df : p
-0003d5c0: 642e 4461 7461 4672 616d 6520 6f72 2070  d.DataFrame or p
-0003d5d0: 642e 5365 7269 6573 0a20 2020 2020 2020  d.Series.       
-0003d5e0: 2074 6172 6765 7420 4461 7461 4672 616d   target DataFram
-0003d5f0: 6520 2f20 5365 7269 6573 2074 6f20 6265  e / Series to be
-0003d600: 2072 656e 616d 6564 0a20 2020 2022 2222   renamed.    """
-0003d610: 0a20 2020 2061 7373 6572 7420 6e6f 7420  .    assert not 
-0003d620: 6973 696e 7374 616e 6365 2864 662c 205f  isinstance(df, _
-0003d630: 4672 616d 6529 0a0a 2020 2020 6966 2063  Frame)..    if c
-0003d640: 6f6c 756d 6e73 2069 7320 6e6f 5f64 6566  olumns is no_def
-0003d650: 6175 6c74 3a0a 2020 2020 2020 2020 7265  ault:.        re
-0003d660: 7475 726e 2064 660a 0a20 2020 2069 6620  turn df..    if 
-0003d670: 6973 696e 7374 616e 6365 2863 6f6c 756d  isinstance(colum
-0003d680: 6e73 2c20 4974 6572 6174 6f72 293a 0a20  ns, Iterator):. 
-0003d690: 2020 2020 2020 2063 6f6c 756d 6e73 203d         columns =
-0003d6a0: 206c 6973 7428 636f 6c75 6d6e 7329 0a0a   list(columns)..
-0003d6b0: 2020 2020 6966 2069 735f 6461 7461 6672      if is_datafr
-0003d6c0: 616d 655f 6c69 6b65 2864 6629 3a0a 2020  ame_like(df):.  
-0003d6d0: 2020 2020 2020 6966 2069 735f 6461 7461        if is_data
-0003d6e0: 6672 616d 655f 6c69 6b65 2863 6f6c 756d  frame_like(colum
-0003d6f0: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
-0003d700: 2063 6f6c 756d 6e73 203d 2063 6f6c 756d   columns = colum
-0003d710: 6e73 2e63 6f6c 756d 6e73 0a20 2020 2020  ns.columns.     
-0003d720: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-0003d730: 616e 6365 2863 6f6c 756d 6e73 2c20 7064  ance(columns, pd
-0003d740: 2e49 6e64 6578 293a 0a20 2020 2020 2020  .Index):.       
-0003d750: 2020 2020 2063 6f6c 756d 6e73 203d 2070       columns = p
-0003d760: 642e 496e 6465 7828 636f 6c75 6d6e 7329  d.Index(columns)
-0003d770: 0a20 2020 2020 2020 2069 6620 280a 2020  .        if (.  
-0003d780: 2020 2020 2020 2020 2020 6c65 6e28 636f            len(co
-0003d790: 6c75 6d6e 7329 203d 3d20 6c65 6e28 6466  lumns) == len(df
-0003d7a0: 2e63 6f6c 756d 6e73 290a 2020 2020 2020  .columns).      
-0003d7b0: 2020 2020 2020 616e 6420 7479 7065 2863        and type(c
-0003d7c0: 6f6c 756d 6e73 2920 6973 2074 7970 6528  olumns) is type(
-0003d7d0: 6466 2e63 6f6c 756d 6e73 290a 2020 2020  df.columns).    
-0003d7e0: 2020 2020 2020 2020 616e 6420 636f 6c75          and colu
-0003d7f0: 6d6e 732e 6474 7970 6520 3d3d 2064 662e  mns.dtype == df.
-0003d800: 636f 6c75 6d6e 732e 6474 7970 650a 2020  columns.dtype.  
-0003d810: 2020 2020 2020 2020 2020 616e 6420 636f            and co
-0003d820: 6c75 6d6e 732e 6571 7561 6c73 2864 662e  lumns.equals(df.
-0003d830: 636f 6c75 6d6e 7329 0a20 2020 2020 2020  columns).       
-0003d840: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-0003d850: 2320 6966 2074 6172 6765 7420 6973 2069  # if target is i
-0003d860: 6465 6e74 6963 616c 2c20 7265 6e61 6d65  dentical, rename
-0003d870: 2069 7320 6e6f 7420 6e65 6365 7373 6172   is not necessar
-0003d880: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
-0003d890: 7475 726e 2064 660a 2020 2020 2020 2020  turn df.        
-0003d8a0: 2320 6465 6570 3d46 616c 7365 2064 6f65  # deep=False doe
-0003d8b0: 736e 2774 2064 6f65 736e 2774 2063 6f70  sn't doesn't cop
-0003d8c0: 7920 616e 7920 6461 7461 2f69 6e64 6963  y any data/indic
-0003d8d0: 6573 2c20 736f 2074 6869 7320 6973 2063  es, so this is c
-0003d8e0: 6865 6170 0a20 2020 2020 2020 2064 6620  heap.        df 
-0003d8f0: 3d20 6466 2e63 6f70 7928 6465 6570 3d46  = df.copy(deep=F
-0003d900: 616c 7365 290a 2020 2020 2020 2020 6466  alse).        df
-0003d910: 2e63 6f6c 756d 6e73 203d 2063 6f6c 756d  .columns = colum
-0003d920: 6e73 0a20 2020 2020 2020 2072 6574 7572  ns.        retur
-0003d930: 6e20 6466 0a20 2020 2065 6c69 6620 6973  n df.    elif is
-0003d940: 5f73 6572 6965 735f 6c69 6b65 2864 6629  _series_like(df)
-0003d950: 206f 7220 6973 5f69 6e64 6578 5f6c 696b   or is_index_lik
-0003d960: 6528 6466 293a 0a20 2020 2020 2020 2069  e(df):.        i
-0003d970: 6620 6973 5f73 6572 6965 735f 6c69 6b65  f is_series_like
-0003d980: 2863 6f6c 756d 6e73 2920 6f72 2069 735f  (columns) or is_
-0003d990: 696e 6465 785f 6c69 6b65 2863 6f6c 756d  index_like(colum
-0003d9a0: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
-0003d9b0: 2063 6f6c 756d 6e73 203d 2063 6f6c 756d   columns = colum
-0003d9c0: 6e73 2e6e 616d 650a 2020 2020 2020 2020  ns.name.        
-0003d9d0: 6966 2064 662e 6e61 6d65 203d 3d20 636f  if df.name == co
-0003d9e0: 6c75 6d6e 733a 0a20 2020 2020 2020 2020  lumns:.         
-0003d9f0: 2020 2072 6574 7572 6e20 6466 0a20 2020     return df.   
-0003da00: 2020 2020 2072 6574 7572 6e20 6466 2e72       return df.r
-0003da10: 656e 616d 6528 636f 6c75 6d6e 7329 0a20  ename(columns). 
-0003da20: 2020 2023 206d 6170 5f70 6172 7469 7469     # map_partiti
-0003da30: 6f6e 206d 6179 2070 6173 7320 6f74 6865  on may pass othe
-0003da40: 7220 7479 7065 730a 2020 2020 7265 7475  r types.    retu
-0003da50: 726e 2064 660a 0a0a 6465 6620 5f72 656e  rn df...def _ren
-0003da60: 616d 655f 6461 736b 2864 662c 206e 616d  ame_dask(df, nam
-0003da70: 6573 293a 0a20 2020 2022 2222 0a20 2020  es):.    """.   
-0003da80: 2044 6573 7472 7563 7469 7665 6c79 2072   Destructively r
-0003da90: 656e 616d 6520 636f 6c75 6d6e 7320 6f66  ename columns of
-0003daa0: 2064 642e 4461 7461 4672 616d 6520 6f72   dd.DataFrame or
-0003dab0: 206e 616d 6520 6f66 2064 642e 5365 7269   name of dd.Seri
-0003dac0: 6573 2e0a 2020 2020 4e6f 7420 666f 7220  es..    Not for 
-0003dad0: 7064 2e44 6174 6146 7261 6d65 206f 7220  pd.DataFrame or 
-0003dae0: 7064 2e53 6572 6965 732e 0a0a 2020 2020  pd.Series...    
-0003daf0: 496e 7465 726e 616c 6c79 2075 7365 6420  Internally used 
-0003db00: 746f 206f 7665 7277 7269 7465 2064 642e  to overwrite dd.
-0003db10: 4461 7461 4672 616d 652e 636f 6c75 6d6e  DataFrame.column
-0003db20: 7320 616e 6420 6464 2e53 6572 6965 732e  s and dd.Series.
-0003db30: 6e61 6d65 0a20 2020 2057 6520 6361 6e27  name.    We can'
-0003db40: 7420 7573 6520 6d61 705f 7061 7274 6974  t use map_partit
-0003db50: 696f 6e20 6265 6361 7573 6520 6974 2061  ion because it a
-0003db60: 7070 6c69 6573 2066 756e 6374 696f 6e20  pplies function 
-0003db70: 7468 656e 2072 656e 616d 650a 0a20 2020  then rename..   
-0003db80: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0003db90: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064  ----------.    d
-0003dba0: 6620 3a20 6464 2e44 6174 6146 7261 6d65  f : dd.DataFrame
-0003dbb0: 206f 7220 6464 2e53 6572 6965 730a 2020   or dd.Series.  
-0003dbc0: 2020 2020 2020 7461 7267 6574 2044 6174        target Dat
-0003dbd0: 6146 7261 6d65 202f 2053 6572 6965 7320  aFrame / Series 
-0003dbe0: 746f 2062 6520 7265 6e61 6d65 640a 2020  to be renamed.  
-0003dbf0: 2020 6e61 6d65 7320 3a20 7475 706c 652c    names : tuple,
-0003dc00: 2073 7472 696e 670a 2020 2020 2020 2020   string.        
-0003dc10: 436f 6c75 6d6e 206e 616d 6573 2f53 6572  Column names/Ser
-0003dc20: 6965 7320 6e61 6d65 0a20 2020 2022 2222  ies name.    """
-0003dc30: 0a0a 2020 2020 6173 7365 7274 2069 7369  ..    assert isi
-0003dc40: 6e73 7461 6e63 6528 6466 2c20 5f46 7261  nstance(df, _Fra
-0003dc50: 6d65 290a 2020 2020 6d65 7461 6461 7461  me).    metadata
-0003dc60: 203d 205f 7265 6e61 6d65 286e 616d 6573   = _rename(names
-0003dc70: 2c20 6466 2e5f 6d65 7461 290a 2020 2020  , df._meta).    
-0003dc80: 6e61 6d65 203d 2066 2272 656e 616d 652d  name = f"rename-
-0003dc90: 7b74 6f6b 656e 697a 6528 6466 2c20 6d65  {tokenize(df, me
-0003dca0: 7461 6461 7461 297d 220a 0a20 2020 2064  tadata)}"..    d
-0003dcb0: 736b 203d 2070 6172 7469 7469 6f6e 7769  sk = partitionwi
-0003dcc0: 7365 5f67 7261 7068 285f 7265 6e61 6d65  se_graph(_rename
-0003dcd0: 2c20 6e61 6d65 2c20 6d65 7461 6461 7461  , name, metadata
-0003dce0: 2c20 6466 290a 2020 2020 6772 6170 6820  , df).    graph 
-0003dcf0: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-0003dd00: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-0003dd10: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
-0003dd20: 656e 6465 6e63 6965 733d 5b64 665d 290a  endencies=[df]).
-0003dd30: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
-0003dd40: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
-0003dd50: 6e61 6d65 2c20 6d65 7461 6461 7461 2c20  name, metadata, 
-0003dd60: 6466 2e64 6976 6973 696f 6e73 290a 0a0a  df.divisions)...
-0003dd70: 6465 6620 7175 616e 7469 6c65 2864 662c  def quantile(df,
-0003dd80: 2071 2c20 6d65 7468 6f64 3d22 6465 6661   q, method="defa
-0003dd90: 756c 7422 293a 0a20 2020 2022 2222 4170  ult"):.    """Ap
-0003dda0: 7072 6f78 696d 6174 6520 7175 616e 7469  proximate quanti
-0003ddb0: 6c65 7320 6f66 2053 6572 6965 732e 0a0a  les of Series...
-0003ddc0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-0003ddd0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-0003dde0: 2020 7120 3a20 6c69 7374 2f61 7272 6179    q : list/array
-0003ddf0: 206f 6620 666c 6f61 7473 0a20 2020 2020   of floats.     
-0003de00: 2020 2049 7465 7261 626c 6520 6f66 206e     Iterable of n
-0003de10: 756d 6265 7273 2072 616e 6769 6e67 2066  umbers ranging f
-0003de20: 726f 6d20 3020 746f 2031 3030 2066 6f72  rom 0 to 100 for
-0003de30: 2074 6865 2064 6573 6972 6564 2071 7561   the desired qua
-0003de40: 6e74 696c 6573 0a20 2020 206d 6574 686f  ntiles.    metho
-0003de50: 6420 3a20 7b27 6465 6661 756c 7427 2c20  d : {'default', 
-0003de60: 2774 6469 6765 7374 272c 2027 6461 736b  'tdigest', 'dask
-0003de70: 277d 2c20 6f70 7469 6f6e 616c 0a20 2020  '}, optional.   
-0003de80: 2020 2020 2057 6861 7420 6d65 7468 6f64       What method
-0003de90: 2074 6f20 7573 652e 2042 7920 6465 6661   to use. By defa
-0003dea0: 756c 7420 7769 6c6c 2075 7365 2064 6173  ult will use das
-0003deb0: 6b27 7320 696e 7465 726e 616c 2063 7573  k's internal cus
-0003dec0: 746f 6d0a 2020 2020 2020 2020 616c 676f  tom.        algo
-0003ded0: 7269 7468 6d20 2860 6027 6461 736b 2760  rithm (``'dask'`
-0003dee0: 6029 2e20 2049 6620 7365 7420 746f 2060  `).  If set to `
-0003def0: 6027 7464 6967 6573 7427 6060 2077 696c  `'tdigest'`` wil
-0003df00: 6c20 7573 6520 7464 6967 6573 7420 666f  l use tdigest fo
-0003df10: 720a 2020 2020 2020 2020 666c 6f61 7473  r.        floats
-0003df20: 2061 6e64 2069 6e74 7320 616e 6420 6661   and ints and fa
-0003df30: 6c6c 6261 636b 2074 6f20 7468 6520 6060  llback to the ``
-0003df40: 2764 6173 6b27 6060 206f 7468 6572 7769  'dask'`` otherwi
-0003df50: 7365 2e0a 2020 2020 2222 220a 2020 2020  se..    """.    
-0003df60: 2320 6375 7272 656e 7420 696d 706c 656d  # current implem
-0003df70: 656e 7461 7469 6f6e 206e 6565 6473 2071  entation needs q
-0003df80: 2074 6f20 6265 2073 6f72 7465 6420 736f   to be sorted so
-0003df90: 0a20 2020 2023 2073 6f72 7420 6966 2061  .    # sort if a
-0003dfa0: 7272 6179 2d6c 696b 652c 206f 7468 6572  rray-like, other
-0003dfb0: 7769 7365 206c 6561 7665 2069 7420 616c  wise leave it al
-0003dfc0: 6f6e 650a 2020 2020 715f 6e64 6172 7261  one.    q_ndarra
-0003dfd0: 7920 3d20 6e70 2e61 7272 6179 2871 290a  y = np.array(q).
-0003dfe0: 2020 2020 6966 2071 5f6e 6461 7272 6179      if q_ndarray
-0003dff0: 2e6e 6469 6d20 3e20 303a 0a20 2020 2020  .ndim > 0:.     
-0003e000: 2020 2071 5f6e 6461 7272 6179 2e73 6f72     q_ndarray.sor
-0003e010: 7428 6b69 6e64 3d22 6d65 7267 6573 6f72  t(kind="mergesor
-0003e020: 7422 290a 2020 2020 2020 2020 7120 3d20  t").        q = 
-0003e030: 715f 6e64 6172 7261 790a 0a20 2020 2061  q_ndarray..    a
-0003e040: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-0003e050: 2864 662c 2053 6572 6965 7329 0a0a 2020  (df, Series)..  
-0003e060: 2020 616c 6c6f 7765 645f 6d65 7468 6f64    allowed_method
-0003e070: 7320 3d20 5b22 6465 6661 756c 7422 2c20  s = ["default", 
-0003e080: 2264 6173 6b22 2c20 2274 6469 6765 7374  "dask", "tdigest
-0003e090: 225d 0a20 2020 2069 6620 6d65 7468 6f64  "].    if method
-0003e0a0: 206e 6f74 2069 6e20 616c 6c6f 7765 645f   not in allowed_
-0003e0b0: 6d65 7468 6f64 733a 0a20 2020 2020 2020  methods:.       
-0003e0c0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0003e0d0: 7228 226d 6574 686f 6420 6361 6e20 6f6e  r("method can on
-0003e0e0: 6c79 2062 6520 2764 6566 6175 6c74 272c  ly be 'default',
-0003e0f0: 2027 6461 736b 2720 6f72 2027 7464 6967   'dask' or 'tdig
-0003e100: 6573 7427 2229 0a0a 2020 2020 6966 206d  est'")..    if m
-0003e110: 6574 686f 6420 3d3d 2022 6465 6661 756c  ethod == "defaul
-0003e120: 7422 3a0a 2020 2020 2020 2020 696e 7465  t":.        inte
-0003e130: 726e 616c 5f6d 6574 686f 6420 3d20 2264  rnal_method = "d
-0003e140: 6173 6b22 0a20 2020 2065 6c73 653a 0a20  ask".    else:. 
-0003e150: 2020 2020 2020 2069 6e74 6572 6e61 6c5f         internal_
-0003e160: 6d65 7468 6f64 203d 206d 6574 686f 640a  method = method.
-0003e170: 0a20 2020 2023 2063 7572 7265 6e74 6c79  .    # currently
-0003e180: 2c20 6f6e 6c79 2053 6572 6965 7320 6861  , only Series ha
-0003e190: 7320 7175 616e 7469 6c65 206d 6574 686f  s quantile metho
-0003e1a0: 640a 2020 2020 6966 2069 7369 6e73 7461  d.    if isinsta
-0003e1b0: 6e63 6528 6466 2c20 496e 6465 7829 3a0a  nce(df, Index):.
-0003e1c0: 2020 2020 2020 2020 7365 7269 6573 5f74          series_t
-0003e1d0: 7970 203d 2064 662e 5f6d 6574 612e 746f  yp = df._meta.to
-0003e1e0: 5f73 6572 6965 7328 292e 5f63 6f6e 7374  _series()._const
-0003e1f0: 7275 6374 6f72 0a20 2020 2020 2020 206d  ructor.        m
-0003e200: 6574 6120 3d20 6466 2e5f 6d65 7461 5f6e  eta = df._meta_n
-0003e210: 6f6e 656d 7074 792e 746f 5f73 6572 6965  onempty.to_serie
-0003e220: 7328 292e 7175 616e 7469 6c65 2871 290a  s().quantile(q).
-0003e230: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0003e240: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
-0003e250: 696b 6528 6466 2e5f 6d65 7461 293a 0a20  ike(df._meta):. 
-0003e260: 2020 2020 2020 2020 2020 2073 6572 6965             serie
-0003e270: 735f 7479 7020 3d20 6466 2e5f 6d65 7461  s_typ = df._meta
-0003e280: 2e5f 636f 6e73 7472 7563 746f 720a 2020  ._constructor.  
-0003e290: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0003e2a0: 2020 2020 2020 2020 7365 7269 6573 5f74          series_t
-0003e2b0: 7970 203d 2064 662e 5f6d 6574 612e 5f63  yp = df._meta._c
-0003e2c0: 6f6e 7374 7275 6374 6f72 5f73 6c69 6365  onstructor_slice
-0003e2d0: 640a 2020 2020 2020 2020 6d65 7461 203d  d.        meta =
-0003e2e0: 2064 662e 5f6d 6574 615f 6e6f 6e65 6d70   df._meta_nonemp
-0003e2f0: 7479 2e71 7561 6e74 696c 6528 7129 0a0a  ty.quantile(q)..
-0003e300: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
-0003e310: 5f6c 696b 6528 6d65 7461 293a 0a20 2020  _like(meta):.   
-0003e320: 2020 2020 2023 2049 6e64 6578 2e71 7561       # Index.qua
-0003e330: 6e74 696c 6528 6c69 7374 2d6c 696b 6529  ntile(list-like)
-0003e340: 206d 7573 7420 6265 2070 642e 5365 7269   must be pd.Seri
-0003e350: 6573 2c20 6e6f 7420 7064 2e49 6e64 6578  es, not pd.Index
-0003e360: 0a20 2020 2020 2020 2064 665f 6e61 6d65  .        df_name
-0003e370: 203d 2064 662e 6e61 6d65 0a20 2020 2020   = df.name.     
-0003e380: 2020 2066 696e 616c 697a 655f 7473 6b20     finalize_tsk 
-0003e390: 3d20 6c61 6d62 6461 2074 736b 3a20 2873  = lambda tsk: (s
-0003e3a0: 6572 6965 735f 7479 702c 2074 736b 2c20  eries_typ, tsk, 
-0003e3b0: 712c 204e 6f6e 652c 2064 665f 6e61 6d65  q, None, df_name
-0003e3c0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0003e3d0: 5f74 7970 6520 3d20 5365 7269 6573 0a20  _type = Series. 
-0003e3e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0003e3f0: 2066 696e 616c 697a 655f 7473 6b20 3d20   finalize_tsk = 
-0003e400: 6c61 6d62 6461 2074 736b 3a20 2867 6574  lambda tsk: (get
-0003e410: 6974 656d 2c20 7473 6b2c 2030 290a 2020  item, tsk, 0).  
-0003e420: 2020 2020 2020 7265 7475 726e 5f74 7970        return_typ
-0003e430: 6520 3d20 5363 616c 6172 0a20 2020 2020  e = Scalar.     
-0003e440: 2020 2071 203d 205b 715d 0a0a 2020 2020     q = [q]..    
-0003e450: 2320 7061 6e64 6173 2075 7365 7320 7175  # pandas uses qu
-0003e460: 616e 7469 6c65 2069 6e20 5b30 2c20 315d  antile in [0, 1]
-0003e470: 0a20 2020 2023 206e 756d 7079 202f 2065  .    # numpy / e
-0003e480: 7665 7279 6f6e 6520 656c 7365 2075 7365  veryone else use
-0003e490: 7320 5b30 2c20 3130 305d 0a20 2020 2071  s [0, 100].    q
-0003e4a0: 7320 3d20 6e70 2e61 7361 7272 6179 2871  s = np.asarray(q
-0003e4b0: 2920 2a20 3130 300a 2020 2020 746f 6b65  ) * 100.    toke
-0003e4c0: 6e20 3d20 746f 6b65 6e69 7a65 2864 662c  n = tokenize(df,
-0003e4d0: 2071 7329 0a0a 2020 2020 6966 206c 656e   qs)..    if len
-0003e4e0: 2871 7329 203d 3d20 303a 0a20 2020 2020  (qs) == 0:.     
-0003e4f0: 2020 206e 616d 6520 3d20 2271 7561 6e74     name = "quant
-0003e500: 696c 6573 2d22 202b 2074 6f6b 656e 0a20  iles-" + token. 
-0003e510: 2020 2020 2020 2065 6d70 7479 5f69 6e64         empty_ind
-0003e520: 6578 203d 2070 642e 496e 6465 7828 5b5d  ex = pd.Index([]
-0003e530: 2c20 6474 7970 653d 666c 6f61 7429 0a0a  , dtype=float)..
-0003e540: 2020 2020 2020 2020 7265 7475 726e 2053          return S
-0003e550: 6572 6965 7328 0a20 2020 2020 2020 2020  eries(.         
-0003e560: 2020 207b 286e 616d 652c 2030 293a 2073     {(name, 0): s
-0003e570: 6572 6965 735f 7479 7028 5b5d 2c20 6e61  eries_typ([], na
-0003e580: 6d65 3d64 662e 6e61 6d65 2c20 696e 6465  me=df.name, inde
-0003e590: 783d 656d 7074 795f 696e 6465 782c 2064  x=empty_index, d
-0003e5a0: 7479 7065 3d22 666c 6f61 7422 297d 2c0a  type="float")},.
-0003e5b0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-0003e5c0: 2c0a 2020 2020 2020 2020 2020 2020 6466  ,.            df
-0003e5d0: 2e5f 6d65 7461 2c0a 2020 2020 2020 2020  ._meta,.        
-0003e5e0: 2020 2020 5b4e 6f6e 652c 204e 6f6e 655d      [None, None]
-0003e5f0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0003e600: 656c 7365 3a0a 2020 2020 2020 2020 6e65  else:.        ne
-0003e610: 775f 6469 7669 7369 6f6e 7320 3d20 5b6e  w_divisions = [n
-0003e620: 702e 6d69 6e28 7129 2c20 6e70 2e6d 6178  p.min(q), np.max
-0003e630: 2871 295d 0a0a 2020 2020 6466 203d 2064  (q)]..    df = d
-0003e640: 662e 6472 6f70 6e61 2829 0a0a 2020 2020  f.dropna()..    
-0003e650: 6966 2069 6e74 6572 6e61 6c5f 6d65 7468  if internal_meth
-0003e660: 6f64 203d 3d20 2274 6469 6765 7374 2220  od == "tdigest" 
-0003e670: 616e 6420 280a 2020 2020 2020 2020 6e70  and (.        np
-0003e680: 2e69 7373 7562 6474 7970 6528 6466 2e64  .issubdtype(df.d
-0003e690: 7479 7065 2c20 6e70 2e66 6c6f 6174 696e  type, np.floatin
-0003e6a0: 6729 206f 7220 6e70 2e69 7373 7562 6474  g) or np.issubdt
-0003e6b0: 7970 6528 6466 2e64 7479 7065 2c20 6e70  ype(df.dtype, np
-0003e6c0: 2e69 6e74 6567 6572 290a 2020 2020 293a  .integer).    ):
-0003e6d0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-0003e6e0: 736b 2e75 7469 6c73 2069 6d70 6f72 7420  sk.utils import 
-0003e6f0: 696d 706f 7274 5f72 6571 7569 7265 640a  import_required.
-0003e700: 0a20 2020 2020 2020 2069 6d70 6f72 745f  .        import_
-0003e710: 7265 7175 6972 6564 280a 2020 2020 2020  required(.      
-0003e720: 2020 2020 2020 2263 7269 636b 222c 2022        "crick", "
-0003e730: 6372 6963 6b20 6973 2061 2072 6571 7569  crick is a requi
-0003e740: 7265 6420 6465 7065 6e64 656e 6379 2066  red dependency f
-0003e750: 6f72 2075 7369 6e67 2074 6865 2074 2d64  or using the t-d
-0003e760: 6967 6573 7420 6d65 7468 6f64 2e22 0a20  igest method.". 
-0003e770: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0003e780: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-0003e790: 792e 7065 7263 656e 7469 6c65 2069 6d70  y.percentile imp
-0003e7a0: 6f72 7420 5f70 6572 6365 6e74 696c 6573  ort _percentiles
-0003e7b0: 5f66 726f 6d5f 7464 6967 6573 742c 205f  _from_tdigest, _
-0003e7c0: 7464 6967 6573 745f 6368 756e 6b0a 0a20  tdigest_chunk.. 
-0003e7d0: 2020 2020 2020 206e 616d 6520 3d20 2271         name = "q
-0003e7e0: 7561 6e74 696c 6573 5f74 6469 6765 7374  uantiles_tdigest
-0003e7f0: 2d31 2d22 202b 2074 6f6b 656e 0a20 2020  -1-" + token.   
-0003e800: 2020 2020 2076 616c 5f64 736b 203d 207b       val_dsk = {
-0003e810: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
-0003e820: 6d65 2c20 6929 3a20 285f 7464 6967 6573  me, i): (_tdiges
-0003e830: 745f 6368 756e 6b2c 2028 6765 7461 7474  t_chunk, (getatt
-0003e840: 722c 206b 6579 2c20 2276 616c 7565 7322  r, key, "values"
-0003e850: 2929 0a20 2020 2020 2020 2020 2020 2066  )).            f
-0003e860: 6f72 2069 2c20 6b65 7920 696e 2065 6e75  or i, key in enu
-0003e870: 6d65 7261 7465 2864 662e 5f5f 6461 736b  merate(df.__dask
-0003e880: 5f6b 6579 735f 5f28 2929 0a20 2020 2020  _keys__()).     
-0003e890: 2020 207d 0a0a 2020 2020 2020 2020 6e61     }..        na
-0003e8a0: 6d65 3220 3d20 2271 7561 6e74 696c 6573  me2 = "quantiles
-0003e8b0: 5f74 6469 6765 7374 2d32 2d22 202b 2074  _tdigest-2-" + t
-0003e8c0: 6f6b 656e 0a20 2020 2020 2020 206d 6572  oken.        mer
-0003e8d0: 6765 5f64 736b 203d 207b 0a20 2020 2020  ge_dsk = {.     
-0003e8e0: 2020 2020 2020 2028 6e61 6d65 322c 2030         (name2, 0
-0003e8f0: 293a 2066 696e 616c 697a 655f 7473 6b28  ): finalize_tsk(
-0003e900: 285f 7065 7263 656e 7469 6c65 735f 6672  (_percentiles_fr
-0003e910: 6f6d 5f74 6469 6765 7374 2c20 7173 2c20  om_tdigest, qs, 
-0003e920: 736f 7274 6564 2876 616c 5f64 736b 2929  sorted(val_dsk))
-0003e930: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
-0003e940: 656c 7365 3a0a 2020 2020 2020 2020 6672  else:.        fr
-0003e950: 6f6d 2064 6173 6b2e 6172 7261 792e 6469  om dask.array.di
-0003e960: 7370 6174 6368 2069 6d70 6f72 7420 7065  spatch import pe
-0003e970: 7263 656e 7469 6c65 5f6c 6f6f 6b75 7020  rcentile_lookup 
-0003e980: 6173 205f 7065 7263 656e 7469 6c65 0a20  as _percentile. 
-0003e990: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-0003e9a0: 2e61 7272 6179 2e70 6572 6365 6e74 696c  .array.percentil
-0003e9b0: 6520 696d 706f 7274 206d 6572 6765 5f70  e import merge_p
-0003e9c0: 6572 6365 6e74 696c 6573 0a0a 2020 2020  ercentiles..    
-0003e9d0: 2020 2020 2320 4164 6420 3020 616e 6420      # Add 0 and 
-0003e9e0: 3130 3020 6475 7269 6e67 2063 616c 6375  100 during calcu
-0003e9f0: 6c61 7469 6f6e 2066 6f72 206d 6f72 6520  lation for more 
-0003ea00: 726f 6275 7374 2062 6568 6176 696f 7220  robust behavior 
-0003ea10: 2868 6f70 6566 756c 6c79 290a 2020 2020  (hopefully).    
-0003ea20: 2020 2020 6361 6c63 5f71 7320 3d20 6e70      calc_qs = np
-0003ea30: 2e70 6164 2871 732c 2031 2c20 6d6f 6465  .pad(qs, 1, mode
-0003ea40: 3d22 636f 6e73 7461 6e74 2229 0a20 2020  ="constant").   
-0003ea50: 2020 2020 2063 616c 635f 7173 5b2d 315d       calc_qs[-1]
-0003ea60: 203d 2031 3030 0a20 2020 2020 2020 206e   = 100.        n
-0003ea70: 616d 6520 3d20 2271 7561 6e74 696c 6573  ame = "quantiles
-0003ea80: 2d31 2d22 202b 2074 6f6b 656e 0a20 2020  -1-" + token.   
-0003ea90: 2020 2020 2076 616c 5f64 736b 203d 207b       val_dsk = {
-0003eaa0: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
-0003eab0: 6d65 2c20 6929 3a20 285f 7065 7263 656e  me, i): (_percen
-0003eac0: 7469 6c65 2c20 6b65 792c 2063 616c 635f  tile, key, calc_
-0003ead0: 7173 290a 2020 2020 2020 2020 2020 2020  qs).            
-0003eae0: 666f 7220 692c 206b 6579 2069 6e20 656e  for i, key in en
-0003eaf0: 756d 6572 6174 6528 6466 2e5f 5f64 6173  umerate(df.__das
-0003eb00: 6b5f 6b65 7973 5f5f 2829 290a 2020 2020  k_keys__()).    
-0003eb10: 2020 2020 7d0a 0a20 2020 2020 2020 206e      }..        n
-0003eb20: 616d 6532 203d 2022 7175 616e 7469 6c65  ame2 = "quantile
-0003eb30: 732d 322d 2220 2b20 746f 6b65 6e0a 2020  s-2-" + token.  
-0003eb40: 2020 2020 2020 6d65 7267 655f 6473 6b20        merge_dsk 
-0003eb50: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-0003eb60: 286e 616d 6532 2c20 3029 3a20 6669 6e61  (name2, 0): fina
-0003eb70: 6c69 7a65 5f74 736b 280a 2020 2020 2020  lize_tsk(.      
-0003eb80: 2020 2020 2020 2020 2020 280a 2020 2020            (.    
-0003eb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eba0: 6d65 7267 655f 7065 7263 656e 7469 6c65  merge_percentile
-0003ebb0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0003ebc0: 2020 2020 2020 2071 732c 0a20 2020 2020         qs,.     
-0003ebd0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0003ebe0: 6361 6c63 5f71 735d 202a 2064 662e 6e70  calc_qs] * df.np
-0003ebf0: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
-0003ec00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0003ec10: 6f72 7465 6428 7661 6c5f 6473 6b29 2c0a  orted(val_dsk),.
-0003ec20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ec30: 2020 2020 226c 6f77 6572 222c 0a20 2020      "lower",.   
-0003ec40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ec50: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0003ec60: 2020 2020 2020 2020 2020 2046 616c 7365             False
-0003ec70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003ec80: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0003ec90: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
-0003eca0: 6473 6b20 3d20 6d65 7267 6528 7661 6c5f  dsk = merge(val_
-0003ecb0: 6473 6b2c 206d 6572 6765 5f64 736b 290a  dsk, merge_dsk).
-0003ecc0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
-0003ecd0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
-0003ece0: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
-0003ecf0: 322c 2064 736b 2c20 6465 7065 6e64 656e  2, dsk, dependen
-0003ed00: 6369 6573 3d5b 6466 5d29 0a20 2020 2072  cies=[df]).    r
-0003ed10: 6574 7572 6e20 7265 7475 726e 5f74 7970  eturn return_typ
-0003ed20: 6528 6772 6170 682c 206e 616d 6532 2c20  e(graph, name2, 
-0003ed30: 6d65 7461 2c20 6e65 775f 6469 7669 7369  meta, new_divisi
-0003ed40: 6f6e 7329 0a0a 0a64 6566 205f 636f 765f  ons)...def _cov_
-0003ed50: 636f 7272 280a 2020 2020 6466 2c0a 2020  corr(.    df,.  
-0003ed60: 2020 6d69 6e5f 7065 7269 6f64 733d 4e6f    min_periods=No
-0003ed70: 6e65 2c0a 2020 2020 636f 7272 3d46 616c  ne,.    corr=Fal
-0003ed80: 7365 2c0a 2020 2020 7363 616c 6172 3d46  se,.    scalar=F
-0003ed90: 616c 7365 2c0a 2020 2020 6e75 6d65 7269  alse,.    numeri
-0003eda0: 635f 6f6e 6c79 3d6e 6f5f 6465 6661 756c  c_only=no_defaul
-0003edb0: 742c 0a20 2020 2073 706c 6974 5f65 7665  t,.    split_eve
-0003edc0: 7279 3d46 616c 7365 2c0a 293a 0a20 2020  ry=False,.):.   
-0003edd0: 2022 2222 4461 7461 4672 616d 6520 636f   """DataFrame co
-0003ede0: 7661 7269 616e 6365 2061 6e64 2070 6561  variance and pea
-0003edf0: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
-0003ee00: 2e0a 0a20 2020 2043 6f6d 7075 7465 7320  ...    Computes 
-0003ee10: 7061 6972 7769 7365 2063 6f76 6172 6961  pairwise covaria
-0003ee20: 6e63 6520 6f72 2063 6f72 7265 6c61 7469  nce or correlati
-0003ee30: 6f6e 206f 6620 636f 6c75 6d6e 732c 2065  on of columns, e
-0003ee40: 7863 6c75 6469 6e67 204e 412f 6e75 6c6c  xcluding NA/null
-0003ee50: 0a20 2020 2076 616c 7565 732e 0a0a 2020  .    values...  
-0003ee60: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0003ee70: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0003ee80: 6466 203a 2044 6174 6146 7261 6d65 0a20  df : DataFrame. 
-0003ee90: 2020 206d 696e 5f70 6572 696f 6473 203a     min_periods :
-0003eea0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-0003eeb0: 2020 2020 2020 204d 696e 696d 756d 206e         Minimum n
-0003eec0: 756d 6265 7220 6f66 206f 6273 6572 7661  umber of observa
-0003eed0: 7469 6f6e 7320 7265 7175 6972 6564 2070  tions required p
-0003eee0: 6572 2070 6169 7220 6f66 2063 6f6c 756d  er pair of colum
-0003eef0: 6e73 0a20 2020 2020 2020 2074 6f20 6861  ns.        to ha
-0003ef00: 7665 2061 2076 616c 6964 2072 6573 756c  ve a valid resul
-0003ef10: 742e 0a20 2020 2063 6f72 7220 3a20 626f  t..    corr : bo
-0003ef20: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
-0003ef30: 2020 2020 2049 6620 5472 7565 2c20 636f       If True, co
-0003ef40: 6d70 7574 6520 7468 6520 5065 6172 736f  mpute the Pearso
-0003ef50: 6e20 636f 7272 656c 6174 696f 6e2e 2049  n correlation. I
-0003ef60: 6620 4661 6c73 6520 5b64 6566 6175 6c74  f False [default
-0003ef70: 5d2c 2063 6f6d 7075 7465 0a20 2020 2020  ], compute.     
-0003ef80: 2020 2074 6865 2063 6f76 6172 6961 6e63     the covarianc
-0003ef90: 652e 0a20 2020 2073 6361 6c61 7220 3a20  e..    scalar : 
-0003efa0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
-0003efb0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-0003efc0: 636f 6d70 7574 6520 636f 7661 7269 616e  compute covarian
-0003efd0: 6365 2062 6574 7765 656e 2074 776f 2076  ce between two v
-0003efe0: 6172 6961 626c 6573 2061 7320 6120 7363  ariables as a sc
-0003eff0: 616c 6172 2e20 4f6e 6c79 0a20 2020 2020  alar. Only.     
-0003f000: 2020 2076 616c 6964 2069 6620 6064 6660     valid if `df`
-0003f010: 2068 6173 2032 2063 6f6c 756d 6e73 2e20   has 2 columns. 
-0003f020: 2049 6620 4661 6c73 6520 5b64 6566 6175   If False [defau
-0003f030: 6c74 5d2c 2063 6f6d 7075 7465 2074 6865  lt], compute the
-0003f040: 2065 6e74 6972 650a 2020 2020 2020 2020   entire.        
-0003f050: 636f 7661 7269 616e 6365 2f63 6f72 7265  covariance/corre
-0003f060: 6c61 7469 6f6e 206d 6174 7269 782e 0a20  lation matrix.. 
-0003f070: 2020 2073 706c 6974 5f65 7665 7279 203a     split_every :
-0003f080: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-0003f090: 2020 2020 2020 2047 726f 7570 2070 6172         Group par
-0003f0a0: 7469 7469 6f6e 7320 696e 746f 2067 726f  titions into gro
-0003f0b0: 7570 7320 6f66 2074 6869 7320 7369 7a65  ups of this size
-0003f0c0: 2077 6869 6c65 2070 6572 666f 726d 696e   while performin
-0003f0d0: 6720 610a 2020 2020 2020 2020 7472 6565  g a.        tree
-0003f0e0: 2d72 6564 7563 7469 6f6e 2e20 4966 2073  -reduction. If s
-0003f0f0: 6574 2074 6f20 4661 6c73 652c 206e 6f20  et to False, no 
-0003f100: 7472 6565 2d72 6564 7563 7469 6f6e 2077  tree-reduction w
-0003f110: 696c 6c20 6265 2075 7365 642e 0a20 2020  ill be used..   
-0003f120: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
-0003f130: 4661 6c73 652e 0a20 2020 2022 2222 0a20  False..    """. 
-0003f140: 2020 2069 6620 6d69 6e5f 7065 7269 6f64     if min_period
-0003f150: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-0003f160: 2020 206d 696e 5f70 6572 696f 6473 203d     min_periods =
-0003f170: 2032 0a20 2020 2065 6c69 6620 6d69 6e5f   2.    elif min_
-0003f180: 7065 7269 6f64 7320 3c20 323a 0a20 2020  periods < 2:.   
-0003f190: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0003f1a0: 4572 726f 7228 226d 696e 5f70 6572 696f  Error("min_perio
-0003f1b0: 6473 206d 7573 7420 6265 203e 3d20 3222  ds must be >= 2"
-0003f1c0: 290a 0a20 2020 2069 6620 7370 6c69 745f  )..    if split_
-0003f1d0: 6576 6572 7920 6973 2046 616c 7365 3a0a  every is False:.
-0003f1e0: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-0003f1f0: 6572 7920 3d20 6466 2e6e 7061 7274 6974  ery = df.npartit
-0003f200: 696f 6e73 0a20 2020 2065 6c69 6620 7370  ions.    elif sp
-0003f210: 6c69 745f 6576 6572 7920 3c20 3220 6f72  lit_every < 2 or
-0003f220: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0003f230: 7370 6c69 745f 6576 6572 792c 2049 6e74  split_every, Int
-0003f240: 6567 7261 6c29 3a0a 2020 2020 2020 2020  egral):.        
-0003f250: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0003f260: 2822 7370 6c69 745f 6576 6572 7920 6d75  ("split_every mu
-0003f270: 7374 2062 6520 616e 2069 6e74 6567 6572  st be an integer
-0003f280: 203e 3d20 3222 290a 0a20 2020 2023 2048   >= 2")..    # H
-0003f290: 616e 646c 6520 7365 6c65 6374 696e 6720  andle selecting 
-0003f2a0: 6e75 6d65 7269 6320 6461 7461 2061 6e64  numeric data and
-0003f2b0: 2061 7373 6f63 6961 7465 6420 6465 7072   associated depr
-0003f2c0: 6563 6174 696f 6e20 7761 726e 696e 670a  ecation warning.
-0003f2d0: 2020 2020 6d61 7962 655f 7761 726e 203d      maybe_warn =
-0003f2e0: 2046 616c 7365 0a20 2020 2069 6620 6e75   False.    if nu
-0003f2f0: 6d65 7269 635f 6f6e 6c79 2069 7320 6e6f  meric_only is no
-0003f300: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
-0003f310: 2020 6966 2050 414e 4441 535f 4754 5f32    if PANDAS_GT_2
-0003f320: 3030 3a0a 2020 2020 2020 2020 2020 2020  00:.            
-0003f330: 6e75 6d65 7269 635f 6f6e 6c79 203d 2046  numeric_only = F
-0003f340: 616c 7365 0a20 2020 2020 2020 2065 6c69  alse.        eli
-0003f350: 6620 5041 4e44 4153 5f47 545f 3135 303a  f PANDAS_GT_150:
-0003f360: 0a20 2020 2020 2020 2020 2020 206d 6179  .            may
-0003f370: 6265 5f77 6172 6e20 3d20 5472 7565 0a20  be_warn = True. 
-0003f380: 2020 2020 2020 2020 2020 206e 756d 6572             numer
-0003f390: 6963 5f6f 6e6c 7920 3d20 5472 7565 0a20  ic_only = True. 
-0003f3a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0003f3b0: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
-0003f3c0: 5f6f 6e6c 7920 3d20 5472 7565 0a0a 2020  _only = True..  
-0003f3d0: 2020 616c 6c5f 6e75 6d65 7269 6320 3d20    all_numeric = 
-0003f3e0: 6466 2e5f 6765 745f 6e75 6d65 7269 635f  df._get_numeric_
-0003f3f0: 6461 7461 2829 2e5f 6e61 6d65 203d 3d20  data()._name == 
-0003f400: 6466 2e5f 6e61 6d65 0a20 2020 2069 6620  df._name.    if 
-0003f410: 6d61 7962 655f 7761 726e 2061 6e64 206e  maybe_warn and n
-0003f420: 6f74 2061 6c6c 5f6e 756d 6572 6963 3a0a  ot all_numeric:.
-0003f430: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-0003f440: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-0003f450: 2020 2022 5468 6520 6465 6661 756c 7420     "The default 
-0003f460: 7661 6c75 6520 6f66 206e 756d 6572 6963  value of numeric
-0003f470: 5f6f 6e6c 7920 7769 6c6c 2062 6520 6046  _only will be `F
-0003f480: 616c 7365 6020 220a 2020 2020 2020 2020  alse` ".        
-0003f490: 2020 2020 2269 6e20 6120 6675 7475 7265      "in a future
-0003f4a0: 2076 6572 7369 6f6e 206f 6620 4461 736b   version of Dask
-0003f4b0: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-0003f4c0: 4675 7475 7265 5761 726e 696e 672c 0a20  FutureWarning,. 
-0003f4d0: 2020 2020 2020 2029 0a0a 2020 2020 6966         )..    if
-0003f4e0: 206e 756d 6572 6963 5f6f 6e6c 7920 616e   numeric_only an
-0003f4f0: 6420 6e6f 7420 616c 6c5f 6e75 6d65 7269  d not all_numeri
-0003f500: 633a 0a20 2020 2020 2020 2064 6620 3d20  c:.        df = 
-0003f510: 6466 2e5f 6765 745f 6e75 6d65 7269 635f  df._get_numeric_
-0003f520: 6461 7461 2829 0a0a 2020 2020 6966 2073  data()..    if s
-0003f530: 6361 6c61 7220 616e 6420 6c65 6e28 6466  calar and len(df
-0003f540: 2e63 6f6c 756d 6e73 2920 213d 2032 3a0a  .columns) != 2:.
-0003f550: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0003f560: 6c75 6545 7272 6f72 2822 7363 616c 6172  lueError("scalar
-0003f570: 206f 6e6c 7920 7661 6c69 6420 666f 7220   only valid for 
-0003f580: 3220 636f 6c75 6d6e 2064 6174 6166 7261  2 column datafra
-0003f590: 6d65 2229 0a0a 2020 2020 746f 6b65 6e20  me")..    token 
-0003f5a0: 3d20 746f 6b65 6e69 7a65 2864 662c 206d  = tokenize(df, m
-0003f5b0: 696e 5f70 6572 696f 6473 2c20 7363 616c  in_periods, scal
-0003f5c0: 6172 2c20 7370 6c69 745f 6576 6572 7929  ar, split_every)
-0003f5d0: 0a0a 2020 2020 6675 6e63 6e61 6d65 203d  ..    funcname =
-0003f5e0: 2022 636f 7272 2220 6966 2063 6f72 7220   "corr" if corr 
-0003f5f0: 656c 7365 2022 636f 7622 0a20 2020 2061  else "cov".    a
-0003f600: 203d 2066 227b 6675 6e63 6e61 6d65 7d2d   = f"{funcname}-
-0003f610: 6368 756e 6b2d 7b64 662e 5f6e 616d 657d  chunk-{df._name}
-0003f620: 220a 2020 2020 6473 6b20 3d20 7b0a 2020  ".    dsk = {.  
-0003f630: 2020 2020 2020 2861 2c20 6929 3a20 285f        (a, i): (_
-0003f640: 636f 765f 636f 7272 5f63 6875 6e6b 2c20  cov_corr_chunk, 
-0003f650: 662c 2063 6f72 7229 2066 6f72 2028 692c  f, corr) for (i,
-0003f660: 2066 2920 696e 2065 6e75 6d65 7261 7465   f) in enumerate
-0003f670: 2864 662e 5f5f 6461 736b 5f6b 6579 735f  (df.__dask_keys_
-0003f680: 5f28 2929 0a20 2020 207d 0a0a 2020 2020  _()).    }..    
-0003f690: 7072 6566 6978 203d 2066 227b 6675 6e63  prefix = f"{func
-0003f6a0: 6e61 6d65 7d2d 636f 6d62 696e 652d 7b64  name}-combine-{d
-0003f6b0: 662e 5f6e 616d 657d 2d22 0a20 2020 206b  f._name}-".    k
-0003f6c0: 203d 2064 662e 6e70 6172 7469 7469 6f6e   = df.npartition
-0003f6d0: 730a 2020 2020 6220 3d20 610a 2020 2020  s.    b = a.    
-0003f6e0: 6465 7074 6820 3d20 300a 2020 2020 7768  depth = 0.    wh
-0003f6f0: 696c 6520 6b20 3e20 7370 6c69 745f 6576  ile k > split_ev
-0003f700: 6572 793a 0a20 2020 2020 2020 2062 203d  ery:.        b =
-0003f710: 2070 7265 6669 7820 2b20 7374 7228 6465   prefix + str(de
-0003f720: 7074 6829 0a20 2020 2020 2020 2066 6f72  pth).        for
-0003f730: 2070 6172 745f 692c 2069 6e64 7320 696e   part_i, inds in
-0003f740: 2065 6e75 6d65 7261 7465 2870 6172 7469   enumerate(parti
-0003f750: 7469 6f6e 5f61 6c6c 2873 706c 6974 5f65  tion_all(split_e
-0003f760: 7665 7279 2c20 7261 6e67 6528 6b29 2929  very, range(k)))
-0003f770: 3a0a 2020 2020 2020 2020 2020 2020 6473  :.            ds
-0003f780: 6b5b 2862 2c20 7061 7274 5f69 295d 203d  k[(b, part_i)] =
-0003f790: 2028 5f63 6f76 5f63 6f72 725f 636f 6d62   (_cov_corr_comb
-0003f7a0: 696e 652c 205b 2861 2c20 6929 2066 6f72  ine, [(a, i) for
-0003f7b0: 2069 2069 6e20 696e 6473 5d2c 2063 6f72   i in inds], cor
-0003f7c0: 7229 0a20 2020 2020 2020 206b 203d 2070  r).        k = p
-0003f7d0: 6172 745f 6920 2b20 310a 2020 2020 2020  art_i + 1.      
-0003f7e0: 2020 6120 3d20 620a 2020 2020 2020 2020    a = b.        
-0003f7f0: 6465 7074 6820 2b3d 2031 0a0a 2020 2020  depth += 1..    
-0003f800: 6e61 6d65 203d 2066 227b 6675 6e63 6e61  name = f"{funcna
-0003f810: 6d65 7d2d 7b74 6f6b 656e 7d22 0a20 2020  me}-{token}".   
-0003f820: 2064 736b 5b28 6e61 6d65 2c20 3029 5d20   dsk[(name, 0)] 
-0003f830: 3d20 280a 2020 2020 2020 2020 5f63 6f76  = (.        _cov
-0003f840: 5f63 6f72 725f 6167 672c 0a20 2020 2020  _corr_agg,.     
-0003f850: 2020 205b 2861 2c20 6929 2066 6f72 2069     [(a, i) for i
-0003f860: 2069 6e20 7261 6e67 6528 6b29 5d2c 0a20   in range(k)],. 
-0003f870: 2020 2020 2020 2064 662e 636f 6c75 6d6e         df.column
-0003f880: 732c 0a20 2020 2020 2020 206d 696e 5f70  s,.        min_p
-0003f890: 6572 696f 6473 2c0a 2020 2020 2020 2020  eriods,.        
-0003f8a0: 636f 7272 2c0a 2020 2020 2020 2020 7363  corr,.        sc
-0003f8b0: 616c 6172 2c0a 2020 2020 2020 2020 6466  alar,.        df
-0003f8c0: 2e5f 6d65 7461 2c0a 2020 2020 290a 2020  ._meta,.    ).  
-0003f8d0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-0003f8e0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-0003f8f0: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
-0003f900: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
-0003f910: 733d 5b64 665d 290a 2020 2020 6966 2073  s=[df]).    if s
-0003f920: 6361 6c61 723a 0a20 2020 2020 2020 2072  calar:.        r
-0003f930: 6574 7572 6e20 5363 616c 6172 2867 7261  eturn Scalar(gra
-0003f940: 7068 2c20 6e61 6d65 2c20 2266 3822 290a  ph, name, "f8").
-0003f950: 2020 2020 6d65 7461 203d 206d 616b 655f      meta = make_
-0003f960: 6d65 7461 280a 2020 2020 2020 2020 5b28  meta(.        [(
-0003f970: 632c 2022 6638 2229 2066 6f72 2063 2069  c, "f8") for c i
-0003f980: 6e20 6466 2e63 6f6c 756d 6e73 5d2c 0a20  n df.columns],. 
-0003f990: 2020 2020 2020 2069 6e64 6578 3d6d 6574         index=met
-0003f9a0: 615f 7365 7269 6573 5f63 6f6e 7374 7275  a_series_constru
-0003f9b0: 6374 6f72 2864 6629 2864 662e 636f 6c75  ctor(df)(df.colu
-0003f9c0: 6d6e 7329 2c0a 2020 2020 2020 2020 7061  mns),.        pa
-0003f9d0: 7265 6e74 5f6d 6574 613d 6466 2e5f 6d65  rent_meta=df._me
-0003f9e0: 7461 2c0a 2020 2020 290a 2020 2020 7265  ta,.    ).    re
-0003f9f0: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
-0003fa00: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
-0003fa10: 6d65 7461 2c20 2864 662e 636f 6c75 6d6e  meta, (df.column
-0003fa20: 732e 6d69 6e28 292c 2064 662e 636f 6c75  s.min(), df.colu
-0003fa30: 6d6e 732e 6d61 7828 2929 290a 0a0a 6465  mns.max()))...de
-0003fa40: 6620 5f63 6f76 5f63 6f72 725f 6368 756e  f _cov_corr_chun
-0003fa50: 6b28 6466 2c20 636f 7272 3d46 616c 7365  k(df, corr=False
-0003fa60: 293a 0a20 2020 2022 2222 4368 756e 6b20  ):.    """Chunk 
-0003fa70: 7061 7274 206f 6620 6120 636f 7661 7269  part of a covari
-0003fa80: 616e 6365 206f 7220 636f 7272 656c 6174  ance or correlat
-0003fa90: 696f 6e20 636f 6d70 7574 6174 696f 6e22  ion computation"
-0003faa0: 2222 0a20 2020 2073 6861 7065 203d 2028  "".    shape = (
-0003fab0: 6466 2e73 6861 7065 5b31 5d2c 2064 662e  df.shape[1], df.
-0003fac0: 7368 6170 655b 315d 290a 2020 2020 6466  shape[1]).    df
-0003fad0: 203d 2064 662e 6173 7479 7065 2822 666c   = df.astype("fl
-0003fae0: 6f61 7436 3422 2c20 636f 7079 3d46 616c  oat64", copy=Fal
-0003faf0: 7365 290a 2020 2020 7375 6d73 203d 206e  se).    sums = n
-0003fb00: 702e 7a65 726f 735f 6c69 6b65 2864 662e  p.zeros_like(df.
-0003fb10: 7661 6c75 6573 2c20 7368 6170 653d 7368  values, shape=sh
-0003fb20: 6170 6529 0a20 2020 2063 6f75 6e74 7320  ape).    counts 
-0003fb30: 3d20 6e70 2e7a 6572 6f73 5f6c 696b 6528  = np.zeros_like(
-0003fb40: 6466 2e76 616c 7565 732c 2073 6861 7065  df.values, shape
-0003fb50: 3d73 6861 7065 290a 2020 2020 666f 7220  =shape).    for 
-0003fb60: 6964 7820 696e 2072 616e 6765 286c 656e  idx in range(len
-0003fb70: 2864 662e 636f 6c75 6d6e 7329 293a 0a20  (df.columns)):. 
-0003fb80: 2020 2020 2020 206d 6173 6b20 3d20 6466         mask = df
-0003fb90: 2e69 6c6f 635b 3a2c 2069 6478 5d2e 6e6f  .iloc[:, idx].no
-0003fba0: 746e 756c 6c28 290a 2020 2020 2020 2020  tnull().        
-0003fbb0: 7375 6d73 5b69 6478 5d20 3d20 6466 5b6d  sums[idx] = df[m
-0003fbc0: 6173 6b5d 2e73 756d 2829 2e76 616c 7565  ask].sum().value
-0003fbd0: 730a 2020 2020 2020 2020 636f 756e 7473  s.        counts
-0003fbe0: 5b69 6478 5d20 3d20 6466 5b6d 6173 6b5d  [idx] = df[mask]
-0003fbf0: 2e63 6f75 6e74 2829 2e76 616c 7565 730a  .count().values.
-0003fc00: 2020 2020 2320 5370 6563 6961 6c20 6361      # Special ca
-0003fc10: 7365 2073 696e 676c 652d 726f 7720 4461  se single-row Da
-0003fc20: 7461 4672 616d 6520 636f 7620 746f 2061  taFrame cov to a
-0003fc30: 766f 6964 2077 6172 6e69 6e67 7320 6672  void warnings fr
-0003fc40: 6f6d 2070 616e 6461 732e 0a20 2020 2069  om pandas..    i
-0003fc50: 6620 6466 2e73 6861 7065 5b30 5d20 3d3d  f df.shape[0] ==
-0003fc60: 2031 3a0a 2020 2020 2020 2020 636f 7620   1:.        cov 
-0003fc70: 3d20 6e70 2e66 756c 6c5f 6c69 6b65 2873  = np.full_like(s
-0003fc80: 756d 732c 206e 702e 6e61 6e29 2020 2320  ums, np.nan)  # 
-0003fc90: 616c 7761 7973 2061 6e20 616c 6c20 6e61  always an all na
-0003fca0: 6e20 7265 7375 6c74 0a20 2020 2065 6c73  n result.    els
-0003fcb0: 653a 0a20 2020 2020 2020 2063 6f76 203d  e:.        cov =
-0003fcc0: 2064 662e 636f 7628 292e 7661 6c75 6573   df.cov().values
-0003fcd0: 0a20 2020 2064 7479 7065 203d 205b 2822  .    dtype = [("
-0003fce0: 7375 6d22 2c20 7375 6d73 2e64 7479 7065  sum", sums.dtype
-0003fcf0: 292c 2028 2263 6f75 6e74 222c 2063 6f75  ), ("count", cou
-0003fd00: 6e74 732e 6474 7970 6529 2c20 2822 636f  nts.dtype), ("co
-0003fd10: 7622 2c20 636f 762e 6474 7970 6529 5d0a  v", cov.dtype)].
-0003fd20: 2020 2020 6966 2063 6f72 723a 0a20 2020      if corr:.   
-0003fd30: 2020 2020 2077 6974 6820 7761 726e 696e       with warnin
-0003fd40: 6773 2e63 6174 6368 5f77 6172 6e69 6e67  gs.catch_warning
-0003fd50: 7328 7265 636f 7264 3d54 7275 6529 3a0a  s(record=True):.
-0003fd60: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-0003fd70: 696e 6773 2e73 696d 706c 6566 696c 7465  ings.simplefilte
-0003fd80: 7228 2261 6c77 6179 7322 290a 2020 2020  r("always").    
-0003fd90: 2020 2020 2020 2020 6d75 203d 2028 7375          mu = (su
-0003fda0: 6d73 202f 2063 6f75 6e74 7329 2e54 0a20  ms / counts).T. 
-0003fdb0: 2020 2020 2020 206d 203d 206e 702e 7a65         m = np.ze
-0003fdc0: 726f 735f 6c69 6b65 2864 662e 7661 6c75  ros_like(df.valu
-0003fdd0: 6573 2c20 7368 6170 653d 7368 6170 6529  es, shape=shape)
-0003fde0: 0a20 2020 2020 2020 206d 6173 6b20 3d20  .        mask = 
-0003fdf0: 6466 2e69 736e 756c 6c28 292e 7661 6c75  df.isnull().valu
-0003fe00: 6573 0a20 2020 2020 2020 2066 6f72 2069  es.        for i
-0003fe10: 6478 2069 6e20 7261 6e67 6528 6c65 6e28  dx in range(len(
-0003fe20: 6466 2e63 6f6c 756d 6e73 2929 3a0a 2020  df.columns)):.  
-0003fe30: 2020 2020 2020 2020 2020 2320 4176 6f69            # Avoi
-0003fe40: 6420 7573 696e 6720 7566 756e 632e 6f75  d using ufunc.ou
-0003fe50: 7465 7220 286e 6f74 2073 7570 706f 7274  ter (not support
-0003fe60: 6564 2062 7920 6375 7079 290a 2020 2020  ed by cupy).    
-0003fe70: 2020 2020 2020 2020 6d75 5f64 6973 6372          mu_discr
-0003fe80: 6570 616e 6379 203d 2028 0a20 2020 2020  epancy = (.     
-0003fe90: 2020 2020 2020 2020 2020 206e 702e 7375             np.su
-0003fea0: 6274 7261 6374 2864 662e 696c 6f63 5b3a  btract(df.iloc[:
-0003feb0: 2c20 6964 785d 2e76 616c 7565 735b 3a2c  , idx].values[:,
-0003fec0: 204e 6f6e 655d 2c20 6d75 5b69 6478 5d5b   None], mu[idx][
-0003fed0: 4e6f 6e65 2c20 3a5d 2920 2a2a 2032 0a20  None, :]) ** 2. 
-0003fee0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0003fef0: 2020 2020 2020 2020 206d 755f 6469 7363           mu_disc
-0003ff00: 7265 7061 6e63 795b 6d61 736b 5d20 3d20  repancy[mask] = 
-0003ff10: 6e70 2e6e 616e 0a20 2020 2020 2020 2020  np.nan.         
-0003ff20: 2020 206d 5b69 6478 5d20 3d20 6e70 2e6e     m[idx] = np.n
-0003ff30: 616e 7375 6d28 6d75 5f64 6973 6372 6570  ansum(mu_discrep
-0003ff40: 616e 6379 2c20 6178 6973 3d30 290a 2020  ancy, axis=0).  
-0003ff50: 2020 2020 2020 6d20 3d20 6d2e 540a 2020        m = m.T.  
-0003ff60: 2020 2020 2020 6474 7970 652e 6170 7065        dtype.appe
-0003ff70: 6e64 2828 226d 222c 206d 2e64 7479 7065  nd(("m", m.dtype
-0003ff80: 2929 0a0a 2020 2020 6f75 7420 3d20 7b22  ))..    out = {"
-0003ff90: 7375 6d22 3a20 7375 6d73 2c20 2263 6f75  sum": sums, "cou
-0003ffa0: 6e74 223a 2063 6f75 6e74 732c 2022 636f  nt": counts, "co
-0003ffb0: 7622 3a20 636f 7620 2a20 2863 6f75 6e74  v": cov * (count
-0003ffc0: 7320 2d20 3129 7d0a 2020 2020 6966 2063  s - 1)}.    if c
-0003ffd0: 6f72 723a 0a20 2020 2020 2020 206f 7574  orr:.        out
-0003ffe0: 5b22 6d22 5d20 3d20 6d0a 2020 2020 7265  ["m"] = m.    re
-0003fff0: 7475 726e 206f 7574 0a0a 0a64 6566 205f  turn out...def _
-00040000: 636f 765f 636f 7272 5f63 6f6d 6269 6e65  cov_corr_combine
-00040010: 2864 6174 615f 696e 2c20 636f 7272 3d46  (data_in, corr=F
-00040020: 616c 7365 293a 0a20 2020 2064 6174 6120  alse):.    data 
-00040030: 3d20 7b22 7375 6d22 3a20 4e6f 6e65 2c20  = {"sum": None, 
-00040040: 2263 6f75 6e74 223a 204e 6f6e 652c 2022  "count": None, "
-00040050: 636f 7622 3a20 4e6f 6e65 7d0a 2020 2020  cov": None}.    
-00040060: 6966 2063 6f72 723a 0a20 2020 2020 2020  if corr:.       
-00040070: 2064 6174 615b 226d 225d 203d 204e 6f6e   data["m"] = Non
-00040080: 650a 0a20 2020 2066 6f72 206b 2069 6e20  e..    for k in 
-00040090: 6461 7461 2e6b 6579 7328 293a 0a20 2020  data.keys():.   
-000400a0: 2020 2020 2064 6174 615b 6b5d 203d 205b       data[k] = [
-000400b0: 645b 6b5d 2066 6f72 2064 2069 6e20 6461  d[k] for d in da
-000400c0: 7461 5f69 6e5d 0a20 2020 2020 2020 2064  ta_in].        d
-000400d0: 6174 615b 6b5d 203d 206e 702e 636f 6e63  ata[k] = np.conc
-000400e0: 6174 656e 6174 6528 6461 7461 5b6b 5d29  atenate(data[k])
-000400f0: 2e72 6573 6861 7065 2828 6c65 6e28 6461  .reshape((len(da
-00040100: 7461 5b6b 5d29 2c29 202b 2064 6174 615b  ta[k]),) + data[
-00040110: 6b5d 5b30 5d2e 7368 6170 6529 0a0a 2020  k][0].shape)..  
-00040120: 2020 7375 6d73 203d 206e 702e 6e61 6e5f    sums = np.nan_
-00040130: 746f 5f6e 756d 2864 6174 615b 2273 756d  to_num(data["sum
-00040140: 225d 290a 2020 2020 636f 756e 7473 203d  "]).    counts =
-00040150: 2064 6174 615b 2263 6f75 6e74 225d 0a0a   data["count"]..
-00040160: 2020 2020 6375 6d5f 7375 6d73 203d 206e      cum_sums = n
-00040170: 702e 6375 6d73 756d 2873 756d 732c 2030  p.cumsum(sums, 0
-00040180: 290a 2020 2020 6375 6d5f 636f 756e 7473  ).    cum_counts
-00040190: 203d 206e 702e 6375 6d73 756d 2863 6f75   = np.cumsum(cou
-000401a0: 6e74 732c 2030 290a 0a20 2020 2073 3120  nts, 0)..    s1 
-000401b0: 3d20 6375 6d5f 7375 6d73 5b3a 2d31 5d0a  = cum_sums[:-1].
-000401c0: 2020 2020 7332 203d 2073 756d 735b 313a      s2 = sums[1:
-000401d0: 5d0a 2020 2020 6e31 203d 2063 756d 5f63  ].    n1 = cum_c
-000401e0: 6f75 6e74 735b 3a2d 315d 0a20 2020 206e  ounts[:-1].    n
-000401f0: 3220 3d20 636f 756e 7473 5b31 3a5d 0a20  2 = counts[1:]. 
-00040200: 2020 2077 6974 6820 6e70 2e65 7272 7374     with np.errst
-00040210: 6174 6528 696e 7661 6c69 643d 2269 676e  ate(invalid="ign
-00040220: 6f72 6522 293a 0a20 2020 2020 2020 2064  ore"):.        d
-00040230: 203d 2028 7332 202f 206e 3229 202d 2028   = (s2 / n2) - (
-00040240: 7331 202f 206e 3129 0a20 2020 2020 2020  s1 / n1).       
-00040250: 2043 203d 206e 702e 6e61 6e73 756d 280a   C = np.nansum(.
-00040260: 2020 2020 2020 2020 2020 2020 286e 3120              (n1 
-00040270: 2a20 6e32 2920 2f20 286e 3120 2b20 6e32  * n2) / (n1 + n2
-00040280: 2920 2a20 2864 202a 2064 2e74 7261 6e73  ) * (d * d.trans
-00040290: 706f 7365 2828 302c 2032 2c20 3129 2929  pose((0, 2, 1)))
-000402a0: 2c20 300a 2020 2020 2020 2020 2920 2b20  , 0.        ) + 
-000402b0: 6e70 2e6e 616e 7375 6d28 6461 7461 5b22  np.nansum(data["
-000402c0: 636f 7622 5d2c 2030 290a 0a20 2020 206f  cov"], 0)..    o
-000402d0: 7574 203d 207b 2273 756d 223a 2063 756d  ut = {"sum": cum
-000402e0: 5f73 756d 735b 2d31 5d2c 2022 636f 756e  _sums[-1], "coun
-000402f0: 7422 3a20 6375 6d5f 636f 756e 7473 5b2d  t": cum_counts[-
-00040300: 315d 2c20 2263 6f76 223a 2043 7d0a 0a20  1], "cov": C}.. 
-00040310: 2020 2069 6620 636f 7272 3a0a 2020 2020     if corr:.    
-00040320: 2020 2020 6e6f 6273 203d 206e 702e 7768      nobs = np.wh
-00040330: 6572 6528 6375 6d5f 636f 756e 7473 5b2d  ere(cum_counts[-
-00040340: 315d 2c20 6375 6d5f 636f 756e 7473 5b2d  1], cum_counts[-
-00040350: 315d 2c20 6e70 2e6e 616e 290a 2020 2020  1], np.nan).    
-00040360: 2020 2020 6d75 203d 2063 756d 5f73 756d      mu = cum_sum
-00040370: 735b 2d31 5d20 2f20 6e6f 6273 0a20 2020  s[-1] / nobs.   
-00040380: 2020 2020 2063 6f75 6e74 735f 6e61 203d       counts_na =
-00040390: 206e 702e 7768 6572 6528 636f 756e 7473   np.where(counts
-000403a0: 2c20 636f 756e 7473 2c20 6e70 2e6e 616e  , counts, np.nan
-000403b0: 290a 2020 2020 2020 2020 6d20 3d20 6e70  ).        m = np
-000403c0: 2e6e 616e 7375 6d28 6461 7461 5b22 6d22  .nansum(data["m"
-000403d0: 5d20 2b20 636f 756e 7473 202a 2028 7375  ] + counts * (su
-000403e0: 6d73 202f 2063 6f75 6e74 735f 6e61 202d  ms / counts_na -
-000403f0: 206d 7529 202a 2a20 322c 2061 7869 733d   mu) ** 2, axis=
-00040400: 3029 0a20 2020 2020 2020 206f 7574 5b22  0).        out["
-00040410: 6d22 5d20 3d20 6d0a 2020 2020 7265 7475  m"] = m.    retu
-00040420: 726e 206f 7574 0a0a 0a64 6566 205f 636f  rn out...def _co
-00040430: 765f 636f 7272 5f61 6767 2864 6174 612c  v_corr_agg(data,
-00040440: 2063 6f6c 732c 206d 696e 5f70 6572 696f   cols, min_perio
-00040450: 6473 3d32 2c20 636f 7272 3d46 616c 7365  ds=2, corr=False
-00040460: 2c20 7363 616c 6172 3d46 616c 7365 2c20  , scalar=False, 
-00040470: 6c69 6b65 5f64 663d 4e6f 6e65 293a 0a20  like_df=None):. 
-00040480: 2020 206f 7574 203d 205f 636f 765f 636f     out = _cov_co
-00040490: 7272 5f63 6f6d 6269 6e65 2864 6174 612c  rr_combine(data,
-000404a0: 2063 6f72 7229 0a20 2020 2063 6f75 6e74   corr).    count
-000404b0: 7320 3d20 6f75 745b 2263 6f75 6e74 225d  s = out["count"]
-000404c0: 0a20 2020 2043 203d 206f 7574 5b22 636f  .    C = out["co
-000404d0: 7622 5d0a 2020 2020 435b 636f 756e 7473  v"].    C[counts
-000404e0: 203c 206d 696e 5f70 6572 696f 6473 5d20   < min_periods] 
-000404f0: 3d20 6e70 2e6e 616e 0a20 2020 2069 6620  = np.nan.    if 
-00040500: 636f 7272 3a0a 2020 2020 2020 2020 6d32  corr:.        m2
-00040510: 203d 206f 7574 5b22 6d22 5d0a 2020 2020   = out["m"].    
-00040520: 2020 2020 6465 6e20 3d20 6e70 2e73 7172      den = np.sqr
-00040530: 7428 6d32 202a 206d 322e 5429 0a20 2020  t(m2 * m2.T).   
-00040540: 2065 6c73 653a 0a20 2020 2020 2020 2064   else:.        d
-00040550: 656e 203d 206e 702e 7768 6572 6528 636f  en = np.where(co
-00040560: 756e 7473 2c20 636f 756e 7473 2c20 6e70  unts, counts, np
-00040570: 2e6e 616e 2920 2d20 310a 2020 2020 7769  .nan) - 1.    wi
-00040580: 7468 206e 702e 6572 7273 7461 7465 2869  th np.errstate(i
-00040590: 6e76 616c 6964 3d22 6967 6e6f 7265 222c  nvalid="ignore",
-000405a0: 2064 6976 6964 653d 2269 676e 6f72 6522   divide="ignore"
-000405b0: 293a 0a20 2020 2020 2020 206d 6174 203d  ):.        mat =
-000405c0: 2043 202f 2064 656e 0a20 2020 2069 6620   C / den.    if 
-000405d0: 7363 616c 6172 3a0a 2020 2020 2020 2020  scalar:.        
-000405e0: 7265 7475 726e 2066 6c6f 6174 286d 6174  return float(mat
-000405f0: 5b30 2c20 315d 290a 2020 2020 7265 7475  [0, 1]).    retu
-00040600: 726e 2028 7064 2e44 6174 6146 7261 6d65  rn (pd.DataFrame
-00040610: 2069 6620 6c69 6b65 5f64 6620 6973 204e   if like_df is N
-00040620: 6f6e 6520 656c 7365 206d 6574 615f 6672  one else meta_fr
-00040630: 616d 655f 636f 6e73 7472 7563 746f 7228  ame_constructor(
-00040640: 6c69 6b65 5f64 6629 2928 0a20 2020 2020  like_df))(.     
-00040650: 2020 206d 6174 2c20 636f 6c75 6d6e 733d     mat, columns=
-00040660: 636f 6c73 2c20 696e 6465 783d 636f 6c73  cols, index=cols
-00040670: 0a20 2020 2029 0a0a 0a64 6566 2070 645f  .    )...def pd_
-00040680: 7370 6c69 7428 6466 2c20 702c 2072 616e  split(df, p, ran
-00040690: 646f 6d5f 7374 6174 653d 4e6f 6e65 2c20  dom_state=None, 
-000406a0: 7368 7566 666c 653d 4661 6c73 6529 3a0a  shuffle=False):.
-000406b0: 2020 2020 2222 2253 706c 6974 2044 6174      """Split Dat
-000406c0: 6146 7261 6d65 2069 6e74 6f20 6d75 6c74  aFrame into mult
-000406d0: 6970 6c65 2070 6965 6365 7320 7073 6575  iple pieces pseu
-000406e0: 646f 7261 6e64 6f6d 6c79 0a0a 2020 2020  dorandomly..    
-000406f0: 3e3e 3e20 6466 203d 2070 642e 4461 7461  >>> df = pd.Data
-00040700: 4672 616d 6528 7b27 6127 3a20 5b31 2c20  Frame({'a': [1, 
-00040710: 322c 2033 2c20 342c 2035 2c20 365d 2c0a  2, 3, 4, 5, 6],.
-00040720: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-00040730: 2020 2020 2020 2020 2020 2027 6227 3a20             'b': 
-00040740: 5b32 2c20 332c 2034 2c20 352c 2036 2c20  [2, 3, 4, 5, 6, 
-00040750: 375d 7d29 0a0a 2020 2020 3e3e 3e20 612c  7]})..    >>> a,
-00040760: 2062 203d 2070 645f 7370 6c69 7428 0a20   b = pd_split(. 
-00040770: 2020 202e 2e2e 2020 2020 2064 662c 205b     ...     df, [
-00040780: 302e 352c 2030 2e35 5d2c 2072 616e 646f  0.5, 0.5], rando
-00040790: 6d5f 7374 6174 653d 3132 332c 2073 6875  m_state=123, shu
-000407a0: 6666 6c65 3d54 7275 650a 2020 2020 2e2e  ffle=True.    ..
-000407b0: 2e20 2920 2023 2072 6f75 6768 6c79 2035  . )  # roughly 5
-000407c0: 302f 3530 2073 706c 6974 0a20 2020 203e  0/50 split.    >
-000407d0: 3e3e 2061 0a20 2020 2020 2020 6120 2062  >> a.       a  b
-000407e0: 0a20 2020 2033 2020 3420 2035 0a20 2020  .    3  4  5.   
-000407f0: 2030 2020 3120 2032 0a20 2020 2035 2020   0  1  2.    5  
-00040800: 3620 2037 0a20 2020 203e 3e3e 2062 0a20  6  7.    >>> b. 
-00040810: 2020 2020 2020 6120 2062 0a20 2020 2031        a  b.    1
-00040820: 2020 3220 2033 0a20 2020 2034 2020 3520    2  3.    4  5 
-00040830: 2036 0a20 2020 2032 2020 3320 2034 0a20   6.    2  3  4. 
-00040840: 2020 2022 2222 0a20 2020 2070 203d 206c     """.    p = l
-00040850: 6973 7428 7029 0a20 2020 2069 6620 7368  ist(p).    if sh
-00040860: 7566 666c 653a 0a20 2020 2020 2020 2069  uffle:.        i
-00040870: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-00040880: 2872 616e 646f 6d5f 7374 6174 652c 206e  (random_state, n
-00040890: 702e 7261 6e64 6f6d 2e52 616e 646f 6d53  p.random.RandomS
-000408a0: 7461 7465 293a 0a20 2020 2020 2020 2020  tate):.         
-000408b0: 2020 2072 616e 646f 6d5f 7374 6174 6520     random_state 
-000408c0: 3d20 6e70 2e72 616e 646f 6d2e 5261 6e64  = np.random.Rand
-000408d0: 6f6d 5374 6174 6528 7261 6e64 6f6d 5f73  omState(random_s
-000408e0: 7461 7465 290a 2020 2020 2020 2020 6466  tate).        df
-000408f0: 203d 2064 662e 7361 6d70 6c65 2866 7261   = df.sample(fra
-00040900: 633d 312e 302c 2072 616e 646f 6d5f 7374  c=1.0, random_st
-00040910: 6174 653d 7261 6e64 6f6d 5f73 7461 7465  ate=random_state
-00040920: 290a 2020 2020 696e 6465 7820 3d20 7073  ).    index = ps
-00040930: 6575 646f 7261 6e64 6f6d 286c 656e 2864  eudorandom(len(d
-00040940: 6629 2c20 702c 2072 616e 646f 6d5f 7374  f), p, random_st
-00040950: 6174 6529 0a20 2020 2072 6574 7572 6e20  ate).    return 
-00040960: 5b64 662e 696c 6f63 5b69 6e64 6578 203d  [df.iloc[index =
-00040970: 3d20 695d 2066 6f72 2069 2069 6e20 7261  = i] for i in ra
-00040980: 6e67 6528 6c65 6e28 7029 295d 0a0a 0a64  nge(len(p))]...d
-00040990: 6566 205f 7461 6b65 5f6c 6173 7428 612c  ef _take_last(a,
-000409a0: 2073 6b69 706e 613d 5472 7565 293a 0a20   skipna=True):. 
-000409b0: 2020 2022 2222 0a20 2020 2074 616b 6520     """.    take 
-000409c0: 6c61 7374 2072 6f77 2028 5365 7269 6573  last row (Series
-000409d0: 2920 6f66 2044 6174 6146 7261 6d65 202f  ) of DataFrame /
-000409e0: 206c 6173 7420 7661 6c75 6520 6f66 2053   last value of S
-000409f0: 6572 6965 730a 2020 2020 636f 6e73 6964  eries.    consid
-00040a00: 6572 696e 6720 4e61 4e2e 0a0a 2020 2020  ering NaN...    
-00040a10: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-00040a20: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6120  ---------.    a 
-00040a30: 3a20 7064 2e44 6174 6146 7261 6d65 206f  : pd.DataFrame o
-00040a40: 7220 7064 2e53 6572 6965 730a 2020 2020  r pd.Series.    
-00040a50: 736b 6970 6e61 203a 2062 6f6f 6c2c 2064  skipna : bool, d
-00040a60: 6566 6175 6c74 2054 7275 650a 2020 2020  efault True.    
-00040a70: 2020 2020 5768 6574 6865 7220 746f 2065      Whether to e
-00040a80: 7863 6c75 6465 204e 614e 0a0a 2020 2020  xclude NaN..    
-00040a90: 2222 220a 0a20 2020 2064 6566 205f 6c61  """..    def _la
-00040aa0: 7374 5f76 616c 6964 2873 293a 0a20 2020  st_valid(s):.   
-00040ab0: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00040ac0: 6e67 6528 312c 206d 696e 2831 302c 206c  nge(1, min(10, l
-00040ad0: 656e 2873 2920 2b20 3129 293a 0a20 2020  en(s) + 1)):.   
-00040ae0: 2020 2020 2020 2020 2076 616c 203d 2073           val = s
-00040af0: 2e69 6c6f 635b 2d69 5d0a 2020 2020 2020  .iloc[-i].      
-00040b00: 2020 2020 2020 6966 206e 6f74 2070 642e        if not pd.
-00040b10: 6973 6e75 6c6c 2876 616c 293a 0a20 2020  isnull(val):.   
-00040b20: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00040b30: 7572 6e20 7661 6c0a 2020 2020 2020 2020  urn val.        
-00040b40: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00040b50: 2020 6e6f 6e6e 756c 6c20 3d20 735b 732e    nonnull = s[s.
-00040b60: 6e6f 746e 6128 295d 0a20 2020 2020 2020  notna()].       
-00040b70: 2020 2020 2069 6620 6e6f 7420 6e6f 6e6e       if not nonn
-00040b80: 756c 6c2e 656d 7074 793a 0a20 2020 2020  ull.empty:.     
-00040b90: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00040ba0: 6e20 6e6f 6e6e 756c 6c2e 696c 6f63 5b2d  n nonnull.iloc[-
-00040bb0: 315d 0a20 2020 2020 2020 2072 6574 7572  1].        retur
-00040bc0: 6e20 4e6f 6e65 0a0a 2020 2020 6966 2073  n None..    if s
-00040bd0: 6b69 706e 6120 6973 2046 616c 7365 3a0a  kipna is False:.
-00040be0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-00040bf0: 2e69 6c6f 635b 2d31 5d0a 2020 2020 656c  .iloc[-1].    el
-00040c00: 7365 3a0a 2020 2020 2020 2020 2320 7461  se:.        # ta
-00040c10: 6b65 206c 6173 7420 7661 6c69 6420 7661  ke last valid va
-00040c20: 6c75 6520 6578 636c 7564 696e 6720 4e61  lue excluding Na
-00040c30: 4e2c 204e 614e 206c 6f63 6174 696f 6e20  N, NaN location 
-00040c40: 6d61 7920 6265 2064 6966 6665 7265 6e74  may be different
-00040c50: 0a20 2020 2020 2020 2023 2069 6e20 6561  .        # in ea
-00040c60: 6368 2063 6f6c 756d 6e0a 2020 2020 2020  ch column.      
-00040c70: 2020 6966 2069 735f 6461 7461 6672 616d    if is_datafram
-00040c80: 655f 6c69 6b65 2861 293a 0a20 2020 2020  e_like(a):.     
-00040c90: 2020 2020 2020 2023 2063 7265 6174 6520         # create 
-00040ca0: 5365 7269 6573 2066 726f 6d20 6170 7072  Series from appr
-00040cb0: 6f70 7269 6174 6520 6261 636b 656e 6420  opriate backend 
-00040cc0: 6461 7461 6672 616d 6520 6c69 6272 6172  dataframe librar
-00040cd0: 790a 2020 2020 2020 2020 2020 2020 7365  y.            se
-00040ce0: 7269 6573 5f74 7970 203d 2074 7970 6528  ries_typ = type(
-00040cf0: 612e 696c 6f63 5b30 3a31 2c20 305d 290a  a.iloc[0:1, 0]).
-00040d00: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-00040d10: 2e65 6d70 7479 3a0a 2020 2020 2020 2020  .empty:.        
-00040d20: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00040d30: 6572 6965 735f 7479 7028 5b5d 2c20 6474  eries_typ([], dt
-00040d40: 7970 653d 2266 6c6f 6174 2229 0a20 2020  ype="float").   
-00040d50: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00040d60: 7365 7269 6573 5f74 7970 280a 2020 2020  series_typ(.    
-00040d70: 2020 2020 2020 2020 2020 2020 5b5f 6c61              [_la
-00040d80: 7374 5f76 616c 6964 2861 2e69 6c6f 635b  st_valid(a.iloc[
-00040d90: 3a2c 2069 5d29 2066 6f72 2069 2069 6e20  :, i]) for i in 
-00040da0: 7261 6e67 6528 6c65 6e28 612e 636f 6c75  range(len(a.colu
-00040db0: 6d6e 7329 295d 2c0a 2020 2020 2020 2020  mns))],.        
-00040dc0: 2020 2020 2020 2020 696e 6465 783d 612e          index=a.
-00040dd0: 636f 6c75 6d6e 732c 0a20 2020 2020 2020  columns,.       
-00040de0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-00040df0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00040e00: 2072 6574 7572 6e20 5f6c 6173 745f 7661   return _last_va
-00040e10: 6c69 6428 6129 0a0a 0a64 6566 2063 6865  lid(a)...def che
-00040e20: 636b 5f64 6976 6973 696f 6e73 2864 6976  ck_divisions(div
-00040e30: 6973 696f 6e73 293a 0a20 2020 2069 6620  isions):.    if 
-00040e40: 6e6f 7420 6973 696e 7374 616e 6365 2864  not isinstance(d
-00040e50: 6976 6973 696f 6e73 2c20 286c 6973 742c  ivisions, (list,
-00040e60: 2074 7570 6c65 2929 3a0a 2020 2020 2020   tuple)):.      
-00040e70: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00040e80: 6f72 2822 4e65 7720 6469 7669 7369 6f6e  or("New division
-00040e90: 206d 7573 7420 6265 206c 6973 7420 6f72   must be list or
-00040ea0: 2074 7570 6c65 2229 0a20 2020 2064 6976   tuple").    div
-00040eb0: 6973 696f 6e73 203d 206c 6973 7428 6469  isions = list(di
-00040ec0: 7669 7369 6f6e 7329 0a20 2020 2069 6620  visions).    if 
-00040ed0: 6c65 6e28 6469 7669 7369 6f6e 7329 203d  len(divisions) =
-00040ee0: 3d20 303a 0a20 2020 2020 2020 2072 6169  = 0:.        rai
-00040ef0: 7365 2056 616c 7565 4572 726f 7228 224e  se ValueError("N
-00040f00: 6577 2064 6976 6973 696f 6e20 6d75 7374  ew division must
-00040f10: 206e 6f74 2062 6520 656d 7074 7922 290a   not be empty").
-00040f20: 2020 2020 6966 2064 6976 6973 696f 6e73      if divisions
-00040f30: 2021 3d20 736f 7274 6564 2864 6976 6973   != sorted(divis
-00040f40: 696f 6e73 293a 0a20 2020 2020 2020 2072  ions):.        r
-00040f50: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00040f60: 224e 6577 2064 6976 6973 696f 6e20 6d75  "New division mu
-00040f70: 7374 2062 6520 736f 7274 6564 2229 0a20  st be sorted"). 
-00040f80: 2020 2069 6620 6c65 6e28 6469 7669 7369     if len(divisi
-00040f90: 6f6e 735b 3a2d 315d 2920 213d 206c 656e  ons[:-1]) != len
-00040fa0: 286c 6973 7428 756e 6971 7565 2864 6976  (list(unique(div
-00040fb0: 6973 696f 6e73 5b3a 2d31 5d29 2929 3a0a  isions[:-1]))):.
-00040fc0: 2020 2020 2020 2020 6d73 6720 3d20 224e          msg = "N
-00040fd0: 6577 2064 6976 6973 696f 6e20 6d75 7374  ew division must
-00040fe0: 2062 6520 756e 6971 7565 2c20 6578 6365   be unique, exce
-00040ff0: 7074 2066 6f72 2074 6865 206c 6173 7420  pt for the last 
-00041000: 656c 656d 656e 7422 0a20 2020 2020 2020  element".       
-00041010: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00041020: 7228 6d73 6729 0a0a 0a64 6566 2072 6570  r(msg)...def rep
-00041030: 6172 7469 7469 6f6e 5f64 6976 6973 696f  artition_divisio
-00041040: 6e73 2861 2c20 622c 206e 616d 652c 206f  ns(a, b, name, o
-00041050: 7574 312c 206f 7574 322c 2066 6f72 6365  ut1, out2, force
-00041060: 3d46 616c 7365 293a 0a20 2020 2022 2222  =False):.    """
-00041070: 6461 736b 2067 7261 7068 2074 6f20 7265  dask graph to re
-00041080: 7061 7274 6974 696f 6e20 6461 7461 6672  partition datafr
-00041090: 616d 6520 6279 206e 6577 2064 6976 6973  ame by new divis
-000410a0: 696f 6e73 0a0a 2020 2020 5061 7261 6d65  ions..    Parame
-000410b0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-000410c0: 2d2d 2d0a 2020 2020 6120 3a20 7475 706c  ---.    a : tupl
-000410d0: 650a 2020 2020 2020 2020 6f6c 6420 6469  e.        old di
-000410e0: 7669 7369 6f6e 730a 2020 2020 6220 3a20  visions.    b : 
-000410f0: 7475 706c 652c 206c 6973 746d 7970 790a  tuple, listmypy.
-00041100: 2020 2020 6f75 7432 203a 2073 7472 0a20      out2 : str. 
-00041110: 2020 2020 2020 206e 616d 6520 6f66 206e         name of n
-00041120: 6577 2064 6174 6166 7261 6d65 0a20 2020  ew dataframe.   
-00041130: 2066 6f72 6365 203a 2062 6f6f 6c2c 2064   force : bool, d
-00041140: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
-00041150: 2020 2020 2041 6c6c 6f77 7320 7468 6520       Allows the 
-00041160: 6578 7061 6e73 696f 6e20 6f66 2074 6865  expansion of the
-00041170: 2065 7869 7374 696e 6720 6469 7669 7369   existing divisi
-00041180: 6f6e 732e 0a20 2020 2020 2020 2049 6620  ons..        If 
-00041190: 4661 6c73 6520 7468 656e 2074 6865 206e  False then the n
-000411a0: 6577 2064 6976 6973 696f 6e73 206c 6f77  ew divisions low
-000411b0: 6572 2061 6e64 2075 7070 6572 2062 6f75  er and upper bou
-000411c0: 6e64 7320 6d75 7374 2062 650a 2020 2020  nds must be.    
-000411d0: 2020 2020 7468 6520 7361 6d65 2061 7320      the same as 
-000411e0: 7468 6520 6f6c 6420 6469 7669 7369 6f6e  the old division
-000411f0: 732e 0a0a 2020 2020 4578 616d 706c 6573  s...    Examples
-00041200: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
-00041210: 2020 3e3e 3e20 6672 6f6d 2070 7072 696e    >>> from pprin
-00041220: 7420 696d 706f 7274 2070 7072 696e 740a  t import pprint.
-00041230: 2020 2020 3e3e 3e20 7070 7269 6e74 2872      >>> pprint(r
-00041240: 6570 6172 7469 7469 6f6e 5f64 6976 6973  epartition_divis
-00041250: 696f 6e73 285b 312c 2033 2c20 375d 2c20  ions([1, 3, 7], 
-00041260: 5b31 2c20 342c 2036 2c20 375d 2c20 2761  [1, 4, 6, 7], 'a
-00041270: 272c 2027 6227 2c20 2763 2729 2920 2023  ', 'b', 'c'))  #
-00041280: 2064 6f63 7465 7374 3a20 2b45 4c4c 4950   doctest: +ELLIP
-00041290: 5349 530a 2020 2020 7b28 2762 272c 2030  SIS.    {('b', 0
-000412a0: 293a 2028 3c66 756e 6374 696f 6e20 626f  ): (<function bo
-000412b0: 756e 6461 7279 5f73 6c69 6365 2061 7420  undary_slice at 
-000412c0: 2e2e 2e3e 2c20 2827 6127 2c20 3029 2c20  ...>, ('a', 0), 
-000412d0: 312c 2033 2c20 4661 6c73 6529 2c0a 2020  1, 3, False),.  
-000412e0: 2020 2028 2762 272c 2031 293a 2028 3c66     ('b', 1): (<f
-000412f0: 756e 6374 696f 6e20 626f 756e 6461 7279  unction boundary
-00041300: 5f73 6c69 6365 2061 7420 2e2e 2e3e 2c20  _slice at ...>, 
-00041310: 2827 6127 2c20 3129 2c20 332c 2034 2c20  ('a', 1), 3, 4, 
-00041320: 4661 6c73 6529 2c0a 2020 2020 2028 2762  False),.     ('b
-00041330: 272c 2032 293a 2028 3c66 756e 6374 696f  ', 2): (<functio
-00041340: 6e20 626f 756e 6461 7279 5f73 6c69 6365  n boundary_slice
-00041350: 2061 7420 2e2e 2e3e 2c20 2827 6127 2c20   at ...>, ('a', 
-00041360: 3129 2c20 342c 2036 2c20 4661 6c73 6529  1), 4, 6, False)
-00041370: 2c0a 2020 2020 2028 2762 272c 2033 293a  ,.     ('b', 3):
-00041380: 2028 3c66 756e 6374 696f 6e20 626f 756e   (<function boun
-00041390: 6461 7279 5f73 6c69 6365 2061 7420 2e2e  dary_slice at ..
-000413a0: 2e3e 2c20 2827 6127 2c20 3129 2c20 362c  .>, ('a', 1), 6,
-000413b0: 2037 2c20 5472 7565 292c 0a20 2020 2020   7, True),.     
-000413c0: 2827 6327 2c20 3029 3a20 283c 6675 6e63  ('c', 0): (<func
-000413d0: 7469 6f6e 2063 6f6e 6361 7420 6174 202e  tion concat at .
-000413e0: 2e2e 3e2c 205b 2827 6227 2c20 3029 2c20  ..>, [('b', 0), 
-000413f0: 2827 6227 2c20 3129 5d29 2c0a 2020 2020  ('b', 1)]),.    
-00041400: 2028 2763 272c 2031 293a 2028 2762 272c   ('c', 1): ('b',
-00041410: 2032 292c 0a20 2020 2020 2827 6327 2c20   2),.     ('c', 
-00041420: 3229 3a20 2827 6227 2c20 3329 7d0a 2020  2): ('b', 3)}.  
-00041430: 2020 2222 220a 2020 2020 6368 6563 6b5f    """.    check_
-00041440: 6469 7669 7369 6f6e 7328 6229 0a0a 2020  divisions(b)..  
-00041450: 2020 6966 206c 656e 2862 2920 3c20 323a    if len(b) < 2:
-00041460: 0a20 2020 2020 2020 2023 206d 696e 696d  .        # minim
-00041470: 756d 2064 6976 6973 696f 6e20 6973 2032  um division is 2
-00041480: 2065 6c65 6d65 6e74 732c 206c 696b 6520   elements, like 
-00041490: 5b30 2c20 305d 0a20 2020 2020 2020 2072  [0, 0].        r
-000414a0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-000414b0: 224e 6577 2064 6976 6973 696f 6e20 6d75  "New division mu
-000414c0: 7374 2062 6520 6c6f 6e67 6572 2074 6861  st be longer tha
-000414d0: 6e20 3220 656c 656d 656e 7473 2229 0a0a  n 2 elements")..
-000414e0: 2020 2020 6966 2066 6f72 6365 3a0a 2020      if force:.  
-000414f0: 2020 2020 2020 6966 2061 5b30 5d20 3c20        if a[0] < 
-00041500: 625b 305d 3a0a 2020 2020 2020 2020 2020  b[0]:.          
-00041510: 2020 6d73 6720 3d20 280a 2020 2020 2020    msg = (.      
-00041520: 2020 2020 2020 2020 2020 226c 6566 7420            "left 
-00041530: 7369 6465 206f 6620 7468 6520 6e65 7720  side of the new 
-00041540: 6469 7669 7369 6f6e 206d 7573 7420 6265  division must be
-00041550: 2065 7175 616c 206f 7220 736d 616c 6c65   equal or smalle
-00041560: 7220 220a 2020 2020 2020 2020 2020 2020  r ".            
-00041570: 2020 2020 2274 6861 6e20 6f6c 6420 6469      "than old di
-00041580: 7669 7369 6f6e 220a 2020 2020 2020 2020  vision".        
-00041590: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000415a0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000415b0: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
-000415c0: 6966 2061 5b2d 315d 203e 2062 5b2d 315d  if a[-1] > b[-1]
-000415d0: 3a0a 2020 2020 2020 2020 2020 2020 6d73  :.            ms
-000415e0: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
-000415f0: 2020 2020 2020 2272 6967 6874 2073 6964        "right sid
-00041600: 6520 6f66 2074 6865 206e 6577 2064 6976  e of the new div
-00041610: 6973 696f 6e20 6d75 7374 2062 6520 6571  ision must be eq
-00041620: 7561 6c20 6f72 206c 6172 6765 7220 220a  ual or larger ".
-00041630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041640: 2274 6861 6e20 6f6c 6420 6469 7669 7369  "than old divisi
-00041650: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
-00041660: 290a 2020 2020 2020 2020 2020 2020 7261  ).            ra
-00041670: 6973 6520 5661 6c75 6545 7272 6f72 286d  ise ValueError(m
-00041680: 7367 290a 2020 2020 656c 7365 3a0a 2020  sg).    else:.  
-00041690: 2020 2020 2020 6966 2061 5b30 5d20 213d        if a[0] !=
-000416a0: 2062 5b30 5d3a 0a20 2020 2020 2020 2020   b[0]:.         
-000416b0: 2020 206d 7367 203d 2022 6c65 6674 2073     msg = "left s
-000416c0: 6964 6520 6f66 206f 6c64 2061 6e64 206e  ide of old and n
-000416d0: 6577 2064 6976 6973 696f 6e73 2061 7265  ew divisions are
-000416e0: 2064 6966 6665 7265 6e74 220a 2020 2020   different".    
-000416f0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00041700: 6c75 6545 7272 6f72 286d 7367 290a 2020  lueError(msg).  
-00041710: 2020 2020 2020 6966 2061 5b2d 315d 2021        if a[-1] !
-00041720: 3d20 625b 2d31 5d3a 0a20 2020 2020 2020  = b[-1]:.       
-00041730: 2020 2020 206d 7367 203d 2022 7269 6768       msg = "righ
-00041740: 7420 7369 6465 206f 6620 6f6c 6420 616e  t side of old an
-00041750: 6420 6e65 7720 6469 7669 7369 6f6e 7320  d new divisions 
-00041760: 6172 6520 6469 6666 6572 656e 7422 0a20  are different". 
-00041770: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00041780: 2056 616c 7565 4572 726f 7228 6d73 6729   ValueError(msg)
-00041790: 0a0a 2020 2020 6465 6620 5f69 735f 7369  ..    def _is_si
-000417a0: 6e67 6c65 5f6c 6173 745f 6469 7628 7829  ngle_last_div(x)
-000417b0: 3a0a 2020 2020 2020 2020 2222 2257 6865  :.        """Whe
-000417c0: 7468 6572 206c 6173 7420 6469 7669 7369  ther last divisi
-000417d0: 6f6e 206f 6e6c 7920 636f 6e74 6169 6e73  on only contains
-000417e0: 2073 696e 676c 6520 6c61 6265 6c22 2222   single label"""
-000417f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00041800: 6c65 6e28 7829 203e 3d20 3220 616e 6420  len(x) >= 2 and 
-00041810: 785b 2d31 5d20 3d3d 2078 5b2d 325d 0a0a  x[-1] == x[-2]..
-00041820: 2020 2020 6320 3d20 5b61 5b30 5d5d 0a20      c = [a[0]]. 
-00041830: 2020 2064 203d 2064 6963 7428 290a 2020     d = dict().  
-00041840: 2020 6c6f 7720 3d20 615b 305d 0a0a 2020    low = a[0]..  
-00041850: 2020 692c 206a 203d 2031 2c20 3120 2023    i, j = 1, 1  #
-00041860: 2069 6e64 6963 6573 2066 6f72 206f 6c64   indices for old
-00041870: 2f6e 6577 2064 6976 6973 696f 6e73 0a20  /new divisions. 
-00041880: 2020 206b 203d 2030 2020 2320 696e 6465     k = 0  # inde
-00041890: 7820 666f 7220 7465 6d70 2064 6976 6973  x for temp divis
-000418a0: 696f 6e73 0a0a 2020 2020 6c61 7374 5f65  ions..    last_e
-000418b0: 6c65 6d20 3d20 5f69 735f 7369 6e67 6c65  lem = _is_single
-000418c0: 5f6c 6173 745f 6469 7628 6129 0a0a 2020  _last_div(a)..  
-000418d0: 2020 2320 7072 6f63 6573 7320 7468 726f    # process thro
-000418e0: 7567 6820 6f6c 6420 6469 7669 7369 6f6e  ugh old division
-000418f0: 0a20 2020 2023 206c 6566 7420 7061 7274  .    # left part
-00041900: 206f 6620 6e65 7720 6469 7669 7369 6f6e   of new division
-00041910: 2063 616e 2062 6520 7072 6f63 6573 7365   can be processe
-00041920: 6420 696e 2074 6869 7320 6c6f 6f70 0a20  d in this loop. 
-00041930: 2020 2077 6869 6c65 2069 203c 206c 656e     while i < len
-00041940: 2861 2920 616e 6420 6a20 3c20 6c65 6e28  (a) and j < len(
-00041950: 6229 3a0a 2020 2020 2020 2020 6966 2061  b):.        if a
-00041960: 5b69 5d20 3c20 625b 6a5d 3a0a 2020 2020  [i] < b[j]:.    
-00041970: 2020 2020 2020 2020 2320 7475 706c 6520          # tuple 
-00041980: 6973 2073 6f6d 6574 6869 6e67 206c 696b  is something lik
-00041990: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
-000419a0: 2028 6d65 7468 6f64 732e 626f 756e 6461   (methods.bounda
-000419b0: 7279 5f73 6c69 6365 2c20 2827 6672 6f6d  ry_slice, ('from
-000419c0: 5f70 616e 6461 732d 2327 2c20 3029 2c20  _pandas-#', 0), 
-000419d0: 332c 2034 2c20 4661 6c73 6529 290a 2020  3, 4, False)).  
-000419e0: 2020 2020 2020 2020 2020 645b 286f 7574            d[(out
-000419f0: 312c 206b 295d 203d 2028 6d65 7468 6f64  1, k)] = (method
-00041a00: 732e 626f 756e 6461 7279 5f73 6c69 6365  s.boundary_slice
-00041a10: 2c20 286e 616d 652c 2069 202d 2031 292c  , (name, i - 1),
-00041a20: 206c 6f77 2c20 615b 695d 2c20 4661 6c73   low, a[i], Fals
-00041a30: 6529 0a20 2020 2020 2020 2020 2020 206c  e).            l
-00041a40: 6f77 203d 2061 5b69 5d0a 2020 2020 2020  ow = a[i].      
-00041a50: 2020 2020 2020 6920 2b3d 2031 0a20 2020        i += 1.   
-00041a60: 2020 2020 2065 6c69 6620 615b 695d 203e       elif a[i] >
-00041a70: 2062 5b6a 5d3a 0a20 2020 2020 2020 2020   b[j]:.         
-00041a80: 2020 2064 5b28 6f75 7431 2c20 6b29 5d20     d[(out1, k)] 
-00041a90: 3d20 286d 6574 686f 6473 2e62 6f75 6e64  = (methods.bound
-00041aa0: 6172 795f 736c 6963 652c 2028 6e61 6d65  ary_slice, (name
-00041ab0: 2c20 6920 2d20 3129 2c20 6c6f 772c 2062  , i - 1), low, b
-00041ac0: 5b6a 5d2c 2046 616c 7365 290a 2020 2020  [j], False).    
-00041ad0: 2020 2020 2020 2020 6c6f 7720 3d20 625b          low = b[
-00041ae0: 6a5d 0a20 2020 2020 2020 2020 2020 206a  j].            j
-00041af0: 202b 3d20 310a 2020 2020 2020 2020 656c   += 1.        el
-00041b00: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00041b10: 645b 286f 7574 312c 206b 295d 203d 2028  d[(out1, k)] = (
-00041b20: 6d65 7468 6f64 732e 626f 756e 6461 7279  methods.boundary
-00041b30: 5f73 6c69 6365 2c20 286e 616d 652c 2069  _slice, (name, i
-00041b40: 202d 2031 292c 206c 6f77 2c20 625b 6a5d   - 1), low, b[j]
-00041b50: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
-00041b60: 2020 2020 206c 6f77 203d 2062 5b6a 5d0a       low = b[j].
-00041b70: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00041b80: 656e 2861 2920 3d3d 2069 202b 2031 206f  en(a) == i + 1 o
-00041b90: 7220 615b 695d 203c 2061 5b69 202b 2031  r a[i] < a[i + 1
-00041ba0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-00041bb0: 2020 206a 202b 3d20 310a 2020 2020 2020     j += 1.      
-00041bc0: 2020 2020 2020 6920 2b3d 2031 0a20 2020        i += 1.   
-00041bd0: 2020 2020 2063 2e61 7070 656e 6428 6c6f       c.append(lo
-00041be0: 7729 0a20 2020 2020 2020 206b 202b 3d20  w).        k += 
-00041bf0: 310a 0a20 2020 2023 2072 6967 6874 2070  1..    # right p
-00041c00: 6172 7420 6f66 206e 6577 2064 6976 6973  art of new divis
-00041c10: 696f 6e20 6361 6e20 7265 6d61 696e 0a20  ion can remain. 
-00041c20: 2020 2069 6620 615b 2d31 5d20 3c20 625b     if a[-1] < b[
-00041c30: 2d31 5d20 6f72 2062 5b2d 315d 203d 3d20  -1] or b[-1] == 
-00041c40: 625b 2d32 5d3a 0a20 2020 2020 2020 2066  b[-2]:.        f
-00041c50: 6f72 205f 6a20 696e 2072 616e 6765 286a  or _j in range(j
-00041c60: 2c20 6c65 6e28 6229 293a 0a20 2020 2020  , len(b)):.     
-00041c70: 2020 2020 2020 2023 2061 6c77 6179 7320         # always 
-00041c80: 7573 6520 7269 6768 742d 6d6f 7374 206f  use right-most o
-00041c90: 6620 6f6c 6420 6469 7669 7369 6f6e 0a20  f old division. 
-00041ca0: 2020 2020 2020 2020 2020 2023 2062 6563             # bec
-00041cb0: 6175 7365 2069 7420 6d61 7920 636f 6e74  ause it may cont
-00041cc0: 6169 6e20 6c61 7374 2065 6c65 6d65 6e74  ain last element
-00041cd0: 0a20 2020 2020 2020 2020 2020 206d 203d  .            m =
-00041ce0: 206c 656e 2861 2920 2d20 320a 2020 2020   len(a) - 2.    
-00041cf0: 2020 2020 2020 2020 645b 286f 7574 312c          d[(out1,
-00041d00: 206b 295d 203d 2028 6d65 7468 6f64 732e   k)] = (methods.
-00041d10: 626f 756e 6461 7279 5f73 6c69 6365 2c20  boundary_slice, 
-00041d20: 286e 616d 652c 206d 292c 206c 6f77 2c20  (name, m), low, 
-00041d30: 625b 5f6a 5d2c 2046 616c 7365 290a 2020  b[_j], False).  
-00041d40: 2020 2020 2020 2020 2020 6c6f 7720 3d20            low = 
-00041d50: 625b 5f6a 5d0a 2020 2020 2020 2020 2020  b[_j].          
-00041d60: 2020 632e 6170 7065 6e64 286c 6f77 290a    c.append(low).
-00041d70: 2020 2020 2020 2020 2020 2020 6b20 2b3d              k +=
-00041d80: 2031 0a20 2020 2065 6c73 653a 0a20 2020   1.    else:.   
-00041d90: 2020 2020 2023 2065 7665 6e20 6966 206e       # even if n
-00041da0: 6577 2064 6976 6973 696f 6e20 6973 2070  ew division is p
-00041db0: 726f 6365 7373 6564 2074 6872 6f75 6768  rocessed through
-00041dc0: 2c0a 2020 2020 2020 2020 2320 7269 6768  ,.        # righ
-00041dd0: 742d 6d6f 7374 2065 6c65 6d65 6e74 206f  t-most element o
-00041de0: 6620 6f6c 6420 6469 7669 7369 6f6e 2063  f old division c
-00041df0: 616e 2072 656d 6169 6e0a 2020 2020 2020  an remain.      
-00041e00: 2020 6966 206c 6173 745f 656c 656d 2061    if last_elem a
-00041e10: 6e64 2069 203c 206c 656e 2861 293a 0a20  nd i < len(a):. 
-00041e20: 2020 2020 2020 2020 2020 2064 5b28 6f75             d[(ou
-00041e30: 7431 2c20 6b29 5d20 3d20 286d 6574 686f  t1, k)] = (metho
-00041e40: 6473 2e62 6f75 6e64 6172 795f 736c 6963  ds.boundary_slic
-00041e50: 652c 2028 6e61 6d65 2c20 6920 2d20 3129  e, (name, i - 1)
-00041e60: 2c20 615b 695d 2c20 615b 695d 2c20 4661  , a[i], a[i], Fa
-00041e70: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
-00041e80: 206b 202b 3d20 310a 2020 2020 2020 2020   k += 1.        
-00041e90: 632e 6170 7065 6e64 2861 5b2d 315d 290a  c.append(a[-1]).
-00041ea0: 0a20 2020 2023 2072 6570 6c61 6365 206c  .    # replace l
-00041eb0: 6173 7420 656c 656d 656e 7420 6f66 2074  ast element of t
-00041ec0: 7570 6c65 2077 6974 6820 5472 7565 0a20  uple with True. 
-00041ed0: 2020 2064 5b28 6f75 7431 2c20 6b20 2d20     d[(out1, k - 
-00041ee0: 3129 5d20 3d20 645b 286f 7574 312c 206b  1)] = d[(out1, k
-00041ef0: 202d 2031 295d 5b3a 2d31 5d20 2b20 2854   - 1)][:-1] + (T
-00041f00: 7275 652c 290a 0a20 2020 2069 2c20 6a20  rue,)..    i, j 
-00041f10: 3d20 302c 2031 0a0a 2020 2020 6c61 7374  = 0, 1..    last
-00041f20: 5f65 6c65 6d20 3d20 5f69 735f 7369 6e67  _elem = _is_sing
-00041f30: 6c65 5f6c 6173 745f 6469 7628 6329 0a0a  le_last_div(c)..
-00041f40: 2020 2020 7768 696c 6520 6a20 3c20 6c65      while j < le
-00041f50: 6e28 6229 3a0a 2020 2020 2020 2020 746d  n(b):.        tm
-00041f60: 7020 3d20 5b5d 0a20 2020 2020 2020 2077  p = [].        w
-00041f70: 6869 6c65 2063 5b69 5d20 3c20 625b 6a5d  hile c[i] < b[j]
-00041f80: 3a0a 2020 2020 2020 2020 2020 2020 746d  :.            tm
-00041f90: 702e 6170 7065 6e64 2828 6f75 7431 2c20  p.append((out1, 
-00041fa0: 6929 290a 2020 2020 2020 2020 2020 2020  i)).            
-00041fb0: 6920 2b3d 2031 0a20 2020 2020 2020 2077  i += 1.        w
-00041fc0: 6869 6c65 2028 0a20 2020 2020 2020 2020  hile (.         
-00041fd0: 2020 206c 6173 745f 656c 656d 0a20 2020     last_elem.   
-00041fe0: 2020 2020 2020 2020 2061 6e64 2063 5b69           and c[i
-00041ff0: 5d20 3d3d 2062 5b2d 315d 0a20 2020 2020  ] == b[-1].     
-00042000: 2020 2020 2020 2061 6e64 2028 625b 2d31         and (b[-1
-00042010: 5d20 213d 2062 5b2d 325d 206f 7220 6a20  ] != b[-2] or j 
-00042020: 3d3d 206c 656e 2862 2920 2d20 3129 0a20  == len(b) - 1). 
-00042030: 2020 2020 2020 2020 2020 2061 6e64 2069             and i
-00042040: 203c 206b 0a20 2020 2020 2020 2029 3a0a   < k.        ):.
-00042050: 2020 2020 2020 2020 2020 2020 2320 6170              # ap
-00042060: 7065 6e64 2069 6620 6c61 7374 2073 706c  pend if last spl
-00042070: 6974 2069 7320 6e6f 7420 696e 636c 7564  it is not includ
-00042080: 6564 0a20 2020 2020 2020 2020 2020 2074  ed.            t
-00042090: 6d70 2e61 7070 656e 6428 286f 7574 312c  mp.append((out1,
-000420a0: 2069 2929 0a20 2020 2020 2020 2020 2020   i)).           
-000420b0: 2069 202b 3d20 310a 2020 2020 2020 2020   i += 1.        
-000420c0: 6966 206c 656e 2874 6d70 2920 3d3d 2030  if len(tmp) == 0
-000420d0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-000420e0: 6475 6d6d 7920 736c 6963 6520 746f 2072  dummy slice to r
-000420f0: 6574 7572 6e20 656d 7074 7920 4461 7461  eturn empty Data
-00042100: 4672 616d 6520 6f72 2053 6572 6965 732c  Frame or Series,
-00042110: 0a20 2020 2020 2020 2020 2020 2023 2077  .            # w
-00042120: 6869 6368 2072 6574 6169 6e20 6f72 6967  hich retain orig
-00042130: 696e 616c 2064 6174 6120 6174 7472 6962  inal data attrib
-00042140: 7574 6573 2028 636f 6c75 6d6e 7320 2f20  utes (columns / 
-00042150: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
-00042160: 2020 645b 286f 7574 322c 206a 202d 2031    d[(out2, j - 1
-00042170: 295d 203d 2028 6d65 7468 6f64 732e 626f  )] = (methods.bo
-00042180: 756e 6461 7279 5f73 6c69 6365 2c20 286e  undary_slice, (n
-00042190: 616d 652c 2030 292c 2061 5b30 5d2c 2061  ame, 0), a[0], a
-000421a0: 5b30 5d2c 2046 616c 7365 290a 2020 2020  [0], False).    
-000421b0: 2020 2020 656c 6966 206c 656e 2874 6d70      elif len(tmp
-000421c0: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
-000421d0: 2020 2020 645b 286f 7574 322c 206a 202d      d[(out2, j -
-000421e0: 2031 295d 203d 2074 6d70 5b30 5d0a 2020   1)] = tmp[0].  
-000421f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00042200: 2020 2020 2020 2020 6966 206e 6f74 2074          if not t
-00042210: 6d70 3a0a 2020 2020 2020 2020 2020 2020  mp:.            
-00042220: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00042230: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00042240: 2020 2020 2020 2020 2020 2263 6865 636b            "check
-00042250: 2066 6f72 2064 7570 6c69 6361 7465 2070   for duplicate p
-00042260: 6172 7469 7469 6f6e 735c 6e6f 6c64 3a5c  artitions\nold:\
-00042270: 6e25 735c 6e5c 6e22 0a20 2020 2020 2020  n%s\n\n".       
-00042280: 2020 2020 2020 2020 2020 2020 2022 6e65               "ne
-00042290: 773a 5c6e 2573 5c6e 5c6e 636f 6d62 696e  w:\n%s\n\ncombin
-000422a0: 6564 3a5c 6e25 7322 2025 2028 7066 6f72  ed:\n%s" % (pfor
-000422b0: 6d61 7428 6129 2c20 7066 6f72 6d61 7428  mat(a), pformat(
-000422c0: 6229 2c20 7066 6f72 6d61 7428 6329 290a  b), pformat(c)).
-000422d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000422e0: 290a 2020 2020 2020 2020 2020 2020 645b  ).            d[
-000422f0: 286f 7574 322c 206a 202d 2031 295d 203d  (out2, j - 1)] =
-00042300: 2028 6d65 7468 6f64 732e 636f 6e63 6174   (methods.concat
-00042310: 2c20 746d 7029 0a20 2020 2020 2020 206a  , tmp).        j
-00042320: 202b 3d20 310a 2020 2020 7265 7475 726e   += 1.    return
-00042330: 2064 0a0a 0a64 6566 2072 6570 6172 7469   d...def reparti
-00042340: 7469 6f6e 5f66 7265 7128 6466 2c20 6672  tion_freq(df, fr
-00042350: 6571 3d4e 6f6e 6529 3a0a 2020 2020 2222  eq=None):.    ""
-00042360: 2252 6570 6172 7469 7469 6f6e 2061 2074  "Repartition a t
-00042370: 696d 6573 6572 6965 7320 6461 7461 6672  imeseries datafr
-00042380: 616d 6520 6279 2061 206e 6577 2066 7265  ame by a new fre
-00042390: 7175 656e 6379 2222 220a 2020 2020 6966  quency""".    if
-000423a0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-000423b0: 6466 2e64 6976 6973 696f 6e73 5b30 5d2c  df.divisions[0],
-000423c0: 2070 642e 5469 6d65 7374 616d 7029 3a0a   pd.Timestamp):.
-000423d0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-000423e0: 7065 4572 726f 7228 2243 616e 206f 6e6c  peError("Can onl
-000423f0: 7920 7265 7061 7274 6974 696f 6e20 6f6e  y repartition on
-00042400: 2066 7265 7175 656e 6379 2066 6f72 2074   frequency for t
-00042410: 696d 6573 6572 6965 7322 290a 0a20 2020  imeseries")..   
-00042420: 2066 7265 7120 3d20 5f6d 6170 5f66 7265   freq = _map_fre
-00042430: 715f 746f 5f70 6572 696f 645f 7374 6172  q_to_period_star
-00042440: 7428 6672 6571 290a 0a20 2020 2074 7279  t(freq)..    try
-00042450: 3a0a 2020 2020 2020 2020 7374 6172 7420  :.        start 
-00042460: 3d20 6466 2e64 6976 6973 696f 6e73 5b30  = df.divisions[0
-00042470: 5d2e 6365 696c 2866 7265 7129 0a20 2020  ].ceil(freq).   
-00042480: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
-00042490: 6f72 3a0a 2020 2020 2020 2020 7374 6172  or:.        star
-000424a0: 7420 3d20 6466 2e64 6976 6973 696f 6e73  t = df.divisions
-000424b0: 5b30 5d0a 2020 2020 6469 7669 7369 6f6e  [0].    division
-000424c0: 7320 3d20 6d65 7468 6f64 732e 746f 6c69  s = methods.toli
-000424d0: 7374 280a 2020 2020 2020 2020 7064 2e64  st(.        pd.d
-000424e0: 6174 655f 7261 6e67 6528 7374 6172 743d  ate_range(start=
-000424f0: 7374 6172 742c 2065 6e64 3d64 662e 6469  start, end=df.di
-00042500: 7669 7369 6f6e 735b 2d31 5d2c 2066 7265  visions[-1], fre
-00042510: 713d 6672 6571 290a 2020 2020 290a 2020  q=freq).    ).  
-00042520: 2020 6966 206e 6f74 206c 656e 2864 6976    if not len(div
-00042530: 6973 696f 6e73 293a 0a20 2020 2020 2020  isions):.       
-00042540: 2064 6976 6973 696f 6e73 203d 205b 6466   divisions = [df
-00042550: 2e64 6976 6973 696f 6e73 5b30 5d2c 2064  .divisions[0], d
-00042560: 662e 6469 7669 7369 6f6e 735b 2d31 5d5d  f.divisions[-1]]
-00042570: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-00042580: 2020 2064 6976 6973 696f 6e73 2e61 7070     divisions.app
-00042590: 656e 6428 6466 2e64 6976 6973 696f 6e73  end(df.divisions
-000425a0: 5b2d 315d 290a 2020 2020 2020 2020 6966  [-1]).        if
-000425b0: 2064 6976 6973 696f 6e73 5b30 5d20 213d   divisions[0] !=
-000425c0: 2064 662e 6469 7669 7369 6f6e 735b 305d   df.divisions[0]
-000425d0: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-000425e0: 7669 7369 6f6e 7320 3d20 5b64 662e 6469  visions = [df.di
-000425f0: 7669 7369 6f6e 735b 305d 5d20 2b20 6469  visions[0]] + di
-00042600: 7669 7369 6f6e 730a 0a20 2020 2072 6574  visions..    ret
-00042610: 7572 6e20 6466 2e72 6570 6172 7469 7469  urn df.repartiti
-00042620: 6f6e 2864 6976 6973 696f 6e73 3d64 6976  on(divisions=div
-00042630: 6973 696f 6e73 290a 0a0a 6465 6620 5f6d  isions)...def _m
-00042640: 6170 5f66 7265 715f 746f 5f70 6572 696f  ap_freq_to_perio
-00042650: 645f 7374 6172 7428 6672 6571 293a 0a20  d_start(freq):. 
-00042660: 2020 2022 2222 456e 7375 7265 2074 6861     """Ensure tha
-00042670: 7420 7468 6520 6672 6571 7565 6e63 7920  t the frequency 
-00042680: 7065 7274 6169 6e73 2074 6f20 7468 6520  pertains to the 
-00042690: 2a2a 7374 6172 742a 2a20 6f66 2061 2070  **start** of a p
-000426a0: 6572 696f 642e 0a0a 2020 2020 4966 2065  eriod...    If e
-000426b0: 2e67 2e20 6066 7265 713d 274d 2760 2c20  .g. `freq='M'`, 
-000426c0: 7468 656e 2074 6865 2064 6976 6973 696f  then the divisio
-000426d0: 6e73 2061 7265 3a0a 2020 2020 2020 2020  ns are:.        
-000426e0: 2d20 3230 3231 2d33 312d 3120 3030 3a30  - 2021-31-1 00:0
-000426f0: 303a 3030 2028 7374 6172 7420 6f66 2046  0:00 (start of F
-00042700: 6562 7275 6172 7920 7061 7274 6974 696f  ebruary partitio
-00042710: 6e29 0a20 2020 2020 2020 202d 2032 3032  n).        - 202
-00042720: 312d 322d 3238 2030 303a 3030 3a30 3020  1-2-28 00:00:00 
-00042730: 2873 7461 7274 206f 6620 4d61 7263 6820  (start of March 
-00042740: 7061 7274 6974 696f 6e29 0a20 2020 2020  partition).     
-00042750: 2020 202d 202e 2e2e 0a0a 2020 2020 6275     - .....    bu
-00042760: 7420 7468 6973 202a 2a73 686f 756c 642a  t this **should*
-00042770: 2a20 6265 3a0a 2020 2020 2020 2020 2d20  * be:.        - 
-00042780: 3230 3231 2d32 2d31 2030 303a 3030 3a30  2021-2-1 00:00:0
-00042790: 3020 2873 7461 7274 206f 6620 4665 6272  0 (start of Febr
-000427a0: 7561 7279 2070 6172 7469 7469 6f6e 290a  uary partition).
-000427b0: 2020 2020 2020 2020 2d20 3230 3231 2d33          - 2021-3
-000427c0: 2d31 2030 303a 3030 3a30 3020 2873 7461  -1 00:00:00 (sta
-000427d0: 7274 206f 6620 4d61 7263 6820 7061 7274  rt of March part
-000427e0: 6974 696f 6e29 0a20 2020 2020 2020 202d  ition).        -
-000427f0: 202e 2e2e 0a0a 2020 2020 5468 6572 6566   .....    Theref
-00042800: 6f72 652c 2077 6520 6d61 7020 6066 7265  ore, we map `fre
-00042810: 713d 274d 2760 2074 6f20 6066 7265 713d  q='M'` to `freq=
-00042820: 274d 5327 6020 2873 616d 6520 666f 7220  'MS'` (same for 
-00042830: 7175 6172 7465 7220 616e 6420 7965 6172  quarter and year
-00042840: 292e 0a20 2020 2022 2222 0a0a 2020 2020  )..    """..    
-00042850: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00042860: 6528 6672 6571 2c20 7374 7229 3a0a 2020  e(freq, str):.  
-00042870: 2020 2020 2020 7265 7475 726e 2066 7265        return fre
-00042880: 710a 0a20 2020 206f 6666 7365 7420 3d20  q..    offset = 
-00042890: 7064 2e74 7365 7269 6573 2e66 7265 7175  pd.tseries.frequ
-000428a0: 656e 6369 6573 2e74 6f5f 6f66 6673 6574  encies.to_offset
-000428b0: 2866 7265 7129 0a20 2020 206f 6666 7365  (freq).    offse
-000428c0: 745f 7479 7065 5f6e 616d 6520 3d20 7479  t_type_name = ty
-000428d0: 7065 286f 6666 7365 7429 2e5f 5f6e 616d  pe(offset).__nam
-000428e0: 655f 5f0a 0a20 2020 2069 6620 6e6f 7420  e__..    if not 
-000428f0: 6f66 6673 6574 5f74 7970 655f 6e61 6d65  offset_type_name
-00042900: 2e65 6e64 7377 6974 6828 2245 6e64 2229  .endswith("End")
-00042910: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00042920: 2066 7265 710a 0a20 2020 206e 6577 5f6f   freq..    new_o
-00042930: 6666 7365 7420 3d20 6f66 6673 6574 5f74  ffset = offset_t
-00042940: 7970 655f 6e61 6d65 5b3a 202d 6c65 6e28  ype_name[: -len(
-00042950: 2245 6e64 2229 5d20 2b20 2242 6567 696e  "End")] + "Begin
-00042960: 220a 2020 2020 7472 793a 0a20 2020 2020  ".    try:.     
-00042970: 2020 206e 6577 5f6f 6666 7365 745f 7479     new_offset_ty
-00042980: 7065 203d 2067 6574 6174 7472 2870 642e  pe = getattr(pd.
-00042990: 7473 6572 6965 732e 6f66 6673 6574 732c  tseries.offsets,
-000429a0: 206e 6577 5f6f 6666 7365 7429 0a20 2020   new_offset).   
-000429b0: 2020 2020 2069 6620 222d 2220 696e 2066       if "-" in f
-000429c0: 7265 713a 0a20 2020 2020 2020 2020 2020  req:.           
-000429d0: 205f 2c20 616e 6368 6f72 203d 2066 7265   _, anchor = fre
-000429e0: 712e 7370 6c69 7428 222d 2229 0a20 2020  q.split("-").   
-000429f0: 2020 2020 2020 2020 2061 6e63 686f 7220           anchor 
-00042a00: 3d20 222d 2220 2b20 616e 6368 6f72 0a20  = "-" + anchor. 
-00042a10: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00042a20: 2020 2020 2020 2020 2061 6e63 686f 7220           anchor 
-00042a30: 3d20 2222 0a20 2020 2020 2020 206e 203d  = "".        n =
-00042a40: 2073 7472 286f 6666 7365 742e 6e29 2069   str(offset.n) i
-00042a50: 6620 6f66 6673 6574 2e6e 2021 3d20 3120  f offset.n != 1 
-00042a60: 656c 7365 2022 220a 2020 2020 2020 2020  else "".        
-00042a70: 7265 7475 726e 2066 227b 6e7d 7b6e 6577  return f"{n}{new
-00042a80: 5f6f 6666 7365 745f 7479 7065 2e5f 7072  _offset_type._pr
-00042a90: 6566 6978 7d7b 616e 6368 6f72 7d22 0a20  efix}{anchor}". 
-00042aa0: 2020 2065 7863 6570 7420 4174 7472 6962     except Attrib
-00042ab0: 7574 6545 7272 6f72 3a0a 2020 2020 2020  uteError:.      
-00042ac0: 2020 7265 7475 726e 2066 7265 710a 0a0a    return freq...
-00042ad0: 6465 6620 7265 7061 7274 6974 696f 6e5f  def repartition_
-00042ae0: 7369 7a65 2864 662c 2073 697a 6529 3a0a  size(df, size):.
-00042af0: 2020 2020 2222 220a 2020 2020 5265 7061      """.    Repa
-00042b00: 7274 6974 696f 6e20 6461 7461 6672 616d  rtition datafram
-00042b10: 6520 736f 2074 6861 7420 6e65 7720 7061  e so that new pa
-00042b20: 7274 6974 696f 6e73 2068 6176 6520 6170  rtitions have ap
-00042b30: 7072 6f78 696d 6174 656c 7920 6073 697a  proximately `siz
-00042b40: 6560 206d 656d 6f72 7920 7573 6167 6520  e` memory usage 
-00042b50: 6561 6368 0a20 2020 2022 2222 0a20 2020  each.    """.   
-00042b60: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
-00042b70: 697a 652c 2073 7472 293a 0a20 2020 2020  ize, str):.     
-00042b80: 2020 2073 697a 6520 3d20 7061 7273 655f     size = parse_
-00042b90: 6279 7465 7328 7369 7a65 290a 2020 2020  bytes(size).    
-00042ba0: 7369 7a65 203d 2069 6e74 2873 697a 6529  size = int(size)
-00042bb0: 0a0a 2020 2020 6d65 6d5f 7573 6167 6573  ..    mem_usages
-00042bc0: 203d 2064 662e 6d61 705f 7061 7274 6974   = df.map_partit
-00042bd0: 696f 6e73 2874 6f74 616c 5f6d 656d 5f75  ions(total_mem_u
-00042be0: 7361 6765 2c20 6465 6570 3d54 7275 6529  sage, deep=True)
-00042bf0: 2e63 6f6d 7075 7465 2829 0a0a 2020 2020  .compute()..    
-00042c00: 2320 312e 2073 706c 6974 2065 6163 6820  # 1. split each 
-00042c10: 7061 7274 6974 696f 6e20 7468 6174 2069  partition that i
-00042c20: 7320 6c61 7267 6572 2074 6861 6e20 7061  s larger than pa
-00042c30: 7274 6974 696f 6e5f 7369 7a65 0a20 2020  rtition_size.   
-00042c40: 206e 7370 6c69 7473 203d 2031 202b 206d   nsplits = 1 + m
-00042c50: 656d 5f75 7361 6765 7320 2f2f 2073 697a  em_usages // siz
-00042c60: 650a 2020 2020 6966 206e 702e 616e 7928  e.    if np.any(
-00042c70: 6e73 706c 6974 7320 3e20 3129 3a0a 2020  nsplits > 1):.  
-00042c80: 2020 2020 2020 7370 6c69 745f 6e61 6d65        split_name
-00042c90: 203d 2066 2272 6570 6172 7469 7469 6f6e   = f"repartition
-00042ca0: 2d73 706c 6974 2d7b 7369 7a65 7d2d 7b74  -split-{size}-{t
-00042cb0: 6f6b 656e 697a 6528 6466 297d 220a 2020  okenize(df)}".  
-00042cc0: 2020 2020 2020 6466 203d 205f 7370 6c69        df = _spli
-00042cd0: 745f 7061 7274 6974 696f 6e73 2864 662c  t_partitions(df,
-00042ce0: 206e 7370 6c69 7473 2c20 7370 6c69 745f   nsplits, split_
-00042cf0: 6e61 6d65 290a 2020 2020 2020 2020 2320  name).        # 
-00042d00: 7570 6461 7465 206d 656d 5f75 7361 6765  update mem_usage
-00042d10: 7320 746f 2061 6363 6f75 6e74 2066 6f72  s to account for
-00042d20: 2074 6865 2073 706c 6974 2070 6172 7469   the split parti
-00042d30: 7469 6f6e 730a 2020 2020 2020 2020 7370  tions.        sp
-00042d40: 6c69 745f 6d65 6d5f 7573 6167 6573 203d  lit_mem_usages =
-00042d50: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
-00042d60: 6e2c 2075 7361 6765 2069 6e20 7a69 7028  n, usage in zip(
-00042d70: 6e73 706c 6974 732c 206d 656d 5f75 7361  nsplits, mem_usa
-00042d80: 6765 7329 3a0a 2020 2020 2020 2020 2020  ges):.          
-00042d90: 2020 7370 6c69 745f 6d65 6d5f 7573 6167    split_mem_usag
-00042da0: 6573 2e65 7874 656e 6428 5b75 7361 6765  es.extend([usage
-00042db0: 202f 206e 5d20 2a20 6e29 0a20 2020 2020   / n] * n).     
-00042dc0: 2020 206d 656d 5f75 7361 6765 7320 3d20     mem_usages = 
-00042dd0: 7064 2e53 6572 6965 7328 7370 6c69 745f  pd.Series(split_
-00042de0: 6d65 6d5f 7573 6167 6573 290a 0a20 2020  mem_usages)..   
-00042df0: 2023 2032 2e20 6e6f 7720 7468 6174 2061   # 2. now that a
-00042e00: 6c6c 2070 6172 7469 7469 6f6e 7320 6172  ll partitions ar
-00042e10: 6520 6c65 7373 2074 6861 6e20 7369 7a65  e less than size
-00042e20: 2c20 636f 6e63 6174 2074 6865 6d20 7570  , concat them up
-00042e30: 2074 6f20 7369 7a65 0a20 2020 2061 7373   to size.    ass
-00042e40: 6572 7420 6e70 2e61 6c6c 286d 656d 5f75  ert np.all(mem_u
-00042e50: 7361 6765 7320 3c3d 2073 697a 6529 0a20  sages <= size). 
-00042e60: 2020 206e 6577 5f6e 7061 7274 6974 696f     new_npartitio
-00042e70: 6e73 203d 206c 6973 7428 6d61 7028 6c65  ns = list(map(le
-00042e80: 6e2c 2069 7465 725f 6368 756e 6b73 286d  n, iter_chunks(m
-00042e90: 656d 5f75 7361 6765 732c 2073 697a 6529  em_usages, size)
-00042ea0: 2929 0a20 2020 206e 6577 5f70 6172 7469  )).    new_parti
-00042eb0: 7469 6f6e 735f 626f 756e 6461 7269 6573  tions_boundaries
-00042ec0: 203d 206e 702e 6375 6d73 756d 286e 6577   = np.cumsum(new
-00042ed0: 5f6e 7061 7274 6974 696f 6e73 290a 2020  _npartitions).  
-00042ee0: 2020 6e65 775f 6e61 6d65 203d 2066 2272    new_name = f"r
-00042ef0: 6570 6172 7469 7469 6f6e 2d7b 7369 7a65  epartition-{size
-00042f00: 7d2d 7b74 6f6b 656e 697a 6528 6466 297d  }-{tokenize(df)}
-00042f10: 220a 2020 2020 7265 7475 726e 205f 7265  ".    return _re
-00042f20: 7061 7274 6974 696f 6e5f 6672 6f6d 5f62  partition_from_b
-00042f30: 6f75 6e64 6172 6965 7328 6466 2c20 6e65  oundaries(df, ne
-00042f40: 775f 7061 7274 6974 696f 6e73 5f62 6f75  w_partitions_bou
-00042f50: 6e64 6172 6965 732c 206e 6577 5f6e 616d  ndaries, new_nam
-00042f60: 6529 0a0a 0a64 6566 2074 6f74 616c 5f6d  e)...def total_m
-00042f70: 656d 5f75 7361 6765 2864 662c 2069 6e64  em_usage(df, ind
-00042f80: 6578 3d54 7275 652c 2064 6565 703d 4661  ex=True, deep=Fa
-00042f90: 6c73 6529 3a0a 2020 2020 6d65 6d5f 7573  lse):.    mem_us
-00042fa0: 6167 6520 3d20 6466 2e6d 656d 6f72 795f  age = df.memory_
-00042fb0: 7573 6167 6528 696e 6465 783d 696e 6465  usage(index=inde
-00042fc0: 782c 2064 6565 703d 6465 6570 290a 2020  x, deep=deep).  
-00042fd0: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
-00042fe0: 696b 6528 6d65 6d5f 7573 6167 6529 3a0a  ike(mem_usage):.
-00042ff0: 2020 2020 2020 2020 6d65 6d5f 7573 6167          mem_usag
-00043000: 6520 3d20 6d65 6d5f 7573 6167 652e 7375  e = mem_usage.su
-00043010: 6d28 290a 2020 2020 7265 7475 726e 206d  m().    return m
-00043020: 656d 5f75 7361 6765 0a0a 0a64 6566 2072  em_usage...def r
-00043030: 6570 6172 7469 7469 6f6e 5f6e 7061 7274  epartition_npart
-00043040: 6974 696f 6e73 2864 662c 206e 7061 7274  itions(df, npart
-00043050: 6974 696f 6e73 293a 0a20 2020 2022 2222  itions):.    """
-00043060: 5265 7061 7274 6974 696f 6e20 6461 7461  Repartition data
-00043070: 6672 616d 6520 746f 2061 2073 6d61 6c6c  frame to a small
-00043080: 6572 206e 756d 6265 7220 6f66 2070 6172  er number of par
-00043090: 7469 7469 6f6e 7322 2222 0a20 2020 206e  titions""".    n
-000430a0: 6577 5f6e 616d 6520 3d20 2272 6570 6172  ew_name = "repar
-000430b0: 7469 7469 6f6e 2d25 642d 2573 2220 2520  tition-%d-%s" % 
-000430c0: 286e 7061 7274 6974 696f 6e73 2c20 746f  (npartitions, to
-000430d0: 6b65 6e69 7a65 2864 6629 290a 2020 2020  kenize(df)).    
-000430e0: 6966 2064 662e 6e70 6172 7469 7469 6f6e  if df.npartition
-000430f0: 7320 3d3d 206e 7061 7274 6974 696f 6e73  s == npartitions
-00043100: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00043110: 2064 660a 2020 2020 656c 6966 2064 662e   df.    elif df.
-00043120: 6e70 6172 7469 7469 6f6e 7320 3e20 6e70  npartitions > np
-00043130: 6172 7469 7469 6f6e 733a 0a20 2020 2020  artitions:.     
-00043140: 2020 206e 7061 7274 6974 696f 6e73 5f72     npartitions_r
-00043150: 6174 696f 203d 2064 662e 6e70 6172 7469  atio = df.nparti
-00043160: 7469 6f6e 7320 2f20 6e70 6172 7469 7469  tions / npartiti
-00043170: 6f6e 730a 2020 2020 2020 2020 6e65 775f  ons.        new_
-00043180: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
-00043190: 6172 6965 7320 3d20 5b0a 2020 2020 2020  aries = [.      
-000431a0: 2020 2020 2020 696e 7428 6e65 775f 7061        int(new_pa
-000431b0: 7274 6974 696f 6e5f 696e 6465 7820 2a20  rtition_index * 
-000431c0: 6e70 6172 7469 7469 6f6e 735f 7261 7469  npartitions_rati
-000431d0: 6f29 0a20 2020 2020 2020 2020 2020 2066  o).            f
-000431e0: 6f72 206e 6577 5f70 6172 7469 7469 6f6e  or new_partition
-000431f0: 5f69 6e64 6578 2069 6e20 7261 6e67 6528  _index in range(
-00043200: 6e70 6172 7469 7469 6f6e 7320 2b20 3129  npartitions + 1)
-00043210: 0a20 2020 2020 2020 205d 0a20 2020 2020  .        ].     
-00043220: 2020 2072 6574 7572 6e20 5f72 6570 6172     return _repar
-00043230: 7469 7469 6f6e 5f66 726f 6d5f 626f 756e  tition_from_boun
-00043240: 6461 7269 6573 2864 662c 206e 6577 5f70  daries(df, new_p
-00043250: 6172 7469 7469 6f6e 735f 626f 756e 6461  artitions_bounda
-00043260: 7269 6573 2c20 6e65 775f 6e61 6d65 290a  ries, new_name).
-00043270: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00043280: 2020 2320 4472 6f70 2064 7570 6c63 6174    # Drop duplcat
-00043290: 6573 2069 6e20 6361 7365 206c 6173 7420  es in case last 
-000432a0: 7061 7274 6974 696f 6e20 6861 7320 7361  partition has sa
-000432b0: 6d65 0a20 2020 2020 2020 2023 2076 616c  me.        # val
-000432c0: 7565 2066 6f72 206d 696e 2061 6e64 206d  ue for min and m
-000432d0: 6178 2064 6976 6973 696f 6e0a 2020 2020  ax division.    
-000432e0: 2020 2020 6f72 6967 696e 616c 5f64 6976      original_div
-000432f0: 6973 696f 6e73 203d 2064 6976 6973 696f  isions = divisio
-00043300: 6e73 203d 2070 642e 5365 7269 6573 2864  ns = pd.Series(d
-00043310: 662e 6469 7669 7369 6f6e 7329 2e64 726f  f.divisions).dro
-00043320: 705f 6475 706c 6963 6174 6573 2829 0a20  p_duplicates(). 
-00043330: 2020 2020 2020 2069 6620 6466 2e6b 6e6f         if df.kno
-00043340: 776e 5f64 6976 6973 696f 6e73 2061 6e64  wn_divisions and
-00043350: 2028 0a20 2020 2020 2020 2020 2020 2069   (.            i
-00043360: 735f 6461 7465 7469 6d65 3634 5f61 6e79  s_datetime64_any
-00043370: 5f64 7479 7065 2864 6976 6973 696f 6e73  _dtype(divisions
-00043380: 2e64 7479 7065 290a 2020 2020 2020 2020  .dtype).        
-00043390: 2020 2020 6f72 2069 735f 6e75 6d65 7269      or is_numeri
-000433a0: 635f 6474 7970 6528 6469 7669 7369 6f6e  c_dtype(division
-000433b0: 732e 6474 7970 6529 0a20 2020 2020 2020  s.dtype).       
-000433c0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-000433d0: 6966 2069 735f 6461 7465 7469 6d65 3634  if is_datetime64
-000433e0: 5f61 6e79 5f64 7479 7065 2864 6976 6973  _any_dtype(divis
-000433f0: 696f 6e73 2e64 7479 7065 293a 0a20 2020  ions.dtype):.   
-00043400: 2020 2020 2020 2020 2020 2020 2064 6976               div
-00043410: 6973 696f 6e73 203d 2064 6976 6973 696f  isions = divisio
-00043420: 6e73 2e76 616c 7565 732e 6173 7479 7065  ns.values.astype
-00043430: 2822 666c 6f61 7436 3422 290a 0a20 2020  ("float64")..   
-00043440: 2020 2020 2020 2020 2069 6620 6973 5f73           if is_s
-00043450: 6572 6965 735f 6c69 6b65 2864 6976 6973  eries_like(divis
-00043460: 696f 6e73 293a 0a20 2020 2020 2020 2020  ions):.         
-00043470: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
-00043480: 203d 2064 6976 6973 696f 6e73 2e76 616c   = divisions.val
-00043490: 7565 730a 0a20 2020 2020 2020 2020 2020  ues..           
-000434a0: 206e 203d 206c 656e 2864 6976 6973 696f   n = len(divisio
-000434b0: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
-000434c0: 6469 7669 7369 6f6e 7320 3d20 6e70 2e69  divisions = np.i
-000434d0: 6e74 6572 7028 0a20 2020 2020 2020 2020  nterp(.         
-000434e0: 2020 2020 2020 2078 3d6e 702e 6c69 6e73         x=np.lins
-000434f0: 7061 6365 2830 2c20 6e2c 206e 7061 7274  pace(0, n, npart
-00043500: 6974 696f 6e73 202b 2031 292c 0a20 2020  itions + 1),.   
-00043510: 2020 2020 2020 2020 2020 2020 2078 703d               xp=
-00043520: 6e70 2e6c 696e 7370 6163 6528 302c 206e  np.linspace(0, n
-00043530: 2c20 6e29 2c0a 2020 2020 2020 2020 2020  , n),.          
-00043540: 2020 2020 2020 6670 3d64 6976 6973 696f        fp=divisio
-00043550: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-00043560: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00043570: 2069 735f 6461 7465 7469 6d65 3634 5f61   is_datetime64_a
-00043580: 6e79 5f64 7479 7065 286f 7269 6769 6e61  ny_dtype(origina
-00043590: 6c5f 6469 7669 7369 6f6e 732e 6474 7970  l_divisions.dtyp
-000435a0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-000435b0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
-000435c0: 6d65 7468 6f64 732e 746f 6c69 7374 280a  methods.tolist(.
-000435d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000435e0: 2020 2020 7064 2e53 6572 6965 7328 6469      pd.Series(di
-000435f0: 7669 7369 6f6e 7329 2e61 7374 7970 6528  visions).astype(
-00043600: 6f72 6967 696e 616c 5f64 6976 6973 696f  original_divisio
-00043610: 6e73 2e64 7479 7065 290a 2020 2020 2020  ns.dtype).      
-00043620: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00043630: 2020 2020 2020 2020 656c 6966 206e 702e          elif np.
-00043640: 6973 7375 6264 7479 7065 286f 7269 6769  issubdtype(origi
-00043650: 6e61 6c5f 6469 7669 7369 6f6e 732e 6474  nal_divisions.dt
-00043660: 7970 652c 206e 702e 696e 7465 6765 7229  ype, np.integer)
-00043670: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00043680: 2020 6469 7669 7369 6f6e 7320 3d20 6469    divisions = di
-00043690: 7669 7369 6f6e 732e 6173 7479 7065 286f  visions.astype(o
-000436a0: 7269 6769 6e61 6c5f 6469 7669 7369 6f6e  riginal_division
-000436b0: 732e 6474 7970 6529 0a0a 2020 2020 2020  s.dtype)..      
-000436c0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-000436d0: 6e63 6528 6469 7669 7369 6f6e 732c 206e  nce(divisions, n
-000436e0: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
-000436f0: 2020 2020 2020 2020 2020 2020 6469 7669              divi
-00043700: 7369 6f6e 7320 3d20 6469 7669 7369 6f6e  sions = division
-00043710: 732e 746f 6c69 7374 2829 0a0a 2020 2020  s.tolist()..    
-00043720: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
-00043730: 7320 3d20 6c69 7374 2864 6976 6973 696f  s = list(divisio
-00043740: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
-00043750: 6469 7669 7369 6f6e 735b 305d 203d 2064  divisions[0] = d
-00043760: 662e 6469 7669 7369 6f6e 735b 305d 0a20  f.divisions[0]. 
-00043770: 2020 2020 2020 2020 2020 2064 6976 6973             divis
-00043780: 696f 6e73 5b2d 315d 203d 2064 662e 6469  ions[-1] = df.di
-00043790: 7669 7369 6f6e 735b 2d31 5d0a 0a20 2020  visions[-1]..   
-000437a0: 2020 2020 2020 2020 2023 2045 6e73 7572           # Ensur
-000437b0: 6520 7468 6520 636f 6d70 7574 6564 2064  e the computed d
-000437c0: 6976 6973 696f 6e73 2061 7265 2075 6e69  ivisions are uni
-000437d0: 7175 650a 2020 2020 2020 2020 2020 2020  que.            
-000437e0: 6469 7669 7369 6f6e 7320 3d20 6c69 7374  divisions = list
-000437f0: 2875 6e69 7175 6528 6469 7669 7369 6f6e  (unique(division
-00043800: 735b 3a2d 315d 2929 202b 205b 6469 7669  s[:-1])) + [divi
-00043810: 7369 6f6e 735b 2d31 5d5d 0a20 2020 2020  sions[-1]].     
-00043820: 2020 2020 2020 2072 6574 7572 6e20 6466         return df
-00043830: 2e72 6570 6172 7469 7469 6f6e 2864 6976  .repartition(div
-00043840: 6973 696f 6e73 3d64 6976 6973 696f 6e73  isions=divisions
-00043850: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00043860: 2020 2020 2020 2020 2020 2020 6469 762c              div,
-00043870: 206d 6f64 203d 2064 6976 6d6f 6428 6e70   mod = divmod(np
-00043880: 6172 7469 7469 6f6e 732c 2064 662e 6e70  artitions, df.np
-00043890: 6172 7469 7469 6f6e 7329 0a20 2020 2020  artitions).     
-000438a0: 2020 2020 2020 206e 7370 6c69 7473 203d         nsplits =
-000438b0: 205b 6469 765d 202a 2064 662e 6e70 6172   [div] * df.npar
-000438c0: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
-000438d0: 2020 2020 6e73 706c 6974 735b 2d31 5d20      nsplits[-1] 
-000438e0: 2b3d 206d 6f64 0a20 2020 2020 2020 2020  += mod.         
-000438f0: 2020 2072 6574 7572 6e20 5f73 706c 6974     return _split
-00043900: 5f70 6172 7469 7469 6f6e 7328 6466 2c20  _partitions(df, 
-00043910: 6e73 706c 6974 732c 206e 6577 5f6e 616d  nsplits, new_nam
-00043920: 6529 0a0a 0a64 6566 205f 7265 7061 7274  e)...def _repart
-00043930: 6974 696f 6e5f 6672 6f6d 5f62 6f75 6e64  ition_from_bound
-00043940: 6172 6965 7328 6466 2c20 6e65 775f 7061  aries(df, new_pa
-00043950: 7274 6974 696f 6e73 5f62 6f75 6e64 6172  rtitions_boundar
-00043960: 6965 732c 206e 6577 5f6e 616d 6529 3a0a  ies, new_name):.
-00043970: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-00043980: 7461 6e63 6528 6e65 775f 7061 7274 6974  tance(new_partit
-00043990: 696f 6e73 5f62 6f75 6e64 6172 6965 732c  ions_boundaries,
-000439a0: 206c 6973 7429 3a0a 2020 2020 2020 2020   list):.        
-000439b0: 6e65 775f 7061 7274 6974 696f 6e73 5f62  new_partitions_b
-000439c0: 6f75 6e64 6172 6965 7320 3d20 6c69 7374  oundaries = list
-000439d0: 286e 6577 5f70 6172 7469 7469 6f6e 735f  (new_partitions_
-000439e0: 626f 756e 6461 7269 6573 290a 2020 2020  boundaries).    
-000439f0: 6966 206e 6577 5f70 6172 7469 7469 6f6e  if new_partition
-00043a00: 735f 626f 756e 6461 7269 6573 5b30 5d20  s_boundaries[0] 
-00043a10: 3e20 303a 0a20 2020 2020 2020 206e 6577  > 0:.        new
-00043a20: 5f70 6172 7469 7469 6f6e 735f 626f 756e  _partitions_boun
-00043a30: 6461 7269 6573 2e69 6e73 6572 7428 302c  daries.insert(0,
-00043a40: 2030 290a 2020 2020 6966 206e 6577 5f70   0).    if new_p
-00043a50: 6172 7469 7469 6f6e 735f 626f 756e 6461  artitions_bounda
-00043a60: 7269 6573 5b2d 315d 203c 2064 662e 6e70  ries[-1] < df.np
-00043a70: 6172 7469 7469 6f6e 733a 0a20 2020 2020  artitions:.     
-00043a80: 2020 206e 6577 5f70 6172 7469 7469 6f6e     new_partition
-00043a90: 735f 626f 756e 6461 7269 6573 2e61 7070  s_boundaries.app
-00043aa0: 656e 6428 6466 2e6e 7061 7274 6974 696f  end(df.npartitio
-00043ab0: 6e73 290a 2020 2020 6473 6b20 3d20 7b7d  ns).    dsk = {}
-00043ac0: 0a20 2020 2066 6f72 2069 2c20 2873 7461  .    for i, (sta
-00043ad0: 7274 2c20 656e 6429 2069 6e20 656e 756d  rt, end) in enum
-00043ae0: 6572 6174 6528 0a20 2020 2020 2020 207a  erate(.        z
-00043af0: 6970 286e 6577 5f70 6172 7469 7469 6f6e  ip(new_partition
-00043b00: 735f 626f 756e 6461 7269 6573 2c20 6e65  s_boundaries, ne
-00043b10: 775f 7061 7274 6974 696f 6e73 5f62 6f75  w_partitions_bou
-00043b20: 6e64 6172 6965 735b 313a 5d29 0a20 2020  ndaries[1:]).   
-00043b30: 2029 3a0a 2020 2020 2020 2020 6473 6b5b   ):.        dsk[
-00043b40: 6e65 775f 6e61 6d65 2c20 695d 203d 2028  new_name, i] = (
-00043b50: 6d65 7468 6f64 732e 636f 6e63 6174 2c20  methods.concat, 
-00043b60: 5b28 6466 2e5f 6e61 6d65 2c20 6a29 2066  [(df._name, j) f
-00043b70: 6f72 206a 2069 6e20 7261 6e67 6528 7374  or j in range(st
-00043b80: 6172 742c 2065 6e64 295d 290a 2020 2020  art, end)]).    
-00043b90: 6469 7669 7369 6f6e 7320 3d20 5b64 662e  divisions = [df.
-00043ba0: 6469 7669 7369 6f6e 735b 695d 2066 6f72  divisions[i] for
-00043bb0: 2069 2069 6e20 6e65 775f 7061 7274 6974   i in new_partit
-00043bc0: 696f 6e73 5f62 6f75 6e64 6172 6965 735d  ions_boundaries]
-00043bd0: 0a20 2020 2067 7261 7068 203d 2048 6967  .    graph = Hig
-00043be0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-00043bf0: 5f63 6f6c 6c65 6374 696f 6e73 286e 6577  _collections(new
-00043c00: 5f6e 616d 652c 2064 736b 2c20 6465 7065  _name, dsk, depe
-00043c10: 6e64 656e 6369 6573 3d5b 6466 5d29 0a20  ndencies=[df]). 
-00043c20: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
-00043c30: 5f6f 626a 6563 7428 6772 6170 682c 206e  _object(graph, n
-00043c40: 6577 5f6e 616d 652c 2064 662e 5f6d 6574  ew_name, df._met
-00043c50: 612c 2064 6976 6973 696f 6e73 290a 0a0a  a, divisions)...
-00043c60: 6465 6620 5f73 706c 6974 5f70 6172 7469  def _split_parti
-00043c70: 7469 6f6e 7328 6466 2c20 6e73 706c 6974  tions(df, nsplit
-00043c80: 732c 206e 6577 5f6e 616d 6529 3a0a 2020  s, new_name):.  
-00043c90: 2020 2222 2253 706c 6974 2061 2044 6173    """Split a Das
-00043ca0: 6b20 6461 7461 6672 616d 6520 696e 746f  k dataframe into
-00043cb0: 206e 6577 2070 6172 7469 7469 6f6e 730a   new partitions.
-00043cc0: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-00043cd0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00043ce0: 2020 2064 663a 2044 6174 6146 7261 6d65     df: DataFrame
-00043cf0: 206f 7220 5365 7269 6573 0a20 2020 206e   or Series.    n
-00043d00: 7370 6c69 7473 3a20 4c69 7374 5b69 6e74  splits: List[int
-00043d10: 5d0a 2020 2020 2020 2020 4e75 6d62 6572  ].        Number
-00043d20: 206f 6620 7461 7267 6574 2064 6174 6166   of target dataf
-00043d30: 7261 6d65 7320 666f 7220 6561 6368 2070  rames for each p
-00043d40: 6172 7469 7469 6f6e 0a20 2020 2020 2020  artition.       
-00043d50: 2054 6865 206c 656e 6774 6820 6f66 206e   The length of n
-00043d60: 7370 6c69 7473 2073 686f 756c 6420 6265  splits should be
-00043d70: 2074 6865 2073 616d 6520 6173 2064 662e   the same as df.
-00043d80: 6e70 6172 7469 7469 6f6e 730a 2020 2020  npartitions.    
-00043d90: 6e65 775f 6e61 6d65 3a20 7374 720a 0a20  new_name: str.. 
-00043da0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-00043db0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2072 6570  --------.    rep
-00043dc0: 6172 7469 7469 6f6e 5f6e 7061 7274 6974  artition_npartit
-00043dd0: 696f 6e73 0a20 2020 2072 6570 6172 7469  ions.    reparti
-00043de0: 7469 6f6e 5f73 697a 650a 2020 2020 2222  tion_size.    ""
-00043df0: 220a 2020 2020 6966 206c 656e 286e 7370  ".    if len(nsp
-00043e00: 6c69 7473 2920 213d 2064 662e 6e70 6172  lits) != df.npar
-00043e10: 7469 7469 6f6e 733a 0a20 2020 2020 2020  titions:.       
-00043e20: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00043e30: 7228 6622 6e73 706c 6974 7320 7368 6f75  r(f"nsplits shou
-00043e40: 6c64 2068 6176 6520 6c65 6e3d 7b64 662e  ld have len={df.
-00043e50: 6e70 6172 7469 7469 6f6e 737d 2229 0a0a  npartitions}")..
-00043e60: 2020 2020 6473 6b20 3d20 7b7d 0a20 2020      dsk = {}.   
-00043e70: 2073 706c 6974 5f6e 616d 6520 3d20 6622   split_name = f"
-00043e80: 7370 6c69 742d 7b74 6f6b 656e 697a 6528  split-{tokenize(
-00043e90: 6466 2c20 6e73 706c 6974 7329 7d22 0a20  df, nsplits)}". 
-00043ea0: 2020 206a 203d 2030 0a20 2020 2066 6f72     j = 0.    for
-00043eb0: 2069 2c20 6b20 696e 2065 6e75 6d65 7261   i, k in enumera
-00043ec0: 7465 286e 7370 6c69 7473 293a 0a20 2020  te(nsplits):.   
-00043ed0: 2020 2020 2069 6620 6b20 3d3d 2031 3a0a       if k == 1:.
-00043ee0: 2020 2020 2020 2020 2020 2020 6473 6b5b              dsk[
-00043ef0: 6e65 775f 6e61 6d65 2c20 6a5d 203d 2028  new_name, j] = (
-00043f00: 6466 2e5f 6e61 6d65 2c20 6929 0a20 2020  df._name, i).   
-00043f10: 2020 2020 2020 2020 206a 202b 3d20 310a           j += 1.
-00043f20: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00043f30: 2020 2020 2020 2020 2020 6473 6b5b 7370            dsk[sp
-00043f40: 6c69 745f 6e61 6d65 2c20 695d 203d 2028  lit_name, i] = (
-00043f50: 7370 6c69 745f 6576 656e 6c79 2c20 2864  split_evenly, (d
-00043f60: 662e 5f6e 616d 652c 2069 292c 206b 290a  f._name, i), k).
-00043f70: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00043f80: 6a6a 2069 6e20 7261 6e67 6528 6b29 3a0a  jj in range(k):.
-00043f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043fa0: 6473 6b5b 6e65 775f 6e61 6d65 2c20 6a5d  dsk[new_name, j]
-00043fb0: 203d 2028 6765 7469 7465 6d2c 2028 7370   = (getitem, (sp
-00043fc0: 6c69 745f 6e61 6d65 2c20 6929 2c20 6a6a  lit_name, i), jj
-00043fd0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00043fe0: 2020 6a20 2b3d 2031 0a0a 2020 2020 6469    j += 1..    di
-00043ff0: 7669 7369 6f6e 7320 3d20 5b4e 6f6e 655d  visions = [None]
-00044000: 202a 2028 3120 2b20 7375 6d28 6e73 706c   * (1 + sum(nspl
-00044010: 6974 7329 290a 2020 2020 6772 6170 6820  its)).    graph 
-00044020: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-00044030: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-00044040: 7328 6e65 775f 6e61 6d65 2c20 6473 6b2c  s(new_name, dsk,
-00044050: 2064 6570 656e 6465 6e63 6965 733d 5b64   dependencies=[d
-00044060: 665d 290a 2020 2020 7265 7475 726e 206e  f]).    return n
-00044070: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
-00044080: 7068 2c20 6e65 775f 6e61 6d65 2c20 6466  ph, new_name, df
-00044090: 2e5f 6d65 7461 2c20 6469 7669 7369 6f6e  ._meta, division
-000440a0: 7329 0a0a 0a64 6566 2072 6570 6172 7469  s)...def reparti
-000440b0: 7469 6f6e 2864 662c 2064 6976 6973 696f  tion(df, divisio
-000440c0: 6e73 3d4e 6f6e 652c 2066 6f72 6365 3d46  ns=None, force=F
-000440d0: 616c 7365 293a 0a20 2020 2022 2222 5265  alse):.    """Re
-000440e0: 7061 7274 6974 696f 6e20 6461 7461 6672  partition datafr
-000440f0: 616d 6520 616c 6f6e 6720 6e65 7720 6469  ame along new di
-00044100: 7669 7369 6f6e 730a 0a20 2020 2044 6173  visions..    Das
-00044110: 6b2e 4461 7461 4672 616d 6520 6f62 6a65  k.DataFrame obje
-00044120: 6374 7320 6172 6520 7061 7274 6974 696f  cts are partitio
-00044130: 6e65 6420 616c 6f6e 6720 7468 6569 7220  ned along their 
-00044140: 696e 6465 782e 2020 4f66 7465 6e20 7768  index.  Often wh
-00044150: 656e 0a20 2020 206d 756c 7469 706c 6520  en.    multiple 
-00044160: 6461 7461 6672 616d 6573 2069 6e74 6572  dataframes inter
-00044170: 6163 7420 7765 206e 6565 6420 746f 2061  act we need to a
-00044180: 6c69 676e 2074 6865 7365 2070 6172 7469  lign these parti
-00044190: 7469 6f6e 696e 6773 2e20 2054 6865 0a20  tionings.  The. 
-000441a0: 2020 2060 6072 6570 6172 7469 7469 6f6e     ``repartition
-000441b0: 6060 2066 756e 6374 696f 6e20 636f 6e73  `` function cons
-000441c0: 7472 7563 7473 2061 206e 6577 2044 6174  tructs a new Dat
-000441d0: 6146 7261 6d65 206f 626a 6563 7420 686f  aFrame object ho
-000441e0: 6c64 696e 6720 7468 6520 7361 6d65 0a20  lding the same. 
-000441f0: 2020 2064 6174 6120 6275 7420 7061 7274     data but part
-00044200: 6974 696f 6e65 6420 6f6e 2064 6966 6665  itioned on diffe
-00044210: 7265 6e74 2076 616c 7565 732e 2020 4974  rent values.  It
-00044220: 2064 6f65 7320 7468 6973 2062 7920 7065   does this by pe
-00044230: 7266 6f72 6d69 6e67 2061 0a20 2020 2073  rforming a.    s
-00044240: 6571 7565 6e63 6520 6f66 2060 606c 6f63  equence of ``loc
-00044250: 6060 2061 6e64 2060 6063 6f6e 6361 7460  `` and ``concat`
-00044260: 6020 6361 6c6c 7320 746f 2073 706c 6974  ` calls to split
-00044270: 2061 6e64 206d 6572 6765 2074 6865 2070   and merge the p
-00044280: 7265 7669 6f75 730a 2020 2020 6765 6e65  revious.    gene
-00044290: 7261 7469 6f6e 206f 6620 7061 7274 6974  ration of partit
-000442a0: 696f 6e73 2e0a 0a20 2020 2050 6172 616d  ions...    Param
-000442b0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-000442c0: 2d2d 2d2d 0a0a 2020 2020 6469 7669 7369  ----..    divisi
-000442d0: 6f6e 7320 3a20 6c69 7374 0a20 2020 2020  ons : list.     
-000442e0: 2020 204c 6973 7420 6f66 2070 6172 7469     List of parti
-000442f0: 7469 6f6e 7320 746f 2062 6520 7573 6564  tions to be used
-00044300: 0a20 2020 2066 6f72 6365 203a 2062 6f6f  .    force : boo
-00044310: 6c2c 2064 6566 6175 6c74 2046 616c 7365  l, default False
-00044320: 0a20 2020 2020 2020 2041 6c6c 6f77 7320  .        Allows 
-00044330: 7468 6520 6578 7061 6e73 696f 6e20 6f66  the expansion of
-00044340: 2074 6865 2065 7869 7374 696e 6720 6469   the existing di
-00044350: 7669 7369 6f6e 732e 0a20 2020 2020 2020  visions..       
-00044360: 2049 6620 4661 6c73 6520 7468 656e 2074   If False then t
-00044370: 6865 206e 6577 2064 6976 6973 696f 6e73  he new divisions
-00044380: 206c 6f77 6572 2061 6e64 2075 7070 6572   lower and upper
-00044390: 2062 6f75 6e64 7320 6d75 7374 2062 650a   bounds must be.
-000443a0: 2020 2020 2020 2020 7468 6520 7361 6d65          the same
-000443b0: 2061 7320 7468 6520 6f6c 6420 6469 7669   as the old divi
-000443c0: 7369 6f6e 732e 0a0a 2020 2020 4578 616d  sions...    Exam
-000443d0: 706c 6573 0a20 2020 202d 2d2d 2d2d 2d2d  ples.    -------
-000443e0: 2d0a 0a20 2020 203e 3e3e 2064 6620 3d20  -..    >>> df = 
-000443f0: 6466 2e72 6570 6172 7469 7469 6f6e 285b  df.repartition([
-00044400: 302c 2035 2c20 3130 2c20 3230 5d29 2020  0, 5, 10, 20])  
-00044410: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
-00044420: 0a0a 2020 2020 416c 736f 2077 6f72 6b73  ..    Also works
-00044430: 206f 6e20 5061 6e64 6173 206f 626a 6563   on Pandas objec
-00044440: 7473 0a0a 2020 2020 3e3e 3e20 6464 6620  ts..    >>> ddf 
-00044450: 3d20 6464 2e72 6570 6172 7469 7469 6f6e  = dd.repartition
-00044460: 2864 662c 205b 302c 2035 2c20 3130 2c20  (df, [0, 5, 10, 
-00044470: 3230 5d29 2020 2320 646f 6374 6573 743a  20])  # doctest:
-00044480: 202b 534b 4950 0a20 2020 2022 2222 0a0a   +SKIP.    """..
-00044490: 2020 2020 2320 6e6f 2d6f 7020 6661 7374      # no-op fast
-000444a0: 7061 7468 2066 6f72 2077 6865 6e20 7765  path for when we
-000444b0: 2061 6c72 6561 6479 2068 6176 6520 6d61   already have ma
-000444c0: 7463 6869 6e67 2064 6976 6973 696f 6e73  tching divisions
-000444d0: 0a20 2020 2069 6620 6973 5f64 6173 6b5f  .    if is_dask_
-000444e0: 636f 6c6c 6563 7469 6f6e 2864 6629 2061  collection(df) a
-000444f0: 6e64 2064 662e 6469 7669 7369 6f6e 7320  nd df.divisions 
-00044500: 3d3d 2064 6976 6973 696f 6e73 3a0a 2020  == divisions:.  
-00044510: 2020 2020 2020 7265 7475 726e 2064 660a        return df.
-00044520: 0a20 2020 2074 6f6b 656e 203d 2074 6f6b  .    token = tok
-00044530: 656e 697a 6528 6466 2c20 6469 7669 7369  enize(df, divisi
-00044540: 6f6e 7329 0a20 2020 2069 6620 6973 696e  ons).    if isin
-00044550: 7374 616e 6365 2864 662c 205f 4672 616d  stance(df, _Fram
-00044560: 6529 3a0a 2020 2020 2020 2020 746d 7020  e):.        tmp 
-00044570: 3d20 2272 6570 6172 7469 7469 6f6e 2d73  = "repartition-s
-00044580: 706c 6974 2d22 202b 2074 6f6b 656e 0a20  plit-" + token. 
-00044590: 2020 2020 2020 206f 7574 203d 2022 7265         out = "re
-000445a0: 7061 7274 6974 696f 6e2d 6d65 7267 652d  partition-merge-
-000445b0: 2220 2b20 746f 6b65 6e0a 2020 2020 2020  " + token.      
-000445c0: 2020 6473 6b20 3d20 7265 7061 7274 6974    dsk = repartit
-000445d0: 696f 6e5f 6469 7669 7369 6f6e 7328 0a20  ion_divisions(. 
-000445e0: 2020 2020 2020 2020 2020 2064 662e 6469             df.di
-000445f0: 7669 7369 6f6e 732c 2064 6976 6973 696f  visions, divisio
-00044600: 6e73 2c20 6466 2e5f 6e61 6d65 2c20 746d  ns, df._name, tm
-00044610: 702c 206f 7574 2c20 666f 7263 653d 666f  p, out, force=fo
-00044620: 7263 650a 2020 2020 2020 2020 290a 2020  rce.        ).  
-00044630: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
-00044640: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-00044650: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6f75  m_collections(ou
-00044660: 742c 2064 736b 2c20 6465 7065 6e64 656e  t, dsk, dependen
-00044670: 6369 6573 3d5b 6466 5d29 0a20 2020 2020  cies=[df]).     
-00044680: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
-00044690: 5f6f 626a 6563 7428 6772 6170 682c 206f  _object(graph, o
-000446a0: 7574 2c20 6466 2e5f 6d65 7461 2c20 6469  ut, df._meta, di
-000446b0: 7669 7369 6f6e 7329 0a20 2020 2065 6c69  visions).    eli
-000446c0: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
-000446d0: 696b 6528 6466 2920 6f72 2069 735f 7365  ike(df) or is_se
-000446e0: 7269 6573 5f6c 696b 6528 6466 293a 0a20  ries_like(df):. 
-000446f0: 2020 2020 2020 206e 616d 6520 3d20 2272         name = "r
-00044700: 6570 6172 7469 7469 6f6e 2d64 6174 6166  epartition-dataf
-00044710: 7261 6d65 2d22 202b 2074 6f6b 656e 0a20  rame-" + token. 
-00044720: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-00044730: 2e64 6174 6166 7261 6d65 2e75 7469 6c73  .dataframe.utils
-00044740: 2069 6d70 6f72 7420 7368 6172 645f 6466   import shard_df
-00044750: 5f6f 6e5f 696e 6465 780a 0a20 2020 2020  _on_index..     
-00044760: 2020 2064 6673 203d 2073 6861 7264 5f64     dfs = shard_d
-00044770: 665f 6f6e 5f69 6e64 6578 2864 662c 2064  f_on_index(df, d
-00044780: 6976 6973 696f 6e73 5b31 3a2d 315d 290a  ivisions[1:-1]).
-00044790: 2020 2020 2020 2020 6473 6b20 3d20 7b28          dsk = {(
-000447a0: 6e61 6d65 2c20 6929 3a20 6466 2066 6f72  name, i): df for
-000447b0: 2069 2c20 6466 2069 6e20 656e 756d 6572   i, df in enumer
-000447c0: 6174 6528 6466 7329 7d0a 2020 2020 2020  ate(dfs)}.      
-000447d0: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
-000447e0: 6f62 6a65 6374 2864 736b 2c20 6e61 6d65  object(dsk, name
-000447f0: 2c20 6466 2c20 6469 7669 7369 6f6e 7329  , df, divisions)
-00044800: 0a20 2020 2072 6169 7365 2056 616c 7565  .    raise Value
-00044810: 4572 726f 7228 2244 6174 6120 6d75 7374  Error("Data must
-00044820: 2062 6520 4461 7461 4672 616d 6520 6f72   be DataFrame or
-00044830: 2053 6572 6965 7322 290a 0a0a 6465 6620   Series")...def 
-00044840: 5f72 6564 7563 7469 6f6e 5f63 6875 6e6b  _reduction_chunk
-00044850: 2878 2c20 6163 615f 6368 756e 6b3d 4e6f  (x, aca_chunk=No
-00044860: 6e65 2c20 2a2a 6b77 6172 6773 293a 0a20  ne, **kwargs):. 
-00044870: 2020 206f 203d 2061 6361 5f63 6875 6e6b     o = aca_chunk
-00044880: 2878 2c20 2a2a 6b77 6172 6773 290a 2020  (x, **kwargs).  
-00044890: 2020 2320 5265 7475 726e 2061 2064 6174    # Return a dat
-000448a0: 6166 7261 6d65 2073 6f20 7468 6174 2074  aframe so that t
-000448b0: 6865 2063 6f6e 6361 7465 6e61 7465 6420  he concatenated 
-000448c0: 7665 7273 696f 6e20 6973 2061 6c73 6f20  version is also 
-000448d0: 6120 6461 7461 6672 616d 650a 2020 2020  a dataframe.    
-000448e0: 6966 206e 6f74 2069 735f 7365 7269 6573  if not is_series
-000448f0: 5f6c 696b 6528 6f29 3a0a 2020 2020 2020  _like(o):.      
-00044900: 2020 7265 7475 726e 206f 0a20 2020 2072    return o.    r
-00044910: 6573 756c 7420 3d20 6f2e 746f 5f66 7261  esult = o.to_fra
-00044920: 6d65 2829 2e54 0a20 2020 2069 6620 6f2e  me().T.    if o.
-00044930: 6474 7970 652e 6b69 6e64 203d 3d20 224f  dtype.kind == "O
-00044940: 223a 0a20 2020 2020 2020 2023 2057 6173  ":.        # Was
-00044950: 2063 6f65 7263 6564 2074 6f20 6f62 6a65   coerced to obje
-00044960: 6374 2c20 736f 2063 6173 7420 6261 636b  ct, so cast back
-00044970: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00044980: 7265 7375 6c74 2e69 6e66 6572 5f6f 626a  result.infer_obj
-00044990: 6563 7473 2829 0a20 2020 2072 6574 7572  ects().    retur
-000449a0: 6e20 7265 7375 6c74 0a0a 0a64 6566 205f  n result...def _
-000449b0: 7265 6475 6374 696f 6e5f 636f 6d62 696e  reduction_combin
-000449c0: 6528 782c 2061 6361 5f63 6f6d 6269 6e65  e(x, aca_combine
-000449d0: 3d4e 6f6e 652c 202a 2a6b 7761 7267 7329  =None, **kwargs)
-000449e0: 3a0a 2020 2020 6966 2069 7369 6e73 7461  :.    if isinsta
-000449f0: 6e63 6528 782c 206c 6973 7429 3a0a 2020  nce(x, list):.  
-00044a00: 2020 2020 2020 7820 3d20 7064 2e53 6572        x = pd.Ser
-00044a10: 6965 7328 7829 0a20 2020 206f 203d 2061  ies(x).    o = a
-00044a20: 6361 5f63 6f6d 6269 6e65 2878 2c20 2a2a  ca_combine(x, **
-00044a30: 6b77 6172 6773 290a 2020 2020 2320 5265  kwargs).    # Re
-00044a40: 7475 726e 2061 2064 6174 6166 7261 6d65  turn a dataframe
-00044a50: 2073 6f20 7468 6174 2074 6865 2063 6f6e   so that the con
-00044a60: 6361 7465 6e61 7465 6420 7665 7273 696f  catenated versio
-00044a70: 6e20 6973 2061 6c73 6f20 6120 6461 7461  n is also a data
-00044a80: 6672 616d 650a 2020 2020 7265 7475 726e  frame.    return
-00044a90: 206f 2e74 6f5f 6672 616d 6528 292e 5420   o.to_frame().T 
-00044aa0: 6966 2069 735f 7365 7269 6573 5f6c 696b  if is_series_lik
-00044ab0: 6528 6f29 2065 6c73 6520 6f0a 0a0a 6465  e(o) else o...de
-00044ac0: 6620 5f72 6564 7563 7469 6f6e 5f61 6767  f _reduction_agg
-00044ad0: 7265 6761 7465 2878 2c20 6163 615f 6167  regate(x, aca_ag
-00044ae0: 6772 6567 6174 653d 4e6f 6e65 2c20 2a2a  gregate=None, **
-00044af0: 6b77 6172 6773 293a 0a20 2020 2069 6620  kwargs):.    if 
-00044b00: 6973 696e 7374 616e 6365 2878 2c20 6c69  isinstance(x, li
-00044b10: 7374 293a 0a20 2020 2020 2020 2078 203d  st):.        x =
-00044b20: 2070 642e 5365 7269 6573 2878 290a 2020   pd.Series(x).  
-00044b30: 2020 7265 7475 726e 2061 6361 5f61 6767    return aca_agg
-00044b40: 7265 6761 7465 2878 2c20 2a2a 6b77 6172  regate(x, **kwar
-00044b50: 6773 290a 0a0a 6465 6620 6964 786d 6178  gs)...def idxmax
-00044b60: 6d69 6e5f 6368 756e 6b28 782c 2066 6e3d  min_chunk(x, fn=
-00044b70: 4e6f 6e65 2c20 736b 6970 6e61 3d54 7275  None, skipna=Tru
-00044b80: 6529 3a0a 2020 2020 6d69 6e6d 6178 203d  e):.    minmax =
-00044b90: 2022 6d61 7822 2069 6620 666e 203d 3d20   "max" if fn == 
-00044ba0: 2269 6478 6d61 7822 2065 6c73 6520 226d  "idxmax" else "m
-00044bb0: 696e 220a 2020 2020 6966 206c 656e 2878  in".    if len(x
-00044bc0: 2920 3e20 303a 0a20 2020 2020 2020 2069  ) > 0:.        i
-00044bd0: 6478 203d 2067 6574 6174 7472 2878 2c20  dx = getattr(x, 
-00044be0: 666e 2928 736b 6970 6e61 3d73 6b69 706e  fn)(skipna=skipn
-00044bf0: 6129 0a20 2020 2020 2020 2076 616c 7565  a).        value
-00044c00: 203d 2067 6574 6174 7472 2878 2c20 6d69   = getattr(x, mi
-00044c10: 6e6d 6178 2928 736b 6970 6e61 3d73 6b69  nmax)(skipna=ski
-00044c20: 706e 6129 0a20 2020 2065 6c73 653a 0a20  pna).    else:. 
-00044c30: 2020 2020 2020 2069 6478 203d 2076 616c         idx = val
-00044c40: 7565 203d 206d 6574 615f 7365 7269 6573  ue = meta_series
-00044c50: 5f63 6f6e 7374 7275 6374 6f72 2878 2928  _constructor(x)(
-00044c60: 5b5d 2c20 6474 7970 653d 2269 3822 290a  [], dtype="i8").
-00044c70: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
-00044c80: 5f6c 696b 6528 6964 7829 3a0a 2020 2020  _like(idx):.    
-00044c90: 2020 2020 7265 7475 726e 206d 6574 615f      return meta_
-00044ca0: 6672 616d 655f 636f 6e73 7472 7563 746f  frame_constructo
-00044cb0: 7228 7829 287b 2269 6478 223a 2069 6478  r(x)({"idx": idx
-00044cc0: 2c20 2276 616c 7565 223a 2076 616c 7565  , "value": value
-00044cd0: 7d29 0a20 2020 2072 6574 7572 6e20 6d65  }).    return me
-00044ce0: 7461 5f66 7261 6d65 5f63 6f6e 7374 7275  ta_frame_constru
-00044cf0: 6374 6f72 2878 2928 7b22 6964 7822 3a20  ctor(x)({"idx": 
-00044d00: 5b69 6478 5d2c 2022 7661 6c75 6522 3a20  [idx], "value": 
-00044d10: 5b76 616c 7565 5d7d 290a 0a0a 6465 6620  [value]})...def 
-00044d20: 6964 786d 6178 6d69 6e5f 726f 7728 782c  idxmaxmin_row(x,
-00044d30: 2066 6e3d 4e6f 6e65 2c20 736b 6970 6e61   fn=None, skipna
-00044d40: 3d54 7275 6529 3a0a 2020 2020 6d69 6e6d  =True):.    minm
-00044d50: 6178 203d 2022 6d61 7822 2069 6620 666e  ax = "max" if fn
-00044d60: 203d 3d20 2269 6478 6d61 7822 2065 6c73   == "idxmax" els
-00044d70: 6520 226d 696e 220a 2020 2020 6966 206c  e "min".    if l
-00044d80: 656e 2878 2920 3e20 303a 0a20 2020 2020  en(x) > 0:.     
-00044d90: 2020 2078 203d 2078 2e73 6574 5f69 6e64     x = x.set_ind
-00044da0: 6578 2822 6964 7822 290a 2020 2020 2020  ex("idx").      
-00044db0: 2020 6964 7820 3d20 5b67 6574 6174 7472    idx = [getattr
-00044dc0: 2878 2e76 616c 7565 2c20 666e 2928 736b  (x.value, fn)(sk
-00044dd0: 6970 6e61 3d73 6b69 706e 6129 5d0a 2020  ipna=skipna)].  
-00044de0: 2020 2020 2020 7661 6c75 6520 3d20 5b67        value = [g
-00044df0: 6574 6174 7472 2878 2e76 616c 7565 2c20  etattr(x.value, 
-00044e00: 6d69 6e6d 6178 2928 736b 6970 6e61 3d73  minmax)(skipna=s
-00044e10: 6b69 706e 6129 5d0a 2020 2020 656c 7365  kipna)].    else
-00044e20: 3a0a 2020 2020 2020 2020 6964 7820 3d20  :.        idx = 
-00044e30: 7661 6c75 6520 3d20 6d65 7461 5f73 6572  value = meta_ser
-00044e40: 6965 735f 636f 6e73 7472 7563 746f 7228  ies_constructor(
-00044e50: 7829 285b 5d2c 2064 7479 7065 3d22 6938  x)([], dtype="i8
-00044e60: 2229 0a20 2020 2072 6574 7572 6e20 6d65  ").    return me
-00044e70: 7461 5f66 7261 6d65 5f63 6f6e 7374 7275  ta_frame_constru
-00044e80: 6374 6f72 2878 2928 0a20 2020 2020 2020  ctor(x)(.       
-00044e90: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-00044ea0: 6964 7822 3a20 6d65 7461 5f73 6572 6965  idx": meta_serie
-00044eb0: 735f 636f 6e73 7472 7563 746f 7228 7829  s_constructor(x)
-00044ec0: 2869 6478 2c20 6474 7970 653d 782e 696e  (idx, dtype=x.in
-00044ed0: 6465 782e 6474 7970 6529 2c0a 2020 2020  dex.dtype),.    
-00044ee0: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
-00044ef0: 206d 6574 615f 7365 7269 6573 5f63 6f6e   meta_series_con
-00044f00: 7374 7275 6374 6f72 2878 2928 7661 6c75  structor(x)(valu
-00044f10: 652c 2064 7479 7065 3d78 2e64 7479 7065  e, dtype=x.dtype
-00044f20: 732e 696c 6f63 5b30 5d29 2c0a 2020 2020  s.iloc[0]),.    
-00044f30: 2020 2020 7d0a 2020 2020 290a 0a0a 6465      }.    )...de
-00044f40: 6620 6964 786d 6178 6d69 6e5f 636f 6d62  f idxmaxmin_comb
-00044f50: 696e 6528 782c 2066 6e3d 4e6f 6e65 2c20  ine(x, fn=None, 
-00044f60: 736b 6970 6e61 3d54 7275 6529 3a0a 2020  skipna=True):.  
-00044f70: 2020 6966 206c 656e 2878 2920 3c3d 2031    if len(x) <= 1
-00044f80: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00044f90: 2078 0a20 2020 2072 6574 7572 6e20 280a   x.    return (.
-00044fa0: 2020 2020 2020 2020 782e 6772 6f75 7062          x.groupb
-00044fb0: 7928 6c65 7665 6c3d 3029 0a20 2020 2020  y(level=0).     
-00044fc0: 2020 202e 6170 706c 7928 6964 786d 6178     .apply(idxmax
-00044fd0: 6d69 6e5f 726f 772c 2066 6e3d 666e 2c20  min_row, fn=fn, 
-00044fe0: 736b 6970 6e61 3d73 6b69 706e 6129 0a20  skipna=skipna). 
-00044ff0: 2020 2020 2020 202e 7265 7365 745f 696e         .reset_in
-00045000: 6465 7828 6c65 7665 6c3d 312c 2064 726f  dex(level=1, dro
-00045010: 703d 5472 7565 290a 2020 2020 290a 0a0a  p=True).    )...
-00045020: 6465 6620 6964 786d 6178 6d69 6e5f 6167  def idxmaxmin_ag
-00045030: 6728 782c 2066 6e3d 4e6f 6e65 2c20 736b  g(x, fn=None, sk
-00045040: 6970 6e61 3d54 7275 652c 2073 6361 6c61  ipna=True, scala
-00045050: 723d 4661 6c73 6529 3a0a 2020 2020 7265  r=False):.    re
-00045060: 7320 3d20 6964 786d 6178 6d69 6e5f 636f  s = idxmaxmin_co
-00045070: 6d62 696e 6528 782c 2066 6e2c 2073 6b69  mbine(x, fn, ski
-00045080: 706e 613d 736b 6970 6e61 295b 2269 6478  pna=skipna)["idx
-00045090: 225d 0a20 2020 2069 6620 6c65 6e28 7265  "].    if len(re
-000450a0: 7329 203d 3d20 303a 0a20 2020 2020 2020  s) == 0:.       
-000450b0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000450c0: 7228 2261 7474 656d 7074 2074 6f20 6765  r("attempt to ge
-000450d0: 7420 6172 676d 6178 206f 6620 616e 2065  t argmax of an e
-000450e0: 6d70 7479 2073 6571 7565 6e63 6522 290a  mpty sequence").
-000450f0: 2020 2020 6966 2073 6361 6c61 723a 0a20      if scalar:. 
-00045100: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00045110: 735b 305d 0a20 2020 2072 6573 2e6e 616d  s[0].    res.nam
-00045120: 6520 3d20 4e6f 6e65 0a20 2020 2072 6574  e = None.    ret
-00045130: 7572 6e20 7265 730a 0a0a 6465 6620 5f6d  urn res...def _m
-00045140: 6f64 655f 6167 6772 6567 6174 6528 6466  ode_aggregate(df
-00045150: 2c20 6472 6f70 6e61 293a 0a20 2020 2076  , dropna):.    v
-00045160: 616c 7565 5f63 6f75 6e74 5f73 6572 6965  alue_count_serie
-00045170: 7320 3d20 6466 2e73 756d 2829 0a20 2020  s = df.sum().   
-00045180: 206d 6178 5f76 616c 203d 2076 616c 7565   max_val = value
-00045190: 5f63 6f75 6e74 5f73 6572 6965 732e 6d61  _count_series.ma
-000451a0: 7828 736b 6970 6e61 3d64 726f 706e 6129  x(skipna=dropna)
-000451b0: 0a20 2020 206d 6f64 655f 7365 7269 6573  .    mode_series
-000451c0: 203d 2028 0a20 2020 2020 2020 2076 616c   = (.        val
-000451d0: 7565 5f63 6f75 6e74 5f73 6572 6965 735b  ue_count_series[
-000451e0: 7661 6c75 655f 636f 756e 745f 7365 7269  value_count_seri
-000451f0: 6573 203d 3d20 6d61 785f 7661 6c5d 0a20  es == max_val]. 
-00045200: 2020 2020 2020 202e 696e 6465 782e 746f         .index.to
-00045210: 5f73 6572 6965 7328 290a 2020 2020 2020  _series().      
-00045220: 2020 2e73 6f72 745f 7661 6c75 6573 2829    .sort_values()
-00045230: 0a20 2020 2020 2020 202e 7265 7365 745f  .        .reset_
-00045240: 696e 6465 7828 6472 6f70 3d54 7275 6529  index(drop=True)
-00045250: 0a20 2020 2029 0a20 2020 2072 6574 7572  .    ).    retur
-00045260: 6e20 6d6f 6465 5f73 6572 6965 730a 0a0a  n mode_series...
-00045270: 6465 6620 5f63 6f75 6e74 5f61 6767 7265  def _count_aggre
-00045280: 6761 7465 2878 293a 0a20 2020 2072 6574  gate(x):.    ret
-00045290: 7572 6e20 782e 7375 6d28 292e 6173 7479  urn x.sum().asty
-000452a0: 7065 2822 696e 7436 3422 290a 0a0a 6465  pe("int64")...de
-000452b0: 6620 7361 6665 5f68 6561 6428 6466 2c20  f safe_head(df, 
-000452c0: 6e29 3a0a 2020 2020 7220 3d20 4d2e 6865  n):.    r = M.he
-000452d0: 6164 2864 662c 206e 290a 2020 2020 6966  ad(df, n).    if
-000452e0: 206c 656e 2872 2920 213d 206e 3a0a 2020   len(r) != n:.  
-000452f0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00045300: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-00045310: 2066 2249 6e73 7566 6669 6369 656e 7420   f"Insufficient 
-00045320: 656c 656d 656e 7473 2066 6f72 2060 6865  elements for `he
-00045330: 6164 602e 207b 6e7d 2065 6c65 6d65 6e74  ad`. {n} element
-00045340: 7320 7265 7175 6573 7465 642c 206f 6e6c  s requested, onl
-00045350: 7920 7b6c 656e 2872 297d 2022 0a20 2020  y {len(r)} ".   
-00045360: 2020 2020 2020 2020 2022 656c 656d 656e           "elemen
-00045370: 7473 2061 7661 696c 6162 6c65 2e20 5472  ts available. Tr
-00045380: 7920 7061 7373 696e 6720 6c61 7267 6572  y passing larger
-00045390: 2060 6e70 6172 7469 7469 6f6e 7360 2074   `npartitions` t
-000453a0: 6f20 6068 6561 6460 2e22 0a20 2020 2020  o `head`.".     
-000453b0: 2020 2029 0a20 2020 2072 6574 7572 6e20     ).    return 
-000453c0: 720a 0a0a 6465 6620 6d61 7962 655f 7368  r...def maybe_sh
-000453d0: 6966 745f 6469 7669 7369 6f6e 7328 6466  ift_divisions(df
-000453e0: 2c20 7065 7269 6f64 732c 2066 7265 7129  , periods, freq)
-000453f0: 3a0a 2020 2020 2222 224d 6179 6265 2073  :.    """Maybe s
-00045400: 6869 6674 2064 6976 6973 696f 6e73 2062  hift divisions b
-00045410: 7920 7065 7269 6f64 7320 6f66 2073 697a  y periods of siz
-00045420: 6520 6672 6571 0a0a 2020 2020 5573 6564  e freq..    Used
-00045430: 2074 6f20 7368 6966 7420 7468 6520 6469   to shift the di
-00045440: 7669 7369 6f6e 7320 666f 7220 7468 6520  visions for the 
-00045450: 6073 6869 6674 6020 6d65 7468 6f64 2e20  `shift` method. 
-00045460: 4966 2066 7265 7120 6973 6e27 7420 6120  If freq isn't a 
-00045470: 6669 7865 640a 2020 2020 7369 7a65 2028  fixed.    size (
-00045480: 6e6f 7420 616e 6368 6f72 6564 206f 7220  not anchored or 
-00045490: 7265 6c61 7469 7665 292c 2074 6865 6e20  relative), then 
-000454a0: 7468 6520 6469 7669 7369 6f6e 7320 6172  the divisions ar
-000454b0: 6520 7368 6966 7465 640a 2020 2020 6170  e shifted.    ap
-000454c0: 7072 6f70 7269 6174 656c 792e 204f 7468  propriately. Oth
-000454d0: 6572 7769 7365 2074 6865 2064 6976 6973  erwise the divis
-000454e0: 696f 6e73 2061 7265 2063 6c65 6172 6564  ions are cleared
-000454f0: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-00045500: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00045510: 0a20 2020 2064 6620 3a20 6464 2e44 6174  .    df : dd.Dat
-00045520: 6146 7261 6d65 2c20 6464 2e53 6572 6965  aFrame, dd.Serie
-00045530: 732c 206f 7220 6464 2e49 6e64 6578 0a20  s, or dd.Index. 
-00045540: 2020 2070 6572 696f 6473 203a 2069 6e74     periods : int
-00045550: 0a20 2020 2020 2020 2054 6865 206e 756d  .        The num
-00045560: 6265 7220 6f66 2070 6572 696f 6473 2074  ber of periods t
-00045570: 6f20 7368 6966 742e 0a20 2020 2066 7265  o shift..    fre
-00045580: 7120 3a20 4461 7465 4f66 6673 6574 2c20  q : DateOffset, 
-00045590: 7469 6d65 6465 6c74 612c 206f 7220 7469  timedelta, or ti
-000455a0: 6d65 2072 756c 6520 7374 7269 6e67 0a20  me rule string. 
-000455b0: 2020 2020 2020 2054 6865 2066 7265 7175         The frequ
-000455c0: 656e 6379 2074 6f20 7368 6966 7420 6279  ency to shift by
-000455d0: 2e0a 2020 2020 2222 220a 2020 2020 6966  ..    """.    if
-000455e0: 2069 7369 6e73 7461 6e63 6528 6672 6571   isinstance(freq
-000455f0: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
-00045600: 6672 6571 203d 2070 642e 7473 6572 6965  freq = pd.tserie
-00045610: 732e 6672 6571 7565 6e63 6965 732e 746f  s.frequencies.to
-00045620: 5f6f 6666 7365 7428 6672 6571 290a 0a20  _offset(freq).. 
-00045630: 2020 2069 735f 6f66 6673 6574 203d 2069     is_offset = i
-00045640: 7369 6e73 7461 6e63 6528 6672 6571 2c20  sinstance(freq, 
-00045650: 7064 2e44 6174 654f 6666 7365 7429 0a20  pd.DateOffset). 
-00045660: 2020 2069 6620 6973 5f6f 6666 7365 743a     if is_offset:
-00045670: 0a20 2020 2020 2020 2069 6620 6672 6571  .        if freq
-00045680: 2e69 735f 616e 6368 6f72 6564 2829 206f  .is_anchored() o
-00045690: 7220 6e6f 7420 6861 7361 7474 7228 6672  r not hasattr(fr
-000456a0: 6571 2c20 2264 656c 7461 2229 3a0a 2020  eq, "delta"):.  
-000456b0: 2020 2020 2020 2020 2020 2320 4361 6e27            # Can'
-000456c0: 7420 696e 6665 7220 6469 7669 7369 6f6e  t infer division
-000456d0: 7320 6f6e 2072 656c 6174 6976 6520 6f72  s on relative or
-000456e0: 2061 6e63 686f 7265 6420 6f66 6673 6574   anchored offset
-000456f0: 732c 2061 730a 2020 2020 2020 2020 2020  s, as.          
-00045700: 2020 2320 6469 7669 7369 6f6e 7320 6d61    # divisions ma
-00045710: 7920 6e6f 7720 7370 6c69 7420 6964 656e  y now split iden
-00045720: 7469 6361 6c20 696e 6465 7820 7661 6c75  tical index valu
-00045730: 652e 0a20 2020 2020 2020 2020 2020 2023  e..            #
-00045740: 2028 652e 672e 2069 6e64 6578 5f70 6172   (e.g. index_par
-00045750: 7469 7469 6f6e 7320 3d20 5b5b 312c 2032  titions = [[1, 2
-00045760: 2c20 335d 2c20 5b33 2c20 342c 2035 5d5d  , 3], [3, 4, 5]]
-00045770: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00045780: 7475 726e 2064 662e 636c 6561 725f 6469  turn df.clear_di
-00045790: 7669 7369 6f6e 7328 290a 2020 2020 6966  visions().    if
-000457a0: 2064 662e 6b6e 6f77 6e5f 6469 7669 7369   df.known_divisi
-000457b0: 6f6e 733a 0a20 2020 2020 2020 2064 6976  ons:.        div
-000457c0: 7320 3d20 7064 2e53 6572 6965 7328 7261  s = pd.Series(ra
-000457d0: 6e67 6528 6c65 6e28 6466 2e64 6976 6973  nge(len(df.divis
-000457e0: 696f 6e73 2929 2c20 696e 6465 783d 6466  ions)), index=df
-000457f0: 2e64 6976 6973 696f 6e73 290a 2020 2020  .divisions).    
-00045800: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
-00045810: 6469 7673 2e73 6869 6674 2870 6572 696f  divs.shift(perio
-00045820: 6473 2c20 6672 6571 3d66 7265 7129 2e69  ds, freq=freq).i
-00045830: 6e64 6578 0a20 2020 2020 2020 2072 6574  ndex.        ret
-00045840: 7572 6e20 6466 2e5f 5f63 6c61 7373 5f5f  urn df.__class__
-00045850: 2864 662e 6461 736b 2c20 6466 2e5f 6e61  (df.dask, df._na
-00045860: 6d65 2c20 6466 2e5f 6d65 7461 2c20 6469  me, df._meta, di
-00045870: 7669 7369 6f6e 7329 0a20 2020 2072 6574  visions).    ret
-00045880: 7572 6e20 6466 0a0a 0a40 7772 6170 7328  urn df...@wraps(
-00045890: 7064 2e74 6f5f 6461 7465 7469 6d65 290a  pd.to_datetime).
-000458a0: 6465 6620 746f 5f64 6174 6574 696d 6528  def to_datetime(
-000458b0: 6172 672c 206d 6574 613d 4e6f 6e65 2c20  arg, meta=None, 
-000458c0: 2a2a 6b77 6172 6773 293a 0a20 2020 2074  **kwargs):.    t
-000458d0: 7a5f 6b77 6172 6720 3d20 7b22 747a 223a  z_kwarg = {"tz":
-000458e0: 2022 7574 6322 7d20 6966 206b 7761 7267   "utc"} if kwarg
-000458f0: 732e 6765 7428 2275 7463 2229 2065 6c73  s.get("utc") els
-00045900: 6520 7b7d 0a20 2020 2069 6620 6d65 7461  e {}.    if meta
-00045910: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00045920: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00045930: 6172 672c 2049 6e64 6578 293a 0a20 2020  arg, Index):.   
-00045940: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-00045950: 7064 2e44 6174 6574 696d 6549 6e64 6578  pd.DatetimeIndex
-00045960: 285b 5d2c 202a 2a74 7a5f 6b77 6172 6729  ([], **tz_kwarg)
-00045970: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00045980: 612e 6e61 6d65 203d 2061 7267 2e6e 616d  a.name = arg.nam
-00045990: 650a 2020 2020 2020 2020 656c 6966 206e  e.        elif n
-000459a0: 6f74 2028 6973 5f64 6174 6166 7261 6d65  ot (is_dataframe
-000459b0: 5f6c 696b 6528 6172 6729 206f 7220 6973  _like(arg) or is
-000459c0: 5f73 6572 6965 735f 6c69 6b65 2861 7267  _series_like(arg
-000459d0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-000459e0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-000459f0: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
-00045a00: 2020 2020 2020 2020 2020 2022 6461 736b             "dask
-00045a10: 2e64 6174 6166 7261 6d65 2e74 6f5f 6461  .dataframe.to_da
-00045a20: 7465 7469 6d65 2064 6f65 7320 6e6f 7420  tetime does not 
-00045a30: 7375 7070 6f72 7420 220a 2020 2020 2020  support ".      
-00045a40: 2020 2020 2020 2020 2020 226e 6f6e 2d69            "non-i
-00045a50: 6e64 6578 2d61 626c 6520 6172 6775 6d65  ndex-able argume
-00045a60: 6e74 7320 286c 696b 6520 7363 616c 6172  nts (like scalar
-00045a70: 7329 220a 2020 2020 2020 2020 2020 2020  s)".            
-00045a80: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00045a90: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00045aa0: 203d 206d 6574 615f 7365 7269 6573 5f63   = meta_series_c
-00045ab0: 6f6e 7374 7275 6374 6f72 2861 7267 2928  onstructor(arg)(
-00045ac0: 5b70 642e 5469 6d65 7374 616d 7028 2232  [pd.Timestamp("2
-00045ad0: 3030 3022 2c20 2a2a 747a 5f6b 7761 7267  000", **tz_kwarg
-00045ae0: 295d 290a 2020 2020 2020 2020 2020 2020  )]).            
-00045af0: 6d65 7461 2e69 6e64 6578 203d 206d 6574  meta.index = met
-00045b00: 612e 696e 6465 782e 6173 7479 7065 2861  a.index.astype(a
-00045b10: 7267 2e69 6e64 6578 2e64 7479 7065 290a  rg.index.dtype).
-00045b20: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00045b30: 2e69 6e64 6578 2e6e 616d 6520 3d20 6172  .index.name = ar
-00045b40: 672e 696e 6465 782e 6e61 6d65 0a20 2020  g.index.name.   
-00045b50: 2069 6620 5041 4e44 4153 5f47 545f 3230   if PANDAS_GT_20
-00045b60: 3020 616e 6420 2269 6e66 6572 5f64 6174  0 and "infer_dat
-00045b70: 6574 696d 655f 666f 726d 6174 2220 696e  etime_format" in
-00045b80: 206b 7761 7267 733a 0a20 2020 2020 2020   kwargs:.       
-00045b90: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-00045ba0: 2020 2020 2020 2020 2020 2020 2254 6865              "The
-00045bb0: 2061 7267 756d 656e 7420 2769 6e66 6572   argument 'infer
-00045bc0: 5f64 6174 6574 696d 655f 666f 726d 6174  _datetime_format
-00045bd0: 2720 6973 2064 6570 7265 6361 7465 6420  ' is deprecated 
-00045be0: 616e 6420 7769 6c6c 2062 6520 7265 6d6f  and will be remo
-00045bf0: 7665 6420 696e 2061 2066 7574 7572 6520  ved in a future 
-00045c00: 7665 7273 696f 6e2e 2022 0a20 2020 2020  version. ".     
-00045c10: 2020 2020 2020 2022 4120 7374 7269 6374         "A strict
-00045c20: 2076 6572 7369 6f6e 206f 6620 6974 2069   version of it i
-00045c30: 7320 6e6f 7720 7468 6520 6465 6661 756c  s now the defaul
-00045c40: 742c 2073 6565 2022 0a20 2020 2020 2020  t, see ".       
-00045c50: 2020 2020 2022 6874 7470 733a 2f2f 7061       "https://pa
-00045c60: 6e64 6173 2e70 7964 6174 612e 6f72 672f  ndas.pydata.org/
-00045c70: 7064 6570 732f 3030 3034 2d63 6f6e 7369  pdeps/0004-consi
-00045c80: 7374 656e 742d 746f 2d64 6174 6574 696d  stent-to-datetim
-00045c90: 652d 7061 7273 696e 672e 6874 6d6c 2e20  e-parsing.html. 
-00045ca0: 220a 2020 2020 2020 2020 2020 2020 2259  ".            "Y
-00045cb0: 6f75 2063 616e 2073 6166 656c 7920 7265  ou can safely re
-00045cc0: 6d6f 7665 2074 6869 7320 6172 6775 6d65  move this argume
-00045cd0: 6e74 2e22 2c0a 2020 2020 2020 2020 2020  nt.",.          
-00045ce0: 2020 5573 6572 5761 726e 696e 672c 0a20    UserWarning,. 
-00045cf0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00045d00: 206b 7761 7267 732e 706f 7028 2269 6e66   kwargs.pop("inf
-00045d10: 6572 5f64 6174 6574 696d 655f 666f 726d  er_datetime_form
-00045d20: 6174 2229 0a0a 2020 2020 7265 7475 726e  at")..    return
-00045d30: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
-00045d40: 7064 2e74 6f5f 6461 7465 7469 6d65 2c20  pd.to_datetime, 
-00045d50: 6172 672c 206d 6574 613d 6d65 7461 2c20  arg, meta=meta, 
-00045d60: 2a2a 6b77 6172 6773 290a 0a0a 4077 7261  **kwargs)...@wra
-00045d70: 7073 2870 642e 746f 5f74 696d 6564 656c  ps(pd.to_timedel
-00045d80: 7461 290a 6465 6620 746f 5f74 696d 6564  ta).def to_timed
-00045d90: 656c 7461 2861 7267 2c20 756e 6974 3d4e  elta(arg, unit=N
-00045da0: 6f6e 652c 2065 7272 6f72 733d 2272 6169  one, errors="rai
-00045db0: 7365 2229 3a0a 2020 2020 6d65 7461 203d  se"):.    meta =
-00045dc0: 206d 6574 615f 7365 7269 6573 5f63 6f6e   meta_series_con
-00045dd0: 7374 7275 6374 6f72 2861 7267 2928 5b70  structor(arg)([p
-00045de0: 642e 5469 6d65 6465 6c74 6128 312c 2075  d.Timedelta(1, u
-00045df0: 6e69 743d 756e 6974 295d 290a 2020 2020  nit=unit)]).    
-00045e00: 7265 7475 726e 206d 6170 5f70 6172 7469  return map_parti
-00045e10: 7469 6f6e 7328 7064 2e74 6f5f 7469 6d65  tions(pd.to_time
-00045e20: 6465 6c74 612c 2061 7267 2c20 756e 6974  delta, arg, unit
-00045e30: 3d75 6e69 742c 2065 7272 6f72 733d 6572  =unit, errors=er
-00045e40: 726f 7273 2c20 6d65 7461 3d6d 6574 6129  rors, meta=meta)
-00045e50: 0a0a 0a69 6620 6861 7361 7474 7228 7064  ...if hasattr(pd
-00045e60: 2c20 2269 736e 6122 293a 0a0a 2020 2020  , "isna"):..    
-00045e70: 4077 7261 7073 2870 642e 6973 6e61 290a  @wraps(pd.isna).
-00045e80: 2020 2020 6465 6620 6973 6e61 2861 7267      def isna(arg
-00045e90: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00045ea0: 6e20 6d61 705f 7061 7274 6974 696f 6e73  n map_partitions
-00045eb0: 2870 642e 6973 6e61 2c20 6172 6729 0a0a  (pd.isna, arg)..
-00045ec0: 0a64 6566 205f 7265 7072 5f64 6174 615f  .def _repr_data_
-00045ed0: 7365 7269 6573 2873 2c20 696e 6465 7829  series(s, index)
-00045ee0: 3a0a 2020 2020 2222 2241 2068 656c 7065  :.    """A helpe
-00045ef0: 7220 666f 7220 6372 6561 7469 6e67 2074  r for creating t
-00045f00: 6865 2060 605f 7265 7072 5f64 6174 6160  he ``_repr_data`
-00045f10: 6020 7072 6f70 6572 7479 2222 220a 2020  ` property""".  
-00045f20: 2020 6e70 6172 7469 7469 6f6e 7320 3d20    npartitions = 
-00045f30: 6c65 6e28 696e 6465 7829 202d 2031 0a20  len(index) - 1. 
-00045f40: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00045f50: 2873 2e64 7479 7065 2c20 7064 2e43 6174  (s.dtype, pd.Cat
-00045f60: 6567 6f72 6963 616c 4474 7970 6529 3a0a  egoricalDtype):.
-00045f70: 2020 2020 2020 2020 6966 2068 6173 5f6b          if has_k
-00045f80: 6e6f 776e 5f63 6174 6567 6f72 6965 7328  nown_categories(
-00045f90: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00045fa0: 6474 7970 6520 3d20 2263 6174 6567 6f72  dtype = "categor
-00045fb0: 795b 6b6e 6f77 6e5d 220a 2020 2020 2020  y[known]".      
-00045fc0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00045fd0: 2020 2020 6474 7970 6520 3d20 2263 6174      dtype = "cat
-00045fe0: 6567 6f72 795b 756e 6b6e 6f77 6e5d 220a  egory[unknown]".
-00045ff0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00046000: 2020 6474 7970 6520 3d20 7374 7228 732e    dtype = str(s.
-00046010: 6474 7970 6529 0a20 2020 2072 6574 7572  dtype).    retur
-00046020: 6e20 7064 2e53 6572 6965 7328 5b64 7479  n pd.Series([dty
-00046030: 7065 5d20 2b20 5b22 2e2e 2e22 5d20 2a20  pe] + ["..."] * 
-00046040: 6e70 6172 7469 7469 6f6e 732c 2069 6e64  npartitions, ind
-00046050: 6578 3d69 6e64 6578 2c20 6e61 6d65 3d73  ex=index, name=s
-00046060: 2e6e 616d 6529 0a0a 0a64 6566 2068 6173  .name)...def has
-00046070: 5f70 6172 616c 6c65 6c5f 7479 7065 2878  _parallel_type(x
-00046080: 293a 0a20 2020 2022 2222 446f 6573 2074  ):.    """Does t
-00046090: 6869 7320 6f62 6a65 6374 2068 6176 6520  his object have 
-000460a0: 6120 6461 736b 2064 6174 6166 7261 6d65  a dask dataframe
-000460b0: 2065 7175 6976 616c 656e 743f 2222 220a   equivalent?""".
-000460c0: 2020 2020 7265 7475 726e 2067 6574 5f70      return get_p
-000460d0: 6172 616c 6c65 6c5f 7479 7065 2878 2920  arallel_type(x) 
-000460e0: 6973 206e 6f74 2053 6361 6c61 720a 0a0a  is not Scalar...
-000460f0: 6465 6620 6e65 775f 6464 5f6f 626a 6563  def new_dd_objec
-00046100: 7428 6473 6b2c 206e 616d 652c 206d 6574  t(dsk, name, met
-00046110: 612c 2064 6976 6973 696f 6e73 2c20 7061  a, divisions, pa
-00046120: 7265 6e74 5f6d 6574 613d 4e6f 6e65 293a  rent_meta=None):
-00046130: 0a20 2020 2022 2222 4765 6e65 7269 6320  .    """Generic 
-00046140: 636f 6e73 7472 7563 746f 7220 666f 7220  constructor for 
-00046150: 6461 736b 2e64 6174 6166 7261 6d65 206f  dask.dataframe o
-00046160: 626a 6563 7473 2e0a 0a20 2020 2044 6563  bjects...    Dec
-00046170: 6964 6573 2074 6865 2061 7070 726f 7072  ides the appropr
-00046180: 6961 7465 206f 7574 7075 7420 636c 6173  iate output clas
-00046190: 7320 6261 7365 6420 6f6e 2074 6865 2074  s based on the t
-000461a0: 7970 6520 6f66 2060 6d65 7461 6020 7072  ype of `meta` pr
-000461b0: 6f76 6964 6564 2e0a 2020 2020 2222 220a  ovided..    """.
-000461c0: 2020 2020 6966 2068 6173 5f70 6172 616c      if has_paral
-000461d0: 6c65 6c5f 7479 7065 286d 6574 6129 3a0a  lel_type(meta):.
-000461e0: 2020 2020 2020 2020 7265 7475 726e 2067          return g
-000461f0: 6574 5f70 6172 616c 6c65 6c5f 7479 7065  et_parallel_type
-00046200: 286d 6574 6129 2864 736b 2c20 6e61 6d65  (meta)(dsk, name
-00046210: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
-00046220: 7329 0a20 2020 2065 6c69 6620 6973 5f61  s).    elif is_a
-00046230: 7272 6179 6c69 6b65 286d 6574 6129 2061  rraylike(meta) a
-00046240: 6e64 206d 6574 612e 7368 6170 653a 0a20  nd meta.shape:. 
-00046250: 2020 2020 2020 2069 6d70 6f72 7420 6461         import da
-00046260: 736b 2e61 7272 6179 2061 7320 6461 0a0a  sk.array as da..
-00046270: 2020 2020 2020 2020 6368 756e 6b73 203d          chunks =
-00046280: 2028 286e 702e 6e61 6e2c 2920 2a20 286c   ((np.nan,) * (l
-00046290: 656e 2864 6976 6973 696f 6e73 2920 2d20  en(divisions) - 
-000462a0: 3129 2c29 202b 2074 7570 6c65 280a 2020  1),) + tuple(.  
-000462b0: 2020 2020 2020 2020 2020 2864 2c29 2066            (d,) f
-000462c0: 6f72 2064 2069 6e20 6d65 7461 2e73 6861  or d in meta.sha
-000462d0: 7065 5b31 3a5d 0a20 2020 2020 2020 2029  pe[1:].        )
-000462e0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-000462f0: 6368 756e 6b73 2920 3e20 313a 0a20 2020  chunks) > 1:.   
-00046300: 2020 2020 2020 2020 206c 6179 6572 203d           layer =
-00046310: 2064 736b 2e6c 6179 6572 735b 6e61 6d65   dsk.layers[name
-00046320: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
-00046330: 2069 7369 6e73 7461 6e63 6528 6c61 7965   isinstance(laye
-00046340: 722c 2042 6c6f 636b 7769 7365 293a 0a20  r, Blockwise):. 
-00046350: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00046360: 6179 6572 2e6e 6577 5f61 7865 735b 226a  ayer.new_axes["j
-00046370: 225d 203d 2063 6875 6e6b 735b 315d 5b30  "] = chunks[1][0
-00046380: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00046390: 2020 6c61 7965 722e 6f75 7470 7574 5f69    layer.output_i
-000463a0: 6e64 6963 6573 203d 206c 6179 6572 2e6f  ndices = layer.o
-000463b0: 7574 7075 745f 696e 6469 6365 7320 2b20  utput_indices + 
-000463c0: 2822 6a22 2c29 0a20 2020 2020 2020 2020  ("j",).         
-000463d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000463e0: 2020 2020 2020 2020 2073 7566 6669 7820           suffix 
-000463f0: 3d20 2830 2c29 202a 2028 6c65 6e28 6368  = (0,) * (len(ch
-00046400: 756e 6b73 2920 2d20 3129 0a20 2020 2020  unks) - 1).     
-00046410: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00046420: 2069 6e20 7261 6e67 6528 6c65 6e28 6368   in range(len(ch
-00046430: 756e 6b73 5b30 5d29 293a 0a20 2020 2020  unks[0])):.     
-00046440: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00046450: 6179 6572 5b28 6e61 6d65 2c20 6929 202b  ayer[(name, i) +
-00046460: 2073 7566 6669 785d 203d 206c 6179 6572   suffix] = layer
-00046470: 2e70 6f70 2828 6e61 6d65 2c20 6929 290a  .pop((name, i)).
-00046480: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-00046490: 612e 4172 7261 7928 6473 6b2c 206e 616d  a.Array(dsk, nam
-000464a0: 653d 6e61 6d65 2c20 6368 756e 6b73 3d63  e=name, chunks=c
-000464b0: 6875 6e6b 732c 2064 7479 7065 3d6d 6574  hunks, dtype=met
-000464c0: 612e 6474 7970 6529 0a20 2020 2065 6c73  a.dtype).    els
-000464d0: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
-000464e0: 6e20 6765 745f 7061 7261 6c6c 656c 5f74  n get_parallel_t
-000464f0: 7970 6528 6d65 7461 2928 6473 6b2c 206e  ype(meta)(dsk, n
-00046500: 616d 652c 206d 6574 612c 2064 6976 6973  ame, meta, divis
-00046510: 696f 6e73 290a 0a0a 6465 6620 7061 7274  ions)...def part
-00046520: 6974 696f 6e77 6973 655f 6772 6170 6828  itionwise_graph(
-00046530: 6675 6e63 2c20 6c61 7965 725f 6e61 6d65  func, layer_name
-00046540: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00046550: 7329 3a0a 2020 2020 2222 220a 2020 2020  s):.    """.    
-00046560: 4170 706c 7920 6120 6675 6e63 7469 6f6e  Apply a function
-00046570: 2070 6172 7469 7469 6f6e 2d77 6973 6520   partition-wise 
-00046580: 6163 726f 7373 2061 7267 756d 656e 7473  across arguments
-00046590: 2074 6f20 6372 6561 7465 206c 6179 6572   to create layer
-000465a0: 206f 6620 6120 6772 6170 680a 0a20 2020   of a graph..   
-000465b0: 2054 6869 7320 6170 706c 6965 7320 6120   This applies a 
-000465c0: 6675 6e63 7469 6f6e 2c20 6060 6675 6e63  function, ``func
-000465d0: 6060 2c20 696e 2061 6e20 656d 6261 7272  ``, in an embarr
-000465e0: 6173 7369 6e67 6c79 2070 6172 616c 6c65  assingly paralle
-000465f0: 6c20 6661 7368 696f 6e0a 2020 2020 6163  l fashion.    ac
-00046600: 726f 7373 2070 6172 7469 7469 6f6e 732f  ross partitions/
-00046610: 6368 756e 6b73 2069 6e20 7468 6520 7072  chunks in the pr
-00046620: 6f76 6964 6564 2061 7267 756d 656e 7473  ovided arguments
-00046630: 2e20 2049 7420 6861 6e64 6c65 7320 4461  .  It handles Da
-00046640: 7461 6672 616d 6573 2c0a 2020 2020 4172  taframes,.    Ar
-00046650: 7261 7973 2c20 616e 6420 7363 616c 6172  rays, and scalar
-00046660: 7320 736d 6f6f 7468 6c79 2c20 616e 6420  s smoothly, and 
-00046670: 7265 6c69 6573 206f 6e20 7468 6520 6060  relies on the ``
-00046680: 626c 6f63 6b77 6973 6560 6020 6d61 6368  blockwise`` mach
-00046690: 696e 6572 790a 2020 2020 746f 2070 726f  inery.    to pro
-000466a0: 7669 6465 2061 206e 6963 656c 7920 7379  vide a nicely sy
-000466b0: 6d62 6f6c 6963 2067 7261 7068 2e0a 0a20  mbolic graph... 
-000466c0: 2020 2049 7420 6973 206d 6f73 7420 636f     It is most co
-000466d0: 6d6d 6f6e 6c79 2075 7365 6420 696e 206f  mmonly used in o
-000466e0: 7468 6572 2067 7261 7068 2d62 7569 6c64  ther graph-build
-000466f0: 696e 6720 6675 6e63 7469 6f6e 7320 746f  ing functions to
-00046700: 2063 7265 6174 6520 7468 650a 2020 2020   create the.    
-00046710: 6170 7072 6f70 7269 6174 6520 6c61 7965  appropriate laye
-00046720: 7220 6f66 2074 6865 2072 6573 756c 7469  r of the resulti
-00046730: 6e67 2064 6174 6166 7261 6d65 2e0a 0a20  ng dataframe... 
-00046740: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00046750: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00046760: 2066 756e 633a 2063 616c 6c61 626c 650a   func: callable.
-00046770: 2020 2020 6c61 7965 725f 6e61 6d65 3a20      layer_name: 
-00046780: 7374 720a 2020 2020 2020 2020 4465 7363  str.        Desc
-00046790: 7269 7074 6976 6520 6e61 6d65 2066 6f72  riptive name for
-000467a0: 2074 6865 206f 7065 7261 7469 6f6e 2e20   the operation. 
-000467b0: 5573 6564 2061 7320 7468 6520 6f75 7470  Used as the outp
-000467c0: 7574 206e 616d 650a 2020 2020 2020 2020  ut name.        
-000467d0: 696e 2074 6865 2072 6573 756c 7469 6e67  in the resulting
-000467e0: 2060 6042 6c6f 636b 7769 7365 6060 2067   ``Blockwise`` g
-000467f0: 7261 7068 206c 6179 6572 2e0a 2020 2020  raph layer..    
-00046800: 2a61 7267 733a 0a20 2020 202a 2a6b 7761  *args:.    **kwa
-00046810: 7267 733a 0a0a 2020 2020 5265 7475 726e  rgs:..    Return
-00046820: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
-00046830: 2020 6f75 743a 2042 6c6f 636b 7769 7365    out: Blockwise
-00046840: 2067 7261 7068 0a0a 2020 2020 4578 616d   graph..    Exam
-00046850: 706c 6573 0a20 2020 202d 2d2d 2d2d 2d2d  ples.    -------
-00046860: 2d0a 2020 2020 3e3e 3e20 7375 6267 7261  -.    >>> subgra
-00046870: 7068 203d 2070 6172 7469 7469 6f6e 7769  ph = partitionwi
-00046880: 7365 5f67 7261 7068 2866 756e 6374 696f  se_graph(functio
-00046890: 6e2c 2078 2c20 792c 207a 3d31 3233 2920  n, x, y, z=123) 
-000468a0: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-000468b0: 500a 2020 2020 3e3e 3e20 6c61 7965 7220  P.    >>> layer 
-000468c0: 3d20 7061 7274 6974 696f 6e77 6973 655f  = partitionwise_
-000468d0: 6772 6170 6828 6675 6e63 7469 6f6e 2c20  graph(function, 
-000468e0: 6466 2c20 782c 207a 3d31 3233 2920 2023  df, x, z=123)  #
-000468f0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-00046900: 2020 2020 3e3e 3e20 6772 6170 6820 3d20      >>> graph = 
-00046910: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-00046920: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-00046930: 6e61 6d65 2c20 6c61 7965 722c 2064 6570  name, layer, dep
-00046940: 656e 6465 6e63 6965 733d 5b64 662c 2078  endencies=[df, x
-00046950: 5d29 2020 2320 646f 6374 6573 743a 202b  ])  # doctest: +
-00046960: 534b 4950 0a20 2020 203e 3e3e 2072 6573  SKIP.    >>> res
-00046970: 756c 7420 3d20 6e65 775f 6464 5f6f 626a  ult = new_dd_obj
-00046980: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
-00046990: 206d 6574 6164 6174 612c 2064 662e 6469   metadata, df.di
-000469a0: 7669 7369 6f6e 7329 2020 2320 646f 6374  visions)  # doct
-000469b0: 6573 743a 202b 534b 4950 0a0a 2020 2020  est: +SKIP..    
-000469c0: 5365 6520 416c 736f 0a20 2020 202d 2d2d  See Also.    ---
-000469d0: 2d2d 2d2d 2d0a 2020 2020 6d61 705f 7061  -----.    map_pa
-000469e0: 7274 6974 696f 6e73 0a20 2020 2022 2222  rtitions.    """
-000469f0: 0a20 2020 2070 6169 7273 203d 205b 5d0a  .    pairs = [].
-00046a00: 2020 2020 6e75 6d62 6c6f 636b 7320 3d20      numblocks = 
-00046a10: 7b7d 0a20 2020 2066 6f72 2061 7267 2069  {}.    for arg i
-00046a20: 6e20 6172 6773 3a0a 2020 2020 2020 2020  n args:.        
-00046a30: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
-00046a40: 672c 205f 4672 616d 6529 3a0a 2020 2020  g, _Frame):.    
-00046a50: 2020 2020 2020 2020 7061 6972 732e 6578          pairs.ex
-00046a60: 7465 6e64 285b 6172 672e 5f6e 616d 652c  tend([arg._name,
-00046a70: 2022 6922 5d29 0a20 2020 2020 2020 2020   "i"]).         
-00046a80: 2020 206e 756d 626c 6f63 6b73 5b61 7267     numblocks[arg
-00046a90: 2e5f 6e61 6d65 5d20 3d20 2861 7267 2e6e  ._name] = (arg.n
-00046aa0: 7061 7274 6974 696f 6e73 2c29 0a20 2020  partitions,).   
-00046ab0: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-00046ac0: 616e 6365 2861 7267 2c20 5363 616c 6172  ance(arg, Scalar
-00046ad0: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
-00046ae0: 6169 7273 2e65 7874 656e 6428 5b61 7267  airs.extend([arg
-00046af0: 2e5f 6e61 6d65 2c20 2269 225d 290a 2020  ._name, "i"]).  
-00046b00: 2020 2020 2020 2020 2020 6e75 6d62 6c6f            numblo
-00046b10: 636b 735b 6172 672e 5f6e 616d 655d 203d  cks[arg._name] =
-00046b20: 2028 312c 290a 2020 2020 2020 2020 656c   (1,).        el
-00046b30: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
-00046b40: 672c 2041 7272 6179 293a 0a20 2020 2020  g, Array):.     
-00046b50: 2020 2020 2020 2069 6620 6172 672e 6e64         if arg.nd
-00046b60: 696d 203d 3d20 313a 0a20 2020 2020 2020  im == 1:.       
-00046b70: 2020 2020 2020 2020 2070 6169 7273 2e65           pairs.e
-00046b80: 7874 656e 6428 5b61 7267 2e6e 616d 652c  xtend([arg.name,
-00046b90: 2022 6922 5d29 0a20 2020 2020 2020 2020   "i"]).         
-00046ba0: 2020 2065 6c69 6620 6172 672e 6e64 696d     elif arg.ndim
-00046bb0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-00046bc0: 2020 2020 2020 2070 6169 7273 2e65 7874         pairs.ext
-00046bd0: 656e 6428 5b61 7267 2e6e 616d 652c 2022  end([arg.name, "
-00046be0: 225d 290a 2020 2020 2020 2020 2020 2020  "]).            
-00046bf0: 656c 6966 2061 7267 2e6e 6469 6d20 3d3d  elif arg.ndim ==
-00046c00: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-00046c10: 2020 2020 7061 6972 732e 6578 7465 6e64      pairs.extend
-00046c20: 285b 6172 672e 6e61 6d65 2c20 2269 6a22  ([arg.name, "ij"
-00046c30: 5d29 0a20 2020 2020 2020 2020 2020 2065  ]).            e
-00046c40: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00046c50: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00046c60: 4572 726f 7228 2243 616e 2774 2061 6464  Error("Can't add
-00046c70: 206d 756c 7469 2d64 696d 656e 7369 6f6e   multi-dimension
-00046c80: 616c 2061 7272 6179 2074 6f20 6461 7461  al array to data
-00046c90: 6672 616d 6573 2229 0a20 2020 2020 2020  frames").       
-00046ca0: 2020 2020 206e 756d 626c 6f63 6b73 5b61       numblocks[a
-00046cb0: 7267 2e5f 6e61 6d65 5d20 3d20 6172 672e  rg._name] = arg.
-00046cc0: 6e75 6d62 6c6f 636b 730a 2020 2020 2020  numblocks.      
-00046cd0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-00046ce0: 6528 6172 672c 2042 6c6f 636b 7769 7365  e(arg, Blockwise
-00046cf0: 4465 7029 3a0a 2020 2020 2020 2020 2020  Dep):.          
-00046d00: 2020 6966 206c 656e 2861 7267 2e6e 756d    if len(arg.num
-00046d10: 626c 6f63 6b73 2920 3d3d 2031 3a0a 2020  blocks) == 1:.  
-00046d20: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00046d30: 6972 732e 6578 7465 6e64 285b 6172 672c  irs.extend([arg,
-00046d40: 2022 6922 5d29 0a20 2020 2020 2020 2020   "i"]).         
-00046d50: 2020 2065 6c69 6620 6c65 6e28 6172 672e     elif len(arg.
-00046d60: 6e75 6d62 6c6f 636b 7329 203d 3d20 323a  numblocks) == 2:
-00046d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00046d80: 2070 6169 7273 2e65 7874 656e 6428 5b61   pairs.extend([a
-00046d90: 7267 2c20 2269 6a22 5d29 0a20 2020 2020  rg, "ij"]).     
-00046da0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00046db0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00046dc0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-00046dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046de0: 2020 2066 2242 6c6f 636b 7769 7365 4465     f"BlockwiseDe
-00046df0: 7020 6172 6720 7b61 7267 2172 7d20 6861  p arg {arg!r} ha
-00046e00: 7320 7b6c 656e 2861 7267 2e6e 756d 626c  s {len(arg.numbl
-00046e10: 6f63 6b73 297d 2064 696d 656e 7369 6f6e  ocks)} dimension
-00046e20: 733b 206f 6e6c 7920 3120 6f72 2032 2061  s; only 1 or 2 a
-00046e30: 7265 2073 7570 706f 7274 6564 2e22 0a20  re supported.". 
-00046e40: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00046e50: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00046e60: 2020 2020 2020 2020 2020 2070 6169 7273             pairs
-00046e70: 2e65 7874 656e 6428 5b61 7267 2c20 4e6f  .extend([arg, No
-00046e80: 6e65 5d29 0a20 2020 2072 6574 7572 6e20  ne]).    return 
-00046e90: 626c 6f63 6b77 6973 6528 0a20 2020 2020  blockwise(.     
-00046ea0: 2020 2066 756e 632c 206c 6179 6572 5f6e     func, layer_n
-00046eb0: 616d 652c 2022 6922 2c20 2a70 6169 7273  ame, "i", *pairs
-00046ec0: 2c20 6e75 6d62 6c6f 636b 733d 6e75 6d62  , numblocks=numb
-00046ed0: 6c6f 636b 732c 2063 6f6e 6361 7465 6e61  locks, concatena
-00046ee0: 7465 3d54 7275 652c 202a 2a6b 7761 7267  te=True, **kwarg
-00046ef0: 730a 2020 2020 290a 0a0a 6465 6620 6d65  s.    )...def me
-00046f00: 7461 5f77 6172 6e69 6e67 2864 6629 3a0a  ta_warning(df):.
-00046f10: 2020 2020 2222 220a 2020 2020 5072 6f76      """.    Prov
-00046f20: 6964 6520 616e 2069 6e66 6f72 6d61 7469  ide an informati
-00046f30: 7665 206d 6573 7361 6765 2077 6865 6e20  ve message when 
-00046f40: 7468 6520 7573 6572 2069 7320 6173 6b65  the user is aske
-00046f50: 6420 746f 2070 726f 7669 6465 206d 6574  d to provide met
-00046f60: 6164 6174 610a 2020 2020 2222 220a 2020  adata.    """.  
-00046f70: 2020 6966 2069 735f 6461 7461 6672 616d    if is_datafram
-00046f80: 655f 6c69 6b65 2864 6629 3a0a 2020 2020  e_like(df):.    
-00046f90: 2020 2020 6d65 7461 5f73 7472 203d 207b      meta_str = {
-00046fa0: 6b3a 2073 7472 2876 2920 666f 7220 6b2c  k: str(v) for k,
-00046fb0: 2076 2069 6e20 6466 2e64 7479 7065 732e   v in df.dtypes.
-00046fc0: 746f 5f64 6963 7428 292e 6974 656d 7328  to_dict().items(
-00046fd0: 297d 0a20 2020 2065 6c69 6620 6973 5f73  )}.    elif is_s
-00046fe0: 6572 6965 735f 6c69 6b65 2864 6629 3a0a  eries_like(df):.
-00046ff0: 2020 2020 2020 2020 6d65 7461 5f73 7472          meta_str
-00047000: 203d 2028 6466 2e6e 616d 652c 2073 7472   = (df.name, str
-00047010: 2864 662e 6474 7970 6529 290a 2020 2020  (df.dtype)).    
-00047020: 656c 7365 3a0a 2020 2020 2020 2020 6d65  else:.        me
-00047030: 7461 5f73 7472 203d 204e 6f6e 650a 2020  ta_str = None.  
-00047040: 2020 6d73 6720 3d20 280a 2020 2020 2020    msg = (.      
-00047050: 2020 225c 6e59 6f75 2064 6964 206e 6f74    "\nYou did not
-00047060: 2070 726f 7669 6465 206d 6574 6164 6174   provide metadat
-00047070: 612c 2073 6f20 4461 736b 2069 7320 7275  a, so Dask is ru
-00047080: 6e6e 696e 6720 796f 7572 2022 0a20 2020  nning your ".   
-00047090: 2020 2020 2022 6675 6e63 7469 6f6e 206f       "function o
-000470a0: 6e20 6120 736d 616c 6c20 6461 7461 7365  n a small datase
-000470b0: 7420 746f 2067 7565 7373 206f 7574 7075  t to guess outpu
-000470c0: 7420 7479 7065 732e 2022 0a20 2020 2020  t types. ".     
-000470d0: 2020 2022 4974 2069 7320 706f 7373 6962     "It is possib
-000470e0: 6c65 2074 6861 7420 4461 736b 2077 696c  le that Dask wil
-000470f0: 6c20 6775 6573 7320 696e 636f 7272 6563  l guess incorrec
-00047100: 746c 792e 5c6e 220a 2020 2020 2020 2020  tly.\n".        
-00047110: 2254 6f20 7072 6f76 6964 6520 616e 2065  "To provide an e
-00047120: 7870 6c69 6369 7420 6f75 7470 7574 2074  xplicit output t
-00047130: 7970 6573 206f 7220 746f 2073 696c 656e  ypes or to silen
-00047140: 6365 2074 6869 7320 6d65 7373 6167 652c  ce this message,
-00047150: 2022 0a20 2020 2020 2020 2022 706c 6561   ".        "plea
-00047160: 7365 2070 726f 7669 6465 2074 6865 2060  se provide the `
-00047170: 6d65 7461 3d60 206b 6579 776f 7264 2c20  meta=` keyword, 
-00047180: 6173 2064 6573 6372 6962 6564 2069 6e20  as described in 
-00047190: 7468 6520 6d61 7020 6f72 2022 0a20 2020  the map or ".   
-000471a0: 2020 2020 2022 6170 706c 7920 6675 6e63       "apply func
-000471b0: 7469 6f6e 2074 6861 7420 796f 7520 6172  tion that you ar
-000471c0: 6520 7573 696e 672e 220a 2020 2020 290a  e using.".    ).
-000471d0: 2020 2020 6966 206d 6574 615f 7374 723a      if meta_str:
-000471e0: 0a20 2020 2020 2020 206d 7367 202b 3d20  .        msg += 
-000471f0: 280a 2020 2020 2020 2020 2020 2020 225c  (.            "\
-00047200: 6e22 0a20 2020 2020 2020 2020 2020 2022  n".            "
-00047210: 2020 4265 666f 7265 3a20 2e61 7070 6c79    Before: .apply
-00047220: 2866 756e 6329 5c6e 220a 2020 2020 2020  (func)\n".      
-00047230: 2020 2020 2020 2220 2041 6674 6572 3a20        "  After: 
-00047240: 202e 6170 706c 7928 6675 6e63 2c20 6d65   .apply(func, me
-00047250: 7461 3d25 7329 5c6e 2220 2520 7374 7228  ta=%s)\n" % str(
-00047260: 6d65 7461 5f73 7472 290a 2020 2020 2020  meta_str).      
-00047270: 2020 290a 2020 2020 7265 7475 726e 206d    ).    return m
-00047280: 7367 0a0a 0a64 6566 2070 7265 6669 785f  sg...def prefix_
-00047290: 7265 6475 6374 696f 6e28 662c 2064 6466  reduction(f, ddf
-000472a0: 2c20 6964 656e 7469 7479 2c20 2a2a 6b77  , identity, **kw
-000472b0: 6172 6773 293a 0a20 2020 2022 2222 436f  args):.    """Co
-000472c0: 6d70 7574 6573 2074 6865 2070 7265 6669  mputes the prefi
-000472d0: 7820 7375 6d73 206f 6620 6620 6f6e 2064  x sums of f on d
-000472e0: 660a 0a20 2020 2049 6620 6466 2068 6173  f..    If df has
-000472f0: 2070 6172 7469 7469 6f6e 7320 5b50 312c   partitions [P1,
-00047300: 2050 322c 202e 2e2e 2c20 506e 5d2c 2074   P2, ..., Pn], t
-00047310: 6865 6e20 7265 7475 726e 7320 7468 6520  hen returns the 
-00047320: 4461 7461 4672 616d 6520 7769 7468 0a20  DataFrame with. 
-00047330: 2020 2070 6172 7469 7469 6f6e 7320 5b66     partitions [f
-00047340: 2869 6465 6e74 6974 792c 2050 3129 2c0a  (identity, P1),.
-00047350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047360: 6628 6628 6964 656e 7469 7479 2c20 5031  f(f(identity, P1
-00047370: 292c 2050 3229 2c0a 2020 2020 2020 2020  ), P2),.        
-00047380: 2020 2020 2020 2020 6628 6628 6628 6964          f(f(f(id
-00047390: 656e 7469 7479 2c20 5031 292c 2050 3229  entity, P1), P2)
-000473a0: 2c20 5033 292c 0a20 2020 2020 2020 2020  , P3),.         
-000473b0: 2020 2020 2020 202e 2e2e 5d0a 0a20 2020         ...]..   
-000473c0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-000473d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066  ----------.    f
-000473e0: 203a 2063 616c 6c61 626c 650a 2020 2020   : callable.    
-000473f0: 2020 2020 616e 2061 7373 6f63 6961 7469      an associati
-00047400: 7665 2066 756e 6374 696f 6e20 660a 2020  ve function f.  
-00047410: 2020 6464 6620 3a20 6464 2e44 6174 6146    ddf : dd.DataF
-00047420: 7261 6d65 0a20 2020 2069 6465 6e74 6974  rame.    identit
-00047430: 7920 3a20 7064 2e44 6174 6146 7261 6d65  y : pd.DataFrame
-00047440: 0a20 2020 2020 2020 2061 6e20 6964 656e  .        an iden
-00047450: 7469 7479 2065 6c65 6d65 6e74 206f 6620  tity element of 
-00047460: 662c 2074 6861 7420 6973 2066 2869 6465  f, that is f(ide
-00047470: 6e74 6974 792c 2064 6629 203d 2066 2864  ntity, df) = f(d
-00047480: 662c 2069 6465 6e74 6974 7929 203d 2064  f, identity) = d
-00047490: 660a 2020 2020 2222 220a 2020 2020 6473  f.    """.    ds
-000474a0: 6b20 3d20 6469 6374 2829 0a20 2020 206e  k = dict().    n
-000474b0: 616d 6520 3d20 2270 7265 6669 785f 7265  ame = "prefix_re
-000474c0: 6475 6374 696f 6e2d 2220 2b20 746f 6b65  duction-" + toke
-000474d0: 6e69 7a65 2866 2c20 6464 662c 2069 6465  nize(f, ddf, ide
-000474e0: 6e74 6974 792c 202a 2a6b 7761 7267 7329  ntity, **kwargs)
-000474f0: 0a20 2020 206d 6574 6120 3d20 6464 662e  .    meta = ddf.
-00047500: 5f6d 6574 610a 2020 2020 6e20 3d20 6c65  _meta.    n = le
-00047510: 6e28 6464 662e 6469 7669 7369 6f6e 7329  n(ddf.divisions)
-00047520: 202d 2031 0a20 2020 2064 6976 6973 696f   - 1.    divisio
-00047530: 6e73 203d 205b 4e6f 6e65 5d20 2a20 286e  ns = [None] * (n
-00047540: 202b 2031 290a 0a20 2020 204e 203d 2031   + 1)..    N = 1
-00047550: 0a20 2020 2077 6869 6c65 204e 203c 206e  .    while N < n
-00047560: 3a0a 2020 2020 2020 2020 4e20 2a3d 2032  :.        N *= 2
-00047570: 0a20 2020 2066 6f72 2069 2069 6e20 7261  .    for i in ra
-00047580: 6e67 6528 6e29 3a0a 2020 2020 2020 2020  nge(n):.        
-00047590: 6473 6b5b 286e 616d 652c 2069 2c20 312c  dsk[(name, i, 1,
-000475a0: 2030 295d 203d 2028 6170 706c 792c 2066   0)] = (apply, f
-000475b0: 2c20 5b28 6464 662e 5f6e 616d 652c 2069  , [(ddf._name, i
-000475c0: 292c 2069 6465 6e74 6974 795d 2c20 6b77  ), identity], kw
-000475d0: 6172 6773 290a 2020 2020 666f 7220 6920  args).    for i 
-000475e0: 696e 2072 616e 6765 286e 2c20 4e29 3a0a  in range(n, N):.
-000475f0: 2020 2020 2020 2020 6473 6b5b 286e 616d          dsk[(nam
-00047600: 652c 2069 2c20 312c 2030 295d 203d 2069  e, i, 1, 0)] = i
-00047610: 6465 6e74 6974 790a 0a20 2020 2064 203d  dentity..    d =
-00047620: 2031 0a20 2020 2077 6869 6c65 2064 203c   1.    while d <
-00047630: 204e 3a0a 2020 2020 2020 2020 666f 7220   N:.        for 
-00047640: 6920 696e 2072 616e 6765 2830 2c20 4e2c  i in range(0, N,
-00047650: 2032 202a 2064 293a 0a20 2020 2020 2020   2 * d):.       
-00047660: 2020 2020 2064 736b 5b28 6e61 6d65 2c20       dsk[(name, 
-00047670: 6920 2b20 3220 2a20 6420 2d20 312c 2032  i + 2 * d - 1, 2
-00047680: 202a 2064 2c20 3029 5d20 3d20 280a 2020   * d, 0)] = (.  
-00047690: 2020 2020 2020 2020 2020 2020 2020 6170                ap
-000476a0: 706c 792c 0a20 2020 2020 2020 2020 2020  ply,.           
-000476b0: 2020 2020 2066 2c0a 2020 2020 2020 2020       f,.        
-000476c0: 2020 2020 2020 2020 5b28 6e61 6d65 2c20          [(name, 
-000476d0: 6920 2b20 6420 2d20 312c 2064 2c20 3029  i + d - 1, d, 0)
-000476e0: 2c20 286e 616d 652c 2069 202b 2032 202a  , (name, i + 2 *
-000476f0: 2064 202d 2031 2c20 642c 2030 295d 2c0a   d - 1, d, 0)],.
-00047700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047710: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-00047720: 2020 2020 290a 2020 2020 2020 2020 6420      ).        d 
-00047730: 2a3d 2032 0a0a 2020 2020 6473 6b5b 286e  *= 2..    dsk[(n
-00047740: 616d 652c 204e 202d 2031 2c20 4e2c 2031  ame, N - 1, N, 1
-00047750: 295d 203d 2069 6465 6e74 6974 790a 0a20  )] = identity.. 
-00047760: 2020 2077 6869 6c65 2064 203e 2031 3a0a     while d > 1:.
-00047770: 2020 2020 2020 2020 6420 2f2f 3d20 320a          d //= 2.
-00047780: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00047790: 2072 616e 6765 2830 2c20 4e2c 2032 202a   range(0, N, 2 *
-000477a0: 2064 293a 0a20 2020 2020 2020 2020 2020   d):.           
-000477b0: 2064 736b 5b28 6e61 6d65 2c20 6920 2b20   dsk[(name, i + 
-000477c0: 6420 2d20 312c 2064 2c20 3129 5d20 3d20  d - 1, d, 1)] = 
-000477d0: 286e 616d 652c 2069 202b 2032 202a 2064  (name, i + 2 * d
-000477e0: 202d 2031 2c20 3220 2a20 642c 2031 290a   - 1, 2 * d, 1).
-000477f0: 2020 2020 2020 2020 2020 2020 6473 6b5b              dsk[
-00047800: 286e 616d 652c 2069 202b 2032 202a 2064  (name, i + 2 * d
-00047810: 202d 2031 2c20 642c 2031 295d 203d 2028   - 1, d, 1)] = (
-00047820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047830: 2061 7070 6c79 2c0a 2020 2020 2020 2020   apply,.        
-00047840: 2020 2020 2020 2020 662c 0a20 2020 2020          f,.     
-00047850: 2020 2020 2020 2020 2020 205b 286e 616d             [(nam
-00047860: 652c 2069 202b 2032 202a 2064 202d 2031  e, i + 2 * d - 1
-00047870: 2c20 3220 2a20 642c 2031 292c 2028 6e61  , 2 * d, 1), (na
-00047880: 6d65 2c20 6920 2b20 6420 2d20 312c 2064  me, i + d - 1, d
-00047890: 2c20 3029 5d2c 0a20 2020 2020 2020 2020  , 0)],.         
-000478a0: 2020 2020 2020 206b 7761 7267 732c 0a20         kwargs,. 
-000478b0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-000478c0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-000478d0: 286e 293a 0a20 2020 2020 2020 2064 736b  (n):.        dsk
-000478e0: 5b28 6e61 6d65 2c20 6929 5d20 3d20 2861  [(name, i)] = (a
-000478f0: 7070 6c79 2c20 662c 205b 286e 616d 652c  pply, f, [(name,
-00047900: 2069 2c20 312c 2031 292c 2069 6465 6e74   i, 1, 1), ident
-00047910: 6974 795d 2c20 6b77 6172 6773 290a 0a20  ity], kwargs).. 
-00047920: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-00047930: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-00047940: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
-00047950: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-00047960: 6573 3d5b 6464 665d 290a 2020 2020 7265  es=[ddf]).    re
-00047970: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
-00047980: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
-00047990: 6d65 7461 2c20 6469 7669 7369 6f6e 7329  meta, divisions)
-000479a0: 0a0a 0a64 6566 2073 7566 6669 785f 7265  ...def suffix_re
-000479b0: 6475 6374 696f 6e28 662c 2064 6466 2c20  duction(f, ddf, 
-000479c0: 6964 656e 7469 7479 2c20 2a2a 6b77 6172  identity, **kwar
-000479d0: 6773 293a 0a20 2020 2022 2222 436f 6d70  gs):.    """Comp
-000479e0: 7574 6573 2074 6865 2073 7566 6669 7820  utes the suffix 
-000479f0: 7375 6d73 206f 6620 6620 6f6e 2064 660a  sums of f on df.
-00047a00: 0a20 2020 2049 6620 6466 2068 6173 2070  .    If df has p
-00047a10: 6172 7469 7469 6f6e 7320 5b50 312c 2050  artitions [P1, P
-00047a20: 322c 202e 2e2e 2c20 506e 5d2c 2074 6865  2, ..., Pn], the
-00047a30: 6e20 7265 7475 726e 7320 7468 6520 4461  n returns the Da
-00047a40: 7461 4672 616d 6520 7769 7468 0a20 2020  taFrame with.   
-00047a50: 2070 6172 7469 7469 6f6e 7320 5b66 2850   partitions [f(P
-00047a60: 312c 2066 2850 322c 202e 2e2e 6628 506e  1, f(P2, ...f(Pn
-00047a70: 2c20 6964 656e 7469 7479 292e 2e2e 2929  , identity)...))
-00047a80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00047a90: 2020 6628 5032 2c20 2e2e 2e66 2850 6e2c    f(P2, ...f(Pn,
-00047aa0: 2069 6465 6e74 6974 7929 2e2e 2e29 2c0a   identity)...),.
-00047ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047ac0: 2e2e 2e66 2850 6e2c 2069 6465 6e74 6974  ...f(Pn, identit
-00047ad0: 7929 2e2e 2e2c 0a20 2020 2020 2020 2020  y)...,.         
-00047ae0: 2020 2020 2020 202e 2e2e 5d0a 0a20 2020         ...]..   
-00047af0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00047b00: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066  ----------.    f
-00047b10: 203a 2063 616c 6c61 626c 650a 2020 2020   : callable.    
-00047b20: 2020 2020 616e 2061 7373 6f63 6961 7469      an associati
-00047b30: 7665 2066 756e 6374 696f 6e20 660a 2020  ve function f.  
-00047b40: 2020 6464 6620 3a20 6464 2e44 6174 6146    ddf : dd.DataF
-00047b50: 7261 6d65 0a20 2020 2069 6465 6e74 6974  rame.    identit
-00047b60: 7920 3a20 7064 2e44 6174 6146 7261 6d65  y : pd.DataFrame
-00047b70: 0a20 2020 2020 2020 2061 6e20 6964 656e  .        an iden
-00047b80: 7469 7479 2065 6c65 6d65 6e74 206f 6620  tity element of 
-00047b90: 662c 2074 6861 7420 6973 2066 2869 6465  f, that is f(ide
-00047ba0: 6e74 6974 792c 2064 6629 203d 2066 2864  ntity, df) = f(d
-00047bb0: 662c 2069 6465 6e74 6974 7929 203d 2064  f, identity) = d
-00047bc0: 660a 2020 2020 6b77 6172 6773 203a 203f  f.    kwargs : ?
-00047bd0: 3f0a 2020 2020 2020 2020 6b65 7977 6f72  ?.        keywor
-00047be0: 6420 6172 6775 6d65 6e74 7320 6f66 2066  d arguments of f
-00047bf0: 203f 3f0a 2020 2020 2222 220a 2020 2020   ??.    """.    
-00047c00: 6473 6b20 3d20 6469 6374 2829 0a20 2020  dsk = dict().   
-00047c10: 206e 616d 6520 3d20 2273 7566 6669 785f   name = "suffix_
-00047c20: 7265 6475 6374 696f 6e2d 2220 2b20 746f  reduction-" + to
-00047c30: 6b65 6e69 7a65 2866 2c20 6464 662c 2069  kenize(f, ddf, i
-00047c40: 6465 6e74 6974 792c 202a 2a6b 7761 7267  dentity, **kwarg
-00047c50: 7329 0a20 2020 206d 6574 6120 3d20 6464  s).    meta = dd
-00047c60: 662e 5f6d 6574 610a 2020 2020 6e20 3d20  f._meta.    n = 
-00047c70: 6c65 6e28 6464 662e 6469 7669 7369 6f6e  len(ddf.division
-00047c80: 7329 202d 2031 0a20 2020 2064 6976 6973  s) - 1.    divis
-00047c90: 696f 6e73 203d 205b 4e6f 6e65 5d20 2a20  ions = [None] * 
-00047ca0: 286e 202b 2031 290a 0a20 2020 204e 203d  (n + 1)..    N =
-00047cb0: 2031 0a20 2020 2077 6869 6c65 204e 203c   1.    while N <
-00047cc0: 206e 3a0a 2020 2020 2020 2020 4e20 2a3d   n:.        N *=
-00047cd0: 2032 0a20 2020 2066 6f72 2069 2069 6e20   2.    for i in 
-00047ce0: 7261 6e67 6528 6e29 3a0a 2020 2020 2020  range(n):.      
-00047cf0: 2020 6473 6b5b 286e 616d 652c 2069 2c20    dsk[(name, i, 
-00047d00: 312c 2030 295d 203d 2028 6170 706c 792c  1, 0)] = (apply,
-00047d10: 2066 2c20 5b28 6464 662e 5f6e 616d 652c   f, [(ddf._name,
-00047d20: 206e 202d 2031 202d 2069 292c 2069 6465   n - 1 - i), ide
-00047d30: 6e74 6974 795d 2c20 6b77 6172 6773 290a  ntity], kwargs).
-00047d40: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00047d50: 6765 286e 2c20 4e29 3a0a 2020 2020 2020  ge(n, N):.      
-00047d60: 2020 6473 6b5b 286e 616d 652c 2069 2c20    dsk[(name, i, 
-00047d70: 312c 2030 295d 203d 2069 6465 6e74 6974  1, 0)] = identit
-00047d80: 790a 0a20 2020 2064 203d 2031 0a20 2020  y..    d = 1.   
-00047d90: 2077 6869 6c65 2064 203c 204e 3a0a 2020   while d < N:.  
-00047da0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00047db0: 616e 6765 2830 2c20 4e2c 2032 202a 2064  ange(0, N, 2 * d
-00047dc0: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-00047dd0: 736b 5b28 6e61 6d65 2c20 6920 2b20 3220  sk[(name, i + 2 
-00047de0: 2a20 6420 2d20 312c 2032 202a 2064 2c20  * d - 1, 2 * d, 
-00047df0: 3029 5d20 3d20 280a 2020 2020 2020 2020  0)] = (.        
-00047e00: 2020 2020 2020 2020 6170 706c 792c 0a20          apply,. 
-00047e10: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00047e20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00047e30: 2020 5b28 6e61 6d65 2c20 6920 2b20 3220    [(name, i + 2 
-00047e40: 2a20 6420 2d20 312c 2064 2c20 3029 2c20  * d - 1, d, 0), 
-00047e50: 286e 616d 652c 2069 202b 2064 202d 2031  (name, i + d - 1
-00047e60: 2c20 642c 2030 295d 2c0a 2020 2020 2020  , d, 0)],.      
-00047e70: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-00047e80: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00047e90: 2020 2020 2020 2020 6420 2a3d 2032 0a0a          d *= 2..
-00047ea0: 2020 2020 6473 6b5b 286e 616d 652c 204e      dsk[(name, N
-00047eb0: 202d 2031 2c20 4e2c 2031 295d 203d 2069   - 1, N, 1)] = i
-00047ec0: 6465 6e74 6974 790a 0a20 2020 2077 6869  dentity..    whi
-00047ed0: 6c65 2064 203e 2031 3a0a 2020 2020 2020  le d > 1:.      
-00047ee0: 2020 6420 2f2f 3d20 320a 2020 2020 2020    d //= 2.      
-00047ef0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00047f00: 2830 2c20 4e2c 2032 202a 2064 293a 0a20  (0, N, 2 * d):. 
-00047f10: 2020 2020 2020 2020 2020 2064 736b 5b28             dsk[(
-00047f20: 6e61 6d65 2c20 6920 2b20 6420 2d20 312c  name, i + d - 1,
-00047f30: 2064 2c20 3129 5d20 3d20 286e 616d 652c   d, 1)] = (name,
-00047f40: 2069 202b 2032 202a 2064 202d 2031 2c20   i + 2 * d - 1, 
-00047f50: 3220 2a20 642c 2031 290a 2020 2020 2020  2 * d, 1).      
-00047f60: 2020 2020 2020 6473 6b5b 286e 616d 652c        dsk[(name,
-00047f70: 2069 202b 2032 202a 2064 202d 2031 2c20   i + 2 * d - 1, 
-00047f80: 642c 2031 295d 203d 2028 0a20 2020 2020  d, 1)] = (.     
-00047f90: 2020 2020 2020 2020 2020 2061 7070 6c79             apply
-00047fa0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00047fb0: 2020 662c 0a20 2020 2020 2020 2020 2020    f,.           
-00047fc0: 2020 2020 205b 286e 616d 652c 2069 202b       [(name, i +
-00047fd0: 2064 202d 2031 2c20 642c 2030 292c 2028   d - 1, d, 0), (
-00047fe0: 6e61 6d65 2c20 6920 2b20 3220 2a20 6420  name, i + 2 * d 
-00047ff0: 2d20 312c 2032 202a 2064 2c20 3129 5d2c  - 1, 2 * d, 1)],
-00048000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00048010: 206b 7761 7267 732c 0a20 2020 2020 2020   kwargs,.       
-00048020: 2020 2020 2029 0a0a 2020 2020 666f 7220       )..    for 
-00048030: 6920 696e 2072 616e 6765 286e 293a 0a20  i in range(n):. 
-00048040: 2020 2020 2020 2064 736b 5b28 6e61 6d65         dsk[(name
-00048050: 2c20 6929 5d20 3d20 2861 7070 6c79 2c20  , i)] = (apply, 
-00048060: 662c 205b 286e 616d 652c 206e 202d 2031  f, [(name, n - 1
-00048070: 202d 2069 2c20 312c 2031 292c 2069 6465   - i, 1, 1), ide
-00048080: 6e74 6974 795d 2c20 6b77 6172 6773 290a  ntity], kwargs).
-00048090: 0a20 2020 2067 7261 7068 203d 2048 6967  .    graph = Hig
-000480a0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-000480b0: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
-000480c0: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
-000480d0: 6369 6573 3d5b 6464 665d 290a 2020 2020  cies=[ddf]).    
-000480e0: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
-000480f0: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
-00048100: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
-00048110: 7329 0a0a 0a64 6566 206d 6170 7365 7269  s)...def mapseri
-00048120: 6573 2862 6173 655f 6368 756e 6b2c 2063  es(base_chunk, c
-00048130: 6f6e 6361 745f 6d61 7029 3a0a 2020 2020  oncat_map):.    
-00048140: 7265 7475 726e 2062 6173 655f 6368 756e  return base_chun
-00048150: 6b2e 6d61 7028 636f 6e63 6174 5f6d 6170  k.map(concat_map
-00048160: 290a 0a0a 6465 6620 6d61 7073 6572 6965  )...def mapserie
-00048170: 735f 636f 6d62 696e 6528 696e 6465 782c  s_combine(index,
-00048180: 2063 6f6e 6361 745f 7265 7375 6c74 293a   concat_result):
-00048190: 0a20 2020 2066 696e 616c 5f73 6572 6965  .    final_serie
-000481a0: 7320 3d20 636f 6e63 6174 5f72 6573 756c  s = concat_resul
-000481b0: 742e 736f 7274 5f69 6e64 6578 2829 0a20  t.sort_index(). 
-000481c0: 2020 2066 696e 616c 5f73 6572 6965 7320     final_series 
-000481d0: 3d20 696e 6465 782e 746f 5f73 6572 6965  = index.to_serie
-000481e0: 7328 292e 6d61 7028 6669 6e61 6c5f 7365  s().map(final_se
-000481f0: 7269 6573 290a 2020 2020 7265 7475 726e  ries).    return
-00048200: 2066 696e 616c 5f73 6572 6965 730a 0a0a   final_series...
-00048210: 6465 6620 7365 7269 6573 5f6d 6170 2862  def series_map(b
-00048220: 6173 655f 7365 7269 6573 2c20 6d61 705f  ase_series, map_
-00048230: 7365 7269 6573 293a 0a20 2020 206e 7061  series):.    npa
-00048240: 7274 6974 696f 6e73 203d 2062 6173 655f  rtitions = base_
-00048250: 7365 7269 6573 2e6e 7061 7274 6974 696f  series.npartitio
-00048260: 6e73 0a20 2020 2073 706c 6974 5f6f 7574  ns.    split_out
-00048270: 203d 206d 6170 5f73 6572 6965 732e 6e70   = map_series.np
-00048280: 6172 7469 7469 6f6e 730a 0a20 2020 2064  artitions..    d
-00048290: 736b 203d 207b 7d0a 0a20 2020 2062 6173  sk = {}..    bas
-000482a0: 655f 746f 6b65 6e5f 6b65 7920 3d20 746f  e_token_key = to
-000482b0: 6b65 6e69 7a65 2862 6173 655f 7365 7269  kenize(base_seri
-000482c0: 6573 2c20 7370 6c69 745f 6f75 7429 0a20  es, split_out). 
-000482d0: 2020 2062 6173 655f 7370 6c69 745f 7072     base_split_pr
-000482e0: 6566 6978 203d 2066 2262 6173 652d 7370  efix = f"base-sp
-000482f0: 6c69 742d 7b62 6173 655f 746f 6b65 6e5f  lit-{base_token_
-00048300: 6b65 797d 220a 2020 2020 6261 7365 5f73  key}".    base_s
-00048310: 6861 7264 5f70 7265 6669 7820 3d20 6622  hard_prefix = f"
-00048320: 6261 7365 2d73 6861 7264 2d7b 6261 7365  base-shard-{base
-00048330: 5f74 6f6b 656e 5f6b 6579 7d22 0a20 2020  _token_key}".   
-00048340: 2066 6f72 2069 2c20 6b65 7920 696e 2065   for i, key in e
-00048350: 6e75 6d65 7261 7465 2862 6173 655f 7365  numerate(base_se
-00048360: 7269 6573 2e5f 5f64 6173 6b5f 6b65 7973  ries.__dask_keys
-00048370: 5f5f 2829 293a 0a20 2020 2020 2020 2064  __()):.        d
-00048380: 736b 5b28 6261 7365 5f73 706c 6974 5f70  sk[(base_split_p
-00048390: 7265 6669 782c 2069 295d 203d 2028 6861  refix, i)] = (ha
-000483a0: 7368 5f73 6861 7264 2c20 6b65 792c 2073  sh_shard, key, s
-000483b0: 706c 6974 5f6f 7574 290a 2020 2020 2020  plit_out).      
-000483c0: 2020 666f 7220 6a20 696e 2072 616e 6765    for j in range
-000483d0: 2873 706c 6974 5f6f 7574 293a 0a20 2020  (split_out):.   
-000483e0: 2020 2020 2020 2020 2064 736b 5b28 6261           dsk[(ba
-000483f0: 7365 5f73 6861 7264 5f70 7265 6669 782c  se_shard_prefix,
-00048400: 2030 2c20 692c 206a 295d 203d 2028 6765   0, i, j)] = (ge
-00048410: 7469 7465 6d2c 2028 6261 7365 5f73 706c  titem, (base_spl
-00048420: 6974 5f70 7265 6669 782c 2069 292c 206a  it_prefix, i), j
-00048430: 290a 0a20 2020 206d 6170 5f74 6f6b 656e  )..    map_token
-00048440: 5f6b 6579 203d 2074 6f6b 656e 697a 6528  _key = tokenize(
-00048450: 6d61 705f 7365 7269 6573 290a 2020 2020  map_series).    
-00048460: 6d61 705f 7370 6c69 745f 7072 6566 6978  map_split_prefix
-00048470: 203d 2066 226d 6170 2d73 706c 6974 2d7b   = f"map-split-{
-00048480: 6d61 705f 746f 6b65 6e5f 6b65 797d 220a  map_token_key}".
-00048490: 2020 2020 6d61 705f 7368 6172 645f 7072      map_shard_pr
-000484a0: 6566 6978 203d 2066 226d 6170 2d73 6861  efix = f"map-sha
-000484b0: 7264 2d7b 6d61 705f 746f 6b65 6e5f 6b65  rd-{map_token_ke
-000484c0: 797d 220a 2020 2020 666f 7220 692c 206b  y}".    for i, k
-000484d0: 6579 2069 6e20 656e 756d 6572 6174 6528  ey in enumerate(
-000484e0: 6d61 705f 7365 7269 6573 2e5f 5f64 6173  map_series.__das
-000484f0: 6b5f 6b65 7973 5f5f 2829 293a 0a20 2020  k_keys__()):.   
-00048500: 2020 2020 2064 736b 5b28 6d61 705f 7370       dsk[(map_sp
-00048510: 6c69 745f 7072 6566 6978 2c20 6929 5d20  lit_prefix, i)] 
-00048520: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00048530: 6861 7368 5f73 6861 7264 2c0a 2020 2020  hash_shard,.    
-00048540: 2020 2020 2020 2020 6b65 792c 0a20 2020          key,.   
-00048550: 2020 2020 2020 2020 2073 706c 6974 5f6f           split_o
-00048560: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
-00048570: 7370 6c69 745f 6f75 745f 6f6e 5f69 6e64  split_out_on_ind
-00048580: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
-00048590: 4e6f 6e65 2c0a 2020 2020 2020 2020 290a  None,.        ).
-000485a0: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
-000485b0: 2072 616e 6765 2873 706c 6974 5f6f 7574   range(split_out
-000485c0: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-000485d0: 736b 5b28 6d61 705f 7368 6172 645f 7072  sk[(map_shard_pr
-000485e0: 6566 6978 2c20 302c 2069 2c20 6a29 5d20  efix, 0, i, j)] 
-000485f0: 3d20 2867 6574 6974 656d 2c20 286d 6170  = (getitem, (map
-00048600: 5f73 706c 6974 5f70 7265 6669 782c 2069  _split_prefix, i
-00048610: 292c 206a 290a 0a20 2020 2074 6f6b 656e  ), j)..    token
-00048620: 5f6b 6579 203d 2074 6f6b 656e 697a 6528  _key = tokenize(
-00048630: 6261 7365 5f73 6572 6965 732c 206d 6170  base_series, map
-00048640: 5f73 6572 6965 7329 0a20 2020 206d 6170  _series).    map
-00048650: 5f70 7265 6669 7820 3d20 6622 6d61 702d  _prefix = f"map-
-00048660: 7365 7269 6573 2d7b 746f 6b65 6e5f 6b65  series-{token_ke
-00048670: 797d 220a 2020 2020 666f 7220 6920 696e  y}".    for i in
-00048680: 2072 616e 6765 286e 7061 7274 6974 696f   range(npartitio
-00048690: 6e73 293a 0a20 2020 2020 2020 2066 6f72  ns):.        for
-000486a0: 206a 2069 6e20 7261 6e67 6528 7370 6c69   j in range(spli
-000486b0: 745f 6f75 7429 3a0a 2020 2020 2020 2020  t_out):.        
-000486c0: 2020 2020 6473 6b5b 286d 6170 5f70 7265      dsk[(map_pre
-000486d0: 6669 782c 2069 2c20 6a29 5d20 3d20 280a  fix, i, j)] = (.
-000486e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000486f0: 6d61 7073 6572 6965 732c 0a20 2020 2020  mapseries,.     
-00048700: 2020 2020 2020 2020 2020 2028 6261 7365             (base
-00048710: 5f73 6861 7264 5f70 7265 6669 782c 2030  _shard_prefix, 0
-00048720: 2c20 692c 206a 292c 0a20 2020 2020 2020  , i, j),.       
-00048730: 2020 2020 2020 2020 2028 5f63 6f6e 6361           (_conca
-00048740: 742c 205b 286d 6170 5f73 6861 7264 5f70  t, [(map_shard_p
-00048750: 7265 6669 782c 2030 2c20 6b2c 206a 2920  refix, 0, k, j) 
-00048760: 666f 7220 6b20 696e 2072 616e 6765 2873  for k in range(s
-00048770: 706c 6974 5f6f 7574 295d 292c 0a20 2020  plit_out)]),.   
-00048780: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00048790: 6669 6e61 6c5f 7072 6566 6978 203d 2066  final_prefix = f
-000487a0: 226d 6170 2d73 6572 6965 732d 636f 6d62  "map-series-comb
-000487b0: 696e 652d 7b74 6f6b 656e 5f6b 6579 7d22  ine-{token_key}"
-000487c0: 0a20 2020 2066 6f72 2069 2c20 6b65 7920  .    for i, key 
-000487d0: 696e 2065 6e75 6d65 7261 7465 2862 6173  in enumerate(bas
-000487e0: 655f 7365 7269 6573 2e69 6e64 6578 2e5f  e_series.index._
-000487f0: 5f64 6173 6b5f 6b65 7973 5f5f 2829 293a  _dask_keys__()):
-00048800: 0a20 2020 2020 2020 2064 736b 5b28 6669  .        dsk[(fi
-00048810: 6e61 6c5f 7072 6566 6978 2c20 6929 5d20  nal_prefix, i)] 
-00048820: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00048830: 6d61 7073 6572 6965 735f 636f 6d62 696e  mapseries_combin
-00048840: 652c 0a20 2020 2020 2020 2020 2020 206b  e,.            k
-00048850: 6579 2c0a 2020 2020 2020 2020 2020 2020  ey,.            
-00048860: 285f 636f 6e63 6174 2c20 5b28 6d61 705f  (_concat, [(map_
-00048870: 7072 6566 6978 2c20 692c 206a 2920 666f  prefix, i, j) fo
-00048880: 7220 6a20 696e 2072 616e 6765 2873 706c  r j in range(spl
-00048890: 6974 5f6f 7574 295d 292c 0a20 2020 2020  it_out)]),.     
-000488a0: 2020 2029 0a0a 2020 2020 6d65 7461 203d     )..    meta =
-000488b0: 206d 6170 5f73 6572 6965 732e 5f6d 6574   map_series._met
-000488c0: 612e 636f 7079 2829 0a20 2020 206d 6574  a.copy().    met
-000488d0: 612e 696e 6465 7820 3d20 6261 7365 5f73  a.index = base_s
-000488e0: 6572 6965 732e 5f6d 6574 612e 696e 6465  eries._meta.inde
-000488f0: 780a 2020 2020 6d65 7461 203d 206d 616b  x.    meta = mak
-00048900: 655f 6d65 7461 286d 6574 6129 0a0a 2020  e_meta(meta)..  
-00048910: 2020 6465 7065 6e64 656e 6369 6573 203d    dependencies =
-00048920: 205b 6261 7365 5f73 6572 6965 732c 206d   [base_series, m
-00048930: 6170 5f73 6572 6965 732c 2062 6173 655f  ap_series, base_
-00048940: 7365 7269 6573 2e69 6e64 6578 5d0a 2020  series.index].  
-00048950: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-00048960: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-00048970: 6c6c 6563 7469 6f6e 7328 0a20 2020 2020  llections(.     
-00048980: 2020 2066 696e 616c 5f70 7265 6669 782c     final_prefix,
-00048990: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-000489a0: 6573 3d64 6570 656e 6465 6e63 6965 730a  es=dependencies.
-000489b0: 2020 2020 290a 2020 2020 6469 7669 7369      ).    divisi
-000489c0: 6f6e 7320 3d20 6c69 7374 2862 6173 655f  ons = list(base_
-000489d0: 7365 7269 6573 2e64 6976 6973 696f 6e73  series.divisions
-000489e0: 290a 0a20 2020 2072 6574 7572 6e20 6e65  )..    return ne
-000489f0: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
-00048a00: 682c 2066 696e 616c 5f70 7265 6669 782c  h, final_prefix,
-00048a10: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
-00048a20: 290a 0a0a 6465 6620 5f63 6f6e 7665 7274  )...def _convert
-00048a30: 5f74 6f5f 6e75 6d65 7269 6328 7365 7269  _to_numeric(seri
-00048a40: 6573 2c20 736b 6970 6e61 293a 0a20 2020  es, skipna):.   
-00048a50: 2069 6620 736b 6970 6e61 3a0a 2020 2020   if skipna:.    
-00048a60: 2020 2020 7265 7475 726e 2073 6572 6965      return serie
-00048a70: 732e 6472 6f70 6e61 2829 2e76 6965 7728  s.dropna().view(
-00048a80: 2269 3822 290a 0a20 2020 2023 2073 6572  "i8")..    # ser
-00048a90: 6965 732e 7669 6577 2822 6938 2229 2077  ies.view("i8") w
-00048aa0: 6974 6820 7064 2e4e 6154 2070 726f 6475  ith pd.NaT produ
-00048ab0: 6365 7320 2d39 3232 3333 3732 3033 3638  ces -92233720368
-00048ac0: 3534 3737 3538 3038 2069 7320 7768 7920  54775808 is why 
-00048ad0: 7765 206e 6565 6420 746f 2064 6f20 7468  we need to do th
-00048ae0: 6973 0a20 2020 2072 6574 7572 6e20 7365  is.    return se
-00048af0: 7269 6573 2e76 6965 7728 2269 3822 292e  ries.view("i8").
-00048b00: 6d61 736b 2873 6572 6965 732e 6973 6e75  mask(series.isnu
-00048b10: 6c6c 2829 2c20 6e70 2e6e 616e 290a 0a0a  ll(), np.nan)...
-00048b20: 6465 6620 5f73 7172 745f 616e 645f 636f  def _sqrt_and_co
-00048b30: 6e76 6572 745f 746f 5f74 696d 6564 656c  nvert_to_timedel
-00048b40: 7461 2870 6172 7469 7469 6f6e 2c20 6178  ta(partition, ax
-00048b50: 6973 2c20 2a61 7267 732c 202a 2a6b 7761  is, *args, **kwa
-00048b60: 7267 7329 3a0a 2020 2020 6966 2061 7869  rgs):.    if axi
-00048b70: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
-00048b80: 7769 7468 2077 6172 6e69 6e67 732e 6361  with warnings.ca
-00048b90: 7463 685f 7761 726e 696e 6773 2829 3a0a  tch_warnings():.
-00048ba0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00048bb0: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
-00048bc0: 6e67 7328 0a20 2020 2020 2020 2020 2020  ngs(.           
-00048bd0: 2020 2020 2022 6967 6e6f 7265 222c 0a20       "ignore",. 
-00048be0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00048bf0: 6174 6567 6f72 793d 5275 6e74 696d 6557  ategory=RuntimeW
-00048c00: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
-00048c10: 2020 2020 2020 2020 6d65 7373 6167 653d          message=
-00048c20: 2269 6e76 616c 6964 2076 616c 7565 2065  "invalid value e
-00048c30: 6e63 6f75 6e74 6572 6564 2069 6e20 6361  ncountered in ca
-00048c40: 7374 222c 0a20 2020 2020 2020 2020 2020  st",.           
-00048c50: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-00048c60: 6574 7572 6e20 7064 2e74 6f5f 7469 6d65  eturn pd.to_time
-00048c70: 6465 6c74 6128 4d2e 7374 6428 7061 7274  delta(M.std(part
-00048c80: 6974 696f 6e2c 2061 7869 733d 6178 6973  ition, axis=axis
-00048c90: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00048ca0: 7329 290a 0a20 2020 2069 735f 6466 5f6c  s))..    is_df_l
-00048cb0: 696b 652c 2074 696d 655f 636f 6c73 203d  ike, time_cols =
-00048cc0: 206b 7761 7267 735b 2269 735f 6466 5f6c   kwargs["is_df_l
-00048cd0: 696b 6522 5d2c 206b 7761 7267 735b 2274  ike"], kwargs["t
-00048ce0: 696d 655f 636f 6c73 225d 0a0a 2020 2020  ime_cols"]..    
-00048cf0: 7371 7274 203d 206e 702e 7371 7274 2870  sqrt = np.sqrt(p
-00048d00: 6172 7469 7469 6f6e 290a 0a20 2020 2069  artition)..    i
-00048d10: 6620 6e6f 7420 6973 5f64 665f 6c69 6b65  f not is_df_like
-00048d20: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00048d30: 2070 642e 746f 5f74 696d 6564 656c 7461   pd.to_timedelta
-00048d40: 2873 7172 7429 0a0a 2020 2020 7469 6d65  (sqrt)..    time
-00048d50: 5f63 6f6c 5f6d 6173 6b20 3d20 7371 7274  _col_mask = sqrt
-00048d60: 2e69 6e64 6578 2e69 7369 6e28 7469 6d65  .index.isin(time
-00048d70: 5f63 6f6c 7329 0a20 2020 206d 6174 6368  _cols).    match
-00048d80: 696e 675f 7661 6c73 203d 2073 7172 745b  ing_vals = sqrt[
-00048d90: 7469 6d65 5f63 6f6c 5f6d 6173 6b5d 0a20  time_col_mask]. 
-00048da0: 2020 2066 6f72 2074 696d 655f 636f 6c2c     for time_col,
-00048db0: 206d 6174 6368 696e 675f 7661 6c20 696e   matching_val in
-00048dc0: 207a 6970 2874 696d 655f 636f 6c73 2c20   zip(time_cols, 
-00048dd0: 6d61 7463 6869 6e67 5f76 616c 7329 3a0a  matching_vals):.
-00048de0: 2020 2020 2020 2020 7371 7274 5b74 696d          sqrt[tim
-00048df0: 655f 636f 6c5d 203d 2070 642e 746f 5f74  e_col] = pd.to_t
-00048e00: 696d 6564 656c 7461 286d 6174 6368 696e  imedelta(matchin
-00048e10: 675f 7661 6c29 0a0a 2020 2020 7265 7475  g_val)..    retu
-00048e20: 726e 2073 7172 740a 0a0a 6465 6620 5f72  rn sqrt...def _r
-00048e30: 6169 7365 5f69 665f 6e6f 745f 7365 7269  aise_if_not_seri
-00048e40: 6573 5f6f 725f 6461 7461 6672 616d 6528  es_or_dataframe(
-00048e50: 782c 2066 756e 636e 616d 6529 3a0a 2020  x, funcname):.  
-00048e60: 2020 2222 220a 2020 2020 5574 696c 6974    """.    Utilit
-00048e70: 7920 6675 6e63 7469 6f6e 2074 6f20 7261  y function to ra
-00048e80: 6973 6520 616e 2065 7272 6f72 2069 6620  ise an error if 
-00048e90: 616e 206f 626a 6563 7420 6973 206e 6f74  an object is not
-00048ea0: 2061 2053 6572 6965 7320 6f72 2044 6174   a Series or Dat
-00048eb0: 6146 7261 6d65 0a20 2020 2022 2222 0a20  aFrame.    """. 
-00048ec0: 2020 2069 6620 6e6f 7420 6973 5f73 6572     if not is_ser
-00048ed0: 6965 735f 6c69 6b65 2878 2920 616e 6420  ies_like(x) and 
-00048ee0: 6e6f 7420 6973 5f64 6174 6166 7261 6d65  not is_dataframe
-00048ef0: 5f6c 696b 6528 7829 3a0a 2020 2020 2020  _like(x):.      
-00048f00: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-00048f10: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
-00048f20: 2020 2020 2020 2020 2022 6025 7360 2069           "`%s` i
-00048f30: 7320 6f6e 6c79 2073 7570 706f 7274 6564  s only supported
-00048f40: 2077 6974 6820 6f62 6a65 6374 7320 7468   with objects th
-00048f50: 6174 2061 7265 2044 6174 6166 7261 6d65  at are Dataframe
-00048f60: 7320 6f72 2053 6572 6965 7322 0a20 2020  s or Series".   
-00048f70: 2020 2020 2020 2020 2025 2066 756e 636e           % funcn
-00048f80: 616d 650a 2020 2020 2020 2020 290a 0a0a  ame.        )...
-00048f90: 6465 6620 5f67 6574 6174 7472 5f6e 756d  def _getattr_num
-00048fa0: 6572 6963 5f6f 6e6c 7928 2a61 7267 732c  eric_only(*args,
-00048fb0: 205f 6461 736b 5f6d 6574 686f 645f 6e61   _dask_method_na
-00048fc0: 6d65 2c20 2a2a 6b77 6172 6773 293a 0a20  me, **kwargs):. 
-00048fd0: 2020 2077 6974 6820 6368 6563 6b5f 6e75     with check_nu
-00048fe0: 6d65 7269 635f 6f6e 6c79 5f64 6570 7265  meric_only_depre
-00048ff0: 6361 7469 6f6e 2829 3a0a 2020 2020 2020  cation():.      
-00049000: 2020 7265 7475 726e 2067 6574 6174 7472    return getattr
-00049010: 284d 2c20 5f64 6173 6b5f 6d65 7468 6f64  (M, _dask_method
-00049020: 5f6e 616d 6529 282a 6172 6773 2c20 2a2a  _name)(*args, **
-00049030: 6b77 6172 6773 290a                      kwargs).
+000331d0: 2020 2020 7368 7566 666c 653d 7368 7566      shuffle=shuf
+000331e0: 666c 652c 0a20 2020 2020 2020 2020 2020  fle,.           
+000331f0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00033200: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00033210: 2020 2020 2020 2020 2023 2044 6f20 7265           # Do re
+00033220: 6375 7273 6976 6520 7061 6972 7769 7365  cursive pairwise
+00033230: 206a 6f69 6e20 6f6e 2065 7665 7279 7468   join on everyth
+00033240: 696e 6720 5f65 7863 6570 745f 2074 6865  ing _except_ the
+00033250: 206c 6173 7420 6a6f 696e 0a20 2020 2020   last join.     
+00033260: 2020 2020 2020 2020 2020 2023 2077 6865             # whe
+00033270: 7265 2077 6520 6e65 6564 2074 6f20 646f  re we need to do
+00033280: 2061 206c 6566 7420 6a6f 696e 2e0a 2020   a left join..  
+00033290: 2020 2020 2020 2020 2020 2020 2020 6f74                ot
+000332a0: 6865 7220 3d20 5f72 6563 7572 7369 7665  her = _recursive
+000332b0: 5f70 6169 7277 6973 655f 6f75 7465 725f  _pairwise_outer_
+000332c0: 6a6f 696e 280a 2020 2020 2020 2020 2020  join(.          
+000332d0: 2020 2020 2020 2020 2020 6f74 6865 722c            other,
+000332e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000332f0: 2020 2020 206f 6e3d 6f6e 2c0a 2020 2020       on=on,.    
+00033300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033310: 6c73 7566 6669 783d 6c73 7566 6669 782c  lsuffix=lsuffix,
+00033320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033330: 2020 2020 2072 7375 6666 6978 3d72 7375       rsuffix=rsu
+00033340: 6666 6978 2c0a 2020 2020 2020 2020 2020  ffix,.          
+00033350: 2020 2020 2020 2020 2020 6e70 6172 7469            nparti
+00033360: 7469 6f6e 733d 6e70 6172 7469 7469 6f6e  tions=npartition
+00033370: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00033380: 2020 2020 2020 2073 6875 6666 6c65 3d73         shuffle=s
+00033390: 6875 6666 6c65 2c0a 2020 2020 2020 2020  huffle,.        
+000333a0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000333b0: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
+000333c0: 6166 7261 6d65 2e6d 756c 7469 2069 6d70  aframe.multi imp
+000333d0: 6f72 7420 6d65 7267 650a 0a20 2020 2020  ort merge..     
+000333e0: 2020 2072 6574 7572 6e20 6d65 7267 6528     return merge(
+000333f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00033400: 662c 0a20 2020 2020 2020 2020 2020 206f  f,.            o
+00033410: 7468 6572 2c0a 2020 2020 2020 2020 2020  ther,.          
+00033420: 2020 686f 773d 686f 772c 0a20 2020 2020    how=how,.     
+00033430: 2020 2020 2020 206c 6566 745f 696e 6465         left_inde
+00033440: 783d 6f6e 2069 7320 4e6f 6e65 2c0a 2020  x=on is None,.  
+00033450: 2020 2020 2020 2020 2020 7269 6768 745f            right_
+00033460: 696e 6465 783d 5472 7565 2c0a 2020 2020  index=True,.    
+00033470: 2020 2020 2020 2020 6c65 6674 5f6f 6e3d          left_on=
+00033480: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00033490: 7375 6666 6978 6573 3d28 6c73 7566 6669  suffixes=(lsuffi
+000334a0: 782c 2072 7375 6666 6978 292c 0a20 2020  x, rsuffix),.   
+000334b0: 2020 2020 2020 2020 206e 7061 7274 6974           npartit
+000334c0: 696f 6e73 3d6e 7061 7274 6974 696f 6e73  ions=npartitions
+000334d0: 2c0a 2020 2020 2020 2020 2020 2020 7368  ,.            sh
+000334e0: 7566 666c 653d 7368 7566 666c 652c 0a20  uffle=shuffle,. 
+000334f0: 2020 2020 2020 2029 0a0a 2020 2020 6966         )..    if
+00033500: 206e 6f74 2050 414e 4441 535f 4754 5f32   not PANDAS_GT_2
+00033510: 3030 3a0a 0a20 2020 2020 2020 2040 6465  00:..        @de
+00033520: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00033530: 7461 4672 616d 6529 0a20 2020 2020 2020  taFrame).       
+00033540: 2064 6566 2061 7070 656e 6428 7365 6c66   def append(self
+00033550: 2c20 6f74 6865 722c 2069 6e74 6572 6c65  , other, interle
+00033560: 6176 655f 7061 7274 6974 696f 6e73 3d46  ave_partitions=F
+00033570: 616c 7365 293a 0a20 2020 2020 2020 2020  alse):.         
+00033580: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00033590: 286f 7468 6572 2c20 5365 7269 6573 293a  (other, Series):
+000335a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000335b0: 206d 7367 203d 2028 0a20 2020 2020 2020   msg = (.       
+000335c0: 2020 2020 2020 2020 2020 2020 2022 556e               "Un
+000335d0: 6162 6c65 2074 6f20 6170 7065 6e64 696e  able to appendin
+000335e0: 6720 6464 2e53 6572 6965 7320 746f 2064  g dd.Series to d
+000335f0: 642e 4461 7461 4672 616d 652e 220a 2020  d.DataFrame.".  
+00033600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033610: 2020 2255 7365 2070 642e 5365 7269 6573    "Use pd.Series
+00033620: 2074 6f20 6170 7065 6e64 2061 7320 726f   to append as ro
+00033630: 772e 220a 2020 2020 2020 2020 2020 2020  w.".            
+00033640: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00033650: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00033660: 6545 7272 6f72 286d 7367 290a 2020 2020  eError(msg).    
+00033670: 2020 2020 2020 2020 656c 6966 2069 735f          elif is_
+00033680: 7365 7269 6573 5f6c 696b 6528 6f74 6865  series_like(othe
+00033690: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+000336a0: 2020 2020 6f74 6865 7220 3d20 6f74 6865      other = othe
+000336b0: 722e 746f 5f66 7261 6d65 2829 2e54 0a20  r.to_frame().T. 
+000336c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000336d0: 6e20 7375 7065 7228 292e 6170 7065 6e64  n super().append
+000336e0: 286f 7468 6572 2c20 696e 7465 726c 6561  (other, interlea
+000336f0: 7665 5f70 6172 7469 7469 6f6e 733d 696e  ve_partitions=in
+00033700: 7465 726c 6561 7665 5f70 6172 7469 7469  terleave_partiti
+00033710: 6f6e 7329 0a0a 2020 2020 4064 6572 6976  ons)..    @deriv
+00033720: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00033730: 7261 6d65 290a 2020 2020 6465 6620 6974  rame).    def it
+00033740: 6572 726f 7773 2873 656c 6629 3a0a 2020  errows(self):.  
+00033750: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00033760: 616e 6765 2873 656c 662e 6e70 6172 7469  ange(self.nparti
+00033770: 7469 6f6e 7329 3a0a 2020 2020 2020 2020  tions):.        
+00033780: 2020 2020 6466 203d 2073 656c 662e 6765      df = self.ge
+00033790: 745f 7061 7274 6974 696f 6e28 6929 2e63  t_partition(i).c
+000337a0: 6f6d 7075 7465 2829 0a20 2020 2020 2020  ompute().       
+000337b0: 2020 2020 2079 6965 6c64 2066 726f 6d20       yield from 
+000337c0: 6466 2e69 7465 7272 6f77 7328 290a 0a20  df.iterrows().. 
+000337d0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+000337e0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+000337f0: 2020 2064 6566 2069 7465 7274 7570 6c65     def itertuple
+00033800: 7328 7365 6c66 2c20 696e 6465 783d 5472  s(self, index=Tr
+00033810: 7565 2c20 6e61 6d65 3d22 5061 6e64 6173  ue, name="Pandas
+00033820: 2229 3a0a 2020 2020 2020 2020 666f 7220  "):.        for 
+00033830: 6920 696e 2072 616e 6765 2873 656c 662e  i in range(self.
+00033840: 6e70 6172 7469 7469 6f6e 7329 3a0a 2020  npartitions):.  
+00033850: 2020 2020 2020 2020 2020 6466 203d 2073            df = s
+00033860: 656c 662e 6765 745f 7061 7274 6974 696f  elf.get_partitio
+00033870: 6e28 6929 2e63 6f6d 7075 7465 2829 0a20  n(i).compute(). 
+00033880: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
+00033890: 2066 726f 6d20 6466 2e69 7465 7274 7570   from df.itertup
+000338a0: 6c65 7328 696e 6465 783d 696e 6465 782c  les(index=index,
+000338b0: 206e 616d 653d 6e61 6d65 290a 0a20 2020   name=name)..   
+000338c0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+000338d0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+000338e0: 2064 6566 2069 7465 6d73 2873 656c 6629   def items(self)
+000338f0: 3a0a 2020 2020 2020 2020 666f 7220 636f  :.        for co
+00033900: 6c5f 6964 782c 206c 6162 656c 2069 6e20  l_idx, label in 
+00033910: 656e 756d 6572 6174 6528 7365 6c66 2e63  enumerate(self.c
+00033920: 6f6c 756d 6e73 293a 0a20 2020 2020 2020  olumns):.       
+00033930: 2020 2020 2079 6965 6c64 206c 6162 656c       yield label
+00033940: 2c20 7365 6c66 2e69 6c6f 635b 3a2c 2063  , self.iloc[:, c
+00033950: 6f6c 5f69 6478 5d0a 0a20 2020 2040 636c  ol_idx]..    @cl
+00033960: 6173 736d 6574 686f 640a 2020 2020 6465  assmethod.    de
+00033970: 6620 5f62 696e 645f 6f70 6572 6174 6f72  f _bind_operator
+00033980: 5f6d 6574 686f 6428 636c 732c 206e 616d  _method(cls, nam
+00033990: 652c 206f 702c 206f 7269 6769 6e61 6c3d  e, op, original=
+000339a0: 7064 2e44 6174 6146 7261 6d65 293a 0a20  pd.DataFrame):. 
+000339b0: 2020 2020 2020 2022 2222 6269 6e64 206f         """bind o
+000339c0: 7065 7261 746f 7220 6d65 7468 6f64 206c  perator method l
+000339d0: 696b 6520 4461 7461 4672 616d 652e 6164  ike DataFrame.ad
+000339e0: 6420 746f 2074 6869 7320 636c 6173 7322  d to this class"
+000339f0: 2222 0a0a 2020 2020 2020 2020 2320 6e61  ""..        # na
+00033a00: 6d65 206d 7573 7420 6265 2065 7870 6c69  me must be expli
+00033a10: 6369 746c 7920 7061 7373 6564 2066 6f72  citly passed for
+00033a20: 2064 6976 206d 6574 686f 6420 7768 6f73   div method whos
+00033a30: 6520 6e61 6d65 2069 7320 7472 7565 6469  e name is truedi
+00033a40: 760a 0a20 2020 2020 2020 2064 6566 206d  v..        def m
+00033a50: 6574 6828 7365 6c66 2c20 6f74 6865 722c  eth(self, other,
+00033a60: 2061 7869 733d 2263 6f6c 756d 6e73 222c   axis="columns",
+00033a70: 206c 6576 656c 3d4e 6f6e 652c 2066 696c   level=None, fil
+00033a80: 6c5f 7661 6c75 653d 4e6f 6e65 293a 0a20  l_value=None):. 
+00033a90: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00033aa0: 7665 6c20 6973 206e 6f74 204e 6f6e 653a  vel is not None:
+00033ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033ac0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+00033ad0: 656e 7465 6445 7272 6f72 2822 6c65 7665  entedError("leve
+00033ae0: 6c20 6d75 7374 2062 6520 4e6f 6e65 2229  l must be None")
+00033af0: 0a0a 2020 2020 2020 2020 2020 2020 6178  ..            ax
+00033b00: 6973 203d 2073 656c 662e 5f76 616c 6964  is = self._valid
+00033b10: 6174 655f 6178 6973 2861 7869 7329 0a0a  ate_axis(axis)..
+00033b20: 2020 2020 2020 2020 2020 2020 6966 2061              if a
+00033b30: 7869 7320 696e 2028 312c 2022 636f 6c75  xis in (1, "colu
+00033b40: 6d6e 7322 293a 0a20 2020 2020 2020 2020  mns"):.         
+00033b50: 2020 2020 2020 2023 2057 6865 6e20 6178         # When ax
+00033b60: 6973 3d31 2061 6e64 206f 7468 6572 2069  is=1 and other i
+00033b70: 7320 6120 7365 7269 6573 2c20 606f 7468  s a series, `oth
+00033b80: 6572 6020 6973 2074 7261 6e73 706f 7365  er` is transpose
+00033b90: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+00033ba0: 2020 2320 616e 6420 7468 6520 6f70 6572    # and the oper
+00033bb0: 6174 6f72 2069 7320 6170 706c 6965 6420  ator is applied 
+00033bc0: 6272 6f61 6463 6173 7420 6163 726f 7373  broadcast across
+00033bd0: 2072 6f77 732e 2054 6869 730a 2020 2020   rows. This.    
+00033be0: 2020 2020 2020 2020 2020 2020 2320 6973              # is
+00033bf0: 6e27 7420 7375 7070 6f72 7465 6420 7769  n't supported wi
+00033c00: 7468 2064 642e 5365 7269 6573 2e0a 2020  th dd.Series..  
+00033c10: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00033c20: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
+00033c30: 722c 2053 6572 6965 7329 3a0a 2020 2020  r, Series):.    
+00033c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033c50: 6d73 6720 3d20 6622 556e 6162 6c65 2074  msg = f"Unable t
+00033c60: 6f20 7b6e 616d 657d 2064 642e 5365 7269  o {name} dd.Seri
+00033c70: 6573 2077 6974 6820 6178 6973 3d31 220a  es with axis=1".
+00033c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033c90: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00033ca0: 7272 6f72 286d 7367 290a 2020 2020 2020  rror(msg).      
+00033cb0: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+00033cc0: 735f 7365 7269 6573 5f6c 696b 6528 6f74  s_series_like(ot
+00033cd0: 6865 7229 3a0a 2020 2020 2020 2020 2020  her):.          
+00033ce0: 2020 2020 2020 2020 2020 2320 5370 6563            # Spec
+00033cf0: 6961 6c20 6361 7365 2066 6f72 2070 642e  ial case for pd.
+00033d00: 5365 7269 6573 2074 6f20 6176 6f69 6420  Series to avoid 
+00033d10: 756e 7761 6e74 6564 2070 6172 7469 7469  unwanted partiti
+00033d20: 6f6e 696e 670a 2020 2020 2020 2020 2020  oning.          
+00033d30: 2020 2020 2020 2020 2020 2320 6f66 206f            # of o
+00033d40: 7468 6572 2e20 5765 2070 6173 7320 6974  ther. We pass it
+00033d50: 2069 6e20 6173 2061 206b 7761 7267 2074   in as a kwarg t
+00033d60: 6f20 7072 6576 656e 7420 7468 6973 2e0a  o prevent this..
+00033d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033d80: 2020 2020 6d65 7461 203d 205f 656d 756c      meta = _emul
+00033d90: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
+00033da0: 2020 2020 2020 2020 2020 2020 206f 702c               op,
+00033db0: 2073 656c 662c 206f 7468 6572 3d6f 7468   self, other=oth
+00033dc0: 6572 2c20 6178 6973 3d61 7869 732c 2066  er, axis=axis, f
+00033dd0: 696c 6c5f 7661 6c75 653d 6669 6c6c 5f76  ill_value=fill_v
+00033de0: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
+00033df0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00033e00: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00033e10: 6574 7572 6e20 6d61 705f 7061 7274 6974  eturn map_partit
+00033e20: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
+00033e30: 2020 2020 2020 2020 2020 2020 2020 6f70                op
+00033e40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033e50: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
+00033e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033e70: 2020 2020 2020 2020 6f74 6865 723d 6f74          other=ot
+00033e80: 6865 722c 0a20 2020 2020 2020 2020 2020  her,.           
+00033e90: 2020 2020 2020 2020 2020 2020 206d 6574               met
+00033ea0: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
+00033eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033ec0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
+00033ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033ee0: 2020 2066 696c 6c5f 7661 6c75 653d 6669     fill_value=fi
+00033ef0: 6c6c 5f76 616c 7565 2c0a 2020 2020 2020  ll_value,.      
+00033f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033f10: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
+00033f20: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
+00033f30: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00033f40: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+00033f50: 6120 3d20 5f65 6d75 6c61 7465 286f 702c  a = _emulate(op,
+00033f60: 2073 656c 662c 206f 7468 6572 2c20 6178   self, other, ax
+00033f70: 6973 3d61 7869 732c 2066 696c 6c5f 7661  is=axis, fill_va
+00033f80: 6c75 653d 6669 6c6c 5f76 616c 7565 290a  lue=fill_value).
+00033f90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00033fa0: 726e 206d 6170 5f70 6172 7469 7469 6f6e  rn map_partition
+00033fb0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00033fc0: 2020 206f 702c 0a20 2020 2020 2020 2020     op,.         
+00033fd0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00033fe0: 2020 2020 2020 2020 2020 2020 206f 7468               oth
+00033ff0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+00034000: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
+00034010: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00034020: 7869 733d 6178 6973 2c0a 2020 2020 2020  xis=axis,.      
+00034030: 2020 2020 2020 2020 2020 6669 6c6c 5f76            fill_v
+00034040: 616c 7565 3d66 696c 6c5f 7661 6c75 652c  alue=fill_value,
+00034050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034060: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+00034070: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
+00034080: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00034090: 6d65 7468 2e5f 5f6e 616d 655f 5f20 3d20  meth.__name__ = 
+000340a0: 6e61 6d65 0a20 2020 2020 2020 2073 6574  name.        set
+000340b0: 6174 7472 2863 6c73 2c20 6e61 6d65 2c20  attr(cls, name, 
+000340c0: 6465 7269 7665 645f 6672 6f6d 286f 7269  derived_from(ori
+000340d0: 6769 6e61 6c29 286d 6574 6829 290a 0a20  ginal)(meth)).. 
+000340e0: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
+000340f0: 2020 2020 6465 6620 5f62 696e 645f 636f      def _bind_co
+00034100: 6d70 6172 6973 6f6e 5f6d 6574 686f 6428  mparison_method(
+00034110: 636c 732c 206e 616d 652c 2063 6f6d 7061  cls, name, compa
+00034120: 7269 736f 6e2c 206f 7269 6769 6e61 6c3d  rison, original=
+00034130: 7064 2e44 6174 6146 7261 6d65 293a 0a20  pd.DataFrame):. 
+00034140: 2020 2020 2020 2022 2222 6269 6e64 2063         """bind c
+00034150: 6f6d 7061 7269 736f 6e20 6d65 7468 6f64  omparison method
+00034160: 206c 696b 6520 4461 7461 4672 616d 652e   like DataFrame.
+00034170: 6571 2074 6f20 7468 6973 2063 6c61 7373  eq to this class
+00034180: 2222 220a 0a20 2020 2020 2020 2064 6566  """..        def
+00034190: 206d 6574 6828 7365 6c66 2c20 6f74 6865   meth(self, othe
+000341a0: 722c 2061 7869 733d 2263 6f6c 756d 6e73  r, axis="columns
+000341b0: 222c 206c 6576 656c 3d4e 6f6e 6529 3a0a  ", level=None):.
+000341c0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+000341d0: 6576 656c 2069 7320 6e6f 7420 4e6f 6e65  evel is not None
+000341e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000341f0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+00034200: 6d65 6e74 6564 4572 726f 7228 226c 6576  mentedError("lev
+00034210: 656c 206d 7573 7420 6265 204e 6f6e 6522  el must be None"
+00034220: 290a 2020 2020 2020 2020 2020 2020 6178  ).            ax
+00034230: 6973 203d 2073 656c 662e 5f76 616c 6964  is = self._valid
+00034240: 6174 655f 6178 6973 2861 7869 7329 0a20  ate_axis(axis). 
+00034250: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00034260: 6e20 656c 656d 7769 7365 2863 6f6d 7061  n elemwise(compa
+00034270: 7269 736f 6e2c 2073 656c 662c 206f 7468  rison, self, oth
+00034280: 6572 2c20 6178 6973 3d61 7869 7329 0a0a  er, axis=axis)..
+00034290: 2020 2020 2020 2020 6d65 7468 2e5f 5f6e          meth.__n
+000342a0: 616d 655f 5f20 3d20 6e61 6d65 0a20 2020  ame__ = name.   
+000342b0: 2020 2020 2073 6574 6174 7472 2863 6c73       setattr(cls
+000342c0: 2c20 6e61 6d65 2c20 6465 7269 7665 645f  , name, derived_
+000342d0: 6672 6f6d 286f 7269 6769 6e61 6c29 286d  from(original)(m
+000342e0: 6574 6829 290a 0a20 2020 2040 696e 7365  eth))..    @inse
+000342f0: 7274 5f6d 6574 615f 7061 7261 6d5f 6465  rt_meta_param_de
+00034300: 7363 7269 7074 696f 6e28 7061 643d 3132  scription(pad=12
+00034310: 290a 2020 2020 6465 6620 6170 706c 7928  ).    def apply(
+00034320: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00034330: 2020 2020 2020 2066 756e 632c 0a20 2020         func,.   
+00034340: 2020 2020 2061 7869 733d 302c 0a20 2020       axis=0,.   
+00034350: 2020 2020 2062 726f 6164 6361 7374 3d4e       broadcast=N
+00034360: 6f6e 652c 0a20 2020 2020 2020 2072 6177  one,.        raw
+00034370: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00034380: 7265 6475 6365 3d4e 6f6e 652c 0a20 2020  reduce=None,.   
+00034390: 2020 2020 2061 7267 733d 2829 2c0a 2020       args=(),.  
+000343a0: 2020 2020 2020 6d65 7461 3d6e 6f5f 6465        meta=no_de
+000343b0: 6661 756c 742c 0a20 2020 2020 2020 2072  fault,.        r
+000343c0: 6573 756c 745f 7479 7065 3d4e 6f6e 652c  esult_type=None,
+000343d0: 0a20 2020 2020 2020 202a 2a6b 7764 732c  .        **kwds,
+000343e0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000343f0: 2222 2250 6172 616c 6c65 6c20 7665 7273  """Parallel vers
+00034400: 696f 6e20 6f66 2070 616e 6461 732e 4461  ion of pandas.Da
+00034410: 7461 4672 616d 652e 6170 706c 790a 0a20  taFrame.apply.. 
+00034420: 2020 2020 2020 2054 6869 7320 6d69 6d69         This mimi
+00034430: 6373 2074 6865 2070 616e 6461 7320 7665  cs the pandas ve
+00034440: 7273 696f 6e20 6578 6365 7074 2066 6f72  rsion except for
+00034450: 2074 6865 2066 6f6c 6c6f 7769 6e67 3a0a   the following:.
+00034460: 0a20 2020 2020 2020 2031 2e20 204f 6e6c  .        1.  Onl
+00034470: 7920 6060 6178 6973 3d31 6060 2069 7320  y ``axis=1`` is 
+00034480: 7375 7070 6f72 7465 6420 2861 6e64 206d  supported (and m
+00034490: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
+000344a0: 2065 7870 6c69 6369 746c 7929 2e0a 2020   explicitly)..  
+000344b0: 2020 2020 2020 322e 2020 5468 6520 7573        2.  The us
+000344c0: 6572 2073 686f 756c 6420 7072 6f76 6964  er should provid
+000344d0: 6520 6f75 7470 7574 206d 6574 6164 6174  e output metadat
+000344e0: 6120 7669 6120 7468 6520 606d 6574 6160  a via the `meta`
+000344f0: 206b 6579 776f 7264 2e0a 0a20 2020 2020   keyword...     
+00034500: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00034510: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00034520: 0a20 2020 2020 2020 2066 756e 6320 3a20  .        func : 
+00034530: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+00034540: 2020 2020 2046 756e 6374 696f 6e20 746f       Function to
+00034550: 2061 7070 6c79 2074 6f20 6561 6368 2063   apply to each c
+00034560: 6f6c 756d 6e2f 726f 770a 2020 2020 2020  olumn/row.      
+00034570: 2020 6178 6973 203a 207b 3020 6f72 2027    axis : {0 or '
+00034580: 696e 6465 7827 2c20 3120 6f72 2027 636f  index', 1 or 'co
+00034590: 6c75 6d6e 7327 7d2c 2064 6566 6175 6c74  lumns'}, default
+000345a0: 2030 0a20 2020 2020 2020 2020 2020 202d   0.            -
+000345b0: 2030 206f 7220 2769 6e64 6578 273a 2061   0 or 'index': a
+000345c0: 7070 6c79 2066 756e 6374 696f 6e20 746f  pply function to
+000345d0: 2065 6163 6820 636f 6c75 6d6e 2028 4e4f   each column (NO
+000345e0: 5420 5355 5050 4f52 5445 4429 0a20 2020  T SUPPORTED).   
+000345f0: 2020 2020 2020 2020 202d 2031 206f 7220           - 1 or 
+00034600: 2763 6f6c 756d 6e73 273a 2061 7070 6c79  'columns': apply
+00034610: 2066 756e 6374 696f 6e20 746f 2065 6163   function to eac
+00034620: 6820 726f 770a 2020 2020 2020 2020 244d  h row.        $M
+00034630: 4554 410a 2020 2020 2020 2020 6172 6773  ETA.        args
+00034640: 203a 2074 7570 6c65 0a20 2020 2020 2020   : tuple.       
+00034650: 2020 2020 2050 6f73 6974 696f 6e61 6c20       Positional 
+00034660: 6172 6775 6d65 6e74 7320 746f 2070 6173  arguments to pas
+00034670: 7320 746f 2066 756e 6374 696f 6e20 696e  s to function in
+00034680: 2061 6464 6974 696f 6e20 746f 2074 6865   addition to the
+00034690: 2061 7272 6179 2f73 6572 6965 730a 0a20   array/series.. 
+000346a0: 2020 2020 2020 2041 6464 6974 696f 6e61         Additiona
+000346b0: 6c20 6b65 7977 6f72 6420 6172 6775 6d65  l keyword argume
+000346c0: 6e74 7320 7769 6c6c 2062 6520 7061 7373  nts will be pass
+000346d0: 6564 2061 7320 6b65 7977 6f72 6473 2074  ed as keywords t
+000346e0: 6f20 7468 6520 6675 6e63 7469 6f6e 0a0a  o the function..
+000346f0: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+00034700: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+00034710: 2020 2020 2020 2020 6170 706c 6965 6420          applied 
+00034720: 3a20 5365 7269 6573 206f 7220 4461 7461  : Series or Data
+00034730: 4672 616d 650a 0a20 2020 2020 2020 2045  Frame..        E
+00034740: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
+00034750: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00034760: 203e 3e3e 2069 6d70 6f72 7420 7061 6e64   >>> import pand
+00034770: 6173 2061 7320 7064 0a20 2020 2020 2020  as as pd.       
+00034780: 203e 3e3e 2069 6d70 6f72 7420 6461 736b   >>> import dask
+00034790: 2e64 6174 6166 7261 6d65 2061 7320 6464  .dataframe as dd
+000347a0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+000347b0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+000347c0: 2778 273a 205b 312c 2032 2c20 332c 2034  'x': [1, 2, 3, 4
+000347d0: 2c20 355d 2c0a 2020 2020 2020 2020 2e2e  , 5],.        ..
+000347e0: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
+000347f0: 2020 2020 2027 7927 3a20 5b31 2e2c 2032       'y': [1., 2
+00034800: 2e2c 2033 2e2c 2034 2e2c 2035 2e5d 7d29  ., 3., 4., 5.]})
+00034810: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
+00034820: 203d 2064 642e 6672 6f6d 5f70 616e 6461   = dd.from_panda
+00034830: 7328 6466 2c20 6e70 6172 7469 7469 6f6e  s(df, npartition
+00034840: 733d 3229 0a0a 2020 2020 2020 2020 4170  s=2)..        Ap
+00034850: 706c 7920 6120 6675 6e63 7469 6f6e 2074  ply a function t
+00034860: 6f20 726f 772d 7769 7365 2070 6173 7369  o row-wise passi
+00034870: 6e67 2069 6e20 6578 7472 6120 6172 6775  ng in extra argu
+00034880: 6d65 6e74 7320 696e 2060 6061 7267 7360  ments in ``args`
+00034890: 6020 616e 640a 2020 2020 2020 2020 6060  ` and.        ``
+000348a0: 6b77 6172 6773 6060 3a0a 0a20 2020 2020  kwargs``:..     
+000348b0: 2020 203e 3e3e 2064 6566 206d 7961 6464     >>> def myadd
+000348c0: 2872 6f77 2c20 612c 2062 3d31 293a 0a20  (row, a, b=1):. 
+000348d0: 2020 2020 2020 202e 2e2e 2020 2020 2072         ...     r
+000348e0: 6574 7572 6e20 726f 772e 7375 6d28 2920  eturn row.sum() 
+000348f0: 2b20 6120 2b20 620a 2020 2020 2020 2020  + a + b.        
+00034900: 3e3e 3e20 7265 7320 3d20 6464 662e 6170  >>> res = ddf.ap
+00034910: 706c 7928 6d79 6164 642c 2061 7869 733d  ply(myadd, axis=
+00034920: 312c 2061 7267 733d 2832 2c29 2c20 623d  1, args=(2,), b=
+00034930: 312e 3529 2020 2320 646f 6374 6573 743a  1.5)  # doctest:
+00034940: 202b 534b 4950 0a0a 2020 2020 2020 2020   +SKIP..        
+00034950: 4279 2064 6566 6175 6c74 2c20 6461 736b  By default, dask
+00034960: 2074 7269 6573 2074 6f20 696e 6665 7220   tries to infer 
+00034970: 7468 6520 6f75 7470 7574 206d 6574 6164  the output metad
+00034980: 6174 6120 6279 2072 756e 6e69 6e67 2079  ata by running y
+00034990: 6f75 720a 2020 2020 2020 2020 7072 6f76  our.        prov
+000349a0: 6964 6564 2066 756e 6374 696f 6e20 6f6e  ided function on
+000349b0: 2073 6f6d 6520 6661 6b65 2064 6174 612e   some fake data.
+000349c0: 2054 6869 7320 776f 726b 7320 7765 6c6c   This works well
+000349d0: 2069 6e20 6d61 6e79 2063 6173 6573 2c20   in many cases, 
+000349e0: 6275 740a 2020 2020 2020 2020 6361 6e20  but.        can 
+000349f0: 736f 6d65 7469 6d65 7320 6265 2065 7870  sometimes be exp
+00034a00: 656e 7369 7665 2c20 6f72 2065 7665 6e20  ensive, or even 
+00034a10: 6661 696c 2e20 546f 2061 766f 6964 2074  fail. To avoid t
+00034a20: 6869 732c 2079 6f75 2063 616e 0a20 2020  his, you can.   
+00034a30: 2020 2020 206d 616e 7561 6c6c 7920 7370       manually sp
+00034a40: 6563 6966 7920 7468 6520 6f75 7470 7574  ecify the output
+00034a50: 206d 6574 6164 6174 6120 7769 7468 2074   metadata with t
+00034a60: 6865 2060 606d 6574 6160 6020 6b65 7977  he ``meta`` keyw
+00034a70: 6f72 642e 2054 6869 730a 2020 2020 2020  ord. This.      
+00034a80: 2020 6361 6e20 6265 2073 7065 6369 6669    can be specifi
+00034a90: 6564 2069 6e20 6d61 6e79 2066 6f72 6d73  ed in many forms
+00034aa0: 2c20 666f 7220 6d6f 7265 2069 6e66 6f72  , for more infor
+00034ab0: 6d61 7469 6f6e 2073 6565 0a20 2020 2020  mation see.     
+00034ac0: 2020 2060 6064 6173 6b2e 6461 7461 6672     ``dask.datafr
+00034ad0: 616d 652e 7574 696c 732e 6d61 6b65 5f6d  ame.utils.make_m
+00034ae0: 6574 6160 602e 0a0a 2020 2020 2020 2020  eta``...        
+00034af0: 4865 7265 2077 6520 7370 6563 6966 7920  Here we specify 
+00034b00: 7468 6520 6f75 7470 7574 2069 7320 6120  the output is a 
+00034b10: 5365 7269 6573 2077 6974 6820 6e61 6d65  Series with name
+00034b20: 2060 6027 7827 6060 2c20 616e 6420 6474   ``'x'``, and dt
+00034b30: 7970 650a 2020 2020 2020 2020 6060 666c  ype.        ``fl
+00034b40: 6f61 7436 3460 603a 0a0a 2020 2020 2020  oat64``:..      
+00034b50: 2020 3e3e 3e20 7265 7320 3d20 6464 662e    >>> res = ddf.
+00034b60: 6170 706c 7928 6d79 6164 642c 2061 7869  apply(myadd, axi
+00034b70: 733d 312c 2061 7267 733d 2832 2c29 2c20  s=1, args=(2,), 
+00034b80: 623d 312e 352c 206d 6574 613d 2827 7827  b=1.5, meta=('x'
+00034b90: 2c20 2766 3827 2929 0a0a 2020 2020 2020  , 'f8'))..      
+00034ba0: 2020 496e 2074 6865 2063 6173 6520 7768    In the case wh
+00034bb0: 6572 6520 7468 6520 6d65 7461 6461 7461  ere the metadata
+00034bc0: 2064 6f65 736e 2774 2063 6861 6e67 652c   doesn't change,
+00034bd0: 2079 6f75 2063 616e 2061 6c73 6f20 7061   you can also pa
+00034be0: 7373 2069 6e0a 2020 2020 2020 2020 7468  ss in.        th
+00034bf0: 6520 6f62 6a65 6374 2069 7473 656c 6620  e object itself 
+00034c00: 6469 7265 6374 6c79 3a0a 0a20 2020 2020  directly:..     
+00034c10: 2020 203e 3e3e 2072 6573 203d 2064 6466     >>> res = ddf
+00034c20: 2e61 7070 6c79 286c 616d 6264 6120 726f  .apply(lambda ro
+00034c30: 773a 2072 6f77 202b 2031 2c20 6178 6973  w: row + 1, axis
+00034c40: 3d31 2c20 6d65 7461 3d64 6466 290a 0a20  =1, meta=ddf).. 
+00034c50: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+00034c60: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00034c70: 0a20 2020 2020 2020 2064 6173 6b2e 4461  .        dask.Da
+00034c80: 7461 4672 616d 652e 6d61 705f 7061 7274  taFrame.map_part
+00034c90: 6974 696f 6e73 0a20 2020 2020 2020 2022  itions.        "
+00034ca0: 2222 0a0a 2020 2020 2020 2020 6966 2062  ""..        if b
+00034cb0: 726f 6164 6361 7374 2069 7320 6e6f 7420  roadcast is not 
+00034cc0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00034cd0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+00034ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034cf0: 2022 5468 6520 6062 726f 6164 6361 7374   "The `broadcast
+00034d00: 6020 6172 6775 6d65 6e74 2069 7320 6e6f  ` argument is no
+00034d10: 206c 6f6e 6765 7220 7573 6564 2f73 7570   longer used/sup
+00034d20: 706f 7274 6564 2e20 220a 2020 2020 2020  ported. ".      
+00034d30: 2020 2020 2020 2020 2020 2249 7420 7769            "It wi
+00034d40: 6c6c 2062 6520 6472 6f70 7065 6420 696e  ll be dropped in
+00034d50: 2061 2066 7574 7572 6520 7265 6c65 6173   a future releas
+00034d60: 652e 222c 0a20 2020 2020 2020 2020 2020  e.",.           
+00034d70: 2020 2020 2063 6174 6567 6f72 793d 4675       category=Fu
+00034d80: 7475 7265 5761 726e 696e 672c 0a20 2020  tureWarning,.   
+00034d90: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00034da0: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
+00034db0: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
+00034dc0: 7869 7329 0a20 2020 2020 2020 2070 616e  xis).        pan
+00034dd0: 6461 735f 6b77 6172 6773 203d 207b 2261  das_kwargs = {"a
+00034de0: 7869 7322 3a20 6178 6973 2c20 2272 6177  xis": axis, "raw
+00034df0: 223a 2072 6177 2c20 2272 6573 756c 745f  ": raw, "result_
+00034e00: 7479 7065 223a 2072 6573 756c 745f 7479  type": result_ty
+00034e10: 7065 7d0a 0a20 2020 2020 2020 206b 7764  pe}..        kwd
+00034e20: 732e 7570 6461 7465 2870 616e 6461 735f  s.update(pandas_
+00034e30: 6b77 6172 6773 290a 0a20 2020 2020 2020  kwargs)..       
+00034e40: 2069 6620 6178 6973 203d 3d20 303a 0a20   if axis == 0:. 
+00034e50: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
+00034e60: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00034e70: 2020 2022 6464 2e44 6174 6146 7261 6d65     "dd.DataFrame
+00034e80: 2e61 7070 6c79 206f 6e6c 7920 7375 7070  .apply only supp
+00034e90: 6f72 7473 2061 7869 733d 315c 6e22 0a20  orts axis=1\n". 
+00034ea0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00034eb0: 2020 5472 793a 2064 662e 6170 706c 7928    Try: df.apply(
+00034ec0: 6675 6e63 2c20 6178 6973 3d31 2922 0a20  func, axis=1)". 
+00034ed0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00034ee0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+00034ef0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00034f00: 6f72 286d 7367 290a 0a20 2020 2020 2020  or(msg)..       
+00034f10: 2069 6620 6d65 7461 2069 7320 6e6f 5f64   if meta is no_d
+00034f20: 6566 6175 6c74 3a0a 2020 2020 2020 2020  efault:.        
+00034f30: 2020 2020 6d65 7461 203d 205f 656d 756c      meta = _emul
+00034f40: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
+00034f50: 2020 2020 204d 2e61 7070 6c79 2c20 7365       M.apply, se
+00034f60: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
+00034f70: 792c 2066 756e 632c 2061 7267 733d 6172  y, func, args=ar
+00034f80: 6773 2c20 7564 663d 5472 7565 2c20 2a2a  gs, udf=True, **
+00034f90: 6b77 6473 0a20 2020 2020 2020 2020 2020  kwds.           
+00034fa0: 2029 0a20 2020 2020 2020 2020 2020 2077   ).            w
+00034fb0: 6172 6e69 6e67 732e 7761 726e 286d 6574  arnings.warn(met
+00034fc0: 615f 7761 726e 696e 6728 6d65 7461 2929  a_warning(meta))
+00034fd0: 0a20 2020 2020 2020 206b 7764 732e 7570  .        kwds.up
+00034fe0: 6461 7465 287b 2270 6172 656e 745f 6d65  date({"parent_me
+00034ff0: 7461 223a 2073 656c 662e 5f6d 6574 617d  ta": self._meta}
+00035000: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00035010: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
+00035020: 4d2e 6170 706c 792c 2073 656c 662c 2066  M.apply, self, f
+00035030: 756e 632c 2061 7267 733d 6172 6773 2c20  unc, args=args, 
+00035040: 6d65 7461 3d6d 6574 612c 202a 2a6b 7764  meta=meta, **kwd
+00035050: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
+00035060: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00035070: 6d65 290a 2020 2020 6465 6620 6170 706c  me).    def appl
+00035080: 796d 6170 2873 656c 662c 2066 756e 632c  ymap(self, func,
+00035090: 206d 6574 613d 6e6f 5f64 6566 6175 6c74   meta=no_default
+000350a0: 293a 0a20 2020 2020 2020 2023 204c 6574  ):.        # Let
+000350b0: 2070 616e 6461 7320 7261 6973 6520 6465   pandas raise de
+000350c0: 7072 6563 6174 696f 6e20 7761 726e 696e  precation warnin
+000350d0: 6773 0a20 2020 2020 2020 2073 656c 662e  gs.        self.
+000350e0: 5f6d 6574 612e 6170 706c 796d 6170 2866  _meta.applymap(f
+000350f0: 756e 6329 0a20 2020 2020 2020 2072 6574  unc).        ret
+00035100: 7572 6e20 656c 656d 7769 7365 286d 6574  urn elemwise(met
+00035110: 686f 6473 2e61 7070 6c79 6d61 702c 2073  hods.applymap, s
+00035120: 656c 662c 2066 756e 632c 206d 6574 613d  elf, func, meta=
+00035130: 6d65 7461 290a 0a20 2020 2064 6566 206d  meta)..    def m
+00035140: 6170 2873 656c 662c 2066 756e 632c 206d  ap(self, func, m
+00035150: 6574 613d 6e6f 5f64 6566 6175 6c74 2c20  eta=no_default, 
+00035160: 6e61 5f61 6374 696f 6e3d 4e6f 6e65 293a  na_action=None):
+00035170: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00035180: 5041 4e44 4153 5f47 545f 3231 303a 0a20  PANDAS_GT_210:. 
+00035190: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000351a0: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+000351b0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+000351c0: 2020 2020 2020 6622 4461 7461 4672 616d        f"DataFram
+000351d0: 652e 6d61 7020 7265 7175 6972 6573 2070  e.map requires p
+000351e0: 616e 6461 733e 3d32 2e31 2e30 2c20 6275  andas>=2.1.0, bu
+000351f0: 7420 7061 6e64 6173 3d7b 5041 4e44 4153  t pandas={PANDAS
+00035200: 5f56 4552 5349 4f4e 7d20 6973 2022 0a20  _VERSION} is ". 
+00035210: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00035220: 696e 7374 616c 6c65 642e 220a 2020 2020  installed.".    
+00035230: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00035240: 2020 7265 7475 726e 2065 6c65 6d77 6973    return elemwis
+00035250: 6528 4d2e 6d61 702c 2073 656c 662c 2066  e(M.map, self, f
+00035260: 756e 632c 206d 6574 613d 6d65 7461 2c20  unc, meta=meta, 
+00035270: 6e61 5f61 6374 696f 6e3d 6e61 5f61 6374  na_action=na_act
+00035280: 696f 6e29 0a0a 2020 2020 4064 6572 6976  ion)..    @deriv
+00035290: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+000352a0: 7261 6d65 290a 2020 2020 6465 6620 726f  rame).    def ro
+000352b0: 756e 6428 7365 6c66 2c20 6465 6369 6d61  und(self, decima
+000352c0: 6c73 3d30 293a 0a20 2020 2020 2020 2072  ls=0):.        r
+000352d0: 6574 7572 6e20 656c 656d 7769 7365 284d  eturn elemwise(M
+000352e0: 2e72 6f75 6e64 2c20 7365 6c66 2c20 6465  .round, self, de
+000352f0: 6369 6d61 6c73 290a 0a20 2020 2040 6465  cimals)..    @de
+00035300: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00035310: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+00035320: 206e 756e 6971 7565 2873 656c 662c 2073   nunique(self, s
+00035330: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+00035340: 2c20 6472 6f70 6e61 3d54 7275 652c 2061  , dropna=True, a
+00035350: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
+00035360: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
+00035370: 2020 2020 2020 2020 2020 2320 7370 6c69            # spli
+00035380: 745f 6576 6572 7920 6e6f 7420 7573 6564  t_every not used
+00035390: 2066 6f72 2061 7869 733d 310a 2020 2020   for axis=1.    
+000353a0: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
+000353b0: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
+000353c0: 7479 2e6e 756e 6971 7565 2861 7869 733d  ty.nunique(axis=
+000353d0: 6178 6973 290a 2020 2020 2020 2020 2020  axis).          
+000353e0: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
+000353f0: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
+00035400: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
+00035410: 6e75 6e69 7175 652c 0a20 2020 2020 2020  nunique,.       
+00035420: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
+00035430: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+00035440: 2020 2020 746f 6b65 6e3d 2273 6572 6965      token="serie
+00035450: 732d 6e75 6e69 7175 6522 2c0a 2020 2020  s-nunique",.    
+00035460: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+00035470: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
+00035480: 2020 2020 2020 2064 726f 706e 613d 6472         dropna=dr
+00035490: 6f70 6e61 2c0a 2020 2020 2020 2020 2020  opna,.          
+000354a0: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
+000354b0: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
+000354c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000354d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000354e0: 2020 2020 2020 6e75 6e69 7175 655f 6c69        nunique_li
+000354f0: 7374 203d 205b 0a20 2020 2020 2020 2020  st = [.         
+00035500: 2020 2020 2020 2073 656c 662e 696c 6f63         self.iloc
+00035510: 5b3a 2c20 695d 2e6e 756e 6971 7565 2873  [:, i].nunique(s
+00035520: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+00035530: 5f65 7665 7279 2c20 6472 6f70 6e61 3d64  _every, dropna=d
+00035540: 726f 706e 6129 0a20 2020 2020 2020 2020  ropna).         
+00035550: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00035560: 7261 6e67 6528 6c65 6e28 7365 6c66 2e63  range(len(self.c
+00035570: 6f6c 756d 6e73 2929 0a20 2020 2020 2020  olumns)).       
+00035580: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+00035590: 2020 206e 616d 6520 3d20 2273 6572 6965     name = "serie
+000355a0: 732d 2220 2b20 746f 6b65 6e69 7a65 282a  s-" + tokenize(*
+000355b0: 6e75 6e69 7175 655f 6c69 7374 290a 2020  nunique_list).  
+000355c0: 2020 2020 2020 2020 2020 6473 6b20 3d20            dsk = 
+000355d0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+000355e0: 2020 286e 616d 652c 2030 293a 2028 0a20    (name, 0): (. 
+000355f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035600: 2020 2061 7070 6c79 2c0a 2020 2020 2020     apply,.      
+00035610: 2020 2020 2020 2020 2020 2020 2020 7064                pd
+00035620: 2e53 6572 6965 732c 0a20 2020 2020 2020  .Series,.       
+00035630: 2020 2020 2020 2020 2020 2020 205b 5b28               [[(
+00035640: 732e 5f6e 616d 652c 2030 2920 666f 7220  s._name, 0) for 
+00035650: 7320 696e 206e 756e 6971 7565 5f6c 6973  s in nunique_lis
+00035660: 745d 5d2c 0a20 2020 2020 2020 2020 2020  t]],.           
+00035670: 2020 2020 2020 2020 207b 2269 6e64 6578           {"index
+00035680: 223a 2073 656c 662e 636f 6c75 6d6e 737d  ": self.columns}
+00035690: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000356a0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+000356b0: 7d0a 2020 2020 2020 2020 2020 2020 6772  }.            gr
+000356c0: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+000356d0: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+000356e0: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+000356f0: 2020 2020 2020 206e 616d 652c 2064 736b         name, dsk
+00035700: 2c20 6465 7065 6e64 656e 6369 6573 3d6e  , dependencies=n
+00035710: 756e 6971 7565 5f6c 6973 740a 2020 2020  unique_list.    
+00035720: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00035730: 2020 2020 2020 7265 7475 726e 2053 6572        return Ser
+00035740: 6965 7328 6772 6170 682c 206e 616d 652c  ies(graph, name,
+00035750: 2073 656c 662e 5f6d 6574 612e 6e75 6e69   self._meta.nuni
+00035760: 7175 6528 292c 2028 4e6f 6e65 2c20 4e6f  que(), (None, No
+00035770: 6e65 2929 0a0a 2020 2020 4064 6572 6976  ne))..    @deriv
+00035780: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00035790: 7261 6d65 290a 2020 2020 6465 6620 6d6f  rame).    def mo
+000357a0: 6465 2873 656c 662c 2064 726f 706e 613d  de(self, dropna=
+000357b0: 5472 7565 2c20 7370 6c69 745f 6576 6572  True, split_ever
+000357c0: 793d 4661 6c73 652c 206e 756d 6572 6963  y=False, numeric
+000357d0: 5f6f 6e6c 793d 4661 6c73 6529 3a0a 2020  _only=False):.  
+000357e0: 2020 2020 2020 6d6f 6465 5f73 6572 6965        mode_serie
+000357f0: 735f 6c69 7374 203d 205b 5d0a 2020 2020  s_list = [].    
+00035800: 2020 2020 666f 7220 636f 6c5f 696e 6465      for col_inde
+00035810: 7820 696e 2072 616e 6765 286c 656e 2873  x in range(len(s
+00035820: 656c 662e 636f 6c75 6d6e 7329 293a 0a20  elf.columns)):. 
+00035830: 2020 2020 2020 2020 2020 2063 6f6c 5f73             col_s
+00035840: 6572 6965 7320 3d20 7365 6c66 2e69 6c6f  eries = self.ilo
+00035850: 635b 3a2c 2063 6f6c 5f69 6e64 6578 5d0a  c[:, col_index].
+00035860: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00035870: 756d 6572 6963 5f6f 6e6c 7920 616e 6420  umeric_only and 
+00035880: 6e6f 7420 7064 2e61 7069 2e74 7970 6573  not pd.api.types
+00035890: 2e69 735f 6e75 6d65 7269 635f 6474 7970  .is_numeric_dtyp
+000358a0: 6528 636f 6c5f 7365 7269 6573 2e64 7479  e(col_series.dty
+000358b0: 7065 293a 0a20 2020 2020 2020 2020 2020  pe):.           
+000358c0: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
+000358d0: 2020 2020 2020 2020 2020 6d6f 6465 5f73            mode_s
+000358e0: 6572 6965 7320 3d20 5365 7269 6573 2e6d  eries = Series.m
+000358f0: 6f64 6528 0a20 2020 2020 2020 2020 2020  ode(.           
+00035900: 2020 2020 2063 6f6c 5f73 6572 6965 732c       col_series,
+00035910: 2064 726f 706e 613d 6472 6f70 6e61 2c20   dropna=dropna, 
+00035920: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+00035930: 745f 6576 6572 790a 2020 2020 2020 2020  t_every.        
+00035940: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00035950: 2020 6d6f 6465 5f73 6572 6965 735f 6c69    mode_series_li
+00035960: 7374 2e61 7070 656e 6428 6d6f 6465 5f73  st.append(mode_s
+00035970: 6572 6965 7329 0a0a 2020 2020 2020 2020  eries)..        
+00035980: 6e61 6d65 203d 2022 636f 6e63 6174 2d22  name = "concat-"
+00035990: 202b 2074 6f6b 656e 697a 6528 2a6d 6f64   + tokenize(*mod
+000359a0: 655f 7365 7269 6573 5f6c 6973 7429 0a0a  e_series_list)..
+000359b0: 2020 2020 2020 2020 6473 6b20 3d20 7b0a          dsk = {.
+000359c0: 2020 2020 2020 2020 2020 2020 286e 616d              (nam
+000359d0: 652c 2030 293a 2028 0a20 2020 2020 2020  e, 0): (.       
+000359e0: 2020 2020 2020 2020 2061 7070 6c79 2c0a           apply,.
+000359f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035a00: 6d65 7468 6f64 732e 636f 6e63 6174 2c0a  methods.concat,.
+00035a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035a20: 5b5b 2864 662e 5f6e 616d 652c 2030 2920  [[(df._name, 0) 
+00035a30: 666f 7220 6466 2069 6e20 6d6f 6465 5f73  for df in mode_s
+00035a40: 6572 6965 735f 6c69 7374 5d5d 2c0a 2020  eries_list]],.  
+00035a50: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+00035a60: 6178 6973 223a 2031 7d2c 0a20 2020 2020  axis": 1},.     
+00035a70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00035a80: 207d 0a0a 2020 2020 2020 2020 6d65 7461   }..        meta
+00035a90: 203d 206d 6574 686f 6473 2e63 6f6e 6361   = methods.conca
+00035aa0: 7428 5b64 662e 5f6d 6574 6120 666f 7220  t([df._meta for 
+00035ab0: 6466 2069 6e20 6d6f 6465 5f73 6572 6965  df in mode_serie
+00035ac0: 735f 6c69 7374 5d2c 2061 7869 733d 3129  s_list], axis=1)
+00035ad0: 0a20 2020 2020 2020 2067 7261 7068 203d  .        graph =
+00035ae0: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
+00035af0: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
+00035b00: 280a 2020 2020 2020 2020 2020 2020 6e61  (.            na
+00035b10: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
+00035b20: 6e63 6965 733d 6d6f 6465 5f73 6572 6965  ncies=mode_serie
+00035b30: 735f 6c69 7374 0a20 2020 2020 2020 2029  s_list.        )
+00035b40: 0a20 2020 2020 2020 2064 6466 203d 206e  .        ddf = n
+00035b50: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
+00035b60: 7068 2c20 6e61 6d65 2c20 6d65 7461 2c20  ph, name, meta, 
+00035b70: 6469 7669 7369 6f6e 733d 284e 6f6e 652c  divisions=(None,
+00035b80: 204e 6f6e 6529 290a 0a20 2020 2020 2020   None))..       
+00035b90: 2072 6574 7572 6e20 6464 660a 0a20 2020   return ddf..   
+00035ba0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00035bb0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00035bc0: 2064 6566 2063 6f76 2873 656c 662c 206d   def cov(self, m
+00035bd0: 696e 5f70 6572 696f 6473 3d4e 6f6e 652c  in_periods=None,
+00035be0: 206e 756d 6572 6963 5f6f 6e6c 793d 6e6f   numeric_only=no
+00035bf0: 5f64 6566 6175 6c74 2c20 7370 6c69 745f  _default, split_
+00035c00: 6576 6572 793d 4661 6c73 6529 3a0a 2020  every=False):.  
+00035c10: 2020 2020 2020 7265 7475 726e 205f 636f        return _co
+00035c20: 765f 636f 7272 280a 2020 2020 2020 2020  v_corr(.        
+00035c30: 2020 2020 7365 6c66 2c20 6d69 6e5f 7065      self, min_pe
+00035c40: 7269 6f64 732c 206e 756d 6572 6963 5f6f  riods, numeric_o
+00035c50: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
+00035c60: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
+00035c70: 6c69 745f 6576 6572 790a 2020 2020 2020  lit_every.      
+00035c80: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
+00035c90: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00035ca0: 616d 6529 0a20 2020 2064 6566 2063 6f72  ame).    def cor
+00035cb0: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
+00035cc0: 0a20 2020 2020 2020 206d 6574 686f 643d  .        method=
+00035cd0: 2270 6561 7273 6f6e 222c 0a20 2020 2020  "pearson",.     
+00035ce0: 2020 206d 696e 5f70 6572 696f 6473 3d4e     min_periods=N
+00035cf0: 6f6e 652c 0a20 2020 2020 2020 206e 756d  one,.        num
+00035d00: 6572 6963 5f6f 6e6c 793d 6e6f 5f64 6566  eric_only=no_def
+00035d10: 6175 6c74 2c0a 2020 2020 2020 2020 7370  ault,.        sp
+00035d20: 6c69 745f 6576 6572 793d 4661 6c73 652c  lit_every=False,
+00035d30: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00035d40: 6966 206d 6574 686f 6420 213d 2022 7065  if method != "pe
+00035d50: 6172 736f 6e22 3a0a 2020 2020 2020 2020  arson":.        
+00035d60: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+00035d70: 6c65 6d65 6e74 6564 4572 726f 7228 224f  lementedError("O
+00035d80: 6e6c 7920 5065 6172 736f 6e20 636f 7272  nly Pearson corr
+00035d90: 656c 6174 696f 6e20 6861 7320 6265 656e  elation has been
+00035da0: 2069 6d70 6c65 6d65 6e74 6564 2229 0a0a   implemented")..
+00035db0: 2020 2020 2020 2020 7265 7475 726e 205f          return _
+00035dc0: 636f 765f 636f 7272 280a 2020 2020 2020  cov_corr(.      
+00035dd0: 2020 2020 2020 7365 6c66 2c20 6d69 6e5f        self, min_
+00035de0: 7065 7269 6f64 732c 2054 7275 652c 206e  periods, True, n
+00035df0: 756d 6572 6963 5f6f 6e6c 793d 6e75 6d65  umeric_only=nume
+00035e00: 7269 635f 6f6e 6c79 2c20 7370 6c69 745f  ric_only, split_
+00035e10: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00035e20: 790a 2020 2020 2020 2020 290a 0a20 2020  y.        )..   
+00035e30: 2064 6566 2069 6e66 6f28 7365 6c66 2c20   def info(self, 
+00035e40: 6275 663d 4e6f 6e65 2c20 7665 7262 6f73  buf=None, verbos
+00035e50: 653d 4661 6c73 652c 206d 656d 6f72 795f  e=False, memory_
+00035e60: 7573 6167 653d 4661 6c73 6529 3a0a 2020  usage=False):.  
+00035e70: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00035e80: 2020 436f 6e63 6973 6520 7375 6d6d 6172    Concise summar
+00035e90: 7920 6f66 2061 2044 6173 6b20 4461 7461  y of a Dask Data
+00035ea0: 4672 616d 652e 0a20 2020 2020 2020 2022  Frame..        "
+00035eb0: 2222 0a0a 2020 2020 2020 2020 6966 2062  ""..        if b
+00035ec0: 7566 2069 7320 4e6f 6e65 3a0a 2020 2020  uf is None:.    
+00035ed0: 2020 2020 2020 2020 696d 706f 7274 2073          import s
+00035ee0: 7973 0a0a 2020 2020 2020 2020 2020 2020  ys..            
+00035ef0: 6275 6620 3d20 7379 732e 7374 646f 7574  buf = sys.stdout
+00035f00: 0a0a 2020 2020 2020 2020 6c69 6e65 7320  ..        lines 
+00035f10: 3d20 5b73 7472 2874 7970 6528 7365 6c66  = [str(type(self
+00035f20: 2929 5d0a 0a20 2020 2020 2020 2069 6620  ))]..        if 
+00035f30: 6c65 6e28 7365 6c66 2e63 6f6c 756d 6e73  len(self.columns
+00035f40: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
+00035f50: 2020 2020 6c69 6e65 732e 6170 7065 6e64      lines.append
+00035f60: 2866 227b 7479 7065 2873 656c 662e 696e  (f"{type(self.in
+00035f70: 6465 782e 5f6d 6574 6129 2e5f 5f6e 616d  dex._meta).__nam
+00035f80: 655f 5f7d 3a20 3020 656e 7472 6965 7322  e__}: 0 entries"
+00035f90: 290a 2020 2020 2020 2020 2020 2020 6c69  ).            li
+00035fa0: 6e65 732e 6170 7065 6e64 2866 2245 6d70  nes.append(f"Emp
+00035fb0: 7479 207b 7479 7065 2873 656c 6629 2e5f  ty {type(self)._
+00035fc0: 5f6e 616d 655f 5f7d 2229 0a20 2020 2020  _name__}").     
+00035fd0: 2020 2020 2020 2069 6620 5041 4e44 4153         if PANDAS
+00035fe0: 5f47 545f 3135 303a 0a20 2020 2020 2020  _GT_150:.       
+00035ff0: 2020 2020 2020 2020 2023 2070 616e 6461           # panda
+00036000: 7320 6461 7461 6672 616d 6520 7374 6172  s dataframe star
+00036010: 7465 6420 6164 6469 6e67 2061 206e 6577  ted adding a new
+00036020: 6c69 6e65 2077 6865 6e20 696e 666f 2069  line when info i
+00036030: 7320 6361 6c6c 6564 2e0a 2020 2020 2020  s called..      
+00036040: 2020 2020 2020 2020 2020 6c69 6e65 732e            lines.
+00036050: 6170 7065 6e64 2822 2229 0a20 2020 2020  append("").     
+00036060: 2020 2020 2020 2070 7574 5f6c 696e 6573         put_lines
+00036070: 2862 7566 2c20 6c69 6e65 7329 0a20 2020  (buf, lines).   
+00036080: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+00036090: 0a20 2020 2020 2020 2023 2047 726f 7570  .        # Group
+000360a0: 2061 6e64 2065 7865 6375 7465 2074 6865   and execute the
+000360b0: 2072 6571 7569 7265 6420 636f 6d70 7574   required comput
+000360c0: 6174 696f 6e73 0a20 2020 2020 2020 2063  ations.        c
+000360d0: 6f6d 7075 7461 7469 6f6e 7320 3d20 7b7d  omputations = {}
+000360e0: 0a20 2020 2020 2020 2069 6620 7665 7262  .        if verb
+000360f0: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
+00036100: 206d 656d 6f72 795f 7573 6167 6520 3d20   memory_usage = 
+00036110: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00036120: 2063 6f6d 7075 7461 7469 6f6e 732e 7570   computations.up
+00036130: 6461 7465 287b 2269 6e64 6578 223a 2073  date({"index": s
+00036140: 656c 662e 696e 6465 782c 2022 636f 756e  elf.index, "coun
+00036150: 7422 3a20 7365 6c66 2e63 6f75 6e74 2829  t": self.count()
+00036160: 7d29 0a20 2020 2020 2020 2069 6620 6d65  }).        if me
+00036170: 6d6f 7279 5f75 7361 6765 3a0a 2020 2020  mory_usage:.    
+00036180: 2020 2020 2020 2020 636f 6d70 7574 6174          computat
+00036190: 696f 6e73 2e75 7064 6174 6528 0a20 2020  ions.update(.   
+000361a0: 2020 2020 2020 2020 2020 2020 207b 226d               {"m
+000361b0: 656d 6f72 795f 7573 6167 6522 3a20 7365  emory_usage": se
+000361c0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+000361d0: 7328 4d2e 6d65 6d6f 7279 5f75 7361 6765  s(M.memory_usage
+000361e0: 2c20 696e 6465 783d 5472 7565 297d 0a20  , index=True)}. 
+000361f0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00036200: 2020 2020 2063 6f6d 7075 7461 7469 6f6e       computation
+00036210: 7320 3d20 6469 6374 280a 2020 2020 2020  s = dict(.      
+00036220: 2020 2020 2020 7a69 7028 636f 6d70 7574        zip(comput
+00036230: 6174 696f 6e73 2e6b 6579 7328 292c 2064  ations.keys(), d
+00036240: 612e 636f 6d70 7574 6528 2a63 6f6d 7075  a.compute(*compu
+00036250: 7461 7469 6f6e 732e 7661 6c75 6573 2829  tations.values()
+00036260: 2929 0a20 2020 2020 2020 2029 0a0a 2020  )).        )..  
+00036270: 2020 2020 2020 6966 2076 6572 626f 7365        if verbose
+00036280: 3a0a 2020 2020 2020 2020 2020 2020 696d  :.            im
+00036290: 706f 7274 2074 6578 7477 7261 700a 0a20  port textwrap.. 
+000362a0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+000362b0: 203d 2063 6f6d 7075 7461 7469 6f6e 735b   = computations[
+000362c0: 2269 6e64 6578 225d 0a20 2020 2020 2020  "index"].       
+000362d0: 2020 2020 2063 6f75 6e74 7320 3d20 636f       counts = co
+000362e0: 6d70 7574 6174 696f 6e73 5b22 636f 756e  mputations["coun
+000362f0: 7422 5d0a 2020 2020 2020 2020 2020 2020  t"].            
+00036300: 6c69 6e65 732e 6170 7065 6e64 2869 6e64  lines.append(ind
+00036310: 6578 5f73 756d 6d61 7279 2869 6e64 6578  ex_summary(index
+00036320: 2929 0a20 2020 2020 2020 2020 2020 206c  )).            l
+00036330: 696e 6573 2e61 7070 656e 6428 6622 4461  ines.append(f"Da
+00036340: 7461 2063 6f6c 756d 6e73 2028 746f 7461  ta columns (tota
+00036350: 6c20 7b6c 656e 2873 656c 662e 636f 6c75  l {len(self.colu
+00036360: 6d6e 7329 7d20 636f 6c75 6d6e 7329 3a22  mns)} columns):"
+00036370: 290a 0a20 2020 2020 2020 2020 2020 2066  )..            f
+00036380: 726f 6d20 7061 6e64 6173 2e69 6f2e 666f  rom pandas.io.fo
+00036390: 726d 6174 732e 7072 696e 7469 6e67 2069  rmats.printing i
+000363a0: 6d70 6f72 7420 7070 7269 6e74 5f74 6869  mport pprint_thi
+000363b0: 6e67 0a0a 2020 2020 2020 2020 2020 2020  ng..            
+000363c0: 7370 6163 6520 3d20 6d61 7828 6c65 6e28  space = max(len(
+000363d0: 7070 7269 6e74 5f74 6869 6e67 286b 2929  pprint_thing(k))
+000363e0: 2066 6f72 206b 2069 6e20 7365 6c66 2e63   for k in self.c
+000363f0: 6f6c 756d 6e73 2920 2b20 310a 2020 2020  olumns) + 1.    
+00036400: 2020 2020 2020 2020 636f 6c75 6d6e 5f77          column_w
+00036410: 6964 7468 203d 206d 6178 2873 7061 6365  idth = max(space
+00036420: 2c20 3729 0a0a 2020 2020 2020 2020 2020  , 7)..          
+00036430: 2020 6865 6164 6572 203d 2028 0a20 2020    header = (.   
+00036440: 2020 2020 2020 2020 2020 2020 2074 6578               tex
+00036450: 7477 7261 702e 6465 6465 6e74 280a 2020  twrap.dedent(.  
+00036460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036470: 2020 2222 225c 0a20 2020 2020 2020 2020    """\.         
+00036480: 2020 2020 2320 2020 7b7b 636f 6c75 6d6e      #   {{column
+00036490: 3a3c 7b63 6f6c 756d 6e5f 7769 6474 687d  :<{column_width}
+000364a0: 7d7d 204e 6f6e 2d4e 756c 6c20 436f 756e  }} Non-Null Coun
+000364b0: 7420 2044 7479 7065 0a20 2020 2020 2020  t  Dtype.       
+000364c0: 2020 2020 202d 2d2d 2020 7b7b 756e 6465       ---  {{unde
+000364d0: 726c 3a3c 7b63 6f6c 756d 6e5f 7769 6474  rl:<{column_widt
+000364e0: 687d 7d7d 202d 2d2d 2d2d 2d2d 2d2d 2d2d  h}}} -----------
+000364f0: 2d2d 2d20 202d 2d2d 2d2d 2222 220a 2020  ---  -----""".  
+00036500: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00036510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036520: 2e66 6f72 6d61 7428 636f 6c75 6d6e 5f77  .format(column_w
+00036530: 6964 7468 3d63 6f6c 756d 6e5f 7769 6474  idth=column_widt
+00036540: 6829 0a20 2020 2020 2020 2020 2020 2020  h).             
+00036550: 2020 202e 666f 726d 6174 2863 6f6c 756d     .format(colum
+00036560: 6e3d 2243 6f6c 756d 6e22 2c20 756e 6465  n="Column", unde
+00036570: 726c 3d22 2d2d 2d2d 2d2d 2229 0a20 2020  rl="------").   
+00036580: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00036590: 2020 2020 2020 2063 6f6c 756d 6e5f 7465         column_te
+000365a0: 6d70 6c61 7465 203d 2074 6578 7477 7261  mplate = textwra
+000365b0: 702e 6465 6465 6e74 280a 2020 2020 2020  p.dedent(.      
+000365c0: 2020 2020 2020 2020 2020 2222 225c 0a20            """\. 
+000365d0: 2020 2020 2020 2020 2020 207b 7b69 3a5e             {{i:^
+000365e0: 337d 7d20 207b 7b6e 616d 653a 3c7b 636f  3}}  {{name:<{co
+000365f0: 6c75 6d6e 5f77 6964 7468 7d7d 7d20 7b7b  lumn_width}}} {{
+00036600: 636f 756e 747d 7d20 6e6f 6e2d 6e75 6c6c  count}} non-null
+00036610: 2020 2020 2020 7b7b 6474 7970 657d 7d22        {{dtype}}"
+00036620: 2222 2e66 6f72 6d61 7428 0a20 2020 2020  "".format(.     
+00036630: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00036640: 6f6c 756d 6e5f 7769 6474 683d 636f 6c75  olumn_width=colu
+00036650: 6d6e 5f77 6964 7468 0a20 2020 2020 2020  mn_width.       
+00036660: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00036670: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00036680: 2020 2020 2063 6f6c 756d 6e5f 696e 666f       column_info
+00036690: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+000366a0: 2020 2020 2063 6f6c 756d 6e5f 7465 6d70       column_temp
+000366b0: 6c61 7465 2e66 6f72 6d61 7428 0a20 2020  late.format(.   
+000366c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000366d0: 2069 3d70 7072 696e 745f 7468 696e 6728   i=pprint_thing(
+000366e0: 6929 2c0a 2020 2020 2020 2020 2020 2020  i),.            
+000366f0: 2020 2020 2020 2020 6e61 6d65 3d70 7072          name=ppr
+00036700: 696e 745f 7468 696e 6728 6e61 6d65 292c  int_thing(name),
+00036710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036720: 2020 2020 2063 6f75 6e74 3d70 7072 696e       count=pprin
+00036730: 745f 7468 696e 6728 636f 756e 7429 2c0a  t_thing(count),.
+00036740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036750: 2020 2020 6474 7970 653d 7070 7269 6e74      dtype=pprint
+00036760: 5f74 6869 6e67 2864 7479 7065 292c 0a20  _thing(dtype),. 
+00036770: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00036780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036790: 2066 6f72 2069 2c20 286e 616d 652c 2063   for i, (name, c
+000367a0: 6f75 6e74 2c20 6474 7970 6529 2069 6e20  ount, dtype) in 
+000367b0: 656e 756d 6572 6174 6528 0a20 2020 2020  enumerate(.     
+000367c0: 2020 2020 2020 2020 2020 2020 2020 207a                 z
+000367d0: 6970 2873 656c 662e 636f 6c75 6d6e 732c  ip(self.columns,
+000367e0: 2063 6f75 6e74 732c 2073 656c 662e 6474   counts, self.dt
+000367f0: 7970 6573 290a 2020 2020 2020 2020 2020  ypes).          
+00036800: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00036810: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
+00036820: 2020 6c69 6e65 732e 6578 7465 6e64 2868    lines.extend(h
+00036830: 6561 6465 722e 7370 6c69 7428 225c 6e22  eader.split("\n"
+00036840: 2929 0a20 2020 2020 2020 2065 6c73 653a  )).        else:
+00036850: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00036860: 756d 6e5f 696e 666f 203d 205b 696e 6465  umn_info = [inde
+00036870: 785f 7375 6d6d 6172 7928 7365 6c66 2e63  x_summary(self.c
+00036880: 6f6c 756d 6e73 2c20 6e61 6d65 3d22 436f  olumns, name="Co
+00036890: 6c75 6d6e 7322 295d 0a0a 2020 2020 2020  lumns")]..      
+000368a0: 2020 6c69 6e65 732e 6578 7465 6e64 2863    lines.extend(c
+000368b0: 6f6c 756d 6e5f 696e 666f 290a 2020 2020  olumn_info).    
+000368c0: 2020 2020 6474 7970 655f 636f 756e 7473      dtype_counts
+000368d0: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+000368e0: 2022 2573 2825 6429 2220 2520 6b20 666f   "%s(%d)" % k fo
+000368f0: 7220 6b20 696e 2073 6f72 7465 6428 7365  r k in sorted(se
+00036900: 6c66 2e64 7479 7065 732e 7661 6c75 655f  lf.dtypes.value_
+00036910: 636f 756e 7473 2829 2e69 7465 6d73 2829  counts().items()
+00036920: 2c20 6b65 793d 7374 7229 0a20 2020 2020  , key=str).     
+00036930: 2020 205d 0a20 2020 2020 2020 206c 696e     ].        lin
+00036940: 6573 2e61 7070 656e 6428 2264 7479 7065  es.append("dtype
+00036950: 733a 207b 7d22 2e66 6f72 6d61 7428 222c  s: {}".format(",
+00036960: 2022 2e6a 6f69 6e28 6474 7970 655f 636f   ".join(dtype_co
+00036970: 756e 7473 2929 290a 0a20 2020 2020 2020  unts)))..       
+00036980: 2069 6620 6d65 6d6f 7279 5f75 7361 6765   if memory_usage
+00036990: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
+000369a0: 6d6f 7279 5f69 6e74 203d 2063 6f6d 7075  mory_int = compu
+000369b0: 7461 7469 6f6e 735b 226d 656d 6f72 795f  tations["memory_
+000369c0: 7573 6167 6522 5d2e 7375 6d28 290a 2020  usage"].sum().  
+000369d0: 2020 2020 2020 2020 2020 6c69 6e65 732e            lines.
+000369e0: 6170 7065 6e64 2866 226d 656d 6f72 7920  append(f"memory 
+000369f0: 7573 6167 653a 207b 6d65 6d6f 7279 5f72  usage: {memory_r
+00036a00: 6570 7228 6d65 6d6f 7279 5f69 6e74 297d  epr(memory_int)}
+00036a10: 5c6e 2229 0a0a 2020 2020 2020 2020 7075  \n")..        pu
+00036a20: 745f 6c69 6e65 7328 6275 662c 206c 696e  t_lines(buf, lin
+00036a30: 6573 290a 0a20 2020 2040 6465 7269 7665  es)..    @derive
+00036a40: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00036a50: 616d 6529 0a20 2020 2064 6566 206d 656d  ame).    def mem
+00036a60: 6f72 795f 7573 6167 6528 7365 6c66 2c20  ory_usage(self, 
+00036a70: 696e 6465 783d 5472 7565 2c20 6465 6570  index=True, deep
+00036a80: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
+00036a90: 2072 6573 756c 7420 3d20 7365 6c66 2e6d   result = self.m
+00036aa0: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
+00036ab0: 6d65 6d6f 7279 5f75 7361 6765 2c20 696e  memory_usage, in
+00036ac0: 6465 783d 696e 6465 782c 2064 6565 703d  dex=index, deep=
+00036ad0: 6465 6570 290a 2020 2020 2020 2020 7265  deep).        re
+00036ae0: 7375 6c74 203d 2072 6573 756c 742e 6772  sult = result.gr
+00036af0: 6f75 7062 7928 7265 7375 6c74 2e69 6e64  oupby(result.ind
+00036b00: 6578 292e 7375 6d28 290a 2020 2020 2020  ex).sum().      
+00036b10: 2020 7265 7475 726e 2072 6573 756c 740a    return result.
+00036b20: 0a20 2020 2064 6566 2070 6976 6f74 5f74  .    def pivot_t
+00036b30: 6162 6c65 2873 656c 662c 2069 6e64 6578  able(self, index
+00036b40: 3d4e 6f6e 652c 2063 6f6c 756d 6e73 3d4e  =None, columns=N
+00036b50: 6f6e 652c 2076 616c 7565 733d 4e6f 6e65  one, values=None
+00036b60: 2c20 6167 6766 756e 633d 226d 6561 6e22  , aggfunc="mean"
+00036b70: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00036b80: 2020 2020 2020 2043 7265 6174 6520 6120         Create a 
+00036b90: 7370 7265 6164 7368 6565 742d 7374 796c  spreadsheet-styl
+00036ba0: 6520 7069 766f 7420 7461 626c 6520 6173  e pivot table as
+00036bb0: 2061 2044 6174 6146 7261 6d65 2e20 5461   a DataFrame. Ta
+00036bc0: 7267 6574 2060 6063 6f6c 756d 6e73 6060  rget ``columns``
+00036bd0: 0a20 2020 2020 2020 206d 7573 7420 6861  .        must ha
+00036be0: 7665 2063 6174 6567 6f72 7920 6474 7970  ve category dtyp
+00036bf0: 6520 746f 2069 6e66 6572 2072 6573 756c  e to infer resul
+00036c00: 7427 7320 6060 636f 6c75 6d6e 7360 602e  t's ``columns``.
+00036c10: 0a20 2020 2020 2020 2060 6069 6e64 6578  .        ``index
+00036c20: 6060 2c20 6060 636f 6c75 6d6e 7360 602c  ``, ``columns``,
+00036c30: 2060 6076 616c 7565 7360 6020 616e 6420   ``values`` and 
+00036c40: 6060 6167 6766 756e 6360 6020 6d75 7374  ``aggfunc`` must
+00036c50: 2062 6520 616c 6c20 7363 616c 6172 2e0a   be all scalar..
+00036c60: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00036c70: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00036c80: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2076  ------.        v
+00036c90: 616c 7565 7320 3a20 7363 616c 6172 0a20  alues : scalar. 
+00036ca0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+00036cb0: 6e20 746f 2061 6767 7265 6761 7465 0a20  n to aggregate. 
+00036cc0: 2020 2020 2020 2069 6e64 6578 203a 2073         index : s
+00036cd0: 6361 6c61 720a 2020 2020 2020 2020 2020  calar.          
+00036ce0: 2020 636f 6c75 6d6e 2074 6f20 6265 2069    column to be i
+00036cf0: 6e64 6578 0a20 2020 2020 2020 2063 6f6c  ndex.        col
+00036d00: 756d 6e73 203a 2073 6361 6c61 720a 2020  umns : scalar.  
+00036d10: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+00036d20: 2074 6f20 6265 2063 6f6c 756d 6e73 0a20   to be columns. 
+00036d30: 2020 2020 2020 2061 6767 6675 6e63 203a         aggfunc :
+00036d40: 207b 276d 6561 6e27 2c20 2773 756d 272c   {'mean', 'sum',
+00036d50: 2027 636f 756e 7427 7d2c 2064 6566 6175   'count'}, defau
+00036d60: 6c74 2027 6d65 616e 270a 0a20 2020 2020  lt 'mean'..     
+00036d70: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+00036d80: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+00036d90: 2020 2074 6162 6c65 203a 2044 6174 6146     table : DataF
+00036da0: 7261 6d65 0a20 2020 2020 2020 2022 2222  rame.        """
+00036db0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+00036dc0: 736b 2e64 6174 6166 7261 6d65 2e72 6573  sk.dataframe.res
+00036dd0: 6861 7065 2069 6d70 6f72 7420 7069 766f  hape import pivo
+00036de0: 745f 7461 626c 650a 0a20 2020 2020 2020  t_table..       
+00036df0: 2072 6574 7572 6e20 7069 766f 745f 7461   return pivot_ta
+00036e00: 626c 6528 0a20 2020 2020 2020 2020 2020  ble(.           
+00036e10: 2073 656c 662c 2069 6e64 6578 3d69 6e64   self, index=ind
+00036e20: 6578 2c20 636f 6c75 6d6e 733d 636f 6c75  ex, columns=colu
+00036e30: 6d6e 732c 2076 616c 7565 733d 7661 6c75  mns, values=valu
+00036e40: 6573 2c20 6167 6766 756e 633d 6167 6766  es, aggfunc=aggf
+00036e50: 756e 630a 2020 2020 2020 2020 290a 0a20  unc.        ).. 
+00036e60: 2020 2064 6566 206d 656c 7428 0a20 2020     def melt(.   
+00036e70: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00036e80: 2020 2069 645f 7661 7273 3d4e 6f6e 652c     id_vars=None,
+00036e90: 0a20 2020 2020 2020 2076 616c 7565 5f76  .        value_v
+00036ea0: 6172 733d 4e6f 6e65 2c0a 2020 2020 2020  ars=None,.      
+00036eb0: 2020 7661 725f 6e61 6d65 3d4e 6f6e 652c    var_name=None,
+00036ec0: 0a20 2020 2020 2020 2076 616c 7565 5f6e  .        value_n
+00036ed0: 616d 653d 2276 616c 7565 222c 0a20 2020  ame="value",.   
+00036ee0: 2020 2020 2063 6f6c 5f6c 6576 656c 3d4e       col_level=N
+00036ef0: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
+00036f00: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00036f10: 556e 7069 766f 7473 2061 2044 6174 6146  Unpivots a DataF
+00036f20: 7261 6d65 2066 726f 6d20 7769 6465 2066  rame from wide f
+00036f30: 6f72 6d61 7420 746f 206c 6f6e 6720 666f  ormat to long fo
+00036f40: 726d 6174 2c0a 2020 2020 2020 2020 6f70  rmat,.        op
+00036f50: 7469 6f6e 616c 6c79 206c 6561 7669 6e67  tionally leaving
+00036f60: 2069 6465 6e74 6966 6965 7220 7661 7269   identifier vari
+00036f70: 6162 6c65 7320 7365 742e 0a0a 2020 2020  ables set...    
+00036f80: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
+00036f90: 6e20 6973 2075 7365 6675 6c20 746f 206d  n is useful to m
+00036fa0: 6173 7361 6765 2061 2044 6174 6146 7261  assage a DataFra
+00036fb0: 6d65 2069 6e74 6f20 6120 666f 726d 6174  me into a format
+00036fc0: 2077 6865 7265 0a20 2020 2020 2020 206f   where.        o
+00036fd0: 6e65 206f 7220 6d6f 7265 2063 6f6c 756d  ne or more colum
+00036fe0: 6e73 2061 7265 2069 6465 6e74 6966 6965  ns are identifie
+00036ff0: 7220 7661 7269 6162 6c65 7320 2860 6069  r variables (``i
+00037000: 645f 7661 7273 6060 292c 2077 6869 6c65  d_vars``), while
+00037010: 0a20 2020 2020 2020 2061 6c6c 206f 7468  .        all oth
+00037020: 6572 2063 6f6c 756d 6e73 2c20 636f 6e73  er columns, cons
+00037030: 6964 6572 6564 206d 6561 7375 7265 6420  idered measured 
+00037040: 7661 7269 6162 6c65 7320 2860 6076 616c  variables (``val
+00037050: 7565 5f76 6172 7360 6029 2c0a 2020 2020  ue_vars``),.    
+00037060: 2020 2020 6172 6520 2275 6e70 6976 6f74      are "unpivot
+00037070: 6564 2220 746f 2074 6865 2072 6f77 2061  ed" to the row a
+00037080: 7869 732c 206c 6561 7669 6e67 206a 7573  xis, leaving jus
+00037090: 7420 7477 6f20 6e6f 6e2d 6964 656e 7469  t two non-identi
+000370a0: 6669 6572 0a20 2020 2020 2020 2063 6f6c  fier.        col
+000370b0: 756d 6e73 2c20 2776 6172 6961 626c 6527  umns, 'variable'
+000370c0: 2061 6e64 2027 7661 6c75 6527 2e0a 0a20   and 'value'... 
+000370d0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+000370e0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+000370f0: 2d2d 2d2d 0a20 2020 2020 2020 2066 7261  ----.        fra
+00037100: 6d65 203a 2044 6174 6146 7261 6d65 0a20  me : DataFrame. 
+00037110: 2020 2020 2020 2069 645f 7661 7273 203a         id_vars :
+00037120: 2074 7570 6c65 2c20 6c69 7374 2c20 6f72   tuple, list, or
+00037130: 206e 6461 7272 6179 2c20 6f70 7469 6f6e   ndarray, option
+00037140: 616c 0a20 2020 2020 2020 2020 2020 2043  al.            C
+00037150: 6f6c 756d 6e28 7329 2074 6f20 7573 6520  olumn(s) to use 
+00037160: 6173 2069 6465 6e74 6966 6965 7220 7661  as identifier va
+00037170: 7269 6162 6c65 732e 0a20 2020 2020 2020  riables..       
+00037180: 2076 616c 7565 5f76 6172 7320 3a20 7475   value_vars : tu
+00037190: 706c 652c 206c 6973 742c 206f 7220 6e64  ple, list, or nd
+000371a0: 6172 7261 792c 206f 7074 696f 6e61 6c0a  array, optional.
+000371b0: 2020 2020 2020 2020 2020 2020 436f 6c75              Colu
+000371c0: 6d6e 2873 2920 746f 2075 6e70 6976 6f74  mn(s) to unpivot
+000371d0: 2e20 4966 206e 6f74 2073 7065 6369 6669  . If not specifi
+000371e0: 6564 2c20 7573 6573 2061 6c6c 2063 6f6c  ed, uses all col
+000371f0: 756d 6e73 2074 6861 740a 2020 2020 2020  umns that.      
+00037200: 2020 2020 2020 6172 6520 6e6f 7420 7365        are not se
+00037210: 7420 6173 2060 6964 5f76 6172 7360 2e0a  t as `id_vars`..
+00037220: 2020 2020 2020 2020 7661 725f 6e61 6d65          var_name
+00037230: 203a 2073 6361 6c61 720a 2020 2020 2020   : scalar.      
+00037240: 2020 2020 2020 4e61 6d65 2074 6f20 7573        Name to us
+00037250: 6520 666f 7220 7468 6520 2776 6172 6961  e for the 'varia
+00037260: 626c 6527 2063 6f6c 756d 6e2e 2049 6620  ble' column. If 
+00037270: 4e6f 6e65 2069 7420 7573 6573 0a20 2020  None it uses.   
+00037280: 2020 2020 2020 2020 2060 6066 7261 6d65           ``frame
+00037290: 2e63 6f6c 756d 6e73 2e6e 616d 6560 6020  .columns.name`` 
+000372a0: 6f72 2027 7661 7269 6162 6c65 272e 0a20  or 'variable'.. 
+000372b0: 2020 2020 2020 2076 616c 7565 5f6e 616d         value_nam
+000372c0: 6520 3a20 7363 616c 6172 2c20 6465 6661  e : scalar, defa
+000372d0: 756c 7420 2776 616c 7565 270a 2020 2020  ult 'value'.    
+000372e0: 2020 2020 2020 2020 4e61 6d65 2074 6f20          Name to 
+000372f0: 7573 6520 666f 7220 7468 6520 2776 616c  use for the 'val
+00037300: 7565 2720 636f 6c75 6d6e 2e0a 2020 2020  ue' column..    
+00037310: 2020 2020 636f 6c5f 6c65 7665 6c20 3a20      col_level : 
+00037320: 696e 7420 6f72 2073 7472 696e 672c 206f  int or string, o
+00037330: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00037340: 2020 2020 4966 2063 6f6c 756d 6e73 2061      If columns a
+00037350: 7265 2061 204d 756c 7469 496e 6465 7820  re a MultiIndex 
+00037360: 7468 656e 2075 7365 2074 6869 7320 6c65  then use this le
+00037370: 7665 6c20 746f 206d 656c 742e 0a0a 2020  vel to melt...  
+00037380: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00037390: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+000373a0: 2020 2020 2020 4461 7461 4672 616d 650a        DataFrame.
+000373b0: 2020 2020 2020 2020 2020 2020 556e 7069              Unpi
+000373c0: 766f 7465 6420 4461 7461 4672 616d 652e  voted DataFrame.
+000373d0: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+000373e0: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+000373f0: 2d2d 2d0a 2020 2020 2020 2020 7061 6e64  ---.        pand
+00037400: 6173 2e44 6174 6146 7261 6d65 2e6d 656c  as.DataFrame.mel
+00037410: 740a 2020 2020 2020 2020 2222 220a 2020  t.        """.  
+00037420: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+00037430: 6461 7461 6672 616d 652e 7265 7368 6170  dataframe.reshap
+00037440: 6520 696d 706f 7274 206d 656c 740a 0a20  e import melt.. 
+00037450: 2020 2020 2020 2072 6574 7572 6e20 6d65         return me
+00037460: 6c74 280a 2020 2020 2020 2020 2020 2020  lt(.            
+00037470: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+00037480: 2020 6964 5f76 6172 733d 6964 5f76 6172    id_vars=id_var
+00037490: 732c 0a20 2020 2020 2020 2020 2020 2076  s,.            v
+000374a0: 616c 7565 5f76 6172 733d 7661 6c75 655f  alue_vars=value_
+000374b0: 7661 7273 2c0a 2020 2020 2020 2020 2020  vars,.          
+000374c0: 2020 7661 725f 6e61 6d65 3d76 6172 5f6e    var_name=var_n
+000374d0: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+000374e0: 2076 616c 7565 5f6e 616d 653d 7661 6c75   value_name=valu
+000374f0: 655f 6e61 6d65 2c0a 2020 2020 2020 2020  e_name,.        
+00037500: 2020 2020 636f 6c5f 6c65 7665 6c3d 636f      col_level=co
+00037510: 6c5f 6c65 7665 6c2c 0a20 2020 2020 2020  l_level,.       
+00037520: 2029 0a0a 2020 2020 6465 6620 746f 5f72   )..    def to_r
+00037530: 6563 6f72 6473 2873 656c 662c 2069 6e64  ecords(self, ind
+00037540: 6578 3d46 616c 7365 2c20 6c65 6e67 7468  ex=False, length
+00037550: 733d 4e6f 6e65 293a 0a20 2020 2020 2020  s=None):.       
+00037560: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+00037570: 7261 6d65 2e69 6f20 696d 706f 7274 2074  rame.io import t
+00037580: 6f5f 7265 636f 7264 730a 0a20 2020 2020  o_records..     
+00037590: 2020 2069 6620 6c65 6e67 7468 7320 6973     if lengths is
+000375a0: 2054 7275 653a 0a20 2020 2020 2020 2020   True:.         
+000375b0: 2020 206c 656e 6774 6873 203d 2074 7570     lengths = tup
+000375c0: 6c65 2873 656c 662e 6d61 705f 7061 7274  le(self.map_part
+000375d0: 6974 696f 6e73 286c 656e 292e 636f 6d70  itions(len).comp
+000375e0: 7574 6528 2929 0a0a 2020 2020 2020 2020  ute())..        
+000375f0: 7265 636f 7264 7320 3d20 746f 5f72 6563  records = to_rec
+00037600: 6f72 6473 2873 656c 6629 0a0a 2020 2020  ords(self)..    
+00037610: 2020 2020 6368 756e 6b73 203d 2073 656c      chunks = sel
+00037620: 662e 5f76 616c 6964 6174 655f 6368 756e  f._validate_chun
+00037630: 6b73 2872 6563 6f72 6473 2c20 6c65 6e67  ks(records, leng
+00037640: 7468 7329 0a20 2020 2020 2020 2072 6563  ths).        rec
+00037650: 6f72 6473 2e5f 6368 756e 6b73 203d 2028  ords._chunks = (
+00037660: 6368 756e 6b73 5b30 5d2c 290a 0a20 2020  chunks[0],)..   
+00037670: 2020 2020 2072 6574 7572 6e20 7265 636f       return reco
+00037680: 7264 730a 0a20 2020 2040 6465 7269 7665  rds..    @derive
+00037690: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+000376a0: 616d 6529 0a20 2020 2064 6566 2074 6f5f  ame).    def to_
+000376b0: 6874 6d6c 2873 656c 662c 206d 6178 5f72  html(self, max_r
+000376c0: 6f77 733d 3529 3a0a 2020 2020 2020 2020  ows=5):.        
+000376d0: 2320 7064 2e53 6572 6965 7320 646f 6573  # pd.Series does
+000376e0: 6e27 7420 6861 7665 2068 746d 6c20 7265  n't have html re
+000376f0: 7072 0a20 2020 2020 2020 2064 6174 6120  pr.        data 
+00037700: 3d20 7365 6c66 2e5f 7265 7072 5f64 6174  = self._repr_dat
+00037710: 6128 292e 746f 5f68 746d 6c28 6d61 785f  a().to_html(max_
+00037720: 726f 7773 3d6d 6178 5f72 6f77 732c 2073  rows=max_rows, s
+00037730: 686f 775f 6469 6d65 6e73 696f 6e73 3d46  how_dimensions=F
+00037740: 616c 7365 290a 2020 2020 2020 2020 7265  alse).        re
+00037750: 7475 726e 2067 6574 5f74 656d 706c 6174  turn get_templat
+00037760: 6528 2264 6174 6166 7261 6d65 2e68 746d  e("dataframe.htm
+00037770: 6c2e 6a32 2229 2e72 656e 6465 7228 0a20  l.j2").render(. 
+00037780: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00037790: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
+000377a0: 2020 6e61 6d65 3d73 656c 662e 5f6e 616d    name=self._nam
+000377b0: 652c 0a20 2020 2020 2020 2020 2020 206c  e,.            l
+000377c0: 6179 6572 733d 6d61 7962 655f 706c 7572  ayers=maybe_plur
+000377d0: 616c 697a 6528 6c65 6e28 7365 6c66 2e64  alize(len(self.d
+000377e0: 6173 6b2e 6c61 7965 7273 292c 2022 6772  ask.layers), "gr
+000377f0: 6170 6820 6c61 7965 7222 292c 0a20 2020  aph layer"),.   
+00037800: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00037810: 5f72 6570 725f 6461 7461 2873 656c 6629  _repr_data(self)
+00037820: 3a0a 2020 2020 2020 2020 6d65 7461 203d  :.        meta =
+00037830: 2073 656c 662e 5f6d 6574 610a 2020 2020   self._meta.    
+00037840: 2020 2020 696e 6465 7820 3d20 7365 6c66      index = self
+00037850: 2e5f 7265 7072 5f64 6976 6973 696f 6e73  ._repr_divisions
+00037860: 0a20 2020 2020 2020 2063 6f6c 7320 3d20  .        cols = 
+00037870: 6d65 7461 2e63 6f6c 756d 6e73 0a20 2020  meta.columns.   
+00037880: 2020 2020 2069 6620 6c65 6e28 636f 6c73       if len(cols
+00037890: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
+000378a0: 2020 2020 7365 7269 6573 5f64 6620 3d20      series_df = 
+000378b0: 7064 2e44 6174 6146 7261 6d65 285b 5b5d  pd.DataFrame([[]
+000378c0: 5d20 2a20 6c65 6e28 696e 6465 7829 2c20  ] * len(index), 
+000378d0: 636f 6c75 6d6e 733d 636f 6c73 2c20 696e  columns=cols, in
+000378e0: 6465 783d 696e 6465 7829 0a20 2020 2020  dex=index).     
+000378f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00037900: 2020 2020 2073 6572 6965 735f 6466 203d       series_df =
+00037910: 2070 642e 636f 6e63 6174 280a 2020 2020   pd.concat(.    
+00037920: 2020 2020 2020 2020 2020 2020 5b5f 7265              [_re
+00037930: 7072 5f64 6174 615f 7365 7269 6573 2873  pr_data_series(s
+00037940: 2c20 696e 6465 783d 696e 6465 7829 2066  , index=index) f
+00037950: 6f72 205f 2c20 7320 696e 206d 6574 612e  or _, s in meta.
+00037960: 6974 656d 7328 295d 2c20 6178 6973 3d31  items()], axis=1
+00037970: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00037980: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00037990: 7269 6573 5f64 660a 0a20 2020 2064 6566  ries_df..    def
+000379a0: 205f 7265 7072 5f68 746d 6c5f 2873 656c   _repr_html_(sel
+000379b0: 6629 3a0a 2020 2020 2020 2020 6461 7461  f):.        data
+000379c0: 203d 2073 656c 662e 5f72 6570 725f 6461   = self._repr_da
+000379d0: 7461 2829 2e74 6f5f 6874 6d6c 280a 2020  ta().to_html(.  
+000379e0: 2020 2020 2020 2020 2020 6d61 785f 726f            max_ro
+000379f0: 7773 3d35 2c20 7368 6f77 5f64 696d 656e  ws=5, show_dimen
+00037a00: 7369 6f6e 733d 4661 6c73 652c 206e 6f74  sions=False, not
+00037a10: 6562 6f6f 6b3d 5472 7565 0a20 2020 2020  ebook=True.     
+00037a20: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00037a30: 7572 6e20 6765 745f 7465 6d70 6c61 7465  urn get_template
+00037a40: 2822 6461 7461 6672 616d 652e 6874 6d6c  ("dataframe.html
+00037a50: 2e6a 3222 292e 7265 6e64 6572 280a 2020  .j2").render(.  
+00037a60: 2020 2020 2020 2020 2020 6461 7461 3d64            data=d
+00037a70: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
+00037a80: 206e 616d 653d 7365 6c66 2e5f 6e61 6d65   name=self._name
+00037a90: 2c0a 2020 2020 2020 2020 2020 2020 6c61  ,.            la
+00037aa0: 7965 7273 3d6d 6179 6265 5f70 6c75 7261  yers=maybe_plura
+00037ab0: 6c69 7a65 286c 656e 2873 656c 662e 6461  lize(len(self.da
+00037ac0: 736b 2e6c 6179 6572 7329 2c20 2267 7261  sk.layers), "gra
+00037ad0: 7068 206c 6179 6572 2229 2c0a 2020 2020  ph layer"),.    
+00037ae0: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
+00037af0: 7365 6c65 6374 5f63 6f6c 756d 6e73 5f6f  select_columns_o
+00037b00: 725f 696e 6465 7828 7365 6c66 2c20 636f  r_index(self, co
+00037b10: 6c75 6d6e 735f 6f72 5f69 6e64 6578 293a  lumns_or_index):
+00037b20: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00037b30: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00037b40: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00037b50: 2d2d 0a20 2020 2020 2020 2063 6f6c 756d  --.        colum
+00037b60: 6e73 5f6f 725f 696e 6465 780a 2020 2020  ns_or_index.    
+00037b70: 2020 2020 2020 2020 436f 6c75 6d6e 206f          Column o
+00037b80: 7220 696e 6465 7820 6e61 6d65 2c20 6f72  r index name, or
+00037b90: 2061 206c 6973 7420 6f66 2074 6865 7365   a list of these
+00037ba0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00037bb0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00037bc0: 2d0a 2020 2020 2020 2020 6464 2e44 6174  -.        dd.Dat
+00037bd0: 6146 7261 6d65 0a20 2020 2020 2020 2020  aFrame.         
+00037be0: 2020 2044 6173 6b20 4461 7461 4672 616d     Dask DataFram
+00037bf0: 6520 7769 7468 2063 6f6c 756d 6e73 2063  e with columns c
+00037c00: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
+00037c10: 6561 6368 2063 6f6c 756d 6e20 6f72 0a20  each column or. 
+00037c20: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+00037c30: 206c 6576 656c 2069 6e20 636f 6c75 6d6e   level in column
+00037c40: 735f 6f72 5f69 6e64 6578 2e20 2049 6620  s_or_index.  If 
+00037c50: 696e 636c 7564 6564 2c20 7468 6520 636f  included, the co
+00037c60: 6c75 6d6e 0a20 2020 2020 2020 2020 2020  lumn.           
+00037c70: 2063 6f72 7265 7370 6f6e 6469 6e67 2074   corresponding t
+00037c80: 6f20 7468 6520 696e 6465 7820 6c65 7665  o the index leve
+00037c90: 6c20 6973 206e 616d 6564 205f 696e 6465  l is named _inde
+00037ca0: 780a 2020 2020 2020 2020 2222 220a 0a20  x.        """.. 
+00037cb0: 2020 2020 2020 2023 2045 6e73 7572 6520         # Ensure 
+00037cc0: 636f 6c75 6d6e 735f 6f72 5f69 6e64 6578  columns_or_index
+00037cd0: 2069 7320 6120 6c69 7374 0a20 2020 2020   is a list.     
+00037ce0: 2020 2063 6f6c 756d 6e73 5f6f 725f 696e     columns_or_in
+00037cf0: 6465 7820 3d20 280a 2020 2020 2020 2020  dex = (.        
+00037d00: 2020 2020 636f 6c75 6d6e 735f 6f72 5f69      columns_or_i
+00037d10: 6e64 6578 0a20 2020 2020 2020 2020 2020  ndex.           
+00037d20: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
+00037d30: 6f6c 756d 6e73 5f6f 725f 696e 6465 782c  olumns_or_index,
+00037d40: 206c 6973 7429 0a20 2020 2020 2020 2020   list).         
+00037d50: 2020 2065 6c73 6520 5b63 6f6c 756d 6e73     else [columns
+00037d60: 5f6f 725f 696e 6465 785d 0a20 2020 2020  _or_index].     
+00037d70: 2020 2029 0a0a 2020 2020 2020 2020 636f     )..        co
+00037d80: 6c75 6d6e 5f6e 616d 6573 203d 205b 0a20  lumn_names = [. 
+00037d90: 2020 2020 2020 2020 2020 206e 2066 6f72             n for
+00037da0: 206e 2069 6e20 636f 6c75 6d6e 735f 6f72   n in columns_or
+00037db0: 5f69 6e64 6578 2069 6620 7365 6c66 2e5f  _index if self._
+00037dc0: 6973 5f63 6f6c 756d 6e5f 6c61 6265 6c5f  is_column_label_
+00037dd0: 7265 6665 7265 6e63 6528 6e29 0a20 2020  reference(n).   
+00037de0: 2020 2020 205d 0a0a 2020 2020 2020 2020       ]..        
+00037df0: 7365 6c65 6374 6564 5f64 6620 3d20 7365  selected_df = se
+00037e00: 6c66 5b63 6f6c 756d 6e5f 6e61 6d65 735d  lf[column_names]
+00037e10: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00037e20: 2e5f 636f 6e74 6169 6e73 5f69 6e64 6578  ._contains_index
+00037e30: 5f6e 616d 6528 636f 6c75 6d6e 735f 6f72  _name(columns_or
+00037e40: 5f69 6e64 6578 293a 0a20 2020 2020 2020  _index):.       
+00037e50: 2020 2020 2023 2049 6e64 6578 206e 616d       # Index nam
+00037e60: 6520 7761 7320 696e 636c 7564 6564 0a20  e was included. 
+00037e70: 2020 2020 2020 2020 2020 2073 656c 6563             selec
+00037e80: 7465 645f 6466 203d 2073 656c 6563 7465  ted_df = selecte
+00037e90: 645f 6466 2e61 7373 6967 6e28 5f69 6e64  d_df.assign(_ind
+00037ea0: 6578 3d73 656c 662e 696e 6465 7829 0a0a  ex=self.index)..
+00037eb0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00037ec0: 656c 6563 7465 645f 6466 0a0a 2020 2020  elected_df..    
+00037ed0: 6465 6620 5f69 735f 636f 6c75 6d6e 5f6c  def _is_column_l
+00037ee0: 6162 656c 5f72 6566 6572 656e 6365 2873  abel_reference(s
+00037ef0: 656c 662c 206b 6579 293a 0a20 2020 2020  elf, key):.     
+00037f00: 2020 2022 2222 0a20 2020 2020 2020 2054     """.        T
+00037f10: 6573 7420 7768 6574 6865 7220 6120 6b65  est whether a ke
+00037f20: 7920 6973 2061 2063 6f6c 756d 6e20 6c61  y is a column la
+00037f30: 6265 6c20 7265 6665 7265 6e63 650a 0a20  bel reference.. 
+00037f40: 2020 2020 2020 2054 6f20 6265 2063 6f6e         To be con
+00037f50: 7369 6465 7265 6420 6120 636f 6c75 6d6e  sidered a column
+00037f60: 206c 6162 656c 2072 6566 6572 656e 6365   label reference
+00037f70: 2c20 606b 6579 6020 6d75 7374 206d 6174  , `key` must mat
+00037f80: 6368 2074 6865 206e 616d 6520 6f66 2061  ch the name of a
+00037f90: 740a 2020 2020 2020 2020 6c65 6173 7420  t.        least 
+00037fa0: 6f6e 6520 636f 6c75 6d6e 2e0a 2020 2020  one column..    
+00037fb0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00037fc0: 7265 7475 726e 2028 0a20 2020 2020 2020  return (.       
+00037fd0: 2020 2020 206e 6f74 2069 735f 6461 736b       not is_dask
+00037fe0: 5f63 6f6c 6c65 6374 696f 6e28 6b65 7929  _collection(key)
+00037ff0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00038000: 2028 6e70 2e69 7373 6361 6c61 7228 6b65   (np.isscalar(ke
+00038010: 7929 206f 7220 6973 696e 7374 616e 6365  y) or isinstance
+00038020: 286b 6579 2c20 7475 706c 6529 290a 2020  (key, tuple)).  
+00038030: 2020 2020 2020 2020 2020 616e 6420 6b65            and ke
+00038040: 7920 696e 2073 656c 662e 636f 6c75 6d6e  y in self.column
+00038050: 730a 2020 2020 2020 2020 290a 0a20 2020  s.        )..   
+00038060: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+00038070: 2020 6465 6620 6672 6f6d 5f64 6963 7428    def from_dict(
+00038080: 0a20 2020 2020 2020 2063 6c73 2c20 6461  .        cls, da
+00038090: 7461 2c20 2a2c 206e 7061 7274 6974 696f  ta, *, npartitio
+000380a0: 6e73 2c20 6f72 6965 6e74 3d22 636f 6c75  ns, orient="colu
+000380b0: 6d6e 7322 2c20 6474 7970 653d 4e6f 6e65  mns", dtype=None
+000380c0: 2c20 636f 6c75 6d6e 733d 4e6f 6e65 0a20  , columns=None. 
+000380d0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+000380e0: 220a 2020 2020 2020 2020 436f 6e73 7472  ".        Constr
+000380f0: 7563 7420 6120 4461 736b 2044 6174 6146  uct a Dask DataF
+00038100: 7261 6d65 2066 726f 6d20 6120 5079 7468  rame from a Pyth
+00038110: 6f6e 2044 6963 7469 6f6e 6172 790a 0a20  on Dictionary.. 
+00038120: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+00038130: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00038140: 0a20 2020 2020 2020 2064 6173 6b2e 6461  .        dask.da
+00038150: 7461 6672 616d 652e 6672 6f6d 5f64 6963  taframe.from_dic
+00038160: 740a 2020 2020 2020 2020 2222 220a 2020  t.        """.  
+00038170: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+00038180: 6461 7461 6672 616d 652e 696f 2069 6d70  dataframe.io imp
+00038190: 6f72 7420 6672 6f6d 5f64 6963 740a 0a20  ort from_dict.. 
+000381a0: 2020 2020 2020 2072 6574 7572 6e20 6672         return fr
+000381b0: 6f6d 5f64 6963 7428 0a20 2020 2020 2020  om_dict(.       
+000381c0: 2020 2020 2064 6174 612c 0a20 2020 2020       data,.     
+000381d0: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
+000381e0: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
+000381f0: 6f72 6965 6e74 3d6f 7269 656e 742c 0a20  orient=orient,. 
+00038200: 2020 2020 2020 2020 2020 2064 7479 7065             dtype
+00038210: 3d64 7479 7065 2c0a 2020 2020 2020 2020  =dtype,.        
+00038220: 2020 2020 636f 6c75 6d6e 733d 636f 6c75      columns=colu
+00038230: 6d6e 732c 0a20 2020 2020 2020 2020 2020  mns,.           
+00038240: 2063 6f6e 7374 7275 6374 6f72 3d63 6c73   constructor=cls
+00038250: 2e5f 7061 7274 6974 696f 6e5f 7479 7065  ._partition_type
+00038260: 2c0a 2020 2020 2020 2020 290a 0a0a 2320  ,.        )...# 
+00038270: 6269 6e64 206f 7065 7261 746f 7273 0a23  bind operators.#
+00038280: 2054 4f44 4f3a 2064 796e 616d 6963 616c   TODO: dynamical
+00038290: 6c79 2062 6f75 6e64 206f 7065 7261 746f  ly bound operato
+000382a0: 7273 2061 7265 2064 6566 6561 7469 6e67  rs are defeating
+000382b0: 2074 7970 6520 616e 6e6f 7461 7469 6f6e   type annotation
+000382c0: 730a 666f 7220 6f70 2069 6e20 5b0a 2020  s.for op in [.  
+000382d0: 2020 6f70 6572 6174 6f72 2e61 6273 2c0a    operator.abs,.
+000382e0: 2020 2020 6f70 6572 6174 6f72 2e61 6464      operator.add
+000382f0: 2c0a 2020 2020 6f70 6572 6174 6f72 2e61  ,.    operator.a
+00038300: 6e64 5f2c 0a20 2020 206f 7065 7261 746f  nd_,.    operato
+00038310: 722e 6571 2c0a 2020 2020 6f70 6572 6174  r.eq,.    operat
+00038320: 6f72 2e67 742c 0a20 2020 206f 7065 7261  or.gt,.    opera
+00038330: 746f 722e 6765 2c0a 2020 2020 6f70 6572  tor.ge,.    oper
+00038340: 6174 6f72 2e69 6e76 2c0a 2020 2020 6f70  ator.inv,.    op
+00038350: 6572 6174 6f72 2e6c 742c 0a20 2020 206f  erator.lt,.    o
+00038360: 7065 7261 746f 722e 6c65 2c0a 2020 2020  perator.le,.    
+00038370: 6f70 6572 6174 6f72 2e6d 6f64 2c0a 2020  operator.mod,.  
+00038380: 2020 6f70 6572 6174 6f72 2e6d 756c 2c0a    operator.mul,.
+00038390: 2020 2020 6f70 6572 6174 6f72 2e6e 652c      operator.ne,
+000383a0: 0a20 2020 206f 7065 7261 746f 722e 6e65  .    operator.ne
+000383b0: 672c 0a20 2020 206f 7065 7261 746f 722e  g,.    operator.
+000383c0: 6f72 5f2c 0a20 2020 206f 7065 7261 746f  or_,.    operato
+000383d0: 722e 706f 772c 0a20 2020 206f 7065 7261  r.pow,.    opera
+000383e0: 746f 722e 7375 622c 0a20 2020 206f 7065  tor.sub,.    ope
+000383f0: 7261 746f 722e 7472 7565 6469 762c 0a20  rator.truediv,. 
+00038400: 2020 206f 7065 7261 746f 722e 666c 6f6f     operator.floo
+00038410: 7264 6976 2c0a 2020 2020 6f70 6572 6174  rdiv,.    operat
+00038420: 6f72 2e78 6f72 2c0a 5d3a 0a20 2020 205f  or.xor,.]:.    _
+00038430: 4672 616d 652e 5f62 696e 645f 6f70 6572  Frame._bind_oper
+00038440: 6174 6f72 286f 7029 0a20 2020 2053 6361  ator(op).    Sca
+00038450: 6c61 722e 5f62 696e 645f 6f70 6572 6174  lar._bind_operat
+00038460: 6f72 286f 7029 0a0a 666f 7220 6e61 6d65  or(op)..for name
+00038470: 2069 6e20 5b0a 2020 2020 2261 6464 222c   in [.    "add",
+00038480: 0a20 2020 2022 7375 6222 2c0a 2020 2020  .    "sub",.    
+00038490: 226d 756c 222c 0a20 2020 2022 6469 7622  "mul",.    "div"
+000384a0: 2c0a 2020 2020 2264 6976 6964 6522 2c0a  ,.    "divide",.
+000384b0: 2020 2020 2274 7275 6564 6976 222c 0a20      "truediv",. 
+000384c0: 2020 2022 666c 6f6f 7264 6976 222c 0a20     "floordiv",. 
+000384d0: 2020 2022 6d6f 6422 2c0a 2020 2020 2270     "mod",.    "p
+000384e0: 6f77 222c 0a20 2020 2022 7261 6464 222c  ow",.    "radd",
+000384f0: 0a20 2020 2022 7273 7562 222c 0a20 2020  .    "rsub",.   
+00038500: 2022 726d 756c 222c 0a20 2020 2022 7264   "rmul",.    "rd
+00038510: 6976 222c 0a20 2020 2022 7274 7275 6564  iv",.    "rtrued
+00038520: 6976 222c 0a20 2020 2022 7266 6c6f 6f72  iv",.    "rfloor
+00038530: 6469 7622 2c0a 2020 2020 2272 6d6f 6422  div",.    "rmod"
+00038540: 2c0a 2020 2020 2272 706f 7722 2c0a 5d3a  ,.    "rpow",.]:
+00038550: 0a20 2020 206d 6574 6820 3d20 6765 7461  .    meth = geta
+00038560: 7474 7228 7064 2e44 6174 6146 7261 6d65  ttr(pd.DataFrame
+00038570: 2c20 6e61 6d65 290a 2020 2020 4461 7461  , name).    Data
+00038580: 4672 616d 652e 5f62 696e 645f 6f70 6572  Frame._bind_oper
+00038590: 6174 6f72 5f6d 6574 686f 6428 6e61 6d65  ator_method(name
+000385a0: 2c20 6d65 7468 290a 0a20 2020 206d 6574  , meth)..    met
+000385b0: 6820 3d20 6765 7461 7474 7228 7064 2e53  h = getattr(pd.S
+000385c0: 6572 6965 732c 206e 616d 6529 0a20 2020  eries, name).   
+000385d0: 2053 6572 6965 732e 5f62 696e 645f 6f70   Series._bind_op
+000385e0: 6572 6174 6f72 5f6d 6574 686f 6428 6e61  erator_method(na
+000385f0: 6d65 2c20 6d65 7468 290a 0a66 6f72 206e  me, meth)..for n
+00038600: 616d 6520 696e 205b 226c 7422 2c20 2267  ame in ["lt", "g
+00038610: 7422 2c20 226c 6522 2c20 2267 6522 2c20  t", "le", "ge", 
+00038620: 226e 6522 2c20 2265 7122 5d3a 0a20 2020  "ne", "eq"]:.   
+00038630: 206d 6574 6820 3d20 6765 7461 7474 7228   meth = getattr(
+00038640: 7064 2e44 6174 6146 7261 6d65 2c20 6e61  pd.DataFrame, na
+00038650: 6d65 290a 2020 2020 4461 7461 4672 616d  me).    DataFram
+00038660: 652e 5f62 696e 645f 636f 6d70 6172 6973  e._bind_comparis
+00038670: 6f6e 5f6d 6574 686f 6428 6e61 6d65 2c20  on_method(name, 
+00038680: 6d65 7468 290a 0a20 2020 206d 6574 6820  meth)..    meth 
+00038690: 3d20 6765 7461 7474 7228 7064 2e53 6572  = getattr(pd.Ser
+000386a0: 6965 732c 206e 616d 6529 0a20 2020 2053  ies, name).    S
+000386b0: 6572 6965 732e 5f62 696e 645f 636f 6d70  eries._bind_comp
+000386c0: 6172 6973 6f6e 5f6d 6574 686f 6428 6e61  arison_method(na
+000386d0: 6d65 2c20 6d65 7468 290a 0a0a 6465 6620  me, meth)...def 
+000386e0: 6973 5f62 726f 6164 6361 7374 6162 6c65  is_broadcastable
+000386f0: 2864 6673 2c20 7329 3a0a 2020 2020 2222  (dfs, s):.    ""
+00038700: 220a 2020 2020 5468 6973 2053 6572 6965  ".    This Serie
+00038710: 7320 6973 2062 726f 6164 6361 7374 6162  s is broadcastab
+00038720: 6c65 2061 6761 696e 7374 2061 6e6f 7468  le against anoth
+00038730: 6572 2064 6174 6166 7261 6d65 2069 6e20  er dataframe in 
+00038740: 7468 6520 7365 7175 656e 6365 0a20 2020  the sequence.   
+00038750: 2022 2222 0a0a 2020 2020 6465 6620 636f   """..    def co
+00038760: 6d70 6172 6528 732c 2064 6629 3a0a 2020  mpare(s, df):.  
+00038770: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+00038780: 2020 2020 2020 2072 6574 7572 6e20 732e         return s.
+00038790: 6469 7669 7369 6f6e 7320 3d3d 2028 6466  divisions == (df
+000387a0: 2e63 6f6c 756d 6e73 2e6d 696e 2829 2c20  .columns.min(), 
+000387b0: 6466 2e63 6f6c 756d 6e73 2e6d 6178 2829  df.columns.max()
+000387c0: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+000387d0: 2054 7970 6545 7272 6f72 3a0a 2020 2020   TypeError:.    
+000387e0: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+000387f0: 616c 7365 0a0a 2020 2020 7265 7475 726e  alse..    return
+00038800: 2028 0a20 2020 2020 2020 2069 7369 6e73   (.        isins
+00038810: 7461 6e63 6528 732c 2053 6572 6965 7329  tance(s, Series)
+00038820: 0a20 2020 2020 2020 2061 6e64 2073 2e6e  .        and s.n
+00038830: 7061 7274 6974 696f 6e73 203d 3d20 310a  partitions == 1.
+00038840: 2020 2020 2020 2020 616e 6420 732e 6b6e          and s.kn
+00038850: 6f77 6e5f 6469 7669 7369 6f6e 730a 2020  own_divisions.  
+00038860: 2020 2020 2020 616e 6420 616e 7928 636f        and any(co
+00038870: 6d70 6172 6528 732c 2064 6629 2066 6f72  mpare(s, df) for
+00038880: 2064 6620 696e 2064 6673 2069 6620 6973   df in dfs if is
+00038890: 696e 7374 616e 6365 2864 662c 2044 6174  instance(df, Dat
+000388a0: 6146 7261 6d65 2929 0a20 2020 2029 0a0a  aFrame)).    )..
+000388b0: 0a64 6566 2065 6c65 6d77 6973 6528 6f70  .def elemwise(op
+000388c0: 2c20 2a61 7267 732c 206d 6574 613d 6e6f  , *args, meta=no
+000388d0: 5f64 6566 6175 6c74 2c20 6f75 743d 4e6f  _default, out=No
+000388e0: 6e65 2c20 7472 616e 7366 6f72 6d5f 6469  ne, transform_di
+000388f0: 7669 7369 6f6e 733d 5472 7565 2c20 2a2a  visions=True, **
+00038900: 6b77 6172 6773 293a 0a20 2020 2022 2222  kwargs):.    """
+00038910: 456c 656d 656e 7477 6973 6520 6f70 6572  Elementwise oper
+00038920: 6174 696f 6e20 666f 7220 4461 736b 2064  ation for Dask d
+00038930: 6174 6166 7261 6d65 730a 0a20 2020 2050  ataframes..    P
+00038940: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+00038950: 2d2d 2d2d 2d2d 2d2d 0a20 2020 206f 703a  --------.    op:
+00038960: 2063 616c 6c61 626c 650a 2020 2020 2020   callable.      
+00038970: 2020 4675 6e63 7469 6f6e 2074 6f20 6170    Function to ap
+00038980: 706c 7920 6163 726f 7373 2069 6e70 7574  ply across input
+00038990: 2064 6174 6166 7261 6d65 730a 2020 2020   dataframes.    
+000389a0: 2a61 7267 733a 2044 6174 6146 7261 6d65  *args: DataFrame
+000389b0: 732c 2053 6572 6965 732c 2053 6361 6c61  s, Series, Scala
+000389c0: 7273 2c20 4172 7261 7973 2c0a 2020 2020  rs, Arrays,.    
+000389d0: 2020 2020 5468 6520 6172 6775 6d65 6e74      The argument
+000389e0: 7320 6f66 2074 6865 206f 7065 7261 7469  s of the operati
+000389f0: 6f6e 0a20 2020 206d 6574 613a 2070 642e  on.    meta: pd.
+00038a00: 4461 7461 4672 616d 652c 2070 642e 5365  DataFrame, pd.Se
+00038a10: 7269 6573 2028 6f70 7469 6f6e 616c 290a  ries (optional).
+00038a20: 2020 2020 2020 2020 5661 6c69 6420 6d65          Valid me
+00038a30: 7461 6461 7461 2066 6f72 2074 6865 206f  tadata for the o
+00038a40: 7065 7261 7469 6f6e 2e20 2057 696c 6c20  peration.  Will 
+00038a50: 6576 616c 7561 7465 206f 6e20 6120 736d  evaluate on a sm
+00038a60: 616c 6c20 7069 6563 6520 6f66 0a20 2020  all piece of.   
+00038a70: 2020 2020 2064 6174 6120 6966 206e 6f74       data if not
+00038a80: 2070 726f 7669 6465 642e 0a20 2020 2074   provided..    t
+00038a90: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
+00038aa0: 6e73 3a20 626f 6f6c 6561 6e0a 2020 2020  ns: boolean.    
+00038ab0: 2020 2020 4966 2074 6865 2069 6e70 7574      If the input
+00038ac0: 2069 7320 6120 6060 6461 736b 2e64 6174   is a ``dask.dat
+00038ad0: 6166 7261 6d65 2e49 6e64 6578 6060 2077  aframe.Index`` w
+00038ae0: 6520 6e6f 726d 616c 6c79 2077 696c 6c20  e normally will 
+00038af0: 616c 736f 2061 7070 6c79 0a20 2020 2020  also apply.     
+00038b00: 2020 2074 6865 2066 756e 6374 696f 6e20     the function 
+00038b10: 6f6e 746f 2074 6865 2064 6976 6973 696f  onto the divisio
+00038b20: 6e73 2061 6e64 2061 7070 6c79 2074 686f  ns and apply tho
+00038b30: 7365 2074 7261 6e73 666f 726d 6564 2064  se transformed d
+00038b40: 6976 6973 696f 6e73 0a20 2020 2020 2020  ivisions.       
+00038b50: 2074 6f20 7468 6520 6f75 7470 7574 2e20   to the output. 
+00038b60: 2059 6f75 2063 616e 2070 6173 7320 6060   You can pass ``
+00038b70: 7472 616e 7366 6f72 6d5f 6469 7669 7369  transform_divisi
+00038b80: 6f6e 733d 4661 6c73 6560 6020 746f 206f  ons=False`` to o
+00038b90: 7665 7272 6964 650a 2020 2020 2020 2020  verride.        
+00038ba0: 7468 6973 2062 6568 6176 696f 720a 2020  this behavior.  
+00038bb0: 2020 6f75 7420 3a20 6060 6461 736b 2e61    out : ``dask.a
+00038bc0: 7272 6179 6060 206f 7220 6060 4e6f 6e65  rray`` or ``None
+00038bd0: 6060 0a20 2020 2020 2020 2049 6620 6f75  ``.        If ou
+00038be0: 7420 6973 2061 2064 6173 6b2e 4461 7461  t is a dask.Data
+00038bf0: 4672 616d 652c 2064 6173 6b2e 5365 7269  Frame, dask.Seri
+00038c00: 6573 206f 7220 6461 736b 2e53 6361 6c61  es or dask.Scala
+00038c10: 7220 7468 656e 0a20 2020 2020 2020 2074  r then.        t
+00038c20: 6869 7320 6f76 6572 7772 6974 6573 2074  his overwrites t
+00038c30: 6865 2063 6f6e 7465 6e74 7320 6f66 2069  he contents of i
+00038c40: 7420 7769 7468 2074 6865 2072 6573 756c  t with the resul
+00038c50: 740a 2020 2020 2a2a 6b77 6172 6773 3a20  t.    **kwargs: 
+00038c60: 7363 616c 6172 730a 0a20 2020 2045 7861  scalars..    Exa
+00038c70: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
+00038c80: 2d2d 0a20 2020 203e 3e3e 2065 6c65 6d77  --.    >>> elemw
+00038c90: 6973 6528 6f70 6572 6174 6f72 2e61 6464  ise(operator.add
+00038ca0: 2c20 6466 2e78 2c20 6466 2e79 2920 2023  , df.x, df.y)  #
+00038cb0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
+00038cc0: 2020 2020 2222 220a 2020 2020 5f6e 616d      """.    _nam
+00038cd0: 6520 3d20 6675 6e63 6e61 6d65 286f 7029  e = funcname(op)
+00038ce0: 202b 2022 2d22 202b 2074 6f6b 656e 697a   + "-" + tokeniz
+00038cf0: 6528 6f70 2c20 2a61 7267 732c 202a 2a6b  e(op, *args, **k
+00038d00: 7761 7267 7329 0a0a 2020 2020 6172 6773  wargs)..    args
+00038d10: 203d 205f 6d61 7962 655f 6672 6f6d 5f70   = _maybe_from_p
+00038d20: 616e 6461 7328 6172 6773 290a 0a20 2020  andas(args)..   
+00038d30: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+00038d40: 7261 6d65 2e6d 756c 7469 2069 6d70 6f72  rame.multi impor
+00038d50: 7420 5f6d 6179 6265 5f61 6c69 676e 5f70  t _maybe_align_p
+00038d60: 6172 7469 7469 6f6e 730a 0a20 2020 2061  artitions..    a
+00038d70: 7267 7320 3d20 5f6d 6179 6265 5f61 6c69  rgs = _maybe_ali
+00038d80: 676e 5f70 6172 7469 7469 6f6e 7328 6172  gn_partitions(ar
+00038d90: 6773 290a 2020 2020 6461 736b 7320 3d20  gs).    dasks = 
+00038da0: 5b61 7267 2066 6f72 2061 7267 2069 6e20  [arg for arg in 
+00038db0: 6172 6773 2069 6620 6973 696e 7374 616e  args if isinstan
+00038dc0: 6365 2861 7267 2c20 285f 4672 616d 652c  ce(arg, (_Frame,
+00038dd0: 2053 6361 6c61 722c 2041 7272 6179 2929   Scalar, Array))
+00038de0: 5d0a 2020 2020 6466 7320 3d20 5b64 6620  ].    dfs = [df 
+00038df0: 666f 7220 6466 2069 6e20 6461 736b 7320  for df in dasks 
+00038e00: 6966 2069 7369 6e73 7461 6e63 6528 6466  if isinstance(df
+00038e10: 2c20 5f46 7261 6d65 295d 0a0a 2020 2020  , _Frame)]..    
+00038e20: 2320 436c 6561 6e20 7570 2064 6173 6b20  # Clean up dask 
+00038e30: 6172 7261 7973 2069 6620 7072 6573 656e  arrays if presen
+00038e40: 740a 2020 2020 6465 7073 203d 2064 6173  t.    deps = das
+00038e50: 6b73 2e63 6f70 7928 290a 2020 2020 666f  ks.copy().    fo
+00038e60: 7220 692c 2061 2069 6e20 656e 756d 6572  r i, a in enumer
+00038e70: 6174 6528 6461 736b 7329 3a0a 2020 2020  ate(dasks):.    
+00038e80: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00038e90: 7461 6e63 6528 612c 2041 7272 6179 293a  tance(a, Array):
+00038ea0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+00038eb0: 7469 6e75 650a 2020 2020 2020 2020 2320  tinue.        # 
+00038ec0: 456e 7375 7265 2074 6861 7420 7468 6579  Ensure that they
+00038ed0: 2068 6176 6520 7369 6d69 6c61 722d 6973   have similar-is
+00038ee0: 6820 6368 756e 6b20 7374 7275 6374 7572  h chunk structur
+00038ef0: 650a 2020 2020 2020 2020 6966 206e 6f74  e.        if not
+00038f00: 2061 6c6c 286e 6f74 2061 2e63 6875 6e6b   all(not a.chunk
+00038f10: 7320 6f72 206c 656e 2861 2e63 6875 6e6b  s or len(a.chunk
+00038f20: 735b 305d 2920 3d3d 2064 662e 6e70 6172  s[0]) == df.npar
+00038f30: 7469 7469 6f6e 7320 666f 7220 6466 2069  titions for df i
+00038f40: 6e20 6466 7329 3a0a 2020 2020 2020 2020  n dfs):.        
+00038f50: 2020 2020 6d73 6720 3d20 280a 2020 2020      msg = (.    
+00038f60: 2020 2020 2020 2020 2020 2020 2257 6865              "Whe
+00038f70: 6e20 636f 6d62 696e 696e 6720 6461 736b  n combining dask
+00038f80: 2061 7272 6179 7320 7769 7468 2064 6174   arrays with dat
+00038f90: 6166 7261 6d65 7320 7468 6579 206d 7573  aframes they mus
+00038fa0: 7420 220a 2020 2020 2020 2020 2020 2020  t ".            
+00038fb0: 2020 2020 226d 6174 6368 2063 6875 6e6b      "match chunk
+00038fc0: 696e 6720 6578 6163 746c 792e 2020 4f70  ing exactly.  Op
+00038fd0: 6572 6174 696f 6e3a 2025 7322 2025 2066  eration: %s" % f
+00038fe0: 756e 636e 616d 6528 6f70 290a 2020 2020  uncname(op).    
+00038ff0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00039000: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00039010: 6545 7272 6f72 286d 7367 290a 2020 2020  eError(msg).    
+00039020: 2020 2020 2320 5265 6368 756e 6b20 746f      # Rechunk to
+00039030: 2068 6176 6520 6120 7369 6e67 6c65 2063   have a single c
+00039040: 6875 6e6b 2061 6c6f 6e67 2061 6c6c 206f  hunk along all o
+00039050: 7468 6572 2061 7865 730a 2020 2020 2020  ther axes.      
+00039060: 2020 6966 2061 2e6e 6469 6d20 3e20 313a    if a.ndim > 1:
+00039070: 0a20 2020 2020 2020 2020 2020 2061 203d  .            a =
+00039080: 2061 2e72 6563 6875 6e6b 287b 6920 2b20   a.rechunk({i + 
+00039090: 313a 2064 2066 6f72 2069 2c20 6420 696e  1: d for i, d in
+000390a0: 2065 6e75 6d65 7261 7465 2861 2e73 6861   enumerate(a.sha
+000390b0: 7065 5b31 3a5d 297d 290a 2020 2020 2020  pe[1:])}).      
+000390c0: 2020 2020 2020 6461 736b 735b 695d 203d        dasks[i] =
+000390d0: 2061 0a0a 2020 2020 6469 7669 7369 6f6e   a..    division
+000390e0: 7320 3d20 6466 735b 305d 2e64 6976 6973  s = dfs[0].divis
+000390f0: 696f 6e73 0a20 2020 2069 6620 7472 616e  ions.    if tran
+00039100: 7366 6f72 6d5f 6469 7669 7369 6f6e 7320  sform_divisions 
+00039110: 616e 6420 6973 696e 7374 616e 6365 2864  and isinstance(d
+00039120: 6673 5b30 5d2c 2049 6e64 6578 2920 616e  fs[0], Index) an
+00039130: 6420 6c65 6e28 6466 7329 203d 3d20 313a  d len(dfs) == 1:
+00039140: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00039150: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
+00039160: 6f6e 7320 3d20 6f70 280a 2020 2020 2020  ons = op(.      
+00039170: 2020 2020 2020 2020 2020 2a5b 7064 2e49            *[pd.I
+00039180: 6e64 6578 2861 7267 2e64 6976 6973 696f  ndex(arg.divisio
+00039190: 6e73 2920 6966 2061 7267 2069 7320 6466  ns) if arg is df
+000391a0: 735b 305d 2065 6c73 6520 6172 6720 666f  s[0] else arg fo
+000391b0: 7220 6172 6720 696e 2061 7267 735d 2c0a  r arg in args],.
+000391c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000391d0: 2a2a 6b77 6172 6773 2c0a 2020 2020 2020  **kwargs,.      
+000391e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000391f0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00039200: 6528 6469 7669 7369 6f6e 732c 2070 642e  e(divisions, pd.
+00039210: 496e 6465 7829 3a0a 2020 2020 2020 2020  Index):.        
+00039220: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+00039230: 7320 3d20 6d65 7468 6f64 732e 746f 6c69  s = methods.toli
+00039240: 7374 2864 6976 6973 696f 6e73 290a 2020  st(divisions).  
+00039250: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
+00039260: 6570 7469 6f6e 3a0a 2020 2020 2020 2020  eption:.        
+00039270: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
+00039280: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00039290: 2020 2069 6620 6e6f 7420 7661 6c69 645f     if not valid_
+000392a0: 6469 7669 7369 6f6e 7328 6469 7669 7369  divisions(divisi
+000392b0: 6f6e 7329 3a0a 2020 2020 2020 2020 2020  ons):.          
+000392c0: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
+000392d0: 3d20 5b4e 6f6e 655d 202a 2028 6466 735b  = [None] * (dfs[
+000392e0: 305d 2e6e 7061 7274 6974 696f 6e73 202b  0].npartitions +
+000392f0: 2031 290a 0a20 2020 205f 6973 5f62 726f   1)..    _is_bro
+00039300: 6164 6361 7374 6162 6c65 203d 2070 6172  adcastable = par
+00039310: 7469 616c 2869 735f 6272 6f61 6463 6173  tial(is_broadcas
+00039320: 7461 626c 652c 2064 6673 290a 2020 2020  table, dfs).    
+00039330: 6466 7320 3d20 6c69 7374 2872 656d 6f76  dfs = list(remov
+00039340: 6528 5f69 735f 6272 6f61 6463 6173 7461  e(_is_broadcasta
+00039350: 626c 652c 2064 6673 2929 0a0a 2020 2020  ble, dfs))..    
+00039360: 6f74 6865 7220 3d20 5b0a 2020 2020 2020  other = [.      
+00039370: 2020 2869 2c20 6172 6729 0a20 2020 2020    (i, arg).     
+00039380: 2020 2066 6f72 2069 2c20 6172 6720 696e     for i, arg in
+00039390: 2065 6e75 6d65 7261 7465 2861 7267 7329   enumerate(args)
+000393a0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+000393b0: 6973 696e 7374 616e 6365 2861 7267 2c20  isinstance(arg, 
+000393c0: 285f 4672 616d 652c 2053 6361 6c61 722c  (_Frame, Scalar,
+000393d0: 2041 7272 6179 2929 0a20 2020 205d 0a0a   Array)).    ]..
+000393e0: 2020 2020 2320 6164 6a75 7374 2074 6865      # adjust the
+000393f0: 206b 6579 206c 656e 6774 6820 6f66 2053   key length of S
+00039400: 6361 6c61 720a 2020 2020 6473 6b20 3d20  calar.    dsk = 
+00039410: 7061 7274 6974 696f 6e77 6973 655f 6772  partitionwise_gr
+00039420: 6170 6828 6f70 2c20 5f6e 616d 652c 202a  aph(op, _name, *
+00039430: 6172 6773 2c20 2a2a 6b77 6172 6773 290a  args, **kwargs).
+00039440: 0a20 2020 2067 7261 7068 203d 2048 6967  .    graph = Hig
+00039450: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+00039460: 5f63 6f6c 6c65 6374 696f 6e73 285f 6e61  _collections(_na
+00039470: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
+00039480: 6e63 6965 733d 6465 7073 290a 0a20 2020  ncies=deps)..   
+00039490: 2069 6620 6d65 7461 2069 7320 6e6f 5f64   if meta is no_d
+000394a0: 6566 6175 6c74 3a0a 2020 2020 2020 2020  efault:.        
+000394b0: 6966 206c 656e 2864 6673 2920 3e3d 2032  if len(dfs) >= 2
+000394c0: 2061 6e64 206e 6f74 2061 6c6c 2868 6173   and not all(has
+000394d0: 6174 7472 2864 2c20 226e 7061 7274 6974  attr(d, "npartit
+000394e0: 696f 6e73 2229 2066 6f72 2064 2069 6e20  ions") for d in 
+000394f0: 6461 736b 7329 3a0a 2020 2020 2020 2020  dasks):.        
+00039500: 2020 2020 2320 7368 6f75 6c64 206e 6f74      # should not
+00039510: 206f 6363 7572 2069 6e20 6375 7272 656e   occur in curren
+00039520: 7420 6675 6e63 730a 2020 2020 2020 2020  t funcs.        
+00039530: 2020 2020 6d73 6720 3d20 2265 6c65 6d77      msg = "elemw
+00039540: 6973 6520 7769 7468 2032 206f 7220 6d6f  ise with 2 or mo
+00039550: 7265 2044 6174 6146 7261 6d65 7320 616e  re DataFrames an
+00039560: 6420 5363 616c 6172 2069 7320 6e6f 7420  d Scalar is not 
+00039570: 7375 7070 6f72 7465 6422 0a20 2020 2020  supported".     
+00039580: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00039590: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+000395a0: 286d 7367 290a 2020 2020 2020 2020 2320  (msg).        # 
+000395b0: 466f 7220 6272 6f61 6463 6173 7461 626c  For broadcastabl
+000395c0: 6520 7365 7269 6573 2c20 7573 6520 6e6f  e series, use no
+000395d0: 2072 6f77 732e 0a20 2020 2020 2020 2070   rows..        p
+000395e0: 6172 7473 203d 205b 0a20 2020 2020 2020  arts = [.       
+000395f0: 2020 2020 2064 2e5f 6d65 7461 0a20 2020       d._meta.   
+00039600: 2020 2020 2020 2020 2069 6620 5f69 735f           if _is_
+00039610: 6272 6f61 6463 6173 7461 626c 6528 6429  broadcastable(d)
+00039620: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00039630: 6520 6e70 2e65 6d70 7479 2828 292c 2064  e np.empty((), d
+00039640: 7479 7065 3d64 2e64 7479 7065 290a 2020  type=d.dtype).  
+00039650: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00039660: 6e73 7461 6e63 6528 642c 2041 7272 6179  nstance(d, Array
+00039670: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00039680: 7365 2064 2e5f 6d65 7461 5f6e 6f6e 656d  se d._meta_nonem
+00039690: 7074 790a 2020 2020 2020 2020 2020 2020  pty.            
+000396a0: 666f 7220 6420 696e 2064 6173 6b73 0a20  for d in dasks. 
+000396b0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+000396c0: 2077 6974 6820 7261 6973 655f 6f6e 5f6d   with raise_on_m
+000396d0: 6574 615f 6572 726f 7228 6675 6e63 6e61  eta_error(funcna
+000396e0: 6d65 286f 7029 293a 0a20 2020 2020 2020  me(op)):.       
+000396f0: 2020 2020 206d 6574 6120 3d20 7061 7274       meta = part
+00039700: 6961 6c5f 6279 5f6f 7264 6572 282a 7061  ial_by_order(*pa
+00039710: 7274 732c 2066 756e 6374 696f 6e3d 6f70  rts, function=op
+00039720: 2c20 6f74 6865 723d 6f74 6865 7229 0a0a  , other=other)..
+00039730: 2020 2020 7265 7375 6c74 203d 206e 6577      result = new
+00039740: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
+00039750: 2c20 5f6e 616d 652c 206d 6574 612c 2064  , _name, meta, d
+00039760: 6976 6973 696f 6e73 290a 2020 2020 7265  ivisions).    re
+00039770: 7475 726e 2068 616e 646c 655f 6f75 7428  turn handle_out(
+00039780: 6f75 742c 2072 6573 756c 7429 0a0a 0a64  out, result)...d
+00039790: 6566 2068 616e 646c 655f 6f75 7428 6f75  ef handle_out(ou
+000397a0: 742c 2072 6573 756c 7429 3a0a 2020 2020  t, result):.    
+000397b0: 2222 2248 616e 646c 6520 6f75 7420 7061  """Handle out pa
+000397c0: 7261 6d65 7465 7273 0a0a 2020 2020 4966  rameters..    If
+000397d0: 206f 7574 2069 7320 6120 6461 736b 2e44   out is a dask.D
+000397e0: 6174 6146 7261 6d65 2c20 6461 736b 2e53  ataFrame, dask.S
+000397f0: 6572 6965 7320 6f72 2064 6173 6b2e 5363  eries or dask.Sc
+00039800: 616c 6172 2074 6865 6e0a 2020 2020 7468  alar then.    th
+00039810: 6973 206f 7665 7277 7269 7465 7320 7468  is overwrites th
+00039820: 6520 636f 6e74 656e 7473 206f 6620 6974  e contents of it
+00039830: 2077 6974 6820 7468 6520 7265 7375 6c74   with the result
+00039840: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
+00039850: 6973 696e 7374 616e 6365 286f 7574 2c20  isinstance(out, 
+00039860: 7475 706c 6529 3a0a 2020 2020 2020 2020  tuple):.        
+00039870: 6966 206c 656e 286f 7574 2920 3d3d 2031  if len(out) == 1
+00039880: 3a0a 2020 2020 2020 2020 2020 2020 6f75  :.            ou
+00039890: 7420 3d20 6f75 745b 305d 0a20 2020 2020  t = out[0].     
+000398a0: 2020 2065 6c69 6620 6c65 6e28 6f75 7429     elif len(out)
+000398b0: 203e 2031 3a0a 2020 2020 2020 2020 2020   > 1:.          
+000398c0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+000398d0: 6d65 6e74 6564 4572 726f 7228 2254 6865  mentedError("The
+000398e0: 206f 7574 2070 6172 616d 6574 6572 2069   out parameter i
+000398f0: 7320 6e6f 7420 6675 6c6c 7920 7375 7070  s not fully supp
+00039900: 6f72 7465 6422 290a 2020 2020 2020 2020  orted").        
+00039910: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00039920: 2020 6f75 7420 3d20 4e6f 6e65 0a0a 2020    out = None..  
+00039930: 2020 2320 4e6f 7469 6365 2c20 7765 2075    # Notice, we u
+00039940: 7365 202e 5f5f 636c 6173 735f 5f20 6173  se .__class__ as
+00039950: 206f 7070 6f73 6564 2074 6f20 7479 7065   opposed to type
+00039960: 2829 2069 6e20 6f72 6465 7220 746f 2073  () in order to s
+00039970: 7570 706f 7274 0a20 2020 2023 206f 626a  upport.    # obj
+00039980: 6563 7420 7072 6f78 6965 7320 7365 6520  ect proxies see 
+00039990: 3c68 7474 7073 3a2f 2f67 6974 6875 622e  <https://github.
+000399a0: 636f 6d2f 6461 736b 2f64 6173 6b2f 7075  com/dask/dask/pu
+000399b0: 6c6c 2f36 3938 313e 0a20 2020 2069 6620  ll/6981>.    if 
+000399c0: 6f75 7420 6973 206e 6f74 204e 6f6e 6520  out is not None 
+000399d0: 616e 6420 6f75 742e 5f5f 636c 6173 735f  and out.__class_
+000399e0: 5f20 213d 2072 6573 756c 742e 5f5f 636c  _ != result.__cl
+000399f0: 6173 735f 5f3a 0a20 2020 2020 2020 2072  ass__:.        r
+00039a00: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
+00039a10: 2020 2020 2020 2020 2020 2020 224d 6973              "Mis
+00039a20: 6d61 7463 6865 6420 7479 7065 7320 6265  matched types be
+00039a30: 7477 6565 6e20 7265 7375 6c74 2061 6e64  tween result and
+00039a40: 206f 7574 2070 6172 616d 6574 6572 2e20   out parameter. 
+00039a50: 220a 2020 2020 2020 2020 2020 2020 226f  ".            "o
+00039a60: 7574 3d25 732c 2072 6573 756c 743d 2573  ut=%s, result=%s
+00039a70: 2220 2520 2873 7472 2874 7970 6528 6f75  " % (str(type(ou
+00039a80: 7429 292c 2073 7472 2874 7970 6528 7265  t)), str(type(re
+00039a90: 7375 6c74 2929 290a 2020 2020 2020 2020  sult))).        
+00039aa0: 290a 0a20 2020 2069 6620 6973 696e 7374  )..    if isinst
+00039ab0: 616e 6365 286f 7574 2c20 4461 7461 4672  ance(out, DataFr
+00039ac0: 616d 6529 3a0a 2020 2020 2020 2020 6966  ame):.        if
+00039ad0: 206c 656e 286f 7574 2e63 6f6c 756d 6e73   len(out.columns
+00039ae0: 2920 213d 206c 656e 2872 6573 756c 742e  ) != len(result.
+00039af0: 636f 6c75 6d6e 7329 3a0a 2020 2020 2020  columns):.      
+00039b00: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00039b10: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00039b20: 2020 2020 2020 2020 224d 6973 6d61 7463          "Mismatc
+00039b30: 6865 6420 636f 6c75 6d6e 7320 636f 756e  hed columns coun
+00039b40: 7420 6265 7477 6565 6e20 7265 7375 6c74  t between result
+00039b50: 2061 6e64 206f 7574 2070 6172 616d 6574   and out paramet
+00039b60: 6572 2e20 220a 2020 2020 2020 2020 2020  er. ".          
+00039b70: 2020 2020 2020 226f 7574 3d25 732c 2072        "out=%s, r
+00039b80: 6573 756c 743d 2573 2220 2520 2873 7472  esult=%s" % (str
+00039b90: 286c 656e 286f 7574 2e63 6f6c 756d 6e73  (len(out.columns
+00039ba0: 2929 2c20 7374 7228 6c65 6e28 7265 7375  )), str(len(resu
+00039bb0: 6c74 2e63 6f6c 756d 6e73 2929 290a 2020  lt.columns))).  
+00039bc0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00039bd0: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
+00039be0: 7574 2c20 2853 6572 6965 732c 2044 6174  ut, (Series, Dat
+00039bf0: 6146 7261 6d65 2c20 5363 616c 6172 2929  aFrame, Scalar))
+00039c00: 3a0a 2020 2020 2020 2020 6f75 742e 5f6d  :.        out._m
+00039c10: 6574 6120 3d20 7265 7375 6c74 2e5f 6d65  eta = result._me
+00039c20: 7461 0a20 2020 2020 2020 206f 7574 2e5f  ta.        out._
+00039c30: 6e61 6d65 203d 2072 6573 756c 742e 5f6e  name = result._n
+00039c40: 616d 650a 2020 2020 2020 2020 6f75 742e  ame.        out.
+00039c50: 6461 736b 203d 2072 6573 756c 742e 6461  dask = result.da
+00039c60: 736b 0a0a 2020 2020 2020 2020 6966 206e  sk..        if n
+00039c70: 6f74 2069 7369 6e73 7461 6e63 6528 6f75  ot isinstance(ou
+00039c80: 742c 2053 6361 6c61 7229 3a0a 2020 2020  t, Scalar):.    
+00039c90: 2020 2020 2020 2020 6f75 742e 5f64 6976          out._div
+00039ca0: 6973 696f 6e73 203d 2072 6573 756c 742e  isions = result.
+00039cb0: 6469 7669 7369 6f6e 730a 2020 2020 656c  divisions.    el
+00039cc0: 6966 206f 7574 2069 7320 6e6f 7420 4e6f  if out is not No
+00039cd0: 6e65 3a0a 2020 2020 2020 2020 6d73 6720  ne:.        msg 
+00039ce0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00039cf0: 2254 6865 206f 7574 2070 6172 616d 6574  "The out paramet
+00039d00: 6572 2069 7320 6e6f 7420 6675 6c6c 7920  er is not fully 
+00039d10: 7375 7070 6f72 7465 642e 220a 2020 2020  supported.".    
+00039d20: 2020 2020 2020 2020 2220 5265 6365 6976          " Receiv
+00039d30: 6564 2074 7970 6520 2573 2c20 6578 7065  ed type %s, expe
+00039d40: 6374 6564 2025 7320 220a 2020 2020 2020  cted %s ".      
+00039d50: 2020 2020 2020 2520 280a 2020 2020 2020        % (.      
+00039d60: 2020 2020 2020 2020 2020 7479 7065 6e61            typena
+00039d70: 6d65 2874 7970 6528 6f75 7429 292c 0a20  me(type(out)),. 
+00039d80: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00039d90: 7970 656e 616d 6528 7479 7065 2872 6573  ypename(type(res
+00039da0: 756c 7429 292c 0a20 2020 2020 2020 2020  ult)),.         
+00039db0: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
+00039dc0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00039dd0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00039de0: 286d 7367 290a 2020 2020 656c 7365 3a0a  (msg).    else:.
+00039df0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00039e00: 6573 756c 740a 0a0a 6465 6620 5f6d 6179  esult...def _may
+00039e10: 6265 5f66 726f 6d5f 7061 6e64 6173 2864  be_from_pandas(d
+00039e20: 6673 293a 0a20 2020 2066 726f 6d20 6461  fs):.    from da
+00039e30: 736b 2e64 6174 6166 7261 6d65 2e69 6f20  sk.dataframe.io 
+00039e40: 696d 706f 7274 2066 726f 6d5f 7061 6e64  import from_pand
+00039e50: 6173 0a0a 2020 2020 6466 7320 3d20 5b0a  as..    dfs = [.
+00039e60: 2020 2020 2020 2020 6672 6f6d 5f70 616e          from_pan
+00039e70: 6461 7328 6466 2c20 3129 0a20 2020 2020  das(df, 1).     
+00039e80: 2020 2069 6620 2869 735f 7365 7269 6573     if (is_series
+00039e90: 5f6c 696b 6528 6466 2920 6f72 2069 735f  _like(df) or is_
+00039ea0: 6461 7461 6672 616d 655f 6c69 6b65 2864  dataframe_like(d
+00039eb0: 6629 2920 616e 6420 6e6f 7420 6973 5f64  f)) and not is_d
+00039ec0: 6173 6b5f 636f 6c6c 6563 7469 6f6e 2864  ask_collection(d
+00039ed0: 6629 0a20 2020 2020 2020 2065 6c73 6520  f).        else 
+00039ee0: 6466 0a20 2020 2020 2020 2066 6f72 2064  df.        for d
+00039ef0: 6620 696e 2064 6673 0a20 2020 205d 0a20  f in dfs.    ]. 
+00039f00: 2020 2072 6574 7572 6e20 6466 730a 0a0a     return dfs...
+00039f10: 6465 6620 6861 7368 5f73 6861 7264 280a  def hash_shard(.
+00039f20: 2020 2020 6466 2c20 6e70 6172 7473 2c20      df, nparts, 
+00039f30: 7370 6c69 745f 6f75 745f 7365 7475 703d  split_out_setup=
+00039f40: 4e6f 6e65 2c20 7370 6c69 745f 6f75 745f  None, split_out_
+00039f50: 7365 7475 705f 6b77 6172 6773 3d4e 6f6e  setup_kwargs=Non
+00039f60: 652c 2069 676e 6f72 655f 696e 6465 783d  e, ignore_index=
+00039f70: 4661 6c73 650a 293a 0a20 2020 2069 6620  False.):.    if 
+00039f80: 7370 6c69 745f 6f75 745f 7365 7475 703a  split_out_setup:
+00039f90: 0a20 2020 2020 2020 2068 203d 2073 706c  .        h = spl
+00039fa0: 6974 5f6f 7574 5f73 6574 7570 2864 662c  it_out_setup(df,
+00039fb0: 202a 2a28 7370 6c69 745f 6f75 745f 7365   **(split_out_se
+00039fc0: 7475 705f 6b77 6172 6773 206f 7220 7b7d  tup_kwargs or {}
+00039fd0: 2929 0a20 2020 2065 6c73 653a 0a20 2020  )).    else:.   
+00039fe0: 2020 2020 2068 203d 2064 660a 0a20 2020       h = df..   
+00039ff0: 2068 203d 2068 6173 685f 6f62 6a65 6374   h = hash_object
+0003a000: 5f64 6973 7061 7463 6828 682c 2069 6e64  _dispatch(h, ind
+0003a010: 6578 3d46 616c 7365 290a 2020 2020 7265  ex=False).    re
+0003a020: 7475 726e 2067 726f 7570 5f73 706c 6974  turn group_split
+0003a030: 5f64 6973 7061 7463 6828 6466 2c20 6820  _dispatch(df, h 
+0003a040: 2520 6e70 6172 7473 2c20 6e70 6172 7473  % nparts, nparts
+0003a050: 2c20 6967 6e6f 7265 5f69 6e64 6578 3d69  , ignore_index=i
+0003a060: 676e 6f72 655f 696e 6465 7829 0a0a 0a64  gnore_index)...d
+0003a070: 6566 2073 706c 6974 5f65 7665 6e6c 7928  ef split_evenly(
+0003a080: 6466 2c20 6b29 3a0a 2020 2020 2222 2253  df, k):.    """S
+0003a090: 706c 6974 2064 6174 6166 7261 6d65 2069  plit dataframe i
+0003a0a0: 6e74 6f20 6b20 726f 7567 686c 7920 6571  nto k roughly eq
+0003a0b0: 7561 6c20 7061 7274 7322 2222 0a20 2020  ual parts""".   
+0003a0c0: 2064 6976 6973 696f 6e73 203d 206e 702e   divisions = np.
+0003a0d0: 6c69 6e73 7061 6365 2830 2c20 6c65 6e28  linspace(0, len(
+0003a0e0: 6466 292c 206b 202b 2031 292e 6173 7479  df), k + 1).asty
+0003a0f0: 7065 2869 6e74 290a 2020 2020 7265 7475  pe(int).    retu
+0003a100: 726e 207b 693a 2064 662e 696c 6f63 5b64  rn {i: df.iloc[d
+0003a110: 6976 6973 696f 6e73 5b69 5d20 3a20 6469  ivisions[i] : di
+0003a120: 7669 7369 6f6e 735b 6920 2b20 315d 5d20  visions[i + 1]] 
+0003a130: 666f 7220 6920 696e 2072 616e 6765 286b  for i in range(k
+0003a140: 297d 0a0a 0a64 6566 2073 706c 6974 5f6f  )}...def split_o
+0003a150: 7574 5f6f 6e5f 696e 6465 7828 6466 293a  ut_on_index(df):
+0003a160: 0a20 2020 2068 203d 2064 662e 696e 6465  .    h = df.inde
+0003a170: 780a 2020 2020 6966 2069 7369 6e73 7461  x.    if isinsta
+0003a180: 6e63 6528 682c 2070 642e 4d75 6c74 6949  nce(h, pd.MultiI
+0003a190: 6e64 6578 293a 0a20 2020 2020 2020 2068  ndex):.        h
+0003a1a0: 203d 206d 6574 615f 6672 616d 655f 636f   = meta_frame_co
+0003a1b0: 6e73 7472 7563 746f 7228 6466 2928 5b5d  nstructor(df)([]
+0003a1c0: 2c20 696e 6465 783d 6829 2e72 6573 6574  , index=h).reset
+0003a1d0: 5f69 6e64 6578 2829 0a20 2020 2072 6574  _index().    ret
+0003a1e0: 7572 6e20 680a 0a0a 6465 6620 7370 6c69  urn h...def spli
+0003a1f0: 745f 6f75 745f 6f6e 5f63 6f6c 7328 6466  t_out_on_cols(df
+0003a200: 2c20 636f 6c73 3d4e 6f6e 6529 3a0a 2020  , cols=None):.  
+0003a210: 2020 7265 7475 726e 2064 665b 636f 6c73    return df[cols
+0003a220: 5d0a 0a0a 4069 6e73 6572 745f 6d65 7461  ]...@insert_meta
+0003a230: 5f70 6172 616d 5f64 6573 6372 6970 7469  _param_descripti
+0003a240: 6f6e 0a64 6566 2061 7070 6c79 5f63 6f6e  on.def apply_con
+0003a250: 6361 745f 6170 706c 7928 0a20 2020 2061  cat_apply(.    a
+0003a260: 7267 732c 0a20 2020 2063 6875 6e6b 3d4e  rgs,.    chunk=N
+0003a270: 6f6e 652c 0a20 2020 2061 6767 7265 6761  one,.    aggrega
+0003a280: 7465 3d4e 6f6e 652c 0a20 2020 2063 6f6d  te=None,.    com
+0003a290: 6269 6e65 3d4e 6f6e 652c 0a20 2020 206d  bine=None,.    m
+0003a2a0: 6574 613d 6e6f 5f64 6566 6175 6c74 2c0a  eta=no_default,.
+0003a2b0: 2020 2020 746f 6b65 6e3d 4e6f 6e65 2c0a      token=None,.
+0003a2c0: 2020 2020 6368 756e 6b5f 6b77 6172 6773      chunk_kwargs
+0003a2d0: 3d4e 6f6e 652c 0a20 2020 2061 6767 7265  =None,.    aggre
+0003a2e0: 6761 7465 5f6b 7761 7267 733d 4e6f 6e65  gate_kwargs=None
+0003a2f0: 2c0a 2020 2020 636f 6d62 696e 655f 6b77  ,.    combine_kw
+0003a300: 6172 6773 3d4e 6f6e 652c 0a20 2020 2073  args=None,.    s
+0003a310: 706c 6974 5f65 7665 7279 3d4e 6f6e 652c  plit_every=None,
+0003a320: 0a20 2020 2073 706c 6974 5f6f 7574 3d4e  .    split_out=N
+0003a330: 6f6e 652c 0a20 2020 2073 706c 6974 5f6f  one,.    split_o
+0003a340: 7574 5f73 6574 7570 3d4e 6f6e 652c 0a20  ut_setup=None,. 
+0003a350: 2020 2073 706c 6974 5f6f 7574 5f73 6574     split_out_set
+0003a360: 7570 5f6b 7761 7267 733d 4e6f 6e65 2c0a  up_kwargs=None,.
+0003a370: 2020 2020 736f 7274 3d4e 6f6e 652c 0a20      sort=None,. 
+0003a380: 2020 2069 676e 6f72 655f 696e 6465 783d     ignore_index=
+0003a390: 4661 6c73 652c 0a20 2020 202a 2a6b 7761  False,.    **kwa
+0003a3a0: 7267 732c 0a29 3a0a 2020 2020 2222 2241  rgs,.):.    """A
+0003a3b0: 7070 6c79 2061 2066 756e 6374 696f 6e20  pply a function 
+0003a3c0: 746f 2062 6c6f 636b 732c 2074 6865 6e20  to blocks, then 
+0003a3d0: 636f 6e63 6174 2c20 7468 656e 2061 7070  concat, then app
+0003a3e0: 6c79 2061 6761 696e 0a0a 2020 2020 5061  ly again..    Pa
+0003a3f0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+0003a400: 2d2d 2d2d 2d2d 2d0a 2020 2020 6172 6773  -------.    args
+0003a410: 203a 0a20 2020 2020 2020 2050 6f73 6974   :.        Posit
+0003a420: 696f 6e61 6c20 6172 6775 6d65 6e74 7320  ional arguments 
+0003a430: 666f 7220 7468 6520 6063 6875 6e6b 6020  for the `chunk` 
+0003a440: 6675 6e63 7469 6f6e 2e20 416c 6c20 6064  function. All `d
+0003a450: 6173 6b2e 6461 7461 6672 616d 6560 0a20  ask.dataframe`. 
+0003a460: 2020 2020 2020 206f 626a 6563 7473 2073         objects s
+0003a470: 686f 756c 6420 6265 2070 6172 7469 7469  hould be partiti
+0003a480: 6f6e 6564 2061 6e64 2069 6e64 6578 6564  oned and indexed
+0003a490: 2065 7175 6976 616c 656e 746c 792e 0a20   equivalently.. 
+0003a4a0: 2020 2063 6875 6e6b 203a 2066 756e 6374     chunk : funct
+0003a4b0: 696f 6e20 5b62 6c6f 636b 2d70 6572 2d61  ion [block-per-a
+0003a4c0: 7267 5d20 2d3e 2062 6c6f 636b 0a20 2020  rg] -> block.   
+0003a4d0: 2020 2020 2046 756e 6374 696f 6e20 746f       Function to
+0003a4e0: 206f 7065 7261 7465 206f 6e20 6561 6368   operate on each
+0003a4f0: 2062 6c6f 636b 206f 6620 6461 7461 0a20   block of data. 
+0003a500: 2020 2061 6767 7265 6761 7465 203a 2066     aggregate : f
+0003a510: 756e 6374 696f 6e20 636f 6e63 6174 656e  unction concaten
+0003a520: 6174 6564 2d62 6c6f 636b 202d 3e20 626c  ated-block -> bl
+0003a530: 6f63 6b0a 2020 2020 2020 2020 4675 6e63  ock.        Func
+0003a540: 7469 6f6e 2074 6f20 6f70 6572 6174 6520  tion to operate 
+0003a550: 6f6e 2074 6865 2063 6f6e 6361 7465 6e61  on the concatena
+0003a560: 7465 6420 7265 7375 6c74 206f 6620 6368  ted result of ch
+0003a570: 756e 6b0a 2020 2020 636f 6d62 696e 6520  unk.    combine 
+0003a580: 3a20 6675 6e63 7469 6f6e 2063 6f6e 6361  : function conca
+0003a590: 7465 6e61 7465 642d 626c 6f63 6b20 2d3e  tenated-block ->
+0003a5a0: 2062 6c6f 636b 2c20 6f70 7469 6f6e 616c   block, optional
+0003a5b0: 0a20 2020 2020 2020 2046 756e 6374 696f  .        Functio
+0003a5c0: 6e20 746f 206f 7065 7261 7465 206f 6e20  n to operate on 
+0003a5d0: 696e 7465 726d 6564 6961 7465 2063 6f6e  intermediate con
+0003a5e0: 6361 7465 6e61 7465 6420 7265 7375 6c74  catenated result
+0003a5f0: 7320 6f66 2063 6875 6e6b 0a20 2020 2020  s of chunk.     
+0003a600: 2020 2069 6e20 6120 7472 6565 2d72 6564     in a tree-red
+0003a610: 7563 7469 6f6e 2e20 4966 206e 6f74 2070  uction. If not p
+0003a620: 726f 7669 6465 642c 2064 6566 6175 6c74  rovided, default
+0003a630: 7320 746f 2061 6767 7265 6761 7465 2e0a  s to aggregate..
+0003a640: 2020 2020 244d 4554 410a 2020 2020 746f      $META.    to
+0003a650: 6b65 6e20 3a20 7374 722c 206f 7074 696f  ken : str, optio
+0003a660: 6e61 6c0a 2020 2020 2020 2020 5468 6520  nal.        The 
+0003a670: 6e61 6d65 2074 6f20 7573 6520 666f 7220  name to use for 
+0003a680: 7468 6520 6f75 7470 7574 206b 6579 732e  the output keys.
+0003a690: 0a20 2020 2063 6875 6e6b 5f6b 7761 7267  .    chunk_kwarg
+0003a6a0: 7320 3a20 6469 6374 2c20 6f70 7469 6f6e  s : dict, option
+0003a6b0: 616c 0a20 2020 2020 2020 204b 6579 776f  al.        Keywo
+0003a6c0: 7264 7320 666f 7220 7468 6520 6368 756e  rds for the chun
+0003a6d0: 6b20 6675 6e63 7469 6f6e 206f 6e6c 792e  k function only.
+0003a6e0: 0a20 2020 2061 6767 7265 6761 7465 5f6b  .    aggregate_k
+0003a6f0: 7761 7267 7320 3a20 6469 6374 2c20 6f70  wargs : dict, op
+0003a700: 7469 6f6e 616c 0a20 2020 2020 2020 204b  tional.        K
+0003a710: 6579 776f 7264 7320 666f 7220 7468 6520  eywords for the 
+0003a720: 6167 6772 6567 6174 6520 6675 6e63 7469  aggregate functi
+0003a730: 6f6e 206f 6e6c 792e 0a20 2020 2063 6f6d  on only..    com
+0003a740: 6269 6e65 5f6b 7761 7267 7320 3a20 6469  bine_kwargs : di
+0003a750: 6374 2c20 6f70 7469 6f6e 616c 0a20 2020  ct, optional.   
+0003a760: 2020 2020 204b 6579 776f 7264 7320 666f       Keywords fo
+0003a770: 7220 7468 6520 636f 6d62 696e 6520 6675  r the combine fu
+0003a780: 6e63 7469 6f6e 206f 6e6c 792e 0a20 2020  nction only..   
+0003a790: 2073 706c 6974 5f65 7665 7279 203a 2069   split_every : i
+0003a7a0: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
+0003a7b0: 2020 2020 2047 726f 7570 2070 6172 7469       Group parti
+0003a7c0: 7469 6f6e 7320 696e 746f 2067 726f 7570  tions into group
+0003a7d0: 7320 6f66 2074 6869 7320 7369 7a65 2077  s of this size w
+0003a7e0: 6869 6c65 2070 6572 666f 726d 696e 6720  hile performing 
+0003a7f0: 610a 2020 2020 2020 2020 7472 6565 2d72  a.        tree-r
+0003a800: 6564 7563 7469 6f6e 2e20 4966 2073 6574  eduction. If set
+0003a810: 2074 6f20 4661 6c73 652c 206e 6f20 7472   to False, no tr
+0003a820: 6565 2d72 6564 7563 7469 6f6e 2077 696c  ee-reduction wil
+0003a830: 6c20 6265 2075 7365 642c 0a20 2020 2020  l be used,.     
+0003a840: 2020 2061 6e64 2061 6c6c 2069 6e74 6572     and all inter
+0003a850: 6d65 6469 6174 6573 2077 696c 6c20 6265  mediates will be
+0003a860: 2063 6f6e 6361 7465 6e61 7465 6420 616e   concatenated an
+0003a870: 6420 7061 7373 6564 2074 6f20 6060 6167  d passed to ``ag
+0003a880: 6772 6567 6174 6560 602e 0a20 2020 2020  gregate``..     
+0003a890: 2020 2044 6566 6175 6c74 2069 7320 382e     Default is 8.
+0003a8a0: 0a20 2020 2073 706c 6974 5f6f 7574 203a  .    split_out :
+0003a8b0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
+0003a8c0: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
+0003a8d0: 206f 7574 7075 7420 7061 7274 6974 696f   output partitio
+0003a8e0: 6e73 2e20 5370 6c69 7420 6f63 6375 7273  ns. Split occurs
+0003a8f0: 2061 6674 6572 2066 6972 7374 2063 6875   after first chu
+0003a900: 6e6b 2072 6564 7563 7469 6f6e 2e0a 2020  nk reduction..  
+0003a910: 2020 7370 6c69 745f 6f75 745f 7365 7475    split_out_setu
+0003a920: 7020 3a20 6361 6c6c 6162 6c65 2c20 6f70  p : callable, op
+0003a930: 7469 6f6e 616c 0a20 2020 2020 2020 2049  tional.        I
+0003a940: 6620 7072 6f76 6964 6564 2c20 7468 6973  f provided, this
+0003a950: 2066 756e 6374 696f 6e20 6973 2063 616c   function is cal
+0003a960: 6c65 6420 6f6e 2065 6163 6820 6368 756e  led on each chun
+0003a970: 6b20 6265 666f 7265 2070 6572 666f 726d  k before perform
+0003a980: 696e 670a 2020 2020 2020 2020 7468 6520  ing.        the 
+0003a990: 6861 7368 2d73 706c 6974 2e20 4974 2073  hash-split. It s
+0003a9a0: 686f 756c 6420 7265 7475 726e 2061 2070  hould return a p
+0003a9b0: 616e 6461 7320 6f62 6a65 6374 2c20 7768  andas object, wh
+0003a9c0: 6572 6520 6561 6368 2072 6f77 0a20 2020  ere each row.   
+0003a9d0: 2020 2020 2028 6578 636c 7564 696e 6720       (excluding 
+0003a9e0: 7468 6520 696e 6465 7829 2069 7320 6861  the index) is ha
+0003a9f0: 7368 6564 2e20 4966 206e 6f74 2070 726f  shed. If not pro
+0003aa00: 7669 6465 642c 2074 6865 2063 6875 6e6b  vided, the chunk
+0003aa10: 2069 7320 6861 7368 6564 0a20 2020 2020   is hashed.     
+0003aa20: 2020 2061 7320 6973 2e0a 2020 2020 7370     as is..    sp
+0003aa30: 6c69 745f 6f75 745f 7365 7475 705f 6b77  lit_out_setup_kw
+0003aa40: 6172 6773 203a 2064 6963 742c 206f 7074  args : dict, opt
+0003aa50: 696f 6e61 6c0a 2020 2020 2020 2020 4b65  ional.        Ke
+0003aa60: 7977 6f72 6473 2066 6f72 2074 6865 2060  ywords for the `
+0003aa70: 7370 6c69 745f 6f75 745f 7365 7475 7060  split_out_setup`
+0003aa80: 2066 756e 6374 696f 6e20 6f6e 6c79 2e0a   function only..
+0003aa90: 2020 2020 736f 7274 203a 2062 6f6f 6c2c      sort : bool,
+0003aaa0: 2064 6566 6175 6c74 204e 6f6e 650a 2020   default None.  
+0003aab0: 2020 2020 2020 4966 2061 6c6c 6f77 6564        If allowed
+0003aac0: 2c20 736f 7274 2074 6865 206b 6579 7320  , sort the keys 
+0003aad0: 6f66 2074 6865 206f 7574 7075 7420 6167  of the output ag
+0003aae0: 6772 6567 6174 696f 6e2e 0a20 2020 2069  gregation..    i
+0003aaf0: 676e 6f72 655f 696e 6465 7820 3a20 626f  gnore_index : bo
+0003ab00: 6f6c 2c20 6465 6661 756c 7420 4661 6c73  ol, default Fals
+0003ab10: 650a 2020 2020 2020 2020 4966 2054 7275  e.        If Tru
+0003ab20: 652c 2064 6f20 6e6f 7420 7072 6573 6572  e, do not preser
+0003ab30: 7665 2069 6e64 6578 2076 616c 7565 7320  ve index values 
+0003ab40: 7468 726f 7567 686f 7574 2041 4341 206f  throughout ACA o
+0003ab50: 7065 7261 7469 6f6e 732e 0a20 2020 206b  perations..    k
+0003ab60: 7761 7267 7320 3a0a 2020 2020 2020 2020  wargs :.        
+0003ab70: 416c 6c20 7265 6d61 696e 696e 6720 6b65  All remaining ke
+0003ab80: 7977 6f72 6473 2077 696c 6c20 6265 2070  ywords will be p
+0003ab90: 6173 7365 6420 746f 2060 6063 6875 6e6b  assed to ``chunk
+0003aba0: 6060 2c20 6060 6167 6772 6567 6174 6560  ``, ``aggregate`
+0003abb0: 602c 2061 6e64 0a20 2020 2020 2020 2060  `, and.        `
+0003abc0: 6063 6f6d 6269 6e65 6060 2e0a 0a20 2020  `combine``...   
+0003abd0: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
+0003abe0: 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e 2064  ------.    >>> d
+0003abf0: 6566 2063 6875 6e6b 2861 5f62 6c6f 636b  ef chunk(a_block
+0003ac00: 2c20 625f 626c 6f63 6b29 3a0a 2020 2020  , b_block):.    
+0003ac10: 2e2e 2e20 2020 2020 7061 7373 0a0a 2020  ...     pass..  
+0003ac20: 2020 3e3e 3e20 6465 6620 6167 6728 6466    >>> def agg(df
+0003ac30: 293a 0a20 2020 202e 2e2e 2020 2020 2070  ):.    ...     p
+0003ac40: 6173 730a 0a20 2020 203e 3e3e 2061 7070  ass..    >>> app
+0003ac50: 6c79 5f63 6f6e 6361 745f 6170 706c 7928  ly_concat_apply(
+0003ac60: 5b61 2c20 625d 2c20 6368 756e 6b3d 6368  [a, b], chunk=ch
+0003ac70: 756e 6b2c 2061 6767 7265 6761 7465 3d61  unk, aggregate=a
+0003ac80: 6767 2920 2023 2064 6f63 7465 7374 3a20  gg)  # doctest: 
+0003ac90: 2b53 4b49 500a 2020 2020 2222 220a 2020  +SKIP.    """.  
+0003aca0: 2020 6966 2073 706c 6974 5f6f 7574 2069    if split_out i
+0003acb0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0003acc0: 7370 6c69 745f 6f75 7420 3d20 310a 2020  split_out = 1.  
+0003acd0: 2020 6966 2063 6875 6e6b 5f6b 7761 7267    if chunk_kwarg
+0003ace0: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
+0003acf0: 2020 2063 6875 6e6b 5f6b 7761 7267 7320     chunk_kwargs 
+0003ad00: 3d20 6469 6374 2829 0a20 2020 2069 6620  = dict().    if 
+0003ad10: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
+0003ad20: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0003ad30: 2020 6167 6772 6567 6174 655f 6b77 6172    aggregate_kwar
+0003ad40: 6773 203d 2064 6963 7428 290a 2020 2020  gs = dict().    
+0003ad50: 6368 756e 6b5f 6b77 6172 6773 2e75 7064  chunk_kwargs.upd
+0003ad60: 6174 6528 6b77 6172 6773 290a 2020 2020  ate(kwargs).    
+0003ad70: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
+0003ad80: 2e75 7064 6174 6528 6b77 6172 6773 290a  .update(kwargs).
+0003ad90: 0a20 2020 2069 6620 636f 6d62 696e 6520  .    if combine 
+0003ada0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0003adb0: 2069 6620 636f 6d62 696e 655f 6b77 6172   if combine_kwar
+0003adc0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+0003add0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0003ade0: 2822 6063 6f6d 6269 6e65 5f6b 7761 7267  ("`combine_kwarg
+0003adf0: 7360 2070 726f 7669 6465 6420 7769 7468  s` provided with
+0003ae00: 206e 6f20 6063 6f6d 6269 6e65 6022 290a   no `combine`").
+0003ae10: 2020 2020 2020 2020 636f 6d62 696e 6520          combine 
+0003ae20: 3d20 6167 6772 6567 6174 650a 2020 2020  = aggregate.    
+0003ae30: 2020 2020 636f 6d62 696e 655f 6b77 6172      combine_kwar
+0003ae40: 6773 203d 2061 6767 7265 6761 7465 5f6b  gs = aggregate_k
+0003ae50: 7761 7267 730a 2020 2020 656c 7365 3a0a  wargs.    else:.
+0003ae60: 2020 2020 2020 2020 6966 2063 6f6d 6269          if combi
+0003ae70: 6e65 5f6b 7761 7267 7320 6973 204e 6f6e  ne_kwargs is Non
+0003ae80: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
+0003ae90: 6f6d 6269 6e65 5f6b 7761 7267 7320 3d20  ombine_kwargs = 
+0003aea0: 6469 6374 2829 0a20 2020 2020 2020 2063  dict().        c
+0003aeb0: 6f6d 6269 6e65 5f6b 7761 7267 732e 7570  ombine_kwargs.up
+0003aec0: 6461 7465 286b 7761 7267 7329 0a0a 2020  date(kwargs)..  
+0003aed0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+0003aee0: 6e63 6528 6172 6773 2c20 2874 7570 6c65  nce(args, (tuple
+0003aef0: 2c20 6c69 7374 2929 3a0a 2020 2020 2020  , list)):.      
+0003af00: 2020 6172 6773 203d 205b 6172 6773 5d0a    args = [args].
+0003af10: 0a20 2020 2064 6673 203d 205b 6172 6720  .    dfs = [arg 
+0003af20: 666f 7220 6172 6720 696e 2061 7267 7320  for arg in args 
+0003af30: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
+0003af40: 672c 205f 4672 616d 6529 5d0a 0a20 2020  g, _Frame)]..   
+0003af50: 206e 7061 7274 6974 696f 6e73 203d 207b   npartitions = {
+0003af60: 6172 672e 6e70 6172 7469 7469 6f6e 7320  arg.npartitions 
+0003af70: 666f 7220 6172 6720 696e 2064 6673 7d0a  for arg in dfs}.
+0003af80: 2020 2020 6966 206c 656e 286e 7061 7274      if len(npart
+0003af90: 6974 696f 6e73 2920 3e20 313a 0a20 2020  itions) > 1:.   
+0003afa0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0003afb0: 4572 726f 7228 2241 6c6c 2061 7267 756d  Error("All argum
+0003afc0: 656e 7473 206d 7573 7420 6861 7665 2073  ents must have s
+0003afd0: 616d 6520 6e75 6d62 6572 206f 6620 7061  ame number of pa
+0003afe0: 7274 6974 696f 6e73 2229 0a20 2020 206e  rtitions").    n
+0003aff0: 7061 7274 6974 696f 6e73 203d 206e 7061  partitions = npa
+0003b000: 7274 6974 696f 6e73 2e70 6f70 2829 0a0a  rtitions.pop()..
+0003b010: 2020 2020 6966 2073 706c 6974 5f65 7665      if split_eve
+0003b020: 7279 2069 7320 4e6f 6e65 3a0a 2020 2020  ry is None:.    
+0003b030: 2020 2020 7370 6c69 745f 6576 6572 7920      split_every 
+0003b040: 3d20 380a 2020 2020 656c 6966 2073 706c  = 8.    elif spl
+0003b050: 6974 5f65 7665 7279 2069 7320 4661 6c73  it_every is Fals
+0003b060: 653a 0a20 2020 2020 2020 2073 706c 6974  e:.        split
+0003b070: 5f65 7665 7279 203d 206e 7061 7274 6974  _every = npartit
+0003b080: 696f 6e73 0a20 2020 2065 6c69 6620 7370  ions.    elif sp
+0003b090: 6c69 745f 6576 6572 7920 3c20 3220 6f72  lit_every < 2 or
+0003b0a0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+0003b0b0: 7370 6c69 745f 6576 6572 792c 2049 6e74  split_every, Int
+0003b0c0: 6567 7261 6c29 3a0a 2020 2020 2020 2020  egral):.        
+0003b0d0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0003b0e0: 2822 7370 6c69 745f 6576 6572 7920 6d75  ("split_every mu
+0003b0f0: 7374 2062 6520 616e 2069 6e74 6567 6572  st be an integer
+0003b100: 203e 3d20 3222 290a 0a20 2020 2074 6f6b   >= 2")..    tok
+0003b110: 656e 5f6b 6579 203d 2074 6f6b 656e 697a  en_key = tokeniz
+0003b120: 6528 0a20 2020 2020 2020 2074 6f6b 656e  e(.        token
+0003b130: 206f 7220 2863 6875 6e6b 2c20 6167 6772   or (chunk, aggr
+0003b140: 6567 6174 6529 2c0a 2020 2020 2020 2020  egate),.        
+0003b150: 6d65 7461 2c0a 2020 2020 2020 2020 6172  meta,.        ar
+0003b160: 6773 2c0a 2020 2020 2020 2020 6368 756e  gs,.        chun
+0003b170: 6b5f 6b77 6172 6773 2c0a 2020 2020 2020  k_kwargs,.      
+0003b180: 2020 6167 6772 6567 6174 655f 6b77 6172    aggregate_kwar
+0003b190: 6773 2c0a 2020 2020 2020 2020 636f 6d62  gs,.        comb
+0003b1a0: 696e 655f 6b77 6172 6773 2c0a 2020 2020  ine_kwargs,.    
+0003b1b0: 2020 2020 7370 6c69 745f 6576 6572 792c      split_every,
+0003b1c0: 0a20 2020 2020 2020 2073 706c 6974 5f6f  .        split_o
+0003b1d0: 7574 2c0a 2020 2020 2020 2020 7370 6c69  ut,.        spli
+0003b1e0: 745f 6f75 745f 7365 7475 702c 0a20 2020  t_out_setup,.   
+0003b1f0: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
+0003b200: 6574 7570 5f6b 7761 7267 732c 0a20 2020  etup_kwargs,.   
+0003b210: 2029 0a0a 2020 2020 2320 426c 6f63 6b77   )..    # Blockw
+0003b220: 6973 6520 4368 756e 6b20 4c61 7965 720a  ise Chunk Layer.
+0003b230: 2020 2020 6368 756e 6b5f 6e61 6d65 203d      chunk_name =
+0003b240: 2066 227b 746f 6b65 6e20 6f72 2066 756e   f"{token or fun
+0003b250: 636e 616d 6528 6368 756e 6b29 7d2d 6368  cname(chunk)}-ch
+0003b260: 756e 6b2d 7b74 6f6b 656e 5f6b 6579 7d22  unk-{token_key}"
+0003b270: 0a20 2020 2063 6875 6e6b 6564 203d 206d  .    chunked = m
+0003b280: 6170 5f62 6167 5f70 6172 7469 7469 6f6e  ap_bag_partition
+0003b290: 7328 0a20 2020 2020 2020 2063 6875 6e6b  s(.        chunk
+0003b2a0: 2c0a 2020 2020 2020 2020 2320 436f 6e76  ,.        # Conv
+0003b2b0: 6572 7420 5f46 7261 6d65 2063 6f6c 6c65  ert _Frame colle
+0003b2c0: 6374 696f 6e73 2074 6f20 4261 670a 2020  ctions to Bag.  
+0003b2d0: 2020 2020 2020 2a5b 0a20 2020 2020 2020        *[.       
+0003b2e0: 2020 2020 2061 7267 2e74 6f5f 6261 6728       arg.to_bag(
+0003b2f0: 666f 726d 6174 3d22 6672 616d 6522 2920  format="frame") 
+0003b300: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
+0003b310: 672c 205f 4672 616d 6529 2065 6c73 6520  g, _Frame) else 
+0003b320: 6172 670a 2020 2020 2020 2020 2020 2020  arg.            
+0003b330: 666f 7220 6172 6720 696e 2061 7267 730a  for arg in args.
+0003b340: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+0003b350: 2020 2074 6f6b 656e 3d63 6875 6e6b 5f6e     token=chunk_n
+0003b360: 616d 652c 0a20 2020 2020 2020 202a 2a63  ame,.        **c
+0003b370: 6875 6e6b 5f6b 7761 7267 732c 0a20 2020  hunk_kwargs,.   
+0003b380: 2029 0a0a 2020 2020 2320 4e4f 5445 3a20   )..    # NOTE: 
+0003b390: 6063 6875 6e6b 6564 6020 6973 206e 6f77  `chunked` is now
+0003b3a0: 2061 2042 6167 2063 6f6c 6c65 6374 696f   a Bag collectio
+0003b3b0: 6e2e 0a20 2020 2023 2057 6520 646f 6e27  n..    # We don'
+0003b3c0: 7420 7573 6520 6120 4461 7461 4672 616d  t use a DataFram
+0003b3d0: 6520 636f 6c6c 6563 7469 6f6e 2c20 6265  e collection, be
+0003b3e0: 6361 7573 650a 2020 2020 2320 7468 6520  cause.    # the 
+0003b3f0: 7061 7274 6974 696f 6e73 206d 6179 206e  partitions may n
+0003b400: 6f74 2063 6f6e 7461 696e 2064 6174 6166  ot contain dataf
+0003b410: 7261 6d65 2d6c 696b 650a 2020 2020 2320  rame-like.    # 
+0003b420: 6f62 6a65 6374 7320 616e 796d 6f72 652e  objects anymore.
+0003b430: 0a0a 2020 2020 2320 426c 6f63 6b77 6973  ..    # Blockwis
+0003b440: 6520 5370 6c69 7420 4c61 7965 720a 2020  e Split Layer.  
+0003b450: 2020 6966 2073 706c 6974 5f6f 7574 2061    if split_out a
+0003b460: 6e64 2073 706c 6974 5f6f 7574 203e 2031  nd split_out > 1
+0003b470: 3a0a 2020 2020 2020 2020 6368 756e 6b65  :.        chunke
+0003b480: 6420 3d20 6368 756e 6b65 642e 6d61 705f  d = chunked.map_
+0003b490: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+0003b4a0: 2020 2020 2020 2020 6861 7368 5f73 6861          hash_sha
+0003b4b0: 7264 2c0a 2020 2020 2020 2020 2020 2020  rd,.            
+0003b4c0: 7370 6c69 745f 6f75 742c 0a20 2020 2020  split_out,.     
+0003b4d0: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
+0003b4e0: 5f73 6574 7570 2c0a 2020 2020 2020 2020  _setup,.        
+0003b4f0: 2020 2020 7370 6c69 745f 6f75 745f 7365      split_out_se
+0003b500: 7475 705f 6b77 6172 6773 2c0a 2020 2020  tup_kwargs,.    
+0003b510: 2020 2020 2020 2020 6967 6e6f 7265 5f69          ignore_i
+0003b520: 6e64 6578 2c0a 2020 2020 2020 2020 2020  ndex,.          
+0003b530: 2020 746f 6b65 6e3d 2273 706c 6974 2d25    token="split-%
+0003b540: 7322 2025 2074 6f6b 656e 5f6b 6579 2c0a  s" % token_key,.
+0003b550: 2020 2020 2020 2020 290a 0a20 2020 2023          )..    #
+0003b560: 2048 616e 646c 6520 736f 7274 2062 6568   Handle sort beh
+0003b570: 6176 696f 720a 2020 2020 6966 2073 6f72  avior.    if sor
+0003b580: 7420 6973 206e 6f74 204e 6f6e 653a 0a20  t is not None:. 
+0003b590: 2020 2020 2020 2069 6620 736f 7274 2061         if sort a
+0003b5a0: 6e64 2073 706c 6974 5f6f 7574 203e 2031  nd split_out > 1
+0003b5b0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0003b5c0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+0003b5d0: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
+0003b5e0: 2020 2020 2020 2020 2022 4361 6e6e 6f74           "Cannot
+0003b5f0: 2067 7561 7261 6e74 6565 2073 6f72 7465   guarantee sorte
+0003b600: 6420 6b65 7973 2066 6f72 2060 7370 6c69  d keys for `spli
+0003b610: 745f 6f75 743e 3160 2e22 0a20 2020 2020  t_out>1`.".     
+0003b620: 2020 2020 2020 2020 2020 2022 2054 7279             " Try
+0003b630: 2075 7369 6e67 2073 706c 6974 5f6f 7574   using split_out
+0003b640: 3d31 2c20 6f72 2067 726f 7570 696e 6720  =1, or grouping 
+0003b650: 7769 7468 2073 6f72 743d 4661 6c73 652e  with sort=False.
+0003b660: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+0003b670: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+0003b680: 655f 6b77 6172 6773 203d 2061 6767 7265  e_kwargs = aggre
+0003b690: 6761 7465 5f6b 7761 7267 7320 6f72 207b  gate_kwargs or {
+0003b6a0: 7d0a 2020 2020 2020 2020 6167 6772 6567  }.        aggreg
+0003b6b0: 6174 655f 6b77 6172 6773 5b22 736f 7274  ate_kwargs["sort
+0003b6c0: 225d 203d 2073 6f72 740a 0a20 2020 2023  "] = sort..    #
+0003b6d0: 2054 7265 652d 5265 6475 6374 696f 6e20   Tree-Reduction 
+0003b6e0: 4c61 7965 720a 2020 2020 6669 6e61 6c5f  Layer.    final_
+0003b6f0: 6e61 6d65 203d 2066 227b 746f 6b65 6e20  name = f"{token 
+0003b700: 6f72 2066 756e 636e 616d 6528 6167 6772  or funcname(aggr
+0003b710: 6567 6174 6529 7d2d 6167 672d 7b74 6f6b  egate)}-agg-{tok
+0003b720: 656e 5f6b 6579 7d22 0a20 2020 206c 6179  en_key}".    lay
+0003b730: 6572 203d 2044 6174 6146 7261 6d65 5472  er = DataFrameTr
+0003b740: 6565 5265 6475 6374 696f 6e28 0a20 2020  eeReduction(.   
+0003b750: 2020 2020 2066 696e 616c 5f6e 616d 652c       final_name,
+0003b760: 0a20 2020 2020 2020 2063 6875 6e6b 6564  .        chunked
+0003b770: 2e6e 616d 652c 0a20 2020 2020 2020 206e  .name,.        n
+0003b780: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
+0003b790: 2020 2020 7061 7274 6961 6c28 5f63 6f6e      partial(_con
+0003b7a0: 6361 742c 2069 676e 6f72 655f 696e 6465  cat, ignore_inde
+0003b7b0: 783d 6967 6e6f 7265 5f69 6e64 6578 292c  x=ignore_index),
+0003b7c0: 0a20 2020 2020 2020 2070 6172 7469 616c  .        partial
+0003b7d0: 2863 6f6d 6269 6e65 2c20 2a2a 636f 6d62  (combine, **comb
+0003b7e0: 696e 655f 6b77 6172 6773 2920 6966 2063  ine_kwargs) if c
+0003b7f0: 6f6d 6269 6e65 5f6b 7761 7267 7320 656c  ombine_kwargs el
+0003b800: 7365 2063 6f6d 6269 6e65 2c0a 2020 2020  se combine,.    
+0003b810: 2020 2020 6669 6e61 6c69 7a65 5f66 756e      finalize_fun
+0003b820: 633d 7061 7274 6961 6c28 6167 6772 6567  c=partial(aggreg
+0003b830: 6174 652c 202a 2a61 6767 7265 6761 7465  ate, **aggregate
+0003b840: 5f6b 7761 7267 7329 0a20 2020 2020 2020  _kwargs).       
+0003b850: 2069 6620 6167 6772 6567 6174 655f 6b77   if aggregate_kw
+0003b860: 6172 6773 0a20 2020 2020 2020 2065 6c73  args.        els
+0003b870: 6520 6167 6772 6567 6174 652c 0a20 2020  e aggregate,.   
+0003b880: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+0003b890: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
+0003b8a0: 2020 2020 2020 7370 6c69 745f 6f75 743d        split_out=
+0003b8b0: 7370 6c69 745f 6f75 7420 6966 2028 7370  split_out if (sp
+0003b8c0: 6c69 745f 6f75 7420 616e 6420 7370 6c69  lit_out and spli
+0003b8d0: 745f 6f75 7420 3e20 3129 2065 6c73 6520  t_out > 1) else 
+0003b8e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7472  None,.        tr
+0003b8f0: 6565 5f6e 6f64 655f 6e61 6d65 3d66 227b  ee_node_name=f"{
+0003b900: 746f 6b65 6e20 6f72 2066 756e 636e 616d  token or funcnam
+0003b910: 6528 636f 6d62 696e 6529 7d2d 636f 6d62  e(combine)}-comb
+0003b920: 696e 652d 7b74 6f6b 656e 5f6b 6579 7d22  ine-{token_key}"
+0003b930: 2c0a 2020 2020 290a 0a20 2020 2069 6620  ,.    )..    if 
+0003b940: 6d65 7461 2069 7320 6e6f 5f64 6566 6175  meta is no_defau
+0003b950: 6c74 3a0a 2020 2020 2020 2020 6d65 7461  lt:.        meta
+0003b960: 5f63 6875 6e6b 203d 205f 656d 756c 6174  _chunk = _emulat
+0003b970: 6528 6368 756e 6b2c 202a 6172 6773 2c20  e(chunk, *args, 
+0003b980: 7564 663d 5472 7565 2c20 2a2a 6368 756e  udf=True, **chun
+0003b990: 6b5f 6b77 6172 6773 290a 2020 2020 2020  k_kwargs).      
+0003b9a0: 2020 6d65 7461 203d 205f 656d 756c 6174    meta = _emulat
+0003b9b0: 6528 0a20 2020 2020 2020 2020 2020 2061  e(.            a
+0003b9c0: 6767 7265 6761 7465 2c20 5f63 6f6e 6361  ggregate, _conca
+0003b9d0: 7428 5b6d 6574 615f 6368 756e 6b5d 2c20  t([meta_chunk], 
+0003b9e0: 6967 6e6f 7265 5f69 6e64 6578 292c 2075  ignore_index), u
+0003b9f0: 6466 3d54 7275 652c 202a 2a61 6767 7265  df=True, **aggre
+0003ba00: 6761 7465 5f6b 7761 7267 730a 2020 2020  gate_kwargs.    
+0003ba10: 2020 2020 290a 2020 2020 6d65 7461 203d      ).    meta =
+0003ba20: 206d 616b 655f 6d65 7461 280a 2020 2020   make_meta(.    
+0003ba30: 2020 2020 6d65 7461 2c0a 2020 2020 2020      meta,.      
+0003ba40: 2020 696e 6465 783d 2867 6574 6174 7472    index=(getattr
+0003ba50: 286d 616b 655f 6d65 7461 2864 6673 5b30  (make_meta(dfs[0
+0003ba60: 5d29 2c20 2269 6e64 6578 222c 204e 6f6e  ]), "index", Non
+0003ba70: 6529 2069 6620 6466 7320 656c 7365 204e  e) if dfs else N
+0003ba80: 6f6e 6529 2c0a 2020 2020 2020 2020 7061  one),.        pa
+0003ba90: 7265 6e74 5f6d 6574 613d 6466 735b 305d  rent_meta=dfs[0]
+0003baa0: 2e5f 6d65 7461 2c0a 2020 2020 290a 0a20  ._meta,.    ).. 
+0003bab0: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+0003bac0: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+0003bad0: 6f6c 6c65 6374 696f 6e73 2866 696e 616c  ollections(final
+0003bae0: 5f6e 616d 652c 206c 6179 6572 2c20 6465  _name, layer, de
+0003baf0: 7065 6e64 656e 6369 6573 3d28 6368 756e  pendencies=(chun
+0003bb00: 6b65 642c 2929 0a20 2020 2064 6976 6973  ked,)).    divis
+0003bb10: 696f 6e73 203d 205b 4e6f 6e65 5d20 2a20  ions = [None] * 
+0003bb20: 2828 7370 6c69 745f 6f75 7420 6f72 2031  ((split_out or 1
+0003bb30: 2920 2b20 3129 0a20 2020 2072 6574 7572  ) + 1).    retur
+0003bb40: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
+0003bb50: 6772 6170 682c 2066 696e 616c 5f6e 616d  graph, final_nam
+0003bb60: 652c 206d 6574 612c 2064 6976 6973 696f  e, meta, divisio
+0003bb70: 6e73 2c20 7061 7265 6e74 5f6d 6574 613d  ns, parent_meta=
+0003bb80: 6466 735b 305d 2e5f 6d65 7461 290a 0a0a  dfs[0]._meta)...
+0003bb90: 6163 6120 3d20 6170 706c 795f 636f 6e63  aca = apply_conc
+0003bba0: 6174 5f61 7070 6c79 0a0a 0a64 6566 205f  at_apply...def _
+0003bbb0: 6578 7472 6163 745f 6d65 7461 2878 2c20  extract_meta(x, 
+0003bbc0: 6e6f 6e65 6d70 7479 3d46 616c 7365 293a  nonempty=False):
+0003bbd0: 0a20 2020 2022 2222 0a20 2020 2045 7874  .    """.    Ext
+0003bbe0: 7261 6374 2069 6e74 6572 6e61 6c20 6361  ract internal ca
+0003bbf0: 6368 6520 6461 7461 2028 6060 5f6d 6574  che data (``_met
+0003bc00: 6160 6029 2066 726f 6d20 6464 2e44 6174  a``) from dd.Dat
+0003bc10: 6146 7261 6d65 202f 2064 642e 5365 7269  aFrame / dd.Seri
+0003bc20: 6573 0a20 2020 2022 2222 0a20 2020 2069  es.    """.    i
+0003bc30: 6620 6973 696e 7374 616e 6365 2878 2c20  f isinstance(x, 
+0003bc40: 2853 6361 6c61 722c 205f 4672 616d 6529  (Scalar, _Frame)
+0003bc50: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0003bc60: 6e20 782e 5f6d 6574 615f 6e6f 6e65 6d70  n x._meta_nonemp
+0003bc70: 7479 2069 6620 6e6f 6e65 6d70 7479 2065  ty if nonempty e
+0003bc80: 6c73 6520 782e 5f6d 6574 610a 2020 2020  lse x._meta.    
+0003bc90: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+0003bca0: 782c 206c 6973 7429 3a0a 2020 2020 2020  x, list):.      
+0003bcb0: 2020 7265 7475 726e 205b 5f65 7874 7261    return [_extra
+0003bcc0: 6374 5f6d 6574 6128 5f78 2c20 6e6f 6e65  ct_meta(_x, none
+0003bcd0: 6d70 7479 2920 666f 7220 5f78 2069 6e20  mpty) for _x in 
+0003bce0: 785d 0a20 2020 2065 6c69 6620 6973 696e  x].    elif isin
+0003bcf0: 7374 616e 6365 2878 2c20 7475 706c 6529  stance(x, tuple)
+0003bd00: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0003bd10: 2074 7570 6c65 285f 6578 7472 6163 745f   tuple(_extract_
+0003bd20: 6d65 7461 285f 782c 206e 6f6e 656d 7074  meta(_x, nonempt
+0003bd30: 7929 2066 6f72 205f 7820 696e 2078 290a  y) for _x in x).
+0003bd40: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+0003bd50: 6e63 6528 782c 2064 6963 7429 3a0a 2020  nce(x, dict):.  
+0003bd60: 2020 2020 2020 7265 7320 3d20 7b7d 0a20        res = {}. 
+0003bd70: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
+0003bd80: 783a 0a20 2020 2020 2020 2020 2020 2072  x:.            r
+0003bd90: 6573 5b6b 5d20 3d20 5f65 7874 7261 6374  es[k] = _extract
+0003bda0: 5f6d 6574 6128 785b 6b5d 2c20 6e6f 6e65  _meta(x[k], none
+0003bdb0: 6d70 7479 290a 2020 2020 2020 2020 7265  mpty).        re
+0003bdc0: 7475 726e 2072 6573 0a20 2020 2065 6c69  turn res.    eli
+0003bdd0: 6620 6973 696e 7374 616e 6365 2878 2c20  f isinstance(x, 
+0003bde0: 4465 6c61 7965 6429 3a0a 2020 2020 2020  Delayed):.      
+0003bdf0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0003be00: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0003be10: 2243 616e 6e6f 7420 696e 6665 7220 6461  "Cannot infer da
+0003be20: 7461 6672 616d 6520 6d65 7461 6461 7461  taframe metadata
+0003be30: 2077 6974 6820 6120 6064 6173 6b2e 6465   with a `dask.de
+0003be40: 6c61 7965 6460 2061 7267 756d 656e 7422  layed` argument"
+0003be50: 0a20 2020 2020 2020 2029 0a20 2020 2065  .        ).    e
+0003be60: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
+0003be70: 7572 6e20 780a 0a0a 6465 6620 5f65 6d75  urn x...def _emu
+0003be80: 6c61 7465 2866 756e 632c 202a 6172 6773  late(func, *args
+0003be90: 2c20 7564 663d 4661 6c73 652c 202a 2a6b  , udf=False, **k
+0003bea0: 7761 7267 7329 3a0a 2020 2020 2222 220a  wargs):.    """.
+0003beb0: 2020 2020 4170 706c 7920 6120 6675 6e63      Apply a func
+0003bec0: 7469 6f6e 2075 7369 6e67 2061 7267 7320  tion using args 
+0003bed0: 2f20 6b77 6172 6773 2e20 4966 2061 7267  / kwargs. If arg
+0003bee0: 756d 656e 7473 2063 6f6e 7461 696e 2064  uments contain d
+0003bef0: 642e 4461 7461 4672 616d 6520 2f0a 2020  d.DataFrame /.  
+0003bf00: 2020 6464 2e53 6572 6965 732c 2075 7369    dd.Series, usi
+0003bf10: 6e67 2069 6e74 6572 6e61 6c20 6361 6368  ng internal cach
+0003bf20: 6520 2860 605f 6d65 7461 6060 2920 666f  e (``_meta``) fo
+0003bf30: 7220 6361 6c63 756c 6174 696f 6e0a 2020  r calculation.  
+0003bf40: 2020 2222 220a 2020 2020 7769 7468 2072    """.    with r
+0003bf50: 6169 7365 5f6f 6e5f 6d65 7461 5f65 7272  aise_on_meta_err
+0003bf60: 6f72 2866 756e 636e 616d 6528 6675 6e63  or(funcname(func
+0003bf70: 292c 2075 6466 3d75 6466 292c 2063 6865  ), udf=udf), che
+0003bf80: 636b 5f6e 756d 6572 6963 5f6f 6e6c 795f  ck_numeric_only_
+0003bf90: 6465 7072 6563 6174 696f 6e28 293a 0a20  deprecation():. 
+0003bfa0: 2020 2020 2020 2072 6574 7572 6e20 6675         return fu
+0003bfb0: 6e63 282a 5f65 7874 7261 6374 5f6d 6574  nc(*_extract_met
+0003bfc0: 6128 6172 6773 2c20 5472 7565 292c 202a  a(args, True), *
+0003bfd0: 2a5f 6578 7472 6163 745f 6d65 7461 286b  *_extract_meta(k
+0003bfe0: 7761 7267 732c 2054 7275 6529 290a 0a0a  wargs, True))...
+0003bff0: 4069 6e73 6572 745f 6d65 7461 5f70 6172  @insert_meta_par
+0003c000: 616d 5f64 6573 6372 6970 7469 6f6e 0a64  am_description.d
+0003c010: 6566 206d 6170 5f70 6172 7469 7469 6f6e  ef map_partition
+0003c020: 7328 0a20 2020 2066 756e 632c 0a20 2020  s(.    func,.   
+0003c030: 202a 6172 6773 2c0a 2020 2020 6d65 7461   *args,.    meta
+0003c040: 3d6e 6f5f 6465 6661 756c 742c 0a20 2020  =no_default,.   
+0003c050: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+0003c060: 613d 5472 7565 2c0a 2020 2020 7472 616e  a=True,.    tran
+0003c070: 7366 6f72 6d5f 6469 7669 7369 6f6e 733d  sform_divisions=
+0003c080: 5472 7565 2c0a 2020 2020 616c 6967 6e5f  True,.    align_
+0003c090: 6461 7461 6672 616d 6573 3d54 7275 652c  dataframes=True,
+0003c0a0: 0a20 2020 202a 2a6b 7761 7267 732c 0a29  .    **kwargs,.)
+0003c0b0: 3a0a 2020 2020 2222 2241 7070 6c79 2050  :.    """Apply P
+0003c0c0: 7974 686f 6e20 6675 6e63 7469 6f6e 206f  ython function o
+0003c0d0: 6e20 6561 6368 2044 6174 6146 7261 6d65  n each DataFrame
+0003c0e0: 2070 6172 7469 7469 6f6e 2e0a 0a20 2020   partition...   
+0003c0f0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0003c100: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066  ----------.    f
+0003c110: 756e 6320 3a20 6675 6e63 7469 6f6e 0a20  unc : function. 
+0003c120: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
+0003c130: 6170 706c 6965 6420 746f 2065 6163 6820  applied to each 
+0003c140: 7061 7274 6974 696f 6e2e 0a20 2020 2061  partition..    a
+0003c150: 7267 732c 206b 7761 7267 7320 3a0a 2020  rgs, kwargs :.  
+0003c160: 2020 2020 2020 4172 6775 6d65 6e74 7320        Arguments 
+0003c170: 616e 6420 6b65 7977 6f72 6473 2074 6f20  and keywords to 
+0003c180: 7061 7373 2074 6f20 7468 6520 6675 6e63  pass to the func
+0003c190: 7469 6f6e 2e20 2041 7420 6c65 6173 7420  tion.  At least 
+0003c1a0: 6f6e 6520 6f66 2074 6865 0a20 2020 2020  one of the.     
+0003c1b0: 2020 2061 7267 7320 7368 6f75 6c64 2062     args should b
+0003c1c0: 6520 6120 4461 736b 2e64 6174 6166 7261  e a Dask.datafra
+0003c1d0: 6d65 2e20 4172 6775 6d65 6e74 7320 616e  me. Arguments an
+0003c1e0: 6420 6b65 7977 6f72 6473 206d 6179 2063  d keywords may c
+0003c1f0: 6f6e 7461 696e 0a20 2020 2020 2020 2060  ontain.        `
+0003c200: 6053 6361 6c61 7260 602c 2060 6044 656c  `Scalar``, ``Del
+0003c210: 6179 6564 6060 206f 7220 7265 6775 6c61  ayed`` or regula
+0003c220: 7220 7079 7468 6f6e 206f 626a 6563 7473  r python objects
+0003c230: 2e20 4461 7461 4672 616d 652d 6c69 6b65  . DataFrame-like
+0003c240: 2061 7267 730a 2020 2020 2020 2020 2862   args.        (b
+0003c250: 6f74 6820 6461 736b 2061 6e64 2070 616e  oth dask and pan
+0003c260: 6461 7329 2077 696c 6c20 6265 2072 6570  das) will be rep
+0003c270: 6172 7469 7469 6f6e 6564 2074 6f20 616c  artitioned to al
+0003c280: 6967 6e20 2869 6620 6e65 6365 7373 6172  ign (if necessar
+0003c290: 7929 0a20 2020 2020 2020 2062 6566 6f72  y).        befor
+0003c2a0: 6520 6170 706c 7969 6e67 2074 6865 2066  e applying the f
+0003c2b0: 756e 6374 696f 6e20 2873 6565 2060 6061  unction (see ``a
+0003c2c0: 6c69 676e 5f64 6174 6166 7261 6d65 7360  lign_dataframes`
+0003c2d0: 6020 746f 2063 6f6e 7472 6f6c 292e 0a20  ` to control).. 
+0003c2e0: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
+0003c2f0: 6174 6120 3a20 626f 6f6c 2c20 6465 6661  ata : bool, defa
+0003c300: 756c 7420 5472 7565 0a20 2020 2020 2020  ult True.       
+0003c310: 2057 6865 7468 6572 2074 6f20 656e 666f   Whether to enfo
+0003c320: 7263 6520 6174 2072 756e 7469 6d65 2074  rce at runtime t
+0003c330: 6861 7420 7468 6520 7374 7275 6374 7572  hat the structur
+0003c340: 6520 6f66 2074 6865 2044 6174 6146 7261  e of the DataFra
+0003c350: 6d65 0a20 2020 2020 2020 2070 726f 6475  me.        produ
+0003c360: 6365 6420 6279 2060 6066 756e 6360 6020  ced by ``func`` 
+0003c370: 6163 7475 616c 6c79 206d 6174 6368 6573  actually matches
+0003c380: 2074 6865 2073 7472 7563 7475 7265 206f   the structure o
+0003c390: 6620 6060 6d65 7461 6060 2e0a 2020 2020  f ``meta``..    
+0003c3a0: 2020 2020 5468 6973 2077 696c 6c20 7265      This will re
+0003c3b0: 6e61 6d65 2061 6e64 2072 656f 7264 6572  name and reorder
+0003c3c0: 2063 6f6c 756d 6e73 2066 6f72 2065 6163   columns for eac
+0003c3d0: 6820 7061 7274 6974 696f 6e2c 0a20 2020  h partition,.   
+0003c3e0: 2020 2020 2061 6e64 2077 696c 6c20 7261       and will ra
+0003c3f0: 6973 6520 616e 2065 7272 6f72 2069 6620  ise an error if 
+0003c400: 7468 6973 2064 6f65 736e 2774 2077 6f72  this doesn't wor
+0003c410: 6b2c 0a20 2020 2020 2020 2062 7574 2069  k,.        but i
+0003c420: 7420 776f 6e27 7420 7261 6973 6520 6966  t won't raise if
+0003c430: 2064 7479 7065 7320 646f 6e27 7420 6d61   dtypes don't ma
+0003c440: 7463 682e 0a20 2020 2074 7261 6e73 666f  tch..    transfo
+0003c450: 726d 5f64 6976 6973 696f 6e73 203a 2062  rm_divisions : b
+0003c460: 6f6f 6c2c 2064 6566 6175 6c74 2054 7275  ool, default Tru
+0003c470: 650a 2020 2020 2020 2020 5768 6574 6865  e.        Whethe
+0003c480: 7220 746f 2061 7070 6c79 2074 6865 2066  r to apply the f
+0003c490: 756e 6374 696f 6e20 6f6e 746f 2074 6865  unction onto the
+0003c4a0: 2064 6976 6973 696f 6e73 2061 6e64 2061   divisions and a
+0003c4b0: 7070 6c79 2074 686f 7365 0a20 2020 2020  pply those.     
+0003c4c0: 2020 2074 7261 6e73 666f 726d 6564 2064     transformed d
+0003c4d0: 6976 6973 696f 6e73 2074 6f20 7468 6520  ivisions to the 
+0003c4e0: 6f75 7470 7574 2e0a 2020 2020 616c 6967  output..    alig
+0003c4f0: 6e5f 6461 7461 6672 616d 6573 203a 2062  n_dataframes : b
+0003c500: 6f6f 6c2c 2064 6566 6175 6c74 2054 7275  ool, default Tru
+0003c510: 650a 2020 2020 2020 2020 5768 6574 6865  e.        Whethe
+0003c520: 7220 746f 2072 6570 6172 7469 7469 6f6e  r to repartition
+0003c530: 2044 6174 6146 7261 6d65 2d20 6f72 2053   DataFrame- or S
+0003c540: 6572 6965 732d 6c69 6b65 2061 7267 730a  eries-like args.
+0003c550: 2020 2020 2020 2020 2862 6f74 6820 6461          (both da
+0003c560: 736b 2061 6e64 2070 616e 6461 7329 2073  sk and pandas) s
+0003c570: 6f20 7468 6569 7220 6469 7669 7369 6f6e  o their division
+0003c580: 7320 616c 6967 6e20 6265 666f 7265 2061  s align before a
+0003c590: 7070 6c79 696e 670a 2020 2020 2020 2020  pplying.        
+0003c5a0: 7468 6520 6675 6e63 7469 6f6e 2e20 5468  the function. Th
+0003c5b0: 6973 2072 6571 7569 7265 7320 616c 6c20  is requires all 
+0003c5c0: 696e 7075 7473 2074 6f20 6861 7665 206b  inputs to have k
+0003c5d0: 6e6f 776e 2064 6976 6973 696f 6e73 2e0a  nown divisions..
+0003c5e0: 2020 2020 2020 2020 5369 6e67 6c65 2d70          Single-p
+0003c5f0: 6172 7469 7469 6f6e 2069 6e70 7574 7320  artition inputs 
+0003c600: 7769 6c6c 2062 6520 7370 6c69 7420 696e  will be split in
+0003c610: 746f 206d 756c 7469 706c 6520 7061 7274  to multiple part
+0003c620: 6974 696f 6e73 2e0a 0a20 2020 2020 2020  itions...       
+0003c630: 2049 6620 4661 6c73 652c 2061 6c6c 2069   If False, all i
+0003c640: 6e70 7574 7320 6d75 7374 2068 6176 6520  nputs must have 
+0003c650: 6569 7468 6572 2074 6865 2073 616d 6520  either the same 
+0003c660: 6e75 6d62 6572 206f 6620 7061 7274 6974  number of partit
+0003c670: 696f 6e73 0a20 2020 2020 2020 206f 7220  ions.        or 
+0003c680: 6120 7369 6e67 6c65 2070 6172 7469 7469  a single partiti
+0003c690: 6f6e 2e20 5369 6e67 6c65 2d70 6172 7469  on. Single-parti
+0003c6a0: 7469 6f6e 2069 6e70 7574 7320 7769 6c6c  tion inputs will
+0003c6b0: 2062 6520 6272 6f61 6463 6173 7420 746f   be broadcast to
+0003c6c0: 0a20 2020 2020 2020 2065 7665 7279 2070  .        every p
+0003c6d0: 6172 7469 7469 6f6e 206f 6620 6d75 6c74  artition of mult
+0003c6e0: 692d 7061 7274 6974 696f 6e20 696e 7075  i-partition inpu
+0003c6f0: 7473 2e0a 2020 2020 244d 4554 410a 2020  ts..    $META.  
+0003c700: 2020 2222 220a 2020 2020 6e61 6d65 203d    """.    name =
+0003c710: 206b 7761 7267 732e 706f 7028 2274 6f6b   kwargs.pop("tok
+0003c720: 656e 222c 204e 6f6e 6529 0a20 2020 2070  en", None).    p
+0003c730: 6172 656e 745f 6d65 7461 203d 206b 7761  arent_meta = kwa
+0003c740: 7267 732e 706f 7028 2270 6172 656e 745f  rgs.pop("parent_
+0003c750: 6d65 7461 222c 204e 6f6e 6529 0a0a 2020  meta", None)..  
+0003c760: 2020 6173 7365 7274 2063 616c 6c61 626c    assert callabl
+0003c770: 6528 6675 6e63 290a 2020 2020 6966 206e  e(func).    if n
+0003c780: 616d 6520 6973 206e 6f74 204e 6f6e 653a  ame is not None:
+0003c790: 0a20 2020 2020 2020 2074 6f6b 656e 203d  .        token =
+0003c7a0: 2074 6f6b 656e 697a 6528 6d65 7461 2c20   tokenize(meta, 
+0003c7b0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+0003c7c0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+0003c7d0: 2020 206e 616d 6520 3d20 6675 6e63 6e61     name = funcna
+0003c7e0: 6d65 2866 756e 6329 0a20 2020 2020 2020  me(func).       
+0003c7f0: 2074 6f6b 656e 203d 2074 6f6b 656e 697a   token = tokeniz
+0003c800: 6528 6675 6e63 2c20 6d65 7461 2c20 2a61  e(func, meta, *a
+0003c810: 7267 732c 202a 2a6b 7761 7267 7329 0a20  rgs, **kwargs). 
+0003c820: 2020 206e 616d 6520 3d20 6622 7b6e 616d     name = f"{nam
+0003c830: 657d 2d7b 746f 6b65 6e7d 220a 0a20 2020  e}-{token}"..   
+0003c840: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+0003c850: 7261 6d65 2e6d 756c 7469 2069 6d70 6f72  rame.multi impor
+0003c860: 7420 5f6d 6179 6265 5f61 6c69 676e 5f70  t _maybe_align_p
+0003c870: 6172 7469 7469 6f6e 730a 0a20 2020 2069  artitions..    i
+0003c880: 6620 616c 6967 6e5f 6461 7461 6672 616d  f align_datafram
+0003c890: 6573 3a0a 2020 2020 2020 2020 6172 6773  es:.        args
+0003c8a0: 203d 205f 6d61 7962 655f 6672 6f6d 5f70   = _maybe_from_p
+0003c8b0: 616e 6461 7328 6172 6773 290a 2020 2020  andas(args).    
+0003c8c0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0003c8d0: 2020 2020 2061 7267 7320 3d20 5f6d 6179       args = _may
+0003c8e0: 6265 5f61 6c69 676e 5f70 6172 7469 7469  be_align_partiti
+0003c8f0: 6f6e 7328 6172 6773 290a 2020 2020 2020  ons(args).      
+0003c900: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
+0003c910: 726f 7220 6173 2065 3a0a 2020 2020 2020  ror as e:.      
+0003c920: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0003c930: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0003c940: 2020 2020 2020 2020 6622 7b65 7d2e 2049          f"{e}. I
+0003c950: 6620 796f 7520 646f 6e27 7420 7761 6e74  f you don't want
+0003c960: 2074 6865 2070 6172 7469 7469 6f6e 7320   the partitions 
+0003c970: 746f 2062 6520 616c 6967 6e65 642c 2061  to be aligned, a
+0003c980: 6e64 2061 7265 2022 0a20 2020 2020 2020  nd are ".       
+0003c990: 2020 2020 2020 2020 2022 6361 6c6c 696e           "callin
+0003c9a0: 6720 606d 6170 5f70 6172 7469 7469 6f6e  g `map_partition
+0003c9b0: 7360 2064 6972 6563 746c 792c 2070 6173  s` directly, pas
+0003c9c0: 7320 6061 6c69 676e 5f64 6174 6166 7261  s `align_datafra
+0003c9d0: 6d65 733d 4661 6c73 6560 2e22 0a20 2020  mes=False`.".   
+0003c9e0: 2020 2020 2020 2020 2029 2066 726f 6d20           ) from 
+0003c9f0: 650a 0a20 2020 2064 6673 203d 205b 6466  e..    dfs = [df
+0003ca00: 2066 6f72 2064 6620 696e 2061 7267 7320   for df in args 
+0003ca10: 6966 2069 7369 6e73 7461 6e63 6528 6466  if isinstance(df
+0003ca20: 2c20 5f46 7261 6d65 295d 0a0a 2020 2020  , _Frame)]..    
+0003ca30: 6d65 7461 203d 205f 6765 745f 6d65 7461  meta = _get_meta
+0003ca40: 5f6d 6170 5f70 6172 7469 7469 6f6e 7328  _map_partitions(
+0003ca50: 6172 6773 2c20 6466 732c 2066 756e 632c  args, dfs, func,
+0003ca60: 206b 7761 7267 732c 206d 6574 612c 2070   kwargs, meta, p
+0003ca70: 6172 656e 745f 6d65 7461 290a 2020 2020  arent_meta).    
+0003ca80: 6966 2061 6c6c 2869 7369 6e73 7461 6e63  if all(isinstanc
+0003ca90: 6528 6172 672c 2053 6361 6c61 7229 2066  e(arg, Scalar) f
+0003caa0: 6f72 2061 7267 2069 6e20 6172 6773 293a  or arg in args):
+0003cab0: 0a20 2020 2020 2020 206c 6179 6572 203d  .        layer =
+0003cac0: 207b 0a20 2020 2020 2020 2020 2020 2028   {.            (
+0003cad0: 6e61 6d65 2c20 3029 3a20 280a 2020 2020  name, 0): (.    
+0003cae0: 2020 2020 2020 2020 2020 2020 6170 706c              appl
+0003caf0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+0003cb00: 2020 2066 756e 632c 0a20 2020 2020 2020     func,.       
+0003cb10: 2020 2020 2020 2020 2028 7475 706c 652c           (tuple,
+0003cb20: 205b 2861 7267 2e5f 6e61 6d65 2c20 3029   [(arg._name, 0)
+0003cb30: 2066 6f72 2061 7267 2069 6e20 6172 6773   for arg in args
+0003cb40: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
+0003cb50: 2020 2020 6b77 6172 6773 2c0a 2020 2020      kwargs,.    
+0003cb60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0003cb70: 2020 7d0a 2020 2020 2020 2020 6772 6170    }.        grap
+0003cb80: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
+0003cb90: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
+0003cba0: 6f6e 7328 6e61 6d65 2c20 6c61 7965 722c  ons(name, layer,
+0003cbb0: 2064 6570 656e 6465 6e63 6965 733d 6172   dependencies=ar
+0003cbc0: 6773 290a 2020 2020 2020 2020 7265 7475  gs).        retu
+0003cbd0: 726e 2053 6361 6c61 7228 6772 6170 682c  rn Scalar(graph,
+0003cbe0: 206e 616d 652c 206d 6574 6129 0a0a 2020   name, meta)..  
+0003cbf0: 2020 6172 6773 3220 3d20 5b5d 0a20 2020    args2 = [].   
+0003cc00: 2064 6570 656e 6465 6e63 6965 7320 3d20   dependencies = 
+0003cc10: 5b5d 0a20 2020 2066 6f72 2061 7267 2069  [].    for arg i
+0003cc20: 6e20 6172 6773 3a0a 2020 2020 2020 2020  n args:.        
+0003cc30: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
+0003cc40: 672c 205f 4672 616d 6529 3a0a 2020 2020  g, _Frame):.    
+0003cc50: 2020 2020 2020 2020 6172 6773 322e 6170          args2.ap
+0003cc60: 7065 6e64 2861 7267 290a 2020 2020 2020  pend(arg).      
+0003cc70: 2020 2020 2020 6465 7065 6e64 656e 6369        dependenci
+0003cc80: 6573 2e61 7070 656e 6428 6172 6729 0a20  es.append(arg). 
+0003cc90: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+0003cca0: 6e75 650a 2020 2020 2020 2020 6172 6720  nue.        arg 
+0003ccb0: 3d20 6e6f 726d 616c 697a 655f 6172 6728  = normalize_arg(
+0003ccc0: 6172 6729 0a20 2020 2020 2020 2061 7267  arg).        arg
+0003ccd0: 322c 2063 6f6c 6c65 6374 696f 6e73 203d  2, collections =
+0003cce0: 2075 6e70 6163 6b5f 636f 6c6c 6563 7469   unpack_collecti
+0003ccf0: 6f6e 7328 6172 6729 0a20 2020 2020 2020  ons(arg).       
+0003cd00: 2069 6620 636f 6c6c 6563 7469 6f6e 733a   if collections:
+0003cd10: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
+0003cd20: 7332 2e61 7070 656e 6428 6172 6732 290a  s2.append(arg2).
+0003cd30: 2020 2020 2020 2020 2020 2020 6465 7065              depe
+0003cd40: 6e64 656e 6369 6573 2e65 7874 656e 6428  ndencies.extend(
+0003cd50: 636f 6c6c 6563 7469 6f6e 7329 0a20 2020  collections).   
+0003cd60: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0003cd70: 2020 2020 2020 2061 7267 7332 2e61 7070         args2.app
+0003cd80: 656e 6428 6172 6729 0a0a 2020 2020 6b77  end(arg)..    kw
+0003cd90: 6172 6773 3320 3d20 7b7d 0a20 2020 2073  args3 = {}.    s
+0003cda0: 696d 706c 6520 3d20 5472 7565 0a20 2020  imple = True.   
+0003cdb0: 2066 6f72 206b 2c20 7620 696e 206b 7761   for k, v in kwa
+0003cdc0: 7267 732e 6974 656d 7328 293a 0a20 2020  rgs.items():.   
+0003cdd0: 2020 2020 2076 203d 206e 6f72 6d61 6c69       v = normali
+0003cde0: 7a65 5f61 7267 2876 290a 2020 2020 2020  ze_arg(v).      
+0003cdf0: 2020 762c 2063 6f6c 6c65 6374 696f 6e73    v, collections
+0003ce00: 203d 2075 6e70 6163 6b5f 636f 6c6c 6563   = unpack_collec
+0003ce10: 7469 6f6e 7328 7629 0a20 2020 2020 2020  tions(v).       
+0003ce20: 2064 6570 656e 6465 6e63 6965 732e 6578   dependencies.ex
+0003ce30: 7465 6e64 2863 6f6c 6c65 6374 696f 6e73  tend(collections
+0003ce40: 290a 2020 2020 2020 2020 6b77 6172 6773  ).        kwargs
+0003ce50: 335b 6b5d 203d 2076 0a20 2020 2020 2020  3[k] = v.       
+0003ce60: 2069 6620 636f 6c6c 6563 7469 6f6e 733a   if collections:
+0003ce70: 0a20 2020 2020 2020 2020 2020 2073 696d  .            sim
+0003ce80: 706c 6520 3d20 4661 6c73 650a 0a20 2020  ple = False..   
+0003ce90: 2064 6976 6973 696f 6e73 203d 205f 6765   divisions = _ge
+0003cea0: 745f 6469 7669 7369 6f6e 735f 6d61 705f  t_divisions_map_
+0003ceb0: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+0003cec0: 2020 2020 616c 6967 6e5f 6461 7461 6672      align_datafr
+0003ced0: 616d 6573 2c20 7472 616e 7366 6f72 6d5f  ames, transform_
+0003cee0: 6469 7669 7369 6f6e 732c 2064 6673 2c20  divisions, dfs, 
+0003cef0: 6675 6e63 2c20 6172 6773 2c20 6b77 6172  func, args, kwar
+0003cf00: 6773 0a20 2020 2029 0a0a 2020 2020 6966  gs.    )..    if
+0003cf10: 2068 6173 5f6b 6579 776f 7264 2866 756e   has_keyword(fun
+0003cf20: 632c 2022 7061 7274 6974 696f 6e5f 696e  c, "partition_in
+0003cf30: 666f 2229 3a0a 2020 2020 2020 2020 7061  fo"):.        pa
+0003cf40: 7274 6974 696f 6e5f 696e 666f 203d 207b  rtition_info = {
+0003cf50: 0a20 2020 2020 2020 2020 2020 2028 692c  .            (i,
+0003cf60: 293a 207b 226e 756d 6265 7222 3a20 692c  ): {"number": i,
+0003cf70: 2022 6469 7669 7369 6f6e 223a 2064 6976   "division": div
+0003cf80: 6973 696f 6e7d 0a20 2020 2020 2020 2020  ision}.         
+0003cf90: 2020 2066 6f72 2069 2c20 6469 7669 7369     for i, divisi
+0003cfa0: 6f6e 2069 6e20 656e 756d 6572 6174 6528  on in enumerate(
+0003cfb0: 6469 7669 7369 6f6e 735b 3a2d 315d 290a  divisions[:-1]).
+0003cfc0: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
+0003cfd0: 2020 2061 7267 7332 2e69 6e73 6572 7428     args2.insert(
+0003cfe0: 302c 2042 6c6f 636b 7769 7365 4465 7044  0, BlockwiseDepD
+0003cff0: 6963 7428 7061 7274 6974 696f 6e5f 696e  ict(partition_in
+0003d000: 666f 2929 0a20 2020 2020 2020 206f 7269  fo)).        ori
+0003d010: 675f 6675 6e63 203d 2066 756e 630a 0a20  g_func = func.. 
+0003d020: 2020 2020 2020 2064 6566 2066 756e 6328         def func(
+0003d030: 7061 7274 6974 696f 6e5f 696e 666f 2c20  partition_info, 
+0003d040: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+0003d050: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0003d060: 7475 726e 206f 7269 675f 6675 6e63 282a  turn orig_func(*
+0003d070: 6172 6773 2c20 2a2a 6b77 6172 6773 2c20  args, **kwargs, 
+0003d080: 7061 7274 6974 696f 6e5f 696e 666f 3d70  partition_info=p
+0003d090: 6172 7469 7469 6f6e 5f69 6e66 6f29 0a0a  artition_info)..
+0003d0a0: 2020 2020 6966 2065 6e66 6f72 6365 5f6d      if enforce_m
+0003d0b0: 6574 6164 6174 613a 0a20 2020 2020 2020  etadata:.       
+0003d0c0: 2064 736b 203d 2070 6172 7469 7469 6f6e   dsk = partition
+0003d0d0: 7769 7365 5f67 7261 7068 280a 2020 2020  wise_graph(.    
+0003d0e0: 2020 2020 2020 2020 6170 706c 795f 616e          apply_an
+0003d0f0: 645f 656e 666f 7263 652c 0a20 2020 2020  d_enforce,.     
+0003d100: 2020 2020 2020 206e 616d 652c 0a20 2020         name,.   
+0003d110: 2020 2020 2020 2020 202a 6172 6773 322c           *args2,
+0003d120: 0a20 2020 2020 2020 2020 2020 2064 6570  .            dep
+0003d130: 656e 6465 6e63 6965 733d 6465 7065 6e64  endencies=depend
+0003d140: 656e 6369 6573 2c0a 2020 2020 2020 2020  encies,.        
+0003d150: 2020 2020 5f66 756e 633d 6675 6e63 2c0a      _func=func,.
+0003d160: 2020 2020 2020 2020 2020 2020 5f6d 6574              _met
+0003d170: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
+0003d180: 2020 2020 2a2a 6b77 6172 6773 332c 0a20      **kwargs3,. 
+0003d190: 2020 2020 2020 2029 0a20 2020 2065 6c73         ).    els
+0003d1a0: 653a 0a20 2020 2020 2020 206b 7761 7267  e:.        kwarg
+0003d1b0: 7334 203d 206b 7761 7267 7320 6966 2073  s4 = kwargs if s
+0003d1c0: 696d 706c 6520 656c 7365 206b 7761 7267  imple else kwarg
+0003d1d0: 7333 0a20 2020 2020 2020 2064 736b 203d  s3.        dsk =
+0003d1e0: 2070 6172 7469 7469 6f6e 7769 7365 5f67   partitionwise_g
+0003d1f0: 7261 7068 280a 2020 2020 2020 2020 2020  raph(.          
+0003d200: 2020 6675 6e63 2c20 6e61 6d65 2c20 2a61    func, name, *a
+0003d210: 7267 7332 2c20 2a2a 6b77 6172 6773 342c  rgs2, **kwargs4,
+0003d220: 2064 6570 656e 6465 6e63 6965 733d 6465   dependencies=de
+0003d230: 7065 6e64 656e 6369 6573 0a20 2020 2020  pendencies.     
+0003d240: 2020 2029 0a0a 2020 2020 6772 6170 6820     )..    graph 
+0003d250: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
+0003d260: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
+0003d270: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
+0003d280: 656e 6465 6e63 6965 733d 6465 7065 6e64  endencies=depend
+0003d290: 656e 6369 6573 290a 2020 2020 7265 7475  encies).    retu
+0003d2a0: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
+0003d2b0: 2867 7261 7068 2c20 6e61 6d65 2c20 6d65  (graph, name, me
+0003d2c0: 7461 2c20 6469 7669 7369 6f6e 7329 0a0a  ta, divisions)..
+0003d2d0: 0a64 6566 205f 6765 745f 6469 7669 7369  .def _get_divisi
+0003d2e0: 6f6e 735f 6d61 705f 7061 7274 6974 696f  ons_map_partitio
+0003d2f0: 6e73 280a 2020 2020 616c 6967 6e5f 6461  ns(.    align_da
+0003d300: 7461 6672 616d 6573 2c20 7472 616e 7366  taframes, transf
+0003d310: 6f72 6d5f 6469 7669 7369 6f6e 732c 2064  orm_divisions, d
+0003d320: 6673 2c20 6675 6e63 2c20 6172 6773 2c20  fs, func, args, 
+0003d330: 6b77 6172 6773 0a29 3a0a 2020 2020 2222  kwargs.):.    ""
+0003d340: 220a 2020 2020 4865 6c70 6572 2074 6f20  ".    Helper to 
+0003d350: 6765 7420 6469 7669 7369 6f6e 7320 666f  get divisions fo
+0003d360: 7220 6d61 705f 7061 7274 6974 696f 6e73  r map_partitions
+0003d370: 2061 6e64 206d 6170 5f6f 7665 726c 6170   and map_overlap
+0003d380: 206f 7574 7075 742e 0a20 2020 2022 2222   output..    """
+0003d390: 0a20 2020 2069 6620 616c 6967 6e5f 6461  .    if align_da
+0003d3a0: 7461 6672 616d 6573 3a0a 2020 2020 2020  taframes:.      
+0003d3b0: 2020 6469 7669 7369 6f6e 7320 3d20 6466    divisions = df
+0003d3c0: 735b 305d 2e64 6976 6973 696f 6e73 0a20  s[0].divisions. 
+0003d3d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0003d3e0: 2023 2055 6e61 6c69 676e 6564 2c20 6466   # Unaligned, df
+0003d3f0: 7320 6973 2061 206d 6978 206f 6620 3120  s is a mix of 1 
+0003d400: 7061 7274 6974 696f 6e20 616e 6420 312b  partition and 1+
+0003d410: 2070 6172 7469 7469 6f6e 2064 6174 6166   partition dataf
+0003d420: 7261 6d65 732c 0a20 2020 2020 2020 2023  rames,.        #
+0003d430: 2075 7365 206c 6f6e 6765 7374 2064 6976   use longest div
+0003d440: 6973 696f 6e73 2066 6f75 6e64 0a20 2020  isions found.   
+0003d450: 2020 2020 2064 6976 6973 696f 6e73 203d       divisions =
+0003d460: 206d 6178 2828 642e 6469 7669 7369 6f6e   max((d.division
+0003d470: 7320 666f 7220 6420 696e 2064 6673 292c  s for d in dfs),
+0003d480: 206b 6579 3d6c 656e 290a 2020 2020 6966   key=len).    if
+0003d490: 2074 7261 6e73 666f 726d 5f64 6976 6973   transform_divis
+0003d4a0: 696f 6e73 2061 6e64 2069 7369 6e73 7461  ions and isinsta
+0003d4b0: 6e63 6528 6466 735b 305d 2c20 496e 6465  nce(dfs[0], Inde
+0003d4c0: 7829 2061 6e64 206c 656e 2864 6673 2920  x) and len(dfs) 
+0003d4d0: 3d3d 2031 3a0a 2020 2020 2020 2020 7472  == 1:.        tr
+0003d4e0: 793a 0a20 2020 2020 2020 2020 2020 2064  y:.            d
+0003d4f0: 6976 6973 696f 6e73 203d 2066 756e 6328  ivisions = func(
+0003d500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d510: 202a 5b70 642e 496e 6465 7828 612e 6469   *[pd.Index(a.di
+0003d520: 7669 7369 6f6e 7329 2069 6620 6120 6973  visions) if a is
+0003d530: 2064 6673 5b30 5d20 656c 7365 2061 2066   dfs[0] else a f
+0003d540: 6f72 2061 2069 6e20 6172 6773 5d2c 202a  or a in args], *
+0003d550: 2a6b 7761 7267 730a 2020 2020 2020 2020  *kwargs.        
+0003d560: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0003d570: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0003d580: 6469 7669 7369 6f6e 732c 2070 642e 496e  divisions, pd.In
+0003d590: 6465 7829 3a0a 2020 2020 2020 2020 2020  dex):.          
+0003d5a0: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
+0003d5b0: 3d20 6d65 7468 6f64 732e 746f 6c69 7374  = methods.tolist
+0003d5c0: 2864 6976 6973 696f 6e73 290a 2020 2020  (divisions).    
+0003d5d0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+0003d5e0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
+0003d5f0: 2020 7061 7373 0a20 2020 2020 2020 2065    pass.        e
+0003d600: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0003d610: 2069 6620 6e6f 7420 7661 6c69 645f 6469   if not valid_di
+0003d620: 7669 7369 6f6e 7328 6469 7669 7369 6f6e  visions(division
+0003d630: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+0003d640: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
+0003d650: 5b4e 6f6e 655d 202a 2028 6466 735b 305d  [None] * (dfs[0]
+0003d660: 2e6e 7061 7274 6974 696f 6e73 202b 2031  .npartitions + 1
+0003d670: 290a 2020 2020 7265 7475 726e 2064 6976  ).    return div
+0003d680: 6973 696f 6e73 0a0a 0a64 6566 205f 6765  isions...def _ge
+0003d690: 745f 6d65 7461 5f6d 6170 5f70 6172 7469  t_meta_map_parti
+0003d6a0: 7469 6f6e 7328 6172 6773 2c20 6466 732c  tions(args, dfs,
+0003d6b0: 2066 756e 632c 206b 7761 7267 732c 206d   func, kwargs, m
+0003d6c0: 6574 612c 2070 6172 656e 745f 6d65 7461  eta, parent_meta
+0003d6d0: 293a 0a20 2020 2022 2222 0a20 2020 2048  ):.    """.    H
+0003d6e0: 656c 7065 7220 746f 2067 656e 6572 6174  elper to generat
+0003d6f0: 6520 6d65 7461 6461 7461 2066 6f72 206d  e metadata for m
+0003d700: 6170 5f70 6172 7469 7469 6f6e 7320 616e  ap_partitions an
+0003d710: 6420 6d61 705f 6f76 6572 6c61 7020 6f75  d map_overlap ou
+0003d720: 7470 7574 2e0a 2020 2020 2222 220a 2020  tput..    """.  
+0003d730: 2020 6d65 7461 5f69 6e64 6578 203d 2067    meta_index = g
+0003d740: 6574 6174 7472 286d 616b 655f 6d65 7461  etattr(make_meta
+0003d750: 2864 6673 5b30 5d29 2c20 2269 6e64 6578  (dfs[0]), "index
+0003d760: 222c 204e 6f6e 6529 2069 6620 6466 7320  ", None) if dfs 
+0003d770: 656c 7365 204e 6f6e 650a 2020 2020 6966  else None.    if
+0003d780: 2070 6172 656e 745f 6d65 7461 2069 7320   parent_meta is 
+0003d790: 4e6f 6e65 2061 6e64 2064 6673 3a0a 2020  None and dfs:.  
+0003d7a0: 2020 2020 2020 7061 7265 6e74 5f6d 6574        parent_met
+0003d7b0: 6120 3d20 6466 735b 305d 2e5f 6d65 7461  a = dfs[0]._meta
+0003d7c0: 0a20 2020 2069 6620 6d65 7461 2069 7320  .    if meta is 
+0003d7d0: 6e6f 5f64 6566 6175 6c74 3a0a 2020 2020  no_default:.    
+0003d7e0: 2020 2020 2320 5573 6520 6e6f 6e2d 6e6f      # Use non-no
+0003d7f0: 726d 616c 697a 6564 206b 7761 7267 7320  rmalized kwargs 
+0003d800: 6865 7265 2c20 6173 2077 6520 7761 6e74  here, as we want
+0003d810: 2074 6865 2072 6561 6c20 7661 6c75 6573   the real values
+0003d820: 2028 6e6f 740a 2020 2020 2020 2020 2320   (not.        # 
+0003d830: 6465 6c61 7965 6420 7661 6c75 6573 290a  delayed values).
+0003d840: 2020 2020 2020 2020 6d65 7461 203d 205f          meta = _
+0003d850: 656d 756c 6174 6528 6675 6e63 2c20 2a61  emulate(func, *a
+0003d860: 7267 732c 2075 6466 3d54 7275 652c 202a  rgs, udf=True, *
+0003d870: 2a6b 7761 7267 7329 0a20 2020 2020 2020  *kwargs).       
+0003d880: 206d 6574 615f 6973 5f65 6d75 6c61 7465   meta_is_emulate
+0003d890: 6420 3d20 5472 7565 0a20 2020 2065 6c73  d = True.    els
+0003d8a0: 653a 0a20 2020 2020 2020 206d 6574 6120  e:.        meta 
+0003d8b0: 3d20 6d61 6b65 5f6d 6574 6128 6d65 7461  = make_meta(meta
+0003d8c0: 2c20 696e 6465 783d 6d65 7461 5f69 6e64  , index=meta_ind
+0003d8d0: 6578 2c20 7061 7265 6e74 5f6d 6574 613d  ex, parent_meta=
+0003d8e0: 7061 7265 6e74 5f6d 6574 6129 0a20 2020  parent_meta).   
+0003d8f0: 2020 2020 206d 6574 615f 6973 5f65 6d75       meta_is_emu
+0003d900: 6c61 7465 6420 3d20 4661 6c73 650a 0a20  lated = False.. 
+0003d910: 2020 2069 6620 6e6f 7420 2868 6173 5f70     if not (has_p
+0003d920: 6172 616c 6c65 6c5f 7479 7065 286d 6574  arallel_type(met
+0003d930: 6129 206f 7220 6973 5f61 7272 6179 6c69  a) or is_arrayli
+0003d940: 6b65 286d 6574 6129 2061 6e64 206d 6574  ke(meta) and met
+0003d950: 612e 7368 6170 6529 2061 6e64 206e 6f74  a.shape) and not
+0003d960: 2061 6c6c 280a 2020 2020 2020 2020 6973   all(.        is
+0003d970: 696e 7374 616e 6365 2861 7267 2c20 5363  instance(arg, Sc
+0003d980: 616c 6172 2920 666f 7220 6172 6720 696e  alar) for arg in
+0003d990: 2061 7267 730a 2020 2020 293a 0a20 2020   args.    ):.   
+0003d9a0: 2020 2020 2069 6620 6e6f 7420 6d65 7461       if not meta
+0003d9b0: 5f69 735f 656d 756c 6174 6564 3a0a 2020  _is_emulated:.  
+0003d9c0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+0003d9d0: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+0003d9e0: 2020 2020 2020 2020 2022 4d65 7461 2069           "Meta i
+0003d9f0: 7320 6e6f 7420 7661 6c69 642c 2060 6d61  s not valid, `ma
+0003da00: 705f 7061 7274 6974 696f 6e73 6020 616e  p_partitions` an
+0003da10: 6420 606d 6170 5f6f 7665 726c 6170 6020  d `map_overlap` 
+0003da20: 6578 7065 6374 7320 6f75 7470 7574 2074  expects output t
+0003da30: 6f20 6265 2061 2070 616e 6461 7320 6f62  o be a pandas ob
+0003da40: 6a65 6374 2e20 220a 2020 2020 2020 2020  ject. ".        
+0003da50: 2020 2020 2020 2020 2254 7279 2070 6173          "Try pas
+0003da60: 7369 6e67 2061 2070 616e 6461 7320 6f62  sing a pandas ob
+0003da70: 6a65 6374 2061 7320 6d65 7461 206f 7220  ject as meta or 
+0003da80: 6120 6469 6374 206f 7220 7475 706c 6520  a dict or tuple 
+0003da90: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
+0003daa0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0003dab0: 2020 2022 286e 616d 652c 2064 7479 7065     "(name, dtype
+0003dac0: 2920 6f66 2074 6865 2063 6f6c 756d 6e73  ) of the columns
+0003dad0: 2e20 496e 2074 6865 2066 7574 7572 6520  . In the future 
+0003dae0: 7468 6520 6d65 7461 2079 6f75 2070 6173  the meta you pas
+0003daf0: 7365 6420 7769 6c6c 206e 6f74 2077 6f72  sed will not wor
+0003db00: 6b2e 222c 0a20 2020 2020 2020 2020 2020  k.",.           
+0003db10: 2020 2020 2046 7574 7572 6557 6172 6e69       FutureWarni
+0003db20: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
+0003db30: 290a 2020 2020 2020 2020 2320 4966 2060  ).        # If `
+0003db40: 6d65 7461 6020 6973 206e 6f74 2061 2070  meta` is not a p
+0003db50: 616e 6461 7320 6f62 6a65 6374 2c20 7468  andas object, th
+0003db60: 6520 636f 6e63 6174 656e 6174 6564 2072  e concatenated r
+0003db70: 6573 756c 7473 2077 696c 6c20 6265 2061  esults will be a
+0003db80: 0a20 2020 2020 2020 2023 2064 6966 6665  .        # diffe
+0003db90: 7265 6e74 2074 7970 650a 2020 2020 2020  rent type.      
+0003dba0: 2020 6d65 7461 203d 206d 616b 655f 6d65    meta = make_me
+0003dbb0: 7461 285f 636f 6e63 6174 285b 6d65 7461  ta(_concat([meta
+0003dbc0: 5d29 2c20 696e 6465 783d 6d65 7461 5f69  ]), index=meta_i
+0003dbd0: 6e64 6578 290a 0a20 2020 2023 2045 6e73  ndex)..    # Ens
+0003dbe0: 7572 6520 6d65 7461 2069 7320 656d 7074  ure meta is empt
+0003dbf0: 7920 7365 7269 6573 0a20 2020 206d 6574  y series.    met
+0003dc00: 6120 3d20 6d61 6b65 5f6d 6574 6128 6d65  a = make_meta(me
+0003dc10: 7461 2c20 7061 7265 6e74 5f6d 6574 613d  ta, parent_meta=
+0003dc20: 7061 7265 6e74 5f6d 6574 6129 0a0a 2020  parent_meta)..  
+0003dc30: 2020 7265 7475 726e 206d 6574 610a 0a0a    return meta...
+0003dc40: 6465 6620 6170 706c 795f 616e 645f 656e  def apply_and_en
+0003dc50: 666f 7263 6528 2a61 7267 732c 202a 2a6b  force(*args, **k
+0003dc60: 7761 7267 7329 3a0a 2020 2020 2222 2241  wargs):.    """A
+0003dc70: 7070 6c79 2061 2066 756e 6374 696f 6e2c  pply a function,
+0003dc80: 2061 6e64 2065 6e66 6f72 6365 2074 6865   and enforce the
+0003dc90: 206f 7574 7075 7420 746f 206d 6174 6368   output to match
+0003dca0: 206d 6574 610a 0a20 2020 2045 6e73 7572   meta..    Ensur
+0003dcb0: 6573 2074 6865 206f 7574 7075 7420 6861  es the output ha
+0003dcc0: 7320 7468 6520 7361 6d65 2063 6f6c 756d  s the same colum
+0003dcd0: 6e73 2c20 6576 656e 2069 6620 656d 7074  ns, even if empt
+0003dce0: 792e 2222 220a 2020 2020 6675 6e63 203d  y.""".    func =
+0003dcf0: 206b 7761 7267 732e 706f 7028 225f 6675   kwargs.pop("_fu
+0003dd00: 6e63 2229 0a20 2020 206d 6574 6120 3d20  nc").    meta = 
+0003dd10: 6b77 6172 6773 2e70 6f70 2822 5f6d 6574  kwargs.pop("_met
+0003dd20: 6122 290a 2020 2020 6466 203d 2066 756e  a").    df = fun
+0003dd30: 6328 2a61 7267 732c 202a 2a6b 7761 7267  c(*args, **kwarg
+0003dd40: 7329 0a20 2020 2069 6620 6973 5f64 6174  s).    if is_dat
+0003dd50: 6166 7261 6d65 5f6c 696b 6528 6466 2920  aframe_like(df) 
+0003dd60: 6f72 2069 735f 7365 7269 6573 5f6c 696b  or is_series_lik
+0003dd70: 6528 6466 2920 6f72 2069 735f 696e 6465  e(df) or is_inde
+0003dd80: 785f 6c69 6b65 2864 6629 3a0a 2020 2020  x_like(df):.    
+0003dd90: 2020 2020 6966 206e 6f74 206c 656e 2864      if not len(d
+0003dda0: 6629 3a0a 2020 2020 2020 2020 2020 2020  f):.            
+0003ddb0: 7265 7475 726e 206d 6574 610a 2020 2020  return meta.    
+0003ddc0: 2020 2020 6966 2069 735f 6461 7461 6672      if is_datafr
+0003ddd0: 616d 655f 6c69 6b65 2864 6629 3a0a 2020  ame_like(df):.  
+0003dde0: 2020 2020 2020 2020 2020 6368 6563 6b5f            check_
+0003ddf0: 6d61 7463 6869 6e67 5f63 6f6c 756d 6e73  matching_columns
+0003de00: 286d 6574 612c 2064 6629 0a20 2020 2020  (meta, df).     
+0003de10: 2020 2020 2020 2063 203d 206d 6574 612e         c = meta.
+0003de20: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
+0003de30: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0003de40: 2020 6320 3d20 6d65 7461 2e6e 616d 650a    c = meta.name.
+0003de50: 2020 2020 2020 2020 7265 7475 726e 205f          return _
+0003de60: 7265 6e61 6d65 2863 2c20 6466 290a 2020  rename(c, df).  
+0003de70: 2020 7265 7475 726e 2064 660a 0a0a 6465    return df...de
+0003de80: 6620 5f72 656e 616d 6528 636f 6c75 6d6e  f _rename(column
+0003de90: 732c 2064 6629 3a0a 2020 2020 2222 220a  s, df):.    """.
+0003dea0: 2020 2020 5265 6e61 6d65 2063 6f6c 756d      Rename colum
+0003deb0: 6e73 206f 6620 7064 2e44 6174 6146 7261  ns of pd.DataFra
+0003dec0: 6d65 206f 7220 6e61 6d65 206f 6620 7064  me or name of pd
+0003ded0: 2e53 6572 6965 732e 0a20 2020 204e 6f74  .Series..    Not
+0003dee0: 2066 6f72 2064 642e 4461 7461 4672 616d   for dd.DataFram
+0003def0: 6520 6f72 2064 642e 5365 7269 6573 2e0a  e or dd.Series..
+0003df00: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+0003df10: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0003df20: 2020 2063 6f6c 756d 6e73 203a 2074 7570     columns : tup
+0003df30: 6c65 2c20 7374 7269 6e67 2c20 7064 2e44  le, string, pd.D
+0003df40: 6174 6146 7261 6d65 206f 7220 7064 2e53  ataFrame or pd.S
+0003df50: 6572 6965 730a 2020 2020 2020 2020 436f  eries.        Co
+0003df60: 6c75 6d6e 206e 616d 6573 2c20 5365 7269  lumn names, Seri
+0003df70: 6573 206e 616d 6520 6f72 2070 616e 6461  es name or panda
+0003df80: 7320 696e 7374 616e 6365 2077 6869 6368  s instance which
+0003df90: 2068 6173 2074 6865 0a20 2020 2020 2020   has the.       
+0003dfa0: 2074 6172 6765 7420 636f 6c75 6d6e 206e   target column n
+0003dfb0: 616d 6573 202f 206e 616d 652e 0a20 2020  ames / name..   
+0003dfc0: 2064 6620 3a20 7064 2e44 6174 6146 7261   df : pd.DataFra
+0003dfd0: 6d65 206f 7220 7064 2e53 6572 6965 730a  me or pd.Series.
+0003dfe0: 2020 2020 2020 2020 7461 7267 6574 2044          target D
+0003dff0: 6174 6146 7261 6d65 202f 2053 6572 6965  ataFrame / Serie
+0003e000: 7320 746f 2062 6520 7265 6e61 6d65 640a  s to be renamed.
+0003e010: 2020 2020 2222 220a 2020 2020 6173 7365      """.    asse
+0003e020: 7274 206e 6f74 2069 7369 6e73 7461 6e63  rt not isinstanc
+0003e030: 6528 6466 2c20 5f46 7261 6d65 290a 0a20  e(df, _Frame).. 
+0003e040: 2020 2069 6620 636f 6c75 6d6e 7320 6973     if columns is
+0003e050: 206e 6f5f 6465 6661 756c 743a 0a20 2020   no_default:.   
+0003e060: 2020 2020 2072 6574 7572 6e20 6466 0a0a       return df..
+0003e070: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0003e080: 6528 636f 6c75 6d6e 732c 2049 7465 7261  e(columns, Itera
+0003e090: 746f 7229 3a0a 2020 2020 2020 2020 636f  tor):.        co
+0003e0a0: 6c75 6d6e 7320 3d20 6c69 7374 2863 6f6c  lumns = list(col
+0003e0b0: 756d 6e73 290a 0a20 2020 2069 6620 6973  umns)..    if is
+0003e0c0: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
+0003e0d0: 6466 293a 0a20 2020 2020 2020 2069 6620  df):.        if 
+0003e0e0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+0003e0f0: 6528 636f 6c75 6d6e 7329 3a0a 2020 2020  e(columns):.    
+0003e100: 2020 2020 2020 2020 636f 6c75 6d6e 7320          columns 
+0003e110: 3d20 636f 6c75 6d6e 732e 636f 6c75 6d6e  = columns.column
+0003e120: 730a 2020 2020 2020 2020 6966 206e 6f74  s.        if not
+0003e130: 2069 7369 6e73 7461 6e63 6528 636f 6c75   isinstance(colu
+0003e140: 6d6e 732c 2070 642e 496e 6465 7829 3a0a  mns, pd.Index):.
+0003e150: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+0003e160: 6d6e 7320 3d20 7064 2e49 6e64 6578 2863  mns = pd.Index(c
+0003e170: 6f6c 756d 6e73 290a 2020 2020 2020 2020  olumns).        
+0003e180: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
+0003e190: 206c 656e 2863 6f6c 756d 6e73 2920 3d3d   len(columns) ==
+0003e1a0: 206c 656e 2864 662e 636f 6c75 6d6e 7329   len(df.columns)
+0003e1b0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+0003e1c0: 2074 7970 6528 636f 6c75 6d6e 7329 2069   type(columns) i
+0003e1d0: 7320 7479 7065 2864 662e 636f 6c75 6d6e  s type(df.column
+0003e1e0: 7329 0a20 2020 2020 2020 2020 2020 2061  s).            a
+0003e1f0: 6e64 2063 6f6c 756d 6e73 2e64 7479 7065  nd columns.dtype
+0003e200: 203d 3d20 6466 2e63 6f6c 756d 6e73 2e64   == df.columns.d
+0003e210: 7479 7065 0a20 2020 2020 2020 2020 2020  type.           
+0003e220: 2061 6e64 2063 6f6c 756d 6e73 2e65 7175   and columns.equ
+0003e230: 616c 7328 6466 2e63 6f6c 756d 6e73 290a  als(df.columns).
+0003e240: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+0003e250: 2020 2020 2020 2023 2069 6620 7461 7267         # if targ
+0003e260: 6574 2069 7320 6964 656e 7469 6361 6c2c  et is identical,
+0003e270: 2072 656e 616d 6520 6973 206e 6f74 206e   rename is not n
+0003e280: 6563 6573 7361 7279 0a20 2020 2020 2020  ecessary.       
+0003e290: 2020 2020 2072 6574 7572 6e20 6466 0a20       return df. 
+0003e2a0: 2020 2020 2020 2023 2064 6565 703d 4661         # deep=Fa
+0003e2b0: 6c73 6520 646f 6573 6e27 7420 646f 6573  lse doesn't does
+0003e2c0: 6e27 7420 636f 7079 2061 6e79 2064 6174  n't copy any dat
+0003e2d0: 612f 696e 6469 6365 732c 2073 6f20 7468  a/indices, so th
+0003e2e0: 6973 2069 7320 6368 6561 700a 2020 2020  is is cheap.    
+0003e2f0: 2020 2020 6466 203d 2064 662e 636f 7079      df = df.copy
+0003e300: 2864 6565 703d 4661 6c73 6529 0a20 2020  (deep=False).   
+0003e310: 2020 2020 2064 662e 636f 6c75 6d6e 7320       df.columns 
+0003e320: 3d20 636f 6c75 6d6e 730a 2020 2020 2020  = columns.      
+0003e330: 2020 7265 7475 726e 2064 660a 2020 2020    return df.    
+0003e340: 656c 6966 2069 735f 7365 7269 6573 5f6c  elif is_series_l
+0003e350: 696b 6528 6466 2920 6f72 2069 735f 696e  ike(df) or is_in
+0003e360: 6465 785f 6c69 6b65 2864 6629 3a0a 2020  dex_like(df):.  
+0003e370: 2020 2020 2020 6966 2069 735f 7365 7269        if is_seri
+0003e380: 6573 5f6c 696b 6528 636f 6c75 6d6e 7329  es_like(columns)
+0003e390: 206f 7220 6973 5f69 6e64 6578 5f6c 696b   or is_index_lik
+0003e3a0: 6528 636f 6c75 6d6e 7329 3a0a 2020 2020  e(columns):.    
+0003e3b0: 2020 2020 2020 2020 636f 6c75 6d6e 7320          columns 
+0003e3c0: 3d20 636f 6c75 6d6e 732e 6e61 6d65 0a20  = columns.name. 
+0003e3d0: 2020 2020 2020 2069 6620 6466 2e6e 616d         if df.nam
+0003e3e0: 6520 3d3d 2063 6f6c 756d 6e73 3a0a 2020  e == columns:.  
+0003e3f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0003e400: 2064 660a 2020 2020 2020 2020 7265 7475   df.        retu
+0003e410: 726e 2064 662e 7265 6e61 6d65 2863 6f6c  rn df.rename(col
+0003e420: 756d 6e73 290a 2020 2020 2320 6d61 705f  umns).    # map_
+0003e430: 7061 7274 6974 696f 6e20 6d61 7920 7061  partition may pa
+0003e440: 7373 206f 7468 6572 2074 7970 6573 0a20  ss other types. 
+0003e450: 2020 2072 6574 7572 6e20 6466 0a0a 0a64     return df...d
+0003e460: 6566 205f 7265 6e61 6d65 5f64 6173 6b28  ef _rename_dask(
+0003e470: 6466 2c20 6e61 6d65 7329 3a0a 2020 2020  df, names):.    
+0003e480: 2222 220a 2020 2020 4465 7374 7275 6374  """.    Destruct
+0003e490: 6976 656c 7920 7265 6e61 6d65 2063 6f6c  ively rename col
+0003e4a0: 756d 6e73 206f 6620 6464 2e44 6174 6146  umns of dd.DataF
+0003e4b0: 7261 6d65 206f 7220 6e61 6d65 206f 6620  rame or name of 
+0003e4c0: 6464 2e53 6572 6965 732e 0a20 2020 204e  dd.Series..    N
+0003e4d0: 6f74 2066 6f72 2070 642e 4461 7461 4672  ot for pd.DataFr
+0003e4e0: 616d 6520 6f72 2070 642e 5365 7269 6573  ame or pd.Series
+0003e4f0: 2e0a 0a20 2020 2049 6e74 6572 6e61 6c6c  ...    Internall
+0003e500: 7920 7573 6564 2074 6f20 6f76 6572 7772  y used to overwr
+0003e510: 6974 6520 6464 2e44 6174 6146 7261 6d65  ite dd.DataFrame
+0003e520: 2e63 6f6c 756d 6e73 2061 6e64 2064 642e  .columns and dd.
+0003e530: 5365 7269 6573 2e6e 616d 650a 2020 2020  Series.name.    
+0003e540: 5765 2063 616e 2774 2075 7365 206d 6170  We can't use map
+0003e550: 5f70 6172 7469 7469 6f6e 2062 6563 6175  _partition becau
+0003e560: 7365 2069 7420 6170 706c 6965 7320 6675  se it applies fu
+0003e570: 6e63 7469 6f6e 2074 6865 6e20 7265 6e61  nction then rena
+0003e580: 6d65 0a0a 2020 2020 5061 7261 6d65 7465  me..    Paramete
+0003e590: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+0003e5a0: 2d0a 2020 2020 6466 203a 2064 642e 4461  -.    df : dd.Da
+0003e5b0: 7461 4672 616d 6520 6f72 2064 642e 5365  taFrame or dd.Se
+0003e5c0: 7269 6573 0a20 2020 2020 2020 2074 6172  ries.        tar
+0003e5d0: 6765 7420 4461 7461 4672 616d 6520 2f20  get DataFrame / 
+0003e5e0: 5365 7269 6573 2074 6f20 6265 2072 656e  Series to be ren
+0003e5f0: 616d 6564 0a20 2020 206e 616d 6573 203a  amed.    names :
+0003e600: 2074 7570 6c65 2c20 7374 7269 6e67 0a20   tuple, string. 
+0003e610: 2020 2020 2020 2043 6f6c 756d 6e20 6e61         Column na
+0003e620: 6d65 732f 5365 7269 6573 206e 616d 650a  mes/Series name.
+0003e630: 2020 2020 2222 220a 0a20 2020 2061 7373      """..    ass
+0003e640: 6572 7420 6973 696e 7374 616e 6365 2864  ert isinstance(d
+0003e650: 662c 205f 4672 616d 6529 0a20 2020 206d  f, _Frame).    m
+0003e660: 6574 6164 6174 6120 3d20 5f72 656e 616d  etadata = _renam
+0003e670: 6528 6e61 6d65 732c 2064 662e 5f6d 6574  e(names, df._met
+0003e680: 6129 0a20 2020 206e 616d 6520 3d20 6622  a).    name = f"
+0003e690: 7265 6e61 6d65 2d7b 746f 6b65 6e69 7a65  rename-{tokenize
+0003e6a0: 2864 662c 206d 6574 6164 6174 6129 7d22  (df, metadata)}"
+0003e6b0: 0a0a 2020 2020 6473 6b20 3d20 7061 7274  ..    dsk = part
+0003e6c0: 6974 696f 6e77 6973 655f 6772 6170 6828  itionwise_graph(
+0003e6d0: 5f72 656e 616d 652c 206e 616d 652c 206d  _rename, name, m
+0003e6e0: 6574 6164 6174 612c 2064 6629 0a20 2020  etadata, df).   
+0003e6f0: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+0003e700: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+0003e710: 6c65 6374 696f 6e73 286e 616d 652c 2064  lections(name, d
+0003e720: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
+0003e730: 3d5b 6466 5d29 0a20 2020 2072 6574 7572  =[df]).    retur
+0003e740: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
+0003e750: 6772 6170 682c 206e 616d 652c 206d 6574  graph, name, met
+0003e760: 6164 6174 612c 2064 662e 6469 7669 7369  adata, df.divisi
+0003e770: 6f6e 7329 0a0a 0a64 6566 2071 7561 6e74  ons)...def quant
+0003e780: 696c 6528 6466 2c20 712c 206d 6574 686f  ile(df, q, metho
+0003e790: 643d 2264 6566 6175 6c74 2229 3a0a 2020  d="default"):.  
+0003e7a0: 2020 2222 2241 7070 726f 7869 6d61 7465    """Approximate
+0003e7b0: 2071 7561 6e74 696c 6573 206f 6620 5365   quantiles of Se
+0003e7c0: 7269 6573 2e0a 0a20 2020 2050 6172 616d  ries...    Param
+0003e7d0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+0003e7e0: 2d2d 2d2d 0a20 2020 2071 203a 206c 6973  ----.    q : lis
+0003e7f0: 742f 6172 7261 7920 6f66 2066 6c6f 6174  t/array of float
+0003e800: 730a 2020 2020 2020 2020 4974 6572 6162  s.        Iterab
+0003e810: 6c65 206f 6620 6e75 6d62 6572 7320 7261  le of numbers ra
+0003e820: 6e67 696e 6720 6672 6f6d 2030 2074 6f20  nging from 0 to 
+0003e830: 3130 3020 666f 7220 7468 6520 6465 7369  100 for the desi
+0003e840: 7265 6420 7175 616e 7469 6c65 730a 2020  red quantiles.  
+0003e850: 2020 6d65 7468 6f64 203a 207b 2764 6566    method : {'def
+0003e860: 6175 6c74 272c 2027 7464 6967 6573 7427  ault', 'tdigest'
+0003e870: 2c20 2764 6173 6b27 7d2c 206f 7074 696f  , 'dask'}, optio
+0003e880: 6e61 6c0a 2020 2020 2020 2020 5768 6174  nal.        What
+0003e890: 206d 6574 686f 6420 746f 2075 7365 2e20   method to use. 
+0003e8a0: 4279 2064 6566 6175 6c74 2077 696c 6c20  By default will 
+0003e8b0: 7573 6520 6461 736b 2773 2069 6e74 6572  use dask's inter
+0003e8c0: 6e61 6c20 6375 7374 6f6d 0a20 2020 2020  nal custom.     
+0003e8d0: 2020 2061 6c67 6f72 6974 686d 2028 6060     algorithm (``
+0003e8e0: 2764 6173 6b27 6060 292e 2020 4966 2073  'dask'``).  If s
+0003e8f0: 6574 2074 6f20 6060 2774 6469 6765 7374  et to ``'tdigest
+0003e900: 2760 6020 7769 6c6c 2075 7365 2074 6469  '`` will use tdi
+0003e910: 6765 7374 2066 6f72 0a20 2020 2020 2020  gest for.       
+0003e920: 2066 6c6f 6174 7320 616e 6420 696e 7473   floats and ints
+0003e930: 2061 6e64 2066 616c 6c62 6163 6b20 746f   and fallback to
+0003e940: 2074 6865 2060 6027 6461 736b 2760 6020   the ``'dask'`` 
+0003e950: 6f74 6865 7277 6973 652e 0a20 2020 2022  otherwise..    "
+0003e960: 2222 0a20 2020 2023 2063 7572 7265 6e74  "".    # current
+0003e970: 2069 6d70 6c65 6d65 6e74 6174 696f 6e20   implementation 
+0003e980: 6e65 6564 7320 7120 746f 2062 6520 736f  needs q to be so
+0003e990: 7274 6564 2073 6f0a 2020 2020 2320 736f  rted so.    # so
+0003e9a0: 7274 2069 6620 6172 7261 792d 6c69 6b65  rt if array-like
+0003e9b0: 2c20 6f74 6865 7277 6973 6520 6c65 6176  , otherwise leav
+0003e9c0: 6520 6974 2061 6c6f 6e65 0a20 2020 2071  e it alone.    q
+0003e9d0: 5f6e 6461 7272 6179 203d 206e 702e 6172  _ndarray = np.ar
+0003e9e0: 7261 7928 7129 0a20 2020 2069 6620 715f  ray(q).    if q_
+0003e9f0: 6e64 6172 7261 792e 6e64 696d 203e 2030  ndarray.ndim > 0
+0003ea00: 3a0a 2020 2020 2020 2020 715f 6e64 6172  :.        q_ndar
+0003ea10: 7261 792e 736f 7274 286b 696e 643d 226d  ray.sort(kind="m
+0003ea20: 6572 6765 736f 7274 2229 0a20 2020 2020  ergesort").     
+0003ea30: 2020 2071 203d 2071 5f6e 6461 7272 6179     q = q_ndarray
+0003ea40: 0a0a 2020 2020 6173 7365 7274 2069 7369  ..    assert isi
+0003ea50: 6e73 7461 6e63 6528 6466 2c20 5365 7269  nstance(df, Seri
+0003ea60: 6573 290a 0a20 2020 2061 6c6c 6f77 6564  es)..    allowed
+0003ea70: 5f6d 6574 686f 6473 203d 205b 2264 6566  _methods = ["def
+0003ea80: 6175 6c74 222c 2022 6461 736b 222c 2022  ault", "dask", "
+0003ea90: 7464 6967 6573 7422 5d0a 2020 2020 6966  tdigest"].    if
+0003eaa0: 206d 6574 686f 6420 6e6f 7420 696e 2061   method not in a
+0003eab0: 6c6c 6f77 6564 5f6d 6574 686f 6473 3a0a  llowed_methods:.
+0003eac0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0003ead0: 6c75 6545 7272 6f72 2822 6d65 7468 6f64  lueError("method
+0003eae0: 2063 616e 206f 6e6c 7920 6265 2027 6465   can only be 'de
+0003eaf0: 6661 756c 7427 2c20 2764 6173 6b27 206f  fault', 'dask' o
+0003eb00: 7220 2774 6469 6765 7374 2722 290a 0a20  r 'tdigest'").. 
+0003eb10: 2020 2069 6620 6d65 7468 6f64 203d 3d20     if method == 
+0003eb20: 2264 6566 6175 6c74 223a 0a20 2020 2020  "default":.     
+0003eb30: 2020 2069 6e74 6572 6e61 6c5f 6d65 7468     internal_meth
+0003eb40: 6f64 203d 2022 6461 736b 220a 2020 2020  od = "dask".    
+0003eb50: 656c 7365 3a0a 2020 2020 2020 2020 696e  else:.        in
+0003eb60: 7465 726e 616c 5f6d 6574 686f 6420 3d20  ternal_method = 
+0003eb70: 6d65 7468 6f64 0a0a 2020 2020 2320 6375  method..    # cu
+0003eb80: 7272 656e 746c 792c 206f 6e6c 7920 5365  rrently, only Se
+0003eb90: 7269 6573 2068 6173 2071 7561 6e74 696c  ries has quantil
+0003eba0: 6520 6d65 7468 6f64 0a20 2020 2069 6620  e method.    if 
+0003ebb0: 6973 696e 7374 616e 6365 2864 662c 2049  isinstance(df, I
+0003ebc0: 6e64 6578 293a 0a20 2020 2020 2020 2073  ndex):.        s
+0003ebd0: 6572 6965 735f 7479 7020 3d20 6466 2e5f  eries_typ = df._
+0003ebe0: 6d65 7461 2e74 6f5f 7365 7269 6573 2829  meta.to_series()
+0003ebf0: 2e5f 636f 6e73 7472 7563 746f 720a 2020  ._constructor.  
+0003ec00: 2020 2020 2020 6d65 7461 203d 2064 662e        meta = df.
+0003ec10: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e74  _meta_nonempty.t
+0003ec20: 6f5f 7365 7269 6573 2829 2e71 7561 6e74  o_series().quant
+0003ec30: 696c 6528 7129 0a20 2020 2065 6c73 653a  ile(q).    else:
+0003ec40: 0a20 2020 2020 2020 2069 6620 6973 5f73  .        if is_s
+0003ec50: 6572 6965 735f 6c69 6b65 2864 662e 5f6d  eries_like(df._m
+0003ec60: 6574 6129 3a0a 2020 2020 2020 2020 2020  eta):.          
+0003ec70: 2020 7365 7269 6573 5f74 7970 203d 2064    series_typ = d
+0003ec80: 662e 5f6d 6574 612e 5f63 6f6e 7374 7275  f._meta._constru
+0003ec90: 6374 6f72 0a20 2020 2020 2020 2065 6c73  ctor.        els
+0003eca0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+0003ecb0: 6572 6965 735f 7479 7020 3d20 6466 2e5f  eries_typ = df._
+0003ecc0: 6d65 7461 2e5f 636f 6e73 7472 7563 746f  meta._constructo
+0003ecd0: 725f 736c 6963 6564 0a20 2020 2020 2020  r_sliced.       
+0003ece0: 206d 6574 6120 3d20 6466 2e5f 6d65 7461   meta = df._meta
+0003ecf0: 5f6e 6f6e 656d 7074 792e 7175 616e 7469  _nonempty.quanti
+0003ed00: 6c65 2871 290a 0a20 2020 2069 6620 6973  le(q)..    if is
+0003ed10: 5f73 6572 6965 735f 6c69 6b65 286d 6574  _series_like(met
+0003ed20: 6129 3a0a 2020 2020 2020 2020 2320 496e  a):.        # In
+0003ed30: 6465 782e 7175 616e 7469 6c65 286c 6973  dex.quantile(lis
+0003ed40: 742d 6c69 6b65 2920 6d75 7374 2062 6520  t-like) must be 
+0003ed50: 7064 2e53 6572 6965 732c 206e 6f74 2070  pd.Series, not p
+0003ed60: 642e 496e 6465 780a 2020 2020 2020 2020  d.Index.        
+0003ed70: 6466 5f6e 616d 6520 3d20 6466 2e6e 616d  df_name = df.nam
+0003ed80: 650a 2020 2020 2020 2020 6669 6e61 6c69  e.        finali
+0003ed90: 7a65 5f74 736b 203d 206c 616d 6264 6120  ze_tsk = lambda 
+0003eda0: 7473 6b3a 2028 7365 7269 6573 5f74 7970  tsk: (series_typ
+0003edb0: 2c20 7473 6b2c 2071 2c20 4e6f 6e65 2c20  , tsk, q, None, 
+0003edc0: 6466 5f6e 616d 6529 0a20 2020 2020 2020  df_name).       
+0003edd0: 2072 6574 7572 6e5f 7479 7065 203d 2053   return_type = S
+0003ede0: 6572 6965 730a 2020 2020 656c 7365 3a0a  eries.    else:.
+0003edf0: 2020 2020 2020 2020 2320 7265 7061 636b          # repack
+0003ee00: 2061 7320 5365 7269 6573 206f 626a 6563   as Series objec
+0003ee10: 7420 746f 2063 6f6e 7665 7274 2073 6361  t to convert sca
+0003ee20: 6c61 7273 2066 726f 6d20 4e75 6d50 7920  lars from NumPy 
+0003ee30: 6261 636b 2062 6566 6f72 6520 6578 7472  back before extr
+0003ee40: 6163 7469 6e67 0a20 2020 2020 2020 2066  acting.        f
+0003ee50: 696e 616c 697a 655f 7473 6b20 3d20 6c61  inalize_tsk = la
+0003ee60: 6d62 6461 2074 736b 3a20 280a 2020 2020  mbda tsk: (.    
+0003ee70: 2020 2020 2020 2020 6c61 6d62 6461 202a          lambda *
+0003ee80: 6172 6773 2c20 2a2a 6b77 6172 6773 3a20  args, **kwargs: 
+0003ee90: 7365 7269 6573 5f74 7970 282a 6172 6773  series_typ(*args
+0003eea0: 2c20 2a2a 6b77 6172 6773 295b 305d 2c0a  , **kwargs)[0],.
+0003eeb0: 2020 2020 2020 2020 2020 2020 7473 6b2c              tsk,
+0003eec0: 0a20 2020 2020 2020 2020 2020 205b 305d  .            [0]
+0003eed0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0003eee0: 2020 2020 7265 7475 726e 5f74 7970 6520      return_type 
+0003eef0: 3d20 5363 616c 6172 0a20 2020 2020 2020  = Scalar.       
+0003ef00: 2071 203d 205b 715d 0a0a 2020 2020 2320   q = [q]..    # 
+0003ef10: 7061 6e64 6173 2075 7365 7320 7175 616e  pandas uses quan
+0003ef20: 7469 6c65 2069 6e20 5b30 2c20 315d 0a20  tile in [0, 1]. 
+0003ef30: 2020 2023 206e 756d 7079 202f 2065 7665     # numpy / eve
+0003ef40: 7279 6f6e 6520 656c 7365 2075 7365 7320  ryone else uses 
+0003ef50: 5b30 2c20 3130 305d 0a20 2020 2071 7320  [0, 100].    qs 
+0003ef60: 3d20 6e70 2e61 7361 7272 6179 2871 2920  = np.asarray(q) 
+0003ef70: 2a20 3130 300a 2020 2020 746f 6b65 6e20  * 100.    token 
+0003ef80: 3d20 746f 6b65 6e69 7a65 2864 662c 2071  = tokenize(df, q
+0003ef90: 7329 0a0a 2020 2020 6966 206c 656e 2871  s)..    if len(q
+0003efa0: 7329 203d 3d20 303a 0a20 2020 2020 2020  s) == 0:.       
+0003efb0: 206e 616d 6520 3d20 2271 7561 6e74 696c   name = "quantil
+0003efc0: 6573 2d22 202b 2074 6f6b 656e 0a20 2020  es-" + token.   
+0003efd0: 2020 2020 2065 6d70 7479 5f69 6e64 6578       empty_index
+0003efe0: 203d 2070 642e 496e 6465 7828 5b5d 2c20   = pd.Index([], 
+0003eff0: 6474 7970 653d 666c 6f61 7429 0a0a 2020  dtype=float)..  
+0003f000: 2020 2020 2020 7265 7475 726e 2053 6572        return Ser
+0003f010: 6965 7328 0a20 2020 2020 2020 2020 2020  ies(.           
+0003f020: 207b 286e 616d 652c 2030 293a 2073 6572   {(name, 0): ser
+0003f030: 6965 735f 7479 7028 5b5d 2c20 6e61 6d65  ies_typ([], name
+0003f040: 3d64 662e 6e61 6d65 2c20 696e 6465 783d  =df.name, index=
+0003f050: 656d 7074 795f 696e 6465 782c 2064 7479  empty_index, dty
+0003f060: 7065 3d22 666c 6f61 7422 297d 2c0a 2020  pe="float")},.  
+0003f070: 2020 2020 2020 2020 2020 6e61 6d65 2c0a            name,.
+0003f080: 2020 2020 2020 2020 2020 2020 6466 2e5f              df._
+0003f090: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
+0003f0a0: 2020 5b4e 6f6e 652c 204e 6f6e 655d 2c0a    [None, None],.
+0003f0b0: 2020 2020 2020 2020 290a 2020 2020 656c          ).    el
+0003f0c0: 7365 3a0a 2020 2020 2020 2020 6e65 775f  se:.        new_
+0003f0d0: 6469 7669 7369 6f6e 7320 3d20 5b6e 702e  divisions = [np.
+0003f0e0: 6d69 6e28 7129 2c20 6e70 2e6d 6178 2871  min(q), np.max(q
+0003f0f0: 295d 0a0a 2020 2020 6466 203d 2064 662e  )]..    df = df.
+0003f100: 6472 6f70 6e61 2829 0a0a 2020 2020 6966  dropna()..    if
+0003f110: 2069 6e74 6572 6e61 6c5f 6d65 7468 6f64   internal_method
+0003f120: 203d 3d20 2274 6469 6765 7374 2220 616e   == "tdigest" an
+0003f130: 6420 280a 2020 2020 2020 2020 6e70 2e69  d (.        np.i
+0003f140: 7373 7562 6474 7970 6528 6466 2e64 7479  ssubdtype(df.dty
+0003f150: 7065 2c20 6e70 2e66 6c6f 6174 696e 6729  pe, np.floating)
+0003f160: 206f 7220 6e70 2e69 7373 7562 6474 7970   or np.issubdtyp
+0003f170: 6528 6466 2e64 7479 7065 2c20 6e70 2e69  e(df.dtype, np.i
+0003f180: 6e74 6567 6572 290a 2020 2020 293a 0a20  nteger).    ):. 
+0003f190: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+0003f1a0: 2e75 7469 6c73 2069 6d70 6f72 7420 696d  .utils import im
+0003f1b0: 706f 7274 5f72 6571 7569 7265 640a 0a20  port_required.. 
+0003f1c0: 2020 2020 2020 2069 6d70 6f72 745f 7265         import_re
+0003f1d0: 7175 6972 6564 280a 2020 2020 2020 2020  quired(.        
+0003f1e0: 2020 2020 2263 7269 636b 222c 2022 6372      "crick", "cr
+0003f1f0: 6963 6b20 6973 2061 2072 6571 7569 7265  ick is a require
+0003f200: 6420 6465 7065 6e64 656e 6379 2066 6f72  d dependency for
+0003f210: 2075 7369 6e67 2074 6865 2074 2d64 6967   using the t-dig
+0003f220: 6573 7420 6d65 7468 6f64 2e22 0a20 2020  est method.".   
+0003f230: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0003f240: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
+0003f250: 7065 7263 656e 7469 6c65 2069 6d70 6f72  percentile impor
+0003f260: 7420 5f70 6572 6365 6e74 696c 6573 5f66  t _percentiles_f
+0003f270: 726f 6d5f 7464 6967 6573 742c 205f 7464  rom_tdigest, _td
+0003f280: 6967 6573 745f 6368 756e 6b0a 0a20 2020  igest_chunk..   
+0003f290: 2020 2020 206e 616d 6520 3d20 2271 7561       name = "qua
+0003f2a0: 6e74 696c 6573 5f74 6469 6765 7374 2d31  ntiles_tdigest-1
+0003f2b0: 2d22 202b 2074 6f6b 656e 0a20 2020 2020  -" + token.     
+0003f2c0: 2020 2076 616c 5f64 736b 203d 207b 0a20     val_dsk = {. 
+0003f2d0: 2020 2020 2020 2020 2020 2028 6e61 6d65             (name
+0003f2e0: 2c20 6929 3a20 285f 7464 6967 6573 745f  , i): (_tdigest_
+0003f2f0: 6368 756e 6b2c 2028 6765 7461 7474 722c  chunk, (getattr,
+0003f300: 206b 6579 2c20 2276 616c 7565 7322 2929   key, "values"))
+0003f310: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0003f320: 2069 2c20 6b65 7920 696e 2065 6e75 6d65   i, key in enume
+0003f330: 7261 7465 2864 662e 5f5f 6461 736b 5f6b  rate(df.__dask_k
+0003f340: 6579 735f 5f28 2929 0a20 2020 2020 2020  eys__()).       
+0003f350: 207d 0a0a 2020 2020 2020 2020 6e61 6d65   }..        name
+0003f360: 3220 3d20 2271 7561 6e74 696c 6573 5f74  2 = "quantiles_t
+0003f370: 6469 6765 7374 2d32 2d22 202b 2074 6f6b  digest-2-" + tok
+0003f380: 656e 0a20 2020 2020 2020 206d 6572 6765  en.        merge
+0003f390: 5f64 736b 203d 207b 0a20 2020 2020 2020  _dsk = {.       
+0003f3a0: 2020 2020 2028 6e61 6d65 322c 2030 293a       (name2, 0):
+0003f3b0: 2066 696e 616c 697a 655f 7473 6b28 285f   finalize_tsk((_
+0003f3c0: 7065 7263 656e 7469 6c65 735f 6672 6f6d  percentiles_from
+0003f3d0: 5f74 6469 6765 7374 2c20 7173 2c20 736f  _tdigest, qs, so
+0003f3e0: 7274 6564 2876 616c 5f64 736b 2929 290a  rted(val_dsk))).
+0003f3f0: 2020 2020 2020 2020 7d0a 2020 2020 656c          }.    el
+0003f400: 7365 3a0a 2020 2020 2020 2020 6672 6f6d  se:.        from
+0003f410: 2064 6173 6b2e 6172 7261 792e 6469 7370   dask.array.disp
+0003f420: 6174 6368 2069 6d70 6f72 7420 7065 7263  atch import perc
+0003f430: 656e 7469 6c65 5f6c 6f6f 6b75 7020 6173  entile_lookup as
+0003f440: 205f 7065 7263 656e 7469 6c65 0a20 2020   _percentile.   
+0003f450: 2020 2020 2066 726f 6d20 6461 736b 2e61       from dask.a
+0003f460: 7272 6179 2e70 6572 6365 6e74 696c 6520  rray.percentile 
+0003f470: 696d 706f 7274 206d 6572 6765 5f70 6572  import merge_per
+0003f480: 6365 6e74 696c 6573 0a0a 2020 2020 2020  centiles..      
+0003f490: 2020 2320 4164 6420 3020 616e 6420 3130    # Add 0 and 10
+0003f4a0: 3020 6475 7269 6e67 2063 616c 6375 6c61  0 during calcula
+0003f4b0: 7469 6f6e 2066 6f72 206d 6f72 6520 726f  tion for more ro
+0003f4c0: 6275 7374 2062 6568 6176 696f 7220 2868  bust behavior (h
+0003f4d0: 6f70 6566 756c 6c79 290a 2020 2020 2020  opefully).      
+0003f4e0: 2020 6361 6c63 5f71 7320 3d20 6e70 2e70    calc_qs = np.p
+0003f4f0: 6164 2871 732c 2031 2c20 6d6f 6465 3d22  ad(qs, 1, mode="
+0003f500: 636f 6e73 7461 6e74 2229 0a20 2020 2020  constant").     
+0003f510: 2020 2063 616c 635f 7173 5b2d 315d 203d     calc_qs[-1] =
+0003f520: 2031 3030 0a20 2020 2020 2020 206e 616d   100.        nam
+0003f530: 6520 3d20 2271 7561 6e74 696c 6573 2d31  e = "quantiles-1
+0003f540: 2d22 202b 2074 6f6b 656e 0a20 2020 2020  -" + token.     
+0003f550: 2020 2076 616c 5f64 736b 203d 207b 0a20     val_dsk = {. 
+0003f560: 2020 2020 2020 2020 2020 2028 6e61 6d65             (name
+0003f570: 2c20 6929 3a20 285f 7065 7263 656e 7469  , i): (_percenti
+0003f580: 6c65 2c20 6b65 792c 2063 616c 635f 7173  le, key, calc_qs
+0003f590: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+0003f5a0: 7220 692c 206b 6579 2069 6e20 656e 756d  r i, key in enum
+0003f5b0: 6572 6174 6528 6466 2e5f 5f64 6173 6b5f  erate(df.__dask_
+0003f5c0: 6b65 7973 5f5f 2829 290a 2020 2020 2020  keys__()).      
+0003f5d0: 2020 7d0a 0a20 2020 2020 2020 206e 616d    }..        nam
+0003f5e0: 6532 203d 2022 7175 616e 7469 6c65 732d  e2 = "quantiles-
+0003f5f0: 322d 2220 2b20 746f 6b65 6e0a 2020 2020  2-" + token.    
+0003f600: 2020 2020 6d65 7267 655f 6473 6b20 3d20      merge_dsk = 
+0003f610: 7b0a 2020 2020 2020 2020 2020 2020 286e  {.            (n
+0003f620: 616d 6532 2c20 3029 3a20 6669 6e61 6c69  ame2, 0): finali
+0003f630: 7a65 5f74 736b 280a 2020 2020 2020 2020  ze_tsk(.        
+0003f640: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
+0003f650: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0003f660: 7267 655f 7065 7263 656e 7469 6c65 732c  rge_percentiles,
+0003f670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f680: 2020 2020 2071 732c 0a20 2020 2020 2020       qs,.       
+0003f690: 2020 2020 2020 2020 2020 2020 205b 6361               [ca
+0003f6a0: 6c63 5f71 735d 202a 2064 662e 6e70 6172  lc_qs] * df.npar
+0003f6b0: 7469 7469 6f6e 732c 0a20 2020 2020 2020  titions,.       
+0003f6c0: 2020 2020 2020 2020 2020 2020 2073 6f72               sor
+0003f6d0: 7465 6428 7661 6c5f 6473 6b29 2c0a 2020  ted(val_dsk),.  
+0003f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f6f0: 2020 226c 6f77 6572 222c 0a20 2020 2020    "lower",.     
+0003f700: 2020 2020 2020 2020 2020 2020 2020 204e                 N
+0003f710: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+0003f720: 2020 2020 2020 2020 2046 616c 7365 2c0a           False,.
+0003f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f740: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+0003f750: 2020 2020 2020 2020 7d0a 2020 2020 6473          }.    ds
+0003f760: 6b20 3d20 6d65 7267 6528 7661 6c5f 6473  k = merge(val_ds
+0003f770: 6b2c 206d 6572 6765 5f64 736b 290a 2020  k, merge_dsk).  
+0003f780: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+0003f790: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+0003f7a0: 6c6c 6563 7469 6f6e 7328 6e61 6d65 322c  llections(name2,
+0003f7b0: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+0003f7c0: 6573 3d5b 6466 5d29 0a20 2020 2072 6574  es=[df]).    ret
+0003f7d0: 7572 6e20 7265 7475 726e 5f74 7970 6528  urn return_type(
+0003f7e0: 6772 6170 682c 206e 616d 6532 2c20 6d65  graph, name2, me
+0003f7f0: 7461 2c20 6e65 775f 6469 7669 7369 6f6e  ta, new_division
+0003f800: 7329 0a0a 0a64 6566 205f 636f 765f 636f  s)...def _cov_co
+0003f810: 7272 280a 2020 2020 6466 2c0a 2020 2020  rr(.    df,.    
+0003f820: 6d69 6e5f 7065 7269 6f64 733d 4e6f 6e65  min_periods=None
+0003f830: 2c0a 2020 2020 636f 7272 3d46 616c 7365  ,.    corr=False
+0003f840: 2c0a 2020 2020 7363 616c 6172 3d46 616c  ,.    scalar=Fal
+0003f850: 7365 2c0a 2020 2020 6e75 6d65 7269 635f  se,.    numeric_
+0003f860: 6f6e 6c79 3d6e 6f5f 6465 6661 756c 742c  only=no_default,
+0003f870: 0a20 2020 2073 706c 6974 5f65 7665 7279  .    split_every
+0003f880: 3d46 616c 7365 2c0a 293a 0a20 2020 2022  =False,.):.    "
+0003f890: 2222 4461 7461 4672 616d 6520 636f 7661  ""DataFrame cova
+0003f8a0: 7269 616e 6365 2061 6e64 2070 6561 7273  riance and pears
+0003f8b0: 6f6e 2063 6f72 7265 6c61 7469 6f6e 2e0a  on correlation..
+0003f8c0: 0a20 2020 2043 6f6d 7075 7465 7320 7061  .    Computes pa
+0003f8d0: 6972 7769 7365 2063 6f76 6172 6961 6e63  irwise covarianc
+0003f8e0: 6520 6f72 2063 6f72 7265 6c61 7469 6f6e  e or correlation
+0003f8f0: 206f 6620 636f 6c75 6d6e 732c 2065 7863   of columns, exc
+0003f900: 6c75 6469 6e67 204e 412f 6e75 6c6c 0a20  luding NA/null. 
+0003f910: 2020 2076 616c 7565 732e 0a0a 2020 2020     values...    
+0003f920: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
+0003f930: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6466  ---------.    df
+0003f940: 203a 2044 6174 6146 7261 6d65 0a20 2020   : DataFrame.   
+0003f950: 206d 696e 5f70 6572 696f 6473 203a 2069   min_periods : i
+0003f960: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
+0003f970: 2020 2020 204d 696e 696d 756d 206e 756d       Minimum num
+0003f980: 6265 7220 6f66 206f 6273 6572 7661 7469  ber of observati
+0003f990: 6f6e 7320 7265 7175 6972 6564 2070 6572  ons required per
+0003f9a0: 2070 6169 7220 6f66 2063 6f6c 756d 6e73   pair of columns
+0003f9b0: 0a20 2020 2020 2020 2074 6f20 6861 7665  .        to have
+0003f9c0: 2061 2076 616c 6964 2072 6573 756c 742e   a valid result.
+0003f9d0: 0a20 2020 2063 6f72 7220 3a20 626f 6f6c  .    corr : bool
+0003f9e0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0003f9f0: 2020 2049 6620 5472 7565 2c20 636f 6d70     If True, comp
+0003fa00: 7574 6520 7468 6520 5065 6172 736f 6e20  ute the Pearson 
+0003fa10: 636f 7272 656c 6174 696f 6e2e 2049 6620  correlation. If 
+0003fa20: 4661 6c73 6520 5b64 6566 6175 6c74 5d2c  False [default],
+0003fa30: 2063 6f6d 7075 7465 0a20 2020 2020 2020   compute.       
+0003fa40: 2074 6865 2063 6f76 6172 6961 6e63 652e   the covariance.
+0003fa50: 0a20 2020 2073 6361 6c61 7220 3a20 626f  .    scalar : bo
+0003fa60: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
+0003fa70: 2020 2020 2049 6620 5472 7565 2c20 636f       If True, co
+0003fa80: 6d70 7574 6520 636f 7661 7269 616e 6365  mpute covariance
+0003fa90: 2062 6574 7765 656e 2074 776f 2076 6172   between two var
+0003faa0: 6961 626c 6573 2061 7320 6120 7363 616c  iables as a scal
+0003fab0: 6172 2e20 4f6e 6c79 0a20 2020 2020 2020  ar. Only.       
+0003fac0: 2076 616c 6964 2069 6620 6064 6660 2068   valid if `df` h
+0003fad0: 6173 2032 2063 6f6c 756d 6e73 2e20 2049  as 2 columns.  I
+0003fae0: 6620 4661 6c73 6520 5b64 6566 6175 6c74  f False [default
+0003faf0: 5d2c 2063 6f6d 7075 7465 2074 6865 2065  ], compute the e
+0003fb00: 6e74 6972 650a 2020 2020 2020 2020 636f  ntire.        co
+0003fb10: 7661 7269 616e 6365 2f63 6f72 7265 6c61  variance/correla
+0003fb20: 7469 6f6e 206d 6174 7269 782e 0a20 2020  tion matrix..   
+0003fb30: 2073 706c 6974 5f65 7665 7279 203a 2069   split_every : i
+0003fb40: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
+0003fb50: 2020 2020 2047 726f 7570 2070 6172 7469       Group parti
+0003fb60: 7469 6f6e 7320 696e 746f 2067 726f 7570  tions into group
+0003fb70: 7320 6f66 2074 6869 7320 7369 7a65 2077  s of this size w
+0003fb80: 6869 6c65 2070 6572 666f 726d 696e 6720  hile performing 
+0003fb90: 610a 2020 2020 2020 2020 7472 6565 2d72  a.        tree-r
+0003fba0: 6564 7563 7469 6f6e 2e20 4966 2073 6574  eduction. If set
+0003fbb0: 2074 6f20 4661 6c73 652c 206e 6f20 7472   to False, no tr
+0003fbc0: 6565 2d72 6564 7563 7469 6f6e 2077 696c  ee-reduction wil
+0003fbd0: 6c20 6265 2075 7365 642e 0a20 2020 2020  l be used..     
+0003fbe0: 2020 2044 6566 6175 6c74 2069 7320 4661     Default is Fa
+0003fbf0: 6c73 652e 0a20 2020 2022 2222 0a20 2020  lse..    """.   
+0003fc00: 2069 6620 6d69 6e5f 7065 7269 6f64 7320   if min_periods 
+0003fc10: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0003fc20: 206d 696e 5f70 6572 696f 6473 203d 2032   min_periods = 2
+0003fc30: 0a20 2020 2065 6c69 6620 6d69 6e5f 7065  .    elif min_pe
+0003fc40: 7269 6f64 7320 3c20 323a 0a20 2020 2020  riods < 2:.     
+0003fc50: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0003fc60: 726f 7228 226d 696e 5f70 6572 696f 6473  ror("min_periods
+0003fc70: 206d 7573 7420 6265 203e 3d20 3222 290a   must be >= 2").
+0003fc80: 0a20 2020 2069 6620 7370 6c69 745f 6576  .    if split_ev
+0003fc90: 6572 7920 6973 2046 616c 7365 3a0a 2020  ery is False:.  
+0003fca0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
+0003fcb0: 7920 3d20 6466 2e6e 7061 7274 6974 696f  y = df.npartitio
+0003fcc0: 6e73 0a20 2020 2065 6c69 6620 7370 6c69  ns.    elif spli
+0003fcd0: 745f 6576 6572 7920 3c20 3220 6f72 206e  t_every < 2 or n
+0003fce0: 6f74 2069 7369 6e73 7461 6e63 6528 7370  ot isinstance(sp
+0003fcf0: 6c69 745f 6576 6572 792c 2049 6e74 6567  lit_every, Integ
+0003fd00: 7261 6c29 3a0a 2020 2020 2020 2020 7261  ral):.        ra
+0003fd10: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+0003fd20: 7370 6c69 745f 6576 6572 7920 6d75 7374  split_every must
+0003fd30: 2062 6520 616e 2069 6e74 6567 6572 203e   be an integer >
+0003fd40: 3d20 3222 290a 0a20 2020 2023 2048 616e  = 2")..    # Han
+0003fd50: 646c 6520 7365 6c65 6374 696e 6720 6e75  dle selecting nu
+0003fd60: 6d65 7269 6320 6461 7461 2061 6e64 2061  meric data and a
+0003fd70: 7373 6f63 6961 7465 6420 6465 7072 6563  ssociated deprec
+0003fd80: 6174 696f 6e20 7761 726e 696e 670a 2020  ation warning.  
+0003fd90: 2020 6d61 7962 655f 7761 726e 203d 2046    maybe_warn = F
+0003fda0: 616c 7365 0a20 2020 2069 6620 6e75 6d65  alse.    if nume
+0003fdb0: 7269 635f 6f6e 6c79 2069 7320 6e6f 5f64  ric_only is no_d
+0003fdc0: 6566 6175 6c74 3a0a 2020 2020 2020 2020  efault:.        
+0003fdd0: 6966 2050 414e 4441 535f 4754 5f32 3030  if PANDAS_GT_200
+0003fde0: 3a0a 2020 2020 2020 2020 2020 2020 6e75  :.            nu
+0003fdf0: 6d65 7269 635f 6f6e 6c79 203d 2046 616c  meric_only = Fal
+0003fe00: 7365 0a20 2020 2020 2020 2065 6c69 6620  se.        elif 
+0003fe10: 5041 4e44 4153 5f47 545f 3135 303a 0a20  PANDAS_GT_150:. 
+0003fe20: 2020 2020 2020 2020 2020 206d 6179 6265             maybe
+0003fe30: 5f77 6172 6e20 3d20 5472 7565 0a20 2020  _warn = True.   
+0003fe40: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
+0003fe50: 5f6f 6e6c 7920 3d20 5472 7565 0a20 2020  _only = True.   
+0003fe60: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0003fe70: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
+0003fe80: 6e6c 7920 3d20 5472 7565 0a0a 2020 2020  nly = True..    
+0003fe90: 616c 6c5f 6e75 6d65 7269 6320 3d20 6466  all_numeric = df
+0003fea0: 2e5f 6765 745f 6e75 6d65 7269 635f 6461  ._get_numeric_da
+0003feb0: 7461 2829 2e5f 6e61 6d65 203d 3d20 6466  ta()._name == df
+0003fec0: 2e5f 6e61 6d65 0a20 2020 2069 6620 6d61  ._name.    if ma
+0003fed0: 7962 655f 7761 726e 2061 6e64 206e 6f74  ybe_warn and not
+0003fee0: 2061 6c6c 5f6e 756d 6572 6963 3a0a 2020   all_numeric:.  
+0003fef0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+0003ff00: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
+0003ff10: 2022 5468 6520 6465 6661 756c 7420 7661   "The default va
+0003ff20: 6c75 6520 6f66 206e 756d 6572 6963 5f6f  lue of numeric_o
+0003ff30: 6e6c 7920 7769 6c6c 2062 6520 6046 616c  nly will be `Fal
+0003ff40: 7365 6020 220a 2020 2020 2020 2020 2020  se` ".          
+0003ff50: 2020 2269 6e20 6120 6675 7475 7265 2076    "in a future v
+0003ff60: 6572 7369 6f6e 206f 6620 4461 736b 2e22  ersion of Dask."
+0003ff70: 2c0a 2020 2020 2020 2020 2020 2020 4675  ,.            Fu
+0003ff80: 7475 7265 5761 726e 696e 672c 0a20 2020  tureWarning,.   
+0003ff90: 2020 2020 2029 0a0a 2020 2020 6966 206e       )..    if n
+0003ffa0: 756d 6572 6963 5f6f 6e6c 7920 616e 6420  umeric_only and 
+0003ffb0: 6e6f 7420 616c 6c5f 6e75 6d65 7269 633a  not all_numeric:
+0003ffc0: 0a20 2020 2020 2020 2064 6620 3d20 6466  .        df = df
+0003ffd0: 2e5f 6765 745f 6e75 6d65 7269 635f 6461  ._get_numeric_da
+0003ffe0: 7461 2829 0a0a 2020 2020 6966 2073 6361  ta()..    if sca
+0003fff0: 6c61 7220 616e 6420 6c65 6e28 6466 2e63  lar and len(df.c
+00040000: 6f6c 756d 6e73 2920 213d 2032 3a0a 2020  olumns) != 2:.  
+00040010: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00040020: 6545 7272 6f72 2822 7363 616c 6172 206f  eError("scalar o
+00040030: 6e6c 7920 7661 6c69 6420 666f 7220 3220  nly valid for 2 
+00040040: 636f 6c75 6d6e 2064 6174 6166 7261 6d65  column dataframe
+00040050: 2229 0a0a 2020 2020 746f 6b65 6e20 3d20  ")..    token = 
+00040060: 746f 6b65 6e69 7a65 2864 662c 206d 696e  tokenize(df, min
+00040070: 5f70 6572 696f 6473 2c20 7363 616c 6172  _periods, scalar
+00040080: 2c20 7370 6c69 745f 6576 6572 7929 0a0a  , split_every)..
+00040090: 2020 2020 6675 6e63 6e61 6d65 203d 2022      funcname = "
+000400a0: 636f 7272 2220 6966 2063 6f72 7220 656c  corr" if corr el
+000400b0: 7365 2022 636f 7622 0a20 2020 2061 203d  se "cov".    a =
+000400c0: 2066 227b 6675 6e63 6e61 6d65 7d2d 6368   f"{funcname}-ch
+000400d0: 756e 6b2d 7b64 662e 5f6e 616d 657d 220a  unk-{df._name}".
+000400e0: 2020 2020 6473 6b20 3d20 7b0a 2020 2020      dsk = {.    
+000400f0: 2020 2020 2861 2c20 6929 3a20 285f 636f      (a, i): (_co
+00040100: 765f 636f 7272 5f63 6875 6e6b 2c20 662c  v_corr_chunk, f,
+00040110: 2063 6f72 7229 2066 6f72 2028 692c 2066   corr) for (i, f
+00040120: 2920 696e 2065 6e75 6d65 7261 7465 2864  ) in enumerate(d
+00040130: 662e 5f5f 6461 736b 5f6b 6579 735f 5f28  f.__dask_keys__(
+00040140: 2929 0a20 2020 207d 0a0a 2020 2020 7072  )).    }..    pr
+00040150: 6566 6978 203d 2066 227b 6675 6e63 6e61  efix = f"{funcna
+00040160: 6d65 7d2d 636f 6d62 696e 652d 7b64 662e  me}-combine-{df.
+00040170: 5f6e 616d 657d 2d22 0a20 2020 206b 203d  _name}-".    k =
+00040180: 2064 662e 6e70 6172 7469 7469 6f6e 730a   df.npartitions.
+00040190: 2020 2020 6220 3d20 610a 2020 2020 6465      b = a.    de
+000401a0: 7074 6820 3d20 300a 2020 2020 7768 696c  pth = 0.    whil
+000401b0: 6520 6b20 3e20 7370 6c69 745f 6576 6572  e k > split_ever
+000401c0: 793a 0a20 2020 2020 2020 2062 203d 2070  y:.        b = p
+000401d0: 7265 6669 7820 2b20 7374 7228 6465 7074  refix + str(dept
+000401e0: 6829 0a20 2020 2020 2020 2066 6f72 2070  h).        for p
+000401f0: 6172 745f 692c 2069 6e64 7320 696e 2065  art_i, inds in e
+00040200: 6e75 6d65 7261 7465 2870 6172 7469 7469  numerate(partiti
+00040210: 6f6e 5f61 6c6c 2873 706c 6974 5f65 7665  on_all(split_eve
+00040220: 7279 2c20 7261 6e67 6528 6b29 2929 3a0a  ry, range(k))):.
+00040230: 2020 2020 2020 2020 2020 2020 6473 6b5b              dsk[
+00040240: 2862 2c20 7061 7274 5f69 295d 203d 2028  (b, part_i)] = (
+00040250: 5f63 6f76 5f63 6f72 725f 636f 6d62 696e  _cov_corr_combin
+00040260: 652c 205b 2861 2c20 6929 2066 6f72 2069  e, [(a, i) for i
+00040270: 2069 6e20 696e 6473 5d2c 2063 6f72 7229   in inds], corr)
+00040280: 0a20 2020 2020 2020 206b 203d 2070 6172  .        k = par
+00040290: 745f 6920 2b20 310a 2020 2020 2020 2020  t_i + 1.        
+000402a0: 6120 3d20 620a 2020 2020 2020 2020 6465  a = b.        de
+000402b0: 7074 6820 2b3d 2031 0a0a 2020 2020 6e61  pth += 1..    na
+000402c0: 6d65 203d 2066 227b 6675 6e63 6e61 6d65  me = f"{funcname
+000402d0: 7d2d 7b74 6f6b 656e 7d22 0a20 2020 2064  }-{token}".    d
+000402e0: 736b 5b28 6e61 6d65 2c20 3029 5d20 3d20  sk[(name, 0)] = 
+000402f0: 280a 2020 2020 2020 2020 5f63 6f76 5f63  (.        _cov_c
+00040300: 6f72 725f 6167 672c 0a20 2020 2020 2020  orr_agg,.       
+00040310: 205b 2861 2c20 6929 2066 6f72 2069 2069   [(a, i) for i i
+00040320: 6e20 7261 6e67 6528 6b29 5d2c 0a20 2020  n range(k)],.   
+00040330: 2020 2020 2064 662e 636f 6c75 6d6e 732c       df.columns,
+00040340: 0a20 2020 2020 2020 206d 696e 5f70 6572  .        min_per
+00040350: 696f 6473 2c0a 2020 2020 2020 2020 636f  iods,.        co
+00040360: 7272 2c0a 2020 2020 2020 2020 7363 616c  rr,.        scal
+00040370: 6172 2c0a 2020 2020 2020 2020 6466 2e5f  ar,.        df._
+00040380: 6d65 7461 2c0a 2020 2020 290a 2020 2020  meta,.    ).    
+00040390: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
+000403a0: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
+000403b0: 6563 7469 6f6e 7328 6e61 6d65 2c20 6473  ections(name, ds
+000403c0: 6b2c 2064 6570 656e 6465 6e63 6965 733d  k, dependencies=
+000403d0: 5b64 665d 290a 2020 2020 6966 2073 6361  [df]).    if sca
+000403e0: 6c61 723a 0a20 2020 2020 2020 2072 6574  lar:.        ret
+000403f0: 7572 6e20 5363 616c 6172 2867 7261 7068  urn Scalar(graph
+00040400: 2c20 6e61 6d65 2c20 2266 3822 290a 2020  , name, "f8").  
+00040410: 2020 6d65 7461 203d 206d 616b 655f 6d65    meta = make_me
+00040420: 7461 280a 2020 2020 2020 2020 5b28 632c  ta(.        [(c,
+00040430: 2022 6638 2229 2066 6f72 2063 2069 6e20   "f8") for c in 
+00040440: 6466 2e63 6f6c 756d 6e73 5d2c 0a20 2020  df.columns],.   
+00040450: 2020 2020 2069 6e64 6578 3d6d 6574 615f       index=meta_
+00040460: 7365 7269 6573 5f63 6f6e 7374 7275 6374  series_construct
+00040470: 6f72 2864 6629 2864 662e 636f 6c75 6d6e  or(df)(df.column
+00040480: 7329 2c0a 2020 2020 2020 2020 7061 7265  s),.        pare
+00040490: 6e74 5f6d 6574 613d 6466 2e5f 6d65 7461  nt_meta=df._meta
+000404a0: 2c0a 2020 2020 290a 2020 2020 7265 7475  ,.    ).    retu
+000404b0: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
+000404c0: 2867 7261 7068 2c20 6e61 6d65 2c20 6d65  (graph, name, me
+000404d0: 7461 2c20 2864 662e 636f 6c75 6d6e 732e  ta, (df.columns.
+000404e0: 6d69 6e28 292c 2064 662e 636f 6c75 6d6e  min(), df.column
+000404f0: 732e 6d61 7828 2929 290a 0a0a 6465 6620  s.max()))...def 
+00040500: 5f63 6f76 5f63 6f72 725f 6368 756e 6b28  _cov_corr_chunk(
+00040510: 6466 2c20 636f 7272 3d46 616c 7365 293a  df, corr=False):
+00040520: 0a20 2020 2022 2222 4368 756e 6b20 7061  .    """Chunk pa
+00040530: 7274 206f 6620 6120 636f 7661 7269 616e  rt of a covarian
+00040540: 6365 206f 7220 636f 7272 656c 6174 696f  ce or correlatio
+00040550: 6e20 636f 6d70 7574 6174 696f 6e22 2222  n computation"""
+00040560: 0a20 2020 2073 6861 7065 203d 2028 6466  .    shape = (df
+00040570: 2e73 6861 7065 5b31 5d2c 2064 662e 7368  .shape[1], df.sh
+00040580: 6170 655b 315d 290a 2020 2020 6466 203d  ape[1]).    df =
+00040590: 2064 662e 6173 7479 7065 2822 666c 6f61   df.astype("floa
+000405a0: 7436 3422 2c20 636f 7079 3d46 616c 7365  t64", copy=False
+000405b0: 290a 2020 2020 7375 6d73 203d 206e 702e  ).    sums = np.
+000405c0: 7a65 726f 735f 6c69 6b65 2864 662e 7661  zeros_like(df.va
+000405d0: 6c75 6573 2c20 7368 6170 653d 7368 6170  lues, shape=shap
+000405e0: 6529 0a20 2020 2063 6f75 6e74 7320 3d20  e).    counts = 
+000405f0: 6e70 2e7a 6572 6f73 5f6c 696b 6528 6466  np.zeros_like(df
+00040600: 2e76 616c 7565 732c 2073 6861 7065 3d73  .values, shape=s
+00040610: 6861 7065 290a 2020 2020 666f 7220 6964  hape).    for id
+00040620: 7820 696e 2072 616e 6765 286c 656e 2864  x in range(len(d
+00040630: 662e 636f 6c75 6d6e 7329 293a 0a20 2020  f.columns)):.   
+00040640: 2020 2020 206d 6173 6b20 3d20 6466 2e69       mask = df.i
+00040650: 6c6f 635b 3a2c 2069 6478 5d2e 6e6f 746e  loc[:, idx].notn
+00040660: 756c 6c28 290a 2020 2020 2020 2020 7375  ull().        su
+00040670: 6d73 5b69 6478 5d20 3d20 6466 5b6d 6173  ms[idx] = df[mas
+00040680: 6b5d 2e73 756d 2829 2e76 616c 7565 730a  k].sum().values.
+00040690: 2020 2020 2020 2020 636f 756e 7473 5b69          counts[i
+000406a0: 6478 5d20 3d20 6466 5b6d 6173 6b5d 2e63  dx] = df[mask].c
+000406b0: 6f75 6e74 2829 2e76 616c 7565 730a 2020  ount().values.  
+000406c0: 2020 2320 5370 6563 6961 6c20 6361 7365    # Special case
+000406d0: 2073 696e 676c 652d 726f 7720 4461 7461   single-row Data
+000406e0: 4672 616d 6520 636f 7620 746f 2061 766f  Frame cov to avo
+000406f0: 6964 2077 6172 6e69 6e67 7320 6672 6f6d  id warnings from
+00040700: 2070 616e 6461 732e 0a20 2020 2069 6620   pandas..    if 
+00040710: 6466 2e73 6861 7065 5b30 5d20 3d3d 2031  df.shape[0] == 1
+00040720: 3a0a 2020 2020 2020 2020 636f 7620 3d20  :.        cov = 
+00040730: 6e70 2e66 756c 6c5f 6c69 6b65 2873 756d  np.full_like(sum
+00040740: 732c 206e 702e 6e61 6e29 2020 2320 616c  s, np.nan)  # al
+00040750: 7761 7973 2061 6e20 616c 6c20 6e61 6e20  ways an all nan 
+00040760: 7265 7375 6c74 0a20 2020 2065 6c73 653a  result.    else:
+00040770: 0a20 2020 2020 2020 2063 6f76 203d 2064  .        cov = d
+00040780: 662e 636f 7628 292e 7661 6c75 6573 0a20  f.cov().values. 
+00040790: 2020 2064 7479 7065 203d 205b 2822 7375     dtype = [("su
+000407a0: 6d22 2c20 7375 6d73 2e64 7479 7065 292c  m", sums.dtype),
+000407b0: 2028 2263 6f75 6e74 222c 2063 6f75 6e74   ("count", count
+000407c0: 732e 6474 7970 6529 2c20 2822 636f 7622  s.dtype), ("cov"
+000407d0: 2c20 636f 762e 6474 7970 6529 5d0a 2020  , cov.dtype)].  
+000407e0: 2020 6966 2063 6f72 723a 0a20 2020 2020    if corr:.     
+000407f0: 2020 2077 6974 6820 7761 726e 696e 6773     with warnings
+00040800: 2e63 6174 6368 5f77 6172 6e69 6e67 7328  .catch_warnings(
+00040810: 7265 636f 7264 3d54 7275 6529 3a0a 2020  record=True):.  
+00040820: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+00040830: 6773 2e73 696d 706c 6566 696c 7465 7228  gs.simplefilter(
+00040840: 2261 6c77 6179 7322 290a 2020 2020 2020  "always").      
+00040850: 2020 2020 2020 6d75 203d 2028 7375 6d73        mu = (sums
+00040860: 202f 2063 6f75 6e74 7329 2e54 0a20 2020   / counts).T.   
+00040870: 2020 2020 206d 203d 206e 702e 7a65 726f       m = np.zero
+00040880: 735f 6c69 6b65 2864 662e 7661 6c75 6573  s_like(df.values
+00040890: 2c20 7368 6170 653d 7368 6170 6529 0a20  , shape=shape). 
+000408a0: 2020 2020 2020 206d 6173 6b20 3d20 6466         mask = df
+000408b0: 2e69 736e 756c 6c28 292e 7661 6c75 6573  .isnull().values
+000408c0: 0a20 2020 2020 2020 2066 6f72 2069 6478  .        for idx
+000408d0: 2069 6e20 7261 6e67 6528 6c65 6e28 6466   in range(len(df
+000408e0: 2e63 6f6c 756d 6e73 2929 3a0a 2020 2020  .columns)):.    
+000408f0: 2020 2020 2020 2020 2320 4176 6f69 6420          # Avoid 
+00040900: 7573 696e 6720 7566 756e 632e 6f75 7465  using ufunc.oute
+00040910: 7220 286e 6f74 2073 7570 706f 7274 6564  r (not supported
+00040920: 2062 7920 6375 7079 290a 2020 2020 2020   by cupy).      
+00040930: 2020 2020 2020 6d75 5f64 6973 6372 6570        mu_discrep
+00040940: 616e 6379 203d 2028 0a20 2020 2020 2020  ancy = (.       
+00040950: 2020 2020 2020 2020 206e 702e 7375 6274           np.subt
+00040960: 7261 6374 2864 662e 696c 6f63 5b3a 2c20  ract(df.iloc[:, 
+00040970: 6964 785d 2e76 616c 7565 735b 3a2c 204e  idx].values[:, N
+00040980: 6f6e 655d 2c20 6d75 5b69 6478 5d5b 4e6f  one], mu[idx][No
+00040990: 6e65 2c20 3a5d 2920 2a2a 2032 0a20 2020  ne, :]) ** 2.   
+000409a0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000409b0: 2020 2020 2020 206d 755f 6469 7363 7265         mu_discre
+000409c0: 7061 6e63 795b 6d61 736b 5d20 3d20 6e70  pancy[mask] = np
+000409d0: 2e6e 616e 0a20 2020 2020 2020 2020 2020  .nan.           
+000409e0: 206d 5b69 6478 5d20 3d20 6e70 2e6e 616e   m[idx] = np.nan
+000409f0: 7375 6d28 6d75 5f64 6973 6372 6570 616e  sum(mu_discrepan
+00040a00: 6379 2c20 6178 6973 3d30 290a 2020 2020  cy, axis=0).    
+00040a10: 2020 2020 6d20 3d20 6d2e 540a 2020 2020      m = m.T.    
+00040a20: 2020 2020 6474 7970 652e 6170 7065 6e64      dtype.append
+00040a30: 2828 226d 222c 206d 2e64 7479 7065 2929  (("m", m.dtype))
+00040a40: 0a0a 2020 2020 6f75 7420 3d20 7b22 7375  ..    out = {"su
+00040a50: 6d22 3a20 7375 6d73 2c20 2263 6f75 6e74  m": sums, "count
+00040a60: 223a 2063 6f75 6e74 732c 2022 636f 7622  ": counts, "cov"
+00040a70: 3a20 636f 7620 2a20 2863 6f75 6e74 7320  : cov * (counts 
+00040a80: 2d20 3129 7d0a 2020 2020 6966 2063 6f72  - 1)}.    if cor
+00040a90: 723a 0a20 2020 2020 2020 206f 7574 5b22  r:.        out["
+00040aa0: 6d22 5d20 3d20 6d0a 2020 2020 7265 7475  m"] = m.    retu
+00040ab0: 726e 206f 7574 0a0a 0a64 6566 205f 636f  rn out...def _co
+00040ac0: 765f 636f 7272 5f63 6f6d 6269 6e65 2864  v_corr_combine(d
+00040ad0: 6174 615f 696e 2c20 636f 7272 3d46 616c  ata_in, corr=Fal
+00040ae0: 7365 293a 0a20 2020 2064 6174 6120 3d20  se):.    data = 
+00040af0: 7b22 7375 6d22 3a20 4e6f 6e65 2c20 2263  {"sum": None, "c
+00040b00: 6f75 6e74 223a 204e 6f6e 652c 2022 636f  ount": None, "co
+00040b10: 7622 3a20 4e6f 6e65 7d0a 2020 2020 6966  v": None}.    if
+00040b20: 2063 6f72 723a 0a20 2020 2020 2020 2064   corr:.        d
+00040b30: 6174 615b 226d 225d 203d 204e 6f6e 650a  ata["m"] = None.
+00040b40: 0a20 2020 2066 6f72 206b 2069 6e20 6461  .    for k in da
+00040b50: 7461 2e6b 6579 7328 293a 0a20 2020 2020  ta.keys():.     
+00040b60: 2020 2064 6174 615b 6b5d 203d 205b 645b     data[k] = [d[
+00040b70: 6b5d 2066 6f72 2064 2069 6e20 6461 7461  k] for d in data
+00040b80: 5f69 6e5d 0a20 2020 2020 2020 2064 6174  _in].        dat
+00040b90: 615b 6b5d 203d 206e 702e 636f 6e63 6174  a[k] = np.concat
+00040ba0: 656e 6174 6528 6461 7461 5b6b 5d29 2e72  enate(data[k]).r
+00040bb0: 6573 6861 7065 2828 6c65 6e28 6461 7461  eshape((len(data
+00040bc0: 5b6b 5d29 2c29 202b 2064 6174 615b 6b5d  [k]),) + data[k]
+00040bd0: 5b30 5d2e 7368 6170 6529 0a0a 2020 2020  [0].shape)..    
+00040be0: 7375 6d73 203d 206e 702e 6e61 6e5f 746f  sums = np.nan_to
+00040bf0: 5f6e 756d 2864 6174 615b 2273 756d 225d  _num(data["sum"]
+00040c00: 290a 2020 2020 636f 756e 7473 203d 2064  ).    counts = d
+00040c10: 6174 615b 2263 6f75 6e74 225d 0a0a 2020  ata["count"]..  
+00040c20: 2020 6375 6d5f 7375 6d73 203d 206e 702e    cum_sums = np.
+00040c30: 6375 6d73 756d 2873 756d 732c 2030 290a  cumsum(sums, 0).
+00040c40: 2020 2020 6375 6d5f 636f 756e 7473 203d      cum_counts =
+00040c50: 206e 702e 6375 6d73 756d 2863 6f75 6e74   np.cumsum(count
+00040c60: 732c 2030 290a 0a20 2020 2073 3120 3d20  s, 0)..    s1 = 
+00040c70: 6375 6d5f 7375 6d73 5b3a 2d31 5d0a 2020  cum_sums[:-1].  
+00040c80: 2020 7332 203d 2073 756d 735b 313a 5d0a    s2 = sums[1:].
+00040c90: 2020 2020 6e31 203d 2063 756d 5f63 6f75      n1 = cum_cou
+00040ca0: 6e74 735b 3a2d 315d 0a20 2020 206e 3220  nts[:-1].    n2 
+00040cb0: 3d20 636f 756e 7473 5b31 3a5d 0a20 2020  = counts[1:].   
+00040cc0: 2077 6974 6820 6e70 2e65 7272 7374 6174   with np.errstat
+00040cd0: 6528 696e 7661 6c69 643d 2269 676e 6f72  e(invalid="ignor
+00040ce0: 6522 293a 0a20 2020 2020 2020 2064 203d  e"):.        d =
+00040cf0: 2028 7332 202f 206e 3229 202d 2028 7331   (s2 / n2) - (s1
+00040d00: 202f 206e 3129 0a20 2020 2020 2020 2043   / n1).        C
+00040d10: 203d 206e 702e 6e61 6e73 756d 280a 2020   = np.nansum(.  
+00040d20: 2020 2020 2020 2020 2020 286e 3120 2a20            (n1 * 
+00040d30: 6e32 2920 2f20 286e 3120 2b20 6e32 2920  n2) / (n1 + n2) 
+00040d40: 2a20 2864 202a 2064 2e74 7261 6e73 706f  * (d * d.transpo
+00040d50: 7365 2828 302c 2032 2c20 3129 2929 2c20  se((0, 2, 1))), 
+00040d60: 300a 2020 2020 2020 2020 2920 2b20 6e70  0.        ) + np
+00040d70: 2e6e 616e 7375 6d28 6461 7461 5b22 636f  .nansum(data["co
+00040d80: 7622 5d2c 2030 290a 0a20 2020 206f 7574  v"], 0)..    out
+00040d90: 203d 207b 2273 756d 223a 2063 756d 5f73   = {"sum": cum_s
+00040da0: 756d 735b 2d31 5d2c 2022 636f 756e 7422  ums[-1], "count"
+00040db0: 3a20 6375 6d5f 636f 756e 7473 5b2d 315d  : cum_counts[-1]
+00040dc0: 2c20 2263 6f76 223a 2043 7d0a 0a20 2020  , "cov": C}..   
+00040dd0: 2069 6620 636f 7272 3a0a 2020 2020 2020   if corr:.      
+00040de0: 2020 6e6f 6273 203d 206e 702e 7768 6572    nobs = np.wher
+00040df0: 6528 6375 6d5f 636f 756e 7473 5b2d 315d  e(cum_counts[-1]
+00040e00: 2c20 6375 6d5f 636f 756e 7473 5b2d 315d  , cum_counts[-1]
+00040e10: 2c20 6e70 2e6e 616e 290a 2020 2020 2020  , np.nan).      
+00040e20: 2020 6d75 203d 2063 756d 5f73 756d 735b    mu = cum_sums[
+00040e30: 2d31 5d20 2f20 6e6f 6273 0a20 2020 2020  -1] / nobs.     
+00040e40: 2020 2063 6f75 6e74 735f 6e61 203d 206e     counts_na = n
+00040e50: 702e 7768 6572 6528 636f 756e 7473 2c20  p.where(counts, 
+00040e60: 636f 756e 7473 2c20 6e70 2e6e 616e 290a  counts, np.nan).
+00040e70: 2020 2020 2020 2020 6d20 3d20 6e70 2e6e          m = np.n
+00040e80: 616e 7375 6d28 6461 7461 5b22 6d22 5d20  ansum(data["m"] 
+00040e90: 2b20 636f 756e 7473 202a 2028 7375 6d73  + counts * (sums
+00040ea0: 202f 2063 6f75 6e74 735f 6e61 202d 206d   / counts_na - m
+00040eb0: 7529 202a 2a20 322c 2061 7869 733d 3029  u) ** 2, axis=0)
+00040ec0: 0a20 2020 2020 2020 206f 7574 5b22 6d22  .        out["m"
+00040ed0: 5d20 3d20 6d0a 2020 2020 7265 7475 726e  ] = m.    return
+00040ee0: 206f 7574 0a0a 0a64 6566 205f 636f 765f   out...def _cov_
+00040ef0: 636f 7272 5f61 6767 2864 6174 612c 2063  corr_agg(data, c
+00040f00: 6f6c 732c 206d 696e 5f70 6572 696f 6473  ols, min_periods
+00040f10: 3d32 2c20 636f 7272 3d46 616c 7365 2c20  =2, corr=False, 
+00040f20: 7363 616c 6172 3d46 616c 7365 2c20 6c69  scalar=False, li
+00040f30: 6b65 5f64 663d 4e6f 6e65 293a 0a20 2020  ke_df=None):.   
+00040f40: 206f 7574 203d 205f 636f 765f 636f 7272   out = _cov_corr
+00040f50: 5f63 6f6d 6269 6e65 2864 6174 612c 2063  _combine(data, c
+00040f60: 6f72 7229 0a20 2020 2063 6f75 6e74 7320  orr).    counts 
+00040f70: 3d20 6f75 745b 2263 6f75 6e74 225d 0a20  = out["count"]. 
+00040f80: 2020 2043 203d 206f 7574 5b22 636f 7622     C = out["cov"
+00040f90: 5d0a 2020 2020 435b 636f 756e 7473 203c  ].    C[counts <
+00040fa0: 206d 696e 5f70 6572 696f 6473 5d20 3d20   min_periods] = 
+00040fb0: 6e70 2e6e 616e 0a20 2020 2069 6620 636f  np.nan.    if co
+00040fc0: 7272 3a0a 2020 2020 2020 2020 6d32 203d  rr:.        m2 =
+00040fd0: 206f 7574 5b22 6d22 5d0a 2020 2020 2020   out["m"].      
+00040fe0: 2020 6465 6e20 3d20 6e70 2e73 7172 7428    den = np.sqrt(
+00040ff0: 6d32 202a 206d 322e 5429 0a20 2020 2065  m2 * m2.T).    e
+00041000: 6c73 653a 0a20 2020 2020 2020 2064 656e  lse:.        den
+00041010: 203d 206e 702e 7768 6572 6528 636f 756e   = np.where(coun
+00041020: 7473 2c20 636f 756e 7473 2c20 6e70 2e6e  ts, counts, np.n
+00041030: 616e 2920 2d20 310a 2020 2020 7769 7468  an) - 1.    with
+00041040: 206e 702e 6572 7273 7461 7465 2869 6e76   np.errstate(inv
+00041050: 616c 6964 3d22 6967 6e6f 7265 222c 2064  alid="ignore", d
+00041060: 6976 6964 653d 2269 676e 6f72 6522 293a  ivide="ignore"):
+00041070: 0a20 2020 2020 2020 206d 6174 203d 2043  .        mat = C
+00041080: 202f 2064 656e 0a20 2020 2069 6620 7363   / den.    if sc
+00041090: 616c 6172 3a0a 2020 2020 2020 2020 7265  alar:.        re
+000410a0: 7475 726e 2066 6c6f 6174 286d 6174 5b30  turn float(mat[0
+000410b0: 2c20 315d 290a 2020 2020 7265 7475 726e  , 1]).    return
+000410c0: 2028 7064 2e44 6174 6146 7261 6d65 2069   (pd.DataFrame i
+000410d0: 6620 6c69 6b65 5f64 6620 6973 204e 6f6e  f like_df is Non
+000410e0: 6520 656c 7365 206d 6574 615f 6672 616d  e else meta_fram
+000410f0: 655f 636f 6e73 7472 7563 746f 7228 6c69  e_constructor(li
+00041100: 6b65 5f64 6629 2928 0a20 2020 2020 2020  ke_df))(.       
+00041110: 206d 6174 2c20 636f 6c75 6d6e 733d 636f   mat, columns=co
+00041120: 6c73 2c20 696e 6465 783d 636f 6c73 0a20  ls, index=cols. 
+00041130: 2020 2029 0a0a 0a64 6566 2070 645f 7370     )...def pd_sp
+00041140: 6c69 7428 6466 2c20 702c 2072 616e 646f  lit(df, p, rando
+00041150: 6d5f 7374 6174 653d 4e6f 6e65 2c20 7368  m_state=None, sh
+00041160: 7566 666c 653d 4661 6c73 6529 3a0a 2020  uffle=False):.  
+00041170: 2020 2222 2253 706c 6974 2044 6174 6146    """Split DataF
+00041180: 7261 6d65 2069 6e74 6f20 6d75 6c74 6970  rame into multip
+00041190: 6c65 2070 6965 6365 7320 7073 6575 646f  le pieces pseudo
+000411a0: 7261 6e64 6f6d 6c79 0a0a 2020 2020 3e3e  randomly..    >>
+000411b0: 3e20 6466 203d 2070 642e 4461 7461 4672  > df = pd.DataFr
+000411c0: 616d 6528 7b27 6127 3a20 5b31 2c20 322c  ame({'a': [1, 2,
+000411d0: 2033 2c20 342c 2035 2c20 365d 2c0a 2020   3, 4, 5, 6],.  
+000411e0: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+000411f0: 2020 2020 2020 2020 2027 6227 3a20 5b32           'b': [2
+00041200: 2c20 332c 2034 2c20 352c 2036 2c20 375d  , 3, 4, 5, 6, 7]
+00041210: 7d29 0a0a 2020 2020 3e3e 3e20 612c 2062  })..    >>> a, b
+00041220: 203d 2070 645f 7370 6c69 7428 0a20 2020   = pd_split(.   
+00041230: 202e 2e2e 2020 2020 2064 662c 205b 302e   ...     df, [0.
+00041240: 352c 2030 2e35 5d2c 2072 616e 646f 6d5f  5, 0.5], random_
+00041250: 7374 6174 653d 3132 332c 2073 6875 6666  state=123, shuff
+00041260: 6c65 3d54 7275 650a 2020 2020 2e2e 2e20  le=True.    ... 
+00041270: 2920 2023 2072 6f75 6768 6c79 2035 302f  )  # roughly 50/
+00041280: 3530 2073 706c 6974 0a20 2020 203e 3e3e  50 split.    >>>
+00041290: 2061 0a20 2020 2020 2020 6120 2062 0a20   a.       a  b. 
+000412a0: 2020 2033 2020 3420 2035 0a20 2020 2030     3  4  5.    0
+000412b0: 2020 3120 2032 0a20 2020 2035 2020 3620    1  2.    5  6 
+000412c0: 2037 0a20 2020 203e 3e3e 2062 0a20 2020   7.    >>> b.   
+000412d0: 2020 2020 6120 2062 0a20 2020 2031 2020      a  b.    1  
+000412e0: 3220 2033 0a20 2020 2034 2020 3520 2036  2  3.    4  5  6
+000412f0: 0a20 2020 2032 2020 3320 2034 0a20 2020  .    2  3  4.   
+00041300: 2022 2222 0a20 2020 2070 203d 206c 6973   """.    p = lis
+00041310: 7428 7029 0a20 2020 2069 6620 7368 7566  t(p).    if shuf
+00041320: 666c 653a 0a20 2020 2020 2020 2069 6620  fle:.        if 
+00041330: 6e6f 7420 6973 696e 7374 616e 6365 2872  not isinstance(r
+00041340: 616e 646f 6d5f 7374 6174 652c 206e 702e  andom_state, np.
+00041350: 7261 6e64 6f6d 2e52 616e 646f 6d53 7461  random.RandomSta
+00041360: 7465 293a 0a20 2020 2020 2020 2020 2020  te):.           
+00041370: 2072 616e 646f 6d5f 7374 6174 6520 3d20   random_state = 
+00041380: 6e70 2e72 616e 646f 6d2e 5261 6e64 6f6d  np.random.Random
+00041390: 5374 6174 6528 7261 6e64 6f6d 5f73 7461  State(random_sta
+000413a0: 7465 290a 2020 2020 2020 2020 6466 203d  te).        df =
+000413b0: 2064 662e 7361 6d70 6c65 2866 7261 633d   df.sample(frac=
+000413c0: 312e 302c 2072 616e 646f 6d5f 7374 6174  1.0, random_stat
+000413d0: 653d 7261 6e64 6f6d 5f73 7461 7465 290a  e=random_state).
+000413e0: 2020 2020 696e 6465 7820 3d20 7073 6575      index = pseu
+000413f0: 646f 7261 6e64 6f6d 286c 656e 2864 6629  dorandom(len(df)
+00041400: 2c20 702c 2072 616e 646f 6d5f 7374 6174  , p, random_stat
+00041410: 6529 0a20 2020 2072 6574 7572 6e20 5b64  e).    return [d
+00041420: 662e 696c 6f63 5b69 6e64 6578 203d 3d20  f.iloc[index == 
+00041430: 695d 2066 6f72 2069 2069 6e20 7261 6e67  i] for i in rang
+00041440: 6528 6c65 6e28 7029 295d 0a0a 0a64 6566  e(len(p))]...def
+00041450: 205f 7461 6b65 5f6c 6173 7428 612c 2073   _take_last(a, s
+00041460: 6b69 706e 613d 5472 7565 293a 0a20 2020  kipna=True):.   
+00041470: 2022 2222 0a20 2020 2074 616b 6520 6c61   """.    take la
+00041480: 7374 2072 6f77 2028 5365 7269 6573 2920  st row (Series) 
+00041490: 6f66 2044 6174 6146 7261 6d65 202f 206c  of DataFrame / l
+000414a0: 6173 7420 7661 6c75 6520 6f66 2053 6572  ast value of Ser
+000414b0: 6965 730a 2020 2020 636f 6e73 6964 6572  ies.    consider
+000414c0: 696e 6720 4e61 4e2e 0a0a 2020 2020 5061  ing NaN...    Pa
+000414d0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+000414e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6120 3a20  -------.    a : 
+000414f0: 7064 2e44 6174 6146 7261 6d65 206f 7220  pd.DataFrame or 
+00041500: 7064 2e53 6572 6965 730a 2020 2020 736b  pd.Series.    sk
+00041510: 6970 6e61 203a 2062 6f6f 6c2c 2064 6566  ipna : bool, def
+00041520: 6175 6c74 2054 7275 650a 2020 2020 2020  ault True.      
+00041530: 2020 5768 6574 6865 7220 746f 2065 7863    Whether to exc
+00041540: 6c75 6465 204e 614e 0a0a 2020 2020 2222  lude NaN..    ""
+00041550: 220a 0a20 2020 2064 6566 205f 6c61 7374  "..    def _last
+00041560: 5f76 616c 6964 2873 293a 0a20 2020 2020  _valid(s):.     
+00041570: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00041580: 6528 312c 206d 696e 2831 302c 206c 656e  e(1, min(10, len
+00041590: 2873 2920 2b20 3129 293a 0a20 2020 2020  (s) + 1)):.     
+000415a0: 2020 2020 2020 2076 616c 203d 2073 2e69         val = s.i
+000415b0: 6c6f 635b 2d69 5d0a 2020 2020 2020 2020  loc[-i].        
+000415c0: 2020 2020 6966 206e 6f74 2070 642e 6973      if not pd.is
+000415d0: 6e75 6c6c 2876 616c 293a 0a20 2020 2020  null(val):.     
+000415e0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000415f0: 6e20 7661 6c0a 2020 2020 2020 2020 656c  n val.        el
+00041600: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00041610: 6e6f 6e6e 756c 6c20 3d20 735b 732e 6e6f  nonnull = s[s.no
+00041620: 746e 6128 295d 0a20 2020 2020 2020 2020  tna()].         
+00041630: 2020 2069 6620 6e6f 7420 6e6f 6e6e 756c     if not nonnul
+00041640: 6c2e 656d 7074 793a 0a20 2020 2020 2020  l.empty:.       
+00041650: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00041660: 6e6f 6e6e 756c 6c2e 696c 6f63 5b2d 315d  nonnull.iloc[-1]
+00041670: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00041680: 4e6f 6e65 0a0a 2020 2020 6966 2073 6b69  None..    if ski
+00041690: 706e 6120 6973 2046 616c 7365 3a0a 2020  pna is False:.  
+000416a0: 2020 2020 2020 7265 7475 726e 2061 2e69        return a.i
+000416b0: 6c6f 635b 2d31 5d0a 2020 2020 656c 7365  loc[-1].    else
+000416c0: 3a0a 2020 2020 2020 2020 2320 7461 6b65  :.        # take
+000416d0: 206c 6173 7420 7661 6c69 6420 7661 6c75   last valid valu
+000416e0: 6520 6578 636c 7564 696e 6720 4e61 4e2c  e excluding NaN,
+000416f0: 204e 614e 206c 6f63 6174 696f 6e20 6d61   NaN location ma
+00041700: 7920 6265 2064 6966 6665 7265 6e74 0a20  y be different. 
+00041710: 2020 2020 2020 2023 2069 6e20 6561 6368         # in each
+00041720: 2063 6f6c 756d 6e0a 2020 2020 2020 2020   column.        
+00041730: 6966 2069 735f 6461 7461 6672 616d 655f  if is_dataframe_
+00041740: 6c69 6b65 2861 293a 0a20 2020 2020 2020  like(a):.       
+00041750: 2020 2020 2023 2063 7265 6174 6520 5365       # create Se
+00041760: 7269 6573 2066 726f 6d20 6170 7072 6f70  ries from approp
+00041770: 7269 6174 6520 6261 636b 656e 6420 6461  riate backend da
+00041780: 7461 6672 616d 6520 6c69 6272 6172 790a  taframe library.
+00041790: 2020 2020 2020 2020 2020 2020 7365 7269              seri
+000417a0: 6573 5f74 7970 203d 2074 7970 6528 612e  es_typ = type(a.
+000417b0: 696c 6f63 5b30 3a31 2c20 305d 290a 2020  iloc[0:1, 0]).  
+000417c0: 2020 2020 2020 2020 2020 6966 2061 2e65            if a.e
+000417d0: 6d70 7479 3a0a 2020 2020 2020 2020 2020  mpty:.          
+000417e0: 2020 2020 2020 7265 7475 726e 2073 6572        return ser
+000417f0: 6965 735f 7479 7028 5b5d 2c20 6474 7970  ies_typ([], dtyp
+00041800: 653d 2266 6c6f 6174 2229 0a20 2020 2020  e="float").     
+00041810: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00041820: 7269 6573 5f74 7970 280a 2020 2020 2020  ries_typ(.      
+00041830: 2020 2020 2020 2020 2020 5b5f 6c61 7374            [_last
+00041840: 5f76 616c 6964 2861 2e69 6c6f 635b 3a2c  _valid(a.iloc[:,
+00041850: 2069 5d29 2066 6f72 2069 2069 6e20 7261   i]) for i in ra
+00041860: 6e67 6528 6c65 6e28 612e 636f 6c75 6d6e  nge(len(a.column
+00041870: 7329 295d 2c0a 2020 2020 2020 2020 2020  s))],.          
+00041880: 2020 2020 2020 696e 6465 783d 612e 636f        index=a.co
+00041890: 6c75 6d6e 732c 0a20 2020 2020 2020 2020  lumns,.         
+000418a0: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
+000418b0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+000418c0: 6574 7572 6e20 5f6c 6173 745f 7661 6c69  eturn _last_vali
+000418d0: 6428 6129 0a0a 0a64 6566 2063 6865 636b  d(a)...def check
+000418e0: 5f64 6976 6973 696f 6e73 2864 6976 6973  _divisions(divis
+000418f0: 696f 6e73 293a 0a20 2020 2069 6620 6e6f  ions):.    if no
+00041900: 7420 6973 696e 7374 616e 6365 2864 6976  t isinstance(div
+00041910: 6973 696f 6e73 2c20 286c 6973 742c 2074  isions, (list, t
+00041920: 7570 6c65 2929 3a0a 2020 2020 2020 2020  uple)):.        
+00041930: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00041940: 2822 4e65 7720 6469 7669 7369 6f6e 206d  ("New division m
+00041950: 7573 7420 6265 206c 6973 7420 6f72 2074  ust be list or t
+00041960: 7570 6c65 2229 0a20 2020 2064 6976 6973  uple").    divis
+00041970: 696f 6e73 203d 206c 6973 7428 6469 7669  ions = list(divi
+00041980: 7369 6f6e 7329 0a20 2020 2069 6620 6c65  sions).    if le
+00041990: 6e28 6469 7669 7369 6f6e 7329 203d 3d20  n(divisions) == 
+000419a0: 303a 0a20 2020 2020 2020 2072 6169 7365  0:.        raise
+000419b0: 2056 616c 7565 4572 726f 7228 224e 6577   ValueError("New
+000419c0: 2064 6976 6973 696f 6e20 6d75 7374 206e   division must n
+000419d0: 6f74 2062 6520 656d 7074 7922 290a 2020  ot be empty").  
+000419e0: 2020 6966 2064 6976 6973 696f 6e73 2021    if divisions !
+000419f0: 3d20 736f 7274 6564 2864 6976 6973 696f  = sorted(divisio
+00041a00: 6e73 293a 0a20 2020 2020 2020 2072 6169  ns):.        rai
+00041a10: 7365 2056 616c 7565 4572 726f 7228 224e  se ValueError("N
+00041a20: 6577 2064 6976 6973 696f 6e20 6d75 7374  ew division must
+00041a30: 2062 6520 736f 7274 6564 2229 0a20 2020   be sorted").   
+00041a40: 2069 6620 6c65 6e28 6469 7669 7369 6f6e   if len(division
+00041a50: 735b 3a2d 315d 2920 213d 206c 656e 286c  s[:-1]) != len(l
+00041a60: 6973 7428 756e 6971 7565 2864 6976 6973  ist(unique(divis
+00041a70: 696f 6e73 5b3a 2d31 5d29 2929 3a0a 2020  ions[:-1]))):.  
+00041a80: 2020 2020 2020 6d73 6720 3d20 224e 6577        msg = "New
+00041a90: 2064 6976 6973 696f 6e20 6d75 7374 2062   division must b
+00041aa0: 6520 756e 6971 7565 2c20 6578 6365 7074  e unique, except
+00041ab0: 2066 6f72 2074 6865 206c 6173 7420 656c   for the last el
+00041ac0: 656d 656e 7422 0a20 2020 2020 2020 2072  ement".        r
+00041ad0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00041ae0: 6d73 6729 0a0a 0a64 6566 2072 6570 6172  msg)...def repar
+00041af0: 7469 7469 6f6e 5f64 6976 6973 696f 6e73  tition_divisions
+00041b00: 2861 2c20 622c 206e 616d 652c 206f 7574  (a, b, name, out
+00041b10: 312c 206f 7574 322c 2066 6f72 6365 3d46  1, out2, force=F
+00041b20: 616c 7365 293a 0a20 2020 2022 2222 6461  alse):.    """da
+00041b30: 736b 2067 7261 7068 2074 6f20 7265 7061  sk graph to repa
+00041b40: 7274 6974 696f 6e20 6461 7461 6672 616d  rtition datafram
+00041b50: 6520 6279 206e 6577 2064 6976 6973 696f  e by new divisio
+00041b60: 6e73 0a0a 2020 2020 5061 7261 6d65 7465  ns..    Paramete
+00041b70: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+00041b80: 2d0a 2020 2020 6120 3a20 7475 706c 650a  -.    a : tuple.
+00041b90: 2020 2020 2020 2020 6f6c 6420 6469 7669          old divi
+00041ba0: 7369 6f6e 730a 2020 2020 6220 3a20 7475  sions.    b : tu
+00041bb0: 706c 652c 206c 6973 746d 7970 790a 2020  ple, listmypy.  
+00041bc0: 2020 6f75 7432 203a 2073 7472 0a20 2020    out2 : str.   
+00041bd0: 2020 2020 206e 616d 6520 6f66 206e 6577       name of new
+00041be0: 2064 6174 6166 7261 6d65 0a20 2020 2066   dataframe.    f
+00041bf0: 6f72 6365 203a 2062 6f6f 6c2c 2064 6566  orce : bool, def
+00041c00: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
+00041c10: 2020 2041 6c6c 6f77 7320 7468 6520 6578     Allows the ex
+00041c20: 7061 6e73 696f 6e20 6f66 2074 6865 2065  pansion of the e
+00041c30: 7869 7374 696e 6720 6469 7669 7369 6f6e  xisting division
+00041c40: 732e 0a20 2020 2020 2020 2049 6620 4661  s..        If Fa
+00041c50: 6c73 6520 7468 656e 2074 6865 206e 6577  lse then the new
+00041c60: 2064 6976 6973 696f 6e73 206c 6f77 6572   divisions lower
+00041c70: 2061 6e64 2075 7070 6572 2062 6f75 6e64   and upper bound
+00041c80: 7320 6d75 7374 2062 650a 2020 2020 2020  s must be.      
+00041c90: 2020 7468 6520 7361 6d65 2061 7320 7468    the same as th
+00041ca0: 6520 6f6c 6420 6469 7669 7369 6f6e 732e  e old divisions.
+00041cb0: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
+00041cc0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00041cd0: 3e3e 3e20 6672 6f6d 2070 7072 696e 7420  >>> from pprint 
+00041ce0: 696d 706f 7274 2070 7072 696e 740a 2020  import pprint.  
+00041cf0: 2020 3e3e 3e20 7070 7269 6e74 2872 6570    >>> pprint(rep
+00041d00: 6172 7469 7469 6f6e 5f64 6976 6973 696f  artition_divisio
+00041d10: 6e73 285b 312c 2033 2c20 375d 2c20 5b31  ns([1, 3, 7], [1
+00041d20: 2c20 342c 2036 2c20 375d 2c20 2761 272c  , 4, 6, 7], 'a',
+00041d30: 2027 6227 2c20 2763 2729 2920 2023 2064   'b', 'c'))  # d
+00041d40: 6f63 7465 7374 3a20 2b45 4c4c 4950 5349  octest: +ELLIPSI
+00041d50: 530a 2020 2020 7b28 2762 272c 2030 293a  S.    {('b', 0):
+00041d60: 2028 3c66 756e 6374 696f 6e20 626f 756e   (<function boun
+00041d70: 6461 7279 5f73 6c69 6365 2061 7420 2e2e  dary_slice at ..
+00041d80: 2e3e 2c20 2827 6127 2c20 3029 2c20 312c  .>, ('a', 0), 1,
+00041d90: 2033 2c20 4661 6c73 6529 2c0a 2020 2020   3, False),.    
+00041da0: 2028 2762 272c 2031 293a 2028 3c66 756e   ('b', 1): (<fun
+00041db0: 6374 696f 6e20 626f 756e 6461 7279 5f73  ction boundary_s
+00041dc0: 6c69 6365 2061 7420 2e2e 2e3e 2c20 2827  lice at ...>, ('
+00041dd0: 6127 2c20 3129 2c20 332c 2034 2c20 4661  a', 1), 3, 4, Fa
+00041de0: 6c73 6529 2c0a 2020 2020 2028 2762 272c  lse),.     ('b',
+00041df0: 2032 293a 2028 3c66 756e 6374 696f 6e20   2): (<function 
+00041e00: 626f 756e 6461 7279 5f73 6c69 6365 2061  boundary_slice a
+00041e10: 7420 2e2e 2e3e 2c20 2827 6127 2c20 3129  t ...>, ('a', 1)
+00041e20: 2c20 342c 2036 2c20 4661 6c73 6529 2c0a  , 4, 6, False),.
+00041e30: 2020 2020 2028 2762 272c 2033 293a 2028       ('b', 3): (
+00041e40: 3c66 756e 6374 696f 6e20 626f 756e 6461  <function bounda
+00041e50: 7279 5f73 6c69 6365 2061 7420 2e2e 2e3e  ry_slice at ...>
+00041e60: 2c20 2827 6127 2c20 3129 2c20 362c 2037  , ('a', 1), 6, 7
+00041e70: 2c20 5472 7565 292c 0a20 2020 2020 2827  , True),.     ('
+00041e80: 6327 2c20 3029 3a20 283c 6675 6e63 7469  c', 0): (<functi
+00041e90: 6f6e 2063 6f6e 6361 7420 6174 202e 2e2e  on concat at ...
+00041ea0: 3e2c 205b 2827 6227 2c20 3029 2c20 2827  >, [('b', 0), ('
+00041eb0: 6227 2c20 3129 5d29 2c0a 2020 2020 2028  b', 1)]),.     (
+00041ec0: 2763 272c 2031 293a 2028 2762 272c 2032  'c', 1): ('b', 2
+00041ed0: 292c 0a20 2020 2020 2827 6327 2c20 3229  ),.     ('c', 2)
+00041ee0: 3a20 2827 6227 2c20 3329 7d0a 2020 2020  : ('b', 3)}.    
+00041ef0: 2222 220a 2020 2020 6368 6563 6b5f 6469  """.    check_di
+00041f00: 7669 7369 6f6e 7328 6229 0a0a 2020 2020  visions(b)..    
+00041f10: 6966 206c 656e 2862 2920 3c20 323a 0a20  if len(b) < 2:. 
+00041f20: 2020 2020 2020 2023 206d 696e 696d 756d         # minimum
+00041f30: 2064 6976 6973 696f 6e20 6973 2032 2065   division is 2 e
+00041f40: 6c65 6d65 6e74 732c 206c 696b 6520 5b30  lements, like [0
+00041f50: 2c20 305d 0a20 2020 2020 2020 2072 6169  , 0].        rai
+00041f60: 7365 2056 616c 7565 4572 726f 7228 224e  se ValueError("N
+00041f70: 6577 2064 6976 6973 696f 6e20 6d75 7374  ew division must
+00041f80: 2062 6520 6c6f 6e67 6572 2074 6861 6e20   be longer than 
+00041f90: 3220 656c 656d 656e 7473 2229 0a0a 2020  2 elements")..  
+00041fa0: 2020 6966 2066 6f72 6365 3a0a 2020 2020    if force:.    
+00041fb0: 2020 2020 6966 2061 5b30 5d20 3c20 625b      if a[0] < b[
+00041fc0: 305d 3a0a 2020 2020 2020 2020 2020 2020  0]:.            
+00041fd0: 6d73 6720 3d20 280a 2020 2020 2020 2020  msg = (.        
+00041fe0: 2020 2020 2020 2020 226c 6566 7420 7369          "left si
+00041ff0: 6465 206f 6620 7468 6520 6e65 7720 6469  de of the new di
+00042000: 7669 7369 6f6e 206d 7573 7420 6265 2065  vision must be e
+00042010: 7175 616c 206f 7220 736d 616c 6c65 7220  qual or smaller 
+00042020: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00042030: 2020 2274 6861 6e20 6f6c 6420 6469 7669    "than old divi
+00042040: 7369 6f6e 220a 2020 2020 2020 2020 2020  sion".          
+00042050: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00042060: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00042070: 286d 7367 290a 2020 2020 2020 2020 6966  (msg).        if
+00042080: 2061 5b2d 315d 203e 2062 5b2d 315d 3a0a   a[-1] > b[-1]:.
+00042090: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
+000420a0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+000420b0: 2020 2020 2272 6967 6874 2073 6964 6520      "right side 
+000420c0: 6f66 2074 6865 206e 6577 2064 6976 6973  of the new divis
+000420d0: 696f 6e20 6d75 7374 2062 6520 6571 7561  ion must be equa
+000420e0: 6c20 6f72 206c 6172 6765 7220 220a 2020  l or larger ".  
+000420f0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+00042100: 6861 6e20 6f6c 6420 6469 7669 7369 6f6e  han old division
+00042110: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+00042120: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00042130: 6520 5661 6c75 6545 7272 6f72 286d 7367  e ValueError(msg
+00042140: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+00042150: 2020 2020 6966 2061 5b30 5d20 213d 2062      if a[0] != b
+00042160: 5b30 5d3a 0a20 2020 2020 2020 2020 2020  [0]:.           
+00042170: 206d 7367 203d 2022 6c65 6674 2073 6964   msg = "left sid
+00042180: 6520 6f66 206f 6c64 2061 6e64 206e 6577  e of old and new
+00042190: 2064 6976 6973 696f 6e73 2061 7265 2064   divisions are d
+000421a0: 6966 6665 7265 6e74 220a 2020 2020 2020  ifferent".      
+000421b0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+000421c0: 6545 7272 6f72 286d 7367 290a 2020 2020  eError(msg).    
+000421d0: 2020 2020 6966 2061 5b2d 315d 2021 3d20      if a[-1] != 
+000421e0: 625b 2d31 5d3a 0a20 2020 2020 2020 2020  b[-1]:.         
+000421f0: 2020 206d 7367 203d 2022 7269 6768 7420     msg = "right 
+00042200: 7369 6465 206f 6620 6f6c 6420 616e 6420  side of old and 
+00042210: 6e65 7720 6469 7669 7369 6f6e 7320 6172  new divisions ar
+00042220: 6520 6469 6666 6572 656e 7422 0a20 2020  e different".   
+00042230: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00042240: 616c 7565 4572 726f 7228 6d73 6729 0a0a  alueError(msg)..
+00042250: 2020 2020 6465 6620 5f69 735f 7369 6e67      def _is_sing
+00042260: 6c65 5f6c 6173 745f 6469 7628 7829 3a0a  le_last_div(x):.
+00042270: 2020 2020 2020 2020 2222 2257 6865 7468          """Wheth
+00042280: 6572 206c 6173 7420 6469 7669 7369 6f6e  er last division
+00042290: 206f 6e6c 7920 636f 6e74 6169 6e73 2073   only contains s
+000422a0: 696e 676c 6520 6c61 6265 6c22 2222 0a20  ingle label""". 
+000422b0: 2020 2020 2020 2072 6574 7572 6e20 6c65         return le
+000422c0: 6e28 7829 203e 3d20 3220 616e 6420 785b  n(x) >= 2 and x[
+000422d0: 2d31 5d20 3d3d 2078 5b2d 325d 0a0a 2020  -1] == x[-2]..  
+000422e0: 2020 6320 3d20 5b61 5b30 5d5d 0a20 2020    c = [a[0]].   
+000422f0: 2064 203d 2064 6963 7428 290a 2020 2020   d = dict().    
+00042300: 6c6f 7720 3d20 615b 305d 0a0a 2020 2020  low = a[0]..    
+00042310: 692c 206a 203d 2031 2c20 3120 2023 2069  i, j = 1, 1  # i
+00042320: 6e64 6963 6573 2066 6f72 206f 6c64 2f6e  ndices for old/n
+00042330: 6577 2064 6976 6973 696f 6e73 0a20 2020  ew divisions.   
+00042340: 206b 203d 2030 2020 2320 696e 6465 7820   k = 0  # index 
+00042350: 666f 7220 7465 6d70 2064 6976 6973 696f  for temp divisio
+00042360: 6e73 0a0a 2020 2020 6c61 7374 5f65 6c65  ns..    last_ele
+00042370: 6d20 3d20 5f69 735f 7369 6e67 6c65 5f6c  m = _is_single_l
+00042380: 6173 745f 6469 7628 6129 0a0a 2020 2020  ast_div(a)..    
+00042390: 2320 7072 6f63 6573 7320 7468 726f 7567  # process throug
+000423a0: 6820 6f6c 6420 6469 7669 7369 6f6e 0a20  h old division. 
+000423b0: 2020 2023 206c 6566 7420 7061 7274 206f     # left part o
+000423c0: 6620 6e65 7720 6469 7669 7369 6f6e 2063  f new division c
+000423d0: 616e 2062 6520 7072 6f63 6573 7365 6420  an be processed 
+000423e0: 696e 2074 6869 7320 6c6f 6f70 0a20 2020  in this loop.   
+000423f0: 2077 6869 6c65 2069 203c 206c 656e 2861   while i < len(a
+00042400: 2920 616e 6420 6a20 3c20 6c65 6e28 6229  ) and j < len(b)
+00042410: 3a0a 2020 2020 2020 2020 6966 2061 5b69  :.        if a[i
+00042420: 5d20 3c20 625b 6a5d 3a0a 2020 2020 2020  ] < b[j]:.      
+00042430: 2020 2020 2020 2320 7475 706c 6520 6973        # tuple is
+00042440: 2073 6f6d 6574 6869 6e67 206c 696b 653a   something like:
+00042450: 0a20 2020 2020 2020 2020 2020 2023 2028  .            # (
+00042460: 6d65 7468 6f64 732e 626f 756e 6461 7279  methods.boundary
+00042470: 5f73 6c69 6365 2c20 2827 6672 6f6d 5f70  _slice, ('from_p
+00042480: 616e 6461 732d 2327 2c20 3029 2c20 332c  andas-#', 0), 3,
+00042490: 2034 2c20 4661 6c73 6529 290a 2020 2020   4, False)).    
+000424a0: 2020 2020 2020 2020 645b 286f 7574 312c          d[(out1,
+000424b0: 206b 295d 203d 2028 6d65 7468 6f64 732e   k)] = (methods.
+000424c0: 626f 756e 6461 7279 5f73 6c69 6365 2c20  boundary_slice, 
+000424d0: 286e 616d 652c 2069 202d 2031 292c 206c  (name, i - 1), l
+000424e0: 6f77 2c20 615b 695d 2c20 4661 6c73 6529  ow, a[i], False)
+000424f0: 0a20 2020 2020 2020 2020 2020 206c 6f77  .            low
+00042500: 203d 2061 5b69 5d0a 2020 2020 2020 2020   = a[i].        
+00042510: 2020 2020 6920 2b3d 2031 0a20 2020 2020      i += 1.     
+00042520: 2020 2065 6c69 6620 615b 695d 203e 2062     elif a[i] > b
+00042530: 5b6a 5d3a 0a20 2020 2020 2020 2020 2020  [j]:.           
+00042540: 2064 5b28 6f75 7431 2c20 6b29 5d20 3d20   d[(out1, k)] = 
+00042550: 286d 6574 686f 6473 2e62 6f75 6e64 6172  (methods.boundar
+00042560: 795f 736c 6963 652c 2028 6e61 6d65 2c20  y_slice, (name, 
+00042570: 6920 2d20 3129 2c20 6c6f 772c 2062 5b6a  i - 1), low, b[j
+00042580: 5d2c 2046 616c 7365 290a 2020 2020 2020  ], False).      
+00042590: 2020 2020 2020 6c6f 7720 3d20 625b 6a5d        low = b[j]
+000425a0: 0a20 2020 2020 2020 2020 2020 206a 202b  .            j +
+000425b0: 3d20 310a 2020 2020 2020 2020 656c 7365  = 1.        else
+000425c0: 3a0a 2020 2020 2020 2020 2020 2020 645b  :.            d[
+000425d0: 286f 7574 312c 206b 295d 203d 2028 6d65  (out1, k)] = (me
+000425e0: 7468 6f64 732e 626f 756e 6461 7279 5f73  thods.boundary_s
+000425f0: 6c69 6365 2c20 286e 616d 652c 2069 202d  lice, (name, i -
+00042600: 2031 292c 206c 6f77 2c20 625b 6a5d 2c20   1), low, b[j], 
+00042610: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
+00042620: 2020 206c 6f77 203d 2062 5b6a 5d0a 2020     low = b[j].  
+00042630: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+00042640: 2861 2920 3d3d 2069 202b 2031 206f 7220  (a) == i + 1 or 
+00042650: 615b 695d 203c 2061 5b69 202b 2031 5d3a  a[i] < a[i + 1]:
+00042660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042670: 206a 202b 3d20 310a 2020 2020 2020 2020   j += 1.        
+00042680: 2020 2020 6920 2b3d 2031 0a20 2020 2020      i += 1.     
+00042690: 2020 2063 2e61 7070 656e 6428 6c6f 7729     c.append(low)
+000426a0: 0a20 2020 2020 2020 206b 202b 3d20 310a  .        k += 1.
+000426b0: 0a20 2020 2023 2072 6967 6874 2070 6172  .    # right par
+000426c0: 7420 6f66 206e 6577 2064 6976 6973 696f  t of new divisio
+000426d0: 6e20 6361 6e20 7265 6d61 696e 0a20 2020  n can remain.   
+000426e0: 2069 6620 615b 2d31 5d20 3c20 625b 2d31   if a[-1] < b[-1
+000426f0: 5d20 6f72 2062 5b2d 315d 203d 3d20 625b  ] or b[-1] == b[
+00042700: 2d32 5d3a 0a20 2020 2020 2020 2066 6f72  -2]:.        for
+00042710: 205f 6a20 696e 2072 616e 6765 286a 2c20   _j in range(j, 
+00042720: 6c65 6e28 6229 293a 0a20 2020 2020 2020  len(b)):.       
+00042730: 2020 2020 2023 2061 6c77 6179 7320 7573       # always us
+00042740: 6520 7269 6768 742d 6d6f 7374 206f 6620  e right-most of 
+00042750: 6f6c 6420 6469 7669 7369 6f6e 0a20 2020  old division.   
+00042760: 2020 2020 2020 2020 2023 2062 6563 6175           # becau
+00042770: 7365 2069 7420 6d61 7920 636f 6e74 6169  se it may contai
+00042780: 6e20 6c61 7374 2065 6c65 6d65 6e74 0a20  n last element. 
+00042790: 2020 2020 2020 2020 2020 206d 203d 206c             m = l
+000427a0: 656e 2861 2920 2d20 320a 2020 2020 2020  en(a) - 2.      
+000427b0: 2020 2020 2020 645b 286f 7574 312c 206b        d[(out1, k
+000427c0: 295d 203d 2028 6d65 7468 6f64 732e 626f  )] = (methods.bo
+000427d0: 756e 6461 7279 5f73 6c69 6365 2c20 286e  undary_slice, (n
+000427e0: 616d 652c 206d 292c 206c 6f77 2c20 625b  ame, m), low, b[
+000427f0: 5f6a 5d2c 2046 616c 7365 290a 2020 2020  _j], False).    
+00042800: 2020 2020 2020 2020 6c6f 7720 3d20 625b          low = b[
+00042810: 5f6a 5d0a 2020 2020 2020 2020 2020 2020  _j].            
+00042820: 632e 6170 7065 6e64 286c 6f77 290a 2020  c.append(low).  
+00042830: 2020 2020 2020 2020 2020 6b20 2b3d 2031            k += 1
+00042840: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00042850: 2020 2023 2065 7665 6e20 6966 206e 6577     # even if new
+00042860: 2064 6976 6973 696f 6e20 6973 2070 726f   division is pro
+00042870: 6365 7373 6564 2074 6872 6f75 6768 2c0a  cessed through,.
+00042880: 2020 2020 2020 2020 2320 7269 6768 742d          # right-
+00042890: 6d6f 7374 2065 6c65 6d65 6e74 206f 6620  most element of 
+000428a0: 6f6c 6420 6469 7669 7369 6f6e 2063 616e  old division can
+000428b0: 2072 656d 6169 6e0a 2020 2020 2020 2020   remain.        
+000428c0: 6966 206c 6173 745f 656c 656d 2061 6e64  if last_elem and
+000428d0: 2069 203c 206c 656e 2861 293a 0a20 2020   i < len(a):.   
+000428e0: 2020 2020 2020 2020 2064 5b28 6f75 7431           d[(out1
+000428f0: 2c20 6b29 5d20 3d20 286d 6574 686f 6473  , k)] = (methods
+00042900: 2e62 6f75 6e64 6172 795f 736c 6963 652c  .boundary_slice,
+00042910: 2028 6e61 6d65 2c20 6920 2d20 3129 2c20   (name, i - 1), 
+00042920: 615b 695d 2c20 615b 695d 2c20 4661 6c73  a[i], a[i], Fals
+00042930: 6529 0a20 2020 2020 2020 2020 2020 206b  e).            k
+00042940: 202b 3d20 310a 2020 2020 2020 2020 632e   += 1.        c.
+00042950: 6170 7065 6e64 2861 5b2d 315d 290a 0a20  append(a[-1]).. 
+00042960: 2020 2023 2072 6570 6c61 6365 206c 6173     # replace las
+00042970: 7420 656c 656d 656e 7420 6f66 2074 7570  t element of tup
+00042980: 6c65 2077 6974 6820 5472 7565 0a20 2020  le with True.   
+00042990: 2064 5b28 6f75 7431 2c20 6b20 2d20 3129   d[(out1, k - 1)
+000429a0: 5d20 3d20 645b 286f 7574 312c 206b 202d  ] = d[(out1, k -
+000429b0: 2031 295d 5b3a 2d31 5d20 2b20 2854 7275   1)][:-1] + (Tru
+000429c0: 652c 290a 0a20 2020 2069 2c20 6a20 3d20  e,)..    i, j = 
+000429d0: 302c 2031 0a0a 2020 2020 6c61 7374 5f65  0, 1..    last_e
+000429e0: 6c65 6d20 3d20 5f69 735f 7369 6e67 6c65  lem = _is_single
+000429f0: 5f6c 6173 745f 6469 7628 6329 0a0a 2020  _last_div(c)..  
+00042a00: 2020 7768 696c 6520 6a20 3c20 6c65 6e28    while j < len(
+00042a10: 6229 3a0a 2020 2020 2020 2020 746d 7020  b):.        tmp 
+00042a20: 3d20 5b5d 0a20 2020 2020 2020 2077 6869  = [].        whi
+00042a30: 6c65 2063 5b69 5d20 3c20 625b 6a5d 3a0a  le c[i] < b[j]:.
+00042a40: 2020 2020 2020 2020 2020 2020 746d 702e              tmp.
+00042a50: 6170 7065 6e64 2828 6f75 7431 2c20 6929  append((out1, i)
+00042a60: 290a 2020 2020 2020 2020 2020 2020 6920  ).            i 
+00042a70: 2b3d 2031 0a20 2020 2020 2020 2077 6869  += 1.        whi
+00042a80: 6c65 2028 0a20 2020 2020 2020 2020 2020  le (.           
+00042a90: 206c 6173 745f 656c 656d 0a20 2020 2020   last_elem.     
+00042aa0: 2020 2020 2020 2061 6e64 2063 5b69 5d20         and c[i] 
+00042ab0: 3d3d 2062 5b2d 315d 0a20 2020 2020 2020  == b[-1].       
+00042ac0: 2020 2020 2061 6e64 2028 625b 2d31 5d20       and (b[-1] 
+00042ad0: 213d 2062 5b2d 325d 206f 7220 6a20 3d3d  != b[-2] or j ==
+00042ae0: 206c 656e 2862 2920 2d20 3129 0a20 2020   len(b) - 1).   
+00042af0: 2020 2020 2020 2020 2061 6e64 2069 203c           and i <
+00042b00: 206b 0a20 2020 2020 2020 2029 3a0a 2020   k.        ):.  
+00042b10: 2020 2020 2020 2020 2020 2320 6170 7065            # appe
+00042b20: 6e64 2069 6620 6c61 7374 2073 706c 6974  nd if last split
+00042b30: 2069 7320 6e6f 7420 696e 636c 7564 6564   is not included
+00042b40: 0a20 2020 2020 2020 2020 2020 2074 6d70  .            tmp
+00042b50: 2e61 7070 656e 6428 286f 7574 312c 2069  .append((out1, i
+00042b60: 2929 0a20 2020 2020 2020 2020 2020 2069  )).            i
+00042b70: 202b 3d20 310a 2020 2020 2020 2020 6966   += 1.        if
+00042b80: 206c 656e 2874 6d70 2920 3d3d 2030 3a0a   len(tmp) == 0:.
+00042b90: 2020 2020 2020 2020 2020 2020 2320 6475              # du
+00042ba0: 6d6d 7920 736c 6963 6520 746f 2072 6574  mmy slice to ret
+00042bb0: 7572 6e20 656d 7074 7920 4461 7461 4672  urn empty DataFr
+00042bc0: 616d 6520 6f72 2053 6572 6965 732c 0a20  ame or Series,. 
+00042bd0: 2020 2020 2020 2020 2020 2023 2077 6869             # whi
+00042be0: 6368 2072 6574 6169 6e20 6f72 6967 696e  ch retain origin
+00042bf0: 616c 2064 6174 6120 6174 7472 6962 7574  al data attribut
+00042c00: 6573 2028 636f 6c75 6d6e 7320 2f20 6e61  es (columns / na
+00042c10: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
+00042c20: 645b 286f 7574 322c 206a 202d 2031 295d  d[(out2, j - 1)]
+00042c30: 203d 2028 6d65 7468 6f64 732e 626f 756e   = (methods.boun
+00042c40: 6461 7279 5f73 6c69 6365 2c20 286e 616d  dary_slice, (nam
+00042c50: 652c 2030 292c 2061 5b30 5d2c 2061 5b30  e, 0), a[0], a[0
+00042c60: 5d2c 2046 616c 7365 290a 2020 2020 2020  ], False).      
+00042c70: 2020 656c 6966 206c 656e 2874 6d70 2920    elif len(tmp) 
+00042c80: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+00042c90: 2020 645b 286f 7574 322c 206a 202d 2031    d[(out2, j - 1
+00042ca0: 295d 203d 2074 6d70 5b30 5d0a 2020 2020  )] = tmp[0].    
+00042cb0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00042cc0: 2020 2020 2020 6966 206e 6f74 2074 6d70        if not tmp
+00042cd0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00042ce0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00042cf0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00042d00: 2020 2020 2020 2020 2263 6865 636b 2066          "check f
+00042d10: 6f72 2064 7570 6c69 6361 7465 2070 6172  or duplicate par
+00042d20: 7469 7469 6f6e 735c 6e6f 6c64 3a5c 6e25  titions\nold:\n%
+00042d30: 735c 6e5c 6e22 0a20 2020 2020 2020 2020  s\n\n".         
+00042d40: 2020 2020 2020 2020 2020 2022 6e65 773a             "new:
+00042d50: 5c6e 2573 5c6e 5c6e 636f 6d62 696e 6564  \n%s\n\ncombined
+00042d60: 3a5c 6e25 7322 2025 2028 7066 6f72 6d61  :\n%s" % (pforma
+00042d70: 7428 6129 2c20 7066 6f72 6d61 7428 6229  t(a), pformat(b)
+00042d80: 2c20 7066 6f72 6d61 7428 6329 290a 2020  , pformat(c)).  
+00042d90: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00042da0: 2020 2020 2020 2020 2020 2020 645b 286f              d[(o
+00042db0: 7574 322c 206a 202d 2031 295d 203d 2028  ut2, j - 1)] = (
+00042dc0: 6d65 7468 6f64 732e 636f 6e63 6174 2c20  methods.concat, 
+00042dd0: 746d 7029 0a20 2020 2020 2020 206a 202b  tmp).        j +
+00042de0: 3d20 310a 2020 2020 7265 7475 726e 2064  = 1.    return d
+00042df0: 0a0a 0a64 6566 2072 6570 6172 7469 7469  ...def repartiti
+00042e00: 6f6e 5f66 7265 7128 6466 2c20 6672 6571  on_freq(df, freq
+00042e10: 3d4e 6f6e 6529 3a0a 2020 2020 2222 2252  =None):.    """R
+00042e20: 6570 6172 7469 7469 6f6e 2061 2074 696d  epartition a tim
+00042e30: 6573 6572 6965 7320 6461 7461 6672 616d  eseries datafram
+00042e40: 6520 6279 2061 206e 6577 2066 7265 7175  e by a new frequ
+00042e50: 656e 6379 2222 220a 2020 2020 6966 206e  ency""".    if n
+00042e60: 6f74 2069 7369 6e73 7461 6e63 6528 6466  ot isinstance(df
+00042e70: 2e64 6976 6973 696f 6e73 5b30 5d2c 2070  .divisions[0], p
+00042e80: 642e 5469 6d65 7374 616d 7029 3a0a 2020  d.Timestamp):.  
+00042e90: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00042ea0: 4572 726f 7228 2243 616e 206f 6e6c 7920  Error("Can only 
+00042eb0: 7265 7061 7274 6974 696f 6e20 6f6e 2066  repartition on f
+00042ec0: 7265 7175 656e 6379 2066 6f72 2074 696d  requency for tim
+00042ed0: 6573 6572 6965 7322 290a 0a20 2020 2066  eseries")..    f
+00042ee0: 7265 7120 3d20 5f6d 6170 5f66 7265 715f  req = _map_freq_
+00042ef0: 746f 5f70 6572 696f 645f 7374 6172 7428  to_period_start(
+00042f00: 6672 6571 290a 0a20 2020 2074 7279 3a0a  freq)..    try:.
+00042f10: 2020 2020 2020 2020 7374 6172 7420 3d20          start = 
+00042f20: 6466 2e64 6976 6973 696f 6e73 5b30 5d2e  df.divisions[0].
+00042f30: 6365 696c 2866 7265 7129 0a20 2020 2065  ceil(freq).    e
+00042f40: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
+00042f50: 3a0a 2020 2020 2020 2020 7374 6172 7420  :.        start 
+00042f60: 3d20 6466 2e64 6976 6973 696f 6e73 5b30  = df.divisions[0
+00042f70: 5d0a 2020 2020 6469 7669 7369 6f6e 7320  ].    divisions 
+00042f80: 3d20 6d65 7468 6f64 732e 746f 6c69 7374  = methods.tolist
+00042f90: 280a 2020 2020 2020 2020 7064 2e64 6174  (.        pd.dat
+00042fa0: 655f 7261 6e67 6528 7374 6172 743d 7374  e_range(start=st
+00042fb0: 6172 742c 2065 6e64 3d64 662e 6469 7669  art, end=df.divi
+00042fc0: 7369 6f6e 735b 2d31 5d2c 2066 7265 713d  sions[-1], freq=
+00042fd0: 6672 6571 290a 2020 2020 290a 2020 2020  freq).    ).    
+00042fe0: 6966 206e 6f74 206c 656e 2864 6976 6973  if not len(divis
+00042ff0: 696f 6e73 293a 0a20 2020 2020 2020 2064  ions):.        d
+00043000: 6976 6973 696f 6e73 203d 205b 6466 2e64  ivisions = [df.d
+00043010: 6976 6973 696f 6e73 5b30 5d2c 2064 662e  ivisions[0], df.
+00043020: 6469 7669 7369 6f6e 735b 2d31 5d5d 0a20  divisions[-1]]. 
+00043030: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00043040: 2064 6976 6973 696f 6e73 2e61 7070 656e   divisions.appen
+00043050: 6428 6466 2e64 6976 6973 696f 6e73 5b2d  d(df.divisions[-
+00043060: 315d 290a 2020 2020 2020 2020 6966 2064  1]).        if d
+00043070: 6976 6973 696f 6e73 5b30 5d20 213d 2064  ivisions[0] != d
+00043080: 662e 6469 7669 7369 6f6e 735b 305d 3a0a  f.divisions[0]:.
+00043090: 2020 2020 2020 2020 2020 2020 6469 7669              divi
+000430a0: 7369 6f6e 7320 3d20 5b64 662e 6469 7669  sions = [df.divi
+000430b0: 7369 6f6e 735b 305d 5d20 2b20 6469 7669  sions[0]] + divi
+000430c0: 7369 6f6e 730a 0a20 2020 2072 6574 7572  sions..    retur
+000430d0: 6e20 6466 2e72 6570 6172 7469 7469 6f6e  n df.repartition
+000430e0: 2864 6976 6973 696f 6e73 3d64 6976 6973  (divisions=divis
+000430f0: 696f 6e73 290a 0a0a 6465 6620 5f6d 6170  ions)...def _map
+00043100: 5f66 7265 715f 746f 5f70 6572 696f 645f  _freq_to_period_
+00043110: 7374 6172 7428 6672 6571 293a 0a20 2020  start(freq):.   
+00043120: 2022 2222 456e 7375 7265 2074 6861 7420   """Ensure that 
+00043130: 7468 6520 6672 6571 7565 6e63 7920 7065  the frequency pe
+00043140: 7274 6169 6e73 2074 6f20 7468 6520 2a2a  rtains to the **
+00043150: 7374 6172 742a 2a20 6f66 2061 2070 6572  start** of a per
+00043160: 696f 642e 0a0a 2020 2020 4966 2065 2e67  iod...    If e.g
+00043170: 2e20 6066 7265 713d 274d 2760 2c20 7468  . `freq='M'`, th
+00043180: 656e 2074 6865 2064 6976 6973 696f 6e73  en the divisions
+00043190: 2061 7265 3a0a 2020 2020 2020 2020 2d20   are:.        - 
+000431a0: 3230 3231 2d33 312d 3120 3030 3a30 303a  2021-31-1 00:00:
+000431b0: 3030 2028 7374 6172 7420 6f66 2046 6562  00 (start of Feb
+000431c0: 7275 6172 7920 7061 7274 6974 696f 6e29  ruary partition)
+000431d0: 0a20 2020 2020 2020 202d 2032 3032 312d  .        - 2021-
+000431e0: 322d 3238 2030 303a 3030 3a30 3020 2873  2-28 00:00:00 (s
+000431f0: 7461 7274 206f 6620 4d61 7263 6820 7061  tart of March pa
+00043200: 7274 6974 696f 6e29 0a20 2020 2020 2020  rtition).       
+00043210: 202d 202e 2e2e 0a0a 2020 2020 6275 7420   - .....    but 
+00043220: 7468 6973 202a 2a73 686f 756c 642a 2a20  this **should** 
+00043230: 6265 3a0a 2020 2020 2020 2020 2d20 3230  be:.        - 20
+00043240: 3231 2d32 2d31 2030 303a 3030 3a30 3020  21-2-1 00:00:00 
+00043250: 2873 7461 7274 206f 6620 4665 6272 7561  (start of Februa
+00043260: 7279 2070 6172 7469 7469 6f6e 290a 2020  ry partition).  
+00043270: 2020 2020 2020 2d20 3230 3231 2d33 2d31        - 2021-3-1
+00043280: 2030 303a 3030 3a30 3020 2873 7461 7274   00:00:00 (start
+00043290: 206f 6620 4d61 7263 6820 7061 7274 6974   of March partit
+000432a0: 696f 6e29 0a20 2020 2020 2020 202d 202e  ion).        - .
+000432b0: 2e2e 0a0a 2020 2020 5468 6572 6566 6f72  ....    Therefor
+000432c0: 652c 2077 6520 6d61 7020 6066 7265 713d  e, we map `freq=
+000432d0: 274d 2760 2074 6f20 6066 7265 713d 274d  'M'` to `freq='M
+000432e0: 5327 6020 2873 616d 6520 666f 7220 7175  S'` (same for qu
+000432f0: 6172 7465 7220 616e 6420 7965 6172 292e  arter and year).
+00043300: 0a20 2020 2022 2222 0a0a 2020 2020 6966  .    """..    if
+00043310: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00043320: 6672 6571 2c20 7374 7229 3a0a 2020 2020  freq, str):.    
+00043330: 2020 2020 7265 7475 726e 2066 7265 710a      return freq.
+00043340: 0a20 2020 206f 6666 7365 7420 3d20 7064  .    offset = pd
+00043350: 2e74 7365 7269 6573 2e66 7265 7175 656e  .tseries.frequen
+00043360: 6369 6573 2e74 6f5f 6f66 6673 6574 2866  cies.to_offset(f
+00043370: 7265 7129 0a20 2020 206f 6666 7365 745f  req).    offset_
+00043380: 7479 7065 5f6e 616d 6520 3d20 7479 7065  type_name = type
+00043390: 286f 6666 7365 7429 2e5f 5f6e 616d 655f  (offset).__name_
+000433a0: 5f0a 0a20 2020 2069 6620 6e6f 7420 6f66  _..    if not of
+000433b0: 6673 6574 5f74 7970 655f 6e61 6d65 2e65  fset_type_name.e
+000433c0: 6e64 7377 6974 6828 2245 6e64 2229 3a0a  ndswith("End"):.
+000433d0: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+000433e0: 7265 710a 0a20 2020 206e 6577 5f6f 6666  req..    new_off
+000433f0: 7365 7420 3d20 6f66 6673 6574 5f74 7970  set = offset_typ
+00043400: 655f 6e61 6d65 5b3a 202d 6c65 6e28 2245  e_name[: -len("E
+00043410: 6e64 2229 5d20 2b20 2242 6567 696e 220a  nd")] + "Begin".
+00043420: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00043430: 206e 6577 5f6f 6666 7365 745f 7479 7065   new_offset_type
+00043440: 203d 2067 6574 6174 7472 2870 642e 7473   = getattr(pd.ts
+00043450: 6572 6965 732e 6f66 6673 6574 732c 206e  eries.offsets, n
+00043460: 6577 5f6f 6666 7365 7429 0a20 2020 2020  ew_offset).     
+00043470: 2020 2069 6620 222d 2220 696e 2066 7265     if "-" in fre
+00043480: 713a 0a20 2020 2020 2020 2020 2020 205f  q:.            _
+00043490: 2c20 616e 6368 6f72 203d 2066 7265 712e  , anchor = freq.
+000434a0: 7370 6c69 7428 222d 2229 0a20 2020 2020  split("-").     
+000434b0: 2020 2020 2020 2061 6e63 686f 7220 3d20         anchor = 
+000434c0: 222d 2220 2b20 616e 6368 6f72 0a20 2020  "-" + anchor.   
+000434d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000434e0: 2020 2020 2020 2061 6e63 686f 7220 3d20         anchor = 
+000434f0: 2222 0a20 2020 2020 2020 206e 203d 2073  "".        n = s
+00043500: 7472 286f 6666 7365 742e 6e29 2069 6620  tr(offset.n) if 
+00043510: 6f66 6673 6574 2e6e 2021 3d20 3120 656c  offset.n != 1 el
+00043520: 7365 2022 220a 2020 2020 2020 2020 7265  se "".        re
+00043530: 7475 726e 2066 227b 6e7d 7b6e 6577 5f6f  turn f"{n}{new_o
+00043540: 6666 7365 745f 7479 7065 2e5f 7072 6566  ffset_type._pref
+00043550: 6978 7d7b 616e 6368 6f72 7d22 0a20 2020  ix}{anchor}".   
+00043560: 2065 7863 6570 7420 4174 7472 6962 7574   except Attribut
+00043570: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
+00043580: 7265 7475 726e 2066 7265 710a 0a0a 6465  return freq...de
+00043590: 6620 7265 7061 7274 6974 696f 6e5f 7369  f repartition_si
+000435a0: 7a65 2864 662c 2073 697a 6529 3a0a 2020  ze(df, size):.  
+000435b0: 2020 2222 220a 2020 2020 5265 7061 7274    """.    Repart
+000435c0: 6974 696f 6e20 6461 7461 6672 616d 6520  ition dataframe 
+000435d0: 736f 2074 6861 7420 6e65 7720 7061 7274  so that new part
+000435e0: 6974 696f 6e73 2068 6176 6520 6170 7072  itions have appr
+000435f0: 6f78 696d 6174 656c 7920 6073 697a 6560  oximately `size`
+00043600: 206d 656d 6f72 7920 7573 6167 6520 6561   memory usage ea
+00043610: 6368 0a20 2020 2022 2222 0a20 2020 2069  ch.    """.    i
+00043620: 6620 6973 696e 7374 616e 6365 2873 697a  f isinstance(siz
+00043630: 652c 2073 7472 293a 0a20 2020 2020 2020  e, str):.       
+00043640: 2073 697a 6520 3d20 7061 7273 655f 6279   size = parse_by
+00043650: 7465 7328 7369 7a65 290a 2020 2020 7369  tes(size).    si
+00043660: 7a65 203d 2069 6e74 2873 697a 6529 0a0a  ze = int(size)..
+00043670: 2020 2020 6d65 6d5f 7573 6167 6573 203d      mem_usages =
+00043680: 2064 662e 6d61 705f 7061 7274 6974 696f   df.map_partitio
+00043690: 6e73 2874 6f74 616c 5f6d 656d 5f75 7361  ns(total_mem_usa
+000436a0: 6765 2c20 6465 6570 3d54 7275 6529 2e63  ge, deep=True).c
+000436b0: 6f6d 7075 7465 2829 0a0a 2020 2020 2320  ompute()..    # 
+000436c0: 312e 2073 706c 6974 2065 6163 6820 7061  1. split each pa
+000436d0: 7274 6974 696f 6e20 7468 6174 2069 7320  rtition that is 
+000436e0: 6c61 7267 6572 2074 6861 6e20 7061 7274  larger than part
+000436f0: 6974 696f 6e5f 7369 7a65 0a20 2020 206e  ition_size.    n
+00043700: 7370 6c69 7473 203d 2031 202b 206d 656d  splits = 1 + mem
+00043710: 5f75 7361 6765 7320 2f2f 2073 697a 650a  _usages // size.
+00043720: 2020 2020 6966 206e 702e 616e 7928 6e73      if np.any(ns
+00043730: 706c 6974 7320 3e20 3129 3a0a 2020 2020  plits > 1):.    
+00043740: 2020 2020 7370 6c69 745f 6e61 6d65 203d      split_name =
+00043750: 2066 2272 6570 6172 7469 7469 6f6e 2d73   f"repartition-s
+00043760: 706c 6974 2d7b 7369 7a65 7d2d 7b74 6f6b  plit-{size}-{tok
+00043770: 656e 697a 6528 6466 297d 220a 2020 2020  enize(df)}".    
+00043780: 2020 2020 6466 203d 205f 7370 6c69 745f      df = _split_
+00043790: 7061 7274 6974 696f 6e73 2864 662c 206e  partitions(df, n
+000437a0: 7370 6c69 7473 2c20 7370 6c69 745f 6e61  splits, split_na
+000437b0: 6d65 290a 2020 2020 2020 2020 2320 7570  me).        # up
+000437c0: 6461 7465 206d 656d 5f75 7361 6765 7320  date mem_usages 
+000437d0: 746f 2061 6363 6f75 6e74 2066 6f72 2074  to account for t
+000437e0: 6865 2073 706c 6974 2070 6172 7469 7469  he split partiti
+000437f0: 6f6e 730a 2020 2020 2020 2020 7370 6c69  ons.        spli
+00043800: 745f 6d65 6d5f 7573 6167 6573 203d 205b  t_mem_usages = [
+00043810: 5d0a 2020 2020 2020 2020 666f 7220 6e2c  ].        for n,
+00043820: 2075 7361 6765 2069 6e20 7a69 7028 6e73   usage in zip(ns
+00043830: 706c 6974 732c 206d 656d 5f75 7361 6765  plits, mem_usage
+00043840: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00043850: 7370 6c69 745f 6d65 6d5f 7573 6167 6573  split_mem_usages
+00043860: 2e65 7874 656e 6428 5b75 7361 6765 202f  .extend([usage /
+00043870: 206e 5d20 2a20 6e29 0a20 2020 2020 2020   n] * n).       
+00043880: 206d 656d 5f75 7361 6765 7320 3d20 7064   mem_usages = pd
+00043890: 2e53 6572 6965 7328 7370 6c69 745f 6d65  .Series(split_me
+000438a0: 6d5f 7573 6167 6573 290a 0a20 2020 2023  m_usages)..    #
+000438b0: 2032 2e20 6e6f 7720 7468 6174 2061 6c6c   2. now that all
+000438c0: 2070 6172 7469 7469 6f6e 7320 6172 6520   partitions are 
+000438d0: 6c65 7373 2074 6861 6e20 7369 7a65 2c20  less than size, 
+000438e0: 636f 6e63 6174 2074 6865 6d20 7570 2074  concat them up t
+000438f0: 6f20 7369 7a65 0a20 2020 2061 7373 6572  o size.    asser
+00043900: 7420 6e70 2e61 6c6c 286d 656d 5f75 7361  t np.all(mem_usa
+00043910: 6765 7320 3c3d 2073 697a 6529 0a20 2020  ges <= size).   
+00043920: 206e 6577 5f6e 7061 7274 6974 696f 6e73   new_npartitions
+00043930: 203d 206c 6973 7428 6d61 7028 6c65 6e2c   = list(map(len,
+00043940: 2069 7465 725f 6368 756e 6b73 286d 656d   iter_chunks(mem
+00043950: 5f75 7361 6765 732c 2073 697a 6529 2929  _usages, size)))
+00043960: 0a20 2020 206e 6577 5f70 6172 7469 7469  .    new_partiti
+00043970: 6f6e 735f 626f 756e 6461 7269 6573 203d  ons_boundaries =
+00043980: 206e 702e 6375 6d73 756d 286e 6577 5f6e   np.cumsum(new_n
+00043990: 7061 7274 6974 696f 6e73 290a 2020 2020  partitions).    
+000439a0: 6e65 775f 6e61 6d65 203d 2066 2272 6570  new_name = f"rep
+000439b0: 6172 7469 7469 6f6e 2d7b 7369 7a65 7d2d  artition-{size}-
+000439c0: 7b74 6f6b 656e 697a 6528 6466 297d 220a  {tokenize(df)}".
+000439d0: 2020 2020 7265 7475 726e 205f 7265 7061      return _repa
+000439e0: 7274 6974 696f 6e5f 6672 6f6d 5f62 6f75  rtition_from_bou
+000439f0: 6e64 6172 6965 7328 6466 2c20 6e65 775f  ndaries(df, new_
+00043a00: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
+00043a10: 6172 6965 732c 206e 6577 5f6e 616d 6529  aries, new_name)
+00043a20: 0a0a 0a64 6566 2074 6f74 616c 5f6d 656d  ...def total_mem
+00043a30: 5f75 7361 6765 2864 662c 2069 6e64 6578  _usage(df, index
+00043a40: 3d54 7275 652c 2064 6565 703d 4661 6c73  =True, deep=Fals
+00043a50: 6529 3a0a 2020 2020 6d65 6d5f 7573 6167  e):.    mem_usag
+00043a60: 6520 3d20 6466 2e6d 656d 6f72 795f 7573  e = df.memory_us
+00043a70: 6167 6528 696e 6465 783d 696e 6465 782c  age(index=index,
+00043a80: 2064 6565 703d 6465 6570 290a 2020 2020   deep=deep).    
+00043a90: 6966 2069 735f 7365 7269 6573 5f6c 696b  if is_series_lik
+00043aa0: 6528 6d65 6d5f 7573 6167 6529 3a0a 2020  e(mem_usage):.  
+00043ab0: 2020 2020 2020 6d65 6d5f 7573 6167 6520        mem_usage 
+00043ac0: 3d20 6d65 6d5f 7573 6167 652e 7375 6d28  = mem_usage.sum(
+00043ad0: 290a 2020 2020 7265 7475 726e 206d 656d  ).    return mem
+00043ae0: 5f75 7361 6765 0a0a 0a64 6566 2072 6570  _usage...def rep
+00043af0: 6172 7469 7469 6f6e 5f6e 7061 7274 6974  artition_npartit
+00043b00: 696f 6e73 2864 662c 206e 7061 7274 6974  ions(df, npartit
+00043b10: 696f 6e73 293a 0a20 2020 2022 2222 5265  ions):.    """Re
+00043b20: 7061 7274 6974 696f 6e20 6461 7461 6672  partition datafr
+00043b30: 616d 6520 746f 2061 2073 6d61 6c6c 6572  ame to a smaller
+00043b40: 206e 756d 6265 7220 6f66 2070 6172 7469   number of parti
+00043b50: 7469 6f6e 7322 2222 0a20 2020 206e 6577  tions""".    new
+00043b60: 5f6e 616d 6520 3d20 2272 6570 6172 7469  _name = "reparti
+00043b70: 7469 6f6e 2d25 642d 2573 2220 2520 286e  tion-%d-%s" % (n
+00043b80: 7061 7274 6974 696f 6e73 2c20 746f 6b65  partitions, toke
+00043b90: 6e69 7a65 2864 6629 290a 2020 2020 6966  nize(df)).    if
+00043ba0: 2064 662e 6e70 6172 7469 7469 6f6e 7320   df.npartitions 
+00043bb0: 3d3d 206e 7061 7274 6974 696f 6e73 3a0a  == npartitions:.
+00043bc0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+00043bd0: 660a 2020 2020 656c 6966 2064 662e 6e70  f.    elif df.np
+00043be0: 6172 7469 7469 6f6e 7320 3e20 6e70 6172  artitions > npar
+00043bf0: 7469 7469 6f6e 733a 0a20 2020 2020 2020  titions:.       
+00043c00: 206e 7061 7274 6974 696f 6e73 5f72 6174   npartitions_rat
+00043c10: 696f 203d 2064 662e 6e70 6172 7469 7469  io = df.npartiti
+00043c20: 6f6e 7320 2f20 6e70 6172 7469 7469 6f6e  ons / npartition
+00043c30: 730a 2020 2020 2020 2020 6e65 775f 7061  s.        new_pa
+00043c40: 7274 6974 696f 6e73 5f62 6f75 6e64 6172  rtitions_boundar
+00043c50: 6965 7320 3d20 5b0a 2020 2020 2020 2020  ies = [.        
+00043c60: 2020 2020 696e 7428 6e65 775f 7061 7274      int(new_part
+00043c70: 6974 696f 6e5f 696e 6465 7820 2a20 6e70  ition_index * np
+00043c80: 6172 7469 7469 6f6e 735f 7261 7469 6f29  artitions_ratio)
+00043c90: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00043ca0: 206e 6577 5f70 6172 7469 7469 6f6e 5f69   new_partition_i
+00043cb0: 6e64 6578 2069 6e20 7261 6e67 6528 6e70  ndex in range(np
+00043cc0: 6172 7469 7469 6f6e 7320 2b20 3129 0a20  artitions + 1). 
+00043cd0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+00043ce0: 2072 6574 7572 6e20 5f72 6570 6172 7469   return _reparti
+00043cf0: 7469 6f6e 5f66 726f 6d5f 626f 756e 6461  tion_from_bounda
+00043d00: 7269 6573 2864 662c 206e 6577 5f70 6172  ries(df, new_par
+00043d10: 7469 7469 6f6e 735f 626f 756e 6461 7269  titions_boundari
+00043d20: 6573 2c20 6e65 775f 6e61 6d65 290a 2020  es, new_name).  
+00043d30: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00043d40: 2320 4472 6f70 2064 7570 6c63 6174 6573  # Drop duplcates
+00043d50: 2069 6e20 6361 7365 206c 6173 7420 7061   in case last pa
+00043d60: 7274 6974 696f 6e20 6861 7320 7361 6d65  rtition has same
+00043d70: 0a20 2020 2020 2020 2023 2076 616c 7565  .        # value
+00043d80: 2066 6f72 206d 696e 2061 6e64 206d 6178   for min and max
+00043d90: 2064 6976 6973 696f 6e0a 2020 2020 2020   division.      
+00043da0: 2020 6f72 6967 696e 616c 5f64 6976 6973    original_divis
+00043db0: 696f 6e73 203d 2064 6976 6973 696f 6e73  ions = divisions
+00043dc0: 203d 2070 642e 5365 7269 6573 2864 662e   = pd.Series(df.
+00043dd0: 6469 7669 7369 6f6e 7329 2e64 726f 705f  divisions).drop_
+00043de0: 6475 706c 6963 6174 6573 2829 0a20 2020  duplicates().   
+00043df0: 2020 2020 2069 6620 6466 2e6b 6e6f 776e       if df.known
+00043e00: 5f64 6976 6973 696f 6e73 2061 6e64 2028  _divisions and (
+00043e10: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
+00043e20: 6461 7465 7469 6d65 3634 5f61 6e79 5f64  datetime64_any_d
+00043e30: 7479 7065 2864 6976 6973 696f 6e73 2e64  type(divisions.d
+00043e40: 7479 7065 290a 2020 2020 2020 2020 2020  type).          
+00043e50: 2020 6f72 2069 735f 6e75 6d65 7269 635f    or is_numeric_
+00043e60: 6474 7970 6528 6469 7669 7369 6f6e 732e  dtype(divisions.
+00043e70: 6474 7970 6529 0a20 2020 2020 2020 2029  dtype).        )
+00043e80: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00043e90: 2069 735f 6461 7465 7469 6d65 3634 5f61   is_datetime64_a
+00043ea0: 6e79 5f64 7479 7065 2864 6976 6973 696f  ny_dtype(divisio
+00043eb0: 6e73 2e64 7479 7065 293a 0a20 2020 2020  ns.dtype):.     
+00043ec0: 2020 2020 2020 2020 2020 2064 6976 6973             divis
+00043ed0: 696f 6e73 203d 2064 6976 6973 696f 6e73  ions = divisions
+00043ee0: 2e76 616c 7565 732e 6173 7479 7065 2822  .values.astype("
+00043ef0: 666c 6f61 7436 3422 290a 0a20 2020 2020  float64")..     
+00043f00: 2020 2020 2020 2069 6620 6973 5f73 6572         if is_ser
+00043f10: 6965 735f 6c69 6b65 2864 6976 6973 696f  ies_like(divisio
+00043f20: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
+00043f30: 2020 2020 2064 6976 6973 696f 6e73 203d       divisions =
+00043f40: 2064 6976 6973 696f 6e73 2e76 616c 7565   divisions.value
+00043f50: 730a 0a20 2020 2020 2020 2020 2020 206e  s..            n
+00043f60: 203d 206c 656e 2864 6976 6973 696f 6e73   = len(divisions
+00043f70: 290a 2020 2020 2020 2020 2020 2020 6469  ).            di
+00043f80: 7669 7369 6f6e 7320 3d20 6e70 2e69 6e74  visions = np.int
+00043f90: 6572 7028 0a20 2020 2020 2020 2020 2020  erp(.           
+00043fa0: 2020 2020 2078 3d6e 702e 6c69 6e73 7061       x=np.linspa
+00043fb0: 6365 2830 2c20 6e2c 206e 7061 7274 6974  ce(0, n, npartit
+00043fc0: 696f 6e73 202b 2031 292c 0a20 2020 2020  ions + 1),.     
+00043fd0: 2020 2020 2020 2020 2020 2078 703d 6e70             xp=np
+00043fe0: 2e6c 696e 7370 6163 6528 302c 206e 2c20  .linspace(0, n, 
+00043ff0: 6e29 2c0a 2020 2020 2020 2020 2020 2020  n),.            
+00044000: 2020 2020 6670 3d64 6976 6973 696f 6e73      fp=divisions
+00044010: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00044020: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00044030: 735f 6461 7465 7469 6d65 3634 5f61 6e79  s_datetime64_any
+00044040: 5f64 7479 7065 286f 7269 6769 6e61 6c5f  _dtype(original_
+00044050: 6469 7669 7369 6f6e 732e 6474 7970 6529  divisions.dtype)
+00044060: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00044070: 2020 6469 7669 7369 6f6e 7320 3d20 6d65    divisions = me
+00044080: 7468 6f64 732e 746f 6c69 7374 280a 2020  thods.tolist(.  
+00044090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000440a0: 2020 7064 2e53 6572 6965 7328 6469 7669    pd.Series(divi
+000440b0: 7369 6f6e 7329 2e61 7374 7970 6528 6f72  sions).astype(or
+000440c0: 6967 696e 616c 5f64 6976 6973 696f 6e73  iginal_divisions
+000440d0: 2e64 7479 7065 290a 2020 2020 2020 2020  .dtype).        
+000440e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000440f0: 2020 2020 2020 656c 6966 206e 702e 6973        elif np.is
+00044100: 7375 6264 7479 7065 286f 7269 6769 6e61  subdtype(origina
+00044110: 6c5f 6469 7669 7369 6f6e 732e 6474 7970  l_divisions.dtyp
+00044120: 652c 206e 702e 696e 7465 6765 7229 3a0a  e, np.integer):.
+00044130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044140: 6469 7669 7369 6f6e 7320 3d20 6469 7669  divisions = divi
+00044150: 7369 6f6e 732e 6173 7479 7065 286f 7269  sions.astype(ori
+00044160: 6769 6e61 6c5f 6469 7669 7369 6f6e 732e  ginal_divisions.
+00044170: 6474 7970 6529 0a0a 2020 2020 2020 2020  dtype)..        
+00044180: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00044190: 6528 6469 7669 7369 6f6e 732c 206e 702e  e(divisions, np.
+000441a0: 6e64 6172 7261 7929 3a0a 2020 2020 2020  ndarray):.      
+000441b0: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
+000441c0: 6f6e 7320 3d20 6469 7669 7369 6f6e 732e  ons = divisions.
+000441d0: 746f 6c69 7374 2829 0a0a 2020 2020 2020  tolist()..      
+000441e0: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
+000441f0: 3d20 6c69 7374 2864 6976 6973 696f 6e73  = list(divisions
+00044200: 290a 2020 2020 2020 2020 2020 2020 6469  ).            di
+00044210: 7669 7369 6f6e 735b 305d 203d 2064 662e  visions[0] = df.
+00044220: 6469 7669 7369 6f6e 735b 305d 0a20 2020  divisions[0].   
+00044230: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
+00044240: 6e73 5b2d 315d 203d 2064 662e 6469 7669  ns[-1] = df.divi
+00044250: 7369 6f6e 735b 2d31 5d0a 0a20 2020 2020  sions[-1]..     
+00044260: 2020 2020 2020 2023 2045 6e73 7572 6520         # Ensure 
+00044270: 7468 6520 636f 6d70 7574 6564 2064 6976  the computed div
+00044280: 6973 696f 6e73 2061 7265 2075 6e69 7175  isions are uniqu
+00044290: 650a 2020 2020 2020 2020 2020 2020 6469  e.            di
+000442a0: 7669 7369 6f6e 7320 3d20 6c69 7374 2875  visions = list(u
+000442b0: 6e69 7175 6528 6469 7669 7369 6f6e 735b  nique(divisions[
+000442c0: 3a2d 315d 2929 202b 205b 6469 7669 7369  :-1])) + [divisi
+000442d0: 6f6e 735b 2d31 5d5d 0a20 2020 2020 2020  ons[-1]].       
+000442e0: 2020 2020 2072 6574 7572 6e20 6466 2e72       return df.r
+000442f0: 6570 6172 7469 7469 6f6e 2864 6976 6973  epartition(divis
+00044300: 696f 6e73 3d64 6976 6973 696f 6e73 290a  ions=divisions).
+00044310: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00044320: 2020 2020 2020 2020 2020 6469 762c 206d            div, m
+00044330: 6f64 203d 2064 6976 6d6f 6428 6e70 6172  od = divmod(npar
+00044340: 7469 7469 6f6e 732c 2064 662e 6e70 6172  titions, df.npar
+00044350: 7469 7469 6f6e 7329 0a20 2020 2020 2020  titions).       
+00044360: 2020 2020 206e 7370 6c69 7473 203d 205b       nsplits = [
+00044370: 6469 765d 202a 2064 662e 6e70 6172 7469  div] * df.nparti
+00044380: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
+00044390: 2020 6e73 706c 6974 735b 2d31 5d20 2b3d    nsplits[-1] +=
+000443a0: 206d 6f64 0a20 2020 2020 2020 2020 2020   mod.           
+000443b0: 2072 6574 7572 6e20 5f73 706c 6974 5f70   return _split_p
+000443c0: 6172 7469 7469 6f6e 7328 6466 2c20 6e73  artitions(df, ns
+000443d0: 706c 6974 732c 206e 6577 5f6e 616d 6529  plits, new_name)
+000443e0: 0a0a 0a64 6566 205f 7265 7061 7274 6974  ...def _repartit
+000443f0: 696f 6e5f 6672 6f6d 5f62 6f75 6e64 6172  ion_from_boundar
+00044400: 6965 7328 6466 2c20 6e65 775f 7061 7274  ies(df, new_part
+00044410: 6974 696f 6e73 5f62 6f75 6e64 6172 6965  itions_boundarie
+00044420: 732c 206e 6577 5f6e 616d 6529 3a0a 2020  s, new_name):.  
+00044430: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00044440: 6e63 6528 6e65 775f 7061 7274 6974 696f  nce(new_partitio
+00044450: 6e73 5f62 6f75 6e64 6172 6965 732c 206c  ns_boundaries, l
+00044460: 6973 7429 3a0a 2020 2020 2020 2020 6e65  ist):.        ne
+00044470: 775f 7061 7274 6974 696f 6e73 5f62 6f75  w_partitions_bou
+00044480: 6e64 6172 6965 7320 3d20 6c69 7374 286e  ndaries = list(n
+00044490: 6577 5f70 6172 7469 7469 6f6e 735f 626f  ew_partitions_bo
+000444a0: 756e 6461 7269 6573 290a 2020 2020 6966  undaries).    if
+000444b0: 206e 6577 5f70 6172 7469 7469 6f6e 735f   new_partitions_
+000444c0: 626f 756e 6461 7269 6573 5b30 5d20 3e20  boundaries[0] > 
+000444d0: 303a 0a20 2020 2020 2020 206e 6577 5f70  0:.        new_p
+000444e0: 6172 7469 7469 6f6e 735f 626f 756e 6461  artitions_bounda
+000444f0: 7269 6573 2e69 6e73 6572 7428 302c 2030  ries.insert(0, 0
+00044500: 290a 2020 2020 6966 206e 6577 5f70 6172  ).    if new_par
+00044510: 7469 7469 6f6e 735f 626f 756e 6461 7269  titions_boundari
+00044520: 6573 5b2d 315d 203c 2064 662e 6e70 6172  es[-1] < df.npar
+00044530: 7469 7469 6f6e 733a 0a20 2020 2020 2020  titions:.       
+00044540: 206e 6577 5f70 6172 7469 7469 6f6e 735f   new_partitions_
+00044550: 626f 756e 6461 7269 6573 2e61 7070 656e  boundaries.appen
+00044560: 6428 6466 2e6e 7061 7274 6974 696f 6e73  d(df.npartitions
+00044570: 290a 2020 2020 6473 6b20 3d20 7b7d 0a20  ).    dsk = {}. 
+00044580: 2020 2066 6f72 2069 2c20 2873 7461 7274     for i, (start
+00044590: 2c20 656e 6429 2069 6e20 656e 756d 6572  , end) in enumer
+000445a0: 6174 6528 0a20 2020 2020 2020 207a 6970  ate(.        zip
+000445b0: 286e 6577 5f70 6172 7469 7469 6f6e 735f  (new_partitions_
+000445c0: 626f 756e 6461 7269 6573 2c20 6e65 775f  boundaries, new_
+000445d0: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
+000445e0: 6172 6965 735b 313a 5d29 0a20 2020 2029  aries[1:]).    )
+000445f0: 3a0a 2020 2020 2020 2020 6473 6b5b 6e65  :.        dsk[ne
+00044600: 775f 6e61 6d65 2c20 695d 203d 2028 6d65  w_name, i] = (me
+00044610: 7468 6f64 732e 636f 6e63 6174 2c20 5b28  thods.concat, [(
+00044620: 6466 2e5f 6e61 6d65 2c20 6a29 2066 6f72  df._name, j) for
+00044630: 206a 2069 6e20 7261 6e67 6528 7374 6172   j in range(star
+00044640: 742c 2065 6e64 295d 290a 2020 2020 6469  t, end)]).    di
+00044650: 7669 7369 6f6e 7320 3d20 5b64 662e 6469  visions = [df.di
+00044660: 7669 7369 6f6e 735b 695d 2066 6f72 2069  visions[i] for i
+00044670: 2069 6e20 6e65 775f 7061 7274 6974 696f   in new_partitio
+00044680: 6e73 5f62 6f75 6e64 6172 6965 735d 0a20  ns_boundaries]. 
+00044690: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+000446a0: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+000446b0: 6f6c 6c65 6374 696f 6e73 286e 6577 5f6e  ollections(new_n
+000446c0: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
+000446d0: 656e 6369 6573 3d5b 6466 5d29 0a20 2020  encies=[df]).   
+000446e0: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
+000446f0: 626a 6563 7428 6772 6170 682c 206e 6577  bject(graph, new
+00044700: 5f6e 616d 652c 2064 662e 5f6d 6574 612c  _name, df._meta,
+00044710: 2064 6976 6973 696f 6e73 290a 0a0a 6465   divisions)...de
+00044720: 6620 5f73 706c 6974 5f70 6172 7469 7469  f _split_partiti
+00044730: 6f6e 7328 6466 2c20 6e73 706c 6974 732c  ons(df, nsplits,
+00044740: 206e 6577 5f6e 616d 6529 3a0a 2020 2020   new_name):.    
+00044750: 2222 2253 706c 6974 2061 2044 6173 6b20  """Split a Dask 
+00044760: 6461 7461 6672 616d 6520 696e 746f 206e  dataframe into n
+00044770: 6577 2070 6172 7469 7469 6f6e 730a 0a20  ew partitions.. 
+00044780: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00044790: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+000447a0: 2064 663a 2044 6174 6146 7261 6d65 206f   df: DataFrame o
+000447b0: 7220 5365 7269 6573 0a20 2020 206e 7370  r Series.    nsp
+000447c0: 6c69 7473 3a20 4c69 7374 5b69 6e74 5d0a  lits: List[int].
+000447d0: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
+000447e0: 6620 7461 7267 6574 2064 6174 6166 7261  f target datafra
+000447f0: 6d65 7320 666f 7220 6561 6368 2070 6172  mes for each par
+00044800: 7469 7469 6f6e 0a20 2020 2020 2020 2054  tition.        T
+00044810: 6865 206c 656e 6774 6820 6f66 206e 7370  he length of nsp
+00044820: 6c69 7473 2073 686f 756c 6420 6265 2074  lits should be t
+00044830: 6865 2073 616d 6520 6173 2064 662e 6e70  he same as df.np
+00044840: 6172 7469 7469 6f6e 730a 2020 2020 6e65  artitions.    ne
+00044850: 775f 6e61 6d65 3a20 7374 720a 0a20 2020  w_name: str..   
+00044860: 2053 6565 2041 6c73 6f0a 2020 2020 2d2d   See Also.    --
+00044870: 2d2d 2d2d 2d2d 0a20 2020 2072 6570 6172  ------.    repar
+00044880: 7469 7469 6f6e 5f6e 7061 7274 6974 696f  tition_npartitio
+00044890: 6e73 0a20 2020 2072 6570 6172 7469 7469  ns.    repartiti
+000448a0: 6f6e 5f73 697a 650a 2020 2020 2222 220a  on_size.    """.
+000448b0: 2020 2020 6966 206c 656e 286e 7370 6c69      if len(nspli
+000448c0: 7473 2920 213d 2064 662e 6e70 6172 7469  ts) != df.nparti
+000448d0: 7469 6f6e 733a 0a20 2020 2020 2020 2072  tions:.        r
+000448e0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+000448f0: 6622 6e73 706c 6974 7320 7368 6f75 6c64  f"nsplits should
+00044900: 2068 6176 6520 6c65 6e3d 7b64 662e 6e70   have len={df.np
+00044910: 6172 7469 7469 6f6e 737d 2229 0a0a 2020  artitions}")..  
+00044920: 2020 6473 6b20 3d20 7b7d 0a20 2020 2073    dsk = {}.    s
+00044930: 706c 6974 5f6e 616d 6520 3d20 6622 7370  plit_name = f"sp
+00044940: 6c69 742d 7b74 6f6b 656e 697a 6528 6466  lit-{tokenize(df
+00044950: 2c20 6e73 706c 6974 7329 7d22 0a20 2020  , nsplits)}".   
+00044960: 206a 203d 2030 0a20 2020 2066 6f72 2069   j = 0.    for i
+00044970: 2c20 6b20 696e 2065 6e75 6d65 7261 7465  , k in enumerate
+00044980: 286e 7370 6c69 7473 293a 0a20 2020 2020  (nsplits):.     
+00044990: 2020 2069 6620 6b20 3d3d 2031 3a0a 2020     if k == 1:.  
+000449a0: 2020 2020 2020 2020 2020 6473 6b5b 6e65            dsk[ne
+000449b0: 775f 6e61 6d65 2c20 6a5d 203d 2028 6466  w_name, j] = (df
+000449c0: 2e5f 6e61 6d65 2c20 6929 0a20 2020 2020  ._name, i).     
+000449d0: 2020 2020 2020 206a 202b 3d20 310a 2020         j += 1.  
+000449e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000449f0: 2020 2020 2020 2020 6473 6b5b 7370 6c69          dsk[spli
+00044a00: 745f 6e61 6d65 2c20 695d 203d 2028 7370  t_name, i] = (sp
+00044a10: 6c69 745f 6576 656e 6c79 2c20 2864 662e  lit_evenly, (df.
+00044a20: 5f6e 616d 652c 2069 292c 206b 290a 2020  _name, i), k).  
+00044a30: 2020 2020 2020 2020 2020 666f 7220 6a6a            for jj
+00044a40: 2069 6e20 7261 6e67 6528 6b29 3a0a 2020   in range(k):.  
+00044a50: 2020 2020 2020 2020 2020 2020 2020 6473                ds
+00044a60: 6b5b 6e65 775f 6e61 6d65 2c20 6a5d 203d  k[new_name, j] =
+00044a70: 2028 6765 7469 7465 6d2c 2028 7370 6c69   (getitem, (spli
+00044a80: 745f 6e61 6d65 2c20 6929 2c20 6a6a 290a  t_name, i), jj).
+00044a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044aa0: 6a20 2b3d 2031 0a0a 2020 2020 6469 7669  j += 1..    divi
+00044ab0: 7369 6f6e 7320 3d20 5b4e 6f6e 655d 202a  sions = [None] *
+00044ac0: 2028 3120 2b20 7375 6d28 6e73 706c 6974   (1 + sum(nsplit
+00044ad0: 7329 290a 2020 2020 6772 6170 6820 3d20  s)).    graph = 
+00044ae0: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
+00044af0: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
+00044b00: 6e65 775f 6e61 6d65 2c20 6473 6b2c 2064  new_name, dsk, d
+00044b10: 6570 656e 6465 6e63 6965 733d 5b64 665d  ependencies=[df]
+00044b20: 290a 2020 2020 7265 7475 726e 206e 6577  ).    return new
+00044b30: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
+00044b40: 2c20 6e65 775f 6e61 6d65 2c20 6466 2e5f  , new_name, df._
+00044b50: 6d65 7461 2c20 6469 7669 7369 6f6e 7329  meta, divisions)
+00044b60: 0a0a 0a64 6566 2072 6570 6172 7469 7469  ...def repartiti
+00044b70: 6f6e 2864 662c 2064 6976 6973 696f 6e73  on(df, divisions
+00044b80: 3d4e 6f6e 652c 2066 6f72 6365 3d46 616c  =None, force=Fal
+00044b90: 7365 293a 0a20 2020 2022 2222 5265 7061  se):.    """Repa
+00044ba0: 7274 6974 696f 6e20 6461 7461 6672 616d  rtition datafram
+00044bb0: 6520 616c 6f6e 6720 6e65 7720 6469 7669  e along new divi
+00044bc0: 7369 6f6e 730a 0a20 2020 2044 6173 6b2e  sions..    Dask.
+00044bd0: 4461 7461 4672 616d 6520 6f62 6a65 6374  DataFrame object
+00044be0: 7320 6172 6520 7061 7274 6974 696f 6e65  s are partitione
+00044bf0: 6420 616c 6f6e 6720 7468 6569 7220 696e  d along their in
+00044c00: 6465 782e 2020 4f66 7465 6e20 7768 656e  dex.  Often when
+00044c10: 0a20 2020 206d 756c 7469 706c 6520 6461  .    multiple da
+00044c20: 7461 6672 616d 6573 2069 6e74 6572 6163  taframes interac
+00044c30: 7420 7765 206e 6565 6420 746f 2061 6c69  t we need to ali
+00044c40: 676e 2074 6865 7365 2070 6172 7469 7469  gn these partiti
+00044c50: 6f6e 696e 6773 2e20 2054 6865 0a20 2020  onings.  The.   
+00044c60: 2060 6072 6570 6172 7469 7469 6f6e 6060   ``repartition``
+00044c70: 2066 756e 6374 696f 6e20 636f 6e73 7472   function constr
+00044c80: 7563 7473 2061 206e 6577 2044 6174 6146  ucts a new DataF
+00044c90: 7261 6d65 206f 626a 6563 7420 686f 6c64  rame object hold
+00044ca0: 696e 6720 7468 6520 7361 6d65 0a20 2020  ing the same.   
+00044cb0: 2064 6174 6120 6275 7420 7061 7274 6974   data but partit
+00044cc0: 696f 6e65 6420 6f6e 2064 6966 6665 7265  ioned on differe
+00044cd0: 6e74 2076 616c 7565 732e 2020 4974 2064  nt values.  It d
+00044ce0: 6f65 7320 7468 6973 2062 7920 7065 7266  oes this by perf
+00044cf0: 6f72 6d69 6e67 2061 0a20 2020 2073 6571  orming a.    seq
+00044d00: 7565 6e63 6520 6f66 2060 606c 6f63 6060  uence of ``loc``
+00044d10: 2061 6e64 2060 6063 6f6e 6361 7460 6020   and ``concat`` 
+00044d20: 6361 6c6c 7320 746f 2073 706c 6974 2061  calls to split a
+00044d30: 6e64 206d 6572 6765 2074 6865 2070 7265  nd merge the pre
+00044d40: 7669 6f75 730a 2020 2020 6765 6e65 7261  vious.    genera
+00044d50: 7469 6f6e 206f 6620 7061 7274 6974 696f  tion of partitio
+00044d60: 6e73 2e0a 0a20 2020 2050 6172 616d 6574  ns...    Paramet
+00044d70: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+00044d80: 2d2d 0a0a 2020 2020 6469 7669 7369 6f6e  --..    division
+00044d90: 7320 3a20 6c69 7374 0a20 2020 2020 2020  s : list.       
+00044da0: 204c 6973 7420 6f66 2070 6172 7469 7469   List of partiti
+00044db0: 6f6e 7320 746f 2062 6520 7573 6564 0a20  ons to be used. 
+00044dc0: 2020 2066 6f72 6365 203a 2062 6f6f 6c2c     force : bool,
+00044dd0: 2064 6566 6175 6c74 2046 616c 7365 0a20   default False. 
+00044de0: 2020 2020 2020 2041 6c6c 6f77 7320 7468         Allows th
+00044df0: 6520 6578 7061 6e73 696f 6e20 6f66 2074  e expansion of t
+00044e00: 6865 2065 7869 7374 696e 6720 6469 7669  he existing divi
+00044e10: 7369 6f6e 732e 0a20 2020 2020 2020 2049  sions..        I
+00044e20: 6620 4661 6c73 6520 7468 656e 2074 6865  f False then the
+00044e30: 206e 6577 2064 6976 6973 696f 6e73 206c   new divisions l
+00044e40: 6f77 6572 2061 6e64 2075 7070 6572 2062  ower and upper b
+00044e50: 6f75 6e64 7320 6d75 7374 2062 650a 2020  ounds must be.  
+00044e60: 2020 2020 2020 7468 6520 7361 6d65 2061        the same a
+00044e70: 7320 7468 6520 6f6c 6420 6469 7669 7369  s the old divisi
+00044e80: 6f6e 732e 0a0a 2020 2020 4578 616d 706c  ons...    Exampl
+00044e90: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
+00044ea0: 0a20 2020 203e 3e3e 2064 6620 3d20 6466  .    >>> df = df
+00044eb0: 2e72 6570 6172 7469 7469 6f6e 285b 302c  .repartition([0,
+00044ec0: 2035 2c20 3130 2c20 3230 5d29 2020 2320   5, 10, 20])  # 
+00044ed0: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
+00044ee0: 2020 2020 416c 736f 2077 6f72 6b73 206f      Also works o
+00044ef0: 6e20 5061 6e64 6173 206f 626a 6563 7473  n Pandas objects
+00044f00: 0a0a 2020 2020 3e3e 3e20 6464 6620 3d20  ..    >>> ddf = 
+00044f10: 6464 2e72 6570 6172 7469 7469 6f6e 2864  dd.repartition(d
+00044f20: 662c 205b 302c 2035 2c20 3130 2c20 3230  f, [0, 5, 10, 20
+00044f30: 5d29 2020 2320 646f 6374 6573 743a 202b  ])  # doctest: +
+00044f40: 534b 4950 0a20 2020 2022 2222 0a0a 2020  SKIP.    """..  
+00044f50: 2020 2320 6e6f 2d6f 7020 6661 7374 7061    # no-op fastpa
+00044f60: 7468 2066 6f72 2077 6865 6e20 7765 2061  th for when we a
+00044f70: 6c72 6561 6479 2068 6176 6520 6d61 7463  lready have matc
+00044f80: 6869 6e67 2064 6976 6973 696f 6e73 0a20  hing divisions. 
+00044f90: 2020 2069 6620 6973 5f64 6173 6b5f 636f     if is_dask_co
+00044fa0: 6c6c 6563 7469 6f6e 2864 6629 2061 6e64  llection(df) and
+00044fb0: 2064 662e 6469 7669 7369 6f6e 7320 3d3d   df.divisions ==
+00044fc0: 2064 6976 6973 696f 6e73 3a0a 2020 2020   divisions:.    
+00044fd0: 2020 2020 7265 7475 726e 2064 660a 0a20      return df.. 
+00044fe0: 2020 2074 6f6b 656e 203d 2074 6f6b 656e     token = token
+00044ff0: 697a 6528 6466 2c20 6469 7669 7369 6f6e  ize(df, division
+00045000: 7329 0a20 2020 2069 6620 6973 696e 7374  s).    if isinst
+00045010: 616e 6365 2864 662c 205f 4672 616d 6529  ance(df, _Frame)
+00045020: 3a0a 2020 2020 2020 2020 746d 7020 3d20  :.        tmp = 
+00045030: 2272 6570 6172 7469 7469 6f6e 2d73 706c  "repartition-spl
+00045040: 6974 2d22 202b 2074 6f6b 656e 0a20 2020  it-" + token.   
+00045050: 2020 2020 206f 7574 203d 2022 7265 7061       out = "repa
+00045060: 7274 6974 696f 6e2d 6d65 7267 652d 2220  rtition-merge-" 
+00045070: 2b20 746f 6b65 6e0a 2020 2020 2020 2020  + token.        
+00045080: 6473 6b20 3d20 7265 7061 7274 6974 696f  dsk = repartitio
+00045090: 6e5f 6469 7669 7369 6f6e 7328 0a20 2020  n_divisions(.   
+000450a0: 2020 2020 2020 2020 2064 662e 6469 7669           df.divi
+000450b0: 7369 6f6e 732c 2064 6976 6973 696f 6e73  sions, divisions
+000450c0: 2c20 6466 2e5f 6e61 6d65 2c20 746d 702c  , df._name, tmp,
+000450d0: 206f 7574 2c20 666f 7263 653d 666f 7263   out, force=forc
+000450e0: 650a 2020 2020 2020 2020 290a 2020 2020  e.        ).    
+000450f0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
+00045100: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+00045110: 636f 6c6c 6563 7469 6f6e 7328 6f75 742c  collections(out,
+00045120: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+00045130: 6573 3d5b 6466 5d29 0a20 2020 2020 2020  es=[df]).       
+00045140: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
+00045150: 626a 6563 7428 6772 6170 682c 206f 7574  bject(graph, out
+00045160: 2c20 6466 2e5f 6d65 7461 2c20 6469 7669  , df._meta, divi
+00045170: 7369 6f6e 7329 0a20 2020 2065 6c69 6620  sions).    elif 
+00045180: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+00045190: 6528 6466 2920 6f72 2069 735f 7365 7269  e(df) or is_seri
+000451a0: 6573 5f6c 696b 6528 6466 293a 0a20 2020  es_like(df):.   
+000451b0: 2020 2020 206e 616d 6520 3d20 2272 6570       name = "rep
+000451c0: 6172 7469 7469 6f6e 2d64 6174 6166 7261  artition-datafra
+000451d0: 6d65 2d22 202b 2074 6f6b 656e 0a20 2020  me-" + token.   
+000451e0: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
+000451f0: 6174 6166 7261 6d65 2e75 7469 6c73 2069  ataframe.utils i
+00045200: 6d70 6f72 7420 7368 6172 645f 6466 5f6f  mport shard_df_o
+00045210: 6e5f 696e 6465 780a 0a20 2020 2020 2020  n_index..       
+00045220: 2064 6673 203d 2073 6861 7264 5f64 665f   dfs = shard_df_
+00045230: 6f6e 5f69 6e64 6578 2864 662c 2064 6976  on_index(df, div
+00045240: 6973 696f 6e73 5b31 3a2d 315d 290a 2020  isions[1:-1]).  
+00045250: 2020 2020 2020 6473 6b20 3d20 7b28 6e61        dsk = {(na
+00045260: 6d65 2c20 6929 3a20 6466 2066 6f72 2069  me, i): df for i
+00045270: 2c20 6466 2069 6e20 656e 756d 6572 6174  , df in enumerat
+00045280: 6528 6466 7329 7d0a 2020 2020 2020 2020  e(dfs)}.        
+00045290: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
+000452a0: 6a65 6374 2864 736b 2c20 6e61 6d65 2c20  ject(dsk, name, 
+000452b0: 6466 2c20 6469 7669 7369 6f6e 7329 0a20  df, divisions). 
+000452c0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000452d0: 726f 7228 2244 6174 6120 6d75 7374 2062  ror("Data must b
+000452e0: 6520 4461 7461 4672 616d 6520 6f72 2053  e DataFrame or S
+000452f0: 6572 6965 7322 290a 0a0a 6465 6620 5f72  eries")...def _r
+00045300: 6564 7563 7469 6f6e 5f63 6875 6e6b 2878  eduction_chunk(x
+00045310: 2c20 6163 615f 6368 756e 6b3d 4e6f 6e65  , aca_chunk=None
+00045320: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00045330: 206f 203d 2061 6361 5f63 6875 6e6b 2878   o = aca_chunk(x
+00045340: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
+00045350: 2320 5265 7475 726e 2061 2064 6174 6166  # Return a dataf
+00045360: 7261 6d65 2073 6f20 7468 6174 2074 6865  rame so that the
+00045370: 2063 6f6e 6361 7465 6e61 7465 6420 7665   concatenated ve
+00045380: 7273 696f 6e20 6973 2061 6c73 6f20 6120  rsion is also a 
+00045390: 6461 7461 6672 616d 650a 2020 2020 6966  dataframe.    if
+000453a0: 206e 6f74 2069 735f 7365 7269 6573 5f6c   not is_series_l
+000453b0: 696b 6528 6f29 3a0a 2020 2020 2020 2020  ike(o):.        
+000453c0: 7265 7475 726e 206f 0a20 2020 2072 6573  return o.    res
+000453d0: 756c 7420 3d20 6f2e 746f 5f66 7261 6d65  ult = o.to_frame
+000453e0: 2829 2e54 0a20 2020 2069 6620 6f2e 6474  ().T.    if o.dt
+000453f0: 7970 652e 6b69 6e64 203d 3d20 224f 223a  ype.kind == "O":
+00045400: 0a20 2020 2020 2020 2023 2057 6173 2063  .        # Was c
+00045410: 6f65 7263 6564 2074 6f20 6f62 6a65 6374  oerced to object
+00045420: 2c20 736f 2063 6173 7420 6261 636b 0a20  , so cast back. 
+00045430: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00045440: 7375 6c74 2e69 6e66 6572 5f6f 626a 6563  sult.infer_objec
+00045450: 7473 2829 0a20 2020 2072 6574 7572 6e20  ts().    return 
+00045460: 7265 7375 6c74 0a0a 0a64 6566 205f 7265  result...def _re
+00045470: 6475 6374 696f 6e5f 636f 6d62 696e 6528  duction_combine(
+00045480: 782c 2061 6361 5f63 6f6d 6269 6e65 3d4e  x, aca_combine=N
+00045490: 6f6e 652c 202a 2a6b 7761 7267 7329 3a0a  one, **kwargs):.
+000454a0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000454b0: 6528 782c 206c 6973 7429 3a0a 2020 2020  e(x, list):.    
+000454c0: 2020 2020 7820 3d20 7064 2e53 6572 6965      x = pd.Serie
+000454d0: 7328 7829 0a20 2020 206f 203d 2061 6361  s(x).    o = aca
+000454e0: 5f63 6f6d 6269 6e65 2878 2c20 2a2a 6b77  _combine(x, **kw
+000454f0: 6172 6773 290a 2020 2020 2320 5265 7475  args).    # Retu
+00045500: 726e 2061 2064 6174 6166 7261 6d65 2073  rn a dataframe s
+00045510: 6f20 7468 6174 2074 6865 2063 6f6e 6361  o that the conca
+00045520: 7465 6e61 7465 6420 7665 7273 696f 6e20  tenated version 
+00045530: 6973 2061 6c73 6f20 6120 6461 7461 6672  is also a datafr
+00045540: 616d 650a 2020 2020 7265 7475 726e 206f  ame.    return o
+00045550: 2e74 6f5f 6672 616d 6528 292e 5420 6966  .to_frame().T if
+00045560: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
+00045570: 6f29 2065 6c73 6520 6f0a 0a0a 6465 6620  o) else o...def 
+00045580: 5f72 6564 7563 7469 6f6e 5f61 6767 7265  _reduction_aggre
+00045590: 6761 7465 2878 2c20 6163 615f 6167 6772  gate(x, aca_aggr
+000455a0: 6567 6174 653d 4e6f 6e65 2c20 2a2a 6b77  egate=None, **kw
+000455b0: 6172 6773 293a 0a20 2020 2069 6620 6973  args):.    if is
+000455c0: 696e 7374 616e 6365 2878 2c20 6c69 7374  instance(x, list
+000455d0: 293a 0a20 2020 2020 2020 2078 203d 2070  ):.        x = p
+000455e0: 642e 5365 7269 6573 2878 290a 2020 2020  d.Series(x).    
+000455f0: 7265 7475 726e 2061 6361 5f61 6767 7265  return aca_aggre
+00045600: 6761 7465 2878 2c20 2a2a 6b77 6172 6773  gate(x, **kwargs
+00045610: 290a 0a0a 6465 6620 6964 786d 6178 6d69  )...def idxmaxmi
+00045620: 6e5f 6368 756e 6b28 782c 2066 6e3d 4e6f  n_chunk(x, fn=No
+00045630: 6e65 2c20 736b 6970 6e61 3d54 7275 652c  ne, skipna=True,
+00045640: 206e 756d 6572 6963 5f6f 6e6c 793d 4661   numeric_only=Fa
+00045650: 6c73 6529 3a0a 2020 2020 6e75 6d65 7269  lse):.    numeri
+00045660: 635f 6f6e 6c79 5f6b 7761 7267 7320 3d20  c_only_kwargs = 
+00045670: 280a 2020 2020 2020 2020 7b7d 2069 6620  (.        {} if 
+00045680: 6e6f 7420 5041 4e44 4153 5f47 545f 3135  not PANDAS_GT_15
+00045690: 3020 6f72 2069 735f 7365 7269 6573 5f6c  0 or is_series_l
+000456a0: 696b 6528 7829 2065 6c73 6520 7b22 6e75  ike(x) else {"nu
+000456b0: 6d65 7269 635f 6f6e 6c79 223a 206e 756d  meric_only": num
+000456c0: 6572 6963 5f6f 6e6c 797d 0a20 2020 2029  eric_only}.    )
+000456d0: 0a20 2020 206d 696e 6d61 7820 3d20 226d  .    minmax = "m
+000456e0: 6178 2220 6966 2066 6e20 3d3d 2022 6964  ax" if fn == "id
+000456f0: 786d 6178 2220 656c 7365 2022 6d69 6e22  xmax" else "min"
+00045700: 0a20 2020 2069 6620 6c65 6e28 7829 203e  .    if len(x) >
+00045710: 2030 3a0a 2020 2020 2020 2020 6964 7820   0:.        idx 
+00045720: 3d20 6765 7461 7474 7228 782c 2066 6e29  = getattr(x, fn)
+00045730: 2873 6b69 706e 613d 736b 6970 6e61 2c20  (skipna=skipna, 
+00045740: 2a2a 6e75 6d65 7269 635f 6f6e 6c79 5f6b  **numeric_only_k
+00045750: 7761 7267 7329 0a20 2020 2020 2020 2076  wargs).        v
+00045760: 616c 7565 203d 2067 6574 6174 7472 2878  alue = getattr(x
+00045770: 2c20 6d69 6e6d 6178 2928 736b 6970 6e61  , minmax)(skipna
+00045780: 3d73 6b69 706e 612c 202a 2a6e 756d 6572  =skipna, **numer
+00045790: 6963 5f6f 6e6c 795f 6b77 6172 6773 290a  ic_only_kwargs).
+000457a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000457b0: 2020 6964 7820 3d20 7661 6c75 6520 3d20    idx = value = 
+000457c0: 6d65 7461 5f73 6572 6965 735f 636f 6e73  meta_series_cons
+000457d0: 7472 7563 746f 7228 7829 285b 5d2c 2064  tructor(x)([], d
+000457e0: 7479 7065 3d22 6938 2229 0a20 2020 2069  type="i8").    i
+000457f0: 6620 6973 5f73 6572 6965 735f 6c69 6b65  f is_series_like
+00045800: 2869 6478 293a 0a20 2020 2020 2020 2072  (idx):.        r
+00045810: 6574 7572 6e20 6d65 7461 5f66 7261 6d65  eturn meta_frame
+00045820: 5f63 6f6e 7374 7275 6374 6f72 2878 2928  _constructor(x)(
+00045830: 7b22 6964 7822 3a20 6964 782c 2022 7661  {"idx": idx, "va
+00045840: 6c75 6522 3a20 7661 6c75 657d 290a 2020  lue": value}).  
+00045850: 2020 7265 7475 726e 206d 6574 615f 6672    return meta_fr
+00045860: 616d 655f 636f 6e73 7472 7563 746f 7228  ame_constructor(
+00045870: 7829 287b 2269 6478 223a 205b 6964 785d  x)({"idx": [idx]
+00045880: 2c20 2276 616c 7565 223a 205b 7661 6c75  , "value": [valu
+00045890: 655d 7d29 0a0a 0a64 6566 2069 6478 6d61  e]})...def idxma
+000458a0: 786d 696e 5f72 6f77 2878 2c20 666e 3d4e  xmin_row(x, fn=N
+000458b0: 6f6e 652c 2073 6b69 706e 613d 5472 7565  one, skipna=True
+000458c0: 293a 0a20 2020 206d 696e 6d61 7820 3d20  ):.    minmax = 
+000458d0: 226d 6178 2220 6966 2066 6e20 3d3d 2022  "max" if fn == "
+000458e0: 6964 786d 6178 2220 656c 7365 2022 6d69  idxmax" else "mi
+000458f0: 6e22 0a20 2020 2069 6620 6c65 6e28 7829  n".    if len(x)
+00045900: 203e 2030 3a0a 2020 2020 2020 2020 7820   > 0:.        x 
+00045910: 3d20 782e 7365 745f 696e 6465 7828 2269  = x.set_index("i
+00045920: 6478 2229 0a20 2020 2020 2020 2023 2070  dx").        # p
+00045930: 6f74 656e 7469 616c 6c79 2063 6f65 7263  otentially coerc
+00045940: 6564 2074 6f20 6f62 6a65 6374 2c20 736f  ed to object, so
+00045950: 2063 6173 7420 6261 636b 0a20 2020 2020   cast back.     
+00045960: 2020 2076 616c 7565 203d 2078 2e76 616c     value = x.val
+00045970: 7565 2e69 6e66 6572 5f6f 626a 6563 7473  ue.infer_objects
+00045980: 2829 0a20 2020 2020 2020 2069 6478 203d  ().        idx =
+00045990: 205b 6765 7461 7474 7228 7661 6c75 652c   [getattr(value,
+000459a0: 2066 6e29 2873 6b69 706e 613d 736b 6970   fn)(skipna=skip
+000459b0: 6e61 295d 0a20 2020 2020 2020 2076 616c  na)].        val
+000459c0: 7565 203d 205b 6765 7461 7474 7228 7661  ue = [getattr(va
+000459d0: 6c75 652c 206d 696e 6d61 7829 2873 6b69  lue, minmax)(ski
+000459e0: 706e 613d 736b 6970 6e61 295d 0a20 2020  pna=skipna)].   
+000459f0: 2065 6c73 653a 0a20 2020 2020 2020 2069   else:.        i
+00045a00: 6478 203d 2076 616c 7565 203d 206d 6574  dx = value = met
+00045a10: 615f 7365 7269 6573 5f63 6f6e 7374 7275  a_series_constru
+00045a20: 6374 6f72 2878 2928 5b5d 2c20 6474 7970  ctor(x)([], dtyp
+00045a30: 653d 2269 3822 290a 2020 2020 7265 7475  e="i8").    retu
+00045a40: 726e 206d 6574 615f 6672 616d 655f 636f  rn meta_frame_co
+00045a50: 6e73 7472 7563 746f 7228 7829 280a 2020  nstructor(x)(.  
+00045a60: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+00045a70: 2020 2020 2269 6478 223a 206d 6574 615f      "idx": meta_
+00045a80: 7365 7269 6573 5f63 6f6e 7374 7275 6374  series_construct
+00045a90: 6f72 2878 2928 6964 782c 2064 7479 7065  or(x)(idx, dtype
+00045aa0: 3d78 2e69 6e64 6578 2e64 7479 7065 292c  =x.index.dtype),
+00045ab0: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
+00045ac0: 6c75 6522 3a20 6d65 7461 5f73 6572 6965  lue": meta_serie
+00045ad0: 735f 636f 6e73 7472 7563 746f 7228 7829  s_constructor(x)
+00045ae0: 2876 616c 7565 2c20 6474 7970 653d 782e  (value, dtype=x.
+00045af0: 6474 7970 6573 2e69 6c6f 635b 305d 292c  dtypes.iloc[0]),
+00045b00: 0a20 2020 2020 2020 207d 0a20 2020 2029  .        }.    )
+00045b10: 0a0a 0a64 6566 2069 6478 6d61 786d 696e  ...def idxmaxmin
+00045b20: 5f63 6f6d 6269 6e65 2878 2c20 666e 3d4e  _combine(x, fn=N
+00045b30: 6f6e 652c 2073 6b69 706e 613d 5472 7565  one, skipna=True
+00045b40: 293a 0a20 2020 2069 6620 6c65 6e28 7829  ):.    if len(x)
+00045b50: 203c 3d20 313a 0a20 2020 2020 2020 2072   <= 1:.        r
+00045b60: 6574 7572 6e20 780a 2020 2020 7265 7475  eturn x.    retu
+00045b70: 726e 2028 0a20 2020 2020 2020 2078 2e67  rn (.        x.g
+00045b80: 726f 7570 6279 286c 6576 656c 3d30 290a  roupby(level=0).
+00045b90: 2020 2020 2020 2020 2e61 7070 6c79 2869          .apply(i
+00045ba0: 6478 6d61 786d 696e 5f72 6f77 2c20 666e  dxmaxmin_row, fn
+00045bb0: 3d66 6e2c 2073 6b69 706e 613d 736b 6970  =fn, skipna=skip
+00045bc0: 6e61 290a 2020 2020 2020 2020 2e72 6573  na).        .res
+00045bd0: 6574 5f69 6e64 6578 286c 6576 656c 3d31  et_index(level=1
+00045be0: 2c20 6472 6f70 3d54 7275 6529 0a20 2020  , drop=True).   
+00045bf0: 2029 0a0a 0a64 6566 2069 6478 6d61 786d   )...def idxmaxm
+00045c00: 696e 5f61 6767 2878 2c20 666e 3d4e 6f6e  in_agg(x, fn=Non
+00045c10: 652c 2073 6b69 706e 613d 5472 7565 2c20  e, skipna=True, 
+00045c20: 7363 616c 6172 3d46 616c 7365 2c20 6e75  scalar=False, nu
+00045c30: 6d65 7269 635f 6f6e 6c79 3d6e 6f5f 6465  meric_only=no_de
+00045c40: 6661 756c 7429 3a0a 2020 2020 7265 7320  fault):.    res 
+00045c50: 3d20 6964 786d 6178 6d69 6e5f 636f 6d62  = idxmaxmin_comb
+00045c60: 696e 6528 782c 2066 6e2c 2073 6b69 706e  ine(x, fn, skipn
+00045c70: 613d 736b 6970 6e61 295b 2269 6478 225d  a=skipna)["idx"]
+00045c80: 0a20 2020 2069 6620 6c65 6e28 7265 7329  .    if len(res)
+00045c90: 203d 3d20 303a 0a20 2020 2020 2020 2072   == 0:.        r
+00045ca0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00045cb0: 2261 7474 656d 7074 2074 6f20 6765 7420  "attempt to get 
+00045cc0: 6172 676d 6178 206f 6620 616e 2065 6d70  argmax of an emp
+00045cd0: 7479 2073 6571 7565 6e63 6522 290a 2020  ty sequence").  
+00045ce0: 2020 6966 2073 6361 6c61 723a 0a20 2020    if scalar:.   
+00045cf0: 2020 2020 2072 6574 7572 6e20 7265 735b       return res[
+00045d00: 305d 0a20 2020 2072 6573 2e6e 616d 6520  0].    res.name 
+00045d10: 3d20 4e6f 6e65 0a20 2020 2072 6574 7572  = None.    retur
+00045d20: 6e20 7265 730a 0a0a 6465 6620 5f6d 6f64  n res...def _mod
+00045d30: 655f 6167 6772 6567 6174 6528 6466 2c20  e_aggregate(df, 
+00045d40: 6472 6f70 6e61 293a 0a20 2020 2076 616c  dropna):.    val
+00045d50: 7565 5f63 6f75 6e74 5f73 6572 6965 7320  ue_count_series 
+00045d60: 3d20 6466 2e73 756d 2829 0a20 2020 206d  = df.sum().    m
+00045d70: 6178 5f76 616c 203d 2076 616c 7565 5f63  ax_val = value_c
+00045d80: 6f75 6e74 5f73 6572 6965 732e 6d61 7828  ount_series.max(
+00045d90: 736b 6970 6e61 3d64 726f 706e 6129 0a20  skipna=dropna). 
+00045da0: 2020 206d 6f64 655f 7365 7269 6573 203d     mode_series =
+00045db0: 2028 0a20 2020 2020 2020 2076 616c 7565   (.        value
+00045dc0: 5f63 6f75 6e74 5f73 6572 6965 735b 7661  _count_series[va
+00045dd0: 6c75 655f 636f 756e 745f 7365 7269 6573  lue_count_series
+00045de0: 203d 3d20 6d61 785f 7661 6c5d 0a20 2020   == max_val].   
+00045df0: 2020 2020 202e 696e 6465 782e 746f 5f73       .index.to_s
+00045e00: 6572 6965 7328 290a 2020 2020 2020 2020  eries().        
+00045e10: 2e73 6f72 745f 7661 6c75 6573 2829 0a20  .sort_values(). 
+00045e20: 2020 2020 2020 202e 7265 7365 745f 696e         .reset_in
+00045e30: 6465 7828 6472 6f70 3d54 7275 6529 0a20  dex(drop=True). 
+00045e40: 2020 2029 0a20 2020 2072 6574 7572 6e20     ).    return 
+00045e50: 6d6f 6465 5f73 6572 6965 730a 0a0a 6465  mode_series...de
+00045e60: 6620 5f63 6f75 6e74 5f61 6767 7265 6761  f _count_aggrega
+00045e70: 7465 2878 293a 0a20 2020 2072 6574 7572  te(x):.    retur
+00045e80: 6e20 782e 7375 6d28 292e 6173 7479 7065  n x.sum().astype
+00045e90: 2822 696e 7436 3422 290a 0a0a 6465 6620  ("int64")...def 
+00045ea0: 7361 6665 5f68 6561 6428 6466 2c20 6e29  safe_head(df, n)
+00045eb0: 3a0a 2020 2020 7220 3d20 4d2e 6865 6164  :.    r = M.head
+00045ec0: 2864 662c 206e 290a 2020 2020 6966 206c  (df, n).    if l
+00045ed0: 656e 2872 2920 213d 206e 3a0a 2020 2020  en(r) != n:.    
+00045ee0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00045ef0: 6e28 0a20 2020 2020 2020 2020 2020 2066  n(.            f
+00045f00: 2249 6e73 7566 6669 6369 656e 7420 656c  "Insufficient el
+00045f10: 656d 656e 7473 2066 6f72 2060 6865 6164  ements for `head
+00045f20: 602e 207b 6e7d 2065 6c65 6d65 6e74 7320  `. {n} elements 
+00045f30: 7265 7175 6573 7465 642c 206f 6e6c 7920  requested, only 
+00045f40: 7b6c 656e 2872 297d 2022 0a20 2020 2020  {len(r)} ".     
+00045f50: 2020 2020 2020 2022 656c 656d 656e 7473         "elements
+00045f60: 2061 7661 696c 6162 6c65 2e20 5472 7920   available. Try 
+00045f70: 7061 7373 696e 6720 6c61 7267 6572 2060  passing larger `
+00045f80: 6e70 6172 7469 7469 6f6e 7360 2074 6f20  npartitions` to 
+00045f90: 6068 6561 6460 2e22 0a20 2020 2020 2020  `head`.".       
+00045fa0: 2029 0a20 2020 2072 6574 7572 6e20 720a   ).    return r.
+00045fb0: 0a0a 6465 6620 6d61 7962 655f 7368 6966  ..def maybe_shif
+00045fc0: 745f 6469 7669 7369 6f6e 7328 6466 2c20  t_divisions(df, 
+00045fd0: 7065 7269 6f64 732c 2066 7265 7129 3a0a  periods, freq):.
+00045fe0: 2020 2020 2222 224d 6179 6265 2073 6869      """Maybe shi
+00045ff0: 6674 2064 6976 6973 696f 6e73 2062 7920  ft divisions by 
+00046000: 7065 7269 6f64 7320 6f66 2073 697a 6520  periods of size 
+00046010: 6672 6571 0a0a 2020 2020 5573 6564 2074  freq..    Used t
+00046020: 6f20 7368 6966 7420 7468 6520 6469 7669  o shift the divi
+00046030: 7369 6f6e 7320 666f 7220 7468 6520 6073  sions for the `s
+00046040: 6869 6674 6020 6d65 7468 6f64 2e20 4966  hift` method. If
+00046050: 2066 7265 7120 6973 6e27 7420 6120 6669   freq isn't a fi
+00046060: 7865 640a 2020 2020 7369 7a65 2028 6e6f  xed.    size (no
+00046070: 7420 616e 6368 6f72 6564 206f 7220 7265  t anchored or re
+00046080: 6c61 7469 7665 292c 2074 6865 6e20 7468  lative), then th
+00046090: 6520 6469 7669 7369 6f6e 7320 6172 6520  e divisions are 
+000460a0: 7368 6966 7465 640a 2020 2020 6170 7072  shifted.    appr
+000460b0: 6f70 7269 6174 656c 792e 204f 7468 6572  opriately. Other
+000460c0: 7769 7365 2074 6865 2064 6976 6973 696f  wise the divisio
+000460d0: 6e73 2061 7265 2063 6c65 6172 6564 2e0a  ns are cleared..
+000460e0: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+000460f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00046100: 2020 2064 6620 3a20 6464 2e44 6174 6146     df : dd.DataF
+00046110: 7261 6d65 2c20 6464 2e53 6572 6965 732c  rame, dd.Series,
+00046120: 206f 7220 6464 2e49 6e64 6578 0a20 2020   or dd.Index.   
+00046130: 2070 6572 696f 6473 203a 2069 6e74 0a20   periods : int. 
+00046140: 2020 2020 2020 2054 6865 206e 756d 6265         The numbe
+00046150: 7220 6f66 2070 6572 696f 6473 2074 6f20  r of periods to 
+00046160: 7368 6966 742e 0a20 2020 2066 7265 7120  shift..    freq 
+00046170: 3a20 4461 7465 4f66 6673 6574 2c20 7469  : DateOffset, ti
+00046180: 6d65 6465 6c74 612c 206f 7220 7469 6d65  medelta, or time
+00046190: 2072 756c 6520 7374 7269 6e67 0a20 2020   rule string.   
+000461a0: 2020 2020 2054 6865 2066 7265 7175 656e       The frequen
+000461b0: 6379 2074 6f20 7368 6966 7420 6279 2e0a  cy to shift by..
+000461c0: 2020 2020 2222 220a 2020 2020 6966 2069      """.    if i
+000461d0: 7369 6e73 7461 6e63 6528 6672 6571 2c20  sinstance(freq, 
+000461e0: 7374 7229 3a0a 2020 2020 2020 2020 6672  str):.        fr
+000461f0: 6571 203d 2070 642e 7473 6572 6965 732e  eq = pd.tseries.
+00046200: 6672 6571 7565 6e63 6965 732e 746f 5f6f  frequencies.to_o
+00046210: 6666 7365 7428 6672 6571 290a 0a20 2020  ffset(freq)..   
+00046220: 2069 735f 6f66 6673 6574 203d 2069 7369   is_offset = isi
+00046230: 6e73 7461 6e63 6528 6672 6571 2c20 7064  nstance(freq, pd
+00046240: 2e44 6174 654f 6666 7365 7429 0a20 2020  .DateOffset).   
+00046250: 2069 6620 6973 5f6f 6666 7365 743a 0a20   if is_offset:. 
+00046260: 2020 2020 2020 2069 6620 6672 6571 2e69         if freq.i
+00046270: 735f 616e 6368 6f72 6564 2829 206f 7220  s_anchored() or 
+00046280: 6e6f 7420 6861 7361 7474 7228 6672 6571  not hasattr(freq
+00046290: 2c20 2264 656c 7461 2229 3a0a 2020 2020  , "delta"):.    
+000462a0: 2020 2020 2020 2020 2320 4361 6e27 7420          # Can't 
+000462b0: 696e 6665 7220 6469 7669 7369 6f6e 7320  infer divisions 
+000462c0: 6f6e 2072 656c 6174 6976 6520 6f72 2061  on relative or a
+000462d0: 6e63 686f 7265 6420 6f66 6673 6574 732c  nchored offsets,
+000462e0: 2061 730a 2020 2020 2020 2020 2020 2020   as.            
+000462f0: 2320 6469 7669 7369 6f6e 7320 6d61 7920  # divisions may 
+00046300: 6e6f 7720 7370 6c69 7420 6964 656e 7469  now split identi
+00046310: 6361 6c20 696e 6465 7820 7661 6c75 652e  cal index value.
+00046320: 0a20 2020 2020 2020 2020 2020 2023 2028  .            # (
+00046330: 652e 672e 2069 6e64 6578 5f70 6172 7469  e.g. index_parti
+00046340: 7469 6f6e 7320 3d20 5b5b 312c 2032 2c20  tions = [[1, 2, 
+00046350: 335d 2c20 5b33 2c20 342c 2035 5d5d 290a  3], [3, 4, 5]]).
+00046360: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00046370: 726e 2064 662e 636c 6561 725f 6469 7669  rn df.clear_divi
+00046380: 7369 6f6e 7328 290a 2020 2020 6966 2064  sions().    if d
+00046390: 662e 6b6e 6f77 6e5f 6469 7669 7369 6f6e  f.known_division
+000463a0: 733a 0a20 2020 2020 2020 2064 6976 7320  s:.        divs 
+000463b0: 3d20 7064 2e53 6572 6965 7328 7261 6e67  = pd.Series(rang
+000463c0: 6528 6c65 6e28 6466 2e64 6976 6973 696f  e(len(df.divisio
+000463d0: 6e73 2929 2c20 696e 6465 783d 6466 2e64  ns)), index=df.d
+000463e0: 6976 6973 696f 6e73 290a 2020 2020 2020  ivisions).      
+000463f0: 2020 6469 7669 7369 6f6e 7320 3d20 6469    divisions = di
+00046400: 7673 2e73 6869 6674 2870 6572 696f 6473  vs.shift(periods
+00046410: 2c20 6672 6571 3d66 7265 7129 2e69 6e64  , freq=freq).ind
+00046420: 6578 0a20 2020 2020 2020 2072 6574 7572  ex.        retur
+00046430: 6e20 6466 2e5f 5f63 6c61 7373 5f5f 2864  n df.__class__(d
+00046440: 662e 6461 736b 2c20 6466 2e5f 6e61 6d65  f.dask, df._name
+00046450: 2c20 6466 2e5f 6d65 7461 2c20 6469 7669  , df._meta, divi
+00046460: 7369 6f6e 7329 0a20 2020 2072 6574 7572  sions).    retur
+00046470: 6e20 6466 0a0a 0a40 7772 6170 7328 7064  n df...@wraps(pd
+00046480: 2e74 6f5f 6461 7465 7469 6d65 290a 6465  .to_datetime).de
+00046490: 6620 746f 5f64 6174 6574 696d 6528 6172  f to_datetime(ar
+000464a0: 672c 206d 6574 613d 4e6f 6e65 2c20 2a2a  g, meta=None, **
+000464b0: 6b77 6172 6773 293a 0a20 2020 2074 7a5f  kwargs):.    tz_
+000464c0: 6b77 6172 6720 3d20 7b22 747a 223a 2022  kwarg = {"tz": "
+000464d0: 7574 6322 7d20 6966 206b 7761 7267 732e  utc"} if kwargs.
+000464e0: 6765 7428 2275 7463 2229 2065 6c73 6520  get("utc") else 
+000464f0: 7b7d 0a20 2020 2069 6620 6d65 7461 2069  {}.    if meta i
+00046500: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00046510: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
+00046520: 672c 2049 6e64 6578 293a 0a20 2020 2020  g, Index):.     
+00046530: 2020 2020 2020 206d 6574 6120 3d20 6765         meta = ge
+00046540: 745f 6d65 7461 5f6c 6962 7261 7279 2861  t_meta_library(a
+00046550: 7267 292e 4461 7465 7469 6d65 496e 6465  rg).DatetimeInde
+00046560: 7828 5b5d 2c20 2a2a 747a 5f6b 7761 7267  x([], **tz_kwarg
+00046570: 290a 2020 2020 2020 2020 2020 2020 6d65  ).            me
+00046580: 7461 2e6e 616d 6520 3d20 6172 672e 6e61  ta.name = arg.na
+00046590: 6d65 0a20 2020 2020 2020 2065 6c69 6620  me.        elif 
+000465a0: 6e6f 7420 2869 735f 6461 7461 6672 616d  not (is_datafram
+000465b0: 655f 6c69 6b65 2861 7267 2920 6f72 2069  e_like(arg) or i
+000465c0: 735f 7365 7269 6573 5f6c 696b 6528 6172  s_series_like(ar
+000465d0: 6729 293a 0a20 2020 2020 2020 2020 2020  g)):.           
+000465e0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+000465f0: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
+00046600: 2020 2020 2020 2020 2020 2020 2264 6173              "das
+00046610: 6b2e 6461 7461 6672 616d 652e 746f 5f64  k.dataframe.to_d
+00046620: 6174 6574 696d 6520 646f 6573 206e 6f74  atetime does not
+00046630: 2073 7570 706f 7274 2022 0a20 2020 2020   support ".     
+00046640: 2020 2020 2020 2020 2020 2022 6e6f 6e2d             "non-
+00046650: 696e 6465 782d 6162 6c65 2061 7267 756d  index-able argum
+00046660: 656e 7473 2028 6c69 6b65 2073 6361 6c61  ents (like scala
+00046670: 7273 2922 0a20 2020 2020 2020 2020 2020  rs)".           
+00046680: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
+00046690: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+000466a0: 6120 3d20 6d65 7461 5f73 6572 6965 735f  a = meta_series_
+000466b0: 636f 6e73 7472 7563 746f 7228 6172 6729  constructor(arg)
+000466c0: 285b 7064 2e54 696d 6573 7461 6d70 2822  ([pd.Timestamp("
+000466d0: 3230 3030 222c 202a 2a74 7a5f 6b77 6172  2000", **tz_kwar
+000466e0: 6729 5d29 0a20 2020 2020 2020 2020 2020  g)]).           
+000466f0: 206d 6574 612e 696e 6465 7820 3d20 6d65   meta.index = me
+00046700: 7461 2e69 6e64 6578 2e61 7374 7970 6528  ta.index.astype(
+00046710: 6172 672e 696e 6465 782e 6474 7970 6529  arg.index.dtype)
+00046720: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+00046730: 612e 696e 6465 782e 6e61 6d65 203d 2061  a.index.name = a
+00046740: 7267 2e69 6e64 6578 2e6e 616d 650a 2020  rg.index.name.  
+00046750: 2020 6966 2050 414e 4441 535f 4754 5f32    if PANDAS_GT_2
+00046760: 3030 2061 6e64 2022 696e 6665 725f 6461  00 and "infer_da
+00046770: 7465 7469 6d65 5f66 6f72 6d61 7422 2069  tetime_format" i
+00046780: 6e20 6b77 6172 6773 3a0a 2020 2020 2020  n kwargs:.      
+00046790: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+000467a0: 0a20 2020 2020 2020 2020 2020 2022 5468  .            "Th
+000467b0: 6520 6172 6775 6d65 6e74 2027 696e 6665  e argument 'infe
+000467c0: 725f 6461 7465 7469 6d65 5f66 6f72 6d61  r_datetime_forma
+000467d0: 7427 2069 7320 6465 7072 6563 6174 6564  t' is deprecated
+000467e0: 2061 6e64 2077 696c 6c20 6265 2072 656d   and will be rem
+000467f0: 6f76 6564 2069 6e20 6120 6675 7475 7265  oved in a future
+00046800: 2076 6572 7369 6f6e 2e20 220a 2020 2020   version. ".    
+00046810: 2020 2020 2020 2020 2241 2073 7472 6963          "A stric
+00046820: 7420 7665 7273 696f 6e20 6f66 2069 7420  t version of it 
+00046830: 6973 206e 6f77 2074 6865 2064 6566 6175  is now the defau
+00046840: 6c74 2c20 7365 6520 220a 2020 2020 2020  lt, see ".      
+00046850: 2020 2020 2020 2268 7474 7073 3a2f 2f70        "https://p
+00046860: 616e 6461 732e 7079 6461 7461 2e6f 7267  andas.pydata.org
+00046870: 2f70 6465 7073 2f30 3030 342d 636f 6e73  /pdeps/0004-cons
+00046880: 6973 7465 6e74 2d74 6f2d 6461 7465 7469  istent-to-dateti
+00046890: 6d65 2d70 6172 7369 6e67 2e68 746d 6c2e  me-parsing.html.
+000468a0: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+000468b0: 596f 7520 6361 6e20 7361 6665 6c79 2072  You can safely r
+000468c0: 656d 6f76 6520 7468 6973 2061 7267 756d  emove this argum
+000468d0: 656e 742e 222c 0a20 2020 2020 2020 2020  ent.",.         
+000468e0: 2020 2055 7365 7257 6172 6e69 6e67 2c0a     UserWarning,.
+000468f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00046900: 2020 6b77 6172 6773 2e70 6f70 2822 696e    kwargs.pop("in
+00046910: 6665 725f 6461 7465 7469 6d65 5f66 6f72  fer_datetime_for
+00046920: 6d61 7422 290a 0a20 2020 2072 6574 7572  mat")..    retur
+00046930: 6e20 6d61 705f 7061 7274 6974 696f 6e73  n map_partitions
+00046940: 2867 6574 5f6d 6574 615f 6c69 6272 6172  (get_meta_librar
+00046950: 7928 6172 6729 2e74 6f5f 6461 7465 7469  y(arg).to_dateti
+00046960: 6d65 2c20 6172 672c 206d 6574 613d 6d65  me, arg, meta=me
+00046970: 7461 2c20 2a2a 6b77 6172 6773 290a 0a0a  ta, **kwargs)...
+00046980: 4077 7261 7073 2870 642e 746f 5f74 696d  @wraps(pd.to_tim
+00046990: 6564 656c 7461 290a 6465 6620 746f 5f74  edelta).def to_t
+000469a0: 696d 6564 656c 7461 2861 7267 2c20 756e  imedelta(arg, un
+000469b0: 6974 3d4e 6f6e 652c 2065 7272 6f72 733d  it=None, errors=
+000469c0: 2272 6169 7365 2229 3a0a 2020 2020 6d65  "raise"):.    me
+000469d0: 7461 203d 206d 6574 615f 7365 7269 6573  ta = meta_series
+000469e0: 5f63 6f6e 7374 7275 6374 6f72 2861 7267  _constructor(arg
+000469f0: 2928 5b70 642e 5469 6d65 6465 6c74 6128  )([pd.Timedelta(
+00046a00: 312c 2075 6e69 743d 756e 6974 295d 290a  1, unit=unit)]).
+00046a10: 2020 2020 7265 7475 726e 206d 6170 5f70      return map_p
+00046a20: 6172 7469 7469 6f6e 7328 7064 2e74 6f5f  artitions(pd.to_
+00046a30: 7469 6d65 6465 6c74 612c 2061 7267 2c20  timedelta, arg, 
+00046a40: 756e 6974 3d75 6e69 742c 2065 7272 6f72  unit=unit, error
+00046a50: 733d 6572 726f 7273 2c20 6d65 7461 3d6d  s=errors, meta=m
+00046a60: 6574 6129 0a0a 0a69 6620 6861 7361 7474  eta)...if hasatt
+00046a70: 7228 7064 2c20 2269 736e 6122 293a 0a0a  r(pd, "isna"):..
+00046a80: 2020 2020 4077 7261 7073 2870 642e 6973      @wraps(pd.is
+00046a90: 6e61 290a 2020 2020 6465 6620 6973 6e61  na).    def isna
+00046aa0: 2861 7267 293a 0a20 2020 2020 2020 2072  (arg):.        r
+00046ab0: 6574 7572 6e20 6d61 705f 7061 7274 6974  eturn map_partit
+00046ac0: 696f 6e73 2870 642e 6973 6e61 2c20 6172  ions(pd.isna, ar
+00046ad0: 6729 0a0a 0a64 6566 205f 7265 7072 5f64  g)...def _repr_d
+00046ae0: 6174 615f 7365 7269 6573 2873 2c20 696e  ata_series(s, in
+00046af0: 6465 7829 3a0a 2020 2020 2222 2241 2068  dex):.    """A h
+00046b00: 656c 7065 7220 666f 7220 6372 6561 7469  elper for creati
+00046b10: 6e67 2074 6865 2060 605f 7265 7072 5f64  ng the ``_repr_d
+00046b20: 6174 6160 6020 7072 6f70 6572 7479 2222  ata`` property""
+00046b30: 220a 2020 2020 6e70 6172 7469 7469 6f6e  ".    npartition
+00046b40: 7320 3d20 6c65 6e28 696e 6465 7829 202d  s = len(index) -
+00046b50: 2031 0a20 2020 2069 6620 6973 696e 7374   1.    if isinst
+00046b60: 616e 6365 2873 2e64 7479 7065 2c20 7064  ance(s.dtype, pd
+00046b70: 2e43 6174 6567 6f72 6963 616c 4474 7970  .CategoricalDtyp
+00046b80: 6529 3a0a 2020 2020 2020 2020 6966 2068  e):.        if h
+00046b90: 6173 5f6b 6e6f 776e 5f63 6174 6567 6f72  as_known_categor
+00046ba0: 6965 7328 7329 3a0a 2020 2020 2020 2020  ies(s):.        
+00046bb0: 2020 2020 6474 7970 6520 3d20 2263 6174      dtype = "cat
+00046bc0: 6567 6f72 795b 6b6e 6f77 6e5d 220a 2020  egory[known]".  
+00046bd0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00046be0: 2020 2020 2020 2020 6474 7970 6520 3d20          dtype = 
+00046bf0: 2263 6174 6567 6f72 795b 756e 6b6e 6f77  "category[unknow
+00046c00: 6e5d 220a 2020 2020 656c 7365 3a0a 2020  n]".    else:.  
+00046c10: 2020 2020 2020 6474 7970 6520 3d20 7374        dtype = st
+00046c20: 7228 732e 6474 7970 6529 0a20 2020 2072  r(s.dtype).    r
+00046c30: 6574 7572 6e20 7064 2e53 6572 6965 7328  eturn pd.Series(
+00046c40: 5b64 7479 7065 5d20 2b20 5b22 2e2e 2e22  [dtype] + ["..."
+00046c50: 5d20 2a20 6e70 6172 7469 7469 6f6e 732c  ] * npartitions,
+00046c60: 2069 6e64 6578 3d69 6e64 6578 2c20 6e61   index=index, na
+00046c70: 6d65 3d73 2e6e 616d 6529 0a0a 0a64 6566  me=s.name)...def
+00046c80: 2068 6173 5f70 6172 616c 6c65 6c5f 7479   has_parallel_ty
+00046c90: 7065 2878 293a 0a20 2020 2022 2222 446f  pe(x):.    """Do
+00046ca0: 6573 2074 6869 7320 6f62 6a65 6374 2068  es this object h
+00046cb0: 6176 6520 6120 6461 736b 2064 6174 6166  ave a dask dataf
+00046cc0: 7261 6d65 2065 7175 6976 616c 656e 743f  rame equivalent?
+00046cd0: 2222 220a 2020 2020 7265 7475 726e 2067  """.    return g
+00046ce0: 6574 5f70 6172 616c 6c65 6c5f 7479 7065  et_parallel_type
+00046cf0: 2878 2920 6973 206e 6f74 2053 6361 6c61  (x) is not Scala
+00046d00: 720a 0a0a 6465 6620 6e65 775f 6464 5f6f  r...def new_dd_o
+00046d10: 626a 6563 7428 6473 6b2c 206e 616d 652c  bject(dsk, name,
+00046d20: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
+00046d30: 2c20 7061 7265 6e74 5f6d 6574 613d 4e6f  , parent_meta=No
+00046d40: 6e65 293a 0a20 2020 2022 2222 4765 6e65  ne):.    """Gene
+00046d50: 7269 6320 636f 6e73 7472 7563 746f 7220  ric constructor 
+00046d60: 666f 7220 6461 736b 2e64 6174 6166 7261  for dask.datafra
+00046d70: 6d65 206f 626a 6563 7473 2e0a 0a20 2020  me objects...   
+00046d80: 2044 6563 6964 6573 2074 6865 2061 7070   Decides the app
+00046d90: 726f 7072 6961 7465 206f 7574 7075 7420  ropriate output 
+00046da0: 636c 6173 7320 6261 7365 6420 6f6e 2074  class based on t
+00046db0: 6865 2074 7970 6520 6f66 2060 6d65 7461  he type of `meta
+00046dc0: 6020 7072 6f76 6964 6564 2e0a 2020 2020  ` provided..    
+00046dd0: 2222 220a 2020 2020 6966 2068 6173 5f70  """.    if has_p
+00046de0: 6172 616c 6c65 6c5f 7479 7065 286d 6574  arallel_type(met
+00046df0: 6129 3a0a 2020 2020 2020 2020 7265 7475  a):.        retu
+00046e00: 726e 2067 6574 5f70 6172 616c 6c65 6c5f  rn get_parallel_
+00046e10: 7479 7065 286d 6574 6129 2864 736b 2c20  type(meta)(dsk, 
+00046e20: 6e61 6d65 2c20 6d65 7461 2c20 6469 7669  name, meta, divi
+00046e30: 7369 6f6e 7329 0a20 2020 2065 6c69 6620  sions).    elif 
+00046e40: 6973 5f61 7272 6179 6c69 6b65 286d 6574  is_arraylike(met
+00046e50: 6129 2061 6e64 206d 6574 612e 7368 6170  a) and meta.shap
+00046e60: 653a 0a20 2020 2020 2020 2069 6d70 6f72  e:.        impor
+00046e70: 7420 6461 736b 2e61 7272 6179 2061 7320  t dask.array as 
+00046e80: 6461 0a0a 2020 2020 2020 2020 6368 756e  da..        chun
+00046e90: 6b73 203d 2028 286e 702e 6e61 6e2c 2920  ks = ((np.nan,) 
+00046ea0: 2a20 286c 656e 2864 6976 6973 696f 6e73  * (len(divisions
+00046eb0: 2920 2d20 3129 2c29 202b 2074 7570 6c65  ) - 1),) + tuple
+00046ec0: 280a 2020 2020 2020 2020 2020 2020 2864  (.            (d
+00046ed0: 2c29 2066 6f72 2064 2069 6e20 6d65 7461  ,) for d in meta
+00046ee0: 2e73 6861 7065 5b31 3a5d 0a20 2020 2020  .shape[1:].     
+00046ef0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+00046f00: 6c65 6e28 6368 756e 6b73 2920 3e20 313a  len(chunks) > 1:
+00046f10: 0a20 2020 2020 2020 2020 2020 206c 6179  .            lay
+00046f20: 6572 203d 2064 736b 2e6c 6179 6572 735b  er = dsk.layers[
+00046f30: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
+00046f40: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00046f50: 6c61 7965 722c 2042 6c6f 636b 7769 7365  layer, Blockwise
+00046f60: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00046f70: 2020 206c 6179 6572 2e6e 6577 5f61 7865     layer.new_axe
+00046f80: 735b 226a 225d 203d 2063 6875 6e6b 735b  s["j"] = chunks[
+00046f90: 315d 5b30 5d0a 2020 2020 2020 2020 2020  1][0].          
+00046fa0: 2020 2020 2020 6c61 7965 722e 6f75 7470        layer.outp
+00046fb0: 7574 5f69 6e64 6963 6573 203d 206c 6179  ut_indices = lay
+00046fc0: 6572 2e6f 7574 7075 745f 696e 6469 6365  er.output_indice
+00046fd0: 7320 2b20 2822 6a22 2c29 0a20 2020 2020  s + ("j",).     
+00046fe0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00046ff0: 2020 2020 2020 2020 2020 2020 2073 7566               suf
+00047000: 6669 7820 3d20 2830 2c29 202a 2028 6c65  fix = (0,) * (le
+00047010: 6e28 6368 756e 6b73 2920 2d20 3129 0a20  n(chunks) - 1). 
+00047020: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00047030: 6f72 2069 2069 6e20 7261 6e67 6528 6c65  or i in range(le
+00047040: 6e28 6368 756e 6b73 5b30 5d29 293a 0a20  n(chunks[0])):. 
+00047050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047060: 2020 206c 6179 6572 5b28 6e61 6d65 2c20     layer[(name, 
+00047070: 6929 202b 2073 7566 6669 785d 203d 206c  i) + suffix] = l
+00047080: 6179 6572 2e70 6f70 2828 6e61 6d65 2c20  ayer.pop((name, 
+00047090: 6929 290a 2020 2020 2020 2020 7265 7475  i)).        retu
+000470a0: 726e 2064 612e 4172 7261 7928 6473 6b2c  rn da.Array(dsk,
+000470b0: 206e 616d 653d 6e61 6d65 2c20 6368 756e   name=name, chun
+000470c0: 6b73 3d63 6875 6e6b 732c 2064 7479 7065  ks=chunks, dtype
+000470d0: 3d6d 6574 612e 6474 7970 6529 0a20 2020  =meta.dtype).   
+000470e0: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
+000470f0: 6574 7572 6e20 6765 745f 7061 7261 6c6c  eturn get_parall
+00047100: 656c 5f74 7970 6528 6d65 7461 2928 6473  el_type(meta)(ds
+00047110: 6b2c 206e 616d 652c 206d 6574 612c 2064  k, name, meta, d
+00047120: 6976 6973 696f 6e73 290a 0a0a 6465 6620  ivisions)...def 
+00047130: 7061 7274 6974 696f 6e77 6973 655f 6772  partitionwise_gr
+00047140: 6170 6828 6675 6e63 2c20 6c61 7965 725f  aph(func, layer_
+00047150: 6e61 6d65 2c20 2a61 7267 732c 202a 2a6b  name, *args, **k
+00047160: 7761 7267 7329 3a0a 2020 2020 2222 220a  wargs):.    """.
+00047170: 2020 2020 4170 706c 7920 6120 6675 6e63      Apply a func
+00047180: 7469 6f6e 2070 6172 7469 7469 6f6e 2d77  tion partition-w
+00047190: 6973 6520 6163 726f 7373 2061 7267 756d  ise across argum
+000471a0: 656e 7473 2074 6f20 6372 6561 7465 206c  ents to create l
+000471b0: 6179 6572 206f 6620 6120 6772 6170 680a  ayer of a graph.
+000471c0: 0a20 2020 2054 6869 7320 6170 706c 6965  .    This applie
+000471d0: 7320 6120 6675 6e63 7469 6f6e 2c20 6060  s a function, ``
+000471e0: 6675 6e63 6060 2c20 696e 2061 6e20 656d  func``, in an em
+000471f0: 6261 7272 6173 7369 6e67 6c79 2070 6172  barrassingly par
+00047200: 616c 6c65 6c20 6661 7368 696f 6e0a 2020  allel fashion.  
+00047210: 2020 6163 726f 7373 2070 6172 7469 7469    across partiti
+00047220: 6f6e 732f 6368 756e 6b73 2069 6e20 7468  ons/chunks in th
+00047230: 6520 7072 6f76 6964 6564 2061 7267 756d  e provided argum
+00047240: 656e 7473 2e20 2049 7420 6861 6e64 6c65  ents.  It handle
+00047250: 7320 4461 7461 6672 616d 6573 2c0a 2020  s Dataframes,.  
+00047260: 2020 4172 7261 7973 2c20 616e 6420 7363    Arrays, and sc
+00047270: 616c 6172 7320 736d 6f6f 7468 6c79 2c20  alars smoothly, 
+00047280: 616e 6420 7265 6c69 6573 206f 6e20 7468  and relies on th
+00047290: 6520 6060 626c 6f63 6b77 6973 6560 6020  e ``blockwise`` 
+000472a0: 6d61 6368 696e 6572 790a 2020 2020 746f  machinery.    to
+000472b0: 2070 726f 7669 6465 2061 206e 6963 656c   provide a nicel
+000472c0: 7920 7379 6d62 6f6c 6963 2067 7261 7068  y symbolic graph
+000472d0: 2e0a 0a20 2020 2049 7420 6973 206d 6f73  ...    It is mos
+000472e0: 7420 636f 6d6d 6f6e 6c79 2075 7365 6420  t commonly used 
+000472f0: 696e 206f 7468 6572 2067 7261 7068 2d62  in other graph-b
+00047300: 7569 6c64 696e 6720 6675 6e63 7469 6f6e  uilding function
+00047310: 7320 746f 2063 7265 6174 6520 7468 650a  s to create the.
+00047320: 2020 2020 6170 7072 6f70 7269 6174 6520      appropriate 
+00047330: 6c61 7965 7220 6f66 2074 6865 2072 6573  layer of the res
+00047340: 756c 7469 6e67 2064 6174 6166 7261 6d65  ulting dataframe
+00047350: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+00047360: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00047370: 0a20 2020 2066 756e 633a 2063 616c 6c61  .    func: calla
+00047380: 626c 650a 2020 2020 6c61 7965 725f 6e61  ble.    layer_na
+00047390: 6d65 3a20 7374 720a 2020 2020 2020 2020  me: str.        
+000473a0: 4465 7363 7269 7074 6976 6520 6e61 6d65  Descriptive name
+000473b0: 2066 6f72 2074 6865 206f 7065 7261 7469   for the operati
+000473c0: 6f6e 2e20 5573 6564 2061 7320 7468 6520  on. Used as the 
+000473d0: 6f75 7470 7574 206e 616d 650a 2020 2020  output name.    
+000473e0: 2020 2020 696e 2074 6865 2072 6573 756c      in the resul
+000473f0: 7469 6e67 2060 6042 6c6f 636b 7769 7365  ting ``Blockwise
+00047400: 6060 2067 7261 7068 206c 6179 6572 2e0a  `` graph layer..
+00047410: 2020 2020 2a61 7267 733a 0a20 2020 202a      *args:.    *
+00047420: 2a6b 7761 7267 733a 0a0a 2020 2020 5265  *kwargs:..    Re
+00047430: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
+00047440: 2d0a 2020 2020 6f75 743a 2042 6c6f 636b  -.    out: Block
+00047450: 7769 7365 2067 7261 7068 0a0a 2020 2020  wise graph..    
+00047460: 4578 616d 706c 6573 0a20 2020 202d 2d2d  Examples.    ---
+00047470: 2d2d 2d2d 2d0a 2020 2020 3e3e 3e20 7375  -----.    >>> su
+00047480: 6267 7261 7068 203d 2070 6172 7469 7469  bgraph = partiti
+00047490: 6f6e 7769 7365 5f67 7261 7068 2866 756e  onwise_graph(fun
+000474a0: 6374 696f 6e2c 2078 2c20 792c 207a 3d31  ction, x, y, z=1
+000474b0: 3233 2920 2023 2064 6f63 7465 7374 3a20  23)  # doctest: 
+000474c0: 2b53 4b49 500a 2020 2020 3e3e 3e20 6c61  +SKIP.    >>> la
+000474d0: 7965 7220 3d20 7061 7274 6974 696f 6e77  yer = partitionw
+000474e0: 6973 655f 6772 6170 6828 6675 6e63 7469  ise_graph(functi
+000474f0: 6f6e 2c20 6466 2c20 782c 207a 3d31 3233  on, df, x, z=123
+00047500: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+00047510: 4b49 500a 2020 2020 3e3e 3e20 6772 6170  KIP.    >>> grap
+00047520: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
+00047530: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
+00047540: 6f6e 7328 6e61 6d65 2c20 6c61 7965 722c  ons(name, layer,
+00047550: 2064 6570 656e 6465 6e63 6965 733d 5b64   dependencies=[d
+00047560: 662c 2078 5d29 2020 2320 646f 6374 6573  f, x])  # doctes
+00047570: 743a 202b 534b 4950 0a20 2020 203e 3e3e  t: +SKIP.    >>>
+00047580: 2072 6573 756c 7420 3d20 6e65 775f 6464   result = new_dd
+00047590: 5f6f 626a 6563 7428 6772 6170 682c 206e  _object(graph, n
+000475a0: 616d 652c 206d 6574 6164 6174 612c 2064  ame, metadata, d
+000475b0: 662e 6469 7669 7369 6f6e 7329 2020 2320  f.divisions)  # 
+000475c0: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
+000475d0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+000475e0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 6d61   --------.    ma
+000475f0: 705f 7061 7274 6974 696f 6e73 0a20 2020  p_partitions.   
+00047600: 2022 2222 0a20 2020 2070 6169 7273 203d   """.    pairs =
+00047610: 205b 5d0a 2020 2020 6e75 6d62 6c6f 636b   [].    numblock
+00047620: 7320 3d20 7b7d 0a20 2020 2066 6f72 2061  s = {}.    for a
+00047630: 7267 2069 6e20 6172 6773 3a0a 2020 2020  rg in args:.    
+00047640: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00047650: 6528 6172 672c 205f 4672 616d 6529 3a0a  e(arg, _Frame):.
+00047660: 2020 2020 2020 2020 2020 2020 7061 6972              pair
+00047670: 732e 6578 7465 6e64 285b 6172 672e 5f6e  s.extend([arg._n
+00047680: 616d 652c 2022 6922 5d29 0a20 2020 2020  ame, "i"]).     
+00047690: 2020 2020 2020 206e 756d 626c 6f63 6b73         numblocks
+000476a0: 5b61 7267 2e5f 6e61 6d65 5d20 3d20 2861  [arg._name] = (a
+000476b0: 7267 2e6e 7061 7274 6974 696f 6e73 2c29  rg.npartitions,)
+000476c0: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
+000476d0: 696e 7374 616e 6365 2861 7267 2c20 5363  instance(arg, Sc
+000476e0: 616c 6172 293a 0a20 2020 2020 2020 2020  alar):.         
+000476f0: 2020 2070 6169 7273 2e65 7874 656e 6428     pairs.extend(
+00047700: 5b61 7267 2e5f 6e61 6d65 2c20 2269 225d  [arg._name, "i"]
+00047710: 290a 2020 2020 2020 2020 2020 2020 6e75  ).            nu
+00047720: 6d62 6c6f 636b 735b 6172 672e 5f6e 616d  mblocks[arg._nam
+00047730: 655d 203d 2028 312c 290a 2020 2020 2020  e] = (1,).      
+00047740: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00047750: 6528 6172 672c 2041 7272 6179 293a 0a20  e(arg, Array):. 
+00047760: 2020 2020 2020 2020 2020 2069 6620 6172             if ar
+00047770: 672e 6e64 696d 203d 3d20 313a 0a20 2020  g.ndim == 1:.   
+00047780: 2020 2020 2020 2020 2020 2020 2070 6169               pai
+00047790: 7273 2e65 7874 656e 6428 5b61 7267 2e6e  rs.extend([arg.n
+000477a0: 616d 652c 2022 6922 5d29 0a20 2020 2020  ame, "i"]).     
+000477b0: 2020 2020 2020 2065 6c69 6620 6172 672e         elif arg.
+000477c0: 6e64 696d 203d 3d20 303a 0a20 2020 2020  ndim == 0:.     
+000477d0: 2020 2020 2020 2020 2020 2070 6169 7273             pairs
+000477e0: 2e65 7874 656e 6428 5b61 7267 2e6e 616d  .extend([arg.nam
+000477f0: 652c 2022 225d 290a 2020 2020 2020 2020  e, ""]).        
+00047800: 2020 2020 656c 6966 2061 7267 2e6e 6469      elif arg.ndi
+00047810: 6d20 3d3d 2032 3a0a 2020 2020 2020 2020  m == 2:.        
+00047820: 2020 2020 2020 2020 7061 6972 732e 6578          pairs.ex
+00047830: 7465 6e64 285b 6172 672e 6e61 6d65 2c20  tend([arg.name, 
+00047840: 2269 6a22 5d29 0a20 2020 2020 2020 2020  "ij"]).         
+00047850: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00047860: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00047870: 616c 7565 4572 726f 7228 2243 616e 2774  alueError("Can't
+00047880: 2061 6464 206d 756c 7469 2d64 696d 656e   add multi-dimen
+00047890: 7369 6f6e 616c 2061 7272 6179 2074 6f20  sional array to 
+000478a0: 6461 7461 6672 616d 6573 2229 0a20 2020  dataframes").   
+000478b0: 2020 2020 2020 2020 206e 756d 626c 6f63           numbloc
+000478c0: 6b73 5b61 7267 2e5f 6e61 6d65 5d20 3d20  ks[arg._name] = 
+000478d0: 6172 672e 6e75 6d62 6c6f 636b 730a 2020  arg.numblocks.  
+000478e0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+000478f0: 7461 6e63 6528 6172 672c 2042 6c6f 636b  tance(arg, Block
+00047900: 7769 7365 4465 7029 3a0a 2020 2020 2020  wiseDep):.      
+00047910: 2020 2020 2020 6966 206c 656e 2861 7267        if len(arg
+00047920: 2e6e 756d 626c 6f63 6b73 2920 3d3d 2031  .numblocks) == 1
+00047930: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00047940: 2020 7061 6972 732e 6578 7465 6e64 285b    pairs.extend([
+00047950: 6172 672c 2022 6922 5d29 0a20 2020 2020  arg, "i"]).     
+00047960: 2020 2020 2020 2065 6c69 6620 6c65 6e28         elif len(
+00047970: 6172 672e 6e75 6d62 6c6f 636b 7329 203d  arg.numblocks) =
+00047980: 3d20 323a 0a20 2020 2020 2020 2020 2020  = 2:.           
+00047990: 2020 2020 2070 6169 7273 2e65 7874 656e       pairs.exten
+000479a0: 6428 5b61 7267 2c20 2269 6a22 5d29 0a20  d([arg, "ij"]). 
+000479b0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000479c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000479d0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+000479e0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+000479f0: 2020 2020 2020 2066 2242 6c6f 636b 7769         f"Blockwi
+00047a00: 7365 4465 7020 6172 6720 7b61 7267 2172  seDep arg {arg!r
+00047a10: 7d20 6861 7320 7b6c 656e 2861 7267 2e6e  } has {len(arg.n
+00047a20: 756d 626c 6f63 6b73 297d 2064 696d 656e  umblocks)} dimen
+00047a30: 7369 6f6e 733b 206f 6e6c 7920 3120 6f72  sions; only 1 or
+00047a40: 2032 2061 7265 2073 7570 706f 7274 6564   2 are supported
+00047a50: 2e22 0a20 2020 2020 2020 2020 2020 2020  .".             
+00047a60: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
+00047a70: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
+00047a80: 6169 7273 2e65 7874 656e 6428 5b61 7267  airs.extend([arg
+00047a90: 2c20 4e6f 6e65 5d29 0a20 2020 2072 6574  , None]).    ret
+00047aa0: 7572 6e20 626c 6f63 6b77 6973 6528 0a20  urn blockwise(. 
+00047ab0: 2020 2020 2020 2066 756e 632c 206c 6179         func, lay
+00047ac0: 6572 5f6e 616d 652c 2022 6922 2c20 2a70  er_name, "i", *p
+00047ad0: 6169 7273 2c20 6e75 6d62 6c6f 636b 733d  airs, numblocks=
+00047ae0: 6e75 6d62 6c6f 636b 732c 2063 6f6e 6361  numblocks, conca
+00047af0: 7465 6e61 7465 3d54 7275 652c 202a 2a6b  tenate=True, **k
+00047b00: 7761 7267 730a 2020 2020 290a 0a0a 6465  wargs.    )...de
+00047b10: 6620 6d65 7461 5f77 6172 6e69 6e67 2864  f meta_warning(d
+00047b20: 6629 3a0a 2020 2020 2222 220a 2020 2020  f):.    """.    
+00047b30: 5072 6f76 6964 6520 616e 2069 6e66 6f72  Provide an infor
+00047b40: 6d61 7469 7665 206d 6573 7361 6765 2077  mative message w
+00047b50: 6865 6e20 7468 6520 7573 6572 2069 7320  hen the user is 
+00047b60: 6173 6b65 6420 746f 2070 726f 7669 6465  asked to provide
+00047b70: 206d 6574 6164 6174 610a 2020 2020 2222   metadata.    ""
+00047b80: 220a 2020 2020 6966 2069 735f 6461 7461  ".    if is_data
+00047b90: 6672 616d 655f 6c69 6b65 2864 6629 3a0a  frame_like(df):.
+00047ba0: 2020 2020 2020 2020 6d65 7461 5f73 7472          meta_str
+00047bb0: 203d 207b 6b3a 2073 7472 2876 2920 666f   = {k: str(v) fo
+00047bc0: 7220 6b2c 2076 2069 6e20 6466 2e64 7479  r k, v in df.dty
+00047bd0: 7065 732e 746f 5f64 6963 7428 292e 6974  pes.to_dict().it
+00047be0: 656d 7328 297d 0a20 2020 2065 6c69 6620  ems()}.    elif 
+00047bf0: 6973 5f73 6572 6965 735f 6c69 6b65 2864  is_series_like(d
+00047c00: 6629 3a0a 2020 2020 2020 2020 6d65 7461  f):.        meta
+00047c10: 5f73 7472 203d 2028 6466 2e6e 616d 652c  _str = (df.name,
+00047c20: 2073 7472 2864 662e 6474 7970 6529 290a   str(df.dtype)).
+00047c30: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00047c40: 2020 6d65 7461 5f73 7472 203d 204e 6f6e    meta_str = Non
+00047c50: 650a 2020 2020 6d73 6720 3d20 280a 2020  e.    msg = (.  
+00047c60: 2020 2020 2020 225c 6e59 6f75 2064 6964        "\nYou did
+00047c70: 206e 6f74 2070 726f 7669 6465 206d 6574   not provide met
+00047c80: 6164 6174 612c 2073 6f20 4461 736b 2069  adata, so Dask i
+00047c90: 7320 7275 6e6e 696e 6720 796f 7572 2022  s running your "
+00047ca0: 0a20 2020 2020 2020 2022 6675 6e63 7469  .        "functi
+00047cb0: 6f6e 206f 6e20 6120 736d 616c 6c20 6461  on on a small da
+00047cc0: 7461 7365 7420 746f 2067 7565 7373 206f  taset to guess o
+00047cd0: 7574 7075 7420 7479 7065 732e 2022 0a20  utput types. ". 
+00047ce0: 2020 2020 2020 2022 4974 2069 7320 706f         "It is po
+00047cf0: 7373 6962 6c65 2074 6861 7420 4461 736b  ssible that Dask
+00047d00: 2077 696c 6c20 6775 6573 7320 696e 636f   will guess inco
+00047d10: 7272 6563 746c 792e 5c6e 220a 2020 2020  rrectly.\n".    
+00047d20: 2020 2020 2254 6f20 7072 6f76 6964 6520      "To provide 
+00047d30: 616e 2065 7870 6c69 6369 7420 6f75 7470  an explicit outp
+00047d40: 7574 2074 7970 6573 206f 7220 746f 2073  ut types or to s
+00047d50: 696c 656e 6365 2074 6869 7320 6d65 7373  ilence this mess
+00047d60: 6167 652c 2022 0a20 2020 2020 2020 2022  age, ".        "
+00047d70: 706c 6561 7365 2070 726f 7669 6465 2074  please provide t
+00047d80: 6865 2060 6d65 7461 3d60 206b 6579 776f  he `meta=` keywo
+00047d90: 7264 2c20 6173 2064 6573 6372 6962 6564  rd, as described
+00047da0: 2069 6e20 7468 6520 6d61 7020 6f72 2022   in the map or "
+00047db0: 0a20 2020 2020 2020 2022 6170 706c 7920  .        "apply 
+00047dc0: 6675 6e63 7469 6f6e 2074 6861 7420 796f  function that yo
+00047dd0: 7520 6172 6520 7573 696e 672e 220a 2020  u are using.".  
+00047de0: 2020 290a 2020 2020 6966 206d 6574 615f    ).    if meta_
+00047df0: 7374 723a 0a20 2020 2020 2020 206d 7367  str:.        msg
+00047e00: 202b 3d20 280a 2020 2020 2020 2020 2020   += (.          
+00047e10: 2020 225c 6e22 0a20 2020 2020 2020 2020    "\n".         
+00047e20: 2020 2022 2020 4265 666f 7265 3a20 2e61     "  Before: .a
+00047e30: 7070 6c79 2866 756e 6329 5c6e 220a 2020  pply(func)\n".  
+00047e40: 2020 2020 2020 2020 2020 2220 2041 6674            "  Aft
+00047e50: 6572 3a20 202e 6170 706c 7928 6675 6e63  er:  .apply(func
+00047e60: 2c20 6d65 7461 3d25 7329 5c6e 2220 2520  , meta=%s)\n" % 
+00047e70: 7374 7228 6d65 7461 5f73 7472 290a 2020  str(meta_str).  
+00047e80: 2020 2020 2020 290a 2020 2020 7265 7475        ).    retu
+00047e90: 726e 206d 7367 0a0a 0a64 6566 2070 7265  rn msg...def pre
+00047ea0: 6669 785f 7265 6475 6374 696f 6e28 662c  fix_reduction(f,
+00047eb0: 2064 6466 2c20 6964 656e 7469 7479 2c20   ddf, identity, 
+00047ec0: 2a2a 6b77 6172 6773 293a 0a20 2020 2022  **kwargs):.    "
+00047ed0: 2222 436f 6d70 7574 6573 2074 6865 2070  ""Computes the p
+00047ee0: 7265 6669 7820 7375 6d73 206f 6620 6620  refix sums of f 
+00047ef0: 6f6e 2064 660a 0a20 2020 2049 6620 6466  on df..    If df
+00047f00: 2068 6173 2070 6172 7469 7469 6f6e 7320   has partitions 
+00047f10: 5b50 312c 2050 322c 202e 2e2e 2c20 506e  [P1, P2, ..., Pn
+00047f20: 5d2c 2074 6865 6e20 7265 7475 726e 7320  ], then returns 
+00047f30: 7468 6520 4461 7461 4672 616d 6520 7769  the DataFrame wi
+00047f40: 7468 0a20 2020 2070 6172 7469 7469 6f6e  th.    partition
+00047f50: 7320 5b66 2869 6465 6e74 6974 792c 2050  s [f(identity, P
+00047f60: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
+00047f70: 2020 2020 6628 6628 6964 656e 7469 7479      f(f(identity
+00047f80: 2c20 5031 292c 2050 3229 2c0a 2020 2020  , P1), P2),.    
+00047f90: 2020 2020 2020 2020 2020 2020 6628 6628              f(f(
+00047fa0: 6628 6964 656e 7469 7479 2c20 5031 292c  f(identity, P1),
+00047fb0: 2050 3229 2c20 5033 292c 0a20 2020 2020   P2), P3),.     
+00047fc0: 2020 2020 2020 2020 2020 202e 2e2e 5d0a             ...].
+00047fd0: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00047fe0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00047ff0: 2020 2066 203a 2063 616c 6c61 626c 650a     f : callable.
+00048000: 2020 2020 2020 2020 616e 2061 7373 6f63          an assoc
+00048010: 6961 7469 7665 2066 756e 6374 696f 6e20  iative function 
+00048020: 660a 2020 2020 6464 6620 3a20 6464 2e44  f.    ddf : dd.D
+00048030: 6174 6146 7261 6d65 0a20 2020 2069 6465  ataFrame.    ide
+00048040: 6e74 6974 7920 3a20 7064 2e44 6174 6146  ntity : pd.DataF
+00048050: 7261 6d65 0a20 2020 2020 2020 2061 6e20  rame.        an 
+00048060: 6964 656e 7469 7479 2065 6c65 6d65 6e74  identity element
+00048070: 206f 6620 662c 2074 6861 7420 6973 2066   of f, that is f
+00048080: 2869 6465 6e74 6974 792c 2064 6629 203d  (identity, df) =
+00048090: 2066 2864 662c 2069 6465 6e74 6974 7929   f(df, identity)
+000480a0: 203d 2064 660a 2020 2020 2222 220a 2020   = df.    """.  
+000480b0: 2020 6473 6b20 3d20 6469 6374 2829 0a20    dsk = dict(). 
+000480c0: 2020 206e 616d 6520 3d20 2270 7265 6669     name = "prefi
+000480d0: 785f 7265 6475 6374 696f 6e2d 2220 2b20  x_reduction-" + 
+000480e0: 746f 6b65 6e69 7a65 2866 2c20 6464 662c  tokenize(f, ddf,
+000480f0: 2069 6465 6e74 6974 792c 202a 2a6b 7761   identity, **kwa
+00048100: 7267 7329 0a20 2020 206d 6574 6120 3d20  rgs).    meta = 
+00048110: 6464 662e 5f6d 6574 610a 2020 2020 6e20  ddf._meta.    n 
+00048120: 3d20 6c65 6e28 6464 662e 6469 7669 7369  = len(ddf.divisi
+00048130: 6f6e 7329 202d 2031 0a20 2020 2064 6976  ons) - 1.    div
+00048140: 6973 696f 6e73 203d 205b 4e6f 6e65 5d20  isions = [None] 
+00048150: 2a20 286e 202b 2031 290a 0a20 2020 204e  * (n + 1)..    N
+00048160: 203d 2031 0a20 2020 2077 6869 6c65 204e   = 1.    while N
+00048170: 203c 206e 3a0a 2020 2020 2020 2020 4e20   < n:.        N 
+00048180: 2a3d 2032 0a20 2020 2066 6f72 2069 2069  *= 2.    for i i
+00048190: 6e20 7261 6e67 6528 6e29 3a0a 2020 2020  n range(n):.    
+000481a0: 2020 2020 6473 6b5b 286e 616d 652c 2069      dsk[(name, i
+000481b0: 2c20 312c 2030 295d 203d 2028 6170 706c  , 1, 0)] = (appl
+000481c0: 792c 2066 2c20 5b28 6464 662e 5f6e 616d  y, f, [(ddf._nam
+000481d0: 652c 2069 292c 2069 6465 6e74 6974 795d  e, i), identity]
+000481e0: 2c20 6b77 6172 6773 290a 2020 2020 666f  , kwargs).    fo
+000481f0: 7220 6920 696e 2072 616e 6765 286e 2c20  r i in range(n, 
+00048200: 4e29 3a0a 2020 2020 2020 2020 6473 6b5b  N):.        dsk[
+00048210: 286e 616d 652c 2069 2c20 312c 2030 295d  (name, i, 1, 0)]
+00048220: 203d 2069 6465 6e74 6974 790a 0a20 2020   = identity..   
+00048230: 2064 203d 2031 0a20 2020 2077 6869 6c65   d = 1.    while
+00048240: 2064 203c 204e 3a0a 2020 2020 2020 2020   d < N:.        
+00048250: 666f 7220 6920 696e 2072 616e 6765 2830  for i in range(0
+00048260: 2c20 4e2c 2032 202a 2064 293a 0a20 2020  , N, 2 * d):.   
+00048270: 2020 2020 2020 2020 2064 736b 5b28 6e61           dsk[(na
+00048280: 6d65 2c20 6920 2b20 3220 2a20 6420 2d20  me, i + 2 * d - 
+00048290: 312c 2032 202a 2064 2c20 3029 5d20 3d20  1, 2 * d, 0)] = 
+000482a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000482b0: 2020 6170 706c 792c 0a20 2020 2020 2020    apply,.       
+000482c0: 2020 2020 2020 2020 2066 2c0a 2020 2020           f,.    
+000482d0: 2020 2020 2020 2020 2020 2020 5b28 6e61              [(na
+000482e0: 6d65 2c20 6920 2b20 6420 2d20 312c 2064  me, i + d - 1, d
+000482f0: 2c20 3029 2c20 286e 616d 652c 2069 202b  , 0), (name, i +
+00048300: 2032 202a 2064 202d 2031 2c20 642c 2030   2 * d - 1, d, 0
+00048310: 295d 2c0a 2020 2020 2020 2020 2020 2020  )],.            
+00048320: 2020 2020 6b77 6172 6773 2c0a 2020 2020      kwargs,.    
+00048330: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00048340: 2020 6420 2a3d 2032 0a0a 2020 2020 6473    d *= 2..    ds
+00048350: 6b5b 286e 616d 652c 204e 202d 2031 2c20  k[(name, N - 1, 
+00048360: 4e2c 2031 295d 203d 2069 6465 6e74 6974  N, 1)] = identit
+00048370: 790a 0a20 2020 2077 6869 6c65 2064 203e  y..    while d >
+00048380: 2031 3a0a 2020 2020 2020 2020 6420 2f2f   1:.        d //
+00048390: 3d20 320a 2020 2020 2020 2020 666f 7220  = 2.        for 
+000483a0: 6920 696e 2072 616e 6765 2830 2c20 4e2c  i in range(0, N,
+000483b0: 2032 202a 2064 293a 0a20 2020 2020 2020   2 * d):.       
+000483c0: 2020 2020 2064 736b 5b28 6e61 6d65 2c20       dsk[(name, 
+000483d0: 6920 2b20 6420 2d20 312c 2064 2c20 3129  i + d - 1, d, 1)
+000483e0: 5d20 3d20 286e 616d 652c 2069 202b 2032  ] = (name, i + 2
+000483f0: 202a 2064 202d 2031 2c20 3220 2a20 642c   * d - 1, 2 * d,
+00048400: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
+00048410: 6473 6b5b 286e 616d 652c 2069 202b 2032  dsk[(name, i + 2
+00048420: 202a 2064 202d 2031 2c20 642c 2031 295d   * d - 1, d, 1)]
+00048430: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00048440: 2020 2020 2061 7070 6c79 2c0a 2020 2020       apply,.    
+00048450: 2020 2020 2020 2020 2020 2020 662c 0a20              f,. 
+00048460: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00048470: 286e 616d 652c 2069 202b 2032 202a 2064  (name, i + 2 * d
+00048480: 202d 2031 2c20 3220 2a20 642c 2031 292c   - 1, 2 * d, 1),
+00048490: 2028 6e61 6d65 2c20 6920 2b20 6420 2d20   (name, i + d - 
+000484a0: 312c 2064 2c20 3029 5d2c 0a20 2020 2020  1, d, 0)],.     
+000484b0: 2020 2020 2020 2020 2020 206b 7761 7267             kwarg
+000484c0: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
+000484d0: 0a0a 2020 2020 666f 7220 6920 696e 2072  ..    for i in r
+000484e0: 616e 6765 286e 293a 0a20 2020 2020 2020  ange(n):.       
+000484f0: 2064 736b 5b28 6e61 6d65 2c20 6929 5d20   dsk[(name, i)] 
+00048500: 3d20 2861 7070 6c79 2c20 662c 205b 286e  = (apply, f, [(n
+00048510: 616d 652c 2069 2c20 312c 2031 292c 2069  ame, i, 1, 1), i
+00048520: 6465 6e74 6974 795d 2c20 6b77 6172 6773  dentity], kwargs
+00048530: 290a 0a20 2020 2067 7261 7068 203d 2048  )..    graph = H
+00048540: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+00048550: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
+00048560: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
+00048570: 656e 6369 6573 3d5b 6464 665d 290a 2020  encies=[ddf]).  
+00048580: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
+00048590: 6f62 6a65 6374 2867 7261 7068 2c20 6e61  object(graph, na
+000485a0: 6d65 2c20 6d65 7461 2c20 6469 7669 7369  me, meta, divisi
+000485b0: 6f6e 7329 0a0a 0a64 6566 2073 7566 6669  ons)...def suffi
+000485c0: 785f 7265 6475 6374 696f 6e28 662c 2064  x_reduction(f, d
+000485d0: 6466 2c20 6964 656e 7469 7479 2c20 2a2a  df, identity, **
+000485e0: 6b77 6172 6773 293a 0a20 2020 2022 2222  kwargs):.    """
+000485f0: 436f 6d70 7574 6573 2074 6865 2073 7566  Computes the suf
+00048600: 6669 7820 7375 6d73 206f 6620 6620 6f6e  fix sums of f on
+00048610: 2064 660a 0a20 2020 2049 6620 6466 2068   df..    If df h
+00048620: 6173 2070 6172 7469 7469 6f6e 7320 5b50  as partitions [P
+00048630: 312c 2050 322c 202e 2e2e 2c20 506e 5d2c  1, P2, ..., Pn],
+00048640: 2074 6865 6e20 7265 7475 726e 7320 7468   then returns th
+00048650: 6520 4461 7461 4672 616d 6520 7769 7468  e DataFrame with
+00048660: 0a20 2020 2070 6172 7469 7469 6f6e 7320  .    partitions 
+00048670: 5b66 2850 312c 2066 2850 322c 202e 2e2e  [f(P1, f(P2, ...
+00048680: 6628 506e 2c20 6964 656e 7469 7479 292e  f(Pn, identity).
+00048690: 2e2e 2929 2c0a 2020 2020 2020 2020 2020  ..)),.          
+000486a0: 2020 2020 2020 6628 5032 2c20 2e2e 2e66        f(P2, ...f
+000486b0: 2850 6e2c 2069 6465 6e74 6974 7929 2e2e  (Pn, identity)..
+000486c0: 2e29 2c0a 2020 2020 2020 2020 2020 2020  .),.            
+000486d0: 2020 2020 2e2e 2e66 2850 6e2c 2069 6465      ...f(Pn, ide
+000486e0: 6e74 6974 7929 2e2e 2e2c 0a20 2020 2020  ntity)...,.     
+000486f0: 2020 2020 2020 2020 2020 202e 2e2e 5d0a             ...].
+00048700: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00048710: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00048720: 2020 2066 203a 2063 616c 6c61 626c 650a     f : callable.
+00048730: 2020 2020 2020 2020 616e 2061 7373 6f63          an assoc
+00048740: 6961 7469 7665 2066 756e 6374 696f 6e20  iative function 
+00048750: 660a 2020 2020 6464 6620 3a20 6464 2e44  f.    ddf : dd.D
+00048760: 6174 6146 7261 6d65 0a20 2020 2069 6465  ataFrame.    ide
+00048770: 6e74 6974 7920 3a20 7064 2e44 6174 6146  ntity : pd.DataF
+00048780: 7261 6d65 0a20 2020 2020 2020 2061 6e20  rame.        an 
+00048790: 6964 656e 7469 7479 2065 6c65 6d65 6e74  identity element
+000487a0: 206f 6620 662c 2074 6861 7420 6973 2066   of f, that is f
+000487b0: 2869 6465 6e74 6974 792c 2064 6629 203d  (identity, df) =
+000487c0: 2066 2864 662c 2069 6465 6e74 6974 7929   f(df, identity)
+000487d0: 203d 2064 660a 2020 2020 6b77 6172 6773   = df.    kwargs
+000487e0: 203a 203f 3f0a 2020 2020 2020 2020 6b65   : ??.        ke
+000487f0: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
+00048800: 6f66 2066 203f 3f0a 2020 2020 2222 220a  of f ??.    """.
+00048810: 2020 2020 6473 6b20 3d20 6469 6374 2829      dsk = dict()
+00048820: 0a20 2020 206e 616d 6520 3d20 2273 7566  .    name = "suf
+00048830: 6669 785f 7265 6475 6374 696f 6e2d 2220  fix_reduction-" 
+00048840: 2b20 746f 6b65 6e69 7a65 2866 2c20 6464  + tokenize(f, dd
+00048850: 662c 2069 6465 6e74 6974 792c 202a 2a6b  f, identity, **k
+00048860: 7761 7267 7329 0a20 2020 206d 6574 6120  wargs).    meta 
+00048870: 3d20 6464 662e 5f6d 6574 610a 2020 2020  = ddf._meta.    
+00048880: 6e20 3d20 6c65 6e28 6464 662e 6469 7669  n = len(ddf.divi
+00048890: 7369 6f6e 7329 202d 2031 0a20 2020 2064  sions) - 1.    d
+000488a0: 6976 6973 696f 6e73 203d 205b 4e6f 6e65  ivisions = [None
+000488b0: 5d20 2a20 286e 202b 2031 290a 0a20 2020  ] * (n + 1)..   
+000488c0: 204e 203d 2031 0a20 2020 2077 6869 6c65   N = 1.    while
+000488d0: 204e 203c 206e 3a0a 2020 2020 2020 2020   N < n:.        
+000488e0: 4e20 2a3d 2032 0a20 2020 2066 6f72 2069  N *= 2.    for i
+000488f0: 2069 6e20 7261 6e67 6528 6e29 3a0a 2020   in range(n):.  
+00048900: 2020 2020 2020 6473 6b5b 286e 616d 652c        dsk[(name,
+00048910: 2069 2c20 312c 2030 295d 203d 2028 6170   i, 1, 0)] = (ap
+00048920: 706c 792c 2066 2c20 5b28 6464 662e 5f6e  ply, f, [(ddf._n
+00048930: 616d 652c 206e 202d 2031 202d 2069 292c  ame, n - 1 - i),
+00048940: 2069 6465 6e74 6974 795d 2c20 6b77 6172   identity], kwar
+00048950: 6773 290a 2020 2020 666f 7220 6920 696e  gs).    for i in
+00048960: 2072 616e 6765 286e 2c20 4e29 3a0a 2020   range(n, N):.  
+00048970: 2020 2020 2020 6473 6b5b 286e 616d 652c        dsk[(name,
+00048980: 2069 2c20 312c 2030 295d 203d 2069 6465   i, 1, 0)] = ide
+00048990: 6e74 6974 790a 0a20 2020 2064 203d 2031  ntity..    d = 1
+000489a0: 0a20 2020 2077 6869 6c65 2064 203c 204e  .    while d < N
+000489b0: 3a0a 2020 2020 2020 2020 666f 7220 6920  :.        for i 
+000489c0: 696e 2072 616e 6765 2830 2c20 4e2c 2032  in range(0, N, 2
+000489d0: 202a 2064 293a 0a20 2020 2020 2020 2020   * d):.         
+000489e0: 2020 2064 736b 5b28 6e61 6d65 2c20 6920     dsk[(name, i 
+000489f0: 2b20 3220 2a20 6420 2d20 312c 2032 202a  + 2 * d - 1, 2 *
+00048a00: 2064 2c20 3029 5d20 3d20 280a 2020 2020   d, 0)] = (.    
+00048a10: 2020 2020 2020 2020 2020 2020 6170 706c              appl
+00048a20: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00048a30: 2020 2066 2c0a 2020 2020 2020 2020 2020     f,.          
+00048a40: 2020 2020 2020 5b28 6e61 6d65 2c20 6920        [(name, i 
+00048a50: 2b20 3220 2a20 6420 2d20 312c 2064 2c20  + 2 * d - 1, d, 
+00048a60: 3029 2c20 286e 616d 652c 2069 202b 2064  0), (name, i + d
+00048a70: 202d 2031 2c20 642c 2030 295d 2c0a 2020   - 1, d, 0)],.  
+00048a80: 2020 2020 2020 2020 2020 2020 2020 6b77                kw
+00048a90: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
+00048aa0: 2020 290a 2020 2020 2020 2020 6420 2a3d    ).        d *=
+00048ab0: 2032 0a0a 2020 2020 6473 6b5b 286e 616d   2..    dsk[(nam
+00048ac0: 652c 204e 202d 2031 2c20 4e2c 2031 295d  e, N - 1, N, 1)]
+00048ad0: 203d 2069 6465 6e74 6974 790a 0a20 2020   = identity..   
+00048ae0: 2077 6869 6c65 2064 203e 2031 3a0a 2020   while d > 1:.  
+00048af0: 2020 2020 2020 6420 2f2f 3d20 320a 2020        d //= 2.  
+00048b00: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00048b10: 616e 6765 2830 2c20 4e2c 2032 202a 2064  ange(0, N, 2 * d
+00048b20: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
+00048b30: 736b 5b28 6e61 6d65 2c20 6920 2b20 6420  sk[(name, i + d 
+00048b40: 2d20 312c 2064 2c20 3129 5d20 3d20 286e  - 1, d, 1)] = (n
+00048b50: 616d 652c 2069 202b 2032 202a 2064 202d  ame, i + 2 * d -
+00048b60: 2031 2c20 3220 2a20 642c 2031 290a 2020   1, 2 * d, 1).  
+00048b70: 2020 2020 2020 2020 2020 6473 6b5b 286e            dsk[(n
+00048b80: 616d 652c 2069 202b 2032 202a 2064 202d  ame, i + 2 * d -
+00048b90: 2031 2c20 642c 2031 295d 203d 2028 0a20   1, d, 1)] = (. 
+00048ba0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00048bb0: 7070 6c79 2c0a 2020 2020 2020 2020 2020  pply,.          
+00048bc0: 2020 2020 2020 662c 0a20 2020 2020 2020        f,.       
+00048bd0: 2020 2020 2020 2020 205b 286e 616d 652c           [(name,
+00048be0: 2069 202b 2064 202d 2031 2c20 642c 2030   i + d - 1, d, 0
+00048bf0: 292c 2028 6e61 6d65 2c20 6920 2b20 3220  ), (name, i + 2 
+00048c00: 2a20 6420 2d20 312c 2032 202a 2064 2c20  * d - 1, 2 * d, 
+00048c10: 3129 5d2c 0a20 2020 2020 2020 2020 2020  1)],.           
+00048c20: 2020 2020 206b 7761 7267 732c 0a20 2020       kwargs,.   
+00048c30: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00048c40: 666f 7220 6920 696e 2072 616e 6765 286e  for i in range(n
+00048c50: 293a 0a20 2020 2020 2020 2064 736b 5b28  ):.        dsk[(
+00048c60: 6e61 6d65 2c20 6929 5d20 3d20 2861 7070  name, i)] = (app
+00048c70: 6c79 2c20 662c 205b 286e 616d 652c 206e  ly, f, [(name, n
+00048c80: 202d 2031 202d 2069 2c20 312c 2031 292c   - 1 - i, 1, 1),
+00048c90: 2069 6465 6e74 6974 795d 2c20 6b77 6172   identity], kwar
+00048ca0: 6773 290a 0a20 2020 2067 7261 7068 203d  gs)..    graph =
+00048cb0: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
+00048cc0: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
+00048cd0: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
+00048ce0: 6e64 656e 6369 6573 3d5b 6464 665d 290a  ndencies=[ddf]).
+00048cf0: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
+00048d00: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
+00048d10: 6e61 6d65 2c20 6d65 7461 2c20 6469 7669  name, meta, divi
+00048d20: 7369 6f6e 7329 0a0a 0a64 6566 206d 6170  sions)...def map
+00048d30: 7365 7269 6573 2862 6173 655f 6368 756e  series(base_chun
+00048d40: 6b2c 2063 6f6e 6361 745f 6d61 7029 3a0a  k, concat_map):.
+00048d50: 2020 2020 7265 7475 726e 2062 6173 655f      return base_
+00048d60: 6368 756e 6b2e 6d61 7028 636f 6e63 6174  chunk.map(concat
+00048d70: 5f6d 6170 290a 0a0a 6465 6620 6d61 7073  _map)...def maps
+00048d80: 6572 6965 735f 636f 6d62 696e 6528 696e  eries_combine(in
+00048d90: 6465 782c 2063 6f6e 6361 745f 7265 7375  dex, concat_resu
+00048da0: 6c74 293a 0a20 2020 2066 696e 616c 5f73  lt):.    final_s
+00048db0: 6572 6965 7320 3d20 636f 6e63 6174 5f72  eries = concat_r
+00048dc0: 6573 756c 742e 736f 7274 5f69 6e64 6578  esult.sort_index
+00048dd0: 2829 0a20 2020 2066 696e 616c 5f73 6572  ().    final_ser
+00048de0: 6965 7320 3d20 696e 6465 782e 746f 5f73  ies = index.to_s
+00048df0: 6572 6965 7328 292e 6d61 7028 6669 6e61  eries().map(fina
+00048e00: 6c5f 7365 7269 6573 290a 2020 2020 7265  l_series).    re
+00048e10: 7475 726e 2066 696e 616c 5f73 6572 6965  turn final_serie
+00048e20: 730a 0a0a 6465 6620 7365 7269 6573 5f6d  s...def series_m
+00048e30: 6170 2862 6173 655f 7365 7269 6573 2c20  ap(base_series, 
+00048e40: 6d61 705f 7365 7269 6573 293a 0a20 2020  map_series):.   
+00048e50: 206e 7061 7274 6974 696f 6e73 203d 2062   npartitions = b
+00048e60: 6173 655f 7365 7269 6573 2e6e 7061 7274  ase_series.npart
+00048e70: 6974 696f 6e73 0a20 2020 2073 706c 6974  itions.    split
+00048e80: 5f6f 7574 203d 206d 6170 5f73 6572 6965  _out = map_serie
+00048e90: 732e 6e70 6172 7469 7469 6f6e 730a 0a20  s.npartitions.. 
+00048ea0: 2020 2064 736b 203d 207b 7d0a 0a20 2020     dsk = {}..   
+00048eb0: 2062 6173 655f 746f 6b65 6e5f 6b65 7920   base_token_key 
+00048ec0: 3d20 746f 6b65 6e69 7a65 2862 6173 655f  = tokenize(base_
+00048ed0: 7365 7269 6573 2c20 7370 6c69 745f 6f75  series, split_ou
+00048ee0: 7429 0a20 2020 2062 6173 655f 7370 6c69  t).    base_spli
+00048ef0: 745f 7072 6566 6978 203d 2066 2262 6173  t_prefix = f"bas
+00048f00: 652d 7370 6c69 742d 7b62 6173 655f 746f  e-split-{base_to
+00048f10: 6b65 6e5f 6b65 797d 220a 2020 2020 6261  ken_key}".    ba
+00048f20: 7365 5f73 6861 7264 5f70 7265 6669 7820  se_shard_prefix 
+00048f30: 3d20 6622 6261 7365 2d73 6861 7264 2d7b  = f"base-shard-{
+00048f40: 6261 7365 5f74 6f6b 656e 5f6b 6579 7d22  base_token_key}"
+00048f50: 0a20 2020 2066 6f72 2069 2c20 6b65 7920  .    for i, key 
+00048f60: 696e 2065 6e75 6d65 7261 7465 2862 6173  in enumerate(bas
+00048f70: 655f 7365 7269 6573 2e5f 5f64 6173 6b5f  e_series.__dask_
+00048f80: 6b65 7973 5f5f 2829 293a 0a20 2020 2020  keys__()):.     
+00048f90: 2020 2064 736b 5b28 6261 7365 5f73 706c     dsk[(base_spl
+00048fa0: 6974 5f70 7265 6669 782c 2069 295d 203d  it_prefix, i)] =
+00048fb0: 2028 6861 7368 5f73 6861 7264 2c20 6b65   (hash_shard, ke
+00048fc0: 792c 2073 706c 6974 5f6f 7574 290a 2020  y, split_out).  
+00048fd0: 2020 2020 2020 666f 7220 6a20 696e 2072        for j in r
+00048fe0: 616e 6765 2873 706c 6974 5f6f 7574 293a  ange(split_out):
+00048ff0: 0a20 2020 2020 2020 2020 2020 2064 736b  .            dsk
+00049000: 5b28 6261 7365 5f73 6861 7264 5f70 7265  [(base_shard_pre
+00049010: 6669 782c 2030 2c20 692c 206a 295d 203d  fix, 0, i, j)] =
+00049020: 2028 6765 7469 7465 6d2c 2028 6261 7365   (getitem, (base
+00049030: 5f73 706c 6974 5f70 7265 6669 782c 2069  _split_prefix, i
+00049040: 292c 206a 290a 0a20 2020 206d 6170 5f74  ), j)..    map_t
+00049050: 6f6b 656e 5f6b 6579 203d 2074 6f6b 656e  oken_key = token
+00049060: 697a 6528 6d61 705f 7365 7269 6573 290a  ize(map_series).
+00049070: 2020 2020 6d61 705f 7370 6c69 745f 7072      map_split_pr
+00049080: 6566 6978 203d 2066 226d 6170 2d73 706c  efix = f"map-spl
+00049090: 6974 2d7b 6d61 705f 746f 6b65 6e5f 6b65  it-{map_token_ke
+000490a0: 797d 220a 2020 2020 6d61 705f 7368 6172  y}".    map_shar
+000490b0: 645f 7072 6566 6978 203d 2066 226d 6170  d_prefix = f"map
+000490c0: 2d73 6861 7264 2d7b 6d61 705f 746f 6b65  -shard-{map_toke
+000490d0: 6e5f 6b65 797d 220a 2020 2020 666f 7220  n_key}".    for 
+000490e0: 692c 206b 6579 2069 6e20 656e 756d 6572  i, key in enumer
+000490f0: 6174 6528 6d61 705f 7365 7269 6573 2e5f  ate(map_series._
+00049100: 5f64 6173 6b5f 6b65 7973 5f5f 2829 293a  _dask_keys__()):
+00049110: 0a20 2020 2020 2020 2064 736b 5b28 6d61  .        dsk[(ma
+00049120: 705f 7370 6c69 745f 7072 6566 6978 2c20  p_split_prefix, 
+00049130: 6929 5d20 3d20 280a 2020 2020 2020 2020  i)] = (.        
+00049140: 2020 2020 6861 7368 5f73 6861 7264 2c0a      hash_shard,.
+00049150: 2020 2020 2020 2020 2020 2020 6b65 792c              key,
+00049160: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+00049170: 6974 5f6f 7574 2c0a 2020 2020 2020 2020  it_out,.        
+00049180: 2020 2020 7370 6c69 745f 6f75 745f 6f6e      split_out_on
+00049190: 5f69 6e64 6578 2c0a 2020 2020 2020 2020  _index,.        
+000491a0: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
+000491b0: 2020 290a 2020 2020 2020 2020 666f 7220    ).        for 
+000491c0: 6a20 696e 2072 616e 6765 2873 706c 6974  j in range(split
+000491d0: 5f6f 7574 293a 0a20 2020 2020 2020 2020  _out):.         
+000491e0: 2020 2064 736b 5b28 6d61 705f 7368 6172     dsk[(map_shar
+000491f0: 645f 7072 6566 6978 2c20 302c 2069 2c20  d_prefix, 0, i, 
+00049200: 6a29 5d20 3d20 2867 6574 6974 656d 2c20  j)] = (getitem, 
+00049210: 286d 6170 5f73 706c 6974 5f70 7265 6669  (map_split_prefi
+00049220: 782c 2069 292c 206a 290a 0a20 2020 2074  x, i), j)..    t
+00049230: 6f6b 656e 5f6b 6579 203d 2074 6f6b 656e  oken_key = token
+00049240: 697a 6528 6261 7365 5f73 6572 6965 732c  ize(base_series,
+00049250: 206d 6170 5f73 6572 6965 7329 0a20 2020   map_series).   
+00049260: 206d 6170 5f70 7265 6669 7820 3d20 6622   map_prefix = f"
+00049270: 6d61 702d 7365 7269 6573 2d7b 746f 6b65  map-series-{toke
+00049280: 6e5f 6b65 797d 220a 2020 2020 666f 7220  n_key}".    for 
+00049290: 6920 696e 2072 616e 6765 286e 7061 7274  i in range(npart
+000492a0: 6974 696f 6e73 293a 0a20 2020 2020 2020  itions):.       
+000492b0: 2066 6f72 206a 2069 6e20 7261 6e67 6528   for j in range(
+000492c0: 7370 6c69 745f 6f75 7429 3a0a 2020 2020  split_out):.    
+000492d0: 2020 2020 2020 2020 6473 6b5b 286d 6170          dsk[(map
+000492e0: 5f70 7265 6669 782c 2069 2c20 6a29 5d20  _prefix, i, j)] 
+000492f0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00049300: 2020 2020 6d61 7073 6572 6965 732c 0a20      mapseries,. 
+00049310: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00049320: 6261 7365 5f73 6861 7264 5f70 7265 6669  base_shard_prefi
+00049330: 782c 2030 2c20 692c 206a 292c 0a20 2020  x, 0, i, j),.   
+00049340: 2020 2020 2020 2020 2020 2020 2028 5f63               (_c
+00049350: 6f6e 6361 742c 205b 286d 6170 5f73 6861  oncat, [(map_sha
+00049360: 7264 5f70 7265 6669 782c 2030 2c20 6b2c  rd_prefix, 0, k,
+00049370: 206a 2920 666f 7220 6b20 696e 2072 616e   j) for k in ran
+00049380: 6765 2873 706c 6974 5f6f 7574 295d 292c  ge(split_out)]),
+00049390: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+000493a0: 2020 2020 6669 6e61 6c5f 7072 6566 6978      final_prefix
+000493b0: 203d 2066 226d 6170 2d73 6572 6965 732d   = f"map-series-
+000493c0: 636f 6d62 696e 652d 7b74 6f6b 656e 5f6b  combine-{token_k
+000493d0: 6579 7d22 0a20 2020 2066 6f72 2069 2c20  ey}".    for i, 
+000493e0: 6b65 7920 696e 2065 6e75 6d65 7261 7465  key in enumerate
+000493f0: 2862 6173 655f 7365 7269 6573 2e69 6e64  (base_series.ind
+00049400: 6578 2e5f 5f64 6173 6b5f 6b65 7973 5f5f  ex.__dask_keys__
+00049410: 2829 293a 0a20 2020 2020 2020 2064 736b  ()):.        dsk
+00049420: 5b28 6669 6e61 6c5f 7072 6566 6978 2c20  [(final_prefix, 
+00049430: 6929 5d20 3d20 280a 2020 2020 2020 2020  i)] = (.        
+00049440: 2020 2020 6d61 7073 6572 6965 735f 636f      mapseries_co
+00049450: 6d62 696e 652c 0a20 2020 2020 2020 2020  mbine,.         
+00049460: 2020 206b 6579 2c0a 2020 2020 2020 2020     key,.        
+00049470: 2020 2020 285f 636f 6e63 6174 2c20 5b28      (_concat, [(
+00049480: 6d61 705f 7072 6566 6978 2c20 692c 206a  map_prefix, i, j
+00049490: 2920 666f 7220 6a20 696e 2072 616e 6765  ) for j in range
+000494a0: 2873 706c 6974 5f6f 7574 295d 292c 0a20  (split_out)]),. 
+000494b0: 2020 2020 2020 2029 0a0a 2020 2020 6d65         )..    me
+000494c0: 7461 203d 206d 6170 5f73 6572 6965 732e  ta = map_series.
+000494d0: 5f6d 6574 612e 636f 7079 2829 0a20 2020  _meta.copy().   
+000494e0: 206d 6574 612e 696e 6465 7820 3d20 6261   meta.index = ba
+000494f0: 7365 5f73 6572 6965 732e 5f6d 6574 612e  se_series._meta.
+00049500: 696e 6465 780a 2020 2020 6d65 7461 203d  index.    meta =
+00049510: 206d 616b 655f 6d65 7461 286d 6574 6129   make_meta(meta)
+00049520: 0a0a 2020 2020 6465 7065 6e64 656e 6369  ..    dependenci
+00049530: 6573 203d 205b 6261 7365 5f73 6572 6965  es = [base_serie
+00049540: 732c 206d 6170 5f73 6572 6965 732c 2062  s, map_series, b
+00049550: 6173 655f 7365 7269 6573 2e69 6e64 6578  ase_series.index
+00049560: 5d0a 2020 2020 6772 6170 6820 3d20 4869  ].    graph = Hi
+00049570: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+00049580: 6d5f 636f 6c6c 6563 7469 6f6e 7328 0a20  m_collections(. 
+00049590: 2020 2020 2020 2066 696e 616c 5f70 7265         final_pre
+000495a0: 6669 782c 2064 736b 2c20 6465 7065 6e64  fix, dsk, depend
+000495b0: 656e 6369 6573 3d64 6570 656e 6465 6e63  encies=dependenc
+000495c0: 6965 730a 2020 2020 290a 2020 2020 6469  ies.    ).    di
+000495d0: 7669 7369 6f6e 7320 3d20 6c69 7374 2862  visions = list(b
+000495e0: 6173 655f 7365 7269 6573 2e64 6976 6973  ase_series.divis
+000495f0: 696f 6e73 290a 0a20 2020 2072 6574 7572  ions)..    retur
+00049600: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
+00049610: 6772 6170 682c 2066 696e 616c 5f70 7265  graph, final_pre
+00049620: 6669 782c 206d 6574 612c 2064 6976 6973  fix, meta, divis
+00049630: 696f 6e73 290a 0a0a 6465 6620 5f63 6f6e  ions)...def _con
+00049640: 7665 7274 5f74 6f5f 6e75 6d65 7269 6328  vert_to_numeric(
+00049650: 7365 7269 6573 2c20 736b 6970 6e61 293a  series, skipna):
+00049660: 0a20 2020 2069 6620 736b 6970 6e61 3a0a  .    if skipna:.
+00049670: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00049680: 6572 6965 732e 6472 6f70 6e61 2829 2e76  eries.dropna().v
+00049690: 6965 7728 2269 3822 290a 0a20 2020 2023  iew("i8")..    #
+000496a0: 2073 6572 6965 732e 7669 6577 2822 6938   series.view("i8
+000496b0: 2229 2077 6974 6820 7064 2e4e 6154 2070  ") with pd.NaT p
+000496c0: 726f 6475 6365 7320 2d39 3232 3333 3732  roduces -9223372
+000496d0: 3033 3638 3534 3737 3538 3038 2069 7320  036854775808 is 
+000496e0: 7768 7920 7765 206e 6565 6420 746f 2064  why we need to d
+000496f0: 6f20 7468 6973 0a20 2020 2072 6574 7572  o this.    retur
+00049700: 6e20 7365 7269 6573 2e76 6965 7728 2269  n series.view("i
+00049710: 3822 292e 6d61 736b 2873 6572 6965 732e  8").mask(series.
+00049720: 6973 6e75 6c6c 2829 2c20 6e70 2e6e 616e  isnull(), np.nan
+00049730: 290a 0a0a 6465 6620 5f73 7172 745f 616e  )...def _sqrt_an
+00049740: 645f 636f 6e76 6572 745f 746f 5f74 696d  d_convert_to_tim
+00049750: 6564 656c 7461 2870 6172 7469 7469 6f6e  edelta(partition
+00049760: 2c20 6178 6973 2c20 6474 7970 653d 4e6f  , axis, dtype=No
+00049770: 6e65 2c20 2a61 7267 732c 202a 2a6b 7761  ne, *args, **kwa
+00049780: 7267 7329 3a0a 2020 2020 6966 2061 7869  rgs):.    if axi
+00049790: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
+000497a0: 7769 7468 2077 6172 6e69 6e67 732e 6361  with warnings.ca
+000497b0: 7463 685f 7761 726e 696e 6773 2829 3a0a  tch_warnings():.
+000497c0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+000497d0: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
+000497e0: 6e67 7328 0a20 2020 2020 2020 2020 2020  ngs(.           
+000497f0: 2020 2020 2022 6967 6e6f 7265 222c 0a20       "ignore",. 
+00049800: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00049810: 6174 6567 6f72 793d 5275 6e74 696d 6557  ategory=RuntimeW
+00049820: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
+00049830: 2020 2020 2020 2020 6d65 7373 6167 653d          message=
+00049840: 2269 6e76 616c 6964 2076 616c 7565 2065  "invalid value e
+00049850: 6e63 6f75 6e74 6572 6564 2069 6e20 6361  ncountered in ca
+00049860: 7374 222c 0a20 2020 2020 2020 2020 2020  st",.           
+00049870: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+00049880: 6574 7572 6e20 7064 2e74 6f5f 7469 6d65  eturn pd.to_time
+00049890: 6465 6c74 6128 4d2e 7374 6428 7061 7274  delta(M.std(part
+000498a0: 6974 696f 6e2c 2061 7869 733d 6178 6973  ition, axis=axis
+000498b0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+000498c0: 7329 290a 0a20 2020 2069 735f 6466 5f6c  s))..    is_df_l
+000498d0: 696b 652c 2074 696d 655f 636f 6c73 203d  ike, time_cols =
+000498e0: 206b 7761 7267 735b 2269 735f 6466 5f6c   kwargs["is_df_l
+000498f0: 696b 6522 5d2c 206b 7761 7267 735b 2274  ike"], kwargs["t
+00049900: 696d 655f 636f 6c73 225d 0a0a 2020 2020  ime_cols"]..    
+00049910: 7371 7274 203d 206e 702e 7371 7274 2870  sqrt = np.sqrt(p
+00049920: 6172 7469 7469 6f6e 290a 0a20 2020 2069  artition)..    i
+00049930: 6620 6e6f 7420 6973 5f64 665f 6c69 6b65  f not is_df_like
+00049940: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00049950: 2070 642e 746f 5f74 696d 6564 656c 7461   pd.to_timedelta
+00049960: 2873 7172 7429 0a0a 2020 2020 7469 6d65  (sqrt)..    time
+00049970: 5f63 6f6c 5f6d 6173 6b20 3d20 7371 7274  _col_mask = sqrt
+00049980: 2e69 6e64 6578 2e69 7369 6e28 7469 6d65  .index.isin(time
+00049990: 5f63 6f6c 7329 0a20 2020 206d 6174 6368  _cols).    match
+000499a0: 696e 675f 7661 6c73 203d 2073 7172 745b  ing_vals = sqrt[
+000499b0: 7469 6d65 5f63 6f6c 5f6d 6173 6b5d 0a20  time_col_mask]. 
+000499c0: 2020 2066 6f72 2074 696d 655f 636f 6c2c     for time_col,
+000499d0: 206d 6174 6368 696e 675f 7661 6c20 696e   matching_val in
+000499e0: 207a 6970 2874 696d 655f 636f 6c73 2c20   zip(time_cols, 
+000499f0: 6d61 7463 6869 6e67 5f76 616c 7329 3a0a  matching_vals):.
+00049a00: 2020 2020 2020 2020 7371 7274 5b74 696d          sqrt[tim
+00049a10: 655f 636f 6c5d 203d 2070 642e 746f 5f74  e_col] = pd.to_t
+00049a20: 696d 6564 656c 7461 286d 6174 6368 696e  imedelta(matchin
+00049a30: 675f 7661 6c29 0a0a 2020 2020 6966 2064  g_val)..    if d
+00049a40: 7479 7065 2069 7320 6e6f 7420 4e6f 6e65  type is not None
+00049a50: 3a0a 2020 2020 2020 2020 7371 7274 203d  :.        sqrt =
+00049a60: 2073 7172 742e 6173 7479 7065 2864 7479   sqrt.astype(dty
+00049a70: 7065 290a 2020 2020 7265 7475 726e 2073  pe).    return s
+00049a80: 7172 740a 0a0a 6465 6620 5f72 6169 7365  qrt...def _raise
+00049a90: 5f69 665f 6e6f 745f 7365 7269 6573 5f6f  _if_not_series_o
+00049aa0: 725f 6461 7461 6672 616d 6528 782c 2066  r_dataframe(x, f
+00049ab0: 756e 636e 616d 6529 3a0a 2020 2020 2222  uncname):.    ""
+00049ac0: 220a 2020 2020 5574 696c 6974 7920 6675  ".    Utility fu
+00049ad0: 6e63 7469 6f6e 2074 6f20 7261 6973 6520  nction to raise 
+00049ae0: 616e 2065 7272 6f72 2069 6620 616e 206f  an error if an o
+00049af0: 626a 6563 7420 6973 206e 6f74 2061 2053  bject is not a S
+00049b00: 6572 6965 7320 6f72 2044 6174 6146 7261  eries or DataFra
+00049b10: 6d65 0a20 2020 2022 2222 0a20 2020 2069  me.    """.    i
+00049b20: 6620 6e6f 7420 6973 5f73 6572 6965 735f  f not is_series_
+00049b30: 6c69 6b65 2878 2920 616e 6420 6e6f 7420  like(x) and not 
+00049b40: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+00049b50: 6528 7829 3a0a 2020 2020 2020 2020 7261  e(x):.        ra
+00049b60: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+00049b70: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
+00049b80: 2020 2020 2022 6025 7360 2069 7320 6f6e       "`%s` is on
+00049b90: 6c79 2073 7570 706f 7274 6564 2077 6974  ly supported wit
+00049ba0: 6820 6f62 6a65 6374 7320 7468 6174 2061  h objects that a
+00049bb0: 7265 2044 6174 6166 7261 6d65 7320 6f72  re Dataframes or
+00049bc0: 2053 6572 6965 7322 0a20 2020 2020 2020   Series".       
+00049bd0: 2020 2020 2025 2066 756e 636e 616d 650a       % funcname.
+00049be0: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
+00049bf0: 5f67 6574 6174 7472 5f6e 756d 6572 6963  _getattr_numeric
+00049c00: 5f6f 6e6c 7928 2a61 7267 732c 205f 6461  _only(*args, _da
+00049c10: 736b 5f6d 6574 686f 645f 6e61 6d65 2c20  sk_method_name, 
+00049c20: 2a2a 6b77 6172 6773 293a 0a20 2020 2077  **kwargs):.    w
+00049c30: 6974 6820 6368 6563 6b5f 6e75 6d65 7269  ith check_numeri
+00049c40: 635f 6f6e 6c79 5f64 6570 7265 6361 7469  c_only_deprecati
+00049c50: 6f6e 2829 3a0a 2020 2020 2020 2020 7265  on():.        re
+00049c60: 7475 726e 2067 6574 6174 7472 284d 2c20  turn getattr(M, 
+00049c70: 5f64 6173 6b5f 6d65 7468 6f64 5f6e 616d  _dask_method_nam
+00049c80: 6529 282a 6172 6773 2c20 2a2a 6b77 6172  e)(*args, **kwar
+00049c90: 6773 290a                                gs).
```

### Comparing `dask-2023.5.0/dask/dataframe/dispatch.py` & `dask-2023.5.1/dask/dataframe/dispatch.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,13 +1,15 @@
 """
 Dispatch in dask.dataframe.
 
 Also see extension.py
 """
 
+from __future__ import annotations
+
 import pandas as pd
 
 import dask.array as da
 import dask.dataframe as dd
 from dask.utils import Dispatch
 
 make_meta_dispatch = Dispatch("make_meta_dispatch")
```

### Comparing `dask-2023.5.0/dask/dataframe/extensions.py` & `dask-2023.5.1/dask/dataframe/extensions.py`

 * *Files 25% similar despite different names*

```diff
@@ -1,12 +1,14 @@
 """
 Support for pandas ExtensionArray in dask.dataframe.
 
 See :ref:`extensionarrays` for more.
 """
+from __future__ import annotations
+
 from dask.dataframe.accessor import (
     register_dataframe_accessor,
     register_index_accessor,
     register_series_accessor,
 )
 from dask.utils import Dispatch
```

### Comparing `dask-2023.5.0/dask/dataframe/groupby.py` & `dask-2023.5.1/dask/dataframe/groupby.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import collections
 import itertools as it
 import operator
 import uuid
 import warnings
 from functools import partial, wraps
 from numbers import Integral
@@ -87,16 +89,14 @@
     "In the future, `sort` for groupby operations will default to `True`"
     " to match the behavior of pandas. However, `sort=True` does not work"
     " with `split_out>1`. To retain the current behavior for multiple"
     " output partitions, set `sort=False`."
 )
 
 NUMERIC_ONLY_NOT_IMPLEMENTED = [
-    "cumprod",
-    "cumsum",
     "mean",
     "std",
     "var",
 ]
 
 
 def _determine_levels(by):
@@ -1780,15 +1780,14 @@
 
         if convert_back_to_series:
             df4 = df4["__series__"].rename(self.obj.name)
 
         return df4, by2
 
     @derived_from(pd.core.groupby.GroupBy)
-    @numeric_only_not_implemented
     def cumsum(self, axis=no_default, numeric_only=no_default):
         axis = self._normalize_axis(axis, "cumsum")
         if axis:
             if axis in (1, "columns") and isinstance(self, SeriesGroupBy):
                 raise ValueError(f"No axis named {axis} for object type Series")
             return self.obj.cumsum(axis=axis)
         else:
@@ -1797,15 +1796,14 @@
                 chunk=M.cumsum,
                 aggregate=M.add,
                 initial=0,
                 numeric_only=numeric_only,
             )
 
     @derived_from(pd.core.groupby.GroupBy)
-    @numeric_only_not_implemented
     def cumprod(self, axis=no_default, numeric_only=no_default):
         axis = self._normalize_axis(axis, "cumprod")
         if axis:
             if axis in (1, "columns") and isinstance(self, SeriesGroupBy):
                 raise ValueError(f"No axis named {axis} for object type Series")
             return self.obj.cumprod(axis=axis)
         else:
```

### Comparing `dask-2023.5.0/dask/dataframe/hyperloglog.py` & `dask-2023.5.1/dask/dataframe/hyperloglog.py`

 * *Files 2% similar despite different names*

```diff
@@ -5,14 +5,16 @@
 
     Philippe Flajolet, Éric Fusy, Olivier Gandouet and Frédéric Meunier.
         "HyperLogLog: the analysis of a near-optimal cardinality estimation
         algorithm". 2007 Conference on Analysis of Algorithms. Nice, France
         (2007)
 
 """
+from __future__ import annotations
+
 import numpy as np
 import pandas as pd
 from pandas.util import hash_pandas_object
 
 
 def compute_first_bit(a):
     "Compute the position of the first nonzero bit for each int in an array."
```

### Comparing `dask-2023.5.0/dask/dataframe/indexing.py` & `dask-2023.5.1/dask/dataframe/indexing.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import bisect
 from collections import defaultdict
 from datetime import datetime
 
 import numpy as np
 import pandas as pd
 from pandas.api.types import is_bool_dtype
```

### Comparing `dask-2023.5.0/dask/dataframe/io/__init__.py` & `dask-2023.5.1/dask/dataframe/io/__init__.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from dask.dataframe.io import demo
 from dask.dataframe.io.csv import read_csv, read_fwf, read_table, to_csv
 from dask.dataframe.io.hdf import read_hdf, to_hdf
 from dask.dataframe.io.io import (
     from_array,
     from_dask_array,
     from_delayed,
```

### Comparing `dask-2023.5.0/dask/dataframe/io/csv.py` & `dask-2023.5.1/dask/dataframe/io/csv.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os
 from collections.abc import Mapping
 from io import BytesIO
 from warnings import catch_warnings, simplefilter, warn
 
 try:
     import psutil
@@ -616,14 +618,17 @@
     if isinstance(header, int):
         firstrow += header
     header = b"" if header is None else parts[firstrow] + b_lineterminator
 
     # Use sample to infer dtypes and check for presence of include_path_column
     head_kwargs = kwargs.copy()
     head_kwargs.pop("skipfooter", None)
+    if head_kwargs.get("engine") == "pyarrow":
+        # Use c engine to infer since Arrow engine does not support nrows
+        head_kwargs["engine"] = "c"
     try:
         head = reader(BytesIO(b_sample), nrows=sample_rows, **head_kwargs)
     except pd.errors.ParserError as e:
         if "EOF" in str(e):
             raise ValueError(
                 "EOF encountered while reading header. \n"
                 "Pass argument `sample_rows` and make sure the value of `sample` "
```

### Comparing `dask-2023.5.0/dask/dataframe/io/demo.py` & `dask-2023.5.1/dask/dataframe/io/demo.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pandas as pd
 
 from dask.dataframe.core import tokenize
 from dask.dataframe.io.io import from_map
 from dask.dataframe.io.utils import DataFrameIOFunction
 from dask.utils import random_state_data
```

### Comparing `dask-2023.5.0/dask/dataframe/io/hdf.py` & `dask-2023.5.1/dask/dataframe/io/hdf.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os
 import uuid
 from fnmatch import fnmatch
 from glob import glob
 from warnings import warn
 
 import pandas as pd
```

### Comparing `dask-2023.5.0/dask/dataframe/io/io.py` & `dask-2023.5.1/dask/dataframe/io/io.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,15 +1,15 @@
 from __future__ import annotations
 
 from collections.abc import Iterable
 from functools import partial
 from math import ceil
 from operator import getitem
 from threading import Lock
-from typing import TYPE_CHECKING, Iterable, Literal, overload
+from typing import TYPE_CHECKING, Literal, overload
 
 import numpy as np
 import pandas as pd
 
 import dask.array as da
 from dask.base import is_dask_collection, tokenize
 from dask.blockwise import BlockwiseDepDict, blockwise
```

### Comparing `dask-2023.5.0/dask/dataframe/io/json.py` & `dask-2023.5.1/dask/dataframe/io/json.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import io
 import os
 from functools import partial
 from itertools import zip_longest
 
 import pandas as pd
 from fsspec.core import open_files
```

### Comparing `dask-2023.5.0/dask/dataframe/io/orc/arrow.py` & `dask-2023.5.1/dask/dataframe/io/orc/arrow.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pyarrow as pa
 import pyarrow.orc as orc
 
 from dask.dataframe.io.utils import _get_pyarrow_dtypes, _meta_from_dtypes
 
 
 class ArrowORCEngine:
```

### Comparing `dask-2023.5.0/dask/dataframe/io/orc/core.py` & `dask-2023.5.1/dask/dataframe/io/orc/core.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import copy
 
 from fsspec.core import get_fs_token_paths
 from fsspec.utils import stringify_path
 
 from dask.base import compute_as_if_collection, tokenize
 from dask.dataframe.backends import dataframe_creation_dispatch
```

### Comparing `dask-2023.5.0/dask/dataframe/io/parquet/arrow.py` & `dask-2023.5.1/dask/dataframe/io/parquet/arrow.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import json
 import operator
 import textwrap
 import warnings
 from collections import defaultdict
 from datetime import datetime
 from functools import reduce
@@ -1252,15 +1254,17 @@
                     "categories not in available columns.\n"
                     "categories: {} | columns: {}".format(categories, list(all_columns))
                 )
 
             # Make sure all categories are set to "unknown".
             # Cannot include index names in the `cols` argument.
             meta = clear_known_categories(
-                meta, cols=[c for c in categories if c not in meta.index.names]
+                meta,
+                cols=[c for c in categories if c not in meta.index.names],
+                dtype_backend=dtype_backend,
             )
 
         if partition_obj:
             # Update meta dtypes for partitioned columns
             for partition in partition_obj:
                 if isinstance(index, list) and partition.name == index[0]:
                     # Index from directory structure
```

### Comparing `dask-2023.5.0/dask/dataframe/io/parquet/core.py` & `dask-2023.5.1/dask/dataframe/io/parquet/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/dataframe/io/parquet/fastparquet.py` & `dask-2023.5.1/dask/dataframe/io/parquet/fastparquet.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import copy
 import pickle
 import threading
 import warnings
 from collections import OrderedDict, defaultdict
 from contextlib import ExitStack
```

### Comparing `dask-2023.5.0/dask/dataframe/io/parquet/utils.py` & `dask-2023.5.1/dask/dataframe/io/parquet/utils.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import re
 import warnings
 
 import numpy as np
 import pandas as pd
 from fsspec.core import expand_paths_if_needed, get_fs_token_paths, stringify_path
 from fsspec.spec import AbstractFileSystem
```

### Comparing `dask-2023.5.0/dask/dataframe/io/sql.py` & `dask-2023.5.1/dask/dataframe/io/sql.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import warnings
 
 import numpy as np
 import pandas as pd
 
 from dask.base import compute as dask_compute
 from dask.dataframe import methods
```

### Comparing `dask-2023.5.0/dask/dataframe/io/tests/test_csv.py` & `dask-2023.5.1/dask/dataframe/io/tests/test_csv.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import gzip
 import os
 import warnings
 from io import BytesIO, StringIO
 from unittest import mock
 
 import pytest
@@ -13,15 +15,15 @@
 from tlz import partition_all, valmap
 
 import dask
 from dask.base import compute_as_if_collection
 from dask.bytes.core import read_bytes
 from dask.bytes.utils import compress
 from dask.core import flatten
-from dask.dataframe._compat import PANDAS_GT_200, tm
+from dask.dataframe._compat import PANDAS_GT_140, PANDAS_GT_200, tm
 from dask.dataframe.io.csv import (
     _infer_block_size,
     auto_blocksize,
     block_mask,
     pandas_read_text,
     text_blocks_to_pandas,
 )
@@ -1247,14 +1249,28 @@
 
 def test_read_csv_singleton_dtype():
     data = b"a,b\n1,2\n3,4\n5,6"
     with filetext(data, mode="wb") as fn:
         assert_eq(pd.read_csv(fn, dtype=float), dd.read_csv(fn, dtype=float))
 
 
+@pytest.mark.skipif(not PANDAS_GT_140, reason="arrow engine available from 1.4")
+def test_read_csv_arrow_engine():
+    pytest.importorskip("pyarrow")
+    sep_text = normalize_text(
+        """
+    a,b
+    1,2
+    """
+    )
+
+    with filetext(sep_text) as fn:
+        assert_eq(pd.read_csv(fn, engine="pyarrow"), dd.read_csv(fn, engine="pyarrow"))
+
+
 def test_robust_column_mismatch():
     files = csv_files.copy()
     k = sorted(files)[-1]
     files[k] = files[k].replace(b"name", b"Name")
     with filetexts(files, mode="b"):
         ddf = dd.read_csv(
             "2014-01-*.csv", header=None, skiprows=1, names=["name", "amount", "id"]
```

### Comparing `dask-2023.5.0/dask/dataframe/io/tests/test_demo.py` & `dask-2023.5.1/dask/dataframe/io/tests/test_demo.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pandas as pd
 import pytest
 
 import dask
 import dask.dataframe as dd
 from dask.blockwise import Blockwise, optimize_blockwise
 from dask.dataframe._compat import tm
```

### Comparing `dask-2023.5.0/dask/dataframe/io/tests/test_hdf.py` & `dask-2023.5.1/dask/dataframe/io/tests/test_hdf.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os
 import pathlib
 from time import sleep
 
 import numpy as np
 import pandas as pd
 import pytest
@@ -447,16 +449,16 @@
         ],
     )
     a = dd.from_pandas(df16, 16)
 
     # adding artificial delays to make sure last tasks finish first
     # that's a way to simulate last tasks finishing last
     def delayed_nop(i):
-        if i[1] < 10:
-            sleep(0.1 * (10 - i[1]))
+        if i.iloc[1] < 10:
+            sleep(0.1 * (10 - i.iloc[1]))
         return i
 
     # saving to multiple hdf nodes
     with tmpfile() as fn:
         a = a.apply(delayed_nop, axis=1, meta=a)
         a.to_hdf(fn, "/data*")
         out = dd.read_hdf(fn, "/data*")
```

### Comparing `dask-2023.5.0/dask/dataframe/io/tests/test_io.py` & `dask-2023.5.1/dask/dataframe/io/tests/test_io.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from datetime import datetime
 
 import numpy as np
 import pandas as pd
 import pytest
 
 import dask
```

### Comparing `dask-2023.5.0/dask/dataframe/io/tests/test_json.py` & `dask-2023.5.1/dask/dataframe/io/tests/test_json.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import json
 import os
 
 import pandas as pd
 import pytest
 
 import dask
```

### Comparing `dask-2023.5.0/dask/dataframe/io/tests/test_orc.py` & `dask-2023.5.1/dask/dataframe/io/tests/test_orc.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import glob
 import os
 import shutil
 import tempfile
 
 import numpy as np
 import pandas as pd
```

### Comparing `dask-2023.5.0/dask/dataframe/io/tests/test_parquet.py` & `dask-2023.5.1/dask/dataframe/io/tests/test_parquet.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 import glob
 import math
 import os
 import warnings
 from decimal import Decimal
 from unittest.mock import MagicMock
@@ -12,15 +14,15 @@
 from packaging.version import parse as parse_version
 
 import dask
 import dask.dataframe as dd
 import dask.multiprocessing
 from dask.array.numpy_compat import _numpy_124
 from dask.blockwise import Blockwise, optimize_blockwise
-from dask.dataframe._compat import PANDAS_GT_150, PANDAS_GT_200
+from dask.dataframe._compat import PANDAS_GT_150, PANDAS_GT_200, PANDAS_GT_202
 from dask.dataframe.io.parquet.core import get_engine
 from dask.dataframe.io.parquet.utils import _parse_pandas_metadata
 from dask.dataframe.optimize import optimize_dataframe_getitem
 from dask.dataframe.utils import assert_eq, pyarrow_strings_enabled
 from dask.layers import DataFrameIOLayer
 from dask.utils import natural_sort_key
 from dask.utils_test import hlg_layer
@@ -4900,7 +4902,19 @@
     ddf = dd.read_parquet(outdir, engine="pyarrow")
 
     expected = pd.DataFrame(
         {"b": ["x", "y"], "a": pd.Categorical(pd.Index([1, 2], dtype="int32"))},
         index=[0, 0],
     )
     assert_eq(ddf, expected)
+
+
+@PYARROW_MARK
+@pytest.mark.skipif(not PANDAS_GT_200, reason="Requires pd.ArrowDtype")
+def test_dtype_backend_categoricals(tmp_path):
+    df = pd.DataFrame({"a": pd.Series(["x", "y"], dtype="category"), "b": [1, 2]})
+    outdir = tmp_path / "out.parquet"
+    df.to_parquet(outdir, engine="pyarrow")
+    ddf = dd.read_parquet(outdir, engine="pyarrow", dtype_backend="pyarrow")
+    pdf = pd.read_parquet(outdir, engine="pyarrow", dtype_backend="pyarrow")
+    # Set sort_results=False because of pandas bug up to 2.0.1
+    assert_eq(ddf, pdf, sort_results=PANDAS_GT_202)
```

### Comparing `dask-2023.5.0/dask/dataframe/io/tests/test_sql.py` & `dask-2023.5.1/dask/dataframe/io/tests/test_sql.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import io
 import sys
 from contextlib import contextmanager
 
 import pytest
 
 from dask.dataframe.io.sql import read_sql, read_sql_query, read_sql_table
```

### Comparing `dask-2023.5.0/dask/dataframe/io/utils.py` & `dask-2023.5.1/dask/dataframe/io/utils.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import json
 from typing import Protocol, runtime_checkable
 from uuid import uuid4
 
 import fsspec
 import pandas as pd
 from fsspec.implementations.local import LocalFileSystem
```

### Comparing `dask-2023.5.0/dask/dataframe/methods.py` & `dask-2023.5.1/dask/dataframe/methods.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import warnings
 from functools import partial
 
 import numpy as np
 import pandas as pd
 from pandas.api.types import is_extension_array_dtype
 from tlz import partition
```

### Comparing `dask-2023.5.0/dask/dataframe/multi.py` & `dask-2023.5.1/dask/dataframe/multi.py`

 * *Files 0% similar despite different names*

```diff
@@ -49,14 +49,16 @@
 
 We proceed with hash joins in the following stages:
 
 1.  Shuffle each input on the specified column.  See the function
     ``dask.dataframe.shuffle.shuffle``.
 2.  Perform embarrassingly parallel join across shuffled inputs.
 """
+from __future__ import annotations
+
 import math
 import pickle
 import warnings
 from functools import partial, wraps
 
 import numpy as np
 import pandas as pd
```

### Comparing `dask-2023.5.0/dask/dataframe/numeric.py` & `dask-2023.5.1/dask/dataframe/numeric.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pandas as pd
 from pandas.api.types import is_scalar as pd_is_scalar
 
 from dask.array import Array
 from dask.dataframe.core import Series
 from dask.delayed import delayed
 from dask.utils import derived_from
```

### Comparing `dask-2023.5.0/dask/dataframe/optimize.py` & `dask-2023.5.1/dask/dataframe/optimize.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,10 @@
 """ Dataframe optimizations """
+from __future__ import annotations
+
 import operator
 
 import numpy as np
 
 from dask import config, core
 from dask.blockwise import Blockwise, fuse_roots, optimize_blockwise
 from dask.highlevelgraph import HighLevelGraph
```

### Comparing `dask-2023.5.0/dask/dataframe/partitionquantiles.py` & `dask-2023.5.1/dask/dataframe/partitionquantiles.py`

 * *Files 1% similar despite different names*

```diff
@@ -64,14 +64,16 @@
 percentiles across all partitions scales as ``npartitions**1.5``.  Although
 we only have a simple compression operation (step 3 above) that combines
 weights of equal values, a more sophisticated one could be added if needed,
 such as for extremely large ``npartitions`` or if we find we need to
 increase the sample size for each partition.
 
 """
+from __future__ import annotations
+
 import math
 
 import numpy as np
 import pandas as pd
 from pandas.api.types import is_datetime64_dtype, is_integer_dtype
 from tlz import merge, merge_sorted, take
```

### Comparing `dask-2023.5.0/dask/dataframe/reshape.py` & `dask-2023.5.1/dask/dataframe/reshape.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,19 +1,19 @@
-import sys
+from __future__ import annotations
 
 import numpy as np
 import pandas as pd
 from pandas.api.types import is_list_like, is_scalar
 
 import dask
 from dask.dataframe import methods
 from dask.dataframe._compat import PANDAS_GT_200
 from dask.dataframe.core import DataFrame, Series, apply_concat_apply, map_partitions
 from dask.dataframe.utils import has_known_categories
-from dask.utils import M
+from dask.utils import M, get_meta_library
 
 ###############################################################
 # Dummies
 ###############################################################
 
 
 _get_dummies_dtype_default = bool if PANDAS_GT_200 else np.uint8
@@ -150,19 +150,16 @@
         else:
             if not all(methods.is_categorical_dtype(data[c]) for c in columns):
                 raise NotImplementedError(not_cat_msg)
 
         if not all(has_known_categories(data[c]) for c in columns):
             raise NotImplementedError(unknown_cat_msg)
 
-    package_name = data._meta.__class__.__module__.split(".")[0]
-    dummies = sys.modules[package_name].get_dummies
-
     return map_partitions(
-        dummies,
+        get_meta_library(data).get_dummies,
         data,
         prefix=prefix,
         prefix_sep=prefix_sep,
         dummy_na=dummy_na,
         columns=columns,
         sparse=sparse,
         drop_first=drop_first,
```

### Comparing `dask-2023.5.0/dask/dataframe/rolling.py` & `dask-2023.5.1/dask/dataframe/rolling.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import datetime
 import inspect
 from numbers import Integral
 
 import pandas as pd
 from pandas.api.types import is_datetime64_any_dtype
 from pandas.core.window import Rolling as pd_Rolling
```

### Comparing `dask-2023.5.0/dask/dataframe/shuffle.py` & `dask-2023.5.1/dask/dataframe/shuffle.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,16 +1,18 @@
+from __future__ import annotations
+
 import contextlib
 import logging
 import math
 import shutil
 import tempfile
 import uuid
 import warnings
-from collections.abc import Sequence
-from typing import Any, Callable, List, Literal, Mapping, Optional, Tuple, Union
+from collections.abc import Callable, Mapping, Sequence
+from typing import Any, Literal
 
 import numpy as np
 import pandas as pd
 import tlz as toolz
 from pandas.api.types import is_numeric_dtype
 
 from dask import config
@@ -31,15 +33,15 @@
     df: DataFrame,
     partition_col: Series,
     repartition: bool,
     npartitions: int,
     upsample: float = 1.0,
     partition_size: float = 128e6,
     ascending: bool = True,
-) -> Tuple[List, List, List, bool]:
+) -> tuple[list, list, list, bool]:
     """
     Utility function to calculate divisions for calls to `map_partitions`
     """
     sizes = df.map_partitions(sizeof) if repartition else []
     divisions = partition_col._repartition_quantiles(npartitions, upsample=upsample)
     mins = partition_col.map_partitions(M.min)
     maxes = partition_col.map_partitions(M.max)
@@ -112,22 +114,22 @@
         )
 
     return divisions, mins.tolist(), maxes.tolist(), presorted
 
 
 def sort_values(
     df: DataFrame,
-    by: Union[str, List[str]],
-    npartitions: Optional[Union[int, Literal["auto"]]] = None,
-    ascending: Union[bool, List[bool]] = True,
-    na_position: Union[Literal["first"], Literal["last"]] = "last",
+    by: str | list[str],
+    npartitions: int | Literal["auto"] | None = None,
+    ascending: bool | list[bool] = True,
+    na_position: Literal["first"] | Literal["last"] = "last",
     upsample: float = 1.0,
     partition_size: float = 128e6,
-    sort_function: Optional[Callable[[pd.DataFrame], pd.DataFrame]] = None,
-    sort_function_kwargs: Optional[Mapping[str, Any]] = None,
+    sort_function: Callable[[pd.DataFrame], pd.DataFrame] | None = None,
+    sort_function_kwargs: Mapping[str, Any] | None = None,
     **kwargs,
 ) -> DataFrame:
     """See DataFrame.sort_values for docstring"""
     if na_position not in ("first", "last"):
         raise ValueError("na_position must be either 'first' or 'last'")
     if not isinstance(by, list):
         by = [by]
@@ -197,21 +199,21 @@
     )
     df = df.map_partitions(sort_function, **sort_kwargs)
     return df
 
 
 def set_index(
     df: DataFrame,
-    index: Union[str, Series],
-    npartitions: Optional[Union[int, Literal["auto"]]] = None,
-    shuffle: Optional[str] = None,
+    index: str | Series,
+    npartitions: int | Literal["auto"] | None = None,
+    shuffle: str | None = None,
     compute: bool = False,
     drop: bool = True,
     upsample: float = 1.0,
-    divisions: Optional[Sequence] = None,
+    divisions: Sequence | None = None,
     partition_size: float = 128e6,
     **kwargs,
 ) -> DataFrame:
     """See _Frame.set_index for docstring"""
     if npartitions == "auto":
         repartition = True
         npartitions = max(100, df.npartitions)
@@ -238,20 +240,20 @@
     return set_partition(
         df, index, divisions, shuffle=shuffle, drop=drop, compute=compute, **kwargs
     )
 
 
 def set_partition(
     df: DataFrame,
-    index: Union[str, Series],
+    index: str | Series,
     divisions: Sequence,
     max_branch: int = 32,
     drop: bool = True,
-    shuffle: Optional[str] = None,
-    compute: Optional[bool] = None,
+    shuffle: str | None = None,
+    compute: bool | None = None,
 ) -> DataFrame:
     """Group DataFrame by index
 
     Sets a new index and partitions data along that index according to
     divisions.  Divisions are often found by computing approximate quantiles.
     The function ``set_index`` will do both of these steps.
 
@@ -1013,15 +1015,15 @@
 
     graph = HighLevelGraph.from_collections(name, dsk, dependencies=[ddf])
     return new_dd_object(graph, name, ddf._meta, divisions)
 
 
 def _compute_partition_stats(
     column: Series, allow_overlap: bool = False, **kwargs
-) -> Tuple[List, List, List[int]]:
+) -> tuple[list, list, list[int]]:
     """For a given column, compute the min, max, and len of each partition.
 
     And make sure that the partitions are sorted relative to each other.
     NOTE: this does not guarantee that every partition is internally sorted.
     """
     mins = column.map_partitions(M.min, meta=column)
     maxes = column.map_partitions(M.max, meta=column)
@@ -1053,15 +1055,15 @@
     lens = methods.tolist(lens)
     if not allow_overlap:
         return (mins, maxes, lens)
     else:
         return (non_empty_mins, non_empty_maxes, lens)
 
 
-def compute_divisions(df: DataFrame, col: Optional[Any] = None, **kwargs) -> Tuple:
+def compute_divisions(df: DataFrame, col: Any | None = None, **kwargs) -> tuple:
     column = df.index if col is None else df[col]
     mins, maxes, _ = _compute_partition_stats(column, allow_overlap=False, **kwargs)
 
     return tuple(mins) + (maxes[-1],)
 
 
 def compute_and_set_divisions(df: DataFrame, **kwargs) -> DataFrame:
@@ -1072,17 +1074,17 @@
             return df
 
     return fix_overlap(df, mins, maxes, lens)
 
 
 def set_sorted_index(
     df: DataFrame,
-    index: Union[str, Series],
+    index: str | Series,
     drop: bool = True,
-    divisions: Optional[Sequence] = None,
+    divisions: Sequence | None = None,
     **kwargs,
 ) -> DataFrame:
     if isinstance(index, Series):
         meta = df._meta.set_index(index._meta, drop=drop)
     else:
         meta = df._meta.set_index(index, drop=drop)
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_accessors.py` & `dask-2023.5.1/dask/dataframe/tests/test_accessors.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 
 import numpy as np
 import pytest
 
 pd = pytest.importorskip("pandas")
 import dask.dataframe as dd
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_arithmetics_reduction.py` & `dask-2023.5.1/dask/dataframe/tests/test_arithmetics_reduction.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 import warnings
 from datetime import datetime
 
 import numpy as np
 import pandas as pd
 import pytest
@@ -26,16 +28,18 @@
 try:
     import scipy
 except ImportError:
     scipy = None
 
 try:
     import pyarrow as pa
+    from pyarrow.lib import ArrowNotImplementedError
 except ImportError:
     pa = None
+    ArrowNotImplementedError = None
 
 
 @pytest.mark.slow
 def test_arithmetics():
     dsk = {
         ("x", 0): pd.DataFrame({"a": [1, 2, 3], "b": [4, 5, 6]}, index=[0, 1, 3]),
         ("x", 1): pd.DataFrame({"a": [4, 5, 6], "b": [3, 2, 1]}, index=[5, 6, 8]),
@@ -1297,42 +1301,52 @@
     assert_eq(
         ddf.count(numeric_only=False, axis=1), df.count(numeric_only=False, axis=1)
     )
     assert_eq(ddf.count(numeric_only=True, axis=1), df.count(numeric_only=True, axis=1))
 
 
 @pytest.mark.parametrize(
-    "func", ["sum", "prod", "product", "min", "max", "count", "var"]
+    "func", ["sum", "prod", "product", "min", "max", "count", "std", "var", "quantile"]
 )
 def test_reductions_frame_dtypes_numeric_only_supported(func):
     df = pd.DataFrame(
         {
             "int": [1, 2, 3, 4, 5, 6, 7, 8],
             "float": [1.0, 2.0, 3.0, 4.0, np.nan, 6.0, 7.0, 8.0],
             "dt": [pd.NaT] + [datetime(2011, i, 1) for i in range(1, 8)],
             "str": list("abcdefgh"),
             "timedelta": pd.to_timedelta([1, 2, 3, 4, 5, 6, 7, np.nan]),
             "bool": [True, False] * 4,
         }
     )
+    npartitions = 3
+    if func == "quantile":
+        # bool doesn't work in pandas quantile
+        df = df.drop(columns="bool")
+        npartitions = 1  # https://github.com/dask/dask/issues/9227
 
-    ddf = dd.from_pandas(df, 3)
-    numeric_only_false_raises = ["sum", "prod", "product", "var"]
+    ddf = dd.from_pandas(df, npartitions)
+
+    numeric_only_false_raises = ["sum", "prod", "product", "std", "var", "quantile"]
 
     # `numeric_only=True` is always supported
     assert_eq(
         getattr(df, func)(numeric_only=True),
         getattr(ddf, func)(numeric_only=True),
     )
+    errors = TypeError if pa is None else (TypeError, ArrowNotImplementedError)
 
     # `numeric_only=False`
     if func in numeric_only_false_raises:
         with pytest.raises(
-            TypeError,
-            match="'DatetimeArray' with dtype datetime64.*|'DatetimeArray' does not implement reduction",
+            errors,
+            match="'DatetimeArray' with dtype datetime64.*|"
+            "'DatetimeArray' does not implement reduction|could not convert|"
+            "'ArrowStringArray' with dtype string"
+            "|unsupported operand|no kernel",
         ):
             getattr(ddf, func)(numeric_only=False)
 
         warning = FutureWarning
     else:
         assert_eq(
             getattr(df, func)(numeric_only=False),
@@ -1340,40 +1354,47 @@
         )
         warning = None
 
     # `numeric_only` default value
     if PANDAS_GT_200:
         if func in numeric_only_false_raises:
             with pytest.raises(
-                TypeError,
-                match="'DatetimeArray' with dtype datetime64.*|'DatetimeArray' does not implement reduction",
+                errors,
+                match="'DatetimeArray' with dtype datetime64.*|"
+                "'DatetimeArray' does not implement reduction|could not convert|"
+                "'ArrowStringArray' with dtype string"
+                "|unsupported operand|no kernel",
             ):
                 getattr(ddf, func)()
         else:
             assert_eq(
                 getattr(df, func)(),
                 getattr(ddf, func)(),
             )
     elif PANDAS_GT_150:
         with pytest.warns(warning, match="The default value of numeric_only"):
             pd_result = getattr(df, func)()
         with pytest.warns(warning, match="The default value of numeric_only"):
             dd_result = getattr(ddf, func)()
         assert_eq(pd_result, dd_result)
     else:
-        if func == "var":
+        if func in ["std", "var", "quantile"]:
             warning = None
         with pytest.warns(warning, match="Dropping of nuisance"):
             pd_result = getattr(df, func)()
         with pytest.warns(warning, match="Dropping of nuisance"):
             dd_result = getattr(ddf, func)()
         assert_eq(pd_result, dd_result)
 
-    df_numerics = df[["int", "float", "bool"]]
-    ddf_numerics = ddf[["int", "float", "bool"]]
+    num_cols = ["int", "float"]
+    if func != "quantile":
+        num_cols.append("bool")
+
+    df_numerics = df[num_cols]
+    ddf_numerics = ddf[num_cols]
 
     assert_eq(
         getattr(df_numerics, func)(),
         getattr(ddf_numerics, func)(),
     )
     assert_eq(
         getattr(df_numerics, func)(numeric_only=False),
@@ -1381,15 +1402,14 @@
     )
 
 
 @pytest.mark.parametrize(
     "func",
     [
         "mean",
-        "std",
         "sem",
     ],
 )
 def test_reductions_frame_dtypes_numeric_only(func):
     df = pd.DataFrame(
         {
             "int": [1, 2, 3, 4, 5, 6, 7, 8],
@@ -1430,14 +1450,44 @@
 
     assert_eq(
         getattr(df_numerics, func)(),
         getattr(ddf_numerics, func)(),
     )
 
 
+@pytest.mark.parametrize("func", ["skew", "kurtosis"])
+def test_skew_kurt_numeric_only_false(func):
+    pytest.importorskip("scipy.stats")
+    df = pd.DataFrame(
+        {
+            "int": [1, 2, 3, 4, 5, 6, 7, 8],
+            "float": [1.0, 2.0, 3.0, 4.0, np.nan, 6.0, 7.0, 8.0],
+            "dt": [pd.NaT] + [datetime(2010, i, 1) for i in range(1, 8)],
+        }
+    )
+    ddf = dd.from_pandas(df, npartitions=2)
+
+    ctx = pytest.raises(TypeError, match="does not support|does not implement")
+
+    with ctx:
+        getattr(df, func)(numeric_only=False)
+    with ctx:
+        getattr(ddf, func)(numeric_only=False)
+
+    if PANDAS_GT_150 and not PANDAS_GT_200:
+        ctx = pytest.warns(FutureWarning, match="default value")
+    elif not PANDAS_GT_150:
+        ctx = pytest.warns(FutureWarning, match="nuisance columns")
+
+    with ctx:
+        getattr(df, func)()
+    with ctx:
+        getattr(ddf, func)()
+
+
 @pytest.mark.parametrize("split_every", [False, 2])
 def test_reductions_frame_nan(split_every):
     df = pd.DataFrame(
         {
             "a": [1, 2, np.nan, 4, 5, 6, 7, 8],
             "b": [1, 2, np.nan, np.nan, np.nan, 5, np.nan, np.nan],
             "c": [np.nan] * 8,
@@ -1647,39 +1697,26 @@
         }
     )
 
     ddf = dd.from_pandas(pdf, 3)
 
     kwargs = {} if numeric_only is None else {"numeric_only": numeric_only}
 
-    success = True
-    ctx = contextlib.nullcontext()
-    if numeric_only is False or (PANDAS_GT_200 and numeric_only is None):
-        ctx = pytest.raises(NotImplementedError, match="numeric_only")
-        success = False
-    elif numeric_only is None:
-        ctx = pytest.warns(FutureWarning, match="numeric_only")
-
     # Series test (same line twice to make sure data structure wasn't mutated)
     assert_eq(ddf["dt1"].std(**kwargs), pdf["dt1"].std(**kwargs))
     assert_eq(ddf["dt1"].std(**kwargs), pdf["dt1"].std(**kwargs))
 
     # DataFrame test (same line twice to make sure data structure wasn't mutated)
     expected = pdf.std(axis=axis, **kwargs)
-    result = None
-    with ctx:
-        result = ddf.std(axis=axis, **kwargs)
-    if success:
-        assert_near_timedeltas(result.compute(), expected)
+    result = ddf.std(axis=axis, **kwargs)
+    assert_near_timedeltas(result.compute(), expected)
 
     expected = pdf.std(axis=axis, **kwargs)
-    with ctx:
-        result = ddf.std(axis=axis, **kwargs)
-    if success:
-        assert_near_timedeltas(result.compute(), expected)
+    result = ddf.std(axis=axis, **kwargs)
+    assert_near_timedeltas(result.compute(), expected)
 
 
 @pytest.mark.parametrize("axis", [0, 1])
 @pytest.mark.parametrize("skipna", [False, True])
 @pytest.mark.parametrize("numeric_only", [True, False, None])
 def test_datetime_std_with_larger_dataset(axis, skipna, numeric_only):
     num_rows = 250
@@ -1714,38 +1751,25 @@
         )
 
     ddf = dd.from_pandas(pdf, 8)
 
     kwargs = {} if numeric_only is None else {"numeric_only": numeric_only}
     kwargs["skipna"] = skipna
 
-    success = True
-    ctx = contextlib.nullcontext()
-    if numeric_only is False or (PANDAS_GT_200 and numeric_only is None):
-        ctx = pytest.raises(NotImplementedError, match="numeric_only")
-        success = False
-    elif numeric_only is None:
-        ctx = pytest.warns(FutureWarning, match="numeric_only")
-
-    result = None
     expected = pdf[["dt1"]].std(axis=axis, **kwargs)
-    with ctx:
-        result = ddf[["dt1"]].std(axis=axis, **kwargs)
-    if success:
-        assert_near_timedeltas(result.compute(), expected)
+    result = ddf[["dt1"]].std(axis=axis, **kwargs)
+    assert_near_timedeltas(result.compute(), expected)
 
     # Same thing but as Series. No axis, since axis=1 raises error
     assert_near_timedeltas(ddf["dt1"].std(**kwargs).compute(), pdf["dt1"].std(**kwargs))
 
     # Computation on full dataset
     expected = pdf.std(axis=axis, **kwargs)
-    with ctx:
-        result = ddf.std(axis=axis, **kwargs)
-    if success:
-        assert_near_timedeltas(result.compute(), expected)
+    result = ddf.std(axis=axis, **kwargs)
+    assert_near_timedeltas(result.compute(), expected)
 
 
 @pytest.mark.parametrize("skipna", [False, True])
 @pytest.mark.parametrize("numeric_only", [True, False, None])
 def test_datetime_std_across_axis1_null_results(skipna, numeric_only):
     pdf = pd.DataFrame(
         {
@@ -1760,35 +1784,32 @@
     )
 
     ddf = dd.from_pandas(pdf, 3)
 
     kwargs = {} if numeric_only is None else {"numeric_only": numeric_only}
     kwargs["skipna"] = skipna
 
-    pctx = contextlib.nullcontext()
-    dctx = contextlib.nullcontext()
+    ctx = contextlib.nullcontext()
     success = True
     if numeric_only is False or (PANDAS_GT_200 and numeric_only is None):
-        dctx = pytest.raises(NotImplementedError, match="numeric_only")
-        pctx = pytest.raises(TypeError)
+        ctx = pytest.raises(TypeError)
         success = False
     elif numeric_only is None:
-        dctx = pctx = pytest.warns(FutureWarning, match="numeric_only")
+        ctx = pytest.warns(FutureWarning, match="numeric_only")
 
     # Single column always results in NaT
     expected = pdf[["dt1"]].std(axis=1, **kwargs)
-    with dctx:
-        result = ddf[["dt1"]].std(axis=1, **kwargs)
+    result = ddf[["dt1"]].std(axis=1, **kwargs)
     if success:
         assert_eq(result, expected)
 
     # Mix of datetimes with other numeric types produces NaNs
-    with pctx:
+    with ctx:
         expected = pdf.std(axis=1, **kwargs)
-    with dctx:
+    with ctx:
         result = ddf.std(axis=1, **kwargs)
     if success:
         assert_eq(result, expected)
 
     # Test with mix of na and truthy datetimes
     pdf2 = pd.DataFrame(
         {
@@ -1803,49 +1824,68 @@
             ],
         }
     )
 
     ddf2 = dd.from_pandas(pdf2, 3)
 
     expected = pdf2.std(axis=1, **kwargs)
-    with dctx:
-        result = ddf2.std(axis=1, **kwargs)
+    result = ddf2.std(axis=1, **kwargs)
     if success:
         assert_eq(result, expected)
 
 
+def test_std_raises_on_index():
+    with pytest.raises(
+        NotImplementedError,
+        match="`std` is only supported with objects that are Dataframes or Series",
+    ):
+        dd.from_pandas(pd.DataFrame({"test": [1, 2]}), npartitions=2).index.std()
+
+
+@pytest.mark.skipif(not PANDAS_GT_200, reason="ArrowDtype not supported")
+def test_std_raises_with_arrow_string_ea():
+    pa = pytest.importorskip("pyarrow")
+    ser = pd.Series(["a", "b", "c"], dtype=pd.ArrowDtype(pa.string()))
+    ds = dd.from_pandas(ser, npartitions=2)
+    with pytest.raises(ValueError, match="`std` not supported with string series"):
+        ds.std()
+
+
 @pytest.mark.parametrize(
-    "dtypes",
+    "dtype",
     [
         pytest.param(
-            ("int64[pyarrow]", "float64[pyarrow]"),
+            "int64[pyarrow]",
             marks=pytest.mark.skipif(
-                pa is None or not PANDAS_GT_150,
-                reason="requires pyarrow installed and ArrowDtype",
+                pa is None or not PANDAS_GT_150, reason="requires pyarrow installed"
             ),
         ),
-        ("Int64", "Float64"),
+        pytest.param(
+            "float64[pyarrow]",
+            marks=pytest.mark.skipif(
+                pa is None or not PANDAS_GT_150, reason="requires pyarrow installed"
+            ),
+        ),
+        "Int64",
+        "Int32",
+        "Float64",
+        "UInt64",
     ],
 )
-@pytest.mark.parametrize("func", ["std", "var", "skew"])
-def test_reductions_with_pandas_and_arrow_ea(dtypes, func):
-    if func in ["skew"]:
+@pytest.mark.parametrize("func", ["std", "var", "skew", "kurtosis"])
+def test_reductions_with_pandas_and_arrow_ea(dtype, func):
+    if func in ["skew", "kurtosis"]:
         pytest.importorskip("scipy")
-        if "pyarrow" in dtypes[0]:
-            pytest.xfail("skew not implemented for arrow dtypes")
-
-    pdf = pd.DataFrame({"a": [1, 2, 3, 4], "b": [4, 5, 6, 7]}).astype(
-        {"a": dtypes[0], "b": dtypes[1]}
-    )
-    ddf = dd.from_pandas(pdf, npartitions=2)
-    pd_result = getattr(pdf, func)()
-    dd_result = getattr(ddf, func)()
-
-    assert_eq(dd_result, pd_result, check_dtype=False)  # _meta is wrongly NA
-
+        if "pyarrow" in dtype:
+            pytest.xfail("skew/kurtosis not implemented for arrow dtypes")
 
-def test_std_raises_on_index():
-    with pytest.raises(
-        NotImplementedError,
-        match="`std` is only supported with objects that are Dataframes or Series",
-    ):
-        dd.from_pandas(pd.DataFrame({"test": [1, 2]}), npartitions=2).index.std()
+    ser = pd.Series([1, 2, 3, 4], dtype=dtype)
+    ds = dd.from_pandas(ser, npartitions=2)
+    pd_result = getattr(ser, func)()
+    dd_result = getattr(ds, func)()
+    if func == "kurtosis":
+        n = ser.shape[0]
+        factor = ((n - 1) * (n + 1)) / ((n - 2) * (n - 3))
+        offset = (6 * (n - 1)) / ((n - 2) * (n - 3))
+        dd_result = factor * dd_result + offset
+    # _meta is wrongly NA
+    assert_eq(dd_result, pd_result, check_dtype=False)
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_boolean.py` & `dask-2023.5.1/dask/dataframe/tests/test_boolean.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pandas as pd
 
 import dask.dataframe as dd
 
 
 def test_meta():
     values = pd.array([True, False, None], dtype="boolean")
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_categorical.py` & `dask-2023.5.1/dask/dataframe/tests/test_categorical.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 import operator
 import warnings
 
 import numpy as np
 import pandas as pd
 import pytest
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_dataframe.py` & `dask-2023.5.1/dask/dataframe/tests/test_dataframe.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 import decimal
 import platform
 import warnings
 import weakref
 import xml.etree.ElementTree
 from datetime import datetime, timedelta
@@ -54,14 +56,20 @@
 from dask.utils_test import _check_warning, hlg_layer
 
 try:
     import crick
 except ImportError:
     crick = None
 
+try:
+    from pyarrow.lib import ArrowNotImplementedError
+except ImportError:
+    ArrowNotImplementedError = RuntimeError  # some unrelated error to make pytest pass
+
+
 dsk = {
     ("x", 0): pd.DataFrame({"a": [1, 2, 3], "b": [4, 5, 6]}, index=[0, 1, 3]),
     ("x", 1): pd.DataFrame({"a": [4, 5, 6], "b": [3, 2, 1]}, index=[5, 6, 8]),
     ("x", 2): pd.DataFrame({"a": [7, 8, 9], "b": [0, 0, 0]}, index=[9, 9, 9]),
 }
 meta = make_meta(
     {"a": "i8", "b": "i8"}, index=pd.Index([], "i8"), parent_meta=pd.DataFrame()
@@ -1484,16 +1492,18 @@
 
     assert result.name == "b"
     assert result.compute().name == "b"
     assert_eq(result, exp)
 
 
 @contextlib.contextmanager
-def assert_numeric_only_default_warning(numeric_only):
-    if numeric_only is None and not PANDAS_GT_200:
+def assert_numeric_only_default_warning(numeric_only, func=None):
+    if func == "quantile" and not PANDAS_GT_150:
+        ctx = contextlib.nullcontext()
+    elif numeric_only is None and not PANDAS_GT_200:
         ctx = pytest.warns(FutureWarning, match="default value of numeric_only")
     else:
         ctx = contextlib.nullcontext()
 
     with ctx:
         yield
 
@@ -1547,28 +1557,30 @@
     numeric_only_kwarg = {}
     if numeric_only is not None:
         numeric_only_kwarg = {"numeric_only": numeric_only}
 
     if numeric_only is False or (PANDAS_GT_200 and numeric_only is None):
         with pytest.raises(TypeError):
             df.quantile(**numeric_only_kwarg)
-        with pytest.raises(NotImplementedError, match="numeric_only=False"):
+        with pytest.raises(
+            (TypeError, ArrowNotImplementedError), match="unsupported operand|no kernel"
+        ):
             ddf.quantile(**numeric_only_kwarg)
     else:
-        with assert_numeric_only_default_warning(numeric_only):
+        with assert_numeric_only_default_warning(numeric_only, "quantile"):
             result = ddf.quantile(method=method, **numeric_only_kwarg)
         assert result.npartitions == 1
         assert result.divisions == ("A", "X")
 
         result = result.compute()
         assert isinstance(result, pd.Series)
         assert result.name == 0.5
         assert_eq(result, expected[0], check_names=False)
 
-        with assert_numeric_only_default_warning(numeric_only):
+        with assert_numeric_only_default_warning(numeric_only, "quantile"):
             result = ddf.quantile([0.25, 0.75], method=method, **numeric_only_kwarg)
         assert result.npartitions == 1
         assert result.divisions == (0.25, 0.75)
 
         result = result.compute()
         assert isinstance(result, pd.DataFrame)
         tm.assert_index_equal(result.index, pd.Index([0.25, 0.75]))
@@ -1577,25 +1589,38 @@
         assert (result == expected[1]).all().all()
 
         with warnings.catch_warnings(record=True):
             warnings.filterwarnings("ignore", category=FutureWarning)
             # pandas issues a warning with 1.5, but not 1.3
             expected = df.quantile(axis=1, **numeric_only_kwarg)
 
-        with assert_numeric_only_default_warning(numeric_only):
+        with assert_numeric_only_default_warning(numeric_only, "quantile"):
             result = ddf.quantile(axis=1, method=method, **numeric_only_kwarg)
 
         assert_eq(result, expected)
 
         with pytest.raises(ValueError), assert_numeric_only_default_warning(
-            numeric_only
+            numeric_only, "quantile"
         ):
             ddf.quantile([0.25, 0.75], axis=1, method=method, **numeric_only_kwarg)
 
 
+def test_quantile_datetime_numeric_only_false():
+    df = pd.DataFrame(
+        {
+            "int": [1, 2, 3, 4, 5, 6, 7, 8],
+            "dt": [pd.NaT] + [datetime(2011, i, 1) for i in range(1, 8)],
+            "timedelta": pd.to_timedelta([1, 2, 3, 4, 5, 6, 7, np.nan]),
+        }
+    )
+    ddf = dd.from_pandas(df, 1)
+
+    assert_eq(ddf.quantile(numeric_only=False), df.quantile(numeric_only=False))
+
+
 def test_quantile_for_possibly_unsorted_q():
     """check that quantile is giving correct answers even when quantile parameter, q, may be unsorted.
 
     See https://github.com/dask/dask/issues/4642.
     """
     # prepare test case where percentiles should equal values
     A = da.arange(0, 101)
@@ -2995,14 +3020,26 @@
     ddf = dd.from_pandas(df, npartitions=2)
     ddf2 = ddf.drop(columns=columns)
     ddf["new"] = ddf["a"] + 1  # Check that ddf2 is not modified
 
     assert_eq(df.drop(columns=columns), ddf2)
 
 
+def test_drop_meta_mismatch():
+    # Ensure `drop()` works when partitions have mismatching columns
+    # (e.g. as is possible with `read_csv`)
+    df1 = pd.DataFrame({"x": [1, 2, 3], "y": [4.5, 6, 7]})
+    df2 = pd.DataFrame({"x": [4, 5, 6]})
+    df = pd.concat([df1, df2])
+    ddf = dd.from_delayed(
+        [dask.delayed(df1), dask.delayed(df2)], meta=df, verify_meta=False
+    )
+    assert_eq(df.drop(columns=["x"]), ddf.drop(columns=["x"]))
+
+
 def test_gh580():
     df = pd.DataFrame({"x": np.arange(10, dtype=float)})
     ddf = dd.from_pandas(df, 2)
     assert_eq(np.cos(df["x"]), np.cos(ddf["x"]))
     assert_eq(np.cos(df["x"]), np.cos(ddf["x"]))
 
 
@@ -3043,14 +3080,18 @@
     assert_eq(ddf.x.to_timestamp(), df.x.to_timestamp(), check_freq=False)
     assert_eq(
         ddf.x.to_timestamp(freq="M", how="s").compute(),
         df.x.to_timestamp(freq="M", how="s"),
         check_freq=False,
     )
 
+    ddf = dd.from_pandas(df, npartitions=4)
+    assert_eq(ddf.to_timestamp(how="end"), df.to_timestamp(how="end"))
+    assert_eq(ddf.x.to_timestamp(how="end"), df.x.to_timestamp(how="end"))
+
 
 def test_to_frame():
     s = pd.Series([1, 2, 3], name="foo")
     a = dd.from_pandas(s, npartitions=2)
 
     assert_eq(s.to_frame(), a.to_frame())
     assert_eq(s.to_frame("bar"), a.to_frame("bar"))
@@ -3126,28 +3167,28 @@
 
     assert_eq(
         ddf.x.apply(lambda x: x + 1, meta=("x", int)), df.x.apply(lambda x: x + 1)
     )
 
     # specify meta
     assert_eq(
-        ddf.apply(lambda xy: xy[0] + xy[1], axis=1, meta=(None, int)),
-        df.apply(lambda xy: xy[0] + xy[1], axis=1),
+        ddf.apply(lambda xy: xy.iloc[0] + xy.iloc[1], axis=1, meta=(None, int)),
+        df.apply(lambda xy: xy.iloc[0] + xy.iloc[1], axis=1),
     )
     assert_eq(
-        ddf.apply(lambda xy: xy[0] + xy[1], axis="columns", meta=(None, int)),
-        df.apply(lambda xy: xy[0] + xy[1], axis="columns"),
+        ddf.apply(lambda xy: xy.iloc[0] + xy.iloc[1], axis="columns", meta=(None, int)),
+        df.apply(lambda xy: xy.iloc[0] + xy.iloc[1], axis="columns"),
     )
 
     # inference
     with warnings.catch_warnings():
         warnings.simplefilter("ignore", UserWarning)
         assert_eq(
-            ddf.apply(lambda xy: xy[0] + xy[1], axis=1),
-            df.apply(lambda xy: xy[0] + xy[1], axis=1),
+            ddf.apply(lambda xy: xy.iloc[0] + xy.iloc[1], axis=1),
+            df.apply(lambda xy: xy.iloc[0] + xy.iloc[1], axis=1),
         )
     with warnings.catch_warnings():
         warnings.simplefilter("ignore", UserWarning)
         assert_eq(ddf.apply(lambda xy: xy, axis=1), df.apply(lambda xy: xy, axis=1))
 
     warning = FutureWarning if PANDAS_GT_210 else None
     # specify meta
@@ -3224,18 +3265,22 @@
     func = lambda row: row["x"] + row["y"]
 
     with pytest.warns(FutureWarning, match="Meta is not valid"):
         ddf.apply(func, axis=1, meta=int)
 
 
 @pytest.mark.skipif(not PANDAS_GT_210, reason="Not available before")
-def test_dataframe_map():
-    df = pd.DataFrame({"x": [1, 2, 3, 4], "y": [10, 20, 30, 40]})
+@pytest.mark.parametrize("na_action", [None, "ignore"])
+def test_dataframe_map(na_action):
+    df = pd.DataFrame({"x": [1, 2, 3, np.nan], "y": [10, 20, 30, 40]})
     ddf = dd.from_pandas(df, npartitions=2)
-    assert_eq(ddf.map(lambda x: x + 1), df.map(lambda x: x + 1))
+    assert_eq(
+        ddf.map(lambda x: x + 1, na_action=na_action),
+        df.map(lambda x: x + 1, na_action=na_action),
+    )
     assert_eq(ddf.map(lambda x: (x, x)), df.map(lambda x: (x, x)))
 
 
 @pytest.mark.skipif(PANDAS_GT_210, reason="Available at 2.1")
 def test_dataframe_map_raises():
     df = pd.DataFrame({"x": [1, 2, 3, 4], "y": [10, 20, 30, 40]})
     ddf = dd.from_pandas(df, npartitions=2)
@@ -3678,14 +3723,23 @@
         res2 = f(ddf.a, m, 5, split_every=2)
         sol = f(df.a, m, 5)
         assert_eq(res, sol)
         assert_eq(res2, sol)
         assert res._name != res2._name
 
 
+def test_nlargest_nsmallest_raises():
+    df = pd.DataFrame({"a": [1, 2, 3]})
+    ddf = dd.from_pandas(df, npartitions=2)
+    with pytest.raises(TypeError, match="missing required positional"):
+        ddf.nlargest()
+    with pytest.raises(TypeError, match="missing required positional"):
+        ddf.nsmallest()
+
+
 def test_reset_index():
     df = pd.DataFrame({"x": [1, 2, 3, 4], "y": [10, 20, 30, 40]})
     ddf = dd.from_pandas(df, npartitions=2)
 
     sol = df.reset_index()
     res = ddf.reset_index()
     assert all(d is None for d in res.divisions)
@@ -4221,14 +4275,51 @@
         )
         assert (
             ddf.a.idxmin(skipna=skipna)._name
             != ddf.a.idxmin(skipna=skipna, split_every=2)._name
         )
 
 
+@pytest.mark.parametrize("func", ["idxmin", "idxmax"])
+def test_idxmaxmin_numeric_only(func):
+    df = pd.DataFrame(
+        {
+            "int": [1, 2, 3, 4, 5, 6, 7, 8],
+            "float": [1.0, 2.0, 3.0, 4.0, np.nan, 6.0, 7.0, 8.0],
+            "dt": [pd.NaT] + [datetime(2010, i, 1) for i in range(1, 8)],
+            "timedelta": pd.to_timedelta([1, 2, 3, 4, 5, 6, 7, np.nan]),
+            "bool": [True, False] * 4,
+        }
+    )
+    ddf = dd.from_pandas(df, npartitions=2)
+
+    if PANDAS_GT_150:
+        assert_eq(
+            getattr(ddf, func)(numeric_only=False),
+            getattr(df, func)(numeric_only=False).sort_index(),
+        )
+        assert_eq(
+            getattr(ddf, func)(numeric_only=True),
+            getattr(df, func)(numeric_only=True).sort_index(),
+        )
+
+        assert_eq(
+            getattr(ddf.drop(columns="bool"), func)(numeric_only=True, axis=1),
+            getattr(df.drop(columns="bool"), func)(
+                numeric_only=True, axis=1
+            ).sort_index(),
+        )
+
+    else:
+        with pytest.raises(TypeError, match="got an unexpected keyword"):
+            getattr(df, func)(numeric_only=False)
+        with pytest.raises(NotImplementedError, match="idxmax for pandas"):
+            getattr(ddf, func)(numeric_only=False)
+
+
 def test_idxmaxmin_empty_partitions():
     df = pd.DataFrame(
         {"a": [1, 2, 3], "b": [1.5, 2, 3], "c": [np.NaN] * 3, "d": [1, 2, np.NaN]}
     )
     empty = df.iloc[:0]
 
     ddf = dd.concat(
@@ -4756,48 +4847,66 @@
     ddf = dd.from_pandas(df, npartitions=5)
     assert_eq(df.loc[:"02.02.2015"], ddf.loc[:"02.02.2015"])
     assert_eq(df.loc["02.02.2015":], ddf.loc["02.02.2015":])
     assert_eq(df[0].loc[:"02.02.2015"], ddf[0].loc[:"02.02.2015"])
     assert_eq(df[0].loc["02.02.2015":], ddf[0].loc["02.02.2015":])
 
 
-def test_to_datetime():
-    df = pd.DataFrame({"year": [2015, 2016], "month": [2, 3], "day": [4, 5]})
+@pytest.mark.parametrize("gpu", [False, pytest.param(True, marks=pytest.mark.gpu)])
+def test_to_datetime(gpu):
+    xd = pd if not gpu else pytest.importorskip("cudf")
+
+    # meta dtype is inconsistent for cuDF-backed frames
+    check_dtype = not gpu
+
+    df = xd.DataFrame({"year": [2015, 2016], "month": ["2", "3"], "day": [4, 5]})
     df.index.name = "ix"
     ddf = dd.from_pandas(df, npartitions=2)
 
-    assert_eq(pd.to_datetime(df), dd.to_datetime(ddf))
+    assert_eq(xd.to_datetime(df), dd.to_datetime(ddf), check_dtype=check_dtype)
+    assert_eq(xd.to_datetime(df), dd.to_datetime(df), check_dtype=check_dtype)
 
-    s = pd.Series(["3/11/2000", "3/12/2000", "3/13/2000"] * 100)
-    s.index = s.values
+    s = xd.Series(
+        ["3/11/2000", "3/12/2000", "3/13/2000"] * 100,
+        index=["3/11/2000", "3/12/2000", "3/13/2000"] * 100,
+    )
     ds = dd.from_pandas(s, npartitions=10, sort=False)
 
     if PANDAS_GT_200:
         ctx = pytest.warns(UserWarning, match="'infer_datetime_format' is deprecated")
     else:
         ctx = contextlib.nullcontext()
 
     with ctx:
-        expected = pd.to_datetime(s, infer_datetime_format=True)
+        expected = xd.to_datetime(s, infer_datetime_format=True)
     with ctx:
         result = dd.to_datetime(ds, infer_datetime_format=True)
-    assert_eq(expected, result)
+    assert_eq(expected, result, check_dtype=check_dtype)
+    with ctx:
+        result = dd.to_datetime(s, infer_datetime_format=True)
+    assert_eq(expected, result, check_dtype=check_dtype)
 
     with ctx:
-        expected = pd.to_datetime(s.index, infer_datetime_format=True)
+        expected = xd.to_datetime(s.index, infer_datetime_format=True)
     with ctx:
         result = dd.to_datetime(ds.index, infer_datetime_format=True)
     assert_eq(expected, result, check_divisions=False)
 
-    assert_eq(
-        pd.to_datetime(s, utc=True),
-        dd.to_datetime(ds, utc=True),
-    )
+    # cuDF does not yet support timezone-aware datetimes
+    if not gpu:
+        assert_eq(
+            xd.to_datetime(s, utc=True),
+            dd.to_datetime(ds, utc=True),
+        )
+        assert_eq(
+            xd.to_datetime(s, utc=True),
+            dd.to_datetime(s, utc=True),
+        )
 
-    for arg in ("2021-08-03", 2021):
+    for arg in ("2021-08-03", 2021, s.index):
         with pytest.raises(NotImplementedError, match="non-index-able arguments"):
             dd.to_datetime(arg)
 
 
 def test_to_timedelta():
     s = pd.Series(range(10))
     ds = dd.from_pandas(s, npartitions=2)
@@ -5664,15 +5773,15 @@
 
 
 def test_index_is_monotonic_dt64():
     s = pd.Series(1, index=pd.date_range("20130101", periods=20))
     ds = dd.from_pandas(s, npartitions=10, sort=False)
     assert_eq(s.index.is_monotonic_increasing, ds.index.is_monotonic_increasing)
 
-    s_2 = pd.Series(1, index=list(reversed(s)))
+    s_2 = s[::-1]
     ds_2 = dd.from_pandas(s_2, npartitions=10, sort=False)
     assert_eq(s_2.index.is_monotonic_decreasing, ds_2.index.is_monotonic_decreasing)
 
 
 def test_is_monotonic_empty_partitions():
     df = pd.DataFrame({"a": [1, 2, 3, 4], "b": [4, 3, 2, 1]})
     ddf = dd.from_pandas(df, npartitions=2)
@@ -5873,7 +5982,45 @@
     expected = df.mask(cond=cond, other=5)
     result = ddf.mask(cond=dd_cond, other=5)
     assert_eq(expected, result)
 
     expected = df.where(cond=cond, other=5)
     result = ddf.where(cond=dd_cond, other=5)
     assert_eq(expected, result)
+
+
+@pytest.mark.parametrize(
+    "func, kwargs",
+    [
+        ("select_dtypes", {"include": "integer"}),
+        ("describe", {"include": "integer"}),
+        ("nunique", {}),
+        ("quantile", {}),
+    ],
+)
+def test_duplicate_columns(func, kwargs):
+    df = pd.DataFrame(
+        {
+            "int": [1, 2, 3],
+            "float": [1.0, 2.0, 3.0],
+            "d": 1,
+        }
+    )
+    df.columns = ["a", "a", "d"]
+    ddf = dd.from_pandas(df, npartitions=1)
+
+    assert_eq(
+        getattr(df, func)(**kwargs),
+        getattr(ddf, func)(**kwargs),
+    )
+
+
+def test_mask_where_callable():
+    """https://github.com/dask/dask/issues/10282"""
+    pdf = pd.DataFrame({"x": [1, None]})
+    ddf = dd.from_pandas(pdf, npartitions=1)
+
+    # dataframe
+    assert_eq(pdf.where(lambda d: d.isna(), 3), ddf.where(lambda d: d.isna(), 3))
+
+    #  series
+    assert_eq(pdf.x.where(lambda d: d == 1, 2), ddf.x.where(lambda d: d == 1, 2))
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_extensions.py` & `dask-2023.5.1/dask/dataframe/tests/test_extensions.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from decimal import Decimal
 
 import pytest
 
 import dask.dataframe as dd
 from dask.dataframe.utils import assert_eq
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_format.py` & `dask-2023.5.1/dask/dataframe/tests/test_format.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,8 +1,10 @@
 # flake8: noqa: W291
+from __future__ import annotations
+
 from textwrap import dedent
 
 import numpy as np
 import pandas as pd
 import pytest
 
 import dask.array as da
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_groupby.py` & `dask-2023.5.1/dask/dataframe/tests/test_groupby.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,12 +1,15 @@
+from __future__ import annotations
+
 import collections
 import contextlib
 import operator
 import pickle
 import warnings
+from datetime import datetime
 from functools import partial
 
 import numpy as np
 import pandas as pd
 import pytest
 
 import dask
@@ -3651,7 +3654,52 @@
     dd_result = getattr(ddf.groupby("A"), func)(numeric_only=False)
     pd_result = getattr(df.groupby("A"), func)(numeric_only=False)
     assert_eq(dd_result, pd_result)
 
     dd_result = getattr(ddf.groupby("A"), func)(numeric_only=True)
     pd_result = getattr(df.groupby("A"), func)(numeric_only=True)
     assert_eq(dd_result, pd_result)
+
+
+@pytest.mark.parametrize("func", ["cumsum", "cumprod"])
+def test_groupby_numeric_only_false(func):
+    df = pd.DataFrame(
+        {
+            "int": [1, 2, 3, 4, 5, 6, 7, 8],
+            "float": [1.0, 2.0, 3.0, 4.0, np.nan, 6.0, 7.0, 8.0],
+            "dt": [pd.NaT] + [datetime(2010, i, 1) for i in range(1, 8)],
+            "A": 1,
+        }
+    )
+    ddf = dd.from_pandas(df, npartitions=2)
+
+    if PANDAS_GT_200:
+        ctx = pytest.raises(TypeError, match="does not support")
+
+        with ctx:
+            getattr(ddf.groupby("A"), func)(numeric_only=False)
+        with ctx:
+            getattr(df.groupby("A"), func)(numeric_only=False)
+
+        with ctx:
+            getattr(ddf.groupby("A"), func)()
+        with ctx:
+            getattr(df.groupby("A"), func)()
+    else:
+        ctx = pytest.warns(FutureWarning, match="Dropping invalid columns")
+
+        with ctx:
+            dd_result = getattr(ddf.groupby("A"), func)(numeric_only=False)
+        with ctx:
+            pd_result = getattr(df.groupby("A"), func)(numeric_only=False)
+        assert_eq(dd_result, pd_result)
+
+        if PANDAS_GT_150:
+            ctx = pytest.warns(FutureWarning, match="default value of numeric_only")
+        else:
+            ctx = contextlib.nullcontext()
+
+        with ctx:
+            dd_result = getattr(ddf.groupby("A"), func)()
+        with ctx:
+            pd_result = getattr(df.groupby("A"), func)()
+        assert_eq(dd_result, pd_result)
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_hashing.py` & `dask-2023.5.1/dask/dataframe/tests/test_hashing.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pandas as pd
 import pytest
 from pandas.util import hash_pandas_object
 
 import dask.dataframe as dd
 from dask.dataframe import _compat
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_hyperloglog.py` & `dask-2023.5.1/dask/dataframe/tests/test_hyperloglog.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pandas as pd
 import pytest
 
 import dask.dataframe as dd
 
 rs = np.random.RandomState(96)
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_indexing.py` & `dask-2023.5.1/dask/dataframe/tests/test_indexing.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 
 import numpy as np
 import pandas as pd
 import pytest
 
 import dask
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_merge_column_and_index.py` & `dask-2023.5.1/dask/dataframe/tests/test_merge_column_and_index.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pandas as pd
 import pytest
 
 import dask.dataframe as dd
 from dask.dataframe.utils import assert_eq
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_multi.py` & `dask-2023.5.1/dask/dataframe/tests/test_multi.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import warnings
 
 import numpy as np
 import pandas as pd
 import pytest
 from pandas.api.types import is_object_dtype
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_numeric.py` & `dask-2023.5.1/dask/dataframe/tests/test_numeric.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pandas as pd
 import pytest
 
 from dask.array import Array, from_array
 from dask.dataframe import Series, from_pandas, to_numeric
 from dask.dataframe.utils import pyarrow_strings_enabled
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_optimize_dataframe.py` & `dask-2023.5.1/dask/dataframe/tests/test_optimize_dataframe.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pandas as pd
 
 import dask
 import dask.dataframe as dd
 
 dsk = {
     ("x", 0): pd.DataFrame({"a": [1, 2, 3], "b": [4, 5, 6]}, index=[0, 1, 3]),
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_pyarrow.py` & `dask-2023.5.1/dask/dataframe/tests/test_pyarrow.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pandas as pd
 import pytest
 from pandas.tests.extension.decimal.array import DecimalDtype
 
 from dask.dataframe._compat import PANDAS_GT_140, PANDAS_GT_150
 from dask.dataframe._pyarrow import (
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_pyarrow_compat.py` & `dask-2023.5.1/dask/dataframe/tests/test_pyarrow_compat.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pickle
 from datetime import date, datetime, time, timedelta
 from decimal import Decimal
 
 import pandas as pd
 import pandas._testing as tm
 import pytest
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_reshape.py` & `dask-2023.5.1/dask/dataframe/tests/test_reshape.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 import warnings
 
 import numpy as np
 import pandas as pd
 import pytest
 from packaging.version import parse as parse_version
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_rolling.py` & `dask-2023.5.1/dask/dataframe/tests/test_rolling.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 import datetime
 
 import numpy as np
 import pandas as pd
 import pytest
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_shuffle.py` & `dask-2023.5.1/dask/dataframe/tests/test_shuffle.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import itertools
 import multiprocessing as mp
 import os
 import pickle
 import random
 import string
 import tempfile
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_ufunc.py` & `dask-2023.5.1/dask/dataframe/tests/test_ufunc.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import warnings
 
 import pytest
 
 pd = pytest.importorskip("pandas")
 
 import numpy as np
```

### Comparing `dask-2023.5.0/dask/dataframe/tests/test_utils_dataframe.py` & `dask-2023.5.1/dask/dataframe/tests/test_utils_dataframe.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,12 @@
+from __future__ import annotations
+
 import re
 import warnings
-from typing import Iterable
+from collections.abc import Iterable
 
 import numpy as np
 import pandas as pd
 import pytest
 
 import dask
 import dask.dataframe as dd
```

### Comparing `dask-2023.5.0/dask/dataframe/tseries/resample.py` & `dask-2023.5.1/dask/dataframe/tseries/resample.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import numpy as np
 import pandas as pd
 from pandas.core.resample import Resampler as pd_Resampler
 
 from dask.base import tokenize
 from dask.dataframe import methods
 from dask.dataframe._compat import PANDAS_GT_140
```

### Comparing `dask-2023.5.0/dask/dataframe/tseries/tests/test_resample.py` & `dask-2023.5.1/dask/dataframe/tseries/tests/test_resample.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from itertools import product
 
 import pandas as pd
 import pytest
 
 import dask.dataframe as dd
 from dask.dataframe.utils import assert_eq
```

### Comparing `dask-2023.5.0/dask/dataframe/utils.py` & `dask-2023.5.1/dask/dataframe/utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,31 +1,31 @@
 from __future__ import annotations
 
 import math
 import re
 import sys
 import textwrap
 import traceback
-from collections.abc import Iterator, Mapping
+from collections.abc import Callable, Iterator, Mapping
 from contextlib import contextmanager
 from numbers import Number
-from typing import Callable, TypeVar, overload
+from typing import TypeVar, overload
 
 import numpy as np
 import pandas as pd
 from pandas.api.types import is_dtype_equal
 
 from dask import config
 from dask.base import get_scheduler, is_dask_collection
 from dask.core import get_deps
 from dask.dataframe import (  # noqa: F401 register pandas extension types
     _dtypes,
     methods,
 )
-from dask.dataframe._compat import tm  # noqa: F401
+from dask.dataframe._compat import PANDAS_GT_150, tm  # noqa: F401
 from dask.dataframe.dispatch import (  # noqa : F401
     make_meta,
     make_meta_obj,
     meta_nonempty,
 )
 from dask.dataframe.extensions import make_scalar
 from dask.utils import (
@@ -257,27 +257,35 @@
         ):
             x.index = x.index.set_categories([])
     elif isinstance(x, pd.CategoricalIndex) and not has_known_categories(x):
         x = x.set_categories([])
     return x
 
 
-def clear_known_categories(x, cols=None, index=True):
+def clear_known_categories(x, cols=None, index=True, dtype_backend=None):
     """Set categories to be unknown.
 
     Parameters
     ----------
     x : DataFrame, Series, Index
     cols : iterable, optional
         If x is a DataFrame, set only categoricals in these columns to unknown.
         By default, all categorical columns are set to unknown categoricals
     index : bool, optional
         If True and x is a Series or DataFrame, set the clear known categories
         in the index as well.
+    dtype_backend : string, optional
+        If set to PyArrow, the categorical dtype is implemented as a PyArrow
+        dictionary
     """
+    if dtype_backend == "pyarrow":
+        # Right now Categorical with PyArrow is implemented as dictionary and
+        # categorical accessor is not yet available
+        return x
+
     if isinstance(x, (pd.Series, pd.DataFrame)):
         x = x.copy()
         if isinstance(x, pd.DataFrame):
             mask = x.dtypes == "category"
             if cols is None:
                 cols = mask[mask].index
             elif not mask.loc[cols].all():
@@ -831,7 +839,19 @@
     return bool(config.get("dataframe.convert-string"))
 
 
 def get_numeric_only_kwargs(numeric_only) -> dict:
     from dask.dataframe.core import no_default  # Avoid circular import
 
     return {} if numeric_only is no_default else {"numeric_only": numeric_only}
+
+
+def check_numeric_only_valid(numeric_only, name: str) -> dict:
+    from dask.dataframe.core import no_default  # Avoid circular import
+
+    if PANDAS_GT_150 and numeric_only is not no_default:
+        return {"numeric_only": numeric_only}
+    elif numeric_only is no_default:
+        return {}
+    raise NotImplementedError(
+        f"numeric_only is not implemented for {name} for pandas < 1.5."
+    )
```

### Comparing `dask-2023.5.0/dask/datasets.py` & `dask-2023.5.1/dask/datasets.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import random
 
 from packaging.version import Version
 
 from dask.utils import import_required
```

### Comparing `dask-2023.5.0/dask/delayed.py` & `dask-2023.5.1/dask/delayed.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import operator
 import types
 import uuid
 import warnings
 from collections.abc import Iterator
 from dataclasses import fields, is_dataclass, replace
 from functools import partial
```

### Comparing `dask-2023.5.0/dask/diagnostics/profile.py` & `dask-2023.5.1/dask/diagnostics/profile.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from collections import namedtuple
 from itertools import starmap
 from multiprocessing import Pipe, Process, current_process
 from time import sleep
 from timeit import default_timer
 
 from dask.callbacks import Callback
```

### Comparing `dask-2023.5.0/dask/diagnostics/profile_visualize.py` & `dask-2023.5.1/dask/diagnostics/profile_visualize.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import random
 import warnings
 from bisect import bisect_left
 from itertools import cycle
 from operator import add, itemgetter
 
 from tlz import accumulate, groupby, pluck, unique
```

### Comparing `dask-2023.5.0/dask/diagnostics/progress.py` & `dask-2023.5.1/dask/diagnostics/progress.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 import sys
 import threading
 import time
 from timeit import default_timer
 
 from dask.callbacks import Callback
```

### Comparing `dask-2023.5.0/dask/diagnostics/tests/test_profiler.py` & `dask-2023.5.1/dask/diagnostics/tests/test_profiler.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import contextlib
 import os
 import warnings
 from operator import add, mul
 from timeit import default_timer
 
 import pytest
```

### Comparing `dask-2023.5.0/dask/diagnostics/tests/test_progress.py` & `dask-2023.5.1/dask/diagnostics/tests/test_progress.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from operator import add, mul
 
 import pytest
 
 from dask.callbacks import Callback
 from dask.diagnostics import ProgressBar
 from dask.diagnostics.progress import format_time
```

### Comparing `dask-2023.5.0/dask/distributed.py` & `dask-2023.5.1/dask/distributed.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,9 +1,11 @@
 # flake8: noqa
 
+from __future__ import annotations
+
 _import_error_message = (
     "dask.distributed is not installed.\n\n"
     "Please either conda or pip install distributed:\n\n"
     "  conda install dask distributed             # either conda install\n"
     '  python -m pip install "dask[distributed]" --upgrade    # or pip install'
 )
```

### Comparing `dask-2023.5.0/dask/dot.py` & `dask-2023.5.1/dask/dot.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/graph_manipulation.py` & `dask-2023.5.1/dask/graph_manipulation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/hashing.py` & `dask-2023.5.1/dask/hashing.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import binascii
 import hashlib
 
 hashers = []  # In decreasing performance order
 
 
 # Timings on a largish array:
```

### Comparing `dask-2023.5.0/dask/highlevelgraph.py` & `dask-2023.5.1/dask/highlevelgraph.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/layers.py` & `dask-2023.5.1/dask/layers.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/local.py` & `dask-2023.5.1/dask/local.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/multiprocessing.py` & `dask-2023.5.1/dask/multiprocessing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/optimization.py` & `dask-2023.5.1/dask/optimization.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import math
 import numbers
 import uuid
 from enum import Enum
 
 from dask import config, core, utils
 from dask.core import (
```

### Comparing `dask-2023.5.0/dask/order.py` & `dask-2023.5.1/dask/order.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 r""" Static order of nodes in dask graph
 
 Dask makes decisions on what tasks to prioritize both
 
 *  Dynamically at runtime
 *  Statically before runtime
```

### Comparing `dask-2023.5.0/dask/rewrite.py` & `dask-2023.5.1/dask/rewrite.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from collections import deque
 
 from dask.core import istask, subs
 
 
 def head(task):
     """Return the top level node of a task"""
```

### Comparing `dask-2023.5.0/dask/sizeof.py` & `dask-2023.5.1/dask/sizeof.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import itertools
 import logging
 import random
 import sys
 from array import array
 
 import importlib_metadata
@@ -200,15 +202,15 @@
         p = 400 + i.memory_usage(deep=False)
         if i.dtype in OBJECT_DTYPES:
             p += object_size(i)
         return p
 
     @sizeof.register(pd.MultiIndex)
     def sizeof_pandas_multiindex(i):
-        p = 400 + object_size(*i.levels)
+        p = sum(sizeof(lev) for lev in i.levels)
         for c in i.codes:
             p += c.nbytes
         return p
 
 
 @sizeof.register_lazy("scipy")
 def register_spmatrix():
```

### Comparing `dask-2023.5.0/dask/system.py` & `dask-2023.5.1/dask/system.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import math
 import os
 import sys
 
 try:
     import psutil
 except ImportError:
```

### Comparing `dask-2023.5.0/dask/tests/test_backends.py` & `dask-2023.5.1/dask/tests/test_backends.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 import dask
 
 
 @pytest.mark.gpu
 @pytest.mark.parametrize("backend", ["pandas", "cudf"])
```

### Comparing `dask-2023.5.0/dask/tests/test_base.py` & `dask-2023.5.1/dask/tests/test_base.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import dataclasses
 import datetime
 import inspect
 import os
 import pathlib
 import subprocess
 import sys
```

### Comparing `dask-2023.5.0/dask/tests/test_cache.py` & `dask-2023.5.1/dask/tests/test_cache.py`

 * *Files 11% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from operator import add
 from time import sleep
 
 import pytest
 
 from dask.cache import Cache
 from dask.callbacks import Callback
```

### Comparing `dask-2023.5.0/dask/tests/test_callbacks.py` & `dask-2023.5.1/dask/tests/test_callbacks.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from dask.callbacks import Callback
 from dask.local import get_sync
 from dask.threaded import get as get_threaded
 from dask.utils_test import add
 
 
 def test_start_callback():
```

### Comparing `dask-2023.5.0/dask/tests/test_ci.py` & `dask-2023.5.1/dask/tests/test_ci.py`

 * *Files 13% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os
 
 import importlib_metadata
 import pytest
 from packaging.version import Version
```

### Comparing `dask-2023.5.0/dask/tests/test_cli.py` & `dask-2023.5.1/dask/tests/test_cli.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import json
 import platform
 import sys
 
 import click
 import importlib_metadata
 import pytest
```

### Comparing `dask-2023.5.0/dask/tests/test_config.py` & `dask-2023.5.1/dask/tests/test_config.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os
 import site
 import stat
 import sys
 from collections import OrderedDict
 from contextlib import contextmanager
```

### Comparing `dask-2023.5.0/dask/tests/test_context.py` & `dask-2023.5.1/dask/tests/test_context.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 import dask
 from dask.context import globalmethod
 
 
 def test_with_get():
```

### Comparing `dask-2023.5.0/dask/tests/test_core.py` & `dask-2023.5.1/dask/tests/test_core.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pickle
 from collections import namedtuple
 
 import pytest
 
 from dask.core import (
     flatten,
```

### Comparing `dask-2023.5.0/dask/tests/test_datasets.py` & `dask-2023.5.1/dask/tests/test_datasets.py`

 * *Files 15% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 import dask
 
 
 def test_mimesis():
     pytest.importorskip("mimesis")
```

### Comparing `dask-2023.5.0/dask/tests/test_delayed.py` & `dask-2023.5.1/dask/tests/test_delayed.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pickle
 import types
 from collections import namedtuple
 from dataclasses import dataclass, field
 from functools import partial
 from operator import add, setitem
 from random import random
```

### Comparing `dask-2023.5.0/dask/tests/test_distributed.py` & `dask-2023.5.1/dask/tests/test_distributed.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 distributed = pytest.importorskip("distributed")
 
 import asyncio
 import os
 import sys
```

### Comparing `dask-2023.5.0/dask/tests/test_docs.py` & `dask-2023.5.1/dask/tests/test_docs.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from pathlib import Path
 
 import pytest
 
 
 def test_development_guidelines_matches_ci():
     """When the environment.yaml changes in CI, make sure to change it in the docs as well"""
```

### Comparing `dask-2023.5.0/dask/tests/test_dot.py` & `dask-2023.5.1/dask/tests/test_dot.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import copy
 import os
 import re
 import sys
 from functools import partial
 from operator import add, neg
```

### Comparing `dask-2023.5.0/dask/tests/test_graph_manipulation.py` & `dask-2023.5.1/dask/tests/test_graph_manipulation.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import random
 import time
 from operator import add
 
 import pytest
 
 import dask
@@ -100,15 +102,15 @@
         dd.from_pandas(df["x"], npartitions=2).map_partitions(cnt.f),  # 2 chunks
         dd.from_pandas(df["x"], npartitions=1).map_partitions(cnt.f),  # 1 chunk
     ]
     cnt.n = 0
     return colls, cnt
 
 
-def demo_tuples(layers: bool) -> "tuple[Tuple, Tuple, NodeCounter]":
+def demo_tuples(layers: bool) -> tuple[Tuple, Tuple, NodeCounter]:
     cnt = NodeCounter()
     # Collections have multiple names
     dsk1 = HighLevelGraph(
         {"a": {("a", h1): (cnt.f, 1), ("a", h2): (cnt.f, 2)}, "b": {"b": (cnt.f, 3)}},
         {"a": set(), "b": set()},
     )
     dsk2 = HighLevelGraph(
```

### Comparing `dask-2023.5.0/dask/tests/test_hashing.py` & `dask-2023.5.1/dask/tests/test_hashing.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 from dask.hashing import hash_buffer, hash_buffer_hex, hashers
 
 np = pytest.importorskip("numpy")
 
 buffers = [
```

### Comparing `dask-2023.5.0/dask/tests/test_highgraph.py` & `dask-2023.5.1/dask/tests/test_highgraph.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os
 import xml.etree.ElementTree
 from collections.abc import Set
 
 import pytest
 
 import dask
@@ -176,14 +178,24 @@
     blayer = B.__dask_graph__().layers[B.name]
     clayer = C.__dask_graph__().layers[C.name]
     assert alayer.annotations == {"resources": {"GPU": 1}, "block_id": annot_map_fn}
     assert blayer.annotations == {"block_id": annot_map_fn}
     assert clayer.annotations is None
 
 
+def test_annotation_and_config_collision():
+    with dask.config.set({"foo": 1}):
+        with dask.annotate(foo=2):
+            assert dask.config.get("foo") == 1
+            assert dask.config.get("annotations") == {"foo": 2}
+            with dask.annotate(bar=3):
+                assert dask.config.get("foo") == 1
+                assert dask.config.get("annotations") == {"foo": 2, "bar": 3}
+
+
 def test_materializedlayer_cull_preserves_annotations():
     layer = MaterializedLayer(
         {"a": 42, "b": 3.14},
         annotations={"foo": "bar"},
     )
 
     culled_layer, _ = layer.cull({"a"}, [])
```

### Comparing `dask-2023.5.0/dask/tests/test_layers.py` & `dask-2023.5.1/dask/tests/test_layers.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os
 
 import pytest
 
 distributed = pytest.importorskip("distributed")
 
 import sys
```

### Comparing `dask-2023.5.0/dask/tests/test_local.py` & `dask-2023.5.1/dask/tests/test_local.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 import dask
 from dask.local import finish_task, get_sync, sortkey, start_state_from_dask
 from dask.order import order
 from dask.utils_test import GetFunctionTestMixin, add, inc
```

### Comparing `dask-2023.5.0/dask/tests/test_multiprocessing.py` & `dask-2023.5.1/dask/tests/test_multiprocessing.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import multiprocessing
 import pickle
 import sys
 from concurrent.futures import ProcessPoolExecutor
 from operator import add
 
 import pytest
```

### Comparing `dask-2023.5.0/dask/tests/test_optimization.py` & `dask-2023.5.1/dask/tests/test_optimization.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import itertools
 import pickle
 from functools import partial
 
 import pytest
 
 import dask
```

### Comparing `dask-2023.5.0/dask/tests/test_order.py` & `dask-2023.5.1/dask/tests/test_order.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import pytest
 
 import dask
 from dask.core import get_deps
 from dask.order import diagnostics, ndependencies, order
 from dask.utils_test import add, inc
```

### Comparing `dask-2023.5.0/dask/tests/test_rewrite.py` & `dask-2023.5.1/dask/tests/test_rewrite.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from dask.rewrite import VAR, RewriteRule, RuleSet, Traverser, args, head
 from dask.utils_test import add, inc
 
 
 def double(x):
     return x * 2
```

### Comparing `dask-2023.5.0/dask/tests/test_sizeof.py` & `dask-2023.5.1/dask/tests/test_sizeof.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os
 import sys
 from array import array
 
 import pytest
 
 from dask.multiprocessing import get_context
```

### Comparing `dask-2023.5.0/dask/tests/test_spark_compat.py` & `dask-2023.5.1/dask/tests/test_spark_compat.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import decimal
 import signal
 import sys
 import threading
 
 import pytest
```

### Comparing `dask-2023.5.0/dask/tests/test_system.py` & `dask-2023.5.1/dask/tests/test_system.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import builtins
 import io
 import os
 import sys
 
 import pytest
```

### Comparing `dask-2023.5.0/dask/tests/test_threaded.py` & `dask-2023.5.1/dask/tests/test_threaded.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import signal
 import sys
 import threading
 from concurrent.futures import ThreadPoolExecutor
 from multiprocessing.pool import ThreadPool
 from time import sleep, time
```

### Comparing `dask-2023.5.0/dask/tests/test_typing.py` & `dask-2023.5.1/dask/tests/test_typing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/tests/test_utils.py` & `dask-2023.5.1/dask/tests/test_utils.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import datetime
 import functools
 import operator
 import pickle
 from array import array
 
 import pytest
@@ -22,14 +24,15 @@
     ensure_dict,
     ensure_set,
     ensure_unicode,
     extra_titles,
     format_bytes,
     format_time,
     funcname,
+    get_meta_library,
     getargspec,
     has_keyword,
     is_arraylike,
     itemgetter,
     iter_chunks,
     memory_repr,
     methodcaller,
@@ -890,7 +893,45 @@
 
     with tmpfile(extension="jpg") as fn:
         assert fn[-4:] == ".jpg"
 
     with tmpfile(extension=".jpg") as fn:
         assert fn[-4:] == ".jpg"
         assert fn[-5] != "."
+
+
+def test_get_meta_library():
+    np = pytest.importorskip("numpy")
+    pd = pytest.importorskip("pandas")
+    da = pytest.importorskip("dask.array")
+    dd = pytest.importorskip("dask.dataframe")
+
+    assert get_meta_library(pd.DataFrame()) == pd
+    assert get_meta_library(np.array([])) == np
+
+    assert get_meta_library(pd.DataFrame()) == get_meta_library(pd.DataFrame)
+    assert get_meta_library(np.ndarray([])) == get_meta_library(np.ndarray)
+
+    assert get_meta_library(pd.DataFrame()) == get_meta_library(
+        dd.from_dict({}, npartitions=1)
+    )
+    assert get_meta_library(np.ndarray([])) == get_meta_library(da.from_array([]))
+
+
+def test_get_meta_library_gpu():
+    cp = pytest.importorskip("cupy")
+    cudf = pytest.importorskip("cudf")
+    da = pytest.importorskip("dask.array")
+    dd = pytest.importorskip("dask.dataframe")
+
+    assert get_meta_library(cudf.DataFrame()) == cudf
+    assert get_meta_library(cp.array([])) == cp
+
+    assert get_meta_library(cudf.DataFrame()) == get_meta_library(cudf.DataFrame)
+    assert get_meta_library(cp.ndarray([])) == get_meta_library(cp.ndarray)
+
+    assert get_meta_library(cudf.DataFrame()) == get_meta_library(
+        dd.from_dict({}, npartitions=1).to_backend("cudf")
+    )
+    assert get_meta_library(cp.ndarray([])) == get_meta_library(
+        da.from_array([]).to_backend("cupy")
+    )
```

### Comparing `dask-2023.5.0/dask/tests/test_utils_test.py` & `dask-2023.5.1/dask/tests/test_utils_test.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import warnings
 
 import pytest
 
 from dask import utils_test
 from dask.highlevelgraph import HighLevelGraph
 from dask.utils_test import _check_warning
```

### Comparing `dask-2023.5.0/dask/threaded.py` & `dask-2023.5.1/dask/threaded.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/typing.py` & `dask-2023.5.1/dask/typing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/utils.py` & `dask-2023.5.1/dask/utils.py`

 * *Files 0% similar despite different names*

```diff
@@ -2100,7 +2100,14 @@
                 check_minimal_arrow_version()
                 return "p2p"
             except RuntimeError:
                 pass
         return "tasks"
     except (ImportError, ValueError):
         return "disk"
+
+
+def get_meta_library(like):
+    if hasattr(like, "_meta"):
+        like = like._meta
+
+    return import_module(typename(like).partition(".")[0])
```

### Comparing `dask-2023.5.0/dask/utils_test.py` & `dask-2023.5.1/dask/utils_test.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/widgets/__init__.py` & `dask-2023.5.1/dask/widgets/__init__.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 try:
     from dask.widgets.widgets import (
         FILTERS,
         TEMPLATE_PATHS,
         get_environment,
         get_template,
     )
```

### Comparing `dask-2023.5.0/dask/widgets/templates/array.html.j2` & `dask-2023.5.1/dask/widgets/templates/array.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/widgets/templates/highlevelgraph.html.j2` & `dask-2023.5.1/dask/widgets/templates/highlevelgraph.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/widgets/templates/highlevelgraph_layer.html.j2` & `dask-2023.5.1/dask/widgets/templates/highlevelgraph_layer.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/dask/widgets/tests/test_widgets.py` & `dask-2023.5.1/dask/widgets/tests/test_widgets.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import os.path
 
 import pytest
 
 jinja2 = pytest.importorskip("jinja2")
 
 from dask.utils import format_bytes
```

### Comparing `dask-2023.5.0/dask/widgets/widgets.py` & `dask-2023.5.1/dask/widgets/widgets.py`

 * *Files 25% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 import datetime
 import html
 import os.path
 
 from jinja2 import Environment, FileSystemLoader, Template
 from jinja2.exceptions import TemplateNotFound
```

### Comparing `dask-2023.5.0/dask.egg-info/PKG-INFO` & `dask-2023.5.1/dask.egg-info/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,30 +1,29 @@
 Metadata-Version: 2.1
 Name: dask
-Version: 2023.5.0
+Version: 2023.5.1
 Summary: Parallel PyData with Task Scheduling
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD
 Project-URL: Homepage, https://github.com/dask/dask/
 Keywords: task-scheduling parallel numpy pandas pydata
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
 Classifier: Intended Audience :: Science/Research
 Classifier: License :: OSI Approved :: BSD License
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: Python
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3 :: Only
-Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Topic :: Scientific/Engineering
 Classifier: Topic :: System :: Distributed Computing
-Requires-Python: >=3.8
+Requires-Python: >=3.9
 Description-Content-Type: text/x-rst
 Provides-Extra: array
 Provides-Extra: bag
 Provides-Extra: dataframe
 Provides-Extra: distributed
 Provides-Extra: diagnostics
 Provides-Extra: delayed
```

### Comparing `dask-2023.5.0/dask.egg-info/SOURCES.txt` & `dask-2023.5.1/dask.egg-info/SOURCES.txt`

 * *Files 1% similar despite different names*

```diff
@@ -202,14 +202,15 @@
 dask/dataframe/tests/test_extensions.py
 dask/dataframe/tests/test_format.py
 dask/dataframe/tests/test_groupby.py
 dask/dataframe/tests/test_hashing.py
 dask/dataframe/tests/test_hyperloglog.py
 dask/dataframe/tests/test_indexing.py
 dask/dataframe/tests/test_merge_column_and_index.py
+dask/dataframe/tests/test_methods.py
 dask/dataframe/tests/test_multi.py
 dask/dataframe/tests/test_numeric.py
 dask/dataframe/tests/test_optimize_dataframe.py
 dask/dataframe/tests/test_pyarrow.py
 dask/dataframe/tests/test_pyarrow_compat.py
 dask/dataframe/tests/test_reshape.py
 dask/dataframe/tests/test_rolling.py
```

### Comparing `dask-2023.5.0/docs/Makefile` & `dask-2023.5.1/docs/Makefile`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/make.bat` & `dask-2023.5.1/docs/make.bat`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/10-minutes-to-dask.rst` & `dask-2023.5.1/docs/source/10-minutes-to-dask.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/_static/config_converter.js` & `dask-2023.5.1/docs/source/_static/config_converter.js`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/_static/dask-simple.png` & `dask-2023.5.1/docs/source/_static/dask-simple.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/_static/main-page.css` & `dask-2023.5.1/docs/source/_static/main-page.css`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/_static/profile.html` & `dask-2023.5.1/docs/source/_static/profile.html`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/_static/stacked_profile.html` & `dask-2023.5.1/docs/source/_static/stacked_profile.html`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/_static/style.css` & `dask-2023.5.1/docs/source/_static/style.css`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/_static/transpose_cyto.html` & `dask-2023.5.1/docs/source/_static/transpose_cyto.html`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/_static/yaml.min.js` & `dask-2023.5.1/docs/source/_static/yaml.min.js`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/api.rst` & `dask-2023.5.1/docs/source/api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/array-api.rst` & `dask-2023.5.1/docs/source/array-api.rst`

 * *Files 2% similar despite different names*

```diff
@@ -393,21 +393,19 @@
    random.default_rng
    random.exponential
    random.f
    random.gamma
    random.geometric
    random.gumbel
    random.hypergeometric
-   random.integers
    random.laplace
    random.logistic
    random.lognormal
    random.logseries
    random.multinomial
-   random.multivariate_hypergeometric
    random.negative_binomial
    random.noncentral_chisquare
    random.noncentral_f
    random.normal
    random.pareto
    random.permutation
    random.poisson
@@ -506,7 +504,18 @@
 
 .. autosummary::
    :toctree: generated/
 
    blockwise
    normalize_chunks
    unify_chunks
+
+
+Dask Metadata
+~~~~~~~~~~~~~
+
+.. currentmodule:: dask.array.utils
+
+.. autosummary::
+   :toctree: generated/
+
+   meta_from_array
```

### Comparing `dask-2023.5.0/docs/source/array-assignment.rst` & `dask-2023.5.1/docs/source/array-assignment.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/array-best-practices.rst` & `dask-2023.5.1/docs/source/array-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/array-chunks.rst` & `dask-2023.5.1/docs/source/array-chunks.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/array-creation.rst` & `dask-2023.5.1/docs/source/array-creation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/array-design.rst` & `dask-2023.5.1/docs/source/array-design.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/array-gufunc.rst` & `dask-2023.5.1/docs/source/array-gufunc.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/array-overlap.rst` & `dask-2023.5.1/docs/source/array-overlap.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/array-random.rst` & `dask-2023.5.1/docs/source/array-random.rst`

 * *Files 22% similar despite different names*

```diff
@@ -40,14 +40,24 @@
   are used. As better algorithms evolve, the bit stream may change.
 
 - Dask does not guarantee parity in the generated numbers with any third party
   library. In particular, numbers generated by Dask and NumPy or CuPy will differ
   even when given the same seed and ``BitGenerator``. Dask tends to spawn ``SeedSequence``
   children to produce independent random number streams in parallel.
 
+- Many of the RandomState methods are exported as functions in ``dask.array.random``.
+  This usage is discouraged, as it is implemented via a global RandomState instance
+  which is not advised on two counts:
+
+  1. It uses global state, which means results will change as the code changes.
+  2. It uses a RandomState rather than the more modern Generator.
+
+  For backward compatible legacy reasons, we cannot change this. Use 
+  ``dask.array.random.default_rng()`` to get a Generator and use its methods instead.
+
 - ``Generator.integers`` is now the canonical way to generate integer random numbers
   from a discrete uniform distribution. The `endpoint` keyword can be used to
   specify open or closed intervals. This replaces both `randint` and `random_integers`.
 
 - ``Generator.random`` is now the canonical way to generate floating-point random
   numbers, which replaces `random_sample`. The ``dask.array.random.random``
   method still uses ``RandomState`` for backwards compatibility and should be
```

### Comparing `dask-2023.5.0/docs/source/array-slicing.rst` & `dask-2023.5.1/docs/source/array-slicing.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/array-sparse.rst` & `dask-2023.5.1/docs/source/array-sparse.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/array-stack.rst` & `dask-2023.5.1/docs/source/array-stack.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/array-stats.rst` & `dask-2023.5.1/docs/source/array-stats.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/array.rst` & `dask-2023.5.1/docs/source/array.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/bag-api.rst` & `dask-2023.5.1/docs/source/bag-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/bag-creation.rst` & `dask-2023.5.1/docs/source/bag-creation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/bag.rst` & `dask-2023.5.1/docs/source/bag.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/best-practices.rst` & `dask-2023.5.1/docs/source/best-practices.rst`

 * *Files 2% similar despite different names*

```diff
@@ -365,9 +365,7 @@
 
    df = dd.read_csv("...")
 
    xmin, xmax = dask.compute(df.x.min(), df.x.max())
 
 This allows Dask to compute the shared parts of the computation (like the
 ``dd.read_csv`` call above) only once, rather than once per ``compute`` call.
-For more guidance on when to call ``compute`` when working with Dask DataFrames
-or Arrays see `this blog post <https://www.coiled.io/blog/dask-compute>`_.
```

### Comparing `dask-2023.5.0/docs/source/caching.rst` & `dask-2023.5.1/docs/source/caching.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/changelog.rst` & `dask-2023.5.1/docs/source/changelog.rst`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,69 @@
 Changelog
 =========
 
+.. _v2023.5.1:
+
+2023.5.1
+--------
+
+Released on May 26, 2023
+
+.. note::
+
+  This release drops support for Python 3.8. As of this release
+  Dask supports Python 3.9, 3.10, and 3.11.
+  See `this community issue <https://github.com/dask/community/issues/315>`_
+  for more details.
+
+Enhancements
+^^^^^^^^^^^^
+- Drop Python 3.8 support (:pr:`10295`) `Thomas Grainger`_
+- Change Dask Bag partitioning scheme to improve cluster saturation (:pr:`10294`) `Jacob Tomlinson`_
+- Generalize ``dd.to_datetime`` for GPU-backed collections, introduce ``get_meta_library`` utility (:pr:`9881`) `Charles Blackmon-Luca`_
+- Add ``na_action`` to ``DataFrame.map`` (:pr:`10305`) `Patrick Hoefler`_
+- Raise ``TypeError`` in ``DataFrame.nsmallest`` and ``DataFrame.nlargest`` when ``columns`` is not given (:pr:`10301`) `Patrick Hoefler`_
+- Improve ``sizeof`` for ``pd.MultiIndex`` (:pr:`10230`) `Patrick Hoefler`_
+- Support duplicated columns in a bunch of ``DataFrame`` methods (:pr:`10261`) `Patrick Hoefler`_
+- Add ``numeric_only`` support to ``DataFrame.idxmin`` and ``DataFrame.idxmax`` (:pr:`10253`) `Patrick Hoefler`_
+- Implement ``numeric_only`` support for ``DataFrame.quantile`` (:pr:`10259`) `Patrick Hoefler`_
+- Add support for ``numeric_only=False`` in ``DataFrame.std`` (:pr:`10251`) `Patrick Hoefler`_
+- Implement ``numeric_only=False`` for ``GroupBy.cumprod`` and ``GroupBy.cumsum`` (:pr:`10262`) `Patrick Hoefler`_
+- Implement ``numeric_only`` for ``skew`` and ``kurtosis`` (:pr:`10258`) `Patrick Hoefler`_
+- ``mask`` and ``where`` should accept a ``callable`` (:pr:`10289`) `Irina Truong`_
+- Fix conversion from ``Categorical`` to ``pa.dictionary`` in ``read_parquet`` (:pr:`10285`) `Patrick Hoefler`_
+
+Bug Fixes
+^^^^^^^^^
+- Spurious config on nested annotations (:pr:`10318`) `crusaderky`_
+- Fix rechunking behavior for dimensions with known and unknown chunk sizes (:pr:`10157`) `Hendrik Makait`_
+- Enable ``drop`` to support mismatched partitions (:pr:`10300`) `James Bourbeau`_
+- Fix ``divisions`` construction for ``to_timestamp`` (:pr:`10304`) `Patrick Hoefler`_
+- pandas ``ExtensionDtype`` raising in ``Series`` reduction operations (:pr:`10149`) `Patrick Hoefler`_
+- Fix regression in ``da.random`` interface (:pr:`10247`) `Eray Aslan`_
+- ``da.coarsen`` doesn't trim an empty chunk in meta (:pr:`10281`) `Irina Truong`_
+- Fix dtype inference for ``engine="pyarrow"`` in ``read_csv`` (:pr:`10280`) `Patrick Hoefler`_
+
+Documentation
+^^^^^^^^^^^^^
+- Add ``meta_from_array`` to API docs (:pr:`10306`) `Ruth Comer`_
+- Update Coiled links (:pr:`10296`) `Sarah Charlotte Johnson`_
+- Add docs for demo day (:pr:`10288`) `Matthew Rocklin`_
+
+Maintenance
+^^^^^^^^^^^
+- Explicitly install ``anaconda-client`` from conda-forge when uploading conda nightlies (:pr:`10316`) `Charles Blackmon-Luca`_
+- Configure ``isort`` to add ``from __future__ import annotations`` (:pr:`10314`) `Thomas Grainger`_
+- Avoid ``pandas`` ``Series.__getitem__`` deprecation in tests (:pr:`10308`) `James Bourbeau`_
+- Ignore ``numpy.find_common_type`` warning from ``pandas`` (:pr:`10307`) `James Bourbeau`_
+- Add test to check that ``DataFrame.__setitem__`` does not modify ``df`` inplace (:pr:`10223`) `Patrick Hoefler`_
+- Clean up default value of ``dropna`` in ``value_counts`` (:pr:`10299`) `Patrick Hoefler`_
+- Add ``pytest-cov`` to ``test`` extra (:pr:`10271`) `James Bourbeau`_
+
+
 .. _v2023.5.0:
 
 2023.5.0
 --------
 
 Released on May 12, 2023
 
@@ -276,15 +335,15 @@
 --------
 
 Released on February 24, 2023
 
 .. note::
 
     This release changes the default DataFrame shuffle algorithm to ``p2p``
-    to improve stability and performance. `Learn more here <https://www.coiled.io/blog/better-shuffling-in-dask-a-proof-of-concept>`_
+    to improve stability and performance. `Learn more here <https://blog.coiled.io/blog/shuffling-large-data-at-constant-memory.html?utm_source=dask-docs&utm_medium=changelog>`_
     and please provide any feedback `on this discussion <https://github.com/dask/distributed/discussions/7509>`_.
 
     If you encounter issues with this new algorithm, please see the :ref:`documentation <shuffle-methods>`
     for more information, and how to switch back to the old mode.
 
 
 Enhancements
@@ -6676,7 +6735,8 @@
 .. _`Chiara Marmo`: https://github.com/cmarmo
 .. _`Jayesh Manani`: https://github.com/jayeshmanani
 .. _`Patrick Hoefler`: https://github.com/phofl
 .. _`Matthew Roeschke`: https://github.com/mroeschke
 .. _`Miles`: https://github.com/milesgranger
 .. _`Anton Loukianov`: https://github.com/antonl
 .. _`Brian Phillips`: https://github.com/bphillips-exos
+.. _`hotpotato`: https://github.com/hotpotato
```

### Comparing `dask-2023.5.0/docs/source/cli.rst` & `dask-2023.5.1/docs/source/cli.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/conf.py` & `dask-2023.5.1/docs/source/conf.py`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/configuration.rst` & `dask-2023.5.1/docs/source/configuration.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/custom-collections.rst` & `dask-2023.5.1/docs/source/custom-collections.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/custom-graphs.rst` & `dask-2023.5.1/docs/source/custom-graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dashboard-progress-script.py` & `dask-2023.5.1/docs/source/dashboard-progress-script.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,10 +1,12 @@
 """
 This script was run to produce some of the screenshots on https://docs.dask.org/en/stable/dashboard.html
 """
+from __future__ import annotations
+
 import time
 
 from dask import delayed
 from dask.distributed import Client, wait
 
 
 @delayed
```

### Comparing `dask-2023.5.0/docs/source/dashboard.rst` & `dask-2023.5.1/docs/source/dashboard.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/daskcheatsheet.pdf` & `dask-2023.5.1/docs/source/daskcheatsheet.pdf`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dataframe-api.rst` & `dask-2023.5.1/docs/source/dataframe-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dataframe-best-practices.rst` & `dask-2023.5.1/docs/source/dataframe-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dataframe-categoricals.rst` & `dask-2023.5.1/docs/source/dataframe-categoricals.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dataframe-create.rst` & `dask-2023.5.1/docs/source/dataframe-create.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dataframe-design.rst` & `dask-2023.5.1/docs/source/dataframe-design.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dataframe-extend.rst` & `dask-2023.5.1/docs/source/dataframe-extend.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dataframe-groupby.rst` & `dask-2023.5.1/docs/source/dataframe-groupby.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dataframe-indexing.rst` & `dask-2023.5.1/docs/source/dataframe-indexing.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dataframe-joins.rst` & `dask-2023.5.1/docs/source/dataframe-joins.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dataframe-parquet.rst` & `dask-2023.5.1/docs/source/dataframe-parquet.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dataframe-sql.rst` & `dask-2023.5.1/docs/source/dataframe-sql.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/dataframe.rst` & `dask-2023.5.1/docs/source/dataframe.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/delayed-api.rst` & `dask-2023.5.1/docs/source/delayed-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/delayed-best-practices.rst` & `dask-2023.5.1/docs/source/delayed-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/delayed-collections.rst` & `dask-2023.5.1/docs/source/delayed-collections.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/delayed.rst` & `dask-2023.5.1/docs/source/delayed.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/deploying-cli.rst` & `dask-2023.5.1/docs/source/deploying-cli.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/deploying-cloud.rst` & `dask-2023.5.1/docs/source/deploying-cloud.rst`

 * *Files 4% similar despite different names*

```diff
@@ -13,15 +13,15 @@
     or `Google Cloud DataProc <https://cloud.google.com/dataproc/>`_
     and `Dask-Yarn <https://yarn.dask.org>`_.
 
     Specific documentation for the popular Amazon EMR service can be found
     `here <https://yarn.dask.org/en/latest/aws-emr.html>`_.
 3.  Directly launching cloud resources such as VMs or containers via a cluster manager with
     `Dask Cloud Provider <https://cloudprovider.dask.org/en/latest/>`_.
-4. A commercial Dask deployment option like `Coiled <https://coiled.io/>`_ to handle the creation and management of Dask clusters on a cloud computing environment (AWS and GCP).
+4. A commercial Dask deployment option like `Coiled <https://coiled.io?utm_source=dask-docs&utm_medium=deploying-cloud>`_ to handle the creation and management of Dask clusters on a cloud computing environment (AWS and GCP).
 
 Cloud Deployment Example
 ------------------------
 
 Using `Dask Cloud Provider <https://cloudprovider.dask.org/en/latest/>`_ to launch a cluster of
 VMs on a platform like `DigitalOcean <https://www.digitalocean.com/>`_ can be as convenient as
 launching a local cluster.
```

### Comparing `dask-2023.5.0/docs/source/deploying-docker.rst` & `dask-2023.5.1/docs/source/deploying-docker.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/deploying-hpc.rst` & `dask-2023.5.1/docs/source/deploying-hpc.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/deploying-kubernetes.rst` & `dask-2023.5.1/docs/source/deploying-kubernetes.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/deploying-python-advanced.rst` & `dask-2023.5.1/docs/source/deploying-python-advanced.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/deploying-python.rst` & `dask-2023.5.1/docs/source/deploying-python.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/deploying-ssh.rst` & `dask-2023.5.1/docs/source/deploying-ssh.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/deploying.rst` & `dask-2023.5.1/docs/source/deploying.rst`

 * *Files 2% similar despite different names*

```diff
@@ -147,15 +147,15 @@
 
 See :doc:`deploying-cloud` for more details.
 
 - `Dask-Yarn <https://yarn.dask.org>`_
     Deploy Dask on YARN clusters, such as are found in traditional Hadoop installations.
 - `Dask Cloud Provider <https://cloudprovider.dask.org/en/latest/>`_
     Constructing and managing ephemeral Dask clusters on AWS, DigitalOcean, GCP, Azure, and Hertzner
-- You can use `Coiled <https://coiled.io/>`_, a commercial Dask deployment option, to handle the creation and management of Dask clusters on cloud computing environments (AWS and GCP).
+- You can use `Coiled <https://coiled.io?utm_source=dask-docs&utm_medium=deploying>`_, a commercial Dask deployment option, to handle the creation and management of Dask clusters on cloud computing environments (AWS and GCP).
 
 Ad-hoc deployments
 ~~~~~~~~~~~~~~~~~~
 
 - :doc:`Manual Setup <deploying-cli>`
     The command line interface to set up ``dask-scheduler`` and ``dask-worker`` processes.
 - :doc:`deploying-ssh`
@@ -164,10 +164,10 @@
     Create ``Scheduler`` and ``Worker``   objects from Python as part of a distributed Tornado TCP application.
 
 .. _managed-cluster-solutions:
 
 Managed Solutions
 ~~~~~~~~~~~~~~~~~
 
-- You can use `Coiled <https://coiled.io/>`_ to handle the creation and management of Dask clusters on cloud computing environments (AWS and GCP).
+- You can use `Coiled <https://coiled.io?utm_source=dask-docs&utm_medium=deploying>`_ to handle the creation and management of Dask clusters on cloud computing environments (AWS and GCP).
 - `Domino Data Lab <https://www.dominodatalab.com/>`_ lets users create Dask clusters in a hosted platform.
 - `Saturn Cloud <https://saturncloud.io/>`_ lets users create Dask clusters in a hosted platform or within their own AWS accounts.
```

### Comparing `dask-2023.5.0/docs/source/deployment-considerations.rst` & `dask-2023.5.1/docs/source/deployment-considerations.rst`

 * *Files 2% similar despite different names*

```diff
@@ -18,15 +18,15 @@
 
 Additional challenges can include getting local packages or scripts onto the cluster (and ensuring they're up to date), as well as packages installed from private Git or PyPI repos.
 
 Environment management options without additional infrastructure:
 
 * :class:`~distributed.diagnostics.plugin.PipInstall` plugin
 * :class:`~distributed.diagnostics.plugin.UploadDirectory` plugin
-* Coiled's `package sync <https://docs.coiled.io/user_guide/package_sync.html>`_ automatically replicates a local environment onto a cluster, including local packages and Git dependencies.
+* Coiled's `package sync <https://docs.coiled.io/user_guide/package_sync.html?utm_source=dask-docs&utm_medium=deployment-considerations>`_ automatically replicates a local environment onto a cluster, including local packages and Git dependencies.
 
 
 Logging
 -------
 When clusters break, logs may be your only tool to debug them. At a minimum, you should have a way to retain logs from all the machines in the cluster. You may also want to ingest these logs into a dedicated logging system, so you can search the logs, or view logs from multiple systems interleaved by time. (If deploying on a cloud provider, this might already be set up for you with the provider's logging system, though be aware of potential charges for log storage.)
 
 When managing dask for a team, you'll also have to figure out how individual (and potentially less-technical) users can access logs and metrics for their own clusters. In a large organization, this may even include preventing users from accessing logs from other users' clusters.
@@ -91,9 +91,9 @@
 In that case, you may need somewhere to store those auxiliary files remotely, where workers can access them. Depending on your deployment system, there are many options, from network file systems to cloud object stores like S3. Regardless, this can be another piece of infrastructure to manage and secure.
 
 
 Note on managed Dask offerings
 ------------------------------
 As shown, setting up and managing a mature Dask deployment, especially for team or production use, can involve a fair amount of complexity outside of Dask itself. Addressing these challenges is generally out of scope for the open-source Dask deployment tools, but there are other projects as well as commercial Dask deployment services that handle many of these considerations. In alphabetical order:
 
-- `Coiled <https://coiled.io/>`_ handles the creation and management of Dask clusters on cloud computing environments (AWS, Azure, and GCP).
+- `Coiled <https://coiled.io?utm_source=dask-docs&utm_medium=deployment-considerations>`_ handles the creation and management of Dask clusters on cloud computing environments (AWS, Azure, and GCP).
 - `Saturn Cloud <https://saturncloud.io/>`_ lets users create Dask clusters in a hosted platform or within their own AWS accounts.
```

### Comparing `dask-2023.5.0/docs/source/develop.rst` & `dask-2023.5.1/docs/source/develop.rst`

 * *Files 0% similar despite different names*

```diff
@@ -129,15 +129,15 @@
 
 Dask maintains development standards that are similar to most PyData projects.  These standards include
 language support, testing, documentation, and style.
 
 Python Versions
 ~~~~~~~~~~~~~~~
 
-Dask supports Python versions 3.8, 3.9 and 3.10.
+Dask supports Python versions 3.9, 3.10 and 3.11.
 Name changes are handled by the :file:`dask/compatibility.py` file.
 
 .. _develop-test:
 
 Test
 ~~~~
 
@@ -250,15 +250,15 @@
        8
        >>> fib(-1)  # Robust to bad inputs
        ValueError(...)
        """
 
 .. _numpydoc: https://numpydoc.readthedocs.io/en/latest/format.html#docstring-standard
 
-Docstrings are tested under Python 3.8 on GitHub Actions. You can test
+Docstrings are tested under Python 3.10 on GitHub Actions. You can test
 docstrings with pytest as follows::
 
    py.test dask --doctest-modules
 
 Docstring testing requires ``graphviz`` to be installed. This can be done via::
 
    conda install -y graphviz
```

### Comparing `dask-2023.5.0/docs/source/diagnostics-distributed.rst` & `dask-2023.5.1/docs/source/diagnostics-distributed.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/diagnostics-local.rst` & `dask-2023.5.1/docs/source/diagnostics-local.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/ecosystem.rst` & `dask-2023.5.1/docs/source/ecosystem.rst`

 * *Files 2% similar despite different names*

```diff
@@ -74,8 +74,8 @@
   cluster backend.
 - `dask-cuda <https://github.com/rapidsai/dask-cuda>`_: Construct a Dask cluster which resembles ``LocalCluster``  and is specifically
   optimized for GPUs.
 
 Commercial Dask Deployment Options
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
-- You can use `Coiled <https://coiled.io/>`_ to handle the creation and management of Dask clusters on cloud computing environments (AWS and GCP).
+- You can use `Coiled <https://coiled.io?utm_source=dask-docs&utm_medium=ecosystem>`_ to handle the creation and management of Dask clusters on cloud computing environments (AWS and GCP).
```

### Comparing `dask-2023.5.0/docs/source/faq.rst` & `dask-2023.5.1/docs/source/faq.rst`

 * *Files 2% similar despite different names*

```diff
@@ -182,15 +182,15 @@
     - **Dask-Kubernetes**: for native Kubernetes integration for fast moving
       or ephemeral deployments.
 
     For more information see :doc:`deploying-kubernetes`
 
 4. **Commercial Dask deployment:**
 
-   - You can use `Coiled <https://coiled.io/>`_ to handle the creation and management of Dask clusters on cloud computing environments (AWS and GCP).
+   - You can use `Coiled <https://coiled.io?utm_source=dask-docs&utm_medium=faq>`_ to handle the creation and management of Dask clusters on cloud computing environments (AWS and GCP).
    - `Domino Data Lab <https://www.dominodatalab.com/>`_ Lets users create Dask clusters in a hosted platform.
    - `Saturn Cloud <https://saturncloud.io/>`_ Lets users create Dask clusters in a hosted platform or within their own AWS accounts.
 
 
 Is Dask secure?
 ~~~~~~~~~~~~~~~
```

### Comparing `dask-2023.5.0/docs/source/futures.rst` & `dask-2023.5.1/docs/source/futures.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/gpu.rst` & `dask-2023.5.1/docs/source/gpu.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/graph_manipulation.rst` & `dask-2023.5.1/docs/source/graph_manipulation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/graphs.rst` & `dask-2023.5.1/docs/source/graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/graphviz.rst` & `dask-2023.5.1/docs/source/graphviz.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/high-level-graphs.rst` & `dask-2023.5.1/docs/source/high-level-graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/how-to/adaptive.rst` & `dask-2023.5.1/docs/source/how-to/adaptive.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/how-to/connect-to-remote-data.rst` & `dask-2023.5.1/docs/source/how-to/connect-to-remote-data.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/how-to/customize-initialization.rst` & `dask-2023.5.1/docs/source/how-to/customize-initialization.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/how-to/debug.rst` & `dask-2023.5.1/docs/source/how-to/debug.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/how-to/extend-sizeof.rst` & `dask-2023.5.1/docs/source/how-to/extend-sizeof.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/how-to/manage-environments.rst` & `dask-2023.5.1/docs/source/how-to/manage-environments.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/how-to/selecting-the-collection-backend.rst` & `dask-2023.5.1/docs/source/how-to/selecting-the-collection-backend.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/how-to/setup-prometheus.rst` & `dask-2023.5.1/docs/source/how-to/setup-prometheus.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/10_minutes_array_graph.png` & `dask-2023.5.1/docs/source/images/10_minutes_array_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/10_minutes_bag_graph.png` & `dask-2023.5.1/docs/source/images/10_minutes_bag_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/10_minutes_dataframe_graph.png` & `dask-2023.5.1/docs/source/images/10_minutes_dataframe_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/HHMI_Janelia_Color.png` & `dask-2023.5.1/docs/source/images/HHMI_Janelia_Color.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/array.svg` & `dask-2023.5.1/docs/source/images/array.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/async-embarrassing.gif` & `dask-2023.5.1/docs/source/images/async-embarrassing.gif`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/concurrent-futures-threaded.webp` & `dask-2023.5.1/docs/source/images/concurrent-futures-threaded.webp`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/crosstalk.svg` & `dask-2023.5.1/docs/source/images/crosstalk.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dashboard_jupyterlab.png` & `dask-2023.5.1/docs/source/images/dashboard_jupyterlab.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dashboard_link.png` & `dask-2023.5.1/docs/source/images/dashboard_link.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dashboard_memory.png` & `dask-2023.5.1/docs/source/images/dashboard_memory.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dashboard_memory_new.gif` & `dask-2023.5.1/docs/source/images/dashboard_memory_new.gif`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dashboard_progress.png` & `dask-2023.5.1/docs/source/images/dashboard_progress.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dashboard_status.png` & `dask-2023.5.1/docs/source/images/dashboard_status.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dashboard_task_processing.png` & `dask-2023.5.1/docs/source/images/dashboard_task_processing.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dashboard_task_stream_unhealthy.png` & `dask-2023.5.1/docs/source/images/dashboard_task_stream_unhealthy.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dashboard_taskstream_healthy.png` & `dask-2023.5.1/docs/source/images/dashboard_taskstream_healthy.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask-adaptive.svg` & `dask-2023.5.1/docs/source/images/dask-adaptive.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask-array.svg` & `dask-2023.5.1/docs/source/images/dask-array.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask-cluster-manager.svg` & `dask-2023.5.1/docs/source/images/dask-cluster-manager.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask-dataframe.svg` & `dask-2023.5.1/docs/source/images/dask-dataframe.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask-overview-distributed-callout.svg` & `dask-2023.5.1/docs/source/images/dask-overview-distributed-callout.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask-overview-schedulers.svg` & `dask-2023.5.1/docs/source/images/dask-overview-schedulers.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask-overview.svg` & `dask-2023.5.1/docs/source/images/dask-overview.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask_horizontal.svg` & `dask-2023.5.1/docs/source/images/dask_horizontal.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask_horizontal_black.svg` & `dask-2023.5.1/docs/source/images/dask_horizontal_black.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask_horizontal_on_blue.svg` & `dask-2023.5.1/docs/source/images/dask_horizontal_on_blue.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask_horizontal_on_pink.svg` & `dask-2023.5.1/docs/source/images/dask_horizontal_on_pink.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask_horizontal_white.svg` & `dask-2023.5.1/docs/source/images/dask_horizontal_white.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask_icon.svg` & `dask-2023.5.1/docs/source/images/dask_icon.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask_icon_black.svg` & `dask-2023.5.1/docs/source/images/dask_icon_black.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask_icon_on_pink.svg` & `dask-2023.5.1/docs/source/images/dask_icon_on_pink.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/dask_icon_white.svg` & `dask-2023.5.1/docs/source/images/dask_icon_white.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/delayed-inc-double-add.svg` & `dask-2023.5.1/docs/source/images/delayed-inc-double-add.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/distributed-overview.svg` & `dask-2023.5.1/docs/source/images/distributed-overview.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/frame-shuffle.svg` & `dask-2023.5.1/docs/source/images/frame-shuffle.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/frame-sort.svg` & `dask-2023.5.1/docs/source/images/frame-sort.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/frame.svg` & `dask-2023.5.1/docs/source/images/frame.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/gputester-msg.png` & `dask-2023.5.1/docs/source/images/gputester-msg.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/growth_of_languages.png` & `dask-2023.5.1/docs/source/images/growth_of_languages.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/growth_of_libraries.png` & `dask-2023.5.1/docs/source/images/growth_of_libraries.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/inc-add.svg` & `dask-2023.5.1/docs/source/images/inc-add.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/map-reduce-task-scheduling.svg` & `dask-2023.5.1/docs/source/images/map-reduce-task-scheduling.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/map_blocks_drop_axis.png` & `dask-2023.5.1/docs/source/images/map_blocks_drop_axis.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/merge_chunks.png` & `dask-2023.5.1/docs/source/images/merge_chunks.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/merge_chunks_false.png` & `dask-2023.5.1/docs/source/images/merge_chunks_false.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/optimize_dask1.svg` & `dask-2023.5.1/docs/source/images/optimize_dask1.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/optimize_dask2.svg` & `dask-2023.5.1/docs/source/images/optimize_dask2.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/optimize_dask3.svg` & `dask-2023.5.1/docs/source/images/optimize_dask3.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/optimize_dask4.svg` & `dask-2023.5.1/docs/source/images/optimize_dask4.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/optimize_dask5.svg` & `dask-2023.5.1/docs/source/images/optimize_dask5.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/order-failure.png` & `dask-2023.5.1/docs/source/images/order-failure.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/order-success.png` & `dask-2023.5.1/docs/source/images/order-success.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/overlap.svg` & `dask-2023.5.1/docs/source/images/overlap.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/overlapping-blocks.svg` & `dask-2023.5.1/docs/source/images/overlapping-blocks.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/overlapping-neighbors.svg` & `dask-2023.5.1/docs/source/images/overlapping-neighbors.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/pipeline.svg` & `dask-2023.5.1/docs/source/images/pipeline.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/reshape.png` & `dask-2023.5.1/docs/source/images/reshape.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/reshape_problem.png` & `dask-2023.5.1/docs/source/images/reshape_problem.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/reshape_rechunked.png` & `dask-2023.5.1/docs/source/images/reshape_rechunked.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/scaling-edges.png` & `dask-2023.5.1/docs/source/images/scaling-edges.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/scaling-nodes.png` & `dask-2023.5.1/docs/source/images/scaling-nodes.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/simple-dask.png` & `dask-2023.5.1/docs/source/images/simple-dask.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/transpose-hlg-hovertooltip.png` & `dask-2023.5.1/docs/source/images/transpose-hlg-hovertooltip.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/transpose-hlg-html-repr.png` & `dask-2023.5.1/docs/source/images/transpose-hlg-html-repr.png`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/transpose.svg` & `dask-2023.5.1/docs/source/images/transpose.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/transpose_opt.svg` & `dask-2023.5.1/docs/source/images/transpose_opt.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/trivial.svg` & `dask-2023.5.1/docs/source/images/trivial.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/images/unoverlapping-neighbors.svg` & `dask-2023.5.1/docs/source/images/unoverlapping-neighbors.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/index.rst` & `dask-2023.5.1/docs/source/index.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/install.rst` & `dask-2023.5.1/docs/source/install.rst`

 * *Files 0% similar despite different names*

```diff
@@ -105,65 +105,65 @@
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `cachey`_        | ``>=0.1.1``     | Use caching for computation                                                                             |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `cityhash`_      | ``>=0.2.4``     | Use CityHash and FarmHash hash functions for array hashing (~2x faster than MurmurHash)                 |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `crick`_         | ``>=0.0.3``     | Use ``tdigest`` internal method for dataframe statistics computation                                    |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
-| `cytoolz`_       | ``>=0.10.1``    | Faster cythonized implementation of internal iterators, functions, and dictionaries                     |
+| `cytoolz`_       | ``>=0.11.0``    | Faster cythonized implementation of internal iterators, functions, and dictionaries                     |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `dask-ml`_       | ``>=1.4.0``     | Common machine learning functions scaled with Dask                                                      |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
-| `fastavro`_      | ``>=0.22.6``    | Storing and reading data from Apache Avro files                                                         |
+| `fastavro`_      | ``>=1.1.0``     | Storing and reading data from Apache Avro files                                                         |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `fastparquet`_   | ``>=0.8.2``     | Storing and reading data from Apache Parquet files                                                      |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `gcsfs`_         | ``>=2021.9.0``  | Storing and reading data located in Google Cloud Storage                                                |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `graphviz`_      | ``>=0.8.4``     | Graph visualization using the graphviz engine                                                           |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `h5py`_          | ``>=2.10.0``    | Storing array data in hdf5 files                                                                        |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `ipycytoscape`_  | ``>=1.0.1``     | Graph visualization using the cytoscape engine                                                          |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
-| `IPython`_       | ``>=7.9.0``     | Write graph visualizations made with graphviz engine to file                                            |
+| `IPython`_       | ``>=7.16.1``    | Write graph visualizations made with graphviz engine to file                                            |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `jinja2`_        | ``>=2.10.3``    | HTML representations of Dask objects in Jupyter notebooks (required for ``dask.diagnostics``)           |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `lz4`_           | ``>=4.3.2``     | Transparent use of lz4 compression algorithm                                                            |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
-| `matplotlib`_    | ``>=3.1.1``     | Color map support for graph visualization                                                               |
+| `matplotlib`_    | ``>=3.4.1``     | Color map support for graph visualization                                                               |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `mimesis`_       | ``>=5.3.0``     | Random bag data generation with :func:`dask.datasets.make_people`                                       |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `mmh3`_          | ``>=2.5.1``     | Use MurmurHash hash functions for array hashing (~8x faster than SHA1)                                  |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `numpy`_         | ``>=1.21``      | Required for ``dask.array``                                                                             |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `pandas`_        | ``>=1.3``       | Required for ``dask.dataframe``                                                                         |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
-| `psutil`_        | ``>=5.7.0``     | Factor CPU affinity into CPU count, intelligently infer blocksize when reading CSV files                |
+| `psutil`_        | ``>=5.7.2``     | Factor CPU affinity into CPU count, intelligently infer blocksize when reading CSV files                |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `pyarrow`_       | ``>=7.0``       | Support for Apache Arrow datatypes & engine when storing/reading Apache ORC or Parquet files            |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `python-snappy`_ | ``>=0.5.4``     | Snappy compression to bs used when storing/reading Avro or Parquet files                                |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `s3fs`_          | ``>=2021.9.0``  | Storing and reading data located in Amazon S3                                                           |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
-| `scipy`_         | ``>=1.3.2``     | Required for ``dask.array.stats``, ``dask.array.fft``, and :func:`dask.array.linalg.lu`                 |
+| `scipy`_         | ``>=1.5.2``     | Required for ``dask.array.stats``, ``dask.array.fft``, and :func:`dask.array.linalg.lu`                 |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `sparse`_        | ``>=0.12.0``    | Use sparse arrays as backend for dask arrays                                                            |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `sqlalchemy`_    | ``>=1.4.16``    | Writing and reading from SQL databases                                                                  |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `tblib`_         | ``>=1.6.0``     | Serialization of worker traceback objects                                                               |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `tiledb`_        | ``>=0.8.1``     | Storing and reading data from TileDB files                                                              |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
-| `xxhash`_        | ``>=1.4.1``     | Use xxHash hash functions for array hashing (~2x faster than MurmurHash, slightly slower than CityHash) |
+| `xxhash`_        | ``>=2.0.0``     | Use xxHash hash functions for array hashing (~2x faster than MurmurHash, slightly slower than CityHash) |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 | `zarr`_          | ``>=2.12.0``    | Storing and reading data from Zarr files                                                                |
 +------------------+-----------------+---------------------------------------------------------------------------------------------------------+
 
 Test
 ----
```

### Comparing `dask-2023.5.0/docs/source/logos.rst` & `dask-2023.5.1/docs/source/logos.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/maintainers.rst` & `dask-2023.5.1/docs/source/maintainers.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/optimize.rst` & `dask-2023.5.1/docs/source/optimize.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/order.rst` & `dask-2023.5.1/docs/source/order.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/phases-of-computation.rst` & `dask-2023.5.1/docs/source/phases-of-computation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/presentations.rst` & `dask-2023.5.1/docs/source/presentations.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/scheduler-overview.rst` & `dask-2023.5.1/docs/source/scheduler-overview.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/scheduling-policy.rst` & `dask-2023.5.1/docs/source/scheduling-policy.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/scheduling.rst` & `dask-2023.5.1/docs/source/scheduling.rst`

 * *Files 0% similar despite different names*

```diff
@@ -232,15 +232,15 @@
 .. _ipyparallel: https://ipyparallel.readthedocs.io/en/latest/examples/Futures.html#Executors
 .. _mpi4py: https://mpi4py.readthedocs.io/en/latest/mpi4py.futures.html
 
 
 Standalone Python scripts
 -------------------------
 
-Some care needs to be taken when running Dask schedulers in a standlone Python script.
+Some care needs to be taken when running Dask schedulers in a standalone Python script.
 Specifically, when using the single-machine multiprocessing scheduler or the local distributed
 scheduler, Dask will create additional Python processes. As part of Python's normal subprocess
 initialization, Python will import the contents of the script in every child process that is created
 (this is true for any Python code where child processes are created -- not just in Dask).
 This import initialization can lead to subprocesses recursively creating other subprocesses
 and eventually an error is raised.
```

### Comparing `dask-2023.5.0/docs/source/scripts/scheduling.py` & `dask-2023.5.1/docs/source/scripts/scheduling.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,7 +1,9 @@
+from __future__ import annotations
+
 from random import randint
 from time import time
 
 import matplotlib.pyplot as plt
 
 import dask
 from dask import local, multiprocessing, threaded
```

### Comparing `dask-2023.5.0/docs/source/shared.rst` & `dask-2023.5.1/docs/source/shared.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/spark.rst` & `dask-2023.5.1/docs/source/spark.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/spec.rst` & `dask-2023.5.1/docs/source/spec.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/support.rst` & `dask-2023.5.1/docs/source/support.rst`

 * *Files 7% similar despite different names*

```diff
@@ -30,16 +30,17 @@
     Note that Slack chat not easily searchable and indexed by search engines, so
     detailed discussion topics around bug reports or usage should go to GitHub issues or
     the Dask Discourse forum, respectively.
 #.  **Monthly developer meeting** happens the first Thursday of the month at
     10:00 US Central Time in `this video meeting <https://us06web.zoom.us/j/87619866741?pwd=S2RxMlRKcnVvakt4NHZoS1cwOGZoZz09>`__.
     Meeting notes are available in
     `this Google doc <https://docs.google.com/document/d/1UqNAP87a56ERH_xkQsS5Q_0PKYybd5Lj2WANy_hRzI0/edit>`_.
-#.  **Monthly social meeting** happens the third Thursday of the month at 10:00
-    US Central Time in `this video meeting <https://whereby.com/dask-dev>`__.
+#.  **Monthly demo day** happens the third Thursday of the month at 10:00
+    US Central Time in `this video meeting <https://us06web.zoom.us/j/89383035703?pwd=WkRJSzNnRTh4T2R1ZjJuVVdJWlMxQT09>`__.
+    Sign ups `here <https://github.com/dask/community/issues/307>`__.
 
     .. raw:: html
 
        <iframe id="calendariframe" src="https://calendar.google.com/calendar/embed?ctz=local&amp;src=4l0vts0c1cgdbq5jhcogj55sfs%40group.calendar.google.com" style="border: 0" width="800" height="600" frameborder="0" scrolling="no"></iframe>
        <script>document.getElementById("calendariframe").src = document.getElementById("calendariframe").src.replace("ctz=local", "ctz=" + Intl.DateTimeFormat().resolvedOptions().timeZone)</script>
 
     You can subscribe to this calendar to be notified of changes:
@@ -84,10 +85,10 @@
 
 
 Paid support
 ------------
 In addition to the previous options, paid support is available from the
 following organizations (listed in alphabetical order):
 
--   Anaconda: `<https://www.anaconda.com/products/professional-services>`_
--   Coiled: `<https://coiled.io>`_
--   Quansight: `<https://www.quansight.com/open-source-support>`_
+-   `Anaconda <https://www.anaconda.com/products/professional-services>`_
+-  `Coiled <https://coiled.io?utm_source=dask-docs&utm_medium=support>`_
+-   `Quansight <https://www.quansight.com/open-source-support>`_
```

#### html2text {}

```diff
@@ -17,17 +17,19 @@
 detailed discussion topics around bug reports or usage should go to GitHub
 issues or the Dask Discourse forum, respectively. #. **Monthly developer
 meeting** happens the first Thursday of the month at 10:00 US Central Time in
 `this video meeting
 us06web.zoom.us/j/87619866741?pwd=S2RxMlRKcnVvakt4NHZoS1cwOGZoZz09>`__. Meeting
 notes are available in `this Google doc
 docs.google.com/document/d/1UqNAP87a56ERH_xkQsS5Q_0PKYybd5Lj2WANy_hRzI0/
-edit>`_. #. **Monthly social meeting** happens the third Thursday of the month
-at 10:00 US Central Time in `this video meeting
-whereby.com/dask-dev>`__. .. raw:: html
+edit>`_. #. **Monthly demo day** happens the third Thursday of the month at 10:
+00 US Central Time in `this video meeting
+us06web.zoom.us/j/89383035703?pwd=WkRJSzNnRTh4T2R1ZjJuVVdJWlMxQT09>`__. Sign
+ups `here
+github.com/dask/community/issues/307>`__. .. raw:: html
  You can subscribe to this calendar to be notified of changes: * `Google
 Calendar
 calendar.google.com/calendar/u/
 0?cid=NGwwdnRzMGMxY2dkYnE1amhjb2dqNTVzZnNAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ>`__
 * `iCal
 calendar.google.com/calendar/ical/
 4l0vts0c1cgdbq5jhcogj55sfs%40group.calendar.google.com/public/basic.ics>`__ ..
@@ -49,11 +51,11 @@
 stackoverflow.com/help/mcve>`_. This significantly reduces the time that
 answerers spend understanding your situation, resulting in higher quality
 answers more quickly. See also `this blogpost
 matthewrocklin.com/blog/work/2018/02/28/minimal-bug-reports>`_ about crafting
 minimal bug reports. These have a much higher likelihood of being answered Paid
 support ------------ In addition to the previous options, paid support is
 available from the following organizations (listed in alphabetical order): -
-Anaconda: `
-www.anaconda.com/products/professional-services>`_ - Coiled: `
-coiled.io>`_ - Quansight: `
+`Anaconda
+www.anaconda.com/products/professional-services>`_ - `Coiled
+coiled.io?utm_source=dask-docs&utm_medium=support>`_ - `Quansight
 www.quansight.com/open-source-support>`_
```

### Comparing `dask-2023.5.0/docs/source/understanding-performance.rst` & `dask-2023.5.1/docs/source/understanding-performance.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/user-interfaces.rst` & `dask-2023.5.1/docs/source/user-interfaces.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/docs/source/why.rst` & `dask-2023.5.1/docs/source/why.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.5.0/pyproject.toml` & `dask-2023.5.1/pyproject.toml`

 * *Files 2% similar despite different names*

```diff
@@ -13,24 +13,23 @@
     "Intended Audience :: Developers",
     "Intended Audience :: Science/Research",
     "License :: OSI Approved :: BSD License",
     "Operating System :: OS Independent",
     "Programming Language :: Python",
     "Programming Language :: Python :: 3",
     "Programming Language :: Python :: 3 :: Only",
-    "Programming Language :: Python :: 3.8",
     "Programming Language :: Python :: 3.9",
     "Programming Language :: Python :: 3.10",
     "Programming Language :: Python :: 3.11",
     "Topic :: Scientific/Engineering",
     "Topic :: System :: Distributed Computing",
 ]
 readme = "README.rst"
 urls = {Homepage = "https://github.com/dask/dask/"}
-requires-python = ">=3.8"
+requires-python = ">=3.9"
 dependencies = [
     # NOTE: These are tested in `continuous_integration/test_imports.sh` If
     # you modify these, make sure to change the corresponding line there.
     "click >= 8.0",
     "cloudpickle >= 1.5.0",
     "fsspec >= 2021.09.0",
     "packaging >= 20.0",
@@ -52,29 +51,30 @@
 array = ["numpy >= 1.21"]
 # keeping for backwards compatibility
 bag = []
 dataframe = [
     "numpy >= 1.21",
     "pandas >= 1.3",
 ]
-distributed = ["distributed == 2023.5.0"]
+distributed = ["distributed == 2023.5.1"]
 diagnostics = [
     "bokeh >= 2.4.2",
     "jinja2 >= 2.10.3",
 ]
 # keeping for backwards compatibility
 delayed = []
 complete = [
     "dask[array,dataframe,distributed,diagnostics]",
     "pyarrow >= 7.0",
     "lz4 >= 4.3.2",
 ]
 test = [
     "pandas[test]",
     "pytest",
+    "pytest-cov",
     "pytest-rerunfailures",
     "pytest-xdist",
     "pre-commit",
 ]
 
 [project.entry-points."dask.array.backends"]
 cupy = "dask.array.cupy_entry_point:CupyBackendEntrypoint"
@@ -100,14 +100,15 @@
 sections = ["FUTURE", "STDLIB", "THIRDPARTY", "DISTRIBUTED", "FIRSTPARTY", "LOCALFOLDER"]
 profile = "black"
 skip_gitignore = true
 force_to_top = ["true"]
 default_section = "THIRDPARTY"
 known_first_party = ["dask"]
 known_distributed = ["distributed"]
+add_imports = ["from __future__ import annotations"]
 
 [tool.versioneer]
 VCS = "git"
 style = "pep440"
 versionfile_source = "dask/_version.py"
 versionfile_build = "dask/_version.py"
 tag_prefix = ""
@@ -133,14 +134,17 @@
     'ignore:The distutils\.sysconfig module is deprecated, use sysconfig instead:DeprecationWarning:numpy',
     # With no network access, distributed raises a warning when detecting local IP address
     "ignore:Couldn't detect a suitable IP address:RuntimeWarning:distributed",
     # Ignore FutureWarning for change in group_keys behavior: no changes required on the dask side.
     # https://pandas.pydata.org/docs/dev/whatsnew/v1.5.0.html#using-group-keys-with-transformers-in-groupby-apply
     "ignore:Not prepending group keys:FutureWarning",
     "ignore:.*:dask.tests.warning_aliases.RemovedIn20Warning",
+    # This is coming from pandas use of np.find_common_type
+    # See https://github.com/pandas-dev/pandas/issues/53236
+    "ignore:np.find_common_type is deprecated:DeprecationWarning",
 ]
 xfail_strict = true
 
 [tool.mypy]
 # Silence errors about Python 3.9-style delayed type annotations on Python 3.8
 python_version = "3.9"
 # See https://github.com/python/mypy/issues/12286 for automatic multi-platform support
```

