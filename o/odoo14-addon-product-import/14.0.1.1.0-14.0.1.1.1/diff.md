# Comparing `tmp/odoo14_addon_product_import-14.0.1.1.0-py3-none-any.whl.zip` & `tmp/odoo14_addon_product_import-14.0.1.1.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,22 +1,22 @@
-Zip file size: 28029 bytes, number of entries: 20
--rw-r--r--  2.0 unx     3034 b- defN 22-Dec-02 13:34 odoo/addons/product_import/README.rst
--rw-r--r--  2.0 unx       87 b- defN 22-Dec-02 13:34 odoo/addons/product_import/__init__.py
--rw-r--r--  2.0 unx      574 b- defN 22-Dec-02 13:34 odoo/addons/product_import/__manifest__.py
--rw-r--r--  2.0 unx     4492 b- defN 22-Dec-02 13:34 odoo/addons/product_import/i18n/product_import.pot
--rw-r--r--  2.0 unx       51 b- defN 22-Dec-02 13:34 odoo/addons/product_import/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx      272 b- defN 22-Dec-02 13:34 odoo/addons/product_import/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      176 b- defN 22-Dec-02 13:34 odoo/addons/product_import/security/ir.model.access.csv
--rw-r--r--  2.0 unx     9455 b- defN 22-Dec-02 13:34 odoo/addons/product_import/static/description/icon.png
--rw-r--r--  2.0 unx    12350 b- defN 22-Dec-02 13:34 odoo/addons/product_import/static/description/index.html
--rw-r--r--  2.0 unx      134 b- defN 22-Dec-02 13:34 odoo/addons/product_import/tests/__init__.py
--rw-r--r--  2.0 unx      657 b- defN 22-Dec-02 13:34 odoo/addons/product_import/tests/common.py
--rw-r--r--  2.0 unx     3825 b- defN 22-Dec-02 13:34 odoo/addons/product_import/tests/test_parse_validate.py
--rw-r--r--  2.0 unx     4415 b- defN 22-Dec-02 13:34 odoo/addons/product_import/tests/test_product_import.py
--rw-r--r--  2.0 unx       95 b- defN 22-Dec-02 13:34 odoo/addons/product_import/wizard/__init__.py
--rw-r--r--  2.0 unx     8055 b- defN 22-Dec-02 13:34 odoo/addons/product_import/wizard/product_import.py
--rw-r--r--  2.0 unx     2184 b- defN 22-Dec-02 13:34 odoo/addons/product_import/wizard/product_import_view.xml
--rw-r--r--  2.0 unx     3665 b- defN 22-Dec-02 13:34 odoo14_addon_product_import-14.0.1.1.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-Dec-02 13:34 odoo14_addon_product_import-14.0.1.1.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 22-Dec-02 13:34 odoo14_addon_product_import-14.0.1.1.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2079 b- defN 22-Dec-02 13:34 odoo14_addon_product_import-14.0.1.1.0.dist-info/RECORD
-20 files, 55697 bytes uncompressed, 24471 bytes compressed:  56.1%
+Zip file size: 28248 bytes, number of entries: 20
+-rw-r--r--  2.0 unx     3034 b- defN 23-May-26 13:09 odoo/addons/product_import/README.rst
+-rw-r--r--  2.0 unx       87 b- defN 23-May-26 13:08 odoo/addons/product_import/__init__.py
+-rw-r--r--  2.0 unx      574 b- defN 23-May-26 13:09 odoo/addons/product_import/__manifest__.py
+-rw-r--r--  2.0 unx     4653 b- defN 23-May-26 13:09 odoo/addons/product_import/i18n/product_import.pot
+-rw-r--r--  2.0 unx       51 b- defN 23-May-26 13:08 odoo/addons/product_import/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx      272 b- defN 23-May-26 13:08 odoo/addons/product_import/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      176 b- defN 23-May-26 13:08 odoo/addons/product_import/security/ir.model.access.csv
+-rw-r--r--  2.0 unx     9455 b- defN 23-May-26 13:08 odoo/addons/product_import/static/description/icon.png
+-rw-r--r--  2.0 unx    12350 b- defN 23-May-26 13:09 odoo/addons/product_import/static/description/index.html
+-rw-r--r--  2.0 unx      134 b- defN 23-May-26 13:08 odoo/addons/product_import/tests/__init__.py
+-rw-r--r--  2.0 unx      657 b- defN 23-May-26 13:08 odoo/addons/product_import/tests/common.py
+-rw-r--r--  2.0 unx     3825 b- defN 23-May-26 13:08 odoo/addons/product_import/tests/test_parse_validate.py
+-rw-r--r--  2.0 unx     4415 b- defN 23-May-26 13:08 odoo/addons/product_import/tests/test_product_import.py
+-rw-r--r--  2.0 unx       95 b- defN 23-May-26 13:08 odoo/addons/product_import/wizard/__init__.py
+-rw-r--r--  2.0 unx     8822 b- defN 23-May-26 13:09 odoo/addons/product_import/wizard/product_import.py
+-rw-r--r--  2.0 unx     2184 b- defN 23-May-26 13:08 odoo/addons/product_import/wizard/product_import_view.xml
+-rw-r--r--  2.0 unx     3665 b- defN 23-May-26 13:09 odoo14_addon_product_import-14.0.1.1.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-26 13:09 odoo14_addon_product_import-14.0.1.1.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-May-26 13:09 odoo14_addon_product_import-14.0.1.1.1.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2079 b- defN 23-May-26 13:09 odoo14_addon_product_import-14.0.1.1.1.dist-info/RECORD
+20 files, 56625 bytes uncompressed, 24690 bytes compressed:  56.4%
```

## zipnote {}

```diff
@@ -42,20 +42,20 @@
 
 Filename: odoo/addons/product_import/wizard/product_import.py
 Comment: 
 
 Filename: odoo/addons/product_import/wizard/product_import_view.xml
 Comment: 
 
-Filename: odoo14_addon_product_import-14.0.1.1.0.dist-info/METADATA
+Filename: odoo14_addon_product_import-14.0.1.1.1.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_product_import-14.0.1.1.0.dist-info/WHEEL
+Filename: odoo14_addon_product_import-14.0.1.1.1.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_product_import-14.0.1.1.0.dist-info/top_level.txt
+Filename: odoo14_addon_product_import-14.0.1.1.1.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_product_import-14.0.1.1.0.dist-info/RECORD
+Filename: odoo14_addon_product_import-14.0.1.1.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/product_import/__manifest__.py

```diff
@@ -1,13 +1,13 @@
 # Copyright 2022 Camptocamp SA
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl).
 
 {
     "name": "Product Import",
-    "version": "14.0.1.1.0",
+    "version": "14.0.1.1.1",
     "development_status": "Alpha",
     "license": "AGPL-3",
     "summary": "Import product catalogues",
     "author": "Camptocamp, Odoo Community Association (OCA)",
     "website": "https://github.com/OCA/edi",
     "depends": [
         "stock",
```

## odoo/addons/product_import/i18n/product_import.pot

```diff
@@ -15,14 +15,20 @@
 
 #. module: product_import
 #: model_terms:ir.ui.view,arch_db:product_import.product_import_form
 msgid "Cancel"
 msgstr ""
 
 #. module: product_import
+#: code:addons/product_import/wizard/product_import.py:0
+#, python-format
+msgid "Cannot import product without barcode: %s"
+msgstr ""
+
+#. module: product_import
 #: model:ir.model.fields,field_description:product_import.field_product_import__create_uid
 msgid "Created by"
 msgstr ""
 
 #. module: product_import
 #: model:ir.model.fields,field_description:product_import.field_product_import__create_date
 msgid "Created on"
```

## odoo/addons/product_import/wizard/product_import.py

```diff
@@ -125,97 +125,113 @@
         seller_id = False
         result = []
         if product:
             # Terminate previous prices
             for s_info in product.seller_ids:
                 if s_info.name.id != seller_info["name"]:
                     continue
+                if s_info.company_id.id not in (seller_info["company_id"], False):
+                    continue
                 if s_info.date_end and s_info.date_end < today:
                     continue
                 if (
                     s_info.product_code == seller_info["product_code"]
                     and s_info.min_qty == seller_info["min_qty"]
                     and s_info.price == seller_info["price"]
                     and s_info.currency_id.id == seller_info["currency_id"]
+                    and s_info.company_id.id == seller_info["company_id"]
                 ):
                     seller_id = s_info.id
                 else:
                     result.append((1, s_info.id, {"date_end": yesterday}))
         if not seller_id:
             seller_info.setdefault("date_start", today)
             result.append((0, 0, seller_info))
         return result
 
     @api.model
     def _prepare_product(self, parsed_product, chatter_msg, seller=None):
-        try:
-            product = self._bdimport.with_context(active_test=False)._match_product(
-                parsed_product, chatter_msg, seller=seller
+        # Important: barcode is unique key of product.template model
+        # So records product.product are created with company_id=False.
+        # Only the pricelist (product.supplierinfo) is company-specific.
+        product_company_id = self.env.context.get("product_company_id", False)
+        if not parsed_product["barcode"]:
+            chatter_msg.append(
+                _("Cannot import product without barcode: %s") % (parsed_product,)
             )
-        except UserError:
-            product = None
+            return False
+        product = (
+            self.env["product.product"]
+            .with_context(active_test=False)
+            .search([("barcode", "=", parsed_product["barcode"])], limit=1)
+        )
         uom = self._bdimport._match_uom(parsed_product["uom"], chatter_msg)
         currency = self._bdimport._match_currency(
             parsed_product["currency"], chatter_msg
         )
 
         product_vals = {
             "active": parsed_product.get("active", True),
             "default_code": parsed_product["code"],
             "barcode": parsed_product["barcode"],
             "name": parsed_product["name"],
             "description": parsed_product["description"],
             "type": "product",
             "uom_id": uom.id,
             "uom_po_id": uom.id,
-            "company_id": self.env.context.get("company_id") or False,
+            "company_id": False,
         }
         seller_info = {
             "name": seller and seller.id or False,
             "product_code": parsed_product["product_code"],
             "price": parsed_product["price"],
             "currency_id": currency.id,
             "min_qty": parsed_product["min_qty"],
+            "company_id": product_company_id,
         }
         product_vals["seller_ids"] = self._prepare_supplierinfo(seller_info, product)
         if product:
             product_vals["recordset"] = product
 
         return product_vals
 
     @api.model
     def create_product(self, parsed_product, chatter_msg, seller=None):
         product_vals = self._prepare_product(parsed_product, chatter_msg, seller=seller)
+        if not product_vals:
+            return False
         product = product_vals.pop("recordset", None)
         if product:
             product.write(product_vals)
             logger.info("Product %d updated", product.id)
         else:
             product = self.env["product.product"].create(product_vals)
             logger.info("Product %d created", product.id)
         return product
 
     @api.model
     def _create_products(self, catalogue, seller, filename=None):
         products = self.env["product.product"].browse()
         for product in catalogue.get("products"):
-            products |= self.create_product(
+            record = self.create_product(
                 product,
                 catalogue["chatter_msg"],
                 seller=seller,
             )
+            if record:
+                products |= record
         self._bdimport.post_create_or_update(catalogue, seller, doc_filename=filename)
         logger.info("Products updated for vendor %d", seller.id)
         return products
 
     def import_button(self):
         self.ensure_one()
         file_content = b64decode(self.product_file)
         catalogue = self.parse_product_catalogue(file_content, self.product_filename)
         if not catalogue.get("products"):
             raise UserError(_("This catalogue doesn't have any product!"))
         company_id = self._get_company_id(catalogue)
         seller = self._get_seller(catalogue)
-        self.with_context(company_id=company_id)._create_products(
+        self.with_context(product_company_id=company_id)._create_products(
             catalogue, seller, filename=self.product_filename
         )
         return {"type": "ir.actions.act_window_close"}
```

## Comparing `odoo14_addon_product_import-14.0.1.1.0.dist-info/METADATA` & `odoo14_addon_product_import-14.0.1.1.1.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-product-import
-Version: 14.0.1.1.0
+Version: 14.0.1.1.1
 Summary: Import product catalogues
 Home-page: https://github.com/OCA/edi
 Author: Camptocamp, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo14_addon_product_import-14.0.1.1.0.dist-info/RECORD` & `odoo14_addon_product_import-14.0.1.1.1.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,20 +1,20 @@
 odoo/addons/product_import/README.rst,sha256=S5Ze1gBXW11HpmF2ULT1zWpLEZVBsmpvks17840AMpM,3034
 odoo/addons/product_import/__init__.py,sha256=gA-KJwIexlEfoOBXIOdkDJyux5LVXOe0NDc3-jNwgkc,87
-odoo/addons/product_import/__manifest__.py,sha256=9_9mlIUdmG_LXqm9F7FvmE7TgcL9SwRRUee__LW-etU,574
-odoo/addons/product_import/i18n/product_import.pot,sha256=xzDK5G1cvKL_mtNQUkAaCxpuge7arKFOm0j4MBD13uo,4492
+odoo/addons/product_import/__manifest__.py,sha256=0bIFch4xA2Cd8M6gtzKMSnXnaYx_7grylfpZXrVPIjU,574
+odoo/addons/product_import/i18n/product_import.pot,sha256=btqLwVJlIf27Ng0KUEq81adTq1VbCwFc2nIOJIXUMgk,4653
 odoo/addons/product_import/readme/CONTRIBUTORS.rst,sha256=ZB_XsVnfWGVQaWJ0eMK3hV4nd0HIg1WRHHV7H0dol28,51
 odoo/addons/product_import/readme/DESCRIPTION.rst,sha256=IouXY5cE-IiyzoZohDQZn7UFvrQNn-cgkaFIi_D1R5A,272
 odoo/addons/product_import/security/ir.model.access.csv,sha256=S-t2vM7MRCG2WtQFmExI79MW7bB0FZBePL2pQniamIs,176
 odoo/addons/product_import/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
 odoo/addons/product_import/static/description/index.html,sha256=IL6HUA21SqZ9enzNN0zKN5wMmjbBaSeEW_wwHEBGza8,12350
 odoo/addons/product_import/tests/__init__.py,sha256=fximK22x03jiyqHE_kRbIuZiCfAYBS5BwUwqotGx_Go,134
 odoo/addons/product_import/tests/common.py,sha256=kB173QVfWZavbybo0a186bZAwrnRN0pEyst11CDiTeI,657
 odoo/addons/product_import/tests/test_parse_validate.py,sha256=whFJSqc21WZufisDp4Bu1b6P0JMdjTkrEdYG06_U_6E,3825
 odoo/addons/product_import/tests/test_product_import.py,sha256=yGbQS1i_Fy2GOo65EpyiaxRsl_bdOe4cteeozci_UgU,4415
 odoo/addons/product_import/wizard/__init__.py,sha256=OFsihyARRCaX0VrSfc3kV26MFnjNnJI9i8iTSxpD-rc,95
-odoo/addons/product_import/wizard/product_import.py,sha256=dtqFZHOYUYNZ_2om6XClXXG2PaCF2lu3u0FsZPYrp3E,8055
+odoo/addons/product_import/wizard/product_import.py,sha256=wYxgDQM1VSihGTDzPD30TbjHSS0GNRtcVOPxoTrBjxY,8822
 odoo/addons/product_import/wizard/product_import_view.xml,sha256=rAk4Y9hr6IxTYMofVXGNYcUT7rlK1vFoM1-z3ChlIzk,2184
-odoo14_addon_product_import-14.0.1.1.0.dist-info/METADATA,sha256=BgmuaBQhxAsg7Y8Mml1oYU-f8xlxCDuzbeJaziQgouo,3665
-odoo14_addon_product_import-14.0.1.1.0.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-odoo14_addon_product_import-14.0.1.1.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo14_addon_product_import-14.0.1.1.0.dist-info/RECORD,,
+odoo14_addon_product_import-14.0.1.1.1.dist-info/METADATA,sha256=6uYQWsHyI4jv6p8vZQYydKgN377N2e_KsZqkdSHnbWk,3665
+odoo14_addon_product_import-14.0.1.1.1.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+odoo14_addon_product_import-14.0.1.1.1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo14_addon_product_import-14.0.1.1.1.dist-info/RECORD,,
```

