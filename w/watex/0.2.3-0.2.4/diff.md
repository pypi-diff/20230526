# Comparing `tmp/watex-0.2.3.tar.gz` & `tmp/watex-0.2.4.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "watex-0.2.3.tar", last modified: Sun May 14 08:46:38 2023, max compression
+gzip compressed data, was "watex-0.2.4.tar", last modified: Fri May 26 14:51:01 2023, max compression
```

## Comparing `watex-0.2.3.tar` & `watex-0.2.4.tar`

### file list

```diff
@@ -1,365 +1,366 @@
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.401985 watex-0.2.3/
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:37.962852 watex-0.2.3/.github/
--rw-rw-rw-   0        0        0      524 2023-02-19 15:19:16.000000 watex-0.2.3/.github/dependabot.yml
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:37.967491 watex-0.2.3/.github/workflows/
--rw-rw-rw-   0        0        0     1616 2023-02-21 12:32:38.000000 watex-0.2.3/.github/workflows/ci.yaml
--rw-rw-rw-   0        0        0     3025 2023-02-19 15:19:16.000000 watex-0.2.3/.github/workflows/codeql.yml
--rw-rw-rw-   0        0        0      905 2023-02-19 15:19:16.000000 watex-0.2.3/.github/workflows/dependency-review.yml
--rw-rw-rw-   0        0        0     1457 2023-03-02 12:14:24.000000 watex-0.2.3/.github/workflows/python-package.yml
--rw-rw-rw-   0        0        0     3118 2023-05-07 17:25:43.000000 watex-0.2.3/.gitignore
--rw-rw-rw-   0        0        0      553 2023-03-17 13:03:23.000000 watex-0.2.3/CITATION.cff
--rw-rw-rw-   0        0        0     1548 2023-01-08 08:20:47.000000 watex-0.2.3/LICENSE
--rw-rw-rw-   0        0        0     1045 2023-05-14 08:24:24.000000 watex-0.2.3/MANIFEST.in
--rw-rw-rw-   0        0        0    15807 2023-05-14 08:46:38.403265 watex-0.2.3/PKG-INFO
--rw-rw-rw-   0        0        0    14370 2023-05-14 07:22:16.000000 watex-0.2.3/README.md
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:37.989393 watex-0.2.3/docs/
--rw-rw-rw-   0        0        0      139 2023-02-18 10:33:13.000000 watex-0.2.3/docs/.gitignore
--rw-rw-rw-   0        0        0      658 2023-01-08 08:20:47.000000 watex-0.2.3/docs/Makefile
--rw-rw-rw-   0        0        0      251 2023-03-20 12:42:04.000000 watex-0.2.3/docs/README.md
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.007305 watex-0.2.3/docs/_static/
--rw-rw-rw-   0        0        0     2711 2023-01-08 08:52:36.000000 watex-0.2.3/docs/_static/copybutton.js
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.009799 watex-0.2.3/docs/_static/css/
--rw-rw-rw-   0        0        0   155712 2023-01-28 12:21:35.000000 watex-0.2.3/docs/_static/css/bootstrap.min.css
--rw-rw-rw-   0        0        0     7607 2023-05-13 16:07:36.000000 watex-0.2.3/docs/_static/css/custom.css
--rw-rw-rw-   0        0        0    70782 2023-02-01 10:38:29.000000 watex-0.2.3/docs/_static/favicon.ico
--rw-rw-rw-   0        0        0     1150 2023-01-30 16:08:53.000000 watex-0.2.3/docs/_static/favicon0.ico
--rw-rw-rw-   0        0        0     8356 2023-01-08 08:52:36.000000 watex-0.2.3/docs/_static/favicon_old.ico
--rw-rw-rw-   0        0        0     3519 2023-01-30 11:43:04.000000 watex-0.2.3/docs/_static/index_api.svg
--rw-rw-rw-   0        0        0     2528 2023-01-30 11:43:05.000000 watex-0.2.3/docs/_static/index_contribute.svg
--rw-rw-rw-   0        0        0     3977 2023-01-30 11:43:04.000000 watex-0.2.3/docs/_static/index_getting_started.svg
--rw-rw-rw-   0        0        0     6429 2023-01-30 11:43:05.000000 watex-0.2.3/docs/_static/index_user_guide.svg
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:37.940108 watex-0.2.3/docs/_static/js/
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.010918 watex-0.2.3/docs/_static/js/vendor/
--rw-rw-rw-   0        0        0    58030 2023-01-28 12:21:35.000000 watex-0.2.3/docs/_static/js/vendor/bootstrap.min.js
--rw-rw-rw-   0        0        0    72818 2023-01-28 12:21:35.000000 watex-0.2.3/docs/_static/js/vendor/jquery-3.6.3.slim.min.js
--rw-rw-rw-   0        0        0     1738 2023-02-02 06:30:47.000000 watex-0.2.3/docs/_static/logo.svg
--rw-rw-rw-   0        0        0     2346 2023-01-08 08:52:36.000000 watex-0.2.3/docs/_static/logo_no_name.svg
--rw-rw-rw-   0        0        0     1916 2023-01-28 05:52:08.000000 watex-0.2.3/docs/_static/logo_small.svg
--rw-rw-rw-   0        0        0     2631 2023-01-08 08:52:36.000000 watex-0.2.3/docs/_static/logo_wide.svg
--rw-rw-rw-   0        0        0     1916 2023-01-28 05:52:08.000000 watex-0.2.3/docs/_static/logo_wide_rev.svg
--rw-rw-rw-   0        0        0     3052 2023-01-08 08:52:36.000000 watex-0.2.3/docs/_static/logo_wide_rev0.svg
--rw-rw-rw-   0        0        0      909 2023-05-14 07:22:16.000000 watex-0.2.3/docs/_static/switcher.json
--rw-rw-rw-   0        0        0      166 2023-01-28 15:18:48.000000 watex-0.2.3/docs/_static/theme.conf
--rw-rw-rw-   0        0        0     1464 2023-01-30 16:00:33.000000 watex-0.2.3/docs/_static/to_favicon.svg
--rw-rw-rw-   0        0        0   125058 2023-01-30 14:23:50.000000 watex-0.2.3/docs/_static/watex_thumb_image.svg
--rw-rw-rw-   0        0        0    26516 2023-01-30 05:05:07.000000 watex-0.2.3/docs/_static/watex_workflow.svg
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.016821 watex-0.2.3/docs/_templates/
--rw-rw-rw-   0        0        0     5128 2023-01-28 12:21:35.000000 watex-0.2.3/docs/_templates/javascript.html
--rw-rw-rw-   0        0        0     1821 2023-05-07 16:57:49.000000 watex-0.2.3/docs/_templates/layout.html
--rw-rw-rw-   0        0        0       87 2023-01-09 10:30:31.000000 watex-0.2.3/docs/_templates/version.html
--rw-rw-rw-   0        0        0    16686 2023-02-01 15:09:39.000000 watex-0.2.3/docs/analysis.rst
--rw-rw-rw-   0        0        0    23221 2023-05-13 11:54:50.000000 watex-0.2.3/docs/api_references.rst
--rw-rw-rw-   0        0        0    15873 2023-04-14 23:54:09.000000 watex-0.2.3/docs/base.rst
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.018259 watex-0.2.3/docs/binder/
--rw-rw-rw-   0        0        0      258 2023-01-08 08:52:36.000000 watex-0.2.3/docs/binder/requirements.txt
--rw-rw-rw-   0        0        0    11688 2023-01-30 11:20:05.000000 watex-0.2.3/docs/cases.rst
--rw-rw-rw-   0        0        0     2772 2023-03-17 13:03:23.000000 watex-0.2.3/docs/citing.rst
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.019265 watex-0.2.3/docs/community/
--rw-rw-rw-   0        0        0     2322 2023-02-19 15:58:54.000000 watex-0.2.3/docs/community/CONTRIBUTING.md
--rw-rw-rw-   0        0        0    16384 2023-03-25 08:21:17.000000 watex-0.2.3/docs/conf.py
--rw-rw-rw-   0        0        0    18198 2023-02-01 09:06:05.000000 watex-0.2.3/docs/datasets.rst
--rw-rw-rw-   0        0        0    16155 2023-02-05 16:03:43.000000 watex-0.2.3/docs/development.rst
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.020753 watex-0.2.3/docs/example_thumbs/
--rw-rw-rw-   0        0        0        0 2023-01-08 08:52:36.000000 watex-0.2.3/docs/example_thumbs/.gitkeep
--rw-rw-rw-   0        0        0    69141 2023-01-30 05:05:07.000000 watex-0.2.3/docs/example_thumbs/watex_workflow.gif
--rw-rw-rw-   0        0        0   100537 2023-03-12 07:09:50.000000 watex-0.2.3/docs/glossary.rst
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.024505 watex-0.2.3/docs/history/
--rw-rw-rw-   0        0        0     5834 2023-02-18 16:26:08.000000 watex-0.2.3/docs/history/five_min_understanding.rst
--rw-rw-rw-   0        0        0      385 2023-02-18 15:40:51.000000 watex-0.2.3/docs/history/index.rst
--rw-rw-rw-   0        0        0     5454 2023-02-21 12:32:38.000000 watex-0.2.3/docs/history/project_goals.rst
--rw-rw-rw-   0        0        0     9463 2023-02-20 11:39:27.000000 watex-0.2.3/docs/history/project_story.rst
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.025766 watex-0.2.3/docs/includes/
--rw-rw-rw-   0        0        0      762 2023-01-10 10:17:54.000000 watex-0.2.3/docs/includes/big_toc_css.rst
--rw-rw-rw-   0        0        0     1087 2023-01-10 10:19:34.000000 watex-0.2.3/docs/includes/bigger_toc_css.rst
--rw-rw-rw-   0        0        0     1918 2023-02-19 16:15:09.000000 watex-0.2.3/docs/index.rst
--rw-rw-rw-   0        0        0    12622 2023-03-19 07:20:06.000000 watex-0.2.3/docs/installation.rst
--rwxrwxrwx   0        0        0      804 2023-01-08 08:20:47.000000 watex-0.2.3/docs/make.bat
--rw-rw-rw-   0        0        0       20 2023-01-08 08:52:36.000000 watex-0.2.3/docs/matplotlibrc.txt
--rw-rw-rw-   0        0        0    46356 2023-02-18 06:46:56.000000 watex-0.2.3/docs/methods.rst
--rw-rw-rw-   0        0        0      548 2023-03-24 16:49:23.000000 watex-0.2.3/docs/requirements.txt
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.026866 watex-0.2.3/docs/source/
--rw-rw-rw-   0        0        0    20241 2023-01-10 14:10:18.000000 watex-0.2.3/docs/source/index.html
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.031008 watex-0.2.3/docs/sphinxext/
--rw-rw-rw-   0        0        0       43 2023-01-12 12:03:56.000000 watex-0.2.3/docs/sphinxext/MANIFEST.in
--rw-rw-rw-   0        0        0     6182 2023-01-12 11:57:22.000000 watex-0.2.3/docs/sphinxext/add_toctree_functions.py
--rw-rw-rw-   0        0        0     1784 2023-01-12 12:03:00.000000 watex-0.2.3/docs/sphinxext/doi_role.py
--rw-rw-rw-   0        0        0     8329 2023-01-12 12:01:15.000000 watex-0.2.3/docs/sphinxext/sphinx_issues.py
--rw-rw-rw-   0        0        0    16329 2023-02-05 13:07:26.000000 watex-0.2.3/docs/structure.rst
--rw-rw-rw-   0        0        0     3807 2023-01-10 10:22:10.000000 watex-0.2.3/docs/tune_toc.rst
--rw-rw-rw-   0        0        0      391 2023-02-02 12:44:21.000000 watex-0.2.3/docs/user_guide.rst
--rw-rw-rw-   0        0        0    42796 2023-01-30 09:59:53.000000 watex-0.2.3/docs/utils.rst
--rw-rw-rw-   0        0        0    76837 2023-02-10 02:52:23.000000 watex-0.2.3/docs/view.rst
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.044088 watex-0.2.3/docs/whatsnew/
--rw-rw-rw-   0        0        0      538 2023-05-07 16:59:43.000000 watex-0.2.3/docs/whatsnew/index.rst
--rw-rw-rw-   0        0        0     1737 2023-03-19 09:38:32.000000 watex-0.2.3/docs/whatsnew/v0.1.0.rst
--rw-rw-rw-   0        0        0     2801 2023-03-19 09:37:06.000000 watex-0.2.3/docs/whatsnew/v0.1.1.rst
--rw-rw-rw-   0        0        0     2202 2023-03-19 09:44:19.000000 watex-0.2.3/docs/whatsnew/v0.1.2.rst
--rw-rw-rw-   0        0        0     2120 2023-03-19 09:42:28.000000 watex-0.2.3/docs/whatsnew/v0.1.3.rst
--rw-rw-rw-   0        0        0     3469 2023-03-19 09:27:50.000000 watex-0.2.3/docs/whatsnew/v0.1.4.rst
--rw-rw-rw-   0        0        0     4092 2023-03-19 10:54:01.000000 watex-0.2.3/docs/whatsnew/v0.1.5.rst
--rw-rw-rw-   0        0        0    21723 2023-03-07 14:39:00.000000 watex-0.2.3/docs/whatsnew/v0.1.6-alpha.rst
--rw-rw-rw-   0        0        0     5019 2023-03-19 09:20:02.000000 watex-0.2.3/docs/whatsnew/v0.1.6.rst
--rw-rw-rw-   0        0        0     1457 2023-03-19 10:17:51.000000 watex-0.2.3/docs/whatsnew/v0.1.7.rst
--rw-rw-rw-   0        0        0     2108 2023-03-20 12:42:04.000000 watex-0.2.3/docs/whatsnew/v0.1.8.rst
--rw-rw-rw-   0        0        0     2042 2023-04-14 23:54:09.000000 watex-0.2.3/docs/whatsnew/v0.1.9.rst
--rw-rw-rw-   0        0        0     5730 2023-04-20 04:00:41.000000 watex-0.2.3/docs/whatsnew/v0.2.0.rst
--rw-rw-rw-   0        0        0     4070 2023-04-22 11:36:08.000000 watex-0.2.3/docs/whatsnew/v0.2.1.rst
--rw-rw-rw-   0        0        0     1093 2023-04-22 07:50:27.000000 watex-0.2.3/docs/whatsnew/v0.2.2.rst
--rw-rw-rw-   0        0        0     2218 2023-05-14 07:06:05.000000 watex-0.2.3/docs/whatsnew/v0.2.3.rst
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.045464 watex-0.2.3/examples/
--rw-rw-rw-   0        0        0      427 2023-01-11 10:44:04.000000 watex-0.2.3/examples/README.txt
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.049689 watex-0.2.3/examples/analysis/
--rw-rw-rw-   0        0        0      109 2023-01-18 16:53:37.000000 watex-0.2.3/examples/analysis/README.txt
--rw-rw-rw-   0        0        0     1031 2023-01-11 15:25:23.000000 watex-0.2.3/examples/analysis/plot_decision_regions.py
--rw-rw-rw-   0        0        0     1171 2023-01-11 15:25:54.000000 watex-0.2.3/examples/analysis/plot_explained_variance_ratio.py
--rw-rw-rw-   0        0        0      875 2023-01-11 15:26:26.000000 watex-0.2.3/examples/analysis/plot_linear_discriminant_analysis.py
--rw-rw-rw-   0        0        0      541 2023-01-11 15:26:56.000000 watex-0.2.3/examples/analysis/plot_pca_vs_factor_with_scedatic_noises.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.058032 watex-0.2.3/examples/applications/
--rw-rw-rw-   0        0        0      510 2023-01-18 17:34:21.000000 watex-0.2.3/examples/applications/README.txt
--rw-rw-rw-   0        0        0     3329 2023-03-05 22:27:58.000000 watex-0.2.3/examples/applications/plot_auto_detect_drilling_location.py
--rw-rw-rw-   0        0        0     8710 2023-01-11 16:26:30.000000 watex-0.2.3/examples/applications/plot_data_exploratory_quick_view.py
--rw-rw-rw-   0        0        0    10236 2023-02-15 12:36:42.000000 watex-0.2.3/examples/applications/plot_dc_em_parameters_computings.py
--rw-rw-rw-   0        0        0     8084 2023-01-20 17:43:45.000000 watex-0.2.3/examples/applications/plot_flow_rate_prediction.py
--rw-rw-rw-   0        0        0     3029 2023-05-14 06:45:04.000000 watex-0.2.3/examples/applications/plot_kmf.py
--rw-rw-rw-   0        0        0     3325 2023-02-16 17:12:25.000000 watex-0.2.3/examples/applications/plot_nsamt_tensor_recovery.py
--rw-rw-rw-   0        0        0     5719 2023-03-17 13:03:23.000000 watex-0.2.3/examples/applications/plot_tensor_restoring.py
--rw-rw-rw-   0        0        0    11030 2023-03-01 11:09:04.000000 watex-0.2.3/examples/applications/plot_ymxs_label_for_k_prediction.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.059060 watex-0.2.3/examples/auto_examples/
--rw-rw-rw-   0        0        0        0 2023-01-25 09:04:31.000000 watex-0.2.3/examples/auto_examples/.gitkeep
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.062758 watex-0.2.3/examples/base/
--rw-rw-rw-   0        0        0      141 2023-01-18 16:52:30.000000 watex-0.2.3/examples/base/README.txt
--rw-rw-rw-   0        0        0     1002 2023-01-11 15:30:46.000000 watex-0.2.3/examples/base/plot_ada_gd.py
--rw-rw-rw-   0        0        0     1032 2023-01-11 15:31:27.000000 watex-0.2.3/examples/base/plot_ada_stochastic_gd.py
--rw-rw-rw-   0        0        0      902 2023-01-11 15:31:50.000000 watex-0.2.3/examples/base/plot_missing.py
--rw-rw-rw-   0        0        0     1392 2023-01-11 15:32:51.000000 watex-0.2.3/examples/base/plot_sbs_feature_selector.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.071750 watex-0.2.3/examples/methods/
--rw-rw-rw-   0        0        0      106 2023-01-08 08:52:36.000000 watex-0.2.3/examples/methods/README.txt
--rw-rw-rw-   0        0        0      874 2023-01-20 17:25:23.000000 watex-0.2.3/examples/methods/plot_2d_tensor_filtered.py
--rw-rw-rw-   0        0        0     1071 2023-01-11 15:40:37.000000 watex-0.2.3/examples/methods/plot_anomaly.py
--rw-rw-rw-   0        0        0     1852 2023-01-11 15:41:46.000000 watex-0.2.3/examples/methods/plot_filtered_tensors.py
--rw-rw-rw-   0        0        0     1007 2023-01-11 15:43:30.000000 watex-0.2.3/examples/methods/plot_logging_predictor_and_target.py
--rw-rw-rw-   0        0        0      884 2023-01-11 15:44:27.000000 watex-0.2.3/examples/methods/plot_logging_predictor_only.py
--rw-rw-rw-   0        0        0      638 2023-01-11 15:44:36.000000 watex-0.2.3/examples/methods/plot_multiple_sites_recovery_signal.py
--rw-rw-rw-   0        0        0     2423 2023-03-02 12:26:23.000000 watex-0.2.3/examples/methods/plot_phase_tensors.py
--rw-rw-rw-   0        0        0      806 2023-01-11 15:44:59.000000 watex-0.2.3/examples/methods/plot_raw_2d_tensor.py
--rw-rw-rw-   0        0        0      915 2023-01-11 15:45:48.000000 watex-0.2.3/examples/methods/plot_ves_fracture_zone.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.097965 watex-0.2.3/examples/utils/
--rw-rw-rw-   0        0        0      125 2023-01-08 08:52:36.000000 watex-0.2.3/examples/utils/README.txt
--rw-rw-rw-   0        0        0      788 2023-01-09 07:43:08.000000 watex-0.2.3/examples/utils/plot_clusters.py
--rw-rw-rw-   0        0        0     2373 2023-03-06 16:32:37.000000 watex-0.2.3/examples/utils/plot_confidence_in_data.py
--rw-rw-rw-   0        0        0     1489 2023-01-11 15:46:32.000000 watex-0.2.3/examples/utils/plot_confusion_matrices.py
--rw-rw-rw-   0        0        0     1124 2023-01-09 07:43:29.000000 watex-0.2.3/examples/utils/plot_confusion_matrix_sweet.py
--rw-rw-rw-   0        0        0      526 2023-01-11 15:46:56.000000 watex-0.2.3/examples/utils/plot_elbow.py
--rw-rw-rw-   0        0        0     1758 2023-01-25 03:02:32.000000 watex-0.2.3/examples/utils/plot_erp.py
--rw-rw-rw-   0        0        0      655 2023-01-11 15:48:44.000000 watex-0.2.3/examples/utils/plot_errors_vs_epochs.py
--rw-rw-rw-   0        0        0      631 2023-01-11 15:49:01.000000 watex-0.2.3/examples/utils/plot_ex_heatmap.py
--rw-rw-rw-   0        0        0      717 2023-01-11 15:50:15.000000 watex-0.2.3/examples/utils/plot_ex_matrix.py
--rw-rw-rw-   0        0        0     1094 2023-01-11 15:50:34.000000 watex-0.2.3/examples/utils/plot_learning_curves.py
--rw-rw-rw-   0        0        0     1787 2023-01-11 15:51:32.000000 watex-0.2.3/examples/utils/plot_log.py
--rw-rw-rw-   0        0        0     1053 2023-01-09 07:44:13.000000 watex-0.2.3/examples/utils/plot_model_confusion_matrix.py
--rw-rw-rw-   0        0        0      751 2023-01-11 15:53:36.000000 watex-0.2.3/examples/utils/plot_naive_dendrogram.py
--rw-rw-rw-   0        0        0      716 2023-01-11 15:53:51.000000 watex-0.2.3/examples/utils/plot_naive_silhouette.py
--rw-rw-rw-   0        0        0      678 2023-01-11 15:54:53.000000 watex-0.2.3/examples/utils/plot_ohmic_area.py
--rw-rw-rw-   0        0        0      814 2023-01-08 08:52:36.000000 watex-0.2.3/examples/utils/plot_pca_components.py
--rw-rw-rw-   0        0        0      611 2023-01-11 15:55:25.000000 watex-0.2.3/examples/utils/plot_regularization_path.py
--rw-rw-rw-   0        0        0      623 2023-01-11 15:55:45.000000 watex-0.2.3/examples/utils/plot_rf_feature_importances.py
--rw-rw-rw-   0        0        0      966 2023-01-24 10:29:45.000000 watex-0.2.3/examples/utils/plot_savitzky_golay1d.py
--rw-rw-rw-   0        0        0     1132 2023-01-08 08:52:36.000000 watex-0.2.3/examples/utils/plot_sbs_feature_selection.py
--rw-rw-rw-   0        0        0     1793 2023-01-25 04:57:49.000000 watex-0.2.3/examples/utils/plot_sfi.py
--rw-rw-rw-   0        0        0     3121 2023-03-04 11:47:12.000000 watex-0.2.3/examples/utils/plot_skew.py
--rw-rw-rw-   0        0        0     2236 2023-03-19 08:17:21.000000 watex-0.2.3/examples/utils/plot_strike.py
--rw-rw-rw-   0        0        0      693 2023-05-14 06:02:07.000000 watex-0.2.3/examples/utils/plot_voronoi.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.133743 watex-0.2.3/examples/view/
--rw-rw-rw-   0        0        0      113 2023-01-18 16:54:11.000000 watex-0.2.3/examples/view/README.txt
--rw-rw-rw-   0        0        0      915 2023-01-24 02:59:52.000000 watex-0.2.3/examples/view/plot_2d_filtered_tensors.py
--rw-rw-rw-   0        0        0      933 2023-01-11 15:58:16.000000 watex-0.2.3/examples/view/plot_base_distributions.py
--rw-rw-rw-   0        0        0     1101 2023-01-16 18:53:31.000000 watex-0.2.3/examples/view/plot_biplot.py
--rw-rw-rw-   0        0        0      553 2023-01-11 15:59:22.000000 watex-0.2.3/examples/view/plot_box.py
--rw-rw-rw-   0        0        0     1678 2023-01-11 16:00:02.000000 watex-0.2.3/examples/view/plot_confusion_matrix_metric.py
--rw-rw-rw-   0        0        0      852 2023-01-08 08:52:36.000000 watex-0.2.3/examples/view/plot_correlating_features.py
--rw-rw-rw-   0        0        0      449 2023-01-11 16:01:24.000000 watex-0.2.3/examples/view/plot_correlation_missing_data.py
--rw-rw-rw-   0        0        0      599 2023-01-11 16:00:47.000000 watex-0.2.3/examples/view/plot_cut_comparison.py
--rw-rw-rw-   0        0        0      453 2023-01-11 16:01:48.000000 watex-0.2.3/examples/view/plot_dendro_missing_data.py
--rw-rw-rw-   0        0        0      921 2023-01-16 17:55:57.000000 watex-0.2.3/examples/view/plot_dendrogram.py
--rw-rw-rw-   0        0        0      854 2023-01-16 17:19:14.000000 watex-0.2.3/examples/view/plot_dendroheat.py
--rw-rw-rw-   0        0        0      920 2023-01-11 16:05:35.000000 watex-0.2.3/examples/view/plot_discussing_features.py
--rw-rw-rw-   0        0        0      697 2023-01-11 16:06:18.000000 watex-0.2.3/examples/view/plot_grid.py
--rw-rw-rw-   0        0        0      676 2023-01-11 16:06:48.000000 watex-0.2.3/examples/view/plot_hist.py
--rw-rw-rw-   0        0        0      888 2023-01-08 08:52:36.000000 watex-0.2.3/examples/view/plot_jointing_features.py
--rw-rw-rw-   0        0        0      644 2023-01-11 16:07:06.000000 watex-0.2.3/examples/view/plot_learning_inspections.py
--rw-rw-rw-   0        0        0     1365 2023-01-11 16:08:38.000000 watex-0.2.3/examples/view/plot_matshow.py
--rw-rw-rw-   0        0        0     2370 2023-01-11 16:10:01.000000 watex-0.2.3/examples/view/plot_model.py
--rw-rw-rw-   0        0        0      588 2023-01-11 16:10:11.000000 watex-0.2.3/examples/view/plot_model_inspection.py
--rw-rw-rw-   0        0        0     1964 2023-01-18 15:28:17.000000 watex-0.2.3/examples/view/plot_model_scores.py
--rw-rw-rw-   0        0        0      725 2023-01-09 07:52:42.000000 watex-0.2.3/examples/view/plot_multiple_feature_distributions.py
--rw-rw-rw-   0        0        0     1226 2023-01-09 07:52:51.000000 watex-0.2.3/examples/view/plot_num_features.py
--rw-rw-rw-   0        0        0     1241 2023-01-11 16:11:17.000000 watex-0.2.3/examples/view/plot_pairwise_corr.py
--rw-rw-rw-   0        0        0      524 2023-01-11 16:11:59.000000 watex-0.2.3/examples/view/plot_pararell_corrdinates.py
--rw-rw-rw-   0        0        0     1372 2023-01-11 16:12:35.000000 watex-0.2.3/examples/view/plot_pca.py
--rw-rw-rw-   0        0        0     5274 2023-03-04 05:56:10.000000 watex-0.2.3/examples/view/plot_phase_sensistive_skew.py
--rw-rw-rw-   0        0        0      818 2023-01-20 17:26:34.000000 watex-0.2.3/examples/view/plot_phase_tensor_2d.py
--rw-rw-rw-   0        0        0      817 2023-01-11 16:12:58.000000 watex-0.2.3/examples/view/plot_pr.py
--rw-rw-rw-   0        0        0     1893 2023-01-16 18:57:53.000000 watex-0.2.3/examples/view/plot_projection.py
--rw-rw-rw-   0        0        0      883 2023-01-11 16:18:27.000000 watex-0.2.3/examples/view/plot_radviz.py
--rw-rw-rw-   0        0        0      929 2023-01-11 16:19:02.000000 watex-0.2.3/examples/view/plot_reg_scoring.py
--rw-rw-rw-   0        0        0      869 2023-01-11 16:19:28.000000 watex-0.2.3/examples/view/plot_res_tensor_2d.py
--rw-rw-rw-   0        0        0     1939 2023-04-20 03:25:59.000000 watex-0.2.3/examples/view/plot_rhoa.py
--rw-rw-rw-   0        0        0     1757 2023-01-11 16:19:47.000000 watex-0.2.3/examples/view/plot_roc.py
--rw-rw-rw-   0        0        0      794 2023-01-11 16:20:19.000000 watex-0.2.3/examples/view/plot_scatter.py
--rw-rw-rw-   0        0        0     1523 2023-01-11 16:20:37.000000 watex-0.2.3/examples/view/plot_scattering_features.py
--rw-rw-rw-   0        0        0      543 2023-01-08 08:52:36.000000 watex-0.2.3/examples/view/plot_silhouette.py
--rw-rw-rw-   0        0        0      759 2023-01-09 07:56:02.000000 watex-0.2.3/examples/view/plot_single_site_signal_recovery.py
--rw-rw-rw-   0        0        0      834 2023-01-11 16:21:15.000000 watex-0.2.3/examples/view/plot_target_inspection.py
--rw-rw-rw-   0        0        0     1615 2023-05-05 12:57:48.000000 watex-0.2.3/pyproject.toml
--rw-rw-rw-   0        0        0      901 2023-05-14 08:46:38.414298 watex-0.2.3/setup.cfg
--rw-rw-rw-   0        0        0     4646 2023-04-20 07:15:26.000000 watex-0.2.3/setup.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.151803 watex-0.2.3/watex/
--rw-rw-rw-   0        0        0     8550 2023-05-12 10:00:13.000000 watex-0.2.3/watex/__init__.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.208371 watex-0.2.3/watex/_build/
--rw-rw-rw-   0        0        0       27 2023-03-11 03:28:02.000000 watex-0.2.3/watex/_build/__init__.py
--rw-rw-rw-   0        0        0       30 2023-01-08 08:20:47.000000 watex-0.2.3/watex/_build/_check_build.pyx
--rw-rw-rw-   0        0        0      333 2023-01-08 08:20:47.000000 watex-0.2.3/watex/_distributor_init.py
--rw-rw-rw-   0        0        0    32010 2023-03-20 12:42:04.000000 watex-0.2.3/watex/_docstring.py
--rw-rw-rw-   0        0        0     3852 2023-03-11 03:28:02.000000 watex-0.2.3/watex/_isotonic.pyx
--rw-rw-rw-   0        0        0    17770 2023-04-14 23:54:09.000000 watex-0.2.3/watex/_typing.py
--rw-rw-rw-   0        0        0      218 2023-05-14 08:46:36.000000 watex-0.2.3/watex/_version.py
--rw-rw-rw-   0        0        0     8798 2023-03-12 01:49:05.000000 watex-0.2.3/watex/_watexlog.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.210925 watex-0.2.3/watex/analysis/
--rw-rw-rw-   0        0        0     1242 2023-02-04 08:11:48.000000 watex-0.2.3/watex/analysis/__init__.py
--rw-rw-rw-   0        0        0    23341 2023-01-18 16:30:53.000000 watex-0.2.3/watex/analysis/decomposition.py
--rw-rw-rw-   0        0        0    25575 2023-02-05 12:23:26.000000 watex-0.2.3/watex/analysis/dimensionality.py
--rw-rw-rw-   0        0        0     9305 2023-02-04 08:20:23.000000 watex-0.2.3/watex/analysis/factor.py
--rw-rw-rw-   0        0        0    85025 2023-03-12 01:49:14.000000 watex-0.2.3/watex/base.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.219604 watex-0.2.3/watex/cases/
--rw-rw-rw-   0        0        0     1078 2023-01-12 16:27:24.000000 watex-0.2.3/watex/cases/__init__.py
--rw-rw-rw-   0        0        0    38684 2023-03-12 01:39:59.000000 watex-0.2.3/watex/cases/features.py
--rw-rw-rw-   0        0        0    31952 2023-03-12 01:40:49.000000 watex-0.2.3/watex/cases/modeling.py
--rw-rw-rw-   0        0        0    39022 2023-03-12 01:40:40.000000 watex-0.2.3/watex/cases/prepare.py
--rw-rw-rw-   0        0        0    49220 2023-03-12 01:41:33.000000 watex-0.2.3/watex/cases/processing.py
--rw-rw-rw-   0        0        0     1353 2023-03-15 12:48:58.000000 watex-0.2.3/watex/cli.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.228301 watex-0.2.3/watex/datasets/
--rw-rw-rw-   0        0        0      868 2023-05-05 12:57:48.000000 watex-0.2.3/watex/datasets/__init__.py
--rw-rw-rw-   0        0        0     7785 2023-03-21 13:31:09.000000 watex-0.2.3/watex/datasets/_config.py
--rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/_hongliu.py
--rw-rw-rw-   0        0        0     5677 2023-03-21 13:58:43.000000 watex-0.2.3/watex/datasets/_p.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.263785 watex-0.2.3/watex/datasets/data/
--rw-rw-rw-   0        0        0       27 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/data/__init__.py
--rw-rw-rw-   0        0        0   328758 2023-03-20 17:59:44.000000 watex-0.2.3/watex/datasets/data/b.pkl
--rw-rw-rw-   0        0        0    34993 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/data/bagoue.csv
--rw-rw-rw-   0        0        0    35250 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/data/boston_house_prices.csv
--rw-rw-rw-   0        0        0      638 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/data/boundiali_ves.csv
--rw-rw-rw-   0        0        0     1158 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/data/dcerp_gbalo.csv
--rw-rw-rw-   0        0        0      699 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/data/dcves_gbalo.csv
--rw-rw-rw-   0        0        0  2216584 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/data/e.h5
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.266963 watex-0.2.3/watex/datasets/data/edis/
--rw-rw-rw-   0        0        0        4 2023-02-24 10:23:34.000000 watex-0.2.3/watex/datasets/data/edis/__init__.py
--rw-rw-rw-   0        0        0   170380 2023-02-24 10:23:34.000000 watex-0.2.3/watex/datasets/data/edis/raw.E.zip
--rw-rw-rw-   0        0        0   184986 2023-02-24 10:23:34.000000 watex-0.2.3/watex/datasets/data/edis/s.E.zip
--rw-rw-rw-   0        0        0 11940145 2023-05-05 12:57:48.000000 watex-0.2.3/watex/datasets/data/h.h5
--rw-rw-rw-   0        0        0     2885 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/data/iris.csv
--rw-rw-rw-   0        0        0   731414 2023-05-05 12:57:48.000000 watex-0.2.3/watex/datasets/data/mxs.joblib
--rw-rw-rw-   0        0        0      603 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/data/semien_ves.csv
--rw-rw-rw-   0        0        0     2230 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/data/tankesse.csv
--rw-rw-rw-   0        0        0    11336 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/data/wine_data.csv
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.274392 watex-0.2.3/watex/datasets/descr/
--rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/descr/__init__.py
--rw-rw-rw-   0        0        0     2827 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/descr/bagoue.rst
--rw-rw-rw-   0        0        0     2397 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/descr/boston_house_prices.rst
--rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/descr/boundiali_ves.rst
--rw-rw-rw-   0        0        0     1822 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/descr/california_housing.rst
--rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/descr/gbalo_erp.rst
--rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/descr/gbalo_ves.rst
--rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/descr/huayuan_edis.rst
--rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/descr/iris.rst
--rw-rw-rw-   0        0        0     3544 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/descr/wine_data.rst
--rw-rw-rw-   0        0        0    43069 2023-05-12 10:00:13.000000 watex-0.2.3/watex/datasets/dload.py
--rw-rw-rw-   0        0        0    17331 2023-05-05 12:57:48.000000 watex-0.2.3/watex/datasets/gdata.py
--rw-rw-rw-   0        0        0    13639 2023-03-24 15:43:33.000000 watex-0.2.3/watex/datasets/io.py
--rw-rw-rw-   0        0        0    34896 2023-03-12 01:42:57.000000 watex-0.2.3/watex/datasets/rload.py
--rw-rw-rw-   0        0        0     6966 2023-05-05 12:57:48.000000 watex-0.2.3/watex/datasets/sets.py
--rw-rw-rw-   0        0        0      822 2023-01-08 08:20:47.000000 watex-0.2.3/watex/datasets/setup.py
--rw-rw-rw-   0        0        0   101706 2023-03-12 01:49:23.000000 watex-0.2.3/watex/decorators.py
--rw-rw-rw-   0        0        0   115869 2023-03-23 14:01:07.000000 watex-0.2.3/watex/edi.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.285852 watex-0.2.3/watex/etc/
--rw-rw-rw-   0        0        0     5711 2023-01-08 08:20:47.000000 watex-0.2.3/watex/etc/AGSO.csv
--rw-rw-rw-   0        0        0      351 2023-01-08 08:20:47.000000 watex-0.2.3/watex/etc/AGSO_STCODES.csv
--rw-rw-rw-   0        0        0    14650 2023-03-20 14:32:57.000000 watex-0.2.3/watex/etc/__XTyT.pkl
--rw-rw-rw-   0        0        0    37763 2023-03-20 16:12:55.000000 watex-0.2.3/watex/etc/__Xy.pkl
--rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.3/watex/etc/__init__.py
--rw-rw-rw-   0        0        0   811233 2023-01-08 08:20:47.000000 watex-0.2.3/watex/etc/__memory.pkl
--rw-rw-rw-   0        0        0    28672 2023-01-08 08:20:47.000000 watex-0.2.3/watex/etc/memory.sq3
--rw-rw-rw-   0        0        0 52244397 2023-01-08 08:20:47.000000 watex-0.2.3/watex/etc/p.models.pkl
--rw-rw-rw-   0        0        0     9383 2023-03-24 14:28:17.000000 watex-0.2.3/watex/exceptions.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.349958 watex-0.2.3/watex/exlib/
--rw-rw-rw-   0        0        0     4022 2023-03-27 14:03:16.000000 watex-0.2.3/watex/exlib/__init__.py
--rw-rw-rw-   0        0        0     2580 2023-03-15 12:48:58.000000 watex-0.2.3/watex/exlib/gbm.py
--rw-rw-rw-   0        0        0     7156 2023-03-12 01:43:33.000000 watex-0.2.3/watex/exlib/sklearn.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.355522 watex-0.2.3/watex/externals/
--rw-rw-rw-   0        0        0      313 2023-01-18 17:47:22.000000 watex-0.2.3/watex/externals/__init__.py
--rw-rw-rw-   0        0        0     4835 2023-01-08 08:20:47.000000 watex-0.2.3/watex/externals/_numpy_compiler_patch.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.358590 watex-0.2.3/watex/externals/_pkgs/
--rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.3/watex/externals/_pkgs/__init__.py
--rw-rw-rw-   0        0        0     3035 2023-01-08 08:20:47.000000 watex-0.2.3/watex/externals/_pkgs/_structures.py
--rw-rw-rw-   0        0        0    16762 2023-01-08 08:20:47.000000 watex-0.2.3/watex/externals/_pkgs/version.py
--rw-rw-rw-   0        0        0      273 2023-01-08 08:20:47.000000 watex-0.2.3/watex/externals/readme.md
--rw-rw-rw-   0        0        0    57854 2023-03-23 14:01:07.000000 watex-0.2.3/watex/externals/z.py
--rw-rw-rw-   0        0        0    24161 2023-03-12 01:43:53.000000 watex-0.2.3/watex/externals/zutils.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.363704 watex-0.2.3/watex/geology/
--rw-rw-rw-   0        0        0      966 2023-01-12 18:53:12.000000 watex-0.2.3/watex/geology/__init__.py
--rw-rw-rw-   0        0        0    12610 2023-03-12 01:44:05.000000 watex-0.2.3/watex/geology/core.py
--rw-rw-rw-   0        0        0    56354 2023-03-12 01:44:15.000000 watex-0.2.3/watex/geology/database.py
--rw-rw-rw-   0        0        0    36848 2023-03-12 01:44:24.000000 watex-0.2.3/watex/geology/drilling.py
--rw-rw-rw-   0        0        0    14479 2023-03-12 01:44:31.000000 watex-0.2.3/watex/geology/geology.py
--rw-rw-rw-   0        0        0    65011 2023-04-14 23:54:09.000000 watex-0.2.3/watex/geology/stratigraphic.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.369207 watex-0.2.3/watex/methods/
--rw-rw-rw-   0        0        0      867 2023-04-15 15:25:13.000000 watex-0.2.3/watex/methods/__init__.py
--rw-rw-rw-   0        0        0    82817 2023-04-22 06:56:19.000000 watex-0.2.3/watex/methods/electrical.py
--rw-rw-rw-   0        0        0   136685 2023-05-14 07:10:18.000000 watex-0.2.3/watex/methods/em.py
--rw-rw-rw-   0        0        0    86661 2023-04-22 06:56:19.000000 watex-0.2.3/watex/methods/erp.py
--rw-rw-rw-   0        0        0    43855 2023-03-12 01:45:26.000000 watex-0.2.3/watex/methods/hydro.py
--rw-rw-rw-   0        0        0    25531 2023-03-12 01:49:41.000000 watex-0.2.3/watex/metrics.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.373696 watex-0.2.3/watex/models/
--rw-rw-rw-   0        0        0     1064 2023-03-24 12:58:06.000000 watex-0.2.3/watex/models/__init__.py
--rw-rw-rw-   0        0        0     6889 2023-03-15 12:48:58.000000 watex-0.2.3/watex/models/_metapredictors.py
--rw-rw-rw-   0        0        0    18878 2023-03-15 12:48:58.000000 watex-0.2.3/watex/models/premodels.py
--rw-rw-rw-   0        0        0    44482 2023-03-28 11:58:09.000000 watex-0.2.3/watex/models/validation.py
--rw-rw-rw-   0        0        0    73950 2023-05-05 12:57:48.000000 watex-0.2.3/watex/property.py
--rw-rw-rw-   0        0        0    48351 2023-04-20 07:15:26.000000 watex-0.2.3/watex/site.py
--rw-rw-rw-   0        0        0    57197 2023-05-13 16:25:03.000000 watex-0.2.3/watex/transformers.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.399405 watex-0.2.3/watex/utils/
--rw-rw-rw-   0        0        0     5875 2023-05-13 14:10:22.000000 watex-0.2.3/watex/utils/__init__.py
--rw-rw-rw-   0        0        0     7140 2023-01-08 08:20:47.000000 watex-0.2.3/watex/utils/_array_api.py
--rw-rw-rw-   0        0        0     7730 2023-01-08 08:20:47.000000 watex-0.2.3/watex/utils/_arraytools.py
--rw-rw-rw-   0        0        0     5936 2023-02-01 06:46:13.000000 watex-0.2.3/watex/utils/_dependency.py
--rw-rw-rw-   0        0        0      222 2023-01-08 08:20:47.000000 watex-0.2.3/watex/utils/_openmp_helpers.pxd
--rw-rw-rw-   0        0        0     2674 2023-01-08 08:20:47.000000 watex-0.2.3/watex/utils/_openmp_helpers.pyx
--rw-rw-rw-   0        0        0    16659 2023-01-28 02:10:06.000000 watex-0.2.3/watex/utils/_packaging_version.py
--rw-rw-rw-   0        0        0     1616 2023-03-28 11:58:09.000000 watex-0.2.3/watex/utils/_set_gdal.py
--rw-rw-rw-   0        0        0     2583 2023-02-16 08:00:08.000000 watex-0.2.3/watex/utils/_show_versions.py
--rw-rw-rw-   0        0        0     8829 2023-03-12 01:46:25.000000 watex-0.2.3/watex/utils/box.py
--rw-rw-rw-   0        0        0    96739 2023-05-14 05:27:06.000000 watex-0.2.3/watex/utils/coreutils.py
--rw-rw-rw-   0        0        0   580618 2023-01-08 08:20:47.000000 watex-0.2.3/watex/utils/epsg.npy
--rw-rw-rw-   0        0        0   225629 2023-05-07 14:14:26.000000 watex-0.2.3/watex/utils/exmath.py
--rw-rw-rw-   0        0        0   228208 2023-05-13 14:08:36.000000 watex-0.2.3/watex/utils/funcutils.py
--rw-rw-rw-   0        0        0    50548 2023-03-12 01:46:46.000000 watex-0.2.3/watex/utils/geotools.py
--rw-rw-rw-   0        0        0    58698 2023-03-28 11:58:09.000000 watex-0.2.3/watex/utils/gistools.py
--rw-rw-rw-   0        0        0   139485 2023-05-05 12:57:48.000000 watex-0.2.3/watex/utils/hydroutils.py
--rw-rw-rw-   0        0        0   122839 2023-05-05 12:57:48.000000 watex-0.2.3/watex/utils/mlutils.py
--rw-rw-rw-   0        0        0   137563 2023-05-14 08:45:36.000000 watex-0.2.3/watex/utils/plotutils.py
--rw-rw-rw-   0        0        0      974 2023-01-08 08:20:47.000000 watex-0.2.3/watex/utils/setup.py
--rw-rw-rw-   0        0        0     3548 2023-01-08 08:20:47.000000 watex-0.2.3/watex/utils/thread.py
--rw-rw-rw-   0        0        0    86091 2023-05-13 08:59:32.000000 watex-0.2.3/watex/utils/validator.py
--rw-rw-rw-   0        0        0    16835 2023-01-28 01:30:49.000000 watex-0.2.3/watex/utils/version.py
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.401985 watex-0.2.3/watex/view/
--rw-rw-rw-   0        0        0     1008 2023-02-24 10:23:34.000000 watex-0.2.3/watex/view/__init__.py
--rw-rw-rw-   0        0        0   145840 2023-05-14 06:19:47.000000 watex-0.2.3/watex/view/mlplot.py
--rw-rw-rw-   0        0        0   190822 2023-04-22 06:56:19.000000 watex-0.2.3/watex/view/plot.py
--rw-rw-rw-   0        0        0     1222 2023-03-11 03:28:02.000000 watex-0.2.3/watex/wlog.yml
-drwxrwxrwx   0        0        0        0 2023-05-14 08:46:38.205598 watex-0.2.3/watex.egg-info/
--rw-rw-rw-   0        0        0    15807 2023-05-14 08:46:36.000000 watex-0.2.3/watex.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0     9465 2023-05-14 08:46:37.000000 watex-0.2.3/watex.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-05-14 08:46:36.000000 watex-0.2.3/watex.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       83 2023-05-14 08:46:36.000000 watex-0.2.3/watex.egg-info/entry_points.txt
--rw-rw-rw-   0        0        0      366 2023-05-14 08:46:36.000000 watex-0.2.3/watex.egg-info/requires.txt
--rw-rw-rw-   0        0        0        6 2023-05-14 08:46:36.000000 watex-0.2.3/watex.egg-info/top_level.txt
--rw-rw-rw-   0        0        0        2 2023-05-14 08:45:36.000000 watex-0.2.3/watex.egg-info/zip-safe
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.190748 watex-0.2.4/
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.798816 watex-0.2.4/.github/
+-rw-rw-rw-   0        0        0      524 2023-02-19 15:19:16.000000 watex-0.2.4/.github/dependabot.yml
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.802953 watex-0.2.4/.github/workflows/
+-rw-rw-rw-   0        0        0     1616 2023-02-21 12:32:38.000000 watex-0.2.4/.github/workflows/ci.yaml
+-rw-rw-rw-   0        0        0     3025 2023-02-19 15:19:16.000000 watex-0.2.4/.github/workflows/codeql.yml
+-rw-rw-rw-   0        0        0      905 2023-02-19 15:19:16.000000 watex-0.2.4/.github/workflows/dependency-review.yml
+-rw-rw-rw-   0        0        0     1457 2023-03-02 12:14:24.000000 watex-0.2.4/.github/workflows/python-package.yml
+-rw-rw-rw-   0        0        0     3118 2023-05-07 17:25:43.000000 watex-0.2.4/.gitignore
+-rw-rw-rw-   0        0        0      553 2023-03-17 13:03:23.000000 watex-0.2.4/CITATION.cff
+-rw-rw-rw-   0        0        0     1548 2023-01-08 08:20:47.000000 watex-0.2.4/LICENSE
+-rw-rw-rw-   0        0        0     1045 2023-05-14 08:24:24.000000 watex-0.2.4/MANIFEST.in
+-rw-rw-rw-   0        0        0    15816 2023-05-26 14:51:01.191741 watex-0.2.4/PKG-INFO
+-rw-rw-rw-   0        0        0    14379 2023-05-24 12:02:39.000000 watex-0.2.4/README.md
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.822738 watex-0.2.4/docs/
+-rw-rw-rw-   0        0        0      139 2023-02-18 10:33:13.000000 watex-0.2.4/docs/.gitignore
+-rw-rw-rw-   0        0        0      658 2023-01-08 08:20:47.000000 watex-0.2.4/docs/Makefile
+-rw-rw-rw-   0        0        0      251 2023-03-20 12:42:04.000000 watex-0.2.4/docs/README.md
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.843147 watex-0.2.4/docs/_static/
+-rw-rw-rw-   0        0        0     2711 2023-01-08 08:52:36.000000 watex-0.2.4/docs/_static/copybutton.js
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.847388 watex-0.2.4/docs/_static/css/
+-rw-rw-rw-   0        0        0   155712 2023-01-28 12:21:35.000000 watex-0.2.4/docs/_static/css/bootstrap.min.css
+-rw-rw-rw-   0        0        0     7607 2023-05-13 16:07:36.000000 watex-0.2.4/docs/_static/css/custom.css
+-rw-rw-rw-   0        0        0    70782 2023-02-01 10:38:29.000000 watex-0.2.4/docs/_static/favicon.ico
+-rw-rw-rw-   0        0        0     1150 2023-01-30 16:08:53.000000 watex-0.2.4/docs/_static/favicon0.ico
+-rw-rw-rw-   0        0        0     8356 2023-01-08 08:52:36.000000 watex-0.2.4/docs/_static/favicon_old.ico
+-rw-rw-rw-   0        0        0     3519 2023-01-30 11:43:04.000000 watex-0.2.4/docs/_static/index_api.svg
+-rw-rw-rw-   0        0        0     2528 2023-01-30 11:43:05.000000 watex-0.2.4/docs/_static/index_contribute.svg
+-rw-rw-rw-   0        0        0     3977 2023-01-30 11:43:04.000000 watex-0.2.4/docs/_static/index_getting_started.svg
+-rw-rw-rw-   0        0        0     6429 2023-01-30 11:43:05.000000 watex-0.2.4/docs/_static/index_user_guide.svg
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.775228 watex-0.2.4/docs/_static/js/
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.849908 watex-0.2.4/docs/_static/js/vendor/
+-rw-rw-rw-   0        0        0    58030 2023-01-28 12:21:35.000000 watex-0.2.4/docs/_static/js/vendor/bootstrap.min.js
+-rw-rw-rw-   0        0        0    72818 2023-01-28 12:21:35.000000 watex-0.2.4/docs/_static/js/vendor/jquery-3.6.3.slim.min.js
+-rw-rw-rw-   0        0        0     1738 2023-02-02 06:30:47.000000 watex-0.2.4/docs/_static/logo.svg
+-rw-rw-rw-   0        0        0     2346 2023-01-08 08:52:36.000000 watex-0.2.4/docs/_static/logo_no_name.svg
+-rw-rw-rw-   0        0        0     1916 2023-01-28 05:52:08.000000 watex-0.2.4/docs/_static/logo_small.svg
+-rw-rw-rw-   0        0        0     2631 2023-01-08 08:52:36.000000 watex-0.2.4/docs/_static/logo_wide.svg
+-rw-rw-rw-   0        0        0     1916 2023-01-28 05:52:08.000000 watex-0.2.4/docs/_static/logo_wide_rev.svg
+-rw-rw-rw-   0        0        0     3052 2023-01-08 08:52:36.000000 watex-0.2.4/docs/_static/logo_wide_rev0.svg
+-rw-rw-rw-   0        0        0     1020 2023-05-25 11:13:58.000000 watex-0.2.4/docs/_static/switcher.json
+-rw-rw-rw-   0        0        0      166 2023-01-28 15:18:48.000000 watex-0.2.4/docs/_static/theme.conf
+-rw-rw-rw-   0        0        0     1464 2023-01-30 16:00:33.000000 watex-0.2.4/docs/_static/to_favicon.svg
+-rw-rw-rw-   0        0        0   125058 2023-01-30 14:23:50.000000 watex-0.2.4/docs/_static/watex_thumb_image.svg
+-rw-rw-rw-   0        0        0    26516 2023-01-30 05:05:07.000000 watex-0.2.4/docs/_static/watex_workflow.svg
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.852912 watex-0.2.4/docs/_templates/
+-rw-rw-rw-   0        0        0     5128 2023-01-28 12:21:35.000000 watex-0.2.4/docs/_templates/javascript.html
+-rw-rw-rw-   0        0        0      867 2023-05-25 11:10:55.000000 watex-0.2.4/docs/_templates/layout.html
+-rw-rw-rw-   0        0        0       87 2023-01-09 10:30:31.000000 watex-0.2.4/docs/_templates/version.html
+-rw-rw-rw-   0        0        0    16686 2023-02-01 15:09:39.000000 watex-0.2.4/docs/analysis.rst
+-rw-rw-rw-   0        0        0    23293 2023-05-26 14:10:01.000000 watex-0.2.4/docs/api_references.rst
+-rw-rw-rw-   0        0        0    15873 2023-04-14 23:54:09.000000 watex-0.2.4/docs/base.rst
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.853913 watex-0.2.4/docs/binder/
+-rw-rw-rw-   0        0        0      258 2023-01-08 08:52:36.000000 watex-0.2.4/docs/binder/requirements.txt
+-rw-rw-rw-   0        0        0    11688 2023-01-30 11:20:05.000000 watex-0.2.4/docs/cases.rst
+-rw-rw-rw-   0        0        0     2772 2023-03-17 13:03:23.000000 watex-0.2.4/docs/citing.rst
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.853913 watex-0.2.4/docs/community/
+-rw-rw-rw-   0        0        0     2322 2023-02-19 15:58:54.000000 watex-0.2.4/docs/community/CONTRIBUTING.md
+-rw-rw-rw-   0        0        0    16384 2023-03-25 08:21:17.000000 watex-0.2.4/docs/conf.py
+-rw-rw-rw-   0        0        0    18198 2023-02-01 09:06:05.000000 watex-0.2.4/docs/datasets.rst
+-rw-rw-rw-   0        0        0    16155 2023-02-05 16:03:43.000000 watex-0.2.4/docs/development.rst
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.854913 watex-0.2.4/docs/example_thumbs/
+-rw-rw-rw-   0        0        0        0 2023-01-08 08:52:36.000000 watex-0.2.4/docs/example_thumbs/.gitkeep
+-rw-rw-rw-   0        0        0    69141 2023-01-30 05:05:07.000000 watex-0.2.4/docs/example_thumbs/watex_workflow.gif
+-rw-rw-rw-   0        0        0   100537 2023-03-12 07:09:50.000000 watex-0.2.4/docs/glossary.rst
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.859944 watex-0.2.4/docs/history/
+-rw-rw-rw-   0        0        0     5834 2023-02-18 16:26:08.000000 watex-0.2.4/docs/history/five_min_understanding.rst
+-rw-rw-rw-   0        0        0      385 2023-02-18 15:40:51.000000 watex-0.2.4/docs/history/index.rst
+-rw-rw-rw-   0        0        0     5454 2023-02-21 12:32:38.000000 watex-0.2.4/docs/history/project_goals.rst
+-rw-rw-rw-   0        0        0     9463 2023-02-20 11:39:27.000000 watex-0.2.4/docs/history/project_story.rst
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.860944 watex-0.2.4/docs/includes/
+-rw-rw-rw-   0        0        0      762 2023-01-10 10:17:54.000000 watex-0.2.4/docs/includes/big_toc_css.rst
+-rw-rw-rw-   0        0        0     1087 2023-01-10 10:19:34.000000 watex-0.2.4/docs/includes/bigger_toc_css.rst
+-rw-rw-rw-   0        0        0     1918 2023-02-19 16:15:09.000000 watex-0.2.4/docs/index.rst
+-rw-rw-rw-   0        0        0    12622 2023-03-19 07:20:06.000000 watex-0.2.4/docs/installation.rst
+-rwxrwxrwx   0        0        0      804 2023-01-08 08:20:47.000000 watex-0.2.4/docs/make.bat
+-rw-rw-rw-   0        0        0       20 2023-01-08 08:52:36.000000 watex-0.2.4/docs/matplotlibrc.txt
+-rw-rw-rw-   0        0        0    46356 2023-02-18 06:46:56.000000 watex-0.2.4/docs/methods.rst
+-rw-rw-rw-   0        0        0      548 2023-03-24 16:49:23.000000 watex-0.2.4/docs/requirements.txt
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.861944 watex-0.2.4/docs/source/
+-rw-rw-rw-   0        0        0    20241 2023-01-10 14:10:18.000000 watex-0.2.4/docs/source/index.html
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.864944 watex-0.2.4/docs/sphinxext/
+-rw-rw-rw-   0        0        0       43 2023-01-12 12:03:56.000000 watex-0.2.4/docs/sphinxext/MANIFEST.in
+-rw-rw-rw-   0        0        0     6182 2023-01-12 11:57:22.000000 watex-0.2.4/docs/sphinxext/add_toctree_functions.py
+-rw-rw-rw-   0        0        0     1784 2023-01-12 12:03:00.000000 watex-0.2.4/docs/sphinxext/doi_role.py
+-rw-rw-rw-   0        0        0     8329 2023-01-12 12:01:15.000000 watex-0.2.4/docs/sphinxext/sphinx_issues.py
+-rw-rw-rw-   0        0        0    16329 2023-02-05 13:07:26.000000 watex-0.2.4/docs/structure.rst
+-rw-rw-rw-   0        0        0     3807 2023-01-10 10:22:10.000000 watex-0.2.4/docs/tune_toc.rst
+-rw-rw-rw-   0        0        0      391 2023-02-02 12:44:21.000000 watex-0.2.4/docs/user_guide.rst
+-rw-rw-rw-   0        0        0    42796 2023-01-30 09:59:53.000000 watex-0.2.4/docs/utils.rst
+-rw-rw-rw-   0        0        0    76837 2023-02-10 02:52:23.000000 watex-0.2.4/docs/view.rst
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.878759 watex-0.2.4/docs/whatsnew/
+-rw-rw-rw-   0        0        0      549 2023-05-25 11:14:26.000000 watex-0.2.4/docs/whatsnew/index.rst
+-rw-rw-rw-   0        0        0     1737 2023-03-19 09:38:32.000000 watex-0.2.4/docs/whatsnew/v0.1.0.rst
+-rw-rw-rw-   0        0        0     2801 2023-03-19 09:37:06.000000 watex-0.2.4/docs/whatsnew/v0.1.1.rst
+-rw-rw-rw-   0        0        0     2202 2023-03-19 09:44:19.000000 watex-0.2.4/docs/whatsnew/v0.1.2.rst
+-rw-rw-rw-   0        0        0     2120 2023-03-19 09:42:28.000000 watex-0.2.4/docs/whatsnew/v0.1.3.rst
+-rw-rw-rw-   0        0        0     3469 2023-03-19 09:27:50.000000 watex-0.2.4/docs/whatsnew/v0.1.4.rst
+-rw-rw-rw-   0        0        0     4092 2023-03-19 10:54:01.000000 watex-0.2.4/docs/whatsnew/v0.1.5.rst
+-rw-rw-rw-   0        0        0    21723 2023-03-07 14:39:00.000000 watex-0.2.4/docs/whatsnew/v0.1.6-alpha.rst
+-rw-rw-rw-   0        0        0     5019 2023-03-19 09:20:02.000000 watex-0.2.4/docs/whatsnew/v0.1.6.rst
+-rw-rw-rw-   0        0        0     1457 2023-03-19 10:17:51.000000 watex-0.2.4/docs/whatsnew/v0.1.7.rst
+-rw-rw-rw-   0        0        0     2108 2023-03-20 12:42:04.000000 watex-0.2.4/docs/whatsnew/v0.1.8.rst
+-rw-rw-rw-   0        0        0     2042 2023-04-14 23:54:09.000000 watex-0.2.4/docs/whatsnew/v0.1.9.rst
+-rw-rw-rw-   0        0        0     5730 2023-04-20 04:00:41.000000 watex-0.2.4/docs/whatsnew/v0.2.0.rst
+-rw-rw-rw-   0        0        0     4070 2023-04-22 11:36:08.000000 watex-0.2.4/docs/whatsnew/v0.2.1.rst
+-rw-rw-rw-   0        0        0     1093 2023-04-22 07:50:27.000000 watex-0.2.4/docs/whatsnew/v0.2.2.rst
+-rw-rw-rw-   0        0        0     2011 2023-05-25 12:52:32.000000 watex-0.2.4/docs/whatsnew/v0.2.3.rst
+-rw-rw-rw-   0        0        0     4125 2023-05-26 09:54:41.000000 watex-0.2.4/docs/whatsnew/v0.2.4.rst
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.879152 watex-0.2.4/examples/
+-rw-rw-rw-   0        0        0      427 2023-01-11 10:44:04.000000 watex-0.2.4/examples/README.txt
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.883152 watex-0.2.4/examples/analysis/
+-rw-rw-rw-   0        0        0      109 2023-01-18 16:53:37.000000 watex-0.2.4/examples/analysis/README.txt
+-rw-rw-rw-   0        0        0     1031 2023-01-11 15:25:23.000000 watex-0.2.4/examples/analysis/plot_decision_regions.py
+-rw-rw-rw-   0        0        0     1171 2023-01-11 15:25:54.000000 watex-0.2.4/examples/analysis/plot_explained_variance_ratio.py
+-rw-rw-rw-   0        0        0      875 2023-01-11 15:26:26.000000 watex-0.2.4/examples/analysis/plot_linear_discriminant_analysis.py
+-rw-rw-rw-   0        0        0      541 2023-01-11 15:26:56.000000 watex-0.2.4/examples/analysis/plot_pca_vs_factor_with_scedatic_noises.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.891298 watex-0.2.4/examples/applications/
+-rw-rw-rw-   0        0        0      510 2023-01-18 17:34:21.000000 watex-0.2.4/examples/applications/README.txt
+-rw-rw-rw-   0        0        0     3329 2023-03-05 22:27:58.000000 watex-0.2.4/examples/applications/plot_auto_detect_drilling_location.py
+-rw-rw-rw-   0        0        0     8710 2023-01-11 16:26:30.000000 watex-0.2.4/examples/applications/plot_data_exploratory_quick_view.py
+-rw-rw-rw-   0        0        0    10236 2023-02-15 12:36:42.000000 watex-0.2.4/examples/applications/plot_dc_em_parameters_computings.py
+-rw-rw-rw-   0        0        0     8084 2023-01-20 17:43:45.000000 watex-0.2.4/examples/applications/plot_flow_rate_prediction.py
+-rw-rw-rw-   0        0        0     9799 2023-05-26 12:42:36.000000 watex-0.2.4/examples/applications/plot_kmf.py
+-rw-rw-rw-   0        0        0     3325 2023-02-16 17:12:25.000000 watex-0.2.4/examples/applications/plot_nsamt_tensor_recovery.py
+-rw-rw-rw-   0        0        0     5719 2023-03-17 13:03:23.000000 watex-0.2.4/examples/applications/plot_tensor_restoring.py
+-rw-rw-rw-   0        0        0    11379 2023-05-25 12:48:47.000000 watex-0.2.4/examples/applications/plot_ymxs_label_for_k_prediction.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.892301 watex-0.2.4/examples/auto_examples/
+-rw-rw-rw-   0        0        0        0 2023-01-25 09:04:31.000000 watex-0.2.4/examples/auto_examples/.gitkeep
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.895303 watex-0.2.4/examples/base/
+-rw-rw-rw-   0        0        0      141 2023-01-18 16:52:30.000000 watex-0.2.4/examples/base/README.txt
+-rw-rw-rw-   0        0        0     1002 2023-01-11 15:30:46.000000 watex-0.2.4/examples/base/plot_ada_gd.py
+-rw-rw-rw-   0        0        0     1032 2023-01-11 15:31:27.000000 watex-0.2.4/examples/base/plot_ada_stochastic_gd.py
+-rw-rw-rw-   0        0        0      902 2023-01-11 15:31:50.000000 watex-0.2.4/examples/base/plot_missing.py
+-rw-rw-rw-   0        0        0     1392 2023-01-11 15:32:51.000000 watex-0.2.4/examples/base/plot_sbs_feature_selector.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.903948 watex-0.2.4/examples/methods/
+-rw-rw-rw-   0        0        0      106 2023-01-08 08:52:36.000000 watex-0.2.4/examples/methods/README.txt
+-rw-rw-rw-   0        0        0      874 2023-01-20 17:25:23.000000 watex-0.2.4/examples/methods/plot_2d_tensor_filtered.py
+-rw-rw-rw-   0        0        0     1071 2023-01-11 15:40:37.000000 watex-0.2.4/examples/methods/plot_anomaly.py
+-rw-rw-rw-   0        0        0     1852 2023-01-11 15:41:46.000000 watex-0.2.4/examples/methods/plot_filtered_tensors.py
+-rw-rw-rw-   0        0        0     1007 2023-01-11 15:43:30.000000 watex-0.2.4/examples/methods/plot_logging_predictor_and_target.py
+-rw-rw-rw-   0        0        0      884 2023-01-11 15:44:27.000000 watex-0.2.4/examples/methods/plot_logging_predictor_only.py
+-rw-rw-rw-   0        0        0      638 2023-01-11 15:44:36.000000 watex-0.2.4/examples/methods/plot_multiple_sites_recovery_signal.py
+-rw-rw-rw-   0        0        0     2423 2023-03-02 12:26:23.000000 watex-0.2.4/examples/methods/plot_phase_tensors.py
+-rw-rw-rw-   0        0        0      806 2023-01-11 15:44:59.000000 watex-0.2.4/examples/methods/plot_raw_2d_tensor.py
+-rw-rw-rw-   0        0        0      915 2023-01-11 15:45:48.000000 watex-0.2.4/examples/methods/plot_ves_fracture_zone.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.926252 watex-0.2.4/examples/utils/
+-rw-rw-rw-   0        0        0      125 2023-01-08 08:52:36.000000 watex-0.2.4/examples/utils/README.txt
+-rw-rw-rw-   0        0        0      788 2023-01-09 07:43:08.000000 watex-0.2.4/examples/utils/plot_clusters.py
+-rw-rw-rw-   0        0        0     2373 2023-03-06 16:32:37.000000 watex-0.2.4/examples/utils/plot_confidence_in_data.py
+-rw-rw-rw-   0        0        0     1489 2023-01-11 15:46:32.000000 watex-0.2.4/examples/utils/plot_confusion_matrices.py
+-rw-rw-rw-   0        0        0     1124 2023-01-09 07:43:29.000000 watex-0.2.4/examples/utils/plot_confusion_matrix_sweet.py
+-rw-rw-rw-   0        0        0      526 2023-01-11 15:46:56.000000 watex-0.2.4/examples/utils/plot_elbow.py
+-rw-rw-rw-   0        0        0     1758 2023-01-25 03:02:32.000000 watex-0.2.4/examples/utils/plot_erp.py
+-rw-rw-rw-   0        0        0      655 2023-01-11 15:48:44.000000 watex-0.2.4/examples/utils/plot_errors_vs_epochs.py
+-rw-rw-rw-   0        0        0      631 2023-01-11 15:49:01.000000 watex-0.2.4/examples/utils/plot_ex_heatmap.py
+-rw-rw-rw-   0        0        0      717 2023-01-11 15:50:15.000000 watex-0.2.4/examples/utils/plot_ex_matrix.py
+-rw-rw-rw-   0        0        0     1094 2023-01-11 15:50:34.000000 watex-0.2.4/examples/utils/plot_learning_curves.py
+-rw-rw-rw-   0        0        0     1787 2023-01-11 15:51:32.000000 watex-0.2.4/examples/utils/plot_log.py
+-rw-rw-rw-   0        0        0     1053 2023-01-09 07:44:13.000000 watex-0.2.4/examples/utils/plot_model_confusion_matrix.py
+-rw-rw-rw-   0        0        0      751 2023-01-11 15:53:36.000000 watex-0.2.4/examples/utils/plot_naive_dendrogram.py
+-rw-rw-rw-   0        0        0      716 2023-01-11 15:53:51.000000 watex-0.2.4/examples/utils/plot_naive_silhouette.py
+-rw-rw-rw-   0        0        0      678 2023-01-11 15:54:53.000000 watex-0.2.4/examples/utils/plot_ohmic_area.py
+-rw-rw-rw-   0        0        0      814 2023-01-08 08:52:36.000000 watex-0.2.4/examples/utils/plot_pca_components.py
+-rw-rw-rw-   0        0        0      611 2023-01-11 15:55:25.000000 watex-0.2.4/examples/utils/plot_regularization_path.py
+-rw-rw-rw-   0        0        0      623 2023-01-11 15:55:45.000000 watex-0.2.4/examples/utils/plot_rf_feature_importances.py
+-rw-rw-rw-   0        0        0      966 2023-01-24 10:29:45.000000 watex-0.2.4/examples/utils/plot_savitzky_golay1d.py
+-rw-rw-rw-   0        0        0     1132 2023-01-08 08:52:36.000000 watex-0.2.4/examples/utils/plot_sbs_feature_selection.py
+-rw-rw-rw-   0        0        0     1793 2023-01-25 04:57:49.000000 watex-0.2.4/examples/utils/plot_sfi.py
+-rw-rw-rw-   0        0        0     3121 2023-03-04 11:47:12.000000 watex-0.2.4/examples/utils/plot_skew.py
+-rw-rw-rw-   0        0        0     2236 2023-03-19 08:17:21.000000 watex-0.2.4/examples/utils/plot_strike.py
+-rw-rw-rw-   0        0        0      693 2023-05-14 06:02:07.000000 watex-0.2.4/examples/utils/plot_voronoi.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.956972 watex-0.2.4/examples/view/
+-rw-rw-rw-   0        0        0      113 2023-01-18 16:54:11.000000 watex-0.2.4/examples/view/README.txt
+-rw-rw-rw-   0        0        0      915 2023-01-24 02:59:52.000000 watex-0.2.4/examples/view/plot_2d_filtered_tensors.py
+-rw-rw-rw-   0        0        0      933 2023-01-11 15:58:16.000000 watex-0.2.4/examples/view/plot_base_distributions.py
+-rw-rw-rw-   0        0        0     1101 2023-01-16 18:53:31.000000 watex-0.2.4/examples/view/plot_biplot.py
+-rw-rw-rw-   0        0        0      553 2023-01-11 15:59:22.000000 watex-0.2.4/examples/view/plot_box.py
+-rw-rw-rw-   0        0        0     1678 2023-01-11 16:00:02.000000 watex-0.2.4/examples/view/plot_confusion_matrix_metric.py
+-rw-rw-rw-   0        0        0      852 2023-01-08 08:52:36.000000 watex-0.2.4/examples/view/plot_correlating_features.py
+-rw-rw-rw-   0        0        0      449 2023-01-11 16:01:24.000000 watex-0.2.4/examples/view/plot_correlation_missing_data.py
+-rw-rw-rw-   0        0        0      599 2023-01-11 16:00:47.000000 watex-0.2.4/examples/view/plot_cut_comparison.py
+-rw-rw-rw-   0        0        0      453 2023-01-11 16:01:48.000000 watex-0.2.4/examples/view/plot_dendro_missing_data.py
+-rw-rw-rw-   0        0        0      921 2023-01-16 17:55:57.000000 watex-0.2.4/examples/view/plot_dendrogram.py
+-rw-rw-rw-   0        0        0      854 2023-01-16 17:19:14.000000 watex-0.2.4/examples/view/plot_dendroheat.py
+-rw-rw-rw-   0        0        0      920 2023-01-11 16:05:35.000000 watex-0.2.4/examples/view/plot_discussing_features.py
+-rw-rw-rw-   0        0        0      697 2023-01-11 16:06:18.000000 watex-0.2.4/examples/view/plot_grid.py
+-rw-rw-rw-   0        0        0      676 2023-01-11 16:06:48.000000 watex-0.2.4/examples/view/plot_hist.py
+-rw-rw-rw-   0        0        0      888 2023-01-08 08:52:36.000000 watex-0.2.4/examples/view/plot_jointing_features.py
+-rw-rw-rw-   0        0        0      644 2023-01-11 16:07:06.000000 watex-0.2.4/examples/view/plot_learning_inspections.py
+-rw-rw-rw-   0        0        0     1365 2023-01-11 16:08:38.000000 watex-0.2.4/examples/view/plot_matshow.py
+-rw-rw-rw-   0        0        0     2370 2023-01-11 16:10:01.000000 watex-0.2.4/examples/view/plot_model.py
+-rw-rw-rw-   0        0        0      588 2023-01-11 16:10:11.000000 watex-0.2.4/examples/view/plot_model_inspection.py
+-rw-rw-rw-   0        0        0     1964 2023-01-18 15:28:17.000000 watex-0.2.4/examples/view/plot_model_scores.py
+-rw-rw-rw-   0        0        0      725 2023-01-09 07:52:42.000000 watex-0.2.4/examples/view/plot_multiple_feature_distributions.py
+-rw-rw-rw-   0        0        0     1226 2023-01-09 07:52:51.000000 watex-0.2.4/examples/view/plot_num_features.py
+-rw-rw-rw-   0        0        0     1241 2023-01-11 16:11:17.000000 watex-0.2.4/examples/view/plot_pairwise_corr.py
+-rw-rw-rw-   0        0        0      524 2023-01-11 16:11:59.000000 watex-0.2.4/examples/view/plot_pararell_corrdinates.py
+-rw-rw-rw-   0        0        0     1372 2023-01-11 16:12:35.000000 watex-0.2.4/examples/view/plot_pca.py
+-rw-rw-rw-   0        0        0     5274 2023-03-04 05:56:10.000000 watex-0.2.4/examples/view/plot_phase_sensistive_skew.py
+-rw-rw-rw-   0        0        0      818 2023-01-20 17:26:34.000000 watex-0.2.4/examples/view/plot_phase_tensor_2d.py
+-rw-rw-rw-   0        0        0      817 2023-01-11 16:12:58.000000 watex-0.2.4/examples/view/plot_pr.py
+-rw-rw-rw-   0        0        0     1893 2023-01-16 18:57:53.000000 watex-0.2.4/examples/view/plot_projection.py
+-rw-rw-rw-   0        0        0      883 2023-01-11 16:18:27.000000 watex-0.2.4/examples/view/plot_radviz.py
+-rw-rw-rw-   0        0        0      929 2023-01-11 16:19:02.000000 watex-0.2.4/examples/view/plot_reg_scoring.py
+-rw-rw-rw-   0        0        0      869 2023-01-11 16:19:28.000000 watex-0.2.4/examples/view/plot_res_tensor_2d.py
+-rw-rw-rw-   0        0        0     1939 2023-04-20 03:25:59.000000 watex-0.2.4/examples/view/plot_rhoa.py
+-rw-rw-rw-   0        0        0     1757 2023-01-11 16:19:47.000000 watex-0.2.4/examples/view/plot_roc.py
+-rw-rw-rw-   0        0        0      794 2023-01-11 16:20:19.000000 watex-0.2.4/examples/view/plot_scatter.py
+-rw-rw-rw-   0        0        0     1523 2023-01-11 16:20:37.000000 watex-0.2.4/examples/view/plot_scattering_features.py
+-rw-rw-rw-   0        0        0      543 2023-01-08 08:52:36.000000 watex-0.2.4/examples/view/plot_silhouette.py
+-rw-rw-rw-   0        0        0      759 2023-01-09 07:56:02.000000 watex-0.2.4/examples/view/plot_single_site_signal_recovery.py
+-rw-rw-rw-   0        0        0      834 2023-01-11 16:21:15.000000 watex-0.2.4/examples/view/plot_target_inspection.py
+-rw-rw-rw-   0        0        0     1615 2023-05-25 04:59:14.000000 watex-0.2.4/pyproject.toml
+-rw-rw-rw-   0        0        0      901 2023-05-26 14:51:01.202276 watex-0.2.4/setup.cfg
+-rw-rw-rw-   0        0        0     4646 2023-05-25 04:59:14.000000 watex-0.2.4/setup.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:00.973868 watex-0.2.4/watex/
+-rw-rw-rw-   0        0        0     8550 2023-05-25 04:59:14.000000 watex-0.2.4/watex/__init__.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.011078 watex-0.2.4/watex/_build/
+-rw-rw-rw-   0        0        0       27 2023-03-11 03:28:02.000000 watex-0.2.4/watex/_build/__init__.py
+-rw-rw-rw-   0        0        0       30 2023-01-08 08:20:47.000000 watex-0.2.4/watex/_build/_check_build.pyx
+-rw-rw-rw-   0        0        0      333 2023-01-08 08:20:47.000000 watex-0.2.4/watex/_distributor_init.py
+-rw-rw-rw-   0        0        0    32062 2023-05-25 04:59:14.000000 watex-0.2.4/watex/_docstring.py
+-rw-rw-rw-   0        0        0     3852 2023-03-11 03:28:02.000000 watex-0.2.4/watex/_isotonic.pyx
+-rw-rw-rw-   0        0        0    17770 2023-04-14 23:54:09.000000 watex-0.2.4/watex/_typing.py
+-rw-rw-rw-   0        0        0      218 2023-05-26 14:50:59.000000 watex-0.2.4/watex/_version.py
+-rw-rw-rw-   0        0        0     8798 2023-03-12 01:49:05.000000 watex-0.2.4/watex/_watexlog.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.014079 watex-0.2.4/watex/analysis/
+-rw-rw-rw-   0        0        0     1242 2023-02-04 08:11:48.000000 watex-0.2.4/watex/analysis/__init__.py
+-rw-rw-rw-   0        0        0    23341 2023-01-18 16:30:53.000000 watex-0.2.4/watex/analysis/decomposition.py
+-rw-rw-rw-   0        0        0    25575 2023-02-05 12:23:26.000000 watex-0.2.4/watex/analysis/dimensionality.py
+-rw-rw-rw-   0        0        0     9305 2023-02-04 08:20:23.000000 watex-0.2.4/watex/analysis/factor.py
+-rw-rw-rw-   0        0        0    85025 2023-03-12 01:49:14.000000 watex-0.2.4/watex/base.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.017261 watex-0.2.4/watex/cases/
+-rw-rw-rw-   0        0        0     1078 2023-01-12 16:27:24.000000 watex-0.2.4/watex/cases/__init__.py
+-rw-rw-rw-   0        0        0    38684 2023-03-12 01:39:59.000000 watex-0.2.4/watex/cases/features.py
+-rw-rw-rw-   0        0        0    31952 2023-03-12 01:40:49.000000 watex-0.2.4/watex/cases/modeling.py
+-rw-rw-rw-   0        0        0    39022 2023-03-12 01:40:40.000000 watex-0.2.4/watex/cases/prepare.py
+-rw-rw-rw-   0        0        0    49220 2023-03-12 01:41:33.000000 watex-0.2.4/watex/cases/processing.py
+-rw-rw-rw-   0        0        0     1353 2023-03-15 12:48:58.000000 watex-0.2.4/watex/cli.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.023248 watex-0.2.4/watex/datasets/
+-rw-rw-rw-   0        0        0      868 2023-05-05 12:57:48.000000 watex-0.2.4/watex/datasets/__init__.py
+-rw-rw-rw-   0        0        0     7785 2023-03-21 13:31:09.000000 watex-0.2.4/watex/datasets/_config.py
+-rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/_hongliu.py
+-rw-rw-rw-   0        0        0     5677 2023-03-21 13:58:43.000000 watex-0.2.4/watex/datasets/_p.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.053058 watex-0.2.4/watex/datasets/data/
+-rw-rw-rw-   0        0        0       27 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/__init__.py
+-rw-rw-rw-   0        0        0   328758 2023-03-20 17:59:44.000000 watex-0.2.4/watex/datasets/data/b.pkl
+-rw-rw-rw-   0        0        0    34993 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/bagoue.csv
+-rw-rw-rw-   0        0        0    35250 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/boston_house_prices.csv
+-rw-rw-rw-   0        0        0      638 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/boundiali_ves.csv
+-rw-rw-rw-   0        0        0     1158 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/dcerp_gbalo.csv
+-rw-rw-rw-   0        0        0      699 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/dcves_gbalo.csv
+-rw-rw-rw-   0        0        0  2216584 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/e.h5
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.056564 watex-0.2.4/watex/datasets/data/edis/
+-rw-rw-rw-   0        0        0        4 2023-02-24 10:23:34.000000 watex-0.2.4/watex/datasets/data/edis/__init__.py
+-rw-rw-rw-   0        0        0   170380 2023-02-24 10:23:34.000000 watex-0.2.4/watex/datasets/data/edis/raw.E.zip
+-rw-rw-rw-   0        0        0   184986 2023-02-24 10:23:34.000000 watex-0.2.4/watex/datasets/data/edis/s.E.zip
+-rw-rw-rw-   0        0        0 11940145 2023-05-05 12:57:48.000000 watex-0.2.4/watex/datasets/data/h.h5
+-rw-rw-rw-   0        0        0     2885 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/iris.csv
+-rw-rw-rw-   0        0        0   731414 2023-05-05 12:57:48.000000 watex-0.2.4/watex/datasets/data/mxs.joblib
+-rw-rw-rw-   0        0        0      603 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/semien_ves.csv
+-rw-rw-rw-   0        0        0     2230 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/tankesse.csv
+-rw-rw-rw-   0        0        0    11336 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/data/wine_data.csv
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.064666 watex-0.2.4/watex/datasets/descr/
+-rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/__init__.py
+-rw-rw-rw-   0        0        0     2827 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/bagoue.rst
+-rw-rw-rw-   0        0        0     2397 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/boston_house_prices.rst
+-rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/boundiali_ves.rst
+-rw-rw-rw-   0        0        0     1822 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/california_housing.rst
+-rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/gbalo_erp.rst
+-rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/gbalo_ves.rst
+-rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/huayuan_edis.rst
+-rw-rw-rw-   0        0        0     2844 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/iris.rst
+-rw-rw-rw-   0        0        0     3544 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/descr/wine_data.rst
+-rw-rw-rw-   0        0        0    43799 2023-05-26 10:01:44.000000 watex-0.2.4/watex/datasets/dload.py
+-rw-rw-rw-   0        0        0    17331 2023-05-05 12:57:48.000000 watex-0.2.4/watex/datasets/gdata.py
+-rw-rw-rw-   0        0        0    13639 2023-03-24 15:43:33.000000 watex-0.2.4/watex/datasets/io.py
+-rw-rw-rw-   0        0        0    34896 2023-03-12 01:42:57.000000 watex-0.2.4/watex/datasets/rload.py
+-rw-rw-rw-   0        0        0     7098 2023-05-24 12:02:39.000000 watex-0.2.4/watex/datasets/sets.py
+-rw-rw-rw-   0        0        0      822 2023-01-08 08:20:47.000000 watex-0.2.4/watex/datasets/setup.py
+-rw-rw-rw-   0        0        0   101706 2023-03-12 01:49:23.000000 watex-0.2.4/watex/decorators.py
+-rw-rw-rw-   0        0        0   115869 2023-03-23 14:01:07.000000 watex-0.2.4/watex/edi.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.075146 watex-0.2.4/watex/etc/
+-rw-rw-rw-   0        0        0     5711 2023-01-08 08:20:47.000000 watex-0.2.4/watex/etc/AGSO.csv
+-rw-rw-rw-   0        0        0      351 2023-01-08 08:20:47.000000 watex-0.2.4/watex/etc/AGSO_STCODES.csv
+-rw-rw-rw-   0        0        0    14650 2023-03-20 14:32:57.000000 watex-0.2.4/watex/etc/__XTyT.pkl
+-rw-rw-rw-   0        0        0    37763 2023-03-20 16:12:55.000000 watex-0.2.4/watex/etc/__Xy.pkl
+-rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.4/watex/etc/__init__.py
+-rw-rw-rw-   0        0        0   811233 2023-01-08 08:20:47.000000 watex-0.2.4/watex/etc/__memory.pkl
+-rw-rw-rw-   0        0        0    28672 2023-01-08 08:20:47.000000 watex-0.2.4/watex/etc/memory.sq3
+-rw-rw-rw-   0        0        0 52244397 2023-01-08 08:20:47.000000 watex-0.2.4/watex/etc/p.models.pkl
+-rw-rw-rw-   0        0        0     9383 2023-03-24 14:28:17.000000 watex-0.2.4/watex/exceptions.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.148962 watex-0.2.4/watex/exlib/
+-rw-rw-rw-   0        0        0     4022 2023-03-27 14:03:16.000000 watex-0.2.4/watex/exlib/__init__.py
+-rw-rw-rw-   0        0        0     2580 2023-03-15 12:48:58.000000 watex-0.2.4/watex/exlib/gbm.py
+-rw-rw-rw-   0        0        0     7156 2023-03-12 01:43:33.000000 watex-0.2.4/watex/exlib/sklearn.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.152423 watex-0.2.4/watex/externals/
+-rw-rw-rw-   0        0        0      313 2023-01-18 17:47:22.000000 watex-0.2.4/watex/externals/__init__.py
+-rw-rw-rw-   0        0        0     4835 2023-01-08 08:20:47.000000 watex-0.2.4/watex/externals/_numpy_compiler_patch.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.154430 watex-0.2.4/watex/externals/_pkgs/
+-rw-rw-rw-   0        0        0       29 2023-01-08 08:20:47.000000 watex-0.2.4/watex/externals/_pkgs/__init__.py
+-rw-rw-rw-   0        0        0     3035 2023-01-08 08:20:47.000000 watex-0.2.4/watex/externals/_pkgs/_structures.py
+-rw-rw-rw-   0        0        0    16762 2023-01-08 08:20:47.000000 watex-0.2.4/watex/externals/_pkgs/version.py
+-rw-rw-rw-   0        0        0      273 2023-01-08 08:20:47.000000 watex-0.2.4/watex/externals/readme.md
+-rw-rw-rw-   0        0        0    57854 2023-03-23 14:01:07.000000 watex-0.2.4/watex/externals/z.py
+-rw-rw-rw-   0        0        0    24161 2023-03-12 01:43:53.000000 watex-0.2.4/watex/externals/zutils.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.159150 watex-0.2.4/watex/geology/
+-rw-rw-rw-   0        0        0     1039 2023-05-25 04:59:14.000000 watex-0.2.4/watex/geology/__init__.py
+-rw-rw-rw-   0        0        0    12616 2023-05-24 12:02:39.000000 watex-0.2.4/watex/geology/core.py
+-rw-rw-rw-   0        0        0    56354 2023-03-12 01:44:15.000000 watex-0.2.4/watex/geology/database.py
+-rw-rw-rw-   0        0        0    59717 2023-05-25 04:59:14.000000 watex-0.2.4/watex/geology/drilling.py
+-rw-rw-rw-   0        0        0    14488 2023-05-24 12:02:39.000000 watex-0.2.4/watex/geology/geology.py
+-rw-rw-rw-   0        0        0    65017 2023-05-24 12:02:39.000000 watex-0.2.4/watex/geology/stratigraphic.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.163144 watex-0.2.4/watex/methods/
+-rw-rw-rw-   0        0        0      867 2023-04-15 15:25:13.000000 watex-0.2.4/watex/methods/__init__.py
+-rw-rw-rw-   0        0        0    82817 2023-04-22 06:56:19.000000 watex-0.2.4/watex/methods/electrical.py
+-rw-rw-rw-   0        0        0   136679 2023-05-14 09:33:31.000000 watex-0.2.4/watex/methods/em.py
+-rw-rw-rw-   0        0        0    86661 2023-04-22 06:56:19.000000 watex-0.2.4/watex/methods/erp.py
+-rw-rw-rw-   0        0        0    43855 2023-03-12 01:45:26.000000 watex-0.2.4/watex/methods/hydro.py
+-rw-rw-rw-   0        0        0    28992 2023-05-24 12:02:39.000000 watex-0.2.4/watex/metrics.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.166651 watex-0.2.4/watex/models/
+-rw-rw-rw-   0        0        0     1064 2023-03-24 12:58:06.000000 watex-0.2.4/watex/models/__init__.py
+-rw-rw-rw-   0        0        0     6889 2023-03-15 12:48:58.000000 watex-0.2.4/watex/models/_metapredictors.py
+-rw-rw-rw-   0        0        0    18878 2023-03-15 12:48:58.000000 watex-0.2.4/watex/models/premodels.py
+-rw-rw-rw-   0        0        0    44482 2023-03-28 11:58:09.000000 watex-0.2.4/watex/models/validation.py
+-rw-rw-rw-   0        0        0    73950 2023-05-05 12:57:48.000000 watex-0.2.4/watex/property.py
+-rw-rw-rw-   0        0        0    48351 2023-04-20 07:15:26.000000 watex-0.2.4/watex/site.py
+-rw-rw-rw-   0        0        0    61573 2023-05-26 14:28:41.000000 watex-0.2.4/watex/transformers.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.187434 watex-0.2.4/watex/utils/
+-rw-rw-rw-   0        0        0     5875 2023-05-13 14:10:22.000000 watex-0.2.4/watex/utils/__init__.py
+-rw-rw-rw-   0        0        0     7140 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/_array_api.py
+-rw-rw-rw-   0        0        0     7730 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/_arraytools.py
+-rw-rw-rw-   0        0        0     5936 2023-02-01 06:46:13.000000 watex-0.2.4/watex/utils/_dependency.py
+-rw-rw-rw-   0        0        0      222 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/_openmp_helpers.pxd
+-rw-rw-rw-   0        0        0     2674 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/_openmp_helpers.pyx
+-rw-rw-rw-   0        0        0    16659 2023-01-28 02:10:06.000000 watex-0.2.4/watex/utils/_packaging_version.py
+-rw-rw-rw-   0        0        0     1616 2023-03-28 11:58:09.000000 watex-0.2.4/watex/utils/_set_gdal.py
+-rw-rw-rw-   0        0        0     2583 2023-02-16 08:00:08.000000 watex-0.2.4/watex/utils/_show_versions.py
+-rw-rw-rw-   0        0        0    13908 2023-05-26 13:32:06.000000 watex-0.2.4/watex/utils/box.py
+-rw-rw-rw-   0        0        0    96738 2023-05-26 13:12:04.000000 watex-0.2.4/watex/utils/coreutils.py
+-rw-rw-rw-   0        0        0   580618 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/epsg.npy
+-rw-rw-rw-   0        0        0   225756 2023-05-26 14:02:20.000000 watex-0.2.4/watex/utils/exmath.py
+-rw-rw-rw-   0        0        0   232075 2023-05-26 09:54:41.000000 watex-0.2.4/watex/utils/funcutils.py
+-rw-rw-rw-   0        0        0    54374 2023-05-24 14:24:15.000000 watex-0.2.4/watex/utils/geotools.py
+-rw-rw-rw-   0        0        0    58698 2023-03-28 11:58:09.000000 watex-0.2.4/watex/utils/gistools.py
+-rw-rw-rw-   0        0        0   139485 2023-05-05 12:57:48.000000 watex-0.2.4/watex/utils/hydroutils.py
+-rw-rw-rw-   0        0        0   122844 2023-05-24 12:02:39.000000 watex-0.2.4/watex/utils/mlutils.py
+-rw-rw-rw-   0        0        0   138126 2023-05-26 13:15:46.000000 watex-0.2.4/watex/utils/plotutils.py
+-rw-rw-rw-   0        0        0      974 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/setup.py
+-rw-rw-rw-   0        0        0     3548 2023-01-08 08:20:47.000000 watex-0.2.4/watex/utils/thread.py
+-rw-rw-rw-   0        0        0    86093 2023-05-24 12:02:39.000000 watex-0.2.4/watex/utils/validator.py
+-rw-rw-rw-   0        0        0    16835 2023-01-28 01:30:49.000000 watex-0.2.4/watex/utils/version.py
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.190748 watex-0.2.4/watex/view/
+-rw-rw-rw-   0        0        0     1008 2023-02-24 10:23:34.000000 watex-0.2.4/watex/view/__init__.py
+-rw-rw-rw-   0        0        0   145840 2023-05-14 06:19:47.000000 watex-0.2.4/watex/view/mlplot.py
+-rw-rw-rw-   0        0        0   190822 2023-04-22 06:56:19.000000 watex-0.2.4/watex/view/plot.py
+-rw-rw-rw-   0        0        0     1222 2023-03-11 03:28:02.000000 watex-0.2.4/watex/wlog.yml
+drwxrwxrwx   0        0        0        0 2023-05-26 14:51:01.010078 watex-0.2.4/watex.egg-info/
+-rw-rw-rw-   0        0        0    15816 2023-05-26 14:50:59.000000 watex-0.2.4/watex.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0     9490 2023-05-26 14:51:00.000000 watex-0.2.4/watex.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-05-26 14:50:59.000000 watex-0.2.4/watex.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       83 2023-05-26 14:50:59.000000 watex-0.2.4/watex.egg-info/entry_points.txt
+-rw-rw-rw-   0        0        0      366 2023-05-26 14:50:59.000000 watex-0.2.4/watex.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        6 2023-05-26 14:50:59.000000 watex-0.2.4/watex.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0        2 2023-05-26 14:49:57.000000 watex-0.2.4/watex.egg-info/zip-safe
```

### Comparing `watex-0.2.3/.github/dependabot.yml` & `watex-0.2.4/.github/dependabot.yml`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/.github/workflows/ci.yaml` & `watex-0.2.4/.github/workflows/ci.yaml`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/.github/workflows/codeql.yml` & `watex-0.2.4/.github/workflows/codeql.yml`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/.github/workflows/dependency-review.yml` & `watex-0.2.4/.github/workflows/dependency-review.yml`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/.github/workflows/python-package.yml` & `watex-0.2.4/.github/workflows/python-package.yml`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/.gitignore` & `watex-0.2.4/.gitignore`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/CITATION.cff` & `watex-0.2.4/CITATION.cff`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/LICENSE` & `watex-0.2.4/LICENSE`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/MANIFEST.in` & `watex-0.2.4/MANIFEST.in`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/PKG-INFO` & `watex-0.2.4/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: watex
-Version: 0.2.3
+Version: 0.2.4
 Summary: Machine learning research in water exploration
 Home-page: https://github.com/WEgeophysics/watex
 Download-URL: https://pypi.org/project/watex/#files
 Author: Laurent Kouadio
 Author-email: etanoyau@gmail.com
 Maintainer: Laurent Kouadio
 Maintainer-email: etanoyau@gmail.com
@@ -163,15 +163,15 @@
 ``k`` -aquifer similarity label prediction and the supervising learning for 
 final ``k``-value prediction. For our toy example, we use two boreholes data 
 stored in the software and merge them to compose a unique dataset. In addition, we dropped the 
 ``remark`` observation which is subjective data not useful for ``k`` prediction as:
 
 ```python
 import watex as wx
-h= wx.fetch_data("hlogs", key='*', drop_observations =True ) # returns log data object.
+h= wx.fetch_data("hlogs", key='h502 h2601', drop_observations =True ) # returns log data object.
 h.feature_names
 Out[3]: Index(['hole_id', 'depth_top', 'depth_bottom', 'strata_name', 'rock_name',
            'layer_thickness', 'resistivity', 'gamma_gamma', 'natural_gamma', 'sp',
            'short_distance_gamma', 'well_diameter'],
           dtype='object')
 hdata = h.frame 
 ```
```

### Comparing `watex-0.2.3/README.md` & `watex-0.2.4/README.md`

 * *Files 0% similar despite different names*

```diff
@@ -128,15 +128,15 @@
 ``k`` -aquifer similarity label prediction and the supervising learning for 
 final ``k``-value prediction. For our toy example, we use two boreholes data 
 stored in the software and merge them to compose a unique dataset. In addition, we dropped the 
 ``remark`` observation which is subjective data not useful for ``k`` prediction as:
 
 ```python
 import watex as wx
-h= wx.fetch_data("hlogs", key='*', drop_observations =True ) # returns log data object.
+h= wx.fetch_data("hlogs", key='h502 h2601', drop_observations =True ) # returns log data object.
 h.feature_names
 Out[3]: Index(['hole_id', 'depth_top', 'depth_bottom', 'strata_name', 'rock_name',
            'layer_thickness', 'resistivity', 'gamma_gamma', 'natural_gamma', 'sp',
            'short_distance_gamma', 'well_diameter'],
           dtype='object')
 hdata = h.frame 
 ```
```

### Comparing `watex-0.2.3/docs/Makefile` & `watex-0.2.4/docs/Makefile`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/copybutton.js` & `watex-0.2.4/docs/_static/copybutton.js`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/css/bootstrap.min.css` & `watex-0.2.4/docs/_static/css/bootstrap.min.css`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/css/custom.css` & `watex-0.2.4/docs/_static/css/custom.css`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/favicon.ico` & `watex-0.2.4/docs/_static/favicon.ico`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/favicon0.ico` & `watex-0.2.4/docs/_static/favicon0.ico`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/favicon_old.ico` & `watex-0.2.4/docs/_static/favicon_old.ico`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/index_api.svg` & `watex-0.2.4/docs/_static/index_api.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/index_contribute.svg` & `watex-0.2.4/docs/_static/index_contribute.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/index_getting_started.svg` & `watex-0.2.4/docs/_static/index_getting_started.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/index_user_guide.svg` & `watex-0.2.4/docs/_static/index_user_guide.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/js/vendor/bootstrap.min.js` & `watex-0.2.4/docs/_static/js/vendor/bootstrap.min.js`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/js/vendor/jquery-3.6.3.slim.min.js` & `watex-0.2.4/docs/_static/js/vendor/jquery-3.6.3.slim.min.js`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/logo.svg` & `watex-0.2.4/docs/_static/logo.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/logo_no_name.svg` & `watex-0.2.4/docs/_static/logo_no_name.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/logo_small.svg` & `watex-0.2.4/docs/_static/logo_small.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/logo_wide.svg` & `watex-0.2.4/docs/_static/logo_wide.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/logo_wide_rev.svg` & `watex-0.2.4/docs/_static/logo_wide_rev.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/logo_wide_rev0.svg` & `watex-0.2.4/docs/_static/logo_wide_rev0.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/switcher.json` & `watex-0.2.4/docs/_static/switcher.json`

 * *Files 2% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.8333333333333334%*

 * *Differences: {'0': "{'version': 'v0.2.5'}",*

 * * '2': "{'name': '0.2.3', 'version': 'v0.2.3'}",*

 * * 'insert': "[(1, OrderedDict([('name', '0.2.4(stable)'), ('version', 'stable'), ('url', "*

 * *           "'https://watex.readthedocs.io/en/0.2.4/')]))]"}*

```diff
@@ -1,19 +1,24 @@
 [
     {
         "name": "dev",
         "url": "https://watex.readthedocs.io/en/latest/",
-        "version": "v0.2.4"
+        "version": "v0.2.5"
     },
     {
-        "name": "0.2.3 (stable)",
-        "url": "https://watex.readthedocs.io/en/0.2.3/",
+        "name": "0.2.4(stable)",
+        "url": "https://watex.readthedocs.io/en/0.2.4/",
         "version": "stable"
     },
     {
+        "name": "0.2.3",
+        "url": "https://watex.readthedocs.io/en/0.2.3/",
+        "version": "v0.2.3"
+    },
+    {
         "name": "0.2.2",
         "url": "https://watex.readthedocs.io/en/0.2.2/",
         "version": "v0.2.2"
     },
     {
         "name": "0.2.1",
         "url": "https://watex.readthedocs.io/en/0.2.1/",
```

### Comparing `watex-0.2.3/docs/_static/to_favicon.svg` & `watex-0.2.4/docs/_static/to_favicon.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/watex_thumb_image.svg` & `watex-0.2.4/docs/_static/watex_thumb_image.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_static/watex_workflow.svg` & `watex-0.2.4/docs/_static/watex_workflow.svg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/_templates/javascript.html` & `watex-0.2.4/docs/_templates/javascript.html`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/analysis.rst` & `watex-0.2.4/docs/analysis.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/api_references.rst` & `watex-0.2.4/docs/api_references.rst`

 * *Files 2% similar despite different names*

```diff
@@ -276,23 +276,26 @@
 
 .. currentmodule:: watex
 
 .. autosummary::
    :toctree: generated/
    :template: class.rst
 
-   geology.core.Base
+   geology.core.GeoBase
    geology.database.DBSetting
    geology.database.GeoDataBase
    geology.drilling.Borehole
    geology.drilling.Drill
+   geology.drilling.DSBorehole
+   geology.drilling.DSBoreholes
    geology.geology.Geology
    geology.geology.Structural
    geology.geology.Structures
    geology.stratigraphic.GeoStrataModel 
+   
 
 Functions
 ~~~~~~~~~~~~
 
 .. autosummary::
    :toctree: generated/
    :template: function.rst
@@ -826,15 +829,15 @@
 	utils.funcutils.make_ids
 	utils.funcutils.fit_by_ll
 	utils.funcutils.fillNaN
 	utils.funcutils.find_close_position
 	utils.funcutils.make_arr_consistent
 	utils.funcutils.ismissing
 	utils.funcutils.reshape
-	utils.funcutils.save_job
+	utils.funcutils.savejob
 	utils.funcutils.load_serialized_data
 	utils.funcutils.serialize_data
 	utils.funcutils.sanitize_unicode_string
 	utils.funcutils.cpath
 	utils.funcutils.smart_format
 	utils.funcutils.read_from_excelsheets
 	utils.funcutils.accept_types
```

### Comparing `watex-0.2.3/docs/base.rst` & `watex-0.2.4/docs/base.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/cases.rst` & `watex-0.2.4/docs/cases.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/citing.rst` & `watex-0.2.4/docs/citing.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/community/CONTRIBUTING.md` & `watex-0.2.4/docs/community/CONTRIBUTING.md`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/conf.py` & `watex-0.2.4/docs/conf.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/datasets.rst` & `watex-0.2.4/docs/datasets.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/development.rst` & `watex-0.2.4/docs/development.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/example_thumbs/watex_workflow.gif` & `watex-0.2.4/docs/example_thumbs/watex_workflow.gif`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/glossary.rst` & `watex-0.2.4/docs/glossary.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/history/five_min_understanding.rst` & `watex-0.2.4/docs/history/five_min_understanding.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/history/project_goals.rst` & `watex-0.2.4/docs/history/project_goals.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/history/project_story.rst` & `watex-0.2.4/docs/history/project_story.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/includes/big_toc_css.rst` & `watex-0.2.4/docs/includes/big_toc_css.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/includes/bigger_toc_css.rst` & `watex-0.2.4/docs/includes/bigger_toc_css.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/index.rst` & `watex-0.2.4/docs/index.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/installation.rst` & `watex-0.2.4/docs/installation.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/make.bat` & `watex-0.2.4/docs/make.bat`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/methods.rst` & `watex-0.2.4/docs/methods.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/requirements.txt` & `watex-0.2.4/docs/requirements.txt`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/source/index.html` & `watex-0.2.4/docs/source/index.html`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/sphinxext/add_toctree_functions.py` & `watex-0.2.4/docs/sphinxext/add_toctree_functions.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/sphinxext/doi_role.py` & `watex-0.2.4/docs/sphinxext/doi_role.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/sphinxext/sphinx_issues.py` & `watex-0.2.4/docs/sphinxext/sphinx_issues.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/structure.rst` & `watex-0.2.4/docs/structure.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/tune_toc.rst` & `watex-0.2.4/docs/tune_toc.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/utils.rst` & `watex-0.2.4/docs/utils.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/view.rst` & `watex-0.2.4/docs/view.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/index.rst` & `watex-0.2.4/docs/whatsnew/index.rst`

 * *Files 21% similar despite different names*

```diff
@@ -10,14 +10,15 @@
 
 Version 0.2
 -------------
 
 .. toctree::
    :maxdepth: 2
    
+   v0.2.4
    v0.2.3
    v0.2.2
    v0.2.1
    v0.2.0
 
 
 Version 0.1
```

### Comparing `watex-0.2.3/docs/whatsnew/v0.1.0.rst` & `watex-0.2.4/docs/whatsnew/v0.1.0.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.1.1.rst` & `watex-0.2.4/docs/whatsnew/v0.1.1.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.1.2.rst` & `watex-0.2.4/docs/whatsnew/v0.1.2.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.1.3.rst` & `watex-0.2.4/docs/whatsnew/v0.1.3.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.1.4.rst` & `watex-0.2.4/docs/whatsnew/v0.1.4.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.1.5.rst` & `watex-0.2.4/docs/whatsnew/v0.1.5.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.1.6-alpha.rst` & `watex-0.2.4/docs/whatsnew/v0.1.6-alpha.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.1.6.rst` & `watex-0.2.4/docs/whatsnew/v0.1.6.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.1.7.rst` & `watex-0.2.4/docs/whatsnew/v0.1.7.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.1.8.rst` & `watex-0.2.4/docs/whatsnew/v0.1.8.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.1.9.rst` & `watex-0.2.4/docs/whatsnew/v0.1.9.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.2.0.rst` & `watex-0.2.4/docs/whatsnew/v0.2.0.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.2.1.rst` & `watex-0.2.4/docs/whatsnew/v0.2.1.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.2.2.rst` & `watex-0.2.4/docs/whatsnew/v0.2.2.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/docs/whatsnew/v0.2.3.rst` & `watex-0.2.4/docs/whatsnew/v0.2.3.rst`

 * *Files 4% similar despite different names*

```diff
@@ -24,16 +24,14 @@
 
 - |Feature| :func:`watex.utils.plotutils.plot_voronoi` plots the Voronoi diagram of the k-Means clusters overlaid with 
   the data.
   
 - |Feature| new function :func:`watex.utils.plot_roc_curves` for visualizing the Receiving Operating Characterisctic (ROC) curves either 
   into a single plot ( used by default) or individual plot for each model by setting the parameter ``all=True``. 
   
-- |Enhancement| Supplement boreholes data are added to :func:`watex.datasets.load_hlogs`. They include boreholes ``'h805' ,'h1102' ,'h1405', 'h2602','h803',
-  'h1104', 'h604', 'h2003'`` and  ``'h1602'``.
```

### Comparing `watex-0.2.3/examples/analysis/plot_decision_regions.py` & `watex-0.2.4/examples/analysis/plot_decision_regions.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/analysis/plot_explained_variance_ratio.py` & `watex-0.2.4/examples/analysis/plot_explained_variance_ratio.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/analysis/plot_linear_discriminant_analysis.py` & `watex-0.2.4/examples/analysis/plot_linear_discriminant_analysis.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/analysis/plot_pca_vs_factor_with_scedatic_noises.py` & `watex-0.2.4/examples/analysis/plot_pca_vs_factor_with_scedatic_noises.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/applications/plot_auto_detect_drilling_location.py` & `watex-0.2.4/examples/applications/plot_auto_detect_drilling_location.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/applications/plot_data_exploratory_quick_view.py` & `watex-0.2.4/examples/applications/plot_data_exploratory_quick_view.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/applications/plot_dc_em_parameters_computings.py` & `watex-0.2.4/examples/applications/plot_dc_em_parameters_computings.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/applications/plot_flow_rate_prediction.py` & `watex-0.2.4/examples/applications/plot_flow_rate_prediction.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/applications/plot_nsamt_tensor_recovery.py` & `watex-0.2.4/examples/applications/plot_nsamt_tensor_recovery.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/applications/plot_tensor_restoring.py` & `watex-0.2.4/examples/applications/plot_tensor_restoring.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/applications/plot_ymxs_label_for_k_prediction.py` & `watex-0.2.4/examples/applications/plot_ymxs_label_for_k_prediction.py`

 * *Files 2% similar despite different names*

```diff
@@ -24,16 +24,16 @@
 # ===================
 # Make a unique dataset from two boreholes data collected in Hongliu 
 # coal mine :h502 and h2601 and reduce down dimensions if necessary
 
 # * load `load_hlogs` to get explicitly the features names and target names 
 box = load_hlogs () 
 # combine our test data 
-data  = load_hlogs().frame + load_hlogs(key= 'h2601').frame  
- 
+# data  = load_hlogs().frame + load_hlogs(key= 'h2601').frame  
+data = load_hlogs (key ='*').frame 
 X0, y0 = data [box.feature_names] , data [box.target_names ] 
 # make copies for safety 
 X, y = X0.copy() , y0.copy() 
 # let's visualize the features names and target names 
 print("feature_names:\n" , box.feature_names ) 
 print("target names:\n", box.target_names ) 
 
@@ -57,18 +57,20 @@
 # Note that for PCA analysis, we can remove the only categorial features 
 # "strata_name" and scaled the remaining features as follows: 
 
 from watex.utils import to_numeric_dtypes  
 from watex.utils import naive_scaler 
 
 # pop_cat_features auto-drop the only categorial features
-Xpca = to_numeric_dtypes (data_imputed , pop_cat_features= True , verbose =True ) 
+Xpca = to_numeric_dtypes (data_imputed , pop_cat_features= True,
+                          reset_index=True, drop_index =True,
+                          verbose =True) 
 #  Scale the data  by default 
 Xpca_scaled = naive_scaler( Xpca )  
-
+Xpca_scaled_columns = list( Xpca_scaled.columns )
 # * Call the normal PCA and plot all components set to None
 
 from watex.analysis import nPCA 
 # %%
 # * Plot explained variance ratio
 pca = nPCA (Xpca_scaled , return_X= False, view = True ) # return PCA object rather than the reduced X  
 
@@ -138,17 +140,20 @@
 # * Plot the features importance 
 # We encode the strata_name and add it to the scale value and plot_the feature  importance 
 
 from watex.exlib.sklearn import RandomForestClassifier 
 from watex.utils import plot_rf_feature_importances 
 
 # add the strata_name to the remaining features 
-strata_column =  pd.Series ( X ['strata_name'].astype ('category').cat.codes , name ='strata_name' )  
-X_for_fi = pd.concat( [ strata_column , Xpca_scaled ], axis =1 ) 
-# plot importance with the predicted label ykm  
+strata_column =  pd.Series ( X ['strata_name'].astype ('category').cat.codes , name ='strata_name' ) 
+strata_column.index = range (len(strata_column))  # reindexing
+
+X_for_fi = pd.concat( [ strata_column , Xpca_scaled ], axis =1, ignore_index=True ) 
+# # plot importance with the predicted label ykm  
+X_for_fi=pd.DataFrame ( X_for_fi.values, columns= ['strata_name'] + Xpca_scaled_columns)
 plot_rf_feature_importances (RandomForestClassifier(), X_for_fi , y =ykm ) 
 
 # %%
 # plot elbow to confirm or infirm the 05 clustering of  aquifers from geological infos
 from watex.utils import plot_elbow 
 plot_elbow(pca.X, n_clusters=11)
```

### Comparing `watex-0.2.3/examples/base/plot_ada_gd.py` & `watex-0.2.4/examples/base/plot_ada_gd.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/base/plot_ada_stochastic_gd.py` & `watex-0.2.4/examples/base/plot_ada_stochastic_gd.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/base/plot_missing.py` & `watex-0.2.4/examples/base/plot_missing.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/base/plot_sbs_feature_selector.py` & `watex-0.2.4/examples/base/plot_sbs_feature_selector.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/methods/plot_2d_tensor_filtered.py` & `watex-0.2.4/examples/methods/plot_2d_tensor_filtered.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/methods/plot_anomaly.py` & `watex-0.2.4/examples/methods/plot_anomaly.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/methods/plot_filtered_tensors.py` & `watex-0.2.4/examples/methods/plot_filtered_tensors.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/methods/plot_logging_predictor_and_target.py` & `watex-0.2.4/examples/methods/plot_logging_predictor_and_target.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/methods/plot_logging_predictor_only.py` & `watex-0.2.4/examples/methods/plot_logging_predictor_only.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/methods/plot_multiple_sites_recovery_signal.py` & `watex-0.2.4/examples/methods/plot_multiple_sites_recovery_signal.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/methods/plot_phase_tensors.py` & `watex-0.2.4/examples/methods/plot_phase_tensors.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/methods/plot_raw_2d_tensor.py` & `watex-0.2.4/examples/methods/plot_raw_2d_tensor.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/methods/plot_ves_fracture_zone.py` & `watex-0.2.4/examples/methods/plot_ves_fracture_zone.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_clusters.py` & `watex-0.2.4/examples/utils/plot_clusters.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_confidence_in_data.py` & `watex-0.2.4/examples/utils/plot_confidence_in_data.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_confusion_matrices.py` & `watex-0.2.4/examples/utils/plot_confusion_matrices.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_confusion_matrix_sweet.py` & `watex-0.2.4/examples/utils/plot_confusion_matrix_sweet.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_elbow.py` & `watex-0.2.4/examples/utils/plot_elbow.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_erp.py` & `watex-0.2.4/examples/utils/plot_erp.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_errors_vs_epochs.py` & `watex-0.2.4/examples/utils/plot_errors_vs_epochs.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_ex_heatmap.py` & `watex-0.2.4/examples/utils/plot_ex_heatmap.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_ex_matrix.py` & `watex-0.2.4/examples/utils/plot_ex_matrix.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_learning_curves.py` & `watex-0.2.4/examples/utils/plot_learning_curves.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_log.py` & `watex-0.2.4/examples/utils/plot_log.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_model_confusion_matrix.py` & `watex-0.2.4/examples/utils/plot_model_confusion_matrix.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_naive_dendrogram.py` & `watex-0.2.4/examples/utils/plot_naive_dendrogram.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_naive_silhouette.py` & `watex-0.2.4/examples/utils/plot_naive_silhouette.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_ohmic_area.py` & `watex-0.2.4/examples/utils/plot_ohmic_area.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_pca_components.py` & `watex-0.2.4/examples/utils/plot_pca_components.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_regularization_path.py` & `watex-0.2.4/examples/utils/plot_regularization_path.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_rf_feature_importances.py` & `watex-0.2.4/examples/utils/plot_rf_feature_importances.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_savitzky_golay1d.py` & `watex-0.2.4/examples/utils/plot_savitzky_golay1d.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_sbs_feature_selection.py` & `watex-0.2.4/examples/utils/plot_sbs_feature_selection.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_sfi.py` & `watex-0.2.4/examples/utils/plot_sfi.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_skew.py` & `watex-0.2.4/examples/utils/plot_skew.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_strike.py` & `watex-0.2.4/examples/utils/plot_strike.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/utils/plot_voronoi.py` & `watex-0.2.4/examples/utils/plot_voronoi.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_2d_filtered_tensors.py` & `watex-0.2.4/examples/view/plot_2d_filtered_tensors.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_base_distributions.py` & `watex-0.2.4/examples/view/plot_base_distributions.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_biplot.py` & `watex-0.2.4/examples/view/plot_biplot.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_box.py` & `watex-0.2.4/examples/view/plot_box.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_confusion_matrix_metric.py` & `watex-0.2.4/examples/view/plot_confusion_matrix_metric.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_correlating_features.py` & `watex-0.2.4/examples/view/plot_correlating_features.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_cut_comparison.py` & `watex-0.2.4/examples/view/plot_cut_comparison.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_dendrogram.py` & `watex-0.2.4/examples/view/plot_dendrogram.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_dendroheat.py` & `watex-0.2.4/examples/view/plot_dendroheat.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_discussing_features.py` & `watex-0.2.4/examples/view/plot_discussing_features.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_grid.py` & `watex-0.2.4/examples/view/plot_grid.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_hist.py` & `watex-0.2.4/examples/view/plot_hist.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_jointing_features.py` & `watex-0.2.4/examples/view/plot_jointing_features.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_learning_inspections.py` & `watex-0.2.4/examples/view/plot_learning_inspections.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_matshow.py` & `watex-0.2.4/examples/view/plot_matshow.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_model.py` & `watex-0.2.4/examples/view/plot_model.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_model_inspection.py` & `watex-0.2.4/examples/view/plot_model_inspection.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_model_scores.py` & `watex-0.2.4/examples/view/plot_model_scores.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_multiple_feature_distributions.py` & `watex-0.2.4/examples/view/plot_multiple_feature_distributions.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_num_features.py` & `watex-0.2.4/examples/view/plot_num_features.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_pairwise_corr.py` & `watex-0.2.4/examples/view/plot_pairwise_corr.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_pararell_corrdinates.py` & `watex-0.2.4/examples/view/plot_pararell_corrdinates.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_pca.py` & `watex-0.2.4/examples/view/plot_pca.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_phase_sensistive_skew.py` & `watex-0.2.4/examples/view/plot_phase_sensistive_skew.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_phase_tensor_2d.py` & `watex-0.2.4/examples/view/plot_phase_tensor_2d.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_pr.py` & `watex-0.2.4/examples/view/plot_pr.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_projection.py` & `watex-0.2.4/examples/view/plot_projection.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_radviz.py` & `watex-0.2.4/examples/view/plot_radviz.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_reg_scoring.py` & `watex-0.2.4/examples/view/plot_reg_scoring.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_res_tensor_2d.py` & `watex-0.2.4/examples/view/plot_res_tensor_2d.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_rhoa.py` & `watex-0.2.4/examples/view/plot_rhoa.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_roc.py` & `watex-0.2.4/examples/view/plot_roc.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_scatter.py` & `watex-0.2.4/examples/view/plot_scatter.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_scattering_features.py` & `watex-0.2.4/examples/view/plot_scattering_features.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_silhouette.py` & `watex-0.2.4/examples/view/plot_silhouette.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_single_site_signal_recovery.py` & `watex-0.2.4/examples/view/plot_single_site_signal_recovery.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/examples/view/plot_target_inspection.py` & `watex-0.2.4/examples/view/plot_target_inspection.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/pyproject.toml` & `watex-0.2.4/pyproject.toml`

 * *Files 5% similar despite different names*

```diff
@@ -9,15 +9,15 @@
 00000080: 2243 7974 686f 6e3e 3d30 2e32 392e 3333  "Cython>=0.29.33
 00000090: 222c 0d0a 2020 2020 2020 2020 5d0d 0a62  ",..        ]..b
 000000a0: 7569 6c64 2d62 6163 6b65 6e64 203d 2022  uild-backend = "
 000000b0: 7365 7475 7074 6f6f 6c73 2e62 7569 6c64  setuptools.build
 000000c0: 5f6d 6574 6122 0d0a 0d0a 5b70 726f 6a65  _meta"....[proje
 000000d0: 6374 5d0d 0a6e 616d 6520 3d20 2277 6174  ct]..name = "wat
 000000e0: 6578 220d 0a76 6572 7369 6f6e 3d22 302e  ex"..version="0.
-000000f0: 322e 3322 0d0a 6479 6e61 6d69 6320 3d20  2.3"..dynamic = 
+000000f0: 322e 3422 0d0a 6479 6e61 6d69 6320 3d20  2.4"..dynamic = 
 00000100: 5b20 226b 6579 776f 7264 7322 5d0d 0a0d  [ "keywords"]...
 00000110: 0a64 6570 656e 6465 6e63 6965 733d 5b0d  .dependencies=[.
 00000120: 0a20 2020 2022 7365 6162 6f72 6e20 3e3d  .    "seaborn >=
 00000130: 302e 3132 2e30 222c 200d 0a20 2020 2022  0.12.0", ..    "
 00000140: 7061 6e64 6173 203e 3d31 2e34 2e30 222c  pandas >=1.4.0",
 00000150: 0d0a 2020 2020 2263 7974 686f 6e20 3e3d  ..    "cython >=
 00000160: 302e 3239 2e33 3322 2c0d 0a20 2020 2022  0.29.33",..    "
```

### Comparing `watex-0.2.3/setup.cfg` & `watex-0.2.4/setup.cfg`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/setup.py` & `watex-0.2.4/setup.py`

 * *Files 0% similar despite different names*

```diff
@@ -14,15 +14,15 @@
 builtins.__WATEX_SETUP__ = True
 
 # We can actually import watex version from 
 # in editable mode :$ python -m pip install -e .
 try: 
     import watex  # noqa
     VERSION = watex.__version__
-except: VERSION ='0.2.1'
+except: VERSION ='0.2.4'
 # set global variables 
 DISTNAME = "watex"
 DESCRIPTION= "Machine learning research in water exploration"
 with open('README.md', 'r', encoding ='utf8') as fm:
     LONG_DESCRIPTION =fm.read()
 MAINTAINER = "Laurent Kouadio"
 MAINTAINER_EMAIL = 'etanoyau@gmail.com'
```

### Comparing `watex-0.2.3/watex/__init__.py` & `watex-0.2.4/watex/__init__.py`

 * *Files 0% similar despite different names*

```diff
@@ -31,15 +31,15 @@
         os.path.dirname(__file__), "wlog.yml")
 
 # generated version by setuptools_scm 
 try:
     from . import _version
     __version__ = _version.version.split('.dev')[0]
 except ImportError:
-    __version__ = '0.2.3' 
+    __version__ = '0.2.4' 
 
 # # set loging Level
 logging.getLogger(__name__)#.setLevel(logging.WARNING)
 # disable the matplotlib font manager logger.
 logging.getLogger('matplotlib.font_manager').disabled = True
 # or ust suppress the DEBUG messages but not the others from that logger.
 # logging.getLogger('matplotlib.font_manager').setLevel(logging.ERROR)
```

### Comparing `watex-0.2.3/watex/_docstring.py` & `watex-0.2.4/watex/_docstring.py`

 * *Files 0% similar despite different names*

```diff
@@ -759,15 +759,15 @@
     returns=DocstringComponents(_core_returns),
     seealso=DocstringComponents(_seealso_blurbs),
 )
  
 """
 .. currentmodule:: watex
 """
-
+#.. |API change| replace:: :bdg-dark:`API change`
 # Define replacements (used in whatsnew bullets)
 
 wx_rst_epilog ="""
 
 .. role:: raw-html(raw)
    :format: html
    
@@ -782,15 +782,15 @@
 .. |EM| replace:: electromagnetic
 .. |EMAP| replace:: |EM| array profiling
 .. |Fix| replace:: :bdg-danger:`Fix`
 .. |Enhancement| replace:: :bdg-info:`Enhancement`
 .. |Feature| replace:: :bdg-success:`Feature`
 .. |Major feature| replace:: :bdg-success:`Major feature`
 .. |Major change| replace:: :bdg-primary:`Major change`
-.. |API change| replace:: :bdg-dark:`API change`
+.. |API change| replace:: :bdg-warning:`API change`
 .. |Deprecated| replace:: :bdg-warning:`Deprecated`
 
 .. |Open Source? Yes!| image:: https://badgen.net/badge/Open%20Source%20%3F/Yes%21/blue?icon=github
    :target: https://github.com/WEgeophysics/watex
    
 .. |License BSD| image:: https://img.shields.io/github/license/WEgeophysics/watex?color=b&label=License&logo=github&logoColor=blue
    :alt: GitHub
```

### Comparing `watex-0.2.3/watex/_isotonic.pyx` & `watex-0.2.4/watex/_isotonic.pyx`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/_typing.py` & `watex-0.2.4/watex/_typing.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/_watexlog.py` & `watex-0.2.4/watex/_watexlog.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/analysis/__init__.py` & `watex-0.2.4/watex/analysis/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/analysis/decomposition.py` & `watex-0.2.4/watex/analysis/decomposition.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/analysis/dimensionality.py` & `watex-0.2.4/watex/analysis/dimensionality.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/analysis/factor.py` & `watex-0.2.4/watex/analysis/factor.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/base.py` & `watex-0.2.4/watex/base.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/cases/__init__.py` & `watex-0.2.4/watex/cases/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/cases/features.py` & `watex-0.2.4/watex/cases/features.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/cases/modeling.py` & `watex-0.2.4/watex/cases/modeling.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/cases/prepare.py` & `watex-0.2.4/watex/cases/prepare.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/cases/processing.py` & `watex-0.2.4/watex/cases/processing.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/cli.py` & `watex-0.2.4/watex/cli.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/__init__.py` & `watex-0.2.4/watex/datasets/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/_config.py` & `watex-0.2.4/watex/datasets/_config.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/_p.py` & `watex-0.2.4/watex/datasets/_p.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/b.pkl` & `watex-0.2.4/watex/datasets/data/b.pkl`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/bagoue.csv` & `watex-0.2.4/watex/datasets/data/bagoue.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/boston_house_prices.csv` & `watex-0.2.4/watex/datasets/data/boston_house_prices.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/boundiali_ves.csv` & `watex-0.2.4/watex/datasets/data/boundiali_ves.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/dcerp_gbalo.csv` & `watex-0.2.4/watex/datasets/data/dcerp_gbalo.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/dcves_gbalo.csv` & `watex-0.2.4/watex/datasets/data/dcves_gbalo.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/e.h5` & `watex-0.2.4/watex/datasets/data/e.h5`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/edis/raw.E.zip` & `watex-0.2.4/watex/datasets/data/edis/raw.E.zip`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/edis/s.E.zip` & `watex-0.2.4/watex/datasets/data/edis/s.E.zip`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/h.h5` & `watex-0.2.4/watex/datasets/data/h.h5`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/iris.csv` & `watex-0.2.4/watex/datasets/data/iris.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/mxs.joblib` & `watex-0.2.4/watex/datasets/data/mxs.joblib`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/semien_ves.csv` & `watex-0.2.4/watex/datasets/data/semien_ves.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/tankesse.csv` & `watex-0.2.4/watex/datasets/data/tankesse.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/data/wine_data.csv` & `watex-0.2.4/watex/datasets/data/wine_data.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/descr/bagoue.rst` & `watex-0.2.4/watex/datasets/descr/bagoue.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/descr/boston_house_prices.rst` & `watex-0.2.4/watex/datasets/descr/boston_house_prices.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/descr/boundiali_ves.rst` & `watex-0.2.4/watex/datasets/descr/boundiali_ves.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/descr/california_housing.rst` & `watex-0.2.4/watex/datasets/descr/california_housing.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/descr/gbalo_erp.rst` & `watex-0.2.4/watex/datasets/descr/gbalo_erp.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/descr/gbalo_ves.rst` & `watex-0.2.4/watex/datasets/descr/gbalo_ves.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/descr/huayuan_edis.rst` & `watex-0.2.4/watex/datasets/descr/huayuan_edis.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/descr/iris.rst` & `watex-0.2.4/watex/datasets/descr/iris.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/descr/wine_data.rst` & `watex-0.2.4/watex/datasets/descr/wine_data.rst`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/dload.py` & `watex-0.2.4/watex/datasets/dload.py`

 * *Files 2% similar despite different names*

```diff
@@ -7,30 +7,32 @@
 =================================
 
 Inspired from the machine learning popular dataset loading 
 
 Created on Thu Oct 13 16:26:47 2022
 @author: Daniel
 """
-
+import scipy 
+import numpy as np
 from warnings import warn 
 from importlib import resources 
 import pandas as pd 
 from .._docstring import erp_doc, ves_doc 
 from .io import csv_data_loader, _to_dataframe, DMODULE, get_data, remove_data 
 from ..utils.coreutils import vesSelector, erpSelector 
 from ..utils.mlutils import split_train_test_by_id , existfeatures
 from ..utils.funcutils import ( 
     to_numeric_dtypes , 
     smart_format, str2columns, 
     is_in_if, 
     reshape, 
     zip_extractor , 
     key_checker, 
-    random_sampling, 
+    random_sampling,
+    assert_ratio
     )
 from ..utils.box import Boxspace
 
 __all__= [ "load_bagoue" , "load_gbalo", "load_iris", "load_semien",
           "load_tankesse",  "load_boundiali", "load_hlogs","load_edis"]
 
 def load_tankesse (
@@ -438,15 +440,15 @@
 >>> list(y.columns)
 ... ['pumping_level', 'aquifer_thickness']
  
 """
 
 def load_bagoue(
         *, return_X_y=False, as_frame=False, split_X_y=False, test_size =.3 , 
-        tag=None , data_names=None,
+        tag=None , data_names=None, **kws
  ):
     cf = as_frame 
     data_file = "bagoue.csv"
     data, target, target_names, feature_names, fdescr = csv_data_loader(
         data_file=data_file, descr_file="bagoue.rst", include_headline= True, 
     )
     frame = None
@@ -898,15 +900,15 @@
     latter already holds `tag` and `data_names` as parameters.
     
 savepath: str, 
    Path to store temporarily the extracted huayuan data data.  If no supplied 
    the default cache is used.
    
 clear_cache:bool, default=False 
-   Clear the cache before storing the new EDI files. For instanceif at the first
+   Clear the cache before storing the new EDI files. For instance, if at the first
    turn all edis is fetched. At the second run, if samples is given, It does 
    not have effect. All the EDI files will be retrieved. Thus, to get the 
    the number of samples for EDI, `clear_cache` should be useful by setting to 
    ``True``. 
   
 Returns
 -------
@@ -961,28 +963,32 @@
     key =None,  
     tag =None, 
     samples=None, 
     tnames = None , 
     data_names=None, 
     split_X_y=False, 
     seed = None, 
-    shuffle=False, 
+    shuffle=False,
+    test_ratio=.2,  
     **kws): 
-    import joblib, numpy as np 
-    
+    import joblib
+
     drop_observations =kws.pop("drop_observations", False)
     
+    target_map= { 
+        0: '1',
+        1: '11*', 
+        2: '2', 
+        3: '2*', 
+        4: '3', 
+        5: '33*'
+        }
+    
     add = {"data": ('data', ) , '*': (
         'X_train','X_test' , 'y_train','y_test' ), 
-        'target_map': { 0: '1',
-                       1: '11', 
-                       2: '2', 
-                       3: '2*', 
-                       4: '3', 
-                       5: '33'}
         }
     
     av= {"sparse": ('X_csr', 'ymxs_transf'), 
          "scale": ('Xsc', 'ymxs_transf'), 
          "train": ( 'X_train', 'y_train'), 
          "test": ('X_test', 'y_test'), 
          'numeric': ( 'Xnm', 'ymxs_transf'), 
@@ -1004,43 +1010,62 @@
            f" {smart_format(available_sets, 'or')}")
     assert str(key).lower() in available_sets , msg
     # manage sampling 
     # by default output 50% data 
     samples= samples or .50 
     
     if split_X_y: 
+        from ..exlib import train_test_split
         data = tuple ([data_dict [k] for k in add ['*'] ] )
-        data = ( random_sampling(d, samples = samples,
-                  random_state= seed , shuffle= shuffle ) for d in data ) 
-        return  tuple (data )
+        # concatenate the CSR matrix 
+        X_csr = scipy.sparse.csc_matrix (np.concatenate (
+            (data[0].toarray(), data[1].toarray()))) 
+        y= np.concatenate ((data[-2], data[-1]))
+        # resampling 
+        data = (random_sampling(d, samples = samples,random_state= seed , 
+                                shuffle= shuffle) for d in (X_csr, y ) 
+                )
+        # split now
+        return train_test_split (*tuple ( data ),random_state = seed, 
+                                 test_size =assert_ratio (test_ratio),
+                                 shuffle = shuffle)
+  
     
+    # Append Xy to Boxspace if 
+    # return_X_y is not set explicitly.
+    Xy = dict() 
     # if for return X and y if k is not None 
     if key is not None and key !="data": 
-        return_X_y = True 
-        
-    if return_X_y:
         if key not in  av.keys():
             key ='raw'
         X, y =  tuple ( [ data_dict[k]  for k in av [key]] ) 
 
         X = random_sampling(X, samples = samples,random_state= seed , 
                             shuffle= shuffle)
         y = random_sampling(y, samples = samples, random_state= seed, 
                             shuffle= shuffle
                                )
-        return (  X, y )  if as_frame or key =='sparse' else (
-            np.array(X), np.array(y))
         
+        if return_X_y: 
+            return (  X, y )  if as_frame or key =='sparse' else (
+                np.array(X), np.array(y))
+        
+        # if return_X_y is not True 
+        Xy ['X']=X ; Xy ['y']=y 
+        # Initialize key to 'data' to 
+        # append the remain data 
+        key ='data'
+
     data = data_dict.get(key)  
     if drop_observations: 
         data.drop (columns = "remark", inplace = True )
         
     frame = None
-    feature_names = list(data.columns [:12] ) 
-    target_columns = list(data.columns [12:])
+    feature_names = list(data.columns [:13] ) 
+    target_columns = list(data.columns [13:])
     
     tnames = tnames or target_columns
     # control the existence of the tnames to retreive
     
     data = random_sampling(data, samples = samples, random_state= seed, 
                            shuffle= shuffle)
     
@@ -1053,42 +1078,43 @@
 
     return Boxspace(
         data=data.values,
         target=data[tnames].values,
         frame=data,
         tnames=tnames,
         target_names = target_columns,
-        target_map = add.get('target_map'), 
+        target_map = target_map, 
         nga_labels = data_dict.get('nga_labels'), 
         #XXX Add description 
         DESCR= '', # fdescr,
         feature_names=feature_names,
         filename=data_file,
         data_module=DMODULE,
+        **Xy
     )
     
 load_mxs.__doc__="""\
-Load the dataset for implementing the mixture learning strategy (MXS).
+Load the dataset after implementing the mixture learning strategy (MXS).
 
-Dataset is composed of 11 boreholes merged with multiple-target thatcan be 
-used for a classification or regression problem.
+Dataset is composed of 11 boreholes merged with multiple-target that can be 
+used for a classification problem.
 
 Parameters
 ----------
 return_X_y : bool, default=False
     If True, returns ``(data, target)`` instead of a Bowlspace object. See
     below for more information about the `data` and `target` object.
     
 as_frame : bool, default=False
     If True, the data is a pandas DataFrame including columns with
     appropriate dtypes (numeric). The target is
     a pandas DataFrame or Series depending on the number of target columns.
     If `return_X_y` is True, then (`data`, `target`) will be pandas
     DataFrames or Series as described below.
-    .. versionadded:: 0.1.3
+
 split_X_y: bool, default=False,
     If True, the data is splitted to hold the training set (X, y)  and the 
     testing set (Xt, yt) with with test ratio fixed to 20 % 
 
 tnames: str, optional 
     the name of the target to retreive. If ``None`` the full target columns 
     are collected and compose a multioutput `y`. For a singular classification 
@@ -1127,14 +1153,18 @@
     np.random.Generator, optional
    If int, array-like, or BitGenerator, seed for random number generator. 
    If np.random.RandomState or np.random.Generator, use as given.
    
 shuffle: bool, default =False, 
    If ``True``, borehole data should be shuffling before sampling. 
    
+test_ratio: float, default is 0.2 i.e. 20% (X, y)
+    The ratio to split the data into training (X, y) and testing (Xt, yt) set 
+    respectively.
+    
 Returns
 ---------
 data : :class:`~watex.utils.Boxspace`
     Dictionary-like object, with the following attributes.
     data : {ndarray, dataframe} 
         The data matrix. If ``as_frame=True``, `data` will be a pandas DataFrame.
     target: {ndarray, Series} 
@@ -1162,19 +1192,16 @@
     (n_samples,) containing the target samples.
     .. versionadded:: 0.1.2
 X, Xt, y, yt: Tuple if ``split_X_y`` is True 
     A tuple of two ndarray (X, Xt). The first containing a 2D array of:
  
 Examples
 --------
-Let's say ,we do not have any idea of the columns that compose the target,
-thus, the best approach is to run the function without passing any parameters::
-
 >>> from watex.datasets.dload import load_mxs  
->>> load_mxs (return_X_y= True, key ='sparse')
+>>> load_mxs (return_X_y= True, key ='sparse', samples ='*')
 (<1038x21 sparse matrix of type '<class 'numpy.float64'>'
  	with 8298 stored elements in Compressed Sparse Row format>,
  array([1, 1, 1, ..., 5, 5, 5], dtype=int64))
  
 """
```

### Comparing `watex-0.2.3/watex/datasets/gdata.py` & `watex-0.2.4/watex/datasets/gdata.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/io.py` & `watex-0.2.4/watex/datasets/io.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/rload.py` & `watex-0.2.4/watex/datasets/rload.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/datasets/sets.py` & `watex-0.2.4/watex/datasets/sets.py`

 * *Files 3% similar despite different names*

```diff
@@ -63,15 +63,15 @@
          "DATASET"
          ]
 
 def fetch_data (tag, **kws): 
     tag = _parse_tags(tag, multi_kind_dataset='bagoue')
     func= _fetch_data if fi else None 
     funcs= (load_bagoue , load_gbalo, load_iris, load_semien, load_tankesse , 
-            load_boundiali, load_hlogs, load_huayuan, load_edis ) 
+            load_boundiali, load_hlogs, load_huayuan, load_edis, load_mxs ) 
     funcns = list (map(lambda f: f.__name__.replace('load_', ''), funcs))
     if tag in (funcns): 
         func = funcs[funcns.index (tag)] 
     
     return func (tag=tag, data_names=funcns, **kws) if callable (func) else None 
 
 
@@ -163,17 +163,16 @@
     
     if len(t) ==1 : 
         if t[0].lower() not in _DTAGS: 
             tag = multi_kind_dataset +' ' + t[0]
             
             warn(f"Fetching {multi_kind_dataset.title()!r} data without"
                  " explicitly prefixing the kind of data with the area"
-                 " name will raise an error in future. Henceforth, "
-                f" the argument should be '{tag}' instead.", 
-                 FutureWarning 
+                 " name will raise an error. In future, the argument"
+                f" should be '{tag}' instead.", FutureWarning 
                  )
     elif len(t) >1 : 
         # only the multi kind dataset is allowed 
         # to contain two words for fetching data 
         if t[0].lower() !=multi_kind_dataset: 
             tag = t[0].lower() # skip the second word 
     return tag 
@@ -193,14 +192,16 @@
     - ERP data found in 'gbalo', 'boundiali' localities in northern part of 
         Cote d'Ivoire <'https://en.wikipedia.org/wiki/Ivory_Coast'>'
     - VES data collected in 'gbalo', 'semien', 'tankesse' in center and 
         eastearn part of Cote d'Ivoire'.
     - FLOW RATE FEATURES data computed from Bagoue ERP and VES data. 
         Refer to paper :doi:`https://doi.org/10.1029/2021wr031623`. 
     - COMMON MACHINE LEARNING popular data sets such IRIS. 
+    - EDI datasets from huayaun county in China, Hunan Province. 
+    - HLOGS and MXS data  for Hongliu coal mine raw and preprocessed borehole data. 
 """
     
 DATASET= type ("DATASET", (), {"KIND": _DTAGS, 
                                "HOW":_LST, 
                                "DOC":_DDOC, 
                                }
 )
```

### Comparing `watex-0.2.3/watex/datasets/setup.py` & `watex-0.2.4/watex/datasets/setup.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/decorators.py` & `watex-0.2.4/watex/decorators.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/edi.py` & `watex-0.2.4/watex/edi.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/etc/AGSO.csv` & `watex-0.2.4/watex/etc/AGSO.csv`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/etc/__XTyT.pkl` & `watex-0.2.4/watex/etc/__XTyT.pkl`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/etc/__Xy.pkl` & `watex-0.2.4/watex/etc/__Xy.pkl`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/etc/__memory.pkl` & `watex-0.2.4/watex/etc/__memory.pkl`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/etc/memory.sq3` & `watex-0.2.4/watex/etc/memory.sq3`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/etc/p.models.pkl` & `watex-0.2.4/watex/etc/p.models.pkl`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/exceptions.py` & `watex-0.2.4/watex/exceptions.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/exlib/__init__.py` & `watex-0.2.4/watex/exlib/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/exlib/gbm.py` & `watex-0.2.4/watex/exlib/gbm.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/exlib/sklearn.py` & `watex-0.2.4/watex/exlib/sklearn.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/externals/_numpy_compiler_patch.py` & `watex-0.2.4/watex/externals/_numpy_compiler_patch.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/externals/_pkgs/_structures.py` & `watex-0.2.4/watex/externals/_pkgs/_structures.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/externals/_pkgs/version.py` & `watex-0.2.4/watex/externals/_pkgs/version.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/externals/z.py` & `watex-0.2.4/watex/externals/z.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/externals/zutils.py` & `watex-0.2.4/watex/externals/zutils.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/geology/__init__.py` & `watex-0.2.4/watex/geology/__init__.py`

 * *Files 12% similar despite different names*

```diff
@@ -14,19 +14,22 @@
 
 from .geology import ( 
     Geology ,  
     Structures,
     Structural, 
     )
 from .drilling import ( 
-    Borehole 
+    Borehole , 
+    DSBorehole, 
+    DSBoreholes, 
     )
 from .stratigraphic import  GeoStrataModel
 
 __all__=[ 
     'Geology' ,  
     'Structures',
     'Structural', 
     'Borehole', 
     'GeoStrataModel', 
-    
+    'DSBorehole', 
+    'DSBoreholes',
     ]
```

### Comparing `watex-0.2.3/watex/geology/core.py` & `watex-0.2.4/watex/geology/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -29,22 +29,22 @@
 from ..exceptions import ( 
     GeoPropertyError, 
     )
 from .._watexlog import watexlog 
 _logger = watexlog().get_watex_logger(__name__ )
 
 __all__=[
-    "Base", 
+    "GeoBase", 
     "set_agso_properties", 
     "mapping_stratum", 
     "fetching_data_from_repo", 
     "get_agso_properties"
     ] 
 
-class Base: 
+class GeoBase: 
     """
     Base class of container of geological informations  for stratigraphy model  
     log creation of exploration area.
     
     Each station is condidered as an attribute and  framed by two closest  
     points from the station offsets. The class deals with the true resistivity
     values collected on exploration area from drilling or geolgical companies.
```

### Comparing `watex-0.2.3/watex/geology/database.py` & `watex-0.2.4/watex/geology/database.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/geology/geology.py` & `watex-0.2.4/watex/geology/geology.py`

 * *Files 1% similar despite different names*

```diff
@@ -5,15 +5,15 @@
 import os
 import re
 import warnings 
 import numpy as np 
 
 import pandas as pd
 from .core import (
-    Base, 
+    GeoBase, 
     get_agso_properties 
     )
 from ..utils.funcutils import ( 
     repr_callable_obj, 
     smart_strobj_recognition
     )
 from ..utils.plotutils import ( 
@@ -81,15 +81,15 @@
     investigation sites"""
     
     def __init__(self, geofn = None,  **kwargs)-> None:
         self._logging =watexlog().get_watex_logger(self.__class__.__name__)
         pass
  
                
-class Structures(Base): 
+class Structures(GeoBase): 
     """
     This class is an auxilliary class to supplement geodatabase , 
     if the GeodataBase doesnt reply  to SQL request  , then use this class
     to secah information about structures .  If SQL is done as well ,
     program won't call this class as rescure . 
     Containers of more than  150 geological strutures.
 
@@ -275,15 +275,15 @@
         appender  = "" if rv is None else f'. Do you mean {rv!r}'
         
         raise AttributeError (
             f'{self.__class__.__name__!r} object has no attribute {name!r}'
             f'{appender}{"" if rv is None else "?"}'
             )        
         
-class Structural(Base) :
+class Structural(GeoBase) :
     """
     Geology strutural conventions class.
     
     Note that the given structural objects are quite less than the litterature 
     More structural object can be added as the structures is known. 
     All geological structural informations are geostructral object.
```

### Comparing `watex-0.2.3/watex/geology/stratigraphic.py` & `watex-0.2.4/watex/geology/stratigraphic.py`

 * *Files 0% similar despite different names*

```diff
@@ -22,15 +22,15 @@
 from .._typing import NDArray 
 from .._watexlog import watexlog 
 from ..decorators import (
     gplot2d
     )
 from ..exceptions import NotFittedError
 from .core import (
-    Base 
+    GeoBase 
     )
 from .database import ( 
     GeoDataBase,
     )
 from ..utils.funcutils import ( 
     serialize_data, 
     load_serialized_data,
@@ -66,15 +66,15 @@
     import tqdm 
     TQDM = True 
 _logger = watexlog().get_watex_logger(__name__ )
 
 __all__=["GeoStrataModel"]
 
 #XXXTODO: add MODEM construction block  in progress 
-class GeoStrataModel(Base):
+class GeoStrataModel(GeoBase):
 
     def __init__(
         self, 
         beta=5, 
         ptol=0.1 , 
         n_epochs=100, 
         tres=None,
```

### Comparing `watex-0.2.3/watex/methods/__init__.py` & `watex-0.2.4/watex/methods/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/methods/electrical.py` & `watex-0.2.4/watex/methods/electrical.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/methods/em.py` & `watex-0.2.4/watex/methods/em.py`

 * *Files 0% similar despite different names*

```diff
@@ -33,8511 +33,8511 @@
 00000200: 7420 2820 0d0a 2020 2020 4544 4945 7272  t ( ..    EDIErr
 00000210: 6f72 2c20 0d0a 2020 2020 546f 704d 6f64  or, ..    TopMod
 00000220: 756c 6545 7272 6f72 2c20 0d0a 2020 2020  uleError, ..    
 00000230: 4672 6571 7565 6e63 7945 7272 6f72 2c20  FrequencyError, 
 00000240: 0d0a 2020 2020 4e6f 7446 6974 7465 6445  ..    NotFittedE
 00000250: 7272 6f72 2c20 0d0a 2020 2020 454d 4572  rror, ..    EMEr
 00000260: 726f 722c 0d0a 2020 2020 5a45 7272 6f72  ror,..    ZError
-00000270: 2c20 0d0a 2020 2020 0d0a 2920 0d0a 6672  , ..    ..) ..fr
-00000280: 6f6d 202e 2e65 7874 6572 6e61 6c73 2e7a  om ..externals.z
-00000290: 2069 6d70 6f72 7420 5a20 6173 2045 4d7a   import Z as EMz
-000002a0: 200d 0a66 726f 6d20 2e2e 7574 696c 732e   ..from ..utils.
-000002b0: 6675 6e63 7574 696c 7320 696d 706f 7274  funcutils import
-000002c0: 2028 200d 0a20 2020 205f 6173 7365 7274   ( ..    _assert
-000002d0: 5f61 6c6c 5f74 7970 6573 2c0d 0a20 2020  _all_types,..   
-000002e0: 2069 735f 6974 6572 6162 6c65 2c0d 0a20   is_iterable,.. 
-000002f0: 2020 2061 7373 6572 745f 7261 7469 6f2c     assert_ratio,
-00000300: 0d0a 2020 2020 6d61 6b65 5f69 6473 2c0d  ..    make_ids,.
-00000310: 0a20 2020 2073 686f 775f 7374 6174 732c  .    show_stats,
-00000320: 200d 0a20 2020 2066 6974 5f62 795f 6c6c   ..    fit_by_ll
-00000330: 2c20 0d0a 2020 2020 7265 7368 6170 652c  , ..    reshape,
-00000340: 200d 0a20 2020 2073 6d61 7274 5f73 7472   ..    smart_str
-00000350: 6f62 6a5f 7265 636f 676e 6974 696f 6e2c  obj_recognition,
-00000360: 200d 0a20 2020 2072 6570 725f 6361 6c6c   ..    repr_call
-00000370: 6162 6c65 5f6f 626a 2c0d 0a20 2020 2072  able_obj,..    r
-00000380: 656d 6f76 655f 6f75 746c 6965 7273 2c20  emove_outliers, 
-00000390: 0d0a 2020 2020 6e6f 726d 616c 697a 6572  ..    normalizer
-000003a0: 2c20 0d0a 2020 2020 7261 6e64 6f6d 5f73  , ..    random_s
-000003b0: 656c 6563 746f 722c 200d 0a20 2020 206c  elector, ..    l
-000003c0: 6973 7469 6e67 5f69 7465 6d73 5f66 6f72  isting_items_for
-000003d0: 6d61 740d 0a20 2020 2029 200d 0a66 726f  mat..    ) ..fro
-000003e0: 6d20 2e2e 7574 696c 732e 6578 6d61 7468  m ..utils.exmath
-000003f0: 2069 6d70 6f72 7420 2820 0d0a 2020 2020   import ( ..    
-00000400: 7363 616c 6550 6f73 6974 696f 6e2c 200d  scalePosition, .
-00000410: 0a20 2020 2066 6974 7465 6e73 6f72 2c0d  .    fittensor,.
-00000420: 0a20 2020 2067 6574 3264 7465 6e73 6f72  .    get2dtensor
-00000430: 2c20 0d0a 2020 2020 6265 7461 6a2c 200d  , ..    betaj, .
-00000440: 0a20 2020 2069 6e74 6572 706f 6c61 7465  .    interpolate
-00000450: 3164 2c0d 0a20 2020 2069 6e74 6572 706f  1d,..    interpo
-00000460: 6c61 7465 3264 2c20 0d0a 2020 2020 6765  late2d, ..    ge
-00000470: 745f 6675 6c6c 5f66 7265 7175 656e 6379  t_full_frequency
-00000480: 2c20 0d0a 2020 2020 6669 6e64 5f63 6c6f  , ..    find_clo
-00000490: 7365 7374 2c20 0d0a 2020 2020 7268 6f70  sest, ..    rhop
-000004a0: 6869 327a 2c20 0d0a 2020 2020 7a32 7268  hi2z, ..    z2rh
-000004b0: 6f61 2c20 0d0a 2020 2020 6d75 302c 0d0a  oa, ..    mu0,..
-000004c0: 2020 2020 736d 6f6f 7468 696e 672c 200d      smoothing, .
-000004d0: 0a20 2020 2029 0d0a 6672 6f6d 202e 2e75  .    )..from ..u
-000004e0: 7469 6c73 2e63 6f72 6575 7469 6c73 2069  tils.coreutils i
-000004f0: 6d70 6f72 7420 2820 0d0a 2020 2020 6d61  mport ( ..    ma
-00000500: 6b65 436f 6f72 6473 2c20 0d0a 2020 2020  keCoords, ..    
-00000510: 290d 0a66 726f 6d20 2e2e 7072 6f70 6572  )..from ..proper
-00000520: 7479 2069 6d70 6f72 7420 280d 0a20 2020  ty import (..   
-00000530: 2049 7345 6469 0d0a 2020 2020 290d 0a66   IsEdi..    )..f
-00000540: 726f 6d20 2e2e 7369 7465 2069 6d70 6f72  rom ..site impor
-00000550: 7420 4c6f 6361 7469 6f6e 200d 0a66 726f  t Location ..fro
-00000560: 6d20 2e2e 5f74 7970 696e 6720 696d 706f  m .._typing impo
-00000570: 7274 2028 200d 0a20 2020 2041 7272 6179  rt ( ..    Array
-00000580: 4c69 6b65 2c20 0d0a 2020 2020 4f70 7469  Like, ..    Opti
-00000590: 6f6e 616c 2c20 0d0a 2020 2020 4c69 7374  onal, ..    List
-000005a0: 2c0d 0a20 2020 2054 7570 6c65 2c20 0d0a  ,..    Tuple, ..
-000005b0: 2020 2020 4469 6374 2c20 0d0a 2020 2020      Dict, ..    
-000005c0: 4e44 4172 7261 792c 200d 0a20 2020 2044  NDArray, ..    D
-000005d0: 5479 7065 2c0d 0a20 2020 2045 4449 4f2c  Type,..    EDIO,
-000005e0: 0d0a 2020 2020 5a4f 2c20 0d0a 2020 2020  ..    ZO, ..    
-000005f0: 542c 0d0a 2020 2020 462c 200d 0a20 2020  T,..    F, ..   
-00000600: 2029 0d0a 6672 6f6d 202e 2e75 7469 6c73   )..from ..utils
-00000610: 2e5f 6465 7065 6e64 656e 6379 2069 6d70  ._dependency imp
-00000620: 6f72 7420 2820 0d0a 2020 2020 696d 706f  ort ( ..    impo
-00000630: 7274 5f6f 7074 696f 6e61 6c5f 6465 7065  rt_optional_depe
-00000640: 6e64 656e 6379 0d0a 2020 2020 290d 0a66  ndency..    )..f
-00000650: 726f 6d20 2e2e 7574 696c 732e 7661 6c69  rom ..utils.vali
-00000660: 6461 746f 7220 696d 706f 7274 2028 200d  dator import ( .
-00000670: 0a20 2020 205f 7661 6c69 6461 7465 5f74  .    _validate_t
-00000680: 656e 736f 722c 200d 0a20 2020 205f 6173  ensor, ..    _as
-00000690: 7365 7274 5f7a 5f6f 725f 6564 695f 6f62  sert_z_or_edi_ob
-000006a0: 6a73 0d0a 2020 2020 290d 0a0d 0a5f 6c6f  js..    )...._lo
-000006b0: 6767 6572 203d 2077 6174 6578 6c6f 672e  gger = watexlog.
-000006c0: 6765 745f 7761 7465 785f 6c6f 6767 6572  get_watex_logger
-000006d0: 285f 5f6e 616d 655f 5f29 0d0a 0d0a 5f5f  (__name__)....__
-000006e0: 616c 6c5f 5f20 3d5b 2745 4d27 2c0d 0a20  all__ =['EM',.. 
-000006f0: 2020 2020 2020 2020 2027 5072 6f63 6573           'Proces
-00000700: 7369 6e67 272c 0d0a 2020 2020 2020 2020  sing',..        
-00000710: 2020 275a 4327 2c0d 0a20 2020 2020 2020    'ZC',..       
-00000720: 2020 205d 0d0a 0d0a 636c 6173 7320 454d     ]....class EM
-00000730: 2849 7345 6469 293a 200d 0a20 2020 2022  (IsEdi): ..    "
-00000740: 2222 0d0a 2020 2020 4372 6561 7465 2045  ""..    Create E
-00000750: 4d20 6f62 6a65 6374 2061 7320 6120 636f  M object as a co
-00000760: 6c6c 6563 7469 6f6e 206f 6620 4544 492d  llection of EDI-
-00000770: 6669 6c65 2e20 0d0a 2020 2020 0d0a 2020  file. ..    ..  
-00000780: 2020 436f 6c6c 6563 7420 6564 6966 696c    Collect edifil
-00000790: 6573 2061 6e64 2063 7265 6174 6520 616e  es and create an
-000007a0: 2045 4d20 6f62 6a65 6374 2e20 4974 2073   EM object. It s
-000007b0: 6574 7320 2074 6865 2070 726f 7065 7274  ets  the propert
-000007c0: 6965 7320 6672 6f6d 200d 0a20 2020 2061  ies from ..    a
-000007d0: 7564 696f 2d6d 6167 6e65 746f 7465 6c6c  udio-magnetotell
-000007e0: 7572 6963 2e20 5468 6520 7477 6f28 3229  uric. The two(2)
-000007f0: 2063 6f6d 706f 6e65 6e74 7320 5859 2061   components XY a
-00000800: 6e64 2059 5820 7769 6c6c 2062 6520 7365  nd YX will be se
-00000810: 7420 616e 6420 0d0a 2020 2020 6361 6c63  t and ..    calc
-00000820: 756c 6174 6564 2e43 616e 2072 6561 6420  ulated.Can read 
-00000830: 4d54 2064 6174 6120 696e 7374 6561 642c  MT data instead,
-00000840: 2068 6f77 6576 6572 2074 6865 2066 756c   however the ful
-00000850: 6c20 6861 6e64 6c69 6e67 2074 7261 6e73  l handling trans
-00000860: 6665 7220 0d0a 2020 2020 6675 6e63 7469  fer ..    functi
-00000870: 6f6e 206c 696b 6520 5469 7070 6572 2061  on like Tipper a
-00000880: 6e64 2053 7065 6374 7261 2020 6973 206e  nd Spectra  is n
-00000890: 6f74 2063 6f6d 706c 6574 6564 2e20 5573  ot completed. Us
-000008a0: 6520 206f 7468 6572 204d 5420 0d0a 2020  e  other MT ..  
-000008b0: 2020 736f 6674 7761 7265 7320 666f 7220    softwares for 
-000008c0: 6120 6c6f 6e67 2070 6572 696f 6473 2064  a long periods d
-000008d0: 6174 612e 200d 0a20 2020 200d 0a20 2020  ata. ..    ..   
-000008e0: 2050 6172 616d 6574 6572 7320 0d0a 2020   Parameters ..  
-000008f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d    -------------.
-00000900: 0a20 2020 2073 7572 7665 795f 6e61 6d65  .    survey_name
-00000910: 3a20 7374 7220 0d0a 2020 2020 2020 2020  : str ..        
-00000920: 6c6f 6361 7469 6f6e 206e 616d 6520 7768  location name wh
-00000930: 6572 6520 7468 6520 6461 7465 2077 6865  ere the date whe
-00000940: 7265 2063 6f6c 6c65 6374 6564 202e 2049  re collected . I
-00000950: 6620 7375 7276 6579 6e61 6d65 2069 7320  f surveyname is 
-00000960: 4e6f 6e65 2020 0d0a 2020 2020 2020 2020  None  ..        
-00000970: 6361 6e20 6368 6563 6820 6f6e 2065 6469  can chech on edi
-00000980: 6669 6c65 732e 200d 0a0d 0a20 2020 2041  files. ....    A
-00000990: 7474 7269 6275 7465 7320 0d0a 2020 2020  ttributes ..    
-000009a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
-000009b0: 2065 6469 4f62 6a73 5f3a 2041 7272 6179   ediObjs_: Array
-000009c0: 2d6c 696b 6520 6f66 2073 6861 7065 2028  -like of shape (
-000009d0: 4e2c 2920 0d0a 2020 2020 2020 2020 6172  N,) ..        ar
-000009e0: 7261 7920 6f66 2074 6865 2063 6f6c 6c65  ray of the colle
-000009f0: 6374 696f 6e20 6f66 2065 6469 6669 6c65  ction of edifile
-00000a00: 7320 7265 6164 5f73 7563 6573 7366 756c  s read_sucessful
-00000a10: 6c79 2020 0d0a 2020 2020 6461 7461 5f3a  ly  ..    data_:
-00000a20: 2041 7272 6179 2d6c 696b 6520 6f66 2073   Array-like of s
-00000a30: 6861 7065 2028 4e2c 2029 200d 0a20 2020  hape (N, ) ..   
-00000a40: 2020 2020 2061 7272 6179 206f 6620 616c       array of al
-00000a50: 6c20 6564 6966 696c 6573 2066 6565 6420  l edifiles feed 
-00000a60: 696e 2074 6865 2060 454d 6020 6d6f 6475  in the `EM` modu
-00000a70: 6c65 7320 7768 6174 6576 6572 2073 7563  les whatever suc
-00000a80: 6573 7375 6666 756c 7920 0d0a 2020 2020  essuffuly ..    
-00000a90: 2020 2020 7265 6164 206f 7220 6e6f 742e      read or not.
-00000aa0: 200d 0a20 2020 2065 6469 6e61 6d65 735f   ..    edinames_
-00000ab0: 3a20 6172 7261 792d 6c69 6b65 206f 6620  : array-like of 
-00000ac0: 7368 6170 6520 284e 2c29 200d 0a20 2020  shape (N,) ..   
-00000ad0: 2020 2020 2061 7272 6179 206f 6620 616c       array of al
-00000ae0: 6c20 6564 692d 6e61 6d65 7320 7375 6365  l edi-names suce
-00000af0: 7373 6675 6c6c 7920 7265 6164 200d 0a20  ssfully read .. 
-00000b00: 2020 2065 6469 6669 6c65 735f 3a20 6172     edifiles_: ar
-00000b10: 7261 7920 6f66 2073 6861 7065 2028 4e2c  ray of shape (N,
-00000b20: 2029 200d 0a20 2020 2020 2020 2061 7272   ) ..        arr
-00000b30: 6179 206f 6620 616c 6c20 6564 6966 696c  ay of all edifil
-00000b40: 6573 2069 6620 6769 7665 6e2e 200d 0a20  es if given. .. 
-00000b50: 2020 2066 7265 7173 5f3a 2061 7272 6179     freqs_: array
-00000b60: 2d6c 696b 6520 6f66 2073 6861 7065 2028  -like of shape (
-00000b70: 4e2c 2029 200d 0a20 2020 2020 2020 2041  N, ) ..        A
-00000b80: 7272 6179 206f 6620 7468 6520 6672 6571  rray of the freq
-00000b90: 7565 6e63 7920 7261 6e67 6520 6672 6f6d  uency range from
-00000ba0: 2045 4449 7320 0d0a 2020 2020 7265 6672   EDIs ..    refr
-00000bb0: 6571 5f3a 2066 6c6f 6174 2c20 0d0a 2020  eq_: float, ..  
-00000bc0: 2020 2020 2020 5265 6665 7265 6e63 6520        Reference 
-00000bd0: 7265 6672 6571 7565 6e63 7920 666f 7220  refrequency for 
-00000be0: 6461 7461 2063 6f72 7265 6374 696f 6e2e  data correction.
-00000bf0: 204e 6f74 6520 7468 6520 7265 6665 7265   Note the refere
-00000c00: 6e63 6520 6672 6571 7565 6e63 790d 0a20  nce frequency.. 
-00000c10: 2020 2020 2020 2069 7320 7468 6520 6869         is the hi
-00000c20: 6768 6573 7420 6672 6571 7565 6e63 7920  ghest frequency 
-00000c30: 7769 7468 2063 6c65 616e 2064 6174 612e  with clean data.
-00000c40: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00000c50: 2050 726f 7065 7274 6965 7320 0d0a 2020   Properties ..  
-00000c60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a    ------------..
-00000c70: 2020 2020 0d0a 2020 2020 6c6f 6e67 6974      ..    longit
-00000c80: 7564 653a 2061 7272 6179 2d6c 696b 652c  ude: array-like,
-00000c90: 2073 6861 7065 2028 4e2c 2920 0d0a 2020   shape (N,) ..  
-00000ca0: 2020 2020 2020 6c6f 6e67 6974 7564 6520        longitude 
-00000cb0: 636f 6f72 6469 6e61 7465 2076 616c 7565  coordinate value
-00000cc0: 7320 2063 6f6c 6c65 6374 6564 2066 726f  s  collected fro
-00000cd0: 6d20 4544 4973 200d 0a20 2020 2020 2020  m EDIs ..       
-00000ce0: 200d 0a20 2020 206c 6174 6974 7564 653a   ..    latitude:
-00000cf0: 2061 7272 6179 2d6c 696b 652c 2073 6861   array-like, sha
-00000d00: 7065 2028 4e2c 2029 0d0a 2020 2020 2020  pe (N, )..      
-00000d10: 2020 4c61 7469 7475 6465 2063 6f6f 7264    Latitude coord
-00000d20: 696e 6174 6520 7661 6c75 6573 2063 6f6c  inate values col
-00000d30: 6c65 6374 6564 2066 726f 6d20 4544 4973  lected from EDIs
-00000d40: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00000d50: 2065 6c65 7661 7469 6f6e 3a20 6172 7261   elevation: arra
-00000d60: 792d 6c69 6b65 2c20 7368 6170 6520 284e  y-like, shape (N
-00000d70: 2c29 200d 0a20 2020 2020 2020 2045 6c65  ,) ..        Ele
-00000d80: 7661 7469 6f6e 2063 6f6f 7264 696e 6174  vation coordinat
-00000d90: 6573 2063 6f6c 6c65 6374 6564 2066 726f  es collected fro
-00000da0: 6d20 4544 4973 200d 0a20 2020 2020 2020  m EDIs ..       
-00000db0: 200d 0a20 2020 2022 2222 0d0a 0d0a 2020   ..    """....  
-00000dc0: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-00000dd0: 656c 662c 2073 7572 7665 795f 6e61 6d65  elf, survey_name
-00000de0: 3a73 7472 2020 3d4e 6f6e 6520 2c20 7665  :str  =None , ve
-00000df0: 7262 6f73 653d 3029 3a20 0d0a 2020 2020  rbose=0): ..    
-00000e00: 2020 2020 7365 6c66 2e5f 6c6f 6767 696e      self._loggin
-00000e10: 6720 3d20 7761 7465 786c 6f67 2e67 6574  g = watexlog.get
-00000e20: 5f77 6174 6578 5f6c 6f67 6765 7228 7365  _watex_logger(se
-00000e30: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
-00000e40: 616d 655f 5f29 0d0a 2020 2020 0d0a 2020  ame__)..    ..  
-00000e50: 2020 2020 2020 7365 6c66 2e73 7572 7665        self.surve
-00000e60: 795f 6e61 6d65 203d 7375 7276 6579 5f6e  y_name =survey_n
-00000e70: 616d 650d 0a20 2020 2020 2020 2073 656c  ame..        sel
-00000e80: 662e 4c6f 6361 7469 6f6e 5f3d 204c 6f63  f.Location_= Loc
-00000e90: 6174 696f 6e28 290d 0a20 2020 2020 2020  ation()..       
-00000ea0: 2073 656c 662e 7665 7262 6f73 653d 7665   self.verbose=ve
-00000eb0: 7262 6f73 650d 0a20 2020 2020 2020 2073  rbose..        s
-00000ec0: 656c 662e 5f6c 6174 6974 7564 6520 3d20  elf._latitude = 
-00000ed0: 4e6f 6e65 0d0a 2020 2020 2020 2020 7365  None..        se
-00000ee0: 6c66 2e5f 6c6f 6e67 6974 7564 653d 4e6f  lf._longitude=No
-00000ef0: 6e65 0d0a 2020 2020 2020 2020 7365 6c66  ne..        self
-00000f00: 2e5f 656c 6576 6174 696f 6e3d 204e 6f6e  ._elevation= Non
-00000f10: 6520 0d0a 0d0a 2020 2020 4070 726f 7065  e ....    @prope
-00000f20: 7274 7920 0d0a 2020 2020 6465 6620 6c61  rty ..    def la
-00000f30: 7469 7475 6465 2873 656c 6629 3a20 0d0a  titude(self): ..
-00000f40: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00000f50: 656c 662e 5f6c 6174 6974 7564 6520 0d0a  elf._latitude ..
-00000f60: 0d0a 2020 2020 406c 6174 6974 7564 652e  ..    @latitude.
-00000f70: 7365 7474 6572 200d 0a20 2020 2064 6566  setter ..    def
-00000f80: 206c 6174 6974 7564 6528 7365 6c66 2c20   latitude(self, 
-00000f90: 6c61 7469 7475 6465 293a 0d0a 2020 2020  latitude):..    
-00000fa0: 2020 2020 7365 6c66 2e5f 6173 7365 7274      self._assert
-00000fb0: 6174 7472 2028 2027 6c61 7469 7475 6465  attr ( 'latitude
-00000fc0: 272c 206c 6174 6974 7564 652c 0d0a 2020  ', latitude,..  
-00000fd0: 2020 2020 2020 2020 2020 7365 6c66 2e4c            self.L
-00000fe0: 6f63 6174 696f 6e5f 2e6c 6174 0d0a 2020  ocation_.lat..  
-00000ff0: 2020 2020 2020 2020 2020 290d 0a0d 0a20            ).... 
-00001000: 2020 2040 7072 6f70 6572 7479 200d 0a20     @property .. 
-00001010: 2020 2064 6566 206c 6f6e 6769 7475 6465     def longitude
-00001020: 2873 656c 6629 3a20 0d0a 2020 2020 2020  (self): ..      
-00001030: 2020 7265 7475 726e 2073 656c 662e 5f6c    return self._l
-00001040: 6f6e 6769 7475 6465 200d 0a20 2020 200d  ongitude ..    .
-00001050: 0a20 2020 2040 6c6f 6e67 6974 7564 652e  .    @longitude.
-00001060: 7365 7474 6572 200d 0a20 2020 2064 6566  setter ..    def
-00001070: 206c 6f6e 6769 7475 6465 2873 656c 662c   longitude(self,
-00001080: 206c 6f6e 6769 7475 6465 293a 0d0a 2020   longitude):..  
-00001090: 2020 2020 2020 7365 6c66 2e5f 6173 7365        self._asse
-000010a0: 7274 6174 7472 2028 2027 6c6f 6e67 6974  rtattr ( 'longit
-000010b0: 7564 6527 2c20 6c6f 6e67 6974 7564 652c  ude', longitude,
-000010c0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-000010d0: 6c66 2e4c 6f63 6174 696f 6e5f 2e6c 6f6e  lf.Location_.lon
-000010e0: 200d 0a20 2020 2020 2020 2020 2020 2029   ..            )
-000010f0: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
-00001100: 7920 0d0a 2020 2020 6465 6620 656c 6576  y ..    def elev
-00001110: 6174 696f 6e28 7365 6c66 293a 200d 0a20  ation(self): .. 
-00001120: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00001130: 6c66 2e5f 656c 6576 6174 696f 6e20 0d0a  lf._elevation ..
-00001140: 2020 2020 0d0a 2020 2020 4065 6c65 7661      ..    @eleva
-00001150: 7469 6f6e 2e73 6574 7465 7220 0d0a 2020  tion.setter ..  
-00001160: 2020 6465 6620 656c 6576 6174 696f 6e28    def elevation(
-00001170: 7365 6c66 2c20 656c 6576 6174 696f 6e29  self, elevation)
-00001180: 3a0d 0a20 2020 2020 2020 2073 656c 662e  :..        self.
-00001190: 5f61 7373 6572 7461 7474 7220 2827 656c  _assertattr ('el
-000011a0: 6576 6174 696f 6e27 2c20 656c 6576 6174  evation', elevat
-000011b0: 696f 6e2c 0d0a 2020 2020 2020 2020 2020  ion,..          
-000011c0: 2020 7365 6c66 2e4c 6f63 6174 696f 6e5f    self.Location_
-000011d0: 2e65 6c65 7620 0d0a 2020 2020 2020 2020  .elev ..        
-000011e0: 2020 2020 290d 0a20 2020 2020 2020 200d      )..        .
-000011f0: 0a20 2020 2040 7072 6f70 6572 7479 200d  .    @property .
-00001200: 0a20 2020 2064 6566 2073 746e 616d 6573  .    def stnames
-00001210: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-00001220: 2072 6574 7572 6e20 7365 6c66 2e5f 7374   return self._st
-00001230: 6174 696f 6e5f 6e61 6d65 730d 0a20 2020  ation_names..   
-00001240: 2040 7374 6e61 6d65 732e 7365 7474 6572   @stnames.setter
-00001250: 200d 0a20 2020 2064 6566 2073 746e 616d   ..    def stnam
-00001260: 6573 2028 7365 6c66 2c20 6564 695f 7374  es (self, edi_st
-00001270: 6174 696f 6e73 293a 0d0a 2020 2020 2020  ations):..      
-00001280: 2020 7472 7920 3a20 5f61 7373 6572 745f    try : _assert_
-00001290: 616c 6c5f 7479 7065 7328 6564 695f 7374  all_types(edi_st
-000012a0: 6174 696f 6e73 2c20 6c69 7374 2c0d 0a20  ations, list,.. 
+00000270: 2c20 0d0a 2920 0d0a 6672 6f6d 202e 2e65  , ..) ..from ..e
+00000280: 7874 6572 6e61 6c73 2e7a 2069 6d70 6f72  xternals.z impor
+00000290: 7420 5a20 6173 2045 4d7a 200d 0a66 726f  t Z as EMz ..fro
+000002a0: 6d20 2e2e 7574 696c 732e 6675 6e63 7574  m ..utils.funcut
+000002b0: 696c 7320 696d 706f 7274 2028 200d 0a20  ils import ( .. 
+000002c0: 2020 205f 6173 7365 7274 5f61 6c6c 5f74     _assert_all_t
+000002d0: 7970 6573 2c0d 0a20 2020 2069 735f 6974  ypes,..    is_it
+000002e0: 6572 6162 6c65 2c0d 0a20 2020 2061 7373  erable,..    ass
+000002f0: 6572 745f 7261 7469 6f2c 0d0a 2020 2020  ert_ratio,..    
+00000300: 6d61 6b65 5f69 6473 2c0d 0a20 2020 2073  make_ids,..    s
+00000310: 686f 775f 7374 6174 732c 200d 0a20 2020  how_stats, ..   
+00000320: 2066 6974 5f62 795f 6c6c 2c20 0d0a 2020   fit_by_ll, ..  
+00000330: 2020 7265 7368 6170 652c 200d 0a20 2020    reshape, ..   
+00000340: 2073 6d61 7274 5f73 7472 6f62 6a5f 7265   smart_strobj_re
+00000350: 636f 676e 6974 696f 6e2c 200d 0a20 2020  cognition, ..   
+00000360: 2072 6570 725f 6361 6c6c 6162 6c65 5f6f   repr_callable_o
+00000370: 626a 2c0d 0a20 2020 2072 656d 6f76 655f  bj,..    remove_
+00000380: 6f75 746c 6965 7273 2c20 0d0a 2020 2020  outliers, ..    
+00000390: 6e6f 726d 616c 697a 6572 2c20 0d0a 2020  normalizer, ..  
+000003a0: 2020 7261 6e64 6f6d 5f73 656c 6563 746f    random_selecto
+000003b0: 722c 200d 0a20 2020 206c 6973 7469 6e67  r, ..    listing
+000003c0: 5f69 7465 6d73 5f66 6f72 6d61 740d 0a20  _items_format.. 
+000003d0: 2020 2029 200d 0a66 726f 6d20 2e2e 7574     ) ..from ..ut
+000003e0: 696c 732e 6578 6d61 7468 2069 6d70 6f72  ils.exmath impor
+000003f0: 7420 2820 0d0a 2020 2020 7363 616c 6550  t ( ..    scaleP
+00000400: 6f73 6974 696f 6e2c 200d 0a20 2020 2066  osition, ..    f
+00000410: 6974 7465 6e73 6f72 2c0d 0a20 2020 2067  ittensor,..    g
+00000420: 6574 3264 7465 6e73 6f72 2c20 0d0a 2020  et2dtensor, ..  
+00000430: 2020 6265 7461 6a2c 200d 0a20 2020 2069    betaj, ..    i
+00000440: 6e74 6572 706f 6c61 7465 3164 2c0d 0a20  nterpolate1d,.. 
+00000450: 2020 2069 6e74 6572 706f 6c61 7465 3264     interpolate2d
+00000460: 2c20 0d0a 2020 2020 6765 745f 6675 6c6c  , ..    get_full
+00000470: 5f66 7265 7175 656e 6379 2c20 0d0a 2020  _frequency, ..  
+00000480: 2020 6669 6e64 5f63 6c6f 7365 7374 2c20    find_closest, 
+00000490: 0d0a 2020 2020 7268 6f70 6869 327a 2c20  ..    rhophi2z, 
+000004a0: 0d0a 2020 2020 7a32 7268 6f61 2c20 0d0a  ..    z2rhoa, ..
+000004b0: 2020 2020 6d75 302c 0d0a 2020 2020 736d      mu0,..    sm
+000004c0: 6f6f 7468 696e 672c 200d 0a20 2020 2029  oothing, ..    )
+000004d0: 0d0a 6672 6f6d 202e 2e75 7469 6c73 2e63  ..from ..utils.c
+000004e0: 6f72 6575 7469 6c73 2069 6d70 6f72 7420  oreutils import 
+000004f0: 2820 0d0a 2020 2020 6d61 6b65 436f 6f72  ( ..    makeCoor
+00000500: 6473 2c20 0d0a 2020 2020 290d 0a66 726f  ds, ..    )..fro
+00000510: 6d20 2e2e 7072 6f70 6572 7479 2069 6d70  m ..property imp
+00000520: 6f72 7420 280d 0a20 2020 2049 7345 6469  ort (..    IsEdi
+00000530: 0d0a 2020 2020 290d 0a66 726f 6d20 2e2e  ..    )..from ..
+00000540: 7369 7465 2069 6d70 6f72 7420 4c6f 6361  site import Loca
+00000550: 7469 6f6e 200d 0a66 726f 6d20 2e2e 5f74  tion ..from .._t
+00000560: 7970 696e 6720 696d 706f 7274 2028 200d  yping import ( .
+00000570: 0a20 2020 2041 7272 6179 4c69 6b65 2c20  .    ArrayLike, 
+00000580: 0d0a 2020 2020 4f70 7469 6f6e 616c 2c20  ..    Optional, 
+00000590: 0d0a 2020 2020 4c69 7374 2c0d 0a20 2020  ..    List,..   
+000005a0: 2054 7570 6c65 2c20 0d0a 2020 2020 4469   Tuple, ..    Di
+000005b0: 6374 2c20 0d0a 2020 2020 4e44 4172 7261  ct, ..    NDArra
+000005c0: 792c 200d 0a20 2020 2044 5479 7065 2c0d  y, ..    DType,.
+000005d0: 0a20 2020 2045 4449 4f2c 0d0a 2020 2020  .    EDIO,..    
+000005e0: 5a4f 2c20 0d0a 2020 2020 542c 0d0a 2020  ZO, ..    T,..  
+000005f0: 2020 462c 200d 0a20 2020 2029 0d0a 6672    F, ..    )..fr
+00000600: 6f6d 202e 2e75 7469 6c73 2e5f 6465 7065  om ..utils._depe
+00000610: 6e64 656e 6379 2069 6d70 6f72 7420 2820  ndency import ( 
+00000620: 0d0a 2020 2020 696d 706f 7274 5f6f 7074  ..    import_opt
+00000630: 696f 6e61 6c5f 6465 7065 6e64 656e 6379  ional_dependency
+00000640: 0d0a 2020 2020 290d 0a66 726f 6d20 2e2e  ..    )..from ..
+00000650: 7574 696c 732e 7661 6c69 6461 746f 7220  utils.validator 
+00000660: 696d 706f 7274 2028 200d 0a20 2020 205f  import ( ..    _
+00000670: 7661 6c69 6461 7465 5f74 656e 736f 722c  validate_tensor,
+00000680: 200d 0a20 2020 205f 6173 7365 7274 5f7a   ..    _assert_z
+00000690: 5f6f 725f 6564 695f 6f62 6a73 0d0a 2020  _or_edi_objs..  
+000006a0: 2020 290d 0a0d 0a5f 6c6f 6767 6572 203d    )...._logger =
+000006b0: 2077 6174 6578 6c6f 672e 6765 745f 7761   watexlog.get_wa
+000006c0: 7465 785f 6c6f 6767 6572 285f 5f6e 616d  tex_logger(__nam
+000006d0: 655f 5f29 0d0a 0d0a 5f5f 616c 6c5f 5f20  e__)....__all__ 
+000006e0: 3d5b 2745 4d27 2c0d 0a20 2020 2020 2020  =['EM',..       
+000006f0: 2020 2027 5072 6f63 6573 7369 6e67 272c     'Processing',
+00000700: 0d0a 2020 2020 2020 2020 2020 275a 4327  ..          'ZC'
+00000710: 2c0d 0a20 2020 2020 2020 2020 205d 0d0a  ,..          ]..
+00000720: 0d0a 636c 6173 7320 454d 2849 7345 6469  ..class EM(IsEdi
+00000730: 293a 200d 0a20 2020 2022 2222 0d0a 2020  ): ..    """..  
+00000740: 2020 4372 6561 7465 2045 4d20 6f62 6a65    Create EM obje
+00000750: 6374 2061 7320 6120 636f 6c6c 6563 7469  ct as a collecti
+00000760: 6f6e 206f 6620 4544 492d 6669 6c65 2e20  on of EDI-file. 
+00000770: 0d0a 2020 2020 0d0a 2020 2020 436f 6c6c  ..    ..    Coll
+00000780: 6563 7420 6564 6966 696c 6573 2061 6e64  ect edifiles and
+00000790: 2063 7265 6174 6520 616e 2045 4d20 6f62   create an EM ob
+000007a0: 6a65 6374 2e20 4974 2073 6574 7320 2074  ject. It sets  t
+000007b0: 6865 2070 726f 7065 7274 6965 7320 6672  he properties fr
+000007c0: 6f6d 200d 0a20 2020 2061 7564 696f 2d6d  om ..    audio-m
+000007d0: 6167 6e65 746f 7465 6c6c 7572 6963 2e20  agnetotelluric. 
+000007e0: 5468 6520 7477 6f28 3229 2063 6f6d 706f  The two(2) compo
+000007f0: 6e65 6e74 7320 5859 2061 6e64 2059 5820  nents XY and YX 
+00000800: 7769 6c6c 2062 6520 7365 7420 616e 6420  will be set and 
+00000810: 0d0a 2020 2020 6361 6c63 756c 6174 6564  ..    calculated
+00000820: 2e43 616e 2072 6561 6420 4d54 2064 6174  .Can read MT dat
+00000830: 6120 696e 7374 6561 642c 2068 6f77 6576  a instead, howev
+00000840: 6572 2074 6865 2066 756c 6c20 6861 6e64  er the full hand
+00000850: 6c69 6e67 2074 7261 6e73 6665 7220 0d0a  ling transfer ..
+00000860: 2020 2020 6675 6e63 7469 6f6e 206c 696b      function lik
+00000870: 6520 5469 7070 6572 2061 6e64 2053 7065  e Tipper and Spe
+00000880: 6374 7261 2020 6973 206e 6f74 2063 6f6d  ctra  is not com
+00000890: 706c 6574 6564 2e20 5573 6520 206f 7468  pleted. Use  oth
+000008a0: 6572 204d 5420 0d0a 2020 2020 736f 6674  er MT ..    soft
+000008b0: 7761 7265 7320 666f 7220 6120 6c6f 6e67  wares for a long
+000008c0: 2070 6572 696f 6473 2064 6174 612e 200d   periods data. .
+000008d0: 0a20 2020 200d 0a20 2020 2050 6172 616d  .    ..    Param
+000008e0: 6574 6572 7320 0d0a 2020 2020 2d2d 2d2d  eters ..    ----
+000008f0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2073  ---------..    s
+00000900: 7572 7665 795f 6e61 6d65 3a20 7374 7220  urvey_name: str 
+00000910: 0d0a 2020 2020 2020 2020 6c6f 6361 7469  ..        locati
+00000920: 6f6e 206e 616d 6520 7768 6572 6520 7468  on name where th
+00000930: 6520 6461 7465 2077 6865 7265 2063 6f6c  e date where col
+00000940: 6c65 6374 6564 202e 2049 6620 7375 7276  lected . If surv
+00000950: 6579 6e61 6d65 2069 7320 4e6f 6e65 2020  eyname is None  
+00000960: 0d0a 2020 2020 2020 2020 6361 6e20 6368  ..        can ch
+00000970: 6563 6820 6f6e 2065 6469 6669 6c65 732e  ech on edifiles.
+00000980: 200d 0a0d 0a20 2020 2041 7474 7269 6275   ....    Attribu
+00000990: 7465 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  tes ..    ------
+000009a0: 2d2d 2d2d 2d0d 0a20 2020 2065 6469 4f62  -----..    ediOb
+000009b0: 6a73 5f3a 2041 7272 6179 2d6c 696b 6520  js_: Array-like 
+000009c0: 6f66 2073 6861 7065 2028 4e2c 2920 0d0a  of shape (N,) ..
+000009d0: 2020 2020 2020 2020 6172 7261 7920 6f66          array of
+000009e0: 2074 6865 2063 6f6c 6c65 6374 696f 6e20   the collection 
+000009f0: 6f66 2065 6469 6669 6c65 7320 7265 6164  of edifiles read
+00000a00: 5f73 7563 6573 7366 756c 6c79 2020 0d0a  _sucessfully  ..
+00000a10: 2020 2020 6461 7461 5f3a 2041 7272 6179      data_: Array
+00000a20: 2d6c 696b 6520 6f66 2073 6861 7065 2028  -like of shape (
+00000a30: 4e2c 2029 200d 0a20 2020 2020 2020 2061  N, ) ..        a
+00000a40: 7272 6179 206f 6620 616c 6c20 6564 6966  rray of all edif
+00000a50: 696c 6573 2066 6565 6420 696e 2074 6865  iles feed in the
+00000a60: 2060 454d 6020 6d6f 6475 6c65 7320 7768   `EM` modules wh
+00000a70: 6174 6576 6572 2073 7563 6573 7375 6666  atever sucessuff
+00000a80: 756c 7920 0d0a 2020 2020 2020 2020 7265  uly ..        re
+00000a90: 6164 206f 7220 6e6f 742e 200d 0a20 2020  ad or not. ..   
+00000aa0: 2065 6469 6e61 6d65 735f 3a20 6172 7261   edinames_: arra
+00000ab0: 792d 6c69 6b65 206f 6620 7368 6170 6520  y-like of shape 
+00000ac0: 284e 2c29 200d 0a20 2020 2020 2020 2061  (N,) ..        a
+00000ad0: 7272 6179 206f 6620 616c 6c20 6564 692d  rray of all edi-
+00000ae0: 6e61 6d65 7320 7375 6365 7373 6675 6c6c  names sucessfull
+00000af0: 7920 7265 6164 200d 0a20 2020 2065 6469  y read ..    edi
+00000b00: 6669 6c65 735f 3a20 6172 7261 7920 6f66  files_: array of
+00000b10: 2073 6861 7065 2028 4e2c 2029 200d 0a20   shape (N, ) .. 
+00000b20: 2020 2020 2020 2061 7272 6179 206f 6620         array of 
+00000b30: 616c 6c20 6564 6966 696c 6573 2069 6620  all edifiles if 
+00000b40: 6769 7665 6e2e 200d 0a20 2020 2066 7265  given. ..    fre
+00000b50: 7173 5f3a 2061 7272 6179 2d6c 696b 6520  qs_: array-like 
+00000b60: 6f66 2073 6861 7065 2028 4e2c 2029 200d  of shape (N, ) .
+00000b70: 0a20 2020 2020 2020 2041 7272 6179 206f  .        Array o
+00000b80: 6620 7468 6520 6672 6571 7565 6e63 7920  f the frequency 
+00000b90: 7261 6e67 6520 6672 6f6d 2045 4449 7320  range from EDIs 
+00000ba0: 0d0a 2020 2020 7265 6672 6571 5f3a 2066  ..    refreq_: f
+00000bb0: 6c6f 6174 2c20 0d0a 2020 2020 2020 2020  loat, ..        
+00000bc0: 5265 6665 7265 6e63 6520 7265 6672 6571  Reference refreq
+00000bd0: 7565 6e63 7920 666f 7220 6461 7461 2063  uency for data c
+00000be0: 6f72 7265 6374 696f 6e2e 204e 6f74 6520  orrection. Note 
+00000bf0: 7468 6520 7265 6665 7265 6e63 6520 6672  the reference fr
+00000c00: 6571 7565 6e63 790d 0a20 2020 2020 2020  equency..       
+00000c10: 2069 7320 7468 6520 6869 6768 6573 7420   is the highest 
+00000c20: 6672 6571 7565 6e63 7920 7769 7468 2063  frequency with c
+00000c30: 6c65 616e 2064 6174 612e 200d 0a20 2020  lean data. ..   
+00000c40: 2020 2020 200d 0a20 2020 2050 726f 7065       ..    Prope
+00000c50: 7274 6965 7320 0d0a 2020 2020 2d2d 2d2d  rties ..    ----
+00000c60: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 0d0a  --------..    ..
+00000c70: 2020 2020 6c6f 6e67 6974 7564 653a 2061      longitude: a
+00000c80: 7272 6179 2d6c 696b 652c 2073 6861 7065  rray-like, shape
+00000c90: 2028 4e2c 2920 0d0a 2020 2020 2020 2020   (N,) ..        
+00000ca0: 6c6f 6e67 6974 7564 6520 636f 6f72 6469  longitude coordi
+00000cb0: 6e61 7465 2076 616c 7565 7320 2063 6f6c  nate values  col
+00000cc0: 6c65 6374 6564 2066 726f 6d20 4544 4973  lected from EDIs
+00000cd0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00000ce0: 206c 6174 6974 7564 653a 2061 7272 6179   latitude: array
+00000cf0: 2d6c 696b 652c 2073 6861 7065 2028 4e2c  -like, shape (N,
+00000d00: 2029 0d0a 2020 2020 2020 2020 4c61 7469   )..        Lati
+00000d10: 7475 6465 2063 6f6f 7264 696e 6174 6520  tude coordinate 
+00000d20: 7661 6c75 6573 2063 6f6c 6c65 6374 6564  values collected
+00000d30: 2066 726f 6d20 4544 4973 200d 0a20 2020   from EDIs ..   
+00000d40: 2020 2020 200d 0a20 2020 2065 6c65 7661       ..    eleva
+00000d50: 7469 6f6e 3a20 6172 7261 792d 6c69 6b65  tion: array-like
+00000d60: 2c20 7368 6170 6520 284e 2c29 200d 0a20  , shape (N,) .. 
+00000d70: 2020 2020 2020 2045 6c65 7661 7469 6f6e         Elevation
+00000d80: 2063 6f6f 7264 696e 6174 6573 2063 6f6c   coordinates col
+00000d90: 6c65 6374 6564 2066 726f 6d20 4544 4973  lected from EDIs
+00000da0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00000db0: 2022 2222 0d0a 0d0a 2020 2020 6465 6620   """....    def 
+00000dc0: 5f5f 696e 6974 5f5f 2873 656c 662c 2073  __init__(self, s
+00000dd0: 7572 7665 795f 6e61 6d65 3a73 7472 2020  urvey_name:str  
+00000de0: 3d4e 6f6e 6520 2c20 7665 7262 6f73 653d  =None , verbose=
+00000df0: 3029 3a20 0d0a 2020 2020 2020 2020 7365  0): ..        se
+00000e00: 6c66 2e5f 6c6f 6767 696e 6720 3d20 7761  lf._logging = wa
+00000e10: 7465 786c 6f67 2e67 6574 5f77 6174 6578  texlog.get_watex
+00000e20: 5f6c 6f67 6765 7228 7365 6c66 2e5f 5f63  _logger(self.__c
+00000e30: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f29  lass__.__name__)
+00000e40: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
+00000e50: 7365 6c66 2e73 7572 7665 795f 6e61 6d65  self.survey_name
+00000e60: 203d 7375 7276 6579 5f6e 616d 650d 0a20   =survey_name.. 
+00000e70: 2020 2020 2020 2073 656c 662e 4c6f 6361         self.Loca
+00000e80: 7469 6f6e 5f3d 204c 6f63 6174 696f 6e28  tion_= Location(
+00000e90: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00000ea0: 7665 7262 6f73 653d 7665 7262 6f73 650d  verbose=verbose.
+00000eb0: 0a20 2020 2020 2020 2073 656c 662e 5f6c  .        self._l
+00000ec0: 6174 6974 7564 6520 3d20 4e6f 6e65 0d0a  atitude = None..
+00000ed0: 2020 2020 2020 2020 7365 6c66 2e5f 6c6f          self._lo
+00000ee0: 6e67 6974 7564 653d 4e6f 6e65 0d0a 2020  ngitude=None..  
+00000ef0: 2020 2020 2020 7365 6c66 2e5f 656c 6576        self._elev
+00000f00: 6174 696f 6e3d 204e 6f6e 6520 0d0a 0d0a  ation= None ....
+00000f10: 2020 2020 4070 726f 7065 7274 7920 0d0a      @property ..
+00000f20: 2020 2020 6465 6620 6c61 7469 7475 6465      def latitude
+00000f30: 2873 656c 6629 3a20 0d0a 2020 2020 2020  (self): ..      
+00000f40: 2020 7265 7475 726e 2073 656c 662e 5f6c    return self._l
+00000f50: 6174 6974 7564 6520 0d0a 0d0a 2020 2020  atitude ....    
+00000f60: 406c 6174 6974 7564 652e 7365 7474 6572  @latitude.setter
+00000f70: 200d 0a20 2020 2064 6566 206c 6174 6974   ..    def latit
+00000f80: 7564 6528 7365 6c66 2c20 6c61 7469 7475  ude(self, latitu
+00000f90: 6465 293a 0d0a 2020 2020 2020 2020 7365  de):..        se
+00000fa0: 6c66 2e5f 6173 7365 7274 6174 7472 2028  lf._assertattr (
+00000fb0: 2027 6c61 7469 7475 6465 272c 206c 6174   'latitude', lat
+00000fc0: 6974 7564 652c 0d0a 2020 2020 2020 2020  itude,..        
+00000fd0: 2020 2020 7365 6c66 2e4c 6f63 6174 696f      self.Locatio
+00000fe0: 6e5f 2e6c 6174 0d0a 2020 2020 2020 2020  n_.lat..        
+00000ff0: 2020 2020 290d 0a0d 0a20 2020 2040 7072      )....    @pr
+00001000: 6f70 6572 7479 200d 0a20 2020 2064 6566  operty ..    def
+00001010: 206c 6f6e 6769 7475 6465 2873 656c 6629   longitude(self)
+00001020: 3a20 0d0a 2020 2020 2020 2020 7265 7475  : ..        retu
+00001030: 726e 2073 656c 662e 5f6c 6f6e 6769 7475  rn self._longitu
+00001040: 6465 200d 0a20 2020 200d 0a20 2020 2040  de ..    ..    @
+00001050: 6c6f 6e67 6974 7564 652e 7365 7474 6572  longitude.setter
+00001060: 200d 0a20 2020 2064 6566 206c 6f6e 6769   ..    def longi
+00001070: 7475 6465 2873 656c 662c 206c 6f6e 6769  tude(self, longi
+00001080: 7475 6465 293a 0d0a 2020 2020 2020 2020  tude):..        
+00001090: 7365 6c66 2e5f 6173 7365 7274 6174 7472  self._assertattr
+000010a0: 2028 2027 6c6f 6e67 6974 7564 6527 2c20   ( 'longitude', 
+000010b0: 6c6f 6e67 6974 7564 652c 0d0a 2020 2020  longitude,..    
+000010c0: 2020 2020 2020 2020 7365 6c66 2e4c 6f63          self.Loc
+000010d0: 6174 696f 6e5f 2e6c 6f6e 200d 0a20 2020  ation_.lon ..   
+000010e0: 2020 2020 2020 2020 2029 0d0a 0d0a 2020           )....  
+000010f0: 2020 4070 726f 7065 7274 7920 0d0a 2020    @property ..  
+00001100: 2020 6465 6620 656c 6576 6174 696f 6e28    def elevation(
+00001110: 7365 6c66 293a 200d 0a20 2020 2020 2020  self): ..       
+00001120: 2072 6574 7572 6e20 7365 6c66 2e5f 656c   return self._el
+00001130: 6576 6174 696f 6e20 0d0a 2020 2020 0d0a  evation ..    ..
+00001140: 2020 2020 4065 6c65 7661 7469 6f6e 2e73      @elevation.s
+00001150: 6574 7465 7220 0d0a 2020 2020 6465 6620  etter ..    def 
+00001160: 656c 6576 6174 696f 6e28 7365 6c66 2c20  elevation(self, 
+00001170: 656c 6576 6174 696f 6e29 3a0d 0a20 2020  elevation):..   
+00001180: 2020 2020 2073 656c 662e 5f61 7373 6572       self._asser
+00001190: 7461 7474 7220 2827 656c 6576 6174 696f  tattr ('elevatio
+000011a0: 6e27 2c20 656c 6576 6174 696f 6e2c 0d0a  n', elevation,..
+000011b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000011c0: 2e4c 6f63 6174 696f 6e5f 2e65 6c65 7620  .Location_.elev 
+000011d0: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
+000011e0: 0a20 2020 2020 2020 200d 0a20 2020 2040  .        ..    @
+000011f0: 7072 6f70 6572 7479 200d 0a20 2020 2064  property ..    d
+00001200: 6566 2073 746e 616d 6573 2873 656c 6629  ef stnames(self)
+00001210: 3a0d 0a20 2020 2020 2020 2072 6574 7572  :..        retur
+00001220: 6e20 7365 6c66 2e5f 7374 6174 696f 6e5f  n self._station_
+00001230: 6e61 6d65 730d 0a20 2020 2040 7374 6e61  names..    @stna
+00001240: 6d65 732e 7365 7474 6572 200d 0a20 2020  mes.setter ..   
+00001250: 2064 6566 2073 746e 616d 6573 2028 7365   def stnames (se
+00001260: 6c66 2c20 6564 695f 7374 6174 696f 6e73  lf, edi_stations
+00001270: 293a 0d0a 2020 2020 2020 2020 7472 7920  ):..        try 
+00001280: 3a20 5f61 7373 6572 745f 616c 6c5f 7479  : _assert_all_ty
+00001290: 7065 7328 6564 695f 7374 6174 696f 6e73  pes(edi_stations
+000012a0: 2c20 6c69 7374 2c0d 0a20 2020 2020 2020  , list,..       
 000012b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000012c0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-000012d0: 7570 6c65 2c20 6e70 2e6e 6461 7272 6179  uple, np.ndarray
-000012e0: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
-000012f0: 7420 3a20 7365 6c66 2e5f 7374 6174 696f  t : self._statio
-00001300: 6e5f 6e61 6d65 7320 3d20 7365 6c66 2e69  n_names = self.i
-00001310: 645f 200d 0a20 2020 2020 2020 2065 6c73  d_ ..        els
-00001320: 6520 3a20 7365 6c66 2e5f 7374 6174 696f  e : self._statio
-00001330: 6e5f 6e61 6d65 7320 3d20 6c69 7374 280d  n_names = list(.
-00001340: 0a20 2020 2020 2020 2020 2020 206d 6170  .            map
-00001350: 286c 616d 6264 6120 6e3a 206e 2e72 6570  (lambda n: n.rep
-00001360: 6c61 6365 2827 2e65 6469 272c 2027 2729  lace('.edi', '')
-00001370: 2c20 6564 695f 7374 6174 696f 6e73 2929  , edi_stations))
-00001380: 0d0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
-00001390: 2873 6574 2028 7365 6c66 2e5f 7374 6174  (set (self._stat
-000013a0: 696f 6e5f 6e61 6d65 7329 2920 3d3d 3120  ion_names)) ==1 
-000013b0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-000013c0: 7365 6c66 2e5f 7374 6174 696f 6e5f 6e61  self._station_na
-000013d0: 6d65 7320 3d20 7365 6c66 2e69 6420 0d0a  mes = self.id ..
-000013e0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-000013f0: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-00001400: 662e 5f73 7461 7469 6f6e 5f6e 616d 6573  f._station_names
-00001410: 2920 213d 206c 656e 2873 656c 662e 6564  ) != len(self.ed
-00001420: 694f 626a 735f 293a 200d 0a20 2020 2020  iObjs_): ..     
-00001430: 2020 2020 2020 2073 656c 662e 5f73 7461         self._sta
-00001440: 7469 6f6e 5f6e 616d 6573 203d 2073 656c  tion_names = sel
-00001450: 662e 6964 2020 0d0a 2020 2020 0d0a 2020  f.id  ..    ..  
-00001460: 2020 6465 6620 6973 5f76 616c 6964 2028    def is_valid (
-00001470: 7365 6c66 2c20 0d0a 2020 2020 2020 2020  self, ..        
-00001480: 6f62 6a3a 2073 7472 207c 2045 4449 4f20  obj: str | EDIO 
-00001490: 0d0a 2020 2020 2020 2020 292d 3e20 4564  ..        )-> Ed
-000014a0: 6920 203a 200d 0a20 2020 2020 2020 2022  i  : ..        "
-000014b0: 2222 4173 7365 7274 2074 6861 7420 7468  ""Assert that th
-000014c0: 6520 6769 7665 6e20 6172 6775 6d65 6e74  e given argument
-000014d0: 2069 7320 616e 2045 4449 202d 6f62 6a65   is an EDI -obje
-000014e0: 6374 2066 726f 6d20 6d6f 6475 6c65 7320  ct from modules 
-000014f0: 0d0a 2020 2020 2020 2020 4544 4920 6f72  ..        EDI or
-00001500: 2045 4449 2066 726f 6d20 7079 6373 616d   EDI from pycsam
-00001510: 7420 616e 6420 4d54 7079 2070 6163 6b61  t and MTpy packa
-00001520: 6765 732e 200d 0a20 2020 2020 2020 2041  ges. ..        A
-00001530: 2054 7970 6545 7272 6f72 2077 696c 6c20   TypeError will 
-00001540: 6f63 6375 7273 206f 7468 6572 7769 7365  occurs otherwise
-00001550: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-00001560: 2020 2020 2050 6172 616d 6574 6572 7320       Parameters 
-00001570: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00001580: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00001590: 6f62 6a3a 2073 7472 2c20 3a63 6c61 7373  obj: str, :class
-000015a0: 3a60 7079 6373 616d 742e 636f 7265 2e65  :`pycsamt.core.e
-000015b0: 6469 2e45 6469 6020 6f72 203a 636c 6173  di.Edi` or :clas
-000015c0: 733a 606d 7470 792e 636f 7265 2e65 6469  s:`mtpy.core.edi
-000015d0: 2e45 6469 6020 0d0a 2020 2020 2020 2020  .Edi` ..        
-000015e0: 2020 2020 4675 6c6c 2070 6174 6820 4544      Full path ED
-000015f0: 4920 6669 6c65 206f 7220 6070 7963 7361  I file or `pycsa
-00001600: 6d74 605f 206f 7220 604d 5470 7960 5f20  mt`_ or `MTpy`_ 
-00001610: 6f62 6a65 6374 732e 0d0a 2020 2020 2020  objects...      
-00001620: 200d 0a20 2020 2020 2020 2052 6574 7572   ..        Retur
-00001630: 6e0d 0a20 2020 2020 2020 202d 2d2d 2d2d  n..        -----
-00001640: 2d2d 0d0a 2020 2020 2020 2020 6f62 6a3a  --..        obj:
-00001650: 7374 722c 203a 636c 6173 733a 6070 7963  str, :class:`pyc
-00001660: 7361 6d74 2e63 6f72 652e 6564 692e 4564  samt.core.edi.Ed
-00001670: 6960 206f 7220 3a63 6c61 7373 3a60 6d74  i` or :class:`mt
-00001680: 7079 2e63 6f72 652e 6564 692e 4564 6960  py.core.edi.Edi`
-00001690: 0d0a 2020 2020 2020 2020 2020 2020 4964  ..            Id
-000016a0: 656e 7469 6361 6c20 6f62 6a65 6374 2061  entical object a
-000016b0: 6674 6572 2061 7373 6572 7469 6e67 2e0d  fter asserting..
-000016c0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-000016d0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-000016e0: 656d 7367 3d28 227b 3021 727d 206f 626a  emsg=("{0!r} obj
-000016f0: 6563 7420 6465 7465 6374 6564 2077 6869  ect detected whi
-00001700: 6c65 2074 6865 2070 6163 6b61 6765 2069  le the package i
-00001710: 7320 6e6f 7420 696e 7374 616c 6c65 6422  s not installed"
-00001720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00001730: 2220 7965 742e 2054 6f20 7061 7373 205b  " yet. To pass [
-00001740: 2770 7963 7361 6d74 2720 7c20 276d 7470  'pycsamt' | 'mtp
-00001750: 7927 5d20 4544 492d 6f62 6a65 6374 2074  y'] EDI-object t
-00001760: 6f20 2745 4d27 220d 0a20 2020 2020 2020  o 'EM'"..       
-00001770: 2020 2020 2020 2022 2063 6c61 7373 2066         " class f
-00001780: 6f72 2062 6173 6963 2069 6d70 6c65 6d65  or basic impleme
-00001790: 6e74 6174 696f 6e2c 7072 696f 7220 696e  ntation,prior in
-000017a0: 7374 616c 6c20 7468 6520 7b30 2172 7d22  stall the {0!r}"
-000017b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000017c0: 2220 6669 7273 742e 2055 7365 2027 7069  " first. Use 'pi
-000017d0: 7027 206f 7220 2763 6f6e 6461 2720 666f  p' or 'conda' fo
-000017e0: 7220 696e 7374 616c 6c61 7469 6f6e 2e22  r installation."
-000017f0: 0d0a 2020 2020 2020 2020 2020 2020 2029  ..             )
-00001800: 0d0a 2020 2020 2020 2020 4973 4564 692e  ..        IsEdi.
-00001810: 7265 6769 7374 6572 2028 4564 6929 0d0a  register (Edi)..
-00001820: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00001830: 7461 6e63 6528 6f62 6a2c 2073 7472 293a  tance(obj, str):
-00001840: 0d0a 2020 2020 2020 2020 2020 2020 6f62  ..            ob
-00001850: 6a20 3d20 4564 6928 292e 6669 7428 6f62  j = Edi().fit(ob
-00001860: 6a29 200d 0a20 2020 0d0a 2020 2020 2020  j) ..   ..      
-00001870: 2020 6966 2022 7079 6373 616d 7422 2069    if "pycsamt" i
-00001880: 6e20 7374 7228 6f62 6a29 3a20 2020 0d0a  n str(obj):   ..
-00001890: 2020 2020 2020 2020 2020 2020 7472 7920              try 
-000018a0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-000018b0: 2020 2020 696d 706f 7274 5f6f 7074 696f      import_optio
-000018c0: 6e61 6c5f 6465 7065 6e64 656e 6379 2028  nal_dependency (
-000018d0: 2270 7963 7361 6d74 2229 0d0a 2020 2020  "pycsamt")..    
-000018e0: 2020 2020 2020 2020 6578 6365 7074 2049          except I
-000018f0: 6d70 6f72 7445 7272 6f72 3a20 0d0a 2020  mportError: ..  
-00001900: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00001910: 6973 6520 546f 704d 6f64 756c 6545 7272  ise TopModuleErr
-00001920: 6f72 2865 6d73 672e 666f 726d 6174 2822  or(emsg.format("
-00001930: 7079 6373 616d 7422 2929 0d0a 2020 2020  pycsamt"))..    
-00001940: 2020 2020 2020 2020 656c 7365 203a 200d          else : .
-00001950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001960: 2023 5858 5820 544f 444f 203a 2070 7269   #XXX TODO : pri
-00001970: 6f72 2072 6576 6973 696e 6720 7468 6520  or revising the 
-00001980: 706b 6720 7374 7275 6374 7572 6520 0d0a  pkg structure ..
-00001990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000019a0: 2320 746f 2070 7963 7361 6d74 2e63 6f72  # to pycsamt.cor
-000019b0: 6520 7369 6e63 6520 6666 2073 7562 7061  e since ff subpa
-000019c0: 636b 6167 6520 646f 6573 0d0a 2020 2020  ckage does..    
-000019d0: 2020 2020 2020 2020 2020 2020 2320 6e6f              # no
-000019e0: 206c 6f6e 6765 7220 6578 6973 7420 696e   longer exist in
-000019f0: 2070 7963 7361 6d74 206e 6577 6573 7420   pycsamt newest 
-00001a00: 7665 7273 696f 6e0d 0a20 2020 2020 2020  version..       
-00001a10: 2020 2020 2020 2020 2066 726f 6d20 7079           from py
-00001a20: 6373 616d 742e 6666 2e63 6f72 6520 696d  csamt.ff.core im
-00001a30: 706f 7274 2065 6469 200d 0a20 2020 2020  port edi ..     
-00001a40: 2020 2020 2020 2020 2020 2049 7345 6469             IsEdi
-00001a50: 2e72 6567 6973 7465 7220 2865 6469 2e45  .register (edi.E
-00001a60: 6469 2029 0d0a 2020 2020 2020 2020 2020  di )..          
-00001a70: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00001a80: 656c 6966 2022 6d74 7079 2220 696e 2073  elif "mtpy" in s
-00001a90: 7472 286f 626a 293a 200d 0a20 2020 2020  tr(obj): ..     
-00001aa0: 2020 2020 2020 2074 7279 203a 200d 0a20         try : .. 
-00001ab0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00001ac0: 6d70 6f72 745f 6f70 7469 6f6e 616c 5f64  mport_optional_d
-00001ad0: 6570 656e 6465 6e63 7920 2822 6d74 7079  ependency ("mtpy
-00001ae0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00001af0: 6578 6365 7074 2049 6d70 6f72 7445 7272  except ImportErr
-00001b00: 6f72 3a20 0d0a 2020 2020 2020 2020 2020  or: ..          
-00001b10: 2020 2020 2020 7261 6973 6520 546f 704d        raise TopM
-00001b20: 6f64 756c 6545 7272 6f72 2865 6d73 672e  oduleError(emsg.
-00001b30: 666f 726d 6174 2822 6d74 7079 2229 290d  format("mtpy")).
-00001b40: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00001b50: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
-00001b60: 2020 2020 2020 6672 6f6d 206d 7470 792e        from mtpy.
-00001b70: 636f 7265 2069 6d70 6f72 7420 6564 690d  core import edi.
-00001b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001b90: 2049 7345 6469 2e72 6567 6973 7465 7220   IsEdi.register 
-00001ba0: 2865 6469 2e45 6469 290d 0a20 2020 2020  (edi.Edi)..     
-00001bb0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00001bc0: 2020 2020 2074 7279 203a 200d 0a20 2020       try : ..   
-00001bd0: 2020 2020 2020 2020 206f 626a 203d 205f           obj = _
-00001be0: 6173 7365 7274 5f61 6c6c 5f74 7970 6573  assert_all_types
-00001bf0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-00001c00: 2020 2020 6f62 6a2c 2049 7345 6469 2c20      obj, IsEdi, 
-00001c10: 6f62 6a6e 616d 653d 2257 726f 6e67 2045  objname="Wrong E
-00001c20: 6469 2d4f 626a 6563 7473 206f 7220 4544  di-Objects or ED
-00001c30: 492d 7061 7468 2c22 290d 0a20 2020 2020  I-path,")..     
-00001c40: 2020 2065 7863 6570 7420 2820 5479 7065     except ( Type
-00001c50: 4572 726f 722c 2041 7474 7269 6275 7465  Error, Attribute
-00001c60: 4572 726f 7229 3a20 0d0a 2020 2020 2020  Error): ..      
-00001c70: 2020 2020 2020 2320 666f 7263 6520 6368        # force ch
-00001c80: 6563 6b69 6e67 2069 6e73 7465 6164 0d0a  ecking instead..
-00001c90: 2020 2020 2020 2020 2020 2020 6f62 6a20              obj 
-00001ca0: 3d20 5f61 7373 6572 745f 616c 6c5f 7479  = _assert_all_ty
-00001cb0: 7065 7320 286f 626a 2c20 4564 692c 206f  pes (obj, Edi, o
-00001cc0: 626a 6e61 6d65 3d22 4544 4922 290d 0a20  bjname="EDI").. 
-00001cd0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00001ce0: 2020 2020 2072 6574 7572 6e20 206f 626a       return  obj
-00001cf0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00001d00: 200d 0a20 2020 2064 6566 205f 6173 7365   ..    def _asse
-00001d10: 7274 6174 7472 2028 7365 6c66 2c20 6e61  rtattr (self, na
-00001d20: 6d65 2c20 7661 6c75 652c 2020 6c6f 6370  me, value,  locp
-00001d30: 726f 7020 293a 200d 0a20 2020 2020 2020  rop ): ..       
-00001d40: 2022 2222 2052 6561 6420 616e 6420 7365   """ Read and se
-00001d50: 7420 6174 7472 6962 7574 6573 2066 726f  t attributes fro
-00001d60: 6d20 6c6f 6361 7469 6f6e 206f 626a 6563  m location objec
-00001d70: 7420 2e20 0d0a 2020 2020 2020 2020 466f  t . ..        Fo
-00001d80: 7220 696e 7374 616e 6365 3a3a 200d 0a20  r instance:: .. 
-00001d90: 2020 2020 2020 2020 2020 203e 3e3e 206e             >>> n
-00001da0: 616d 6520 3d20 276c 6f6e 6769 7475 6465  ame = 'longitude
-00001db0: 272c 6f62 6a65 6374 203d 2073 656c 662e  ',object = self.
-00001dc0: 4c6f 6361 7469 6f6e 2e6c 6f6e 0d0a 2020  Location.lon..  
-00001dd0: 2020 2020 2020 2020 2020 3e3e 3e20 7365            >>> se
-00001de0: 6c66 2e5f 6c6f 6e67 6974 7564 6520 3d20  lf._longitude = 
-00001df0: 6e70 2e61 7272 6179 2028 200d 0a20 2020  np.array ( ..   
-00001e00: 2020 2020 2020 2020 202e 2e2e 2020 2020           ...    
-00001e10: 206c 6973 7420 286d 6170 2028 206c 616d   list (map ( lam
-00001e20: 6264 6120 6f20 3a20 7365 6c66 2e4c 6f63  bda o : self.Loc
-00001e30: 6174 696f 6e2e 6c6f 6e20 2c20 0d0a 2020  ation.lon , ..  
-00001e40: 2020 2020 2020 2020 2020 2e2e 2e20 2020            ...   
-00001e50: 2020 2020 2020 2020 2020 2020 206c 6f6e               lon
-00001e60: 6769 7475 6465 2929 290d 0a20 2020 2020  gitude)))..     
-00001e70: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00001e80: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
-00001e90: 6c75 652c 2028 666c 6f61 742c 2069 6e74  lue, (float, int
-00001ea0: 2929 3a20 0d0a 2020 2020 2020 2020 2020  )): ..          
-00001eb0: 2020 7661 6c75 653d 205b 7661 6c75 655d    value= [value]
-00001ec0: 0d0a 2020 2020 2020 2020 733d 6e70 2e7a  ..        s=np.z
-00001ed0: 6572 6f73 5f6c 696b 6528 7661 6c75 6529  eros_like(value)
-00001ee0: 0d0a 2020 2020 2020 2020 666f 7220 692c  ..        for i,
-00001ef0: 2070 2069 6e20 656e 756d 6572 6174 6528   p in enumerate(
-00001f00: 7661 6c75 6529 3a20 0d0a 2020 2020 2020  value): ..      
-00001f10: 2020 2020 2020 6c6f 6370 726f 7020 3d20        locprop = 
-00001f20: 7020 3b20 735b 695d 203d 206c 6f63 7072  p ; s[i] = locpr
-00001f30: 6f70 200d 0a20 2020 2020 2020 2073 6574  op ..        set
-00001f40: 6174 7472 2873 656c 662c 2066 275f 7b6e  attr(self, f'_{n
-00001f50: 616d 657d 272c 2073 2029 0d0a 2020 2020  ame}', s )..    
-00001f60: 2020 2020 0d0a 2020 2020 4070 726f 7065      ..    @prope
-00001f70: 7274 7920 0d0a 2020 2020 6465 6620 696e  rty ..    def in
-00001f80: 7370 6563 7420 2873 656c 6629 3a20 0d0a  spect (self): ..
-00001f90: 2020 2020 2020 2020 2222 2220 496e 7370          """ Insp
-00001fa0: 6563 7420 6f62 6a65 6374 2077 6865 7468  ect object wheth
-00001fb0: 6572 2069 7320 6669 7474 6564 206f 7220  er is fitted or 
-00001fc0: 6e6f 7422 2222 0d0a 2020 2020 2020 2020  not"""..        
-00001fd0: 6d73 6720 3d20 2820 227b 6f62 6a2e 5f5f  msg = ( "{obj.__
-00001fe0: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
-00001ff0: 7d20 696e 7374 616e 6365 2069 7320 6e6f  } instance is no
-00002000: 7420 6669 7474 6564 2079 6574 2e22 0d0a  t fitted yet."..
-00002010: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00002020: 2043 616c 6c20 2766 6974 2720 7769 7468   Call 'fit' with
-00002030: 2061 7070 726f 7072 6961 7465 2061 7267   appropriate arg
-00002040: 756d 656e 7473 2062 6566 6f72 6520 7573  uments before us
-00002050: 696e 6722 0d0a 2020 2020 2020 2020 2020  ing"..          
-00002060: 2020 2020 2022 2074 6869 7320 6d65 7468       " this meth
-00002070: 6f64 220d 0a20 2020 2020 2020 2020 2020  od"..           
-00002080: 2020 2020 290d 0a20 2020 2020 2020 200d      )..        .
-00002090: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-000020a0: 6861 7361 7474 7220 2873 656c 662c 2027  hasattr (self, '
-000020b0: 6564 694f 626a 735f 2729 3a20 0d0a 2020  ediObjs_'): ..  
-000020c0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000020d0: 4e6f 7446 6974 7465 6445 7272 6f72 286d  NotFittedError(m
-000020e0: 7367 2e66 6f72 6d61 7428 0d0a 2020 2020  sg.format(..    
-000020f0: 2020 2020 2020 2020 2020 2020 6f62 6a3d              obj=
-00002100: 7365 6c66 290d 0a20 2020 2020 2020 2020  self)..         
-00002110: 2020 2029 0d0a 2020 2020 2020 2020 7265     )..        re
-00002120: 7475 726e 2031 200d 0a20 2020 2020 2020  turn 1 ..       
-00002130: 200d 0a20 2020 2064 6566 205f 7265 6164   ..    def _read
-00002140: 5f65 6d6f 2028 7365 6c66 2c20 642c 202f  _emo (self, d, /
-00002150: 2029 3a20 0d0a 2020 2020 2020 2020 2222   ): ..        ""
-00002160: 2220 7265 6164 2c20 6173 7365 7274 2061  " read, assert a
-00002170: 6e64 2045 4449 2070 6172 7365 2064 6174  nd EDI parse dat
-00002180: 612e 200d 0a20 2020 2020 2020 2050 6172  a. ..        Par
-00002190: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-000021a0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-000021b0: 2020 2020 2064 3a20 7374 7269 6e67 2c20       d: string, 
-000021c0: 6c69 7374 200d 0a20 2020 2020 2020 2020  list ..         
-000021d0: 2020 4544 4920 7061 7468 2d6c 696b 6520    EDI path-like 
-000021e0: 6f62 6a65 6374 2077 6865 6e20 7661 6c75  object when valu
-000021f0: 6520 6973 2070 6173 7365 6420 6173 2073  e is passed as s
-00002200: 7472 696e 672e 200d 0a20 2020 2020 2020  tring. ..       
-00002210: 2020 2020 4c69 7374 206f 6620 4544 492d      List of EDI-
-00002220: 6669 6c65 206f 7220 4544 4920 6f62 6a65  file or EDI obje
-00002230: 6374 732e 200d 0a20 2020 2020 2020 2022  cts. ..        "
-00002240: 2222 200d 0a20 2020 2020 2020 200d 0a20  "" ..        .. 
-00002250: 2020 2020 2020 2065 6d73 6720 3d28 2257         emsg =("W
-00002260: 726f 6e67 2045 4449 207b 7d2e 204d 6f72  rong EDI {}. Mor
-00002270: 6520 6465 7461 696c 7320 6162 6f75 7420  e details about 
-00002280: 7468 6520 5345 472d 4544 4920 6361 6e20  the SEG-EDI can 
-00002290: 6265 2066 6f75 6e64 220d 0a20 2020 2020  be found"..     
-000022a0: 2020 2020 2020 2020 2020 2220 696e 203c            " in <
-000022b0: 6874 7470 733a 2f2f 7777 772e 6d74 6e65  https://www.mtne
-000022c0: 742e 696e 666f 2f64 6f63 732f 7365 675f  t.info/docs/seg_
-000022d0: 6d74 5f65 6d61 705f 3139 3837 2e70 6466  mt_emap_1987.pdf
-000022e0: 3e20 220d 0a20 2020 2020 2020 2020 2020  > "..           
-000022f0: 2020 2020 290d 0a20 2020 2020 2020 2074      )..        t
-00002300: 7970 6573 203d 4e6f 6e65 2023 206f 626a  ypes =None # obj
-00002310: 6563 7420 0d0a 2020 2020 2020 2020 7266  ect ..        rf
-00002320: 203d 5b5d 2023 2063 6f75 6e74 206e 756d   =[] # count num
-00002330: 6265 7220 6f66 2072 6561 6469 6e67 2066  ber of reading f
-00002340: 696c 6573 2e0d 0a20 2020 2020 2020 200d  iles...        .
-00002350: 0a20 2020 2020 2020 2023 2077 6865 6e20  .        # when 
-00002360: 6420 6973 2073 7472 3b20 6578 7065 6374  d is str; expect
-00002370: 2074 6f20 6265 2061 2070 6174 6820 6f72   to be a path or
-00002380: 2066 696c 6520 0d0a 2020 2020 2020 2020   file ..        
-00002390: 6966 2069 7369 6e73 7461 6e63 6520 2864  if isinstance (d
-000023a0: 2c20 7374 7229 3a20 0d0a 2020 2020 2020  , str): ..      
-000023b0: 2020 2020 2020 6966 206f 732e 7061 7468        if os.path
-000023c0: 2e69 7366 696c 6520 2864 293a 0d0a 2020  .isfile (d):..  
-000023d0: 2020 2020 2020 2020 2020 2020 2020 7479                ty
-000023e0: 7065 7320 3d20 2765 6627 2320 6564 6966  pes = 'ef'# edif
-000023f0: 696c 6520 0d0a 2020 2020 2020 2020 2020  ile ..          
-00002400: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-00002410: 662e 5f61 7373 6572 745f 6564 6928 642c  f._assert_edi(d,
-00002420: 2046 616c 7365 293a 0d0a 2020 2020 2020   False):..      
-00002430: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00002440: 6973 6520 4544 4945 7272 6f72 2865 6d73  ise EDIError(ems
-00002450: 672e 666f 726d 6174 2827 6669 6c65 2729  g.format('file')
-00002460: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00002470: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00002480: 2020 2020 2020 2020 2072 663d 205b 2064           rf= [ d
-00002490: 205d 200d 0a20 2020 2020 2020 2020 2020   ] ..           
-000024a0: 2020 2020 2023 206e 6f77 2062 7569 6c64       # now build
-000024b0: 2061 6e20 4544 4920 6f62 6a65 6374 2077   an EDI object w
-000024c0: 6974 6820 7661 6c69 6420 4544 490d 0a20  ith valid EDI.. 
-000024d0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-000024e0: 6f73 2e70 6174 682e 6973 6469 7220 2864  os.path.isdir (d
-000024f0: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
-00002500: 2020 2020 2074 7970 6573 3d27 6570 2720       types='ep' 
-00002510: 2365 6469 7061 7468 200d 0a20 2020 2020  #edipath ..     
-00002520: 2020 2020 2020 2020 2020 2023 2063 6f75             # cou
-00002530: 6e74 206e 756d 6265 7220 6f66 2066 696c  nt number of fil
-00002540: 6573 2e20 0d0a 2020 2020 2020 2020 2020  es. ..          
-00002550: 2020 2020 2020 7266 203d 206f 732e 6c69        rf = os.li
-00002560: 7374 6469 7220 2864 2029 2023 2063 6f6c  stdir (d ) # col
-00002570: 6c65 6374 2061 6c6c 2066 696c 6573 2069  lect all files i
-00002580: 6e20 7468 6520 7061 7468 200d 0a20 2020  n the path ..   
-00002590: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-000025a0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000025b0: 203d 2073 6f72 7465 6420 285b 206f 732e   = sorted ([ os.
-000025c0: 7061 7468 2e6a 6f69 6e28 642c 2065 6469  path.join(d, edi
-000025d0: 2029 200d 0a20 2020 2020 2020 2020 2020   ) ..           
-000025e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000025f0: 2020 666f 7220 6564 6920 696e 2072 6620    for edi in rf 
-00002600: 6966 2065 6469 2e65 6e64 7377 6974 6820  if edi.endswith 
-00002610: 2827 2e65 6469 2729 5d29 2020 0d0a 2020  ('.edi')])  ..  
-00002620: 2020 2020 2020 2020 2020 656c 7365 3a20            else: 
-00002630: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00002640: 2020 7261 6973 6520 4544 4945 7272 6f72    raise EDIError
-00002650: 2865 6d73 672e 666f 726d 6174 2827 6f62  (emsg.format('ob
-00002660: 6a65 6374 2729 2920 0d0a 2020 2020 2020  ject')) ..      
-00002670: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00002680: 2020 2020 7365 6c66 2e64 6174 615f 203d      self.data_ =
-00002690: 2069 735f 6974 6572 6162 6c65 2864 2c20   is_iterable(d, 
-000026a0: 6578 636c 7564 655f 7374 7269 6e67 203d  exclude_string =
-000026b0: 5472 7565 202c 2074 7261 6e73 666f 726d  True , transform
-000026c0: 203d 5472 7565 2029 0d0a 2020 2020 2020   =True )..      
-000026d0: 2020 7472 7920 3a0d 0a20 2020 2020 2020    try :..       
-000026e0: 2020 2020 2073 656c 662e 6461 7461 5f3d       self.data_=
-000026f0: 2073 6f72 7465 6428 2073 656c 662e 6461   sorted( self.da
-00002700: 7461 5f29 2023 2073 6f72 7465 6420 6564  ta_) # sorted ed
-00002710: 6920 0d0a 2020 2020 2020 2020 6578 6365  i ..        exce
-00002720: 7074 203a 200d 0a20 2020 2020 2020 2020  pt : ..         
-00002730: 2020 2023 2073 6b69 7020 5479 7065 4572     # skip TypeEr
-00002740: 726f 723a 2027 3c27 206e 6f74 2073 7570  ror: '<' not sup
-00002750: 706f 7274 6564 2062 6574 7765 656e 2069  ported between i
-00002760: 6e73 7461 6e63 6573 200d 0a20 2020 2020  nstances ..     
-00002770: 2020 2020 2020 2023 206f 6620 2745 6469         # of 'Edi
-00002780: 2720 616e 6420 2745 6469 270d 0a20 2020  ' and 'Edi'..   
-00002790: 2020 2020 2020 2020 2070 6173 7320 0d0a           pass ..
-000027a0: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
-000027b0: 206e 6f74 2074 7970 6573 3a20 7266 203d   not types: rf =
-000027c0: 2073 656c 662e 6461 7461 5f20 2320 6966   self.data_ # if
-000027d0: 2045 4449 2d6f 626a 6563 7473 2061 7265   EDI-objects are
-000027e0: 2073 6574 200d 0a20 2020 2020 2020 200d   set ..        .
-000027f0: 0a20 2020 2020 2020 2023 2072 6561 6420  .        # read 
-00002800: 4544 4920 6f62 6a65 6374 7320 0d0a 2020  EDI objects ..  
-00002810: 2020 2020 2020 7472 793a 200d 0a20 2020        try: ..   
-00002820: 2020 2020 2020 2020 2073 656c 662e 6564           self.ed
-00002830: 694f 626a 735f 203d 206c 6973 7428 6d61  iObjs_ = list(ma
-00002840: 7028 6c61 6d62 6461 206f 3a20 7365 6c66  p(lambda o: self
-00002850: 2e69 735f 7661 6c69 6428 6f29 2c20 7365  .is_valid(o), se
-00002860: 6c66 2e64 6174 615f 2929 2020 0d0a 2020  lf.data_))  ..  
-00002870: 2020 2020 2020 6578 6365 7074 2045 4449        except EDI
-00002880: 4572 726f 723a 200d 0a20 2020 2020 2020  Error: ..       
-00002890: 2020 2020 206f 626a 6e20 3d20 7479 7065       objn = type
-000028a0: 2873 656c 662e 6564 694f 626a 735f 5b30  (self.ediObjs_[0
-000028b0: 5d29 2e5f 5f6e 616d 655f 5f0d 0a20 2020  ]).__name__..   
-000028c0: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
-000028d0: 4d45 7272 6f72 2028 6622 4578 7065 6374  MError (f"Expect
-000028e0: 2061 2063 6f6c 6c65 6374 696f 6e20 6f66   a collection of
-000028f0: 2045 4449 206f 626a 6563 7473 2e20 476f   EDI objects. Go
-00002900: 7420 7b6f 626a 6e21 727d 2229 200d 0a20  t {objn!r}") .. 
-00002910: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00002920: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
-00002930: 3a0d 0a20 2020 2020 2020 2020 2020 2074  :..            t
-00002940: 7279 3a73 686f 775f 7374 6174 7328 7266  ry:show_stats(rf
-00002950: 2c20 7365 6c66 2e65 6469 4f62 6a73 5f29  , self.ediObjs_)
-00002960: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
-00002970: 6365 7074 3a20 7061 7373 200d 0a20 2020  cept: pass ..   
-00002980: 2020 2020 200d 0a0d 0a20 2020 2064 6566       ....    def
-00002990: 205f 6765 745f 7465 6e73 6f72 5f61 6e64   _get_tensor_and
-000029a0: 5f65 7272 5f76 616c 7565 7320 2873 656c  _err_values (sel
-000029b0: 662c 2061 7474 7220 293a 200d 0a20 2020  f, attr ): ..   
-000029c0: 2020 2020 2022 2222 2047 6574 2074 656e       """ Get ten
-000029d0: 736f 7220 7769 7468 2065 7272 6f72 2061  sor with error a
-000029e0: 6e64 2070 7574 2069 6e20 6469 6374 696f  nd put in dictio
-000029f0: 6e6e 6172 7920 0d0a 2020 2020 2020 2020  nnary ..        
-00002a00: 6f66 2073 7461 7469 6f6e 2f74 656e 736f  of station/tenso
-00002a10: 7220 7661 6c75 6573 2e0d 0a20 2020 2020  r values...     
-00002a20: 2020 200d 0a20 2020 2020 2020 203a 7061     ..        :pa
-00002a30: 7261 6d20 6174 7472 3a20 6174 7472 6962  ram attr: attrib
-00002a40: 7574 6520 6672 6f6d 205a 206f 626a 6563  ute from Z objec
-00002a50: 7473 2e0d 0a20 2020 2020 2020 203a 7265  ts...        :re
-00002a60: 7475 726e 3a20 4120 3344 2074 656e 736f  turn: A 3D tenso
-00002a70: 7220 286e 6672 6571 2c20 322c 2032 2920  r (nfreq, 2, 2) 
-00002a80: 616e 6420 7465 6e73 6f72 2061 7420 6561  and tensor at ea
-00002a90: 6368 2073 7461 7469 6f6e 2e20 200d 0a20  ch station.  .. 
-00002aa0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
-00002ab0: 200d 0a20 2020 2020 2020 2020 2020 203e   ..            >
-00002ac0: 3e3e 2069 6d70 6f72 7420 7761 7465 7820  >> import watex 
-00002ad0: 0d0a 2020 2020 2020 2020 2020 2020 3e3e  ..            >>
-00002ae0: 3e20 7465 7374 5f65 6469 3d20 7761 7465  > test_edi= wate
-00002af0: 782e 6461 7461 7365 7473 2e6c 6f61 645f  x.datasets.load_
-00002b00: 6564 6973 2028 0d0a 2020 2020 2020 2020  edis (..        
-00002b10: 2020 2020 2020 2020 7361 6d70 6c65 7320          samples 
-00002b20: 3d32 202c 2072 6574 7572 6e5f 6461 7461  =2 , return_data
-00002b30: 203d 5472 7565 2029 200d 0a20 2020 2020   =True ) ..     
-00002b40: 2020 2020 2020 203e 3e3e 2065 7420 3d20         >>> et = 
-00002b50: 7761 7465 782e 454d 2829 2e66 6974 2874  watex.EM().fit(t
-00002b60: 6573 745f 6564 6920 290d 0a20 2020 2020  est_edi )..     
-00002b70: 2020 2020 2020 203e 3e3e 2065 742e 5f67         >>> et._g
-00002b80: 6574 5f74 656e 736f 725f 616e 645f 6572  et_tensor_and_er
-00002b90: 725f 7661 6c75 6573 2028 277a 2729 0d0a  r_values ('z')..
-00002ba0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00002bb0: 2020 2020 2073 656c 662e 696e 7370 6563       self.inspec
-00002bc0: 7420 0d0a 2020 2020 2020 2020 2320 2d2d  t ..        # --
-00002bd0: 2d3e 2067 6574 2069 6d70 6564 616e 6365  -> get impedance
-00002be0: 732c 2070 6861 7365 2074 656e 736f 7220  s, phase tensor 
-00002bf0: 616e 640d 0a20 2020 2020 2020 2023 2072  and..        # r
-00002c00: 6573 6973 7469 7669 7469 6573 2076 616c  esistivities val
-00002c10: 7565 7320 666f 726d 2065 6469 6f62 6a65  ues form ediobje
-00002c20: 6374 0d0a 2020 2020 2020 2020 7365 6c66  ct..        self
-00002c30: 2e5f 6c6f 6767 696e 672e 696e 666f 2827  ._logging.info('
-00002c40: 5365 7474 696e 6720 696d 7065 6461 6e63  Setting impedanc
-00002c50: 6573 2061 6e64 2070 6861 7365 7320 7465  es and phases te
-00002c60: 6e73 6f72 7320 616e 6427 0d0a 2020 2020  nsors and'..    
+000012c0: 2020 2020 2020 2020 2074 7570 6c65 2c20           tuple, 
+000012d0: 6e70 2e6e 6461 7272 6179 290d 0a20 2020  np.ndarray)..   
+000012e0: 2020 2020 2065 7863 6570 7420 3a20 7365       except : se
+000012f0: 6c66 2e5f 7374 6174 696f 6e5f 6e61 6d65  lf._station_name
+00001300: 7320 3d20 7365 6c66 2e69 645f 200d 0a20  s = self.id_ .. 
+00001310: 2020 2020 2020 2065 6c73 6520 3a20 7365         else : se
+00001320: 6c66 2e5f 7374 6174 696f 6e5f 6e61 6d65  lf._station_name
+00001330: 7320 3d20 6c69 7374 280d 0a20 2020 2020  s = list(..     
+00001340: 2020 2020 2020 206d 6170 286c 616d 6264         map(lambd
+00001350: 6120 6e3a 206e 2e72 6570 6c61 6365 2827  a n: n.replace('
+00001360: 2e65 6469 272c 2027 2729 2c20 6564 695f  .edi', ''), edi_
+00001370: 7374 6174 696f 6e73 2929 0d0a 2020 2020  stations))..    
+00001380: 2020 2020 6966 206c 656e 2873 6574 2028      if len(set (
+00001390: 7365 6c66 2e5f 7374 6174 696f 6e5f 6e61  self._station_na
+000013a0: 6d65 7329 2920 3d3d 3120 3a20 0d0a 2020  mes)) ==1 : ..  
+000013b0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000013c0: 7374 6174 696f 6e5f 6e61 6d65 7320 3d20  station_names = 
+000013d0: 7365 6c66 2e69 6420 0d0a 2020 2020 2020  self.id ..      
+000013e0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000013f0: 6966 206c 656e 2873 656c 662e 5f73 7461  if len(self._sta
+00001400: 7469 6f6e 5f6e 616d 6573 2920 213d 206c  tion_names) != l
+00001410: 656e 2873 656c 662e 6564 694f 626a 735f  en(self.ediObjs_
+00001420: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
+00001430: 2073 656c 662e 5f73 7461 7469 6f6e 5f6e   self._station_n
+00001440: 616d 6573 203d 2073 656c 662e 6964 2020  ames = self.id  
+00001450: 0d0a 2020 2020 0d0a 2020 2020 6465 6620  ..    ..    def 
+00001460: 6973 5f76 616c 6964 2028 7365 6c66 2c20  is_valid (self, 
+00001470: 0d0a 2020 2020 2020 2020 6f62 6a3a 2073  ..        obj: s
+00001480: 7472 207c 2045 4449 4f20 0d0a 2020 2020  tr | EDIO ..    
+00001490: 2020 2020 292d 3e20 4564 6920 203a 200d      )-> Edi  : .
+000014a0: 0a20 2020 2020 2020 2022 2222 4173 7365  .        """Asse
+000014b0: 7274 2074 6861 7420 7468 6520 6769 7665  rt that the give
+000014c0: 6e20 6172 6775 6d65 6e74 2069 7320 616e  n argument is an
+000014d0: 2045 4449 202d 6f62 6a65 6374 2066 726f   EDI -object fro
+000014e0: 6d20 6d6f 6475 6c65 7320 0d0a 2020 2020  m modules ..    
+000014f0: 2020 2020 4544 4920 6f72 2045 4449 2066      EDI or EDI f
+00001500: 726f 6d20 7079 6373 616d 7420 616e 6420  rom pycsamt and 
+00001510: 4d54 7079 2070 6163 6b61 6765 732e 200d  MTpy packages. .
+00001520: 0a20 2020 2020 2020 2041 2054 7970 6545  .        A TypeE
+00001530: 7272 6f72 2077 696c 6c20 6f63 6375 7273  rror will occurs
+00001540: 206f 7468 6572 7769 7365 2e0d 0a20 2020   otherwise...   
+00001550: 2020 2020 200d 0a20 2020 2020 2020 2050       ..        P
+00001560: 6172 616d 6574 6572 7320 0d0a 2020 2020  arameters ..    
+00001570: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00001580: 0d0a 2020 2020 2020 2020 6f62 6a3a 2073  ..        obj: s
+00001590: 7472 2c20 3a63 6c61 7373 3a60 7079 6373  tr, :class:`pycs
+000015a0: 616d 742e 636f 7265 2e65 6469 2e45 6469  amt.core.edi.Edi
+000015b0: 6020 6f72 203a 636c 6173 733a 606d 7470  ` or :class:`mtp
+000015c0: 792e 636f 7265 2e65 6469 2e45 6469 6020  y.core.edi.Edi` 
+000015d0: 0d0a 2020 2020 2020 2020 2020 2020 4675  ..            Fu
+000015e0: 6c6c 2070 6174 6820 4544 4920 6669 6c65  ll path EDI file
+000015f0: 206f 7220 6070 7963 7361 6d74 605f 206f   or `pycsamt`_ o
+00001600: 7220 604d 5470 7960 5f20 6f62 6a65 6374  r `MTpy`_ object
+00001610: 732e 0d0a 2020 2020 2020 200d 0a20 2020  s...       ..   
+00001620: 2020 2020 2052 6574 7572 6e0d 0a20 2020       Return..   
+00001630: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+00001640: 2020 2020 2020 6f62 6a3a 7374 722c 203a        obj:str, :
+00001650: 636c 6173 733a 6070 7963 7361 6d74 2e63  class:`pycsamt.c
+00001660: 6f72 652e 6564 692e 4564 6960 206f 7220  ore.edi.Edi` or 
+00001670: 3a63 6c61 7373 3a60 6d74 7079 2e63 6f72  :class:`mtpy.cor
+00001680: 652e 6564 692e 4564 6960 0d0a 2020 2020  e.edi.Edi`..    
+00001690: 2020 2020 2020 2020 4964 656e 7469 6361          Identica
+000016a0: 6c20 6f62 6a65 6374 2061 6674 6572 2061  l object after a
+000016b0: 7373 6572 7469 6e67 2e0d 0a20 2020 2020  sserting...     
+000016c0: 2020 200d 0a20 2020 2020 2020 2022 2222     ..        """
+000016d0: 0d0a 2020 2020 2020 2020 656d 7367 3d28  ..        emsg=(
+000016e0: 227b 3021 727d 206f 626a 6563 7420 6465  "{0!r} object de
+000016f0: 7465 6374 6564 2077 6869 6c65 2074 6865  tected while the
+00001700: 2070 6163 6b61 6765 2069 7320 6e6f 7420   package is not 
+00001710: 696e 7374 616c 6c65 6422 0d0a 2020 2020  installed"..    
+00001720: 2020 2020 2020 2020 2020 2220 7965 742e            " yet.
+00001730: 2054 6f20 7061 7373 205b 2770 7963 7361   To pass ['pycsa
+00001740: 6d74 2720 7c20 276d 7470 7927 5d20 4544  mt' | 'mtpy'] ED
+00001750: 492d 6f62 6a65 6374 2074 6f20 2745 4d27  I-object to 'EM'
+00001760: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+00001770: 2022 2063 6c61 7373 2066 6f72 2062 6173   " class for bas
+00001780: 6963 2069 6d70 6c65 6d65 6e74 6174 696f  ic implementatio
+00001790: 6e2c 7072 696f 7220 696e 7374 616c 6c20  n,prior install 
+000017a0: 7468 6520 7b30 2172 7d22 0d0a 2020 2020  the {0!r}"..    
+000017b0: 2020 2020 2020 2020 2020 2220 6669 7273            " firs
+000017c0: 742e 2055 7365 2027 7069 7027 206f 7220  t. Use 'pip' or 
+000017d0: 2763 6f6e 6461 2720 666f 7220 696e 7374  'conda' for inst
+000017e0: 616c 6c61 7469 6f6e 2e22 0d0a 2020 2020  allation."..    
+000017f0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+00001800: 2020 2020 4973 4564 692e 7265 6769 7374      IsEdi.regist
+00001810: 6572 2028 4564 6929 0d0a 2020 2020 2020  er (Edi)..      
+00001820: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00001830: 6f62 6a2c 2073 7472 293a 0d0a 2020 2020  obj, str):..    
+00001840: 2020 2020 2020 2020 6f62 6a20 3d20 4564          obj = Ed
+00001850: 6928 292e 6669 7428 6f62 6a29 200d 0a20  i().fit(obj) .. 
+00001860: 2020 0d0a 2020 2020 2020 2020 6966 2022    ..        if "
+00001870: 7079 6373 616d 7422 2069 6e20 7374 7228  pycsamt" in str(
+00001880: 6f62 6a29 3a20 2020 0d0a 2020 2020 2020  obj):   ..      
+00001890: 2020 2020 2020 7472 7920 3a20 0d0a 2020        try : ..  
+000018a0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+000018b0: 706f 7274 5f6f 7074 696f 6e61 6c5f 6465  port_optional_de
+000018c0: 7065 6e64 656e 6379 2028 2270 7963 7361  pendency ("pycsa
+000018d0: 6d74 2229 0d0a 2020 2020 2020 2020 2020  mt")..          
+000018e0: 2020 6578 6365 7074 2049 6d70 6f72 7445    except ImportE
+000018f0: 7272 6f72 3a20 0d0a 2020 2020 2020 2020  rror: ..        
+00001900: 2020 2020 2020 2020 7261 6973 6520 546f          raise To
+00001910: 704d 6f64 756c 6545 7272 6f72 2865 6d73  pModuleError(ems
+00001920: 672e 666f 726d 6174 2822 7079 6373 616d  g.format("pycsam
+00001930: 7422 2929 0d0a 2020 2020 2020 2020 2020  t"))..          
+00001940: 2020 656c 7365 203a 200d 0a20 2020 2020    else : ..     
+00001950: 2020 2020 2020 2020 2020 2023 5858 5820             #XXX 
+00001960: 544f 444f 203a 2070 7269 6f72 2072 6576  TODO : prior rev
+00001970: 6973 696e 6720 7468 6520 706b 6720 7374  ising the pkg st
+00001980: 7275 6374 7572 6520 0d0a 2020 2020 2020  ructure ..      
+00001990: 2020 2020 2020 2020 2020 2320 746f 2070            # to p
+000019a0: 7963 7361 6d74 2e63 6f72 6520 7369 6e63  ycsamt.core sinc
+000019b0: 6520 6666 2073 7562 7061 636b 6167 6520  e ff subpackage 
+000019c0: 646f 6573 0d0a 2020 2020 2020 2020 2020  does..          
+000019d0: 2020 2020 2020 2320 6e6f 206c 6f6e 6765        # no longe
+000019e0: 7220 6578 6973 7420 696e 2070 7963 7361  r exist in pycsa
+000019f0: 6d74 206e 6577 6573 7420 7665 7273 696f  mt newest versio
+00001a00: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
+00001a10: 2020 2066 726f 6d20 7079 6373 616d 742e     from pycsamt.
+00001a20: 6666 2e63 6f72 6520 696d 706f 7274 2065  ff.core import e
+00001a30: 6469 200d 0a20 2020 2020 2020 2020 2020  di ..           
+00001a40: 2020 2020 2049 7345 6469 2e72 6567 6973       IsEdi.regis
+00001a50: 7465 7220 2865 6469 2e45 6469 2029 0d0a  ter (edi.Edi )..
+00001a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001a70: 0d0a 2020 2020 2020 2020 656c 6966 2022  ..        elif "
+00001a80: 6d74 7079 2220 696e 2073 7472 286f 626a  mtpy" in str(obj
+00001a90: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
+00001aa0: 2074 7279 203a 200d 0a20 2020 2020 2020   try : ..       
+00001ab0: 2020 2020 2020 2020 2069 6d70 6f72 745f           import_
+00001ac0: 6f70 7469 6f6e 616c 5f64 6570 656e 6465  optional_depende
+00001ad0: 6e63 7920 2822 6d74 7079 2229 0d0a 2020  ncy ("mtpy")..  
+00001ae0: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00001af0: 2049 6d70 6f72 7445 7272 6f72 3a20 0d0a   ImportError: ..
+00001b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001b10: 7261 6973 6520 546f 704d 6f64 756c 6545  raise TopModuleE
+00001b20: 7272 6f72 2865 6d73 672e 666f 726d 6174  rror(emsg.format
+00001b30: 2822 6d74 7079 2229 290d 0a20 2020 2020  ("mtpy"))..     
+00001b40: 2020 2020 2020 2065 6c73 6520 3a20 0d0a         else : ..
+00001b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001b60: 6672 6f6d 206d 7470 792e 636f 7265 2069  from mtpy.core i
+00001b70: 6d70 6f72 7420 6564 690d 0a20 2020 2020  mport edi..     
+00001b80: 2020 2020 2020 2020 2020 2049 7345 6469             IsEdi
+00001b90: 2e72 6567 6973 7465 7220 2865 6469 2e45  .register (edi.E
+00001ba0: 6469 290d 0a20 2020 2020 2020 2020 2020  di)..           
+00001bb0: 2020 2020 200d 0a20 2020 2020 2020 2074       ..        t
+00001bc0: 7279 203a 200d 0a20 2020 2020 2020 2020  ry : ..         
+00001bd0: 2020 206f 626a 203d 205f 6173 7365 7274     obj = _assert
+00001be0: 5f61 6c6c 5f74 7970 6573 2028 0d0a 2020  _all_types (..  
+00001bf0: 2020 2020 2020 2020 2020 2020 2020 6f62                ob
+00001c00: 6a2c 2049 7345 6469 2c20 6f62 6a6e 616d  j, IsEdi, objnam
+00001c10: 653d 2257 726f 6e67 2045 6469 2d4f 626a  e="Wrong Edi-Obj
+00001c20: 6563 7473 206f 7220 4544 492d 7061 7468  ects or EDI-path
+00001c30: 2c22 290d 0a20 2020 2020 2020 2065 7863  ,")..        exc
+00001c40: 6570 7420 2820 5479 7065 4572 726f 722c  ept ( TypeError,
+00001c50: 2041 7474 7269 6275 7465 4572 726f 7229   AttributeError)
+00001c60: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00001c70: 2320 666f 7263 6520 6368 6563 6b69 6e67  # force checking
+00001c80: 2069 6e73 7465 6164 0d0a 2020 2020 2020   instead..      
+00001c90: 2020 2020 2020 6f62 6a20 3d20 5f61 7373        obj = _ass
+00001ca0: 6572 745f 616c 6c5f 7479 7065 7320 286f  ert_all_types (o
+00001cb0: 626a 2c20 4564 692c 206f 626a 6e61 6d65  bj, Edi, objname
+00001cc0: 3d22 4544 4922 290d 0a20 2020 2020 2020  ="EDI")..       
+00001cd0: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
+00001ce0: 6574 7572 6e20 206f 626a 200d 0a20 2020  eturn  obj ..   
+00001cf0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00001d00: 2064 6566 205f 6173 7365 7274 6174 7472   def _assertattr
+00001d10: 2028 7365 6c66 2c20 6e61 6d65 2c20 7661   (self, name, va
+00001d20: 6c75 652c 2020 6c6f 6370 726f 7020 293a  lue,  locprop ):
+00001d30: 200d 0a20 2020 2020 2020 2022 2222 2052   ..        """ R
+00001d40: 6561 6420 616e 6420 7365 7420 6174 7472  ead and set attr
+00001d50: 6962 7574 6573 2066 726f 6d20 6c6f 6361  ibutes from loca
+00001d60: 7469 6f6e 206f 626a 6563 7420 2e20 0d0a  tion object . ..
+00001d70: 2020 2020 2020 2020 466f 7220 696e 7374          For inst
+00001d80: 616e 6365 3a3a 200d 0a20 2020 2020 2020  ance:: ..       
+00001d90: 2020 2020 203e 3e3e 206e 616d 6520 3d20       >>> name = 
+00001da0: 276c 6f6e 6769 7475 6465 272c 6f62 6a65  'longitude',obje
+00001db0: 6374 203d 2073 656c 662e 4c6f 6361 7469  ct = self.Locati
+00001dc0: 6f6e 2e6c 6f6e 0d0a 2020 2020 2020 2020  on.lon..        
+00001dd0: 2020 2020 3e3e 3e20 7365 6c66 2e5f 6c6f      >>> self._lo
+00001de0: 6e67 6974 7564 6520 3d20 6e70 2e61 7272  ngitude = np.arr
+00001df0: 6179 2028 200d 0a20 2020 2020 2020 2020  ay ( ..         
+00001e00: 2020 202e 2e2e 2020 2020 206c 6973 7420     ...     list 
+00001e10: 286d 6170 2028 206c 616d 6264 6120 6f20  (map ( lambda o 
+00001e20: 3a20 7365 6c66 2e4c 6f63 6174 696f 6e2e  : self.Location.
+00001e30: 6c6f 6e20 2c20 0d0a 2020 2020 2020 2020  lon , ..        
+00001e40: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00001e50: 2020 2020 2020 206c 6f6e 6769 7475 6465         longitude
+00001e60: 2929 290d 0a20 2020 2020 2020 2022 2222  )))..        """
+00001e70: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+00001e80: 6e73 7461 6e63 6528 7661 6c75 652c 2028  nstance(value, (
+00001e90: 666c 6f61 742c 2069 6e74 2929 3a20 0d0a  float, int)): ..
+00001ea0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00001eb0: 653d 205b 7661 6c75 655d 0d0a 2020 2020  e= [value]..    
+00001ec0: 2020 2020 733d 6e70 2e7a 6572 6f73 5f6c      s=np.zeros_l
+00001ed0: 696b 6528 7661 6c75 6529 0d0a 2020 2020  ike(value)..    
+00001ee0: 2020 2020 666f 7220 692c 2070 2069 6e20      for i, p in 
+00001ef0: 656e 756d 6572 6174 6528 7661 6c75 6529  enumerate(value)
+00001f00: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00001f10: 6c6f 6370 726f 7020 3d20 7020 3b20 735b  locprop = p ; s[
+00001f20: 695d 203d 206c 6f63 7072 6f70 200d 0a20  i] = locprop .. 
+00001f30: 2020 2020 2020 2073 6574 6174 7472 2873         setattr(s
+00001f40: 656c 662c 2066 275f 7b6e 616d 657d 272c  elf, f'_{name}',
+00001f50: 2073 2029 0d0a 2020 2020 2020 2020 0d0a   s )..        ..
+00001f60: 2020 2020 4070 726f 7065 7274 7920 0d0a      @property ..
+00001f70: 2020 2020 6465 6620 696e 7370 6563 7420      def inspect 
+00001f80: 2873 656c 6629 3a20 0d0a 2020 2020 2020  (self): ..      
+00001f90: 2020 2222 2220 496e 7370 6563 7420 6f62    """ Inspect ob
+00001fa0: 6a65 6374 2077 6865 7468 6572 2069 7320  ject whether is 
+00001fb0: 6669 7474 6564 206f 7220 6e6f 7422 2222  fitted or not"""
+00001fc0: 0d0a 2020 2020 2020 2020 6d73 6720 3d20  ..        msg = 
+00001fd0: 2820 227b 6f62 6a2e 5f5f 636c 6173 735f  ( "{obj.__class_
+00001fe0: 5f2e 5f5f 6e61 6d65 5f5f 7d20 696e 7374  _.__name__} inst
+00001ff0: 616e 6365 2069 7320 6e6f 7420 6669 7474  ance is not fitt
+00002000: 6564 2079 6574 2e22 0d0a 2020 2020 2020  ed yet."..      
+00002010: 2020 2020 2020 2020 2022 2043 616c 6c20           " Call 
+00002020: 2766 6974 2720 7769 7468 2061 7070 726f  'fit' with appro
+00002030: 7072 6961 7465 2061 7267 756d 656e 7473  priate arguments
+00002040: 2062 6566 6f72 6520 7573 696e 6722 0d0a   before using"..
+00002050: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00002060: 2074 6869 7320 6d65 7468 6f64 220d 0a20   this method".. 
+00002070: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+00002080: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00002090: 2020 2069 6620 6e6f 7420 6861 7361 7474     if not hasatt
+000020a0: 7220 2873 656c 662c 2027 6564 694f 626a  r (self, 'ediObj
+000020b0: 735f 2729 3a20 0d0a 2020 2020 2020 2020  s_'): ..        
+000020c0: 2020 2020 7261 6973 6520 4e6f 7446 6974      raise NotFit
+000020d0: 7465 6445 7272 6f72 286d 7367 2e66 6f72  tedError(msg.for
+000020e0: 6d61 7428 0d0a 2020 2020 2020 2020 2020  mat(..          
+000020f0: 2020 2020 2020 6f62 6a3d 7365 6c66 290d        obj=self).
+00002100: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
+00002110: 2020 2020 2020 2020 7265 7475 726e 2031          return 1
+00002120: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00002130: 2064 6566 205f 7265 6164 5f65 6d6f 2028   def _read_emo (
+00002140: 7365 6c66 2c20 642c 202f 2029 3a20 0d0a  self, d, / ): ..
+00002150: 2020 2020 2020 2020 2222 2220 7265 6164          """ read
+00002160: 2c20 6173 7365 7274 2061 6e64 2045 4449  , assert and EDI
+00002170: 2070 6172 7365 2064 6174 612e 200d 0a20   parse data. .. 
+00002180: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00002190: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+000021a0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2064  -----..        d
+000021b0: 3a20 7374 7269 6e67 2c20 6c69 7374 200d  : string, list .
+000021c0: 0a20 2020 2020 2020 2020 2020 4544 4920  .           EDI 
+000021d0: 7061 7468 2d6c 696b 6520 6f62 6a65 6374  path-like object
+000021e0: 2077 6865 6e20 7661 6c75 6520 6973 2070   when value is p
+000021f0: 6173 7365 6420 6173 2073 7472 696e 672e  assed as string.
+00002200: 200d 0a20 2020 2020 2020 2020 2020 4c69   ..           Li
+00002210: 7374 206f 6620 4544 492d 6669 6c65 206f  st of EDI-file o
+00002220: 7220 4544 4920 6f62 6a65 6374 732e 200d  r EDI objects. .
+00002230: 0a20 2020 2020 2020 2022 2222 200d 0a20  .        """ .. 
+00002240: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00002250: 2065 6d73 6720 3d28 2257 726f 6e67 2045   emsg =("Wrong E
+00002260: 4449 207b 7d2e 204d 6f72 6520 6465 7461  DI {}. More deta
+00002270: 696c 7320 6162 6f75 7420 7468 6520 5345  ils about the SE
+00002280: 472d 4544 4920 6361 6e20 6265 2066 6f75  G-EDI can be fou
+00002290: 6e64 220d 0a20 2020 2020 2020 2020 2020  nd"..           
+000022a0: 2020 2020 2220 696e 203c 6874 7470 733a      " in <https:
+000022b0: 2f2f 7777 772e 6d74 6e65 742e 696e 666f  //www.mtnet.info
+000022c0: 2f64 6f63 732f 7365 675f 6d74 5f65 6d61  /docs/seg_mt_ema
+000022d0: 705f 3139 3837 2e70 6466 3e20 220d 0a20  p_1987.pdf> ".. 
+000022e0: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+000022f0: 0a20 2020 2020 2020 2074 7970 6573 203d  .        types =
+00002300: 4e6f 6e65 2023 206f 626a 6563 7420 0d0a  None # object ..
+00002310: 2020 2020 2020 2020 7266 203d 5b5d 2023          rf =[] #
+00002320: 2063 6f75 6e74 206e 756d 6265 7220 6f66   count number of
+00002330: 2072 6561 6469 6e67 2066 696c 6573 2e0d   reading files..
+00002340: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00002350: 2020 2023 2077 6865 6e20 6420 6973 2073     # when d is s
+00002360: 7472 3b20 6578 7065 6374 2074 6f20 6265  tr; expect to be
+00002370: 2061 2070 6174 6820 6f72 2066 696c 6520   a path or file 
+00002380: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+00002390: 6e73 7461 6e63 6520 2864 2c20 7374 7229  nstance (d, str)
+000023a0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+000023b0: 6966 206f 732e 7061 7468 2e69 7366 696c  if os.path.isfil
+000023c0: 6520 2864 293a 0d0a 2020 2020 2020 2020  e (d):..        
+000023d0: 2020 2020 2020 2020 7479 7065 7320 3d20          types = 
+000023e0: 2765 6627 2320 6564 6966 696c 6520 0d0a  'ef'# edifile ..
+000023f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002400: 6966 206e 6f74 2073 656c 662e 5f61 7373  if not self._ass
+00002410: 6572 745f 6564 6928 642c 2046 616c 7365  ert_edi(d, False
+00002420: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00002430: 2020 2020 2020 2020 7261 6973 6520 4544          raise ED
+00002440: 4945 7272 6f72 2865 6d73 672e 666f 726d  IError(emsg.form
+00002450: 6174 2827 6669 6c65 2729 290d 0a20 2020  at('file'))..   
+00002460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002470: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00002480: 2020 2072 663d 205b 2064 205d 200d 0a20     rf= [ d ] .. 
+00002490: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000024a0: 206e 6f77 2062 7569 6c64 2061 6e20 4544   now build an ED
+000024b0: 4920 6f62 6a65 6374 2077 6974 6820 7661  I object with va
+000024c0: 6c69 6420 4544 490d 0a20 2020 2020 2020  lid EDI..       
+000024d0: 2020 2020 2065 6c69 6620 6f73 2e70 6174       elif os.pat
+000024e0: 682e 6973 6469 7220 2864 293a 200d 0a20  h.isdir (d): .. 
+000024f0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00002500: 7970 6573 3d27 6570 2720 2365 6469 7061  ypes='ep' #edipa
+00002510: 7468 200d 0a20 2020 2020 2020 2020 2020  th ..           
+00002520: 2020 2020 2023 2063 6f75 6e74 206e 756d       # count num
+00002530: 6265 7220 6f66 2066 696c 6573 2e20 0d0a  ber of files. ..
+00002540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002550: 7266 203d 206f 732e 6c69 7374 6469 7220  rf = os.listdir 
+00002560: 2864 2029 2023 2063 6f6c 6c65 6374 2061  (d ) # collect a
+00002570: 6c6c 2066 696c 6573 2069 6e20 7468 6520  ll files in the 
+00002580: 7061 7468 200d 0a20 2020 2020 2020 2020  path ..         
+00002590: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000025a0: 2020 2020 2020 2020 2064 203d 2073 6f72           d = sor
+000025b0: 7465 6420 285b 206f 732e 7061 7468 2e6a  ted ([ os.path.j
+000025c0: 6f69 6e28 642c 2065 6469 2029 200d 0a20  oin(d, edi ) .. 
+000025d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000025e0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000025f0: 6564 6920 696e 2072 6620 6966 2065 6469  edi in rf if edi
+00002600: 2e65 6e64 7377 6974 6820 2827 2e65 6469  .endswith ('.edi
+00002610: 2729 5d29 2020 0d0a 2020 2020 2020 2020  ')])  ..        
+00002620: 2020 2020 656c 7365 3a20 0d0a 2020 2020      else: ..    
+00002630: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00002640: 6520 4544 4945 7272 6f72 2865 6d73 672e  e EDIError(emsg.
+00002650: 666f 726d 6174 2827 6f62 6a65 6374 2729  format('object')
+00002660: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
+00002670: 2020 2020 0d0a 2020 2020 2020 2020 7365      ..        se
+00002680: 6c66 2e64 6174 615f 203d 2069 735f 6974  lf.data_ = is_it
+00002690: 6572 6162 6c65 2864 2c20 6578 636c 7564  erable(d, exclud
+000026a0: 655f 7374 7269 6e67 203d 5472 7565 202c  e_string =True ,
+000026b0: 2074 7261 6e73 666f 726d 203d 5472 7565   transform =True
+000026c0: 2029 0d0a 2020 2020 2020 2020 7472 7920   )..        try 
+000026d0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+000026e0: 656c 662e 6461 7461 5f3d 2073 6f72 7465  elf.data_= sorte
+000026f0: 6428 2073 656c 662e 6461 7461 5f29 2023  d( self.data_) #
+00002700: 2073 6f72 7465 6420 6564 6920 0d0a 2020   sorted edi ..  
+00002710: 2020 2020 2020 6578 6365 7074 203a 200d        except : .
+00002720: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
+00002730: 6b69 7020 5479 7065 4572 726f 723a 2027  kip TypeError: '
+00002740: 3c27 206e 6f74 2073 7570 706f 7274 6564  <' not supported
+00002750: 2062 6574 7765 656e 2069 6e73 7461 6e63   between instanc
+00002760: 6573 200d 0a20 2020 2020 2020 2020 2020  es ..           
+00002770: 2023 206f 6620 2745 6469 2720 616e 6420   # of 'Edi' and 
+00002780: 2745 6469 270d 0a20 2020 2020 2020 2020  'Edi'..         
+00002790: 2020 2070 6173 7320 0d0a 2020 2020 0d0a     pass ..    ..
+000027a0: 2020 2020 2020 2020 6966 206e 6f74 2074          if not t
+000027b0: 7970 6573 3a20 7266 203d 2073 656c 662e  ypes: rf = self.
+000027c0: 6461 7461 5f20 2320 6966 2045 4449 2d6f  data_ # if EDI-o
+000027d0: 626a 6563 7473 2061 7265 2073 6574 200d  bjects are set .
+000027e0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+000027f0: 2020 2023 2072 6561 6420 4544 4920 6f62     # read EDI ob
+00002800: 6a65 6374 7320 0d0a 2020 2020 2020 2020  jects ..        
+00002810: 7472 793a 200d 0a20 2020 2020 2020 2020  try: ..         
+00002820: 2020 2073 656c 662e 6564 694f 626a 735f     self.ediObjs_
+00002830: 203d 206c 6973 7428 6d61 7028 6c61 6d62   = list(map(lamb
+00002840: 6461 206f 3a20 7365 6c66 2e69 735f 7661  da o: self.is_va
+00002850: 6c69 6428 6f29 2c20 7365 6c66 2e64 6174  lid(o), self.dat
+00002860: 615f 2929 2020 0d0a 2020 2020 2020 2020  a_))  ..        
+00002870: 6578 6365 7074 2045 4449 4572 726f 723a  except EDIError:
+00002880: 200d 0a20 2020 2020 2020 2020 2020 206f   ..            o
+00002890: 626a 6e20 3d20 7479 7065 2873 656c 662e  bjn = type(self.
+000028a0: 6564 694f 626a 735f 5b30 5d29 2e5f 5f6e  ediObjs_[0]).__n
+000028b0: 616d 655f 5f0d 0a20 2020 2020 2020 2020  ame__..         
+000028c0: 2020 2072 6169 7365 2045 4d45 7272 6f72     raise EMError
+000028d0: 2028 6622 4578 7065 6374 2061 2063 6f6c   (f"Expect a col
+000028e0: 6c65 6374 696f 6e20 6f66 2045 4449 206f  lection of EDI o
+000028f0: 626a 6563 7473 2e20 476f 7420 7b6f 626a  bjects. Got {obj
+00002900: 6e21 727d 2229 200d 0a20 2020 2020 2020  n!r}") ..       
+00002910: 200d 0a20 2020 2020 2020 2069 6620 7365   ..        if se
+00002920: 6c66 2e76 6572 626f 7365 3a0d 0a20 2020  lf.verbose:..   
+00002930: 2020 2020 2020 2020 2074 7279 3a73 686f           try:sho
+00002940: 775f 7374 6174 7328 7266 2c20 7365 6c66  w_stats(rf, self
+00002950: 2e65 6469 4f62 6a73 5f29 0d0a 2020 2020  .ediObjs_)..    
+00002960: 2020 2020 2020 2020 6578 6365 7074 3a20          except: 
+00002970: 7061 7373 200d 0a20 2020 2020 2020 200d  pass ..        .
+00002980: 0a0d 0a20 2020 2064 6566 205f 6765 745f  ...    def _get_
+00002990: 7465 6e73 6f72 5f61 6e64 5f65 7272 5f76  tensor_and_err_v
+000029a0: 616c 7565 7320 2873 656c 662c 2061 7474  alues (self, att
+000029b0: 7220 293a 200d 0a20 2020 2020 2020 2022  r ): ..        "
+000029c0: 2222 2047 6574 2074 656e 736f 7220 7769  "" Get tensor wi
+000029d0: 7468 2065 7272 6f72 2061 6e64 2070 7574  th error and put
+000029e0: 2069 6e20 6469 6374 696f 6e6e 6172 7920   in dictionnary 
+000029f0: 0d0a 2020 2020 2020 2020 6f66 2073 7461  ..        of sta
+00002a00: 7469 6f6e 2f74 656e 736f 7220 7661 6c75  tion/tensor valu
+00002a10: 6573 2e0d 0a20 2020 2020 2020 200d 0a20  es...        .. 
+00002a20: 2020 2020 2020 203a 7061 7261 6d20 6174         :param at
+00002a30: 7472 3a20 6174 7472 6962 7574 6520 6672  tr: attribute fr
+00002a40: 6f6d 205a 206f 626a 6563 7473 2e0d 0a20  om Z objects... 
+00002a50: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+00002a60: 4120 3344 2074 656e 736f 7220 286e 6672  A 3D tensor (nfr
+00002a70: 6571 2c20 322c 2032 2920 616e 6420 7465  eq, 2, 2) and te
+00002a80: 6e73 6f72 2061 7420 6561 6368 2073 7461  nsor at each sta
+00002a90: 7469 6f6e 2e20 200d 0a20 2020 2020 2020  tion.  ..       
+00002aa0: 203a 6578 616d 706c 653a 200d 0a20 2020   :example: ..   
+00002ab0: 2020 2020 2020 2020 203e 3e3e 2069 6d70           >>> imp
+00002ac0: 6f72 7420 7761 7465 7820 0d0a 2020 2020  ort watex ..    
+00002ad0: 2020 2020 2020 2020 3e3e 3e20 7465 7374          >>> test
+00002ae0: 5f65 6469 3d20 7761 7465 782e 6461 7461  _edi= watex.data
+00002af0: 7365 7473 2e6c 6f61 645f 6564 6973 2028  sets.load_edis (
+00002b00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00002b10: 2020 7361 6d70 6c65 7320 3d32 202c 2072    samples =2 , r
+00002b20: 6574 7572 6e5f 6461 7461 203d 5472 7565  eturn_data =True
+00002b30: 2029 200d 0a20 2020 2020 2020 2020 2020   ) ..           
+00002b40: 203e 3e3e 2065 7420 3d20 7761 7465 782e   >>> et = watex.
+00002b50: 454d 2829 2e66 6974 2874 6573 745f 6564  EM().fit(test_ed
+00002b60: 6920 290d 0a20 2020 2020 2020 2020 2020  i )..           
+00002b70: 203e 3e3e 2065 742e 5f67 6574 5f74 656e   >>> et._get_ten
+00002b80: 736f 725f 616e 645f 6572 725f 7661 6c75  sor_and_err_valu
+00002b90: 6573 2028 277a 2729 0d0a 2020 2020 2020  es ('z')..      
+00002ba0: 2020 2222 220d 0a20 2020 2020 2020 2073    """..        s
+00002bb0: 656c 662e 696e 7370 6563 7420 0d0a 2020  elf.inspect ..  
+00002bc0: 2020 2020 2020 2320 2d2d 2d3e 2067 6574        # ---> get
+00002bd0: 2069 6d70 6564 616e 6365 732c 2070 6861   impedances, pha
+00002be0: 7365 2074 656e 736f 7220 616e 640d 0a20  se tensor and.. 
+00002bf0: 2020 2020 2020 2023 2072 6573 6973 7469         # resisti
+00002c00: 7669 7469 6573 2076 616c 7565 7320 666f  vities values fo
+00002c10: 726d 2065 6469 6f62 6a65 6374 0d0a 2020  rm ediobject..  
+00002c20: 2020 2020 2020 7365 6c66 2e5f 6c6f 6767        self._logg
+00002c30: 696e 672e 696e 666f 2827 5365 7474 696e  ing.info('Settin
+00002c40: 6720 696d 7065 6461 6e63 6573 2061 6e64  g impedances and
+00002c50: 2070 6861 7365 7320 7465 6e73 6f72 7320   phases tensors 
+00002c60: 616e 6427 0d0a 2020 2020 2020 2020 2020  and'..          
 00002c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c80: 2020 2020 2020 2027 7265 7369 7374 6976         'resistiv
-00002c90: 6974 7920 7661 6c75 6573 2066 726f 6d20  ity values from 
-00002ca0: 6120 636f 6c6c 6563 7469 6f6e 2065 6469  a collection edi
-00002cb0: 6f62 6a27 290d 0a20 2020 2020 2020 2074  obj')..        t
-00002cc0: 203d 205b 6765 7461 7474 7220 2865 6469   = [getattr (edi
-00002cd0: 5f6f 626a 2e5a 2c20 6174 7472 2029 2066  _obj.Z, attr ) f
-00002ce0: 6f72 2065 6469 5f6f 626a 2069 6e20 7365  or edi_obj in se
-00002cf0: 6c66 2e65 6469 4f62 6a73 5f5d 0d0a 2020  lf.ediObjs_]..  
-00002d00: 2020 2020 2020 2320 7075 7420 616c 6c20        # put all 
-00002d10: 7374 6174 696f 6e20 2820 6b65 7929 202f  station ( key) /
-00002d20: 7661 6c75 6573 2069 6e0d 0a20 2020 2020  values in..     
-00002d30: 2020 2074 6469 6374 203d 207b 6b65 793a     tdict = {key:
-00002d40: 7661 6c75 6520 666f 7220 6b65 7920 2c20  value for key , 
-00002d50: 7661 6c75 6520 696e 207a 6970 2028 7365  value in zip (se
-00002d60: 6c66 2e69 642c 2074 297d 0d0a 2020 2020  lf.id, t)}..    
-00002d70: 2020 2020 0d0a 2020 2020 2020 2020 7265      ..        re
-00002d80: 7475 726e 2074 2c20 7464 6963 740d 0a20  turn t, tdict.. 
-00002d90: 2020 200d 0a20 2020 2064 6566 2066 6974     ..    def fit
-00002da0: 2873 656c 662c 200d 0a20 2020 2020 2020  (self, ..       
-00002db0: 2020 2020 2020 6461 7461 3a20 7374 727c        data: str|
-00002dc0: 4c69 7374 5b45 4449 4f5d 0d0a 2020 2020  List[EDIO]..    
-00002dd0: 2020 2020 2020 2020 2029 2d3e 2245 4d22           )->"EM"
-00002de0: 3a0d 0a20 2020 2020 2020 2022 2222 0d0a  :..        """..
-00002df0: 2020 2020 2020 2020 4173 7365 7274 2061          Assert a
-00002e00: 6e64 206d 616b 6520 454d 206f 626a 6563  nd make EM objec
-00002e10: 7420 6672 6f6d 2061 2063 6f6c 6c65 6374  t from a collect
-00002e20: 696f 6e20 4544 4973 2e20 0d0a 2020 2020  ion EDIs. ..    
-00002e30: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
-00002e40: 7261 6d65 7465 7273 200d 0a20 2020 2020  rameters ..     
-00002e50: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 200d     ----------- .
-00002e60: 0a20 2020 2020 2020 2064 6174 6120 3a20  .        data : 
-00002e70: 7374 722c 206f 7220 6c69 7374 206f 7220  str, or list or 
-00002e80: 3a63 6c61 7373 3a60 7079 6373 616d 742e  :class:`pycsamt.
-00002e90: 636f 7265 2e65 6469 2e45 6469 6020 6f62  core.edi.Edi` ob
-00002ea0: 6a65 6374 200d 0a20 2020 2020 2020 2020  ject ..         
-00002eb0: 2020 2046 756c 6c20 7061 7468 2074 6f20     Full path to 
-00002ec0: 4544 4920 6669 6c65 7320 6f72 2063 6f6c  EDI files or col
-00002ed0: 6c65 6374 696f 6e20 6f66 2045 4449 2d6f  lection of EDI-o
-00002ee0: 626a 6563 7473 200d 0a20 2020 2020 2020  bjects ..       
-00002ef0: 2020 2020 200d 0a20 2020 2020 2020 2052       ..        R
-00002f00: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-00002f10: 2d2d 2d2d 2d2d 2d2d 200d 0a20 2020 2020  -------- ..     
-00002f20: 2020 2073 656c 663a 2045 4d20 6f62 6a65     self: EM obje
-00002f30: 6374 2066 726f 6d20 6120 636f 6c6c 6563  ct from a collec
-00002f40: 7469 6f6e 2045 4449 7320 0d0a 2020 2020  tion EDIs ..    
-00002f50: 2020 2020 0d0a 2020 2020 2020 2020 4578      ..        Ex
-00002f60: 616d 706c 6573 200d 0a20 2020 2020 2020  amples ..       
-00002f70: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020   --------..     
-00002f80: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
-00002f90: 782e 6d65 7468 6f64 732e 656d 2069 6d70  x.methods.em imp
-00002fa0: 6f72 7420 454d 200d 0a20 2020 2020 2020  ort EM ..       
-00002fb0: 203e 3e3e 2065 6d4f 626a 7320 3d20 454d   >>> emObjs = EM
-00002fc0: 2829 2e66 6974 2028 7227 6461 7461 2f65  ().fit (r'data/e
-00002fd0: 6469 7327 290d 0a20 2020 2020 2020 203e  dis')..        >
-00002fe0: 3e3e 2065 6d4f 626a 732e 6564 694f 626a  >> emObjs.ediObj
-00002ff0: 735f 200d 0a20 2020 2020 2020 202e 2e2e  s_ ..        ...
-00003000: 200d 0a0d 0a20 2020 2020 2020 2022 2222   ....        """
-00003010: 0d0a 2020 2020 2020 2020 6465 6620 5f66  ..        def _f
-00003020: 6574 6368 5f68 6561 6469 6e66 6f73 2028  etch_headinfos (
-00003030: 636f 626a 2c20 2061 7474 7229 3a20 0d0a  cobj,  attr): ..
-00003040: 2020 2020 2020 2020 2020 2020 2222 2220              """ 
-00003050: 5365 7420 6174 7472 6962 7574 6520 6061  Set attribute `a
-00003060: 7474 7260 2066 726f 6d20 636f 6c6c 6563  ttr` from collec
-00003070: 7469 6f6e 206f 626a 6563 7420 6063 6f62  tion object `cob
-00003080: 6a60 2e22 2222 0d0a 2020 2020 2020 2020  j`."""..        
-00003090: 2020 2020 7265 7475 726e 206c 6973 7428      return list(
-000030a0: 6d61 7020 286c 616d 6264 6120 6f3a 2067  map (lambda o: g
-000030b0: 6574 6174 7472 286f 2c20 6174 7472 292c  etattr(o, attr),
-000030c0: 2063 6f62 6a29 290d 0a20 2020 0d0a 2020   cobj))..   ..  
-000030d0: 2020 2020 2020 7365 6c66 2e5f 7265 6164        self._read
-000030e0: 5f65 6d6f 2864 6174 6120 2920 0d0a 2020  _emo(data ) ..  
-000030f0: 2020 2020 2020 2320 736f 7274 6564 2065        # sorted e
-00003100: 6469 4f62 6a73 2066 726f 6d20 6c61 746c  diObjs from latl
-00003110: 6f6e 6720 200d 0a20 2020 2020 2020 2073  ong  ..        s
-00003120: 656c 662e 6564 694f 626a 735f 202c 2073  elf.ediObjs_ , s
-00003130: 656c 662e 6564 696e 616d 6573 203d 2066  elf.edinames = f
-00003140: 6974 5f62 795f 6c6c 280d 0a20 2020 2020  it_by_ll(..     
-00003150: 2020 2020 2020 2073 656c 662e 6564 694f         self.ediO
-00003160: 626a 735f 290d 0a20 2020 2020 2020 2023  bjs_)..        #
-00003170: 2072 656f 7267 616e 697a 6520 2065 6469   reorganize  edi
-00003180: 7320 6163 636f 7264 696e 6720 0d0a 2020  s according ..  
-00003190: 2020 2020 2020 2320 746f 206c 6f6e 206c        # to lon l
-000031a0: 6174 206f 7264 6572 2e20 0d0a 2020 2020  at order. ..    
-000031b0: 2020 2020 7365 6c66 2e65 6469 6669 6c65      self.edifile
-000031c0: 7320 3d20 6c69 7374 286d 6170 280d 0a20  s = list(map(.. 
-000031d0: 2020 2020 2020 2020 2020 206c 616d 6264             lambd
-000031e0: 6120 6f3a 206f 2e65 6469 6669 6c65 202c  a o: o.edifile ,
-000031f0: 2073 656c 662e 6564 694f 626a 735f 2929   self.ediObjs_))
-00003200: 0d0a 0d0a 2020 2020 2020 2020 232d 2d67  ....        #--g
-00003210: 6574 2063 6f6f 7264 696e 6174 6573 2076  et coordinates v
-00003220: 616c 7565 7320 0d0a 2020 2020 2020 2020  alues ..        
-00003230: 2320 616e 6420 636f 7272 6563 7420 6c6f  # and correct lo
-00003240: 6e5f 6c61 7420 2d2d 2d0d 0a20 2020 2020  n_lat ---..     
-00003250: 2020 206c 6174 2020 3d20 5f66 6574 6368     lat  = _fetch
-00003260: 5f68 6561 6469 6e66 6f73 280d 0a20 2020  _headinfos(..   
-00003270: 2020 2020 2020 2020 2073 656c 662e 6564           self.ed
-00003280: 694f 626a 735f 2c20 276c 6174 2729 0d0a  iObjs_, 'lat')..
-00003290: 2020 2020 2020 2020 6c6f 6e20 203d 205f          lon  = _
-000032a0: 6665 7463 685f 6865 6164 696e 666f 7328  fetch_headinfos(
-000032b0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-000032c0: 6c66 2e65 6469 4f62 6a73 5f2c 2027 6c6f  lf.ediObjs_, 'lo
-000032d0: 6e27 290d 0a20 2020 2020 2020 2065 6c65  n')..        ele
-000032e0: 7620 3d20 5f66 6574 6368 5f68 6561 6469  v = _fetch_headi
-000032f0: 6e66 6f73 280d 0a20 2020 2020 2020 2020  nfos(..         
-00003300: 2020 2073 656c 662e 6564 694f 626a 735f     self.ediObjs_
-00003310: 2c20 2765 6c65 7627 290d 0a20 2020 2020  , 'elev')..     
-00003320: 2020 206c 6f6e 2c2a 5f20 3d20 7363 616c     lon,*_ = scal
-00003330: 6550 6f73 6974 696f 6e28 0d0a 2020 2020  ePosition(..    
-00003340: 2020 2020 2020 2020 6c6f 6e29 2069 6620          lon) if 
-00003350: 6c65 6e28 7365 6c66 2e65 6469 4f62 6a73  len(self.ediObjs
-00003360: 5f29 3e20 3120 656c 7365 206c 6f6e 200d  _)> 1 else lon .
-00003370: 0a20 2020 2020 2020 206c 6174 2c2a 5f20  .        lat,*_ 
-00003380: 3d20 7363 616c 6550 6f73 6974 696f 6e28  = scalePosition(
-00003390: 0d0a 2020 2020 2020 2020 2020 2020 6c61  ..            la
-000033a0: 7429 2069 6620 6c65 6e28 7365 6c66 2e65  t) if len(self.e
-000033b0: 6469 4f62 6a73 5f29 3e20 3120 656c 7365  diObjs_)> 1 else
-000033c0: 206c 6174 0d0a 2020 2020 2020 2020 0d0a   lat..        ..
-000033d0: 2020 2020 2020 2020 2320 4372 6561 7465          # Create
-000033e0: 2074 6865 2073 7461 7469 6f6e 2069 6473   the station ids
-000033f0: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-00003400: 6964 203d 206d 616b 655f 6964 7328 7365  id = make_ids(se
-00003410: 6c66 2e65 6469 4f62 6a73 5f2c 2070 7265  lf.ediObjs_, pre
-00003420: 6669 783d 2753 2729 0d0a 2020 2020 0d0a  fix='S')..    ..
-00003430: 2020 2020 2020 2020 7365 6c66 2e6c 6f6e          self.lon
-00003440: 6769 7475 6465 3d20 6c6f 6e20 0d0a 2020  gitude= lon ..  
-00003450: 2020 2020 2020 7365 6c66 2e6c 6174 6974        self.latit
-00003460: 7564 653d 206c 6174 2020 0d0a 2020 2020  ude= lat  ..    
-00003470: 2020 2020 7365 6c66 2e65 6c65 7661 7469      self.elevati
-00003480: 6f6e 3d20 656c 6576 0d0a 2020 2020 2020  on= elev..      
-00003490: 2020 7472 7920 3a20 0d0a 2020 2020 2020    try : ..      
-000034a0: 2020 2020 2020 7365 6c66 2e65 6c65 7661        self.eleva
-000034b0: 7469 6f6e 3d20 7365 6c66 2e65 6c65 7661  tion= self.eleva
-000034c0: 7469 6f6e 2e61 7374 7970 6520 280d 0a20  tion.astype (.. 
-000034d0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-000034e0: 702e 666c 6f61 7436 3429 0d0a 2020 2020  p.float64)..    
-000034f0: 2020 2020 6578 6365 7074 203a 7061 7373      except :pass
-00003500: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-00003510: 7374 6e61 6d65 7320 3d20 7365 6c66 2e65  stnames = self.e
-00003520: 6469 6e61 6d65 7320 0d0a 2020 2020 2020  dinames ..      
-00003530: 2020 2320 6765 7420 6672 6571 7565 6e63    # get frequenc
-00003540: 7920 6172 7261 7920 6672 6f6d 2074 6865  y array from the
-00003550: 2066 6972 7374 2076 616c 7565 206f 6620   first value of 
-00003560: 6564 6966 696c 6573 2e0d 0a20 2020 2020  edifiles...     
-00003570: 2020 2073 656c 662e 6672 6571 5f61 7272     self.freq_arr
-00003580: 6179 203d 2073 656c 662e 6564 694f 626a  ay = self.ediObj
-00003590: 735f 5b30 5d2e 5a2e 6672 6571 0d0a 0d0a  s_[0].Z.freq....
-000035a0: 2020 2020 2020 2020 7365 6c66 2e66 7265          self.fre
-000035b0: 7173 5f20 3d20 7365 6c66 2e67 6574 6675  qs_ = self.getfu
-000035c0: 6c6c 6672 6571 7565 6e63 7920 2829 0d0a  llfrequency ()..
-000035d0: 2020 2020 2020 2020 7365 6c66 2e72 6566          self.ref
-000035e0: 7265 715f 203d 2073 656c 662e 6765 7472  req_ = self.getr
-000035f0: 6566 6572 656e 6365 6672 6571 7565 6e63  eferencefrequenc
-00003600: 7928 290d 0a20 2020 2020 2020 200d 0a20  y()..        .. 
-00003610: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00003620: 6c66 200d 0a20 2020 200d 0a20 2020 2064  lf ..    ..    d
-00003630: 6566 2072 6577 7269 7465 2028 0d0a 2020  ef rewrite (..  
-00003640: 2020 2020 2020 7365 6c66 2c20 0d0a 2020        self, ..  
-00003650: 2020 2020 2020 2a2c 2020 0d0a 2020 2020        *,  ..    
-00003660: 2020 2020 6279 3a20 7374 7220 203d 2027      by: str  = '
-00003670: 6e61 6d65 272c 200d 0a20 2020 2020 2020  name', ..       
-00003680: 2070 7265 6669 783a 204f 7074 696f 6e61   prefix: Optiona
-00003690: 6c5b 7374 725d 2020 3d20 4e6f 6e65 2c20  l[str]  = None, 
-000036a0: 0d0a 2020 2020 2020 2020 6461 7461 6964  ..        dataid
-000036b0: 3a20 4f70 7469 6f6e 616c 5b4c 6973 745b  : Optional[List[
-000036c0: 7374 725d 5d20 3d4e 6f6e 652c 200d 0a20  str]] =None, .. 
-000036d0: 2020 2020 2020 2073 6176 6570 6174 683a         savepath:
-000036e0: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-000036f0: 204e 6f6e 652c 200d 0a20 2020 2020 2020   None, ..       
-00003700: 2068 6f77 3a20 7374 7220 3d27 7079 272c   how: str ='py',
-00003710: 200d 0a20 2020 2020 2020 2063 6f72 7265   ..        corre
-00003720: 6374 5f6c 6c3a 2062 6f6f 6c20 3d54 7275  ct_ll: bool =Tru
-00003730: 652c 200d 0a20 2020 2020 2020 206d 616b  e, ..        mak
-00003740: 655f 636f 6f72 6473 3a20 626f 6f6c 203d  e_coords: bool =
-00003750: 4661 6c73 652c 200d 0a20 2020 2020 2020  False, ..       
-00003760: 2072 6566 6c6f 6e67 3a20 4f70 7469 6f6e   reflong: Option
-00003770: 616c 5b73 7472 207c 2066 6c6f 6174 5d20  al[str | float] 
-00003780: 3d4e 6f6e 652c 200d 0a20 2020 2020 2020  =None, ..       
-00003790: 2072 6566 6c61 743a 204f 7074 696f 6e61   reflat: Optiona
-000037a0: 6c5b 7374 7220 7c20 666c 6f61 745d 3d4e  l[str | float]=N
-000037b0: 6f6e 652c 200d 0a20 2020 2020 2020 2073  one, ..        s
-000037c0: 7465 703a 2073 7472 2020 3d27 316b 6d27  tep: str  ='1km'
-000037d0: 2c0d 0a20 2020 2020 2020 2065 6469 5f70  ,..        edi_p
-000037e0: 7265 6669 783a 204f 7074 696f 6e61 6c5b  refix: Optional[
-000037f0: 7374 725d 203d 4e6f 6e65 2c20 0d0a 2020  str] =None, ..  
-00003800: 2020 2020 2020 6578 706f 7274 3a20 626f        export: bo
-00003810: 6f6c 203d 5472 7565 2c20 0d0a 2020 2020  ol =True, ..    
-00003820: 2020 2020 2a2a 6b77 730d 0a20 2020 2020      **kws..     
-00003830: 2020 2029 2d3e 2022 454d 223a 200d 0a20     )-> "EM": .. 
-00003840: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00003850: 2022 2222 2052 6577 7269 7465 2045 6469   """ Rewrite Edi
-00003860: 732c 2063 6f72 7265 6374 2073 7461 7469  s, correct stati
-00003870: 6f6e 2063 6f6f 7264 696e 6174 6573 2061  on coordinates a
-00003880: 6e64 2064 6970 6f6c 6520 6c65 6e67 7468  nd dipole length
-00003890: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
-000038a0: 2020 2020 2020 4361 6e20 7265 6e61 6d65        Can rename
-000038b0: 2074 6865 2064 6174 6169 642c 2020 6375   the dataid,  cu
-000038c0: 7374 6f6d 697a 6520 7369 7465 7320 616e  stomize sites an
-000038d0: 6420 636f 7272 6563 7420 7468 6520 706f  d correct the po
-000038e0: 7369 7469 6f6e 696e 670d 0a20 2020 2020  sitioning..     
-000038f0: 2020 206c 6174 6974 7564 6573 2061 6e64     latitudes and
-00003900: 206c 6f6e 6769 7475 6465 732e 200d 0a20   longitudes. .. 
-00003910: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00003920: 2050 6172 616d 6574 6572 7320 0d0a 2020   Parameters ..  
-00003930: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00003940: 2d2d 0d0a 2020 2020 2020 2020 6461 7461  --..        data
-00003950: 6964 3a20 6c69 7374 200d 0a20 2020 2020  id: list ..     
-00003960: 2020 2020 2020 206c 6973 7420 6f66 2069         list of i
-00003970: 6473 2074 6f20 2072 656e 616d 6520 7468  ds to  rename th
-00003980: 6520 6578 6973 7469 6e67 2045 4449 2d64  e existing EDI-d
-00003990: 6174 6169 6420 6672 6f6d 2020 0d0a 2020  ataid from  ..  
-000039a0: 2020 2020 2020 2020 2020 3a63 6c61 7373            :class
-000039b0: 3a60 4865 6164 2e64 6174 6169 6460 2e20  :`Head.dataid`. 
-000039c0: 4966 2067 6976 656e 2c20 6974 2073 686f  If given, it sho
-000039d0: 756c 6420 6d61 7463 6820 7468 6520 6c65  uld match the le
-000039e0: 6e67 7468 206f 6620 0d0a 2020 2020 2020  ngth of ..      
-000039f0: 2020 2020 2020 7468 6520 636f 6c6c 6563        the collec
-00003a00: 7469 6f6e 7320 6f66 2060 6564 694f 626a  tions of `ediObj
-00003a10: 7360 2e20 4120 5661 6c75 6545 7272 6f72  s`. A ValueError
-00003a20: 2077 696c 6c20 6f63 6375 7273 2069 6620   will occurs if 
-00003a30: 7468 6520 0d0a 2020 2020 2020 2020 2020  the ..          
-00003a40: 2020 6c65 6e67 7468 206f 6620 6964 7320    length of ids 
-00003a50: 7072 6f76 6964 6564 2069 7320 6f75 7420  provided is out 
-00003a60: 6f66 2074 6865 2072 616e 6765 206f 6620  of the range of 
-00003a70: 7468 6520 6e75 6d62 6572 206f 6620 4544  the number of ED
-00003a80: 6973 0d0a 2020 2020 2020 2020 2020 2020  is..            
-00003a90: 6f62 6a65 6374 7320 0d0a 0d0a 2020 2020  objects ....    
-00003aa0: 2020 2020 6279 3a20 7374 7220 0d0a 2020      by: str ..  
-00003ab0: 2020 2020 2020 2020 2020 5265 6e61 6d65            Rename
-00003ac0: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
-00003ad0: 6520 696e 6e65 7220 6d6f 6475 6c65 2049  e inner module I
-00003ae0: 642e 2043 616e 2062 6520 6060 6e61 6d65  d. Can be ``name
-00003af0: 6060 2c20 6060 6964 6060 2c20 0d0a 2020  ``, ``id``, ..  
-00003b00: 2020 2020 2020 2020 2020 6060 6e75 6d62            ``numb
-00003b10: 6572 6060 2e20 4465 6661 756c 7420 6973  er``. Default is
-00003b20: 2060 606e 616d 6560 602e 2049 6620 3a61   ``name``. If :a
-00003b30: 7474 723a 607e 2e45 4d2e 7375 7276 6579  ttr:`~.EM.survey
-00003b40: 5f6e 616d 6560 0d0a 2020 2020 2020 2020  _name`..        
-00003b50: 2020 2020 6973 2067 6976 656e 2c20 7468      is given, th
-00003b60: 6520 7768 6f6c 6520 7375 7276 6579 206e  e whole survey n
-00003b70: 616d 6520 7368 6f75 6c64 2062 6520 6f76  ame should be ov
-00003b80: 6572 7772 6974 7465 6e2e 2043 6f6e 7665  erwritten. Conve
-00003b90: 7273 6c79 2c20 7468 6520 200d 0a20 2020  rsly, the  ..   
-00003ba0: 2020 2020 2020 2020 2061 7267 756d 656e           argumen
-00003bb0: 7420 6060 6978 6060 206f 7574 7075 7473  t ``ix`` outputs
-00003bc0: 2074 6865 206e 756d 6265 7220 6f66 2066   the number of f
-00003bd0: 6f72 6d61 7469 6e67 2073 7461 7469 6f6e  ormating station
-00003be0: 7320 6578 636c 7564 696e 6720 0d0a 2020  s excluding ..  
-00003bf0: 2020 2020 2020 2020 2020 7468 6520 7375            the su
-00003c00: 7276 6579 206e 616d 652e 200d 0a20 2020  rvey name. ..   
-00003c10: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00003c20: 2020 2070 7265 6669 783a 2073 7472 0d0a     prefix: str..
-00003c30: 2020 2020 2020 2020 2020 2020 5072 6566              Pref
-00003c40: 6978 2074 6865 206e 756d 6265 7220 6f66  ix the number of
-00003c50: 2074 6865 2073 6974 652e 2049 7420 636f   the site. It co
-00003c60: 756c 6420 6265 2074 6865 2061 6262 7265  uld be the abbre
-00003c70: 7669 6174 696f 6e20 2020 0d0a 2020 2020  viation   ..    
-00003c80: 2020 2020 2020 2020 6f66 2074 6865 2073          of the s
-00003c90: 7572 7665 7920 6172 6561 2e20 0d0a 0d0a  urvey area. ....
-00003ca0: 2020 2020 2020 2020 636f 7272 6563 745f          correct_
-00003cb0: 6c6c 3a20 626f 6f6c 2c0d 0a20 2020 2020  ll: bool,..     
-00003cc0: 2020 2020 2020 2057 7269 7465 2074 6865         Write the
-00003cd0: 2073 6361 6c65 6420 706f 7369 7469 6f6e   scaled position
-00003ce0: 7328 206c 6f6e 6769 7475 6465 2061 6e64  s( longitude and
-00003cf0: 206c 6174 6974 7564 6529 2e20 4465 6661   latitude). Defa
-00003d00: 756c 7420 6973 0d0a 2020 2020 2020 2020  ult is..        
-00003d10: 2020 2020 6060 5472 7565 6060 2e20 0d0a      ``True``. ..
-00003d20: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00003d30: 2020 2020 2020 6d61 6b65 5f63 6f6f 7264        make_coord
-00003d40: 733a 2062 6f6f 6c20 0d0a 2020 2020 2020  s: bool ..      
-00003d50: 2020 2020 2020 5573 6566 756c 2074 6f20        Useful to 
-00003d60: 6869 6465 2074 6865 2072 6561 6c20 636f  hide the real co
-00003d70: 6f72 6469 6e61 7465 7320 6f66 2074 6865  ordinates of the
-00003d80: 2073 6974 6573 2062 7920 6765 6e65 7261   sites by genera
-00003d90: 7469 6e67 200d 0a20 2020 2020 2020 2020  ting ..         
-00003da0: 2020 2061 2027 6661 6b65 2720 636f 6f72     a 'fake' coor
-00003db0: 6469 6e61 7465 7320 666f 7220 6120 7370  dinates for a sp
-00003dc0: 6563 6966 6963 2070 7572 706f 7365 732e  ecific purposes.
-00003dd0: 2057 6865 6e20 7365 7474 696e 6720 746f   When setting to
-00003de0: 2060 6054 7275 6560 600d 0a20 2020 2020   ``True``..     
-00003df0: 2020 2020 2020 2062 6520 7375 7265 2074         be sure t
-00003e00: 6f20 7072 6f76 6964 6520 7468 6520 6072  o provide the `r
-00003e10: 6566 6c6f 6e67 6020 616e 6420 6072 6566  eflong` and `ref
-00003e20: 6c61 7460 2076 616c 7565 7320 6f74 6865  lat` values othe
-00003e30: 7277 6973 6520 616e 6420 0d0a 2020 2020  rwise and ..    
-00003e40: 2020 2020 2020 2020 6572 726f 7220 7769          error wi
-00003e50: 6c6c 206f 6363 7572 732e 200d 0a20 2020  ll occurs. ..   
-00003e60: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00003e70: 2020 2072 6566 6c6f 6e67 3a20 666c 6f61     reflong: floa
-00003e80: 7420 6f72 2073 7472 696e 6720 0d0a 2020  t or string ..  
-00003e90: 2020 2020 2020 2020 2020 5265 6665 7265            Refere
-00003ea0: 6e63 6520 6c6f 6e67 6974 7564 6520 2069  nce longitude  i
-00003eb0: 6e20 6465 6772 6565 2064 6563 696d 616c  n degree decimal
-00003ec0: 206f 7220 696e 2044 443a 4d4d 3a53 5320   or in DD:MM:SS 
-00003ed0: 666f 7220 7468 6520 200d 0a20 2020 2020  for the  ..     
-00003ee0: 2020 2020 2020 2073 6974 6520 636f 6e73         site cons
-00003ef0: 6964 6572 6564 2061 7320 7468 6520 6f72  idered as the or
-00003f00: 6967 696e 206f 6620 7468 6520 6c61 6d64  igin of the lamd
-00003f10: 6d61 726b 2e0d 0a20 2020 2020 2020 2020  mark...         
-00003f20: 2020 200d 0a20 2020 2020 2020 2072 6566     ..        ref
-00003f30: 6c61 743a 2066 6c6f 6174 206f 7220 7374  lat: float or st
-00003f40: 7269 6e67 200d 0a20 2020 2020 2020 2020  ring ..         
-00003f50: 2020 2052 6566 6572 656e 6365 206c 6174     Reference lat
-00003f60: 6974 7564 6520 696e 2064 6567 7265 6520  itude in degree 
-00003f70: 6465 6369 6d61 6c20 6f72 2069 6e20 4444  decimal or in DD
-00003f80: 3a4d 4d3a 5353 2066 6f72 2074 6865 2072  :MM:SS for the r
-00003f90: 6566 6572 656e 6365 2020 0d0a 2020 2020  eference  ..    
-00003fa0: 2020 2020 2020 2020 7369 7465 2063 6f6e          site con
-00003fb0: 7369 6465 7265 6420 6173 2074 6865 206c  sidered as the l
-00003fc0: 616e 646d 6172 6b20 6f72 6967 696e 2e0d  andmark origin..
-00003fd0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00003fe0: 2020 2020 2020 2073 7465 703a 2066 6c6f         step: flo
-00003ff0: 6174 206f 7220 7374 7220 0d0a 2020 2020  at or str ..    
-00004000: 2020 2020 2020 2020 4f66 6673 6574 206f          Offset o
-00004010: 7220 7468 6520 6469 7374 616e 6365 206f  r the distance o
-00004020: 6620 7365 7065 7261 7469 6f6e 2062 6574  f seperation bet
-00004030: 7765 656e 2064 6966 6665 7265 6e74 2073  ween different s
-00004040: 6974 6573 2069 6e20 6d65 7465 7273 2e20  ites in meters. 
-00004050: 0d0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-00004060: 2074 6865 2076 616c 7565 2069 7320 6769   the value is gi
-00004070: 7665 6e20 6173 2073 7472 696e 6720 7479  ven as string ty
-00004080: 7065 2c20 6578 6365 7074 2074 6865 2060  pe, except the `
-00004090: 606b 6d60 602c 2069 7420 7368 6f75 6c64  `km``, it should
-000040a0: 2062 6520 0d0a 2020 2020 2020 2020 2020   be ..          
-000040b0: 2020 636f 6e73 6964 6572 6564 2061 7320    considered as 
-000040c0: 6120 6060 6d60 6020 7661 6c75 652e 204f  a ``m`` value. O
-000040d0: 6e6c 7920 6d65 7465 7273 2061 6e64 206b  nly meters and k
-000040e0: 696c 6f6d 6574 6572 7320 6172 6520 6163  ilometers are ac
-000040f0: 6365 7061 626c 6573 2e0d 0a20 2020 2020  cepables...     
-00004100: 2020 2020 2020 2044 6566 6175 6c74 2076         Default v
-00004110: 616c 7565 206f 6620 7365 7065 7261 7469  alue of seperati
-00004120: 6f6e 2062 6574 7765 656e 2074 6865 2073  on between the s
-00004130: 6974 6520 6973 2060 6031 6b6d 6060 2e20  ite is ``1km``. 
-00004140: 0d0a 2020 2020 2020 2020 2020 2020 200d  ..             .
-00004150: 0a20 2020 2020 2020 2073 6176 6570 6174  .        savepat
-00004160: 683a 2073 7472 200d 0a20 2020 2020 2020  h: str ..       
-00004170: 2020 2020 2046 756c 6c20 7061 7468 206f       Full path o
-00004180: 6620 7468 6520 7361 7665 2064 6972 6563  f the save direc
-00004190: 746f 7279 2e20 4966 206e 6f74 2067 6976  tory. If not giv
-000041a0: 656e 2c20 4544 4973 2020 7368 6f75 6c64  en, EDIs  should
-000041b0: 2062 6520 0d0a 2020 2020 2020 2020 2020   be ..          
-000041c0: 2020 6f75 7470 7574 6564 2069 6e20 7468    outputed in th
-000041d0: 6520 6372 6561 7465 6420 6469 7265 6374  e created direct
-000041e0: 6f72 792e 200d 0a20 2020 200d 0a20 2020  ory. ..    ..   
-000041f0: 2020 2020 2068 6f77 3a20 7374 7220 0d0a       how: str ..
-00004200: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00004210: 7761 7920 746f 2069 6e64 6578 2074 6865  way to index the
-00004220: 2073 7461 7469 6f6e 732e 2044 6566 6175   stations. Defau
-00004230: 6c74 2069 7320 7468 6520 5079 7468 6f6e  lt is the Python
-00004240: 2069 6e64 6578 696e 670d 0a20 2020 2020   indexing..     
-00004250: 2020 2020 2020 2069 2e65 2e20 7468 6520         i.e. the 
-00004260: 636f 756e 7469 6e67 2073 7461 7274 7320  counting starts 
-00004270: 6279 2030 2e20 416e 7920 6f74 6865 7220  by 0. Any other 
-00004280: 7661 6c75 6520 7769 6c6c 2073 7461 7274  value will start
-00004290: 2063 6f75 6e74 696e 6720 0d0a 2020 2020   counting ..    
-000042a0: 2020 2020 2020 2020 7468 6520 7369 7465          the site
-000042b0: 2066 726f 6d20 312e 0d0a 2020 2020 2020   from 1...      
-000042c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000042d0: 6578 706f 7274 3a20 626f 6f6c 2c20 0d0a  export: bool, ..
-000042e0: 2020 2020 2020 2020 2020 2020 4578 706f              Expo
-000042f0: 7274 206e 6577 2065 6469 2d66 696c 6573  rt new edi-files
-00004300: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-00004310: 0a20 2020 2020 2020 206b 7773 3a20 6469  .        kws: di
-00004320: 6374 200d 0a20 2020 2020 2020 2020 2020  ct ..           
-00004330: 2041 6464 6974 696f 6e6e 616c 206b 6579   Additionnal key
-00004340: 776f 7264 2061 7267 756d 656e 7473 2066  word arguments f
-00004350: 726f 6d20 607e 4564 692e 7772 6974 655f  rom `~Edi.write_
-00004360: 6564 6966 696c 6560 2061 6e64 200d 0a20  edifile` and .. 
-00004370: 2020 2020 2020 2020 2020 203a 6675 6e63             :func
-00004380: 3a60 7761 7465 782e 7574 696c 732e 636f  :`watex.utils.co
-00004390: 7265 7574 696c 732e 6d61 6b65 436f 6f72  reutils.makeCoor
-000043a0: 6473 602e 200d 0a20 2020 2020 2020 2020  ds`. ..         
-000043b0: 2020 200d 0a20 2020 2020 2020 2052 6574     ..        Ret
-000043c0: 7572 6e73 200d 0a20 2020 2020 2020 202d  urns ..        -
-000043d0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-000043e0: 2045 4d3a 203a 636c 6173 733a 607e 2e45   EM: :class:`~.E
-000043f0: 4d60 2069 6e73 7461 6e63 650d 0a20 2020  M` instance..   
-00004400: 2020 2020 2020 2020 2020 5265 7475 726e            Return
-00004410: 7320 6060 7365 6c66 6060 2066 6f72 2065  s ``self`` for e
-00004420: 6173 7920 6d65 7468 6f64 2063 6861 696e  asy method chain
-00004430: 696e 672e 0d0a 2020 2020 2020 2020 2020  ing...          
-00004440: 2020 0d0a 2020 2020 2020 2020 4578 616d    ..        Exam
-00004450: 706c 6573 0d0a 2020 2020 2020 2020 2d2d  ples..        --
-00004460: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00004470: 203e 3e3e 2066 726f 6d20 7761 7465 782e   >>> from watex.
-00004480: 6d65 7468 6f64 732e 656d 2069 6d70 6f72  methods.em impor
-00004490: 7420 454d 0d0a 2020 2020 2020 2020 3e3e  t EM..        >>
-000044a0: 3e20 6564 6970 6174 6820 3d20 7227 6461  > edipath = r'da
-000044b0: 7461 2f65 6469 7327 0d0a 2020 2020 2020  ta/edis'..      
-000044c0: 2020 3e3e 3e20 7361 7665 7061 7468 203d    >>> savepath =
-000044d0: 2020 7227 2f55 7365 7273 2f44 616e 6965    r'/Users/Danie
-000044e0: 6c2f 4465 736b 746f 702f 6564 696f 7574  l/Desktop/ediout
-000044f0: 270d 0a20 2020 2020 2020 203e 3e3e 2065  '..        >>> e
-00004500: 6d4f 626a 7320 3d20 454d 2829 2e66 6974  mObjs = EM().fit
-00004510: 2865 6469 7061 7468 290d 0a20 2020 2020  (edipath)..     
-00004520: 2020 203e 3e3e 2065 6d4f 626a 732e 7265     >>> emObjs.re
-00004530: 7772 6974 655f 6564 6973 2862 793d 2769  write_edis(by='i
-00004540: 6427 2c20 6564 695f 7072 6566 6978 203d  d', edi_prefix =
-00004550: 2762 3127 2c0d 0a20 2020 2020 2020 2020  'b1',..         
+00002c80: 2027 7265 7369 7374 6976 6974 7920 7661   'resistivity va
+00002c90: 6c75 6573 2066 726f 6d20 6120 636f 6c6c  lues from a coll
+00002ca0: 6563 7469 6f6e 2065 6469 6f62 6a27 290d  ection ediobj').
+00002cb0: 0a20 2020 2020 2020 2074 203d 205b 6765  .        t = [ge
+00002cc0: 7461 7474 7220 2865 6469 5f6f 626a 2e5a  tattr (edi_obj.Z
+00002cd0: 2c20 6174 7472 2029 2066 6f72 2065 6469  , attr ) for edi
+00002ce0: 5f6f 626a 2069 6e20 7365 6c66 2e65 6469  _obj in self.edi
+00002cf0: 4f62 6a73 5f5d 0d0a 2020 2020 2020 2020  Objs_]..        
+00002d00: 2320 7075 7420 616c 6c20 7374 6174 696f  # put all statio
+00002d10: 6e20 2820 6b65 7929 202f 7661 6c75 6573  n ( key) /values
+00002d20: 2069 6e0d 0a20 2020 2020 2020 2074 6469   in..        tdi
+00002d30: 6374 203d 207b 6b65 793a 7661 6c75 6520  ct = {key:value 
+00002d40: 666f 7220 6b65 7920 2c20 7661 6c75 6520  for key , value 
+00002d50: 696e 207a 6970 2028 7365 6c66 2e69 642c  in zip (self.id,
+00002d60: 2074 297d 0d0a 2020 2020 2020 2020 0d0a   t)}..        ..
+00002d70: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+00002d80: 2c20 7464 6963 740d 0a20 2020 200d 0a20  , tdict..    .. 
+00002d90: 2020 2064 6566 2066 6974 2873 656c 662c     def fit(self,
+00002da0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00002db0: 6461 7461 3a20 7374 727c 4c69 7374 5b45  data: str|List[E
+00002dc0: 4449 4f5d 0d0a 2020 2020 2020 2020 2020  DIO]..          
+00002dd0: 2020 2029 2d3e 2245 4d22 3a0d 0a20 2020     )->"EM":..   
+00002de0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00002df0: 2020 4173 7365 7274 2061 6e64 206d 616b    Assert and mak
+00002e00: 6520 454d 206f 626a 6563 7420 6672 6f6d  e EM object from
+00002e10: 2061 2063 6f6c 6c65 6374 696f 6e20 4544   a collection ED
+00002e20: 4973 2e20 0d0a 2020 2020 2020 2020 0d0a  Is. ..        ..
+00002e30: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00002e40: 7273 200d 0a20 2020 2020 2020 202d 2d2d  rs ..        ---
+00002e50: 2d2d 2d2d 2d2d 2d2d 200d 0a20 2020 2020  -------- ..     
+00002e60: 2020 2064 6174 6120 3a20 7374 722c 206f     data : str, o
+00002e70: 7220 6c69 7374 206f 7220 3a63 6c61 7373  r list or :class
+00002e80: 3a60 7079 6373 616d 742e 636f 7265 2e65  :`pycsamt.core.e
+00002e90: 6469 2e45 6469 6020 6f62 6a65 6374 200d  di.Edi` object .
+00002ea0: 0a20 2020 2020 2020 2020 2020 2046 756c  .            Ful
+00002eb0: 6c20 7061 7468 2074 6f20 4544 4920 6669  l path to EDI fi
+00002ec0: 6c65 7320 6f72 2063 6f6c 6c65 6374 696f  les or collectio
+00002ed0: 6e20 6f66 2045 4449 2d6f 626a 6563 7473  n of EDI-objects
+00002ee0: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
+00002ef0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00002f00: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00002f10: 2d2d 200d 0a20 2020 2020 2020 2073 656c  -- ..        sel
+00002f20: 663a 2045 4d20 6f62 6a65 6374 2066 726f  f: EM object fro
+00002f30: 6d20 6120 636f 6c6c 6563 7469 6f6e 2045  m a collection E
+00002f40: 4449 7320 0d0a 2020 2020 2020 2020 0d0a  DIs ..        ..
+00002f50: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+00002f60: 200d 0a20 2020 2020 2020 202d 2d2d 2d2d   ..        -----
+00002f70: 2d2d 2d0d 0a20 2020 2020 2020 203e 3e3e  ---..        >>>
+00002f80: 2066 726f 6d20 7761 7465 782e 6d65 7468   from watex.meth
+00002f90: 6f64 732e 656d 2069 6d70 6f72 7420 454d  ods.em import EM
+00002fa0: 200d 0a20 2020 2020 2020 203e 3e3e 2065   ..        >>> e
+00002fb0: 6d4f 626a 7320 3d20 454d 2829 2e66 6974  mObjs = EM().fit
+00002fc0: 2028 7227 6461 7461 2f65 6469 7327 290d   (r'data/edis').
+00002fd0: 0a20 2020 2020 2020 203e 3e3e 2065 6d4f  .        >>> emO
+00002fe0: 626a 732e 6564 694f 626a 735f 200d 0a20  bjs.ediObjs_ .. 
+00002ff0: 2020 2020 2020 202e 2e2e 200d 0a0d 0a20         ... .... 
+00003000: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00003010: 2020 2020 6465 6620 5f66 6574 6368 5f68      def _fetch_h
+00003020: 6561 6469 6e66 6f73 2028 636f 626a 2c20  eadinfos (cobj, 
+00003030: 2061 7474 7229 3a20 0d0a 2020 2020 2020   attr): ..      
+00003040: 2020 2020 2020 2222 2220 5365 7420 6174        """ Set at
+00003050: 7472 6962 7574 6520 6061 7474 7260 2066  tribute `attr` f
+00003060: 726f 6d20 636f 6c6c 6563 7469 6f6e 206f  rom collection o
+00003070: 626a 6563 7420 6063 6f62 6a60 2e22 2222  bject `cobj`."""
+00003080: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00003090: 7475 726e 206c 6973 7428 6d61 7020 286c  turn list(map (l
+000030a0: 616d 6264 6120 6f3a 2067 6574 6174 7472  ambda o: getattr
+000030b0: 286f 2c20 6174 7472 292c 2063 6f62 6a29  (o, attr), cobj)
+000030c0: 290d 0a20 2020 0d0a 2020 2020 2020 2020  )..   ..        
+000030d0: 7365 6c66 2e5f 7265 6164 5f65 6d6f 2864  self._read_emo(d
+000030e0: 6174 6120 2920 0d0a 2020 2020 2020 2020  ata ) ..        
+000030f0: 2320 736f 7274 6564 2065 6469 4f62 6a73  # sorted ediObjs
+00003100: 2066 726f 6d20 6c61 746c 6f6e 6720 200d   from latlong  .
+00003110: 0a20 2020 2020 2020 2073 656c 662e 6564  .        self.ed
+00003120: 694f 626a 735f 202c 2073 656c 662e 6564  iObjs_ , self.ed
+00003130: 696e 616d 6573 203d 2066 6974 5f62 795f  inames = fit_by_
+00003140: 6c6c 280d 0a20 2020 2020 2020 2020 2020  ll(..           
+00003150: 2073 656c 662e 6564 694f 626a 735f 290d   self.ediObjs_).
+00003160: 0a20 2020 2020 2020 2023 2072 656f 7267  .        # reorg
+00003170: 616e 697a 6520 2065 6469 7320 6163 636f  anize  edis acco
+00003180: 7264 696e 6720 0d0a 2020 2020 2020 2020  rding ..        
+00003190: 2320 746f 206c 6f6e 206c 6174 206f 7264  # to lon lat ord
+000031a0: 6572 2e20 0d0a 2020 2020 2020 2020 7365  er. ..        se
+000031b0: 6c66 2e65 6469 6669 6c65 7320 3d20 6c69  lf.edifiles = li
+000031c0: 7374 286d 6170 280d 0a20 2020 2020 2020  st(map(..       
+000031d0: 2020 2020 206c 616d 6264 6120 6f3a 206f       lambda o: o
+000031e0: 2e65 6469 6669 6c65 202c 2073 656c 662e  .edifile , self.
+000031f0: 6564 694f 626a 735f 2929 0d0a 0d0a 2020  ediObjs_))....  
+00003200: 2020 2020 2020 232d 2d67 6574 2063 6f6f        #--get coo
+00003210: 7264 696e 6174 6573 2076 616c 7565 7320  rdinates values 
+00003220: 0d0a 2020 2020 2020 2020 2320 616e 6420  ..        # and 
+00003230: 636f 7272 6563 7420 6c6f 6e5f 6c61 7420  correct lon_lat 
+00003240: 2d2d 2d0d 0a20 2020 2020 2020 206c 6174  ---..        lat
+00003250: 2020 3d20 5f66 6574 6368 5f68 6561 6469    = _fetch_headi
+00003260: 6e66 6f73 280d 0a20 2020 2020 2020 2020  nfos(..         
+00003270: 2020 2073 656c 662e 6564 694f 626a 735f     self.ediObjs_
+00003280: 2c20 276c 6174 2729 0d0a 2020 2020 2020  , 'lat')..      
+00003290: 2020 6c6f 6e20 203d 205f 6665 7463 685f    lon  = _fetch_
+000032a0: 6865 6164 696e 666f 7328 0d0a 2020 2020  headinfos(..    
+000032b0: 2020 2020 2020 2020 7365 6c66 2e65 6469          self.edi
+000032c0: 4f62 6a73 5f2c 2027 6c6f 6e27 290d 0a20  Objs_, 'lon').. 
+000032d0: 2020 2020 2020 2065 6c65 7620 3d20 5f66         elev = _f
+000032e0: 6574 6368 5f68 6561 6469 6e66 6f73 280d  etch_headinfos(.
+000032f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00003300: 662e 6564 694f 626a 735f 2c20 2765 6c65  f.ediObjs_, 'ele
+00003310: 7627 290d 0a20 2020 2020 2020 206c 6f6e  v')..        lon
+00003320: 2c2a 5f20 3d20 7363 616c 6550 6f73 6974  ,*_ = scalePosit
+00003330: 696f 6e28 0d0a 2020 2020 2020 2020 2020  ion(..          
+00003340: 2020 6c6f 6e29 2069 6620 6c65 6e28 7365    lon) if len(se
+00003350: 6c66 2e65 6469 4f62 6a73 5f29 3e20 3120  lf.ediObjs_)> 1 
+00003360: 656c 7365 206c 6f6e 200d 0a20 2020 2020  else lon ..     
+00003370: 2020 206c 6174 2c2a 5f20 3d20 7363 616c     lat,*_ = scal
+00003380: 6550 6f73 6974 696f 6e28 0d0a 2020 2020  ePosition(..    
+00003390: 2020 2020 2020 2020 6c61 7429 2069 6620          lat) if 
+000033a0: 6c65 6e28 7365 6c66 2e65 6469 4f62 6a73  len(self.ediObjs
+000033b0: 5f29 3e20 3120 656c 7365 206c 6174 0d0a  _)> 1 else lat..
+000033c0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000033d0: 2020 2320 4372 6561 7465 2074 6865 2073    # Create the s
+000033e0: 7461 7469 6f6e 2069 6473 200d 0a20 2020  tation ids ..   
+000033f0: 2020 2020 2073 656c 662e 6964 203d 206d       self.id = m
+00003400: 616b 655f 6964 7328 7365 6c66 2e65 6469  ake_ids(self.edi
+00003410: 4f62 6a73 5f2c 2070 7265 6669 783d 2753  Objs_, prefix='S
+00003420: 2729 0d0a 2020 2020 0d0a 2020 2020 2020  ')..    ..      
+00003430: 2020 7365 6c66 2e6c 6f6e 6769 7475 6465    self.longitude
+00003440: 3d20 6c6f 6e20 0d0a 2020 2020 2020 2020  = lon ..        
+00003450: 7365 6c66 2e6c 6174 6974 7564 653d 206c  self.latitude= l
+00003460: 6174 2020 0d0a 2020 2020 2020 2020 7365  at  ..        se
+00003470: 6c66 2e65 6c65 7661 7469 6f6e 3d20 656c  lf.elevation= el
+00003480: 6576 0d0a 2020 2020 2020 2020 7472 7920  ev..        try 
+00003490: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+000034a0: 7365 6c66 2e65 6c65 7661 7469 6f6e 3d20  self.elevation= 
+000034b0: 7365 6c66 2e65 6c65 7661 7469 6f6e 2e61  self.elevation.a
+000034c0: 7374 7970 6520 280d 0a20 2020 2020 2020  stype (..       
+000034d0: 2020 2020 2020 2020 206e 702e 666c 6f61           np.floa
+000034e0: 7436 3429 0d0a 2020 2020 2020 2020 6578  t64)..        ex
+000034f0: 6365 7074 203a 7061 7373 200d 0a20 2020  cept :pass ..   
+00003500: 2020 2020 2073 656c 662e 7374 6e61 6d65       self.stname
+00003510: 7320 3d20 7365 6c66 2e65 6469 6e61 6d65  s = self.ediname
+00003520: 7320 0d0a 2020 2020 2020 2020 2320 6765  s ..        # ge
+00003530: 7420 6672 6571 7565 6e63 7920 6172 7261  t frequency arra
+00003540: 7920 6672 6f6d 2074 6865 2066 6972 7374  y from the first
+00003550: 2076 616c 7565 206f 6620 6564 6966 696c   value of edifil
+00003560: 6573 2e0d 0a20 2020 2020 2020 2073 656c  es...        sel
+00003570: 662e 6672 6571 5f61 7272 6179 203d 2073  f.freq_array = s
+00003580: 656c 662e 6564 694f 626a 735f 5b30 5d2e  elf.ediObjs_[0].
+00003590: 5a2e 6672 6571 0d0a 0d0a 2020 2020 2020  Z.freq....      
+000035a0: 2020 7365 6c66 2e66 7265 7173 5f20 3d20    self.freqs_ = 
+000035b0: 7365 6c66 2e67 6574 6675 6c6c 6672 6571  self.getfullfreq
+000035c0: 7565 6e63 7920 2829 0d0a 2020 2020 2020  uency ()..      
+000035d0: 2020 7365 6c66 2e72 6566 7265 715f 203d    self.refreq_ =
+000035e0: 2073 656c 662e 6765 7472 6566 6572 656e   self.getreferen
+000035f0: 6365 6672 6571 7565 6e63 7928 290d 0a20  cefrequency().. 
+00003600: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00003610: 2072 6574 7572 6e20 7365 6c66 200d 0a20   return self .. 
+00003620: 2020 200d 0a20 2020 2064 6566 2072 6577     ..    def rew
+00003630: 7269 7465 2028 0d0a 2020 2020 2020 2020  rite (..        
+00003640: 7365 6c66 2c20 0d0a 2020 2020 2020 2020  self, ..        
+00003650: 2a2c 2020 0d0a 2020 2020 2020 2020 6279  *,  ..        by
+00003660: 3a20 7374 7220 203d 2027 6e61 6d65 272c  : str  = 'name',
+00003670: 200d 0a20 2020 2020 2020 2070 7265 6669   ..        prefi
+00003680: 783a 204f 7074 696f 6e61 6c5b 7374 725d  x: Optional[str]
+00003690: 2020 3d20 4e6f 6e65 2c20 0d0a 2020 2020    = None, ..    
+000036a0: 2020 2020 6461 7461 6964 3a20 4f70 7469      dataid: Opti
+000036b0: 6f6e 616c 5b4c 6973 745b 7374 725d 5d20  onal[List[str]] 
+000036c0: 3d4e 6f6e 652c 200d 0a20 2020 2020 2020  =None, ..       
+000036d0: 2073 6176 6570 6174 683a 204f 7074 696f   savepath: Optio
+000036e0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+000036f0: 200d 0a20 2020 2020 2020 2068 6f77 3a20   ..        how: 
+00003700: 7374 7220 3d27 7079 272c 200d 0a20 2020  str ='py', ..   
+00003710: 2020 2020 2063 6f72 7265 6374 5f6c 6c3a       correct_ll:
+00003720: 2062 6f6f 6c20 3d54 7275 652c 200d 0a20   bool =True, .. 
+00003730: 2020 2020 2020 206d 616b 655f 636f 6f72         make_coor
+00003740: 6473 3a20 626f 6f6c 203d 4661 6c73 652c  ds: bool =False,
+00003750: 200d 0a20 2020 2020 2020 2072 6566 6c6f   ..        reflo
+00003760: 6e67 3a20 4f70 7469 6f6e 616c 5b73 7472  ng: Optional[str
+00003770: 207c 2066 6c6f 6174 5d20 3d4e 6f6e 652c   | float] =None,
+00003780: 200d 0a20 2020 2020 2020 2072 6566 6c61   ..        refla
+00003790: 743a 204f 7074 696f 6e61 6c5b 7374 7220  t: Optional[str 
+000037a0: 7c20 666c 6f61 745d 3d4e 6f6e 652c 200d  | float]=None, .
+000037b0: 0a20 2020 2020 2020 2073 7465 703a 2073  .        step: s
+000037c0: 7472 2020 3d27 316b 6d27 2c0d 0a20 2020  tr  ='1km',..   
+000037d0: 2020 2020 2065 6469 5f70 7265 6669 783a       edi_prefix:
+000037e0: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+000037f0: 4e6f 6e65 2c20 0d0a 2020 2020 2020 2020  None, ..        
+00003800: 6578 706f 7274 3a20 626f 6f6c 203d 5472  export: bool =Tr
+00003810: 7565 2c20 0d0a 2020 2020 2020 2020 2a2a  ue, ..        **
+00003820: 6b77 730d 0a20 2020 2020 2020 2029 2d3e  kws..        )->
+00003830: 2022 454d 223a 200d 0a20 2020 2020 2020   "EM": ..       
+00003840: 200d 0a20 2020 2020 2020 2022 2222 2052   ..        """ R
+00003850: 6577 7269 7465 2045 6469 732c 2063 6f72  ewrite Edis, cor
+00003860: 7265 6374 2073 7461 7469 6f6e 2063 6f6f  rect station coo
+00003870: 7264 696e 6174 6573 2061 6e64 2064 6970  rdinates and dip
+00003880: 6f6c 6520 6c65 6e67 7468 2e20 0d0a 2020  ole length. ..  
+00003890: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000038a0: 4361 6e20 7265 6e61 6d65 2074 6865 2064  Can rename the d
+000038b0: 6174 6169 642c 2020 6375 7374 6f6d 697a  ataid,  customiz
+000038c0: 6520 7369 7465 7320 616e 6420 636f 7272  e sites and corr
+000038d0: 6563 7420 7468 6520 706f 7369 7469 6f6e  ect the position
+000038e0: 696e 670d 0a20 2020 2020 2020 206c 6174  ing..        lat
+000038f0: 6974 7564 6573 2061 6e64 206c 6f6e 6769  itudes and longi
+00003900: 7475 6465 732e 200d 0a20 2020 2020 2020  tudes. ..       
+00003910: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
+00003920: 6574 6572 7320 0d0a 2020 2020 2020 2020  eters ..        
+00003930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
+00003940: 2020 2020 2020 6461 7461 6964 3a20 6c69        dataid: li
+00003950: 7374 200d 0a20 2020 2020 2020 2020 2020  st ..           
+00003960: 206c 6973 7420 6f66 2069 6473 2074 6f20   list of ids to 
+00003970: 2072 656e 616d 6520 7468 6520 6578 6973   rename the exis
+00003980: 7469 6e67 2045 4449 2d64 6174 6169 6420  ting EDI-dataid 
+00003990: 6672 6f6d 2020 0d0a 2020 2020 2020 2020  from  ..        
+000039a0: 2020 2020 3a63 6c61 7373 3a60 4865 6164      :class:`Head
+000039b0: 2e64 6174 6169 6460 2e20 4966 2067 6976  .dataid`. If giv
+000039c0: 656e 2c20 6974 2073 686f 756c 6420 6d61  en, it should ma
+000039d0: 7463 6820 7468 6520 6c65 6e67 7468 206f  tch the length o
+000039e0: 6620 0d0a 2020 2020 2020 2020 2020 2020  f ..            
+000039f0: 7468 6520 636f 6c6c 6563 7469 6f6e 7320  the collections 
+00003a00: 6f66 2060 6564 694f 626a 7360 2e20 4120  of `ediObjs`. A 
+00003a10: 5661 6c75 6545 7272 6f72 2077 696c 6c20  ValueError will 
+00003a20: 6f63 6375 7273 2069 6620 7468 6520 0d0a  occurs if the ..
+00003a30: 2020 2020 2020 2020 2020 2020 6c65 6e67              leng
+00003a40: 7468 206f 6620 6964 7320 7072 6f76 6964  th of ids provid
+00003a50: 6564 2069 7320 6f75 7420 6f66 2074 6865  ed is out of the
+00003a60: 2072 616e 6765 206f 6620 7468 6520 6e75   range of the nu
+00003a70: 6d62 6572 206f 6620 4544 6973 0d0a 2020  mber of EDis..  
+00003a80: 2020 2020 2020 2020 2020 6f62 6a65 6374            object
+00003a90: 7320 0d0a 0d0a 2020 2020 2020 2020 6279  s ....        by
+00003aa0: 3a20 7374 7220 0d0a 2020 2020 2020 2020  : str ..        
+00003ab0: 2020 2020 5265 6e61 6d65 2061 6363 6f72      Rename accor
+00003ac0: 6469 6e67 2074 6f20 7468 6520 696e 6e65  ding to the inne
+00003ad0: 7220 6d6f 6475 6c65 2049 642e 2043 616e  r module Id. Can
+00003ae0: 2062 6520 6060 6e61 6d65 6060 2c20 6060   be ``name``, ``
+00003af0: 6964 6060 2c20 0d0a 2020 2020 2020 2020  id``, ..        
+00003b00: 2020 2020 6060 6e75 6d62 6572 6060 2e20      ``number``. 
+00003b10: 4465 6661 756c 7420 6973 2060 606e 616d  Default is ``nam
+00003b20: 6560 602e 2049 6620 3a61 7474 723a 607e  e``. If :attr:`~
+00003b30: 2e45 4d2e 7375 7276 6579 5f6e 616d 6560  .EM.survey_name`
+00003b40: 0d0a 2020 2020 2020 2020 2020 2020 6973  ..            is
+00003b50: 2067 6976 656e 2c20 7468 6520 7768 6f6c   given, the whol
+00003b60: 6520 7375 7276 6579 206e 616d 6520 7368  e survey name sh
+00003b70: 6f75 6c64 2062 6520 6f76 6572 7772 6974  ould be overwrit
+00003b80: 7465 6e2e 2043 6f6e 7665 7273 6c79 2c20  ten. Conversly, 
+00003b90: 7468 6520 200d 0a20 2020 2020 2020 2020  the  ..         
+00003ba0: 2020 2061 7267 756d 656e 7420 6060 6978     argument ``ix
+00003bb0: 6060 206f 7574 7075 7473 2074 6865 206e  `` outputs the n
+00003bc0: 756d 6265 7220 6f66 2066 6f72 6d61 7469  umber of formati
+00003bd0: 6e67 2073 7461 7469 6f6e 7320 6578 636c  ng stations excl
+00003be0: 7564 696e 6720 0d0a 2020 2020 2020 2020  uding ..        
+00003bf0: 2020 2020 7468 6520 7375 7276 6579 206e      the survey n
+00003c00: 616d 652e 200d 0a20 2020 2020 2020 2020  ame. ..         
+00003c10: 2020 200d 0a20 2020 2020 2020 2070 7265     ..        pre
+00003c20: 6669 783a 2073 7472 0d0a 2020 2020 2020  fix: str..      
+00003c30: 2020 2020 2020 5072 6566 6978 2074 6865        Prefix the
+00003c40: 206e 756d 6265 7220 6f66 2074 6865 2073   number of the s
+00003c50: 6974 652e 2049 7420 636f 756c 6420 6265  ite. It could be
+00003c60: 2074 6865 2061 6262 7265 7669 6174 696f   the abbreviatio
+00003c70: 6e20 2020 0d0a 2020 2020 2020 2020 2020  n   ..          
+00003c80: 2020 6f66 2074 6865 2073 7572 7665 7920    of the survey 
+00003c90: 6172 6561 2e20 0d0a 0d0a 2020 2020 2020  area. ....      
+00003ca0: 2020 636f 7272 6563 745f 6c6c 3a20 626f    correct_ll: bo
+00003cb0: 6f6c 2c0d 0a20 2020 2020 2020 2020 2020  ol,..           
+00003cc0: 2057 7269 7465 2074 6865 2073 6361 6c65   Write the scale
+00003cd0: 6420 706f 7369 7469 6f6e 7328 206c 6f6e  d positions( lon
+00003ce0: 6769 7475 6465 2061 6e64 206c 6174 6974  gitude and latit
+00003cf0: 7564 6529 2e20 4465 6661 756c 7420 6973  ude). Default is
+00003d00: 0d0a 2020 2020 2020 2020 2020 2020 6060  ..            ``
+00003d10: 5472 7565 6060 2e20 0d0a 2020 2020 2020  True``. ..      
+00003d20: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00003d30: 6d61 6b65 5f63 6f6f 7264 733a 2062 6f6f  make_coords: boo
+00003d40: 6c20 0d0a 2020 2020 2020 2020 2020 2020  l ..            
+00003d50: 5573 6566 756c 2074 6f20 6869 6465 2074  Useful to hide t
+00003d60: 6865 2072 6561 6c20 636f 6f72 6469 6e61  he real coordina
+00003d70: 7465 7320 6f66 2074 6865 2073 6974 6573  tes of the sites
+00003d80: 2062 7920 6765 6e65 7261 7469 6e67 200d   by generating .
+00003d90: 0a20 2020 2020 2020 2020 2020 2061 2027  .            a '
+00003da0: 6661 6b65 2720 636f 6f72 6469 6e61 7465  fake' coordinate
+00003db0: 7320 666f 7220 6120 7370 6563 6966 6963  s for a specific
+00003dc0: 2070 7572 706f 7365 732e 2057 6865 6e20   purposes. When 
+00003dd0: 7365 7474 696e 6720 746f 2060 6054 7275  setting to ``Tru
+00003de0: 6560 600d 0a20 2020 2020 2020 2020 2020  e``..           
+00003df0: 2062 6520 7375 7265 2074 6f20 7072 6f76   be sure to prov
+00003e00: 6964 6520 7468 6520 6072 6566 6c6f 6e67  ide the `reflong
+00003e10: 6020 616e 6420 6072 6566 6c61 7460 2076  ` and `reflat` v
+00003e20: 616c 7565 7320 6f74 6865 7277 6973 6520  alues otherwise 
+00003e30: 616e 6420 0d0a 2020 2020 2020 2020 2020  and ..          
+00003e40: 2020 6572 726f 7220 7769 6c6c 206f 6363    error will occ
+00003e50: 7572 732e 200d 0a20 2020 2020 2020 2020  urs. ..         
+00003e60: 2020 200d 0a20 2020 2020 2020 2072 6566     ..        ref
+00003e70: 6c6f 6e67 3a20 666c 6f61 7420 6f72 2073  long: float or s
+00003e80: 7472 696e 6720 0d0a 2020 2020 2020 2020  tring ..        
+00003e90: 2020 2020 5265 6665 7265 6e63 6520 6c6f      Reference lo
+00003ea0: 6e67 6974 7564 6520 2069 6e20 6465 6772  ngitude  in degr
+00003eb0: 6565 2064 6563 696d 616c 206f 7220 696e  ee decimal or in
+00003ec0: 2044 443a 4d4d 3a53 5320 666f 7220 7468   DD:MM:SS for th
+00003ed0: 6520 200d 0a20 2020 2020 2020 2020 2020  e  ..           
+00003ee0: 2073 6974 6520 636f 6e73 6964 6572 6564   site considered
+00003ef0: 2061 7320 7468 6520 6f72 6967 696e 206f   as the origin o
+00003f00: 6620 7468 6520 6c61 6d64 6d61 726b 2e0d  f the lamdmark..
+00003f10: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00003f20: 2020 2020 2020 2072 6566 6c61 743a 2066         reflat: f
+00003f30: 6c6f 6174 206f 7220 7374 7269 6e67 200d  loat or string .
+00003f40: 0a20 2020 2020 2020 2020 2020 2052 6566  .            Ref
+00003f50: 6572 656e 6365 206c 6174 6974 7564 6520  erence latitude 
+00003f60: 696e 2064 6567 7265 6520 6465 6369 6d61  in degree decima
+00003f70: 6c20 6f72 2069 6e20 4444 3a4d 4d3a 5353  l or in DD:MM:SS
+00003f80: 2066 6f72 2074 6865 2072 6566 6572 656e   for the referen
+00003f90: 6365 2020 0d0a 2020 2020 2020 2020 2020  ce  ..          
+00003fa0: 2020 7369 7465 2063 6f6e 7369 6465 7265    site considere
+00003fb0: 6420 6173 2074 6865 206c 616e 646d 6172  d as the landmar
+00003fc0: 6b20 6f72 6967 696e 2e0d 0a20 2020 2020  k origin...     
+00003fd0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00003fe0: 2073 7465 703a 2066 6c6f 6174 206f 7220   step: float or 
+00003ff0: 7374 7220 0d0a 2020 2020 2020 2020 2020  str ..          
+00004000: 2020 4f66 6673 6574 206f 7220 7468 6520    Offset or the 
+00004010: 6469 7374 616e 6365 206f 6620 7365 7065  distance of sepe
+00004020: 7261 7469 6f6e 2062 6574 7765 656e 2064  ration between d
+00004030: 6966 6665 7265 6e74 2073 6974 6573 2069  ifferent sites i
+00004040: 6e20 6d65 7465 7273 2e20 0d0a 2020 2020  n meters. ..    
+00004050: 2020 2020 2020 2020 4966 2074 6865 2076          If the v
+00004060: 616c 7565 2069 7320 6769 7665 6e20 6173  alue is given as
+00004070: 2073 7472 696e 6720 7479 7065 2c20 6578   string type, ex
+00004080: 6365 7074 2074 6865 2060 606b 6d60 602c  cept the ``km``,
+00004090: 2069 7420 7368 6f75 6c64 2062 6520 0d0a   it should be ..
+000040a0: 2020 2020 2020 2020 2020 2020 636f 6e73              cons
+000040b0: 6964 6572 6564 2061 7320 6120 6060 6d60  idered as a ``m`
+000040c0: 6020 7661 6c75 652e 204f 6e6c 7920 6d65  ` value. Only me
+000040d0: 7465 7273 2061 6e64 206b 696c 6f6d 6574  ters and kilomet
+000040e0: 6572 7320 6172 6520 6163 6365 7061 626c  ers are accepabl
+000040f0: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
+00004100: 2044 6566 6175 6c74 2076 616c 7565 206f   Default value o
+00004110: 6620 7365 7065 7261 7469 6f6e 2062 6574  f seperation bet
+00004120: 7765 656e 2074 6865 2073 6974 6520 6973  ween the site is
+00004130: 2060 6031 6b6d 6060 2e20 0d0a 2020 2020   ``1km``. ..    
+00004140: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00004150: 2020 2073 6176 6570 6174 683a 2073 7472     savepath: str
+00004160: 200d 0a20 2020 2020 2020 2020 2020 2046   ..            F
+00004170: 756c 6c20 7061 7468 206f 6620 7468 6520  ull path of the 
+00004180: 7361 7665 2064 6972 6563 746f 7279 2e20  save directory. 
+00004190: 4966 206e 6f74 2067 6976 656e 2c20 4544  If not given, ED
+000041a0: 4973 2020 7368 6f75 6c64 2062 6520 0d0a  Is  should be ..
+000041b0: 2020 2020 2020 2020 2020 2020 6f75 7470              outp
+000041c0: 7574 6564 2069 6e20 7468 6520 6372 6561  uted in the crea
+000041d0: 7465 6420 6469 7265 6374 6f72 792e 200d  ted directory. .
+000041e0: 0a20 2020 200d 0a20 2020 2020 2020 2068  .    ..        h
+000041f0: 6f77 3a20 7374 7220 0d0a 2020 2020 2020  ow: str ..      
+00004200: 2020 2020 2020 5468 6520 7761 7920 746f        The way to
+00004210: 2069 6e64 6578 2074 6865 2073 7461 7469   index the stati
+00004220: 6f6e 732e 2044 6566 6175 6c74 2069 7320  ons. Default is 
+00004230: 7468 6520 5079 7468 6f6e 2069 6e64 6578  the Python index
+00004240: 696e 670d 0a20 2020 2020 2020 2020 2020  ing..           
+00004250: 2069 2e65 2e20 7468 6520 636f 756e 7469   i.e. the counti
+00004260: 6e67 2073 7461 7274 7320 6279 2030 2e20  ng starts by 0. 
+00004270: 416e 7920 6f74 6865 7220 7661 6c75 6520  Any other value 
+00004280: 7769 6c6c 2073 7461 7274 2063 6f75 6e74  will start count
+00004290: 696e 6720 0d0a 2020 2020 2020 2020 2020  ing ..          
+000042a0: 2020 7468 6520 7369 7465 2066 726f 6d20    the site from 
+000042b0: 312e 0d0a 2020 2020 2020 2020 2020 2020  1...            
+000042c0: 0d0a 2020 2020 2020 2020 6578 706f 7274  ..        export
+000042d0: 3a20 626f 6f6c 2c20 0d0a 2020 2020 2020  : bool, ..      
+000042e0: 2020 2020 2020 4578 706f 7274 206e 6577        Export new
+000042f0: 2065 6469 2d66 696c 6573 200d 0a20 2020   edi-files ..   
+00004300: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00004310: 2020 206b 7773 3a20 6469 6374 200d 0a20     kws: dict .. 
+00004320: 2020 2020 2020 2020 2020 2041 6464 6974             Addit
+00004330: 696f 6e6e 616c 206b 6579 776f 7264 2061  ionnal keyword a
+00004340: 7267 756d 656e 7473 2066 726f 6d20 607e  rguments from `~
+00004350: 4564 692e 7772 6974 655f 6564 6966 696c  Edi.write_edifil
+00004360: 6560 2061 6e64 200d 0a20 2020 2020 2020  e` and ..       
+00004370: 2020 2020 203a 6675 6e63 3a60 7761 7465       :func:`wate
+00004380: 782e 7574 696c 732e 636f 7265 7574 696c  x.utils.coreutil
+00004390: 732e 6d61 6b65 436f 6f72 6473 602e 200d  s.makeCoords`. .
+000043a0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+000043b0: 2020 2020 2020 2052 6574 7572 6e73 200d         Returns .
+000043c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000043d0: 2d0d 0a20 2020 2020 2020 2045 4d3a 203a  -..        EM: :
+000043e0: 636c 6173 733a 607e 2e45 4d60 2069 6e73  class:`~.EM` ins
+000043f0: 7461 6e63 650d 0a20 2020 2020 2020 2020  tance..         
+00004400: 2020 2020 5265 7475 726e 7320 6060 7365      Returns ``se
+00004410: 6c66 6060 2066 6f72 2065 6173 7920 6d65  lf`` for easy me
+00004420: 7468 6f64 2063 6861 696e 696e 672e 0d0a  thod chaining...
+00004430: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00004440: 2020 2020 2020 4578 616d 706c 6573 0d0a        Examples..
+00004450: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00004460: 2d0d 0a20 2020 2020 2020 203e 3e3e 2066  -..        >>> f
+00004470: 726f 6d20 7761 7465 782e 6d65 7468 6f64  rom watex.method
+00004480: 732e 656d 2069 6d70 6f72 7420 454d 0d0a  s.em import EM..
+00004490: 2020 2020 2020 2020 3e3e 3e20 6564 6970          >>> edip
+000044a0: 6174 6820 3d20 7227 6461 7461 2f65 6469  ath = r'data/edi
+000044b0: 7327 0d0a 2020 2020 2020 2020 3e3e 3e20  s'..        >>> 
+000044c0: 7361 7665 7061 7468 203d 2020 7227 2f55  savepath =  r'/U
+000044d0: 7365 7273 2f44 616e 6965 6c2f 4465 736b  sers/Daniel/Desk
+000044e0: 746f 702f 6564 696f 7574 270d 0a20 2020  top/ediout'..   
+000044f0: 2020 2020 203e 3e3e 2065 6d4f 626a 7320       >>> emObjs 
+00004500: 3d20 454d 2829 2e66 6974 2865 6469 7061  = EM().fit(edipa
+00004510: 7468 290d 0a20 2020 2020 2020 203e 3e3e  th)..        >>>
+00004520: 2065 6d4f 626a 732e 7265 7772 6974 655f   emObjs.rewrite_
+00004530: 6564 6973 2862 793d 2769 6427 2c20 6564  edis(by='id', ed
+00004540: 695f 7072 6566 6978 203d 2762 3127 2c0d  i_prefix ='b1',.
+00004550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00004560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004570: 2020 2020 2020 2073 6176 6570 6174 6820         savepath 
-00004580: 3d73 6176 6570 6174 6829 0d0a 2020 2020  =savepath)..    
-00004590: 2020 2020 3e3e 3e20 2320 0d0a 2020 2020      >>> # ..    
-000045a0: 2020 2020 3e3e 3e20 2320 7365 636f 6e64      >>> # second
-000045b0: 2065 7861 6d70 6c65 2074 6f20 7772 6974   example to writ
-000045c0: 6520 3720 7361 6d70 6c65 7320 6f66 2065  e 7 samples of e
-000045d0: 6469 2066 726f 6d20 0d0a 2020 2020 2020  di from ..      
-000045e0: 2020 3e3e 3e20 2320 4564 6920 6f62 6a65    >>> # Edi obje
-000045f0: 6374 7320 696e 6e65 7220 6461 7461 7365  cts inner datase
-00004600: 7473 200d 0a20 2020 2020 2020 203e 3e3e  ts ..        >>>
-00004610: 2023 0d0a 2020 2020 2020 2020 3e3e 3e20   #..        >>> 
-00004620: 696d 706f 7274 2077 6174 6578 2061 7320  import watex as 
-00004630: 7778 200d 0a20 2020 2020 2020 203e 3e3e  wx ..        >>>
-00004640: 2065 6469 5f73 616d 706c 6520 3d20 7778   edi_sample = wx
-00004650: 2e66 6574 6368 5f64 6174 6120 2827 6564  .fetch_data ('ed
-00004660: 6973 272c 206b 6579 203d 2765 6469 272c  is', key ='edi',
-00004670: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00004570: 2073 6176 6570 6174 6820 3d73 6176 6570   savepath =savep
+00004580: 6174 6829 0d0a 2020 2020 2020 2020 3e3e  ath)..        >>
+00004590: 3e20 2320 0d0a 2020 2020 2020 2020 3e3e  > # ..        >>
+000045a0: 3e20 2320 7365 636f 6e64 2065 7861 6d70  > # second examp
+000045b0: 6c65 2074 6f20 7772 6974 6520 3720 7361  le to write 7 sa
+000045c0: 6d70 6c65 7320 6f66 2065 6469 2066 726f  mples of edi fro
+000045d0: 6d20 0d0a 2020 2020 2020 2020 3e3e 3e20  m ..        >>> 
+000045e0: 2320 4564 6920 6f62 6a65 6374 7320 696e  # Edi objects in
+000045f0: 6e65 7220 6461 7461 7365 7473 200d 0a20  ner datasets .. 
+00004600: 2020 2020 2020 203e 3e3e 2023 0d0a 2020         >>> #..  
+00004610: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+00004620: 2077 6174 6578 2061 7320 7778 200d 0a20   watex as wx .. 
+00004630: 2020 2020 2020 203e 3e3e 2065 6469 5f73         >>> edi_s
+00004640: 616d 706c 6520 3d20 7778 2e66 6574 6368  ample = wx.fetch
+00004650: 5f64 6174 6120 2827 6564 6973 272c 206b  _data ('edis', k
+00004660: 6579 203d 2765 6469 272c 200d 0a20 2020  ey ='edi', ..   
+00004670: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00004680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004690: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-000046a0: 6573 203d 372c 2072 6574 7572 6e5f 6461  es =7, return_da
-000046b0: 7461 203d 5472 7565 2029 200d 0a20 2020  ta =True ) ..   
-000046c0: 2020 2020 203e 3e3e 2065 6d6f 626a 203d       >>> emobj =
-000046d0: 2077 782e 454d 2028 292e 6669 7428 6564   wx.EM ().fit(ed
-000046e0: 695f 7361 6d70 6c65 290d 0a20 2020 2020  i_sample)..     
-000046f0: 2020 203e 3e3e 2065 6d6f 626a 2e72 6577     >>> emobj.rew
-00004700: 7269 7465 2862 793d 2773 7461 7469 6f6e  rite(by='station
-00004710: 272c 2070 7265 6669 783d 2750 5327 290d  ', prefix='PS').
-00004720: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00004730: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00004740: 6465 6620 7265 706c 6163 655f 7265 666c  def replace_refl
-00004750: 6174 6c6f 6e20 2820 206f 6c69 7374 202c  atlon (  olist ,
-00004760: 206e 7661 6c2c 206b 696e 6420 3d27 7265   nval, kind ='re
-00004770: 666c 6174 2729 3a0d 0a20 2020 2020 2020  flat'):..       
-00004780: 2020 2020 2022 2222 2052 6570 6c61 6365       """ Replace
-00004790: 2044 6566 696e 656d 6561 7375 7265 6d65   Definemeasureme
-000047a0: 6e74 2052 6566 6c61 7420 616e 6420 5265  nt Reflat and Re
-000047b0: 666c 6f6e 6720 6279 2074 6865 2069 6e74  flong by the int
-000047c0: 6572 706f 6c61 7465 640d 0a20 2020 2020  erpolated..     
-000047d0: 2020 2020 2020 2076 616c 7565 732e 0d0a         values...
-000047e0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-000047f0: 2020 2020 2020 2020 2020 3a70 6172 616d            :param
-00004800: 206f 6c69 7374 3a20 6f6c 6420 6c69 7374   olist: old list
-00004810: 2063 6f6d 706f 7369 6e67 2074 6865 2072   composing the r
-00004820: 6561 6420 4544 4920 6d65 6173 7572 656d  ead EDI measurem
-00004830: 656e 7420 696e 666f 732e 0d0a 2020 2020  ent infos...    
-00004840: 2020 2020 2020 2020 3a74 7970 6520 6f6c          :type ol
-00004850: 6973 743a 206c 6973 7420 0d0a 2020 2020  ist: list ..    
-00004860: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-00004870: 7661 6c3a 204e 6577 2072 6566 6c61 7420  val: New reflat 
-00004880: 6f72 2072 6566 6c6f 6e67 206c 6973 742e  or reflong list.
-00004890: 204d 6f73 746c 7920 6973 2074 6865 2044   Mostly is the D
-000048a0: 443a 4d4d 3a53 5320 0d0a 2020 2020 2020  D:MM:SS ..      
-000048b0: 2020 2020 2020 2020 2020 7661 6c75 6520            value 
-000048c0: 696e 7465 7270 6f6c 6174 6564 2e20 0d0a  interpolated. ..
-000048d0: 2020 2020 2020 2020 2020 2020 3a70 6172              :par
-000048e0: 616d 206b 696e 643a 2054 7970 6520 6f66  am kind: Type of
-000048f0: 206d 6561 7375 7265 6d65 6e74 2074 6f20   measurement to 
-00004900: 7772 6974 652e 200d 0a20 2020 2020 2020  write. ..       
-00004910: 2020 2020 203a 7479 7065 206b 696e 643a       :type kind:
-00004920: 7374 7220 0d0a 2020 2020 2020 2020 2020  str ..          
-00004930: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00004940: 3a72 6574 7572 6e3a 204c 6973 7420 6f66  :return: List of
-00004950: 206f 6c64 2065 6c65 6d65 6e74 2072 6570   old element rep
-00004960: 6c61 6365 642e 200d 0a20 2020 2020 2020  laced. ..       
-00004970: 2020 2020 203a 7274 7970 653a 206c 6973       :rtype: lis
-00004980: 7420 0d0a 2020 2020 2020 2020 2020 2020  t ..            
-00004990: 2222 220d 0a20 2020 2020 2020 2020 2020  """..           
-000049a0: 2074 7279 203a 200d 0a20 2020 2020 2020   try : ..       
-000049b0: 2020 2020 2020 2020 2066 6f72 2069 692c           for ii,
-000049c0: 2063 6f6d 7020 696e 2065 6e75 6d65 7261   comp in enumera
-000049d0: 7465 2028 6f6c 6973 7429 3a0d 0a20 2020  te (olist):..   
-000049e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000049f0: 2069 6620 636f 6d70 2e73 7472 6970 2829   if comp.strip()
-00004a00: 2e66 696e 6428 6b69 6e64 293e 3d30 3a20  .find(kind)>=0: 
-00004a10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00004a20: 2020 2020 2020 2020 2020 6f6c 6973 745b            olist[
-00004a30: 6969 5d3d 2066 2720 7b6b 696e 647d 3d7b  ii]= f' {kind}={
-00004a40: 6e76 616c 7d5c 6e27 0d0a 2020 2020 2020  nval}\n'..      
-00004a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a60: 2020 6272 6561 6b20 0d0a 2020 2020 2020    break ..      
-00004a70: 2020 2020 2020 6578 6365 7074 3a0d 0a20        except:.. 
-00004a80: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00004a90: 6173 730d 0a20 2020 2020 2020 2020 2020  ass..           
-00004aa0: 2072 6574 7572 6e20 6f6c 6973 740d 0a20   return olist.. 
-00004ab0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00004ac0: 2072 6567 6578 203d 2072 652e 636f 6d70   regex = re.comp
-00004ad0: 696c 6528 275c 642b 272c 2072 652e 4947  ile('\d+', re.IG
-00004ae0: 4e4f 5245 4341 5345 290d 0a20 2020 2020  NORECASE)..     
-00004af0: 2020 2062 7920 3d20 7374 7228 6279 292e     by = str(by).
-00004b00: 6c6f 7765 7228 2920 0d0a 2020 2020 2020  lower() ..      
-00004b10: 2020 6966 2062 792e 6669 6e64 2827 7375    if by.find('su
-00004b20: 7276 6579 2729 3e3d 3020 3a0d 0a20 2020  rvey')>=0 :..   
-00004b30: 2020 2020 2020 2020 2062 7920 3d27 6e61           by ='na
-00004b40: 6d65 270d 0a20 2020 2020 2020 200d 0a20  me'..        .. 
-00004b50: 2020 2020 2020 2070 7265 6669 7820 3d20         prefix = 
-00004b60: 7374 7228 7072 6566 6978 2920 0d0a 0d0a  str(prefix) ....
-00004b70: 2020 2020 2020 2020 7365 6c66 2e69 6e73          self.ins
-00004b80: 7065 6374 200d 0a20 2020 2020 2020 200d  pect ..        .
-00004b90: 0a20 2020 2020 2020 2073 656c 662e 6964  .        self.id
-00004ba0: 203d 206d 616b 655f 6964 7328 7365 6c66   = make_ids(self
-00004bb0: 2e65 6469 4f62 6a73 5f2c 2070 7265 6669  .ediObjs_, prefi
-00004bc0: 783d 2753 272c 2068 6f77 3d20 686f 7720  x='S', how= how 
-00004bd0: 290d 0a20 2020 2020 2020 2020 2020 0d0a  )..           ..
-00004be0: 2020 2020 2020 2020 6966 2068 6f77 2021          if how !
-00004bf0: 3d27 7079 273a 200d 0a20 2020 2020 2020  ='py': ..       
-00004c00: 2020 2020 2073 656c 662e 6964 203d 206d       self.id = m
-00004c10: 616b 655f 6964 7328 7365 6c66 2e65 6469  ake_ids(self.edi
-00004c20: 4f62 6a73 5f2c 2070 7265 6669 783d 2753  Objs_, prefix='S
-00004c30: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
+00004690: 2020 2020 2073 616d 706c 6573 203d 372c       samples =7,
+000046a0: 2072 6574 7572 6e5f 6461 7461 203d 5472   return_data =Tr
+000046b0: 7565 2029 200d 0a20 2020 2020 2020 203e  ue ) ..        >
+000046c0: 3e3e 2065 6d6f 626a 203d 2077 782e 454d  >> emobj = wx.EM
+000046d0: 2028 292e 6669 7428 6564 695f 7361 6d70   ().fit(edi_samp
+000046e0: 6c65 290d 0a20 2020 2020 2020 203e 3e3e  le)..        >>>
+000046f0: 2065 6d6f 626a 2e72 6577 7269 7465 2862   emobj.rewrite(b
+00004700: 793d 2773 7461 7469 6f6e 272c 2070 7265  y='station', pre
+00004710: 6669 783d 2750 5327 290d 0a20 2020 2020  fix='PS')..     
+00004720: 2020 200d 0a20 2020 2020 2020 2022 2222     ..        """
+00004730: 0d0a 2020 2020 2020 2020 6465 6620 7265  ..        def re
+00004740: 706c 6163 655f 7265 666c 6174 6c6f 6e20  place_reflatlon 
+00004750: 2820 206f 6c69 7374 202c 206e 7661 6c2c  (  olist , nval,
+00004760: 206b 696e 6420 3d27 7265 666c 6174 2729   kind ='reflat')
+00004770: 3a0d 0a20 2020 2020 2020 2020 2020 2022  :..            "
+00004780: 2222 2052 6570 6c61 6365 2044 6566 696e  "" Replace Defin
+00004790: 656d 6561 7375 7265 6d65 6e74 2052 6566  emeasurement Ref
+000047a0: 6c61 7420 616e 6420 5265 666c 6f6e 6720  lat and Reflong 
+000047b0: 6279 2074 6865 2069 6e74 6572 706f 6c61  by the interpola
+000047c0: 7465 640d 0a20 2020 2020 2020 2020 2020  ted..           
+000047d0: 2076 616c 7565 732e 0d0a 2020 2020 2020   values...      
+000047e0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000047f0: 2020 2020 3a70 6172 616d 206f 6c69 7374      :param olist
+00004800: 3a20 6f6c 6420 6c69 7374 2063 6f6d 706f  : old list compo
+00004810: 7369 6e67 2074 6865 2072 6561 6420 4544  sing the read ED
+00004820: 4920 6d65 6173 7572 656d 656e 7420 696e  I measurement in
+00004830: 666f 732e 0d0a 2020 2020 2020 2020 2020  fos...          
+00004840: 2020 3a74 7970 6520 6f6c 6973 743a 206c    :type olist: l
+00004850: 6973 7420 0d0a 2020 2020 2020 2020 2020  ist ..          
+00004860: 2020 3a70 6172 616d 206e 7661 6c3a 204e    :param nval: N
+00004870: 6577 2072 6566 6c61 7420 6f72 2072 6566  ew reflat or ref
+00004880: 6c6f 6e67 206c 6973 742e 204d 6f73 746c  long list. Mostl
+00004890: 7920 6973 2074 6865 2044 443a 4d4d 3a53  y is the DD:MM:S
+000048a0: 5320 0d0a 2020 2020 2020 2020 2020 2020  S ..            
+000048b0: 2020 2020 7661 6c75 6520 696e 7465 7270      value interp
+000048c0: 6f6c 6174 6564 2e20 0d0a 2020 2020 2020  olated. ..      
+000048d0: 2020 2020 2020 3a70 6172 616d 206b 696e        :param kin
+000048e0: 643a 2054 7970 6520 6f66 206d 6561 7375  d: Type of measu
+000048f0: 7265 6d65 6e74 2074 6f20 7772 6974 652e  rement to write.
+00004900: 200d 0a20 2020 2020 2020 2020 2020 203a   ..            :
+00004910: 7479 7065 206b 696e 643a 7374 7220 0d0a  type kind:str ..
+00004920: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00004930: 2020 2020 2020 2020 2020 3a72 6574 7572            :retur
+00004940: 6e3a 204c 6973 7420 6f66 206f 6c64 2065  n: List of old e
+00004950: 6c65 6d65 6e74 2072 6570 6c61 6365 642e  lement replaced.
+00004960: 200d 0a20 2020 2020 2020 2020 2020 203a   ..            :
+00004970: 7274 7970 653a 206c 6973 7420 0d0a 2020  rtype: list ..  
+00004980: 2020 2020 2020 2020 2020 2222 220d 0a20            """.. 
+00004990: 2020 2020 2020 2020 2020 2074 7279 203a             try :
+000049a0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000049b0: 2020 2066 6f72 2069 692c 2063 6f6d 7020     for ii, comp 
+000049c0: 696e 2065 6e75 6d65 7261 7465 2028 6f6c  in enumerate (ol
+000049d0: 6973 7429 3a0d 0a20 2020 2020 2020 2020  ist):..         
+000049e0: 2020 2020 2020 2020 2020 2069 6620 636f             if co
+000049f0: 6d70 2e73 7472 6970 2829 2e66 696e 6428  mp.strip().find(
+00004a00: 6b69 6e64 293e 3d30 3a20 0d0a 2020 2020  kind)>=0: ..    
+00004a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004a20: 2020 2020 6f6c 6973 745b 6969 5d3d 2066      olist[ii]= f
+00004a30: 2720 7b6b 696e 647d 3d7b 6e76 616c 7d5c  ' {kind}={nval}\
+00004a40: 6e27 0d0a 2020 2020 2020 2020 2020 2020  n'..            
+00004a50: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00004a60: 6b20 0d0a 2020 2020 2020 2020 2020 2020  k ..            
+00004a70: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+00004a80: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
+00004a90: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00004aa0: 6e20 6f6c 6973 740d 0a20 2020 2020 2020  n olist..       
+00004ab0: 200d 0a20 2020 2020 2020 2072 6567 6578   ..        regex
+00004ac0: 203d 2072 652e 636f 6d70 696c 6528 275c   = re.compile('\
+00004ad0: 642b 272c 2072 652e 4947 4e4f 5245 4341  d+', re.IGNORECA
+00004ae0: 5345 290d 0a20 2020 2020 2020 2062 7920  SE)..        by 
+00004af0: 3d20 7374 7228 6279 292e 6c6f 7765 7228  = str(by).lower(
+00004b00: 2920 0d0a 2020 2020 2020 2020 6966 2062  ) ..        if b
+00004b10: 792e 6669 6e64 2827 7375 7276 6579 2729  y.find('survey')
+00004b20: 3e3d 3020 3a0d 0a20 2020 2020 2020 2020  >=0 :..         
+00004b30: 2020 2062 7920 3d27 6e61 6d65 270d 0a20     by ='name'.. 
+00004b40: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00004b50: 2070 7265 6669 7820 3d20 7374 7228 7072   prefix = str(pr
+00004b60: 6566 6978 2920 0d0a 0d0a 2020 2020 2020  efix) ....      
+00004b70: 2020 7365 6c66 2e69 6e73 7065 6374 200d    self.inspect .
+00004b80: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00004b90: 2020 2073 656c 662e 6964 203d 206d 616b     self.id = mak
+00004ba0: 655f 6964 7328 7365 6c66 2e65 6469 4f62  e_ids(self.ediOb
+00004bb0: 6a73 5f2c 2070 7265 6669 783d 2753 272c  js_, prefix='S',
+00004bc0: 2068 6f77 3d20 686f 7720 290d 0a20 2020   how= how )..   
+00004bd0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00004be0: 2020 6966 2068 6f77 2021 3d27 7079 273a    if how !='py':
+00004bf0: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
+00004c00: 656c 662e 6964 203d 206d 616b 655f 6964  elf.id = make_id
+00004c10: 7328 7365 6c66 2e65 6469 4f62 6a73 5f2c  s(self.ediObjs_,
+00004c20: 2070 7265 6669 783d 2753 272c 0d0a 2020   prefix='S',..  
+00004c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00004c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004c50: 2020 2020 2020 2020 636d 6f64 6520 3d4e          cmode =N
-00004c60: 6f6e 6529 2020 0d0a 2020 2020 2020 2020  one)  ..        
-00004c70: 6966 2064 6174 6169 6420 6973 204e 6f6e  if dataid is Non
-00004c80: 653a 200d 0a20 2020 2020 2020 2020 2020  e: ..           
-00004c90: 2069 6620 7072 6566 6978 2021 3d27 4e6f   if prefix !='No
-00004ca0: 6e65 2720 3a20 0d0a 2020 2020 2020 2020  ne' : ..        
-00004cb0: 2020 2020 2020 2020 6461 7461 6964 203d          dataid =
-00004cc0: 206c 6973 7428 6d61 7028 6c61 6d62 6461   list(map(lambda
-00004cd0: 2073 3a20 732e 7265 706c 6163 6528 2753   s: s.replace('S
-00004ce0: 272c 2070 7265 6669 7829 2c20 7365 6c66  ', prefix), self
-00004cf0: 2e69 6429 290d 0a20 2020 2020 2020 2020  .id))..         
-00004d00: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00004d10: 2020 2020 2065 6c69 6620 6279 203d 3d27       elif by =='
-00004d20: 6e61 6d65 273a 200d 0a20 2020 2020 2020  name': ..       
-00004d30: 2020 2020 2020 2020 2023 2067 6574 2074           # get t
-00004d40: 6865 2066 6972 7374 206e 616d 6520 6f66  he first name of
-00004d50: 2064 6174 6149 6420 6f66 2074 6865 2045   dataId of the E
-00004d60: 4449 2065 6469 4f62 6a73 2020 616e 6420  DI ediObjs  and 
-00004d70: 6669 6c6c 6564 0d0a 2020 2020 2020 2020  filled..        
-00004d80: 2020 2020 2020 2020 2320 7468 6520 7265          # the re
-00004d90: 6e61 6d65 2064 6174 6149 642e 2072 656d  name dataId. rem
-00004da0: 6f76 6520 7468 6520 7472 6169 6c27 5f27  ove the trail'_'
-00004db0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00004dc0: 2020 2020 6e61 6d65 203d 2073 656c 662e      name = self.
-00004dd0: 7375 7276 6579 5f6e 616d 6520 6f72 2020  survey_name or  
-00004de0: 7265 6765 782e 7375 6228 0d0a 2020 2020  regex.sub(..    
-00004df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004e00: 2727 2c20 7365 6c66 2e65 6469 4f62 6a73  '', self.ediObjs
-00004e10: 5f5b 305d 2e48 6561 642e 6461 7461 6964  _[0].Head.dataid
-00004e20: 292e 7265 706c 6163 6528 275f 272c 2027  ).replace('_', '
-00004e30: 2729 200d 0a20 2020 2020 2020 2020 2020  ') ..           
-00004e40: 2020 2020 2023 2072 656d 6f76 6520 7072       # remove pr
-00004e50: 6566 6978 2029 2753 2720 616e 6420 6b65  efix )'S' and ke
-00004e60: 6570 206f 6e6c 7920 7468 6520 6469 6769  ep only the digi
-00004e70: 7420 0d0a 2020 2020 2020 2020 2020 2020  t ..            
-00004e80: 2020 2020 6461 7461 6964 203d 206c 6973      dataid = lis
-00004e90: 7428 6d61 7028 6c61 6d62 6461 206e 3a20  t(map(lambda n: 
-00004ea0: 6e61 6d65 202b 206e 2c20 7265 6765 782e  name + n, regex.
-00004eb0: 6669 6e64 616c 6c28 0d0a 2020 2020 2020  findall(..      
-00004ec0: 2020 2020 2020 2020 2020 2020 2020 2727                ''
-00004ed0: 2e6a 6f69 6e28 7365 6c66 2e69 6429 2920  .join(self.id)) 
-00004ee0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00004ef0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-00004f00: 2020 656c 6966 2062 792e 6669 6e64 2827    elif by.find('
-00004f10: 6e75 6d27 293e 3d30 3a20 0d0a 2020 2020  num')>=0: ..    
-00004f20: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00004f30: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00004f40: 6964 203d 2072 6567 6578 2e66 696e 6461  id = regex.finda
-00004f50: 6c6c 2827 272e 6a6f 696e 2873 656c 662e  ll(''.join(self.
-00004f60: 6964 2929 2020 0d0a 2020 2020 2020 2020  id))  ..        
-00004f70: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00004f80: 2020 2020 2065 6c69 6620 6279 203d 3d27       elif by =='
-00004f90: 6964 273a 200d 0a20 2020 2020 2020 2020  id': ..         
-00004fa0: 2020 2020 2020 2064 6174 6169 6420 3d20         dataid = 
-00004fb0: 7365 6c66 2e69 6420 0d0a 2020 2020 2020  self.id ..      
-00004fc0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00004fd0: 2020 2020 2020 2020 656c 6966 2062 7920          elif by 
-00004fe0: 3d3d 2769 7827 3a20 0d0a 2020 2020 2020  =='ix': ..      
-00004ff0: 2020 2020 2020 2020 2020 6461 7461 6964            dataid
-00005000: 203d 206c 6973 7428 6d61 7028 0d0a 2020   = list(map(..  
-00005010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005020: 2020 6c61 6d62 6461 2078 3a20 7374 7228    lambda x: str(
-00005030: 696e 7428 7829 292c 2072 6567 6578 2e66  int(x)), regex.f
-00005040: 696e 6461 6c6c 2827 272e 6a6f 696e 2873  indall(''.join(s
-00005050: 656c 662e 6964 2929 2929 2020 0d0a 2020  elf.id))))  ..  
-00005060: 2020 2020 2020 2020 2020 656c 7365 203a            else :
-00005070: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005080: 2020 6461 7461 6964 203d 206c 6973 7428    dataid = list(
-00005090: 6d61 7028 6c61 6d62 6461 206f 626a 3a20  map(lambda obj: 
-000050a0: 6f62 6a2e 4865 6164 2e64 6174 6169 642c  obj.Head.dataid,
-000050b0: 2073 656c 662e 6564 694f 626a 735f 2929   self.ediObjs_))
-000050c0: 0d0a 0d0a 2020 2020 2020 2020 656c 6966  ....        elif
-000050d0: 2064 6174 6169 6420 6973 206e 6f74 204e   dataid is not N
-000050e0: 6f6e 653a 200d 0a20 2020 2020 2020 2020  one: ..         
-000050f0: 2020 2069 6620 6e6f 7420 6e70 2e69 7465     if not np.ite
-00005100: 7261 626c 6528 6461 7461 6964 293a 200d  rable(dataid): .
-00005110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005120: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00005130: 7228 2744 6174 6149 6420 7061 7261 6d65  r('DataId parame
-00005140: 7465 7220 7368 6f75 6c64 2062 6520 616e  ter should be an
-00005150: 2069 7465 7261 626c 6520 270d 0a20 2020   iterable '..   
+00004c50: 2020 636d 6f64 6520 3d4e 6f6e 6529 2020    cmode =None)  
+00004c60: 0d0a 2020 2020 2020 2020 6966 2064 6174  ..        if dat
+00004c70: 6169 6420 6973 204e 6f6e 653a 200d 0a20  aid is None: .. 
+00004c80: 2020 2020 2020 2020 2020 2069 6620 7072             if pr
+00004c90: 6566 6978 2021 3d27 4e6f 6e65 2720 3a20  efix !='None' : 
+00004ca0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004cb0: 2020 6461 7461 6964 203d 206c 6973 7428    dataid = list(
+00004cc0: 6d61 7028 6c61 6d62 6461 2073 3a20 732e  map(lambda s: s.
+00004cd0: 7265 706c 6163 6528 2753 272c 2070 7265  replace('S', pre
+00004ce0: 6669 7829 2c20 7365 6c66 2e69 6429 290d  fix), self.id)).
+00004cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004d00: 200d 0a20 2020 2020 2020 2020 2020 2065   ..            e
+00004d10: 6c69 6620 6279 203d 3d27 6e61 6d65 273a  lif by =='name':
+00004d20: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00004d30: 2020 2023 2067 6574 2074 6865 2066 6972     # get the fir
+00004d40: 7374 206e 616d 6520 6f66 2064 6174 6149  st name of dataI
+00004d50: 6420 6f66 2074 6865 2045 4449 2065 6469  d of the EDI edi
+00004d60: 4f62 6a73 2020 616e 6420 6669 6c6c 6564  Objs  and filled
+00004d70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004d80: 2020 2320 7468 6520 7265 6e61 6d65 2064    # the rename d
+00004d90: 6174 6149 642e 2072 656d 6f76 6520 7468  ataId. remove th
+00004da0: 6520 7472 6169 6c27 5f27 2020 0d0a 2020  e trail'_'  ..  
+00004db0: 2020 2020 2020 2020 2020 2020 2020 6e61                na
+00004dc0: 6d65 203d 2073 656c 662e 7375 7276 6579  me = self.survey
+00004dd0: 5f6e 616d 6520 6f72 2020 7265 6765 782e  _name or  regex.
+00004de0: 7375 6228 0d0a 2020 2020 2020 2020 2020  sub(..          
+00004df0: 2020 2020 2020 2020 2020 2727 2c20 7365            '', se
+00004e00: 6c66 2e65 6469 4f62 6a73 5f5b 305d 2e48  lf.ediObjs_[0].H
+00004e10: 6561 642e 6461 7461 6964 292e 7265 706c  ead.dataid).repl
+00004e20: 6163 6528 275f 272c 2027 2729 200d 0a20  ace('_', '') .. 
+00004e30: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00004e40: 2072 656d 6f76 6520 7072 6566 6978 2029   remove prefix )
+00004e50: 2753 2720 616e 6420 6b65 6570 206f 6e6c  'S' and keep onl
+00004e60: 7920 7468 6520 6469 6769 7420 0d0a 2020  y the digit ..  
+00004e70: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00004e80: 7461 6964 203d 206c 6973 7428 6d61 7028  taid = list(map(
+00004e90: 6c61 6d62 6461 206e 3a20 6e61 6d65 202b  lambda n: name +
+00004ea0: 206e 2c20 7265 6765 782e 6669 6e64 616c   n, regex.findal
+00004eb0: 6c28 0d0a 2020 2020 2020 2020 2020 2020  l(..            
+00004ec0: 2020 2020 2020 2020 2727 2e6a 6f69 6e28          ''.join(
+00004ed0: 7365 6c66 2e69 6429 2920 2929 0d0a 2020  self.id)) ))..  
+00004ee0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+00004ef0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00004f00: 2062 792e 6669 6e64 2827 6e75 6d27 293e   by.find('num')>
+00004f10: 3d30 3a20 0d0a 2020 2020 2020 2020 2020  =0: ..          
+00004f20: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00004f30: 2020 2020 2020 6461 7461 6964 203d 2072        dataid = r
+00004f40: 6567 6578 2e66 696e 6461 6c6c 2827 272e  egex.findall(''.
+00004f50: 6a6f 696e 2873 656c 662e 6964 2929 2020  join(self.id))  
+00004f60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004f70: 200d 0a20 2020 2020 2020 2020 2020 2065   ..            e
+00004f80: 6c69 6620 6279 203d 3d27 6964 273a 200d  lif by =='id': .
+00004f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004fa0: 2064 6174 6169 6420 3d20 7365 6c66 2e69   dataid = self.i
+00004fb0: 6420 0d0a 2020 2020 2020 2020 2020 2020  d ..            
+00004fc0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00004fd0: 2020 656c 6966 2062 7920 3d3d 2769 7827    elif by =='ix'
+00004fe0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00004ff0: 2020 2020 6461 7461 6964 203d 206c 6973      dataid = lis
+00005000: 7428 6d61 7028 0d0a 2020 2020 2020 2020  t(map(..        
+00005010: 2020 2020 2020 2020 2020 2020 6c61 6d62              lamb
+00005020: 6461 2078 3a20 7374 7228 696e 7428 7829  da x: str(int(x)
+00005030: 292c 2072 6567 6578 2e66 696e 6461 6c6c  ), regex.findall
+00005040: 2827 272e 6a6f 696e 2873 656c 662e 6964  (''.join(self.id
+00005050: 2929 2929 2020 0d0a 2020 2020 2020 2020  ))))  ..        
+00005060: 2020 2020 656c 7365 203a 0d0a 2020 2020      else :..    
+00005070: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00005080: 6964 203d 206c 6973 7428 6d61 7028 6c61  id = list(map(la
+00005090: 6d62 6461 206f 626a 3a20 6f62 6a2e 4865  mbda obj: obj.He
+000050a0: 6164 2e64 6174 6169 642c 2073 656c 662e  ad.dataid, self.
+000050b0: 6564 694f 626a 735f 2929 0d0a 0d0a 2020  ediObjs_))....  
+000050c0: 2020 2020 2020 656c 6966 2064 6174 6169        elif datai
+000050d0: 6420 6973 206e 6f74 204e 6f6e 653a 200d  d is not None: .
+000050e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000050f0: 6e6f 7420 6e70 2e69 7465 7261 626c 6528  not np.iterable(
+00005100: 6461 7461 6964 293a 200d 0a20 2020 2020  dataid): ..     
+00005110: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00005120: 2056 616c 7565 4572 726f 7228 2744 6174   ValueError('Dat
+00005130: 6149 6420 7061 7261 6d65 7465 7220 7368  aId parameter sh
+00005140: 6f75 6c64 2062 6520 616e 2069 7465 7261  ould be an itera
+00005150: 626c 6520 270d 0a20 2020 2020 2020 2020  ble '..         
 00005160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005170: 2020 2020 2020 2020 2020 2020 2020 6627                f'
-00005180: 6f62 6a65 6374 2c20 6e6f 7420 7b74 7970  object, not {typ
-00005190: 6528 6461 7461 6964 292e 5f5f 6e61 6d65  e(dataid).__name
-000051a0: 5f5f 2172 7d27 290d 0a20 2020 2020 2020  __!r}')..       
-000051b0: 2020 2020 2069 6620 6c65 6e28 6461 7461       if len(data
-000051c0: 6964 2920 213d 206c 656e 2873 656c 662e  id) != len(self.
-000051d0: 6564 694f 626a 735f 293a 200d 0a20 2020  ediObjs_): ..   
-000051e0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-000051f0: 7365 2056 616c 7565 4572 726f 7220 280d  se ValueError (.
-00005200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005210: 2020 2020 2027 4461 7461 4964 206c 656e       'DataId len
-00005220: 6774 6820 6d75 7374 2068 6176 6520 7468  gth must have th
-00005230: 6520 7361 6d65 206c 656e 6774 6820 7769  e same length wi
-00005240: 7468 2074 6865 206e 756d 6265 7227 0d0a  th the number'..
-00005250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005260: 2020 2020 2720 6f66 2063 6f6c 6c65 6374      ' of collect
-00005270: 6564 2045 4449 7328 7b30 7d29 2e20 4275  ed EDIs({0}). Bu
-00005280: 7420 7b31 7d20 7b32 7d20 6769 7665 6e2e  t {1} {2} given.
-00005290: 272e 666f 726d 6174 280d 0a20 2020 2020  '.format(..     
-000052a0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-000052b0: 656e 2873 656c 662e 6564 694f 626a 735f  en(self.ediObjs_
-000052c0: 292c 206c 656e 2864 6174 6169 6429 2c0d  ), len(dataid),.
-000052d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000052e0: 2020 2020 2066 227b 2769 7327 2069 6620       f"{'is' if 
-000052f0: 6c65 6e28 6461 7461 6964 293c 3d31 2065  len(dataid)<=1 e
-00005300: 6c73 6520 2761 7265 277d 2229 290d 0a20  lse 'are'}")).. 
-00005310: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00005320: 6c6f 6e67 2c20 6c61 7420 3d20 7365 6c66  long, lat = self
-00005330: 2e6c 6f6e 6769 7475 6465 2c20 7365 6c66  .longitude, self
-00005340: 2e6c 6174 6974 7564 6520 0d0a 2020 2020  .latitude ..    
-00005350: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
-00005360: 206d 616b 655f 636f 6f72 6473 3a20 0d0a   make_coords: ..
-00005370: 2020 2020 2020 2020 2020 2020 6966 2028              if (
-00005380: 7265 666c 6f6e 6720 6f72 2072 6566 6c61  reflong or refla
-00005390: 7429 2069 7320 4e6f 6e65 3a20 0d0a 2020  t) is None: ..  
-000053a0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000053b0: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
-000053c0: 5265 666c 6f6e 6720 616e 6420 7265 666c  Reflong and refl
-000053d0: 6174 2070 6172 616d 7320 6d75 7374 206e  at params must n
-000053e0: 6f74 2062 6520 4e6f 6e65 2127 290d 0a20  ot be None!').. 
-000053f0: 2020 2020 2020 2020 2020 206c 6f6e 672c             long,
-00005400: 206c 6174 203d 206d 616b 6543 6f6f 7264   lat = makeCoord
-00005410: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
-00005420: 2020 2072 6566 6c6f 6e67 203d 2072 6566     reflong = ref
-00005430: 6c6f 6e67 2c20 7265 666c 6174 3d20 7265  long, reflat= re
-00005440: 666c 6174 2c20 6e73 6974 6573 3d20 6c65  flat, nsites= le
-00005450: 6e28 7365 6c66 2e65 6469 4f62 6a73 5f29  n(self.ediObjs_)
-00005460: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00005470: 2020 7374 6570 203d 2073 7465 7020 2c20    step = step , 
-00005480: 2a2a 6b77 7329 200d 0a20 2020 2020 2020  **kws) ..       
-00005490: 2023 2063 6c65 616e 2074 6865 206f 6c64   # clean the old
-000054a0: 206d 6169 6e20 4564 6920 7365 6374 696f   main Edi sectio
-000054b0: 6e20 696e 666f 2061 6e64 200d 0a20 2020  n info and ..   
-000054c0: 2020 2020 2023 2061 6e64 2067 6574 2074       # and get t
-000054d0: 6865 206e 6577 2076 616c 7565 730d 0a20  he new values.. 
-000054e0: 2020 2020 2020 2069 6620 636f 7272 6563         if correc
-000054f0: 745f 6c6c 3a0d 0a20 2020 2020 2020 2020  t_ll:..         
-00005500: 2020 206c 6f6e 646d 732c 2a5f 203d 2073     londms,*_ = s
-00005510: 6361 6c65 506f 7369 7469 6f6e 2873 656c  calePosition(sel
-00005520: 662e 6c6f 6e67 6974 7564 6529 0d0a 2020  f.longitude)..  
-00005530: 2020 2020 2020 2020 2020 6c61 7464 6d73            latdms
-00005540: 2c2a 5f20 3d20 7363 616c 6550 6f73 6974  ,*_ = scalePosit
-00005550: 696f 6e28 7365 6c66 2e6c 6174 6974 7564  ion(self.latitud
-00005560: 6529 200d 0a0d 0a20 2020 2020 2020 2023  e) ....        #
-00005570: 2063 6f6c 6c65 6374 206e 6577 2065 6469   collect new edi
-00005580: 4f62 6a73 200d 0a20 2020 2020 2020 2063  Objs ..        c
-00005590: 6f62 6a73 203d 206e 702e 7a65 726f 735f  objs = np.zeros_
-000055a0: 6c69 6b65 2028 7365 6c66 2e65 6469 4f62  like (self.ediOb
-000055b0: 6a73 5f2c 2064 7479 7065 3d6f 626a 6563  js_, dtype=objec
-000055c0: 7420 2920 0d0a 2020 2020 2020 2020 0d0a  t ) ..        ..
-000055d0: 2020 2020 2020 2020 666f 7220 6b2c 2028          for k, (
-000055e0: 6f62 6a2c 2064 6964 2920 696e 2065 6e75  obj, did) in enu
-000055f0: 6d65 7261 7465 287a 6970 2873 656c 662e  merate(zip(self.
-00005600: 6564 694f 626a 735f 2c20 6461 7461 6964  ediObjs_, dataid
-00005610: 2929 3a20 0d0a 2020 2020 2020 2020 2020  )): ..          
-00005620: 2020 6f62 6a2e 4865 6164 2e65 6469 5f68    obj.Head.edi_h
-00005630: 6561 6465 7220 3d20 4e6f 6e65 2020 0d0a  eader = None  ..
-00005640: 2020 2020 2020 2020 2020 2020 6f62 6a2e              obj.
-00005650: 4865 6164 2e64 6174 6169 6420 3d20 6469  Head.dataid = di
-00005660: 6420 0d0a 2020 2020 2020 2020 2020 2020  d ..            
-00005670: 6f62 6a2e 496e 666f 2e65 6469 696e 666f  obj.Info.ediinfo
-00005680: 203d 204e 6f6e 6520 0d0a 2020 2020 2020   = None ..      
-00005690: 2020 2020 2020 6966 2063 6f72 7265 6374        if correct
-000056a0: 5f6c 6c20 6f72 206d 616b 655f 636f 6f72  _ll or make_coor
-000056b0: 6473 3a0d 0a20 2020 2020 2020 2020 2020  ds:..           
-000056c0: 2020 2020 206f 626a 2e48 6561 642e 6c6f       obj.Head.lo
-000056d0: 6e67 203d 2066 6c6f 6174 286c 6f6e 675b  ng = float(long[
-000056e0: 6b5d 290d 0a20 2020 2020 2020 2020 2020  k])..           
-000056f0: 2020 2020 206f 626a 2e48 6561 642e 6c61       obj.Head.la
-00005700: 7420 3d20 666c 6f61 7428 6c61 745b 6b5d  t = float(lat[k]
-00005710: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00005720: 2020 206f 626a 2e48 6561 642e 656c 6576     obj.Head.elev
-00005730: 203d 2066 6c6f 6174 2873 656c 662e 656c   = float(self.el
-00005740: 6576 6174 696f 6e5b 6b5d 290d 0a20 2020  evation[k])..   
-00005750: 2020 2020 2020 2020 2020 2020 206f 6320               oc 
-00005760: 3d20 6f62 6a2e 4465 6669 6e65 4d65 6173  = obj.DefineMeas
-00005770: 7572 656d 656e 742e 6465 6669 6e65 5f6d  urement.define_m
-00005780: 6561 7375 7265 6d65 6e74 0d0a 2020 2020  easurement..    
-00005790: 2020 2020 2020 2020 2020 2020 6f63 3d20              oc= 
-000057a0: 7265 706c 6163 655f 7265 666c 6174 6c6f  replace_reflatlo
-000057b0: 6e28 6f63 2c20 6e76 616c 3d20 6c61 7464  n(oc, nval= latd
-000057c0: 6d73 5b6b 5d29 0d0a 2020 2020 2020 2020  ms[k])..        
-000057d0: 2020 2020 2020 2020 6f63 3d20 7265 706c          oc= repl
-000057e0: 6163 655f 7265 666c 6174 6c6f 6e28 6f63  ace_reflatlon(oc
-000057f0: 2c20 6e76 616c 3d20 6c6f 6e64 6d73 5b6b  , nval= londms[k
-00005800: 5d2c 2020 6b69 6e64 3d27 7265 666c 6f6e  ],  kind='reflon
-00005810: 6727 290d 0a20 2020 2020 2020 2020 2020  g')..           
-00005820: 2020 2020 206f 6320 3d20 7265 706c 6163       oc = replac
-00005830: 655f 7265 666c 6174 6c6f 6e28 6f63 2c20  e_reflatlon(oc, 
-00005840: 6e76 616c 3d20 7365 6c66 2e65 6c65 7661  nval= self.eleva
-00005850: 7469 6f6e 5b6b 5d2c 200d 0a20 2020 2020  tion[k], ..     
+00005170: 2020 2020 2020 2020 6627 6f62 6a65 6374          f'object
+00005180: 2c20 6e6f 7420 7b74 7970 6528 6461 7461  , not {type(data
+00005190: 6964 292e 5f5f 6e61 6d65 5f5f 2172 7d27  id).__name__!r}'
+000051a0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+000051b0: 6620 6c65 6e28 6461 7461 6964 2920 213d  f len(dataid) !=
+000051c0: 206c 656e 2873 656c 662e 6564 694f 626a   len(self.ediObj
+000051d0: 735f 293a 200d 0a20 2020 2020 2020 2020  s_): ..         
+000051e0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000051f0: 7565 4572 726f 7220 280d 0a20 2020 2020  ueError (..     
+00005200: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00005210: 4461 7461 4964 206c 656e 6774 6820 6d75  DataId length mu
+00005220: 7374 2068 6176 6520 7468 6520 7361 6d65  st have the same
+00005230: 206c 656e 6774 6820 7769 7468 2074 6865   length with the
+00005240: 206e 756d 6265 7227 0d0a 2020 2020 2020   number'..      
+00005250: 2020 2020 2020 2020 2020 2020 2020 2720                ' 
+00005260: 6f66 2063 6f6c 6c65 6374 6564 2045 4449  of collected EDI
+00005270: 7328 7b30 7d29 2e20 4275 7420 7b31 7d20  s({0}). But {1} 
+00005280: 7b32 7d20 6769 7665 6e2e 272e 666f 726d  {2} given.'.form
+00005290: 6174 280d 0a20 2020 2020 2020 2020 2020  at(..           
+000052a0: 2020 2020 2020 2020 206c 656e 2873 656c           len(sel
+000052b0: 662e 6564 694f 626a 735f 292c 206c 656e  f.ediObjs_), len
+000052c0: 2864 6174 6169 6429 2c0d 0a20 2020 2020  (dataid),..     
+000052d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000052e0: 227b 2769 7327 2069 6620 6c65 6e28 6461  "{'is' if len(da
+000052f0: 7461 6964 293c 3d31 2065 6c73 6520 2761  taid)<=1 else 'a
+00005300: 7265 277d 2229 290d 0a20 2020 2020 2020  re'}"))..       
+00005310: 0d0a 2020 2020 2020 2020 6c6f 6e67 2c20  ..        long, 
+00005320: 6c61 7420 3d20 7365 6c66 2e6c 6f6e 6769  lat = self.longi
+00005330: 7475 6465 2c20 7365 6c66 2e6c 6174 6974  tude, self.latit
+00005340: 7564 6520 0d0a 2020 2020 2020 2020 0d0a  ude ..        ..
+00005350: 2020 2020 2020 2020 6966 206d 616b 655f          if make_
+00005360: 636f 6f72 6473 3a20 0d0a 2020 2020 2020  coords: ..      
+00005370: 2020 2020 2020 6966 2028 7265 666c 6f6e        if (reflon
+00005380: 6720 6f72 2072 6566 6c61 7429 2069 7320  g or reflat) is 
+00005390: 4e6f 6e65 3a20 0d0a 2020 2020 2020 2020  None: ..        
+000053a0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+000053b0: 6c75 6545 7272 6f72 2827 5265 666c 6f6e  lueError('Reflon
+000053c0: 6720 616e 6420 7265 666c 6174 2070 6172  g and reflat par
+000053d0: 616d 7320 6d75 7374 206e 6f74 2062 6520  ams must not be 
+000053e0: 4e6f 6e65 2127 290d 0a20 2020 2020 2020  None!')..       
+000053f0: 2020 2020 206c 6f6e 672c 206c 6174 203d       long, lat =
+00005400: 206d 616b 6543 6f6f 7264 7328 0d0a 2020   makeCoords(..  
+00005410: 2020 2020 2020 2020 2020 2020 2072 6566               ref
+00005420: 6c6f 6e67 203d 2072 6566 6c6f 6e67 2c20  long = reflong, 
+00005430: 7265 666c 6174 3d20 7265 666c 6174 2c20  reflat= reflat, 
+00005440: 6e73 6974 6573 3d20 6c65 6e28 7365 6c66  nsites= len(self
+00005450: 2e65 6469 4f62 6a73 5f29 2c0d 0a20 2020  .ediObjs_),..   
+00005460: 2020 2020 2020 2020 2020 2020 7374 6570              step
+00005470: 203d 2073 7465 7020 2c20 2a2a 6b77 7329   = step , **kws)
+00005480: 200d 0a20 2020 2020 2020 2023 2063 6c65   ..        # cle
+00005490: 616e 2074 6865 206f 6c64 206d 6169 6e20  an the old main 
+000054a0: 4564 6920 7365 6374 696f 6e20 696e 666f  Edi section info
+000054b0: 2061 6e64 200d 0a20 2020 2020 2020 2023   and ..        #
+000054c0: 2061 6e64 2067 6574 2074 6865 206e 6577   and get the new
+000054d0: 2076 616c 7565 730d 0a20 2020 2020 2020   values..       
+000054e0: 2069 6620 636f 7272 6563 745f 6c6c 3a0d   if correct_ll:.
+000054f0: 0a20 2020 2020 2020 2020 2020 206c 6f6e  .            lon
+00005500: 646d 732c 2a5f 203d 2073 6361 6c65 506f  dms,*_ = scalePo
+00005510: 7369 7469 6f6e 2873 656c 662e 6c6f 6e67  sition(self.long
+00005520: 6974 7564 6529 0d0a 2020 2020 2020 2020  itude)..        
+00005530: 2020 2020 6c61 7464 6d73 2c2a 5f20 3d20      latdms,*_ = 
+00005540: 7363 616c 6550 6f73 6974 696f 6e28 7365  scalePosition(se
+00005550: 6c66 2e6c 6174 6974 7564 6529 200d 0a0d  lf.latitude) ...
+00005560: 0a20 2020 2020 2020 2023 2063 6f6c 6c65  .        # colle
+00005570: 6374 206e 6577 2065 6469 4f62 6a73 200d  ct new ediObjs .
+00005580: 0a20 2020 2020 2020 2063 6f62 6a73 203d  .        cobjs =
+00005590: 206e 702e 7a65 726f 735f 6c69 6b65 2028   np.zeros_like (
+000055a0: 7365 6c66 2e65 6469 4f62 6a73 5f2c 2064  self.ediObjs_, d
+000055b0: 7479 7065 3d6f 626a 6563 7420 2920 0d0a  type=object ) ..
+000055c0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000055d0: 2020 666f 7220 6b2c 2028 6f62 6a2c 2064    for k, (obj, d
+000055e0: 6964 2920 696e 2065 6e75 6d65 7261 7465  id) in enumerate
+000055f0: 287a 6970 2873 656c 662e 6564 694f 626a  (zip(self.ediObj
+00005600: 735f 2c20 6461 7461 6964 2929 3a20 0d0a  s_, dataid)): ..
+00005610: 2020 2020 2020 2020 2020 2020 6f62 6a2e              obj.
+00005620: 4865 6164 2e65 6469 5f68 6561 6465 7220  Head.edi_header 
+00005630: 3d20 4e6f 6e65 2020 0d0a 2020 2020 2020  = None  ..      
+00005640: 2020 2020 2020 6f62 6a2e 4865 6164 2e64        obj.Head.d
+00005650: 6174 6169 6420 3d20 6469 6420 0d0a 2020  ataid = did ..  
+00005660: 2020 2020 2020 2020 2020 6f62 6a2e 496e            obj.In
+00005670: 666f 2e65 6469 696e 666f 203d 204e 6f6e  fo.ediinfo = Non
+00005680: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
+00005690: 6966 2063 6f72 7265 6374 5f6c 6c20 6f72  if correct_ll or
+000056a0: 206d 616b 655f 636f 6f72 6473 3a0d 0a20   make_coords:.. 
+000056b0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000056c0: 626a 2e48 6561 642e 6c6f 6e67 203d 2066  bj.Head.long = f
+000056d0: 6c6f 6174 286c 6f6e 675b 6b5d 290d 0a20  loat(long[k]).. 
+000056e0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000056f0: 626a 2e48 6561 642e 6c61 7420 3d20 666c  bj.Head.lat = fl
+00005700: 6f61 7428 6c61 745b 6b5d 290d 0a20 2020  oat(lat[k])..   
+00005710: 2020 2020 2020 2020 2020 2020 206f 626a               obj
+00005720: 2e48 6561 642e 656c 6576 203d 2066 6c6f  .Head.elev = flo
+00005730: 6174 2873 656c 662e 656c 6576 6174 696f  at(self.elevatio
+00005740: 6e5b 6b5d 290d 0a20 2020 2020 2020 2020  n[k])..         
+00005750: 2020 2020 2020 206f 6320 3d20 6f62 6a2e         oc = obj.
+00005760: 4465 6669 6e65 4d65 6173 7572 656d 656e  DefineMeasuremen
+00005770: 742e 6465 6669 6e65 5f6d 6561 7375 7265  t.define_measure
+00005780: 6d65 6e74 0d0a 2020 2020 2020 2020 2020  ment..          
+00005790: 2020 2020 2020 6f63 3d20 7265 706c 6163        oc= replac
+000057a0: 655f 7265 666c 6174 6c6f 6e28 6f63 2c20  e_reflatlon(oc, 
+000057b0: 6e76 616c 3d20 6c61 7464 6d73 5b6b 5d29  nval= latdms[k])
+000057c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000057d0: 2020 6f63 3d20 7265 706c 6163 655f 7265    oc= replace_re
+000057e0: 666c 6174 6c6f 6e28 6f63 2c20 6e76 616c  flatlon(oc, nval
+000057f0: 3d20 6c6f 6e64 6d73 5b6b 5d2c 2020 6b69  = londms[k],  ki
+00005800: 6e64 3d27 7265 666c 6f6e 6727 290d 0a20  nd='reflong').. 
+00005810: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00005820: 6320 3d20 7265 706c 6163 655f 7265 666c  c = replace_refl
+00005830: 6174 6c6f 6e28 6f63 2c20 6e76 616c 3d20  atlon(oc, nval= 
+00005840: 7365 6c66 2e65 6c65 7661 7469 6f6e 5b6b  self.elevation[k
+00005850: 5d2c 200d 0a20 2020 2020 2020 2020 2020  ], ..           
 00005860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005880: 2020 6b69 6e64 3d27 7265 6665 6c65 7627    kind='refelev'
-00005890: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000058a0: 2020 206f 626a 2e44 6566 696e 654d 6561     obj.DefineMea
-000058b0: 7375 7265 6d65 6e74 2e64 6566 696e 655f  surement.define_
-000058c0: 6d65 6173 7572 656d 656e 7420 3d20 6f63  measurement = oc
-000058d0: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
-000058e0: 2045 6d70 7479 2074 6865 2070 7265 7669   Empty the previ
-000058f0: 6f75 7320 4d54 454d 4150 2069 6e66 6f73  ous MTEMAP infos
-00005900: 2061 6e64 200d 0a20 2020 2020 2020 2020   and ..         
-00005910: 2020 2023 2066 6574 6368 2074 6865 2061     # fetch the a
-00005920: 7474 7269 6275 7465 2076 616c 7565 7320  ttribute values 
-00005930: 6e65 776c 7920 7365 742e 0d0a 2020 2020  newly set...    
-00005940: 2020 2020 2020 2020 6f62 6a2e 4d54 454d          obj.MTEM
-00005950: 4150 2e6d 7465 6d61 7073 6563 7469 6e66  AP.mtemapsectinf
-00005960: 6f20 3d4e 6f6e 6520 0d0a 2020 2020 2020  o =None ..      
-00005970: 2020 2020 2020 6f62 6a2e 4d54 454d 4150        obj.MTEMAP
-00005980: 2e73 6563 7469 643d 2064 6964 0d0a 2020  .sectid= did..  
-00005990: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-000059a0: 2020 2020 2020 2020 6966 2065 7870 6f72          if expor
-000059b0: 743a 200d 0a20 2020 2020 2020 2020 2020  t: ..           
-000059c0: 2020 2020 206f 626a 2e77 7269 7465 5f65       obj.write_e
-000059d0: 6469 6669 6c65 280d 0a20 2020 2020 2020  difile(..       
-000059e0: 2020 2020 2020 2020 2020 2020 2073 6176               sav
-000059f0: 6570 6174 6820 3d20 7361 7665 7061 7468  epath = savepath
-00005a00: 202c 6e65 775f 6564 6966 696c 656e 616d   ,new_edifilenam
-00005a10: 6520 3d20 6564 695f 7072 6566 6978 2c20  e = edi_prefix, 
-00005a20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005a30: 2020 2020 2020 2a2a 6b77 7329 0d0a 2020        **kws)..  
-00005a40: 2020 2020 2020 2020 2020 636f 626a 735b            cobjs[
-00005a50: 6b5d 203d 206f 626a 200d 0a20 2020 2020  k] = obj ..     
-00005a60: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-00005a70: 662e 6564 694f 626a 735f 203d 2063 6f62  f.ediObjs_ = cob
-00005a80: 6a73 200d 0a20 2020 2020 2020 200d 0a20  js ..        .. 
-00005a90: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00005aa0: 6c66 200d 0a0d 0a20 2020 2064 6566 2067  lf ....    def g
-00005ab0: 6574 6675 6c6c 6672 6571 7565 6e63 7920  etfullfrequency 
-00005ac0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-00005ad0: 7365 6c66 2c20 0d0a 2020 2020 2020 2020  self, ..        
-00005ae0: 2020 2020 746f 5f6c 6f67 3130 3a62 6f6f      to_log10:boo
-00005af0: 6c20 203d 4661 6c73 6520 0d0a 2020 2020  l  =False ..    
-00005b00: 2020 2020 292d 3e20 4172 7261 794c 696b      )-> ArrayLik
-00005b10: 655b 4454 7970 655b 666c 6f61 745d 5d3a  e[DType[float]]:
-00005b20: 200d 0a20 2020 2020 2020 2022 2222 2047   ..        """ G
-00005b30: 6574 2074 6865 2066 7265 7175 656e 6379  et the frequency
-00005b40: 2077 6974 6820 636c 6561 6e20 6461 7461   with clean data
-00005b50: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
-00005b60: 2020 2020 2020 5468 6520 6675 6c6c 206f        The full o
-00005b70: 7220 706c 6169 6e20 6672 6571 7565 6e63  r plain frequenc
-00005b80: 7920 6973 2061 7272 6179 2066 7265 7175  y is array frequ
-00005b90: 656e 6379 2077 6974 6820 6e6f 206d 6973  ency with no mis
-00005ba0: 7369 6e67 2020 6461 7461 2064 7572 696e  sing  data durin
-00005bb0: 6720 0d0a 2020 2020 2020 2020 7468 6520  g ..        the 
-00005bc0: 6461 7461 2063 6f6c 6c65 6374 696f 6e2e  data collection.
-00005bd0: 204e 6f74 6520 7468 6174 2077 6865 6e20   Note that when 
-00005be0: 7573 696e 6720 7c4e 5341 4d54 7c2c 2073  using |NSAMT|, s
-00005bf0: 6f6d 6520 6461 7461 2061 7265 206d 6973  ome data are mis
-00005c00: 7369 6e67 200d 0a20 2020 2020 2020 2064  sing ..        d
-00005c10: 7565 2074 6f20 7468 6520 7765 616b 206f  ue to the weak o
-00005c20: 6620 6d69 7373 696e 6720 6672 6571 7565  f missing freque
-00005c30: 6e63 7920 6174 2063 6572 7461 696e 2062  ncy at certain b
-00005c40: 616e 6420 6573 7065 6369 616c 6c79 2069  and especially i
-00005c50: 6e20 7468 6520 0d0a 2020 2020 2020 2020  n the ..        
-00005c60: 6174 7465 6e75 6174 696f 6e20 6261 6e64  attenuation band
-00005c70: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
-00005c80: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00005c90: 200d 0a20 2020 2020 2020 202d 2d2d 2d2d   ..        -----
-00005ca0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00005cb0: 746f 5f6c 6f67 3130 3a20 626f 6f6c 2c20  to_log10: bool, 
-00005cc0: 6465 6661 756c 743d 4661 6c73 652c 200d  default=False, .
-00005cd0: 0a20 2020 2020 2020 2020 2020 2065 7870  .            exp
-00005ce0: 6f72 7420 6672 6571 7565 6e63 7920 746f  ort frequency to
-00005cf0: 2062 6173 6520 3130 206c 6f67 6172 6974   base 10 logarit
-00005d00: 686d 200d 0a20 2020 2020 2020 2020 2020  hm ..           
-00005d10: 200d 0a20 2020 2020 2020 2052 6574 7572   ..        Retur
-00005d20: 6e73 200d 0a20 2020 2020 2020 202d 2d2d  ns ..        ---
-00005d30: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2066  -----..        f
-00005d40: 3a20 4172 7261 796c 696b 6520 3164 206f  : Arraylike 1d o
-00005d50: 6620 7368 6170 6528 4e2c 2029 0d0a 2020  f shape(N, )..  
-00005d60: 2020 2020 2020 2020 2020 6672 6571 7565            freque
-00005d70: 6e63 7920 7769 7468 2063 6c65 616e 2064  ncy with clean d
-00005d80: 6174 612e 204f 7574 206f 6620 6061 7474  ata. Out of `att
-00005d90: 656e 7561 7469 6f6e 2062 616e 6460 2069  enuation band` i
-00005da0: 6620 7375 7276 6579 200d 0a20 2020 2020  f survey ..     
-00005db0: 2020 2020 2020 2069 7320 636f 6d70 6c65         is comple
-00005dc0: 7465 6420 7769 7468 2020 7c4e 5341 4d54  ted with  |NSAMT
-00005dd0: 7c2e 200d 0a20 2020 2020 2020 200d 0a20  |. ..        .. 
-00005de0: 2020 2020 2020 2053 6565 2041 6c73 6f0d         See Also.
-00005df0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00005e00: 2d0d 0a20 2020 2020 2020 2077 6174 6578  -..        watex
-00005e10: 2e75 7469 6c73 2e65 786d 6174 682e 6765  .utils.exmath.ge
-00005e20: 745f 6675 6c6c 5f66 7265 7175 656e 6379  t_full_frequency
-00005e30: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00005e40: 4765 7420 7468 6520 636f 6d70 6c65 7465  Get the complete
-00005e50: 2066 7265 7175 656e 6379 2077 6974 6820   frequency with 
-00005e60: 6e6f 206d 6973 7369 6e67 2073 6967 6e61  no missing signa
-00005e70: 6c73 2e20 0d0a 2020 2020 2020 2020 2020  ls. ..          
-00005e80: 2020 0d0a 2020 2020 2020 2020 4578 616d    ..        Exam
-00005e90: 706c 6520 0d0a 2020 2020 2020 2020 2d2d  ple ..        --
-00005ea0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 203e  -----..        >
-00005eb0: 3e3e 2069 6d70 6f72 7420 7761 7465 7820  >> import watex 
-00005ec0: 6173 2077 7820 0d0a 2020 2020 2020 2020  as wx ..        
-00005ed0: 3e3e 3e20 6564 695f 7361 6d70 6c65 203d  >>> edi_sample =
-00005ee0: 2077 782e 6665 7463 685f 6461 7461 2028   wx.fetch_data (
-00005ef0: 2765 6469 7327 2c20 7265 7475 726e 5f64  'edis', return_d
-00005f00: 6174 613d 5472 7565 2c20 7361 6d70 6c65  ata=True, sample
-00005f10: 7320 3d20 3132 2029 0d0a 2020 2020 2020  s = 12 )..      
-00005f20: 2020 3e3e 3e20 7778 2e45 4d28 292e 6669    >>> wx.EM().fi
-00005f30: 7428 6564 695f 7361 6d70 6c65 292e 6765  t(edi_sample).ge
-00005f40: 7466 756c 6c66 7265 7175 656e 6379 2874  tfullfrequency(t
-00005f50: 6f5f 6c6f 6731 3020 3d54 7275 6520 290d  o_log10 =True ).
-00005f60: 0a20 2020 2020 2020 2061 7272 6179 285b  .        array([
-00005f70: 342e 3736 3933 3737 3333 2c20 342e 3731  4.76937733, 4.71
-00005f80: 3730 3736 3339 2c20 342e 3636 3437 3735  707639, 4.664775
-00005f90: 3533 2c20 342e 3631 3234 3734 3636 2c20  53, 4.61247466, 
-00005fa0: 342e 3536 3031 3733 3832 2c0d 0a20 2020  4.56017382,..   
-00005fb0: 2020 2020 2020 2020 2020 2020 342e 3530              4.50
-00005fc0: 3738 3732 3837 2c20 342e 3435 3535 3732  787287, 4.455572
-00005fd0: 3034 2c20 342e 3430 3332 3731 3034 2c20  04, 4.40327104, 
-00005fe0: 342e 3335 3039 3730 3231 2c20 342e 3239  4.35097021, 4.29
-00005ff0: 3836 3639 3238 2c0d 0a20 2020 2020 2020  866928,..       
-00006000: 2020 2020 2020 2020 342e 3234 3633 3638          4.246368
-00006010: 3332 2c20 342e 3139 3430 3637 3631 2c20  32, 4.19406761, 
-00006020: 342e 3134 3137 3636 3638 2c20 342e 3038  4.14176668, 4.08
-00006030: 3934 3635 3635 2c20 342e 3033 3731 3634  946565, 4.037164
-00006040: 3635 2c0d 0a20 2020 2020 2020 2020 2020  65,..           
-00006050: 2020 2020 2e2e 2e0d 0a20 2020 2020 2020      .....       
-00006060: 2020 2020 2020 2020 322e 3637 3733 3432          2.677342
-00006070: 3238 2c20 322e 3632 3530 3434 3739 2c20  28, 2.62504479, 
-00006080: 322e 3537 3237 3433 3835 2c20 322e 3532  2.57274385, 2.52
-00006090: 3034 3434 3233 2c20 322e 3436 3831 3430  044423, 2.468140
-000060a0: 3437 2c0d 0a20 2020 2020 2020 2020 2020  47,..           
-000060b0: 2020 2020 322e 3431 3538 3431 3037 2c20      2.41584107, 
-000060c0: 322e 3336 3335 3336 3737 2c20 322e 3331  2.36353677, 2.31
-000060d0: 3132 3435 3132 2c20 322e 3235 3839 3234  124512, 2.258924
-000060e0: 3438 2c20 322e 3230 3636 3337 3031 2c0d  48, 2.20663701,.
-000060f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006100: 322e 3135 3433 3332 3636 2c20 322e 3130  2.15433266, 2.10
-00006110: 3230 3231 3836 2c20 322e 3034 3937 3231  202186, 2.049721
-00006120: 3832 2c20 312e 3939 3734 3330 3037 5d29  82, 1.99743007])
-00006130: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-00006140: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
-00006150: 7370 6563 7420 0d0a 2020 2020 2020 2020  spect ..        
-00006160: 7265 7475 726e 2067 6574 5f66 756c 6c5f  return get_full_
-00006170: 6672 6571 7565 6e63 7920 2873 656c 662e  frequency (self.
-00006180: 6564 694f 626a 735f 202c 2074 6f5f 6c6f  ediObjs_ , to_lo
-00006190: 6731 3020 3d20 746f 5f6c 6f67 3130 2920  g10 = to_log10) 
-000061a0: 0d0a 0d0a 2020 2020 6465 6620 6d61 6b65  ....    def make
-000061b0: 3264 2028 0d0a 2020 2020 2020 2020 7365  2d (..        se
-000061c0: 6c66 2c0d 0a20 2020 2020 2020 206f 7574  lf,..        out
-000061d0: 3a73 7472 203d 2027 7265 7378 7927 2c0d  :str = 'resxy',.
-000061e0: 0a20 2020 2020 2020 202a 2c20 0d0a 2020  .        *, ..  
-000061f0: 2020 2020 2020 6b69 6e64 3a73 7472 203d        kind:str =
-00006200: 2027 636f 6d70 6c65 7827 202c 200d 0a20   'complex' , .. 
-00006210: 2020 2020 2020 202a 2a6b 7773 200d 0a20         **kws .. 
-00006220: 2020 2020 2020 2029 2d3e 204e 4441 7272         )-> NDArr
-00006230: 6179 5b44 5479 7065 5b66 6c6f 6174 5d5d  ay[DType[float]]
-00006240: 3a20 0d0a 2020 2020 2020 2020 2222 2220  : ..        """ 
-00006250: 4f75 7420 3244 2072 6573 6973 7469 7669  Out 2D resistivi
-00006260: 7479 2c20 7068 6173 652d 6572 726f 7220  ty, phase-error 
-00006270: 616e 6420 7465 6e73 6f72 206d 6174 7269  and tensor matri
-00006280: 7820 6672 6f6d 2061 2063 6f6c 6c65 6374  x from a collect
-00006290: 696f 6e0d 0a20 2020 2020 2020 206f 6620  ion..        of 
-000062a0: 4544 492d 6f62 6a65 6374 732e 200d 0a20  EDI-objects. .. 
-000062b0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000062c0: 204d 6174 7269 7820 6465 7065 6e64 7320   Matrix depends 
-000062d0: 6f66 2074 6865 206e 756d 6265 7220 6f66  of the number of
-000062e0: 2066 7265 7175 656e 6379 2074 696d 6573   frequency times
-000062f0: 206e 756d 6265 7220 6f66 2073 6974 6573   number of sites
-00006300: 2e20 0d0a 2020 2020 2020 2020 5468 6520  . ..        The 
-00006310: 6675 6e63 7469 6f6e 2061 7373 6572 7473  function asserts
-00006320: 2077 6865 7468 6572 2061 6c6c 2064 6174   whether all dat
-00006330: 6120 6672 6f6d 2061 6c6c 2066 7265 7175  a from all frequ
-00006340: 656e 6369 6573 2061 7265 2061 7661 696c  encies are avail
-00006350: 6162 6c65 2e20 0d0a 2020 2020 2020 2020  able. ..        
-00006360: 5468 6520 6d69 7373 696e 6720 7661 6c75  The missing valu
-00006370: 6573 2073 686f 756c 6420 6265 2066 696c  es should be fil
-00006380: 6c65 6420 6279 204e 614e 2e20 0d0a 2020  led by NaN. ..  
-00006390: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000063a0: 5061 7261 6d65 7465 7273 200d 0a20 2020  Parameters ..   
-000063b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
-000063c0: 200d 0a20 2020 2020 2020 2064 6174 613a   ..        data:
-000063d0: 2050 6174 682d 6c69 6b65 206f 626a 6563   Path-like objec
-000063e0: 7420 6f72 206c 6973 7420 6f66 2070 7963  t or list of pyc
-000063f0: 7361 6d74 2e63 6f72 652e 6564 6920 6f62  samt.core.edi ob
-00006400: 6a65 6374 730d 0a20 2020 2020 2020 2020  jects..         
-00006410: 2020 2043 6f6c 6c65 6374 696f 6e73 206f     Collections o
-00006420: 6620 4544 492d 6f62 6a65 6374 7320 6672  f EDI-objects fr
-00006430: 6f6d 2060 7079 6373 616d 7460 5f20 6f72  om `pycsamt`_ or
-00006440: 2066 756c 6c20 7061 7468 2074 6f20 4544   full path to ED
-00006450: 4920 6669 6c65 732e 0d0a 2020 2020 2020  I files...      
-00006460: 2020 6f75 743a 2073 7472 200d 0a20 2020    out: str ..   
-00006470: 2020 2020 2020 2020 206b 696e 6420 6f66           kind of
-00006480: 2064 6174 6120 746f 206f 7574 7075 742e   data to output.
-00006490: 2042 6520 7375 7265 2074 6f20 7072 6f76   Be sure to prov
-000064a0: 6964 6520 7468 6520 636f 6d70 6f6e 656e  ide the componen
-000064b0: 7420 746f 2072 6574 7269 6576 6520 0d0a  t to retrieve ..
-000064c0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-000064d0: 6174 7472 6962 7574 6520 6672 6f6d 2074  attribute from t
-000064e0: 6865 2063 6f6c 6c65 6374 696f 6e20 6f62  he collection ob
-000064f0: 6a65 6374 2e20 4578 6365 7074 2074 6865  ject. Except the
-00006500: 2060 6572 726f 7260 2061 6e64 200d 0a20   `error` and .. 
-00006510: 2020 2020 2020 2020 2020 2066 7265 7175             frequ
-00006520: 656e 6379 2061 7474 7269 6275 7465 2c20  ency attribute, 
-00006530: 7468 6520 6d69 7373 696e 6720 636f 6d70  the missing comp
-00006540: 6f6e 656e 7420 746f 2074 6865 2061 7474  onent to the att
-00006550: 7269 6275 7465 2077 696c 6c20 0d0a 2020  ribute will ..  
-00006560: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00006570: 616e 2065 7272 6f72 2e20 666f 7220 696e  an error. for in
-00006580: 7374 616e 6365 2060 6072 6573 7879 6060  stance ``resxy``
-00006590: 2066 6f72 2078 7920 636f 6d70 6f6e 656e   for xy componen
-000065a0: 742e 2044 6566 6175 6c74 2069 7320 0d0a  t. Default is ..
-000065b0: 2020 2020 2020 2020 2020 2020 6060 7265              ``re
-000065c0: 7378 7960 602e 200d 0a20 2020 2020 2020  sxy``. ..       
-000065d0: 206b 696e 6420 3a20 626f 6f6c 206f 7220   kind : bool or 
-000065e0: 7374 7220 0d0a 2020 2020 2020 2020 2020  str ..          
-000065f0: 2020 666f 6375 7365 7320 6f6e 2074 6865    focuses on the
-00006600: 2074 656e 736f 7220 6f75 7470 7574 2e20   tensor output. 
-00006610: 4e6f 7465 2074 6861 7420 7468 6520 7465  Note that the te
-00006620: 6e73 6f72 2069 7320 6120 636f 6d70 6c65  nsor is a comple
-00006630: 7820 6e75 6d62 6572 200d 0a20 2020 2020  x number ..     
-00006640: 2020 2020 2020 206f 6620 6e64 6172 7261         of ndarra
-00006650: 7920 286e 6672 6571 2c20 322c 3220 292e  y (nfreq, 2,2 ).
-00006660: 2049 6620 7365 7420 746f 6060 6d6f 6475   If set to``modu
-00006670: 6c75 7360 2c20 7468 6520 6d6f 6475 6c75  lus`, the modulu
-00006680: 7320 6f66 2074 6865 2063 6f6d 706c 6578  s of the complex
-00006690: 200d 0a20 2020 2020 2020 2020 2020 2074   ..            t
-000066a0: 656e 736f 7220 7368 6f75 6c64 2062 6520  ensor should be 
-000066b0: 6f75 7470 7574 7465 642e 2049 6620 6060  outputted. If ``
-000066c0: 7265 616c 6060 206f 7260 6069 6d61 6760  real`` or``imag`
-000066d0: 602c 2069 7420 7265 7475 726e 7320 6f6e  `, it returns on
-000066e0: 6c79 0d0a 2020 2020 2020 2020 2020 2020  ly..            
-000066f0: 7468 6520 7370 6563 6966 6963 206f 6e65  the specific one
-00006700: 2e20 4465 6661 756c 7420 6973 2060 6063  . Default is ``c
-00006710: 6f6d 706c 6578 6060 2e0d 0a20 2020 2020  omplex``...     
-00006720: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00006730: 206b 7773 3a20 6469 6374 200d 0a20 2020   kws: dict ..   
-00006740: 2020 2020 2020 2020 2041 6464 6974 696f           Additio
-00006750: 6e61 6c20 6b65 7977 6f72 6473 2061 7267  nal keywords arg
-00006760: 756d 656e 7473 2066 726f 6d20 3a66 756e  uments from :fun
-00006770: 633a 607e 2e67 6574 6675 6c6c 6672 6571  c:`~.getfullfreq
-00006780: 7565 6e63 7920 602e 200d 0a20 2020 2020  uency `. ..     
-00006790: 2020 200d 0a20 2020 2020 2020 2052 6574     ..        Ret
-000067a0: 7572 6e73 200d 0a20 2020 2020 2020 202d  urns ..        -
-000067b0: 2d2d 2d2d 2d2d 2d20 0d0a 2020 2020 2020  ------- ..      
-000067c0: 2020 6d61 7432 6420 3a20 6e70 2e6e 6461    mat2d : np.nda
-000067d0: 7272 6179 286e 6672 6571 2c20 6e73 7461  rray(nfreq, nsta
-000067e0: 7469 6f6e 7329 200d 0a20 2020 2020 2020  tions) ..       
-000067f0: 2020 2020 2074 6865 206d 6174 7269 7820       the matrix 
-00006800: 6f66 206e 756d 6265 7220 6f66 2066 7265  of number of fre
-00006810: 7175 656e 6379 2061 6e64 206e 756d 6265  quency and numbe
-00006820: 7220 6f66 2045 6469 2d63 6f6c 6c65 6374  r of Edi-collect
-00006830: 6573 2077 6869 6368 200d 0a20 2020 2020  es which ..     
-00006840: 2020 2020 2020 2063 6f72 7265 7370 6f6e         correspon
-00006850: 6420 746f 2074 6865 206e 756d 6265 7220  d to the number 
-00006860: 6f66 2074 6865 2073 7461 7469 6f6e 732f  of the stations/
-00006870: 7369 7465 732e 200d 0a20 2020 2020 2020  sites. ..       
-00006880: 200d 0a20 2020 2020 2020 2045 7861 6d70   ..        Examp
-00006890: 6c65 7320 0d0a 2020 2020 2020 2020 2d2d  les ..        --
-000068a0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-000068b0: 203e 3e3e 2066 726f 6d20 7761 7465 782e   >>> from watex.
-000068c0: 6d65 7468 6f64 732e 656d 2069 6d70 6f72  methods.em impor
-000068d0: 7420 454d 200d 0a20 2020 2020 2020 203e  t EM ..        >
-000068e0: 3e3e 2065 6469 7061 7468 203d 2764 6174  >> edipath ='dat
-000068f0: 612f 6564 6973 270d 0a20 2020 2020 2020  a/edis'..       
-00006900: 203e 3e3e 2065 6d4f 626a 733d 2045 4d28   >>> emObjs= EM(
-00006910: 292e 6669 7428 6564 6970 6174 6829 0d0a  ).fit(edipath)..
-00006920: 2020 2020 2020 2020 3e3e 3e20 7068 7978          >>> phyx
-00006930: 203d 2045 4d28 292e 6d61 6b65 3264 2028   = EM().make2d (
-00006940: 2770 6861 7365 7978 2729 0d0a 2020 2020  'phaseyx')..    
-00006950: 2020 2020 3e3e 3e20 7068 7978 200d 0a20      >>> phyx .. 
-00006960: 2020 2020 2020 202e 2e2e 2061 7272 6179         ... array
-00006970: 285b 5b20 3236 2e34 3235 3436 3539 332c  ([[ 26.42546593,
-00006980: 2020 3332 2e37 3130 3636 3435 342c 2020    32.71066454,  
-00006990: 3330 2e39 3232 3237 3436 205d 2c0d 0a20  30.9222746 ],.. 
-000069a0: 2020 2020 2020 2020 2020 2020 2020 5b20                [ 
-000069b0: 3434 2e32 3539 3930 3534 312c 2020 3430  44.25990541,  40
-000069c0: 2e37 3739 3131 3133 362c 2020 3431 2e30  .77911136,  41.0
-000069d0: 3333 3931 3438 205d 2c0d 0a20 2020 2020  339148 ],..     
-000069e0: 2020 2020 2020 2020 2020 2e2e 2e0d 0a20            ..... 
-000069f0: 2020 2020 2020 2020 2020 2020 2020 5b20                [ 
-00006a00: 3337 2e36 3635 3934 3638 362c 2020 3333  37.66594686,  33
-00006a10: 2e30 3333 3735 3836 332c 2020 3335 2e37  .03375863,  35.7
-00006a20: 3534 3230 3830 325d 2c0d 0a20 2020 2020  5420802],..     
-00006a30: 2020 2020 2020 2020 2020 5b20 2020 2020            [     
-00006a40: 2020 2020 6e61 6e2c 2020 2020 2020 2020      nan,        
-00006a50: 2020 6e61 6e2c 2020 3434 2e30 3434 3938    nan,  44.04498
-00006a60: 3739 315d 5d29 0d0a 2020 2020 2020 2020  791]])..        
-00006a70: 3e3e 3e20 7068 7978 2e73 6861 7065 200d  >>> phyx.shape .
-00006a80: 0a20 2020 2020 2020 202e 2e2e 2028 3535  .        ... (55
-00006a90: 2c20 3329 0d0a 2020 2020 2020 2020 3e3e  , 3)..        >>
-00006aa0: 3e20 2320 6765 7420 7468 6520 7265 616c  > # get the real
-00006ab0: 206e 756d 6265 7220 6f66 2074 6865 2079   number of the y
-00006ac0: 7920 636f 6d70 6f6e 6574 206f 6620 7465  y componet of te
-00006ad0: 6e73 6f72 207a 200d 0a20 2020 2020 2020  nsor z ..       
-00006ae0: 203e 3e3e 207a 7979 5f72 203d 206d 616b   >>> zyy_r = mak
-00006af0: 6532 6420 2865 6469 4f62 6a73 2c20 277a  e2d (ediObjs, 'z
-00006b00: 7978 272c 206b 696e 6420 3d27 7265 616c  yx', kind ='real
-00006b10: 2729 0d0a 2020 2020 2020 2020 2e2e 2e20  ')..        ... 
-00006b20: 6172 7261 7928 5b5b 2034 3136 352e 3620  array([[ 4165.6 
-00006b30: 2020 2c20 2038 3636 352e 3634 2020 2c20    ,  8665.64  , 
-00006b40: 2035 3238 352e 3437 2020 5d2c 0d0a 2020   5285.47  ],..  
-00006b50: 2020 2020 2020 2020 2020 2020 205b 2037               [ 7
-00006b60: 3037 322e 3831 2020 2c20 3131 3636 332e  072.81  , 11663.
-00006b70: 3120 2020 2c20 2036 3930 302e 3333 2020  1   ,  6900.33  
-00006b80: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-00006b90: 2020 202e 2e2e 0d0a 2020 2020 2020 2020     .....        
-00006ba0: 2020 2020 2020 205b 2020 2039 302e 3730         [   90.70
-00006bb0: 3939 2c20 2020 3131 392e 3530 3520 2c20  99,   119.505 , 
-00006bc0: 2020 3132 322e 3334 3320 5d2c 0d0a 2020    122.343 ],..  
-00006bd0: 2020 2020 2020 2020 2020 2020 205b 2020               [  
-00006be0: 2020 2020 206e 616e 2c20 2020 2020 2020       nan,       
-00006bf0: 206e 616e 2c20 2020 2038 382e 3036 3234   nan,    88.0624
-00006c00: 5d5d 290d 0a20 2020 2020 2020 203e 3e3e  ]])..        >>>
-00006c10: 2023 2067 6574 2074 6865 2072 6573 6973   # get the resis
-00006c20: 7469 7669 7479 2065 7272 6f72 206f 6620  tivity error of 
-00006c30: 636f 6d70 6f6e 656e 7420 2778 7927 0d0a  component 'xy'..
-00006c40: 2020 2020 2020 2020 3e3e 3e20 7265 7378          >>> resx
-00006c50: 795f 6572 7220 3d20 454d 2e6d 616b 6532  y_err = EM.make2
-00006c60: 6420 2827 7265 7378 795f 6572 7227 290d  d ('resxy_err').
-00006c70: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
-00006c80: 7879 5f65 7272 200d 0a20 2020 2020 2020  xy_err ..       
-00006c90: 202e 2e2e 2061 7272 6179 285b 5b30 2e30   ... array([[0.0
-00006ca0: 3133 3239 3033 372c 2030 2e30 3239 3432  1329037, 0.02942
-00006cb0: 3535 372c 2030 2e30 3137 3630 3334 205d  557, 0.0176034 ]
-00006cc0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00006cd0: 2020 5b30 2e30 3333 3539 3039 202c 2030    [0.0335909 , 0
-00006ce0: 2e30 3532 3338 3836 332c 2030 2e30 3331  .05238863, 0.031
-00006cf0: 3131 3437 355d 2c0d 0a20 2020 2020 2020  11475],..       
-00006d00: 2020 2020 2020 2020 2e2e 2e0d 0a20 2020          .....   
-00006d10: 2020 2020 2020 2020 2020 2020 5b33 2e33              [3.3
-00006d20: 3333 3539 3934 322c 2034 2e31 3436 3834  3359942, 4.14684
-00006d30: 3932 362c 2034 2e33 3835 3632 3237 315d  926, 4.38562271]
-00006d40: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00006d50: 2020 5b20 2020 2020 2020 6e61 6e2c 2020    [       nan,  
-00006d60: 2020 2020 2020 6e61 6e2c 2034 2e33 3536        nan, 4.356
-00006d70: 3035 3630 335d 5d29 0d0a 2020 2020 2020  05603]])..      
-00006d80: 2020 3e3e 3e20 7068 7978 2e73 6861 7065    >>> phyx.shape
-00006d90: 202c 7a79 795f 722e 7368 6170 652c 2072   ,zyy_r.shape, r
-00006da0: 6573 7879 5f65 7272 2e73 6861 7065 2020  esxy_err.shape  
-00006db0: 0d0a 2020 2020 2020 2020 2e2e 2e20 2828  ..        ... ((
-00006dc0: 3535 2c20 3329 2c20 2835 352c 2033 292c  55, 3), (55, 3),
-00006dd0: 2028 3535 2c20 3329 290d 0a20 2020 2020   (55, 3))..     
-00006de0: 2020 200d 0a20 2020 2020 2020 2022 2222     ..        """
-00006df0: 0d0a 2020 2020 2020 2020 7365 6c66 2e69  ..        self.i
-00006e00: 6e73 7065 6374 200d 0a20 2020 2020 2020  nspect ..       
-00006e10: 200d 0a20 2020 2020 2020 2064 6566 2066   ..        def f
-00006e20: 6974 3264 616c 6c28 6f62 6a73 2c20 6174  it2dall(objs, at
-00006e30: 7472 2c20 636f 6d70 293a 200d 0a20 2020  tr, comp): ..   
-00006e40: 2020 2020 2020 2020 2022 2222 2052 6561           """ Rea
-00006e50: 6420 616c 6c20 6564 694f 626a 7320 616e  d all ediObjs an
-00006e60: 6420 7265 706c 6163 6520 616c 6c20 6d69  d replace all mi
-00006e70: 7373 696e 6720 6461 7461 2062 7920 4e61  ssing data by Na
-00006e80: 4e20 7661 6c75 652e 200d 0a20 2020 2020  N value. ..     
-00006e90: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00006ea0: 2020 2020 2054 6869 7320 6973 2075 7365       This is use
-00006eb0: 6675 6c20 746f 206c 6574 2074 6865 2061  ful to let the a
-00006ec0: 7272 6179 7320 6174 2065 6163 6820 7374  rrays at each st
-00006ed0: 6174 696f 6e20 746f 2020 6d61 7463 6820  ation to  match 
-00006ee0: 7468 6520 6c65 6e67 7468 200d 0a20 2020  the length ..   
-00006ef0: 2020 2020 2020 2020 206f 6620 7468 6520           of the 
-00006f00: 636f 6d70 6c65 7465 2066 7265 7175 656e  complete frequen
-00006f10: 6379 2072 6174 6865 7220 7468 616e 2073  cy rather than s
-00006f20: 6872 756e 6b69 6e67 2020 7570 2073 6f6d  hrunking  up som
-00006f30: 6520 6461 7461 2e20 5468 6520 0d0a 2020  e data. The ..  
-00006f40: 2020 2020 2020 2020 2020 6d69 7373 696e            missin
-00006f50: 6720 6461 7461 2073 686f 756c 6420 6265  g data should be
-00006f60: 2066 696c 6c65 6420 6279 204e 614e 2076   filled by NaN v
-00006f70: 616c 7565 732e 200d 0a20 2020 2020 2020  alues. ..       
-00006f80: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00006f90: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00006fa0: 2020 2020 2320 7573 6520 205b 6765 7461      # use  [geta
-00006fb0: 7474 7228 2065 6469 4f62 6a2e 5a2c 2066  ttr( ediObj.Z, f
-00006fc0: 227b 6174 7472 7d22 295b 7475 706c 6520  "{attr}")[tuple 
-00006fd0: 2820 5f63 2e67 6574 2863 6f6d 7029 292e  ( _c.get(comp)).
-00006fe0: 2e2e 200d 0a20 2020 2020 2020 2020 2020  .. ..           
-00006ff0: 2023 2077 6865 7265 200d 0a20 2020 2020   # where ..     
-00007000: 2020 2020 2020 2023 2023 3d3e 2073 6c69         # #=> sli
-00007010: 6365 2069 6e64 6578 2066 6f72 2063 6f6d  ce index for com
-00007020: 706f 6e65 6e74 2072 6574 7265 6976 696e  ponent retreivin
-00007030: 6720 7075 7270 6f73 6520 0d0a 2020 2020  g purpose ..    
-00007040: 2020 2020 2020 2020 2320 5f63 3d20 7b0d          # _c= {.
-00007050: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
-00007060: 2020 2020 2027 7878 273a 205b 736c 6963       'xx': [slic
-00007070: 6520 284e 6f6e 652c 206c 656e 2873 656c  e (None, len(sel
-00007080: 662e 6672 6571 735f 2929 2c20 3020 2c20  f.freqs_)), 0 , 
-00007090: 305d 202c 200d 0a20 2020 2020 2020 2020  0] , ..         
-000070a0: 2020 2023 2020 2020 2020 2027 7879 273a     #       'xy':
-000070b0: 205b 736c 6963 6520 284e 6f6e 652c 206c   [slice (None, l
-000070c0: 656e 2873 656c 662e 6672 6571 735f 2929  en(self.freqs_))
-000070d0: 2c20 3020 2c20 315d 2c20 0d0a 2020 2020  , 0 , 1], ..    
-000070e0: 2020 2020 2020 2020 2320 2020 2020 2020          #       
-000070f0: 2779 7827 3a20 5b73 6c69 6365 2028 4e6f  'yx': [slice (No
-00007100: 6e65 2c20 6c65 6e28 7365 6c66 2e66 7265  ne, len(self.fre
-00007110: 7173 5f29 292c 2031 202c 2030 5d2c 200d  qs_)), 1 , 0], .
-00007120: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
-00007130: 2020 2020 2027 7979 273a 205b 736c 6963       'yy': [slic
-00007140: 6520 284e 6f6e 652c 206c 656e 2873 656c  e (None, len(sel
-00007150: 662e 6672 6571 735f 2929 2c20 312c 2020  f.freqs_)), 1,  
-00007160: 315d 200d 0a20 2020 2020 2020 2020 2020  1] ..           
-00007170: 2023 207d 0d0a 2020 2020 2020 2020 2020   # }..          
-00007180: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00007190: 7a6c 203d 205b 6765 7461 7474 7228 2065  zl = [getattr( e
-000071a0: 6469 4f62 6a2e 5a2c 2066 227b 6174 7472  diObj.Z, f"{attr
-000071b0: 7d22 295b 7475 706c 6520 2820 0d0a 2020  }")[tuple ( ..  
-000071c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000071d0: 6c66 2e74 736c 6963 6572 2829 2e67 6574  lf.tslicer().get
-000071e0: 2863 6f6d 7029 295d 0d0a 2020 2020 2020  (comp))]..      
-000071f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00007200: 6564 694f 626a 2069 6e20 6f62 6a73 205d  ediObj in objs ]
-00007210: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00007220: 206e 616d 6520 3d3d 277a 273a 200d 0a20   name =='z': .. 
-00007230: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00007240: 6620 6b69 6e64 203d 3d27 6d6f 6475 6c75  f kind =='modulu
-00007250: 7327 3a20 0d0a 2020 2020 2020 2020 2020  s': ..          
-00007260: 2020 2020 2020 2020 2020 7a6c 203d 205b            zl = [
-00007270: 206e 702e 6162 7320 2876 2920 666f 7220   np.abs (v) for 
-00007280: 7620 696e 207a 6c5d 0d0a 2020 2020 2020  v in zl]..      
-00007290: 2020 2020 2020 2020 2020 2020 2020 7a6c                zl
-000072a0: 203d 205b 6669 7474 656e 736f 7228 7365   = [fittensor(se
-000072b0: 6c66 2e66 7265 7173 5f2c 2065 6469 4f62  lf.freqs_, ediOb
-000072c0: 6a2e 5a2e 5f66 7265 712c 2076 290d 0a20  j.Z._freq, v).. 
+00005870: 2020 2020 2020 2020 2020 2020 6b69 6e64              kind
+00005880: 3d27 7265 6665 6c65 7627 290d 0a20 2020  ='refelev')..   
+00005890: 2020 2020 2020 2020 2020 2020 206f 626a               obj
+000058a0: 2e44 6566 696e 654d 6561 7375 7265 6d65  .DefineMeasureme
+000058b0: 6e74 2e64 6566 696e 655f 6d65 6173 7572  nt.define_measur
+000058c0: 656d 656e 7420 3d20 6f63 200d 0a20 2020  ement = oc ..   
+000058d0: 2020 2020 2020 2020 2023 2045 6d70 7479           # Empty
+000058e0: 2074 6865 2070 7265 7669 6f75 7320 4d54   the previous MT
+000058f0: 454d 4150 2069 6e66 6f73 2061 6e64 200d  EMAP infos and .
+00005900: 0a20 2020 2020 2020 2020 2020 2023 2066  .            # f
+00005910: 6574 6368 2074 6865 2061 7474 7269 6275  etch the attribu
+00005920: 7465 2076 616c 7565 7320 6e65 776c 7920  te values newly 
+00005930: 7365 742e 0d0a 2020 2020 2020 2020 2020  set...          
+00005940: 2020 6f62 6a2e 4d54 454d 4150 2e6d 7465    obj.MTEMAP.mte
+00005950: 6d61 7073 6563 7469 6e66 6f20 3d4e 6f6e  mapsectinfo =Non
+00005960: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
+00005970: 6f62 6a2e 4d54 454d 4150 2e73 6563 7469  obj.MTEMAP.secti
+00005980: 643d 2064 6964 0d0a 2020 2020 2020 2020  d= did..        
+00005990: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+000059a0: 2020 6966 2065 7870 6f72 743a 200d 0a20    if export: .. 
+000059b0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000059c0: 626a 2e77 7269 7465 5f65 6469 6669 6c65  bj.write_edifile
+000059d0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+000059e0: 2020 2020 2020 2073 6176 6570 6174 6820         savepath 
+000059f0: 3d20 7361 7665 7061 7468 202c 6e65 775f  = savepath ,new_
+00005a00: 6564 6966 696c 656e 616d 6520 3d20 6564  edifilename = ed
+00005a10: 695f 7072 6566 6978 2c20 0d0a 2020 2020  i_prefix, ..    
+00005a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005a30: 2a2a 6b77 7329 0d0a 2020 2020 2020 2020  **kws)..        
+00005a40: 2020 2020 636f 626a 735b 6b5d 203d 206f      cobjs[k] = o
+00005a50: 626a 200d 0a20 2020 2020 2020 200d 0a20  bj ..        .. 
+00005a60: 2020 2020 2020 2073 656c 662e 6564 694f         self.ediO
+00005a70: 626a 735f 203d 2063 6f62 6a73 200d 0a20  bjs_ = cobjs .. 
+00005a80: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00005a90: 2072 6574 7572 6e20 7365 6c66 200d 0a0d   return self ...
+00005aa0: 0a20 2020 2064 6566 2067 6574 6675 6c6c  .    def getfull
+00005ab0: 6672 6571 7565 6e63 7920 2028 0d0a 2020  frequency  (..  
+00005ac0: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
+00005ad0: 0d0a 2020 2020 2020 2020 2020 2020 746f  ..            to
+00005ae0: 5f6c 6f67 3130 3a62 6f6f 6c20 203d 4661  _log10:bool  =Fa
+00005af0: 6c73 6520 0d0a 2020 2020 2020 2020 292d  lse ..        )-
+00005b00: 3e20 4172 7261 794c 696b 655b 4454 7970  > ArrayLike[DTyp
+00005b10: 655b 666c 6f61 745d 5d3a 200d 0a20 2020  e[float]]: ..   
+00005b20: 2020 2020 2022 2222 2047 6574 2074 6865       """ Get the
+00005b30: 2066 7265 7175 656e 6379 2077 6974 6820   frequency with 
+00005b40: 636c 6561 6e20 6461 7461 2e20 0d0a 2020  clean data. ..  
+00005b50: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00005b60: 5468 6520 6675 6c6c 206f 7220 706c 6169  The full or plai
+00005b70: 6e20 6672 6571 7565 6e63 7920 6973 2061  n frequency is a
+00005b80: 7272 6179 2066 7265 7175 656e 6379 2077  rray frequency w
+00005b90: 6974 6820 6e6f 206d 6973 7369 6e67 2020  ith no missing  
+00005ba0: 6461 7461 2064 7572 696e 6720 0d0a 2020  data during ..  
+00005bb0: 2020 2020 2020 7468 6520 6461 7461 2063        the data c
+00005bc0: 6f6c 6c65 6374 696f 6e2e 204e 6f74 6520  ollection. Note 
+00005bd0: 7468 6174 2077 6865 6e20 7573 696e 6720  that when using 
+00005be0: 7c4e 5341 4d54 7c2c 2073 6f6d 6520 6461  |NSAMT|, some da
+00005bf0: 7461 2061 7265 206d 6973 7369 6e67 200d  ta are missing .
+00005c00: 0a20 2020 2020 2020 2064 7565 2074 6f20  .        due to 
+00005c10: 7468 6520 7765 616b 206f 6620 6d69 7373  the weak of miss
+00005c20: 696e 6720 6672 6571 7565 6e63 7920 6174  ing frequency at
+00005c30: 2063 6572 7461 696e 2062 616e 6420 6573   certain band es
+00005c40: 7065 6369 616c 6c79 2069 6e20 7468 6520  pecially in the 
+00005c50: 0d0a 2020 2020 2020 2020 6174 7465 6e75  ..        attenu
+00005c60: 6174 696f 6e20 6261 6e64 2e20 0d0a 2020  ation band. ..  
+00005c70: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00005c80: 5061 7261 6d65 7465 7273 200d 0a20 2020  Parameters ..   
+00005c90: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+00005ca0: 0d0a 2020 2020 2020 2020 746f 5f6c 6f67  ..        to_log
+00005cb0: 3130 3a20 626f 6f6c 2c20 6465 6661 756c  10: bool, defaul
+00005cc0: 743d 4661 6c73 652c 200d 0a20 2020 2020  t=False, ..     
+00005cd0: 2020 2020 2020 2065 7870 6f72 7420 6672         export fr
+00005ce0: 6571 7565 6e63 7920 746f 2062 6173 6520  equency to base 
+00005cf0: 3130 206c 6f67 6172 6974 686d 200d 0a20  10 logarithm .. 
+00005d00: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00005d10: 2020 2020 2052 6574 7572 6e73 200d 0a20       Returns .. 
+00005d20: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0d         --------.
+00005d30: 0a20 2020 2020 2020 2066 3a20 4172 7261  .        f: Arra
+00005d40: 796c 696b 6520 3164 206f 6620 7368 6170  ylike 1d of shap
+00005d50: 6528 4e2c 2029 0d0a 2020 2020 2020 2020  e(N, )..        
+00005d60: 2020 2020 6672 6571 7565 6e63 7920 7769      frequency wi
+00005d70: 7468 2063 6c65 616e 2064 6174 612e 204f  th clean data. O
+00005d80: 7574 206f 6620 6061 7474 656e 7561 7469  ut of `attenuati
+00005d90: 6f6e 2062 616e 6460 2069 6620 7375 7276  on band` if surv
+00005da0: 6579 200d 0a20 2020 2020 2020 2020 2020  ey ..           
+00005db0: 2069 7320 636f 6d70 6c65 7465 6420 7769   is completed wi
+00005dc0: 7468 2020 7c4e 5341 4d54 7c2e 200d 0a20  th  |NSAMT|. .. 
+00005dd0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00005de0: 2053 6565 2041 6c73 6f0d 0a20 2020 2020   See Also..     
+00005df0: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
+00005e00: 2020 2020 2077 6174 6578 2e75 7469 6c73       watex.utils
+00005e10: 2e65 786d 6174 682e 6765 745f 6675 6c6c  .exmath.get_full
+00005e20: 5f66 7265 7175 656e 6379 3a20 0d0a 2020  _frequency: ..  
+00005e30: 2020 2020 2020 2020 2020 4765 7420 7468            Get th
+00005e40: 6520 636f 6d70 6c65 7465 2066 7265 7175  e complete frequ
+00005e50: 656e 6379 2077 6974 6820 6e6f 206d 6973  ency with no mis
+00005e60: 7369 6e67 2073 6967 6e61 6c73 2e20 0d0a  sing signals. ..
+00005e70: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00005e80: 2020 2020 2020 4578 616d 706c 6520 0d0a        Example ..
+00005e90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+00005ea0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+00005eb0: 6f72 7420 7761 7465 7820 6173 2077 7820  ort watex as wx 
+00005ec0: 0d0a 2020 2020 2020 2020 3e3e 3e20 6564  ..        >>> ed
+00005ed0: 695f 7361 6d70 6c65 203d 2077 782e 6665  i_sample = wx.fe
+00005ee0: 7463 685f 6461 7461 2028 2765 6469 7327  tch_data ('edis'
+00005ef0: 2c20 7265 7475 726e 5f64 6174 613d 5472  , return_data=Tr
+00005f00: 7565 2c20 7361 6d70 6c65 7320 3d20 3132  ue, samples = 12
+00005f10: 2029 0d0a 2020 2020 2020 2020 3e3e 3e20   )..        >>> 
+00005f20: 7778 2e45 4d28 292e 6669 7428 6564 695f  wx.EM().fit(edi_
+00005f30: 7361 6d70 6c65 292e 6765 7466 756c 6c66  sample).getfullf
+00005f40: 7265 7175 656e 6379 2874 6f5f 6c6f 6731  requency(to_log1
+00005f50: 3020 3d54 7275 6520 290d 0a20 2020 2020  0 =True )..     
+00005f60: 2020 2061 7272 6179 285b 342e 3736 3933     array([4.7693
+00005f70: 3737 3333 2c20 342e 3731 3730 3736 3339  7733, 4.71707639
+00005f80: 2c20 342e 3636 3437 3735 3533 2c20 342e  , 4.66477553, 4.
+00005f90: 3631 3234 3734 3636 2c20 342e 3536 3031  61247466, 4.5601
+00005fa0: 3733 3832 2c0d 0a20 2020 2020 2020 2020  7382,..         
+00005fb0: 2020 2020 2020 342e 3530 3738 3732 3837        4.50787287
+00005fc0: 2c20 342e 3435 3535 3732 3034 2c20 342e  , 4.45557204, 4.
+00005fd0: 3430 3332 3731 3034 2c20 342e 3335 3039  40327104, 4.3509
+00005fe0: 3730 3231 2c20 342e 3239 3836 3639 3238  7021, 4.29866928
+00005ff0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00006000: 2020 342e 3234 3633 3638 3332 2c20 342e    4.24636832, 4.
+00006010: 3139 3430 3637 3631 2c20 342e 3134 3137  19406761, 4.1417
+00006020: 3636 3638 2c20 342e 3038 3934 3635 3635  6668, 4.08946565
+00006030: 2c20 342e 3033 3731 3634 3635 2c0d 0a20  , 4.03716465,.. 
+00006040: 2020 2020 2020 2020 2020 2020 2020 2e2e                ..
+00006050: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00006060: 2020 322e 3637 3733 3432 3238 2c20 322e    2.67734228, 2.
+00006070: 3632 3530 3434 3739 2c20 322e 3537 3237  62504479, 2.5727
+00006080: 3433 3835 2c20 322e 3532 3034 3434 3233  4385, 2.52044423
+00006090: 2c20 322e 3436 3831 3430 3437 2c0d 0a20  , 2.46814047,.. 
+000060a0: 2020 2020 2020 2020 2020 2020 2020 322e                2.
+000060b0: 3431 3538 3431 3037 2c20 322e 3336 3335  41584107, 2.3635
+000060c0: 3336 3737 2c20 322e 3331 3132 3435 3132  3677, 2.31124512
+000060d0: 2c20 322e 3235 3839 3234 3438 2c20 322e  , 2.25892448, 2.
+000060e0: 3230 3636 3337 3031 2c0d 0a20 2020 2020  20663701,..     
+000060f0: 2020 2020 2020 2020 2020 322e 3135 3433            2.1543
+00006100: 3332 3636 2c20 322e 3130 3230 3231 3836  3266, 2.10202186
+00006110: 2c20 322e 3034 3937 3231 3832 2c20 312e  , 2.04972182, 1.
+00006120: 3939 3734 3330 3037 5d29 0d0a 0d0a 2020  99743007])....  
+00006130: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00006140: 2020 2073 656c 662e 696e 7370 6563 7420     self.inspect 
+00006150: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00006160: 2067 6574 5f66 756c 6c5f 6672 6571 7565   get_full_freque
+00006170: 6e63 7920 2873 656c 662e 6564 694f 626a  ncy (self.ediObj
+00006180: 735f 202c 2074 6f5f 6c6f 6731 3020 3d20  s_ , to_log10 = 
+00006190: 746f 5f6c 6f67 3130 2920 0d0a 0d0a 2020  to_log10) ....  
+000061a0: 2020 6465 6620 6d61 6b65 3264 2028 0d0a    def make2d (..
+000061b0: 2020 2020 2020 2020 7365 6c66 2c0d 0a20          self,.. 
+000061c0: 2020 2020 2020 206f 7574 3a73 7472 203d         out:str =
+000061d0: 2027 7265 7378 7927 2c0d 0a20 2020 2020   'resxy',..     
+000061e0: 2020 202a 2c20 0d0a 2020 2020 2020 2020     *, ..        
+000061f0: 6b69 6e64 3a73 7472 203d 2027 636f 6d70  kind:str = 'comp
+00006200: 6c65 7827 202c 200d 0a20 2020 2020 2020  lex' , ..       
+00006210: 202a 2a6b 7773 200d 0a20 2020 2020 2020   **kws ..       
+00006220: 2029 2d3e 204e 4441 7272 6179 5b44 5479   )-> NDArray[DTy
+00006230: 7065 5b66 6c6f 6174 5d5d 3a20 0d0a 2020  pe[float]]: ..  
+00006240: 2020 2020 2020 2222 2220 4f75 7420 3244        """ Out 2D
+00006250: 2072 6573 6973 7469 7669 7479 2c20 7068   resistivity, ph
+00006260: 6173 652d 6572 726f 7220 616e 6420 7465  ase-error and te
+00006270: 6e73 6f72 206d 6174 7269 7820 6672 6f6d  nsor matrix from
+00006280: 2061 2063 6f6c 6c65 6374 696f 6e0d 0a20   a collection.. 
+00006290: 2020 2020 2020 206f 6620 4544 492d 6f62         of EDI-ob
+000062a0: 6a65 6374 732e 200d 0a20 2020 2020 2020  jects. ..       
+000062b0: 200d 0a20 2020 2020 2020 204d 6174 7269   ..        Matri
+000062c0: 7820 6465 7065 6e64 7320 6f66 2074 6865  x depends of the
+000062d0: 206e 756d 6265 7220 6f66 2066 7265 7175   number of frequ
+000062e0: 656e 6379 2074 696d 6573 206e 756d 6265  ency times numbe
+000062f0: 7220 6f66 2073 6974 6573 2e20 0d0a 2020  r of sites. ..  
+00006300: 2020 2020 2020 5468 6520 6675 6e63 7469        The functi
+00006310: 6f6e 2061 7373 6572 7473 2077 6865 7468  on asserts wheth
+00006320: 6572 2061 6c6c 2064 6174 6120 6672 6f6d  er all data from
+00006330: 2061 6c6c 2066 7265 7175 656e 6369 6573   all frequencies
+00006340: 2061 7265 2061 7661 696c 6162 6c65 2e20   are available. 
+00006350: 0d0a 2020 2020 2020 2020 5468 6520 6d69  ..        The mi
+00006360: 7373 696e 6720 7661 6c75 6573 2073 686f  ssing values sho
+00006370: 756c 6420 6265 2066 696c 6c65 6420 6279  uld be filled by
+00006380: 204e 614e 2e20 0d0a 2020 2020 2020 2020   NaN. ..        
+00006390: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+000063a0: 7465 7273 200d 0a20 2020 2020 2020 202d  ters ..        -
+000063b0: 2d2d 2d2d 2d2d 2d2d 2d2d 200d 0a20 2020  ---------- ..   
+000063c0: 2020 2020 2064 6174 613a 2050 6174 682d       data: Path-
+000063d0: 6c69 6b65 206f 626a 6563 7420 6f72 206c  like object or l
+000063e0: 6973 7420 6f66 2070 7963 7361 6d74 2e63  ist of pycsamt.c
+000063f0: 6f72 652e 6564 6920 6f62 6a65 6374 730d  ore.edi objects.
+00006400: 0a20 2020 2020 2020 2020 2020 2043 6f6c  .            Col
+00006410: 6c65 6374 696f 6e73 206f 6620 4544 492d  lections of EDI-
+00006420: 6f62 6a65 6374 7320 6672 6f6d 2060 7079  objects from `py
+00006430: 6373 616d 7460 5f20 6f72 2066 756c 6c20  csamt`_ or full 
+00006440: 7061 7468 2074 6f20 4544 4920 6669 6c65  path to EDI file
+00006450: 732e 0d0a 2020 2020 2020 2020 6f75 743a  s...        out:
+00006460: 2073 7472 200d 0a20 2020 2020 2020 2020   str ..         
+00006470: 2020 206b 696e 6420 6f66 2064 6174 6120     kind of data 
+00006480: 746f 206f 7574 7075 742e 2042 6520 7375  to output. Be su
+00006490: 7265 2074 6f20 7072 6f76 6964 6520 7468  re to provide th
+000064a0: 6520 636f 6d70 6f6e 656e 7420 746f 2072  e component to r
+000064b0: 6574 7269 6576 6520 0d0a 2020 2020 2020  etrieve ..      
+000064c0: 2020 2020 2020 7468 6520 6174 7472 6962        the attrib
+000064d0: 7574 6520 6672 6f6d 2074 6865 2063 6f6c  ute from the col
+000064e0: 6c65 6374 696f 6e20 6f62 6a65 6374 2e20  lection object. 
+000064f0: 4578 6365 7074 2074 6865 2060 6572 726f  Except the `erro
+00006500: 7260 2061 6e64 200d 0a20 2020 2020 2020  r` and ..       
+00006510: 2020 2020 2066 7265 7175 656e 6379 2061       frequency a
+00006520: 7474 7269 6275 7465 2c20 7468 6520 6d69  ttribute, the mi
+00006530: 7373 696e 6720 636f 6d70 6f6e 656e 7420  ssing component 
+00006540: 746f 2074 6865 2061 7474 7269 6275 7465  to the attribute
+00006550: 2077 696c 6c20 0d0a 2020 2020 2020 2020   will ..        
+00006560: 2020 2020 7261 6973 6520 616e 2065 7272      raise an err
+00006570: 6f72 2e20 666f 7220 696e 7374 616e 6365  or. for instance
+00006580: 2060 6072 6573 7879 6060 2066 6f72 2078   ``resxy`` for x
+00006590: 7920 636f 6d70 6f6e 656e 742e 2044 6566  y component. Def
+000065a0: 6175 6c74 2069 7320 0d0a 2020 2020 2020  ault is ..      
+000065b0: 2020 2020 2020 6060 7265 7378 7960 602e        ``resxy``.
+000065c0: 200d 0a20 2020 2020 2020 206b 696e 6420   ..        kind 
+000065d0: 3a20 626f 6f6c 206f 7220 7374 7220 0d0a  : bool or str ..
+000065e0: 2020 2020 2020 2020 2020 2020 666f 6375              focu
+000065f0: 7365 7320 6f6e 2074 6865 2074 656e 736f  ses on the tenso
+00006600: 7220 6f75 7470 7574 2e20 4e6f 7465 2074  r output. Note t
+00006610: 6861 7420 7468 6520 7465 6e73 6f72 2069  hat the tensor i
+00006620: 7320 6120 636f 6d70 6c65 7820 6e75 6d62  s a complex numb
+00006630: 6572 200d 0a20 2020 2020 2020 2020 2020  er ..           
+00006640: 206f 6620 6e64 6172 7261 7920 286e 6672   of ndarray (nfr
+00006650: 6571 2c20 322c 3220 292e 2049 6620 7365  eq, 2,2 ). If se
+00006660: 7420 746f 6060 6d6f 6475 6c75 7360 2c20  t to``modulus`, 
+00006670: 7468 6520 6d6f 6475 6c75 7320 6f66 2074  the modulus of t
+00006680: 6865 2063 6f6d 706c 6578 200d 0a20 2020  he complex ..   
+00006690: 2020 2020 2020 2020 2074 656e 736f 7220           tensor 
+000066a0: 7368 6f75 6c64 2062 6520 6f75 7470 7574  should be output
+000066b0: 7465 642e 2049 6620 6060 7265 616c 6060  ted. If ``real``
+000066c0: 206f 7260 6069 6d61 6760 602c 2069 7420   or``imag``, it 
+000066d0: 7265 7475 726e 7320 6f6e 6c79 0d0a 2020  returns only..  
+000066e0: 2020 2020 2020 2020 2020 7468 6520 7370            the sp
+000066f0: 6563 6966 6963 206f 6e65 2e20 4465 6661  ecific one. Defa
+00006700: 756c 7420 6973 2060 6063 6f6d 706c 6578  ult is ``complex
+00006710: 6060 2e0d 0a20 2020 2020 2020 2020 2020  ``...           
+00006720: 200d 0a20 2020 2020 2020 206b 7773 3a20   ..        kws: 
+00006730: 6469 6374 200d 0a20 2020 2020 2020 2020  dict ..         
+00006740: 2020 2041 6464 6974 696f 6e61 6c20 6b65     Additional ke
+00006750: 7977 6f72 6473 2061 7267 756d 656e 7473  ywords arguments
+00006760: 2066 726f 6d20 3a66 756e 633a 607e 2e67   from :func:`~.g
+00006770: 6574 6675 6c6c 6672 6571 7565 6e63 7920  etfullfrequency 
+00006780: 602e 200d 0a20 2020 2020 2020 200d 0a20  `. ..        .. 
+00006790: 2020 2020 2020 2052 6574 7572 6e73 200d         Returns .
+000067a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000067b0: 2d20 0d0a 2020 2020 2020 2020 6d61 7432  - ..        mat2
+000067c0: 6420 3a20 6e70 2e6e 6461 7272 6179 286e  d : np.ndarray(n
+000067d0: 6672 6571 2c20 6e73 7461 7469 6f6e 7329  freq, nstations)
+000067e0: 200d 0a20 2020 2020 2020 2020 2020 2074   ..            t
+000067f0: 6865 206d 6174 7269 7820 6f66 206e 756d  he matrix of num
+00006800: 6265 7220 6f66 2066 7265 7175 656e 6379  ber of frequency
+00006810: 2061 6e64 206e 756d 6265 7220 6f66 2045   and number of E
+00006820: 6469 2d63 6f6c 6c65 6374 6573 2077 6869  di-collectes whi
+00006830: 6368 200d 0a20 2020 2020 2020 2020 2020  ch ..           
+00006840: 2063 6f72 7265 7370 6f6e 6420 746f 2074   correspond to t
+00006850: 6865 206e 756d 6265 7220 6f66 2074 6865  he number of the
+00006860: 2073 7461 7469 6f6e 732f 7369 7465 732e   stations/sites.
+00006870: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00006880: 2020 2020 2045 7861 6d70 6c65 7320 0d0a       Examples ..
+00006890: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000068a0: 2d0d 0a20 2020 2020 2020 203e 3e3e 2066  -..        >>> f
+000068b0: 726f 6d20 7761 7465 782e 6d65 7468 6f64  rom watex.method
+000068c0: 732e 656d 2069 6d70 6f72 7420 454d 200d  s.em import EM .
+000068d0: 0a20 2020 2020 2020 203e 3e3e 2065 6469  .        >>> edi
+000068e0: 7061 7468 203d 2764 6174 612f 6564 6973  path ='data/edis
+000068f0: 270d 0a20 2020 2020 2020 203e 3e3e 2065  '..        >>> e
+00006900: 6d4f 626a 733d 2045 4d28 292e 6669 7428  mObjs= EM().fit(
+00006910: 6564 6970 6174 6829 0d0a 2020 2020 2020  edipath)..      
+00006920: 2020 3e3e 3e20 7068 7978 203d 2045 4d28    >>> phyx = EM(
+00006930: 292e 6d61 6b65 3264 2028 2770 6861 7365  ).make2d ('phase
+00006940: 7978 2729 0d0a 2020 2020 2020 2020 3e3e  yx')..        >>
+00006950: 3e20 7068 7978 200d 0a20 2020 2020 2020  > phyx ..       
+00006960: 202e 2e2e 2061 7272 6179 285b 5b20 3236   ... array([[ 26
+00006970: 2e34 3235 3436 3539 332c 2020 3332 2e37  .42546593,  32.7
+00006980: 3130 3636 3435 342c 2020 3330 2e39 3232  1066454,  30.922
+00006990: 3237 3436 205d 2c0d 0a20 2020 2020 2020  2746 ],..       
+000069a0: 2020 2020 2020 2020 5b20 3434 2e32 3539          [ 44.259
+000069b0: 3930 3534 312c 2020 3430 2e37 3739 3131  90541,  40.77911
+000069c0: 3133 362c 2020 3431 2e30 3333 3931 3438  136,  41.0339148
+000069d0: 205d 2c0d 0a20 2020 2020 2020 2020 2020   ],..           
+000069e0: 2020 2020 2e2e 2e0d 0a20 2020 2020 2020      .....       
+000069f0: 2020 2020 2020 2020 5b20 3337 2e36 3635          [ 37.665
+00006a00: 3934 3638 362c 2020 3333 2e30 3333 3735  94686,  33.03375
+00006a10: 3836 332c 2020 3335 2e37 3534 3230 3830  863,  35.7542080
+00006a20: 325d 2c0d 0a20 2020 2020 2020 2020 2020  2],..           
+00006a30: 2020 2020 5b20 2020 2020 2020 2020 6e61      [         na
+00006a40: 6e2c 2020 2020 2020 2020 2020 6e61 6e2c  n,          nan,
+00006a50: 2020 3434 2e30 3434 3938 3739 315d 5d29    44.04498791]])
+00006a60: 0d0a 2020 2020 2020 2020 3e3e 3e20 7068  ..        >>> ph
+00006a70: 7978 2e73 6861 7065 200d 0a20 2020 2020  yx.shape ..     
+00006a80: 2020 202e 2e2e 2028 3535 2c20 3329 0d0a     ... (55, 3)..
+00006a90: 2020 2020 2020 2020 3e3e 3e20 2320 6765          >>> # ge
+00006aa0: 7420 7468 6520 7265 616c 206e 756d 6265  t the real numbe
+00006ab0: 7220 6f66 2074 6865 2079 7920 636f 6d70  r of the yy comp
+00006ac0: 6f6e 6574 206f 6620 7465 6e73 6f72 207a  onet of tensor z
+00006ad0: 200d 0a20 2020 2020 2020 203e 3e3e 207a   ..        >>> z
+00006ae0: 7979 5f72 203d 206d 616b 6532 6420 2865  yy_r = make2d (e
+00006af0: 6469 4f62 6a73 2c20 277a 7978 272c 206b  diObjs, 'zyx', k
+00006b00: 696e 6420 3d27 7265 616c 2729 0d0a 2020  ind ='real')..  
+00006b10: 2020 2020 2020 2e2e 2e20 6172 7261 7928        ... array(
+00006b20: 5b5b 2034 3136 352e 3620 2020 2c20 2038  [[ 4165.6   ,  8
+00006b30: 3636 352e 3634 2020 2c20 2035 3238 352e  665.64  ,  5285.
+00006b40: 3437 2020 5d2c 0d0a 2020 2020 2020 2020  47  ],..        
+00006b50: 2020 2020 2020 205b 2037 3037 322e 3831         [ 7072.81
+00006b60: 2020 2c20 3131 3636 332e 3120 2020 2c20    , 11663.1   , 
+00006b70: 2036 3930 302e 3333 2020 5d2c 0d0a 2020   6900.33  ],..  
+00006b80: 2020 2020 2020 2020 2020 2020 202e 2e2e               ...
+00006b90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00006ba0: 205b 2020 2039 302e 3730 3939 2c20 2020   [   90.7099,   
+00006bb0: 3131 392e 3530 3520 2c20 2020 3132 322e  119.505 ,   122.
+00006bc0: 3334 3320 5d2c 0d0a 2020 2020 2020 2020  343 ],..        
+00006bd0: 2020 2020 2020 205b 2020 2020 2020 206e         [       n
+00006be0: 616e 2c20 2020 2020 2020 206e 616e 2c20  an,        nan, 
+00006bf0: 2020 2038 382e 3036 3234 5d5d 290d 0a20     88.0624]]).. 
+00006c00: 2020 2020 2020 203e 3e3e 2023 2067 6574         >>> # get
+00006c10: 2074 6865 2072 6573 6973 7469 7669 7479   the resistivity
+00006c20: 2065 7272 6f72 206f 6620 636f 6d70 6f6e   error of compon
+00006c30: 656e 7420 2778 7927 0d0a 2020 2020 2020  ent 'xy'..      
+00006c40: 2020 3e3e 3e20 7265 7378 795f 6572 7220    >>> resxy_err 
+00006c50: 3d20 454d 2e6d 616b 6532 6420 2827 7265  = EM.make2d ('re
+00006c60: 7378 795f 6572 7227 290d 0a20 2020 2020  sxy_err')..     
+00006c70: 2020 203e 3e3e 2072 6573 7879 5f65 7272     >>> resxy_err
+00006c80: 200d 0a20 2020 2020 2020 202e 2e2e 2061   ..        ... a
+00006c90: 7272 6179 285b 5b30 2e30 3133 3239 3033  rray([[0.0132903
+00006ca0: 372c 2030 2e30 3239 3432 3535 372c 2030  7, 0.02942557, 0
+00006cb0: 2e30 3137 3630 3334 205d 2c0d 0a20 2020  .0176034 ],..   
+00006cc0: 2020 2020 2020 2020 2020 2020 5b30 2e30              [0.0
+00006cd0: 3333 3539 3039 202c 2030 2e30 3532 3338  335909 , 0.05238
+00006ce0: 3836 332c 2030 2e30 3331 3131 3437 355d  863, 0.03111475]
+00006cf0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00006d00: 2020 2e2e 2e0d 0a20 2020 2020 2020 2020    .....         
+00006d10: 2020 2020 2020 5b33 2e33 3333 3539 3934        [3.3335994
+00006d20: 322c 2034 2e31 3436 3834 3932 362c 2034  2, 4.14684926, 4
+00006d30: 2e33 3835 3632 3237 315d 2c0d 0a20 2020  .38562271],..   
+00006d40: 2020 2020 2020 2020 2020 2020 5b20 2020              [   
+00006d50: 2020 2020 6e61 6e2c 2020 2020 2020 2020      nan,        
+00006d60: 6e61 6e2c 2034 2e33 3536 3035 3630 335d  nan, 4.35605603]
+00006d70: 5d29 0d0a 2020 2020 2020 2020 3e3e 3e20  ])..        >>> 
+00006d80: 7068 7978 2e73 6861 7065 202c 7a79 795f  phyx.shape ,zyy_
+00006d90: 722e 7368 6170 652c 2072 6573 7879 5f65  r.shape, resxy_e
+00006da0: 7272 2e73 6861 7065 2020 0d0a 2020 2020  rr.shape  ..    
+00006db0: 2020 2020 2e2e 2e20 2828 3535 2c20 3329      ... ((55, 3)
+00006dc0: 2c20 2835 352c 2033 292c 2028 3535 2c20  , (55, 3), (55, 
+00006dd0: 3329 290d 0a20 2020 2020 2020 200d 0a20  3))..        .. 
+00006de0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00006df0: 2020 2020 7365 6c66 2e69 6e73 7065 6374      self.inspect
+00006e00: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00006e10: 2020 2020 2064 6566 2066 6974 3264 616c       def fit2dal
+00006e20: 6c28 6f62 6a73 2c20 6174 7472 2c20 636f  l(objs, attr, co
+00006e30: 6d70 293a 200d 0a20 2020 2020 2020 2020  mp): ..         
+00006e40: 2020 2022 2222 2052 6561 6420 616c 6c20     """ Read all 
+00006e50: 6564 694f 626a 7320 616e 6420 7265 706c  ediObjs and repl
+00006e60: 6163 6520 616c 6c20 6d69 7373 696e 6720  ace all missing 
+00006e70: 6461 7461 2062 7920 4e61 4e20 7661 6c75  data by NaN valu
+00006e80: 652e 200d 0a20 2020 2020 2020 2020 2020  e. ..           
+00006e90: 200d 0a20 2020 2020 2020 2020 2020 2054   ..            T
+00006ea0: 6869 7320 6973 2075 7365 6675 6c20 746f  his is useful to
+00006eb0: 206c 6574 2074 6865 2061 7272 6179 7320   let the arrays 
+00006ec0: 6174 2065 6163 6820 7374 6174 696f 6e20  at each station 
+00006ed0: 746f 2020 6d61 7463 6820 7468 6520 6c65  to  match the le
+00006ee0: 6e67 7468 200d 0a20 2020 2020 2020 2020  ngth ..         
+00006ef0: 2020 206f 6620 7468 6520 636f 6d70 6c65     of the comple
+00006f00: 7465 2066 7265 7175 656e 6379 2072 6174  te frequency rat
+00006f10: 6865 7220 7468 616e 2073 6872 756e 6b69  her than shrunki
+00006f20: 6e67 2020 7570 2073 6f6d 6520 6461 7461  ng  up some data
+00006f30: 2e20 5468 6520 0d0a 2020 2020 2020 2020  . The ..        
+00006f40: 2020 2020 6d69 7373 696e 6720 6461 7461      missing data
+00006f50: 2073 686f 756c 6420 6265 2066 696c 6c65   should be fille
+00006f60: 6420 6279 204e 614e 2076 616c 7565 732e  d by NaN values.
+00006f70: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
+00006f80: 0a20 2020 2020 2020 2020 2020 2022 2222  .            """
+00006f90: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00006fa0: 7573 6520 205b 6765 7461 7474 7228 2065  use  [getattr( e
+00006fb0: 6469 4f62 6a2e 5a2c 2066 227b 6174 7472  diObj.Z, f"{attr
+00006fc0: 7d22 295b 7475 706c 6520 2820 5f63 2e67  }")[tuple ( _c.g
+00006fd0: 6574 2863 6f6d 7029 292e 2e2e 200d 0a20  et(comp))... .. 
+00006fe0: 2020 2020 2020 2020 2020 2023 2077 6865             # whe
+00006ff0: 7265 200d 0a20 2020 2020 2020 2020 2020  re ..           
+00007000: 2023 2023 3d3e 2073 6c69 6365 2069 6e64   # #=> slice ind
+00007010: 6578 2066 6f72 2063 6f6d 706f 6e65 6e74  ex for component
+00007020: 2072 6574 7265 6976 696e 6720 7075 7270   retreiving purp
+00007030: 6f73 6520 0d0a 2020 2020 2020 2020 2020  ose ..          
+00007040: 2020 2320 5f63 3d20 7b0d 0a20 2020 2020    # _c= {..     
+00007050: 2020 2020 2020 2023 2020 2020 2020 2027         #       '
+00007060: 7878 273a 205b 736c 6963 6520 284e 6f6e  xx': [slice (Non
+00007070: 652c 206c 656e 2873 656c 662e 6672 6571  e, len(self.freq
+00007080: 735f 2929 2c20 3020 2c20 305d 202c 200d  s_)), 0 , 0] , .
+00007090: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
+000070a0: 2020 2020 2027 7879 273a 205b 736c 6963       'xy': [slic
+000070b0: 6520 284e 6f6e 652c 206c 656e 2873 656c  e (None, len(sel
+000070c0: 662e 6672 6571 735f 2929 2c20 3020 2c20  f.freqs_)), 0 , 
+000070d0: 315d 2c20 0d0a 2020 2020 2020 2020 2020  1], ..          
+000070e0: 2020 2320 2020 2020 2020 2779 7827 3a20    #       'yx': 
+000070f0: 5b73 6c69 6365 2028 4e6f 6e65 2c20 6c65  [slice (None, le
+00007100: 6e28 7365 6c66 2e66 7265 7173 5f29 292c  n(self.freqs_)),
+00007110: 2031 202c 2030 5d2c 200d 0a20 2020 2020   1 , 0], ..     
+00007120: 2020 2020 2020 2023 2020 2020 2020 2027         #       '
+00007130: 7979 273a 205b 736c 6963 6520 284e 6f6e  yy': [slice (Non
+00007140: 652c 206c 656e 2873 656c 662e 6672 6571  e, len(self.freq
+00007150: 735f 2929 2c20 312c 2020 315d 200d 0a20  s_)), 1,  1] .. 
+00007160: 2020 2020 2020 2020 2020 2023 207d 0d0a             # }..
+00007170: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00007180: 2020 2020 2020 2020 2020 7a6c 203d 205b            zl = [
+00007190: 6765 7461 7474 7228 2065 6469 4f62 6a2e  getattr( ediObj.
+000071a0: 5a2c 2066 227b 6174 7472 7d22 295b 7475  Z, f"{attr}")[tu
+000071b0: 706c 6520 2820 0d0a 2020 2020 2020 2020  ple ( ..        
+000071c0: 2020 2020 2020 2020 7365 6c66 2e74 736c          self.tsl
+000071d0: 6963 6572 2829 2e67 6574 2863 6f6d 7029  icer().get(comp)
+000071e0: 295d 0d0a 2020 2020 2020 2020 2020 2020  )]..            
+000071f0: 2020 2020 2020 666f 7220 6564 694f 626a        for ediObj
+00007200: 2069 6e20 6f62 6a73 205d 0d0a 2020 2020   in objs ]..    
+00007210: 2020 2020 2020 2020 6966 206e 616d 6520          if name 
+00007220: 3d3d 277a 273a 200d 0a20 2020 2020 2020  =='z': ..       
+00007230: 2020 2020 2020 2020 2069 6620 6b69 6e64           if kind
+00007240: 203d 3d27 6d6f 6475 6c75 7327 3a20 0d0a   =='modulus': ..
+00007250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007260: 2020 2020 7a6c 203d 205b 206e 702e 6162      zl = [ np.ab
+00007270: 7320 2876 2920 666f 7220 7620 696e 207a  s (v) for v in z
+00007280: 6c5d 0d0a 2020 2020 2020 2020 2020 2020  l]..            
+00007290: 2020 2020 2020 2020 7a6c 203d 205b 6669          zl = [fi
+000072a0: 7474 656e 736f 7228 7365 6c66 2e66 7265  ttensor(self.fre
+000072b0: 7173 5f2c 2065 6469 4f62 6a2e 5a2e 5f66  qs_, ediObj.Z._f
+000072c0: 7265 712c 2076 290d 0a20 2020 2020 2020  req, v)..       
 000072d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000072e0: 2020 2020 2020 2020 2066 6f72 2065 6469           for edi
-000072f0: 4f62 6a20 2c20 2076 2020 696e 207a 6970  Obj ,  v  in zip
-00007300: 286f 626a 732c 207a 6c29 5d0d 0a20 2020  (objs, zl)]..   
-00007310: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00007320: 6b69 6e64 2069 6e20 2827 7265 616c 2720  kind in ('real' 
-00007330: 2c20 2763 6f6d 706c 6578 2729 203a 200d  , 'complex') : .
-00007340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007350: 2020 2020 207a 7220 3d20 5b66 6974 7465       zr = [fitte
-00007360: 6e73 6f72 2873 656c 662e 6672 6571 735f  nsor(self.freqs_
-00007370: 2c20 6564 694f 626a 2e5a 2e5f 6672 6571  , ediObj.Z._freq
-00007380: 2c20 762e 7265 616c 290d 0a20 2020 2020  , v.real)..     
-00007390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000073a0: 2020 2020 2066 6f72 2065 6469 4f62 6a20       for ediObj 
-000073b0: 2c20 2076 2020 696e 207a 6970 286f 626a  ,  v  in zip(obj
-000073c0: 732c 207a 6c29 5d0d 0a20 2020 2020 2020  s, zl)]..       
-000073d0: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-000073e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000073f0: 6620 6b69 6e64 2069 6e20 2827 696d 6167  f kind in ('imag
-00007400: 272c 2027 636f 6d70 6c65 7827 293a 200d  ', 'complex'): .
-00007410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007420: 2020 2020 207a 693d 205b 6669 7474 656e       zi= [fitten
-00007430: 736f 7228 7365 6c66 2e66 7265 7173 5f2c  sor(self.freqs_,
-00007440: 2065 6469 4f62 6a2e 5a2e 5f66 7265 712c   ediObj.Z._freq,
-00007450: 2076 2e69 6d61 6729 0d0a 2020 2020 2020   v.imag)..      
-00007460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007470: 2020 2020 666f 7220 6564 694f 626a 202c      for ediObj ,
-00007480: 2020 7620 2069 6e20 7a69 7028 6f62 6a73    v  in zip(objs
-00007490: 2c20 7a6c 295d 0d0a 2020 2020 2020 2020  , zl)]..        
-000074a0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-000074b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000074c0: 206b 696e 6420 3d3d 2763 6f6d 706c 6578   kind =='complex
-000074d0: 273a 200d 0a20 2020 2020 2020 2020 2020  ': ..           
-000074e0: 2020 2020 2020 2020 207a 6c20 3d20 5b20           zl = [ 
-000074f0: 7220 2b20 316a 202a 2069 6d20 666f 7220  r + 1j * im for 
-00007500: 722c 2069 6d20 696e 207a 6970 2028 7a72  r, im in zip (zr
-00007510: 2c20 7a69 295d 0d0a 2020 2020 2020 2020  , zi)]..        
-00007520: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00007530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007540: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00007550: 2020 2020 7a6c 203d 207a 6c20 6966 206b      zl = zl if k
-00007560: 696e 6420 696e 2028 276d 6f64 756c 7573  ind in ('modulus
-00007570: 272c 2027 636f 6d70 6c65 7827 2920 656c  ', 'complex') el
-00007580: 7365 2028 0d0a 2020 2020 2020 2020 2020  se (..          
-00007590: 2020 2020 2020 2020 2020 7a72 2069 6620            zr if 
-000075a0: 6b69 6e64 203d 3d27 7265 616c 2720 656c  kind =='real' el
-000075b0: 7365 207a 6920 2920 2020 200d 0a20 2020  se zi )    ..   
-000075c0: 2020 2020 2020 2020 2065 6c73 6520 3a20           else : 
-000075d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000075e0: 2020 7a6c 203d 205b 6669 7474 656e 736f    zl = [fittenso
-000075f0: 7228 7365 6c66 2e66 7265 7173 5f2c 2065  r(self.freqs_, e
-00007600: 6469 4f62 6a2e 5a2e 5f66 7265 712c 2076  diObj.Z._freq, v
-00007610: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00007620: 2020 2020 2020 2020 2066 6f72 2065 6469           for edi
-00007630: 4f62 6a20 2c20 2076 2020 696e 207a 6970  Obj ,  v  in zip
-00007640: 286f 626a 732c 207a 6c29 5d0d 0a20 2020  (objs, zl)]..   
-00007650: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-00007660: 2020 2020 2020 2020 2020 2023 2073 7461             # sta
-00007670: 636b 6564 2074 6865 207a 2076 616c 7565  cked the z value
-00007680: 7320 616c 6f6d 7820 6178 6973 3d31 2e20  s alomx axis=1. 
-00007690: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-000076a0: 7475 726e 206e 702e 6873 7461 636b 2028  turn np.hstack (
-000076b0: 5b20 7265 7368 6170 6520 286f 2c20 6178  [ reshape (o, ax
-000076c0: 6973 3d30 2920 666f 7220 6f20 696e 207a  is=0) for o in z
-000076d0: 6c5d 290d 0a20 2020 2020 2020 2020 2020  l])..           
-000076e0: 0d0a 2020 2020 2020 2020 2320 7265 6164  ..        # read
-000076f0: 2f61 7373 6572 7420 6564 6973 2061 6e64  /assert edis and
-00007700: 2067 6574 2074 6865 2063 6f6d 706c 6574   get the complet
-00007710: 6520 6672 6571 7565 6e63 7920 2020 2020  e frequency     
-00007720: 0d0a 2020 2020 2020 2020 6e61 6d65 202c  ..        name ,
-00007730: 206d 3220 3d20 5f76 616c 6964 6174 655f   m2 = _validate_
-00007740: 7465 6e73 6f72 286f 7574 203d 206f 7574  tensor(out = out
-00007750: 202c 206b 696e 6420 3d20 6b69 6e64 2c20   , kind = kind, 
-00007760: 2a2a 6b77 7320 290d 0a20 2020 2020 2020  **kws )..       
-00007770: 200d 0a20 2020 2020 2020 2023 3d3d 3e20   ..        #==> 
-00007780: 7265 7475 726e 7320 6d61 7432 6420 6672  returns mat2d fr
-00007790: 6571 200d 0a20 2020 2020 2020 2023 2069  eq ..        # i
-000077a0: 6620 6d31 203d 3d27 5f66 7265 7127 3a20  f m1 =='_freq': 
-000077b0: 0d0a 2020 2020 2020 2020 6966 206e 616d  ..        if nam
-000077c0: 6520 3d3d 275f 6672 6571 273a 200d 0a20  e =='_freq': .. 
-000077d0: 2020 2020 2020 2020 2020 2066 3264 2020             f2d  
-000077e0: 3d20 5b66 6974 7465 6e73 6f72 2873 656c  = [fittensor(sel
-000077f0: 662e 6672 6571 735f 2c20 6564 694f 626a  f.freqs_, ediObj
-00007800: 2e5a 2e5f 6672 6571 2c20 6564 694f 626a  .Z._freq, ediObj
-00007810: 2e5a 2e5f 6672 6571 290d 0a20 2020 2020  .Z._freq)..     
-00007820: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00007830: 2065 6469 4f62 6a20 696e 2073 656c 662e   ediObj in self.
-00007840: 6564 694f 626a 735f 0d0a 2020 2020 2020  ediObjs_..      
-00007850: 2020 2020 2020 2020 2020 2020 5d0d 0a20              ].. 
-00007860: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00007870: 6e20 206e 702e 6873 7461 636b 2028 5b20  n  np.hstack ([ 
-00007880: 7265 7368 6170 6520 286f 2c20 6178 6973  reshape (o, axis
-00007890: 3d30 2920 666f 7220 6f20 696e 2066 3264  =0) for o in f2d
-000078a0: 5d29 0d0a 2020 2020 2020 2020 0d0a 2020  ])..        ..  
-000078b0: 2020 2020 2020 2320 2320 6765 7420 7468        # # get th
-000078c0: 6520 7661 6c75 6520 666f 7220 6578 706f  e value for expo
-000078d0: 7274 6174 696f 6e20 2861 7474 7269 6275  rtation (attribu
-000078e0: 7465 206e 616d 6520 616e 6420 636f 6d70  te name and comp
-000078f0: 6f6e 656e 7473 290d 0a20 2020 2020 2020  onents)..       
-00007900: 206d 6174 3264 2020 3d20 6669 7432 6461   mat2d  = fit2da
-00007910: 6c6c 286f 626a 733d 2073 656c 662e 6564  ll(objs= self.ed
-00007920: 694f 626a 735f 2c20 6174 7472 3d20 6e61  iObjs_, attr= na
-00007930: 6d65 2c20 636f 6d70 3d20 6d32 290d 0a20  me, comp= m2).. 
-00007940: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00007950: 2072 6574 7572 6e20 6d61 7432 6420 0d0a   return mat2d ..
-00007960: 200d 0a20 2020 2064 6566 2067 6574 7265   ..    def getre
-00007970: 6665 7265 6e63 6566 7265 7175 656e 6379  ferencefrequency
-00007980: 2028 0d0a 2020 2020 2020 2020 7365 6c66   (..        self
-00007990: 2c0d 0a20 2020 2020 2020 2074 6f5f 6c6f  ,..        to_lo
-000079a0: 6731 303a 2062 6f6f 6c20 3d46 616c 7365  g10: bool =False
-000079b0: 0d0a 2020 2020 2020 2020 293a 200d 0a20  ..        ): .. 
-000079c0: 2020 2020 2020 2022 2222 2047 6574 2074         """ Get t
-000079d0: 6865 2072 6566 6572 656e 6365 2066 7265  he reference fre
-000079e0: 7175 656e 6379 2066 726f 6d20 636f 6c6c  quency from coll
-000079f0: 6563 7469 6f6e 2045 6469 7320 6f62 6a65  ection Edis obje
-00007a00: 6374 732e 0d0a 2020 2020 2020 2020 0d0a  cts...        ..
-00007a10: 2020 2020 2020 2020 5468 6520 6869 6768          The high
-00007a20: 6573 7420 6672 6571 7565 6e63 7920 7769  est frequency wi
-00007a30: 7468 2063 6c65 616e 2064 6174 6120 7368  th clean data sh
-00007a40: 6f75 6c64 2062 6520 7365 6c65 6374 6564  ould be selected
-00007a50: 2061 7320 7468 6520 200d 0a20 2020 2020   as the  ..     
-00007a60: 2020 2072 6566 6572 656e 6365 2066 7265     reference fre
-00007a70: 7175 656e 6379 0d0a 2020 2020 2020 2020  quency..        
-00007a80: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00007a90: 7465 7273 200d 0a20 2020 2020 2020 202d  ters ..        -
-00007aa0: 2d2d 2d2d 2d2d 2d2d 2d20 0d0a 2020 2020  --------- ..    
-00007ab0: 2020 2020 6461 7461 3a20 6c69 7374 2020      data: list  
-00007ac0: 6f66 2020 7079 6373 616d 742e 636f 7265  of  pycsamt.core
-00007ad0: 2e65 6469 2e45 6469 206f 7220 6d74 7079  .edi.Edi or mtpy
-00007ae0: 2e63 6f72 652e 6564 692e 4564 6920 6f62  .core.edi.Edi ob
-00007af0: 6a65 6374 7320 0d0a 2020 2020 2020 2020  jects ..        
-00007b00: 2020 2020 436f 6c6c 6563 7469 6f6e 7320      Collections 
-00007b10: 6f66 2045 4449 2d6f 626a 6563 7473 2066  of EDI-objects f
-00007b20: 726f 6d20 6070 7963 7361 6d74 605f 200d  rom `pycsamt`_ .
-00007b30: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00007b40: 2020 2020 2020 2074 6f5f 6c6f 6731 303a         to_log10:
-00007b50: 2062 6f6f 6c2c 200d 0a20 2020 2020 2020   bool, ..       
-00007b60: 2020 2020 206f 7574 7075 7473 2074 6865       outputs the
-00007b70: 2072 6566 6572 656e 6365 2066 7265 7175   reference frequ
-00007b80: 656e 6379 2069 6e74 6f20 6261 7365 2031  ency into base 1
-00007b90: 3020 6c6f 6761 7269 7468 6d20 696e 2048  0 logarithm in H
-00007ba0: 7a2e 0d0a 2020 2020 2020 2020 0d0a 2020  z...        ..  
-00007bb0: 2020 2020 2020 5265 7475 726e 7320 0d0a        Returns ..
-00007bc0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-00007bd0: 0a20 2020 2020 2020 2072 6620 3a20 666c  .        rf : fl
-00007be0: 6f61 7420 0d0a 2020 2020 2020 2020 2020  oat ..          
-00007bf0: 2020 7468 6520 7265 6665 7265 6e63 6520    the reference 
-00007c00: 6672 6571 7565 6e63 7920 6174 2074 6865  frequency at the
-00007c10: 2063 6c65 616e 2064 6174 6120 696e 2048   clean data in H
-00007c20: 7a20 0d0a 2020 2020 2020 2020 2020 2020  z ..            
-00007c30: 0d0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00007c40: 6573 200d 0a20 2020 2020 2020 202d 2d2d  es ..        ---
-00007c50: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00007c60: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e6d  >>> from watex.m
-00007c70: 6574 686f 6473 2e65 6d20 696d 706f 7274  ethods.em import
-00007c80: 2045 4d20 200d 0a20 2020 2020 2020 203e   EM  ..        >
-00007c90: 3e3e 2065 6469 7061 7468 203d 2764 6174  >> edipath ='dat
-00007ca0: 612f 3365 6469 7327 0d0a 2020 2020 2020  a/3edis'..      
-00007cb0: 2020 3e3e 3e20 7265 6620 3d20 454d 2829    >>> ref = EM()
-00007cc0: 2e67 6574 7265 6665 7265 6e63 6566 7265  .getreferencefre
-00007cd0: 7175 656e 6379 2865 6469 7061 7468 2c20  quency(edipath, 
-00007ce0: 746f 5f6c 6f67 3130 3d54 7275 6529 0d0a  to_log10=True)..
-00007cf0: 2020 2020 2020 2020 3e3e 3e20 7265 6620          >>> ref 
-00007d00: 0d0a 2020 2020 2020 2020 2e2e 2e20 342e  ..        ... 4.
-00007d10: 3834 3530 3938 3034 3030 3134 3235 3720  845098040014257 
-00007d20: 2320 696e 2048 7a20 0d0a 2020 2020 2020  # in Hz ..      
-00007d30: 2020 0d0a 2020 2020 2020 2020 5265 6665    ..        Refe
-00007d40: 7265 6e63 6573 200d 0a20 2020 2020 2020  rences ..       
-00007d50: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00007d60: 2020 2020 2068 7474 703a 2f2f 7777 772e       http://www.
-00007d70: 7a6f 6e67 652e 636f 6d2f 6c65 6761 6379  zonge.com/legacy
-00007d80: 2f50 4446 5f44 6174 5072 6f2f 4173 7461  /PDF_DatPro/Asta
-00007d90: 7469 632e 7064 660d 0a20 2020 2020 2020  tic.pdf..       
-00007da0: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
-00007db0: 2020 2020 2020 2020 7365 6c66 2e69 6e73          self.ins
-00007dc0: 7065 6374 200d 0a20 2020 2020 2020 2073  pect ..        s
-00007dd0: 656c 662e 6672 6571 735f 3d20 7365 6c66  elf.freqs_= self
-00007de0: 2e67 6574 6675 6c6c 6672 6571 7565 6e63  .getfullfrequenc
-00007df0: 7920 2829 0d0a 2020 2020 2020 2020 2320  y ()..        # 
-00007e00: 6669 7420 7a20 616e 6420 6669 6e64 2061  fit z and find a
-00007e10: 6c6c 206d 6973 7369 6e67 2064 6174 6120  ll missing data 
-00007e20: 6672 6f6d 2063 6f6d 706c 6574 6520 6672  from complete fr
-00007e30: 6571 7565 6e63 7920 6620 0d0a 2020 2020  equency f ..    
-00007e40: 2020 2020 2320 7765 2074 616b 6520 6f6e      # we take on
-00007e50: 6c79 2074 6865 2063 6f6d 706f 6e65 6e74  ly the component
-00007e60: 2078 7920 666f 7220 6669 7474 696e 672e   xy for fitting.
-00007e70: 0d0a 0d0a 2020 2020 2020 2020 7a78 7920  ....        zxy 
-00007e80: 3d20 5b66 6974 7465 6e73 6f72 2873 656c  = [fittensor(sel
-00007e90: 662e 6672 6571 735f 2c20 6564 694f 626a  f.freqs_, ediObj
-00007ea0: 2e5a 2e5f 6672 6571 2c20 6564 694f 626a  .Z._freq, ediObj
-00007eb0: 2e5a 2e7a 5b3a 2c20 302c 2031 5d2e 7265  .Z.z[:, 0, 1].re
-00007ec0: 616c 290d 0a20 2020 2020 2020 2020 2020  al)..           
-00007ed0: 2020 2066 6f72 2065 6469 4f62 6a20 696e     for ediObj in
-00007ee0: 2073 656c 662e 6564 694f 626a 735f 0d0a   self.ediObjs_..
-00007ef0: 2020 2020 2020 2020 2020 2020 2020 5d0d                ].
-00007f00: 0a20 2020 2020 2020 2023 2073 7461 636b  .        # stack
-00007f10: 6564 2074 6865 207a 2076 616c 7565 7320  ed the z values 
-00007f20: 616c 6f6d 7820 6178 6973 3d31 2e20 0d0a  alomx axis=1. ..
-00007f30: 2020 2020 2020 2020 6172 7232 6420 3d20          arr2d = 
-00007f40: 6e70 2e68 7374 6163 6b20 285b 2072 6573  np.hstack ([ res
-00007f50: 6861 7065 2028 6f2c 2061 7869 733d 3029  hape (o, axis=0)
-00007f60: 2066 6f72 206f 2069 6e20 7a78 795d 290d   for o in zxy]).
-00007f70: 0a0d 0a20 2020 2020 2020 2020 2020 200d  ...            .
-00007f80: 0a20 2020 2020 2020 2069 785f 6e61 6e20  .        ix_nan 
-00007f90: 3d20 7265 7368 6170 6520 286e 702e 6172  = reshape (np.ar
-00007fa0: 6777 6865 7265 286e 702e 6973 6e61 6e28  gwhere(np.isnan(
-00007fb0: 6172 7232 6429 2e61 6e79 2861 7869 7320  arr2d).any(axis 
-00007fc0: 3d31 2920 2929 0d0a 2020 2020 2020 2020  =1) ))..        
-00007fd0: 2020 2020 2320 6372 6561 7465 2062 6f6f      # create boo
-00007fe0: 6c20 6172 7261 7920 616e 6420 6d61 736b  l array and mask
-00007ff0: 2074 6865 2072 6f77 206f 6620 4e61 4e20   the row of NaN 
-00008000: 0d0a 2020 2020 2020 2020 6d61 736b 203d  ..        mask =
-00008010: 206e 702e 6675 6c6c 5f6c 696b 6520 2873   np.full_like (s
-00008020: 656c 662e 6672 6571 735f 2c20 6669 6c6c  elf.freqs_, fill
-00008030: 5f76 616c 7565 203d 2054 7275 6520 2c20  _value = True , 
-00008040: 6474 7970 653d 626f 6f6c 290d 0a20 2020  dtype=bool)..   
-00008050: 2020 2020 206d 6173 6b5b 5b2a 6978 5f6e       mask[[*ix_n
-00008060: 616e 5d20 5d20 3d20 4661 6c73 6520 0d0a  an] ] = False ..
-00008070: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
-00008080: 6520 7265 6665 7265 6e63 6520 6672 6571  e reference freq
-00008090: 7565 6e63 7920 616e 6420 696e 6465 7820  uency and index 
-000080a0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000080b0: 2020 7365 6c66 2e66 7265 7173 5f20 5b6d    self.freqs_ [m
-000080c0: 6173 6b5d 2e6d 6178 2829 2069 6620 6e6f  ask].max() if no
-000080d0: 7420 746f 5f6c 6f67 3130 2065 6c73 6520  t to_log10 else 
-000080e0: 6e70 2e6c 6f67 3130 280d 0a20 2020 2020  np.log10(..     
-000080f0: 2020 2020 2020 2073 656c 662e 6672 6571         self.freq
-00008100: 735f 205b 6d61 736b 5d2e 6d61 7828 2929  s_ [mask].max())
-00008110: 0d0a 2020 2020 0d0a 2020 2020 6465 6620  ..    ..    def 
-00008120: 5f65 7870 6f72 7465 6469 2028 7365 6c66  _exportedi (self
-00008130: 2c20 6564 694f 626a 3a20 4544 494f 292d  , ediObj: EDIO)-
-00008140: 3e20 2245 4449 4f22 203a 0d0a 2020 2020  > "EDIO" :..    
-00008150: 2020 2020 2222 2249 736f 6c61 7465 6420      """Isolated 
-00008160: 7061 7274 2066 6f72 2076 616c 6964 6174  part for validat
-00008170: 6520 4544 4920 666f 7220 6d75 6c74 6970  e EDI for multip
-00008180: 6c65 2045 4449 2065 7870 6f72 7473 200d  le EDI exports .
-00008190: 0a20 2020 2020 2020 2028 3a6d 6574 683a  .        (:meth:
-000081a0: 6065 7870 6f72 7465 6469 7360 292e 200d  `exportedis`). .
-000081b0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-000081c0: 2020 2020 2020 7472 7920 3a20 0d0a 2020        try : ..  
-000081d0: 2020 2020 2020 2020 2020 6564 694f 626a            ediObj
-000081e0: 203d 2073 656c 662e 6973 5f76 616c 6964   = self.is_valid
-000081f0: 2865 6469 4f62 6a20 2920 0d0a 2020 2020  (ediObj ) ..    
-00008200: 2020 2020 6578 6365 7074 203a 200d 0a20      except : .. 
-00008210: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-00008220: 696e 7374 616e 6365 2028 6564 694f 626a  instance (ediObj
-00008230: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
-00008240: 2020 2020 2020 2020 2065 6469 4f62 6a20           ediObj 
-00008250: 3d20 4564 6928 292e 6669 7428 6564 694f  = Edi().fit(ediO
-00008260: 626a 2029 0d0a 2020 2020 2020 2020 2020  bj )..          
-00008270: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00008280: 2020 2020 6966 2068 6173 6174 7472 2028      if hasattr (
-00008290: 6564 694f 626a 2c20 275f 5f69 7465 725f  ediObj, '__iter_
-000082a0: 5f27 293a 200d 0a20 2020 2020 2020 2020  _'): ..         
-000082b0: 2020 2020 2020 2065 6469 4f62 6a20 3d20         ediObj = 
-000082c0: 6564 694f 626a 5b30 5d0d 0a20 2020 2020  ediObj[0]..     
-000082d0: 2020 2020 2020 2020 2020 2069 6620 205f             if  _
-000082e0: 6173 7365 7274 5f7a 5f6f 725f 6564 695f  assert_z_or_edi_
-000082f0: 6f62 6a73 2865 6469 4f62 6a20 2921 3d27  objs(ediObj )!='
-00008300: 4544 4927 203a 0d0a 2020 2020 2020 2020  EDI' :..        
-00008310: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00008320: 6520 4544 4945 7272 6f72 2822 4f62 6a20  e EDIError("Obj 
-00008330: 7b65 6469 4f62 6a21 727d 2069 7320 6e6f  {ediObj!r} is no
-00008340: 7420 616e 2045 4449 2d6f 626a 6563 742e  t an EDI-object.
-00008350: 2229 0d0a 2020 2020 2020 2020 7265 7475  ")..        retu
-00008360: 726e 2065 6469 4f62 6a20 0d0a 2020 2020  rn ediObj ..    
-00008370: 2020 200d 0a20 2020 2064 6566 2065 7870     ..    def exp
-00008380: 6f72 7465 6469 7328 0d0a 2020 2020 2020  ortedis(..      
-00008390: 2020 7365 6c66 2c20 0d0a 2020 2020 2020    self, ..      
-000083a0: 2020 6564 694f 626a 733a 204c 6973 7420    ediObjs: List 
-000083b0: 5b45 4449 4f5d 2c20 0d0a 2020 2020 2020  [EDIO], ..      
-000083c0: 2020 6e65 775f 5a3a 204c 6973 7420 5b5a    new_Z: List [Z
-000083d0: 4f5d 2c20 0d0a 2020 2020 2020 2020 7361  O], ..        sa
-000083e0: 7665 7061 7468 203d 204e 6f6e 652c 200d  vepath = None, .
-000083f0: 0a20 2020 2020 2020 202a 2a6b 7773 200d  .        **kws .
-00008400: 0a20 2020 2020 2020 2029 3a20 0d0a 2020  .        ): ..  
-00008410: 2020 2020 2020 2222 2245 7870 6f72 7420        """Export 
-00008420: 4544 4920 6669 6c65 7320 6672 6f6d 206d  EDI files from m
-00008430: 756c 7469 706c 6573 2045 4449 206f 7220  ultiples EDI or 
-00008440: 7a20 6f62 6a65 6374 730d 0a20 2020 2020  z objects..     
-00008450: 2020 200d 0a20 2020 2020 2020 2045 7870     ..        Exp
-00008460: 6f72 7420 6e65 7720 4544 4920 6669 6c65  ort new EDI file
-00008470: 2066 726f 6d20 7468 6520 666f 726d 6572   from the former
-00008480: 206f 626a 6563 7420 7769 7468 2020 6120   object with  a 
-00008490: 6769 7665 6e20 6e65 7720 200d 0a20 2020  given new  ..   
-000084a0: 2020 2020 2069 6d70 6564 616e 6365 2074       impedance t
-000084b0: 656e 736f 7273 2e20 5468 6520 6578 706f  ensors. The expo
-000084c0: 7274 2069 7320 6173 7375 6d65 6420 6120  rt is assumed a 
-000084d0: 6e65 7720 6f75 7470 7574 2045 4449 200d  new output EDI .
-000084e0: 0a20 2020 2020 2020 2072 6573 756c 7469  .        resulti
-000084f0: 6e67 2066 726f 6d20 6d75 6c74 6970 6c65  ng from multiple
-00008500: 7320 636f 7272 6563 7469 6f6e 7320 6170  s corrections ap
-00008510: 706c 6963 6174 696f 6e73 2e0d 0a20 2020  plications...   
-00008520: 2020 2020 200d 0a20 2020 2020 2020 2050       ..        P
-00008530: 6172 616d 6574 6572 7320 0d0a 2020 2020  arameters ..    
-00008540: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d      -----------.
-00008550: 0a20 2020 2020 2020 2065 6469 4f62 6a73  .        ediObjs
-00008560: 3a20 6c69 7374 206f 6620 7374 7269 6e67  : list of string
-00008570: 2020 3a63 6c61 7373 3a60 7761 7465 782e    :class:`watex.
-00008580: 6564 692e 4564 6960 200d 0a20 2020 2020  edi.Edi` ..     
-00008590: 2020 2020 2020 2046 756c 6c20 7061 7468         Full path
-000085a0: 2074 6f20 4564 6920 6669 6c65 2f6f 626a   to Edi file/obj
-000085b0: 6563 7420 6f72 206f 626a 6563 7420 6672  ect or object fr
-000085c0: 6f6d 2063 6c61 7373 3a60 454d 6020 6f62  om class:`EM` ob
-000085d0: 6a65 6374 732e 200d 0a20 200d 0a20 2020  jects. ..  ..   
-000085e0: 2020 2020 206e 6577 5f5a 3a20 6c69 7374       new_Z: list
-000085f0: 206f 6620 6e64 6172 7261 7920 286e 6672   of ndarray (nfr
-00008600: 6571 2c20 322c 2032 2920 0d0a 2020 2020  eq, 2, 2) ..    
-00008610: 2020 2020 2020 2020 4120 636f 6c6c 6563          A collec
-00008620: 7469 6f6e 206f 6620 4e64 6172 7261 7920  tion of Ndarray 
-00008630: 6f66 2069 6d70 6564 616e 6365 2074 656e  of impedance ten
-00008640: 736f 7273 205a 2e20 0d0a 2020 2020 2020  sors Z. ..      
-00008650: 2020 2020 2020 5468 6520 7465 6e73 6f72        The tensor
-00008660: 205a 2069 7320 3344 2061 7272 6179 2063   Z is 3D array c
-00008670: 6f6d 706f 7365 6420 6f66 206e 756d 6265  omposed of numbe
-00008680: 7220 6f66 2066 7265 7175 656e 6379 200d  r of frequency .
-00008690: 0a20 2020 2020 2020 2020 2020 2060 6e66  .            `nf
-000086a0: 7265 7160 616e 6420 666f 7572 2063 6f6d  req`and four com
-000086b0: 706f 6e65 6e74 7320 2860 6078 7860 602c  ponents (``xx``,
-000086c0: 2060 6078 7960 602c 2060 6079 7860 602c   ``xy``, ``yx``,
-000086d0: 0d0a 2020 2020 2020 2020 2020 2020 616e  ..            an
-000086e0: 6420 6060 7979 6060 2920 696e 2032 5832  d ``yy``) in 2X2
-000086f0: 206d 6174 7269 6365 732e 2054 6865 2020   matrices. The  
-00008700: 7465 6e73 6f72 205a 2069 7320 6120 636f  tensor Z is a co
-00008710: 6d70 6c65 7820 6e75 6d62 6572 2e20 0d0a  mplex number. ..
-00008720: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00008730: 2020 2020 2020 7361 7665 7061 7468 3a73        savepath:s
-00008740: 7472 2c20 4f70 7469 6f6e 616c 200d 0a20  tr, Optional .. 
-00008750: 2020 2020 2020 2020 2020 5061 7468 2074            Path t
-00008760: 6f20 7361 7665 2061 206e 6577 2045 4449  o save a new EDI
-00008770: 2066 696c 652e 2049 6620 6060 4e6f 6e65   file. If ``None
-00008780: 6060 2c20 6f75 7470 7574 7320 746f 2060  ``, outputs to `
-00008790: 5f6f 7574 7075 7445 4449 5f60 0d0a 2020  _outputEDI_`..  
-000087a0: 2020 2020 2020 2020 2066 6f6c 6465 722e           folder.
-000087b0: 0d0a 2020 2020 2020 2020 2020 200d 0a20  ..           .. 
-000087c0: 2020 2020 2020 2052 6574 7572 6e73 200d         Returns .
-000087d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000087e0: 2d0d 0a20 2020 2020 2020 2020 6564 694f  -..         ediO
-000087f0: 626a 2066 726f 6d20 7761 7465 782e 6564  bj from watex.ed
-00008800: 692e 4564 6920 0d0a 2020 2020 2020 2020  i.Edi ..        
-00008810: 200d 0a20 2020 2020 2020 2053 6565 2041   ..        See A
-00008820: 6c73 6f0d 0a20 2020 2020 2020 202d 2d2d  lso..        ---
-00008830: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00008840: 6578 706f 7274 6564 693a 200d 0a20 2020  exportedi: ..   
-00008850: 2020 2020 2020 2020 2045 7870 6f72 7420           Export 
-00008860: 7369 6e67 6c65 2045 4449 2066 726f 6d0d  single EDI from.
-00008870: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00008880: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00008890: 2020 2020 6564 694f 626a 7320 3d20 6973      ediObjs = is
-000088a0: 5f69 7465 7261 626c 6528 0d0a 2020 2020  _iterable(..    
-000088b0: 2020 2020 2020 2020 6564 694f 626a 7320          ediObjs 
-000088c0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-000088d0: 6578 636c 7564 655f 7374 7269 6e67 203d  exclude_string =
-000088e0: 5472 7565 202c 200d 0a20 2020 2020 2020  True , ..       
-000088f0: 2020 2020 2074 7261 6e73 666f 726d 203d       transform =
-00008900: 5472 7565 200d 0a20 2020 2020 2020 2020  True ..         
-00008910: 2020 2029 0d0a 2020 2020 2020 2020 6e65     )..        ne
-00008920: 775f 5a20 3d20 6973 5f69 7465 7261 626c  w_Z = is_iterabl
-00008930: 6528 0d0a 2020 2020 2020 2020 2020 2020  e(..            
-00008940: 6e65 775f 5a20 2c20 0d0a 2020 2020 2020  new_Z , ..      
-00008950: 2020 2020 2020 6578 636c 7564 655f 7374        exclude_st
-00008960: 7269 6e67 203d 5472 7565 202c 200d 0a20  ring =True , .. 
-00008970: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-00008980: 666f 726d 203d 5472 7565 200d 0a20 2020  form =True ..   
-00008990: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-000089a0: 2020 2020 0d0a 2020 2020 2020 2020 666f      ..        fo
-000089b0: 7220 652c 207a 2020 696e 207a 6970 2028  r e, z  in zip (
-000089c0: 6564 694f 626a 732c 206e 6577 5f5a 2029  ediObjs, new_Z )
-000089d0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-000089e0: 653d 2073 656c 662e 5f65 7870 6f72 7465  e= self._exporte
-000089f0: 6469 2865 2920 0d0a 2020 2020 2020 2020  di(e) ..        
-00008a00: 2020 2020 652e 7772 6974 655f 6e65 775f      e.write_new_
-00008a10: 6564 6966 696c 6528 200d 0a20 2020 2020  edifile( ..     
-00008a20: 2020 2020 2020 2020 2020 206e 6577 5f5a             new_Z
-00008a30: 3d7a 2c0d 0a20 2020 2020 2020 2020 2020  =z,..           
-00008a40: 2020 2020 2073 6176 6570 6174 6820 3d20       savepath = 
-00008a50: 7361 7665 7061 7468 202c 200d 0a20 2020  savepath , ..   
-00008a60: 2020 2020 2020 2020 2020 2020 202a 2a6b               **k
-00008a70: 7773 0d0a 2020 2020 2020 2020 2020 2020  ws..            
-00008a80: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
-00008a90: 2020 200d 0a20 2020 2064 6566 2074 736c     ..    def tsl
-00008aa0: 6963 6572 2028 200d 0a20 2020 2020 2020  icer ( ..       
-00008ab0: 2073 656c 662c 2020 0d0a 2020 2020 2020   self,  ..      
-00008ac0: 2020 6672 6571 733d 204e 6f6e 652c 200d    freqs= None, .
-00008ad0: 0a20 2020 2020 2020 207a 3d20 4e6f 6e65  .        z= None
-00008ae0: 2c20 0d0a 2020 2020 2020 2020 636f 6d70  , ..        comp
-00008af0: 6f6e 656e 7420 3d27 7879 270d 0a20 2020  onent ='xy'..   
-00008b00: 2020 2020 2029 3a20 0d0a 2020 2020 2020       ): ..      
-00008b10: 2020 2222 2252 6574 7572 6e73 2074 656e    """Returns ten
-00008b20: 736f 7220 3264 2066 726f 6d20 636f 6d70  sor 2d from comp
-00008b30: 6f6e 656e 7473 200d 0a20 2020 2020 2020  onents ..       
-00008b40: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
-00008b50: 6574 6572 7320 0d0a 2020 2020 2020 2020  eters ..        
-00008b60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
-00008b70: 2020 2020 2066 7265 7173 3a20 6172 7261       freqs: arra
-00008b80: 796c 696b 6520 0d0a 2020 2020 2020 2020  ylike ..        
-00008b90: 2020 2066 756c 6c20 6672 6571 7565 6e63     full frequenc
-00008ba0: 7920 7468 6174 2063 6f6d 706f 7365 6420  y that composed 
-00008bb0: 7468 6520 7465 6e73 6f72 2e20 4966 2060  the tensor. If `
-00008bc0: 604e 6f6e 6560 602c 2075 7365 2074 6865  `None``, use the
-00008bd0: 200d 0a20 2020 2020 2020 2020 2020 636f   ..           co
-00008be0: 6d70 6f6e 656e 7473 2069 6e20 0d0a 2020  mponents in ..  
-00008bf0: 2020 2020 2020 5a3a 2041 7272 6179 4c69        Z: ArrayLi
-00008c00: 6b65 2033 4420 0d0a 2020 2020 2020 2020  ke 3D ..        
-00008c10: 2020 2054 656e 736f 7220 6973 2063 6f6d     Tensor is com
-00008c20: 706f 7365 6420 6f66 2033 4420 6172 7261  posed of 3D arra
-00008c30: 7920 6f66 2073 6861 7065 2028 6e5f 6672  y of shape (n_fr
-00008c40: 6571 732c 2032 2c20 3229 200d 0a20 2020  eqs, 2, 2) ..   
-00008c50: 2020 2020 2063 6f6d 706f 6e65 6e74 3a20       component: 
-00008c60: 7374 722c 200d 0a20 2020 2020 2020 2020  str, ..         
-00008c70: 2063 6f6d 706f 6e65 6e74 7320 616c 6f6e   components alon
-00008c80: 6720 7369 6465 2074 6f20 7265 7472 6965  g side to retrie
-00008c90: 7665 202e 2043 616e 2062 6520 5b27 7878  ve . Can be ['xx
-00008ca0: 277c 2778 7927 7c27 7978 277c 2779 7927  '|'xy'|'yx'|'yy'
-00008cb0: 5d0d 0a20 2020 2020 2020 2020 200d 0a20  ]..          .. 
-00008cc0: 2020 2020 2020 202e 2e20 7665 7273 696f         .. versio
-00008cd0: 6e61 6464 6564 3a3a 2076 302e 322e 3020  nadded:: v0.2.0 
-00008ce0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00008cf0: 2020 2020 5265 7475 726e 7320 0d0a 2020      Returns ..  
-00008d00: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0d        ---------.
-00008d10: 0a20 2020 2020 2020 207a 206f 7220 736c  .        z or sl
-00008d20: 6963 653a 2041 7272 616c 696b 6520 3244  ice: Arralike 2D
-00008d30: 2074 656e 736f 722c 206f 7220 6469 6374   tensor, or dict
-00008d40: 200d 0a20 2020 2020 2020 2020 2020 5265   ..           Re
-00008d50: 7475 726e 7320 3244 2074 656e 736f 7220  turns 2D tensor 
-00008d60: 6f72 2064 6963 7469 6f6e 6e61 7279 206f  or dictionnary o
-00008d70: 6620 636f 6d70 6f6e 656e 7473 2069 6e64  f components ind
-00008d80: 6578 2073 6c69 6365 7273 2e20 0d0a 2020  ex slicers. ..  
-00008d90: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00008da0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00008db0: 2320 7365 7420 636f 6d70 6f6e 656e 7420  # set component 
-00008dc0: 736c 6963 6573 2069 6e74 6f20 6120 6469  slices into a di
-00008dd0: 6374 0d0a 2020 2020 2020 2020 6672 6571  ct..        freq
-00008de0: 7320 3d20 6672 6571 7320 6966 2066 7265  s = freqs if fre
-00008df0: 7173 2069 7320 6e6f 7420 4e6f 6e65 2065  qs is not None e
-00008e00: 6c73 6520 2073 656c 662e 6672 6571 735f  lse  self.freqs_
-00008e10: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00008e20: 2020 2020 2063 203d 207b 0d0a 2020 2020       c = {..    
-00008e30: 2020 2020 2020 2020 2020 2778 7827 3a20            'xx': 
-00008e40: 5b73 6c69 6365 2028 4e6f 6e65 2c20 6c65  [slice (None, le
-00008e50: 6e28 6672 6571 7329 292c 2030 202c 2030  n(freqs)), 0 , 0
-00008e60: 5d20 2c20 0d0a 2020 2020 2020 2020 2020  ] , ..          
-00008e70: 2020 2020 2778 7927 3a20 5b73 6c69 6365      'xy': [slice
-00008e80: 2028 4e6f 6e65 2c20 6c65 6e28 6672 6571   (None, len(freq
-00008e90: 7329 292c 2030 202c 2031 5d2c 200d 0a20  s)), 0 , 1], .. 
-00008ea0: 2020 2020 2020 2020 2020 2020 2027 7978               'yx
-00008eb0: 273a 205b 736c 6963 6520 284e 6f6e 652c  ': [slice (None,
-00008ec0: 206c 656e 2866 7265 7173 2929 2c20 3120   len(freqs)), 1 
-00008ed0: 2c20 305d 2c20 0d0a 2020 2020 2020 2020  , 0], ..        
-00008ee0: 2020 2020 2020 2779 7927 3a20 5b73 6c69        'yy': [sli
-00008ef0: 6365 2028 4e6f 6e65 2c20 6c65 6e28 6672  ce (None, len(fr
-00008f00: 6571 7329 292c 2031 2c20 2031 5d20 0d0a  eqs)), 1,  1] ..
-00008f10: 2020 2020 2020 2020 7d0d 0a20 2020 2020          }..     
-00008f20: 2020 200d 0a20 2020 2020 2020 2072 6574     ..        ret
-00008f30: 7572 6e20 207a 205b 7475 706c 6520 2863  urn  z [tuple (c
-00008f40: 2e67 6574 2863 6f6d 706f 6e65 6e74 2929  .get(component))
-00008f50: 5d20 6966 207a 2069 7320 6e6f 7420 4e6f  ] if z is not No
-00008f60: 6e65 2065 6c73 6520 6320 0d0a 2020 2020  ne else c ..    
-00008f70: 2020 200d 0a20 2020 2040 7374 6174 6963     ..    @static
-00008f80: 6d65 7468 6f64 200d 0a20 2020 2064 6566  method ..    def
-00008f90: 2067 6574 5f7a 5f66 726f 6d28 2065 6469   get_z_from( edi
-00008fa0: 5f6f 626a 5f6c 6973 742c 202f 2c20 293a  _obj_list, /, ):
-00008fb0: 200d 0a20 2020 2020 2020 2022 2222 2047   ..        """ G
-00008fc0: 6574 207a 206f 626a 6563 7420 6672 6f6d  et z object from
-00008fd0: 2045 6469 206f 626a 6563 742e 200d 0a20   Edi object. .. 
-00008fe0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00008ff0: 7320 0d0a 2020 2020 2020 2020 2d2d 2d2d  s ..        ----
-00009000: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00009010: 207a 5f6f 725f 6564 6973 5f6f 626a 5f6c   z_or_edis_obj_l
-00009020: 6973 743a 206c 6973 7420 6f66 203a 636c  ist: list of :cl
-00009030: 6173 733a 6077 6174 6578 2e65 6469 2e45  ass:`watex.edi.E
-00009040: 6469 6020 6f72 205c 0d0a 2020 2020 2020  di` or \..      
-00009050: 2020 2020 2020 3a63 6c61 7373 3a60 7761        :class:`wa
-00009060: 7465 782e 6578 7465 726e 616c 732e 7a2e  tex.externals.z.
-00009070: 5a60 200d 0a20 2020 2020 2020 2020 2020  Z` ..           
-00009080: 2041 2063 6f6c 6c65 6374 696f 6e20 6f66   A collection of
-00009090: 2045 4449 2d20 6f72 2049 6d70 6564 616e   EDI- or Impedan
-000090a0: 6365 7320 7465 6e73 6f72 7320 6f62 6a65  ces tensors obje
-000090b0: 6374 732e 200d 0a20 2020 2020 2020 2020  cts. ..         
-000090c0: 2020 200d 0a20 2020 2020 2020 202e 2e20     ..        .. 
-000090d0: 7665 7273 696f 6e61 6464 6564 3a3a 2076  versionadded:: v
-000090e0: 302e 312e 3920 0d0a 2020 2020 2020 2020  0.1.9 ..        
-000090f0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00009100: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00009110: 2d2d 2d0d 0a20 2020 2020 2020 205a 3a20  ---..        Z: 
-00009120: 6c69 7374 206f 6620 3a63 6c61 7373 3a60  list of :class:`
-00009130: 7761 7465 782e 6578 7465 726e 616c 732e  watex.externals.
-00009140: 7a2e 5a60 0d0a 2020 2020 2020 2020 2020  z.Z`..          
-00009150: 204c 6973 7420 6f66 2069 6d70 6564 616e   List of impedan
-00009160: 6365 2074 656e 736f 7220 4f62 6a65 6374  ce tensor Object
-00009170: 732e 200d 0a20 2020 2020 2020 2020 200d  s. ..          .
-00009180: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00009190: 2020 2020 2020 6f62 6a5f 7479 7065 2020        obj_type  
-000091a0: 3d20 5f61 7373 6572 745f 7a5f 6f72 5f65  = _assert_z_or_e
-000091b0: 6469 5f6f 626a 7320 2865 6469 5f6f 626a  di_objs (edi_obj
-000091c0: 5f6c 6973 7429 0d0a 2020 2020 2020 2020  _list)..        
-000091d0: 7265 7475 726e 2020 2065 6469 5f6f 626a  return   edi_obj
-000091e0: 5f6c 6973 7420 2069 6620 6f62 6a5f 7479  _list  if obj_ty
-000091f0: 7065 203d 3d27 5a27 2065 6c73 6520 5b0d  pe =='Z' else [.
-00009200: 0a20 2020 2020 2020 2020 2020 2065 6469  .            edi
-00009210: 5f6f 626a 5f6c 6973 745b 695d 2e5a 2066  _obj_list[i].Z f
-00009220: 6f72 2069 2069 6e20 7261 6e67 6520 286c  or i in range (l
-00009230: 656e 2820 6564 695f 6f62 6a5f 6c69 7374  en( edi_obj_list
-00009240: 2920 2029 5d20 2020 0d0a 2020 2020 0d0a  )  )]   ..    ..
-00009250: 2020 2020 6465 6620 5f5f 7265 7072 5f5f      def __repr__
-00009260: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-00009270: 2022 2222 2050 7265 7474 7920 666f 726d   """ Pretty form
-00009280: 6174 2066 6f72 2070 726f 6772 616d 6d65  at for programme
-00009290: 7220 6775 6964 616e 6365 2066 6f6c 6c6f  r guidance follo
-000092a0: 7769 6e67 2074 6865 2041 5049 2e2e 2e20  wing the API... 
-000092b0: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
-000092c0: 7572 6e20 7265 7072 5f63 616c 6c61 626c  urn repr_callabl
-000092d0: 655f 6f62 6a20 2028 7365 6c66 2c20 736b  e_obj  (self, sk
-000092e0: 6970 203d 2827 6564 6966 696c 6573 272c  ip =('edifiles',
-000092f0: 2027 6672 6571 5f61 7272 6179 272c 2027   'freq_array', '
-00009300: 6964 2729 290d 0a20 2020 2020 2020 0d0a  id'))..       ..
-00009310: 2020 2020 0d0a 2020 2020 6465 6620 5f5f      ..    def __
-00009320: 6765 7461 7474 725f 5f28 7365 6c66 2c20  getattr__(self, 
-00009330: 6e61 6d65 293a 0d0a 2020 2020 2020 2020  name):..        
-00009340: 7276 203d 2073 6d61 7274 5f73 7472 6f62  rv = smart_strob
-00009350: 6a5f 7265 636f 676e 6974 696f 6e28 6e61  j_recognition(na
-00009360: 6d65 2c20 7365 6c66 2e5f 5f64 6963 745f  me, self.__dict_
-00009370: 5f2c 2064 6565 7020 3d54 7275 6529 0d0a  _, deep =True)..
-00009380: 2020 2020 2020 2020 6170 7065 6e64 6572          appender
-00009390: 2020 3d20 2222 2069 6620 7276 2069 7320    = "" if rv is 
-000093a0: 4e6f 6e65 2065 6c73 6520 6627 2e20 446f  None else f'. Do
-000093b0: 2079 6f75 206d 6561 6e20 7b72 7621 727d   you mean {rv!r}
-000093c0: 270d 0a20 2020 2020 2020 200d 0a20 2020  '..        ..   
-000093d0: 2020 2020 2072 6169 7365 2041 7474 7269       raise Attri
-000093e0: 6275 7465 4572 726f 7220 280d 0a20 2020  buteError (..   
-000093f0: 2020 2020 2020 2020 2066 277b 7365 6c66           f'{self
-00009400: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-00009410: 655f 5f21 727d 206f 626a 6563 7420 6861  e__!r} object ha
-00009420: 7320 6e6f 2061 7474 7269 6275 7465 207b  s no attribute {
-00009430: 6e61 6d65 2172 7d27 0d0a 2020 2020 2020  name!r}'..      
-00009440: 2020 2020 2020 6627 7b61 7070 656e 6465        f'{appende
-00009450: 727d 7b22 2220 6966 2072 7620 6973 204e  r}{"" if rv is N
-00009460: 6f6e 6520 656c 7365 2022 3f22 7d27 0d0a  one else "?"}'..
-00009470: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-00009480: 2020 2020 2020 200d 0a63 6c61 7373 205f         ..class _
-00009490: 7a75 7064 6174 6528 454d 293a 200d 0a20  zupdate(EM): .. 
-000094a0: 2020 2022 2222 2041 2064 6563 6f72 6174     """ A decorat
-000094b0: 6f72 2066 6f72 2069 6d70 6564 616e 6365  or for impedance
-000094c0: 2074 656e 736f 7220 7570 6461 7469 6e67   tensor updating
-000094d0: 2e20 0d0a 2020 2020 0d0a 2020 2020 5570  . ..    ..    Up
-000094e0: 6461 7465 2061 205a 206f 626a 6563 7420  date a Z object 
-000094f0: 6672 6f6d 2065 6163 6820 4544 4920 6f62  from each EDI ob
-00009500: 6a65 6374 2063 6f6d 706f 7369 6e67 2074  ject composing t
-00009510: 6865 2063 6f6c 6c65 6374 696f 6e20 6f62  he collection ob
-00009520: 6a65 6374 7320 0d0a 2020 2020 616e 6420  jects ..    and 
-00009530: 6f75 7470 7574 2061 206e 6577 2045 4449  output a new EDI
-00009540: 2d66 696c 6573 2069 6620 606f 7074 696f  -files if `optio
-00009550: 6e60 2069 7320 7365 7420 746f 2060 6077  n` is set to ``w
-00009560: 7269 7465 6060 2e20 0d0a 2020 2020 0d0a  rite``. ..    ..
-00009570: 2020 2020 5061 7261 6d65 7465 7273 200d      Parameters .
-00009580: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
-00009590: 2d0d 0a20 2020 200d 0a20 2020 206f 7074  -..    ..    opt
-000095a0: 696f 6e3a 2073 7472 202c 2064 6566 6175  ion: str , defau
-000095b0: 6c74 3d27 7772 6974 6527 0d0a 2020 2020  lt='write'..    
-000095c0: 2020 2020 6b69 6e64 206f 6620 6163 7469      kind of acti
-000095d0: 6f6e 2074 6f20 7065 7266 6f72 6d20 7769  on to perform wi
-000095e0: 7468 206e 6577 205a 2063 6f6c 6c65 6374  th new Z collect
-000095f0: 696f 6e2e 0d0a 2020 2020 2020 2020 5768  ion...        Wh
-00009600: 656e 2060 6f70 7469 6f6e 6020 6973 2073  en `option` is s
-00009610: 6574 2074 6f20 6060 7772 6974 6560 602e  et to ``write``.
-00009620: 2054 6865 206e 6577 2045 4449 202d 6669   The new EDI -fi
-00009630: 6c65 7320 6172 6520 6578 706f 7274 6564  les are exported
-00009640: 2e0d 0a20 2020 2020 2020 2041 6e79 206f  ...        Any o
-00009650: 7468 6572 2076 616c 7565 7320 7368 6f75  ther values shou
-00009660: 6c64 2072 6574 7572 6e20 6f6e 6c79 2074  ld return only t
-00009670: 6865 2075 7064 6174 6564 2069 6d70 6564  he updated imped
-00009680: 616e 6365 2074 656e 736f 7273 2e0d 0a20  ance tensors... 
-00009690: 2020 2020 2020 200d 0a20 2020 2052 6574         ..    Ret
-000096a0: 7572 6e73 200d 0a20 2020 202d 2d2d 2d2d  urns ..    -----
-000096b0: 2d2d 2d0d 0a20 2020 205a 207c 4e6f 6e65  ---..    Z |None
-000096c0: 203a 2041 2063 6f6c 6c65 6374 696f 6e20   : A collection 
-000096d0: 6f66 2020 3a63 6c61 7373 3a60 7761 7465  of  :class:`wate
-000096e0: 782e 6578 7465 726e 616c 732e 7a2e 5a60  x.externals.z.Z`
-000096f0: 2069 6d70 6564 616e 6365 2074 656e 736f   impedance tenso
-00009700: 7220 0d0a 2020 2020 2020 2020 6f62 6a65  r ..        obje
-00009710: 6374 732e 204e 6f6e 6520 6966 2060 6f70  cts. None if `op
-00009720: 7469 6f6e 6020 6973 2074 6f20 6060 7772  tion` is to ``wr
-00009730: 6974 6560 602e 200d 0a20 2020 2020 2020  ite``. ..       
-00009740: 200d 0a20 2020 2022 2222 0d0a 2020 2020   ..    """..    
-00009750: 0d0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
-00009760: 5f5f 2873 656c 662c 206f 7074 696f 6e3a  __(self, option:
-00009770: 2073 7472 203d 2027 7772 6974 6527 293a   str = 'write'):
-00009780: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-00009790: 6f70 7469 6f6e 203d 206f 7074 696f 6e0d  option = option.
-000097a0: 0a20 2020 200d 0a20 2020 2064 6566 205f  .    ..    def _
-000097b0: 5f63 616c 6c5f 5f20 2873 656c 662c 2066  _call__ (self, f
-000097c0: 756e 633a 4629 3a0d 0a20 2020 2020 2020  unc:F):..       
-000097d0: 200d 0a20 2020 2020 2020 2040 6675 6e63   ..        @func
-000097e0: 746f 6f6c 732e 7772 6170 7320 2866 756e  tools.wraps (fun
-000097f0: 6329 0d0a 2020 2020 2020 2020 6465 6620  c)..        def 
-00009800: 6e65 775f 6675 6e63 2028 202a 6172 6773  new_func ( *args
-00009810: 2c20 2a2a 6b77 7329 3a20 0d0a 2020 2020  , **kws): ..    
-00009820: 2020 2020 2020 2020 2222 2220 5772 6170          """ Wrap
-00009830: 7065 7220 2074 6f20 6d61 6b65 206e 6577  per  to make new
-00009840: 205a 2e20 5468 6520 7570 6461 7465 6420   Z. The updated 
-00009850: 5a20 6973 2061 2063 6f6c 6c65 6374 696f  Z is a collectio
-00009860: 6e0d 0a20 2020 2020 2020 2020 2020 206f  n..            o
-00009870: 626a 6563 7420 6672 6f6d 2027 3a63 6c61  bject from ':cla
-00009880: 7373 3a60 7079 6373 616d 742e 636f 7265  ss:`pycsamt.core
-00009890: 2e7a 2e5a 6020 2222 220d 0a20 2020 2020  .z.Z` """..     
-000098a0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000098b0: 2020 2020 2028 6564 694f 626a 7320 2c20       (ediObjs , 
-000098c0: 6672 6571 2c20 207a 5f64 6963 7429 2c20  freq,  z_dict), 
-000098d0: 6b77 6172 6773 203d 2066 756e 6320 282a  kwargs = func (*
-000098e0: 6172 6773 2c20 2a2a 6b77 7329 0d0a 2020  args, **kws)..  
-000098f0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00009900: 2320 706f 7020 7468 6520 6f70 7469 6f6e  # pop the option
-00009910: 2061 7267 756d 656e 7420 6966 2075 7365   argument if use
-00009920: 7220 7072 6f76 6964 6573 2069 7420 0d0a  r provides it ..
-00009930: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
-00009940: 6f6e 203d 206b 7761 7267 732e 706f 7028  on = kwargs.pop(
-00009950: 276f 7074 696f 6e27 2c20 4e6f 6e65 290d  'option', None).
-00009960: 0a20 2020 2020 2020 2020 2020 2072 6f74  .            rot
-00009970: 6174 6520 3d20 6b77 6172 6773 2e70 6f70  ate = kwargs.pop
-00009980: 2028 2772 6f74 6174 6527 2c20 302e 2029   ('rotate', 0. )
-00009990: 200d 0a20 2020 2020 2020 2020 2020 2065   ..            e
-000099a0: 6469 4f3d 206b 7761 7267 732e 706f 7028  diO= kwargs.pop(
-000099b0: 2765 6469 4f62 6a73 272c 204e 6f6e 6520  'ediObjs', None 
-000099c0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-000099d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000099e0: 662e 6f70 7469 6f6e 203d 2073 7472 286f  f.option = str(o
-000099f0: 7074 696f 6e29 2e6c 6f77 6572 2829 2020  ption).lower()  
-00009a00: 6f72 2073 656c 662e 6f70 7469 6f6e 200d  or self.option .
-00009a10: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-00009a20: 7265 6174 6520 616e 2065 6d70 7479 2061  reate an empty a
-00009a30: 7272 6179 2074 6f20 636f 6c6c 6563 7420  rray to collect 
-00009a40: 6561 6368 206e 6577 205a 206f 626a 6563  each new Z objec
-00009a50: 7420 0d0a 2020 2020 2020 2020 2020 200d  t ..           .
-00009a60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00009a70: 6973 696e 7374 616e 6365 2028 7a5f 6469  isinstance (z_di
-00009a80: 6374 2c20 6469 6374 2029 3a20 0d0a 2020  ct, dict ): ..  
-00009a90: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00009aa0: 2320 7261 7468 6572 2074 6861 6e20 7573  # rather than us
-00009ab0: 696e 6720 6564 694f 626a 7320 0d0a 2020  ing ediObjs ..  
-00009ac0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00009ad0: 7768 6963 6820 636f 756c 6420 6265 204e  which could be N
-00009ae0: 6f6e 6520 6966 2074 6865 2069 6465 6120  one if the idea 
-00009af0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009b00: 2020 2320 6973 206a 7573 7420 746f 2063    # is just to c
-00009b10: 6f72 7265 6374 2074 6865 2074 656e 736f  orrect the tenso
-00009b20: 7220 7a0d 0a20 2020 2020 2020 2020 2020  r z..           
-00009b30: 2020 2020 2023 2074 6865 7265 666f 7220       # therefor 
-00009b40: 6665 7463 6820 7468 6520 7368 6170 6520  fetch the shape 
-00009b50: 5b31 5d20 6f66 2061 2072 616e 646f 6d20  [1] of a random 
-00009b60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009b70: 2020 2320 636f 6d70 6f6e 656e 7473 2077    # components w
-00009b80: 6869 6368 2063 6f72 7265 7370 6f6e 6420  hich correspond 
-00009b90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009ba0: 2020 2320 746f 2074 6865 206e 756d 6265    # to the numbe
-00009bb0: 7220 6f66 2073 7461 7469 6f6e 7320 6f66  r of stations of
-00009bc0: 2063 6f6c 6c65 6374 6564 2045 4449 200d   collected EDI .
-00009bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009be0: 206e 7369 7465 7320 3d20 6c69 7374 2820   nsites = list( 
-00009bf0: 7a5f 6469 6374 2e76 616c 7565 7328 2929  z_dict.values())
-00009c00: 205b 305d 2e73 6861 7065 205b 3120 5d20   [0].shape [1 ] 
-00009c10: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00009c20: 2020 2020 5a63 203d 206e 702e 656d 7074      Zc = np.empt
-00009c30: 7928 286e 7369 7465 732c 2029 2c20 6474  y((nsites, ), dt
-00009c40: 7970 6520 3d20 6f62 6a65 6374 2029 0d0a  ype = object )..
-00009c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009c60: 666f 7220 6b6b 2069 6e20 7261 6e67 6520  for kk in range 
-00009c70: 2028 6e73 6974 6573 293a 0d0a 2020 2020   (nsites):..    
-00009c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009c90: 2320 6372 6561 7465 2061 206e 6577 205a  # create a new Z
-00009ca0: 206f 626a 6563 7420 666f 7220 6561 6368   object for each
-00009cb0: 2045 6469 0d0a 2020 2020 2020 2020 2020   Edi..          
-00009cc0: 2020 2020 2020 2020 2020 5a3d 2073 656c            Z= sel
-00009cd0: 662e 5f6d 616b 655f 7a4f 626a 286b 6b2c  f._make_zObj(kk,
-00009ce0: 6672 6571 3d66 7265 712c 200d 0a20 2020  freq=freq, ..   
+000072e0: 2020 2066 6f72 2065 6469 4f62 6a20 2c20     for ediObj , 
+000072f0: 2076 2020 696e 207a 6970 286f 626a 732c   v  in zip(objs,
+00007300: 207a 6c29 5d0d 0a20 2020 2020 2020 2020   zl)]..         
+00007310: 2020 2020 2020 2069 6620 6b69 6e64 2069         if kind i
+00007320: 6e20 2827 7265 616c 2720 2c20 2763 6f6d  n ('real' , 'com
+00007330: 706c 6578 2729 203a 200d 0a20 2020 2020  plex') : ..     
+00007340: 2020 2020 2020 2020 2020 2020 2020 207a                 z
+00007350: 7220 3d20 5b66 6974 7465 6e73 6f72 2873  r = [fittensor(s
+00007360: 656c 662e 6672 6571 735f 2c20 6564 694f  elf.freqs_, ediO
+00007370: 626a 2e5a 2e5f 6672 6571 2c20 762e 7265  bj.Z._freq, v.re
+00007380: 616c 290d 0a20 2020 2020 2020 2020 2020  al)..           
+00007390: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000073a0: 6f72 2065 6469 4f62 6a20 2c20 2076 2020  or ediObj ,  v  
+000073b0: 696e 207a 6970 286f 626a 732c 207a 6c29  in zip(objs, zl)
+000073c0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+000073d0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000073e0: 2020 2020 2020 2020 2069 6620 6b69 6e64           if kind
+000073f0: 2069 6e20 2827 696d 6167 272c 2027 636f   in ('imag', 'co
+00007400: 6d70 6c65 7827 293a 200d 0a20 2020 2020  mplex'): ..     
+00007410: 2020 2020 2020 2020 2020 2020 2020 207a                 z
+00007420: 693d 205b 6669 7474 656e 736f 7228 7365  i= [fittensor(se
+00007430: 6c66 2e66 7265 7173 5f2c 2065 6469 4f62  lf.freqs_, ediOb
+00007440: 6a2e 5a2e 5f66 7265 712c 2076 2e69 6d61  j.Z._freq, v.ima
+00007450: 6729 0d0a 2020 2020 2020 2020 2020 2020  g)..            
+00007460: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00007470: 7220 6564 694f 626a 202c 2020 7620 2069  r ediObj ,  v  i
+00007480: 6e20 7a69 7028 6f62 6a73 2c20 7a6c 295d  n zip(objs, zl)]
+00007490: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000074a0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000074b0: 2020 2020 2020 2020 6966 206b 696e 6420          if kind 
+000074c0: 3d3d 2763 6f6d 706c 6578 273a 200d 0a20  =='complex': .. 
+000074d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074e0: 2020 207a 6c20 3d20 5b20 7220 2b20 316a     zl = [ r + 1j
+000074f0: 202a 2069 6d20 666f 7220 722c 2069 6d20   * im for r, im 
+00007500: 696e 207a 6970 2028 7a72 2c20 7a69 295d  in zip (zr, zi)]
+00007510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007520: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00007530: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00007540: 2020 2020 2020 2020 2020 2020 2020 7a6c                zl
+00007550: 203d 207a 6c20 6966 206b 696e 6420 696e   = zl if kind in
+00007560: 2028 276d 6f64 756c 7573 272c 2027 636f   ('modulus', 'co
+00007570: 6d70 6c65 7827 2920 656c 7365 2028 0d0a  mplex') else (..
+00007580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007590: 2020 2020 7a72 2069 6620 6b69 6e64 203d      zr if kind =
+000075a0: 3d27 7265 616c 2720 656c 7365 207a 6920  ='real' else zi 
+000075b0: 2920 2020 200d 0a20 2020 2020 2020 2020  )    ..         
+000075c0: 2020 2065 6c73 6520 3a20 0d0a 2020 2020     else : ..    
+000075d0: 2020 2020 2020 2020 2020 2020 7a6c 203d              zl =
+000075e0: 205b 6669 7474 656e 736f 7228 7365 6c66   [fittensor(self
+000075f0: 2e66 7265 7173 5f2c 2065 6469 4f62 6a2e  .freqs_, ediObj.
+00007600: 5a2e 5f66 7265 712c 2076 290d 0a20 2020  Z._freq, v)..   
+00007610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007620: 2020 2066 6f72 2065 6469 4f62 6a20 2c20     for ediObj , 
+00007630: 2076 2020 696e 207a 6970 286f 626a 732c   v  in zip(objs,
+00007640: 207a 6c29 5d0d 0a20 2020 2020 2020 2020   zl)]..         
+00007650: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00007660: 2020 2020 2023 2073 7461 636b 6564 2074       # stacked t
+00007670: 6865 207a 2076 616c 7565 7320 616c 6f6d  he z values alom
+00007680: 7820 6178 6973 3d31 2e20 0d0a 2020 2020  x axis=1. ..    
+00007690: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+000076a0: 702e 6873 7461 636b 2028 5b20 7265 7368  p.hstack ([ resh
+000076b0: 6170 6520 286f 2c20 6178 6973 3d30 2920  ape (o, axis=0) 
+000076c0: 666f 7220 6f20 696e 207a 6c5d 290d 0a20  for o in zl]).. 
+000076d0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+000076e0: 2020 2020 2320 7265 6164 2f61 7373 6572      # read/asser
+000076f0: 7420 6564 6973 2061 6e64 2067 6574 2074  t edis and get t
+00007700: 6865 2063 6f6d 706c 6574 6520 6672 6571  he complete freq
+00007710: 7565 6e63 7920 2020 2020 0d0a 2020 2020  uency     ..    
+00007720: 2020 2020 6e61 6d65 202c 206d 3220 3d20      name , m2 = 
+00007730: 5f76 616c 6964 6174 655f 7465 6e73 6f72  _validate_tensor
+00007740: 286f 7574 203d 206f 7574 202c 206b 696e  (out = out , kin
+00007750: 6420 3d20 6b69 6e64 2c20 2a2a 6b77 7320  d = kind, **kws 
+00007760: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00007770: 2020 2020 2023 3d3d 3e20 7265 7475 726e       #==> return
+00007780: 7320 6d61 7432 6420 6672 6571 200d 0a20  s mat2d freq .. 
+00007790: 2020 2020 2020 2023 2069 6620 6d31 203d         # if m1 =
+000077a0: 3d27 5f66 7265 7127 3a20 0d0a 2020 2020  ='_freq': ..    
+000077b0: 2020 2020 6966 206e 616d 6520 3d3d 275f      if name =='_
+000077c0: 6672 6571 273a 200d 0a20 2020 2020 2020  freq': ..       
+000077d0: 2020 2020 2066 3264 2020 3d20 5b66 6974       f2d  = [fit
+000077e0: 7465 6e73 6f72 2873 656c 662e 6672 6571  tensor(self.freq
+000077f0: 735f 2c20 6564 694f 626a 2e5a 2e5f 6672  s_, ediObj.Z._fr
+00007800: 6571 2c20 6564 694f 626a 2e5a 2e5f 6672  eq, ediObj.Z._fr
+00007810: 6571 290d 0a20 2020 2020 2020 2020 2020  eq)..           
+00007820: 2020 2020 2020 2066 6f72 2065 6469 4f62         for ediOb
+00007830: 6a20 696e 2073 656c 662e 6564 694f 626a  j in self.ediObj
+00007840: 735f 0d0a 2020 2020 2020 2020 2020 2020  s_..            
+00007850: 2020 2020 2020 5d0d 0a20 2020 2020 2020        ]..       
+00007860: 2020 2020 2072 6574 7572 6e20 206e 702e       return  np.
+00007870: 6873 7461 636b 2028 5b20 7265 7368 6170  hstack ([ reshap
+00007880: 6520 286f 2c20 6178 6973 3d30 2920 666f  e (o, axis=0) fo
+00007890: 7220 6f20 696e 2066 3264 5d29 0d0a 2020  r o in f2d])..  
+000078a0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000078b0: 2320 2320 6765 7420 7468 6520 7661 6c75  # # get the valu
+000078c0: 6520 666f 7220 6578 706f 7274 6174 696f  e for exportatio
+000078d0: 6e20 2861 7474 7269 6275 7465 206e 616d  n (attribute nam
+000078e0: 6520 616e 6420 636f 6d70 6f6e 656e 7473  e and components
+000078f0: 290d 0a20 2020 2020 2020 206d 6174 3264  )..        mat2d
+00007900: 2020 3d20 6669 7432 6461 6c6c 286f 626a    = fit2dall(obj
+00007910: 733d 2073 656c 662e 6564 694f 626a 735f  s= self.ediObjs_
+00007920: 2c20 6174 7472 3d20 6e61 6d65 2c20 636f  , attr= name, co
+00007930: 6d70 3d20 6d32 290d 0a20 2020 2020 2020  mp= m2)..       
+00007940: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
+00007950: 6e20 6d61 7432 6420 0d0a 200d 0a20 2020  n mat2d .. ..   
+00007960: 2064 6566 2067 6574 7265 6665 7265 6e63   def getreferenc
+00007970: 6566 7265 7175 656e 6379 2028 0d0a 2020  efrequency (..  
+00007980: 2020 2020 2020 7365 6c66 2c0d 0a20 2020        self,..   
+00007990: 2020 2020 2074 6f5f 6c6f 6731 303a 2062       to_log10: b
+000079a0: 6f6f 6c20 3d46 616c 7365 0d0a 2020 2020  ool =False..    
+000079b0: 2020 2020 293a 200d 0a20 2020 2020 2020      ): ..       
+000079c0: 2022 2222 2047 6574 2074 6865 2072 6566   """ Get the ref
+000079d0: 6572 656e 6365 2066 7265 7175 656e 6379  erence frequency
+000079e0: 2066 726f 6d20 636f 6c6c 6563 7469 6f6e   from collection
+000079f0: 2045 6469 7320 6f62 6a65 6374 732e 0d0a   Edis objects...
+00007a00: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00007a10: 2020 5468 6520 6869 6768 6573 7420 6672    The highest fr
+00007a20: 6571 7565 6e63 7920 7769 7468 2063 6c65  equency with cle
+00007a30: 616e 2064 6174 6120 7368 6f75 6c64 2062  an data should b
+00007a40: 6520 7365 6c65 6374 6564 2061 7320 7468  e selected as th
+00007a50: 6520 200d 0a20 2020 2020 2020 2072 6566  e  ..        ref
+00007a60: 6572 656e 6365 2066 7265 7175 656e 6379  erence frequency
+00007a70: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00007a80: 2020 2020 5061 7261 6d65 7465 7273 200d      Parameters .
+00007a90: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00007aa0: 2d2d 2d20 0d0a 2020 2020 2020 2020 6461  --- ..        da
+00007ab0: 7461 3a20 6c69 7374 2020 6f66 2020 7079  ta: list  of  py
+00007ac0: 6373 616d 742e 636f 7265 2e65 6469 2e45  csamt.core.edi.E
+00007ad0: 6469 206f 7220 6d74 7079 2e63 6f72 652e  di or mtpy.core.
+00007ae0: 6564 692e 4564 6920 6f62 6a65 6374 7320  edi.Edi objects 
+00007af0: 0d0a 2020 2020 2020 2020 2020 2020 436f  ..            Co
+00007b00: 6c6c 6563 7469 6f6e 7320 6f66 2045 4449  llections of EDI
+00007b10: 2d6f 626a 6563 7473 2066 726f 6d20 6070  -objects from `p
+00007b20: 7963 7361 6d74 605f 200d 0a20 2020 2020  ycsamt`_ ..     
+00007b30: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00007b40: 2074 6f5f 6c6f 6731 303a 2062 6f6f 6c2c   to_log10: bool,
+00007b50: 200d 0a20 2020 2020 2020 2020 2020 206f   ..            o
+00007b60: 7574 7075 7473 2074 6865 2072 6566 6572  utputs the refer
+00007b70: 656e 6365 2066 7265 7175 656e 6379 2069  ence frequency i
+00007b80: 6e74 6f20 6261 7365 2031 3020 6c6f 6761  nto base 10 loga
+00007b90: 7269 7468 6d20 696e 2048 7a2e 0d0a 2020  rithm in Hz...  
+00007ba0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00007bb0: 5265 7475 726e 7320 0d0a 2020 2020 2020  Returns ..      
+00007bc0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+00007bd0: 2020 2072 6620 3a20 666c 6f61 7420 0d0a     rf : float ..
+00007be0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00007bf0: 7265 6665 7265 6e63 6520 6672 6571 7565  reference freque
+00007c00: 6e63 7920 6174 2074 6865 2063 6c65 616e  ncy at the clean
+00007c10: 2064 6174 6120 696e 2048 7a20 0d0a 2020   data in Hz ..  
+00007c20: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00007c30: 2020 2020 4578 616d 706c 6573 200d 0a20      Examples .. 
+00007c40: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00007c50: 0d0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
+00007c60: 6f6d 2077 6174 6578 2e6d 6574 686f 6473  om watex.methods
+00007c70: 2e65 6d20 696d 706f 7274 2045 4d20 200d  .em import EM  .
+00007c80: 0a20 2020 2020 2020 203e 3e3e 2065 6469  .        >>> edi
+00007c90: 7061 7468 203d 2764 6174 612f 3365 6469  path ='data/3edi
+00007ca0: 7327 0d0a 2020 2020 2020 2020 3e3e 3e20  s'..        >>> 
+00007cb0: 7265 6620 3d20 454d 2829 2e67 6574 7265  ref = EM().getre
+00007cc0: 6665 7265 6e63 6566 7265 7175 656e 6379  ferencefrequency
+00007cd0: 2865 6469 7061 7468 2c20 746f 5f6c 6f67  (edipath, to_log
+00007ce0: 3130 3d54 7275 6529 0d0a 2020 2020 2020  10=True)..      
+00007cf0: 2020 3e3e 3e20 7265 6620 0d0a 2020 2020    >>> ref ..    
+00007d00: 2020 2020 2e2e 2e20 342e 3834 3530 3938      ... 4.845098
+00007d10: 3034 3030 3134 3235 3720 2320 696e 2048  040014257 # in H
+00007d20: 7a20 0d0a 2020 2020 2020 2020 0d0a 2020  z ..        ..  
+00007d30: 2020 2020 2020 5265 6665 7265 6e63 6573        References
+00007d40: 200d 0a20 2020 2020 2020 202d 2d2d 2d2d   ..        -----
+00007d50: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2068  -----..        h
+00007d60: 7474 703a 2f2f 7777 772e 7a6f 6e67 652e  ttp://www.zonge.
+00007d70: 636f 6d2f 6c65 6761 6379 2f50 4446 5f44  com/legacy/PDF_D
+00007d80: 6174 5072 6f2f 4173 7461 7469 632e 7064  atPro/Astatic.pd
+00007d90: 660d 0a20 2020 2020 2020 200d 0a20 2020  f..        ..   
+00007da0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00007db0: 2020 7365 6c66 2e69 6e73 7065 6374 200d    self.inspect .
+00007dc0: 0a20 2020 2020 2020 2073 656c 662e 6672  .        self.fr
+00007dd0: 6571 735f 3d20 7365 6c66 2e67 6574 6675  eqs_= self.getfu
+00007de0: 6c6c 6672 6571 7565 6e63 7920 2829 0d0a  llfrequency ()..
+00007df0: 2020 2020 2020 2020 2320 6669 7420 7a20          # fit z 
+00007e00: 616e 6420 6669 6e64 2061 6c6c 206d 6973  and find all mis
+00007e10: 7369 6e67 2064 6174 6120 6672 6f6d 2063  sing data from c
+00007e20: 6f6d 706c 6574 6520 6672 6571 7565 6e63  omplete frequenc
+00007e30: 7920 6620 0d0a 2020 2020 2020 2020 2320  y f ..        # 
+00007e40: 7765 2074 616b 6520 6f6e 6c79 2074 6865  we take only the
+00007e50: 2063 6f6d 706f 6e65 6e74 2078 7920 666f   component xy fo
+00007e60: 7220 6669 7474 696e 672e 0d0a 0d0a 2020  r fitting.....  
+00007e70: 2020 2020 2020 7a78 7920 3d20 5b66 6974        zxy = [fit
+00007e80: 7465 6e73 6f72 2873 656c 662e 6672 6571  tensor(self.freq
+00007e90: 735f 2c20 6564 694f 626a 2e5a 2e5f 6672  s_, ediObj.Z._fr
+00007ea0: 6571 2c20 6564 694f 626a 2e5a 2e7a 5b3a  eq, ediObj.Z.z[:
+00007eb0: 2c20 302c 2031 5d2e 7265 616c 290d 0a20  , 0, 1].real).. 
+00007ec0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00007ed0: 2065 6469 4f62 6a20 696e 2073 656c 662e   ediObj in self.
+00007ee0: 6564 694f 626a 735f 0d0a 2020 2020 2020  ediObjs_..      
+00007ef0: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
+00007f00: 2020 2023 2073 7461 636b 6564 2074 6865     # stacked the
+00007f10: 207a 2076 616c 7565 7320 616c 6f6d 7820   z values alomx 
+00007f20: 6178 6973 3d31 2e20 0d0a 2020 2020 2020  axis=1. ..      
+00007f30: 2020 6172 7232 6420 3d20 6e70 2e68 7374    arr2d = np.hst
+00007f40: 6163 6b20 285b 2072 6573 6861 7065 2028  ack ([ reshape (
+00007f50: 6f2c 2061 7869 733d 3029 2066 6f72 206f  o, axis=0) for o
+00007f60: 2069 6e20 7a78 795d 290d 0a0d 0a20 2020   in zxy])....   
+00007f70: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00007f80: 2020 2069 785f 6e61 6e20 3d20 7265 7368     ix_nan = resh
+00007f90: 6170 6520 286e 702e 6172 6777 6865 7265  ape (np.argwhere
+00007fa0: 286e 702e 6973 6e61 6e28 6172 7232 6429  (np.isnan(arr2d)
+00007fb0: 2e61 6e79 2861 7869 7320 3d31 2920 2929  .any(axis =1) ))
+00007fc0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00007fd0: 6372 6561 7465 2062 6f6f 6c20 6172 7261  create bool arra
+00007fe0: 7920 616e 6420 6d61 736b 2074 6865 2072  y and mask the r
+00007ff0: 6f77 206f 6620 4e61 4e20 0d0a 2020 2020  ow of NaN ..    
+00008000: 2020 2020 6d61 736b 203d 206e 702e 6675      mask = np.fu
+00008010: 6c6c 5f6c 696b 6520 2873 656c 662e 6672  ll_like (self.fr
+00008020: 6571 735f 2c20 6669 6c6c 5f76 616c 7565  eqs_, fill_value
+00008030: 203d 2054 7275 6520 2c20 6474 7970 653d   = True , dtype=
+00008040: 626f 6f6c 290d 0a20 2020 2020 2020 206d  bool)..        m
+00008050: 6173 6b5b 5b2a 6978 5f6e 616e 5d20 5d20  ask[[*ix_nan] ] 
+00008060: 3d20 4661 6c73 6520 0d0a 2020 2020 2020  = False ..      
+00008070: 2020 2320 6765 7420 7468 6520 7265 6665    # get the refe
+00008080: 7265 6e63 6520 6672 6571 7565 6e63 7920  rence frequency 
+00008090: 616e 6420 696e 6465 7820 0d0a 2020 2020  and index ..    
+000080a0: 2020 2020 7265 7475 726e 2020 7365 6c66      return  self
+000080b0: 2e66 7265 7173 5f20 5b6d 6173 6b5d 2e6d  .freqs_ [mask].m
+000080c0: 6178 2829 2069 6620 6e6f 7420 746f 5f6c  ax() if not to_l
+000080d0: 6f67 3130 2065 6c73 6520 6e70 2e6c 6f67  og10 else np.log
+000080e0: 3130 280d 0a20 2020 2020 2020 2020 2020  10(..           
+000080f0: 2073 656c 662e 6672 6571 735f 205b 6d61   self.freqs_ [ma
+00008100: 736b 5d2e 6d61 7828 2929 0d0a 2020 2020  sk].max())..    
+00008110: 0d0a 2020 2020 6465 6620 5f65 7870 6f72  ..    def _expor
+00008120: 7465 6469 2028 7365 6c66 2c20 6564 694f  tedi (self, ediO
+00008130: 626a 3a20 4544 494f 292d 3e20 2245 4449  bj: EDIO)-> "EDI
+00008140: 4f22 203a 0d0a 2020 2020 2020 2020 2222  O" :..        ""
+00008150: 2249 736f 6c61 7465 6420 7061 7274 2066  "Isolated part f
+00008160: 6f72 2076 616c 6964 6174 6520 4544 4920  or validate EDI 
+00008170: 666f 7220 6d75 6c74 6970 6c65 2045 4449  for multiple EDI
+00008180: 2065 7870 6f72 7473 200d 0a20 2020 2020   exports ..     
+00008190: 2020 2028 3a6d 6574 683a 6065 7870 6f72     (:meth:`expor
+000081a0: 7465 6469 7360 292e 200d 0a20 2020 2020  tedis`). ..     
+000081b0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+000081c0: 7472 7920 3a20 0d0a 2020 2020 2020 2020  try : ..        
+000081d0: 2020 2020 6564 694f 626a 203d 2073 656c      ediObj = sel
+000081e0: 662e 6973 5f76 616c 6964 2865 6469 4f62  f.is_valid(ediOb
+000081f0: 6a20 2920 0d0a 2020 2020 2020 2020 6578  j ) ..        ex
+00008200: 6365 7074 203a 200d 0a20 2020 2020 2020  cept : ..       
+00008210: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00008220: 6365 2028 6564 694f 626a 2c20 7374 7229  ce (ediObj, str)
+00008230: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00008240: 2020 2065 6469 4f62 6a20 3d20 4564 6928     ediObj = Edi(
+00008250: 292e 6669 7428 6564 694f 626a 2029 0d0a  ).fit(ediObj )..
+00008260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008270: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00008280: 2068 6173 6174 7472 2028 6564 694f 626a   hasattr (ediObj
+00008290: 2c20 275f 5f69 7465 725f 5f27 293a 200d  , '__iter__'): .
+000082a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000082b0: 2065 6469 4f62 6a20 3d20 6564 694f 626a   ediObj = ediObj
+000082c0: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
+000082d0: 2020 2020 2069 6620 205f 6173 7365 7274       if  _assert
+000082e0: 5f7a 5f6f 725f 6564 695f 6f62 6a73 2865  _z_or_edi_objs(e
+000082f0: 6469 4f62 6a20 2921 3d27 4544 4927 203a  diObj )!='EDI' :
+00008300: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008310: 2020 2020 2020 7261 6973 6520 4544 4945        raise EDIE
+00008320: 7272 6f72 2822 4f62 6a20 7b65 6469 4f62  rror("Obj {ediOb
+00008330: 6a21 727d 2069 7320 6e6f 7420 616e 2045  j!r} is not an E
+00008340: 4449 2d6f 626a 6563 742e 2229 0d0a 2020  DI-object.")..  
+00008350: 2020 2020 2020 7265 7475 726e 2065 6469        return edi
+00008360: 4f62 6a20 0d0a 2020 2020 2020 200d 0a20  Obj ..       .. 
+00008370: 2020 2064 6566 2065 7870 6f72 7465 6469     def exportedi
+00008380: 7328 0d0a 2020 2020 2020 2020 7365 6c66  s(..        self
+00008390: 2c20 0d0a 2020 2020 2020 2020 6564 694f  , ..        ediO
+000083a0: 626a 733a 204c 6973 7420 5b45 4449 4f5d  bjs: List [EDIO]
+000083b0: 2c20 0d0a 2020 2020 2020 2020 6e65 775f  , ..        new_
+000083c0: 5a3a 204c 6973 7420 5b5a 4f5d 2c20 0d0a  Z: List [ZO], ..
+000083d0: 2020 2020 2020 2020 7361 7665 7061 7468          savepath
+000083e0: 203d 204e 6f6e 652c 200d 0a20 2020 2020   = None, ..     
+000083f0: 2020 202a 2a6b 7773 200d 0a20 2020 2020     **kws ..     
+00008400: 2020 2029 3a20 0d0a 2020 2020 2020 2020     ): ..        
+00008410: 2222 2245 7870 6f72 7420 4544 4920 6669  """Export EDI fi
+00008420: 6c65 7320 6672 6f6d 206d 756c 7469 706c  les from multipl
+00008430: 6573 2045 4449 206f 7220 7a20 6f62 6a65  es EDI or z obje
+00008440: 6374 730d 0a20 2020 2020 2020 200d 0a20  cts..        .. 
+00008450: 2020 2020 2020 2045 7870 6f72 7420 6e65         Export ne
+00008460: 7720 4544 4920 6669 6c65 2066 726f 6d20  w EDI file from 
+00008470: 7468 6520 666f 726d 6572 206f 626a 6563  the former objec
+00008480: 7420 7769 7468 2020 6120 6769 7665 6e20  t with  a given 
+00008490: 6e65 7720 200d 0a20 2020 2020 2020 2069  new  ..        i
+000084a0: 6d70 6564 616e 6365 2074 656e 736f 7273  mpedance tensors
+000084b0: 2e20 5468 6520 6578 706f 7274 2069 7320  . The export is 
+000084c0: 6173 7375 6d65 6420 6120 6e65 7720 6f75  assumed a new ou
+000084d0: 7470 7574 2045 4449 200d 0a20 2020 2020  tput EDI ..     
+000084e0: 2020 2072 6573 756c 7469 6e67 2066 726f     resulting fro
+000084f0: 6d20 6d75 6c74 6970 6c65 7320 636f 7272  m multiples corr
+00008500: 6563 7469 6f6e 7320 6170 706c 6963 6174  ections applicat
+00008510: 696f 6e73 2e0d 0a20 2020 2020 2020 200d  ions...        .
+00008520: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00008530: 6572 7320 0d0a 2020 2020 2020 2020 2d2d  ers ..        --
+00008540: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00008550: 2020 2065 6469 4f62 6a73 3a20 6c69 7374     ediObjs: list
+00008560: 206f 6620 7374 7269 6e67 2020 3a63 6c61   of string  :cla
+00008570: 7373 3a60 7761 7465 782e 6564 692e 4564  ss:`watex.edi.Ed
+00008580: 6960 200d 0a20 2020 2020 2020 2020 2020  i` ..           
+00008590: 2046 756c 6c20 7061 7468 2074 6f20 4564   Full path to Ed
+000085a0: 6920 6669 6c65 2f6f 626a 6563 7420 6f72  i file/object or
+000085b0: 206f 626a 6563 7420 6672 6f6d 2063 6c61   object from cla
+000085c0: 7373 3a60 454d 6020 6f62 6a65 6374 732e  ss:`EM` objects.
+000085d0: 200d 0a20 200d 0a20 2020 2020 2020 206e   ..  ..        n
+000085e0: 6577 5f5a 3a20 6c69 7374 206f 6620 6e64  ew_Z: list of nd
+000085f0: 6172 7261 7920 286e 6672 6571 2c20 322c  array (nfreq, 2,
+00008600: 2032 2920 0d0a 2020 2020 2020 2020 2020   2) ..          
+00008610: 2020 4120 636f 6c6c 6563 7469 6f6e 206f    A collection o
+00008620: 6620 4e64 6172 7261 7920 6f66 2069 6d70  f Ndarray of imp
+00008630: 6564 616e 6365 2074 656e 736f 7273 205a  edance tensors Z
+00008640: 2e20 0d0a 2020 2020 2020 2020 2020 2020  . ..            
+00008650: 5468 6520 7465 6e73 6f72 205a 2069 7320  The tensor Z is 
+00008660: 3344 2061 7272 6179 2063 6f6d 706f 7365  3D array compose
+00008670: 6420 6f66 206e 756d 6265 7220 6f66 2066  d of number of f
+00008680: 7265 7175 656e 6379 200d 0a20 2020 2020  requency ..     
+00008690: 2020 2020 2020 2060 6e66 7265 7160 616e         `nfreq`an
+000086a0: 6420 666f 7572 2063 6f6d 706f 6e65 6e74  d four component
+000086b0: 7320 2860 6078 7860 602c 2060 6078 7960  s (``xx``, ``xy`
+000086c0: 602c 2060 6079 7860 602c 0d0a 2020 2020  `, ``yx``,..    
+000086d0: 2020 2020 2020 2020 616e 6420 6060 7979          and ``yy
+000086e0: 6060 2920 696e 2032 5832 206d 6174 7269  ``) in 2X2 matri
+000086f0: 6365 732e 2054 6865 2020 7465 6e73 6f72  ces. The  tensor
+00008700: 205a 2069 7320 6120 636f 6d70 6c65 7820   Z is a complex 
+00008710: 6e75 6d62 6572 2e20 0d0a 2020 2020 2020  number. ..      
+00008720: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00008730: 7361 7665 7061 7468 3a73 7472 2c20 4f70  savepath:str, Op
+00008740: 7469 6f6e 616c 200d 0a20 2020 2020 2020  tional ..       
+00008750: 2020 2020 5061 7468 2074 6f20 7361 7665      Path to save
+00008760: 2061 206e 6577 2045 4449 2066 696c 652e   a new EDI file.
+00008770: 2049 6620 6060 4e6f 6e65 6060 2c20 6f75   If ``None``, ou
+00008780: 7470 7574 7320 746f 2060 5f6f 7574 7075  tputs to `_outpu
+00008790: 7445 4449 5f60 0d0a 2020 2020 2020 2020  tEDI_`..        
+000087a0: 2020 2066 6f6c 6465 722e 0d0a 2020 2020     folder...    
+000087b0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000087c0: 2052 6574 7572 6e73 200d 0a20 2020 2020   Returns ..     
+000087d0: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
+000087e0: 2020 2020 2020 6564 694f 626a 2066 726f        ediObj fro
+000087f0: 6d20 7761 7465 782e 6564 692e 4564 6920  m watex.edi.Edi 
+00008800: 0d0a 2020 2020 2020 2020 200d 0a20 2020  ..         ..   
+00008810: 2020 2020 2053 6565 2041 6c73 6f0d 0a20       See Also.. 
+00008820: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00008830: 0d0a 2020 2020 2020 2020 6578 706f 7274  ..        export
+00008840: 6564 693a 200d 0a20 2020 2020 2020 2020  edi: ..         
+00008850: 2020 2045 7870 6f72 7420 7369 6e67 6c65     Export single
+00008860: 2045 4449 2066 726f 6d0d 0a20 2020 2020   EDI from..     
+00008870: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00008880: 2022 2222 0d0a 2020 2020 2020 2020 6564   """..        ed
+00008890: 694f 626a 7320 3d20 6973 5f69 7465 7261  iObjs = is_itera
+000088a0: 626c 6528 0d0a 2020 2020 2020 2020 2020  ble(..          
+000088b0: 2020 6564 694f 626a 7320 2c20 0d0a 2020    ediObjs , ..  
+000088c0: 2020 2020 2020 2020 2020 6578 636c 7564            exclud
+000088d0: 655f 7374 7269 6e67 203d 5472 7565 202c  e_string =True ,
+000088e0: 200d 0a20 2020 2020 2020 2020 2020 2074   ..            t
+000088f0: 7261 6e73 666f 726d 203d 5472 7565 200d  ransform =True .
+00008900: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
+00008910: 2020 2020 2020 2020 6e65 775f 5a20 3d20          new_Z = 
+00008920: 6973 5f69 7465 7261 626c 6528 0d0a 2020  is_iterable(..  
+00008930: 2020 2020 2020 2020 2020 6e65 775f 5a20            new_Z 
+00008940: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00008950: 6578 636c 7564 655f 7374 7269 6e67 203d  exclude_string =
+00008960: 5472 7565 202c 200d 0a20 2020 2020 2020  True , ..       
+00008970: 2020 2020 2074 7261 6e73 666f 726d 203d       transform =
+00008980: 5472 7565 200d 0a20 2020 2020 2020 2020  True ..         
+00008990: 2020 2029 0d0a 2020 2020 2020 2020 0d0a     )..        ..
+000089a0: 2020 2020 2020 2020 666f 7220 652c 207a          for e, z
+000089b0: 2020 696e 207a 6970 2028 6564 694f 626a    in zip (ediObj
+000089c0: 732c 206e 6577 5f5a 2029 3a20 0d0a 2020  s, new_Z ): ..  
+000089d0: 2020 2020 2020 2020 2020 653d 2073 656c            e= sel
+000089e0: 662e 5f65 7870 6f72 7465 6469 2865 2920  f._exportedi(e) 
+000089f0: 0d0a 2020 2020 2020 2020 2020 2020 652e  ..            e.
+00008a00: 7772 6974 655f 6e65 775f 6564 6966 696c  write_new_edifil
+00008a10: 6528 200d 0a20 2020 2020 2020 2020 2020  e( ..           
+00008a20: 2020 2020 206e 6577 5f5a 3d7a 2c0d 0a20       new_Z=z,.. 
+00008a30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00008a40: 6176 6570 6174 6820 3d20 7361 7665 7061  avepath = savepa
+00008a50: 7468 202c 200d 0a20 2020 2020 2020 2020  th , ..         
+00008a60: 2020 2020 2020 202a 2a6b 7773 0d0a 2020         **kws..  
+00008a70: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+00008a80: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00008a90: 2020 2064 6566 2074 736c 6963 6572 2028     def tslicer (
+00008aa0: 200d 0a20 2020 2020 2020 2073 656c 662c   ..        self,
+00008ab0: 2020 0d0a 2020 2020 2020 2020 6672 6571    ..        freq
+00008ac0: 733d 204e 6f6e 652c 200d 0a20 2020 2020  s= None, ..     
+00008ad0: 2020 207a 3d20 4e6f 6e65 2c20 0d0a 2020     z= None, ..  
+00008ae0: 2020 2020 2020 636f 6d70 6f6e 656e 7420        component 
+00008af0: 3d27 7879 270d 0a20 2020 2020 2020 2029  ='xy'..        )
+00008b00: 3a20 0d0a 2020 2020 2020 2020 2222 2252  : ..        """R
+00008b10: 6574 7572 6e73 2074 656e 736f 7220 3264  eturns tensor 2d
+00008b20: 2066 726f 6d20 636f 6d70 6f6e 656e 7473   from components
+00008b30: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00008b40: 2020 2020 2050 6172 616d 6574 6572 7320       Parameters 
+00008b50: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00008b60: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2066  -----..        f
+00008b70: 7265 7173 3a20 6172 7261 796c 696b 6520  reqs: arraylike 
+00008b80: 0d0a 2020 2020 2020 2020 2020 2066 756c  ..           ful
+00008b90: 6c20 6672 6571 7565 6e63 7920 7468 6174  l frequency that
+00008ba0: 2063 6f6d 706f 7365 6420 7468 6520 7465   composed the te
+00008bb0: 6e73 6f72 2e20 4966 2060 604e 6f6e 6560  nsor. If ``None`
+00008bc0: 602c 2075 7365 2074 6865 200d 0a20 2020  `, use the ..   
+00008bd0: 2020 2020 2020 2020 636f 6d70 6f6e 656e          componen
+00008be0: 7473 2069 6e20 0d0a 2020 2020 2020 2020  ts in ..        
+00008bf0: 5a3a 2041 7272 6179 4c69 6b65 2033 4420  Z: ArrayLike 3D 
+00008c00: 0d0a 2020 2020 2020 2020 2020 2054 656e  ..           Ten
+00008c10: 736f 7220 6973 2063 6f6d 706f 7365 6420  sor is composed 
+00008c20: 6f66 2033 4420 6172 7261 7920 6f66 2073  of 3D array of s
+00008c30: 6861 7065 2028 6e5f 6672 6571 732c 2032  hape (n_freqs, 2
+00008c40: 2c20 3229 200d 0a20 2020 2020 2020 2063  , 2) ..        c
+00008c50: 6f6d 706f 6e65 6e74 3a20 7374 722c 200d  omponent: str, .
+00008c60: 0a20 2020 2020 2020 2020 2063 6f6d 706f  .          compo
+00008c70: 6e65 6e74 7320 616c 6f6e 6720 7369 6465  nents along side
+00008c80: 2074 6f20 7265 7472 6965 7665 202e 2043   to retrieve . C
+00008c90: 616e 2062 6520 5b27 7878 277c 2778 7927  an be ['xx'|'xy'
+00008ca0: 7c27 7978 277c 2779 7927 5d0d 0a20 2020  |'yx'|'yy']..   
+00008cb0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00008cc0: 202e 2e20 7665 7273 696f 6e61 6464 6564   .. versionadded
+00008cd0: 3a3a 2076 302e 322e 3020 0d0a 2020 2020  :: v0.2.0 ..    
+00008ce0: 2020 2020 0d0a 2020 2020 2020 2020 5265      ..        Re
+00008cf0: 7475 726e 7320 0d0a 2020 2020 2020 2020  turns ..        
+00008d00: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00008d10: 2020 207a 206f 7220 736c 6963 653a 2041     z or slice: A
+00008d20: 7272 616c 696b 6520 3244 2074 656e 736f  rralike 2D tenso
+00008d30: 722c 206f 7220 6469 6374 200d 0a20 2020  r, or dict ..   
+00008d40: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+00008d50: 3244 2074 656e 736f 7220 6f72 2064 6963  2D tensor or dic
+00008d60: 7469 6f6e 6e61 7279 206f 6620 636f 6d70  tionnary of comp
+00008d70: 6f6e 656e 7473 2069 6e64 6578 2073 6c69  onents index sli
+00008d80: 6365 7273 2e20 0d0a 2020 2020 2020 2020  cers. ..        
+00008d90: 2020 200d 0a20 2020 2020 2020 2022 2222     ..        """
+00008da0: 0d0a 2020 2020 2020 2020 2320 7365 7420  ..        # set 
+00008db0: 636f 6d70 6f6e 656e 7420 736c 6963 6573  component slices
+00008dc0: 2069 6e74 6f20 6120 6469 6374 0d0a 2020   into a dict..  
+00008dd0: 2020 2020 2020 6672 6571 7320 3d20 6672        freqs = fr
+00008de0: 6571 7320 6966 2066 7265 7173 2069 7320  eqs if freqs is 
+00008df0: 6e6f 7420 4e6f 6e65 2065 6c73 6520 2073  not None else  s
+00008e00: 656c 662e 6672 6571 735f 200d 0a20 2020  elf.freqs_ ..   
+00008e10: 2020 2020 200d 0a20 2020 2020 2020 2063       ..        c
+00008e20: 203d 207b 0d0a 2020 2020 2020 2020 2020   = {..          
+00008e30: 2020 2020 2778 7827 3a20 5b73 6c69 6365      'xx': [slice
+00008e40: 2028 4e6f 6e65 2c20 6c65 6e28 6672 6571   (None, len(freq
+00008e50: 7329 292c 2030 202c 2030 5d20 2c20 0d0a  s)), 0 , 0] , ..
+00008e60: 2020 2020 2020 2020 2020 2020 2020 2778                'x
+00008e70: 7927 3a20 5b73 6c69 6365 2028 4e6f 6e65  y': [slice (None
+00008e80: 2c20 6c65 6e28 6672 6571 7329 292c 2030  , len(freqs)), 0
+00008e90: 202c 2031 5d2c 200d 0a20 2020 2020 2020   , 1], ..       
+00008ea0: 2020 2020 2020 2027 7978 273a 205b 736c         'yx': [sl
+00008eb0: 6963 6520 284e 6f6e 652c 206c 656e 2866  ice (None, len(f
+00008ec0: 7265 7173 2929 2c20 3120 2c20 305d 2c20  reqs)), 1 , 0], 
+00008ed0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008ee0: 2779 7927 3a20 5b73 6c69 6365 2028 4e6f  'yy': [slice (No
+00008ef0: 6e65 2c20 6c65 6e28 6672 6571 7329 292c  ne, len(freqs)),
+00008f00: 2031 2c20 2031 5d20 0d0a 2020 2020 2020   1,  1] ..      
+00008f10: 2020 7d0d 0a20 2020 2020 2020 200d 0a20    }..        .. 
+00008f20: 2020 2020 2020 2072 6574 7572 6e20 207a         return  z
+00008f30: 205b 7475 706c 6520 2863 2e67 6574 2863   [tuple (c.get(c
+00008f40: 6f6d 706f 6e65 6e74 2929 5d20 6966 207a  omponent))] if z
+00008f50: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
+00008f60: 6520 6320 0d0a 2020 2020 2020 200d 0a20  e c ..       .. 
+00008f70: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
+00008f80: 200d 0a20 2020 2064 6566 2067 6574 5f7a   ..    def get_z
+00008f90: 5f66 726f 6d28 2065 6469 5f6f 626a 5f6c  _from( edi_obj_l
+00008fa0: 6973 742c 202f 2c20 293a 200d 0a20 2020  ist, /, ): ..   
+00008fb0: 2020 2020 2022 2222 2047 6574 207a 206f       """ Get z o
+00008fc0: 626a 6563 7420 6672 6f6d 2045 6469 206f  bject from Edi o
+00008fd0: 626a 6563 742e 200d 0a20 2020 2020 2020  bject. ..       
+00008fe0: 2050 6172 616d 6574 6572 7320 0d0a 2020   Parameters ..  
+00008ff0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00009000: 2d0d 0a20 2020 2020 2020 207a 5f6f 725f  -..        z_or_
+00009010: 6564 6973 5f6f 626a 5f6c 6973 743a 206c  edis_obj_list: l
+00009020: 6973 7420 6f66 203a 636c 6173 733a 6077  ist of :class:`w
+00009030: 6174 6578 2e65 6469 2e45 6469 6020 6f72  atex.edi.Edi` or
+00009040: 205c 0d0a 2020 2020 2020 2020 2020 2020   \..            
+00009050: 3a63 6c61 7373 3a60 7761 7465 782e 6578  :class:`watex.ex
+00009060: 7465 726e 616c 732e 7a2e 5a60 200d 0a20  ternals.z.Z` .. 
+00009070: 2020 2020 2020 2020 2020 2041 2063 6f6c             A col
+00009080: 6c65 6374 696f 6e20 6f66 2045 4449 2d20  lection of EDI- 
+00009090: 6f72 2049 6d70 6564 616e 6365 7320 7465  or Impedances te
+000090a0: 6e73 6f72 7320 6f62 6a65 6374 732e 200d  nsors objects. .
+000090b0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+000090c0: 2020 2020 2020 202e 2e20 7665 7273 696f         .. versio
+000090d0: 6e61 6464 6564 3a3a 2076 302e 312e 3920  nadded:: v0.1.9 
+000090e0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000090f0: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+00009100: 2020 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20       --------.. 
+00009110: 2020 2020 2020 205a 3a20 6c69 7374 206f         Z: list o
+00009120: 6620 3a63 6c61 7373 3a60 7761 7465 782e  f :class:`watex.
+00009130: 6578 7465 726e 616c 732e 7a2e 5a60 0d0a  externals.z.Z`..
+00009140: 2020 2020 2020 2020 2020 204c 6973 7420             List 
+00009150: 6f66 2069 6d70 6564 616e 6365 2074 656e  of impedance ten
+00009160: 736f 7220 4f62 6a65 6374 732e 200d 0a20  sor Objects. .. 
+00009170: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00009180: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00009190: 6f62 6a5f 7479 7065 2020 3d20 5f61 7373  obj_type  = _ass
+000091a0: 6572 745f 7a5f 6f72 5f65 6469 5f6f 626a  ert_z_or_edi_obj
+000091b0: 7320 2865 6469 5f6f 626a 5f6c 6973 7429  s (edi_obj_list)
+000091c0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000091d0: 2020 2065 6469 5f6f 626a 5f6c 6973 7420     edi_obj_list 
+000091e0: 2069 6620 6f62 6a5f 7479 7065 203d 3d27   if obj_type =='
+000091f0: 5a27 2065 6c73 6520 5b0d 0a20 2020 2020  Z' else [..     
+00009200: 2020 2020 2020 2065 6469 5f6f 626a 5f6c         edi_obj_l
+00009210: 6973 745b 695d 2e5a 2066 6f72 2069 2069  ist[i].Z for i i
+00009220: 6e20 7261 6e67 6520 286c 656e 2820 6564  n range (len( ed
+00009230: 695f 6f62 6a5f 6c69 7374 2920 2029 5d20  i_obj_list)  )] 
+00009240: 2020 0d0a 2020 2020 0d0a 2020 2020 6465    ..    ..    de
+00009250: 6620 5f5f 7265 7072 5f5f 2873 656c 6629  f __repr__(self)
+00009260: 3a0d 0a20 2020 2020 2020 2022 2222 2050  :..        """ P
+00009270: 7265 7474 7920 666f 726d 6174 2066 6f72  retty format for
+00009280: 2070 726f 6772 616d 6d65 7220 6775 6964   programmer guid
+00009290: 616e 6365 2066 6f6c 6c6f 7769 6e67 2074  ance following t
+000092a0: 6865 2041 5049 2e2e 2e20 2222 220d 0a20  he API... """.. 
+000092b0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+000092c0: 7072 5f63 616c 6c61 626c 655f 6f62 6a20  pr_callable_obj 
+000092d0: 2028 7365 6c66 2c20 736b 6970 203d 2827   (self, skip =('
+000092e0: 6564 6966 696c 6573 272c 2027 6672 6571  edifiles', 'freq
+000092f0: 5f61 7272 6179 272c 2027 6964 2729 290d  _array', 'id')).
+00009300: 0a20 2020 2020 2020 0d0a 2020 2020 0d0a  .       ..    ..
+00009310: 2020 2020 6465 6620 5f5f 6765 7461 7474      def __getatt
+00009320: 725f 5f28 7365 6c66 2c20 6e61 6d65 293a  r__(self, name):
+00009330: 0d0a 2020 2020 2020 2020 7276 203d 2073  ..        rv = s
+00009340: 6d61 7274 5f73 7472 6f62 6a5f 7265 636f  mart_strobj_reco
+00009350: 676e 6974 696f 6e28 6e61 6d65 2c20 7365  gnition(name, se
+00009360: 6c66 2e5f 5f64 6963 745f 5f2c 2064 6565  lf.__dict__, dee
+00009370: 7020 3d54 7275 6529 0d0a 2020 2020 2020  p =True)..      
+00009380: 2020 6170 7065 6e64 6572 2020 3d20 2222    appender  = ""
+00009390: 2069 6620 7276 2069 7320 4e6f 6e65 2065   if rv is None e
+000093a0: 6c73 6520 6627 2e20 446f 2079 6f75 206d  lse f'. Do you m
+000093b0: 6561 6e20 7b72 7621 727d 270d 0a20 2020  ean {rv!r}'..   
+000093c0: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
+000093d0: 6169 7365 2041 7474 7269 6275 7465 4572  aise AttributeEr
+000093e0: 726f 7220 280d 0a20 2020 2020 2020 2020  ror (..         
+000093f0: 2020 2066 277b 7365 6c66 2e5f 5f63 6c61     f'{self.__cla
+00009400: 7373 5f5f 2e5f 5f6e 616d 655f 5f21 727d  ss__.__name__!r}
+00009410: 206f 626a 6563 7420 6861 7320 6e6f 2061   object has no a
+00009420: 7474 7269 6275 7465 207b 6e61 6d65 2172  ttribute {name!r
+00009430: 7d27 0d0a 2020 2020 2020 2020 2020 2020  }'..            
+00009440: 6627 7b61 7070 656e 6465 727d 7b22 2220  f'{appender}{"" 
+00009450: 6966 2072 7620 6973 204e 6f6e 6520 656c  if rv is None el
+00009460: 7365 2022 3f22 7d27 0d0a 2020 2020 2020  se "?"}'..      
+00009470: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+00009480: 200d 0a63 6c61 7373 205f 7a75 7064 6174   ..class _zupdat
+00009490: 6528 454d 293a 200d 0a20 2020 2022 2222  e(EM): ..    """
+000094a0: 2041 2064 6563 6f72 6174 6f72 2066 6f72   A decorator for
+000094b0: 2069 6d70 6564 616e 6365 2074 656e 736f   impedance tenso
+000094c0: 7220 7570 6461 7469 6e67 2e20 0d0a 2020  r updating. ..  
+000094d0: 2020 0d0a 2020 2020 5570 6461 7465 2061    ..    Update a
+000094e0: 205a 206f 626a 6563 7420 6672 6f6d 2065   Z object from e
+000094f0: 6163 6820 4544 4920 6f62 6a65 6374 2063  ach EDI object c
+00009500: 6f6d 706f 7369 6e67 2074 6865 2063 6f6c  omposing the col
+00009510: 6c65 6374 696f 6e20 6f62 6a65 6374 7320  lection objects 
+00009520: 0d0a 2020 2020 616e 6420 6f75 7470 7574  ..    and output
+00009530: 2061 206e 6577 2045 4449 2d66 696c 6573   a new EDI-files
+00009540: 2069 6620 606f 7074 696f 6e60 2069 7320   if `option` is 
+00009550: 7365 7420 746f 2060 6077 7269 7465 6060  set to ``write``
+00009560: 2e20 0d0a 2020 2020 0d0a 2020 2020 5061  . ..    ..    Pa
+00009570: 7261 6d65 7465 7273 200d 0a20 2020 202d  rameters ..    -
+00009580: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
+00009590: 200d 0a20 2020 206f 7074 696f 6e3a 2073   ..    option: s
+000095a0: 7472 202c 2064 6566 6175 6c74 3d27 7772  tr , default='wr
+000095b0: 6974 6527 0d0a 2020 2020 2020 2020 6b69  ite'..        ki
+000095c0: 6e64 206f 6620 6163 7469 6f6e 2074 6f20  nd of action to 
+000095d0: 7065 7266 6f72 6d20 7769 7468 206e 6577  perform with new
+000095e0: 205a 2063 6f6c 6c65 6374 696f 6e2e 0d0a   Z collection...
+000095f0: 2020 2020 2020 2020 5768 656e 2060 6f70          When `op
+00009600: 7469 6f6e 6020 6973 2073 6574 2074 6f20  tion` is set to 
+00009610: 6060 7772 6974 6560 602e 2054 6865 206e  ``write``. The n
+00009620: 6577 2045 4449 202d 6669 6c65 7320 6172  ew EDI -files ar
+00009630: 6520 6578 706f 7274 6564 2e0d 0a20 2020  e exported...   
+00009640: 2020 2020 2041 6e79 206f 7468 6572 2076       Any other v
+00009650: 616c 7565 7320 7368 6f75 6c64 2072 6574  alues should ret
+00009660: 7572 6e20 6f6e 6c79 2074 6865 2075 7064  urn only the upd
+00009670: 6174 6564 2069 6d70 6564 616e 6365 2074  ated impedance t
+00009680: 656e 736f 7273 2e0d 0a20 2020 2020 2020  ensors...       
+00009690: 200d 0a20 2020 2052 6574 7572 6e73 200d   ..    Returns .
+000096a0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20  .    --------.. 
+000096b0: 2020 205a 207c 4e6f 6e65 203a 2041 2063     Z |None : A c
+000096c0: 6f6c 6c65 6374 696f 6e20 6f66 2020 3a63  ollection of  :c
+000096d0: 6c61 7373 3a60 7761 7465 782e 6578 7465  lass:`watex.exte
+000096e0: 726e 616c 732e 7a2e 5a60 2069 6d70 6564  rnals.z.Z` imped
+000096f0: 616e 6365 2074 656e 736f 7220 0d0a 2020  ance tensor ..  
+00009700: 2020 2020 2020 6f62 6a65 6374 732e 204e        objects. N
+00009710: 6f6e 6520 6966 2060 6f70 7469 6f6e 6020  one if `option` 
+00009720: 6973 2074 6f20 6060 7772 6974 6560 602e  is to ``write``.
+00009730: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00009740: 2022 2222 0d0a 2020 2020 0d0a 2020 2020   """..    ..    
+00009750: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00009760: 662c 206f 7074 696f 6e3a 2073 7472 203d  f, option: str =
+00009770: 2027 7772 6974 6527 293a 200d 0a20 2020   'write'): ..   
+00009780: 2020 2020 2073 656c 662e 6f70 7469 6f6e       self.option
+00009790: 203d 206f 7074 696f 6e0d 0a20 2020 200d   = option..    .
+000097a0: 0a20 2020 2064 6566 205f 5f63 616c 6c5f  .    def __call_
+000097b0: 5f20 2873 656c 662c 2066 756e 633a 4629  _ (self, func:F)
+000097c0: 3a0d 0a20 2020 2020 2020 200d 0a20 2020  :..        ..   
+000097d0: 2020 2020 2040 6675 6e63 746f 6f6c 732e       @functools.
+000097e0: 7772 6170 7320 2866 756e 6329 0d0a 2020  wraps (func)..  
+000097f0: 2020 2020 2020 6465 6620 6e65 775f 6675        def new_fu
+00009800: 6e63 2028 202a 6172 6773 2c20 2a2a 6b77  nc ( *args, **kw
+00009810: 7329 3a20 0d0a 2020 2020 2020 2020 2020  s): ..          
+00009820: 2020 2222 2220 5772 6170 7065 7220 2074    """ Wrapper  t
+00009830: 6f20 6d61 6b65 206e 6577 205a 2e20 5468  o make new Z. Th
+00009840: 6520 7570 6461 7465 6420 5a20 6973 2061  e updated Z is a
+00009850: 2063 6f6c 6c65 6374 696f 6e0d 0a20 2020   collection..   
+00009860: 2020 2020 2020 2020 206f 626a 6563 7420           object 
+00009870: 6672 6f6d 2027 3a63 6c61 7373 3a60 7079  from ':class:`py
+00009880: 6373 616d 742e 636f 7265 2e7a 2e5a 6020  csamt.core.z.Z` 
+00009890: 2222 220d 0a20 2020 2020 2020 2020 2020  """..           
+000098a0: 200d 0a20 2020 2020 2020 2020 2020 2028   ..            (
+000098b0: 6564 694f 626a 7320 2c20 6672 6571 2c20  ediObjs , freq, 
+000098c0: 207a 5f64 6963 7429 2c20 6b77 6172 6773   z_dict), kwargs
+000098d0: 203d 2066 756e 6320 282a 6172 6773 2c20   = func (*args, 
+000098e0: 2a2a 6b77 7329 0d0a 2020 2020 0d0a 2020  **kws)..    ..  
+000098f0: 2020 2020 2020 2020 2020 2320 706f 7020            # pop 
+00009900: 7468 6520 6f70 7469 6f6e 2061 7267 756d  the option argum
+00009910: 656e 7420 6966 2075 7365 7220 7072 6f76  ent if user prov
+00009920: 6964 6573 2069 7420 0d0a 2020 2020 2020  ides it ..      
+00009930: 2020 2020 2020 6f70 7469 6f6e 203d 206b        option = k
+00009940: 7761 7267 732e 706f 7028 276f 7074 696f  wargs.pop('optio
+00009950: 6e27 2c20 4e6f 6e65 290d 0a20 2020 2020  n', None)..     
+00009960: 2020 2020 2020 2072 6f74 6174 6520 3d20         rotate = 
+00009970: 6b77 6172 6773 2e70 6f70 2028 2772 6f74  kwargs.pop ('rot
+00009980: 6174 6527 2c20 302e 2029 200d 0a20 2020  ate', 0. ) ..   
+00009990: 2020 2020 2020 2020 2065 6469 4f3d 206b           ediO= k
+000099a0: 7761 7267 732e 706f 7028 2765 6469 4f62  wargs.pop('ediOb
+000099b0: 6a73 272c 204e 6f6e 6520 290d 0a20 2020  js', None )..   
+000099c0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+000099d0: 2020 2020 2020 2073 656c 662e 6f70 7469         self.opti
+000099e0: 6f6e 203d 2073 7472 286f 7074 696f 6e29  on = str(option)
+000099f0: 2e6c 6f77 6572 2829 2020 6f72 2073 656c  .lower()  or sel
+00009a00: 662e 6f70 7469 6f6e 200d 0a20 2020 2020  f.option ..     
+00009a10: 2020 2020 2020 2023 2063 7265 6174 6520         # create 
+00009a20: 616e 2065 6d70 7479 2061 7272 6179 2074  an empty array t
+00009a30: 6f20 636f 6c6c 6563 7420 6561 6368 206e  o collect each n
+00009a40: 6577 205a 206f 626a 6563 7420 0d0a 2020  ew Z object ..  
+00009a50: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00009a60: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00009a70: 616e 6365 2028 7a5f 6469 6374 2c20 6469  ance (z_dict, di
+00009a80: 6374 2029 3a20 0d0a 2020 2020 2020 2020  ct ): ..        
+00009a90: 2020 2020 2020 2020 2320 2320 7261 7468          # # rath
+00009aa0: 6572 2074 6861 6e20 7573 696e 6720 6564  er than using ed
+00009ab0: 694f 626a 7320 0d0a 2020 2020 2020 2020  iObjs ..        
+00009ac0: 2020 2020 2020 2020 2320 7768 6963 6820          # which 
+00009ad0: 636f 756c 6420 6265 204e 6f6e 6520 6966  could be None if
+00009ae0: 2074 6865 2069 6465 6120 0d0a 2020 2020   the idea ..    
+00009af0: 2020 2020 2020 2020 2020 2020 2320 6973              # is
+00009b00: 206a 7573 7420 746f 2063 6f72 7265 6374   just to correct
+00009b10: 2074 6865 2074 656e 736f 7220 7a0d 0a20   the tensor z.. 
+00009b20: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00009b30: 2074 6865 7265 666f 7220 6665 7463 6820   therefor fetch 
+00009b40: 7468 6520 7368 6170 6520 5b31 5d20 6f66  the shape [1] of
+00009b50: 2061 2072 616e 646f 6d20 0d0a 2020 2020   a random ..    
+00009b60: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+00009b70: 6d70 6f6e 656e 7473 2077 6869 6368 2063  mponents which c
+00009b80: 6f72 7265 7370 6f6e 6420 0d0a 2020 2020  orrespond ..    
+00009b90: 2020 2020 2020 2020 2020 2020 2320 746f              # to
+00009ba0: 2074 6865 206e 756d 6265 7220 6f66 2073   the number of s
+00009bb0: 7461 7469 6f6e 7320 6f66 2063 6f6c 6c65  tations of colle
+00009bc0: 6374 6564 2045 4449 200d 0a20 2020 2020  cted EDI ..     
+00009bd0: 2020 2020 2020 2020 2020 206e 7369 7465             nsite
+00009be0: 7320 3d20 6c69 7374 2820 7a5f 6469 6374  s = list( z_dict
+00009bf0: 2e76 616c 7565 7328 2929 205b 305d 2e73  .values()) [0].s
+00009c00: 6861 7065 205b 3120 5d20 0d0a 0d0a 2020  hape [1 ] ....  
+00009c10: 2020 2020 2020 2020 2020 2020 2020 5a63                Zc
+00009c20: 203d 206e 702e 656d 7074 7928 286e 7369   = np.empty((nsi
+00009c30: 7465 732c 2029 2c20 6474 7970 6520 3d20  tes, ), dtype = 
+00009c40: 6f62 6a65 6374 2029 0d0a 2020 2020 2020  object )..      
+00009c50: 2020 2020 2020 2020 2020 666f 7220 6b6b            for kk
+00009c60: 2069 6e20 7261 6e67 6520 2028 6e73 6974   in range  (nsit
+00009c70: 6573 293a 0d0a 2020 2020 2020 2020 2020  es):..          
+00009c80: 2020 2020 2020 2020 2020 2320 6372 6561            # crea
+00009c90: 7465 2061 206e 6577 205a 206f 626a 6563  te a new Z objec
+00009ca0: 7420 666f 7220 6561 6368 2045 6469 0d0a  t for each Edi..
+00009cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009cc0: 2020 2020 5a3d 2073 656c 662e 5f6d 616b      Z= self._mak
+00009cd0: 655f 7a4f 626a 286b 6b2c 6672 6571 3d66  e_zObj(kk,freq=f
+00009ce0: 7265 712c 200d 0a20 2020 2020 2020 2020  req, ..         
 00009cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d10: 2020 2020 7a5f 6469 6374 203d 207a 5f64      z_dict = z_d
-00009d20: 6963 7420 2c20 0d0a 2020 2020 2020 2020  ict , ..        
+00009d00: 2020 2020 2020 2020 2020 2020 2020 7a5f                z_
+00009d10: 6469 6374 203d 207a 5f64 6963 7420 2c20  dict = z_dict , 
+00009d20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00009d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d40: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00009d50: 6f74 6174 653d 2072 6f74 6174 652c 200d  otate= rotate, .
-00009d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009d40: 2020 2020 2020 2020 2072 6f74 6174 653d           rotate=
+00009d50: 2072 6f74 6174 652c 200d 0a20 2020 2020   rotate, ..     
+00009d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00009d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d80: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-00009d90: 2020 2020 2020 2020 2020 2020 2020 205a                 Z
-00009da0: 635b 6b6b 5d20 3d5a 0d0a 2020 2020 2020  c[kk] =Z..      
-00009db0: 2020 2020 2020 656c 7365 203a 200d 0a20        else : .. 
-00009dc0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00009dd0: 2077 7269 7465 2063 6f72 7265 6374 6564   write corrected
-00009de0: 2045 4469 7320 7769 7468 206e 6f20 6c6f   EDis with no lo
-00009df0: 6f70 7320 0d0a 2020 2020 2020 2020 2020  ops ..          
-00009e00: 2020 2020 2020 5a63 203d 207a 5f64 6963        Zc = z_dic
-00009e10: 7420 0d0a 2020 2020 2020 2020 2020 2020  t ..            
-00009e20: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00009e30: 2073 656c 662e 6f70 7469 6f6e 2069 6e20   self.option in 
-00009e40: 2827 7772 6974 6527 2c20 2774 7275 6527  ('write', 'true'
-00009e50: 2920 3a0d 0a20 2020 2020 2020 2020 2020  ) :..           
-00009e60: 2020 2020 206f 626a 7479 7065 203d 205f       objtype = _
-00009e70: 6173 7365 7274 5f7a 5f6f 725f 6564 695f  assert_z_or_edi_
-00009e80: 6f62 6a73 2865 6469 4f62 6a73 290d 0a20  objs(ediObjs).. 
-00009e90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00009ea0: 6620 6f62 6a74 7970 6520 3d3d 275a 2761  f objtype =='Z'a
-00009eb0: 6e64 2065 6469 4f20 6973 204e 6f6e 653a  nd ediO is None:
-00009ec0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009ed0: 2020 2020 2020 7261 6973 6520 454d 4572        raise EMEr
-00009ee0: 726f 7220 2822 4d69 7373 696e 6720 4544  ror ("Missing ED
-00009ef0: 492d 6f62 6a65 6374 732e 205a 206f 626a  I-objects. Z obj
-00009f00: 6563 7420 6f6e 6c79 2063 616e 6e6f 7422  ect only cannot"
-00009f10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f30: 2020 2020 2022 2062 6520 6578 706f 7274       " be export
-00009f40: 6564 2e20 5072 6f76 6964 6520 7468 6520  ed. Provide the 
-00009f50: 4544 492d 6f62 6a65 6374 7320 6173 220d  EDI-objects as".
-00009f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f80: 2020 2020 2220 6120 6b65 7977 6f72 6420      " a keyword 
-00009f90: 6172 6775 6d65 6e74 2060 6564 694f 626a  argument `ediObj
-00009fa0: 7360 2074 6f20 636f 6c6c 6563 7422 0d0a  s` to collect"..
+00009d80: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+00009d90: 2020 2020 2020 2020 205a 635b 6b6b 5d20           Zc[kk] 
+00009da0: 3d5a 0d0a 2020 2020 2020 2020 2020 2020  =Z..            
+00009db0: 656c 7365 203a 200d 0a20 2020 2020 2020  else : ..       
+00009dc0: 2020 2020 2020 2020 2023 2077 7269 7465           # write
+00009dd0: 2063 6f72 7265 6374 6564 2045 4469 7320   corrected EDis 
+00009de0: 7769 7468 206e 6f20 6c6f 6f70 7320 0d0a  with no loops ..
+00009df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009e00: 5a63 203d 207a 5f64 6963 7420 0d0a 2020  Zc = z_dict ..  
+00009e10: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00009e20: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00009e30: 6f70 7469 6f6e 2069 6e20 2827 7772 6974  option in ('writ
+00009e40: 6527 2c20 2774 7275 6527 2920 3a0d 0a20  e', 'true') :.. 
+00009e50: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00009e60: 626a 7479 7065 203d 205f 6173 7365 7274  bjtype = _assert
+00009e70: 5f7a 5f6f 725f 6564 695f 6f62 6a73 2865  _z_or_edi_objs(e
+00009e80: 6469 4f62 6a73 290d 0a20 2020 2020 2020  diObjs)..       
+00009e90: 2020 2020 2020 2020 2069 6620 6f62 6a74           if objt
+00009ea0: 7970 6520 3d3d 275a 2761 6e64 2065 6469  ype =='Z'and edi
+00009eb0: 4f20 6973 204e 6f6e 653a 0d0a 2020 2020  O is None:..    
+00009ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ed0: 7261 6973 6520 454d 4572 726f 7220 2822  raise EMError ("
+00009ee0: 4d69 7373 696e 6720 4544 492d 6f62 6a65  Missing EDI-obje
+00009ef0: 6374 732e 205a 206f 626a 6563 7420 6f6e  cts. Z object on
+00009f00: 6c79 2063 616e 6e6f 7422 0d0a 2020 2020  ly cannot"..    
+00009f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00009f30: 2062 6520 6578 706f 7274 6564 2e20 5072   be exported. Pr
+00009f40: 6f76 6964 6520 7468 6520 4544 492d 6f62  ovide the EDI-ob
+00009f50: 6a65 6374 7320 6173 220d 0a20 2020 2020  jects as"..     
+00009f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f70: 2020 2020 2020 2020 2020 2020 2020 2220                " 
+00009f80: 6120 6b65 7977 6f72 6420 6172 6775 6d65  a keyword argume
+00009f90: 6e74 2060 6564 694f 626a 7360 2074 6f20  nt `ediObjs` to 
+00009fa0: 636f 6c6c 6563 7422 0d0a 2020 2020 2020  collect"..      
 00009fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009fd0: 2020 2022 2074 6865 206d 6574 6164 6174     " the metadat
-00009fe0: 6120 6f66 2074 6865 2073 6974 6520 3c48  a of the site <H
-00009ff0: 6561 642d 496e 666f 732d 220d 0a20 2020  ead-Infos-"..   
+00009fc0: 2020 2020 2020 2020 2020 2020 2022 2074               " t
+00009fd0: 6865 206d 6574 6164 6174 6120 6f66 2074  he metadata of t
+00009fe0: 6865 2073 6974 6520 3c48 6561 642d 496e  he site <Head-In
+00009ff0: 666f 732d 220d 0a20 2020 2020 2020 2020  fos-"..         
 0000a000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a020: 2220 4d65 6173 7572 656d 656e 742e 2e2e  " Measurement...
-0000a030: 3e20 666f 7220 7265 7772 6974 7469 6e67  > for rewritting
-0000a040: 2e20 4974 2064 6f65 7320 220d 0a20 2020  . It does "..   
+0000a010: 2020 2020 2020 2020 2020 2220 4d65 6173            " Meas
+0000a020: 7572 656d 656e 742e 2e2e 3e20 666f 7220  urement...> for 
+0000a030: 7265 7772 6974 7469 6e67 2e20 4974 2064  rewritting. It d
+0000a040: 6f65 7320 220d 0a20 2020 2020 2020 2020  oes "..         
 0000a050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a070: 2220 6e6f 7420 616c 7465 7220 7468 6520  " not alter the 
-0000a080: 6e65 7720 636f 7272 6563 7465 6420 6f72  new corrected or
-0000a090: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+0000a060: 2020 2020 2020 2020 2020 2220 6e6f 7420            " not 
+0000a070: 616c 7465 7220 7468 6520 6e65 7720 636f  alter the new co
+0000a080: 7272 6563 7465 6420 6f72 220d 0a20 2020  rrected or"..   
+0000a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000a0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0b0: 2020 2020 2020 2220 696e 7465 7270 6f6c        " interpol
-0000a0c0: 6174 6564 205a 2e22 290d 0a20 2020 2020  ated Z.")..     
-0000a0d0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0000a0e0: 2020 2020 2020 2020 2020 2020 2065 6469               edi
-0000a0f0: 4f20 3d20 6564 694f 626a 7320 6966 206f  O = ediObjs if o
-0000a100: 626a 7479 7065 3d3d 2745 4449 2765 6c73  bjtype=='EDI'els
-0000a110: 6520 6564 694f 0d0a 2020 2020 2020 2020  e ediO..        
-0000a120: 2020 2020 2020 2020 6564 694f 203d 2069          ediO = i
-0000a130: 735f 6974 6572 6162 6c65 280d 0a20 2020  s_iterable(..   
-0000a140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a150: 2065 6469 4f20 2c20 0d0a 2020 2020 2020   ediO , ..      
-0000a160: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-0000a170: 636c 7564 655f 7374 7269 6e67 203d 5472  clude_string =Tr
-0000a180: 7565 2c20 0d0a 2020 2020 2020 2020 2020  ue, ..          
-0000a190: 2020 2020 2020 2020 2020 7472 616e 7366            transf
-0000a1a0: 6f72 6d20 3d54 7275 6520 0d0a 2020 2020  orm =True ..    
-0000a1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000a1d0: 2020 2061 7373 6572 7420 6c65 6e28 6564     assert len(ed
-0000a1e0: 694f 2920 3d3d 6c65 6e28 5a63 292c 2028  iO) ==len(Zc), (
-0000a1f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a200: 2020 2020 2020 2245 4449 2d6f 626a 6563        "EDI-objec
-0000a210: 7473 2061 6e64 205a 2063 6f6c 6c65 6374  ts and Z collect
-0000a220: 696f 6e20 6d75 7374 2062 6520 636f 6e73  ion must be cons
-0000a230: 6973 7465 6e74 2e22 0d0a 2020 2020 2020  istent."..      
-0000a240: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0000a250: 2047 6f74 207b 6c65 6e28 6564 694f 297d   Got {len(ediO)}
-0000a260: 2061 6e64 207b 6c65 6e28 5a63 297d 2e22   and {len(Zc)}."
-0000a270: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000a280: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000a290: 2020 2020 2073 656c 662e 6578 706f 7274       self.export
-0000a2a0: 6564 6973 280d 0a20 2020 2020 2020 2020  edis(..         
-0000a2b0: 2020 2020 2020 2020 2020 2065 6469 4f62             ediOb
-0000a2c0: 6a73 3d65 6469 4f2c 200d 0a20 2020 2020  js=ediO, ..     
-0000a2d0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000a2e0: 6577 5f5a 3d5a 632c 200d 0a20 2020 2020  ew_Z=Zc, ..     
-0000a2f0: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-0000a300: 2a6b 7761 7267 730d 0a20 2020 2020 2020  *kwargs..       
-0000a310: 2020 2020 2020 2020 2020 2020 2029 200d               ) .
-0000a320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a330: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-0000a340: 6574 7572 6e20 5a63 2069 6620 7365 6c66  eturn Zc if self
-0000a350: 2e6f 7074 696f 6e20 213d 2777 7269 7465  .option !='write
-0000a360: 2720 656c 7365 204e 6f6e 6520 0d0a 2020  ' else None ..  
-0000a370: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000a380: 2020 7265 7475 726e 206e 6577 5f66 756e    return new_fun
-0000a390: 6320 0d0a 2020 2020 0d0a 2020 2020 6465  c ..    ..    de
-0000a3a0: 6620 5f6d 616b 655f 7a4f 626a 2028 0d0a  f _make_zObj (..
-0000a3b0: 2020 2020 2020 2020 7365 6c66 2c20 0d0a          self, ..
-0000a3c0: 2020 2020 2020 2020 6b6b 3a20 696e 7420          kk: int 
-0000a3d0: 2c0d 0a20 2020 2020 2020 202a 2c20 0d0a  ,..        *, ..
-0000a3e0: 2020 2020 2020 2020 6672 6571 3a20 4172          freq: Ar
-0000a3f0: 7261 794c 696b 655b 4454 7970 655b 666c  rayLike[DType[fl
-0000a400: 6f61 745d 5d2c 200d 0a20 2020 2020 2020  oat]], ..       
-0000a410: 207a 5f64 6963 743a 2044 6963 745b 7374   z_dict: Dict[st
-0000a420: 722c 204e 4441 7272 6179 5b44 5479 7065  r, NDArray[DType
-0000a430: 5b63 6f6d 706c 6578 5d5d 5d2c 200d 0a20  [complex]]], .. 
-0000a440: 2020 2020 2020 2072 6f74 6174 653d 302e         rotate=0.
-0000a450: 0d0a 2020 2020 2020 2020 292d 3e20 4e44  ..        )-> ND
-0000a460: 4172 7261 795b 4454 7970 655b 636f 6d70  Array[DType[comp
-0000a470: 6c65 785d 5d3a 200d 0a20 2020 2020 2020  lex]]: ..       
-0000a480: 2022 2222 204d 616b 6520 6e65 7720 5a20   """ Make new Z 
-0000a490: 6f62 6a65 6374 2066 726f 6d20 6672 6571  object from freq
-0000a4a0: 7565 6e63 7920 616e 6420 6469 6374 2074  uency and dict t
-0000a4b0: 656e 736f 7220 636f 6d70 6f6e 656e 7420  ensor component 
-0000a4c0: 5a2e 200d 0a20 2020 2020 2020 200d 0a20  Z. ..        .. 
-0000a4d0: 2020 2020 2020 203a 7061 7261 6d20 6b6b         :param kk
-0000a4e0: 3a20 696e 7420 0d0a 2020 2020 2020 2020  : int ..        
-0000a4f0: 2020 2020 696e 6465 7820 6f66 2072 6f75      index of rou
-0000a500: 7469 6e65 2074 6f20 7265 7472 6965 7665  tine to retrieve
-0000a510: 2074 6865 2074 656e 736f 7220 6461 7461   the tensor data
-0000a520: 2e20 4974 206d 6179 2063 6f72 7265 7370  . It may corresp
-0000a530: 6f6e 6420 6f66 200d 0a20 2020 2020 2020  ond of ..       
-0000a540: 2020 2020 2074 6865 2073 7461 7469 6f6e       the station
-0000a550: 2069 6e64 6578 2e20 0d0a 2020 2020 2020   index. ..      
-0000a560: 2020 3a70 6172 616d 2066 7265 713a 2061    :param freq: a
-0000a570: 7272 6179 2d6c 696b 6520 0d0a 2020 2020  rray-like ..    
-0000a580: 2020 2020 2020 2020 6675 6c6c 2066 7265          full fre
-0000a590: 7175 656e 6379 206f 6620 636f 6d70 6f6e  quency of compon
-0000a5a0: 656e 7420 0d0a 2020 2020 2020 2020 3a70  ent ..        :p
-0000a5b0: 6172 616d 207a 5f64 6963 743a 2064 6963  aram z_dict: dic
-0000a5c0: 742c 200d 0a20 2020 2020 2020 2020 2020  t, ..           
-0000a5d0: 2064 6963 7469 6f6e 6e61 7279 206f 6620   dictionnary of 
-0000a5e0: 616c 6c20 7465 6e73 6f72 2063 6f6d 706f  all tensor compo
-0000a5f0: 6e65 6e74 2e0d 0a20 2020 2020 2020 203a  nent...        :
-0000a600: 7061 7261 6d20 726f 7461 7465 3a20 666c  param rotate: fl
-0000a610: 6f61 742c 200d 0a20 2020 2020 2020 2020  oat, ..         
-0000a620: 2041 6e67 6c65 2074 6f20 726f 7461 7465   Angle to rotate
-0000a630: 2074 6865 2069 6d70 6564 616e 6365 2074   the impedance t
-0000a640: 656e 736f 7220 6163 636f 7264 696e 676c  ensor accordingl
-0000a650: 792e 200d 0a0d 0a20 2020 2020 2020 2022  y. ....        "
-0000a660: 2222 0d0a 2020 2020 2020 2020 5a20 3d20  ""..        Z = 
-0000a670: 454d 7a28 0d0a 2020 2020 2020 2020 2020  EMz(..          
-0000a680: 2020 7a5f 6172 7261 793d 6e70 2e7a 6572    z_array=np.zer
-0000a690: 6f73 2828 6c65 6e28 6672 6571 2029 2c20  os((len(freq ), 
-0000a6a0: 322c 2032 292c 6474 7970 653d 2763 6f6d  2, 2),dtype='com
-0000a6b0: 706c 6578 2729 2c0d 0a20 2020 2020 2020  plex'),..       
-0000a6c0: 2020 2020 207a 5f65 7272 5f61 7272 6179       z_err_array
-0000a6d0: 3d6e 702e 7a65 726f 7328 286c 656e 2866  =np.zeros((len(f
-0000a6e0: 7265 7129 2c20 322c 2032 2929 2c0d 0a20  req), 2, 2)),.. 
-0000a6f0: 2020 2020 2020 2020 2020 2066 7265 713d             freq=
-0000a700: 6672 6571 200d 0a20 2020 2020 2020 2020  freq ..         
-0000a710: 2020 2029 0d0a 2020 2020 2020 2020 7a78     )..        zx
-0000a720: 7820 3d20 7a5f 6469 6374 2e67 6574 2827  x = z_dict.get('
-0000a730: 7a78 7827 2920 0d0a 2020 2020 2020 2020  zxx') ..        
-0000a740: 7a78 7920 3d20 7a5f 6469 6374 2e67 6574  zxy = z_dict.get
-0000a750: 2827 7a78 7927 2920 0d0a 2020 2020 2020  ('zxy') ..      
-0000a760: 2020 7a79 7820 3d20 7a5f 6469 6374 2e67    zyx = z_dict.g
-0000a770: 6574 2827 7a79 7827 2920 0d0a 2020 2020  et('zyx') ..    
-0000a780: 2020 2020 7a79 7920 3d20 7a5f 6469 6374      zyy = z_dict
-0000a790: 2e67 6574 2827 7a79 7927 2920 0d0a 2020  .get('zyy') ..  
-0000a7a0: 2020 2020 2020 2320 646f 6e74 2072 6169        # dont rai
-0000a7b0: 7365 2061 6e79 2065 7272 6f72 2069 6620  se any error if 
-0000a7c0: 7468 6520 636f 6d70 6f6e 656e 7420 0d0a  the component ..
-0000a7d0: 2020 2020 2020 2020 2320 646f 6573 206e          # does n
-0000a7e0: 6f74 2065 7869 7374 2e0d 0a20 2020 2020  ot exist...     
-0000a7f0: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-0000a800: 7a78 7820 6973 206e 6f74 204e 6f6e 653a  zxx is not None:
-0000a810: 200d 0a20 2020 2020 2020 2020 2020 205a   ..            Z
-0000a820: 2e5f 7a5b 3a2c 2030 2c20 2030 5d20 3d20  ._z[:, 0,  0] = 
-0000a830: 7265 7368 6170 6520 287a 7878 5b3a 2c20  reshape (zxx[:, 
-0000a840: 6b6b 5d2c 2031 2920 0d0a 2020 2020 2020  kk], 1) ..      
-0000a850: 2020 6966 207a 7879 2069 7320 6e6f 7420    if zxy is not 
-0000a860: 4e6f 6e65 3a20 0d0a 2020 2020 2020 2020  None: ..        
-0000a870: 2020 2020 5a2e 5f7a 5b3a 2c20 302c 2020      Z._z[:, 0,  
-0000a880: 315d 203d 2072 6573 6861 7065 2028 7a78  1] = reshape (zx
-0000a890: 795b 3a2c 206b 6b5d 2c20 3129 0d0a 2020  y[:, kk], 1)..  
-0000a8a0: 2020 2020 2020 6966 207a 7978 2069 7320        if zyx is 
-0000a8b0: 206e 6f74 204e 6f6e 653a 200d 0a20 2020   not None: ..   
-0000a8c0: 2020 2020 2020 2020 205a 2e5f 7a5b 3a2c           Z._z[:,
-0000a8d0: 2031 2c20 2030 5d20 3d20 7265 7368 6170   1,  0] = reshap
-0000a8e0: 6520 287a 7978 5b3a 2c20 6b6b 5d2c 2031  e (zyx[:, kk], 1
-0000a8f0: 2920 0d0a 2020 2020 2020 2020 6966 207a  ) ..        if z
-0000a900: 7979 2069 7320 6e6f 7420 4e6f 6e65 3a20  yy is not None: 
-0000a910: 0d0a 2020 2020 2020 2020 2020 2020 5a2e  ..            Z.
-0000a920: 5f7a 5b3a 2c20 312c 2020 315d 203d 2072  _z[:, 1,  1] = r
-0000a930: 6573 6861 7065 2028 7a79 795b 3a2c 206b  eshape (zyy[:, k
-0000a940: 6b5d 2c20 3129 0d0a 2020 2020 2020 2020  k], 1)..        
-0000a950: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
-0000a960: 7365 7420 7468 6520 7a5f 6572 7220 0d0a  set the z_err ..
-0000a970: 2020 2020 2020 2020 7a78 785f 6572 7220          zxx_err 
-0000a980: 3d20 7a5f 6469 6374 2e67 6574 2827 7a78  = z_dict.get('zx
-0000a990: 785f 6572 7227 2920 0d0a 2020 2020 2020  x_err') ..      
-0000a9a0: 2020 7a78 795f 6572 7220 3d20 7a5f 6469    zxy_err = z_di
-0000a9b0: 6374 2e67 6574 2827 7a78 795f 6572 7227  ct.get('zxy_err'
-0000a9c0: 2920 0d0a 2020 2020 2020 2020 7a79 785f  ) ..        zyx_
-0000a9d0: 6572 7220 3d20 7a5f 6469 6374 2e67 6574  err = z_dict.get
-0000a9e0: 2827 7a79 785f 6572 7227 2920 0d0a 2020  ('zyx_err') ..  
-0000a9f0: 2020 2020 2020 7a79 795f 6572 7220 3d20        zyy_err = 
-0000aa00: 7a5f 6469 6374 2e67 6574 2827 7a79 795f  z_dict.get('zyy_
-0000aa10: 6572 7227 2920 0d0a 2020 2020 2020 2020  err') ..        
-0000aa20: 0d0a 2020 2020 2020 2020 6966 207a 7878  ..        if zxx
-0000aa30: 5f65 7272 2069 7320 6e6f 7420 4e6f 6e65  _err is not None
-0000aa40: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0000aa50: 5a2e 5f7a 5f65 7272 5b3a 2c20 302c 2020  Z._z_err[:, 0,  
-0000aa60: 305d 203d 2072 6573 6861 7065 2028 7a78  0] = reshape (zx
-0000aa70: 785f 6572 725b 3a2c 206b 6b5d 2c20 3129  x_err[:, kk], 1)
-0000aa80: 200d 0a20 2020 2020 2020 2069 6620 7a78   ..        if zx
-0000aa90: 795f 6572 7220 6973 206e 6f74 204e 6f6e  y_err is not Non
-0000aaa0: 653a 200d 0a20 2020 2020 2020 2020 2020  e: ..           
-0000aab0: 205a 2e5f 7a5f 6572 725b 3a2c 2030 2c20   Z._z_err[:, 0, 
-0000aac0: 2031 5d20 3d20 7265 7368 6170 6520 287a   1] = reshape (z
-0000aad0: 7879 5f65 7272 5b3a 2c20 6b6b 5d2c 2031  xy_err[:, kk], 1
-0000aae0: 290d 0a20 2020 2020 2020 2069 6620 7a79  )..        if zy
-0000aaf0: 785f 6572 7220 6973 206e 6f74 204e 6f6e  x_err is not Non
-0000ab00: 653a 200d 0a20 2020 2020 2020 2020 2020  e: ..           
-0000ab10: 205a 2e5f 7a5f 6572 725b 3a2c 2031 2c20   Z._z_err[:, 1, 
-0000ab20: 2030 5d20 3d20 7265 7368 6170 6520 287a   0] = reshape (z
-0000ab30: 7978 5f65 7272 5b3a 2c20 6b6b 5d2c 2031  yx_err[:, kk], 1
-0000ab40: 2920 0d0a 2020 2020 2020 2020 6966 207a  ) ..        if z
-0000ab50: 7979 5f65 7272 2069 7320 6e6f 7420 4e6f  yy_err is not No
-0000ab60: 6e65 3a20 0d0a 2020 2020 2020 2020 2020  ne: ..          
-0000ab70: 2020 5a2e 5f7a 5f65 7272 5b3a 2c20 312c    Z._z_err[:, 1,
-0000ab80: 2020 315d 203d 2072 6573 6861 7065 2028    1] = reshape (
-0000ab90: 7a79 795f 6572 725b 3a2c 206b 6b5d 2c20  zyy_err[:, kk], 
-0000aba0: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-0000abb0: 0d0a 2020 2020 2020 2020 5a2e 726f 7461  ..        Z.rota
-0000abc0: 7465 2872 6f74 6174 6520 2920 2320 726f  te(rotate ) # ro
-0000abd0: 7461 7465 2061 6e67 6c65 2069 6620 6769  tate angle if gi
-0000abe0: 7665 6e20 0d0a 2020 2020 2020 2020 5a2e  ven ..        Z.
-0000abf0: 636f 6d70 7574 655f 7265 7369 7374 6976  compute_resistiv
-0000ac00: 6974 795f 7068 6173 6528 0d0a 2020 2020  ity_phase(..    
-0000ac10: 2020 2020 2020 2020 7a5f 6172 7261 7920          z_array 
-0000ac20: 3d20 5a2e 5f7a 202c 207a 5f65 7272 5f61  = Z._z , z_err_a
-0000ac30: 7272 6179 203d 205a 2e5f 7a5f 6572 722c  rray = Z._z_err,
-0000ac40: 2066 7265 7120 3d20 6672 6571 2029 0d0a   freq = freq )..
-0000ac50: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000ac60: 205a 0d0a 200d 0a20 2020 2020 2020 200d   Z.. ..        .
-0000ac70: 0a63 6c61 7373 2050 726f 6365 7373 696e  .class Processin
-0000ac80: 6720 2845 4d29 203a 0d0a 2020 2020 2222  g (EM) :..    ""
-0000ac90: 2220 4261 7365 2070 726f 6365 7373 696e  " Base processin
-0000aca0: 6720 6f66 2045 4d20 6f62 6a65 6374 200d  g of EM object .
-0000acb0: 0a20 2020 200d 0a20 2020 2046 6173 7420  .    ..    Fast 
-0000acc0: 7072 6f63 6573 7320 454d 4150 2061 6e64  process EMAP and
-0000acd0: 2041 4d54 2064 6174 612e 2054 6f6f 6c73   AMT data. Tools
-0000ace0: 2061 7265 2075 7365 6420 666f 7220 6461   are used for da
-0000acf0: 7461 2073 616e 6974 697a 696e 672c 200d  ta sanitizing, .
-0000ad00: 0a20 2020 2072 656d 6f76 696e 6720 6e6f  .    removing no
-0000ad10: 6973 6573 2061 6e64 2066 696c 7465 7269  ises and filteri
-0000ad20: 6e67 2e20 0d0a 2020 2020 0d0a 2020 2020  ng. ..    ..    
-0000ad30: 5061 7261 6d65 7465 7273 200d 0a20 2020  Parameters ..   
-0000ad40: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-0000ad50: 2064 6174 613a 2050 6174 682d 6c69 6b65   data: Path-like
-0000ad60: 206f 626a 6563 7420 6f72 206c 6973 7420   object or list 
-0000ad70: 206f 6620 203a 636c 6173 733a 7761 7465   of  :class:wate
-0000ad80: 782e 6564 692e 4564 6960 206f 7220 5c0d  x.edi.Edi` or \.
-0000ad90: 0a20 2020 2020 2020 2060 7079 6373 616d  .        `pycsam
-0000ada0: 742e 636f 7265 2e65 6469 2e45 6469 6020  t.core.edi.Edi` 
-0000adb0: 6f62 6a65 6374 7320 0d0a 2020 2020 2020  objects ..      
-0000adc0: 2020 436f 6c6c 6563 7469 6f6e 7320 6f66    Collections of
-0000add0: 2045 4449 2d6f 626a 6563 7473 200d 0a20   EDI-objects .. 
-0000ade0: 2020 200d 0a20 2020 2066 7265 7173 3a20     ..    freqs: 
-0000adf0: 6172 7261 792d 6c69 6b65 2c20 7368 6170  array-like, shap
-0000ae00: 6520 284e 290d 0a20 2020 2020 2020 2046  e (N)..        F
-0000ae10: 7265 7175 656e 6379 2061 7272 6179 2e20  requency array. 
-0000ae20: 4974 2073 686f 756c 6420 6265 2074 6865  It should be the
-0000ae30: 2063 6f6d 706c 6574 6520 6672 6571 7565   complete freque
-0000ae40: 6e63 7920 7573 6564 2064 7572 696e 6720  ncy used during 
-0000ae50: 7468 6520 0d0a 2020 2020 2020 2020 7375  the ..        su
-0000ae60: 7276 6579 2061 7265 612e 2049 7420 6361  rvey area. It ca
-0000ae70: 6e20 6265 2067 6574 2075 7369 6e67 2074  n be get using t
-0000ae80: 6865 203a 6675 6e63 3a60 6765 7466 756c  he :func:`getful
-0000ae90: 6c66 7265 7175 656e 6379 2060 200d 0a20  lfrequency ` .. 
-0000aea0: 2020 2020 2020 204e 6f20 6e65 6564 2069         No need i
-0000aeb0: 6620 6564 694f 626a 7320 6973 2070 726f  f ediObjs is pro
-0000aec0: 7669 6465 642e 200d 0a20 2020 2020 2020  vided. ..       
-0000aed0: 200d 0a20 2020 2077 696e 646f 775f 7369   ..    window_si
-0000aee0: 7a65 203a 2069 6e74 0d0a 2020 2020 2020  ze : int..      
-0000aef0: 2020 7468 6520 6c65 6e67 7468 206f 6620    the length of 
-0000af00: 7468 6520 7769 6e64 6f77 2e20 4d75 7374  the window. Must
-0000af10: 2062 6520 6772 6561 7465 7220 7468 616e   be greater than
-0000af20: 2031 2061 6e64 2070 7265 6665 7261 626c   1 and preferabl
-0000af30: 790d 0a20 2020 2020 2020 2061 6e20 6f64  y..        an od
-0000af40: 6420 696e 7465 6765 7220 6e75 6d62 6572  d integer number
-0000af50: 2e20 4465 6661 756c 7420 6973 2060 6035  . Default is ``5
-0000af60: 6060 0d0a 2020 2020 2020 2020 0d0a 2020  ``..        ..  
-0000af70: 2020 636f 6d70 6f6e 656e 743a 2073 7472    component: str
-0000af80: 200d 0a20 2020 2020 2020 6669 656c 6420   ..       field 
-0000af90: 7465 6e73 6f72 7320 6469 7265 6374 696f  tensors directio
-0000afa0: 6e2e 2049 7420 6361 6e20 6265 2060 6078  n. It can be ``x
-0000afb0: 7860 602c 2060 6078 7960 602c 6060 7978  x``, ``xy``,``yx
-0000afc0: 6060 2c20 6060 7979 6060 2e20 4966 200d  ``, ``yy``. If .
-0000afd0: 0a20 2020 2020 2020 6061 7272 3264 6060  .       `arr2d``
-0000afe0: 2069 7320 7072 6f76 6964 6564 2c20 6e6f   is provided, no
-0000aff0: 206e 6565 6420 746f 2067 6976 6520 616e   need to give an
-0000b000: 2061 7267 756d 656e 742e 2049 7420 6265   argument. It be
-0000b010: 636f 6d65 2075 7365 6675 6c20 0d0a 2020  come useful ..  
-0000b020: 2020 2020 2077 6865 6e20 6120 636f 6c6c       when a coll
-0000b030: 6563 7469 6f6e 206f 6620 4544 492d 6f62  ection of EDI-ob
-0000b040: 6a65 6374 7320 6973 2070 726f 7669 6465  jects is provide
-0000b050: 642e 2049 6620 646f 6e27 7420 7370 6563  d. If don't spec
-0000b060: 6966 792c 2074 6865 200d 0a20 2020 2020  ify, the ..     
-0000b070: 2020 7265 7369 7374 6976 6974 7920 616e    resistivity an
-0000b080: 6420 7068 6173 6520 7661 6c75 6520 6174  d phase value at
-0000b090: 2063 6f6d 706f 6e65 6e74 2060 7879 6020   component `xy` 
-0000b0a0: 7368 6f75 6c64 2062 6520 6665 7463 6865  should be fetche
-0000b0b0: 6420 666f 7220 0d0a 2020 2020 2020 2063  d for ..       c
-0000b0c0: 6f72 7265 6374 696f 6e20 6279 2064 6566  orrection by def
-0000b0d0: 6175 6c74 2e20 4368 616e 6765 2074 6865  ault. Change the
-0000b0e0: 2063 6f6d 706f 6e65 6e74 2076 616c 7565   component value
-0000b0f0: 2074 6f20 6765 7420 7468 6520 6170 7072   to get the appr
-0000b100: 6f70 7269 6174 6520 0d0a 2020 2020 2020  opriate ..      
-0000b110: 2064 6174 6120 666f 7220 636f 7272 6563   data for correc
-0000b120: 7469 6f6e 2e20 4465 6661 756c 7420 6973  tion. Default is
-0000b130: 2060 6078 7960 602e 0d0a 2020 2020 2020   ``xy``...      
-0000b140: 200d 0a20 2020 206d 6f64 653a 2073 7472   ..    mode: str
-0000b150: 200d 0a20 2020 2020 2020 206d 6f64 6520   ..        mode 
-0000b160: 6f66 2074 6865 2062 6f72 6465 7220 7472  of the border tr
-0000b170: 696d 6d69 6e67 2e20 5368 6f75 6c64 2062  imming. Should b
-0000b180: 6520 2776 616c 6964 2720 6f72 2027 7361  e 'valid' or 'sa
-0000b190: 6d65 272e 2776 616c 6964 2720 6973 2075  me'.'valid' is u
-0000b1a0: 7365 6420 0d0a 2020 2020 2020 2020 666f  sed ..        fo
-0000b1b0: 7220 7265 6775 6c61 7220 7472 696d 696d  r regular trimim
-0000b1c0: 6720 7768 6572 6561 7320 7468 6520 2773  g whereas the 's
-0000b1d0: 616d 6527 2069 7320 7573 6564 2066 6f72  ame' is used for
-0000b1e0: 2061 7070 656e 6469 6e67 2074 6865 2066   appending the f
-0000b1f0: 6972 7374 0d0a 2020 2020 2020 2020 616e  irst..        an
-0000b200: 6420 6c61 7374 2076 616c 7565 206f 6620  d last value of 
-0000b210: 7265 7369 7374 6976 6974 792e 2041 6e79  resistivity. Any
-0000b220: 206f 7468 6572 2061 7267 756d 656e 7420   other argument 
-0000b230: 6578 6365 7074 2027 7661 6c69 6427 2073  except 'valid' s
-0000b240: 686f 756c 6420 0d0a 2020 2020 2020 2020  hould ..        
-0000b250: 6265 2063 6f6e 7369 6465 7265 6420 6173  be considered as
-0000b260: 2027 7361 6d65 2720 6172 6775 6d65 6e74   'same' argument
-0000b270: 2e20 4465 6661 756c 7420 6973 2060 6073  . Default is ``s
-0000b280: 616d 6560 602e 2020 2020 200d 0a20 2020  ame``.     ..   
-0000b290: 2020 2020 0d0a 2020 2020 6d65 7468 6f64      ..    method
-0000b2a0: 3a20 7374 722c 2064 6566 6175 6c74 2060  : str, default `
-0000b2b0: 6073 6c69 6e65 6172 6060 0d0a 2020 2020  `slinear``..    
-0000b2c0: 2020 2020 496e 7465 7270 6f6c 6174 696f      Interpolatio
-0000b2d0: 6e20 7465 6368 6e69 7175 6520 746f 2075  n technique to u
-0000b2e0: 7365 2e20 4361 6e20 616c 736f 2062 6520  se. Can also be 
-0000b2f0: 6060 6e65 6172 6573 7460 602e 2052 6566  ``nearest``. Ref
-0000b300: 6572 2074 6f20 0d0a 2020 2020 2020 2020  er to ..        
-0000b310: 7468 6520 646f 6375 6d65 6e74 6174 696f  the documentatio
-0000b320: 6e20 6f66 203a 6675 6e63 3a60 7e2e 696e  n of :func:`~.in
-0000b330: 7465 7270 6f6c 6174 6532 6460 2e20 0d0a  terpolate2d`. ..
-0000b340: 2020 2020 2020 2020 0d0a 2020 2020 6f75          ..    ou
-0000b350: 7420 3a20 7374 7220 0d0a 2020 2020 2020  t : str ..      
-0000b360: 2020 5661 6c75 6520 746f 2065 7870 6f72    Value to expor
-0000b370: 742e 2043 616e 2062 6520 6060 7366 6163  t. Can be ``sfac
-0000b380: 746f 7260 602c 2060 6074 656e 736f 7260  tor``, ``tensor`
-0000b390: 6020 666f 7220 636f 7272 6563 7469 6f6e  ` for correction
-0000b3a0: 7320 6661 6374 6f72 200d 0a20 2020 2020  s factor ..     
-0000b3b0: 2020 2061 6e64 2069 6d70 6564 616e 6365     and impedance
-0000b3c0: 2074 656e 736f 722e 2041 6e79 206f 7468   tensor. Any oth
-0000b3d0: 6572 2076 616c 7565 7320 7769 6c6c 2065  er values will e
-0000b3e0: 7870 6f72 7420 7468 6520 7374 6174 6963  xport the static
-0000b3f0: 2063 6f72 7265 6374 6564 2020 0d0a 2020   corrected  ..  
-0000b400: 2020 2020 2020 7265 7369 7374 6976 6974        resistivit
-0000b410: 792e 200d 0a20 2020 2020 2020 200d 0a20  y. ..        .. 
-0000b420: 2020 2063 203a 2069 6e74 2c20 0d0a 2020     c : int, ..  
-0000b430: 2020 2020 2020 4120 7769 6e64 6f77 2d77        A window-w
-0000b440: 6964 7468 2065 7870 616e 7369 6f6e 2066  idth expansion f
-0000b450: 6163 746f 7220 7468 6174 206d 7573 7420  actor that must 
-0000b460: 6265 2069 6e70 7574 2074 6f20 7468 6520  be input to the 
-0000b470: 6669 6c74 6572 200d 0a20 2020 2020 2020  filter ..       
-0000b480: 2061 6461 7074 6174 696f 6e20 7072 6f63   adaptation proc
-0000b490: 6573 7320 746f 2063 6f6e 7472 6f6c 2074  ess to control t
-0000b4a0: 6865 2072 6f6c 6c2d 6f66 6620 6368 6172  he roll-off char
-0000b4b0: 6163 7465 7269 7374 6963 730d 0a20 2020  acteristics..   
-0000b4c0: 2020 2020 206f 6620 7468 6520 6170 706c       of the appl
-0000b4d0: 6965 6420 4861 6e6e 696e 6720 7769 6e64  ied Hanning wind
-0000b4e0: 6f77 2e20 4974 2069 7320 7265 636f 6d6d  ow. It is recomm
-0000b4f0: 656e 6465 6420 746f 2073 656c 6563 7420  ended to select 
-0000b500: 6063 6020 6265 7477 6565 6e20 0d0a 2020  `c` between ..  
-0000b510: 2020 2020 2020 6060 3160 6020 2061 6e64        ``1``  and
-0000b520: 2060 6034 6060 2e20 2044 6566 6175 6c74   ``4``.  Default
-0000b530: 2069 7320 6060 3260 602e 200d 0a0d 0a20   is ``2``. .... 
-0000b540: 2020 2045 7861 6d70 6c65 7320 0d0a 2020     Examples ..  
-0000b550: 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020    --------..    
-0000b560: 3e3e 3e20 696d 706f 7274 206d 6174 706c  >>> import matpl
-0000b570: 6f74 6c69 622e 7079 706c 6f74 2061 7320  otlib.pyplot as 
-0000b580: 706c 7420 0d0a 2020 2020 3e3e 3e20 6672  plt ..    >>> fr
-0000b590: 6f6d 2077 6174 6578 2e6d 6574 686f 6473  om watex.methods
-0000b5a0: 2e65 6d20 696d 706f 7274 2050 726f 6365  .em import Proce
-0000b5b0: 7373 696e 6720 0d0a 2020 2020 3e3e 3e20  ssing ..    >>> 
-0000b5c0: 6564 6970 6174 6820 3d20 2764 6174 612f  edipath = 'data/
-0000b5d0: 6564 6973 270d 0a20 2020 203e 3e3e 2070  edis'..    >>> p
-0000b5e0: 203d 2050 726f 6365 7373 696e 6728 292e   = Processing().
-0000b5f0: 6669 7428 6564 6970 6174 6829 200d 0a20  fit(edipath) .. 
-0000b600: 2020 203e 3e3e 2070 2e77 696e 646f 775f     >>> p.window_
-0000b610: 7369 7a65 203d 3220 0d0a 2020 2020 3e3e  size =2 ..    >>
-0000b620: 3e20 702e 636f 6d70 6f6e 656e 7420 3d27  > p.component ='
-0000b630: 7978 270d 0a20 2020 203e 3e3e 2072 633d  yx'..    >>> rc=
-0000b640: 2070 2e74 6d61 2829 0d0a 2020 2020 3e3e   p.tma()..    >>
-0000b650: 3e20 2320 6765 7420 7468 6520 7265 7369  > # get the resi
-0000b660: 7374 6976 7920 7661 6c75 6520 6f66 2074  stivy value of t
-0000b670: 6865 2074 6869 7264 2066 7265 7175 656e  he third frequen
-0000b680: 6379 2020 6174 2061 6c6c 2073 7461 7469  cy  at all stati
-0000b690: 6f6e 7320 0d0a 2020 2020 3e3e 3e20 702e  ons ..    >>> p.
-0000b6a0: 7265 7332 645f 5b33 2c20 3a5d 2020 0d0a  res2d_[3, :]  ..
-0000b6b0: 2020 2020 2e2e 2e20 6172 7261 7928 5b20      ... array([ 
-0000b6c0: 3434 372e 3035 3432 3330 3031 2c20 3130  447.05423001, 10
-0000b6d0: 3136 2e35 3433 3532 3935 342c 2031 3431  16.54352954, 141
-0000b6e0: 352e 3930 3939 3231 3839 2c20 2035 3336  5.90992189,  536
-0000b6f0: 2e35 3432 3933 3939 342c 0d0a 2020 2020  .54293994,..    
-0000b700: 2020 2020 2020 2031 3330 372e 3834 3435         1307.8445
-0000b710: 3630 3336 2c20 2020 3635 2e34 3438 3036  6036,   65.44806
-0000b720: 3639 382c 2020 2038 362e 3636 3831 3737  698,   86.668177
-0000b730: 3931 2c20 2032 3431 2e37 3635 3932 3237  91,  241.7659227
-0000b740: 332c 0d0a 2020 2020 2020 2020 2020 202e  3,..           .
-0000b750: 2e2e 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0000b760: 3234 382e 3239 3037 3730 3339 2c20 2032  248.29077039,  2
-0000b770: 3437 2e37 3134 3532 3731 322c 2020 2031  47.71452712,   1
-0000b780: 372e 3033 3838 3834 3134 5d29 0d0a 2020  7.03888414])..  
-0000b790: 2020 3e3e 3e20 2023 2067 6574 2074 6865    >>>  # get the
-0000b7a0: 2072 6573 6973 7469 7669 7479 2076 616c   resistivity val
-0000b7b0: 7565 2063 6f72 7265 6374 6564 2061 7420  ue corrected at 
-0000b7c0: 7468 6520 7468 6972 6420 6672 6571 7565  the third freque
-0000b7d0: 6e63 7920 0d0a 2020 2020 3e3e 3e20 7263  ncy ..    >>> rc
-0000b7e0: 205b 332c 203a 5d0d 0a20 2020 202e 2e2e   [3, :]..    ...
-0000b7f0: 2061 7272 6179 285b 2034 3437 2e30 3534   array([ 447.054
-0000b800: 3233 3030 312c 2020 3736 332e 3932 3431  23001,  763.9241
-0000b810: 3637 3638 2c20 2039 3239 2e33 3338 3337  6768,  929.33837
-0000b820: 3334 392c 2020 3838 312e 3439 3939 3230  349,  881.499920
-0000b830: 3931 2c0d 0a20 2020 2020 2020 2020 2020  91,..           
-0000b840: 2034 3034 2e39 3333 3832 3136 332c 2020   404.93382163,  
-0000b850: 3139 302e 3538 3236 3431 3531 2c20 2031  190.58264151,  1
-0000b860: 3630 2e37 3139 3137 3635 342c 2020 3136  60.71917654,  16
-0000b870: 332e 3330 3033 3438 3735 2c0d 0a20 2020  3.30034875,..   
-0000b880: 2020 2020 2020 2020 2033 3934 2e32 3732           394.272
-0000b890: 3730 3932 202c 2020 3637 392e 3731 3534  7092 ,  679.7154
-0000b8a0: 3238 3131 2c20 2039 3533 2e32 3739 3635  2811,  953.27965
-0000b8b0: 3637 202c 2031 3231 322e 3432 3838 3339  67 , 1212.428839
-0000b8c0: 3434 2c0d 0a20 2020 2020 2020 2020 2020  44,..           
-0000b8d0: 202e 2e2e 0d0a 2020 2020 2020 2020 2020   .....          
-0000b8e0: 2020 3136 342e 3538 3238 3238 3636 2c20    164.58282866, 
-0000b8f0: 2020 3936 2e36 3030 3832 3135 392c 2020    96.60082159,  
-0000b900: 2031 372e 3033 3838 3834 3134 5d29 0d0a   17.03888414])..
-0000b910: 2020 2020 3e3e 3e20 706c 742e 7365 6d69      >>> plt.semi
-0000b920: 6c6f 6779 2028 6e70 2e61 7261 6e67 6520  logy (np.arange 
-0000b930: 2870 2e72 6573 3264 5f2e 7368 6170 655b  (p.res2d_.shape[
-0000b940: 315d 2029 2c20 702e 7265 7332 645f 5b33  1] ), p.res2d_[3
-0000b950: 2c20 3a5d 2c20 272d 2d27 2c0d 0a20 2020  , :], '--',..   
-0000b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b970: 2020 206e 702e 6172 616e 6765 2028 702e     np.arange (p.
-0000b980: 7265 7332 645f 2e73 6861 7065 5b31 5d20  res2d_.shape[1] 
-0000b990: 292c 2072 635b 332c 203a 5d2c 2027 6f6b  ), rc[3, :], 'ok
-0000b9a0: 2d2d 2729 0d0a 200d 0a20 2020 2052 6566  --').. ..    Ref
-0000b9b0: 6572 656e 6365 7320 0d0a 2020 2020 2d2d  erences ..    --
-0000b9c0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 202e  ---------..    .
-0000b9d0: 2e20 5b31 5d20 6874 7470 3a2f 2f77 7777  . [1] http://www
-0000b9e0: 2e7a 6f6e 6765 2e63 6f6d 2f6c 6567 6163  .zonge.com/legac
-0000b9f0: 792f 5044 465f 4461 7450 726f 2f41 7374  y/PDF_DatPro/Ast
-0000ba00: 6174 6963 2e70 6466 0d0a 2020 2020 2020  atic.pdf..      
-0000ba10: 2020 0d0a 2020 2020 2222 220d 0a20 2020    ..    """..   
-0000ba20: 200d 0a20 2020 2064 6566 205f 5f69 6e69   ..    def __ini
-0000ba30: 745f 5f28 0d0a 2020 2020 2020 2020 7365  t__(..        se
-0000ba40: 6c66 2c0d 0a20 2020 2020 2020 2077 696e  lf,..        win
-0000ba50: 646f 775f 7369 7a65 3a69 6e74 203d 352c  dow_size:int =5,
-0000ba60: 200d 0a20 2020 2020 2020 2063 6f6d 706f   ..        compo
-0000ba70: 6e65 6e74 3a73 7472 203d 2778 7927 2c20  nent:str ='xy', 
-0000ba80: 0d0a 2020 2020 2020 2020 6d6f 6465 3a20  ..        mode: 
-0000ba90: 7374 7220 3d27 7361 6d65 272c 200d 0a20  str ='same', .. 
-0000baa0: 2020 2020 2020 206d 6574 686f 643a 7374         method:st
-0000bab0: 7220 3d27 736c 696e 6561 7227 2c20 0d0a  r ='slinear', ..
-0000bac0: 2020 2020 2020 2020 6f75 743a 7374 7220          out:str 
-0000bad0: 203d 2773 7268 6f27 2c20 0d0a 2020 2020   ='srho', ..    
-0000bae0: 2020 2020 633a 2069 6e74 203d 322c 200d      c: int =2, .
-0000baf0: 0a20 2020 2020 2020 202a 2a6b 7773 0d0a  .        **kws..
-0000bb00: 2020 2020 2020 2020 293a 200d 0a20 2020          ): ..   
-0000bb10: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
-0000bb20: 6e69 745f 5f28 2a2a 6b77 7329 0d0a 2020  nit__(**kws)..  
-0000bb30: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000bb40: 7365 6c66 2e5f 6c6f 6767 696e 673d 2077  self._logging= w
-0000bb50: 6174 6578 6c6f 672e 6765 745f 7761 7465  atexlog.get_wate
-0000bb60: 785f 6c6f 6767 6572 2873 656c 662e 5f5f  x_logger(self.__
-0000bb70: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
-0000bb80: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0000bb90: 7769 6e64 6f77 5f73 697a 653d 7769 6e64  window_size=wind
-0000bba0: 6f77 5f73 697a 6520 0d0a 2020 2020 2020  ow_size ..      
-0000bbb0: 2020 7365 6c66 2e63 6f6d 706f 6e65 6e74    self.component
-0000bbc0: 3d63 6f6d 706f 6e65 6e74 200d 0a20 2020  =component ..   
-0000bbd0: 2020 2020 2073 656c 662e 6d6f 6465 3d6d       self.mode=m
-0000bbe0: 6f64 6520 0d0a 2020 2020 2020 2020 7365  ode ..        se
-0000bbf0: 6c66 2e6d 6574 686f 643d 6d65 7468 6f64  lf.method=method
-0000bc00: 200d 0a20 2020 2020 2020 2073 656c 662e   ..        self.
-0000bc10: 6f75 743d 6f75 7420 0d0a 2020 2020 2020  out=out ..      
-0000bc20: 2020 7365 6c66 2e63 3d63 0d0a 2020 2020    self.c=c..    
-0000bc30: 2020 2020 0d0a 0d0a 2020 2020 6465 6620      ....    def 
-0000bc40: 746d 6120 280d 0a20 2020 2020 2020 2073  tma (..        s
-0000bc50: 656c 662c 0d0a 2020 2020 2020 2020 736d  elf,..        sm
-0000bc60: 6f6f 7468 3a20 626f 6f6c 203d 2054 7275  ooth: bool = Tru
-0000bc70: 652c 200d 0a20 2020 2020 2020 2064 726f  e, ..        dro
-0000bc80: 705f 6f75 746c 6965 7273 3a62 6f6f 6c20  p_outliers:bool 
-0000bc90: 3d20 5472 7565 2c20 0d0a 2020 2020 2020  = True, ..      
-0000bca0: 2020 7265 7475 726e 5f70 6869 3a62 6f6f    return_phi:boo
-0000bcb0: 6c20 3d46 616c 7365 2c20 0d0a 2020 2020  l =False, ..    
-0000bcc0: 2920 3a0d 0a20 2020 2020 2020 200d 0a20  ) :..        .. 
-0000bcd0: 2020 2020 2020 2022 2222 2041 2074 7269         """ A tri
-0000bce0: 6d6d 6564 2d6d 6f76 696e 672d 6176 6572  mmed-moving-aver
-0000bcf0: 6167 6520 6669 6c74 6572 2074 6f20 6573  age filter to es
-0000bd00: 7469 6d61 7465 2061 7665 7261 6765 2061  timate average a
-0000bd10: 7070 6172 656e 740d 0a20 2020 2020 2020  pparent..       
-0000bd20: 2072 6573 6973 7469 7669 7469 6573 2061   resistivities a
-0000bd30: 7420 6120 7369 6e67 6c65 2073 7461 7469  t a single stati
-0000bd40: 632d 636f 7272 6563 7469 6f6e 2d72 6566  c-correction-ref
-0000bd50: 6572 656e 6365 2066 7265 7175 656e 6379  erence frequency
-0000bd60: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
-0000bd70: 2020 2020 2020 5468 6520 544d 4120 6669        The TMA fi
-0000bd80: 6c74 6572 206f 7074 696f 6e20 6573 7469  lter option esti
-0000bd90: 6d61 7465 7320 6e65 6172 2d73 7572 6661  mates near-surfa
-0000bda0: 6365 2072 6573 6973 7469 7669 7469 6573  ce resistivities
-0000bdb0: 2062 7920 6176 6572 6167 696e 670d 0a20   by averaging.. 
-0000bdc0: 2020 2020 2020 2061 7070 6172 656e 7420         apparent 
-0000bdd0: 7265 7369 7374 6976 6974 6965 7320 616c  resistivities al
-0000bde0: 6f6e 6720 6c69 6e65 2061 7420 7468 6520  ong line at the 
-0000bdf0: 7365 6c65 6374 6564 2073 7461 7469 632d  selected static-
-0000be00: 636f 7272 6563 7469 6f6e 200d 0a20 2020  correction ..   
-0000be10: 2020 2020 2072 6566 6572 656e 6365 2066       reference f
-0000be20: 7265 7175 656e 6379 2e20 5468 6520 6869  requency. The hi
-0000be30: 6768 6573 7420 6672 6571 7565 6e63 7920  ghest frequency 
-0000be40: 7769 7468 2063 6c65 616e 2064 6174 6120  with clean data 
-0000be50: 7368 6f75 6c64 2062 6520 0d0a 2020 2020  should be ..    
-0000be60: 2020 2020 7365 6c65 6374 6564 2061 7320      selected as 
-0000be70: 7468 6520 7265 6665 7265 6e63 6520 6672  the reference fr
-0000be80: 6571 7565 6e63 792e 0d0a 2020 2020 2020  equency...      
-0000be90: 2020 0d0a 2020 2020 2020 2020 5061 7261    ..        Para
-0000bea0: 6d65 7465 7273 200d 0a20 2020 2020 2020  meters ..       
-0000beb0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-0000bec0: 2020 2020 2073 6d6f 6f74 683a 2062 6f6f       smooth: boo
-0000bed0: 6c2c 2064 6566 6175 6c74 3d54 7275 652c  l, default=True,
-0000bee0: 200d 0a20 2020 2020 2020 2020 2020 536d   ..           Sm
-0000bef0: 6f6f 7468 2074 6865 2074 656e 736f 7220  ooth the tensor 
-0000bf00: 6461 7461 2061 6c6f 6e67 2074 6865 2066  data along the f
-0000bf10: 7265 7175 656e 6369 6573 2e20 0d0a 2020  requencies. ..  
-0000bf20: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000bf30: 6472 6f70 5f6f 7574 6c69 6572 733a 2062  drop_outliers: b
-0000bf40: 6f6f 6c2c 2064 6566 6175 6c74 3d54 7275  ool, default=Tru
-0000bf50: 6520 0d0a 2020 2020 2020 2020 2020 2053  e ..           S
-0000bf60: 7570 7072 6573 7320 6f75 746c 6965 7273  uppress outliers
-0000bf70: 2069 6e20 7468 6520 6461 7461 2077 6865   in the data whe
-0000bf80: 6e20 736d 6f6f 7468 696e 6720 6461 7461  n smoothing data
-0000bf90: 2061 6c6f 6e67 200d 0a20 2020 2020 2020   along ..       
-0000bfa0: 2020 2020 7468 6520 6672 6571 7565 6e63      the frequenc
-0000bfb0: 6965 7320 6178 6973 2e20 4e6f 7465 2074  ies axis. Note t
-0000bfc0: 6861 7420 6064 726f 705f 6f75 746c 6965  hat `drop_outlie
-0000bfd0: 7273 6020 646f 6573 206e 6f74 2074 616b  rs` does not tak
-0000bfe0: 6520 0d0a 2020 2020 2020 2020 2020 2065  e ..           e
-0000bff0: 6666 6563 7420 6966 2060 736d 6f6f 7468  ffect if `smooth
-0000c000: 6020 6973 2060 6046 616c 7365 6060 2e20  ` is ``False``. 
-0000c010: 0d0a 2020 2020 2020 2020 2020 200d 0a20  ..           .. 
-0000c020: 2020 2020 2020 2072 6574 7572 6e5f 7068         return_ph
-0000c030: 693a 2062 6f6f 6c2c 2064 6566 6175 6c74  i: bool, default
-0000c040: 3d46 616c 7365 2c20 0d0a 2020 2020 2020  =False, ..      
-0000c050: 2020 2020 2072 6574 7572 6e20 636f 7272       return corr
-0000c060: 6563 7465 6420 7068 6173 6520 696e 2064  ected phase in d
-0000c070: 6567 7265 6573 2e20 4d6f 7374 6c79 2074  egrees. Mostly t
-0000c080: 6865 2070 6861 7365 2064 6f65 7320 6e6f  he phase does no
-0000c090: 7420 6e65 6564 200d 0a20 2020 2020 2020  t need ..       
-0000c0a0: 2020 2020 746f 2063 6f72 7265 6374 2073      to correct s
-0000c0b0: 696e 6365 2069 7420 6973 206e 6f74 2061  ince it is not a
-0000c0c0: 6666 6563 7465 6420 6279 2074 6865 2073  ffected by the s
-0000c0d0: 7461 7469 6320 7368 6966 7420 6566 6665  tatic shift effe
-0000c0e0: 6374 2e20 0d0a 2020 2020 2020 2020 2020  ct. ..          
-0000c0f0: 2048 6f77 6576 6572 2c20 6974 2063 616e   However, it can
-0000c100: 2062 6520 6173 2073 6d6f 6f74 6820 7068   be as smooth ph
-0000c110: 6173 6520 6375 7276 6520 7768 656e 2060  ase curve when `
-0000c120: 6073 6d6f 6f74 683d 5472 7565 6060 0d0a  `smooth=True``..
-0000c130: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000c140: 2e2e 2076 6572 7369 6f6e 6164 6465 643a  .. versionadded:
-0000c150: 3a20 302e 322e 3120 0d0a 2020 2020 2020  : 0.2.1 ..      
-0000c160: 2020 2020 2050 6f6c 6973 6820 7468 6520       Polish the 
-0000c170: 7465 6e73 6f72 2064 6174 6120 616c 6f6e  tensor data alon
-0000c180: 6720 7468 6520 6672 6571 7565 6e63 7920  g the frequency 
-0000c190: 6178 6973 2072 656d 6f76 6520 6e6f 6973  axis remove nois
-0000c1a0: 6573 200d 0a20 2020 2020 2020 2020 2020  es ..           
-0000c1b0: 616e 6420 6465 616c 2077 6974 6820 7468  and deal with th
-0000c1c0: 6520 7374 6174 6963 2073 6869 6674 2065  e static shift e
-0000c1d0: 6666 6563 7420 7768 656e 2069 6e74 6572  ffect when inter
-0000c1e0: 6665 7265 6e63 6573 206e 6f69 7365 7320  ferences noises 
-0000c1f0: 0d0a 2020 2020 2020 2020 2020 2061 7265  ..           are
-0000c200: 2073 7472 6f6e 6720 656e 6f75 6768 2e20   strong enough. 
-0000c210: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0000c220: 2020 2020 5265 7475 726e 7320 0d0a 2020      Returns ..  
-0000c230: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-0000c240: 2020 2020 2020 2072 633a 206e 702e 6e64         rc: np.nd
-0000c250: 6172 7261 792c 2073 6861 7065 2020 284e  array, shape  (N
-0000c260: 2c20 4d29 0d0a 2020 2020 2020 2020 2020  , M)..          
-0000c270: 2020 454d 4150 2061 7070 6172 656e 7420    EMAP apparent 
-0000c280: 2072 6573 6973 7469 7669 7479 2073 7461   resistivity sta
-0000c290: 7469 6320 7368 6966 7420 636f 7272 6563  tic shift correc
-0000c2a0: 7465 6420 6f72 2073 7461 7469 6320 0d0a  ted or static ..
-0000c2b0: 2020 2020 2020 2020 2020 2020 636f 7272              corr
-0000c2c0: 6563 7469 6f6e 2066 6163 746f 7220 6f72  ection factor or
-0000c2d0: 2069 6d70 6564 616e 6365 2074 656e 736f   impedance tenso
-0000c2e0: 722e 0d0a 2020 2020 2020 2020 2020 2020  r...            
-0000c2f0: 0d0a 2020 2020 2020 2020 7263 2c20 7068  ..        rc, ph
-0000c300: 695f 633a 2054 7570 6c65 206f 6620 7368  i_c: Tuple of sh
-0000c310: 6170 6520 284e 2c20 4e29 200d 0a20 2020  ape (N, N) ..   
-0000c320: 2020 2020 2020 2020 454d 4150 2061 7070          EMAP app
-0000c330: 6172 656e 7420 7265 7369 7374 6976 6974  arent resistivit
-0000c340: 7920 616e 6420 7068 6173 6520 636f 7272  y and phase corr
-0000c350: 6563 7465 642e 200d 0a0d 0a20 2020 2020  ected. ....     
-0000c360: 2020 2045 7861 6d70 6c65 0d0a 2020 2020     Example..    
-0000c370: 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020      --------..  
-0000c380: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-0000c390: 2077 6174 6578 2061 7320 7778 0d0a 2020   watex as wx..  
-0000c3a0: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-0000c3b0: 206d 6174 706c 6f74 6c69 622e 7079 706c   matplotlib.pypl
-0000c3c0: 6f74 2061 7320 706c 7420 0d0a 2020 2020  ot as plt ..    
-0000c3d0: 2020 2020 3e3e 3e20 6564 695f 6461 7461      >>> edi_data
-0000c3e0: 203d 2077 782e 6665 7463 685f 6461 7461   = wx.fetch_data
-0000c3f0: 2028 2765 6469 7327 2c20 6173 5f66 7261   ('edis', as_fra
-0000c400: 6d65 203d 5472 7565 2c20 6b65 7920 3d27  me =True, key ='
-0000c410: 6564 6927 290d 0a20 2020 2020 2020 203e  edi')..        >
-0000c420: 3e3e 2070 203d 2077 782e 454d 5072 6f63  >> p = wx.EMProc
-0000c430: 6573 7369 6e67 2028 6f75 743d 277a 2729  essing (out='z')
-0000c440: 2e66 6974 2865 6469 5f64 6174 612e 6564  .fit(edi_data.ed
-0000c450: 6929 200d 0a20 2020 2020 2020 203e 3e3e  i) ..        >>>
-0000c460: 207a 5f63 6f72 7265 6374 6564 203d 2070   z_corrected = p
-0000c470: 2e74 6d61 2028 2920 2320 6f75 7470 7574  .tma () # output
-0000c480: 207a 2069 6e20 636f 6d70 6c65 7820 6474   z in complex dt
-0000c490: 7970 6520 0d0a 2020 2020 2020 2020 3e3e  ype ..        >>
-0000c4a0: 3e20 706c 742e 706c 6f74 2028 6e70 2e61  > plt.plot (np.a
-0000c4b0: 7261 6e67 6520 286c 656e 2870 2e65 6469  range (len(p.edi
-0000c4c0: 4f62 6a73 5f29 2920 2c20 6e70 2e61 6273  Objs_)) , np.abs
-0000c4d0: 2820 0d0a 2020 2020 2020 2020 2020 2020  ( ..            
-0000c4e0: 5b20 6564 696f 626a 2e5a 2e7a 5b3a 2c20  [ ediobj.Z.z[:, 
-0000c4f0: 302c 2031 5d5b 375d 2020 666f 7220 6564  0, 1][7]  for ed
-0000c500: 696f 626a 2069 6e20 702e 6564 694f 626a  iobj in p.ediObj
-0000c510: 735f 5d29 202c 2027 2d6f 6b27 2c0d 0a20  s_]) , '-ok',.. 
-0000c520: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-0000c530: 616e 6765 286c 656e 2870 2e65 6469 4f62  ange(len(p.ediOb
-0000c540: 6a73 5f29 292c 206e 702e 6162 7328 207a  js_)), np.abs( z
-0000c550: 5f63 6f72 7265 6374 6564 5b37 2c3a 205d  _corrected[7,: ]
-0000c560: 2920 2c20 276f 722d 2729 0d0a 2020 2020  ) , 'or-')..    
-0000c570: 2020 2020 0d0a 2020 2020 2020 2020 5265      ..        Re
-0000c580: 6665 7265 6e63 6573 200d 0a20 2020 2020  ferences ..     
-0000c590: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a     -----------..
-0000c5a0: 2020 2020 2020 2020 2e2e 205b 315d 2068          .. [1] h
-0000c5b0: 7474 703a 2f2f 7777 772e 7a6f 6e67 652e  ttp://www.zonge.
-0000c5c0: 636f 6d2f 6c65 6761 6379 2f50 4446 5f44  com/legacy/PDF_D
-0000c5d0: 6174 5072 6f2f 4173 7461 7469 632e 7064  atPro/Astatic.pd
-0000c5e0: 660d 0a20 2020 2020 2020 200d 0a20 2020  f..        ..   
-0000c5f0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-0000c600: 2020 7365 6c66 2e69 6e73 7065 6374 0d0a    self.inspect..
-0000c610: 2020 2020 2020 2020 2320 6173 7365 7274          # assert
-0000c620: 2066 696c 7465 7220 6172 6775 6d65 6e74   filter argument
-0000c630: 7320 0d0a 2020 2020 2020 2020 7365 6c66  s ..        self
-0000c640: 2e72 6573 3264 5f20 2c20 7365 6c66 2e70  .res2d_ , self.p
-0000c650: 6873 3264 5f20 2c20 7365 6c66 2e66 7265  hs2d_ , self.fre
-0000c660: 7173 5f2c 2073 656c 662e 632c 2073 656c  qs_, self.c, sel
-0000c670: 662e 7769 6e64 6f77 5f73 697a 652c 205c  f.window_size, \
-0000c680: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0000c690: 6c66 2e63 6f6d 706f 6e65 6e74 2c20 7365  lf.component, se
-0000c6a0: 6c66 2e6f 7574 203d 2073 656c 662e 5f6d  lf.out = self._m
-0000c6b0: 616b 6532 6462 6c6f 6273 2028 290d 0a20  ake2dblobs ().. 
-0000c6c0: 0d0a 2020 2020 2020 2020 2320 2069 6e74  ..        #  int
-0000c6d0: 6572 706f 6c61 7465 2072 6573 6973 7469  erpolate resisti
-0000c6e0: 7669 7479 2061 6e64 2070 6861 7365 7320  vity and phases 
-0000c6f0: 0d0a 2020 2020 2020 2020 7365 6c66 2e70  ..        self.p
-0000c700: 6873 3264 5f3d 2069 6e74 6572 706f 6c61  hs2d_= interpola
-0000c710: 7465 3264 280d 0a20 2020 2020 2020 2020  te2d(..         
-0000c720: 2020 2073 656c 662e 7068 7332 645f 2c20     self.phs2d_, 
-0000c730: 6d65 7468 6f64 203d 7365 6c66 2e6d 6574  method =self.met
-0000c740: 686f 6429 0d0a 2020 2020 2020 2020 7365  hod)..        se
-0000c750: 6c66 2e72 6573 3264 5f3d 2069 6e74 6572  lf.res2d_= inter
-0000c760: 706f 6c61 7465 3264 280d 0a20 2020 2020  polate2d(..     
-0000c770: 2020 2020 2020 2073 656c 662e 7265 7332         self.res2
-0000c780: 645f 2c20 6d65 7468 6f64 203d 7365 6c66  d_, method =self
-0000c790: 2e6d 6574 686f 6429 0d0a 2020 2020 2020  .method)..      
-0000c7a0: 2020 2320 6765 7420 7468 6520 696e 6465    # get the inde
-0000c7b0: 7820 6f66 2074 6865 2072 6566 6572 656e  x of the referen
-0000c7c0: 6365 2066 7265 7175 656e 6379 2020 616e  ce frequency  an
-0000c7d0: 6420 636f 6c6c 6563 7420 0d0a 2020 2020  d collect ..    
-0000c7e0: 2020 2020 2320 7468 6520 7265 7369 7374      # the resist
-0000c7f0: 6976 6974 7920 616e 6420 7068 6173 6520  ivity and phase 
-0000c800: 6174 2074 6861 7420 6672 6571 7565 6e63  at that frequenc
-0000c810: 7920 0d0a 2020 2020 2020 2020 6978 5f72  y ..        ix_r
-0000c820: 6620 3d20 696e 7428 7265 7368 6170 6520  f = int(reshape 
-0000c830: 286e 702e 6172 6777 6865 7265 2028 7365  (np.argwhere (se
-0000c840: 6c66 2e66 7265 7173 5f3d 3d73 656c 662e  lf.freqs_==self.
-0000c850: 7265 6672 6571 5f29 2929 2020 0d0a 0d0a  refreq_)))  ....
-0000c860: 2020 2020 2020 2020 2320 6e6f 726d 616c          # normal
-0000c870: 697a 6520 6c6f 6720 6672 6571 7565 6e63  ize log frequenc
-0000c880: 7920 616e 6420 7461 6b65 2074 6865 206e  y and take the n
-0000c890: 6f72 6d61 6c69 7a65 2072 6566 2066 7265  ormalize ref fre
-0000c8a0: 7120 0d0a 2020 2020 2020 2020 6e6f 726d  q ..        norm
-0000c8b0: 5f66 203d 2028 6e70 2e6c 6f67 3130 2873  _f = (np.log10(s
-0000c8c0: 656c 662e 6672 6571 735f 2920 2f20 6e70  elf.freqs_) / np
-0000c8d0: 2e6c 696e 616c 672e 6e6f 726d 280d 0a20  .linalg.norm(.. 
-0000c8e0: 2020 2020 2020 2020 2020 206e 702e 6c6f             np.lo
-0000c8f0: 6731 3028 7365 6c66 2e66 7265 7173 5f29  g10(self.freqs_)
-0000c900: 2929 0d0a 2020 2020 2020 2020 2320 636f  ))..        # co
-0000c910: 6d70 7574 6520 7468 6520 736c 6f70 6520  mpute the slope 
-0000c920: 6174 2065 6163 6820 6e6f 726d 616c 697a  at each normaliz
-0000c930: 6520 6672 6571 7565 6e63 7920 0d0a 2020  e frequency ..  
-0000c940: 2020 2020 2020 736c 6f70 6532 6420 3d20        slope2d = 
-0000c950: 6e70 2e61 7263 7461 6e28 2028 6e70 2e64  np.arctan( (np.d
-0000c960: 6567 3272 6164 2873 656c 662e 7068 7332  eg2rad(self.phs2
-0000c970: 645f 2920 2f20 280d 0a20 2020 2020 2020  d_) / (..       
-0000c980: 2020 2020 206e 702e 7069 202f 3420 2929       np.pi /4 ))
-0000c990: 202d 3120 2920 2f20 286e 702e 7069 202f   -1 ) / (np.pi /
-0000c9a0: 3220 290d 0a20 2020 2020 2020 206c 6f67  2 )..        log
-0000c9b0: 5f72 686f 3264 203d 206e 702e 6c6f 6731  _rho2d = np.log1
-0000c9c0: 3020 2873 656c 662e 7265 7332 645f 2920  0 (self.res2d_) 
-0000c9d0: 2b20 6e6f 726d 5f66 5b3a 2c20 4e6f 6e65  + norm_f[:, None
-0000c9e0: 5d20 2a20 736c 6f70 6532 6420 0d0a 2020  ] * slope2d ..  
-0000c9f0: 2020 2020 2020 2320 6578 7472 6170 6f6c        # extrapol
-0000ca00: 6174 6520 7570 200d 0a20 2020 2020 2020  ate up ..       
-0000ca10: 2023 2072 6570 6c61 6365 2074 6865 2075   # replace the u
-0000ca20: 7020 6672 6571 7565 6e63 7920 7468 696e  p frequency thin
-0000ca30: 2074 6865 2069 6e64 6578 206f 6620 7266   the index of rf
-0000ca40: 2062 7920 696e 7465 7270 6f6c 6174 696e   by interpolatin
-0000ca50: 6720 7570 200d 0a20 2020 2020 2020 206c  g up ..        l
-0000ca60: 6f67 5f72 686f 3264 205b 3a69 785f 7266  og_rho2d [:ix_rf
-0000ca70: 2c20 3a5d 203d 206e 702e 6c6f 6731 3020  , :] = np.log10 
-0000ca80: 280d 0a20 2020 2020 2020 2020 2020 2073  (..            s
-0000ca90: 656c 662e 7265 7332 645f 5b3a 6978 5f72  elf.res2d_[:ix_r
-0000caa0: 662c 203a 205d 2920 2b20 6e70 2e6c 6f67  f, : ]) + np.log
-0000cab0: 3130 280d 0a20 2020 2020 2020 2020 2020  10(..           
-0000cac0: 2020 2020 206e 702e 7371 7274 2832 2929       np.sqrt(2))
-0000cad0: 202a 2073 6c6f 7065 3264 5b3a 6978 5f72   * slope2d[:ix_r
-0000cae0: 662c 203a 5d0d 0a20 2020 2020 2020 200d  f, :]..        .
-0000caf0: 0a20 2020 2020 2020 2023 206d 616b 6520  .        # make 
-0000cb00: 616e 2061 7272 6179 206f 6620 7765 6967  an array of weig
-0000cb10: 6874 2066 6163 746f 7220 7766 200d 0a20  ht factor wf .. 
-0000cb20: 2020 2020 2020 2077 6620 3d20 6e70 2e7a         wf = np.z
-0000cb30: 6572 6f73 5f6c 696b 6528 6c6f 675f 7268  eros_like(log_rh
-0000cb40: 6f32 6429 2023 2061 7665 7261 6765 206c  o2d) # average l
-0000cb50: 6f67 6a20 0d0a 2020 2020 2020 2020 2320  ogj ..        # 
-0000cb60: 466f 7220 6561 6368 2073 7461 7469 6f6e  For each station
-0000cb70: 2063 6f6c 6c65 6374 2061 2067 726f 7570   collect a group
-0000cb80: 206f 6620 7769 6e64 6f77 2d73 697a 6520   of window-size 
-0000cb90: 6c6f 6728 726a 2029 2c20 0d0a 2020 2020  log(rj ), ..    
-0000cba0: 2020 2020 2320 2369 2e65 2e20 666f 7220      # #i.e. for 
-0000cbb0: 7769 6e64 6f77 2073 697a 6520 3d35 2073  window size =5 s
-0000cbc0: 7461 7469 6f6e 2069 6e64 6578 206a 2c20  tation index j, 
-0000cbd0: 6920 3d20 6a2d 3220 746f 206a 2b32 2e20  i = j-2 to j+2. 
-0000cbe0: 0d0a 2020 2020 2020 2020 6861 6c66 5f77  ..        half_w
-0000cbf0: 696e 646f 7720 3d20 7365 6c66 2e77 696e  indow = self.win
-0000cc00: 646f 775f 7369 7a65 202f 2f32 200d 0a20  dow_size //2 .. 
-0000cc10: 2020 2020 2020 2066 6f72 2069 6920 696e         for ii in
-0000cc20: 2072 616e 6765 286c 6f67 5f72 686f 3264   range(log_rho2d
-0000cc30: 2e73 6861 7065 5b31 5d29 3a0d 0a20 2020  .shape[1]):..   
-0000cc40: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0000cc50: 2020 2020 2020 2069 6620 6969 203d 3d30         if ii ==0
-0000cc60: 206f 7220 6969 203d 3d6c 6f67 5f72 686f   or ii ==log_rho
-0000cc70: 3264 2e73 6861 7065 5b31 5d20 2d31 3a20  2d.shape[1] -1: 
-0000cc80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000cc90: 2020 7720 3d20 286c 6f67 5f72 686f 3264    w = (log_rho2d
-0000cca0: 5b20 3a2c 203a 6969 202b 2068 616c 665f  [ :, :ii + half_
-0000ccb0: 7769 6e64 6f77 202b 315d 200d 0a20 2020  window +1] ..   
-0000ccc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ccd0: 2020 6966 2020 6969 202d 2068 616c 665f    if  ii - half_
-0000cce0: 7769 6e64 6f77 203c 2030 2065 6c73 6520  window < 0 else 
-0000ccf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000cd00: 2020 2020 2020 206c 6f67 5f72 686f 3264         log_rho2d
-0000cd10: 5b3a 2c20 6969 2d68 616c 665f 7769 6e64  [:, ii-half_wind
-0000cd20: 6f77 3a5d 200d 0a20 2020 2020 2020 2020  ow:] ..         
-0000cd30: 2020 2020 2020 2020 2020 2020 2920 6966              ) if
-0000cd40: 2073 656c 662e 6d6f 6465 203d 3d27 7661   self.mode =='va
-0000cd50: 6c69 6427 2065 6c73 6520 6c6f 675f 7268  lid' else log_rh
-0000cd60: 6f32 645b 3a2c 2069 695d 5b3a 2c20 4e6f  o2d[:, ii][:, No
-0000cd70: 6e65 5d0d 0a20 2020 2020 200d 0a20 2020  ne]..      ..   
-0000cd80: 2020 2020 2020 2020 2065 6c69 6620 6969           elif ii
-0000cd90: 202d 2068 616c 665f 7769 6e64 6f77 203c   - half_window <
-0000cda0: 2030 3a20 0d0a 2020 2020 2020 2020 2020   0: ..          
-0000cdb0: 2020 2020 2020 773d 206c 6f67 5f72 686f        w= log_rho
-0000cdc0: 3264 5b20 3a2c 203a 6969 202b 2068 616c  2d[ :, :ii + hal
-0000cdd0: 665f 7769 6e64 6f77 202b 315d 0d0a 2020  f_window +1]..  
-0000cde0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-0000cdf0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0000ce00: 2069 6920 2b20 6861 6c66 5f77 696e 646f   ii + half_windo
-0000ce10: 7720 2b31 203e 206c 6f67 5f72 686f 3264  w +1 > log_rho2d
-0000ce20: 2e73 6861 7065 5b31 5d3a 200d 0a20 2020  .shape[1]: ..   
-0000ce30: 2020 2020 2020 2020 2020 2020 2077 3d20               w= 
-0000ce40: 6c6f 675f 7268 6f32 645b 3a2c 2069 692d  log_rho2d[:, ii-
-0000ce50: 6861 6c66 5f77 696e 646f 773a 5d0d 0a20  half_window:].. 
-0000ce60: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000ce70: 2065 6c73 6520 3a20 0d0a 2020 2020 2020   else : ..      
-0000ce80: 2020 2020 2020 2020 2020 2320 4469 7363            # Disc
-0000ce90: 6172 6420 7468 6520 6c6f 7765 7374 2061  ard the lowest a
-0000cea0: 6e64 2068 6967 6865 7374 2076 616c 7565  nd highest value
-0000ceb0: 6420 6c6f 6728 726a 2029 200d 0a20 2020  d log(rj ) ..   
-0000cec0: 2020 2020 2020 2020 2020 2020 2023 2066               # f
-0000ced0: 726f 6d20 7468 6520 6772 6f75 7020 6f66  rom the group of
-0000cee0: 2066 6976 6520 616e 6420 6176 6572 6167   five and averag
-0000cef0: 6520 7468 6520 7265 6d61 696e 696e 670d  e the remaining.
-0000cf00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cf10: 2023 2074 6872 6565 203d 3e20 6176 675f   # three => avg_
-0000cf20: 6c6f 676a 2e0d 0a20 2020 2020 2020 2020  logj...         
-0000cf30: 2020 2020 2020 2077 3d20 6c6f 675f 7268         w= log_rh
-0000cf40: 6f32 645b 3a2c 2069 692d 6861 6c66 5f77  o2d[:, ii-half_w
-0000cf50: 696e 646f 7720 3a20 6861 6c66 5f77 696e  indow : half_win
-0000cf60: 646f 7720 2b20 6969 202b 2031 205d 0d0a  dow + ii + 1 ]..
-0000cf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cf80: 7472 7920 3a20 0d0a 2020 2020 2020 2020  try : ..        
-0000cf90: 2020 2020 2020 2020 2020 2020 6c73 203d              ls =
-0000cfa0: 205b 206e 702e 6465 6c65 7465 2028 775b   [ np.delete (w[
-0000cfb0: 6969 2c20 3a5d 202c 206e 702e 7768 6572  ii, :] , np.wher
-0000cfc0: 6520 280d 0a20 2020 2020 2020 2020 2020  e (..           
-0000cfd0: 2020 2020 2020 2020 2020 2020 206e 702e               np.
-0000cfe0: 6c6f 6769 6361 6c5f 6f72 2877 5b69 692c  logical_or(w[ii,
-0000cff0: 203a 5d20 3d3d 775b 6969 2c20 3a5d 2e6d   :] ==w[ii, :].m
-0000d000: 6178 2829 2c0d 0a20 2020 2020 2020 2020  ax(),..         
+0000a0b0: 2220 696e 7465 7270 6f6c 6174 6564 205a  " interpolated Z
+0000a0c0: 2e22 290d 0a20 2020 2020 2020 2020 2020  .")..           
+0000a0d0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0000a0e0: 2020 2020 2020 2065 6469 4f20 3d20 6564         ediO = ed
+0000a0f0: 694f 626a 7320 6966 206f 626a 7479 7065  iObjs if objtype
+0000a100: 3d3d 2745 4449 2765 6c73 6520 6564 694f  =='EDI'else ediO
+0000a110: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a120: 2020 6564 694f 203d 2069 735f 6974 6572    ediO = is_iter
+0000a130: 6162 6c65 280d 0a20 2020 2020 2020 2020  able(..         
+0000a140: 2020 2020 2020 2020 2020 2065 6469 4f20             ediO 
+0000a150: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0000a160: 2020 2020 2020 2020 6578 636c 7564 655f          exclude_
+0000a170: 7374 7269 6e67 203d 5472 7565 2c20 0d0a  string =True, ..
+0000a180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a190: 2020 2020 7472 616e 7366 6f72 6d20 3d54      transform =T
+0000a1a0: 7275 6520 0d0a 2020 2020 2020 2020 2020  rue ..          
+0000a1b0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+0000a1c0: 2020 2020 2020 2020 2020 2020 2061 7373               ass
+0000a1d0: 6572 7420 6c65 6e28 6564 694f 2920 3d3d  ert len(ediO) ==
+0000a1e0: 6c65 6e28 5a63 292c 2028 0d0a 2020 2020  len(Zc), (..    
+0000a1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a200: 2245 4449 2d6f 626a 6563 7473 2061 6e64  "EDI-objects and
+0000a210: 205a 2063 6f6c 6c65 6374 696f 6e20 6d75   Z collection mu
+0000a220: 7374 2062 6520 636f 6e73 6973 7465 6e74  st be consistent
+0000a230: 2e22 0d0a 2020 2020 2020 2020 2020 2020  ."..            
+0000a240: 2020 2020 2020 2020 6622 2047 6f74 207b          f" Got {
+0000a250: 6c65 6e28 6564 694f 297d 2061 6e64 207b  len(ediO)} and {
+0000a260: 6c65 6e28 5a63 297d 2e22 290d 0a20 2020  len(Zc)}.")..   
+0000a270: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+0000a280: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000a290: 656c 662e 6578 706f 7274 6564 6973 280d  elf.exportedis(.
+0000a2a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a2b0: 2020 2020 2065 6469 4f62 6a73 3d65 6469       ediObjs=edi
+0000a2c0: 4f2c 200d 0a20 2020 2020 2020 2020 2020  O, ..           
+0000a2d0: 2020 2020 2020 2020 206e 6577 5f5a 3d5a           new_Z=Z
+0000a2e0: 632c 200d 0a20 2020 2020 2020 2020 2020  c, ..           
+0000a2f0: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
+0000a300: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+0000a310: 2020 2020 2020 2029 200d 0a20 2020 2020         ) ..     
+0000a320: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0000a330: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000a340: 5a63 2069 6620 7365 6c66 2e6f 7074 696f  Zc if self.optio
+0000a350: 6e20 213d 2777 7269 7465 2720 656c 7365  n !='write' else
+0000a360: 204e 6f6e 6520 0d0a 2020 2020 2020 2020   None ..        
+0000a370: 2020 0d0a 2020 2020 2020 2020 7265 7475    ..        retu
+0000a380: 726e 206e 6577 5f66 756e 6320 0d0a 2020  rn new_func ..  
+0000a390: 2020 0d0a 2020 2020 6465 6620 5f6d 616b    ..    def _mak
+0000a3a0: 655f 7a4f 626a 2028 0d0a 2020 2020 2020  e_zObj (..      
+0000a3b0: 2020 7365 6c66 2c20 0d0a 2020 2020 2020    self, ..      
+0000a3c0: 2020 6b6b 3a20 696e 7420 2c0d 0a20 2020    kk: int ,..   
+0000a3d0: 2020 2020 202a 2c20 0d0a 2020 2020 2020       *, ..      
+0000a3e0: 2020 6672 6571 3a20 4172 7261 794c 696b    freq: ArrayLik
+0000a3f0: 655b 4454 7970 655b 666c 6f61 745d 5d2c  e[DType[float]],
+0000a400: 200d 0a20 2020 2020 2020 207a 5f64 6963   ..        z_dic
+0000a410: 743a 2044 6963 745b 7374 722c 204e 4441  t: Dict[str, NDA
+0000a420: 7272 6179 5b44 5479 7065 5b63 6f6d 706c  rray[DType[compl
+0000a430: 6578 5d5d 5d2c 200d 0a20 2020 2020 2020  ex]]], ..       
+0000a440: 2072 6f74 6174 653d 302e 0d0a 2020 2020   rotate=0...    
+0000a450: 2020 2020 292d 3e20 4e44 4172 7261 795b      )-> NDArray[
+0000a460: 4454 7970 655b 636f 6d70 6c65 785d 5d3a  DType[complex]]:
+0000a470: 200d 0a20 2020 2020 2020 2022 2222 204d   ..        """ M
+0000a480: 616b 6520 6e65 7720 5a20 6f62 6a65 6374  ake new Z object
+0000a490: 2066 726f 6d20 6672 6571 7565 6e63 7920   from frequency 
+0000a4a0: 616e 6420 6469 6374 2074 656e 736f 7220  and dict tensor 
+0000a4b0: 636f 6d70 6f6e 656e 7420 5a2e 200d 0a20  component Z. .. 
+0000a4c0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000a4d0: 203a 7061 7261 6d20 6b6b 3a20 696e 7420   :param kk: int 
+0000a4e0: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
+0000a4f0: 6465 7820 6f66 2072 6f75 7469 6e65 2074  dex of routine t
+0000a500: 6f20 7265 7472 6965 7665 2074 6865 2074  o retrieve the t
+0000a510: 656e 736f 7220 6461 7461 2e20 4974 206d  ensor data. It m
+0000a520: 6179 2063 6f72 7265 7370 6f6e 6420 6f66  ay correspond of
+0000a530: 200d 0a20 2020 2020 2020 2020 2020 2074   ..            t
+0000a540: 6865 2073 7461 7469 6f6e 2069 6e64 6578  he station index
+0000a550: 2e20 0d0a 2020 2020 2020 2020 3a70 6172  . ..        :par
+0000a560: 616d 2066 7265 713a 2061 7272 6179 2d6c  am freq: array-l
+0000a570: 696b 6520 0d0a 2020 2020 2020 2020 2020  ike ..          
+0000a580: 2020 6675 6c6c 2066 7265 7175 656e 6379    full frequency
+0000a590: 206f 6620 636f 6d70 6f6e 656e 7420 0d0a   of component ..
+0000a5a0: 2020 2020 2020 2020 3a70 6172 616d 207a          :param z
+0000a5b0: 5f64 6963 743a 2064 6963 742c 200d 0a20  _dict: dict, .. 
+0000a5c0: 2020 2020 2020 2020 2020 2064 6963 7469             dicti
+0000a5d0: 6f6e 6e61 7279 206f 6620 616c 6c20 7465  onnary of all te
+0000a5e0: 6e73 6f72 2063 6f6d 706f 6e65 6e74 2e0d  nsor component..
+0000a5f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000a600: 726f 7461 7465 3a20 666c 6f61 742c 200d  rotate: float, .
+0000a610: 0a20 2020 2020 2020 2020 2041 6e67 6c65  .          Angle
+0000a620: 2074 6f20 726f 7461 7465 2074 6865 2069   to rotate the i
+0000a630: 6d70 6564 616e 6365 2074 656e 736f 7220  mpedance tensor 
+0000a640: 6163 636f 7264 696e 676c 792e 200d 0a0d  accordingly. ...
+0000a650: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+0000a660: 2020 2020 2020 5a20 3d20 454d 7a28 0d0a        Z = EMz(..
+0000a670: 2020 2020 2020 2020 2020 2020 7a5f 6172              z_ar
+0000a680: 7261 793d 6e70 2e7a 6572 6f73 2828 6c65  ray=np.zeros((le
+0000a690: 6e28 6672 6571 2029 2c20 322c 2032 292c  n(freq ), 2, 2),
+0000a6a0: 6474 7970 653d 2763 6f6d 706c 6578 2729  dtype='complex')
+0000a6b0: 2c0d 0a20 2020 2020 2020 2020 2020 207a  ,..            z
+0000a6c0: 5f65 7272 5f61 7272 6179 3d6e 702e 7a65  _err_array=np.ze
+0000a6d0: 726f 7328 286c 656e 2866 7265 7129 2c20  ros((len(freq), 
+0000a6e0: 322c 2032 2929 2c0d 0a20 2020 2020 2020  2, 2)),..       
+0000a6f0: 2020 2020 2066 7265 713d 6672 6571 200d       freq=freq .
+0000a700: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
+0000a710: 2020 2020 2020 2020 7a78 7820 3d20 7a5f          zxx = z_
+0000a720: 6469 6374 2e67 6574 2827 7a78 7827 2920  dict.get('zxx') 
+0000a730: 0d0a 2020 2020 2020 2020 7a78 7920 3d20  ..        zxy = 
+0000a740: 7a5f 6469 6374 2e67 6574 2827 7a78 7927  z_dict.get('zxy'
+0000a750: 2920 0d0a 2020 2020 2020 2020 7a79 7820  ) ..        zyx 
+0000a760: 3d20 7a5f 6469 6374 2e67 6574 2827 7a79  = z_dict.get('zy
+0000a770: 7827 2920 0d0a 2020 2020 2020 2020 7a79  x') ..        zy
+0000a780: 7920 3d20 7a5f 6469 6374 2e67 6574 2827  y = z_dict.get('
+0000a790: 7a79 7927 2920 0d0a 2020 2020 2020 2020  zyy') ..        
+0000a7a0: 2320 646f 6e74 2072 6169 7365 2061 6e79  # dont raise any
+0000a7b0: 2065 7272 6f72 2069 6620 7468 6520 636f   error if the co
+0000a7c0: 6d70 6f6e 656e 7420 0d0a 2020 2020 2020  mponent ..      
+0000a7d0: 2020 2320 646f 6573 206e 6f74 2065 7869    # does not exi
+0000a7e0: 7374 2e0d 0a20 2020 2020 2020 200d 0a20  st...        .. 
+0000a7f0: 2020 2020 2020 2069 6620 7a78 7820 6973         if zxx is
+0000a800: 206e 6f74 204e 6f6e 653a 200d 0a20 2020   not None: ..   
+0000a810: 2020 2020 2020 2020 205a 2e5f 7a5b 3a2c           Z._z[:,
+0000a820: 2030 2c20 2030 5d20 3d20 7265 7368 6170   0,  0] = reshap
+0000a830: 6520 287a 7878 5b3a 2c20 6b6b 5d2c 2031  e (zxx[:, kk], 1
+0000a840: 2920 0d0a 2020 2020 2020 2020 6966 207a  ) ..        if z
+0000a850: 7879 2069 7320 6e6f 7420 4e6f 6e65 3a20  xy is not None: 
+0000a860: 0d0a 2020 2020 2020 2020 2020 2020 5a2e  ..            Z.
+0000a870: 5f7a 5b3a 2c20 302c 2020 315d 203d 2072  _z[:, 0,  1] = r
+0000a880: 6573 6861 7065 2028 7a78 795b 3a2c 206b  eshape (zxy[:, k
+0000a890: 6b5d 2c20 3129 0d0a 2020 2020 2020 2020  k], 1)..        
+0000a8a0: 6966 207a 7978 2069 7320 206e 6f74 204e  if zyx is  not N
+0000a8b0: 6f6e 653a 200d 0a20 2020 2020 2020 2020  one: ..         
+0000a8c0: 2020 205a 2e5f 7a5b 3a2c 2031 2c20 2030     Z._z[:, 1,  0
+0000a8d0: 5d20 3d20 7265 7368 6170 6520 287a 7978  ] = reshape (zyx
+0000a8e0: 5b3a 2c20 6b6b 5d2c 2031 2920 0d0a 2020  [:, kk], 1) ..  
+0000a8f0: 2020 2020 2020 6966 207a 7979 2069 7320        if zyy is 
+0000a900: 6e6f 7420 4e6f 6e65 3a20 0d0a 2020 2020  not None: ..    
+0000a910: 2020 2020 2020 2020 5a2e 5f7a 5b3a 2c20          Z._z[:, 
+0000a920: 312c 2020 315d 203d 2072 6573 6861 7065  1,  1] = reshape
+0000a930: 2028 7a79 795b 3a2c 206b 6b5d 2c20 3129   (zyy[:, kk], 1)
+0000a940: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+0000a950: 2020 2020 2020 2020 2320 7365 7420 7468          # set th
+0000a960: 6520 7a5f 6572 7220 0d0a 2020 2020 2020  e z_err ..      
+0000a970: 2020 7a78 785f 6572 7220 3d20 7a5f 6469    zxx_err = z_di
+0000a980: 6374 2e67 6574 2827 7a78 785f 6572 7227  ct.get('zxx_err'
+0000a990: 2920 0d0a 2020 2020 2020 2020 7a78 795f  ) ..        zxy_
+0000a9a0: 6572 7220 3d20 7a5f 6469 6374 2e67 6574  err = z_dict.get
+0000a9b0: 2827 7a78 795f 6572 7227 2920 0d0a 2020  ('zxy_err') ..  
+0000a9c0: 2020 2020 2020 7a79 785f 6572 7220 3d20        zyx_err = 
+0000a9d0: 7a5f 6469 6374 2e67 6574 2827 7a79 785f  z_dict.get('zyx_
+0000a9e0: 6572 7227 2920 0d0a 2020 2020 2020 2020  err') ..        
+0000a9f0: 7a79 795f 6572 7220 3d20 7a5f 6469 6374  zyy_err = z_dict
+0000aa00: 2e67 6574 2827 7a79 795f 6572 7227 2920  .get('zyy_err') 
+0000aa10: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0000aa20: 2020 2020 6966 207a 7878 5f65 7272 2069      if zxx_err i
+0000aa30: 7320 6e6f 7420 4e6f 6e65 3a20 0d0a 2020  s not None: ..  
+0000aa40: 2020 2020 2020 2020 2020 5a2e 5f7a 5f65            Z._z_e
+0000aa50: 7272 5b3a 2c20 302c 2020 305d 203d 2072  rr[:, 0,  0] = r
+0000aa60: 6573 6861 7065 2028 7a78 785f 6572 725b  eshape (zxx_err[
+0000aa70: 3a2c 206b 6b5d 2c20 3129 200d 0a20 2020  :, kk], 1) ..   
+0000aa80: 2020 2020 2069 6620 7a78 795f 6572 7220       if zxy_err 
+0000aa90: 6973 206e 6f74 204e 6f6e 653a 200d 0a20  is not None: .. 
+0000aaa0: 2020 2020 2020 2020 2020 205a 2e5f 7a5f             Z._z_
+0000aab0: 6572 725b 3a2c 2030 2c20 2031 5d20 3d20  err[:, 0,  1] = 
+0000aac0: 7265 7368 6170 6520 287a 7879 5f65 7272  reshape (zxy_err
+0000aad0: 5b3a 2c20 6b6b 5d2c 2031 290d 0a20 2020  [:, kk], 1)..   
+0000aae0: 2020 2020 2069 6620 7a79 785f 6572 7220       if zyx_err 
+0000aaf0: 6973 206e 6f74 204e 6f6e 653a 200d 0a20  is not None: .. 
+0000ab00: 2020 2020 2020 2020 2020 205a 2e5f 7a5f             Z._z_
+0000ab10: 6572 725b 3a2c 2031 2c20 2030 5d20 3d20  err[:, 1,  0] = 
+0000ab20: 7265 7368 6170 6520 287a 7978 5f65 7272  reshape (zyx_err
+0000ab30: 5b3a 2c20 6b6b 5d2c 2031 2920 0d0a 2020  [:, kk], 1) ..  
+0000ab40: 2020 2020 2020 6966 207a 7979 5f65 7272        if zyy_err
+0000ab50: 2069 7320 6e6f 7420 4e6f 6e65 3a20 0d0a   is not None: ..
+0000ab60: 2020 2020 2020 2020 2020 2020 5a2e 5f7a              Z._z
+0000ab70: 5f65 7272 5b3a 2c20 312c 2020 315d 203d  _err[:, 1,  1] =
+0000ab80: 2072 6573 6861 7065 2028 7a79 795f 6572   reshape (zyy_er
+0000ab90: 725b 3a2c 206b 6b5d 2c20 3129 0d0a 2020  r[:, kk], 1)..  
+0000aba0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000abb0: 2020 2020 5a2e 726f 7461 7465 2872 6f74      Z.rotate(rot
+0000abc0: 6174 6520 2920 2320 726f 7461 7465 2061  ate ) # rotate a
+0000abd0: 6e67 6c65 2069 6620 6769 7665 6e20 0d0a  ngle if given ..
+0000abe0: 2020 2020 2020 2020 5a2e 636f 6d70 7574          Z.comput
+0000abf0: 655f 7265 7369 7374 6976 6974 795f 7068  e_resistivity_ph
+0000ac00: 6173 6528 0d0a 2020 2020 2020 2020 2020  ase(..          
+0000ac10: 2020 7a5f 6172 7261 7920 3d20 5a2e 5f7a    z_array = Z._z
+0000ac20: 202c 207a 5f65 7272 5f61 7272 6179 203d   , z_err_array =
+0000ac30: 205a 2e5f 7a5f 6572 722c 2066 7265 7120   Z._z_err, freq 
+0000ac40: 3d20 6672 6571 2029 0d0a 0d0a 2020 2020  = freq )....    
+0000ac50: 2020 2020 7265 7475 726e 205a 0d0a 200d      return Z.. .
+0000ac60: 0a20 2020 2020 2020 200d 0a63 6c61 7373  .        ..class
+0000ac70: 2050 726f 6365 7373 696e 6720 2845 4d29   Processing (EM)
+0000ac80: 203a 0d0a 2020 2020 2222 2220 4261 7365   :..    """ Base
+0000ac90: 2070 726f 6365 7373 696e 6720 6f66 2045   processing of E
+0000aca0: 4d20 6f62 6a65 6374 200d 0a20 2020 200d  M object ..    .
+0000acb0: 0a20 2020 2046 6173 7420 7072 6f63 6573  .    Fast proces
+0000acc0: 7320 454d 4150 2061 6e64 2041 4d54 2064  s EMAP and AMT d
+0000acd0: 6174 612e 2054 6f6f 6c73 2061 7265 2075  ata. Tools are u
+0000ace0: 7365 6420 666f 7220 6461 7461 2073 616e  sed for data san
+0000acf0: 6974 697a 696e 672c 200d 0a20 2020 2072  itizing, ..    r
+0000ad00: 656d 6f76 696e 6720 6e6f 6973 6573 2061  emoving noises a
+0000ad10: 6e64 2066 696c 7465 7269 6e67 2e20 0d0a  nd filtering. ..
+0000ad20: 2020 2020 0d0a 2020 2020 5061 7261 6d65      ..    Parame
+0000ad30: 7465 7273 200d 0a20 2020 202d 2d2d 2d2d  ters ..    -----
+0000ad40: 2d2d 2d2d 2d0d 0a20 2020 2064 6174 613a  -----..    data:
+0000ad50: 2050 6174 682d 6c69 6b65 206f 626a 6563   Path-like objec
+0000ad60: 7420 6f72 206c 6973 7420 206f 6620 203a  t or list  of  :
+0000ad70: 636c 6173 733a 7761 7465 782e 6564 692e  class:watex.edi.
+0000ad80: 4564 6960 206f 7220 5c0d 0a20 2020 2020  Edi` or \..     
+0000ad90: 2020 2060 7079 6373 616d 742e 636f 7265     `pycsamt.core
+0000ada0: 2e65 6469 2e45 6469 6020 6f62 6a65 6374  .edi.Edi` object
+0000adb0: 7320 0d0a 2020 2020 2020 2020 436f 6c6c  s ..        Coll
+0000adc0: 6563 7469 6f6e 7320 6f66 2045 4449 2d6f  ections of EDI-o
+0000add0: 626a 6563 7473 200d 0a20 2020 200d 0a20  bjects ..    .. 
+0000ade0: 2020 2066 7265 7173 3a20 6172 7261 792d     freqs: array-
+0000adf0: 6c69 6b65 2c20 7368 6170 6520 284e 290d  like, shape (N).
+0000ae00: 0a20 2020 2020 2020 2046 7265 7175 656e  .        Frequen
+0000ae10: 6379 2061 7272 6179 2e20 4974 2073 686f  cy array. It sho
+0000ae20: 756c 6420 6265 2074 6865 2063 6f6d 706c  uld be the compl
+0000ae30: 6574 6520 6672 6571 7565 6e63 7920 7573  ete frequency us
+0000ae40: 6564 2064 7572 696e 6720 7468 6520 0d0a  ed during the ..
+0000ae50: 2020 2020 2020 2020 7375 7276 6579 2061          survey a
+0000ae60: 7265 612e 2049 7420 6361 6e20 6265 2067  rea. It can be g
+0000ae70: 6574 2075 7369 6e67 2074 6865 203a 6675  et using the :fu
+0000ae80: 6e63 3a60 6765 7466 756c 6c66 7265 7175  nc:`getfullfrequ
+0000ae90: 656e 6379 2060 200d 0a20 2020 2020 2020  ency ` ..       
+0000aea0: 204e 6f20 6e65 6564 2069 6620 6564 694f   No need if ediO
+0000aeb0: 626a 7320 6973 2070 726f 7669 6465 642e  bjs is provided.
+0000aec0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0000aed0: 2077 696e 646f 775f 7369 7a65 203a 2069   window_size : i
+0000aee0: 6e74 0d0a 2020 2020 2020 2020 7468 6520  nt..        the 
+0000aef0: 6c65 6e67 7468 206f 6620 7468 6520 7769  length of the wi
+0000af00: 6e64 6f77 2e20 4d75 7374 2062 6520 6772  ndow. Must be gr
+0000af10: 6561 7465 7220 7468 616e 2031 2061 6e64  eater than 1 and
+0000af20: 2070 7265 6665 7261 626c 790d 0a20 2020   preferably..   
+0000af30: 2020 2020 2061 6e20 6f64 6420 696e 7465       an odd inte
+0000af40: 6765 7220 6e75 6d62 6572 2e20 4465 6661  ger number. Defa
+0000af50: 756c 7420 6973 2060 6035 6060 0d0a 2020  ult is ``5``..  
+0000af60: 2020 2020 2020 0d0a 2020 2020 636f 6d70        ..    comp
+0000af70: 6f6e 656e 743a 2073 7472 200d 0a20 2020  onent: str ..   
+0000af80: 2020 2020 6669 656c 6420 7465 6e73 6f72      field tensor
+0000af90: 7320 6469 7265 6374 696f 6e2e 2049 7420  s direction. It 
+0000afa0: 6361 6e20 6265 2060 6078 7860 602c 2060  can be ``xx``, `
+0000afb0: 6078 7960 602c 6060 7978 6060 2c20 6060  `xy``,``yx``, ``
+0000afc0: 7979 6060 2e20 4966 200d 0a20 2020 2020  yy``. If ..     
+0000afd0: 2020 6061 7272 3264 6060 2069 7320 7072    `arr2d`` is pr
+0000afe0: 6f76 6964 6564 2c20 6e6f 206e 6565 6420  ovided, no need 
+0000aff0: 746f 2067 6976 6520 616e 2061 7267 756d  to give an argum
+0000b000: 656e 742e 2049 7420 6265 636f 6d65 2075  ent. It become u
+0000b010: 7365 6675 6c20 0d0a 2020 2020 2020 2077  seful ..       w
+0000b020: 6865 6e20 6120 636f 6c6c 6563 7469 6f6e  hen a collection
+0000b030: 206f 6620 4544 492d 6f62 6a65 6374 7320   of EDI-objects 
+0000b040: 6973 2070 726f 7669 6465 642e 2049 6620  is provided. If 
+0000b050: 646f 6e27 7420 7370 6563 6966 792c 2074  don't specify, t
+0000b060: 6865 200d 0a20 2020 2020 2020 7265 7369  he ..       resi
+0000b070: 7374 6976 6974 7920 616e 6420 7068 6173  stivity and phas
+0000b080: 6520 7661 6c75 6520 6174 2063 6f6d 706f  e value at compo
+0000b090: 6e65 6e74 2060 7879 6020 7368 6f75 6c64  nent `xy` should
+0000b0a0: 2062 6520 6665 7463 6865 6420 666f 7220   be fetched for 
+0000b0b0: 0d0a 2020 2020 2020 2063 6f72 7265 6374  ..       correct
+0000b0c0: 696f 6e20 6279 2064 6566 6175 6c74 2e20  ion by default. 
+0000b0d0: 4368 616e 6765 2074 6865 2063 6f6d 706f  Change the compo
+0000b0e0: 6e65 6e74 2076 616c 7565 2074 6f20 6765  nent value to ge
+0000b0f0: 7420 7468 6520 6170 7072 6f70 7269 6174  t the appropriat
+0000b100: 6520 0d0a 2020 2020 2020 2064 6174 6120  e ..       data 
+0000b110: 666f 7220 636f 7272 6563 7469 6f6e 2e20  for correction. 
+0000b120: 4465 6661 756c 7420 6973 2060 6078 7960  Default is ``xy`
+0000b130: 602e 0d0a 2020 2020 2020 200d 0a20 2020  `...       ..   
+0000b140: 206d 6f64 653a 2073 7472 200d 0a20 2020   mode: str ..   
+0000b150: 2020 2020 206d 6f64 6520 6f66 2074 6865       mode of the
+0000b160: 2062 6f72 6465 7220 7472 696d 6d69 6e67   border trimming
+0000b170: 2e20 5368 6f75 6c64 2062 6520 2776 616c  . Should be 'val
+0000b180: 6964 2720 6f72 2027 7361 6d65 272e 2776  id' or 'same'.'v
+0000b190: 616c 6964 2720 6973 2075 7365 6420 0d0a  alid' is used ..
+0000b1a0: 2020 2020 2020 2020 666f 7220 7265 6775          for regu
+0000b1b0: 6c61 7220 7472 696d 696d 6720 7768 6572  lar trimimg wher
+0000b1c0: 6561 7320 7468 6520 2773 616d 6527 2069  eas the 'same' i
+0000b1d0: 7320 7573 6564 2066 6f72 2061 7070 656e  s used for appen
+0000b1e0: 6469 6e67 2074 6865 2066 6972 7374 0d0a  ding the first..
+0000b1f0: 2020 2020 2020 2020 616e 6420 6c61 7374          and last
+0000b200: 2076 616c 7565 206f 6620 7265 7369 7374   value of resist
+0000b210: 6976 6974 792e 2041 6e79 206f 7468 6572  ivity. Any other
+0000b220: 2061 7267 756d 656e 7420 6578 6365 7074   argument except
+0000b230: 2027 7661 6c69 6427 2073 686f 756c 6420   'valid' should 
+0000b240: 0d0a 2020 2020 2020 2020 6265 2063 6f6e  ..        be con
+0000b250: 7369 6465 7265 6420 6173 2027 7361 6d65  sidered as 'same
+0000b260: 2720 6172 6775 6d65 6e74 2e20 4465 6661  ' argument. Defa
+0000b270: 756c 7420 6973 2060 6073 616d 6560 602e  ult is ``same``.
+0000b280: 2020 2020 200d 0a20 2020 2020 2020 0d0a       ..       ..
+0000b290: 2020 2020 6d65 7468 6f64 3a20 7374 722c      method: str,
+0000b2a0: 2064 6566 6175 6c74 2060 6073 6c69 6e65   default ``sline
+0000b2b0: 6172 6060 0d0a 2020 2020 2020 2020 496e  ar``..        In
+0000b2c0: 7465 7270 6f6c 6174 696f 6e20 7465 6368  terpolation tech
+0000b2d0: 6e69 7175 6520 746f 2075 7365 2e20 4361  nique to use. Ca
+0000b2e0: 6e20 616c 736f 2062 6520 6060 6e65 6172  n also be ``near
+0000b2f0: 6573 7460 602e 2052 6566 6572 2074 6f20  est``. Refer to 
+0000b300: 0d0a 2020 2020 2020 2020 7468 6520 646f  ..        the do
+0000b310: 6375 6d65 6e74 6174 696f 6e20 6f66 203a  cumentation of :
+0000b320: 6675 6e63 3a60 7e2e 696e 7465 7270 6f6c  func:`~.interpol
+0000b330: 6174 6532 6460 2e20 0d0a 2020 2020 2020  ate2d`. ..      
+0000b340: 2020 0d0a 2020 2020 6f75 7420 3a20 7374    ..    out : st
+0000b350: 7220 0d0a 2020 2020 2020 2020 5661 6c75  r ..        Valu
+0000b360: 6520 746f 2065 7870 6f72 742e 2043 616e  e to export. Can
+0000b370: 2062 6520 6060 7366 6163 746f 7260 602c   be ``sfactor``,
+0000b380: 2060 6074 656e 736f 7260 6020 666f 7220   ``tensor`` for 
+0000b390: 636f 7272 6563 7469 6f6e 7320 6661 6374  corrections fact
+0000b3a0: 6f72 200d 0a20 2020 2020 2020 2061 6e64  or ..        and
+0000b3b0: 2069 6d70 6564 616e 6365 2074 656e 736f   impedance tenso
+0000b3c0: 722e 2041 6e79 206f 7468 6572 2076 616c  r. Any other val
+0000b3d0: 7565 7320 7769 6c6c 2065 7870 6f72 7420  ues will export 
+0000b3e0: 7468 6520 7374 6174 6963 2063 6f72 7265  the static corre
+0000b3f0: 6374 6564 2020 0d0a 2020 2020 2020 2020  cted  ..        
+0000b400: 7265 7369 7374 6976 6974 792e 200d 0a20  resistivity. .. 
+0000b410: 2020 2020 2020 200d 0a20 2020 2063 203a         ..    c :
+0000b420: 2069 6e74 2c20 0d0a 2020 2020 2020 2020   int, ..        
+0000b430: 4120 7769 6e64 6f77 2d77 6964 7468 2065  A window-width e
+0000b440: 7870 616e 7369 6f6e 2066 6163 746f 7220  xpansion factor 
+0000b450: 7468 6174 206d 7573 7420 6265 2069 6e70  that must be inp
+0000b460: 7574 2074 6f20 7468 6520 6669 6c74 6572  ut to the filter
+0000b470: 200d 0a20 2020 2020 2020 2061 6461 7074   ..        adapt
+0000b480: 6174 696f 6e20 7072 6f63 6573 7320 746f  ation process to
+0000b490: 2063 6f6e 7472 6f6c 2074 6865 2072 6f6c   control the rol
+0000b4a0: 6c2d 6f66 6620 6368 6172 6163 7465 7269  l-off characteri
+0000b4b0: 7374 6963 730d 0a20 2020 2020 2020 206f  stics..        o
+0000b4c0: 6620 7468 6520 6170 706c 6965 6420 4861  f the applied Ha
+0000b4d0: 6e6e 696e 6720 7769 6e64 6f77 2e20 4974  nning window. It
+0000b4e0: 2069 7320 7265 636f 6d6d 656e 6465 6420   is recommended 
+0000b4f0: 746f 2073 656c 6563 7420 6063 6020 6265  to select `c` be
+0000b500: 7477 6565 6e20 0d0a 2020 2020 2020 2020  tween ..        
+0000b510: 6060 3160 6020 2061 6e64 2060 6034 6060  ``1``  and ``4``
+0000b520: 2e20 2044 6566 6175 6c74 2069 7320 6060  .  Default is ``
+0000b530: 3260 602e 200d 0a0d 0a20 2020 2045 7861  2``. ....    Exa
+0000b540: 6d70 6c65 7320 0d0a 2020 2020 2d2d 2d2d  mples ..    ----
+0000b550: 2d2d 2d2d 0d0a 2020 2020 3e3e 3e20 696d  ----..    >>> im
+0000b560: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
+0000b570: 7079 706c 6f74 2061 7320 706c 7420 0d0a  pyplot as plt ..
+0000b580: 2020 2020 3e3e 3e20 6672 6f6d 2077 6174      >>> from wat
+0000b590: 6578 2e6d 6574 686f 6473 2e65 6d20 696d  ex.methods.em im
+0000b5a0: 706f 7274 2050 726f 6365 7373 696e 6720  port Processing 
+0000b5b0: 0d0a 2020 2020 3e3e 3e20 6564 6970 6174  ..    >>> edipat
+0000b5c0: 6820 3d20 2764 6174 612f 6564 6973 270d  h = 'data/edis'.
+0000b5d0: 0a20 2020 203e 3e3e 2070 203d 2050 726f  .    >>> p = Pro
+0000b5e0: 6365 7373 696e 6728 292e 6669 7428 6564  cessing().fit(ed
+0000b5f0: 6970 6174 6829 200d 0a20 2020 203e 3e3e  ipath) ..    >>>
+0000b600: 2070 2e77 696e 646f 775f 7369 7a65 203d   p.window_size =
+0000b610: 3220 0d0a 2020 2020 3e3e 3e20 702e 636f  2 ..    >>> p.co
+0000b620: 6d70 6f6e 656e 7420 3d27 7978 270d 0a20  mponent ='yx'.. 
+0000b630: 2020 203e 3e3e 2072 633d 2070 2e74 6d61     >>> rc= p.tma
+0000b640: 2829 0d0a 2020 2020 3e3e 3e20 2320 6765  ()..    >>> # ge
+0000b650: 7420 7468 6520 7265 7369 7374 6976 7920  t the resistivy 
+0000b660: 7661 6c75 6520 6f66 2074 6865 2074 6869  value of the thi
+0000b670: 7264 2066 7265 7175 656e 6379 2020 6174  rd frequency  at
+0000b680: 2061 6c6c 2073 7461 7469 6f6e 7320 0d0a   all stations ..
+0000b690: 2020 2020 3e3e 3e20 702e 7265 7332 645f      >>> p.res2d_
+0000b6a0: 5b33 2c20 3a5d 2020 0d0a 2020 2020 2e2e  [3, :]  ..    ..
+0000b6b0: 2e20 6172 7261 7928 5b20 3434 372e 3035  . array([ 447.05
+0000b6c0: 3432 3330 3031 2c20 3130 3136 2e35 3433  423001, 1016.543
+0000b6d0: 3532 3935 342c 2031 3431 352e 3930 3939  52954, 1415.9099
+0000b6e0: 3231 3839 2c20 2035 3336 2e35 3432 3933  2189,  536.54293
+0000b6f0: 3939 342c 0d0a 2020 2020 2020 2020 2020  994,..          
+0000b700: 2031 3330 372e 3834 3435 3630 3336 2c20   1307.84456036, 
+0000b710: 2020 3635 2e34 3438 3036 3639 382c 2020    65.44806698,  
+0000b720: 2038 362e 3636 3831 3737 3931 2c20 2032   86.66817791,  2
+0000b730: 3431 2e37 3635 3932 3237 332c 0d0a 2020  41.76592273,..  
+0000b740: 2020 2020 2020 2020 202e 2e2e 0d0a 2020           .....  
+0000b750: 2020 2020 2020 2020 2020 3234 382e 3239            248.29
+0000b760: 3037 3730 3339 2c20 2032 3437 2e37 3134  077039,  247.714
+0000b770: 3532 3731 322c 2020 2031 372e 3033 3838  52712,   17.0388
+0000b780: 3834 3134 5d29 0d0a 2020 2020 3e3e 3e20  8414])..    >>> 
+0000b790: 2023 2067 6574 2074 6865 2072 6573 6973   # get the resis
+0000b7a0: 7469 7669 7479 2076 616c 7565 2063 6f72  tivity value cor
+0000b7b0: 7265 6374 6564 2061 7420 7468 6520 7468  rected at the th
+0000b7c0: 6972 6420 6672 6571 7565 6e63 7920 0d0a  ird frequency ..
+0000b7d0: 2020 2020 3e3e 3e20 7263 205b 332c 203a      >>> rc [3, :
+0000b7e0: 5d0d 0a20 2020 202e 2e2e 2061 7272 6179  ]..    ... array
+0000b7f0: 285b 2034 3437 2e30 3534 3233 3030 312c  ([ 447.05423001,
+0000b800: 2020 3736 332e 3932 3431 3637 3638 2c20    763.92416768, 
+0000b810: 2039 3239 2e33 3338 3337 3334 392c 2020   929.33837349,  
+0000b820: 3838 312e 3439 3939 3230 3931 2c0d 0a20  881.49992091,.. 
+0000b830: 2020 2020 2020 2020 2020 2034 3034 2e39             404.9
+0000b840: 3333 3832 3136 332c 2020 3139 302e 3538  3382163,  190.58
+0000b850: 3236 3431 3531 2c20 2031 3630 2e37 3139  264151,  160.719
+0000b860: 3137 3635 342c 2020 3136 332e 3330 3033  17654,  163.3003
+0000b870: 3438 3735 2c0d 0a20 2020 2020 2020 2020  4875,..         
+0000b880: 2020 2033 3934 2e32 3732 3730 3932 202c     394.2727092 ,
+0000b890: 2020 3637 392e 3731 3534 3238 3131 2c20    679.71542811, 
+0000b8a0: 2039 3533 2e32 3739 3635 3637 202c 2031   953.2796567 , 1
+0000b8b0: 3231 322e 3432 3838 3339 3434 2c0d 0a20  212.42883944,.. 
+0000b8c0: 2020 2020 2020 2020 2020 202e 2e2e 0d0a             .....
+0000b8d0: 2020 2020 2020 2020 2020 2020 3136 342e              164.
+0000b8e0: 3538 3238 3238 3636 2c20 2020 3936 2e36  58282866,   96.6
+0000b8f0: 3030 3832 3135 392c 2020 2031 372e 3033  0082159,   17.03
+0000b900: 3838 3834 3134 5d29 0d0a 2020 2020 3e3e  888414])..    >>
+0000b910: 3e20 706c 742e 7365 6d69 6c6f 6779 2028  > plt.semilogy (
+0000b920: 6e70 2e61 7261 6e67 6520 2870 2e72 6573  np.arange (p.res
+0000b930: 3264 5f2e 7368 6170 655b 315d 2029 2c20  2d_.shape[1] ), 
+0000b940: 702e 7265 7332 645f 5b33 2c20 3a5d 2c20  p.res2d_[3, :], 
+0000b950: 272d 2d27 2c0d 0a20 2020 2020 2020 2020  '--',..         
+0000b960: 2020 2020 2020 2020 2020 2020 206e 702e               np.
+0000b970: 6172 616e 6765 2028 702e 7265 7332 645f  arange (p.res2d_
+0000b980: 2e73 6861 7065 5b31 5d20 292c 2072 635b  .shape[1] ), rc[
+0000b990: 332c 203a 5d2c 2027 6f6b 2d2d 2729 0d0a  3, :], 'ok--')..
+0000b9a0: 200d 0a20 2020 2052 6566 6572 656e 6365   ..    Reference
+0000b9b0: 7320 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  s ..    --------
+0000b9c0: 2d2d 2d0d 0a20 2020 202e 2e20 5b31 5d20  ---..    .. [1] 
+0000b9d0: 6874 7470 3a2f 2f77 7777 2e7a 6f6e 6765  http://www.zonge
+0000b9e0: 2e63 6f6d 2f6c 6567 6163 792f 5044 465f  .com/legacy/PDF_
+0000b9f0: 4461 7450 726f 2f41 7374 6174 6963 2e70  DatPro/Astatic.p
+0000ba00: 6466 0d0a 2020 2020 2020 2020 0d0a 2020  df..        ..  
+0000ba10: 2020 2222 220d 0a20 2020 200d 0a20 2020    """..    ..   
+0000ba20: 2064 6566 205f 5f69 6e69 745f 5f28 0d0a   def __init__(..
+0000ba30: 2020 2020 2020 2020 7365 6c66 2c0d 0a20          self,.. 
+0000ba40: 2020 2020 2020 2077 696e 646f 775f 7369         window_si
+0000ba50: 7a65 3a69 6e74 203d 352c 200d 0a20 2020  ze:int =5, ..   
+0000ba60: 2020 2020 2063 6f6d 706f 6e65 6e74 3a73       component:s
+0000ba70: 7472 203d 2778 7927 2c20 0d0a 2020 2020  tr ='xy', ..    
+0000ba80: 2020 2020 6d6f 6465 3a20 7374 7220 3d27      mode: str ='
+0000ba90: 7361 6d65 272c 200d 0a20 2020 2020 2020  same', ..       
+0000baa0: 206d 6574 686f 643a 7374 7220 3d27 736c   method:str ='sl
+0000bab0: 696e 6561 7227 2c20 0d0a 2020 2020 2020  inear', ..      
+0000bac0: 2020 6f75 743a 7374 7220 203d 2773 7268    out:str  ='srh
+0000bad0: 6f27 2c20 0d0a 2020 2020 2020 2020 633a  o', ..        c:
+0000bae0: 2069 6e74 203d 322c 200d 0a20 2020 2020   int =2, ..     
+0000baf0: 2020 202a 2a6b 7773 0d0a 2020 2020 2020     **kws..      
+0000bb00: 2020 293a 200d 0a20 2020 2020 2020 2073    ): ..        s
+0000bb10: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
+0000bb20: 2a2a 6b77 7329 0d0a 2020 2020 2020 2020  **kws)..        
+0000bb30: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+0000bb40: 6c6f 6767 696e 673d 2077 6174 6578 6c6f  logging= watexlo
+0000bb50: 672e 6765 745f 7761 7465 785f 6c6f 6767  g.get_watex_logg
+0000bb60: 6572 2873 656c 662e 5f5f 636c 6173 735f  er(self.__class_
+0000bb70: 5f2e 5f5f 6e61 6d65 5f5f 290d 0a20 2020  _.__name__)..   
+0000bb80: 2020 2020 2073 656c 662e 7769 6e64 6f77       self.window
+0000bb90: 5f73 697a 653d 7769 6e64 6f77 5f73 697a  _size=window_siz
+0000bba0: 6520 0d0a 2020 2020 2020 2020 7365 6c66  e ..        self
+0000bbb0: 2e63 6f6d 706f 6e65 6e74 3d63 6f6d 706f  .component=compo
+0000bbc0: 6e65 6e74 200d 0a20 2020 2020 2020 2073  nent ..        s
+0000bbd0: 656c 662e 6d6f 6465 3d6d 6f64 6520 0d0a  elf.mode=mode ..
+0000bbe0: 2020 2020 2020 2020 7365 6c66 2e6d 6574          self.met
+0000bbf0: 686f 643d 6d65 7468 6f64 200d 0a20 2020  hod=method ..   
+0000bc00: 2020 2020 2073 656c 662e 6f75 743d 6f75       self.out=ou
+0000bc10: 7420 0d0a 2020 2020 2020 2020 7365 6c66  t ..        self
+0000bc20: 2e63 3d63 0d0a 2020 2020 2020 2020 0d0a  .c=c..        ..
+0000bc30: 0d0a 2020 2020 6465 6620 746d 6120 280d  ..    def tma (.
+0000bc40: 0a20 2020 2020 2020 2073 656c 662c 0d0a  .        self,..
+0000bc50: 2020 2020 2020 2020 736d 6f6f 7468 3a20          smooth: 
+0000bc60: 626f 6f6c 203d 2054 7275 652c 200d 0a20  bool = True, .. 
+0000bc70: 2020 2020 2020 2064 726f 705f 6f75 746c         drop_outl
+0000bc80: 6965 7273 3a62 6f6f 6c20 3d20 5472 7565  iers:bool = True
+0000bc90: 2c20 0d0a 2020 2020 2020 2020 7265 7475  , ..        retu
+0000bca0: 726e 5f70 6869 3a62 6f6f 6c20 3d46 616c  rn_phi:bool =Fal
+0000bcb0: 7365 2c20 0d0a 2020 2020 2920 3a0d 0a20  se, ..    ) :.. 
+0000bcc0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000bcd0: 2022 2222 2041 2074 7269 6d6d 6564 2d6d   """ A trimmed-m
+0000bce0: 6f76 696e 672d 6176 6572 6167 6520 6669  oving-average fi
+0000bcf0: 6c74 6572 2074 6f20 6573 7469 6d61 7465  lter to estimate
+0000bd00: 2061 7665 7261 6765 2061 7070 6172 656e   average apparen
+0000bd10: 740d 0a20 2020 2020 2020 2072 6573 6973  t..        resis
+0000bd20: 7469 7669 7469 6573 2061 7420 6120 7369  tivities at a si
+0000bd30: 6e67 6c65 2073 7461 7469 632d 636f 7272  ngle static-corr
+0000bd40: 6563 7469 6f6e 2d72 6566 6572 656e 6365  ection-reference
+0000bd50: 2066 7265 7175 656e 6379 2e20 0d0a 2020   frequency. ..  
+0000bd60: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000bd70: 5468 6520 544d 4120 6669 6c74 6572 206f  The TMA filter o
+0000bd80: 7074 696f 6e20 6573 7469 6d61 7465 7320  ption estimates 
+0000bd90: 6e65 6172 2d73 7572 6661 6365 2072 6573  near-surface res
+0000bda0: 6973 7469 7669 7469 6573 2062 7920 6176  istivities by av
+0000bdb0: 6572 6167 696e 670d 0a20 2020 2020 2020  eraging..       
+0000bdc0: 2061 7070 6172 656e 7420 7265 7369 7374   apparent resist
+0000bdd0: 6976 6974 6965 7320 616c 6f6e 6720 6c69  ivities along li
+0000bde0: 6e65 2061 7420 7468 6520 7365 6c65 6374  ne at the select
+0000bdf0: 6564 2073 7461 7469 632d 636f 7272 6563  ed static-correc
+0000be00: 7469 6f6e 200d 0a20 2020 2020 2020 2072  tion ..        r
+0000be10: 6566 6572 656e 6365 2066 7265 7175 656e  eference frequen
+0000be20: 6379 2e20 5468 6520 6869 6768 6573 7420  cy. The highest 
+0000be30: 6672 6571 7565 6e63 7920 7769 7468 2063  frequency with c
+0000be40: 6c65 616e 2064 6174 6120 7368 6f75 6c64  lean data should
+0000be50: 2062 6520 0d0a 2020 2020 2020 2020 7365   be ..        se
+0000be60: 6c65 6374 6564 2061 7320 7468 6520 7265  lected as the re
+0000be70: 6665 7265 6e63 6520 6672 6571 7565 6e63  ference frequenc
+0000be80: 792e 0d0a 2020 2020 2020 2020 0d0a 2020  y...        ..  
+0000be90: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0000bea0: 200d 0a20 2020 2020 2020 202d 2d2d 2d2d   ..        -----
+0000beb0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
+0000bec0: 6d6f 6f74 683a 2062 6f6f 6c2c 2064 6566  mooth: bool, def
+0000bed0: 6175 6c74 3d54 7275 652c 200d 0a20 2020  ault=True, ..   
+0000bee0: 2020 2020 2020 2020 536d 6f6f 7468 2074          Smooth t
+0000bef0: 6865 2074 656e 736f 7220 6461 7461 2061  he tensor data a
+0000bf00: 6c6f 6e67 2074 6865 2066 7265 7175 656e  long the frequen
+0000bf10: 6369 6573 2e20 0d0a 2020 2020 2020 2020  cies. ..        
+0000bf20: 0d0a 2020 2020 2020 2020 6472 6f70 5f6f  ..        drop_o
+0000bf30: 7574 6c69 6572 733a 2062 6f6f 6c2c 2064  utliers: bool, d
+0000bf40: 6566 6175 6c74 3d54 7275 6520 0d0a 2020  efault=True ..  
+0000bf50: 2020 2020 2020 2020 2053 7570 7072 6573           Suppres
+0000bf60: 7320 6f75 746c 6965 7273 2069 6e20 7468  s outliers in th
+0000bf70: 6520 6461 7461 2077 6865 6e20 736d 6f6f  e data when smoo
+0000bf80: 7468 696e 6720 6461 7461 2061 6c6f 6e67  thing data along
+0000bf90: 200d 0a20 2020 2020 2020 2020 2020 7468   ..           th
+0000bfa0: 6520 6672 6571 7565 6e63 6965 7320 6178  e frequencies ax
+0000bfb0: 6973 2e20 4e6f 7465 2074 6861 7420 6064  is. Note that `d
+0000bfc0: 726f 705f 6f75 746c 6965 7273 6020 646f  rop_outliers` do
+0000bfd0: 6573 206e 6f74 2074 616b 6520 0d0a 2020  es not take ..  
+0000bfe0: 2020 2020 2020 2020 2065 6666 6563 7420           effect 
+0000bff0: 6966 2060 736d 6f6f 7468 6020 6973 2060  if `smooth` is `
+0000c000: 6046 616c 7365 6060 2e20 0d0a 2020 2020  `False``. ..    
+0000c010: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000c020: 2072 6574 7572 6e5f 7068 693a 2062 6f6f   return_phi: boo
+0000c030: 6c2c 2064 6566 6175 6c74 3d46 616c 7365  l, default=False
+0000c040: 2c20 0d0a 2020 2020 2020 2020 2020 2072  , ..           r
+0000c050: 6574 7572 6e20 636f 7272 6563 7465 6420  eturn corrected 
+0000c060: 7068 6173 6520 696e 2064 6567 7265 6573  phase in degrees
+0000c070: 2e20 4d6f 7374 6c79 2074 6865 2070 6861  . Mostly the pha
+0000c080: 7365 2064 6f65 7320 6e6f 7420 6e65 6564  se does not need
+0000c090: 200d 0a20 2020 2020 2020 2020 2020 746f   ..           to
+0000c0a0: 2063 6f72 7265 6374 2073 696e 6365 2069   correct since i
+0000c0b0: 7420 6973 206e 6f74 2061 6666 6563 7465  t is not affecte
+0000c0c0: 6420 6279 2074 6865 2073 7461 7469 6320  d by the static 
+0000c0d0: 7368 6966 7420 6566 6665 6374 2e20 0d0a  shift effect. ..
+0000c0e0: 2020 2020 2020 2020 2020 2048 6f77 6576             Howev
+0000c0f0: 6572 2c20 6974 2063 616e 2062 6520 6173  er, it can be as
+0000c100: 2073 6d6f 6f74 6820 7068 6173 6520 6375   smooth phase cu
+0000c110: 7276 6520 7768 656e 2060 6073 6d6f 6f74  rve when ``smoot
+0000c120: 683d 5472 7565 6060 0d0a 2020 2020 2020  h=True``..      
+0000c130: 0d0a 2020 2020 2020 2020 2e2e 2076 6572  ..        .. ver
+0000c140: 7369 6f6e 6164 6465 643a 3a20 302e 322e  sionadded:: 0.2.
+0000c150: 3120 0d0a 2020 2020 2020 2020 2020 2050  1 ..           P
+0000c160: 6f6c 6973 6820 7468 6520 7465 6e73 6f72  olish the tensor
+0000c170: 2064 6174 6120 616c 6f6e 6720 7468 6520   data along the 
+0000c180: 6672 6571 7565 6e63 7920 6178 6973 2072  frequency axis r
+0000c190: 656d 6f76 6520 6e6f 6973 6573 200d 0a20  emove noises .. 
+0000c1a0: 2020 2020 2020 2020 2020 616e 6420 6465            and de
+0000c1b0: 616c 2077 6974 6820 7468 6520 7374 6174  al with the stat
+0000c1c0: 6963 2073 6869 6674 2065 6666 6563 7420  ic shift effect 
+0000c1d0: 7768 656e 2069 6e74 6572 6665 7265 6e63  when interferenc
+0000c1e0: 6573 206e 6f69 7365 7320 0d0a 2020 2020  es noises ..    
+0000c1f0: 2020 2020 2020 2061 7265 2073 7472 6f6e         are stron
+0000c200: 6720 656e 6f75 6768 2e20 0d0a 2020 2020  g enough. ..    
+0000c210: 2020 2020 0d0a 2020 2020 2020 2020 5265      ..        Re
+0000c220: 7475 726e 7320 0d0a 2020 2020 2020 2020  turns ..        
+0000c230: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0000c240: 2072 633a 206e 702e 6e64 6172 7261 792c   rc: np.ndarray,
+0000c250: 2073 6861 7065 2020 284e 2c20 4d29 0d0a   shape  (N, M)..
+0000c260: 2020 2020 2020 2020 2020 2020 454d 4150              EMAP
+0000c270: 2061 7070 6172 656e 7420 2072 6573 6973   apparent  resis
+0000c280: 7469 7669 7479 2073 7461 7469 6320 7368  tivity static sh
+0000c290: 6966 7420 636f 7272 6563 7465 6420 6f72  ift corrected or
+0000c2a0: 2073 7461 7469 6320 0d0a 2020 2020 2020   static ..      
+0000c2b0: 2020 2020 2020 636f 7272 6563 7469 6f6e        correction
+0000c2c0: 2066 6163 746f 7220 6f72 2069 6d70 6564   factor or imped
+0000c2d0: 616e 6365 2074 656e 736f 722e 0d0a 2020  ance tensor...  
+0000c2e0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000c2f0: 2020 2020 7263 2c20 7068 695f 633a 2054      rc, phi_c: T
+0000c300: 7570 6c65 206f 6620 7368 6170 6520 284e  uple of shape (N
+0000c310: 2c20 4e29 200d 0a20 2020 2020 2020 2020  , N) ..         
+0000c320: 2020 454d 4150 2061 7070 6172 656e 7420    EMAP apparent 
+0000c330: 7265 7369 7374 6976 6974 7920 616e 6420  resistivity and 
+0000c340: 7068 6173 6520 636f 7272 6563 7465 642e  phase corrected.
+0000c350: 200d 0a0d 0a20 2020 2020 2020 2045 7861   ....        Exa
+0000c360: 6d70 6c65 0d0a 2020 2020 2020 2020 2d2d  mple..        --
+0000c370: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0000c380: 3e3e 3e20 696d 706f 7274 2077 6174 6578  >>> import watex
+0000c390: 2061 7320 7778 0d0a 2020 2020 2020 2020   as wx..        
+0000c3a0: 3e3e 3e20 696d 706f 7274 206d 6174 706c  >>> import matpl
+0000c3b0: 6f74 6c69 622e 7079 706c 6f74 2061 7320  otlib.pyplot as 
+0000c3c0: 706c 7420 0d0a 2020 2020 2020 2020 3e3e  plt ..        >>
+0000c3d0: 3e20 6564 695f 6461 7461 203d 2077 782e  > edi_data = wx.
+0000c3e0: 6665 7463 685f 6461 7461 2028 2765 6469  fetch_data ('edi
+0000c3f0: 7327 2c20 6173 5f66 7261 6d65 203d 5472  s', as_frame =Tr
+0000c400: 7565 2c20 6b65 7920 3d27 6564 6927 290d  ue, key ='edi').
+0000c410: 0a20 2020 2020 2020 203e 3e3e 2070 203d  .        >>> p =
+0000c420: 2077 782e 454d 5072 6f63 6573 7369 6e67   wx.EMProcessing
+0000c430: 2028 6f75 743d 277a 2729 2e66 6974 2865   (out='z').fit(e
+0000c440: 6469 5f64 6174 612e 6564 6929 200d 0a20  di_data.edi) .. 
+0000c450: 2020 2020 2020 203e 3e3e 207a 5f63 6f72         >>> z_cor
+0000c460: 7265 6374 6564 203d 2070 2e74 6d61 2028  rected = p.tma (
+0000c470: 2920 2320 6f75 7470 7574 207a 2069 6e20  ) # output z in 
+0000c480: 636f 6d70 6c65 7820 6474 7970 6520 0d0a  complex dtype ..
+0000c490: 2020 2020 2020 2020 3e3e 3e20 706c 742e          >>> plt.
+0000c4a0: 706c 6f74 2028 6e70 2e61 7261 6e67 6520  plot (np.arange 
+0000c4b0: 286c 656e 2870 2e65 6469 4f62 6a73 5f29  (len(p.ediObjs_)
+0000c4c0: 2920 2c20 6e70 2e61 6273 2820 0d0a 2020  ) , np.abs( ..  
+0000c4d0: 2020 2020 2020 2020 2020 5b20 6564 696f            [ edio
+0000c4e0: 626a 2e5a 2e7a 5b3a 2c20 302c 2031 5d5b  bj.Z.z[:, 0, 1][
+0000c4f0: 375d 2020 666f 7220 6564 696f 626a 2069  7]  for ediobj i
+0000c500: 6e20 702e 6564 694f 626a 735f 5d29 202c  n p.ediObjs_]) ,
+0000c510: 2027 2d6f 6b27 2c0d 0a20 2020 2020 2020   '-ok',..       
+0000c520: 2020 2020 206e 702e 6172 616e 6765 286c       np.arange(l
+0000c530: 656e 2870 2e65 6469 4f62 6a73 5f29 292c  en(p.ediObjs_)),
+0000c540: 206e 702e 6162 7328 207a 5f63 6f72 7265   np.abs( z_corre
+0000c550: 6374 6564 5b37 2c3a 205d 2920 2c20 276f  cted[7,: ]) , 'o
+0000c560: 722d 2729 0d0a 2020 2020 2020 2020 0d0a  r-')..        ..
+0000c570: 2020 2020 2020 2020 5265 6665 7265 6e63          Referenc
+0000c580: 6573 200d 0a20 2020 2020 2020 202d 2d2d  es ..        ---
+0000c590: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+0000c5a0: 2020 2e2e 205b 315d 2068 7474 703a 2f2f    .. [1] http://
+0000c5b0: 7777 772e 7a6f 6e67 652e 636f 6d2f 6c65  www.zonge.com/le
+0000c5c0: 6761 6379 2f50 4446 5f44 6174 5072 6f2f  gacy/PDF_DatPro/
+0000c5d0: 4173 7461 7469 632e 7064 660d 0a20 2020  Astatic.pdf..   
+0000c5e0: 2020 2020 200d 0a20 2020 2020 2020 2022       ..        "
+0000c5f0: 2222 0d0a 2020 2020 2020 2020 7365 6c66  ""..        self
+0000c600: 2e69 6e73 7065 6374 0d0a 2020 2020 2020  .inspect..      
+0000c610: 2020 2320 6173 7365 7274 2066 696c 7465    # assert filte
+0000c620: 7220 6172 6775 6d65 6e74 7320 0d0a 2020  r arguments ..  
+0000c630: 2020 2020 2020 7365 6c66 2e72 6573 3264        self.res2d
+0000c640: 5f20 2c20 7365 6c66 2e70 6873 3264 5f20  _ , self.phs2d_ 
+0000c650: 2c20 7365 6c66 2e66 7265 7173 5f2c 2073  , self.freqs_, s
+0000c660: 656c 662e 632c 2073 656c 662e 7769 6e64  elf.c, self.wind
+0000c670: 6f77 5f73 697a 652c 205c 0d0a 2020 2020  ow_size, \..    
+0000c680: 2020 2020 2020 2020 7365 6c66 2e63 6f6d          self.com
+0000c690: 706f 6e65 6e74 2c20 7365 6c66 2e6f 7574  ponent, self.out
+0000c6a0: 203d 2073 656c 662e 5f6d 616b 6532 6462   = self._make2db
+0000c6b0: 6c6f 6273 2028 290d 0a20 0d0a 2020 2020  lobs ().. ..    
+0000c6c0: 2020 2020 2320 2069 6e74 6572 706f 6c61      #  interpola
+0000c6d0: 7465 2072 6573 6973 7469 7669 7479 2061  te resistivity a
+0000c6e0: 6e64 2070 6861 7365 7320 0d0a 2020 2020  nd phases ..    
+0000c6f0: 2020 2020 7365 6c66 2e70 6873 3264 5f3d      self.phs2d_=
+0000c700: 2069 6e74 6572 706f 6c61 7465 3264 280d   interpolate2d(.
+0000c710: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000c720: 662e 7068 7332 645f 2c20 6d65 7468 6f64  f.phs2d_, method
+0000c730: 203d 7365 6c66 2e6d 6574 686f 6429 0d0a   =self.method)..
+0000c740: 2020 2020 2020 2020 7365 6c66 2e72 6573          self.res
+0000c750: 3264 5f3d 2069 6e74 6572 706f 6c61 7465  2d_= interpolate
+0000c760: 3264 280d 0a20 2020 2020 2020 2020 2020  2d(..           
+0000c770: 2073 656c 662e 7265 7332 645f 2c20 6d65   self.res2d_, me
+0000c780: 7468 6f64 203d 7365 6c66 2e6d 6574 686f  thod =self.metho
+0000c790: 6429 0d0a 2020 2020 2020 2020 2320 6765  d)..        # ge
+0000c7a0: 7420 7468 6520 696e 6465 7820 6f66 2074  t the index of t
+0000c7b0: 6865 2072 6566 6572 656e 6365 2066 7265  he reference fre
+0000c7c0: 7175 656e 6379 2020 616e 6420 636f 6c6c  quency  and coll
+0000c7d0: 6563 7420 0d0a 2020 2020 2020 2020 2320  ect ..        # 
+0000c7e0: 7468 6520 7265 7369 7374 6976 6974 7920  the resistivity 
+0000c7f0: 616e 6420 7068 6173 6520 6174 2074 6861  and phase at tha
+0000c800: 7420 6672 6571 7565 6e63 7920 0d0a 2020  t frequency ..  
+0000c810: 2020 2020 2020 6978 5f72 6620 3d20 696e        ix_rf = in
+0000c820: 7428 7265 7368 6170 6520 286e 702e 6172  t(reshape (np.ar
+0000c830: 6777 6865 7265 2028 7365 6c66 2e66 7265  gwhere (self.fre
+0000c840: 7173 5f3d 3d73 656c 662e 7265 6672 6571  qs_==self.refreq
+0000c850: 5f29 2929 2020 0d0a 0d0a 2020 2020 2020  _)))  ....      
+0000c860: 2020 2320 6e6f 726d 616c 697a 6520 6c6f    # normalize lo
+0000c870: 6720 6672 6571 7565 6e63 7920 616e 6420  g frequency and 
+0000c880: 7461 6b65 2074 6865 206e 6f72 6d61 6c69  take the normali
+0000c890: 7a65 2072 6566 2066 7265 7120 0d0a 2020  ze ref freq ..  
+0000c8a0: 2020 2020 2020 6e6f 726d 5f66 203d 2028        norm_f = (
+0000c8b0: 6e70 2e6c 6f67 3130 2873 656c 662e 6672  np.log10(self.fr
+0000c8c0: 6571 735f 2920 2f20 6e70 2e6c 696e 616c  eqs_) / np.linal
+0000c8d0: 672e 6e6f 726d 280d 0a20 2020 2020 2020  g.norm(..       
+0000c8e0: 2020 2020 206e 702e 6c6f 6731 3028 7365       np.log10(se
+0000c8f0: 6c66 2e66 7265 7173 5f29 2929 0d0a 2020  lf.freqs_)))..  
+0000c900: 2020 2020 2020 2320 636f 6d70 7574 6520        # compute 
+0000c910: 7468 6520 736c 6f70 6520 6174 2065 6163  the slope at eac
+0000c920: 6820 6e6f 726d 616c 697a 6520 6672 6571  h normalize freq
+0000c930: 7565 6e63 7920 0d0a 2020 2020 2020 2020  uency ..        
+0000c940: 736c 6f70 6532 6420 3d20 6e70 2e61 7263  slope2d = np.arc
+0000c950: 7461 6e28 2028 6e70 2e64 6567 3272 6164  tan( (np.deg2rad
+0000c960: 2873 656c 662e 7068 7332 645f 2920 2f20  (self.phs2d_) / 
+0000c970: 280d 0a20 2020 2020 2020 2020 2020 206e  (..            n
+0000c980: 702e 7069 202f 3420 2929 202d 3120 2920  p.pi /4 )) -1 ) 
+0000c990: 2f20 286e 702e 7069 202f 3220 290d 0a20  / (np.pi /2 ).. 
+0000c9a0: 2020 2020 2020 206c 6f67 5f72 686f 3264         log_rho2d
+0000c9b0: 203d 206e 702e 6c6f 6731 3020 2873 656c   = np.log10 (sel
+0000c9c0: 662e 7265 7332 645f 2920 2b20 6e6f 726d  f.res2d_) + norm
+0000c9d0: 5f66 5b3a 2c20 4e6f 6e65 5d20 2a20 736c  _f[:, None] * sl
+0000c9e0: 6f70 6532 6420 0d0a 2020 2020 2020 2020  ope2d ..        
+0000c9f0: 2320 6578 7472 6170 6f6c 6174 6520 7570  # extrapolate up
+0000ca00: 200d 0a20 2020 2020 2020 2023 2072 6570   ..        # rep
+0000ca10: 6c61 6365 2074 6865 2075 7020 6672 6571  lace the up freq
+0000ca20: 7565 6e63 7920 7468 696e 2074 6865 2069  uency thin the i
+0000ca30: 6e64 6578 206f 6620 7266 2062 7920 696e  ndex of rf by in
+0000ca40: 7465 7270 6f6c 6174 696e 6720 7570 200d  terpolating up .
+0000ca50: 0a20 2020 2020 2020 206c 6f67 5f72 686f  .        log_rho
+0000ca60: 3264 205b 3a69 785f 7266 2c20 3a5d 203d  2d [:ix_rf, :] =
+0000ca70: 206e 702e 6c6f 6731 3020 280d 0a20 2020   np.log10 (..   
+0000ca80: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
+0000ca90: 7332 645f 5b3a 6978 5f72 662c 203a 205d  s2d_[:ix_rf, : ]
+0000caa0: 2920 2b20 6e70 2e6c 6f67 3130 280d 0a20  ) + np.log10(.. 
+0000cab0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000cac0: 702e 7371 7274 2832 2929 202a 2073 6c6f  p.sqrt(2)) * slo
+0000cad0: 7065 3264 5b3a 6978 5f72 662c 203a 5d0d  pe2d[:ix_rf, :].
+0000cae0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0000caf0: 2020 2023 206d 616b 6520 616e 2061 7272     # make an arr
+0000cb00: 6179 206f 6620 7765 6967 6874 2066 6163  ay of weight fac
+0000cb10: 746f 7220 7766 200d 0a20 2020 2020 2020  tor wf ..       
+0000cb20: 2077 6620 3d20 6e70 2e7a 6572 6f73 5f6c   wf = np.zeros_l
+0000cb30: 696b 6528 6c6f 675f 7268 6f32 6429 2023  ike(log_rho2d) #
+0000cb40: 2061 7665 7261 6765 206c 6f67 6a20 0d0a   average logj ..
+0000cb50: 2020 2020 2020 2020 2320 466f 7220 6561          # For ea
+0000cb60: 6368 2073 7461 7469 6f6e 2063 6f6c 6c65  ch station colle
+0000cb70: 6374 2061 2067 726f 7570 206f 6620 7769  ct a group of wi
+0000cb80: 6e64 6f77 2d73 697a 6520 6c6f 6728 726a  ndow-size log(rj
+0000cb90: 2029 2c20 0d0a 2020 2020 2020 2020 2320   ), ..        # 
+0000cba0: 2369 2e65 2e20 666f 7220 7769 6e64 6f77  #i.e. for window
+0000cbb0: 2073 697a 6520 3d35 2073 7461 7469 6f6e   size =5 station
+0000cbc0: 2069 6e64 6578 206a 2c20 6920 3d20 6a2d   index j, i = j-
+0000cbd0: 3220 746f 206a 2b32 2e20 0d0a 2020 2020  2 to j+2. ..    
+0000cbe0: 2020 2020 6861 6c66 5f77 696e 646f 7720      half_window 
+0000cbf0: 3d20 7365 6c66 2e77 696e 646f 775f 7369  = self.window_si
+0000cc00: 7a65 202f 2f32 200d 0a20 2020 2020 2020  ze //2 ..       
+0000cc10: 2066 6f72 2069 6920 696e 2072 616e 6765   for ii in range
+0000cc20: 286c 6f67 5f72 686f 3264 2e73 6861 7065  (log_rho2d.shape
+0000cc30: 5b31 5d29 3a0d 0a20 2020 2020 2020 2020  [1]):..         
+0000cc40: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0000cc50: 2069 6620 6969 203d 3d30 206f 7220 6969   if ii ==0 or ii
+0000cc60: 203d 3d6c 6f67 5f72 686f 3264 2e73 6861   ==log_rho2d.sha
+0000cc70: 7065 5b31 5d20 2d31 3a20 0d0a 2020 2020  pe[1] -1: ..    
+0000cc80: 2020 2020 2020 2020 2020 2020 7720 3d20              w = 
+0000cc90: 286c 6f67 5f72 686f 3264 5b20 3a2c 203a  (log_rho2d[ :, :
+0000cca0: 6969 202b 2068 616c 665f 7769 6e64 6f77  ii + half_window
+0000ccb0: 202b 315d 200d 0a20 2020 2020 2020 2020   +1] ..         
+0000ccc0: 2020 2020 2020 2020 2020 2020 6966 2020              if  
+0000ccd0: 6969 202d 2068 616c 665f 7769 6e64 6f77  ii - half_window
+0000cce0: 203c 2030 2065 6c73 6520 0d0a 2020 2020   < 0 else ..    
+0000ccf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cd00: 206c 6f67 5f72 686f 3264 5b3a 2c20 6969   log_rho2d[:, ii
+0000cd10: 2d68 616c 665f 7769 6e64 6f77 3a5d 200d  -half_window:] .
+0000cd20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cd30: 2020 2020 2020 2920 6966 2073 656c 662e        ) if self.
+0000cd40: 6d6f 6465 203d 3d27 7661 6c69 6427 2065  mode =='valid' e
+0000cd50: 6c73 6520 6c6f 675f 7268 6f32 645b 3a2c  lse log_rho2d[:,
+0000cd60: 2069 695d 5b3a 2c20 4e6f 6e65 5d0d 0a20   ii][:, None].. 
+0000cd70: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0000cd80: 2020 2065 6c69 6620 6969 202d 2068 616c     elif ii - hal
+0000cd90: 665f 7769 6e64 6f77 203c 2030 3a20 0d0a  f_window < 0: ..
+0000cda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cdb0: 773d 206c 6f67 5f72 686f 3264 5b20 3a2c  w= log_rho2d[ :,
+0000cdc0: 203a 6969 202b 2068 616c 665f 7769 6e64   :ii + half_wind
+0000cdd0: 6f77 202b 315d 0d0a 2020 2020 2020 2020  ow +1]..        
+0000cde0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000cdf0: 2020 2020 2020 656c 6966 2069 6920 2b20        elif ii + 
+0000ce00: 6861 6c66 5f77 696e 646f 7720 2b31 203e  half_window +1 >
+0000ce10: 206c 6f67 5f72 686f 3264 2e73 6861 7065   log_rho2d.shape
+0000ce20: 5b31 5d3a 200d 0a20 2020 2020 2020 2020  [1]: ..         
+0000ce30: 2020 2020 2020 2077 3d20 6c6f 675f 7268         w= log_rh
+0000ce40: 6f32 645b 3a2c 2069 692d 6861 6c66 5f77  o2d[:, ii-half_w
+0000ce50: 696e 646f 773a 5d0d 0a20 2020 200d 0a20  indow:]..    .. 
+0000ce60: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+0000ce70: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0000ce80: 2020 2020 2320 4469 7363 6172 6420 7468      # Discard th
+0000ce90: 6520 6c6f 7765 7374 2061 6e64 2068 6967  e lowest and hig
+0000cea0: 6865 7374 2076 616c 7565 6420 6c6f 6728  hest valued log(
+0000ceb0: 726a 2029 200d 0a20 2020 2020 2020 2020  rj ) ..         
+0000cec0: 2020 2020 2020 2023 2066 726f 6d20 7468         # from th
+0000ced0: 6520 6772 6f75 7020 6f66 2066 6976 6520  e group of five 
+0000cee0: 616e 6420 6176 6572 6167 6520 7468 6520  and average the 
+0000cef0: 7265 6d61 696e 696e 670d 0a20 2020 2020  remaining..     
+0000cf00: 2020 2020 2020 2020 2020 2023 2074 6872             # thr
+0000cf10: 6565 203d 3e20 6176 675f 6c6f 676a 2e0d  ee => avg_logj..
+0000cf20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cf30: 2077 3d20 6c6f 675f 7268 6f32 645b 3a2c   w= log_rho2d[:,
+0000cf40: 2069 692d 6861 6c66 5f77 696e 646f 7720   ii-half_window 
+0000cf50: 3a20 6861 6c66 5f77 696e 646f 7720 2b20  : half_window + 
+0000cf60: 6969 202b 2031 205d 0d0a 2020 2020 2020  ii + 1 ]..      
+0000cf70: 2020 2020 2020 2020 2020 7472 7920 3a20            try : 
+0000cf80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000cf90: 2020 2020 2020 6c73 203d 205b 206e 702e        ls = [ np.
+0000cfa0: 6465 6c65 7465 2028 775b 6969 2c20 3a5d  delete (w[ii, :]
+0000cfb0: 202c 206e 702e 7768 6572 6520 280d 0a20   , np.where (.. 
+0000cfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cfd0: 2020 2020 2020 206e 702e 6c6f 6769 6361         np.logica
+0000cfe0: 6c5f 6f72 2877 5b69 692c 203a 5d20 3d3d  l_or(w[ii, :] ==
+0000cff0: 775b 6969 2c20 3a5d 2e6d 6178 2829 2c0d  w[ii, :].max(),.
+0000d000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0000d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d020: 2020 2020 2020 2020 2020 2020 2077 5b69               w[i
-0000d030: 692c 203a 5d20 3d3d 775b 6969 2c20 3a5d  i, :] ==w[ii, :]
-0000d040: 2e6d 696e 2829 290d 0a20 2020 2020 2020  .min())..       
-0000d050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d060: 2029 2920 666f 7220 6969 2069 6e20 7261   )) for ii in ra
-0000d070: 6e67 6520 286c 656e 2877 2929 5d0d 0a20  nge (len(w))].. 
-0000d080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d090: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000d0a0: 2020 2020 2020 2020 2077 203d 206e 702e           w = np.
-0000d0b0: 7673 7461 636b 2028 6c73 290d 0a20 2020  vstack (ls)..   
-0000d0c0: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-0000d0d0: 6570 7420 3a20 0d0a 2020 2020 2020 2020  ept : ..        
-0000d0e0: 2020 2020 2020 2020 2020 2020 2320 696e              # in
-0000d0f0: 2074 6865 2063 6173 6520 7468 6520 6c73   the case the ls
-0000d100: 2068 6173 2073 6f6d 6520 6172 7261 7920   has some array 
-0000d110: 7769 7468 2064 6966 6665 7265 6e74 206c  with different l
-0000d120: 656e 6774 6820 0d0a 2020 2020 2020 2020  ength ..        
-0000d130: 2020 2020 2020 2020 2020 2020 2320 646f              # do
-0000d140: 2074 6865 2061 7665 7261 6765 206d 616e   the average man
-0000d150: 7561 6c6c 7920 616e 6420 7365 7420 6173  ually and set as
-0000d160: 2061 6e20 6172 7261 7920 6f66 2061 7869   an array of axi
-0000d170: 7320 312e 2020 0d0a 2020 2020 2020 2020  s 1.  ..        
-0000d180: 2020 2020 2020 2020 2020 2020 6c73 203d              ls =
-0000d190: 205b 6e70 2e73 756d 2877 5b69 692c 203a   [np.sum(w[ii, :
-0000d1a0: 5d29 2f20 6c65 6e28 775b 6969 2c20 3a5d  ])/ len(w[ii, :]
-0000d1b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d020: 2020 2020 2020 2077 5b69 692c 203a 5d20         w[ii, :] 
+0000d030: 3d3d 775b 6969 2c20 3a5d 2e6d 696e 2829  ==w[ii, :].min()
+0000d040: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000d050: 2020 2020 2020 2020 2020 2029 2920 666f             )) fo
+0000d060: 7220 6969 2069 6e20 7261 6e67 6520 286c  r ii in range (l
+0000d070: 656e 2877 2929 5d0d 0a20 2020 2020 2020  en(w))]..       
+0000d080: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+0000d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d0a0: 2020 2077 203d 206e 702e 7673 7461 636b     w = np.vstack
+0000d0b0: 2028 6c73 290d 0a20 2020 2020 2020 2020   (ls)..         
+0000d0c0: 2020 2020 2020 2065 7863 6570 7420 3a20         except : 
+0000d0d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d0e0: 2020 2020 2020 2320 696e 2074 6865 2063        # in the c
+0000d0f0: 6173 6520 7468 6520 6c73 2068 6173 2073  ase the ls has s
+0000d100: 6f6d 6520 6172 7261 7920 7769 7468 2064  ome array with d
+0000d110: 6966 6665 7265 6e74 206c 656e 6774 6820  ifferent length 
+0000d120: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d130: 2020 2020 2020 2320 646f 2074 6865 2061        # do the a
+0000d140: 7665 7261 6765 206d 616e 7561 6c6c 7920  verage manually 
+0000d150: 616e 6420 7365 7420 6173 2061 6e20 6172  and set as an ar
+0000d160: 7261 7920 6f66 2061 7869 7320 312e 2020  ray of axis 1.  
+0000d170: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d180: 2020 2020 2020 6c73 203d 205b 6e70 2e73        ls = [np.s
+0000d190: 756d 2877 5b69 692c 203a 5d29 2f20 6c65  um(w[ii, :])/ le
+0000d1a0: 6e28 775b 6969 2c20 3a5d 0d0a 2020 2020  n(w[ii, :]..    
+0000d1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000d1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d1e0: 2020 2920 666f 7220 6969 2069 6e20 7261    ) for ii in ra
-0000d1f0: 6e67 6528 6c65 6e28 7729 295d 0d0a 2020  nge(len(w))]..  
-0000d200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d210: 2020 7720 3d20 6e70 2e61 7272 6179 286c    w = np.array(l
-0000d220: 7329 5b3a 2c20 4e6f 6e65 5d20 2320 6d61  s)[:, None] # ma
-0000d230: 6b65 2061 7869 7320 3d20 310d 0a20 2020  ke axis = 1..   
-0000d240: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-0000d250: 2020 2020 2020 2020 2020 2077 665b 3a2c             wf[:,
-0000d260: 2069 695d 203d 206e 702e 6176 6572 6167   ii] = np.averag
-0000d270: 6520 2877 2c20 6178 6973 203d 2031 290d  e (w, axis = 1).
-0000d280: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0000d290: 2020 2020 2020 2023 2063 6f6d 7075 7465         # compute
-0000d2a0: 2074 6865 2063 6f72 7265 6374 696f 6e20   the correction 
-0000d2b0: 6661 6374 6f72 2063 660d 0a20 2020 2020  factor cf..     
-0000d2c0: 2020 2063 6620 3d20 6e70 2e70 6f77 6572     cf = np.power
-0000d2d0: 2831 302c 2077 662c 2064 7479 7065 203d  (10, wf, dtype =
-0000d2e0: 666c 6f61 7429 2f20 6e70 2e20 706f 7765  float)/ np. powe
-0000d2f0: 7228 3130 2c20 6c6f 675f 7268 6f32 6429  r(10, log_rho2d)
-0000d300: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-0000d310: 2020 2020 2072 6320 3d20 7365 6c66 2e72       rc = self.r
-0000d320: 6573 3264 5f20 2a20 6366 0d0a 2020 2020  es2d_ * cf..    
-0000d330: 2020 2020 6966 2073 6d6f 6f74 683a 200d      if smooth: .
-0000d340: 0a20 2020 2020 2020 2020 2020 2072 6320  .            rc 
-0000d350: 3d20 736d 6f6f 7468 696e 6728 2072 6320  = smoothing( rc 
-0000d360: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-0000d370: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000d380: 726f 705f 6f75 746c 6965 7273 203d 2064  rop_outliers = d
-0000d390: 726f 705f 6f75 746c 6965 7273 2c20 0d0a  rop_outliers, ..
+0000d1d0: 2020 2020 2020 2020 2020 2020 2920 666f              ) fo
+0000d1e0: 7220 6969 2069 6e20 7261 6e67 6528 6c65  r ii in range(le
+0000d1f0: 6e28 7729 295d 0d0a 2020 2020 2020 2020  n(w))]..        
+0000d200: 2020 2020 2020 2020 2020 2020 7720 3d20              w = 
+0000d210: 6e70 2e61 7272 6179 286c 7329 5b3a 2c20  np.array(ls)[:, 
+0000d220: 4e6f 6e65 5d20 2320 6d61 6b65 2061 7869  None] # make axi
+0000d230: 7320 3d20 310d 0a20 2020 2020 2020 2020  s = 1..         
+0000d240: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000d250: 2020 2020 2077 665b 3a2c 2069 695d 203d       wf[:, ii] =
+0000d260: 206e 702e 6176 6572 6167 6520 2877 2c20   np.average (w, 
+0000d270: 6178 6973 203d 2031 290d 0a20 2020 2020  axis = 1)..     
+0000d280: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000d290: 2023 2063 6f6d 7075 7465 2074 6865 2063   # compute the c
+0000d2a0: 6f72 7265 6374 696f 6e20 6661 6374 6f72  orrection factor
+0000d2b0: 2063 660d 0a20 2020 2020 2020 2063 6620   cf..        cf 
+0000d2c0: 3d20 6e70 2e70 6f77 6572 2831 302c 2077  = np.power(10, w
+0000d2d0: 662c 2064 7479 7065 203d 666c 6f61 7429  f, dtype =float)
+0000d2e0: 2f20 6e70 2e20 706f 7765 7228 3130 2c20  / np. power(10, 
+0000d2f0: 6c6f 675f 7268 6f32 6429 200d 0a20 2020  log_rho2d) ..   
+0000d300: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
+0000d310: 6320 3d20 7365 6c66 2e72 6573 3264 5f20  c = self.res2d_ 
+0000d320: 2a20 6366 0d0a 2020 2020 2020 2020 6966  * cf..        if
+0000d330: 2073 6d6f 6f74 683a 200d 0a20 2020 2020   smooth: ..     
+0000d340: 2020 2020 2020 2072 6320 3d20 736d 6f6f         rc = smoo
+0000d350: 7468 696e 6728 2072 6320 2c20 0d0a 2020  thing( rc , ..  
+0000d360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d370: 2020 2020 2020 2020 2064 726f 705f 6f75           drop_ou
+0000d380: 746c 6965 7273 203d 2064 726f 705f 6f75  tliers = drop_ou
+0000d390: 746c 6965 7273 2c20 0d0a 2020 2020 2020  tliers, ..      
 0000d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d3b0: 2020 2020 2020 2020 2020 2023 2062 6c6f             # blo
-0000d3c0: 636b 206d 6f76 696e 6720 6176 6572 6167  ck moving averag
-0000d3d0: 6520 606d 6160 200d 0a20 2020 2020 2020  e `ma` ..       
-0000d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d3f0: 2020 2020 2320 7472 6963 6b20 746f 2054      # trick to T
-0000d400: 7275 6520 746f 2070 7265 7665 6e74 2063  rue to prevent c
-0000d410: 6861 6e67 6573 200d 0a20 2020 2020 2020  hanges ..       
-0000d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d430: 2020 2020 2320 696e 2073 6d6f 6f74 6869      # in smoothi
-0000d440: 6e67 2066 756e 6374 696f 6e0d 0a20 2020  ng function..   
+0000d3b0: 2020 2020 2023 2062 6c6f 636b 206d 6f76       # block mov
+0000d3c0: 696e 6720 6176 6572 6167 6520 606d 6160  ing average `ma`
+0000d3d0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000d3e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0000d3f0: 7472 6963 6b20 746f 2054 7275 6520 746f  trick to True to
+0000d400: 2070 7265 7665 6e74 2063 6861 6e67 6573   prevent changes
+0000d410: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000d420: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0000d430: 696e 2073 6d6f 6f74 6869 6e67 2066 756e  in smoothing fun
+0000d440: 6374 696f 6e0d 0a20 2020 2020 2020 2020  ction..         
 0000d450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d460: 2020 2020 2020 2020 6d61 203d 5472 7565          ma =True
-0000d470: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000d480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d490: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
-0000d4a0: 2066 6f72 6365 2072 6573 6973 7469 7669   force resistivi
-0000d4b0: 7479 2074 6f20 6265 2070 6f73 6974 6976  ty to be positiv
-0000d4c0: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
-0000d4d0: 2320 6166 7465 7220 736d 6f6f 7468 696e  # after smoothin
-0000d4e0: 6720 6966 2065 7869 7374 7320 0d0a 2020  g if exists ..  
-0000d4f0: 2020 2020 2020 2020 2020 6966 2028 7263            if (rc
-0000d500: 203c 2030 292e 616e 7928 293a 200d 0a20   < 0).any(): .. 
-0000d510: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000d520: 6320 3d20 6e70 2e61 6273 2028 7263 2029  c = np.abs (rc )
-0000d530: 0d0a 2020 2020 2020 2020 2320 6170 706c  ..        # appl
-0000d540: 6965 6420 636f 7272 6563 7469 6f6e 2066  ied correction f
-0000d550: 6163 746f 7220 0d0a 2020 2020 2020 2020  actor ..        
-0000d560: 2320 746f 2070 6861 7365 200d 0a20 2020  # to phase ..   
-0000d570: 2020 2020 2070 6863 203d 2073 656c 662e       phc = self.
-0000d580: 7068 7332 645f 202a 2063 6620 0d0a 2020  phs2d_ * cf ..  
-0000d590: 2020 2020 2020 6966 2073 656c 662e 6f75        if self.ou
-0000d5a0: 7420 3d3d 277a 273a 200d 0a20 2020 2020  t =='z': ..     
-0000d5b0: 2020 2020 2020 2023 2072 6320 3d20 7268         # rc = rh
-0000d5c0: 6f61 327a 2872 632c 2073 656c 662e 7068  oa2z(rc, self.ph
-0000d5d0: 7332 645f 2c20 7365 6c66 2e66 7265 7173  s2d_, self.freqs
-0000d5e0: 5f29 0d0a 2020 2020 2020 2020 2020 2020  _)..            
-0000d5f0: 7263 203d 2072 686f 7068 6932 7a28 7263  rc = rhophi2z(rc
-0000d600: 2c20 7068 632c 2073 656c 662e 6672 6571  , phc, self.freq
-0000d610: 735f 290d 0a20 2020 2020 2020 2020 2020  s_)..           
-0000d620: 200d 0a20 2020 2020 2020 2069 6620 736d   ..        if sm
-0000d630: 6f6f 7468 3a20 0d0a 2020 2020 2020 2020  ooth: ..        
-0000d640: 2020 2020 7068 6320 3d20 736d 6f6f 7468      phc = smooth
-0000d650: 696e 6720 2870 6863 202c 2064 726f 705f  ing (phc , drop_
-0000d660: 6f75 746c 6965 7273 203d 2064 726f 705f  outliers = drop_
-0000d670: 6f75 746c 6965 7273 200d 0a20 2020 2020  outliers ..     
+0000d460: 2020 6d61 203d 5472 7565 2020 200d 0a20    ma =True   .. 
+0000d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d480: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+0000d490: 2020 2020 2020 2020 2023 2066 6f72 6365           # force
+0000d4a0: 2072 6573 6973 7469 7669 7479 2074 6f20   resistivity to 
+0000d4b0: 6265 2070 6f73 6974 6976 6520 0d0a 2020  be positive ..  
+0000d4c0: 2020 2020 2020 2020 2020 2320 6166 7465            # afte
+0000d4d0: 7220 736d 6f6f 7468 696e 6720 6966 2065  r smoothing if e
+0000d4e0: 7869 7374 7320 0d0a 2020 2020 2020 2020  xists ..        
+0000d4f0: 2020 2020 6966 2028 7263 203c 2030 292e      if (rc < 0).
+0000d500: 616e 7928 293a 200d 0a20 2020 2020 2020  any(): ..       
+0000d510: 2020 2020 2020 2020 2072 6320 3d20 6e70           rc = np
+0000d520: 2e61 6273 2028 7263 2029 0d0a 2020 2020  .abs (rc )..    
+0000d530: 2020 2020 2320 6170 706c 6965 6420 636f      # applied co
+0000d540: 7272 6563 7469 6f6e 2066 6163 746f 7220  rrection factor 
+0000d550: 0d0a 2020 2020 2020 2020 2320 746f 2070  ..        # to p
+0000d560: 6861 7365 200d 0a20 2020 2020 2020 2070  hase ..        p
+0000d570: 6863 203d 2073 656c 662e 7068 7332 645f  hc = self.phs2d_
+0000d580: 202a 2063 6620 0d0a 2020 2020 2020 2020   * cf ..        
+0000d590: 6966 2073 656c 662e 6f75 7420 3d3d 277a  if self.out =='z
+0000d5a0: 273a 200d 0a20 2020 2020 2020 2020 2020  ': ..           
+0000d5b0: 2023 2072 6320 3d20 7268 6f61 327a 2872   # rc = rhoa2z(r
+0000d5c0: 632c 2073 656c 662e 7068 7332 645f 2c20  c, self.phs2d_, 
+0000d5d0: 7365 6c66 2e66 7265 7173 5f29 0d0a 2020  self.freqs_)..  
+0000d5e0: 2020 2020 2020 2020 2020 7263 203d 2072            rc = r
+0000d5f0: 686f 7068 6932 7a28 7263 2c20 7068 632c  hophi2z(rc, phc,
+0000d600: 2073 656c 662e 6672 6571 735f 290d 0a20   self.freqs_).. 
+0000d610: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0000d620: 2020 2020 2069 6620 736d 6f6f 7468 3a20       if smooth: 
+0000d630: 0d0a 2020 2020 2020 2020 2020 2020 7068  ..            ph
+0000d640: 6320 3d20 736d 6f6f 7468 696e 6720 2870  c = smoothing (p
+0000d650: 6863 202c 2064 726f 705f 6f75 746c 6965  hc , drop_outlie
+0000d660: 7273 203d 2064 726f 705f 6f75 746c 6965  rs = drop_outlie
+0000d670: 7273 200d 0a20 2020 2020 2020 2020 2020  rs ..           
 0000d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d690: 2020 2020 2020 2020 2920 2020 200d 0a20          )    .. 
-0000d6a0: 2020 2020 2020 2072 6574 7572 6e20 7263         return rc
-0000d6b0: 2020 6966 206e 6f74 2072 6574 7572 6e5f    if not return_
-0000d6c0: 7068 6920 656c 7365 2028 7263 2c20 7068  phi else (rc, ph
-0000d6d0: 6320 2920 0d0a 0d0a 2020 2020 6465 6620  c ) ....    def 
-0000d6e0: 5f6d 616b 6532 6462 6c6f 6273 2028 0d0a  _make2dblobs (..
-0000d6f0: 2020 2020 2020 2020 7365 6c66 2c20 0d0a          self, ..
-0000d700: 2020 2020 2020 2020 293a 200d 0a20 2020          ): ..   
-0000d710: 2020 2020 2022 2222 2041 7373 6572 7473       """ Asserts
-0000d720: 2061 7267 756d 656e 7420 6f66 207c 454d   argument of |EM
-0000d730: 4150 7c20 6669 6c74 6572 2061 6e64 2072  AP| filter and r
-0000d740: 6574 7572 6e73 2075 7365 6675 6c20 6172  eturns useful ar
-0000d750: 6775 6d65 6e74 732e 0d0a 200d 0a20 2020  guments... ..   
-0000d760: 2020 2020 203a 6e6f 7465 3a20 6372 6561       :note: crea
-0000d770: 7465 6420 746f 2063 6f6c 6c65 6374 2061  ted to collect a
-0000d780: 7267 756d 656e 7420 6f66 2045 4d41 5020  rgument of EMAP 
-0000d790: 6669 6c74 6572 732e 2052 6566 6572 2074  filters. Refer t
-0000d7a0: 6f20 6675 6e63 7469 6f6e 7320 0d0a 2020  o functions ..  
-0000d7b0: 2020 2020 2020 3a66 756e 633a 607e 2e74        :func:`~.t
-0000d7c0: 6d61 602c 203a 6675 6e63 3a60 7e2e 666c  ma`, :func:`~.fl
-0000d7d0: 6d61 6020 616e 6420 3a66 756e 633a 607e  ma` and :func:`~
-0000d7e0: 2e61 6d61 6020 646f 6375 6d65 6e74 6174  .ama` documentat
-0000d7f0: 696f 6e2e 200d 0a20 2020 2020 2020 2022  ion. ..        "
-0000d800: 2222 0d0a 0d0a 2020 2020 2020 2020 7365  ""....        se
-0000d810: 6c66 2e63 6f6d 706f 6e65 6e74 3d20 7374  lf.component= st
-0000d820: 7228 7365 6c66 2e63 6f6d 706f 6e65 6e74  r(self.component
-0000d830: 292e 6c6f 7765 7228 292e 7374 7269 7028  ).lower().strip(
-0000d840: 2920 0d0a 2020 2020 2020 2020 7365 6c66  ) ..        self
-0000d850: 2e6f 7574 3d20 7374 7228 7365 6c66 2e6f  .out= str(self.o
-0000d860: 7574 292e 6c6f 7765 7228 292e 7374 7269  ut).lower().stri
-0000d870: 7028 2920 0d0a 2020 2020 2020 2020 0d0a  p() ..        ..
-0000d880: 2020 2020 2020 2020 7472 7920 3a20 0d0a          try : ..
-0000d890: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000d8a0: 2e63 203d 2069 6e74 2028 7365 6c66 2e63  .c = int (self.c
-0000d8b0: 2920 0d0a 2020 2020 2020 2020 6578 6365  ) ..        exce
-0000d8c0: 7074 203a 200d 0a20 2020 2020 2020 2020  pt : ..         
-0000d8d0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-0000d8e0: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
-0000d8f0: 2020 2020 2066 2745 7870 6563 7420 616e       f'Expect an
-0000d900: 2069 6e74 6567 6572 2076 616c 7565 206e   integer value n
-0000d910: 6f74 207b 7479 7065 2873 656c 662e 6329  ot {type(self.c)
-0000d920: 2e5f 5f6e 616d 655f 5f21 727d 2729 0d0a  .__name__!r}')..
-0000d930: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000d940: 2020 6966 2073 656c 662e 6f75 742e 6669    if self.out.fi
-0000d950: 6e64 2028 2766 6163 746f 7227 2920 3e3d  nd ('factor') >=
-0000d960: 2030 206f 7220 7365 6c66 2e6f 7574 203d   0 or self.out =
-0000d970: 3d27 7366 273a 200d 0a20 2020 2020 2020  ='sf': ..       
-0000d980: 2020 2020 2073 656c 662e 6f75 7420 3d27       self.out ='
-0000d990: 7366 270d 0a20 2020 2020 2020 2065 6c69  sf'..        eli
-0000d9a0: 6620 7365 6c66 2e6f 7574 2069 6e20 2827  f self.out in ('
-0000d9b0: 7a27 2c20 2769 6d70 6564 616e 6365 272c  z', 'impedance',
-0000d9c0: 2027 7465 6e73 6f72 2729 3a20 7365 6c66   'tensor'): self
-0000d9d0: 2e6f 7574 203d 277a 270d 0a20 2020 2020  .out ='z'..     
-0000d9e0: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-0000d9f0: 7365 6c66 2e63 6f6d 706f 6e65 6e74 206e  self.component n
-0000da00: 6f74 2069 6e20 2827 7878 272c 2027 7879  ot in ('xx', 'xy
-0000da10: 272c 2027 7978 272c 2027 7979 2729 3a20  ', 'yx', 'yy'): 
-0000da20: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-0000da30: 6973 6520 5661 6c75 6545 7272 6f72 2866  ise ValueError(f
-0000da40: 2255 6e61 6363 6570 7461 626c 6520 636f  "Unacceptable co
-0000da50: 6d70 6f6e 656e 7420 7b73 656c 662e 636f  mponent {self.co
-0000da60: 6d70 6f6e 656e 7421 727d 2e20 220d 0a20  mponent!r}. ".. 
+0000d690: 2020 2920 2020 200d 0a20 2020 2020 2020    )    ..       
+0000d6a0: 2072 6574 7572 6e20 7263 2020 6966 206e   return rc  if n
+0000d6b0: 6f74 2072 6574 7572 6e5f 7068 6920 656c  ot return_phi el
+0000d6c0: 7365 2028 7263 2c20 7068 6320 2920 0d0a  se (rc, phc ) ..
+0000d6d0: 0d0a 2020 2020 6465 6620 5f6d 616b 6532  ..    def _make2
+0000d6e0: 6462 6c6f 6273 2028 0d0a 2020 2020 2020  dblobs (..      
+0000d6f0: 2020 7365 6c66 2c20 0d0a 2020 2020 2020    self, ..      
+0000d700: 2020 293a 200d 0a20 2020 2020 2020 2022    ): ..        "
+0000d710: 2222 2041 7373 6572 7473 2061 7267 756d  "" Asserts argum
+0000d720: 656e 7420 6f66 207c 454d 4150 7c20 6669  ent of |EMAP| fi
+0000d730: 6c74 6572 2061 6e64 2072 6574 7572 6e73  lter and returns
+0000d740: 2075 7365 6675 6c20 6172 6775 6d65 6e74   useful argument
+0000d750: 732e 0d0a 200d 0a20 2020 2020 2020 203a  s... ..        :
+0000d760: 6e6f 7465 3a20 6372 6561 7465 6420 746f  note: created to
+0000d770: 2063 6f6c 6c65 6374 2061 7267 756d 656e   collect argumen
+0000d780: 7420 6f66 2045 4d41 5020 6669 6c74 6572  t of EMAP filter
+0000d790: 732e 2052 6566 6572 2074 6f20 6675 6e63  s. Refer to func
+0000d7a0: 7469 6f6e 7320 0d0a 2020 2020 2020 2020  tions ..        
+0000d7b0: 3a66 756e 633a 607e 2e74 6d61 602c 203a  :func:`~.tma`, :
+0000d7c0: 6675 6e63 3a60 7e2e 666c 6d61 6020 616e  func:`~.flma` an
+0000d7d0: 6420 3a66 756e 633a 607e 2e61 6d61 6020  d :func:`~.ama` 
+0000d7e0: 646f 6375 6d65 6e74 6174 696f 6e2e 200d  documentation. .
+0000d7f0: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
+0000d800: 2020 2020 2020 2020 7365 6c66 2e63 6f6d          self.com
+0000d810: 706f 6e65 6e74 3d20 7374 7228 7365 6c66  ponent= str(self
+0000d820: 2e63 6f6d 706f 6e65 6e74 292e 6c6f 7765  .component).lowe
+0000d830: 7228 292e 7374 7269 7028 2920 0d0a 2020  r().strip() ..  
+0000d840: 2020 2020 2020 7365 6c66 2e6f 7574 3d20        self.out= 
+0000d850: 7374 7228 7365 6c66 2e6f 7574 292e 6c6f  str(self.out).lo
+0000d860: 7765 7228 292e 7374 7269 7028 2920 0d0a  wer().strip() ..
+0000d870: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000d880: 2020 7472 7920 3a20 0d0a 2020 2020 2020    try : ..      
+0000d890: 2020 2020 2020 7365 6c66 2e63 203d 2069        self.c = i
+0000d8a0: 6e74 2028 7365 6c66 2e63 2920 0d0a 2020  nt (self.c) ..  
+0000d8b0: 2020 2020 2020 6578 6365 7074 203a 200d        except : .
+0000d8c0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000d8d0: 7365 2054 7970 6545 7272 6f72 280d 0a20  se TypeError(.. 
+0000d8e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000d8f0: 2745 7870 6563 7420 616e 2069 6e74 6567  'Expect an integ
+0000d900: 6572 2076 616c 7565 206e 6f74 207b 7479  er value not {ty
+0000d910: 7065 2873 656c 662e 6329 2e5f 5f6e 616d  pe(self.c).__nam
+0000d920: 655f 5f21 727d 2729 0d0a 2020 2020 2020  e__!r}')..      
+0000d930: 2020 0d0a 2020 2020 2020 2020 6966 2073    ..        if s
+0000d940: 656c 662e 6f75 742e 6669 6e64 2028 2766  elf.out.find ('f
+0000d950: 6163 746f 7227 2920 3e3d 2030 206f 7220  actor') >= 0 or 
+0000d960: 7365 6c66 2e6f 7574 203d 3d27 7366 273a  self.out =='sf':
+0000d970: 200d 0a20 2020 2020 2020 2020 2020 2073   ..            s
+0000d980: 656c 662e 6f75 7420 3d27 7366 270d 0a20  elf.out ='sf'.. 
+0000d990: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+0000d9a0: 2e6f 7574 2069 6e20 2827 7a27 2c20 2769  .out in ('z', 'i
+0000d9b0: 6d70 6564 616e 6365 272c 2027 7465 6e73  mpedance', 'tens
+0000d9c0: 6f72 2729 3a20 7365 6c66 2e6f 7574 203d  or'): self.out =
+0000d9d0: 277a 270d 0a20 2020 2020 2020 200d 0a20  'z'..        .. 
+0000d9e0: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
+0000d9f0: 6f6d 706f 6e65 6e74 206e 6f74 2069 6e20  omponent not in 
+0000da00: 2827 7878 272c 2027 7879 272c 2027 7978  ('xx', 'xy', 'yx
+0000da10: 272c 2027 7979 2729 3a20 0d0a 2020 2020  ', 'yy'): ..    
+0000da20: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0000da30: 6c75 6545 7272 6f72 2866 2255 6e61 6363  lueError(f"Unacc
+0000da40: 6570 7461 626c 6520 636f 6d70 6f6e 656e  eptable componen
+0000da50: 7420 7b73 656c 662e 636f 6d70 6f6e 656e  t {self.componen
+0000da60: 7421 727d 2e20 220d 0a20 2020 2020 2020  t!r}. "..       
 0000da70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da80: 2020 2020 2020 2020 2020 2020 2245 7870              "Exp
-0000da90: 6563 7420 2778 7827 2c20 2778 7927 2c20  ect 'xx', 'xy', 
-0000daa0: 2779 7827 206f 7220 2779 7927 2229 0d0a  'yx' or 'yy'")..
-0000dab0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000dac0: 2020 7365 6c66 2e72 6573 3264 5f3d 2073    self.res2d_= s
-0000dad0: 656c 662e 6d61 6b65 3264 286f 7574 3d66  elf.make2d(out=f
-0000dae0: 2772 6573 7b73 656c 662e 636f 6d70 6f6e  'res{self.compon
-0000daf0: 656e 747d 2729 0d0a 2020 2020 2020 2020  ent}')..        
-0000db00: 7365 6c66 2e70 6873 3264 5f20 3d20 7365  self.phs2d_ = se
-0000db10: 6c66 2e6d 616b 6532 6428 6f75 743d 6627  lf.make2d(out=f'
-0000db20: 7068 6173 657b 7365 6c66 2e63 6f6d 706f  phase{self.compo
-0000db30: 6e65 6e74 7d27 290d 0a20 2020 2020 2020  nent}')..       
-0000db40: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-0000db50: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-0000db60: 7365 6c66 2e72 6573 3264 5f29 2021 3d20  self.res2d_) != 
-0000db70: 6c65 6e28 7365 6c66 2e66 7265 7173 5f29  len(self.freqs_)
-0000db80: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0000db90: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0000dba0: 2028 2252 6573 6973 7469 7669 7479 2061   ("Resistivity a
-0000dbb0: 6e64 2066 7265 7175 656e 6379 2061 7272  nd frequency arr
-0000dbc0: 6179 7320 6d75 7374 2068 6176 6520 6120  ays must have a 
-0000dbd0: 7361 6d65 220d 0a20 2020 2020 2020 2020  same"..         
-0000dbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dbf0: 2066 2220 6c65 6e67 7468 2e20 4275 7420   f" length. But 
-0000dc00: 7b6c 656e 2873 656c 662e 7265 7332 645f  {len(self.res2d_
-0000dc10: 297d 2026 207b 6c65 6e28 7365 6c66 2e66  )} & {len(self.f
-0000dc20: 7265 7173 5f29 7d22 0d0a 2020 2020 2020  reqs_)}"..      
-0000dc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dc40: 2020 2020 2220 7765 7265 2067 6976 656e      " were given
-0000dc50: 2229 0d0a 2020 2020 2020 2020 6966 206c  ")..        if l
-0000dc60: 656e 2873 656c 662e 7265 7332 645f 2920  en(self.res2d_) 
-0000dc70: 213d 206c 656e 2873 656c 662e 7068 7332  != len(self.phs2
-0000dc80: 645f 293a 200d 0a20 2020 2020 2020 2020  d_): ..         
-0000dc90: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0000dca0: 726f 7220 2822 5265 7369 7374 6976 6974  ror ("Resistivit
-0000dcb0: 7920 616e 6420 7068 6173 6520 6d75 7374  y and phase must
-0000dcc0: 2068 6176 6520 7468 6520 7361 6d65 206c   have the same l
-0000dcd0: 656e 6774 682e 220d 0a20 2020 2020 2020  ength."..       
+0000da80: 2020 2020 2020 2245 7870 6563 7420 2778        "Expect 'x
+0000da90: 7827 2c20 2778 7927 2c20 2779 7827 206f  x', 'xy', 'yx' o
+0000daa0: 7220 2779 7927 2229 0d0a 2020 2020 2020  r 'yy'")..      
+0000dab0: 2020 0d0a 2020 2020 2020 2020 7365 6c66    ..        self
+0000dac0: 2e72 6573 3264 5f3d 2073 656c 662e 6d61  .res2d_= self.ma
+0000dad0: 6b65 3264 286f 7574 3d66 2772 6573 7b73  ke2d(out=f'res{s
+0000dae0: 656c 662e 636f 6d70 6f6e 656e 747d 2729  elf.component}')
+0000daf0: 0d0a 2020 2020 2020 2020 7365 6c66 2e70  ..        self.p
+0000db00: 6873 3264 5f20 3d20 7365 6c66 2e6d 616b  hs2d_ = self.mak
+0000db10: 6532 6428 6f75 743d 6627 7068 6173 657b  e2d(out=f'phase{
+0000db20: 7365 6c66 2e63 6f6d 706f 6e65 6e74 7d27  self.component}'
+0000db30: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+0000db40: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0000db50: 2020 2069 6620 6c65 6e28 7365 6c66 2e72     if len(self.r
+0000db60: 6573 3264 5f29 2021 3d20 6c65 6e28 7365  es2d_) != len(se
+0000db70: 6c66 2e66 7265 7173 5f29 3a20 0d0a 2020  lf.freqs_): ..  
+0000db80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000db90: 5661 6c75 6545 7272 6f72 2028 2252 6573  ValueError ("Res
+0000dba0: 6973 7469 7669 7479 2061 6e64 2066 7265  istivity and fre
+0000dbb0: 7175 656e 6379 2061 7272 6179 7320 6d75  quency arrays mu
+0000dbc0: 7374 2068 6176 6520 6120 7361 6d65 220d  st have a same".
+0000dbd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000dbe0: 2020 2020 2020 2020 2020 2066 2220 6c65             f" le
+0000dbf0: 6e67 7468 2e20 4275 7420 7b6c 656e 2873  ngth. But {len(s
+0000dc00: 656c 662e 7265 7332 645f 297d 2026 207b  elf.res2d_)} & {
+0000dc10: 6c65 6e28 7365 6c66 2e66 7265 7173 5f29  len(self.freqs_)
+0000dc20: 7d22 0d0a 2020 2020 2020 2020 2020 2020  }"..            
+0000dc30: 2020 2020 2020 2020 2020 2020 2020 2220                " 
+0000dc40: 7765 7265 2067 6976 656e 2229 0d0a 2020  were given")..  
+0000dc50: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
+0000dc60: 662e 7265 7332 645f 2920 213d 206c 656e  f.res2d_) != len
+0000dc70: 2873 656c 662e 7068 7332 645f 293a 200d  (self.phs2d_): .
+0000dc80: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000dc90: 7365 2056 616c 7565 4572 726f 7220 2822  se ValueError ("
+0000dca0: 5265 7369 7374 6976 6974 7920 616e 6420  Resistivity and 
+0000dcb0: 7068 6173 6520 6d75 7374 2068 6176 6520  phase must have 
+0000dcc0: 7468 6520 7361 6d65 206c 656e 6774 682e  the same length.
+0000dcd0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
 0000dce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dcf0: 2020 2020 2020 2066 2220 4275 7420 7b6c         f" But {l
-0000dd00: 656e 2873 656c 662e 7265 7332 645f 297d  en(self.res2d_)}
-0000dd10: 2026 207b 6c65 6e28 7365 6c66 2e70 6873   & {len(self.phs
-0000dd20: 3264 5f29 7d20 220d 0a20 2020 2020 2020  2d_)} "..       
+0000dcf0: 2066 2220 4275 7420 7b6c 656e 2873 656c   f" But {len(sel
+0000dd00: 662e 7265 7332 645f 297d 2026 207b 6c65  f.res2d_)} & {le
+0000dd10: 6e28 7365 6c66 2e70 6873 3264 5f29 7d20  n(self.phs2d_)} 
+0000dd20: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
 0000dd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd40: 2020 2020 2020 2022 7765 7265 2067 6976         "were giv
-0000dd50: 656e 2e22 290d 0a20 2020 2020 2020 2074  en.")..        t
-0000dd60: 7279 203a 200d 0a20 2020 2020 2020 2020  ry : ..         
-0000dd70: 2020 2073 656c 662e 7769 6e64 6f77 5f73     self.window_s
-0000dd80: 697a 6520 3d20 696e 7428 7365 6c66 2e77  ize = int(self.w
-0000dd90: 696e 646f 775f 7369 7a65 290d 0a20 2020  indow_size)..   
-0000dda0: 2020 2020 2065 7863 6570 7420 5661 6c75       except Valu
-0000ddb0: 6545 7272 6f72 203a 200d 0a20 2020 2020  eError : ..     
-0000ddc0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000ddd0: 7565 4572 726f 7220 280d 0a20 2020 2020  ueError (..     
-0000dde0: 2020 2020 2020 2020 2020 2027 436f 756c             'Coul
-0000ddf0: 6420 6e6f 7420 636f 6e76 6572 7420 7b74  d not convert {t
-0000de00: 7970 6528 7365 6c66 2e77 696e 646f 775f  ype(self.window_
-0000de10: 7369 7a65 292e 5f5f 6e61 6d65 5f5f 2172  size).__name__!r
-0000de20: 7d20 270d 0a20 2020 2020 2020 2020 2020  } '..           
-0000de30: 2020 2020 2020 2774 6f20 696e 7465 6765        'to intege
-0000de40: 723a 207b 7365 6c66 2e77 696e 646f 775f  r: {self.window_
-0000de50: 7369 7a65 2172 7d27 290d 0a20 2020 2020  size!r}')..     
-0000de60: 0d0a 2020 2020 2020 2020 7365 6c66 2e72  ..        self.r
-0000de70: 6573 3264 5f20 3d20 6e70 2e61 7272 6179  es2d_ = np.array
-0000de80: 2028 7365 6c66 2e72 6573 3264 5f29 0d0a   (self.res2d_)..
-0000de90: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000dea0: 7769 6e64 6f77 5f73 697a 6520 3e20 7365  window_size > se
-0000deb0: 6c66 2e72 6573 3264 5f2e 7368 6170 6520  lf.res2d_.shape 
-0000dec0: 5b31 5d3a 0d0a 2020 2020 2020 2020 2020  [1]:..          
-0000ded0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0000dee0: 6f72 2028 2277 696e 646f 7720 7369 7a65  or ("window size
-0000def0: 206d 6967 6874 206e 6f74 2062 6520 6c65   might not be le
-0000df00: 7373 2074 6861 6e22 0d0a 2020 2020 2020  ss than"..      
+0000dd40: 2022 7765 7265 2067 6976 656e 2e22 290d   "were given.").
+0000dd50: 0a20 2020 2020 2020 2074 7279 203a 200d  .        try : .
+0000dd60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000dd70: 662e 7769 6e64 6f77 5f73 697a 6520 3d20  f.window_size = 
+0000dd80: 696e 7428 7365 6c66 2e77 696e 646f 775f  int(self.window_
+0000dd90: 7369 7a65 290d 0a20 2020 2020 2020 2065  size)..        e
+0000dda0: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
+0000ddb0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+0000ddc0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0000ddd0: 7220 280d 0a20 2020 2020 2020 2020 2020  r (..           
+0000dde0: 2020 2020 2027 436f 756c 6420 6e6f 7420       'Could not 
+0000ddf0: 636f 6e76 6572 7420 7b74 7970 6528 7365  convert {type(se
+0000de00: 6c66 2e77 696e 646f 775f 7369 7a65 292e  lf.window_size).
+0000de10: 5f5f 6e61 6d65 5f5f 2172 7d20 270d 0a20  __name__!r} '.. 
+0000de20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000de30: 2774 6f20 696e 7465 6765 723a 207b 7365  'to integer: {se
+0000de40: 6c66 2e77 696e 646f 775f 7369 7a65 2172  lf.window_size!r
+0000de50: 7d27 290d 0a20 2020 2020 0d0a 2020 2020  }')..     ..    
+0000de60: 2020 2020 7365 6c66 2e72 6573 3264 5f20      self.res2d_ 
+0000de70: 3d20 6e70 2e61 7272 6179 2028 7365 6c66  = np.array (self
+0000de80: 2e72 6573 3264 5f29 0d0a 2020 2020 2020  .res2d_)..      
+0000de90: 2020 6966 2073 656c 662e 7769 6e64 6f77    if self.window
+0000dea0: 5f73 697a 6520 3e20 7365 6c66 2e72 6573  _size > self.res
+0000deb0: 3264 5f2e 7368 6170 6520 5b31 5d3a 0d0a  2d_.shape [1]:..
+0000dec0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000ded0: 6520 5661 6c75 6545 7272 6f72 2028 2277  e ValueError ("w
+0000dee0: 696e 646f 7720 7369 7a65 206d 6967 6874  indow size might
+0000def0: 206e 6f74 2062 6520 6c65 7373 2074 6861   not be less tha
+0000df00: 6e22 0d0a 2020 2020 2020 2020 2020 2020  n"..            
 0000df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000df20: 2020 2020 2020 2020 6622 207b 7374 7228          f" {str(
-0000df30: 7365 6c66 2e72 6573 3264 5f2e 7368 6170  self.res2d_.shap
-0000df40: 6520 5b31 5d29 2172 7d22 290d 0a20 2020  e [1])!r}")..   
-0000df50: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
-0000df60: 6574 7572 6e20 2873 656c 662e 7265 7332  eturn (self.res2
-0000df70: 645f 202c 2073 656c 662e 7068 7332 645f  d_ , self.phs2d_
-0000df80: 202c 2073 656c 662e 6672 6571 735f 2c20   , self.freqs_, 
-0000df90: 7365 6c66 2e63 2c0d 0a20 2020 2020 2020  self.c,..       
-0000dfa0: 2020 2020 2020 2020 2073 656c 662e 7769           self.wi
-0000dfb0: 6e64 6f77 5f73 697a 652c 2073 656c 662e  ndow_size, self.
-0000dfc0: 636f 6d70 6f6e 656e 742c 2073 656c 662e  component, self.
-0000dfd0: 6f75 7429 200d 0a0d 0a20 2020 2064 6566  out) ....    def
-0000dfe0: 2061 6d61 2028 0d0a 2020 2020 2020 2020   ama (..        
-0000dff0: 7365 6c66 2c20 0d0a 2020 2020 2020 2020  self, ..        
-0000e000: 736d 6f6f 7468 3a62 6f6f 6c20 3d54 7275  smooth:bool =Tru
-0000e010: 652c 200d 0a20 2020 2020 2020 2064 726f  e, ..        dro
-0000e020: 705f 6f75 746c 6965 7273 3a62 6f6f 6c3d  p_outliers:bool=
-0000e030: 5472 7565 2c20 0d0a 2020 2020 2020 2020  True, ..        
-0000e040: 7265 7475 726e 5f70 6869 3a20 626f 6f6c  return_phi: bool
-0000e050: 3d46 616c 7365 2c20 0d0a 2020 2020 2020  =False, ..      
-0000e060: 2020 293a 0d0a 2020 2020 2020 2020 2222    ):..        ""
-0000e070: 2220 0d0a 2020 2020 2020 2020 5573 6520  " ..        Use 
-0000e080: 616e 2061 6461 7074 6976 652d 6d6f 7669  an adaptive-movi
-0000e090: 6e67 2d61 7665 7261 6765 2066 696c 7465  ng-average filte
-0000e0a0: 7220 746f 2065 7374 696d 6174 6520 6176  r to estimate av
-0000e0b0: 6572 6167 6520 6170 7061 7265 6e74 200d  erage apparent .
-0000e0c0: 0a20 2020 2020 2020 2072 6573 6973 7469  .        resisti
-0000e0d0: 7669 7469 6573 2061 7420 6120 7369 6e67  vities at a sing
-0000e0e0: 6c65 2073 7461 7469 632d 636f 7272 6563  le static-correc
-0000e0f0: 7469 6f6e 2d72 6566 6572 656e 6365 2066  tion-reference f
-0000e100: 7265 7175 656e 6379 2e2e 200d 0a20 2020  requency.. ..   
-0000e110: 2020 2020 200d 0a20 2020 2020 2020 2054       ..        T
-0000e120: 6865 2041 4d41 2066 696c 7465 7220 6573  he AMA filter es
-0000e130: 7469 6d61 7465 7320 7374 6174 6963 2d63  timates static-c
-0000e140: 6f72 7265 6374 6564 2061 7070 6172 656e  orrected apparen
-0000e150: 7420 7265 7369 7374 6976 6974 6965 7320  t resistivities 
-0000e160: 6174 2061 200d 0a20 2020 2020 2020 2073  at a ..        s
-0000e170: 696e 676c 6520 7265 6665 7265 6e63 6520  ingle reference 
-0000e180: 6672 6571 7565 6e63 7920 6279 2063 616c  frequency by cal
-0000e190: 6375 6c61 7469 6e67 2061 2070 726f 6669  culating a profi
-0000e1a0: 6c65 206f 6620 6176 6572 6167 6520 696d  le of average im
-0000e1b0: 7065 6461 6e63 6573 200d 0a20 2020 2020  pedances ..     
-0000e1c0: 2020 2061 6c6f 6e67 2074 6865 206c 656e     along the len
-0000e1d0: 6774 6820 6f66 2074 6865 206c 696e 652e  gth of the line.
-0000e1e0: 2053 6f75 6e64 696e 6720 6375 7276 6573   Sounding curves
-0000e1f0: 2061 7265 2074 6865 6e20 7368 6966 7465   are then shifte
-0000e200: 6420 736f 2074 6861 7420 7468 6579 0d0a  d so that they..
-0000e210: 2020 2020 2020 2020 696e 7465 7273 6563          intersec
-0000e220: 7420 7468 6520 6176 6572 6167 6564 2070  t the averaged p
-0000e230: 726f 6669 6c65 2e20 0d0a 2020 2020 2020  rofile. ..      
-0000e240: 2020 0d0a 2020 2020 2020 2020 5061 7261    ..        Para
-0000e250: 6d65 7465 7273 200d 0a20 2020 2020 2020  meters ..       
-0000e260: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-0000e270: 2020 2020 2073 6d6f 6f74 683a 2062 6f6f       smooth: boo
-0000e280: 6c2c 2064 6566 6175 6c74 3d54 7275 652c  l, default=True,
-0000e290: 200d 0a20 2020 2020 2020 2020 2020 536d   ..           Sm
-0000e2a0: 6f6f 7468 2074 6865 2074 656e 736f 7220  ooth the tensor 
-0000e2b0: 6461 7461 2061 6c6f 6e67 2074 6865 2066  data along the f
-0000e2c0: 7265 7175 656e 6369 6573 2e20 0d0a 2020  requencies. ..  
-0000e2d0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000e2e0: 6472 6f70 5f6f 7574 6c69 6572 733a 2062  drop_outliers: b
-0000e2f0: 6f6f 6c2c 2064 6566 6175 6c74 3d54 7275  ool, default=Tru
-0000e300: 6520 0d0a 2020 2020 2020 2020 2020 2053  e ..           S
-0000e310: 7570 7072 6573 7320 6f75 746c 6965 7273  uppress outliers
-0000e320: 2069 6e20 7468 6520 6461 7461 2077 6865   in the data whe
-0000e330: 6e20 736d 6f6f 7468 696e 6720 6461 7461  n smoothing data
-0000e340: 2061 6c6f 6e67 200d 0a20 2020 2020 2020   along ..       
-0000e350: 2020 2020 7468 6520 6672 6571 7565 6e63      the frequenc
-0000e360: 6965 7320 6178 6973 2e20 4e6f 7465 2074  ies axis. Note t
-0000e370: 6861 7420 6064 726f 705f 6f75 746c 6965  hat `drop_outlie
-0000e380: 7273 6020 646f 6573 206e 6f74 2074 616b  rs` does not tak
-0000e390: 6520 0d0a 2020 2020 2020 2020 2020 2065  e ..           e
-0000e3a0: 6666 6563 7420 6966 2060 736d 6f6f 7468  ffect if `smooth
-0000e3b0: 6020 6973 2060 6046 616c 7365 6060 2e0d  ` is ``False``..
-0000e3c0: 0a20 2020 2020 2020 2020 2020 0d0a 2020  .           ..  
-0000e3d0: 2020 2020 2020 7265 7475 726e 5f70 6869        return_phi
-0000e3e0: 3a20 626f 6f6c 2c20 6465 6661 756c 743d  : bool, default=
-0000e3f0: 4661 6c73 652c 200d 0a20 2020 2020 2020  False, ..       
-0000e400: 2020 2020 7265 7475 726e 2063 6f72 7265      return corre
-0000e410: 6374 6564 2070 6861 7365 2e20 4d6f 7374  cted phase. Most
-0000e420: 6c79 2074 6865 2070 6861 7365 2064 6f65  ly the phase doe
-0000e430: 7320 6e6f 7420 6e65 6564 2074 6f20 636f  s not need to co
-0000e440: 7272 6563 7420 0d0a 2020 2020 2020 2020  rrect ..        
-0000e450: 2020 2073 696e 6365 2069 7420 6973 206e     since it is n
-0000e460: 6f74 2061 6666 6563 7465 6420 6279 2074  ot affected by t
-0000e470: 6865 2073 7461 7469 6320 7368 6966 7420  he static shift 
-0000e480: 6566 6665 6374 2e20 486f 7765 7665 722c  effect. However,
-0000e490: 2069 7420 0d0a 2020 2020 2020 2020 2020   it ..          
-0000e4a0: 2063 616e 2062 6520 6173 2073 6d6f 6f74   can be as smoot
-0000e4b0: 6820 7068 6173 6520 6375 7276 6520 7768  h phase curve wh
-0000e4c0: 656e 2060 6073 6d6f 6f74 683d 5472 7565  en ``smooth=True
-0000e4d0: 6060 0d0a 2020 2020 2020 2020 2020 0d0a  ``..          ..
-0000e4e0: 2020 2020 2020 2020 2e2e 2076 6572 7369          .. versi
-0000e4f0: 6f6e 6164 6465 643a 3a20 302e 322e 3120  onadded:: 0.2.1 
-0000e500: 0d0a 2020 2020 2020 2020 2020 2050 6f6c  ..           Pol
-0000e510: 6973 6820 7468 6520 7465 6e73 6f72 2064  ish the tensor d
-0000e520: 6174 6120 616c 6f6e 6720 7468 6520 6672  ata along the fr
-0000e530: 6571 7565 6e63 7920 6178 6973 2072 656d  equency axis rem
-0000e540: 6f76 6520 6e6f 6973 6573 200d 0a20 2020  ove noises ..   
-0000e550: 2020 2020 2020 2020 616e 6420 6465 616c          and deal
-0000e560: 2077 6974 6820 7468 6520 7374 6174 6963   with the static
-0000e570: 2073 6869 6674 2065 6666 6563 7420 7768   shift effect wh
-0000e580: 656e 2069 6e74 6572 6665 7265 6e63 6573  en interferences
-0000e590: 206e 6f69 7365 7320 0d0a 2020 2020 2020   noises ..      
-0000e5a0: 2020 2020 2061 7265 2073 7472 6f6e 6720       are strong 
-0000e5b0: 656e 6f75 6768 2e20 0d0a 2020 2020 2020  enough. ..      
-0000e5c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000e5d0: 5265 7475 726e 7320 0d0a 2020 2020 2020  Returns ..      
-0000e5e0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0000e5f0: 2020 2072 633a 206e 702e 6e64 6172 7261     rc: np.ndarra
-0000e600: 792c 2073 6861 7065 2020 284e 2c20 4d29  y, shape  (N, M)
-0000e610: 0d0a 2020 2020 2020 2020 2020 2020 454d  ..            EM
-0000e620: 4150 2061 7070 6172 656e 7420 2072 6573  AP apparent  res
-0000e630: 6973 7469 7669 7479 2073 7461 7469 6320  istivity static 
-0000e640: 7368 6966 7420 636f 7272 6563 7465 6420  shift corrected 
-0000e650: 6f72 2073 7461 7469 6320 0d0a 2020 2020  or static ..    
-0000e660: 2020 2020 2020 2020 636f 7272 6563 7469          correcti
-0000e670: 6f6e 2066 6163 746f 7220 6f72 2069 6d70  on factor or imp
-0000e680: 6564 616e 6365 2074 656e 736f 722e 0d0a  edance tensor...
-0000e690: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-0000e6a0: 2020 2020 2020 7263 2c20 7068 695f 633a        rc, phi_c:
-0000e6b0: 2054 7570 6c65 206f 6620 7368 6170 6520   Tuple of shape 
-0000e6c0: 284e 2c20 4e29 200d 0a20 2020 2020 2020  (N, N) ..       
-0000e6d0: 2020 2020 454d 4150 2061 7070 6172 656e      EMAP apparen
-0000e6e0: 7420 7265 7369 7374 6976 6974 7920 616e  t resistivity an
-0000e6f0: 6420 7068 6173 6520 636f 7272 6563 7465  d phase correcte
-0000e700: 642e 200d 0a20 2020 2020 2020 2020 2020  d. ..           
-0000e710: 200d 0a20 2020 2020 2020 2045 7861 6d70   ..        Examp
-0000e720: 6c65 0d0a 2020 2020 2020 2020 2d2d 2d2d  le..        ----
-0000e730: 2d2d 2d2d 0d0a 2020 2020 2020 2020 3e3e  ----..        >>
-0000e740: 3e20 696d 706f 7274 2077 6174 6578 2061  > import watex a
-0000e750: 7320 7778 0d0a 2020 2020 2020 2020 3e3e  s wx..        >>
-0000e760: 3e20 696d 706f 7274 206d 6174 706c 6f74  > import matplot
-0000e770: 6c69 622e 7079 706c 6f74 2061 7320 706c  lib.pyplot as pl
-0000e780: 7420 0d0a 2020 2020 2020 2020 3e3e 3e20  t ..        >>> 
-0000e790: 6564 695f 6461 7461 203d 2077 782e 6665  edi_data = wx.fe
-0000e7a0: 7463 685f 6461 7461 2028 2765 6469 7327  tch_data ('edis'
-0000e7b0: 2c20 6173 5f66 7261 6d65 203d 5472 7565  , as_frame =True
-0000e7c0: 2c20 6b65 7920 3d27 6564 6927 290d 0a20  , key ='edi').. 
-0000e7d0: 2020 2020 2020 203e 3e3e 2070 203d 2077         >>> p = w
-0000e7e0: 782e 454d 5072 6f63 6573 7369 6e67 2028  x.EMProcessing (
-0000e7f0: 6f75 743d 277a 2729 2e66 6974 2865 6469  out='z').fit(edi
-0000e800: 5f64 6174 612e 6564 6929 200d 0a20 2020  _data.edi) ..   
-0000e810: 2020 2020 203e 3e3e 207a 5f63 6f72 7265       >>> z_corre
-0000e820: 6374 6564 203d 2070 2e61 6d61 2028 2920  cted = p.ama () 
-0000e830: 2320 6f75 7470 7574 207a 2069 6e20 636f  # output z in co
-0000e840: 6d70 6c65 7820 6474 7970 6520 0d0a 2020  mplex dtype ..  
-0000e850: 2020 2020 2020 3e3e 3e20 706c 742e 706c        >>> plt.pl
-0000e860: 6f74 2028 6e70 2e61 7261 6e67 6520 286c  ot (np.arange (l
-0000e870: 656e 2870 2e65 6469 4f62 6a73 5f29 2920  en(p.ediObjs_)) 
-0000e880: 2c20 6e70 2e61 6273 2820 0d0a 2020 2020  , np.abs( ..    
-0000e890: 2020 2020 2020 2020 5b20 6564 696f 626a          [ ediobj
-0000e8a0: 2e5a 2e7a 5b3a 2c20 302c 2031 5d5b 375d  .Z.z[:, 0, 1][7]
-0000e8b0: 2020 666f 7220 6564 696f 626a 2069 6e20    for ediobj in 
-0000e8c0: 702e 6564 694f 626a 735f 5d29 202c 2027  p.ediObjs_]) , '
-0000e8d0: 2d6f 6b27 2c0d 0a20 2020 2020 2020 2020  -ok',..         
-0000e8e0: 2020 206e 702e 6172 616e 6765 286c 656e     np.arange(len
-0000e8f0: 2870 2e65 6469 4f62 6a73 5f29 292c 206e  (p.ediObjs_)), n
-0000e900: 702e 6162 7328 207a 5f63 6f72 7265 6374  p.abs( z_correct
-0000e910: 6564 5b37 2c3a 205d 2920 2c20 276f 722d  ed[7,: ]) , 'or-
-0000e920: 2729 0d0a 2020 2020 2020 2020 0d0a 2020  ')..        ..  
-0000e930: 2020 2020 2020 5265 6665 7265 6e63 6573        References
-0000e940: 200d 0a20 2020 2020 2020 202d 2d2d 2d2d   ..        -----
-0000e950: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0000e960: 2e2e 205b 315d 2068 7474 703a 2f2f 7777  .. [1] http://ww
-0000e970: 772e 7a6f 6e67 652e 636f 6d2f 6c65 6761  w.zonge.com/lega
-0000e980: 6379 2f50 4446 5f44 6174 5072 6f2f 4173  cy/PDF_DatPro/As
-0000e990: 7461 7469 632e 7064 660d 0a20 2020 2020  tatic.pdf..     
-0000e9a0: 2020 202e 2e20 5b32 5d20 546f 7272 6573     .. [2] Torres
-0000e9b0: 2d56 6572 6469 6e20 616e 6420 426f 7374  -Verdin and Bost
-0000e9c0: 6963 6b2c 2031 3939 322c 2020 5072 696e  ick, 1992,  Prin
-0000e9d0: 6369 706c 6573 206f 6620 7370 6174 6961  ciples of spatia
-0000e9e0: 6c20 7375 7266 6163 6520 0d0a 2020 2020  l surface ..    
-0000e9f0: 2020 2020 2020 2020 656c 6563 7472 6963          electric
-0000ea00: 2066 6965 6c64 2066 696c 7465 7269 6e67   field filtering
-0000ea10: 2069 6e20 6d61 676e 6574 6f74 656c 6c75   in magnetotellu
-0000ea20: 7269 6373 3a20 656c 6563 7472 6f6d 6167  rics: electromag
-0000ea30: 6e65 7469 6320 6172 7261 7920 7072 6f66  netic array prof
-0000ea40: 696c 696e 670d 0a20 2020 2020 2020 2020  iling..         
-0000ea50: 2020 2028 454d 4150 292c 2047 656f 7068     (EMAP), Geoph
-0000ea60: 7973 6963 732c 2076 3537 2c20 7036 3033  ysics, v57, p603
-0000ea70: 2d36 3232 2e68 7474 7073 3a2f 2f64 6f69  -622.https://doi
-0000ea80: 2e6f 7267 2f31 302e 3131 3930 2f31 2e32  .org/10.1190/1.2
-0000ea90: 3430 3036 3235 0d0a 2020 2020 2020 2020  400625..        
-0000eaa0: 2020 2020 0d0a 2020 2020 2020 2020 2222      ..        ""
-0000eab0: 220d 0a20 2020 2020 2020 2073 656c 662e  "..        self.
-0000eac0: 696e 7370 6563 7420 0d0a 0d0a 2020 2020  inspect ....    
-0000ead0: 2020 2020 2320 6173 7365 7274 2066 696c      # assert fil
-0000eae0: 7465 7220 6172 6775 6d65 6e74 7320 0d0a  ter arguments ..
-0000eaf0: 2020 2020 2020 2020 7365 6c66 2e72 6573          self.res
-0000eb00: 3264 5f20 2c20 7365 6c66 2e70 6873 3264  2d_ , self.phs2d
-0000eb10: 5f20 2c20 7365 6c66 2e66 7265 7173 5f2c  _ , self.freqs_,
-0000eb20: 2073 656c 662e 632c 2073 656c 662e 7769   self.c, self.wi
-0000eb30: 6e64 6f77 5f73 697a 652c 205c 0d0a 2020  ndow_size, \..  
-0000eb40: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-0000eb50: 6f6d 706f 6e65 6e74 2c20 7365 6c66 2e6f  omponent, self.o
-0000eb60: 7574 203d 2073 656c 662e 5f6d 616b 6532  ut = self._make2
-0000eb70: 6462 6c6f 6273 2028 290d 0a20 2020 2020  dblobs ()..     
-0000eb80: 2020 2023 2020 696e 7465 7270 6f6c 6174     #  interpolat
-0000eb90: 6520 7265 7369 7374 6976 6974 7920 616e  e resistivity an
-0000eba0: 6420 7068 6173 6573 200d 0a20 2020 2020  d phases ..     
-0000ebb0: 2020 2073 656c 662e 7068 7332 645f 3d20     self.phs2d_= 
-0000ebc0: 696e 7465 7270 6f6c 6174 6532 6428 7365  interpolate2d(se
-0000ebd0: 6c66 2e70 6873 3264 5f2c 206d 6574 686f  lf.phs2d_, metho
-0000ebe0: 6420 3d73 656c 662e 6d65 7468 6f64 290d  d =self.method).
-0000ebf0: 0a20 2020 2020 2020 2073 656c 662e 7265  .        self.re
-0000ec00: 7332 645f 3d20 696e 7465 7270 6f6c 6174  s2d_= interpolat
-0000ec10: 6532 6428 7365 6c66 2e72 6573 3264 5f2c  e2d(self.res2d_,
-0000ec20: 206d 6574 686f 6420 3d73 656c 662e 6d65   method =self.me
-0000ec30: 7468 6f64 2c29 0d0a 2020 2020 2020 2020  thod,)..        
-0000ec40: 0d0a 2020 2020 2020 2020 2320 636f 6e76  ..        # conv
-0000ec50: 6572 7420 6170 702e 2072 6573 6973 7469  ert app. resisti
-0000ec60: 7669 7479 2061 6e64 2069 6d70 6564 616e  vity and impedan
-0000ec70: 6365 2070 6861 7365 2020 746f 200d 0a20  ce phase  to .. 
-0000ec80: 2020 2020 2020 2023 2069 6d70 6564 616e         # impedan
-0000ec90: 6365 2076 616c 7565 732c 205a 6a2c 2066  ce values, Zj, f
-0000eca0: 6f72 2065 6163 6820 7374 6174 696f 6e0d  or each station.
-0000ecb0: 0a20 2020 2020 2020 206f 6d65 6761 3020  .        omega0 
-0000ecc0: 3d20 3220 2a20 6e70 2e70 6920 2a20 7365  = 2 * np.pi * se
-0000ecd0: 6c66 2e66 7265 7173 5f0d 0a20 2020 2020  lf.freqs_..     
-0000ece0: 2020 207a 6a20 3d20 6e70 2e73 7172 7428     zj = np.sqrt(
-0000ecf0: 7365 6c66 2e72 6573 3264 5f20 2a20 6f6d  self.res2d_ * om
-0000ed00: 6567 6130 5b3a 2c20 4e6f 6e65 5d20 2a20  ega0[:, None] * 
-0000ed10: 6d75 3020 2920 2a20 286e 702e 636f 7320  mu0 ) * (np.cos 
-0000ed20: 280d 0a20 2020 2020 2020 2020 2020 206e  (..            n
-0000ed30: 702e 6465 6732 7261 6428 7365 6c66 2e70  p.deg2rad(self.p
-0000ed40: 6873 3264 5f29 2920 2b20 316a 202a 206e  hs2d_)) + 1j * n
-0000ed50: 702e 7369 6e28 6e70 2e64 6567 3272 6164  p.sin(np.deg2rad
-0000ed60: 2873 656c 662e 7068 7332 645f 2929 290d  (self.phs2d_))).
-0000ed70: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0000ed80: 2020 2023 2063 6f6d 7075 7465 2074 6865     # compute the
-0000ed90: 2077 6569 6768 7420 6661 6374 6f72 2066   weight factor f
-0000eda0: 6f72 2063 6f6e 766f 6c75 7469 6e67 200d  or convoluting .
-0000edb0: 0a20 2020 2020 2020 2023 204c 203d 2064  .        # L = d
-0000edc0: 6970 6f6c 6520 6c65 6e67 7468 203d 204c  ipole length = L
-0000edd0: 203a 2031 2069 7320 6669 7865 6420 6469   : 1 is fixed di
-0000ede0: 706f 6c65 202d 6c65 6e67 7468 200d 0a20  pole -length .. 
-0000edf0: 2020 2020 2020 2077 203d 206e 702e 6172         w = np.ar
-0000ee00: 7261 7928 5b62 6574 616a 2028 786a 203d  ray([betaj (xj =
-0000ee10: 2069 692c 204c 3d20 3120 2c20 573d 2073   ii, L= 1 , W= s
-0000ee20: 656c 662e 7769 6e64 6f77 5f73 697a 6529  elf.window_size)
-0000ee30: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000ee40: 2020 2020 2020 2020 2066 6f72 2069 6920           for ii 
-0000ee50: 696e 2072 616e 6765 2873 656c 662e 7769  in range(self.wi
-0000ee60: 6e64 6f77 5f73 697a 6529 5d29 0d0a 2020  ndow_size)])..  
-0000ee70: 2020 2020 2020 2370 7269 6e74 2877 290d        #print(w).
-0000ee80: 0a20 2020 2020 2020 207a 6a72 203d 206e  .        zjr = n
-0000ee90: 702e 7a65 726f 735f 6c69 6b65 2873 656c  p.zeros_like(sel
-0000eea0: 662e 7265 7332 645f 2920 0d0a 2020 2020  f.res2d_) ..    
-0000eeb0: 2020 2020 7a6a 6920 3d20 7a6a 722e 636f      zji = zjr.co
-0000eec0: 7079 2829 0d0a 2020 2020 2020 2020 2320  py()..        # 
+0000df20: 2020 6622 207b 7374 7228 7365 6c66 2e72    f" {str(self.r
+0000df30: 6573 3264 5f2e 7368 6170 6520 5b31 5d29  es2d_.shape [1])
+0000df40: 2172 7d22 290d 0a20 2020 2020 2020 200d  !r}")..        .
+0000df50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000df60: 2873 656c 662e 7265 7332 645f 202c 2073  (self.res2d_ , s
+0000df70: 656c 662e 7068 7332 645f 202c 2073 656c  elf.phs2d_ , sel
+0000df80: 662e 6672 6571 735f 2c20 7365 6c66 2e63  f.freqs_, self.c
+0000df90: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000dfa0: 2020 2073 656c 662e 7769 6e64 6f77 5f73     self.window_s
+0000dfb0: 697a 652c 2073 656c 662e 636f 6d70 6f6e  ize, self.compon
+0000dfc0: 656e 742c 2073 656c 662e 6f75 7429 200d  ent, self.out) .
+0000dfd0: 0a0d 0a20 2020 2064 6566 2061 6d61 2028  ...    def ama (
+0000dfe0: 0d0a 2020 2020 2020 2020 7365 6c66 2c20  ..        self, 
+0000dff0: 0d0a 2020 2020 2020 2020 736d 6f6f 7468  ..        smooth
+0000e000: 3a62 6f6f 6c20 3d54 7275 652c 200d 0a20  :bool =True, .. 
+0000e010: 2020 2020 2020 2064 726f 705f 6f75 746c         drop_outl
+0000e020: 6965 7273 3a62 6f6f 6c3d 5472 7565 2c20  iers:bool=True, 
+0000e030: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000e040: 5f70 6869 3a20 626f 6f6c 3d46 616c 7365  _phi: bool=False
+0000e050: 2c20 0d0a 2020 2020 2020 2020 293a 0d0a  , ..        ):..
+0000e060: 2020 2020 2020 2020 2222 2220 0d0a 2020          """ ..  
+0000e070: 2020 2020 2020 5573 6520 616e 2061 6461        Use an ada
+0000e080: 7074 6976 652d 6d6f 7669 6e67 2d61 7665  ptive-moving-ave
+0000e090: 7261 6765 2066 696c 7465 7220 746f 2065  rage filter to e
+0000e0a0: 7374 696d 6174 6520 6176 6572 6167 6520  stimate average 
+0000e0b0: 6170 7061 7265 6e74 200d 0a20 2020 2020  apparent ..     
+0000e0c0: 2020 2072 6573 6973 7469 7669 7469 6573     resistivities
+0000e0d0: 2061 7420 6120 7369 6e67 6c65 2073 7461   at a single sta
+0000e0e0: 7469 632d 636f 7272 6563 7469 6f6e 2d72  tic-correction-r
+0000e0f0: 6566 6572 656e 6365 2066 7265 7175 656e  eference frequen
+0000e100: 6379 2e2e 200d 0a20 2020 2020 2020 200d  cy.. ..        .
+0000e110: 0a20 2020 2020 2020 2054 6865 2041 4d41  .        The AMA
+0000e120: 2066 696c 7465 7220 6573 7469 6d61 7465   filter estimate
+0000e130: 7320 7374 6174 6963 2d63 6f72 7265 6374  s static-correct
+0000e140: 6564 2061 7070 6172 656e 7420 7265 7369  ed apparent resi
+0000e150: 7374 6976 6974 6965 7320 6174 2061 200d  stivities at a .
+0000e160: 0a20 2020 2020 2020 2073 696e 676c 6520  .        single 
+0000e170: 7265 6665 7265 6e63 6520 6672 6571 7565  reference freque
+0000e180: 6e63 7920 6279 2063 616c 6375 6c61 7469  ncy by calculati
+0000e190: 6e67 2061 2070 726f 6669 6c65 206f 6620  ng a profile of 
+0000e1a0: 6176 6572 6167 6520 696d 7065 6461 6e63  average impedanc
+0000e1b0: 6573 200d 0a20 2020 2020 2020 2061 6c6f  es ..        alo
+0000e1c0: 6e67 2074 6865 206c 656e 6774 6820 6f66  ng the length of
+0000e1d0: 2074 6865 206c 696e 652e 2053 6f75 6e64   the line. Sound
+0000e1e0: 696e 6720 6375 7276 6573 2061 7265 2074  ing curves are t
+0000e1f0: 6865 6e20 7368 6966 7465 6420 736f 2074  hen shifted so t
+0000e200: 6861 7420 7468 6579 0d0a 2020 2020 2020  hat they..      
+0000e210: 2020 696e 7465 7273 6563 7420 7468 6520    intersect the 
+0000e220: 6176 6572 6167 6564 2070 726f 6669 6c65  averaged profile
+0000e230: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
+0000e240: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0000e250: 200d 0a20 2020 2020 2020 202d 2d2d 2d2d   ..        -----
+0000e260: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
+0000e270: 6d6f 6f74 683a 2062 6f6f 6c2c 2064 6566  mooth: bool, def
+0000e280: 6175 6c74 3d54 7275 652c 200d 0a20 2020  ault=True, ..   
+0000e290: 2020 2020 2020 2020 536d 6f6f 7468 2074          Smooth t
+0000e2a0: 6865 2074 656e 736f 7220 6461 7461 2061  he tensor data a
+0000e2b0: 6c6f 6e67 2074 6865 2066 7265 7175 656e  long the frequen
+0000e2c0: 6369 6573 2e20 0d0a 2020 2020 2020 2020  cies. ..        
+0000e2d0: 0d0a 2020 2020 2020 2020 6472 6f70 5f6f  ..        drop_o
+0000e2e0: 7574 6c69 6572 733a 2062 6f6f 6c2c 2064  utliers: bool, d
+0000e2f0: 6566 6175 6c74 3d54 7275 6520 0d0a 2020  efault=True ..  
+0000e300: 2020 2020 2020 2020 2053 7570 7072 6573           Suppres
+0000e310: 7320 6f75 746c 6965 7273 2069 6e20 7468  s outliers in th
+0000e320: 6520 6461 7461 2077 6865 6e20 736d 6f6f  e data when smoo
+0000e330: 7468 696e 6720 6461 7461 2061 6c6f 6e67  thing data along
+0000e340: 200d 0a20 2020 2020 2020 2020 2020 7468   ..           th
+0000e350: 6520 6672 6571 7565 6e63 6965 7320 6178  e frequencies ax
+0000e360: 6973 2e20 4e6f 7465 2074 6861 7420 6064  is. Note that `d
+0000e370: 726f 705f 6f75 746c 6965 7273 6020 646f  rop_outliers` do
+0000e380: 6573 206e 6f74 2074 616b 6520 0d0a 2020  es not take ..  
+0000e390: 2020 2020 2020 2020 2065 6666 6563 7420           effect 
+0000e3a0: 6966 2060 736d 6f6f 7468 6020 6973 2060  if `smooth` is `
+0000e3b0: 6046 616c 7365 6060 2e0d 0a20 2020 2020  `False``...     
+0000e3c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000e3d0: 7265 7475 726e 5f70 6869 3a20 626f 6f6c  return_phi: bool
+0000e3e0: 2c20 6465 6661 756c 743d 4661 6c73 652c  , default=False,
+0000e3f0: 200d 0a20 2020 2020 2020 2020 2020 7265   ..           re
+0000e400: 7475 726e 2063 6f72 7265 6374 6564 2070  turn corrected p
+0000e410: 6861 7365 2e20 4d6f 7374 6c79 2074 6865  hase. Mostly the
+0000e420: 2070 6861 7365 2064 6f65 7320 6e6f 7420   phase does not 
+0000e430: 6e65 6564 2074 6f20 636f 7272 6563 7420  need to correct 
+0000e440: 0d0a 2020 2020 2020 2020 2020 2073 696e  ..           sin
+0000e450: 6365 2069 7420 6973 206e 6f74 2061 6666  ce it is not aff
+0000e460: 6563 7465 6420 6279 2074 6865 2073 7461  ected by the sta
+0000e470: 7469 6320 7368 6966 7420 6566 6665 6374  tic shift effect
+0000e480: 2e20 486f 7765 7665 722c 2069 7420 0d0a  . However, it ..
+0000e490: 2020 2020 2020 2020 2020 2063 616e 2062             can b
+0000e4a0: 6520 6173 2073 6d6f 6f74 6820 7068 6173  e as smooth phas
+0000e4b0: 6520 6375 7276 6520 7768 656e 2060 6073  e curve when ``s
+0000e4c0: 6d6f 6f74 683d 5472 7565 6060 0d0a 2020  mooth=True``..  
+0000e4d0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000e4e0: 2020 2e2e 2076 6572 7369 6f6e 6164 6465    .. versionadde
+0000e4f0: 643a 3a20 302e 322e 3120 0d0a 2020 2020  d:: 0.2.1 ..    
+0000e500: 2020 2020 2020 2050 6f6c 6973 6820 7468         Polish th
+0000e510: 6520 7465 6e73 6f72 2064 6174 6120 616c  e tensor data al
+0000e520: 6f6e 6720 7468 6520 6672 6571 7565 6e63  ong the frequenc
+0000e530: 7920 6178 6973 2072 656d 6f76 6520 6e6f  y axis remove no
+0000e540: 6973 6573 200d 0a20 2020 2020 2020 2020  ises ..         
+0000e550: 2020 616e 6420 6465 616c 2077 6974 6820    and deal with 
+0000e560: 7468 6520 7374 6174 6963 2073 6869 6674  the static shift
+0000e570: 2065 6666 6563 7420 7768 656e 2069 6e74   effect when int
+0000e580: 6572 6665 7265 6e63 6573 206e 6f69 7365  erferences noise
+0000e590: 7320 0d0a 2020 2020 2020 2020 2020 2061  s ..           a
+0000e5a0: 7265 2073 7472 6f6e 6720 656e 6f75 6768  re strong enough
+0000e5b0: 2e20 0d0a 2020 2020 2020 2020 2020 2020  . ..            
+0000e5c0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0000e5d0: 7320 0d0a 2020 2020 2020 2020 2d2d 2d2d  s ..        ----
+0000e5e0: 2d2d 2d0d 0a20 2020 2020 2020 2072 633a  ---..        rc:
+0000e5f0: 206e 702e 6e64 6172 7261 792c 2073 6861   np.ndarray, sha
+0000e600: 7065 2020 284e 2c20 4d29 0d0a 2020 2020  pe  (N, M)..    
+0000e610: 2020 2020 2020 2020 454d 4150 2061 7070          EMAP app
+0000e620: 6172 656e 7420 2072 6573 6973 7469 7669  arent  resistivi
+0000e630: 7479 2073 7461 7469 6320 7368 6966 7420  ty static shift 
+0000e640: 636f 7272 6563 7465 6420 6f72 2073 7461  corrected or sta
+0000e650: 7469 6320 0d0a 2020 2020 2020 2020 2020  tic ..          
+0000e660: 2020 636f 7272 6563 7469 6f6e 2066 6163    correction fac
+0000e670: 746f 7220 6f72 2069 6d70 6564 616e 6365  tor or impedance
+0000e680: 2074 656e 736f 722e 0d0a 2020 2020 2020   tensor...      
+0000e690: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000e6a0: 7263 2c20 7068 695f 633a 2054 7570 6c65  rc, phi_c: Tuple
+0000e6b0: 206f 6620 7368 6170 6520 284e 2c20 4e29   of shape (N, N)
+0000e6c0: 200d 0a20 2020 2020 2020 2020 2020 454d   ..           EM
+0000e6d0: 4150 2061 7070 6172 656e 7420 7265 7369  AP apparent resi
+0000e6e0: 7374 6976 6974 7920 616e 6420 7068 6173  stivity and phas
+0000e6f0: 6520 636f 7272 6563 7465 642e 200d 0a20  e corrected. .. 
+0000e700: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0000e710: 2020 2020 2045 7861 6d70 6c65 0d0a 2020       Example..  
+0000e720: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a        --------..
+0000e730: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+0000e740: 7274 2077 6174 6578 2061 7320 7778 0d0a  rt watex as wx..
+0000e750: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+0000e760: 7274 206d 6174 706c 6f74 6c69 622e 7079  rt matplotlib.py
+0000e770: 706c 6f74 2061 7320 706c 7420 0d0a 2020  plot as plt ..  
+0000e780: 2020 2020 2020 3e3e 3e20 6564 695f 6461        >>> edi_da
+0000e790: 7461 203d 2077 782e 6665 7463 685f 6461  ta = wx.fetch_da
+0000e7a0: 7461 2028 2765 6469 7327 2c20 6173 5f66  ta ('edis', as_f
+0000e7b0: 7261 6d65 203d 5472 7565 2c20 6b65 7920  rame =True, key 
+0000e7c0: 3d27 6564 6927 290d 0a20 2020 2020 2020  ='edi')..       
+0000e7d0: 203e 3e3e 2070 203d 2077 782e 454d 5072   >>> p = wx.EMPr
+0000e7e0: 6f63 6573 7369 6e67 2028 6f75 743d 277a  ocessing (out='z
+0000e7f0: 2729 2e66 6974 2865 6469 5f64 6174 612e  ').fit(edi_data.
+0000e800: 6564 6929 200d 0a20 2020 2020 2020 203e  edi) ..        >
+0000e810: 3e3e 207a 5f63 6f72 7265 6374 6564 203d  >> z_corrected =
+0000e820: 2070 2e61 6d61 2028 2920 2320 6f75 7470   p.ama () # outp
+0000e830: 7574 207a 2069 6e20 636f 6d70 6c65 7820  ut z in complex 
+0000e840: 6474 7970 6520 0d0a 2020 2020 2020 2020  dtype ..        
+0000e850: 3e3e 3e20 706c 742e 706c 6f74 2028 6e70  >>> plt.plot (np
+0000e860: 2e61 7261 6e67 6520 286c 656e 2870 2e65  .arange (len(p.e
+0000e870: 6469 4f62 6a73 5f29 2920 2c20 6e70 2e61  diObjs_)) , np.a
+0000e880: 6273 2820 0d0a 2020 2020 2020 2020 2020  bs( ..          
+0000e890: 2020 5b20 6564 696f 626a 2e5a 2e7a 5b3a    [ ediobj.Z.z[:
+0000e8a0: 2c20 302c 2031 5d5b 375d 2020 666f 7220  , 0, 1][7]  for 
+0000e8b0: 6564 696f 626a 2069 6e20 702e 6564 694f  ediobj in p.ediO
+0000e8c0: 626a 735f 5d29 202c 2027 2d6f 6b27 2c0d  bjs_]) , '-ok',.
+0000e8d0: 0a20 2020 2020 2020 2020 2020 206e 702e  .            np.
+0000e8e0: 6172 616e 6765 286c 656e 2870 2e65 6469  arange(len(p.edi
+0000e8f0: 4f62 6a73 5f29 292c 206e 702e 6162 7328  Objs_)), np.abs(
+0000e900: 207a 5f63 6f72 7265 6374 6564 5b37 2c3a   z_corrected[7,:
+0000e910: 205d 2920 2c20 276f 722d 2729 0d0a 2020   ]) , 'or-')..  
+0000e920: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000e930: 5265 6665 7265 6e63 6573 200d 0a20 2020  References ..   
+0000e940: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000e950: 0d0a 2020 2020 2020 2020 2e2e 205b 315d  ..        .. [1]
+0000e960: 2068 7474 703a 2f2f 7777 772e 7a6f 6e67   http://www.zong
+0000e970: 652e 636f 6d2f 6c65 6761 6379 2f50 4446  e.com/legacy/PDF
+0000e980: 5f44 6174 5072 6f2f 4173 7461 7469 632e  _DatPro/Astatic.
+0000e990: 7064 660d 0a20 2020 2020 2020 202e 2e20  pdf..        .. 
+0000e9a0: 5b32 5d20 546f 7272 6573 2d56 6572 6469  [2] Torres-Verdi
+0000e9b0: 6e20 616e 6420 426f 7374 6963 6b2c 2031  n and Bostick, 1
+0000e9c0: 3939 322c 2020 5072 696e 6369 706c 6573  992,  Principles
+0000e9d0: 206f 6620 7370 6174 6961 6c20 7375 7266   of spatial surf
+0000e9e0: 6163 6520 0d0a 2020 2020 2020 2020 2020  ace ..          
+0000e9f0: 2020 656c 6563 7472 6963 2066 6965 6c64    electric field
+0000ea00: 2066 696c 7465 7269 6e67 2069 6e20 6d61   filtering in ma
+0000ea10: 676e 6574 6f74 656c 6c75 7269 6373 3a20  gnetotellurics: 
+0000ea20: 656c 6563 7472 6f6d 6167 6e65 7469 6320  electromagnetic 
+0000ea30: 6172 7261 7920 7072 6f66 696c 696e 670d  array profiling.
+0000ea40: 0a20 2020 2020 2020 2020 2020 2028 454d  .            (EM
+0000ea50: 4150 292c 2047 656f 7068 7973 6963 732c  AP), Geophysics,
+0000ea60: 2076 3537 2c20 7036 3033 2d36 3232 2e68   v57, p603-622.h
+0000ea70: 7474 7073 3a2f 2f64 6f69 2e6f 7267 2f31  ttps://doi.org/1
+0000ea80: 302e 3131 3930 2f31 2e32 3430 3036 3235  0.1190/1.2400625
+0000ea90: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+0000eaa0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0000eab0: 2020 2020 2073 656c 662e 696e 7370 6563       self.inspec
+0000eac0: 7420 0d0a 0d0a 2020 2020 2020 2020 2320  t ....        # 
+0000ead0: 6173 7365 7274 2066 696c 7465 7220 6172  assert filter ar
+0000eae0: 6775 6d65 6e74 7320 0d0a 2020 2020 2020  guments ..      
+0000eaf0: 2020 7365 6c66 2e72 6573 3264 5f20 2c20    self.res2d_ , 
+0000eb00: 7365 6c66 2e70 6873 3264 5f20 2c20 7365  self.phs2d_ , se
+0000eb10: 6c66 2e66 7265 7173 5f2c 2073 656c 662e  lf.freqs_, self.
+0000eb20: 632c 2073 656c 662e 7769 6e64 6f77 5f73  c, self.window_s
+0000eb30: 697a 652c 205c 0d0a 2020 2020 2020 2020  ize, \..        
+0000eb40: 2020 2020 7365 6c66 2e63 6f6d 706f 6e65      self.compone
+0000eb50: 6e74 2c20 7365 6c66 2e6f 7574 203d 2073  nt, self.out = s
+0000eb60: 656c 662e 5f6d 616b 6532 6462 6c6f 6273  elf._make2dblobs
+0000eb70: 2028 290d 0a20 2020 2020 2020 2023 2020   ()..        #  
+0000eb80: 696e 7465 7270 6f6c 6174 6520 7265 7369  interpolate resi
+0000eb90: 7374 6976 6974 7920 616e 6420 7068 6173  stivity and phas
+0000eba0: 6573 200d 0a20 2020 2020 2020 2073 656c  es ..        sel
+0000ebb0: 662e 7068 7332 645f 3d20 696e 7465 7270  f.phs2d_= interp
+0000ebc0: 6f6c 6174 6532 6428 7365 6c66 2e70 6873  olate2d(self.phs
+0000ebd0: 3264 5f2c 206d 6574 686f 6420 3d73 656c  2d_, method =sel
+0000ebe0: 662e 6d65 7468 6f64 290d 0a20 2020 2020  f.method)..     
+0000ebf0: 2020 2073 656c 662e 7265 7332 645f 3d20     self.res2d_= 
+0000ec00: 696e 7465 7270 6f6c 6174 6532 6428 7365  interpolate2d(se
+0000ec10: 6c66 2e72 6573 3264 5f2c 206d 6574 686f  lf.res2d_, metho
+0000ec20: 6420 3d73 656c 662e 6d65 7468 6f64 2c29  d =self.method,)
+0000ec30: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0000ec40: 2020 2020 2320 636f 6e76 6572 7420 6170      # convert ap
+0000ec50: 702e 2072 6573 6973 7469 7669 7479 2061  p. resistivity a
+0000ec60: 6e64 2069 6d70 6564 616e 6365 2070 6861  nd impedance pha
+0000ec70: 7365 2020 746f 200d 0a20 2020 2020 2020  se  to ..       
+0000ec80: 2023 2069 6d70 6564 616e 6365 2076 616c   # impedance val
+0000ec90: 7565 732c 205a 6a2c 2066 6f72 2065 6163  ues, Zj, for eac
+0000eca0: 6820 7374 6174 696f 6e0d 0a20 2020 2020  h station..     
+0000ecb0: 2020 206f 6d65 6761 3020 3d20 3220 2a20     omega0 = 2 * 
+0000ecc0: 6e70 2e70 6920 2a20 7365 6c66 2e66 7265  np.pi * self.fre
+0000ecd0: 7173 5f0d 0a20 2020 2020 2020 207a 6a20  qs_..        zj 
+0000ece0: 3d20 6e70 2e73 7172 7428 7365 6c66 2e72  = np.sqrt(self.r
+0000ecf0: 6573 3264 5f20 2a20 6f6d 6567 6130 5b3a  es2d_ * omega0[:
+0000ed00: 2c20 4e6f 6e65 5d20 2a20 6d75 3020 2920  , None] * mu0 ) 
+0000ed10: 2a20 286e 702e 636f 7320 280d 0a20 2020  * (np.cos (..   
+0000ed20: 2020 2020 2020 2020 206e 702e 6465 6732           np.deg2
+0000ed30: 7261 6428 7365 6c66 2e70 6873 3264 5f29  rad(self.phs2d_)
+0000ed40: 2920 2b20 316a 202a 206e 702e 7369 6e28  ) + 1j * np.sin(
+0000ed50: 6e70 2e64 6567 3272 6164 2873 656c 662e  np.deg2rad(self.
+0000ed60: 7068 7332 645f 2929 290d 0a20 2020 2020  phs2d_)))..     
+0000ed70: 2020 200d 0a20 2020 2020 2020 2023 2063     ..        # c
+0000ed80: 6f6d 7075 7465 2074 6865 2077 6569 6768  ompute the weigh
+0000ed90: 7420 6661 6374 6f72 2066 6f72 2063 6f6e  t factor for con
+0000eda0: 766f 6c75 7469 6e67 200d 0a20 2020 2020  voluting ..     
+0000edb0: 2020 2023 204c 203d 2064 6970 6f6c 6520     # L = dipole 
+0000edc0: 6c65 6e67 7468 203d 204c 203a 2031 2069  length = L : 1 i
+0000edd0: 7320 6669 7865 6420 6469 706f 6c65 202d  s fixed dipole -
+0000ede0: 6c65 6e67 7468 200d 0a20 2020 2020 2020  length ..       
+0000edf0: 2077 203d 206e 702e 6172 7261 7928 5b62   w = np.array([b
+0000ee00: 6574 616a 2028 786a 203d 2069 692c 204c  etaj (xj = ii, L
+0000ee10: 3d20 3120 2c20 573d 2073 656c 662e 7769  = 1 , W= self.wi
+0000ee20: 6e64 6f77 5f73 697a 6529 200d 0a20 2020  ndow_size) ..   
+0000ee30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ee40: 2020 2066 6f72 2069 6920 696e 2072 616e     for ii in ran
+0000ee50: 6765 2873 656c 662e 7769 6e64 6f77 5f73  ge(self.window_s
+0000ee60: 697a 6529 5d29 0d0a 2020 2020 2020 2020  ize)])..        
+0000ee70: 2370 7269 6e74 2877 290d 0a20 2020 2020  #print(w)..     
+0000ee80: 2020 207a 6a72 203d 206e 702e 7a65 726f     zjr = np.zero
+0000ee90: 735f 6c69 6b65 2873 656c 662e 7265 7332  s_like(self.res2
+0000eea0: 645f 2920 0d0a 2020 2020 2020 2020 7a6a  d_) ..        zj
+0000eeb0: 6920 3d20 7a6a 722e 636f 7079 2829 0d0a  i = zjr.copy()..
+0000eec0: 2020 2020 2020 2020 2320 7878 7878 7878          # xxxxxx
 0000eed0: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0000eee0: 7878 7878 7878 780d 0a20 2020 2020 2020  xxxxxxx..       
-0000eef0: 2023 2064 6f20 7468 6520 7361 6d65 2066   # do the same f
-0000ef00: 6f72 2074 6865 2070 6861 7365 200d 0a20  or the phase .. 
-0000ef10: 2020 2020 2020 2070 6861 7365 5f63 203d         phase_c =
-0000ef20: 206e 702e 7a65 726f 735f 6c69 6b65 2873   np.zeros_like(s
-0000ef30: 656c 662e 7068 7332 645f 2920 0d0a 2020  elf.phs2d_) ..  
-0000ef40: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000ef50: 666f 7220 6969 2069 6e20 7261 6e67 6520  for ii in range 
-0000ef60: 286c 656e 287a 6a29 293a 200d 0a20 2020  (len(zj)): ..   
-0000ef70: 2020 2020 2020 2020 2077 5f65 7870 203d           w_exp =
-0000ef80: 205b 206b 202a 2073 656c 662e 7769 6e64   [ k * self.wind
-0000ef90: 6f77 5f73 697a 6520 666f 7220 6b20 696e  ow_size for k in
-0000efa0: 2072 616e 6765 2831 2c20 7365 6c66 2e63   range(1, self.c
-0000efb0: 202b 3120 295d 0d0a 2020 2020 2020 2020   +1 )]..        
-0000efc0: 2020 2020 7a63 723d 6c69 7374 2829 3b20      zcr=list(); 
-0000efd0: 7a63 6920 3d20 6c69 7374 2829 0d0a 2020  zci = list()..  
-0000efe0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0000eff0: 2020 2020 2020 2020 2378 7878 7878 7878          #xxxxxxx
-0000f000: 7878 7878 0d0a 2020 2020 2020 2020 2020  xxxx..          
-0000f010: 2020 7068 6920 3d20 6c69 7374 2829 200d    phi = list() .
-0000f020: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-0000f030: 6f6d 7075 7465 205a 6b28 786b 2c20 7729  ompute Zk(xk, w)
-0000f040: 2069 7465 7261 7469 7665 6c79 0d0a 2020   iteratively..  
-0000f050: 2020 2020 2020 2020 2020 2320 7769 7468            # with
-0000f060: 2061 6470 6174 6176 6976 6520 5720 6578   adpatavive W ex
-0000f070: 7061 6e64 6564 2074 6f20 3120 746f 2063  panded to 1 to c
-0000f080: 200d 0a20 2020 2020 2020 2020 2020 2066   ..            f
-0000f090: 6f72 2077 696e 645f 6b20 2069 6e20 775f  or wind_k  in w_
-0000f0a0: 6578 7020 3a20 0d0a 2020 2020 2020 2020  exp : ..        
-0000f0b0: 2020 2020 2020 2020 773d 206e 702e 6172          w= np.ar
-0000f0c0: 7261 7928 5b62 6574 616a 2028 786a 203d  ray([betaj (xj =
-0000f0d0: 206a 6a2c 204c 3d20 312c 2057 3d20 7769   jj, L= 1, W= wi
-0000f0e0: 6e64 5f6b 0d0a 2020 2020 2020 2020 2020  nd_k..          
+0000eee0: 780d 0a20 2020 2020 2020 2023 2064 6f20  x..        # do 
+0000eef0: 7468 6520 7361 6d65 2066 6f72 2074 6865  the same for the
+0000ef00: 2070 6861 7365 200d 0a20 2020 2020 2020   phase ..       
+0000ef10: 2070 6861 7365 5f63 203d 206e 702e 7a65   phase_c = np.ze
+0000ef20: 726f 735f 6c69 6b65 2873 656c 662e 7068  ros_like(self.ph
+0000ef30: 7332 645f 2920 0d0a 2020 2020 2020 2020  s2d_) ..        
+0000ef40: 0d0a 2020 2020 2020 2020 666f 7220 6969  ..        for ii
+0000ef50: 2069 6e20 7261 6e67 6520 286c 656e 287a   in range (len(z
+0000ef60: 6a29 293a 200d 0a20 2020 2020 2020 2020  j)): ..         
+0000ef70: 2020 2077 5f65 7870 203d 205b 206b 202a     w_exp = [ k *
+0000ef80: 2073 656c 662e 7769 6e64 6f77 5f73 697a   self.window_siz
+0000ef90: 6520 666f 7220 6b20 696e 2072 616e 6765  e for k in range
+0000efa0: 2831 2c20 7365 6c66 2e63 202b 3120 295d  (1, self.c +1 )]
+0000efb0: 0d0a 2020 2020 2020 2020 2020 2020 7a63  ..            zc
+0000efc0: 723d 6c69 7374 2829 3b20 7a63 6920 3d20  r=list(); zci = 
+0000efd0: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
+0000efe0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+0000eff0: 2020 2378 7878 7878 7878 7878 7878 0d0a    #xxxxxxxxxxx..
+0000f000: 2020 2020 2020 2020 2020 2020 7068 6920              phi 
+0000f010: 3d20 6c69 7374 2829 200d 0a20 2020 2020  = list() ..     
+0000f020: 2020 2020 2020 2023 2063 6f6d 7075 7465         # compute
+0000f030: 205a 6b28 786b 2c20 7729 2069 7465 7261   Zk(xk, w) itera
+0000f040: 7469 7665 6c79 0d0a 2020 2020 2020 2020  tively..        
+0000f050: 2020 2020 2320 7769 7468 2061 6470 6174      # with adpat
+0000f060: 6176 6976 6520 5720 6578 7061 6e64 6564  avive W expanded
+0000f070: 2074 6f20 3120 746f 2063 200d 0a20 2020   to 1 to c ..   
+0000f080: 2020 2020 2020 2020 2066 6f72 2077 696e           for win
+0000f090: 645f 6b20 2069 6e20 775f 6578 7020 3a20  d_k  in w_exp : 
+0000f0a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f0b0: 2020 773d 206e 702e 6172 7261 7928 5b62    w= np.array([b
+0000f0c0: 6574 616a 2028 786a 203d 206a 6a2c 204c  etaj (xj = jj, L
+0000f0d0: 3d20 312c 2057 3d20 7769 6e64 5f6b 0d0a  = 1, W= wind_k..
+0000f0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000f0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f100: 2020 2020 2020 2020 2020 2920 666f 7220            ) for 
-0000f110: 6a6a 2069 6e20 7261 6e67 6528 7769 6e64  jj in range(wind
-0000f120: 5f6b 290d 0a20 2020 2020 2020 2020 2020  _k)..           
-0000f130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f140: 2020 5d29 0d0a 2020 2020 2020 2020 2020    ])..          
-0000f150: 2020 2020 2020 2320 626c 6f63 6b20 6d6f        # block mo
-0000f160: 6465 2074 6f20 7361 6d65 2074 6f20 6b65  de to same to ke
-0000f170: 6570 2074 6865 2073 616d 6520 6469 6d65  ep the same dime
-0000f180: 6e73 696f 6e73 0d0a 2020 2020 2020 2020  nsions..        
-0000f190: 2020 2020 2020 2020 7a63 722e 6170 7065          zcr.appe
-0000f1a0: 6e64 286e 702e 636f 6e76 6f6c 7665 287a  nd(np.convolve(z
-0000f1b0: 6a5b 6969 2c20 3a5d 2e72 6561 6c2c 2077  j[ii, :].real, w
-0000f1c0: 5b3a 3a2d 315d 2c20 2773 616d 6527 2929  [::-1], 'same'))
-0000f1d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f1e0: 2020 7a63 692e 6170 7065 6e64 286e 702e    zci.append(np.
-0000f1f0: 636f 6e76 6f6c 7665 287a 6a5b 6969 2c20  convolve(zj[ii, 
-0000f200: 3a5d 2e69 6d61 672c 2077 5b3a 3a2d 315d  :].imag, w[::-1]
-0000f210: 2c20 2773 616d 6527 2929 0d0a 2020 2020  , 'same'))..    
-0000f220: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-0000f230: 2020 2020 2020 2020 2020 2020 2020 2378                #x
-0000f240: 7878 7878 780d 0a20 2020 2020 2020 2020  xxxxx..         
-0000f250: 2020 2020 2020 2070 6869 2e61 7070 656e         phi.appen
-0000f260: 6428 6e70 2e63 6f6e 766f 6c76 6528 7365  d(np.convolve(se
-0000f270: 6c66 2e70 6873 3264 5f5b 6969 2c20 3a5d  lf.phs2d_[ii, :]
-0000f280: 2c20 775b 3a3a 2d31 5d2c 2027 7361 6d65  , w[::-1], 'same
-0000f290: 2729 290d 0a20 2020 2020 2020 2020 2020  '))..           
-0000f2a0: 2023 2061 6e64 2074 616b 6520 7468 6520   # and take the 
-0000f2b0: 6176 6572 6167 6520 0d0a 2020 2020 2020  average ..      
-0000f2c0: 2020 2020 2020 7472 7920 3a20 0d0a 2020        try : ..  
-0000f2d0: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-0000f2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f2f0: 7a6a 7220 5b69 692c 203a 5d20 3d20 6e70  zjr [ii, :] = np
-0000f300: 2e61 7665 7261 6765 2028 6e70 2e76 7374  .average (np.vst
-0000f310: 6163 6b20 287a 6372 292c 2061 7869 7320  ack (zcr), axis 
-0000f320: 3d20 3029 0d0a 2020 2020 2020 2020 2020  = 0)..          
-0000f330: 2020 2020 2020 7a6a 695b 6969 2c20 3a5d        zji[ii, :]
-0000f340: 203d 206e 702e 6176 6572 6167 6520 286e   = np.average (n
-0000f350: 702e 7673 7461 636b 2028 7a63 6929 2c20  p.vstack (zci), 
-0000f360: 6178 6973 203d 2030 290d 0a20 2020 2020  axis = 0)..     
-0000f370: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0000f380: 2020 2020 2020 2020 2020 2020 2023 7878               #xx
-0000f390: 7878 7878 7878 7878 7878 0d0a 2020 2020  xxxxxxxxxx..    
-0000f3a0: 2020 2020 2020 2020 2020 2020 7068 6173              phas
-0000f3b0: 655f 635b 6969 2c20 3a5d 3d20 6e70 2e61  e_c[ii, :]= np.a
-0000f3c0: 7665 7261 6765 2028 6e70 2e76 7374 6163  verage (np.vstac
-0000f3d0: 6b20 2870 6869 292c 2061 7869 7320 3d20  k (phi), axis = 
-0000f3e0: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-0000f3f0: 6578 6365 7074 203a 200d 0a20 2020 2020  except : ..     
-0000f400: 2020 2020 2020 2020 2020 2023 2077 6865             # whe
-0000f410: 6e20 2061 7272 6179 2064 696d 656e 7369  n  array dimensi
-0000f420: 6f6e 7320 6973 206f 7574 206f 6620 7468  ons is out of th
-0000f430: 6520 636f 6e63 6174 656e 6174 696f 6e20  e concatenation 
-0000f440: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f450: 2020 2320 7468 656e 2073 6872 756e 6b20    # then shrunk 
-0000f460: 6974 2074 6f20 6d61 7463 6820 6578 6163  it to match exac
-0000f470: 746c 7920 7468 6520 6669 7273 7420 6172  tly the first ar
-0000f480: 7261 7920 0d0a 2020 2020 2020 2020 2020  ray ..          
-0000f490: 2020 2020 2020 2320 7468 6963 6b20 6170        # thick ap
-0000f4a0: 7065 6e64 2077 6865 6e20 7769 6e64 6f77  pend when window
-0000f4b0: 2077 6964 7468 2069 7320 6869 6768 6572   width is higher
-0000f4c0: 2061 6e64 2074 6865 206e 756d 6265 7220   and the number 
-0000f4d0: 6f66 200d 0a20 2020 2020 2020 2020 2020  of ..           
-0000f4e0: 2020 2020 2023 2074 6865 2073 7461 7469       # the stati
-0000f4f0: 6f6e 200d 0a20 2020 2020 2020 2020 2020  on ..           
-0000f500: 2020 2020 2073 6872 5f7a 7263 203d 205b       shr_zrc = [
-0000f510: 2061 7220 5b3a 206c 656e 287a 6372 5b30   ar [: len(zcr[0
-0000f520: 5d29 5d20 666f 7220 6172 2069 6e20 7a63  ])] for ar in zc
-0000f530: 7220 5d0d 0a20 2020 2020 2020 2020 2020  r ]..           
-0000f540: 2020 2020 2073 6872 5f7a 7263 6920 3d20       shr_zrci = 
-0000f550: 5b20 6172 205b 3a20 6c65 6e28 7a63 695b  [ ar [: len(zci[
-0000f560: 305d 295d 2066 6f72 2061 7220 696e 207a  0])] for ar in z
-0000f570: 6369 205d 0d0a 2020 2020 2020 2020 2020  ci ]..          
-0000f580: 2020 2020 2020 7a6a 7220 5b69 692c 203a        zjr [ii, :
-0000f590: 5d20 3d20 6e70 2e61 7665 7261 6765 2028  ] = np.average (
-0000f5a0: 6e70 2e76 7374 6163 6b20 2873 6872 5f7a  np.vstack (shr_z
-0000f5b0: 7263 292c 2061 7869 7320 3d20 3029 0d0a  rc), axis = 0)..
-0000f5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f5d0: 7a6a 695b 6969 2c20 3a5d 203d 206e 702e  zji[ii, :] = np.
-0000f5e0: 6176 6572 6167 6520 286e 702e 7673 7461  average (np.vsta
-0000f5f0: 636b 2028 7368 725f 7a72 6369 292c 2061  ck (shr_zrci), a
-0000f600: 7869 7320 3d20 3029 0d0a 2020 2020 200d  xis = 0)..     .
-0000f610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f620: 2023 7878 7878 7878 7878 7878 7878 7878   #xxxxxxxxxxxxxx
-0000f630: 7878 7878 780d 0a20 2020 2020 2020 2020  xxxxx..         
-0000f640: 2020 2020 2020 2070 6873 5f7a 7263 203d         phs_zrc =
-0000f650: 205b 2061 7220 5b3a 206c 656e 2870 6869   [ ar [: len(phi
-0000f660: 5b30 5d29 5d20 666f 7220 6172 2069 6e20  [0])] for ar in 
-0000f670: 7068 6920 5d0d 0a20 2020 2020 2020 2020  phi ]..         
-0000f680: 2020 2020 2020 2070 6861 7365 5f63 205b         phase_c [
-0000f690: 6969 2c20 3a5d 3d20 6e70 2e61 7665 7261  ii, :]= np.avera
-0000f6a0: 6765 2028 6e70 2e76 7374 6163 6b20 2870  ge (np.vstack (p
-0000f6b0: 6873 5f7a 7263 292c 2061 7869 7320 3d20  hs_zrc), axis = 
-0000f6c0: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-0000f6d0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000f6e0: 2020 7a6a 6320 3d20 7a6a 7220 2b20 316a    zjc = zjr + 1j
-0000f6f0: 202a 207a 6a69 200d 0a20 2020 2020 2020   * zji ..       
-0000f700: 2072 6320 3d20 7a32 7268 6f61 287a 6a63   rc = z2rhoa(zjc
-0000f710: 2c20 7365 6c66 2e66 7265 7173 5f29 200d  , self.freqs_) .
-0000f720: 0a20 2020 2020 2020 2069 6620 736d 6f6f  .        if smoo
-0000f730: 7468 3a20 0d0a 2020 2020 2020 2020 2020  th: ..          
-0000f740: 2020 2320 626c 6f63 6b20 6d6f 7669 6e67    # block moving
-0000f750: 2061 7665 7261 6765 2060 6d61 6020 7472   average `ma` tr
-0000f760: 6963 6b20 746f 2054 7275 6520 0d0a 2020  ick to True ..  
-0000f770: 2020 2020 2020 2020 2020 2320 616e 6420            # and 
-0000f780: 666f 7263 6520 7265 7369 7374 6976 6974  force resistivit
-0000f790: 7920 7661 6c75 6520 746f 2062 6520 706f  y value to be po
-0000f7a0: 7369 7469 7665 200d 0a20 2020 2020 2020  sitive ..       
-0000f7b0: 2020 2020 2072 6320 3d20 736d 6f6f 7468       rc = smooth
-0000f7c0: 696e 6728 2072 6320 2c20 0d0a 2020 2020  ing( rc , ..    
+0000f100: 2020 2020 2920 666f 7220 6a6a 2069 6e20      ) for jj in 
+0000f110: 7261 6e67 6528 7769 6e64 5f6b 290d 0a20  range(wind_k).. 
+0000f120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f130: 2020 2020 2020 2020 2020 2020 5d29 0d0a              ])..
+0000f140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f150: 2320 626c 6f63 6b20 6d6f 6465 2074 6f20  # block mode to 
+0000f160: 7361 6d65 2074 6f20 6b65 6570 2074 6865  same to keep the
+0000f170: 2073 616d 6520 6469 6d65 6e73 696f 6e73   same dimensions
+0000f180: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f190: 2020 7a63 722e 6170 7065 6e64 286e 702e    zcr.append(np.
+0000f1a0: 636f 6e76 6f6c 7665 287a 6a5b 6969 2c20  convolve(zj[ii, 
+0000f1b0: 3a5d 2e72 6561 6c2c 2077 5b3a 3a2d 315d  :].real, w[::-1]
+0000f1c0: 2c20 2773 616d 6527 2929 0d0a 2020 2020  , 'same'))..    
+0000f1d0: 2020 2020 2020 2020 2020 2020 7a63 692e              zci.
+0000f1e0: 6170 7065 6e64 286e 702e 636f 6e76 6f6c  append(np.convol
+0000f1f0: 7665 287a 6a5b 6969 2c20 3a5d 2e69 6d61  ve(zj[ii, :].ima
+0000f200: 672c 2077 5b3a 3a2d 315d 2c20 2773 616d  g, w[::-1], 'sam
+0000f210: 6527 2929 0d0a 2020 2020 2020 2020 2020  e'))..          
+0000f220: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000f230: 2020 2020 2020 2020 2378 7878 7878 780d          #xxxxxx.
+0000f240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f250: 2070 6869 2e61 7070 656e 6428 6e70 2e63   phi.append(np.c
+0000f260: 6f6e 766f 6c76 6528 7365 6c66 2e70 6873  onvolve(self.phs
+0000f270: 3264 5f5b 6969 2c20 3a5d 2c20 775b 3a3a  2d_[ii, :], w[::
+0000f280: 2d31 5d2c 2027 7361 6d65 2729 290d 0a20  -1], 'same')).. 
+0000f290: 2020 2020 2020 2020 2020 2023 2061 6e64             # and
+0000f2a0: 2074 616b 6520 7468 6520 6176 6572 6167   take the averag
+0000f2b0: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
+0000f2c0: 7472 7920 3a20 0d0a 2020 2020 2020 2020  try : ..        
+0000f2d0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000f2e0: 2020 2020 2020 2020 2020 7a6a 7220 5b69            zjr [i
+0000f2f0: 692c 203a 5d20 3d20 6e70 2e61 7665 7261  i, :] = np.avera
+0000f300: 6765 2028 6e70 2e76 7374 6163 6b20 287a  ge (np.vstack (z
+0000f310: 6372 292c 2061 7869 7320 3d20 3029 0d0a  cr), axis = 0)..
+0000f320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f330: 7a6a 695b 6969 2c20 3a5d 203d 206e 702e  zji[ii, :] = np.
+0000f340: 6176 6572 6167 6520 286e 702e 7673 7461  average (np.vsta
+0000f350: 636b 2028 7a63 6929 2c20 6178 6973 203d  ck (zci), axis =
+0000f360: 2030 290d 0a20 2020 2020 2020 2020 2020   0)..           
+0000f370: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0000f380: 2020 2020 2020 2023 7878 7878 7878 7878         #xxxxxxxx
+0000f390: 7878 7878 0d0a 2020 2020 2020 2020 2020  xxxx..          
+0000f3a0: 2020 2020 2020 7068 6173 655f 635b 6969        phase_c[ii
+0000f3b0: 2c20 3a5d 3d20 6e70 2e61 7665 7261 6765  , :]= np.average
+0000f3c0: 2028 6e70 2e76 7374 6163 6b20 2870 6869   (np.vstack (phi
+0000f3d0: 292c 2061 7869 7320 3d20 3029 0d0a 2020  ), axis = 0)..  
+0000f3e0: 2020 2020 2020 2020 2020 6578 6365 7074            except
+0000f3f0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+0000f400: 2020 2020 2023 2077 6865 6e20 2061 7272       # when  arr
+0000f410: 6179 2064 696d 656e 7369 6f6e 7320 6973  ay dimensions is
+0000f420: 206f 7574 206f 6620 7468 6520 636f 6e63   out of the conc
+0000f430: 6174 656e 6174 696f 6e20 0d0a 2020 2020  atenation ..    
+0000f440: 2020 2020 2020 2020 2020 2020 2320 7468              # th
+0000f450: 656e 2073 6872 756e 6b20 6974 2074 6f20  en shrunk it to 
+0000f460: 6d61 7463 6820 6578 6163 746c 7920 7468  match exactly th
+0000f470: 6520 6669 7273 7420 6172 7261 7920 0d0a  e first array ..
+0000f480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f490: 2320 7468 6963 6b20 6170 7065 6e64 2077  # thick append w
+0000f4a0: 6865 6e20 7769 6e64 6f77 2077 6964 7468  hen window width
+0000f4b0: 2069 7320 6869 6768 6572 2061 6e64 2074   is higher and t
+0000f4c0: 6865 206e 756d 6265 7220 6f66 200d 0a20  he number of .. 
+0000f4d0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000f4e0: 2074 6865 2073 7461 7469 6f6e 200d 0a20   the station .. 
+0000f4f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000f500: 6872 5f7a 7263 203d 205b 2061 7220 5b3a  hr_zrc = [ ar [:
+0000f510: 206c 656e 287a 6372 5b30 5d29 5d20 666f   len(zcr[0])] fo
+0000f520: 7220 6172 2069 6e20 7a63 7220 5d0d 0a20  r ar in zcr ].. 
+0000f530: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000f540: 6872 5f7a 7263 6920 3d20 5b20 6172 205b  hr_zrci = [ ar [
+0000f550: 3a20 6c65 6e28 7a63 695b 305d 295d 2066  : len(zci[0])] f
+0000f560: 6f72 2061 7220 696e 207a 6369 205d 0d0a  or ar in zci ]..
+0000f570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f580: 7a6a 7220 5b69 692c 203a 5d20 3d20 6e70  zjr [ii, :] = np
+0000f590: 2e61 7665 7261 6765 2028 6e70 2e76 7374  .average (np.vst
+0000f5a0: 6163 6b20 2873 6872 5f7a 7263 292c 2061  ack (shr_zrc), a
+0000f5b0: 7869 7320 3d20 3029 0d0a 2020 2020 2020  xis = 0)..      
+0000f5c0: 2020 2020 2020 2020 2020 7a6a 695b 6969            zji[ii
+0000f5d0: 2c20 3a5d 203d 206e 702e 6176 6572 6167  , :] = np.averag
+0000f5e0: 6520 286e 702e 7673 7461 636b 2028 7368  e (np.vstack (sh
+0000f5f0: 725f 7a72 6369 292c 2061 7869 7320 3d20  r_zrci), axis = 
+0000f600: 3029 0d0a 2020 2020 200d 0a20 2020 2020  0)..     ..     
+0000f610: 2020 2020 2020 2020 2020 2023 7878 7878             #xxxx
+0000f620: 7878 7878 7878 7878 7878 7878 7878 780d  xxxxxxxxxxxxxxx.
+0000f630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f640: 2070 6873 5f7a 7263 203d 205b 2061 7220   phs_zrc = [ ar 
+0000f650: 5b3a 206c 656e 2870 6869 5b30 5d29 5d20  [: len(phi[0])] 
+0000f660: 666f 7220 6172 2069 6e20 7068 6920 5d0d  for ar in phi ].
+0000f670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f680: 2070 6861 7365 5f63 205b 6969 2c20 3a5d   phase_c [ii, :]
+0000f690: 3d20 6e70 2e61 7665 7261 6765 2028 6e70  = np.average (np
+0000f6a0: 2e76 7374 6163 6b20 2870 6873 5f7a 7263  .vstack (phs_zrc
+0000f6b0: 292c 2061 7869 7320 3d20 3029 0d0a 2020  ), axis = 0)..  
+0000f6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f6d0: 2020 0d0a 2020 2020 2020 2020 7a6a 6320    ..        zjc 
+0000f6e0: 3d20 7a6a 7220 2b20 316a 202a 207a 6a69  = zjr + 1j * zji
+0000f6f0: 200d 0a20 2020 2020 2020 2072 6320 3d20   ..        rc = 
+0000f700: 7a32 7268 6f61 287a 6a63 2c20 7365 6c66  z2rhoa(zjc, self
+0000f710: 2e66 7265 7173 5f29 200d 0a20 2020 2020  .freqs_) ..     
+0000f720: 2020 2069 6620 736d 6f6f 7468 3a20 0d0a     if smooth: ..
+0000f730: 2020 2020 2020 2020 2020 2020 2320 626c              # bl
+0000f740: 6f63 6b20 6d6f 7669 6e67 2061 7665 7261  ock moving avera
+0000f750: 6765 2060 6d61 6020 7472 6963 6b20 746f  ge `ma` trick to
+0000f760: 2054 7275 6520 0d0a 2020 2020 2020 2020   True ..        
+0000f770: 2020 2020 2320 616e 6420 666f 7263 6520      # and force 
+0000f780: 7265 7369 7374 6976 6974 7920 7661 6c75  resistivity valu
+0000f790: 6520 746f 2062 6520 706f 7369 7469 7665  e to be positive
+0000f7a0: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
+0000f7b0: 6320 3d20 736d 6f6f 7468 696e 6728 2072  c = smoothing( r
+0000f7c0: 6320 2c20 0d0a 2020 2020 2020 2020 2020  c , ..          
 0000f7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f7e0: 2020 2020 2020 2064 726f 705f 6f75 746c         drop_outl
-0000f7f0: 6965 7273 203d 2064 726f 705f 6f75 746c  iers = drop_outl
-0000f800: 6965 7273 2c20 0d0a 2020 2020 2020 2020  iers, ..        
-0000f810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f820: 2020 206d 6120 3d54 7275 6520 2c20 0d0a     ma =True , ..
+0000f7e0: 2064 726f 705f 6f75 746c 6965 7273 203d   drop_outliers =
+0000f7f0: 2064 726f 705f 6f75 746c 6965 7273 2c20   drop_outliers, 
+0000f800: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f810: 2020 2020 2020 2020 2020 2020 206d 6120               ma 
+0000f820: 3d54 7275 6520 2c20 0d0a 2020 2020 2020  =True , ..      
 0000f830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f840: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-0000f850: 2020 2020 2020 2020 2020 6966 2028 7263            if (rc
-0000f860: 203c 2030 292e 616e 7928 293a 200d 0a20   < 0).any(): .. 
-0000f870: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000f880: 6320 3d20 6e70 2e61 6273 2028 7263 2029  c = np.abs (rc )
-0000f890: 0d0a 0d0a 2020 2020 2020 2020 6966 2073  ....        if s
-0000f8a0: 656c 662e 6d6f 6465 203d 3d27 7361 6d65  elf.mode =='same
-0000f8b0: 273a 200d 0a20 2020 2020 2020 2020 2020  ': ..           
-0000f8c0: 2072 635b 3a2c 2030 5d20 3d20 7365 6c66   rc[:, 0] = self
-0000f8d0: 2e72 6573 3264 5f5b 3a2c 2030 5d0d 0a20  .res2d_[:, 0].. 
-0000f8e0: 2020 2020 2020 2020 2020 2023 207a 6a63             # zjc
-0000f8f0: 5b3a 2c20 305d 203d 207a 6a20 5b3a 2c20  [:, 0] = zj [:, 
-0000f900: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
-0000f910: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0000f920: 662e 6f75 7420 3d3d 277a 273a 200d 0a20  f.out =='z': .. 
-0000f930: 2020 2020 2020 2020 2020 2023 2072 6563             # rec
-0000f940: 6f6d 7075 7465 207a 2077 6974 6820 7468  ompute z with th
-0000f950: 6520 636f 7272 6563 7465 6420 7068 6173  e corrected phas
-0000f960: 650d 0a20 2020 2020 2020 2020 2020 2072  e..            r
-0000f970: 6320 3d20 7268 6f70 6869 327a 2872 632c  c = rhophi2z(rc,
-0000f980: 2070 6869 3d20 7068 6173 655f 632c 2066   phi= phase_c, f
-0000f990: 7265 713d 2073 656c 662e 6672 6571 735f  req= self.freqs_
-0000f9a0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-0000f9b0: 0a20 2020 2020 2020 2069 6620 736d 6f6f  .        if smoo
-0000f9c0: 7468 203a 200d 0a20 2020 2020 2020 2020  th : ..         
-0000f9d0: 2020 2070 6861 7365 5f63 203d 2073 6d6f     phase_c = smo
-0000f9e0: 6f74 6869 6e67 2028 2070 6861 7365 5f63  othing ( phase_c
-0000f9f0: 2c20 6472 6f70 5f6f 7574 6c69 6572 733d  , drop_outliers=
-0000fa00: 2064 726f 705f 6f75 746c 6965 7273 2029   drop_outliers )
-0000fa10: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-0000fa20: 2020 2020 2020 2020 7265 7475 726e 2020          return  
-0000fa30: 7263 2069 6620 6e6f 7420 7265 7475 726e  rc if not return
-0000fa40: 5f70 6869 2065 6c73 6520 2820 7263 2c20  _phi else ( rc, 
-0000fa50: 7068 6173 655f 6320 290d 0a0d 0a20 2020  phase_c )....   
-0000fa60: 2064 6566 2066 6c6d 6120 280d 0a20 2020   def flma (..   
-0000fa70: 2020 2020 2073 656c 662c 200d 0a20 2020       self, ..   
-0000fa80: 2020 2020 2073 6d6f 6f74 683a 626f 6f6c       smooth:bool
-0000fa90: 3d54 7275 652c 200d 0a20 2020 2020 2020  =True, ..       
-0000faa0: 2064 726f 705f 6f75 746c 6965 7273 3a62   drop_outliers:b
-0000fab0: 6f6f 6c3d 5472 7565 2c20 0d0a 2020 2020  ool=True, ..    
-0000fac0: 2020 2020 7265 7475 726e 5f70 6869 3a62      return_phi:b
-0000fad0: 6f6f 6c3d 4661 6c73 6520 0d0a 2020 2020  ool=False ..    
-0000fae0: 2020 2020 2920 3a0d 0a20 2020 2020 2020      ) :..       
-0000faf0: 2022 2222 2041 2066 6978 6564 2d6c 656e   """ A fixed-len
-0000fb00: 6774 682d 6d6f 7669 6e67 2d61 7665 7261  gth-moving-avera
-0000fb10: 6765 2066 696c 7465 7220 746f 2065 7374  ge filter to est
-0000fb20: 696d 6174 6520 6176 6572 6167 6520 6170  imate average ap
-0000fb30: 7061 7265 6e74 0d0a 2020 2020 2020 2020  parent..        
-0000fb40: 7265 7369 7374 6976 6974 6965 7320 6174  resistivities at
-0000fb50: 2061 2073 696e 676c 6520 7374 6174 6963   a single static
-0000fb60: 2d63 6f72 7265 6374 696f 6e2d 7265 6665  -correction-refe
-0000fb70: 7265 6e63 6520 6672 6571 7565 6e63 792e  rence frequency.
-0000fb80: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-0000fb90: 2020 2020 2054 6865 2046 4c4d 4120 6669       The FLMA fi
-0000fba0: 6c74 6572 2065 7374 696d 6174 6573 2073  lter estimates s
-0000fbb0: 7461 7469 632d 636f 7272 6563 7465 6420  tatic-corrected 
-0000fbc0: 6170 7061 7265 6e74 2072 6573 6973 7469  apparent resisti
-0000fbd0: 7669 7469 6573 2061 7420 6120 0d0a 2020  vities at a ..  
-0000fbe0: 2020 2020 2020 7369 6e67 6c65 2072 6566        single ref
-0000fbf0: 6572 656e 6365 2066 7265 7175 656e 6379  erence frequency
-0000fc00: 2062 7920 6361 6c63 756c 6174 696e 6720   by calculating 
-0000fc10: 6120 7072 6f66 696c 6520 6f66 2061 7665  a profile of ave
-0000fc20: 7261 6765 2069 6d70 6564 616e 6365 7320  rage impedances 
-0000fc30: 0d0a 2020 2020 2020 2020 616c 6f6e 6720  ..        along 
-0000fc40: 7468 6520 6c65 6e67 7468 206f 6620 7468  the length of th
-0000fc50: 6520 6c69 6e65 2e20 536f 756e 6469 6e67  e line. Sounding
-0000fc60: 2063 7572 7665 7320 6172 6520 7468 656e   curves are then
-0000fc70: 2073 6869 6674 6564 2073 6f20 7468 6174   shifted so that
-0000fc80: 2074 6865 790d 0a20 2020 2020 2020 2069   they..        i
-0000fc90: 6e74 6572 7365 6374 2074 6865 2061 7665  ntersect the ave
-0000fca0: 7261 6765 6420 7072 6f66 696c 652e 200d  raged profile. .
-0000fcb0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0000fcc0: 2020 2050 6172 616d 6574 6572 7320 0d0a     Parameters ..
-0000fcd0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000fce0: 2d2d 0d0a 2020 2020 2020 2020 736d 6f6f  --..        smoo
-0000fcf0: 7468 3a20 626f 6f6c 2c20 6465 6661 756c  th: bool, defaul
-0000fd00: 743d 5472 7565 2c20 0d0a 2020 2020 2020  t=True, ..      
-0000fd10: 2020 2020 2053 6d6f 6f74 6820 7468 6520       Smooth the 
-0000fd20: 7465 6e73 6f72 2064 6174 6120 616c 6f6e  tensor data alon
-0000fd30: 6720 7468 6520 6672 6571 7565 6e63 6965  g the frequencie
-0000fd40: 732e 200d 0a20 2020 2020 2020 200d 0a20  s. ..        .. 
-0000fd50: 2020 2020 2020 2064 726f 705f 6f75 746c         drop_outl
-0000fd60: 6965 7273 3a20 626f 6f6c 2c20 6465 6661  iers: bool, defa
-0000fd70: 756c 743d 5472 7565 200d 0a20 2020 2020  ult=True ..     
-0000fd80: 2020 2020 2020 5375 7070 7265 7373 206f        Suppress o
-0000fd90: 7574 6c69 6572 7320 696e 2074 6865 2064  utliers in the d
-0000fda0: 6174 6120 7768 656e 2073 6d6f 6f74 6869  ata when smoothi
-0000fdb0: 6e67 2064 6174 6120 616c 6f6e 6720 0d0a  ng data along ..
-0000fdc0: 2020 2020 2020 2020 2020 2074 6865 2066             the f
-0000fdd0: 7265 7175 656e 6369 6573 2061 7869 732e  requencies axis.
-0000fde0: 204e 6f74 6520 7468 6174 2060 6472 6f70   Note that `drop
-0000fdf0: 5f6f 7574 6c69 6572 7360 2064 6f65 7320  _outliers` does 
-0000fe00: 6e6f 7420 7461 6b65 200d 0a20 2020 2020  not take ..     
-0000fe10: 2020 2020 2020 6566 6665 6374 2069 6620        effect if 
-0000fe20: 6073 6d6f 6f74 6860 2069 7320 6060 4661  `smooth` is ``Fa
-0000fe30: 6c73 6560 602e 200d 0a20 2020 2020 2020  lse``. ..       
-0000fe40: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
-0000fe50: 6e5f 7068 693a 2062 6f6f 6c2c 2064 6566  n_phi: bool, def
-0000fe60: 6175 6c74 3d46 616c 7365 2c20 0d0a 2020  ault=False, ..  
-0000fe70: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000fe80: 636f 7272 6563 7465 6420 7068 6173 6520  corrected phase 
-0000fe90: 696e 2064 6567 7265 6573 2e20 4d6f 7374  in degrees. Most
-0000fea0: 6c79 2074 6865 2070 6861 7365 2064 6f65  ly the phase doe
-0000feb0: 7320 6e6f 7420 6e65 6564 200d 0a20 2020  s not need ..   
-0000fec0: 2020 2020 2020 2020 746f 2063 6f72 7265          to corre
-0000fed0: 6374 2073 696e 6365 2069 7420 6973 206e  ct since it is n
-0000fee0: 6f74 2061 6666 6563 7465 6420 6279 2074  ot affected by t
-0000fef0: 6865 2073 7461 7469 6320 7368 6966 7420  he static shift 
-0000ff00: 6566 6665 6374 2e0d 0a20 2020 2020 2020  effect...       
-0000ff10: 2020 2020 486f 7765 7665 722c 2069 7420      However, it 
-0000ff20: 6361 6e20 6265 2061 7320 736d 6f6f 7468  can be as smooth
-0000ff30: 2070 6861 7365 2063 7572 7665 2077 6865   phase curve whe
-0000ff40: 6e20 6060 736d 6f6f 7468 3d54 7275 6560  n ``smooth=True`
-0000ff50: 600d 0a20 2020 2020 2020 2020 2020 0d0a  `..           ..
-0000ff60: 2020 2020 2020 2020 2e2e 2076 6572 7369          .. versi
-0000ff70: 6f6e 6164 6465 643a 3a20 302e 322e 3120  onadded:: 0.2.1 
-0000ff80: 0d0a 2020 2020 2020 2020 2020 2050 6f6c  ..           Pol
-0000ff90: 6973 6820 7468 6520 7465 6e73 6f72 2064  ish the tensor d
-0000ffa0: 6174 6120 616c 6f6e 6720 7468 6520 6672  ata along the fr
-0000ffb0: 6571 7565 6e63 7920 6178 6973 2072 656d  equency axis rem
-0000ffc0: 6f76 6520 6e6f 6973 6573 200d 0a20 2020  ove noises ..   
-0000ffd0: 2020 2020 2020 2020 616e 6420 6465 616c          and deal
-0000ffe0: 2077 6974 6820 7468 6520 7374 6174 6963   with the static
-0000fff0: 2073 6869 6674 2065 6666 6563 7420 7768   shift effect wh
-00010000: 656e 2069 6e74 6572 6665 7265 6e63 6573  en interferences
-00010010: 206e 6f69 7365 7320 0d0a 2020 2020 2020   noises ..      
-00010020: 2020 2020 2061 7265 2073 7472 6f6e 6720       are strong 
-00010030: 656e 6f75 6768 2e20 0d0a 2020 200d 0a20  enough. ..   .. 
-00010040: 2020 2020 2020 2052 6574 7572 6e73 200d         Returns .
-00010050: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00010060: 0d0a 2020 2020 2020 2020 7263 3a20 6e70  ..        rc: np
-00010070: 2e6e 6461 7272 6179 2c20 7368 6170 6520  .ndarray, shape 
-00010080: 2028 4e2c 204d 290d 0a20 2020 2020 2020   (N, M)..       
-00010090: 2020 2020 2045 4d41 5020 6170 7061 7265       EMAP appare
-000100a0: 6e74 2020 7265 7369 7374 6976 6974 7920  nt  resistivity 
-000100b0: 7374 6174 6963 2073 6869 6674 2063 6f72  static shift cor
-000100c0: 7265 6374 6564 206f 7220 7374 6174 6963  rected or static
-000100d0: 200d 0a20 2020 2020 2020 2020 2020 2063   ..            c
-000100e0: 6f72 7265 6374 696f 6e20 6661 6374 6f72  orrection factor
-000100f0: 206f 7220 696d 7065 6461 6e63 6520 7465   or impedance te
-00010100: 6e73 6f72 2e0d 0a20 2020 2020 2020 2020  nsor...         
-00010110: 2020 200d 0a20 2020 2020 2020 2072 632c     ..        rc,
-00010120: 2070 6869 5f63 3a20 5475 706c 6520 6f66   phi_c: Tuple of
-00010130: 2073 6861 7065 2028 4e2c 204e 2920 0d0a   shape (N, N) ..
-00010140: 2020 2020 2020 2020 2020 2045 4d41 5020             EMAP 
-00010150: 6170 7061 7265 6e74 2072 6573 6973 7469  apparent resisti
-00010160: 7669 7479 2061 6e64 2070 6861 7365 2063  vity and phase c
-00010170: 6f72 7265 6374 6564 2e20 0d0a 2020 2020  orrected. ..    
-00010180: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00010190: 2020 4578 616d 706c 6520 0d0a 2020 2020    Example ..    
-000101a0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020      --------..  
-000101b0: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-000101c0: 2077 6174 6578 2061 7320 7778 0d0a 2020   watex as wx..  
-000101d0: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-000101e0: 206d 6174 706c 6f74 6c69 622e 7079 706c   matplotlib.pypl
-000101f0: 6f74 2061 7320 706c 7420 0d0a 2020 2020  ot as plt ..    
-00010200: 2020 2020 3e3e 3e20 6564 695f 6461 7461      >>> edi_data
-00010210: 203d 2077 782e 6665 7463 685f 6461 7461   = wx.fetch_data
-00010220: 2028 2765 6469 7327 2c20 6173 5f66 7261   ('edis', as_fra
-00010230: 6d65 203d 5472 7565 2c20 6b65 7920 3d27  me =True, key ='
-00010240: 6564 6927 290d 0a20 2020 2020 2020 203e  edi')..        >
-00010250: 3e3e 2070 203d 2077 782e 454d 5072 6f63  >> p = wx.EMProc
-00010260: 6573 7369 6e67 2028 6f75 743d 277a 2729  essing (out='z')
-00010270: 2e66 6974 2865 6469 5f64 6174 612e 6564  .fit(edi_data.ed
-00010280: 6929 200d 0a20 2020 2020 2020 203e 3e3e  i) ..        >>>
-00010290: 207a 5f63 6f72 7265 6374 6564 203d 2070   z_corrected = p
-000102a0: 2e66 6c6d 6120 2829 2023 206f 7574 7075  .flma () # outpu
-000102b0: 7420 7a20 696e 2063 6f6d 706c 6578 2064  t z in complex d
-000102c0: 7479 7065 200d 0a20 2020 2020 2020 203e  type ..        >
-000102d0: 3e3e 2070 6c74 2e70 6c6f 7420 286e 702e  >> plt.plot (np.
-000102e0: 6172 616e 6765 2028 6c65 6e28 702e 6564  arange (len(p.ed
-000102f0: 694f 626a 735f 2929 202c 206e 702e 6162  iObjs_)) , np.ab
-00010300: 7328 200d 0a20 2020 2020 2020 2020 2020  s( ..           
-00010310: 205b 2065 6469 6f62 6a2e 5a2e 7a5b 3a2c   [ ediobj.Z.z[:,
-00010320: 2030 2c20 315d 5b37 5d20 2066 6f72 2065   0, 1][7]  for e
-00010330: 6469 6f62 6a20 696e 2070 2e65 6469 4f62  diobj in p.ediOb
-00010340: 6a73 5f5d 2920 2c20 272d 6f6b 272c 0d0a  js_]) , '-ok',..
-00010350: 2020 2020 2020 2020 2020 2020 6e70 2e61              np.a
-00010360: 7261 6e67 6528 6c65 6e28 702e 6564 694f  range(len(p.ediO
-00010370: 626a 735f 2929 2c20 6e70 2e61 6273 2820  bjs_)), np.abs( 
-00010380: 7a5f 636f 7272 6563 7465 645b 372c 3a20  z_corrected[7,: 
-00010390: 5d29 202c 2027 6f72 2d27 290d 0a20 2020  ]) , 'or-')..   
-000103a0: 2020 2020 200d 0a20 2020 2020 2020 2052       ..        R
-000103b0: 6566 6572 656e 6365 7320 0d0a 2020 2020  eferences ..    
-000103c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d      -----------.
-000103d0: 0a20 2020 2020 2020 202e 2e20 5b31 5d20  .        .. [1] 
-000103e0: 6874 7470 3a2f 2f77 7777 2e7a 6f6e 6765  http://www.zonge
-000103f0: 2e63 6f6d 2f6c 6567 6163 792f 5044 465f  .com/legacy/PDF_
-00010400: 4461 7450 726f 2f41 7374 6174 6963 2e70  DatPro/Astatic.p
-00010410: 6466 0d0a 2020 2020 2020 2020 0d0a 2020  df..        ..  
-00010420: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00010430: 2020 2073 656c 662e 696e 7370 6563 7420     self.inspect 
-00010440: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
-00010450: 2320 6173 7365 7274 2066 696c 7465 7220  # assert filter 
-00010460: 6172 6775 6d65 6e74 7320 0d0a 2020 2020  arguments ..    
-00010470: 2020 2020 7365 6c66 2e72 6573 3264 5f20      self.res2d_ 
-00010480: 2c20 7365 6c66 2e70 6873 3264 5f20 2c20  , self.phs2d_ , 
-00010490: 7365 6c66 2e66 7265 7173 5f2c 2073 656c  self.freqs_, sel
-000104a0: 662e 632c 2073 656c 662e 7769 6e64 6f77  f.c, self.window
-000104b0: 5f73 697a 652c 205c 0d0a 2020 2020 2020  _size, \..      
-000104c0: 2020 2020 2020 7365 6c66 2e63 6f6d 706f        self.compo
-000104d0: 6e65 6e74 2c20 7365 6c66 2e6f 7574 203d  nent, self.out =
-000104e0: 2073 656c 662e 5f6d 616b 6532 6462 6c6f   self._make2dblo
-000104f0: 6273 2028 290d 0a20 2020 2020 2020 2023  bs ()..        #
-00010500: 2020 696e 7465 7270 6f6c 6174 6520 7265    interpolate re
-00010510: 7369 7374 6976 6974 7920 616e 6420 7068  sistivity and ph
-00010520: 6173 6573 200d 0a20 2020 2020 2020 2073  ases ..        s
-00010530: 656c 662e 7068 7332 645f 3d20 696e 7465  elf.phs2d_= inte
-00010540: 7270 6f6c 6174 6532 6428 7365 6c66 2e70  rpolate2d(self.p
-00010550: 6873 3264 5f2c 206d 6574 686f 6420 3d73  hs2d_, method =s
-00010560: 656c 662e 6d65 7468 6f64 290d 0a20 2020  elf.method)..   
-00010570: 2020 2020 2073 656c 662e 7265 7332 645f       self.res2d_
-00010580: 3d20 696e 7465 7270 6f6c 6174 6532 6428  = interpolate2d(
-00010590: 7365 6c66 2e72 6573 3264 5f2c 206d 6574  self.res2d_, met
-000105a0: 686f 6420 3d73 656c 662e 6d65 7468 6f64  hod =self.method
-000105b0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-000105c0: 2020 2020 2023 2063 6f6e 7665 7274 2061       # convert a
-000105d0: 7070 2e20 7265 7369 7374 6976 6974 7920  pp. resistivity 
-000105e0: 616e 6420 696d 7065 6461 6e63 6520 7068  and impedance ph
-000105f0: 6173 6520 2074 6f20 0d0a 2020 2020 2020  ase  to ..      
-00010600: 2020 2369 6d70 6564 616e 6365 2076 616c    #impedance val
-00010610: 7565 732c 205a 6a2c 2066 6f72 2065 6163  ues, Zj, for eac
-00010620: 6820 7374 6174 696f 6e0d 0a20 2020 2020  h station..     
-00010630: 2020 206f 6d65 6761 3020 3d20 3220 2a20     omega0 = 2 * 
-00010640: 6e70 2e70 6920 2a20 7365 6c66 2e66 7265  np.pi * self.fre
-00010650: 7173 5f0d 0a20 2020 2020 2020 207a 6a20  qs_..        zj 
-00010660: 3d20 6e70 2e73 7172 7428 7365 6c66 2e72  = np.sqrt(self.r
-00010670: 6573 3264 5f20 2a20 6f6d 6567 6130 5b3a  es2d_ * omega0[:
-00010680: 2c20 4e6f 6e65 5d20 2a20 6d75 3020 2920  , None] * mu0 ) 
-00010690: 2a20 286e 702e 636f 7320 280d 0a20 2020  * (np.cos (..   
-000106a0: 2020 2020 2020 2020 206e 702e 6465 6732           np.deg2
-000106b0: 7261 6428 7365 6c66 2e70 6873 3264 5f29  rad(self.phs2d_)
-000106c0: 2920 2b20 316a 202a 206e 702e 7369 6e28  ) + 1j * np.sin(
-000106d0: 6e70 2e64 6567 3272 6164 2873 656c 662e  np.deg2rad(self.
-000106e0: 7068 7332 645f 2929 290d 0a20 2020 2020  phs2d_)))..     
-000106f0: 2020 200d 0a20 2020 2020 2020 2023 2063     ..        # c
-00010700: 6f6d 7075 7465 2074 6865 2077 6569 6768  ompute the weigh
-00010710: 7420 6661 6374 6f72 2066 6f72 2063 6f6e  t factor for con
-00010720: 766f 6c75 7469 6e67 200d 0a20 2020 2020  voluting ..     
-00010730: 2020 2023 204c 203d 2064 6970 6f6c 6520     # L = dipole 
-00010740: 6c65 6e67 7468 203d 204c 0d0a 2020 2020  length = L..    
-00010750: 2020 2020 7720 3d20 6e70 2e61 7272 6179      w = np.array
-00010760: 285b 6265 7461 6a20 2878 6a20 3d20 6969  ([betaj (xj = ii
-00010770: 2c20 4c3d 2031 202c 2057 3d20 7365 6c66  , L= 1 , W= self
-00010780: 2e77 696e 646f 775f 7369 7a65 2920 0d0a  .window_size) ..
+0000f840: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+0000f850: 2020 2020 6966 2028 7263 203c 2030 292e      if (rc < 0).
+0000f860: 616e 7928 293a 200d 0a20 2020 2020 2020  any(): ..       
+0000f870: 2020 2020 2020 2020 2072 6320 3d20 6e70           rc = np
+0000f880: 2e61 6273 2028 7263 2029 0d0a 0d0a 2020  .abs (rc )....  
+0000f890: 2020 2020 2020 6966 2073 656c 662e 6d6f        if self.mo
+0000f8a0: 6465 203d 3d27 7361 6d65 273a 200d 0a20  de =='same': .. 
+0000f8b0: 2020 2020 2020 2020 2020 2072 635b 3a2c             rc[:,
+0000f8c0: 2030 5d20 3d20 7365 6c66 2e72 6573 3264   0] = self.res2d
+0000f8d0: 5f5b 3a2c 2030 5d0d 0a20 2020 2020 2020  _[:, 0]..       
+0000f8e0: 2020 2020 2023 207a 6a63 5b3a 2c20 305d       # zjc[:, 0]
+0000f8f0: 203d 207a 6a20 5b3a 2c20 305d 0d0a 2020   = zj [:, 0]..  
+0000f900: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000f910: 2020 2020 6966 2073 656c 662e 6f75 7420      if self.out 
+0000f920: 3d3d 277a 273a 200d 0a20 2020 2020 2020  =='z': ..       
+0000f930: 2020 2020 2023 2072 6563 6f6d 7075 7465       # recompute
+0000f940: 207a 2077 6974 6820 7468 6520 636f 7272   z with the corr
+0000f950: 6563 7465 6420 7068 6173 650d 0a20 2020  ected phase..   
+0000f960: 2020 2020 2020 2020 2072 6320 3d20 7268           rc = rh
+0000f970: 6f70 6869 327a 2872 632c 2070 6869 3d20  ophi2z(rc, phi= 
+0000f980: 7068 6173 655f 632c 2066 7265 713d 2073  phase_c, freq= s
+0000f990: 656c 662e 6672 6571 735f 290d 0a20 2020  elf.freqs_)..   
+0000f9a0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0000f9b0: 2020 2069 6620 736d 6f6f 7468 203a 200d     if smooth : .
+0000f9c0: 0a20 2020 2020 2020 2020 2020 2070 6861  .            pha
+0000f9d0: 7365 5f63 203d 2073 6d6f 6f74 6869 6e67  se_c = smoothing
+0000f9e0: 2028 2070 6861 7365 5f63 2c20 6472 6f70   ( phase_c, drop
+0000f9f0: 5f6f 7574 6c69 6572 733d 2064 726f 705f  _outliers= drop_
+0000fa00: 6f75 746c 6965 7273 2029 0d0a 2020 2020  outliers )..    
+0000fa10: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000fa20: 2020 7265 7475 726e 2020 7263 2069 6620    return  rc if 
+0000fa30: 6e6f 7420 7265 7475 726e 5f70 6869 2065  not return_phi e
+0000fa40: 6c73 6520 2820 7263 2c20 7068 6173 655f  lse ( rc, phase_
+0000fa50: 6320 290d 0a0d 0a20 2020 2064 6566 2066  c )....    def f
+0000fa60: 6c6d 6120 280d 0a20 2020 2020 2020 2073  lma (..        s
+0000fa70: 656c 662c 200d 0a20 2020 2020 2020 2073  elf, ..        s
+0000fa80: 6d6f 6f74 683a 626f 6f6c 3d54 7275 652c  mooth:bool=True,
+0000fa90: 200d 0a20 2020 2020 2020 2064 726f 705f   ..        drop_
+0000faa0: 6f75 746c 6965 7273 3a62 6f6f 6c3d 5472  outliers:bool=Tr
+0000fab0: 7565 2c20 0d0a 2020 2020 2020 2020 7265  ue, ..        re
+0000fac0: 7475 726e 5f70 6869 3a62 6f6f 6c3d 4661  turn_phi:bool=Fa
+0000fad0: 6c73 6520 0d0a 2020 2020 2020 2020 2920  lse ..        ) 
+0000fae0: 3a0d 0a20 2020 2020 2020 2022 2222 2041  :..        """ A
+0000faf0: 2066 6978 6564 2d6c 656e 6774 682d 6d6f   fixed-length-mo
+0000fb00: 7669 6e67 2d61 7665 7261 6765 2066 696c  ving-average fil
+0000fb10: 7465 7220 746f 2065 7374 696d 6174 6520  ter to estimate 
+0000fb20: 6176 6572 6167 6520 6170 7061 7265 6e74  average apparent
+0000fb30: 0d0a 2020 2020 2020 2020 7265 7369 7374  ..        resist
+0000fb40: 6976 6974 6965 7320 6174 2061 2073 696e  ivities at a sin
+0000fb50: 676c 6520 7374 6174 6963 2d63 6f72 7265  gle static-corre
+0000fb60: 6374 696f 6e2d 7265 6665 7265 6e63 6520  ction-reference 
+0000fb70: 6672 6571 7565 6e63 792e 200d 0a20 2020  frequency. ..   
+0000fb80: 2020 2020 200d 0a20 2020 2020 2020 2054       ..        T
+0000fb90: 6865 2046 4c4d 4120 6669 6c74 6572 2065  he FLMA filter e
+0000fba0: 7374 696d 6174 6573 2073 7461 7469 632d  stimates static-
+0000fbb0: 636f 7272 6563 7465 6420 6170 7061 7265  corrected appare
+0000fbc0: 6e74 2072 6573 6973 7469 7669 7469 6573  nt resistivities
+0000fbd0: 2061 7420 6120 0d0a 2020 2020 2020 2020   at a ..        
+0000fbe0: 7369 6e67 6c65 2072 6566 6572 656e 6365  single reference
+0000fbf0: 2066 7265 7175 656e 6379 2062 7920 6361   frequency by ca
+0000fc00: 6c63 756c 6174 696e 6720 6120 7072 6f66  lculating a prof
+0000fc10: 696c 6520 6f66 2061 7665 7261 6765 2069  ile of average i
+0000fc20: 6d70 6564 616e 6365 7320 0d0a 2020 2020  mpedances ..    
+0000fc30: 2020 2020 616c 6f6e 6720 7468 6520 6c65      along the le
+0000fc40: 6e67 7468 206f 6620 7468 6520 6c69 6e65  ngth of the line
+0000fc50: 2e20 536f 756e 6469 6e67 2063 7572 7665  . Sounding curve
+0000fc60: 7320 6172 6520 7468 656e 2073 6869 6674  s are then shift
+0000fc70: 6564 2073 6f20 7468 6174 2074 6865 790d  ed so that they.
+0000fc80: 0a20 2020 2020 2020 2069 6e74 6572 7365  .        interse
+0000fc90: 6374 2074 6865 2061 7665 7261 6765 6420  ct the averaged 
+0000fca0: 7072 6f66 696c 652e 200d 0a20 2020 2020  profile. ..     
+0000fcb0: 2020 200d 0a20 2020 2020 2020 2050 6172     ..        Par
+0000fcc0: 616d 6574 6572 7320 0d0a 2020 2020 2020  ameters ..      
+0000fcd0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0000fce0: 2020 2020 2020 736d 6f6f 7468 3a20 626f        smooth: bo
+0000fcf0: 6f6c 2c20 6465 6661 756c 743d 5472 7565  ol, default=True
+0000fd00: 2c20 0d0a 2020 2020 2020 2020 2020 2053  , ..           S
+0000fd10: 6d6f 6f74 6820 7468 6520 7465 6e73 6f72  mooth the tensor
+0000fd20: 2064 6174 6120 616c 6f6e 6720 7468 6520   data along the 
+0000fd30: 6672 6571 7565 6e63 6965 732e 200d 0a20  frequencies. .. 
+0000fd40: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0000fd50: 2064 726f 705f 6f75 746c 6965 7273 3a20   drop_outliers: 
+0000fd60: 626f 6f6c 2c20 6465 6661 756c 743d 5472  bool, default=Tr
+0000fd70: 7565 200d 0a20 2020 2020 2020 2020 2020  ue ..           
+0000fd80: 5375 7070 7265 7373 206f 7574 6c69 6572  Suppress outlier
+0000fd90: 7320 696e 2074 6865 2064 6174 6120 7768  s in the data wh
+0000fda0: 656e 2073 6d6f 6f74 6869 6e67 2064 6174  en smoothing dat
+0000fdb0: 6120 616c 6f6e 6720 0d0a 2020 2020 2020  a along ..      
+0000fdc0: 2020 2020 2074 6865 2066 7265 7175 656e       the frequen
+0000fdd0: 6369 6573 2061 7869 732e 204e 6f74 6520  cies axis. Note 
+0000fde0: 7468 6174 2060 6472 6f70 5f6f 7574 6c69  that `drop_outli
+0000fdf0: 6572 7360 2064 6f65 7320 6e6f 7420 7461  ers` does not ta
+0000fe00: 6b65 200d 0a20 2020 2020 2020 2020 2020  ke ..           
+0000fe10: 6566 6665 6374 2069 6620 6073 6d6f 6f74  effect if `smoot
+0000fe20: 6860 2069 7320 6060 4661 6c73 6560 602e  h` is ``False``.
+0000fe30: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0000fe40: 2020 2020 2072 6574 7572 6e5f 7068 693a       return_phi:
+0000fe50: 2062 6f6f 6c2c 2064 6566 6175 6c74 3d46   bool, default=F
+0000fe60: 616c 7365 2c20 0d0a 2020 2020 2020 2020  alse, ..        
+0000fe70: 2020 2072 6574 7572 6e20 636f 7272 6563     return correc
+0000fe80: 7465 6420 7068 6173 6520 696e 2064 6567  ted phase in deg
+0000fe90: 7265 6573 2e20 4d6f 7374 6c79 2074 6865  rees. Mostly the
+0000fea0: 2070 6861 7365 2064 6f65 7320 6e6f 7420   phase does not 
+0000feb0: 6e65 6564 200d 0a20 2020 2020 2020 2020  need ..         
+0000fec0: 2020 746f 2063 6f72 7265 6374 2073 696e    to correct sin
+0000fed0: 6365 2069 7420 6973 206e 6f74 2061 6666  ce it is not aff
+0000fee0: 6563 7465 6420 6279 2074 6865 2073 7461  ected by the sta
+0000fef0: 7469 6320 7368 6966 7420 6566 6665 6374  tic shift effect
+0000ff00: 2e0d 0a20 2020 2020 2020 2020 2020 486f  ...           Ho
+0000ff10: 7765 7665 722c 2069 7420 6361 6e20 6265  wever, it can be
+0000ff20: 2061 7320 736d 6f6f 7468 2070 6861 7365   as smooth phase
+0000ff30: 2063 7572 7665 2077 6865 6e20 6060 736d   curve when ``sm
+0000ff40: 6f6f 7468 3d54 7275 6560 600d 0a20 2020  ooth=True``..   
+0000ff50: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0000ff60: 2020 2e2e 2076 6572 7369 6f6e 6164 6465    .. versionadde
+0000ff70: 643a 3a20 302e 322e 3120 0d0a 2020 2020  d:: 0.2.1 ..    
+0000ff80: 2020 2020 2020 2050 6f6c 6973 6820 7468         Polish th
+0000ff90: 6520 7465 6e73 6f72 2064 6174 6120 616c  e tensor data al
+0000ffa0: 6f6e 6720 7468 6520 6672 6571 7565 6e63  ong the frequenc
+0000ffb0: 7920 6178 6973 2072 656d 6f76 6520 6e6f  y axis remove no
+0000ffc0: 6973 6573 200d 0a20 2020 2020 2020 2020  ises ..         
+0000ffd0: 2020 616e 6420 6465 616c 2077 6974 6820    and deal with 
+0000ffe0: 7468 6520 7374 6174 6963 2073 6869 6674  the static shift
+0000fff0: 2065 6666 6563 7420 7768 656e 2069 6e74   effect when int
+00010000: 6572 6665 7265 6e63 6573 206e 6f69 7365  erferences noise
+00010010: 7320 0d0a 2020 2020 2020 2020 2020 2061  s ..           a
+00010020: 7265 2073 7472 6f6e 6720 656e 6f75 6768  re strong enough
+00010030: 2e20 0d0a 2020 200d 0a20 2020 2020 2020  . ..   ..       
+00010040: 2052 6574 7572 6e73 200d 0a20 2020 2020   Returns ..     
+00010050: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00010060: 2020 2020 7263 3a20 6e70 2e6e 6461 7272      rc: np.ndarr
+00010070: 6179 2c20 7368 6170 6520 2028 4e2c 204d  ay, shape  (N, M
+00010080: 290d 0a20 2020 2020 2020 2020 2020 2045  )..            E
+00010090: 4d41 5020 6170 7061 7265 6e74 2020 7265  MAP apparent  re
+000100a0: 7369 7374 6976 6974 7920 7374 6174 6963  sistivity static
+000100b0: 2073 6869 6674 2063 6f72 7265 6374 6564   shift corrected
+000100c0: 206f 7220 7374 6174 6963 200d 0a20 2020   or static ..   
+000100d0: 2020 2020 2020 2020 2063 6f72 7265 6374           correct
+000100e0: 696f 6e20 6661 6374 6f72 206f 7220 696d  ion factor or im
+000100f0: 7065 6461 6e63 6520 7465 6e73 6f72 2e0d  pedance tensor..
+00010100: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00010110: 2020 2020 2020 2072 632c 2070 6869 5f63         rc, phi_c
+00010120: 3a20 5475 706c 6520 6f66 2073 6861 7065  : Tuple of shape
+00010130: 2028 4e2c 204e 2920 0d0a 2020 2020 2020   (N, N) ..      
+00010140: 2020 2020 2045 4d41 5020 6170 7061 7265       EMAP appare
+00010150: 6e74 2072 6573 6973 7469 7669 7479 2061  nt resistivity a
+00010160: 6e64 2070 6861 7365 2063 6f72 7265 6374  nd phase correct
+00010170: 6564 2e20 0d0a 2020 2020 2020 2020 2020  ed. ..          
+00010180: 2020 0d0a 2020 2020 2020 2020 4578 616d    ..        Exam
+00010190: 706c 6520 0d0a 2020 2020 2020 2020 2d2d  ple ..        --
+000101a0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+000101b0: 3e3e 3e20 696d 706f 7274 2077 6174 6578  >>> import watex
+000101c0: 2061 7320 7778 0d0a 2020 2020 2020 2020   as wx..        
+000101d0: 3e3e 3e20 696d 706f 7274 206d 6174 706c  >>> import matpl
+000101e0: 6f74 6c69 622e 7079 706c 6f74 2061 7320  otlib.pyplot as 
+000101f0: 706c 7420 0d0a 2020 2020 2020 2020 3e3e  plt ..        >>
+00010200: 3e20 6564 695f 6461 7461 203d 2077 782e  > edi_data = wx.
+00010210: 6665 7463 685f 6461 7461 2028 2765 6469  fetch_data ('edi
+00010220: 7327 2c20 6173 5f66 7261 6d65 203d 5472  s', as_frame =Tr
+00010230: 7565 2c20 6b65 7920 3d27 6564 6927 290d  ue, key ='edi').
+00010240: 0a20 2020 2020 2020 203e 3e3e 2070 203d  .        >>> p =
+00010250: 2077 782e 454d 5072 6f63 6573 7369 6e67   wx.EMProcessing
+00010260: 2028 6f75 743d 277a 2729 2e66 6974 2865   (out='z').fit(e
+00010270: 6469 5f64 6174 612e 6564 6929 200d 0a20  di_data.edi) .. 
+00010280: 2020 2020 2020 203e 3e3e 207a 5f63 6f72         >>> z_cor
+00010290: 7265 6374 6564 203d 2070 2e66 6c6d 6120  rected = p.flma 
+000102a0: 2829 2023 206f 7574 7075 7420 7a20 696e  () # output z in
+000102b0: 2063 6f6d 706c 6578 2064 7479 7065 200d   complex dtype .
+000102c0: 0a20 2020 2020 2020 203e 3e3e 2070 6c74  .        >>> plt
+000102d0: 2e70 6c6f 7420 286e 702e 6172 616e 6765  .plot (np.arange
+000102e0: 2028 6c65 6e28 702e 6564 694f 626a 735f   (len(p.ediObjs_
+000102f0: 2929 202c 206e 702e 6162 7328 200d 0a20  )) , np.abs( .. 
+00010300: 2020 2020 2020 2020 2020 205b 2065 6469             [ edi
+00010310: 6f62 6a2e 5a2e 7a5b 3a2c 2030 2c20 315d  obj.Z.z[:, 0, 1]
+00010320: 5b37 5d20 2066 6f72 2065 6469 6f62 6a20  [7]  for ediobj 
+00010330: 696e 2070 2e65 6469 4f62 6a73 5f5d 2920  in p.ediObjs_]) 
+00010340: 2c20 272d 6f6b 272c 0d0a 2020 2020 2020  , '-ok',..      
+00010350: 2020 2020 2020 6e70 2e61 7261 6e67 6528        np.arange(
+00010360: 6c65 6e28 702e 6564 694f 626a 735f 2929  len(p.ediObjs_))
+00010370: 2c20 6e70 2e61 6273 2820 7a5f 636f 7272  , np.abs( z_corr
+00010380: 6563 7465 645b 372c 3a20 5d29 202c 2027  ected[7,: ]) , '
+00010390: 6f72 2d27 290d 0a20 2020 2020 2020 200d  or-')..        .
+000103a0: 0a20 2020 2020 2020 2052 6566 6572 656e  .        Referen
+000103b0: 6365 7320 0d0a 2020 2020 2020 2020 2d2d  ces ..        --
+000103c0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+000103d0: 2020 202e 2e20 5b31 5d20 6874 7470 3a2f     .. [1] http:/
+000103e0: 2f77 7777 2e7a 6f6e 6765 2e63 6f6d 2f6c  /www.zonge.com/l
+000103f0: 6567 6163 792f 5044 465f 4461 7450 726f  egacy/PDF_DatPro
+00010400: 2f41 7374 6174 6963 2e70 6466 0d0a 2020  /Astatic.pdf..  
+00010410: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00010420: 2222 220d 0a20 2020 2020 2020 2073 656c  """..        sel
+00010430: 662e 696e 7370 6563 7420 0d0a 2020 2020  f.inspect ..    
+00010440: 0d0a 2020 2020 2020 2020 2320 6173 7365  ..        # asse
+00010450: 7274 2066 696c 7465 7220 6172 6775 6d65  rt filter argume
+00010460: 6e74 7320 0d0a 2020 2020 2020 2020 7365  nts ..        se
+00010470: 6c66 2e72 6573 3264 5f20 2c20 7365 6c66  lf.res2d_ , self
+00010480: 2e70 6873 3264 5f20 2c20 7365 6c66 2e66  .phs2d_ , self.f
+00010490: 7265 7173 5f2c 2073 656c 662e 632c 2073  reqs_, self.c, s
+000104a0: 656c 662e 7769 6e64 6f77 5f73 697a 652c  elf.window_size,
+000104b0: 205c 0d0a 2020 2020 2020 2020 2020 2020   \..            
+000104c0: 7365 6c66 2e63 6f6d 706f 6e65 6e74 2c20  self.component, 
+000104d0: 7365 6c66 2e6f 7574 203d 2073 656c 662e  self.out = self.
+000104e0: 5f6d 616b 6532 6462 6c6f 6273 2028 290d  _make2dblobs ().
+000104f0: 0a20 2020 2020 2020 2023 2020 696e 7465  .        #  inte
+00010500: 7270 6f6c 6174 6520 7265 7369 7374 6976  rpolate resistiv
+00010510: 6974 7920 616e 6420 7068 6173 6573 200d  ity and phases .
+00010520: 0a20 2020 2020 2020 2073 656c 662e 7068  .        self.ph
+00010530: 7332 645f 3d20 696e 7465 7270 6f6c 6174  s2d_= interpolat
+00010540: 6532 6428 7365 6c66 2e70 6873 3264 5f2c  e2d(self.phs2d_,
+00010550: 206d 6574 686f 6420 3d73 656c 662e 6d65   method =self.me
+00010560: 7468 6f64 290d 0a20 2020 2020 2020 2073  thod)..        s
+00010570: 656c 662e 7265 7332 645f 3d20 696e 7465  elf.res2d_= inte
+00010580: 7270 6f6c 6174 6532 6428 7365 6c66 2e72  rpolate2d(self.r
+00010590: 6573 3264 5f2c 206d 6574 686f 6420 3d73  es2d_, method =s
+000105a0: 656c 662e 6d65 7468 6f64 290d 0a20 2020  elf.method)..   
+000105b0: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+000105c0: 2063 6f6e 7665 7274 2061 7070 2e20 7265   convert app. re
+000105d0: 7369 7374 6976 6974 7920 616e 6420 696d  sistivity and im
+000105e0: 7065 6461 6e63 6520 7068 6173 6520 2074  pedance phase  t
+000105f0: 6f20 0d0a 2020 2020 2020 2020 2369 6d70  o ..        #imp
+00010600: 6564 616e 6365 2076 616c 7565 732c 205a  edance values, Z
+00010610: 6a2c 2066 6f72 2065 6163 6820 7374 6174  j, for each stat
+00010620: 696f 6e0d 0a20 2020 2020 2020 206f 6d65  ion..        ome
+00010630: 6761 3020 3d20 3220 2a20 6e70 2e70 6920  ga0 = 2 * np.pi 
+00010640: 2a20 7365 6c66 2e66 7265 7173 5f0d 0a20  * self.freqs_.. 
+00010650: 2020 2020 2020 207a 6a20 3d20 6e70 2e73         zj = np.s
+00010660: 7172 7428 7365 6c66 2e72 6573 3264 5f20  qrt(self.res2d_ 
+00010670: 2a20 6f6d 6567 6130 5b3a 2c20 4e6f 6e65  * omega0[:, None
+00010680: 5d20 2a20 6d75 3020 2920 2a20 286e 702e  ] * mu0 ) * (np.
+00010690: 636f 7320 280d 0a20 2020 2020 2020 2020  cos (..         
+000106a0: 2020 206e 702e 6465 6732 7261 6428 7365     np.deg2rad(se
+000106b0: 6c66 2e70 6873 3264 5f29 2920 2b20 316a  lf.phs2d_)) + 1j
+000106c0: 202a 206e 702e 7369 6e28 6e70 2e64 6567   * np.sin(np.deg
+000106d0: 3272 6164 2873 656c 662e 7068 7332 645f  2rad(self.phs2d_
+000106e0: 2929 290d 0a20 2020 2020 2020 200d 0a20  )))..        .. 
+000106f0: 2020 2020 2020 2023 2063 6f6d 7075 7465         # compute
+00010700: 2074 6865 2077 6569 6768 7420 6661 6374   the weight fact
+00010710: 6f72 2066 6f72 2063 6f6e 766f 6c75 7469  or for convoluti
+00010720: 6e67 200d 0a20 2020 2020 2020 2023 204c  ng ..        # L
+00010730: 203d 2064 6970 6f6c 6520 6c65 6e67 7468   = dipole length
+00010740: 203d 204c 0d0a 2020 2020 2020 2020 7720   = L..        w 
+00010750: 3d20 6e70 2e61 7272 6179 285b 6265 7461  = np.array([beta
+00010760: 6a20 2878 6a20 3d20 6969 2c20 4c3d 2031  j (xj = ii, L= 1
+00010770: 202c 2057 3d20 7365 6c66 2e77 696e 646f   , W= self.windo
+00010780: 775f 7369 7a65 2920 0d0a 2020 2020 2020  w_size) ..      
 00010790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000107a0: 2020 2020 2020 666f 7220 6969 2069 6e20        for ii in 
-000107b0: 7261 6e67 6528 7365 6c66 2e77 696e 646f  range(self.windo
-000107c0: 775f 7369 7a65 295d 290d 0a20 2020 2020  w_size)])..     
-000107d0: 2020 200d 0a20 2020 2020 2020 207a 6a72     ..        zjr
-000107e0: 203d 206e 702e 7a65 726f 735f 6c69 6b65   = np.zeros_like
-000107f0: 2873 656c 662e 7265 7332 645f 2920 0d0a  (self.res2d_) ..
-00010800: 2020 2020 2020 2020 7a6a 6920 3d20 7a6a          zji = zj
-00010810: 722e 636f 7079 2829 200d 0a20 2020 2020  r.copy() ..     
-00010820: 2020 2023 2064 6f20 7468 6520 7361 6d65     # do the same
-00010830: 2066 6f72 2074 6865 2070 6861 7365 200d   for the phase .
-00010840: 0a20 2020 2020 2020 2070 6861 7365 5f63  .        phase_c
-00010850: 203d 206e 702e 7a65 726f 735f 6c69 6b65   = np.zeros_like
-00010860: 2873 656c 662e 7068 7332 645f 2920 0d0a  (self.phs2d_) ..
-00010870: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00010880: 2020 666f 7220 6969 2069 6e20 7261 6e67    for ii in rang
-00010890: 6528 6c65 6e28 7a6a 7229 2920 3a0d 0a20  e(len(zjr)) :.. 
-000108a0: 2020 2020 2020 2020 2020 2023 2062 6c6f             # blo
-000108b0: 636b 206d 6f64 6520 746f 2073 616d 6520  ck mode to same 
-000108c0: 746f 206b 6565 7020 7468 6520 7361 6d65  to keep the same
-000108d0: 2061 7272 6179 2064 696d 656e 7369 6f6e   array dimension
-000108e0: 730d 0a20 2020 2020 2020 2020 2020 207a  s..            z
-000108f0: 6a72 5b69 692c 203a 5d20 3d20 6e70 2e63  jr[ii, :] = np.c
-00010900: 6f6e 766f 6c76 6528 7a6a 5b69 692c 203a  onvolve(zj[ii, :
-00010910: 5d2e 7265 616c 2c20 775b 3a3a 2d31 5d2c  ].real, w[::-1],
-00010920: 2027 7361 6d65 2729 0d0a 2020 2020 2020   'same')..      
-00010930: 2020 2020 2020 7a6a 695b 6969 2c20 3a5d        zji[ii, :]
-00010940: 203d 206e 702e 636f 6e76 6f6c 7665 287a   = np.convolve(z
-00010950: 6a5b 6969 2c20 3a5d 2e69 6d61 672c 2077  j[ii, :].imag, w
-00010960: 5b3a 3a2d 315d 2c20 2773 616d 6527 290d  [::-1], 'same').
-00010970: 0a20 2020 2020 2020 2020 2020 2023 2078  .            # x
+000107a0: 666f 7220 6969 2069 6e20 7261 6e67 6528  for ii in range(
+000107b0: 7365 6c66 2e77 696e 646f 775f 7369 7a65  self.window_size
+000107c0: 295d 290d 0a20 2020 2020 2020 200d 0a20  )])..        .. 
+000107d0: 2020 2020 2020 207a 6a72 203d 206e 702e         zjr = np.
+000107e0: 7a65 726f 735f 6c69 6b65 2873 656c 662e  zeros_like(self.
+000107f0: 7265 7332 645f 2920 0d0a 2020 2020 2020  res2d_) ..      
+00010800: 2020 7a6a 6920 3d20 7a6a 722e 636f 7079    zji = zjr.copy
+00010810: 2829 200d 0a20 2020 2020 2020 2023 2064  () ..        # d
+00010820: 6f20 7468 6520 7361 6d65 2066 6f72 2074  o the same for t
+00010830: 6865 2070 6861 7365 200d 0a20 2020 2020  he phase ..     
+00010840: 2020 2070 6861 7365 5f63 203d 206e 702e     phase_c = np.
+00010850: 7a65 726f 735f 6c69 6b65 2873 656c 662e  zeros_like(self.
+00010860: 7068 7332 645f 2920 0d0a 2020 2020 2020  phs2d_) ..      
+00010870: 2020 0d0a 2020 2020 2020 2020 666f 7220    ..        for 
+00010880: 6969 2069 6e20 7261 6e67 6528 6c65 6e28  ii in range(len(
+00010890: 7a6a 7229 2920 3a0d 0a20 2020 2020 2020  zjr)) :..       
+000108a0: 2020 2020 2023 2062 6c6f 636b 206d 6f64       # block mod
+000108b0: 6520 746f 2073 616d 6520 746f 206b 6565  e to same to kee
+000108c0: 7020 7468 6520 7361 6d65 2061 7272 6179  p the same array
+000108d0: 2064 696d 656e 7369 6f6e 730d 0a20 2020   dimensions..   
+000108e0: 2020 2020 2020 2020 207a 6a72 5b69 692c           zjr[ii,
+000108f0: 203a 5d20 3d20 6e70 2e63 6f6e 766f 6c76   :] = np.convolv
+00010900: 6528 7a6a 5b69 692c 203a 5d2e 7265 616c  e(zj[ii, :].real
+00010910: 2c20 775b 3a3a 2d31 5d2c 2027 7361 6d65  , w[::-1], 'same
+00010920: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00010930: 7a6a 695b 6969 2c20 3a5d 203d 206e 702e  zji[ii, :] = np.
+00010940: 636f 6e76 6f6c 7665 287a 6a5b 6969 2c20  convolve(zj[ii, 
+00010950: 3a5d 2e69 6d61 672c 2077 5b3a 3a2d 315d  :].imag, w[::-1]
+00010960: 2c20 2773 616d 6527 290d 0a20 2020 2020  , 'same')..     
+00010970: 2020 2020 2020 2023 2078 7878 7878 7878         # xxxxxxx
 00010980: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-00010990: 7878 7878 7878 0d0a 2020 2020 2020 2020  xxxxxx..        
-000109a0: 2020 2020 7068 6173 655f 6320 5b69 692c      phase_c [ii,
-000109b0: 203a 5d20 3d20 6e70 2e63 6f6e 766f 6c76   :] = np.convolv
-000109c0: 6528 0d0a 2020 2020 2020 2020 2020 2020  e(..            
-000109d0: 2020 2020 7365 6c66 2e70 6873 3264 5f5b      self.phs2d_[
-000109e0: 6969 2c20 3a5d 2c20 775b 3a3a 2d31 5d2c  ii, :], w[::-1],
-000109f0: 2027 7361 6d65 2729 0d0a 2020 2020 2020   'same')..      
-00010a00: 2020 2320 7265 636f 7665 7220 7468 6520    # recover the 
-00010a10: 7374 6174 6963 2061 7070 6172 656e 7420  static apparent 
-00010a20: 7265 7369 7374 6976 6974 7920 6672 6f6d  resistivity from
-00010a30: 2072 6566 6572 656e 6365 2066 7265 7120   reference freq 
-00010a40: 0d0a 2020 2020 2020 2020 7a6a 6320 3d20  ..        zjc = 
-00010a50: 7a6a 7220 2b20 316a 202a 207a 6a69 200d  zjr + 1j * zji .
-00010a60: 0a20 2020 2020 2020 2072 6320 3d20 7a32  .        rc = z2
-00010a70: 7268 6f61 2028 7a6a 632c 2073 656c 662e  rhoa (zjc, self.
-00010a80: 6672 6571 735f 2920 2320 6e70 2e61 6273  freqs_) # np.abs
-00010a90: 287a 6a63 292a 2a32 202f 2028 6f6d 6567  (zjc)**2 / (omeg
-00010aa0: 6130 5b3a 2c20 4e6f 6e65 5d20 2a20 6d75  a0[:, None] * mu
-00010ab0: 3020 290d 0a20 2020 2020 2020 2069 6620  0 )..        if 
-00010ac0: 736d 6f6f 7468 3a20 0d0a 2020 2020 2020  smooth: ..      
-00010ad0: 2020 2020 2020 2320 626c 6f63 6b20 6d6f        # block mo
-00010ae0: 7669 6e67 2061 7665 7261 6765 2060 6d61  ving average `ma
-00010af0: 6020 7469 7020 746f 2054 7275 6520 0d0a  ` tip to True ..
-00010b00: 2020 2020 2020 2020 2020 2020 2320 746f              # to
-00010b10: 2070 7265 7665 6e74 2061 6e20 6576 656e   prevent an even
-00010b20: 7475 616c 2063 6861 6e67 6573 2069 6e20  tual changes in 
-00010b30: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00010b40: 6e65 7874 2076 6572 7369 6f6e 732e 200d  next versions. .
-00010b50: 0a20 2020 2020 2020 2020 2020 2072 6320  .            rc 
-00010b60: 3d20 736d 6f6f 7468 696e 6728 2072 6320  = smoothing( rc 
-00010b70: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00010b80: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00010b90: 726f 705f 6f75 746c 6965 7273 203d 2064  rop_outliers = d
-00010ba0: 726f 705f 6f75 746c 6965 7273 2c20 0d0a  rop_outliers, ..
+00010990: 0d0a 2020 2020 2020 2020 2020 2020 7068  ..            ph
+000109a0: 6173 655f 6320 5b69 692c 203a 5d20 3d20  ase_c [ii, :] = 
+000109b0: 6e70 2e63 6f6e 766f 6c76 6528 0d0a 2020  np.convolve(..  
+000109c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000109d0: 6c66 2e70 6873 3264 5f5b 6969 2c20 3a5d  lf.phs2d_[ii, :]
+000109e0: 2c20 775b 3a3a 2d31 5d2c 2027 7361 6d65  , w[::-1], 'same
+000109f0: 2729 0d0a 2020 2020 2020 2020 2320 7265  ')..        # re
+00010a00: 636f 7665 7220 7468 6520 7374 6174 6963  cover the static
+00010a10: 2061 7070 6172 656e 7420 7265 7369 7374   apparent resist
+00010a20: 6976 6974 7920 6672 6f6d 2072 6566 6572  ivity from refer
+00010a30: 656e 6365 2066 7265 7120 0d0a 2020 2020  ence freq ..    
+00010a40: 2020 2020 7a6a 6320 3d20 7a6a 7220 2b20      zjc = zjr + 
+00010a50: 316a 202a 207a 6a69 200d 0a20 2020 2020  1j * zji ..     
+00010a60: 2020 2072 6320 3d20 7a32 7268 6f61 2028     rc = z2rhoa (
+00010a70: 7a6a 632c 2073 656c 662e 6672 6571 735f  zjc, self.freqs_
+00010a80: 2920 2320 6e70 2e61 6273 287a 6a63 292a  ) # np.abs(zjc)*
+00010a90: 2a32 202f 2028 6f6d 6567 6130 5b3a 2c20  *2 / (omega0[:, 
+00010aa0: 4e6f 6e65 5d20 2a20 6d75 3020 290d 0a20  None] * mu0 ).. 
+00010ab0: 2020 2020 2020 2069 6620 736d 6f6f 7468         if smooth
+00010ac0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00010ad0: 2320 626c 6f63 6b20 6d6f 7669 6e67 2061  # block moving a
+00010ae0: 7665 7261 6765 2060 6d61 6020 7469 7020  verage `ma` tip 
+00010af0: 746f 2054 7275 6520 0d0a 2020 2020 2020  to True ..      
+00010b00: 2020 2020 2020 2320 746f 2070 7265 7665        # to preve
+00010b10: 6e74 2061 6e20 6576 656e 7475 616c 2063  nt an eventual c
+00010b20: 6861 6e67 6573 2069 6e20 0d0a 2020 2020  hanges in ..    
+00010b30: 2020 2020 2020 2020 2320 6e65 7874 2076          # next v
+00010b40: 6572 7369 6f6e 732e 200d 0a20 2020 2020  ersions. ..     
+00010b50: 2020 2020 2020 2072 6320 3d20 736d 6f6f         rc = smoo
+00010b60: 7468 696e 6728 2072 6320 2c20 0d0a 2020  thing( rc , ..  
+00010b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b80: 2020 2020 2020 2020 2064 726f 705f 6f75           drop_ou
+00010b90: 746c 6965 7273 203d 2064 726f 705f 6f75  tliers = drop_ou
+00010ba0: 746c 6965 7273 2c20 0d0a 2020 2020 2020  tliers, ..      
 00010bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010bc0: 2020 2020 2020 2020 2020 206d 6120 3d54             ma =T
-00010bd0: 7275 6520 0d0a 2020 2020 2020 2020 2020  rue ..          
-00010be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010bf0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-00010c00: 2320 666f 7263 6520 7265 7369 7374 6976  # force resistiv
-00010c10: 6974 7920 746f 2062 6520 706f 7369 7469  ity to be positi
-00010c20: 7665 200d 0a20 2020 2020 2020 2020 2020  ve ..           
-00010c30: 2023 2061 6674 6572 2073 6d6f 6f74 6869   # after smoothi
-00010c40: 6e67 2069 6620 6578 6973 7473 200d 0a20  ng if exists .. 
-00010c50: 2020 2020 2020 2020 2020 2069 6620 2872             if (r
-00010c60: 6320 3c20 3029 2e61 6e79 2829 3a20 0d0a  c < 0).any(): ..
-00010c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010c80: 7263 203d 206e 702e 6162 7320 2872 6320  rc = np.abs (rc 
-00010c90: 290d 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-00010ca0: 6c66 2e6d 6f64 6520 3d3d 2773 616d 6527  lf.mode =='same'
-00010cb0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00010cc0: 7263 5b3a 2c20 305d 3d20 7365 6c66 2e72  rc[:, 0]= self.r
-00010cd0: 6573 3264 5f5b 3a2c 2030 5d0d 0a20 2020  es2d_[:, 0]..   
-00010ce0: 2020 2020 2020 2020 207a 6a63 5b3a 2c20           zjc[:, 
-00010cf0: 305d 3d20 7a6a 205b 3a2c 2030 5d0d 0a20  0]= zj [:, 0].. 
-00010d00: 2020 2020 2020 2023 2072 6563 6f6d 7075         # recompu
-00010d10: 7465 207a 200d 0a20 2020 2020 2020 2069  te z ..        i
-00010d20: 6620 7365 6c66 2e6f 7574 203d 3d27 7a27  f self.out =='z'
-00010d30: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00010d40: 7263 203d 2072 686f 7068 6932 7a28 7263  rc = rhophi2z(rc
-00010d50: 2c20 7068 693d 2070 6861 7365 5f63 2c20  , phi= phase_c, 
-00010d60: 6672 6571 3d20 7365 6c66 2e66 7265 7173  freq= self.freqs
-00010d70: 5f29 0d0a 2020 2020 2020 2020 2020 2020  _)..            
-00010d80: 0d0a 2020 2020 2020 2020 6966 2073 6d6f  ..        if smo
-00010d90: 6f74 6820 3a20 0d0a 2020 2020 2020 2020  oth : ..        
-00010da0: 2020 2020 7068 6173 655f 6320 3d20 736d      phase_c = sm
-00010db0: 6f6f 7468 696e 6720 2820 7068 6173 655f  oothing ( phase_
-00010dc0: 632c 2064 726f 705f 6f75 746c 6965 7273  c, drop_outliers
-00010dd0: 3d20 6472 6f70 5f6f 7574 6c69 6572 7320  = drop_outliers 
-00010de0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-00010df0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00010e00: 2072 6320 6966 206e 6f74 2072 6574 7572   rc if not retur
-00010e10: 6e5f 7068 6920 656c 7365 2028 2072 632c  n_phi else ( rc,
-00010e20: 2070 6861 7365 5f63 2029 0d0a 2020 2020   phase_c )..    
-00010e30: 0d0a 2020 2020 6465 6620 736b 6577 280d  ..    def skew(.
-00010e40: 0a20 2020 2020 2020 2073 656c 662c 0d0a  .        self,..
-00010e50: 2020 2020 2020 2020 6d65 7468 6f64 3a73          method:s
-00010e60: 7472 203d 2773 7769 6674 272c 200d 0a20  tr ='swift', .. 
-00010e70: 2020 2020 2020 2072 6574 7572 6e5f 736b         return_sk
-00010e80: 6577 6e65 7373 3a62 6f6f 6c3d 4661 6c73  ewness:bool=Fals
-00010e90: 652c 200d 0a20 2020 2020 2020 2073 7570  e, ..        sup
-00010ea0: 7072 6573 735f 6f75 746c 6965 7273 3a62  press_outliers:b
-00010eb0: 6f6f 6c3d 4661 6c73 652c 200d 0a20 2020  ool=False, ..   
-00010ec0: 2020 2020 2029 2d3e 204e 4441 7272 6179       )-> NDArray
-00010ed0: 5b44 5479 7065 5b66 6c6f 6174 5d5d 3a20  [DType[float]]: 
-00010ee0: 0d0a 2020 2020 2020 2020 7222 2222 0d0a  ..        r"""..
-00010ef0: 2020 2020 2020 2020 5468 6520 636f 6e76          The conv
-00010f00: 656e 7469 6f6e 616c 2061 7379 6d6d 6574  entional asymmet
-00010f10: 7279 2070 6172 616d 6574 6572 2062 6173  ry parameter bas
-00010f20: 6564 206f 6e20 7468 6520 5a20 6d61 676e  ed on the Z magn
-00010f30: 6974 7564 652e 200d 0a20 2020 2020 2020  itude. ..       
-00010f40: 200d 0a20 2020 2020 2020 2054 6865 2045   ..        The E
-00010f50: 4d20 7369 676e 616c 2069 7320 696e 666c  M signal is infl
-00010f60: 7565 6e63 6564 2062 7920 7365 7665 7261  uenced by severa
-00010f70: 6c20 6661 6374 6f72 7320 7375 6368 2061  l factors such a
-00010f80: 7320 7468 6520 6469 6d65 6e73 696f 6e61  s the dimensiona
-00010f90: 6c69 7479 0d0a 2020 2020 2020 2020 6f66  lity..        of
-00010fa0: 2074 6865 2070 726f 7061 6761 7469 6f6e   the propagation
-00010fb0: 206d 6564 6975 6d20 616e 6420 7468 6520   medium and the 
-00010fc0: 7068 7973 6963 616c 2061 6e6f 6d61 6c69  physical anomali
-00010fd0: 6573 2c20 7768 6963 6820 6361 6e20 6469  es, which can di
-00010fe0: 7374 6f72 7420 7468 650d 0a20 2020 2020  stort the..     
-00010ff0: 2020 2045 4d20 6669 656c 6420 626f 7468     EM field both
-00011000: 206c 6f63 616c 6c79 2061 6e64 2072 6567   locally and reg
-00011010: 696f 6e61 6c6c 792e 2054 6865 2064 6973  ionally. The dis
-00011020: 746f 7274 696f 6e20 6f66 205a 2077 6173  tortion of Z was
-00011030: 2064 6574 6572 6d69 6e65 6420 0d0a 2020   determined ..  
-00011040: 2020 2020 2020 6672 6f6d 2074 6865 2071        from the q
-00011050: 7561 6e74 6966 6963 6174 696f 6e20 6f66  uantification of
-00011060: 2069 7473 2061 7379 6d6d 6574 7279 2061   its asymmetry a
-00011070: 6e64 2074 6865 2064 6576 6961 7469 6f6e  nd the deviation
-00011080: 2066 726f 6d20 7468 6520 636f 6e64 6974   from the condit
-00011090: 696f 6e73 200d 0a20 2020 2020 2020 2074  ions ..        t
-000110a0: 6861 7420 6465 6669 6e65 2069 7473 2064  hat define its d
-000110b0: 696d 656e 7369 6f6e 616c 6974 792e 2054  imensionality. T
-000110c0: 6865 2070 6172 616d 6574 6572 7320 7573  he parameters us
-000110d0: 6564 2066 6f72 2074 6869 7320 7075 7270  ed for this purp
-000110e0: 6f73 6520 6172 6520 616c 6c20 0d0a 2020  ose are all ..  
-000110f0: 2020 2020 2020 726f 7461 7469 6f6e 616c        rotational
-00011100: 2069 6e76 6172 6961 6e74 2062 6563 6175   invariant becau
-00011110: 7365 2074 6865 205a 2063 6f6d 706f 6e65  se the Z compone
-00011120: 6e74 7320 696e 766f 6c76 6564 2069 6e20  nts involved in 
-00011130: 6974 7320 6465 6669 6e69 7469 6f6e 2061  its definition a
-00011140: 7265 0d0a 2020 2020 2020 2020 696e 6465  re..        inde
-00011150: 7065 6e64 656e 7420 6f66 2074 6865 206f  pendent of the o
-00011160: 7269 656e 7461 7469 6f6e 2073 7973 7465  rientation syste
-00011170: 6d20 7573 6564 2e20 5468 6520 636f 6e76  m used. The conv
-00011180: 656e 7469 6f6e 616c 2061 7379 6d6d 6574  entional asymmet
-00011190: 7279 0d0a 2020 2020 2020 2020 7061 7261  ry..        para
-000111a0: 6d65 7465 7220 6261 7365 6420 6f6e 2074  meter based on t
-000111b0: 6865 205a 206d 6167 6e69 7475 6465 2069  he Z magnitude i
-000111c0: 7320 7468 6520 736b 6577 2064 6566 696e  s the skew defin
-000111d0: 6564 2062 7920 5377 6966 7420 2831 3936  ed by Swift (196
-000111e0: 3729 2061 730d 0a20 2020 2020 2020 2066  7) as..        f
-000111f0: 6f6c 6c6f 7773 3a0d 0a20 2020 2020 2020  ollows:..       
-00011200: 200d 0a20 2020 2020 2020 202e 2e20 6d61   ..        .. ma
-00011210: 7468 3a3a 200d 0a20 2020 2020 2020 200d  th:: ..        .
-00011220: 0a20 2020 2020 2020 2020 2020 2073 6b65  .            ske
-00011230: 775f 7b73 7769 6674 7d3d 207c 5c66 7261  w_{swift}= |\fra
-00011240: 637b 5a5f 7b78 787d 202b 205a 5f7b 7979  c{Z_{xx} + Z_{yy
-00011250: 7d7d 7b20 5a5f 7b78 797d 202d 205a 5f7b  }}{ Z_{xy} - Z_{
-00011260: 7978 7d7d 7c20 0d0a 2020 2020 2020 2020  yx}}| ..        
-00011270: 2020 2020 0d0a 2020 2020 2020 2020 5768      ..        Wh
-00011280: 656e 2074 6865 203a 6d61 7468 3a60 736b  en the :math:`sk
-00011290: 6577 5f7b 7377 6966 747d 6020 2069 7320  ew_{swift}`  is 
-000112a0: 636c 6f73 6520 746f 2060 6030 2e60 602c  close to ``0.``,
-000112b0: 2077 6520 6173 7375 6d65 2061 2031 4420   we assume a 1D 
-000112c0: 6f72 2032 4420 6d6f 6465 6c0d 0a20 2020  or 2D model..   
-000112d0: 2020 2020 2077 6865 6e20 7468 6520 3a6d       when the :m
-000112e0: 6174 683a 6073 6b65 775f 7b73 7769 6674  ath:`skew_{swift
-000112f0: 7d60 2069 7320 6772 6561 7465 7220 7468  }` is greater th
-00011300: 616e 2060 603e 3d30 2e32 6060 2c20 7765  an ``>=0.2``, we
-00011310: 2061 7373 756d 6520 3344 206c 6f63 616c   assume 3D local
-00011320: 200d 0a20 2020 2020 2020 2061 6e6f 6d61   ..        anoma
-00011330: 6c79 2028 4261 6872 2c20 3139 3931 3b20  ly (Bahr, 1991; 
-00011340: 5265 6464 7920 6574 2061 6c2e 2c20 3139  Reddy et al., 19
-00011350: 3737 292e 2020 4974 2069 7320 6765 6e65  77).  It is gene
-00011360: 7261 6c6c 7920 636f 6e73 6964 6572 6564  rally considered
-00011370: 200d 0a20 2020 2020 2020 2074 6861 7420   ..        that 
-00011380: 616e 2065 6c65 6374 7269 6361 6c20 7374  an electrical st
-00011390: 7275 6374 7572 6520 6f66 203a 6d61 7468  ructure of :math
-000113a0: 3a60 736b 6577 203c 2030 2e34 6020 6361  :`skew < 0.4` ca
-000113b0: 6e20 6265 2074 7265 6174 6564 2061 7320  n be treated as 
-000113c0: 6120 0d0a 2020 2020 2020 2020 3244 206d  a ..        2D m
-000113d0: 6564 6975 6d2e 0d0a 2020 2020 2020 2020  edium...        
-000113e0: 0d0a 2020 2020 2020 2020 4675 7274 6865  ..        Furthe
-000113f0: 726d 6f72 652c 2042 6168 7220 2831 3938  rmore, Bahr (198
-00011400: 3829 2070 726f 706f 7365 6420 7468 6520  8) proposed the 
-00011410: 7068 6173 6520 7365 6e73 6974 6976 6520  phase sensitive 
-00011420: 736b 6577 2077 6869 6368 2063 616c 6375  skew which calcu
-00011430: 6c61 7465 730d 0a20 2020 2020 2020 2074  lates..        t
-00011440: 6865 2073 6b65 7720 7461 6b69 6e67 2069  he skew taking i
-00011450: 6e74 6f20 6163 636f 756e 7420 7468 6520  nto account the 
-00011460: 6469 7374 6f72 7469 6f6e 7320 7072 6f64  distortions prod
-00011470: 7563 6564 2069 6e20 5a20 6f76 6572 2032  uced in Z over 2
-00011480: 4420 7374 7275 6374 7572 6573 0d0a 2020  D structures..  
-00011490: 2020 2020 2020 6279 2073 6861 6c6c 6f77        by shallow
-000114a0: 2063 6f6e 6475 6374 6976 6520 616e 6f6d   conductive anom
-000114b0: 616c 6965 7320 616e 6420 6973 2064 6566  alies and is def
-000114c0: 696e 6564 2061 7320 666f 6c6c 6f77 733a  ined as follows:
-000114d0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-000114e0: 2020 2020 2e2e 206d 6174 683a 3a0d 0a20      .. math::.. 
-000114f0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00011500: 2020 2020 2020 2020 2073 6b65 775f 7b42           skew_{B
-00011510: 6168 727d 2026 203d 2026 205c 7371 7274  ahr} & = & \sqrt
-00011520: 7b20 5c66 7261 637b 7c5b 445f 312c 2053  { \frac{|[D_1, S
-00011530: 5f32 5d20 2d5b 535f 312c 2044 5f32 5d7c  _2] -[S_1, D_2]|
-00011540: 7d7b 7c44 5f32 7c7d 7d20 5c71 7561 6420  }{|D_2|}} \quad 
-00011550: 5c74 6578 747b 7768 6572 657d 200d 0a20  \text{where} .. 
-00011560: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00011570: 2020 2020 2020 2020 2053 5f31 2026 203d           S_1 & =
-00011580: 2026 205a 5f7b 7878 7d20 2b20 5a5f 7b79   & Z_{xx} + Z_{y
-00011590: 797d 205c 7175 6164 203b 205c 7175 6164  y} \quad ; \quad
-000115a0: 2020 535f 3220 3d20 5a5f 7b78 797d 202b    S_2 = Z_{xy} +
-000115b0: 205a 5f7b 7978 7d20 0d0a 2020 2020 2020   Z_{yx} ..      
-000115c0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000115d0: 2020 2020 445f 3120 2620 3d20 2620 205a      D_1 & = &  Z
-000115e0: 5f7b 7878 7d20 2d20 5a5f 7b79 797d 205c  _{xx} - Z_{yy} \
-000115f0: 7175 6164 203b 205c 7175 6164 2020 445f  quad ; \quad  D_
-00011600: 3220 3d20 5a5f 7b78 797d 202d 205a 5f7b  2 = Z_{xy} - Z_{
-00011610: 7978 7d0d 0a20 2020 2020 2020 2020 2020  yx}..           
-00011620: 200d 0a20 2020 2020 2020 204e 6f74 6520   ..        Note 
-00011630: 7468 6174 2054 6865 2070 6861 7365 2064  that The phase d
-00011640: 6966 6665 7265 6e63 6573 2062 6574 7765  ifferences betwe
-00011650: 656e 2074 776f 2063 6f6d 706c 6578 206e  en two complex n
-00011660: 756d 6265 7273 203a 6d61 7468 3a60 435f  umbers :math:`C_
-00011670: 3160 2061 6e64 200d 0a20 2020 2020 2020  1` and ..       
-00011680: 203a 6d61 7468 3a60 435f 3260 2061 6e64   :math:`C_2` and
-00011690: 2074 6865 2063 6f72 7265 7370 6f6e 6469   the correspondi
-000116a0: 6e67 2061 6d70 6c69 7475 6465 2020 7072  ng amplitude  pr
-000116b0: 6f64 7563 7473 2061 7265 206e 6f77 2061  oducts are now a
-000116c0: 6262 7265 7669 6174 6564 200d 0a20 2020  bbreviated ..   
-000116d0: 2020 2020 2062 7920 7468 6520 636f 6d6d       by the comm
-000116e0: 7574 6174 6f72 733a 0d0a 2020 2020 2020  utators:..      
-000116f0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00011700: 2e2e 206d 6174 683a 3a20 0d0a 2020 2020  .. math:: ..    
-00011710: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00011720: 2020 2020 5c5b 435f 312c 2043 5f32 5d20      \[C_1, C_2] 
-00011730: 2620 3d20 2620 5c74 6578 747b 496d 7d20  & = & \text{Im} 
-00011740: 435f 322a 435f 315e 2a0d 0a20 2020 2020  C_2*C_1^*..     
-00011750: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00011760: 2020 2020 205c 5b43 5f31 2c20 435f 325d       \[C_1, C_2]
-00011770: 2020 2620 3d20 2620 5c74 6578 747b 5265    & = & \text{Re
-00011780: 7d20 435f 3120 2a20 5c74 6578 747b 496d  } C_1 * \text{Im
-00011790: 7d43 5f32 2020 2d20 525f 6528 435f 3229  }C_2  - R_e(C_2)
-000117a0: 2a20 5c74 6578 747b 496d 7d43 5f31 0d0a  * \text{Im}C_1..
+00010bc0: 2020 2020 206d 6120 3d54 7275 6520 0d0a       ma =True ..
+00010bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010be0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00010bf0: 2020 2020 2020 2020 2020 2320 666f 7263            # forc
+00010c00: 6520 7265 7369 7374 6976 6974 7920 746f  e resistivity to
+00010c10: 2062 6520 706f 7369 7469 7665 200d 0a20   be positive .. 
+00010c20: 2020 2020 2020 2020 2020 2023 2061 6674             # aft
+00010c30: 6572 2073 6d6f 6f74 6869 6e67 2069 6620  er smoothing if 
+00010c40: 6578 6973 7473 200d 0a20 2020 2020 2020  exists ..       
+00010c50: 2020 2020 2069 6620 2872 6320 3c20 3029       if (rc < 0)
+00010c60: 2e61 6e79 2829 3a20 0d0a 2020 2020 2020  .any(): ..      
+00010c70: 2020 2020 2020 2020 2020 7263 203d 206e            rc = n
+00010c80: 702e 6162 7320 2872 6320 290d 0a20 2020  p.abs (rc )..   
+00010c90: 2020 2020 2069 6620 7365 6c66 2e6d 6f64       if self.mod
+00010ca0: 6520 3d3d 2773 616d 6527 3a20 0d0a 2020  e =='same': ..  
+00010cb0: 2020 2020 2020 2020 2020 7263 5b3a 2c20            rc[:, 
+00010cc0: 305d 3d20 7365 6c66 2e72 6573 3264 5f5b  0]= self.res2d_[
+00010cd0: 3a2c 2030 5d0d 0a20 2020 2020 2020 2020  :, 0]..         
+00010ce0: 2020 207a 6a63 5b3a 2c20 305d 3d20 7a6a     zjc[:, 0]= zj
+00010cf0: 205b 3a2c 2030 5d0d 0a20 2020 2020 2020   [:, 0]..       
+00010d00: 2023 2072 6563 6f6d 7075 7465 207a 200d   # recompute z .
+00010d10: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00010d20: 2e6f 7574 203d 3d27 7a27 3a20 0d0a 2020  .out =='z': ..  
+00010d30: 2020 2020 2020 2020 2020 7263 203d 2072            rc = r
+00010d40: 686f 7068 6932 7a28 7263 2c20 7068 693d  hophi2z(rc, phi=
+00010d50: 2070 6861 7365 5f63 2c20 6672 6571 3d20   phase_c, freq= 
+00010d60: 7365 6c66 2e66 7265 7173 5f29 0d0a 2020  self.freqs_)..  
+00010d70: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00010d80: 2020 2020 6966 2073 6d6f 6f74 6820 3a20      if smooth : 
+00010d90: 0d0a 2020 2020 2020 2020 2020 2020 7068  ..            ph
+00010da0: 6173 655f 6320 3d20 736d 6f6f 7468 696e  ase_c = smoothin
+00010db0: 6720 2820 7068 6173 655f 632c 2064 726f  g ( phase_c, dro
+00010dc0: 705f 6f75 746c 6965 7273 3d20 6472 6f70  p_outliers= drop
+00010dd0: 5f6f 7574 6c69 6572 7320 290d 0a20 2020  _outliers )..   
+00010de0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00010df0: 2020 2072 6574 7572 6e20 2072 6320 6966     return  rc if
+00010e00: 206e 6f74 2072 6574 7572 6e5f 7068 6920   not return_phi 
+00010e10: 656c 7365 2028 2072 632c 2070 6861 7365  else ( rc, phase
+00010e20: 5f63 2029 0d0a 2020 2020 0d0a 2020 2020  _c )..    ..    
+00010e30: 6465 6620 736b 6577 280d 0a20 2020 2020  def skew(..     
+00010e40: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
+00010e50: 2020 6d65 7468 6f64 3a73 7472 203d 2773    method:str ='s
+00010e60: 7769 6674 272c 200d 0a20 2020 2020 2020  wift', ..       
+00010e70: 2072 6574 7572 6e5f 736b 6577 6e65 7373   return_skewness
+00010e80: 3a62 6f6f 6c3d 4661 6c73 652c 200d 0a20  :bool=False, .. 
+00010e90: 2020 2020 2020 2073 7570 7072 6573 735f         suppress_
+00010ea0: 6f75 746c 6965 7273 3a62 6f6f 6c3d 4661  outliers:bool=Fa
+00010eb0: 6c73 652c 200d 0a20 2020 2020 2020 2029  lse, ..        )
+00010ec0: 2d3e 204e 4441 7272 6179 5b44 5479 7065  -> NDArray[DType
+00010ed0: 5b66 6c6f 6174 5d5d 3a20 0d0a 2020 2020  [float]]: ..    
+00010ee0: 2020 2020 7222 2222 0d0a 2020 2020 2020      r"""..      
+00010ef0: 2020 5468 6520 636f 6e76 656e 7469 6f6e    The convention
+00010f00: 616c 2061 7379 6d6d 6574 7279 2070 6172  al asymmetry par
+00010f10: 616d 6574 6572 2062 6173 6564 206f 6e20  ameter based on 
+00010f20: 7468 6520 5a20 6d61 676e 6974 7564 652e  the Z magnitude.
+00010f30: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00010f40: 2020 2020 2054 6865 2045 4d20 7369 676e       The EM sign
+00010f50: 616c 2069 7320 696e 666c 7565 6e63 6564  al is influenced
+00010f60: 2062 7920 7365 7665 7261 6c20 6661 6374   by several fact
+00010f70: 6f72 7320 7375 6368 2061 7320 7468 6520  ors such as the 
+00010f80: 6469 6d65 6e73 696f 6e61 6c69 7479 0d0a  dimensionality..
+00010f90: 2020 2020 2020 2020 6f66 2074 6865 2070          of the p
+00010fa0: 726f 7061 6761 7469 6f6e 206d 6564 6975  ropagation mediu
+00010fb0: 6d20 616e 6420 7468 6520 7068 7973 6963  m and the physic
+00010fc0: 616c 2061 6e6f 6d61 6c69 6573 2c20 7768  al anomalies, wh
+00010fd0: 6963 6820 6361 6e20 6469 7374 6f72 7420  ich can distort 
+00010fe0: 7468 650d 0a20 2020 2020 2020 2045 4d20  the..        EM 
+00010ff0: 6669 656c 6420 626f 7468 206c 6f63 616c  field both local
+00011000: 6c79 2061 6e64 2072 6567 696f 6e61 6c6c  ly and regionall
+00011010: 792e 2054 6865 2064 6973 746f 7274 696f  y. The distortio
+00011020: 6e20 6f66 205a 2077 6173 2064 6574 6572  n of Z was deter
+00011030: 6d69 6e65 6420 0d0a 2020 2020 2020 2020  mined ..        
+00011040: 6672 6f6d 2074 6865 2071 7561 6e74 6966  from the quantif
+00011050: 6963 6174 696f 6e20 6f66 2069 7473 2061  ication of its a
+00011060: 7379 6d6d 6574 7279 2061 6e64 2074 6865  symmetry and the
+00011070: 2064 6576 6961 7469 6f6e 2066 726f 6d20   deviation from 
+00011080: 7468 6520 636f 6e64 6974 696f 6e73 200d  the conditions .
+00011090: 0a20 2020 2020 2020 2074 6861 7420 6465  .        that de
+000110a0: 6669 6e65 2069 7473 2064 696d 656e 7369  fine its dimensi
+000110b0: 6f6e 616c 6974 792e 2054 6865 2070 6172  onality. The par
+000110c0: 616d 6574 6572 7320 7573 6564 2066 6f72  ameters used for
+000110d0: 2074 6869 7320 7075 7270 6f73 6520 6172   this purpose ar
+000110e0: 6520 616c 6c20 0d0a 2020 2020 2020 2020  e all ..        
+000110f0: 726f 7461 7469 6f6e 616c 2069 6e76 6172  rotational invar
+00011100: 6961 6e74 2062 6563 6175 7365 2074 6865  iant because the
+00011110: 205a 2063 6f6d 706f 6e65 6e74 7320 696e   Z components in
+00011120: 766f 6c76 6564 2069 6e20 6974 7320 6465  volved in its de
+00011130: 6669 6e69 7469 6f6e 2061 7265 0d0a 2020  finition are..  
+00011140: 2020 2020 2020 696e 6465 7065 6e64 656e        independen
+00011150: 7420 6f66 2074 6865 206f 7269 656e 7461  t of the orienta
+00011160: 7469 6f6e 2073 7973 7465 6d20 7573 6564  tion system used
+00011170: 2e20 5468 6520 636f 6e76 656e 7469 6f6e  . The convention
+00011180: 616c 2061 7379 6d6d 6574 7279 0d0a 2020  al asymmetry..  
+00011190: 2020 2020 2020 7061 7261 6d65 7465 7220        parameter 
+000111a0: 6261 7365 6420 6f6e 2074 6865 205a 206d  based on the Z m
+000111b0: 6167 6e69 7475 6465 2069 7320 7468 6520  agnitude is the 
+000111c0: 736b 6577 2064 6566 696e 6564 2062 7920  skew defined by 
+000111d0: 5377 6966 7420 2831 3936 3729 2061 730d  Swift (1967) as.
+000111e0: 0a20 2020 2020 2020 2066 6f6c 6c6f 7773  .        follows
+000111f0: 3a0d 0a20 2020 2020 2020 200d 0a20 2020  :..        ..   
+00011200: 2020 2020 202e 2e20 6d61 7468 3a3a 200d       .. math:: .
+00011210: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00011220: 2020 2020 2020 2073 6b65 775f 7b73 7769         skew_{swi
+00011230: 6674 7d3d 207c 5c66 7261 637b 5a5f 7b78  ft}= |\frac{Z_{x
+00011240: 787d 202b 205a 5f7b 7979 7d7d 7b20 5a5f  x} + Z_{yy}}{ Z_
+00011250: 7b78 797d 202d 205a 5f7b 7978 7d7d 7c20  {xy} - Z_{yx}}| 
+00011260: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+00011270: 2020 2020 2020 2020 5768 656e 2074 6865          When the
+00011280: 203a 6d61 7468 3a60 736b 6577 5f7b 7377   :math:`skew_{sw
+00011290: 6966 747d 6020 2069 7320 636c 6f73 6520  ift}`  is close 
+000112a0: 746f 2060 6030 2e60 602c 2077 6520 6173  to ``0.``, we as
+000112b0: 7375 6d65 2061 2031 4420 6f72 2032 4420  sume a 1D or 2D 
+000112c0: 6d6f 6465 6c0d 0a20 2020 2020 2020 2077  model..        w
+000112d0: 6865 6e20 7468 6520 3a6d 6174 683a 6073  hen the :math:`s
+000112e0: 6b65 775f 7b73 7769 6674 7d60 2069 7320  kew_{swift}` is 
+000112f0: 6772 6561 7465 7220 7468 616e 2060 603e  greater than ``>
+00011300: 3d30 2e32 6060 2c20 7765 2061 7373 756d  =0.2``, we assum
+00011310: 6520 3344 206c 6f63 616c 200d 0a20 2020  e 3D local ..   
+00011320: 2020 2020 2061 6e6f 6d61 6c79 2028 4261       anomaly (Ba
+00011330: 6872 2c20 3139 3931 3b20 5265 6464 7920  hr, 1991; Reddy 
+00011340: 6574 2061 6c2e 2c20 3139 3737 292e 2020  et al., 1977).  
+00011350: 4974 2069 7320 6765 6e65 7261 6c6c 7920  It is generally 
+00011360: 636f 6e73 6964 6572 6564 200d 0a20 2020  considered ..   
+00011370: 2020 2020 2074 6861 7420 616e 2065 6c65       that an ele
+00011380: 6374 7269 6361 6c20 7374 7275 6374 7572  ctrical structur
+00011390: 6520 6f66 203a 6d61 7468 3a60 736b 6577  e of :math:`skew
+000113a0: 203c 2030 2e34 6020 6361 6e20 6265 2074   < 0.4` can be t
+000113b0: 7265 6174 6564 2061 7320 6120 0d0a 2020  reated as a ..  
+000113c0: 2020 2020 2020 3244 206d 6564 6975 6d2e        2D medium.
+000113d0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000113e0: 2020 2020 4675 7274 6865 726d 6f72 652c      Furthermore,
+000113f0: 2042 6168 7220 2831 3938 3829 2070 726f   Bahr (1988) pro
+00011400: 706f 7365 6420 7468 6520 7068 6173 6520  posed the phase 
+00011410: 7365 6e73 6974 6976 6520 736b 6577 2077  sensitive skew w
+00011420: 6869 6368 2063 616c 6375 6c61 7465 730d  hich calculates.
+00011430: 0a20 2020 2020 2020 2074 6865 2073 6b65  .        the ske
+00011440: 7720 7461 6b69 6e67 2069 6e74 6f20 6163  w taking into ac
+00011450: 636f 756e 7420 7468 6520 6469 7374 6f72  count the distor
+00011460: 7469 6f6e 7320 7072 6f64 7563 6564 2069  tions produced i
+00011470: 6e20 5a20 6f76 6572 2032 4420 7374 7275  n Z over 2D stru
+00011480: 6374 7572 6573 0d0a 2020 2020 2020 2020  ctures..        
+00011490: 6279 2073 6861 6c6c 6f77 2063 6f6e 6475  by shallow condu
+000114a0: 6374 6976 6520 616e 6f6d 616c 6965 7320  ctive anomalies 
+000114b0: 616e 6420 6973 2064 6566 696e 6564 2061  and is defined a
+000114c0: 7320 666f 6c6c 6f77 733a 0d0a 2020 2020  s follows:..    
+000114d0: 2020 2020 0d0a 2020 2020 2020 2020 2e2e      ..        ..
+000114e0: 206d 6174 683a 3a0d 0a20 2020 2020 2020   math::..       
+000114f0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00011500: 2020 2073 6b65 775f 7b42 6168 727d 2026     skew_{Bahr} &
+00011510: 203d 2026 205c 7371 7274 7b20 5c66 7261   = & \sqrt{ \fra
+00011520: 637b 7c5b 445f 312c 2053 5f32 5d20 2d5b  c{|[D_1, S_2] -[
+00011530: 535f 312c 2044 5f32 5d7c 7d7b 7c44 5f32  S_1, D_2]|}{|D_2
+00011540: 7c7d 7d20 5c71 7561 6420 5c74 6578 747b  |}} \quad \text{
+00011550: 7768 6572 657d 200d 0a20 2020 2020 2020  where} ..       
+00011560: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00011570: 2020 2053 5f31 2026 203d 2026 205a 5f7b     S_1 & = & Z_{
+00011580: 7878 7d20 2b20 5a5f 7b79 797d 205c 7175  xx} + Z_{yy} \qu
+00011590: 6164 203b 205c 7175 6164 2020 535f 3220  ad ; \quad  S_2 
+000115a0: 3d20 5a5f 7b78 797d 202b 205a 5f7b 7978  = Z_{xy} + Z_{yx
+000115b0: 7d20 0d0a 2020 2020 2020 2020 2020 2020  } ..            
+000115c0: 0d0a 2020 2020 2020 2020 2020 2020 445f  ..            D_
+000115d0: 3120 2620 3d20 2620 205a 5f7b 7878 7d20  1 & = &  Z_{xx} 
+000115e0: 2d20 5a5f 7b79 797d 205c 7175 6164 203b  - Z_{yy} \quad ;
+000115f0: 205c 7175 6164 2020 445f 3220 3d20 5a5f   \quad  D_2 = Z_
+00011600: 7b78 797d 202d 205a 5f7b 7978 7d0d 0a20  {xy} - Z_{yx}.. 
+00011610: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00011620: 2020 2020 204e 6f74 6520 7468 6174 2054       Note that T
+00011630: 6865 2070 6861 7365 2064 6966 6665 7265  he phase differe
+00011640: 6e63 6573 2062 6574 7765 656e 2074 776f  nces between two
+00011650: 2063 6f6d 706c 6578 206e 756d 6265 7273   complex numbers
+00011660: 203a 6d61 7468 3a60 435f 3160 2061 6e64   :math:`C_1` and
+00011670: 200d 0a20 2020 2020 2020 203a 6d61 7468   ..        :math
+00011680: 3a60 435f 3260 2061 6e64 2074 6865 2063  :`C_2` and the c
+00011690: 6f72 7265 7370 6f6e 6469 6e67 2061 6d70  orresponding amp
+000116a0: 6c69 7475 6465 2020 7072 6f64 7563 7473  litude  products
+000116b0: 2061 7265 206e 6f77 2061 6262 7265 7669   are now abbrevi
+000116c0: 6174 6564 200d 0a20 2020 2020 2020 2062  ated ..        b
+000116d0: 7920 7468 6520 636f 6d6d 7574 6174 6f72  y the commutator
+000116e0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+000116f0: 0d0a 2020 2020 2020 2020 2e2e 206d 6174  ..        .. mat
+00011700: 683a 3a20 0d0a 2020 2020 2020 2020 2020  h:: ..          
+00011710: 0d0a 2020 2020 2020 2020 2020 2020 5c5b  ..            \[
+00011720: 435f 312c 2043 5f32 5d20 2620 3d20 2620  C_1, C_2] & = & 
+00011730: 5c74 6578 747b 496d 7d20 435f 322a 435f  \text{Im} C_2*C_
+00011740: 315e 2a0d 0a20 2020 2020 2020 2020 2020  1^*..           
+00011750: 200d 0a20 2020 2020 2020 2020 2020 205c   ..            \
+00011760: 5b43 5f31 2c20 435f 325d 2020 2620 3d20  [C_1, C_2]  & = 
+00011770: 2620 5c74 6578 747b 5265 7d20 435f 3120  & \text{Re} C_1 
+00011780: 2a20 5c74 6578 747b 496d 7d43 5f32 2020  * \text{Im}C_2  
+00011790: 2d20 525f 6528 435f 3229 2a20 5c74 6578  - R_e(C_2)* \tex
+000117a0: 747b 496d 7d43 5f31 0d0a 2020 2020 2020  t{Im}C_1..      
 000117b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000117c0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000117d0: 2020 496e 6465 6564 2c20 3a6d 6174 683a    Indeed, :math:
-000117e0: 6073 6b65 775f 7b42 6168 727d 6020 6d65  `skew_{Bahr}` me
-000117f0: 6173 7572 6573 2074 6865 2064 6576 6961  asures the devia
-00011800: 7469 6f6e 2066 726f 6d20 7468 6520 7379  tion from the sy
-00011810: 6d6d 6574 7279 2063 6f6e 6469 7469 6f6e  mmetry condition
-00011820: 0d0a 2020 2020 2020 2020 7468 726f 7567  ..        throug
-00011830: 6820 7468 6520 7068 6173 6520 6469 6666  h the phase diff
-00011840: 6572 656e 6365 7320 6265 7477 6565 6e20  erences between 
-00011850: 6561 6368 2070 6169 7220 6f66 2074 656e  each pair of ten
-00011860: 736f 7220 656c 656d 656e 7473 2c63 6f6e  sor elements,con
-00011870: 7369 6465 7269 6e67 0d0a 2020 2020 2020  sidering..      
-00011880: 2020 7468 6174 2070 6861 7365 7320 6172    that phases ar
-00011890: 6520 6c65 7373 2073 656e 7369 7469 7665  e less sensitive
-000118a0: 2074 6f20 7375 7266 6163 6520 6469 7374   to surface dist
-000118b0: 6f72 7469 6f6e 7328 692e 652e 2067 616c  ortions(i.e. gal
-000118c0: 7661 6e69 6320 6469 7374 6f72 7469 6f6e  vanic distortion
-000118d0: 292e 0d0a 2020 2020 2020 2020 5468 6520  )...        The 
-000118e0: 3a6d 6174 683a 6073 6b65 775f 7b42 6168  :math:`skew_{Bah
-000118f0: 727d 6020 7468 7265 7368 6f6c 6420 6973  r}` threshold is
-00011900: 2073 6574 2061 7420 6060 302e 3360 6020   set at ``0.3`` 
-00011910: 616e 6420 6869 6768 6572 2076 616c 7565  and higher value
-00011920: 7320 6d65 616e 200d 0a20 2020 2020 2020  s mean ..       
-00011930: 2033 4420 7374 7275 6374 7572 6573 2028   3D structures (
-00011940: 4261 6872 2c20 3139 3931 292e 0d0a 2020  Bahr, 1991)...  
-00011950: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00011960: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00011970: 7465 7273 200d 0a20 2020 2020 2020 202d  ters ..        -
-00011980: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00011990: 2020 6461 7461 3a20 7374 7220 6f66 2070    data: str of p
-000119a0: 6174 682d 6c69 6b65 206f 7220 6c69 7374  ath-like or list
-000119b0: 206f 6620 7079 6373 616d 742e 636f 7265   of pycsamt.core
-000119c0: 2e65 6469 2e45 6469 200d 0a20 2020 2020  .edi.Edi ..     
-000119d0: 2020 2020 2020 2045 4449 2064 6174 6120         EDI data 
-000119e0: 6f72 2045 4449 206f 626a 6563 7420 7769  or EDI object wi
-000119f0: 7468 2066 756c 6c20 696d 7065 6461 6e63  th full impedanc
-00011a00: 6520 7465 6e73 6f72 205a 2e20 0d0a 2020  e tensor Z. ..  
-00011a10: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00011a20: 6d65 7468 6f64 3a20 7374 7220 0d0a 2020  method: str ..  
-00011a30: 2020 2020 2020 2020 2020 4b69 6e64 206f            Kind o
-00011a40: 6620 636f 7272 6563 7469 6f6e 2e20 4361  f correction. Ca
-00011a50: 6e20 6265 2060 6073 7769 6674 6060 2066  n be ``swift`` f
-00011a60: 6f72 2074 6865 2072 656d 6f76 6520 6469  or the remove di
-00011a70: 7374 6f72 7369 6f6e 2070 726f 706f 7365  storsion propose
-00011a80: 6420 0d0a 2020 2020 2020 2020 2020 2020  d ..            
-00011a90: 6279 2053 7769 6674 2069 6e20 3139 3637  by Swift in 1967
-00011aa0: 2e20 5468 6520 7661 6c75 6520 636c 6f73  . The value clos
-00011ab0: 6520 746f 2030 2e20 6173 7375 6d65 2074  e to 0. assume t
-00011ac0: 6865 2031 4420 616e 6420 3244 2073 7472  he 1D and 2D str
-00011ad0: 7563 7475 7265 7320 0d0a 2020 2020 2020  uctures ..      
-00011ae0: 2020 2020 2020 616e 6420 3344 206f 7468        and 3D oth
-00011af0: 6572 7769 7365 2e20 436f 6e76 6572 736c  erwise. Conversl
-00011b00: 7920 746f 2060 6062 6168 7260 6020 666f  y to ``bahr`` fo
-00011b10: 7220 7468 6520 7265 6d6f 7665 2064 6973  r the remove dis
-00011b20: 746f 7273 696f 6e20 7072 6f70 6f73 6564  torsion proposed
-00011b30: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00011b40: 6279 2042 6168 7220 696e 2031 3939 312e  by Bahr in 1991.
-00011b50: 2054 6865 206c 6174 7465 7220 7468 7265   The latter thre
-00011b60: 7368 6f6c 6420 6973 2073 6574 2074 6f20  shold is set to 
-00011b70: 302e 332e 2041 626f 7665 2074 6869 7320  0.3. Above this 
-00011b80: 7661 6c75 6520 0d0a 2020 2020 2020 2020  value ..        
-00011b90: 2020 2020 7468 6520 7374 7275 6374 7572      the structur
-00011ba0: 6573 2069 7320 3344 2e20 0d0a 2020 2020  es is 3D. ..    
-00011bb0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00011bc0: 2020 7265 7475 726e 5f73 6b65 776e 6573    return_skewnes
-00011bd0: 733a 2073 7472 2c20 0d0a 2020 2020 2020  s: str, ..      
-00011be0: 2020 2020 2054 7970 6963 616c 6c79 2072       Typically r
-00011bf0: 6574 7572 6e73 2074 6865 2074 7970 6520  eturns the type 
-00011c00: 6f66 2073 6b65 776e 6573 732e 2060 6027  of skewness. ``'
-00011c10: 736b 6577 2760 6020 6f72 2060 606d 7560  skew'`` or ``mu`
-00011c20: 6020 666f 7220 0d0a 2020 2020 2020 2020  ` for ..        
-00011c30: 2020 2073 6b65 7720 616e 6420 726f 7461     skew and rota
-00011c40: 7469 6f6e 2d20 616c 6c20 696e 7661 7269  tion- all invari
-00011c50: 616e 7420 7661 6c75 6573 2072 6573 7065  ant values respe
-00011c60: 6374 6976 656c 792e 2041 6e79 206f 7468  ctively. Any oth
-00011c70: 6572 200d 0a20 2020 2020 2020 2020 2020  er ..           
-00011c80: 7661 6c75 6520 7265 7475 726e 2062 6f74  value return bot
-00011c90: 6820 736b 6577 2061 6e64 2072 6f74 6174  h skew and rotat
-00011ca0: 696f 6e61 6c20 696e 7661 7269 616e 742e  ional invariant.
-00011cb0: 200d 0a20 0d0a 2020 2020 2020 2020 7375   .. ..        su
-00011cc0: 7070 7265 7373 5f6f 7574 6c69 6572 733a  ppress_outliers:
-00011cd0: 2062 6f6f 6c2c 2064 6566 6175 6c74 3d46   bool, default=F
-00011ce0: 616c 7365 2c20 0d0a 2020 2020 2020 2020  alse, ..        
-00011cf0: 2020 2052 656d 6f76 6520 7468 6520 6f75     Remove the ou
-00011d00: 746c 6965 7273 2028 6966 2061 7070 6c69  tliers (if appli
-00011d10: 6361 626c 6520 696e 2074 6865 2064 6174  cable in the dat
-00011d20: 6120 2920 6265 666f 7265 0d0a 2020 2020  a ) before..    
-00011d30: 2020 2020 2020 206e 6f72 6d61 6c69 7a69         normalizi
-00011d40: 6e67 2e20 0d0a 2020 2020 2020 2020 2020  ng. ..          
-00011d50: 200d 0a20 2020 2020 2020 2020 2020 2e2e   ..           ..
-00011d60: 2076 6572 7369 6f6e 6164 6465 643a 3a20   versionadded:: 
-00011d70: 302e 312e 3620 0d0a 2020 2020 2020 2020  0.1.6 ..        
-00011d80: 2020 200d 0a20 2020 2020 2020 2052 6574     ..        Ret
-00011d90: 7572 6e73 200d 0a20 2020 2020 2020 202d  urns ..        -
-00011da0: 2d2d 2d2d 2d2d 2d2d 200d 0a20 2020 2020  -------- ..     
-00011db0: 2020 2073 6b77 2c20 6d75 203a 2054 7570     skw, mu : Tup
-00011dc0: 6c65 206f 6620 6e64 6172 7261 792d 6c69  le of ndarray-li
-00011dd0: 6b65 202c 2073 6861 7065 2028 4e2c 204d  ke , shape (N, M
-00011de0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-00011df0: 2d20 4172 7261 7920 6f66 2073 6b65 7720  - Array of skew 
-00011e00: 6174 2065 6163 6820 6672 6571 7565 6e63  at each frequenc
-00011e10: 7920 0d0a 2020 2020 2020 2020 2020 2020  y ..            
-00011e20: 2d20 726f 7461 7469 6f6e 616c 2069 6e76  - rotational inv
-00011e30: 6172 6961 6e74 2060 606d 7560 6020 6174  ariant ``mu`` at
-00011e40: 2065 6163 6820 6672 6571 7565 6e63 7920   each frequency 
-00011e50: 7468 6174 0d0a 2020 2020 2020 2020 2020  that..          
-00011e60: 2020 2020 6d65 6173 7572 6573 206f 6620      measures of 
-00011e70: 7068 6173 6520 6469 6666 6572 656e 6365  phase difference
-00011e80: 7320 696e 2074 6865 2069 6d70 6564 616e  s in the impedan
-00011e90: 6365 2074 656e 736f 722e 200d 0a20 2020  ce tensor. ..   
-00011ea0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00011eb0: 2020 2053 6565 2041 6c73 6f0d 0a20 2020     See Also..   
-00011ec0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a       ---------..
-00011ed0: 2020 2020 2020 2020 7761 7465 782e 7574          watex.ut
-00011ee0: 696c 732e 706c 6f74 5f73 6b65 773a 200d  ils.plot_skew: .
-00011ef0: 0a20 2020 2020 2020 2020 2020 2046 6f72  .            For
-00011f00: 2070 6861 7365 2073 656e 7369 7374 6976   phase sensistiv
-00011f10: 6520 736b 6577 2076 6973 7561 6c69 7a61  e skew visualiza
-00011f20: 7469 6f6e 202d 206e 6169 7665 2070 6c6f  tion - naive plo
-00011f30: 742e 200d 0a20 2020 2020 2020 2077 6174  t. ..        wat
-00011f40: 6578 2e76 6965 772e 5450 6c6f 742e 706c  ex.view.TPlot.pl
-00011f50: 6f74 536b 6577 3a20 0d0a 2020 2020 2020  otSkew: ..      
-00011f60: 2020 2020 2020 466f 7220 636f 6e73 6973        For consis
-00011f70: 7465 6e74 2070 6c6f 7420 6f66 2070 6861  tent plot of pha
-00011f80: 7365 2073 656e 7369 7469 7665 2073 6b65  se sensitive ske
-00011f90: 7720 7669 7375 616c 697a 6174 696f 6e2e  w visualization.
-00011fa0: 2041 6c6c 6f77 200d 0a20 2020 2020 2020   Allow ..       
-00011fb0: 2020 2020 2063 7573 746f 6d69 7a65 2070       customize p
-00011fc0: 6c6f 7473 2e20 0d0a 2020 2020 2020 2020  lots. ..        
-00011fd0: 7761 7465 782e 7669 6577 2e54 506c 6f74  watex.view.TPlot
-00011fe0: 2e70 6c6f 745f 7068 6173 655f 7465 6e73  .plot_phase_tens
-00011ff0: 6f72 733a 200d 0a20 2020 2020 2020 2020  ors: ..         
-00012000: 2020 2050 6c6f 7420 736b 6577 2061 7320     Plot skew as 
-00012010: 656c 6c69 7073 6973 2076 6973 7561 6c69  ellipsis visuali
-00012020: 7a61 7469 6f6e 2062 7920 7475 726e 696e  zation by turnin
-00012030: 6720 7468 6520 6074 656e 736f 7260 0d0a  g the `tensor`..
-00012040: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00012050: 6d65 7465 7220 746f 2060 6073 6b65 7760  meter to ``skew`
-00012060: 602e 200d 0a0d 0a20 2020 2020 2020 2045  `. ....        E
-00012070: 7861 6d70 6c65 730d 0a20 2020 2020 2020  xamples..       
-00012080: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020   --------..     
-00012090: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
-000120a0: 782e 6d65 7468 6f64 732e 656d 2069 6d70  x.methods.em imp
-000120b0: 6f72 7420 5072 6f63 6573 7369 6e67 200d  ort Processing .
-000120c0: 0a20 2020 2020 2020 203e 3e3e 2065 6469  .        >>> edi
-000120d0: 7061 7468 203d 2027 6461 7461 2f65 6469  path = 'data/edi
-000120e0: 7327 0d0a 2020 2020 2020 2020 3e3e 3e20  s'..        >>> 
-000120f0: 7020 3d20 5072 6f63 6573 7369 6e67 2829  p = Processing()
-00012100: 2e66 6974 2865 6469 7061 7468 2920 0d0a  .fit(edipath) ..
-00012110: 2020 2020 2020 2020 3e3e 3e20 736b 2c5f          >>> sk,_
-00012120: 203d 2070 2e73 6b65 7728 290d 0a20 2020   = p.skew()..   
-00012130: 2020 2020 203e 3e3e 2073 6b5b 303a 2c20       >>> sk[0:, 
-00012140: 5d0d 0a20 2020 2020 2020 202e 2e2e 2061  ]..        ... a
-00012150: 7272 6179 285b 302e 3435 3437 3535 3237  rray([0.45475527
-00012160: 2c20 302e 3738 3736 3839 3620 2c20 302e  , 0.7876896 , 0.
-00012170: 3434 3938 3633 3937 5d29 0d0a 2020 2020  44986397])..    
-00012180: 2020 2020 0d0a 2020 2020 2020 2020 5265      ..        Re
-00012190: 6665 7265 6e63 6573 200d 0a20 2020 2020  ferences ..     
-000121a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-000121b0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-000121c0: 2020 2020 2042 6168 722c 204b 2e2c 2031       Bahr, K., 1
-000121d0: 3939 312e 2047 656f 6c6f 6769 6361 6c20  991. Geological 
-000121e0: 6e6f 6973 6520 696e 206d 6167 6e65 746f  noise in magneto
-000121f0: 7465 6c6c 7572 6963 2064 6174 613a 2061  telluric data: a
-00012200: 2063 6c61 7373 6966 6963 6174 696f 6e20   classification 
-00012210: 0d0a 2020 2020 2020 2020 2020 2020 6f66  ..            of
-00012220: 2064 6973 746f 7274 696f 6e20 7479 7065   distortion type
-00012230: 732e 2050 6879 7369 6373 206f 6620 7468  s. Physics of th
-00012240: 6520 4561 7274 6820 616e 6420 506c 616e  e Earth and Plan
-00012250: 6574 6172 7920 496e 7465 7269 6f72 7320  etary Interiors 
-00012260: 3636 0d0a 2020 2020 2020 2020 2020 2020  66..            
-00012270: 2831 e280 9332 292c 2032 34e2 8093 3338  (1...2), 24...38
-00012280: 2e0d 0a20 2020 2020 2020 2042 6172 6365  ...        Barce
-00012290: 6c6f 6e61 2c20 482e 2c20 4661 7665 7474  lona, H., Favett
-000122a0: 6f2c 2041 2e2c 2050 6572 692c 2056 2e47  o, A., Peri, V.G
-000122b0: 2e2c 2050 6f6d 706f 7369 656c 6c6f 2c20  ., Pomposiello, 
-000122c0: 432e 2c20 556e 6761 7265 6c6c 692c 2043  C., Ungarelli, C
-000122d0: 2e2c 2032 3031 332e 0d0a 2020 2020 2020  ., 2013...      
-000122e0: 2020 2020 2020 5468 6520 706f 7465 6e74        The potent
-000122f0: 6961 6c20 6f66 2061 7564 696f 6d61 676e  ial of audiomagn
-00012300: 6574 6f74 656c 6c75 7269 6373 2069 6e20  etotellurics in 
-00012310: 7468 6520 7374 7564 7920 6f66 2067 656f  the study of geo
-00012320: 7468 6572 6d61 6c20 6669 656c 6473 3a20  thermal fields: 
-00012330: 0d0a 2020 2020 2020 2020 2020 2020 4120  ..            A 
-00012340: 6361 7365 2073 7475 6479 2066 726f 6d20  case study from 
-00012350: 7468 6520 6e6f 7274 6865 726e 2073 6567  the northern seg
-00012360: 6d65 6e74 206f 6620 7468 6520 4c61 2043  ment of the La C
-00012370: 616e 6465 6c61 7269 6120 5261 6e67 652c  andelaria Range,
-00012380: 0d0a 2020 2020 2020 2020 2020 2020 6e6f  ..            no
-00012390: 7274 6877 6573 7465 726e 2041 7267 656e  rthwestern Argen
-000123a0: 7469 6e61 2e20 4a2e 2041 7070 6c2e 2047  tina. J. Appl. G
-000123b0: 656f 7068 7973 2e20 3838 2c20 3833 e280  eophys. 88, 83..
-000123c0: 9339 332e 0d0a 2020 2020 2020 2020 2020  .93...          
-000123d0: 2020 6874 7470 733a 2f2f 646f 692e 6f72    https://doi.or
-000123e0: 672f 3130 2e31 3031 362f 6a2e 6a61 7070  g/10.1016/j.japp
-000123f0: 6765 6f2e 3230 3132 2e31 302e 3030 3420  geo.2012.10.004 
-00012400: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00012410: 0d0a 2020 2020 2020 2020 5377 6966 742c  ..        Swift,
-00012420: 2043 2e2c 2031 3936 372e 2041 206d 6167   C., 1967. A mag
-00012430: 6e65 746f 7465 6c6c 7572 6963 2069 6e76  netotelluric inv
-00012440: 6573 7469 6761 7469 6f6e 206f 6620 616e  estigation of an
-00012450: 2065 6c65 6374 7269 6361 6c20 636f 6e64   electrical cond
-00012460: 7563 7469 7669 7479 200d 0a20 2020 2020  uctivity ..     
-00012470: 2020 2020 2020 616e 6f6d 616c 7920 696e        anomaly in
-00012480: 2074 6865 2073 6f75 7468 7765 7374 6572   the southwester
-00012490: 6e20 556e 6974 6564 2053 7461 7465 732e  n United States.
-000124a0: 2050 682e 442e 2054 6865 7369 732c 204d   Ph.D. Thesis, M
-000124b0: 4954 2050 7265 7373 2e20 4361 6d62 7269  IT Press. Cambri
-000124c0: 6467 652e 200d 0a20 2020 2020 2020 2020  dge. ..         
-000124d0: 2020 0d0a 2020 2020 2020 2020 2222 220d    ..        """.
-000124e0: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
-000124f0: 696e 7370 6563 7420 0d0a 2020 2020 2020  inspect ..      
-00012500: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00012510: 7365 6c66 2e6d 6574 686f 6420 3d20 7374  self.method = st
-00012520: 7228 6d65 7468 6f64 292e 6c6f 7765 7228  r(method).lower(
-00012530: 290d 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-00012540: 6c66 2e6d 6574 686f 6420 6e6f 7420 696e  lf.method not in
-00012550: 2028 2773 7769 6674 272c 2027 6261 6872   ('swift', 'bahr
-00012560: 2729 3a20 0d0a 2020 2020 2020 2020 2020  '): ..          
-00012570: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00012580: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
-00012590: 2020 2020 2066 2745 7870 6563 7465 6420       f'Expected 
-000125a0: 6172 6775 6d65 6e74 2060 6073 7769 6674  argument ``swift
-000125b0: 6060 206f 7220 6060 6261 6872 6060 206e  `` or ``bahr`` n
-000125c0: 6f74 3a20 7b73 656c 662e 6d65 7468 6f64  ot: {self.method
-000125d0: 2172 7d27 290d 0a20 2020 2020 2020 2020  !r}')..         
-000125e0: 2020 200d 0a20 2020 2020 2020 2072 6574     ..        ret
-000125f0: 7572 6e5f 736b 6577 6e65 7373 3d20 7374  urn_skewness= st
-00012600: 7228 7265 7475 726e 5f73 6b65 776e 6573  r(return_skewnes
-00012610: 7329 2e6c 6f77 6572 2829 200d 0a20 2020  s).lower() ..   
-00012620: 2020 2020 2069 6620 2028 2027 6d75 2720       if  ( 'mu' 
-00012630: 696e 2072 6574 7572 6e5f 736b 6577 6e65  in return_skewne
-00012640: 7373 206f 7220 0d0a 2020 2020 2020 2020  ss or ..        
-00012650: 2020 2020 2027 726f 7427 2069 6e20 7265       'rot' in re
-00012660: 7475 726e 5f73 6b65 776e 6573 7320 6f72  turn_skewness or
-00012670: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00012680: 2769 6e76 6172 6961 6e74 2720 696e 2072  'invariant' in r
-00012690: 6574 7572 6e5f 736b 6577 6e65 7373 293a  eturn_skewness):
-000126a0: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-000126b0: 6574 7572 6e5f 736b 6577 6e65 7373 203d  eturn_skewness =
-000126c0: 276d 7527 200d 0a20 2020 2020 2020 2065  'mu' ..        e
-000126d0: 6c69 6620 2773 6b65 7727 2069 6e20 7265  lif 'skew' in re
-000126e0: 7475 726e 5f73 6b65 776e 6573 733a 200d  turn_skewness: .
-000126f0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00012700: 7572 6e5f 736b 6577 6e65 7373 203d 2773  urn_skewness ='s
-00012710: 6b65 7727 0d0a 2020 2020 2020 2020 2020  kew'..          
-00012720: 2020 0d0a 2020 2020 2020 2020 5a78 783d    ..        Zxx=
-00012730: 2073 656c 662e 6d61 6b65 3264 2827 7a78   self.make2d('zx
-00012740: 7827 290d 0a20 2020 2020 2020 205a 7879  x')..        Zxy
-00012750: 203d 2073 656c 662e 6d61 6b65 3264 2827   = self.make2d('
-00012760: 7a78 7927 290d 0a20 2020 2020 2020 205a  zxy')..        Z
-00012770: 7978 203d 2073 656c 662e 6d61 6b65 3264  yx = self.make2d
-00012780: 2827 7a79 7827 290d 0a20 2020 2020 2020  ('zyx')..       
-00012790: 205a 7979 3d20 7365 6c66 2e6d 616b 6532   Zyy= self.make2
-000127a0: 6428 277a 7979 2729 0d0a 2020 2020 2020  d('zyy')..      
-000127b0: 2020 0d0a 2020 2020 2020 2020 5331 203d    ..        S1 =
-000127c0: 5a78 7820 2b20 5a79 793b 2053 3220 3d20  Zxx + Zyy; S2 = 
-000127d0: 5a78 7920 2b20 5a79 783b 2044 3120 3d5a  Zxy + Zyx; D1 =Z
-000127e0: 7878 2d5a 7979 203b 2020 4432 3d20 5a78  xx-Zyy ;  D2= Zx
-000127f0: 792d 5a79 7820 0d0a 2020 2020 2020 2020  y-Zyx ..        
-00012800: 4431 5332 203d 2028 5332 202a 206e 702e  D1S2 = (S2 * np.
-00012810: 636f 6e6a 2844 3129 292e 696d 6167 203b  conj(D1)).imag ;
-00012820: 2053 3144 3220 3d20 2844 3220 2a20 6e70   S1D2 = (D2 * np
-00012830: 2e63 6f6e 6a28 5331 2929 2e69 6d61 6720  .conj(S1)).imag 
-00012840: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00012850: 2020 2020 6966 206d 6574 686f 6420 3d3d      if method ==
-00012860: 2773 7769 6674 273a 200d 0a20 2020 2020  'swift': ..     
-00012870: 2020 2020 2020 2073 6b77 203d 206e 702e         skw = np.
-00012880: 6162 7320 2820 5331 2020 2f20 4432 2029  abs ( S1  / D2 )
-00012890: 2020 0d0a 2020 2020 2020 2020 656c 7365    ..        else
-000128a0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-000128b0: 2073 6b77 203d 206e 702e 7371 7274 286e   skw = np.sqrt(n
-000128c0: 702e 6162 7328 2044 3153 3220 2d20 5331  p.abs( D1S2 - S1
-000128d0: 4432 2929 2f6e 702e 6162 7328 4432 290d  D2))/np.abs(D2).
-000128e0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-000128f0: 2020 2020 2020 206d 7520 3d20 6e70 2e73         mu = np.s
-00012900: 7172 7428 6e70 2e61 6273 2844 3153 3229  qrt(np.abs(D1S2)
-00012910: 202b 206e 702e 6162 7320 2853 3144 3229   + np.abs (S1D2)
-00012920: 292f 206e 702e 6162 7328 4432 2920 0d0a  )/ np.abs(D2) ..
-00012930: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00012940: 2020 6966 2073 7570 7072 6573 735f 6f75    if suppress_ou
-00012950: 746c 6965 7273 3a20 0d0a 2020 2020 2020  tliers: ..      
-00012960: 2020 2020 2020 736b 7720 3d20 7265 6d6f        skw = remo
-00012970: 7665 5f6f 7574 6c69 6572 7328 736b 772c  ve_outliers(skw,
-00012980: 2066 696c 6c5f 7661 6c75 653d 206e 702e   fill_value= np.
-00012990: 6e61 6e20 2920 0d0a 2020 2020 2020 2020  nan ) ..        
-000129a0: 2020 2020 6d75 203d 2072 656d 6f76 655f      mu = remove_
-000129b0: 6f75 746c 6965 7273 286d 752c 2066 696c  outliers(mu, fil
-000129c0: 6c5f 7661 6c75 653d 206e 702e 6e61 6e20  l_value= np.nan 
-000129d0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-000129e0: 0a20 2020 2020 2020 2073 6b77 203d 206e  .        skw = n
-000129f0: 6f72 6d61 6c69 7a65 7228 736b 7729 203b  ormalizer(skw) ;
-00012a00: 206d 7520 3d20 6e6f 726d 616c 697a 6572   mu = normalizer
-00012a10: 286d 7520 290d 0a20 2020 2020 2020 2020  (mu )..         
-00012a20: 2020 200d 0a20 2020 2020 2020 2072 6574     ..        ret
-00012a30: 7572 6e20 736b 7720 6966 2072 6574 7572  urn skw if retur
-00012a40: 6e5f 736b 6577 6e65 7373 3d3d 2773 6b65  n_skewness=='ske
-00012a50: 7727 2065 6c73 6520 280d 0a20 2020 2020  w' else (..     
-00012a60: 2020 2020 2020 206d 7520 6966 2072 6574         mu if ret
-00012a70: 7572 6e5f 736b 6577 6e65 7373 3d3d 276d  urn_skewness=='m
-00012a80: 7527 2065 6c73 6520 736b 772c 206d 7529  u' else skw, mu)
-00012a90: 0d0a 2020 200d 0a0d 0a20 2020 2064 6566  ..   ....    def
-00012aa0: 207a 7265 7374 6f72 6528 0d0a 2020 2020   zrestore(..    
-00012ab0: 2020 2020 7365 6c66 2c0d 0a20 2020 2020      self,..     
-00012ac0: 2020 202a 2c20 0d0a 2020 2020 2020 2020     *, ..        
-00012ad0: 7465 6e73 6f72 3a73 7472 3d4e 6f6e 652c  tensor:str=None,
-00012ae0: 200d 0a20 2020 2020 2020 2063 6f6d 706f   ..        compo
-00012af0: 6e65 6e74 3a73 7472 3d4e 6f6e 652c 200d  nent:str=None, .
-00012b00: 0a20 2020 2020 2020 2062 7566 6665 723a  .        buffer:
-00012b10: 2054 7570 6c65 5b66 6c6f 6174 5d3d 4e6f   Tuple[float]=No
-00012b20: 6e65 2c20 0d0a 2020 2020 2020 2020 6d65  ne, ..        me
-00012b30: 7468 6f64 3a73 7472 203d 2770 6427 2c0d  thod:str ='pd',.
-00012b40: 0a20 2020 2020 2020 202a 2a6b 7773 200d  .        **kws .
-00012b50: 0a20 2020 2020 2020 2029 3a20 0d0a 2020  .        ): ..  
-00012b60: 2020 2020 2020 2222 2220 4669 7820 7468        """ Fix th
-00012b70: 6520 7765 616b 2061 6e64 206d 6973 7369  e weak and missi
-00012b80: 6e67 2073 6967 6e61 6c20 6174 2074 6865  ng signal at the
-00012b90: 2027 6465 6164 2d62 616e 6460 2d20 616e   'dead-band`- an
-00012ba0: 6420 7265 636f 7665 7220 7468 6520 0d0a  d recover the ..
-00012bb0: 2020 2020 2020 2020 6d69 7373 696e 6720          missing 
-00012bc0: 696d 7065 6461 6e63 6520 7465 6e73 6f72  impedance tensor
-00012bd0: 2076 616c 7565 732e 200d 0a20 2020 2020   values. ..     
-00012be0: 2020 200d 0a20 2020 2020 2020 2054 6865     ..        The
-00012bf0: 2066 756e 6374 696f 6e20 7573 6573 2074   function uses t
-00012c00: 6865 2063 6f6d 706c 6574 6520 6672 6571  he complete freq
-00012c10: 7565 6e63 7920 2866 7265 7175 656e 6379  uency (frequency
-00012c20: 2077 6974 6820 636c 6561 6e20 6461 7461   with clean data
-00012c30: 2920 0d0a 2020 2020 2020 2020 636f 6c6c  ) ..        coll
-00012c40: 6563 7465 6420 7468 6f75 6768 6f75 7420  ected thoughout 
-00012c50: 7468 6520 7375 7276 6579 2074 6f20 7265  the survey to re
-00012c60: 636f 7665 7220 6279 2069 6e74 6572 2f65  cover by inter/e
-00012c70: 7874 7261 706f 6c61 7469 6e67 2074 6865  xtrapolating the
-00012c80: 200d 0a20 2020 2020 2020 206d 6973 7369   ..        missi
-00012c90: 6e67 206f 7220 7765 616b 2020 6672 6571  ng or weak  freq
-00012ca0: 7565 6e63 6965 7320 7468 6572 6562 7920  uencies thereby 
-00012cb0: 7265 7374 6f72 696e 6720 7468 6520 696d  restoring the im
-00012cc0: 7065 6461 6e63 6520 7465 6e73 6f72 7320  pedance tensors 
-00012cd0: 0d0a 2020 2020 2020 2020 6174 2074 6861  ..        at tha
-00012ce0: 7420 2764 6561 642d 6261 6e64 272e 204e  t 'dead-band'. N
-00012cf0: 6f74 6520 7468 6174 2074 6865 2027 6465  ote that the 'de
-00012d00: 6164 2d20 6261 6e64 2720 616c 736f 206b  ad- band' also k
-00012d10: 6e6f 776e 2061 7320 0d0a 2020 2020 2020  nown as ..      
-00012d20: 2020 2761 7474 656e 7561 7469 6f6e 202d    'attenuation -
-00012d30: 6261 6e64 2720 6973 2077 6865 7265 2074  band' is where t
-00012d40: 6865 2041 4d54 2073 6967 6e61 6c20 6973  he AMT signal is
-00012d50: 2077 6561 6b20 6f72 2067 656e 6572 616c   weak or general
-00012d60: 6c79 200d 0a20 2020 2020 2020 2061 6273  ly ..        abs
-00012d70: 6365 6e74 2e20 0d0a 200d 0a20 2020 2020  cent. .. ..     
-00012d80: 2020 2050 6172 616d 6574 6572 7320 0d0a     Parameters ..
-00012d90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00012da0: 2d2d 0d0a 0d0a 2020 2020 2020 2020 7465  --....        te
-00012db0: 6e73 6f72 3a20 7374 722c 206f 7074 696f  nsor: str, optio
-00012dc0: 6e61 6c2c 205b 2272 6573 6973 7469 7669  nal, ["resistivi
-00012dd0: 7479 227c 2270 6861 7365 227c 227a 227c  ty"|"phase"|"z"|
-00012de0: 2266 7265 7175 656e 6379 225d 0d0a 2020  "frequency"]..  
-00012df0: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
-00012e00: 2074 6865 203a 7465 726d 3a60 7465 6e73   the :term:`tens
-00012e10: 6f72 602e 2049 6620 7468 6520 6e61 6d65  or`. If the name
-00012e20: 206f 6620 7465 6e73 6f72 2069 7320 6769   of tensor is gi
-00012e30: 7665 6e2c 200d 0a20 2020 2020 2020 2020  ven, ..         
-00012e40: 2020 6675 6e63 7469 6f6e 2020 7265 7475    function  retu
-00012e50: 726e 7320 7468 6520 7465 6e73 6f72 2076  rns the tensor v
-00012e60: 616c 7565 696e 2074 776f 2d64 696d 656e  aluein two-dimen
-00012e70: 7369 6f6e 616c 7320 636f 6d70 6f73 6564  sionals composed
-00012e80: 200d 0a20 2020 2020 2020 2020 2020 6f66   ..           of
-00012e90: 2028 6e5f 6672 6571 202c 206e 5f73 6974   (n_freq , n_sit
-00012ea0: 6573 2920 7768 6572 6520 6060 6e5f 6672  es) where ``n_fr
-00012eb0: 6571 3d6e 756d 6265 7220 6f66 2066 7265  eq=number of fre
-00012ec0: 7175 656e 6379 6060 200d 0a20 2020 2020  quency`` ..     
-00012ed0: 2020 2020 2020 616e 6420 6060 6e5f 7361        and ``n_sa
-00012ee0: 7469 6f6e 7360 6020 6e75 6d62 6572 206f  tions`` number o
-00012ef0: 6620 7369 7465 732e 204e 6f74 6520 7468  f sites. Note th
-00012f00: 6174 2069 6620 7468 6520 7465 6e73 6f72  at if the tensor
-00012f10: 2069 7320 0d0a 2020 2020 2020 2020 2020   is ..          
-00012f20: 2070 6173 7365 6420 6173 2062 6f6f 6c65   passed as boole
-00012f30: 616e 2076 616c 7565 7320 6060 5472 7565  an values ``True
-00012f40: 6060 2c20 7468 6520 6060 7265 7369 7374  ``, the ``resist
-00012f50: 6976 6974 7960 6020 7465 6e73 6f72 2069  ivity`` tensor i
-00012f60: 7320 0d0a 2020 2020 2020 2020 2020 2065  s ..           e
-00012f70: 7870 6f72 7465 6420 6279 2064 6566 6175  xported by defau
-00012f80: 6c74 2061 6e64 2074 6865 2060 6063 6f6d  lt and the ``com
-00012f90: 706f 6e65 6e74 6060 7368 6f75 6c64 2062  ponent``should b
-00012fa0: 6520 7468 6520 636f 6d70 6f6e 656e 7420  e the component 
-00012fb0: 0d0a 2020 2020 2020 2020 2020 2070 6173  ..           pas
-00012fc0: 7365 6420 746f 203a 636c 6173 733a 6050  sed to :class:`P
-00012fd0: 726f 6365 7373 696e 6760 2061 7420 696e  rocessing` at in
-00012fe0: 6974 6961 6c69 7a61 7469 6f6e 2e20 0d0a  itialization. ..
-00012ff0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00013000: 2020 2020 6275 6666 6572 3a20 6c69 7374      buffer: list
-00013010: 205b 6d61 782c 206d 696e 5d20 6672 6571   [max, min] freq
-00013020: 7565 6e63 7920 696e 2048 7a0d 0a20 2020  uency in Hz..   
-00013030: 2020 2020 2020 2020 206c 6973 7420 6f66           list of
-00013040: 206d 6178 696d 756d 2061 6e64 206d 696e   maximum and min
-00013050: 696d 756d 2066 7265 7175 656e 6369 6573  imum frequencies
-00013060: 2e20 4974 206d 7573 7420 636f 6e74 6169  . It must contai
-00013070: 6e20 6f6e 6c79 2074 776f 200d 0a20 2020  n only two ..   
-00013080: 2020 2020 2020 2020 2076 616c 7565 732e           values.
-00013090: 2049 6620 604e 6f6e 6560 2c20 7468 6520   If `None`, the 
-000130a0: 6d61 7820 616e 6420 6d69 6e20 6f66 2074  max and min of t
-000130b0: 6865 2063 6c65 616e 2066 7265 7175 656e  he clean frequen
-000130c0: 6369 6573 2061 7265 200d 0a20 2020 2020  cies are ..     
-000130d0: 2020 2020 2020 2073 656c 6563 7465 642e         selected.
-000130e0: 204d 6f72 656f 7665 7220 7468 6520 5b6d   Moreover the [m
-000130f0: 696e 2c20 6d61 785d 2066 7265 7175 656e  in, max] frequen
-00013100: 6379 2073 686f 756c 6420 6e6f 7420 636f  cy should not co
-00013110: 6d70 756c 736f 7279 200d 0a20 2020 2020  mpulsory ..     
-00013120: 2020 2020 2020 2074 6f20 6669 7420 7468         to fit th
-00013130: 6520 6672 6571 7565 6e63 7920 7261 6e67  e frequency rang
-00013140: 6520 696e 2074 6865 2064 6174 612e 2054  e in the data. T
-00013150: 6865 2067 6976 656e 2066 7265 7175 656e  he given frequen
-00013160: 6379 2063 616e 200d 0a20 2020 2020 2020  cy can ..       
-00013170: 2020 2020 2062 6520 696e 7465 7270 6f6c       be interpol
-00013180: 6174 6564 2074 6f20 6d61 7463 6820 7468  ated to match th
-00013190: 6520 6265 7374 2063 6c6f 7365 7374 2066  e best closest f
-000131a0: 7265 7175 656e 6369 6573 2069 6e20 7468  requencies in th
-000131b0: 6520 6461 7461 2e20 0d0a 2020 2020 2020  e data. ..      
-000131c0: 0d0a 2020 2020 2020 2020 6d65 7468 6f64  ..        method
-000131d0: 3a20 7374 722c 206f 7074 696f 6e61 6c20  : str, optional 
-000131e0: 2c20 6465 6661 756c 743d 2770 6427 200d  , default='pd' .
-000131f0: 0a20 2020 2020 2020 2020 2020 204d 6574  .            Met
-00013200: 686f 6420 6f66 205a 2069 6e74 6572 706f  hod of Z interpo
-00013210: 6c61 7469 6f6e 2e20 5573 6520 6060 6261  lation. Use ``ba
-00013220: 7365 6060 2066 6f72 2060 7363 6970 7960  se`` for `scipy`
-00013230: 2069 6e74 6572 706f 6c61 7469 6f6e 2c20   interpolation, 
-00013240: 0d0a 2020 2020 2020 2020 2020 2020 6060  ..            ``
-00013250: 6d65 616e 6060 206f 7220 6060 6266 6660  mean`` or ``bff`
-00013260: 6020 666f 7220 7363 616c 696e 6720 6d65  ` for scaling me
-00013270: 7468 6f64 7320 616e 6420 6060 7064 6060  thods and ``pd``
-00013280: 2066 6f72 2070 616e 6461 7320 0d0a 2020   for pandas ..  
-00013290: 2020 2020 2020 2020 2020 696e 7465 7270            interp
-000132a0: 6f6c 6174 696f 6e20 6d65 7468 6f64 732e  olation methods.
-000132b0: 204e 6f74 6520 7468 6174 2074 6865 2066   Note that the f
-000132c0: 6972 7374 206d 6574 686f 6420 6973 2066  irst method is f
-000132d0: 6173 7420 616e 6420 0d0a 2020 2020 2020  ast and ..      
-000132e0: 2020 2020 2020 6566 6669 6369 656e 7420        efficient 
-000132f0: 7768 656e 2074 6865 206e 756d 6265 7220  when the number 
-00013300: 6f66 204e 614e 2069 6e20 7468 6520 6172  of NaN in the ar
-00013310: 7261 7920 6966 2072 656c 6174 6976 656c  ray if relativel
-00013320: 7920 6665 772e 200d 0a20 2020 2020 2020  y few. ..       
-00013330: 2020 2020 2049 7420 6973 206c 6573 7320       It is less 
-00013340: 6163 6375 7261 7465 2074 6f20 7573 6520  accurate to use 
-00013350: 7468 6520 6062 6173 6560 2069 6e74 6572  the `base` inter
-00013360: 706f 6c61 7469 6f6e 2077 6865 6e20 7468  polation when th
-00013370: 6520 6461 7461 200d 0a20 2020 2020 2020  e data ..       
-00013380: 2020 2020 2069 7320 636f 6d70 6f73 6564       is composed
-00013390: 206f 6620 6d61 6e79 206d 6973 7369 6e67   of many missing
-000133a0: 2076 616c 7565 732e 2041 6c74 6572 6e61   values. Alterna
-000133b0: 7469 7665 6c79 2c20 7468 6520 7363 616c  tively, the scal
-000133c0: 6564 200d 0a20 2020 2020 2020 2020 2020  ed ..           
-000133d0: 206d 6574 686f 6428 7468 6520 2073 6563   method(the  sec
-000133e0: 6f6e 6420 6f6e 6529 2069 7320 7072 6f70  ond one) is prop
-000133f0: 6f73 6564 2074 6f20 6265 2074 6865 2061  osed to be the a
-00013400: 6c74 6572 6e61 7469 7665 2077 6179 206d  lternative way m
-00013410: 6f72 6520 0d0a 2020 2020 2020 2020 2020  ore ..          
-00013420: 2020 6566 6669 6369 656e 742e 2049 6e64    efficient. Ind
-00013430: 6565 642c 2077 6865 6e20 6060 6d65 616e  eed, when ``mean
-00013440: 6060 2061 7267 756d 656e 7420 6973 2073  `` argument is s
-00013450: 6574 2c20 6675 6e63 7469 6f6e 2072 6570  et, function rep
-00013460: 6c61 6365 7320 0d0a 2020 2020 2020 2020  laces ..        
-00013470: 2020 2020 7468 6520 4e61 4e20 7661 6c75      the NaN valu
-00013480: 6573 2062 7920 7468 6520 6e6f 6e7a 6572  es by the nonzer
-00013490: 6f73 2069 6e20 7468 6520 7261 7720 6172  os in the raw ar
-000134a0: 7261 7920 616e 6420 7468 656e 2075 7365  ray and then use
-000134b0: 7320 7468 6520 0d0a 2020 2020 2020 2020  s the ..        
-000134c0: 2020 2020 6d65 616e 2074 6f20 6669 7420      mean to fit 
-000134d0: 7468 6520 6461 7461 2e20 5468 6520 7265  the data. The re
-000134e0: 7375 6c74 206f 6620 6669 7474 696e 6720  sult of fitting 
-000134f0: 6372 6561 7465 7320 6120 736d 6f6f 7468  creates a smooth
-00013500: 2063 7572 7665 200d 0a20 2020 2020 2020   curve ..       
-00013510: 2020 2020 2077 6865 7265 2074 6865 2069       where the i
-00013520: 6e64 6578 206f 6620 6561 6368 204e 614e  ndex of each NaN
-00013530: 2069 6e20 7468 6520 7261 7720 6172 7261   in the raw arra
-00013540: 7920 6973 2072 6570 6c61 6365 6420 6279  y is replaced by
-00013550: 2069 7473 200d 0a20 2020 2020 2020 2020   its ..         
-00013560: 2020 2063 6f72 7265 7370 6f6e 6469 6e67     corresponding
-00013570: 2076 616c 7565 7320 696e 2074 6865 2066   values in the f
-00013580: 6974 2072 6573 756c 7473 2e20 5468 6520  it results. The 
-00013590: 7361 6d65 2061 7070 726f 6163 6820 6973  same approach is
-000135a0: 2075 7365 6420 0d0a 2020 2020 2020 2020   used ..        
-000135b0: 2020 2020 666f 7220 6060 6266 6660 6020      for ``bff`` 
-000135c0: 6d65 7468 6f64 2e20 436f 6e76 6572 7365  method. Converse
-000135d0: 6c79 2c20 7261 7468 6572 2074 6861 6e20  ly, rather than 
-000135e0: 6176 6572 6167 696e 6720 7468 6520 6e6f  averaging the no
-000135f0: 6e7a 6572 6f73 200d 0a20 2020 2020 2020  nzeros ..       
-00013600: 2020 2020 2076 616c 7565 732c 2069 7420       values, it 
-00013610: 7573 6573 2074 6865 2062 6163 6b77 6172  uses the backwar
-00013620: 6420 616e 6420 666f 7277 6172 6420 7374  d and forward st
-00013630: 7261 7465 6779 2020 746f 2066 696c 6c20  rategy  to fill 
-00013640: 7468 6520 0d0a 2020 2020 2020 2020 2020  the ..          
-00013650: 2020 4e61 4e20 6265 666f 7265 2073 6361    NaN before sca
-00013660: 6c69 6e67 2e20 6060 6d65 616e 6060 2061  ling. ``mean`` a
-00013670: 6e64 2060 6062 6666 6060 2061 7265 206d  nd ``bff`` are m
-00013680: 6f72 6520 6566 6669 6369 656e 7420 7768  ore efficient wh
-00013690: 656e 200d 0a20 2020 2020 2020 2020 2020  en ..           
-000136a0: 2074 6865 2064 6174 6120 6172 6520 636f   the data are co
-000136b0: 6d70 6f73 6564 206f 6620 6120 6c6f 7420  mposed of a lot 
-000136c0: 6f66 206d 6973 7369 6e67 2076 616c 7565  of missing value
-000136d0: 732e 2057 6865 6e20 7468 6520 0d0a 2020  s. When the ..  
-000136e0: 2020 2020 2020 2020 2020 696e 7465 7270            interp
-000136f0: 6f6c 6174 696f 6e20 606d 6574 686f 6460  olation `method`
-00013700: 2069 7320 7365 7420 746f 2060 6070 6460   is set to ``pd`
-00013710: 602c 2066 756e 6374 696f 6e20 7573 6573  `, function uses
-00013720: 2074 6865 2070 616e 6461 7320 0d0a 2020   the pandas ..  
-00013730: 2020 2020 2020 2020 2020 696e 7465 7270            interp
-00013740: 6f6c 6174 696f 6e20 6275 7420 656e 6465  olation but ende
-00013750: 6420 7468 6520 696e 7465 7270 6f6c 6174  d the interpolat
-00013760: 696f 6e20 7769 7468 2066 6f72 7761 7264  ion with forward
-00013770: 2f62 6163 6b77 6172 6420 0d0a 2020 2020  /backward ..    
-00013780: 2020 2020 2020 2020 4e61 4e20 6669 6c6c          NaN fill
-00013790: 696e 6720 7369 6e63 6520 7468 6520 696e  ing since the in
-000137a0: 7465 7270 6f6c 6174 696f 6e20 7769 7468  terpolation with
-000137b0: 2070 616e 6461 7320 646f 6573 206e 6f74   pandas does not
-000137c0: 2064 6561 6c20 7769 7468 200d 0a20 2020   deal with ..   
-000137d0: 2020 2020 2020 2020 2061 6c6c 204e 614e           all NaN
-000137e0: 2061 7420 7468 6520 6265 6769 6e69 6e67   at the begining
-000137f0: 206f 7220 6174 2074 6865 2065 6e64 206f   or at the end o
-00013800: 6620 7468 6520 6172 7261 792e 200d 0a20  f the array. .. 
-00013810: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00013820: 2020 2020 2066 696c 6c5f 7661 6c75 653a       fill_value:
-00013830: 2061 7272 6179 2d6c 696b 652c 2073 7472   array-like, str
-00013840: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
-00013850: 756c 743d 2765 7874 7261 706f 6c61 7465  ult='extrapolate
-00013860: 272c 200d 0a20 2020 2020 2020 2020 2020  ', ..           
-00013870: 2049 6620 6120 6e64 6172 7261 7920 286f   If a ndarray (o
-00013880: 7220 666c 6f61 7429 2c20 7468 6973 2076  r float), this v
-00013890: 616c 7565 2077 696c 6c20 6265 2075 7365  alue will be use
-000138a0: 6420 746f 2066 696c 6c20 696e 2066 6f72  d to fill in for
-000138b0: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-000138c0: 6571 7565 7374 6564 2070 6f69 6e74 7320  equested points 
-000138d0: 6f75 7473 6964 6520 6f66 2074 6865 2064  outside of the d
-000138e0: 6174 6120 7261 6e67 652e 2049 6620 6e6f  ata range. If no
-000138f0: 7420 7072 6f76 6964 6564 2c20 0d0a 2020  t provided, ..  
-00013900: 2020 2020 2020 2020 2020 7468 656e 2074            then t
-00013910: 6865 2064 6566 6175 6c74 2069 7320 4e61  he default is Na
-00013920: 4e2e 2054 6865 2061 7272 6179 2d6c 696b  N. The array-lik
-00013930: 6520 6d75 7374 2062 726f 6164 6361 7374  e must broadcast
-00013940: 2070 726f 7065 726c 7920 0d0a 2020 2020   properly ..    
-00013950: 2020 2020 2020 2020 746f 2074 6865 2064          to the d
-00013960: 696d 656e 7369 6f6e 7320 6f66 2074 6865  imensions of the
-00013970: 2020 6e6f 6e2d 696e 7465 7270 6f6c 6174    non-interpolat
-00013980: 696f 6e20 6178 6573 2e20 4966 2074 776f  ion axes. If two
-00013990: 2d65 6c65 6d65 6e74 200d 0a20 2020 2020  -element ..     
-000139a0: 2020 2020 2020 2069 6e20 7475 706c 652c         in tuple,
-000139b0: 2074 6865 6e20 7468 6520 6669 7273 7420   then the first 
-000139c0: 656c 656d 656e 7420 6973 2075 7365 6420  element is used 
-000139d0: 6173 2061 2066 696c 6c20 7661 6c75 650d  as a fill value.
-000139e0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-000139f0: 2060 6078 5f6e 6577 203c 2078 5b30 5d60   ``x_new < x[0]`
-00013a00: 6020 616e 6420 7468 6520 7365 636f 6e64  ` and the second
-00013a10: 2065 6c65 6d65 6e74 2069 7320 7573 6564   element is used
-00013a20: 2066 6f72 200d 0a20 2020 2020 2020 2020   for ..         
-00013a30: 2020 2060 6078 5f6e 6577 203e 2078 5b2d     ``x_new > x[-
-00013a40: 315d 6060 2e20 416e 7974 6869 6e67 2074  1]``. Anything t
-00013a50: 6861 7420 6973 206e 6f74 2061 2032 2d65  hat is not a 2-e
-00013a60: 6c65 6d65 6e74 2074 7570 6c65 200d 0a20  lement tuple .. 
-00013a70: 2020 2020 2020 2020 2020 2028 652e 672e             (e.g.
-00013a80: 2c20 6c69 7374 206f 7220 6e64 6172 7261  , list or ndarra
-00013a90: 792c 7265 6761 7264 6c65 7373 206f 6620  y,regardless of 
-00013aa0: 7368 6170 6529 2069 7320 7461 6b65 6e20  shape) is taken 
-00013ab0: 746f 2062 6520 6120 0d0a 2020 2020 2020  to be a ..      
-00013ac0: 2020 2020 2020 7369 6e67 6c65 2061 7272        single arr
-00013ad0: 6179 2d6c 696b 6520 6172 6775 6d65 6e74  ay-like argument
-00013ae0: 206d 6561 6e74 2074 6f20 6265 2075 7365   meant to be use
-00013af0: 6420 666f 7220 626f 7468 2062 6f75 6e64  d for both bound
-00013b00: 7320 6173 200d 0a20 2020 2020 2020 2020  s as ..         
-00013b10: 2020 2062 656c 6f77 2c20 6162 6f76 6520     below, above 
-00013b20: 3d20 6669 6c6c 5f76 616c 7565 2c20 6669  = fill_value, fi
-00013b30: 6c6c 5f76 616c 7565 2e20 5573 696e 6720  ll_value. Using 
-00013b40: 6120 7477 6f2d 656c 656d 656e 7420 7475  a two-element tu
-00013b50: 706c 6520 0d0a 2020 2020 2020 2020 2020  ple ..          
-00013b60: 2020 6f72 206e 6461 7272 6179 2072 6571    or ndarray req
-00013b70: 7569 7265 7320 6060 626f 756e 6473 5f65  uires ``bounds_e
-00013b80: 7272 6f72 3d46 616c 7365 6060 2e0d 0a20  rror=False``... 
-00013b90: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00013ba0: 2020 2020 206b 7773 3a20 6469 6374 200d       kws: dict .
-00013bb0: 0a20 2020 2020 2020 2020 2020 2041 6464  .            Add
-00013bc0: 6974 696f 6e61 6c20 6b65 7977 6f72 6420  itional keyword 
-00013bd0: 6172 6775 6d65 6e74 7320 6672 6f6d 203a  arguments from :
-00013be0: 6675 6e63 3a60 7e69 6e74 6572 706f 6c61  func:`~interpola
-00013bf0: 7465 3164 602e 200d 0a20 2020 2020 2020  te1d`. ..       
-00013c00: 200d 0a20 2020 2020 2020 2052 6574 7572   ..        Retur
-00013c10: 6e73 200d 0a20 2020 2020 2020 202d 2d2d  ns ..        ---
-00013c20: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2020  -----..         
-00013c30: 2020 2041 7272 6179 2d6c 696b 6520 6f66     Array-like of
-00013c40: 203a 636c 6173 733a 6077 6174 6578 2e65   :class:`watex.e
-00013c50: 7874 6572 6e61 6c2e 7a2e 5a60 206f 626a  xternal.z.Z` obj
-00013c60: 6563 7473 200d 0a20 2020 2020 2020 2020  ects ..         
-00013c70: 2020 2041 7272 6179 2063 6f6c 6c65 6374     Array collect
-00013c80: 696f 6e20 6f66 206e 6577 205a 2069 6d70  ion of new Z imp
-00013c90: 6564 616e 6365 7320 6f62 6a65 6374 7320  edances objects 
-00013ca0: 7769 7468 2064 6561 642d 6261 6e64 2074  with dead-band t
-00013cb0: 656e 736f 7220 0d0a 2020 2020 2020 2020  ensor ..        
-00013cc0: 2020 2020 7265 636f 7665 7265 642e 203a      recovered. :
-00013cd0: 636c 6173 733a 6077 6174 6578 2e65 7874  class:`watex.ext
-00013ce0: 6572 6e61 6c73 2e7a 2e2e 5a60 2061 7265  ernals.z..Z` are
-00013cf0: 206e 6461 7272 6179 2028 6e66 7265 712c   ndarray (nfreq,
-00013d00: 2032 2c20 3229 2e20 0d0a 2020 2020 2020   2, 2). ..      
-00013d10: 2020 2020 2020 3278 3220 6d61 7472 6963        2x2 matric
-00013d20: 6573 2066 6f72 2063 6f6d 706f 6e65 6e74  es for component
-00013d30: 7320 7878 2c20 7879 2061 6e64 2079 782c  s xx, xy and yx,
-00013d40: 2079 792e 2049 6620 7465 6e73 6f72 2067   yy. If tensor g
-00013d50: 6976 656e 2c20 0d0a 2020 2020 2020 2020  iven, ..        
-00013d60: 2020 2020 6974 2072 6574 7572 6e73 2061      it returns a
-00013d70: 2063 6f6c 6c65 6374 696f 6e20 6f66 2032   collection of 2
-00013d80: 4420 7465 6e73 6f72 206f 6620 6561 6368  D tensor of each
-00013d90: 2073 7461 7469 6f6e 732e 200d 0a20 2020   stations. ..   
-00013da0: 200d 0a20 2020 2020 2020 204d 6f72 6520   ..        More 
-00013db0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00013dc0: 0d0a 2020 2020 2020 2020 4f6e 6520 6d61  ..        One ma
-00013dd0: 696e 2070 726f 626c 656d 2069 6e20 636f  in problem in co
-00013de0: 6c6c 6563 7469 6e67 207c 4e53 414d 547c  llecting |NSAMT|
-00013df0: 2064 6174 6120 6973 2074 6865 2073 6967   data is the sig
-00013e00: 6e61 6c20 6c65 7665 6c20 696e 2074 6865  nal level in the
-00013e10: 200d 0a20 2020 2020 2020 2027 6174 7465   ..        'atte
-00013e20: 6e75 6174 696f 6e20 6261 6e64 272e 2043  nuation band'. C
-00013e30: 6f6d 7061 7265 6420 746f 2074 6865 207c  ompared to the |
-00013e40: 4353 414d 547c 206d 6574 686f 6420 2857  CSAMT| method (W
-00013e50: 616e 6720 616e 6420 5461 6e2c 2032 3031  ang and Tan, 201
-00013e60: 373b 200d 0a20 2020 2020 2020 205a 6f6e  7; ..        Zon
-00013e70: 6765 2061 6e64 2048 7567 6865 732c 2031  ge and Hughes, 1
-00013e80: 3939 3129 2c74 6865 206e 6174 7572 616c  991),the natural
-00013e90: 2073 6967 6e61 6c73 2061 7265 206e 6f74   signals are not
-00013ea0: 2075 6e64 6572 206f 7572 2063 6f6e 7472   under our contr
-00013eb0: 6f6c 200d 0a20 2020 2020 2020 2061 6e64  ol ..        and
-00013ec0: 2073 7566 6665 7220 6672 6f6d 2066 7265   suffer from fre
-00013ed0: 7175 656e 6379 2020 7261 6e67 6573 2077  quency  ranges w
-00013ee0: 6974 6820 6c69 7474 6c65 206f 7220 6e6f  ith little or no
-00013ef0: 2073 6967 6e61 6c2e 2020 4d6f 7374 200d   signal.  Most .
-00013f00: 0a20 2020 2020 2020 206e 6f74 6162 6c79  .        notably
-00013f10: 2c20 7468 6520 7c4e 5341 4d54 7c20 2764  , the |NSAMT| 'd
-00013f20: 6561 642d 6261 6e64 2720 6265 7477 6565  ead-band' betwee
-00013f30: 6e20 6170 7072 6f78 696d 6174 656c 7920  n approximately 
-00013f40: 3120 6b48 7a20 616e 6420 3420 0d0a 2020  1 kHz and 4 ..  
-00013f50: 2020 2020 2020 6b48 7a2c 2062 7574 2061        kHz, but a
-00013f60: 6c73 6f20 6120 7369 676e 616c 206c 6f77  lso a signal low
-00013f70: 2069 6e20 7468 6520 7669 6369 6e69 7479   in the vicinity
-00013f80: 6f66 2031 2048 7a20 7768 6572 6520 7468  of 1 Hz where th
-00013f90: 6520 7472 616e 7369 7469 6f6e 200d 0a20  e transition .. 
-00013fa0: 2020 2020 2020 2074 6f20 6d61 676e 6574         to magnet
-00013fb0: 6f73 7068 6572 6963 2065 6e65 7267 7920  ospheric energy 
-00013fc0: 736f 7572 6365 7320 6f63 6375 7273 2028  sources occurs (
-00013fd0: 476f 6c64 616b 2061 6e64 204f 6c73 6f6e  Goldak and Olson
-00013fe0: 2c20 3230 3135 292e 200d 0a20 2020 2020  , 2015). ..     
-00013ff0: 2020 2049 6e20 7468 6973 2062 616e 642c     In this band,
-00014000: 206e 6174 7572 616c 2073 6f75 7263 6520   natural source 
-00014010: 7369 676e 616c 7320 6172 6520 6765 6e65  signals are gene
-00014020: 7261 6c6c 7920 2061 6273 656e 742e 2054  rally  absent. T
-00014030: 6865 2045 4d20 0d0a 2020 2020 2020 2020  he EM ..        
-00014040: 656e 6572 6779 2069 7320 6469 7373 6970  energy is dissip
-00014050: 6174 6564 2061 6e64 206f 6674 656e 2063  ated and often c
-00014060: 756c 7475 7261 6c20 7c45 4d7c 206e 6f69  ultural |EM| noi
-00014070: 7365 2066 696c 6c73 2074 6865 2067 6170  se fills the gap
-00014080: 200d 0a20 2020 2020 2020 2028 5a6f 6e67   ..        (Zong
-00014090: 652c 2032 3030 3029 2e20 5468 6520 7265  e, 2000). The re
-000140a0: 7370 6f6e 7365 2069 7320 6578 7472 6170  sponse is extrap
-000140b0: 6f6c 6174 6564 2066 726f 6d20 7265 7375  olated from resu
-000140c0: 6c74 7320 6f62 7365 7276 6564 200d 0a20  lts observed .. 
-000140d0: 2020 2020 2020 2074 6f70 2066 7265 7175         top frequ
-000140e0: 656e 6369 6573 2820 466f 7220 696e 7374  encies( For inst
-000140f0: 616e 6365 2061 7420 3230 2c20 3430 2c20  ance at 20, 40, 
-00014100: 3235 302c 2061 6e64 2035 3030 2048 7a29  250, and 500 Hz)
-00014110: 2e45 7870 6572 6965 6e63 650d 0a20 2020  .Experience..   
-00014120: 2020 2020 2069 6e64 6963 6174 6573 2074       indicates t
-00014130: 6861 7420 7468 6520 6e61 7475 7261 6c20  hat the natural 
-00014140: 736f 7572 6365 2073 6967 6e61 6c20 6c65  source signal le
-00014150: 7665 6c20 6174 2032 3030 3020 487a 2063  vel at 2000 Hz c
-00014160: 616e 2062 6520 0d0a 2020 2020 2020 2020  an be ..        
-00014170: 6578 7065 6374 6564 2074 6f20 6170 7072  expected to appr
-00014180: 6f61 6368 2031 302d 3620 ceb3 2fe2 889a  oach 10-6 ../...
-00014190: 487a 2028 5a68 656e 672c 2032 3031 303b  Hz (Zheng, 2010;
-000141a0: 205a 6f6e 6765 2c20 3230 3030 292e 0d0a   Zonge, 2000)...
-000141b0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000141c0: 2020 5365 6520 416c 736f 0d0a 2020 2020    See Also..    
-000141d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-000141e0: 2020 2020 2020 2020 7363 6970 792e 696e          scipy.in
-000141f0: 7465 7270 6f6c 6174 652e 696e 7465 7270  terpolate.interp
-00014200: 3164 3a20 0d0a 2020 2020 2020 2020 2020  1d: ..          
-00014210: 2020 496e 7465 7270 6f6c 6174 6520 3144    Interpolate 1D
-00014220: 2e20 0d0a 2020 2020 2020 2020 2020 2020  . ..            
-00014230: 0d0a 2020 2020 2020 2020 5265 6665 7265  ..        Refere
-00014240: 6e63 6573 200d 0a20 2020 2020 2020 202d  nces ..        -
-00014250: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-00014260: 2020 2047 6f6c 6461 6b2c 2044 2e4b 2e2c     Goldak, D.K.,
-00014270: 204f 6c73 6f6e 2c20 522e 572e 2c20 3230   Olson, R.W., 20
-00014280: 3135 2e20 4e65 7720 6465 7665 6c6f 706d  15. New developm
-00014290: 656e 7473 2069 6e20 7c41 4d54 7c20 6578  ents in |AMT| ex
-000142a0: 706c 6f72 6174 696f 6ee2 80af 3a0d 0a20  ploration...:.. 
-000142b0: 2020 2020 2020 2020 2020 2043 6173 6520             Case 
-000142c0: 7374 7564 7920 6672 6f6d 2044 6172 6e6c  study from Darnl
-000142d0: 6579 2042 6179 2e20 4353 4547 2052 6563  ey Bay. CSEG Rec
-000142e0: 2e20 3232 e280 9332 372e 0d0a 2020 2020  . 22...27...    
-000142f0: 2020 2020 5761 6e67 2c20 4b2e 2c20 5461      Wang, K., Ta
-00014300: 6e2c 2048 2e2c 2032 3031 372e 2052 6573  n, H., 2017. Res
-00014310: 6561 7263 6820 6f6e 2074 6865 2066 6f72  earch on the for
-00014320: 7761 7264 206d 6f64 656c 696e 6720 6f66  ward modeling of
-00014330: 207c 4353 414d 547c 2069 6e20 0d0a 2020   |CSAMT| in ..  
-00014340: 2020 2020 2020 2020 2020 7468 7265 652d            three-
-00014350: 6469 6d65 6e73 696f 6e61 6c20 6178 6961  dimensional axia
-00014360: 6c20 616e 6973 6f74 726f 7069 6320 6d65  l anisotropic me
-00014370: 6469 612e 204a 2e20 4170 706c 2e20 4765  dia. J. Appl. Ge
-00014380: 6f70 6879 732e 2031 3436 2c20 3237 e280  ophys. 146, 27..
-00014390: 9333 362e 0d0a 2020 2020 2020 2020 2020  .36...          
-000143a0: 2020 6874 7470 733a 2f2f 646f 692e 6f72    https://doi.or
-000143b0: 672f 3130 2e31 3031 362f 6a2e 6a61 7070  g/10.1016/j.japp
-000143c0: 6765 6f2e 3230 3137 2e30 382e 3030 370d  geo.2017.08.007.
-000143d0: 0a20 2020 2020 2020 205a 6f6e 6765 2c20  .        Zonge, 
-000143e0: 492e 2c20 3230 3030 2e20 7c4e 5341 4d54  I., 2000. |NSAMT
-000143f0: 7c20 496d 6167 696e 672e 2033 3332 3220  | Imaging. 3322 
-00014400: 4561 7374 2046 6f72 7420 4c6f 7765 6c6c  East Fort Lowell
-00014410: 2052 6f61 642c 2054 7563 736f 6e2c 2041   Road, Tucson, A
-00014420: 5a20 3835 3731 3620 5553 412e 200d 0a20  Z 85716 USA. .. 
-00014430: 2020 2020 2020 205a 6f6e 6765 2c20 4c2e         Zonge, L.
-00014440: 2c20 4875 6768 6573 2c20 4c2e 4a2e 2c20  , Hughes, L.J., 
-00014450: 3139 3931 2e20 7c43 5341 4d54 7c2e 2053  1991. |CSAMT|. S
-00014460: 6f63 2e20 4578 706c 6f72 2e20 4765 6f70  oc. Explor. Geop
-00014470: 6879 732e 2032 2c20 3731 33e2 8093 3830  hys. 2, 713...80
-00014480: 392e 0d0a 2020 2020 2020 2020 2020 200d  9...           .
-00014490: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-000144a0: 7320 0d0a 2020 2020 2020 2020 2d2d 2d2d  s ..        ----
-000144b0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 3e3e  ----..        >>
-000144c0: 3e20 696d 706f 7274 206e 756d 7079 2061  > import numpy a
-000144d0: 7320 6e70 200d 0a20 2020 2020 2020 203e  s np ..        >
-000144e0: 3e3e 2069 6d70 6f72 7420 6d61 7470 6c6f  >> import matplo
-000144f0: 746c 6962 2e70 7970 6c6f 7420 6173 2070  tlib.pyplot as p
-00014500: 6c74 200d 0a20 2020 2020 2020 203e 3e3e  lt ..        >>>
-00014510: 2066 726f 6d20 7761 7465 782e 6d65 7468   from watex.meth
-00014520: 6f64 732e 656d 2069 6d70 6f72 7420 5072  ods.em import Pr
-00014530: 6f63 6573 7369 6e67 0d0a 2020 2020 2020  ocessing..      
-00014540: 2020 3e3e 3e20 7061 7468 3265 6469 203d    >>> path2edi =
-00014550: 2027 6461 7461 2f65 6469 7327 0d0a 2020   'data/edis'..  
-00014560: 2020 2020 2020 3e3e 3e20 704f 626a 733d        >>> pObjs=
-00014570: 2050 726f 6365 7373 696e 6728 292e 6669   Processing().fi
-00014580: 7428 7061 7468 3265 6469 290d 0a20 2020  t(path2edi)..   
-00014590: 2020 2020 203e 3e3e 2023 204f 6e65 2063       >>> # One c
-000145a0: 616e 2073 7065 6369 6679 2074 6865 2066  an specify the f
-000145b0: 7265 7175 656e 6379 2062 7566 6665 7220  requency buffer 
-000145c0: 6c69 6b65 2074 6865 2065 7861 6d70 6c65  like the example
-000145d0: 2062 656c 6f77 2c20 486f 7765 7665 7220   below, However 
-000145e0: 0d0a 2020 2020 2020 2020 3e3e 3e20 2320  ..        >>> # 
-000145f0: 6974 2069 7320 6e6f 7420 6e65 6365 7373  it is not necess
-00014600: 6172 6179 2061 7420 6c65 6173 7420 7468  aray at least th
-00014610: 6572 6520 6973 2061 2061 2073 7065 6369  ere is a a speci
-00014620: 6669 6320 7265 6173 6f6e 2074 6f20 6669  fic reason to fi
-00014630: 7820 7468 6520 6672 6571 7565 6e63 6965  x the frequencie
-00014640: 7320 0d0a 2020 2020 2020 2020 3e3e 3e20  s ..        >>> 
-00014650: 6275 6666 6572 203d 205b 312e 3435 3030  buffer = [1.4500
-00014660: 3065 2b30 342c 312e 3131 3530 3065 2b30  0e+04,1.11500e+0
-00014670: 315d 0d0a 2020 2020 2020 2020 3e3e 3e20  1]..        >>> 
-00014680: 7a6f 626a 735f 6220 3d20 2070 4f62 6a73  zobjs_b =  pObjs
-00014690: 2e7a 7265 7374 6f72 6528 6275 6666 6572  .zrestore(buffer
-000146a0: 203d 2062 7566 6665 720d 0a20 2020 2020   = buffer..     
+000117c0: 2020 0d0a 2020 2020 2020 2020 496e 6465    ..        Inde
+000117d0: 6564 2c20 3a6d 6174 683a 6073 6b65 775f  ed, :math:`skew_
+000117e0: 7b42 6168 727d 6020 6d65 6173 7572 6573  {Bahr}` measures
+000117f0: 2074 6865 2064 6576 6961 7469 6f6e 2066   the deviation f
+00011800: 726f 6d20 7468 6520 7379 6d6d 6574 7279  rom the symmetry
+00011810: 2063 6f6e 6469 7469 6f6e 0d0a 2020 2020   condition..    
+00011820: 2020 2020 7468 726f 7567 6820 7468 6520      through the 
+00011830: 7068 6173 6520 6469 6666 6572 656e 6365  phase difference
+00011840: 7320 6265 7477 6565 6e20 6561 6368 2070  s between each p
+00011850: 6169 7220 6f66 2074 656e 736f 7220 656c  air of tensor el
+00011860: 656d 656e 7473 2c63 6f6e 7369 6465 7269  ements,consideri
+00011870: 6e67 0d0a 2020 2020 2020 2020 7468 6174  ng..        that
+00011880: 2070 6861 7365 7320 6172 6520 6c65 7373   phases are less
+00011890: 2073 656e 7369 7469 7665 2074 6f20 7375   sensitive to su
+000118a0: 7266 6163 6520 6469 7374 6f72 7469 6f6e  rface distortion
+000118b0: 7328 692e 652e 2067 616c 7661 6e69 6320  s(i.e. galvanic 
+000118c0: 6469 7374 6f72 7469 6f6e 292e 0d0a 2020  distortion)...  
+000118d0: 2020 2020 2020 5468 6520 3a6d 6174 683a        The :math:
+000118e0: 6073 6b65 775f 7b42 6168 727d 6020 7468  `skew_{Bahr}` th
+000118f0: 7265 7368 6f6c 6420 6973 2073 6574 2061  reshold is set a
+00011900: 7420 6060 302e 3360 6020 616e 6420 6869  t ``0.3`` and hi
+00011910: 6768 6572 2076 616c 7565 7320 6d65 616e  gher values mean
+00011920: 200d 0a20 2020 2020 2020 2033 4420 7374   ..        3D st
+00011930: 7275 6374 7572 6573 2028 4261 6872 2c20  ructures (Bahr, 
+00011940: 3139 3931 292e 0d0a 2020 2020 2020 2020  1991)...        
+00011950: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00011960: 2020 2020 5061 7261 6d65 7465 7273 200d      Parameters .
+00011970: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00011980: 2d2d 0d0a 2020 2020 2020 2020 6461 7461  --..        data
+00011990: 3a20 7374 7220 6f66 2070 6174 682d 6c69  : str of path-li
+000119a0: 6b65 206f 7220 6c69 7374 206f 6620 7079  ke or list of py
+000119b0: 6373 616d 742e 636f 7265 2e65 6469 2e45  csamt.core.edi.E
+000119c0: 6469 200d 0a20 2020 2020 2020 2020 2020  di ..           
+000119d0: 2045 4449 2064 6174 6120 6f72 2045 4449   EDI data or EDI
+000119e0: 206f 626a 6563 7420 7769 7468 2066 756c   object with ful
+000119f0: 6c20 696d 7065 6461 6e63 6520 7465 6e73  l impedance tens
+00011a00: 6f72 205a 2e20 0d0a 2020 2020 2020 2020  or Z. ..        
+00011a10: 0d0a 2020 2020 2020 2020 6d65 7468 6f64  ..        method
+00011a20: 3a20 7374 7220 0d0a 2020 2020 2020 2020  : str ..        
+00011a30: 2020 2020 4b69 6e64 206f 6620 636f 7272      Kind of corr
+00011a40: 6563 7469 6f6e 2e20 4361 6e20 6265 2060  ection. Can be `
+00011a50: 6073 7769 6674 6060 2066 6f72 2074 6865  `swift`` for the
+00011a60: 2072 656d 6f76 6520 6469 7374 6f72 7369   remove distorsi
+00011a70: 6f6e 2070 726f 706f 7365 6420 0d0a 2020  on proposed ..  
+00011a80: 2020 2020 2020 2020 2020 6279 2053 7769            by Swi
+00011a90: 6674 2069 6e20 3139 3637 2e20 5468 6520  ft in 1967. The 
+00011aa0: 7661 6c75 6520 636c 6f73 6520 746f 2030  value close to 0
+00011ab0: 2e20 6173 7375 6d65 2074 6865 2031 4420  . assume the 1D 
+00011ac0: 616e 6420 3244 2073 7472 7563 7475 7265  and 2D structure
+00011ad0: 7320 0d0a 2020 2020 2020 2020 2020 2020  s ..            
+00011ae0: 616e 6420 3344 206f 7468 6572 7769 7365  and 3D otherwise
+00011af0: 2e20 436f 6e76 6572 736c 7920 746f 2060  . Conversly to `
+00011b00: 6062 6168 7260 6020 666f 7220 7468 6520  `bahr`` for the 
+00011b10: 7265 6d6f 7665 2064 6973 746f 7273 696f  remove distorsio
+00011b20: 6e20 7072 6f70 6f73 6564 2020 0d0a 2020  n proposed  ..  
+00011b30: 2020 2020 2020 2020 2020 6279 2042 6168            by Bah
+00011b40: 7220 696e 2031 3939 312e 2054 6865 206c  r in 1991. The l
+00011b50: 6174 7465 7220 7468 7265 7368 6f6c 6420  atter threshold 
+00011b60: 6973 2073 6574 2074 6f20 302e 332e 2041  is set to 0.3. A
+00011b70: 626f 7665 2074 6869 7320 7661 6c75 6520  bove this value 
+00011b80: 0d0a 2020 2020 2020 2020 2020 2020 7468  ..            th
+00011b90: 6520 7374 7275 6374 7572 6573 2069 7320  e structures is 
+00011ba0: 3344 2e20 0d0a 2020 2020 2020 2020 2020  3D. ..          
+00011bb0: 2020 0d0a 2020 2020 2020 2020 7265 7475    ..        retu
+00011bc0: 726e 5f73 6b65 776e 6573 733a 2073 7472  rn_skewness: str
+00011bd0: 2c20 0d0a 2020 2020 2020 2020 2020 2054  , ..           T
+00011be0: 7970 6963 616c 6c79 2072 6574 7572 6e73  ypically returns
+00011bf0: 2074 6865 2074 7970 6520 6f66 2073 6b65   the type of ske
+00011c00: 776e 6573 732e 2060 6027 736b 6577 2760  wness. ``'skew'`
+00011c10: 6020 6f72 2060 606d 7560 6020 666f 7220  ` or ``mu`` for 
+00011c20: 0d0a 2020 2020 2020 2020 2020 2073 6b65  ..           ske
+00011c30: 7720 616e 6420 726f 7461 7469 6f6e 2d20  w and rotation- 
+00011c40: 616c 6c20 696e 7661 7269 616e 7420 7661  all invariant va
+00011c50: 6c75 6573 2072 6573 7065 6374 6976 656c  lues respectivel
+00011c60: 792e 2041 6e79 206f 7468 6572 200d 0a20  y. Any other .. 
+00011c70: 2020 2020 2020 2020 2020 7661 6c75 6520            value 
+00011c80: 7265 7475 726e 2062 6f74 6820 736b 6577  return both skew
+00011c90: 2061 6e64 2072 6f74 6174 696f 6e61 6c20   and rotational 
+00011ca0: 696e 7661 7269 616e 742e 200d 0a20 0d0a  invariant. .. ..
+00011cb0: 2020 2020 2020 2020 7375 7070 7265 7373          suppress
+00011cc0: 5f6f 7574 6c69 6572 733a 2062 6f6f 6c2c  _outliers: bool,
+00011cd0: 2064 6566 6175 6c74 3d46 616c 7365 2c20   default=False, 
+00011ce0: 0d0a 2020 2020 2020 2020 2020 2052 656d  ..           Rem
+00011cf0: 6f76 6520 7468 6520 6f75 746c 6965 7273  ove the outliers
+00011d00: 2028 6966 2061 7070 6c69 6361 626c 6520   (if applicable 
+00011d10: 696e 2074 6865 2064 6174 6120 2920 6265  in the data ) be
+00011d20: 666f 7265 0d0a 2020 2020 2020 2020 2020  fore..          
+00011d30: 206e 6f72 6d61 6c69 7a69 6e67 2e20 0d0a   normalizing. ..
+00011d40: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00011d50: 2020 2020 2020 2020 2e2e 2076 6572 7369          .. versi
+00011d60: 6f6e 6164 6465 643a 3a20 302e 312e 3620  onadded:: 0.1.6 
+00011d70: 0d0a 2020 2020 2020 2020 2020 200d 0a20  ..           .. 
+00011d80: 2020 2020 2020 2052 6574 7572 6e73 200d         Returns .
+00011d90: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00011da0: 2d2d 200d 0a20 2020 2020 2020 2073 6b77  -- ..        skw
+00011db0: 2c20 6d75 203a 2054 7570 6c65 206f 6620  , mu : Tuple of 
+00011dc0: 6e64 6172 7261 792d 6c69 6b65 202c 2073  ndarray-like , s
+00011dd0: 6861 7065 2028 4e2c 204d 2029 0d0a 2020  hape (N, M )..  
+00011de0: 2020 2020 2020 2020 2020 2d20 4172 7261            - Arra
+00011df0: 7920 6f66 2073 6b65 7720 6174 2065 6163  y of skew at eac
+00011e00: 6820 6672 6571 7565 6e63 7920 0d0a 2020  h frequency ..  
+00011e10: 2020 2020 2020 2020 2020 2d20 726f 7461            - rota
+00011e20: 7469 6f6e 616c 2069 6e76 6172 6961 6e74  tional invariant
+00011e30: 2060 606d 7560 6020 6174 2065 6163 6820   ``mu`` at each 
+00011e40: 6672 6571 7565 6e63 7920 7468 6174 0d0a  frequency that..
+00011e50: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00011e60: 6173 7572 6573 206f 6620 7068 6173 6520  asures of phase 
+00011e70: 6469 6666 6572 656e 6365 7320 696e 2074  differences in t
+00011e80: 6865 2069 6d70 6564 616e 6365 2074 656e  he impedance ten
+00011e90: 736f 722e 200d 0a20 2020 2020 2020 2020  sor. ..         
+00011ea0: 2020 200d 0a20 2020 2020 2020 2053 6565     ..        See
+00011eb0: 2041 6c73 6f0d 0a20 2020 2020 2020 202d   Also..        -
+00011ec0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00011ed0: 2020 7761 7465 782e 7574 696c 732e 706c    watex.utils.pl
+00011ee0: 6f74 5f73 6b65 773a 200d 0a20 2020 2020  ot_skew: ..     
+00011ef0: 2020 2020 2020 2046 6f72 2070 6861 7365         For phase
+00011f00: 2073 656e 7369 7374 6976 6520 736b 6577   sensistive skew
+00011f10: 2076 6973 7561 6c69 7a61 7469 6f6e 202d   visualization -
+00011f20: 206e 6169 7665 2070 6c6f 742e 200d 0a20   naive plot. .. 
+00011f30: 2020 2020 2020 2077 6174 6578 2e76 6965         watex.vie
+00011f40: 772e 5450 6c6f 742e 706c 6f74 536b 6577  w.TPlot.plotSkew
+00011f50: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00011f60: 466f 7220 636f 6e73 6973 7465 6e74 2070  For consistent p
+00011f70: 6c6f 7420 6f66 2070 6861 7365 2073 656e  lot of phase sen
+00011f80: 7369 7469 7665 2073 6b65 7720 7669 7375  sitive skew visu
+00011f90: 616c 697a 6174 696f 6e2e 2041 6c6c 6f77  alization. Allow
+00011fa0: 200d 0a20 2020 2020 2020 2020 2020 2063   ..            c
+00011fb0: 7573 746f 6d69 7a65 2070 6c6f 7473 2e20  ustomize plots. 
+00011fc0: 0d0a 2020 2020 2020 2020 7761 7465 782e  ..        watex.
+00011fd0: 7669 6577 2e54 506c 6f74 2e70 6c6f 745f  view.TPlot.plot_
+00011fe0: 7068 6173 655f 7465 6e73 6f72 733a 200d  phase_tensors: .
+00011ff0: 0a20 2020 2020 2020 2020 2020 2050 6c6f  .            Plo
+00012000: 7420 736b 6577 2061 7320 656c 6c69 7073  t skew as ellips
+00012010: 6973 2076 6973 7561 6c69 7a61 7469 6f6e  is visualization
+00012020: 2062 7920 7475 726e 696e 6720 7468 6520   by turning the 
+00012030: 6074 656e 736f 7260 0d0a 2020 2020 2020  `tensor`..      
+00012040: 2020 2020 2020 7061 7261 6d65 7465 7220        parameter 
+00012050: 746f 2060 6073 6b65 7760 602e 200d 0a0d  to ``skew``. ...
+00012060: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00012070: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00012080: 2d2d 2d0d 0a20 2020 2020 2020 203e 3e3e  ---..        >>>
+00012090: 2066 726f 6d20 7761 7465 782e 6d65 7468   from watex.meth
+000120a0: 6f64 732e 656d 2069 6d70 6f72 7420 5072  ods.em import Pr
+000120b0: 6f63 6573 7369 6e67 200d 0a20 2020 2020  ocessing ..     
+000120c0: 2020 203e 3e3e 2065 6469 7061 7468 203d     >>> edipath =
+000120d0: 2027 6461 7461 2f65 6469 7327 0d0a 2020   'data/edis'..  
+000120e0: 2020 2020 2020 3e3e 3e20 7020 3d20 5072        >>> p = Pr
+000120f0: 6f63 6573 7369 6e67 2829 2e66 6974 2865  ocessing().fit(e
+00012100: 6469 7061 7468 2920 0d0a 2020 2020 2020  dipath) ..      
+00012110: 2020 3e3e 3e20 736b 2c5f 203d 2070 2e73    >>> sk,_ = p.s
+00012120: 6b65 7728 290d 0a20 2020 2020 2020 203e  kew()..        >
+00012130: 3e3e 2073 6b5b 303a 2c20 5d0d 0a20 2020  >> sk[0:, ]..   
+00012140: 2020 2020 202e 2e2e 2061 7272 6179 285b       ... array([
+00012150: 302e 3435 3437 3535 3237 2c20 302e 3738  0.45475527, 0.78
+00012160: 3736 3839 3620 2c20 302e 3434 3938 3633  76896 , 0.449863
+00012170: 3937 5d29 0d0a 2020 2020 2020 2020 0d0a  97])..        ..
+00012180: 2020 2020 2020 2020 5265 6665 7265 6e63          Referenc
+00012190: 6573 200d 0a20 2020 2020 2020 202d 2d2d  es ..        ---
+000121a0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+000121b0: 2020 2020 200d 0a20 2020 2020 2020 2042       ..        B
+000121c0: 6168 722c 204b 2e2c 2031 3939 312e 2047  ahr, K., 1991. G
+000121d0: 656f 6c6f 6769 6361 6c20 6e6f 6973 6520  eological noise 
+000121e0: 696e 206d 6167 6e65 746f 7465 6c6c 7572  in magnetotellur
+000121f0: 6963 2064 6174 613a 2061 2063 6c61 7373  ic data: a class
+00012200: 6966 6963 6174 696f 6e20 0d0a 2020 2020  ification ..    
+00012210: 2020 2020 2020 2020 6f66 2064 6973 746f          of disto
+00012220: 7274 696f 6e20 7479 7065 732e 2050 6879  rtion types. Phy
+00012230: 7369 6373 206f 6620 7468 6520 4561 7274  sics of the Eart
+00012240: 6820 616e 6420 506c 616e 6574 6172 7920  h and Planetary 
+00012250: 496e 7465 7269 6f72 7320 3636 0d0a 2020  Interiors 66..  
+00012260: 2020 2020 2020 2020 2020 2831 e280 9332            (1...2
+00012270: 292c 2032 34e2 8093 3338 2e0d 0a20 2020  ), 24...38...   
+00012280: 2020 2020 2042 6172 6365 6c6f 6e61 2c20       Barcelona, 
+00012290: 482e 2c20 4661 7665 7474 6f2c 2041 2e2c  H., Favetto, A.,
+000122a0: 2050 6572 692c 2056 2e47 2e2c 2050 6f6d   Peri, V.G., Pom
+000122b0: 706f 7369 656c 6c6f 2c20 432e 2c20 556e  posiello, C., Un
+000122c0: 6761 7265 6c6c 692c 2043 2e2c 2032 3031  garelli, C., 201
+000122d0: 332e 0d0a 2020 2020 2020 2020 2020 2020  3...            
+000122e0: 5468 6520 706f 7465 6e74 6961 6c20 6f66  The potential of
+000122f0: 2061 7564 696f 6d61 676e 6574 6f74 656c   audiomagnetotel
+00012300: 6c75 7269 6373 2069 6e20 7468 6520 7374  lurics in the st
+00012310: 7564 7920 6f66 2067 656f 7468 6572 6d61  udy of geotherma
+00012320: 6c20 6669 656c 6473 3a20 0d0a 2020 2020  l fields: ..    
+00012330: 2020 2020 2020 2020 4120 6361 7365 2073          A case s
+00012340: 7475 6479 2066 726f 6d20 7468 6520 6e6f  tudy from the no
+00012350: 7274 6865 726e 2073 6567 6d65 6e74 206f  rthern segment o
+00012360: 6620 7468 6520 4c61 2043 616e 6465 6c61  f the La Candela
+00012370: 7269 6120 5261 6e67 652c 0d0a 2020 2020  ria Range,..    
+00012380: 2020 2020 2020 2020 6e6f 7274 6877 6573          northwes
+00012390: 7465 726e 2041 7267 656e 7469 6e61 2e20  tern Argentina. 
+000123a0: 4a2e 2041 7070 6c2e 2047 656f 7068 7973  J. Appl. Geophys
+000123b0: 2e20 3838 2c20 3833 e280 9339 332e 0d0a  . 88, 83...93...
+000123c0: 2020 2020 2020 2020 2020 2020 6874 7470              http
+000123d0: 733a 2f2f 646f 692e 6f72 672f 3130 2e31  s://doi.org/10.1
+000123e0: 3031 362f 6a2e 6a61 7070 6765 6f2e 3230  016/j.jappgeo.20
+000123f0: 3132 2e31 302e 3030 3420 2020 0d0a 2020  12.10.004   ..  
+00012400: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00012410: 2020 2020 5377 6966 742c 2043 2e2c 2031      Swift, C., 1
+00012420: 3936 372e 2041 206d 6167 6e65 746f 7465  967. A magnetote
+00012430: 6c6c 7572 6963 2069 6e76 6573 7469 6761  lluric investiga
+00012440: 7469 6f6e 206f 6620 616e 2065 6c65 6374  tion of an elect
+00012450: 7269 6361 6c20 636f 6e64 7563 7469 7669  rical conductivi
+00012460: 7479 200d 0a20 2020 2020 2020 2020 2020  ty ..           
+00012470: 616e 6f6d 616c 7920 696e 2074 6865 2073  anomaly in the s
+00012480: 6f75 7468 7765 7374 6572 6e20 556e 6974  outhwestern Unit
+00012490: 6564 2053 7461 7465 732e 2050 682e 442e  ed States. Ph.D.
+000124a0: 2054 6865 7369 732c 204d 4954 2050 7265   Thesis, MIT Pre
+000124b0: 7373 2e20 4361 6d62 7269 6467 652e 200d  ss. Cambridge. .
+000124c0: 0a20 2020 2020 2020 2020 2020 0d0a 2020  .           ..  
+000124d0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
+000124e0: 2020 2020 2073 656c 662e 696e 7370 6563       self.inspec
+000124f0: 7420 0d0a 2020 2020 2020 2020 2020 2020  t ..            
+00012500: 0d0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
+00012510: 6574 686f 6420 3d20 7374 7228 6d65 7468  ethod = str(meth
+00012520: 6f64 292e 6c6f 7765 7228 290d 0a20 2020  od).lower()..   
+00012530: 2020 2020 2069 6620 7365 6c66 2e6d 6574       if self.met
+00012540: 686f 6420 6e6f 7420 696e 2028 2773 7769  hod not in ('swi
+00012550: 6674 272c 2027 6261 6872 2729 3a20 0d0a  ft', 'bahr'): ..
+00012560: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00012570: 6520 5661 6c75 6545 7272 6f72 280d 0a20  e ValueError(.. 
+00012580: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00012590: 2745 7870 6563 7465 6420 6172 6775 6d65  'Expected argume
+000125a0: 6e74 2060 6073 7769 6674 6060 206f 7220  nt ``swift`` or 
+000125b0: 6060 6261 6872 6060 206e 6f74 3a20 7b73  ``bahr`` not: {s
+000125c0: 656c 662e 6d65 7468 6f64 2172 7d27 290d  elf.method!r}').
+000125d0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+000125e0: 2020 2020 2020 2072 6574 7572 6e5f 736b         return_sk
+000125f0: 6577 6e65 7373 3d20 7374 7228 7265 7475  ewness= str(retu
+00012600: 726e 5f73 6b65 776e 6573 7329 2e6c 6f77  rn_skewness).low
+00012610: 6572 2829 200d 0a20 2020 2020 2020 2069  er() ..        i
+00012620: 6620 2028 2027 6d75 2720 696e 2072 6574  f  ( 'mu' in ret
+00012630: 7572 6e5f 736b 6577 6e65 7373 206f 7220  urn_skewness or 
+00012640: 0d0a 2020 2020 2020 2020 2020 2020 2027  ..             '
+00012650: 726f 7427 2069 6e20 7265 7475 726e 5f73  rot' in return_s
+00012660: 6b65 776e 6573 7320 6f72 200d 0a20 2020  kewness or ..   
+00012670: 2020 2020 2020 2020 2020 2769 6e76 6172            'invar
+00012680: 6961 6e74 2720 696e 2072 6574 7572 6e5f  iant' in return_
+00012690: 736b 6577 6e65 7373 293a 200d 0a20 2020  skewness): ..   
+000126a0: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
+000126b0: 736b 6577 6e65 7373 203d 276d 7527 200d  skewness ='mu' .
+000126c0: 0a20 2020 2020 2020 2065 6c69 6620 2773  .        elif 's
+000126d0: 6b65 7727 2069 6e20 7265 7475 726e 5f73  kew' in return_s
+000126e0: 6b65 776e 6573 733a 200d 0a20 2020 2020  kewness: ..     
+000126f0: 2020 2020 2020 2072 6574 7572 6e5f 736b         return_sk
+00012700: 6577 6e65 7373 203d 2773 6b65 7727 0d0a  ewness ='skew'..
+00012710: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00012720: 2020 2020 2020 5a78 783d 2073 656c 662e        Zxx= self.
+00012730: 6d61 6b65 3264 2827 7a78 7827 290d 0a20  make2d('zxx').. 
+00012740: 2020 2020 2020 205a 7879 203d 2073 656c         Zxy = sel
+00012750: 662e 6d61 6b65 3264 2827 7a78 7927 290d  f.make2d('zxy').
+00012760: 0a20 2020 2020 2020 205a 7978 203d 2073  .        Zyx = s
+00012770: 656c 662e 6d61 6b65 3264 2827 7a79 7827  elf.make2d('zyx'
+00012780: 290d 0a20 2020 2020 2020 205a 7979 3d20  )..        Zyy= 
+00012790: 7365 6c66 2e6d 616b 6532 6428 277a 7979  self.make2d('zyy
+000127a0: 2729 0d0a 2020 2020 2020 2020 0d0a 2020  ')..        ..  
+000127b0: 2020 2020 2020 5331 203d 5a78 7820 2b20        S1 =Zxx + 
+000127c0: 5a79 793b 2053 3220 3d20 5a78 7920 2b20  Zyy; S2 = Zxy + 
+000127d0: 5a79 783b 2044 3120 3d5a 7878 2d5a 7979  Zyx; D1 =Zxx-Zyy
+000127e0: 203b 2020 4432 3d20 5a78 792d 5a79 7820   ;  D2= Zxy-Zyx 
+000127f0: 0d0a 2020 2020 2020 2020 4431 5332 203d  ..        D1S2 =
+00012800: 2028 5332 202a 206e 702e 636f 6e6a 2844   (S2 * np.conj(D
+00012810: 3129 292e 696d 6167 203b 2053 3144 3220  1)).imag ; S1D2 
+00012820: 3d20 2844 3220 2a20 6e70 2e63 6f6e 6a28  = (D2 * np.conj(
+00012830: 5331 2929 2e69 6d61 6720 0d0a 2020 2020  S1)).imag ..    
+00012840: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
+00012850: 206d 6574 686f 6420 3d3d 2773 7769 6674   method =='swift
+00012860: 273a 200d 0a20 2020 2020 2020 2020 2020  ': ..           
+00012870: 2073 6b77 203d 206e 702e 6162 7320 2820   skw = np.abs ( 
+00012880: 5331 2020 2f20 4432 2029 2020 0d0a 2020  S1  / D2 )  ..  
+00012890: 2020 2020 2020 656c 7365 203a 200d 0a20        else : .. 
+000128a0: 2020 2020 2020 2020 2020 2073 6b77 203d             skw =
+000128b0: 206e 702e 7371 7274 286e 702e 6162 7328   np.sqrt(np.abs(
+000128c0: 2044 3153 3220 2d20 5331 4432 2929 2f6e   D1S2 - S1D2))/n
+000128d0: 702e 6162 7328 4432 290d 0a20 2020 2020  p.abs(D2)..     
+000128e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000128f0: 206d 7520 3d20 6e70 2e73 7172 7428 6e70   mu = np.sqrt(np
+00012900: 2e61 6273 2844 3153 3229 202b 206e 702e  .abs(D1S2) + np.
+00012910: 6162 7320 2853 3144 3229 292f 206e 702e  abs (S1D2))/ np.
+00012920: 6162 7328 4432 2920 0d0a 2020 2020 2020  abs(D2) ..      
+00012930: 2020 0d0a 2020 2020 2020 2020 6966 2073    ..        if s
+00012940: 7570 7072 6573 735f 6f75 746c 6965 7273  uppress_outliers
+00012950: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00012960: 736b 7720 3d20 7265 6d6f 7665 5f6f 7574  skw = remove_out
+00012970: 6c69 6572 7328 736b 772c 2066 696c 6c5f  liers(skw, fill_
+00012980: 7661 6c75 653d 206e 702e 6e61 6e20 2920  value= np.nan ) 
+00012990: 0d0a 2020 2020 2020 2020 2020 2020 6d75  ..            mu
+000129a0: 203d 2072 656d 6f76 655f 6f75 746c 6965   = remove_outlie
+000129b0: 7273 286d 752c 2066 696c 6c5f 7661 6c75  rs(mu, fill_valu
+000129c0: 653d 206e 702e 6e61 6e20 290d 0a20 2020  e= np.nan )..   
+000129d0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+000129e0: 2020 2073 6b77 203d 206e 6f72 6d61 6c69     skw = normali
+000129f0: 7a65 7228 736b 7729 203b 206d 7520 3d20  zer(skw) ; mu = 
+00012a00: 6e6f 726d 616c 697a 6572 286d 7520 290d  normalizer(mu ).
+00012a10: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00012a20: 2020 2020 2020 2072 6574 7572 6e20 736b         return sk
+00012a30: 7720 6966 2072 6574 7572 6e5f 736b 6577  w if return_skew
+00012a40: 6e65 7373 3d3d 2773 6b65 7727 2065 6c73  ness=='skew' els
+00012a50: 6520 280d 0a20 2020 2020 2020 2020 2020  e (..           
+00012a60: 206d 7520 6966 2072 6574 7572 6e5f 736b   mu if return_sk
+00012a70: 6577 6e65 7373 3d3d 276d 7527 2065 6c73  ewness=='mu' els
+00012a80: 6520 736b 772c 206d 7529 0d0a 2020 200d  e skw, mu)..   .
+00012a90: 0a0d 0a20 2020 2064 6566 207a 7265 7374  ...    def zrest
+00012aa0: 6f72 6528 0d0a 2020 2020 2020 2020 7365  ore(..        se
+00012ab0: 6c66 2c0d 0a20 2020 2020 2020 202a 2c20  lf,..        *, 
+00012ac0: 0d0a 2020 2020 2020 2020 7465 6e73 6f72  ..        tensor
+00012ad0: 3a73 7472 3d4e 6f6e 652c 200d 0a20 2020  :str=None, ..   
+00012ae0: 2020 2020 2063 6f6d 706f 6e65 6e74 3a73       component:s
+00012af0: 7472 3d4e 6f6e 652c 200d 0a20 2020 2020  tr=None, ..     
+00012b00: 2020 2062 7566 6665 723a 2054 7570 6c65     buffer: Tuple
+00012b10: 5b66 6c6f 6174 5d3d 4e6f 6e65 2c20 0d0a  [float]=None, ..
+00012b20: 2020 2020 2020 2020 6d65 7468 6f64 3a73          method:s
+00012b30: 7472 203d 2770 6427 2c0d 0a20 2020 2020  tr ='pd',..     
+00012b40: 2020 202a 2a6b 7773 200d 0a20 2020 2020     **kws ..     
+00012b50: 2020 2029 3a20 0d0a 2020 2020 2020 2020     ): ..        
+00012b60: 2222 2220 4669 7820 7468 6520 7765 616b  """ Fix the weak
+00012b70: 2061 6e64 206d 6973 7369 6e67 2073 6967   and missing sig
+00012b80: 6e61 6c20 6174 2074 6865 2027 6465 6164  nal at the 'dead
+00012b90: 2d62 616e 6460 2d20 616e 6420 7265 636f  -band`- and reco
+00012ba0: 7665 7220 7468 6520 0d0a 2020 2020 2020  ver the ..      
+00012bb0: 2020 6d69 7373 696e 6720 696d 7065 6461    missing impeda
+00012bc0: 6e63 6520 7465 6e73 6f72 2076 616c 7565  nce tensor value
+00012bd0: 732e 200d 0a20 2020 2020 2020 200d 0a20  s. ..        .. 
+00012be0: 2020 2020 2020 2054 6865 2066 756e 6374         The funct
+00012bf0: 696f 6e20 7573 6573 2074 6865 2063 6f6d  ion uses the com
+00012c00: 706c 6574 6520 6672 6571 7565 6e63 7920  plete frequency 
+00012c10: 2866 7265 7175 656e 6379 2077 6974 6820  (frequency with 
+00012c20: 636c 6561 6e20 6461 7461 2920 0d0a 2020  clean data) ..  
+00012c30: 2020 2020 2020 636f 6c6c 6563 7465 6420        collected 
+00012c40: 7468 6f75 6768 6f75 7420 7468 6520 7375  thoughout the su
+00012c50: 7276 6579 2074 6f20 7265 636f 7665 7220  rvey to recover 
+00012c60: 6279 2069 6e74 6572 2f65 7874 7261 706f  by inter/extrapo
+00012c70: 6c61 7469 6e67 2074 6865 200d 0a20 2020  lating the ..   
+00012c80: 2020 2020 206d 6973 7369 6e67 206f 7220       missing or 
+00012c90: 7765 616b 2020 6672 6571 7565 6e63 6965  weak  frequencie
+00012ca0: 7320 7468 6572 6562 7920 7265 7374 6f72  s thereby restor
+00012cb0: 696e 6720 7468 6520 696d 7065 6461 6e63  ing the impedanc
+00012cc0: 6520 7465 6e73 6f72 7320 0d0a 2020 2020  e tensors ..    
+00012cd0: 2020 2020 6174 2074 6861 7420 2764 6561      at that 'dea
+00012ce0: 642d 6261 6e64 272e 204e 6f74 6520 7468  d-band'. Note th
+00012cf0: 6174 2074 6865 2027 6465 6164 2d20 6261  at the 'dead- ba
+00012d00: 6e64 2720 616c 736f 206b 6e6f 776e 2061  nd' also known a
+00012d10: 7320 0d0a 2020 2020 2020 2020 2761 7474  s ..        'att
+00012d20: 656e 7561 7469 6f6e 202d 6261 6e64 2720  enuation -band' 
+00012d30: 6973 2077 6865 7265 2074 6865 2041 4d54  is where the AMT
+00012d40: 2073 6967 6e61 6c20 6973 2077 6561 6b20   signal is weak 
+00012d50: 6f72 2067 656e 6572 616c 6c79 200d 0a20  or generally .. 
+00012d60: 2020 2020 2020 2061 6273 6365 6e74 2e20         abscent. 
+00012d70: 0d0a 200d 0a20 2020 2020 2020 2050 6172  .. ..        Par
+00012d80: 616d 6574 6572 7320 0d0a 2020 2020 2020  ameters ..      
+00012d90: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a    ----------....
+00012da0: 2020 2020 2020 2020 7465 6e73 6f72 3a20          tensor: 
+00012db0: 7374 722c 206f 7074 696f 6e61 6c2c 205b  str, optional, [
+00012dc0: 2272 6573 6973 7469 7669 7479 227c 2270  "resistivity"|"p
+00012dd0: 6861 7365 227c 227a 227c 2266 7265 7175  hase"|"z"|"frequ
+00012de0: 656e 6379 225d 0d0a 2020 2020 2020 2020  ency"]..        
+00012df0: 2020 204e 616d 6520 6f66 2074 6865 203a     Name of the :
+00012e00: 7465 726d 3a60 7465 6e73 6f72 602e 2049  term:`tensor`. I
+00012e10: 6620 7468 6520 6e61 6d65 206f 6620 7465  f the name of te
+00012e20: 6e73 6f72 2069 7320 6769 7665 6e2c 200d  nsor is given, .
+00012e30: 0a20 2020 2020 2020 2020 2020 6675 6e63  .           func
+00012e40: 7469 6f6e 2020 7265 7475 726e 7320 7468  tion  returns th
+00012e50: 6520 7465 6e73 6f72 2076 616c 7565 696e  e tensor valuein
+00012e60: 2074 776f 2d64 696d 656e 7369 6f6e 616c   two-dimensional
+00012e70: 7320 636f 6d70 6f73 6564 200d 0a20 2020  s composed ..   
+00012e80: 2020 2020 2020 2020 6f66 2028 6e5f 6672          of (n_fr
+00012e90: 6571 202c 206e 5f73 6974 6573 2920 7768  eq , n_sites) wh
+00012ea0: 6572 6520 6060 6e5f 6672 6571 3d6e 756d  ere ``n_freq=num
+00012eb0: 6265 7220 6f66 2066 7265 7175 656e 6379  ber of frequency
+00012ec0: 6060 200d 0a20 2020 2020 2020 2020 2020  `` ..           
+00012ed0: 616e 6420 6060 6e5f 7361 7469 6f6e 7360  and ``n_sations`
+00012ee0: 6020 6e75 6d62 6572 206f 6620 7369 7465  ` number of site
+00012ef0: 732e 204e 6f74 6520 7468 6174 2069 6620  s. Note that if 
+00012f00: 7468 6520 7465 6e73 6f72 2069 7320 0d0a  the tensor is ..
+00012f10: 2020 2020 2020 2020 2020 2070 6173 7365             passe
+00012f20: 6420 6173 2062 6f6f 6c65 616e 2076 616c  d as boolean val
+00012f30: 7565 7320 6060 5472 7565 6060 2c20 7468  ues ``True``, th
+00012f40: 6520 6060 7265 7369 7374 6976 6974 7960  e ``resistivity`
+00012f50: 6020 7465 6e73 6f72 2069 7320 0d0a 2020  ` tensor is ..  
+00012f60: 2020 2020 2020 2020 2065 7870 6f72 7465           exporte
+00012f70: 6420 6279 2064 6566 6175 6c74 2061 6e64  d by default and
+00012f80: 2074 6865 2060 6063 6f6d 706f 6e65 6e74   the ``component
+00012f90: 6060 7368 6f75 6c64 2062 6520 7468 6520  ``should be the 
+00012fa0: 636f 6d70 6f6e 656e 7420 0d0a 2020 2020  component ..    
+00012fb0: 2020 2020 2020 2070 6173 7365 6420 746f         passed to
+00012fc0: 203a 636c 6173 733a 6050 726f 6365 7373   :class:`Process
+00012fd0: 696e 6760 2061 7420 696e 6974 6961 6c69  ing` at initiali
+00012fe0: 7a61 7469 6f6e 2e20 0d0a 2020 2020 2020  zation. ..      
+00012ff0: 2020 2020 0d0a 2020 2020 2020 2020 6275      ..        bu
+00013000: 6666 6572 3a20 6c69 7374 205b 6d61 782c  ffer: list [max,
+00013010: 206d 696e 5d20 6672 6571 7565 6e63 7920   min] frequency 
+00013020: 696e 2048 7a0d 0a20 2020 2020 2020 2020  in Hz..         
+00013030: 2020 206c 6973 7420 6f66 206d 6178 696d     list of maxim
+00013040: 756d 2061 6e64 206d 696e 696d 756d 2066  um and minimum f
+00013050: 7265 7175 656e 6369 6573 2e20 4974 206d  requencies. It m
+00013060: 7573 7420 636f 6e74 6169 6e20 6f6e 6c79  ust contain only
+00013070: 2074 776f 200d 0a20 2020 2020 2020 2020   two ..         
+00013080: 2020 2076 616c 7565 732e 2049 6620 604e     values. If `N
+00013090: 6f6e 6560 2c20 7468 6520 6d61 7820 616e  one`, the max an
+000130a0: 6420 6d69 6e20 6f66 2074 6865 2063 6c65  d min of the cle
+000130b0: 616e 2066 7265 7175 656e 6369 6573 2061  an frequencies a
+000130c0: 7265 200d 0a20 2020 2020 2020 2020 2020  re ..           
+000130d0: 2073 656c 6563 7465 642e 204d 6f72 656f   selected. Moreo
+000130e0: 7665 7220 7468 6520 5b6d 696e 2c20 6d61  ver the [min, ma
+000130f0: 785d 2066 7265 7175 656e 6379 2073 686f  x] frequency sho
+00013100: 756c 6420 6e6f 7420 636f 6d70 756c 736f  uld not compulso
+00013110: 7279 200d 0a20 2020 2020 2020 2020 2020  ry ..           
+00013120: 2074 6f20 6669 7420 7468 6520 6672 6571   to fit the freq
+00013130: 7565 6e63 7920 7261 6e67 6520 696e 2074  uency range in t
+00013140: 6865 2064 6174 612e 2054 6865 2067 6976  he data. The giv
+00013150: 656e 2066 7265 7175 656e 6379 2063 616e  en frequency can
+00013160: 200d 0a20 2020 2020 2020 2020 2020 2062   ..            b
+00013170: 6520 696e 7465 7270 6f6c 6174 6564 2074  e interpolated t
+00013180: 6f20 6d61 7463 6820 7468 6520 6265 7374  o match the best
+00013190: 2063 6c6f 7365 7374 2066 7265 7175 656e   closest frequen
+000131a0: 6369 6573 2069 6e20 7468 6520 6461 7461  cies in the data
+000131b0: 2e20 0d0a 2020 2020 2020 0d0a 2020 2020  . ..      ..    
+000131c0: 2020 2020 6d65 7468 6f64 3a20 7374 722c      method: str,
+000131d0: 206f 7074 696f 6e61 6c20 2c20 6465 6661   optional , defa
+000131e0: 756c 743d 2770 6427 200d 0a20 2020 2020  ult='pd' ..     
+000131f0: 2020 2020 2020 204d 6574 686f 6420 6f66         Method of
+00013200: 205a 2069 6e74 6572 706f 6c61 7469 6f6e   Z interpolation
+00013210: 2e20 5573 6520 6060 6261 7365 6060 2066  . Use ``base`` f
+00013220: 6f72 2060 7363 6970 7960 2069 6e74 6572  or `scipy` inter
+00013230: 706f 6c61 7469 6f6e 2c20 0d0a 2020 2020  polation, ..    
+00013240: 2020 2020 2020 2020 6060 6d65 616e 6060          ``mean``
+00013250: 206f 7220 6060 6266 6660 6020 666f 7220   or ``bff`` for 
+00013260: 7363 616c 696e 6720 6d65 7468 6f64 7320  scaling methods 
+00013270: 616e 6420 6060 7064 6060 2066 6f72 2070  and ``pd`` for p
+00013280: 616e 6461 7320 0d0a 2020 2020 2020 2020  andas ..        
+00013290: 2020 2020 696e 7465 7270 6f6c 6174 696f      interpolatio
+000132a0: 6e20 6d65 7468 6f64 732e 204e 6f74 6520  n methods. Note 
+000132b0: 7468 6174 2074 6865 2066 6972 7374 206d  that the first m
+000132c0: 6574 686f 6420 6973 2066 6173 7420 616e  ethod is fast an
+000132d0: 6420 0d0a 2020 2020 2020 2020 2020 2020  d ..            
+000132e0: 6566 6669 6369 656e 7420 7768 656e 2074  efficient when t
+000132f0: 6865 206e 756d 6265 7220 6f66 204e 614e  he number of NaN
+00013300: 2069 6e20 7468 6520 6172 7261 7920 6966   in the array if
+00013310: 2072 656c 6174 6976 656c 7920 6665 772e   relatively few.
+00013320: 200d 0a20 2020 2020 2020 2020 2020 2049   ..            I
+00013330: 7420 6973 206c 6573 7320 6163 6375 7261  t is less accura
+00013340: 7465 2074 6f20 7573 6520 7468 6520 6062  te to use the `b
+00013350: 6173 6560 2069 6e74 6572 706f 6c61 7469  ase` interpolati
+00013360: 6f6e 2077 6865 6e20 7468 6520 6461 7461  on when the data
+00013370: 200d 0a20 2020 2020 2020 2020 2020 2069   ..            i
+00013380: 7320 636f 6d70 6f73 6564 206f 6620 6d61  s composed of ma
+00013390: 6e79 206d 6973 7369 6e67 2076 616c 7565  ny missing value
+000133a0: 732e 2041 6c74 6572 6e61 7469 7665 6c79  s. Alternatively
+000133b0: 2c20 7468 6520 7363 616c 6564 200d 0a20  , the scaled .. 
+000133c0: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+000133d0: 6428 7468 6520 2073 6563 6f6e 6420 6f6e  d(the  second on
+000133e0: 6529 2069 7320 7072 6f70 6f73 6564 2074  e) is proposed t
+000133f0: 6f20 6265 2074 6865 2061 6c74 6572 6e61  o be the alterna
+00013400: 7469 7665 2077 6179 206d 6f72 6520 0d0a  tive way more ..
+00013410: 2020 2020 2020 2020 2020 2020 6566 6669              effi
+00013420: 6369 656e 742e 2049 6e64 6565 642c 2077  cient. Indeed, w
+00013430: 6865 6e20 6060 6d65 616e 6060 2061 7267  hen ``mean`` arg
+00013440: 756d 656e 7420 6973 2073 6574 2c20 6675  ument is set, fu
+00013450: 6e63 7469 6f6e 2072 6570 6c61 6365 7320  nction replaces 
+00013460: 0d0a 2020 2020 2020 2020 2020 2020 7468  ..            th
+00013470: 6520 4e61 4e20 7661 6c75 6573 2062 7920  e NaN values by 
+00013480: 7468 6520 6e6f 6e7a 6572 6f73 2069 6e20  the nonzeros in 
+00013490: 7468 6520 7261 7720 6172 7261 7920 616e  the raw array an
+000134a0: 6420 7468 656e 2075 7365 7320 7468 6520  d then uses the 
+000134b0: 0d0a 2020 2020 2020 2020 2020 2020 6d65  ..            me
+000134c0: 616e 2074 6f20 6669 7420 7468 6520 6461  an to fit the da
+000134d0: 7461 2e20 5468 6520 7265 7375 6c74 206f  ta. The result o
+000134e0: 6620 6669 7474 696e 6720 6372 6561 7465  f fitting create
+000134f0: 7320 6120 736d 6f6f 7468 2063 7572 7665  s a smooth curve
+00013500: 200d 0a20 2020 2020 2020 2020 2020 2077   ..            w
+00013510: 6865 7265 2074 6865 2069 6e64 6578 206f  here the index o
+00013520: 6620 6561 6368 204e 614e 2069 6e20 7468  f each NaN in th
+00013530: 6520 7261 7720 6172 7261 7920 6973 2072  e raw array is r
+00013540: 6570 6c61 6365 6420 6279 2069 7473 200d  eplaced by its .
+00013550: 0a20 2020 2020 2020 2020 2020 2063 6f72  .            cor
+00013560: 7265 7370 6f6e 6469 6e67 2076 616c 7565  responding value
+00013570: 7320 696e 2074 6865 2066 6974 2072 6573  s in the fit res
+00013580: 756c 7473 2e20 5468 6520 7361 6d65 2061  ults. The same a
+00013590: 7070 726f 6163 6820 6973 2075 7365 6420  pproach is used 
+000135a0: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+000135b0: 7220 6060 6266 6660 6020 6d65 7468 6f64  r ``bff`` method
+000135c0: 2e20 436f 6e76 6572 7365 6c79 2c20 7261  . Conversely, ra
+000135d0: 7468 6572 2074 6861 6e20 6176 6572 6167  ther than averag
+000135e0: 696e 6720 7468 6520 6e6f 6e7a 6572 6f73  ing the nonzeros
+000135f0: 200d 0a20 2020 2020 2020 2020 2020 2076   ..            v
+00013600: 616c 7565 732c 2069 7420 7573 6573 2074  alues, it uses t
+00013610: 6865 2062 6163 6b77 6172 6420 616e 6420  he backward and 
+00013620: 666f 7277 6172 6420 7374 7261 7465 6779  forward strategy
+00013630: 2020 746f 2066 696c 6c20 7468 6520 0d0a    to fill the ..
+00013640: 2020 2020 2020 2020 2020 2020 4e61 4e20              NaN 
+00013650: 6265 666f 7265 2073 6361 6c69 6e67 2e20  before scaling. 
+00013660: 6060 6d65 616e 6060 2061 6e64 2060 6062  ``mean`` and ``b
+00013670: 6666 6060 2061 7265 206d 6f72 6520 6566  ff`` are more ef
+00013680: 6669 6369 656e 7420 7768 656e 200d 0a20  ficient when .. 
+00013690: 2020 2020 2020 2020 2020 2074 6865 2064             the d
+000136a0: 6174 6120 6172 6520 636f 6d70 6f73 6564  ata are composed
+000136b0: 206f 6620 6120 6c6f 7420 6f66 206d 6973   of a lot of mis
+000136c0: 7369 6e67 2076 616c 7565 732e 2057 6865  sing values. Whe
+000136d0: 6e20 7468 6520 0d0a 2020 2020 2020 2020  n the ..        
+000136e0: 2020 2020 696e 7465 7270 6f6c 6174 696f      interpolatio
+000136f0: 6e20 606d 6574 686f 6460 2069 7320 7365  n `method` is se
+00013700: 7420 746f 2060 6070 6460 602c 2066 756e  t to ``pd``, fun
+00013710: 6374 696f 6e20 7573 6573 2074 6865 2070  ction uses the p
+00013720: 616e 6461 7320 0d0a 2020 2020 2020 2020  andas ..        
+00013730: 2020 2020 696e 7465 7270 6f6c 6174 696f      interpolatio
+00013740: 6e20 6275 7420 656e 6465 6420 7468 6520  n but ended the 
+00013750: 696e 7465 7270 6f6c 6174 696f 6e20 7769  interpolation wi
+00013760: 7468 2066 6f72 7761 7264 2f62 6163 6b77  th forward/backw
+00013770: 6172 6420 0d0a 2020 2020 2020 2020 2020  ard ..          
+00013780: 2020 4e61 4e20 6669 6c6c 696e 6720 7369    NaN filling si
+00013790: 6e63 6520 7468 6520 696e 7465 7270 6f6c  nce the interpol
+000137a0: 6174 696f 6e20 7769 7468 2070 616e 6461  ation with panda
+000137b0: 7320 646f 6573 206e 6f74 2064 6561 6c20  s does not deal 
+000137c0: 7769 7468 200d 0a20 2020 2020 2020 2020  with ..         
+000137d0: 2020 2061 6c6c 204e 614e 2061 7420 7468     all NaN at th
+000137e0: 6520 6265 6769 6e69 6e67 206f 7220 6174  e begining or at
+000137f0: 2074 6865 2065 6e64 206f 6620 7468 6520   the end of the 
+00013800: 6172 7261 792e 200d 0a20 2020 2020 2020  array. ..       
+00013810: 2020 2020 200d 0a20 2020 2020 2020 2066       ..        f
+00013820: 696c 6c5f 7661 6c75 653a 2061 7272 6179  ill_value: array
+00013830: 2d6c 696b 652c 2073 7472 2c20 6f70 7469  -like, str, opti
+00013840: 6f6e 616c 2c20 6465 6661 756c 743d 2765  onal, default='e
+00013850: 7874 7261 706f 6c61 7465 272c 200d 0a20  xtrapolate', .. 
+00013860: 2020 2020 2020 2020 2020 2049 6620 6120             If a 
+00013870: 6e64 6172 7261 7920 286f 7220 666c 6f61  ndarray (or floa
+00013880: 7429 2c20 7468 6973 2076 616c 7565 2077  t), this value w
+00013890: 696c 6c20 6265 2075 7365 6420 746f 2066  ill be used to f
+000138a0: 696c 6c20 696e 2066 6f72 200d 0a20 2020  ill in for ..   
+000138b0: 2020 2020 2020 2020 2072 6571 7565 7374           request
+000138c0: 6564 2070 6f69 6e74 7320 6f75 7473 6964  ed points outsid
+000138d0: 6520 6f66 2074 6865 2064 6174 6120 7261  e of the data ra
+000138e0: 6e67 652e 2049 6620 6e6f 7420 7072 6f76  nge. If not prov
+000138f0: 6964 6564 2c20 0d0a 2020 2020 2020 2020  ided, ..        
+00013900: 2020 2020 7468 656e 2074 6865 2064 6566      then the def
+00013910: 6175 6c74 2069 7320 4e61 4e2e 2054 6865  ault is NaN. The
+00013920: 2061 7272 6179 2d6c 696b 6520 6d75 7374   array-like must
+00013930: 2062 726f 6164 6361 7374 2070 726f 7065   broadcast prope
+00013940: 726c 7920 0d0a 2020 2020 2020 2020 2020  rly ..          
+00013950: 2020 746f 2074 6865 2064 696d 656e 7369    to the dimensi
+00013960: 6f6e 7320 6f66 2074 6865 2020 6e6f 6e2d  ons of the  non-
+00013970: 696e 7465 7270 6f6c 6174 696f 6e20 6178  interpolation ax
+00013980: 6573 2e20 4966 2074 776f 2d65 6c65 6d65  es. If two-eleme
+00013990: 6e74 200d 0a20 2020 2020 2020 2020 2020  nt ..           
+000139a0: 2069 6e20 7475 706c 652c 2074 6865 6e20   in tuple, then 
+000139b0: 7468 6520 6669 7273 7420 656c 656d 656e  the first elemen
+000139c0: 7420 6973 2075 7365 6420 6173 2061 2066  t is used as a f
+000139d0: 696c 6c20 7661 6c75 650d 0a20 2020 2020  ill value..     
+000139e0: 2020 2020 2020 2066 6f72 2060 6078 5f6e         for ``x_n
+000139f0: 6577 203c 2078 5b30 5d60 6020 616e 6420  ew < x[0]`` and 
+00013a00: 7468 6520 7365 636f 6e64 2065 6c65 6d65  the second eleme
+00013a10: 6e74 2069 7320 7573 6564 2066 6f72 200d  nt is used for .
+00013a20: 0a20 2020 2020 2020 2020 2020 2060 6078  .            ``x
+00013a30: 5f6e 6577 203e 2078 5b2d 315d 6060 2e20  _new > x[-1]``. 
+00013a40: 416e 7974 6869 6e67 2074 6861 7420 6973  Anything that is
+00013a50: 206e 6f74 2061 2032 2d65 6c65 6d65 6e74   not a 2-element
+00013a60: 2074 7570 6c65 200d 0a20 2020 2020 2020   tuple ..       
+00013a70: 2020 2020 2028 652e 672e 2c20 6c69 7374       (e.g., list
+00013a80: 206f 7220 6e64 6172 7261 792c 7265 6761   or ndarray,rega
+00013a90: 7264 6c65 7373 206f 6620 7368 6170 6529  rdless of shape)
+00013aa0: 2069 7320 7461 6b65 6e20 746f 2062 6520   is taken to be 
+00013ab0: 6120 0d0a 2020 2020 2020 2020 2020 2020  a ..            
+00013ac0: 7369 6e67 6c65 2061 7272 6179 2d6c 696b  single array-lik
+00013ad0: 6520 6172 6775 6d65 6e74 206d 6561 6e74  e argument meant
+00013ae0: 2074 6f20 6265 2075 7365 6420 666f 7220   to be used for 
+00013af0: 626f 7468 2062 6f75 6e64 7320 6173 200d  both bounds as .
+00013b00: 0a20 2020 2020 2020 2020 2020 2062 656c  .            bel
+00013b10: 6f77 2c20 6162 6f76 6520 3d20 6669 6c6c  ow, above = fill
+00013b20: 5f76 616c 7565 2c20 6669 6c6c 5f76 616c  _value, fill_val
+00013b30: 7565 2e20 5573 696e 6720 6120 7477 6f2d  ue. Using a two-
+00013b40: 656c 656d 656e 7420 7475 706c 6520 0d0a  element tuple ..
+00013b50: 2020 2020 2020 2020 2020 2020 6f72 206e              or n
+00013b60: 6461 7272 6179 2072 6571 7569 7265 7320  darray requires 
+00013b70: 6060 626f 756e 6473 5f65 7272 6f72 3d46  ``bounds_error=F
+00013b80: 616c 7365 6060 2e0d 0a20 2020 2020 2020  alse``...       
+00013b90: 2020 2020 200d 0a20 2020 2020 2020 206b       ..        k
+00013ba0: 7773 3a20 6469 6374 200d 0a20 2020 2020  ws: dict ..     
+00013bb0: 2020 2020 2020 2041 6464 6974 696f 6e61         Additiona
+00013bc0: 6c20 6b65 7977 6f72 6420 6172 6775 6d65  l keyword argume
+00013bd0: 6e74 7320 6672 6f6d 203a 6675 6e63 3a60  nts from :func:`
+00013be0: 7e69 6e74 6572 706f 6c61 7465 3164 602e  ~interpolate1d`.
+00013bf0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00013c00: 2020 2020 2052 6574 7572 6e73 200d 0a20       Returns .. 
+00013c10: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0d         --------.
+00013c20: 0a20 2020 2020 2020 2020 2020 2041 7272  .            Arr
+00013c30: 6179 2d6c 696b 6520 6f66 203a 636c 6173  ay-like of :clas
+00013c40: 733a 6077 6174 6578 2e65 7874 6572 6e61  s:`watex.externa
+00013c50: 6c2e 7a2e 5a60 206f 626a 6563 7473 200d  l.z.Z` objects .
+00013c60: 0a20 2020 2020 2020 2020 2020 2041 7272  .            Arr
+00013c70: 6179 2063 6f6c 6c65 6374 696f 6e20 6f66  ay collection of
+00013c80: 206e 6577 205a 2069 6d70 6564 616e 6365   new Z impedance
+00013c90: 7320 6f62 6a65 6374 7320 7769 7468 2064  s objects with d
+00013ca0: 6561 642d 6261 6e64 2074 656e 736f 7220  ead-band tensor 
+00013cb0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00013cc0: 636f 7665 7265 642e 203a 636c 6173 733a  covered. :class:
+00013cd0: 6077 6174 6578 2e65 7874 6572 6e61 6c73  `watex.externals
+00013ce0: 2e7a 2e2e 5a60 2061 7265 206e 6461 7272  .z..Z` are ndarr
+00013cf0: 6179 2028 6e66 7265 712c 2032 2c20 3229  ay (nfreq, 2, 2)
+00013d00: 2e20 0d0a 2020 2020 2020 2020 2020 2020  . ..            
+00013d10: 3278 3220 6d61 7472 6963 6573 2066 6f72  2x2 matrices for
+00013d20: 2063 6f6d 706f 6e65 6e74 7320 7878 2c20   components xx, 
+00013d30: 7879 2061 6e64 2079 782c 2079 792e 2049  xy and yx, yy. I
+00013d40: 6620 7465 6e73 6f72 2067 6976 656e 2c20  f tensor given, 
+00013d50: 0d0a 2020 2020 2020 2020 2020 2020 6974  ..            it
+00013d60: 2072 6574 7572 6e73 2061 2063 6f6c 6c65   returns a colle
+00013d70: 6374 696f 6e20 6f66 2032 4420 7465 6e73  ction of 2D tens
+00013d80: 6f72 206f 6620 6561 6368 2073 7461 7469  or of each stati
+00013d90: 6f6e 732e 200d 0a20 2020 200d 0a20 2020  ons. ..    ..   
+00013da0: 2020 2020 204d 6f72 6520 0d0a 2020 2020       More ..    
+00013db0: 2020 2020 2d2d 2d2d 2d2d 0d0a 2020 2020      ------..    
+00013dc0: 2020 2020 4f6e 6520 6d61 696e 2070 726f      One main pro
+00013dd0: 626c 656d 2069 6e20 636f 6c6c 6563 7469  blem in collecti
+00013de0: 6e67 207c 4e53 414d 547c 2064 6174 6120  ng |NSAMT| data 
+00013df0: 6973 2074 6865 2073 6967 6e61 6c20 6c65  is the signal le
+00013e00: 7665 6c20 696e 2074 6865 200d 0a20 2020  vel in the ..   
+00013e10: 2020 2020 2027 6174 7465 6e75 6174 696f       'attenuatio
+00013e20: 6e20 6261 6e64 272e 2043 6f6d 7061 7265  n band'. Compare
+00013e30: 6420 746f 2074 6865 207c 4353 414d 547c  d to the |CSAMT|
+00013e40: 206d 6574 686f 6420 2857 616e 6720 616e   method (Wang an
+00013e50: 6420 5461 6e2c 2032 3031 373b 200d 0a20  d Tan, 2017; .. 
+00013e60: 2020 2020 2020 205a 6f6e 6765 2061 6e64         Zonge and
+00013e70: 2048 7567 6865 732c 2031 3939 3129 2c74   Hughes, 1991),t
+00013e80: 6865 206e 6174 7572 616c 2073 6967 6e61  he natural signa
+00013e90: 6c73 2061 7265 206e 6f74 2075 6e64 6572  ls are not under
+00013ea0: 206f 7572 2063 6f6e 7472 6f6c 200d 0a20   our control .. 
+00013eb0: 2020 2020 2020 2061 6e64 2073 7566 6665         and suffe
+00013ec0: 7220 6672 6f6d 2066 7265 7175 656e 6379  r from frequency
+00013ed0: 2020 7261 6e67 6573 2077 6974 6820 6c69    ranges with li
+00013ee0: 7474 6c65 206f 7220 6e6f 2073 6967 6e61  ttle or no signa
+00013ef0: 6c2e 2020 4d6f 7374 200d 0a20 2020 2020  l.  Most ..     
+00013f00: 2020 206e 6f74 6162 6c79 2c20 7468 6520     notably, the 
+00013f10: 7c4e 5341 4d54 7c20 2764 6561 642d 6261  |NSAMT| 'dead-ba
+00013f20: 6e64 2720 6265 7477 6565 6e20 6170 7072  nd' between appr
+00013f30: 6f78 696d 6174 656c 7920 3120 6b48 7a20  oximately 1 kHz 
+00013f40: 616e 6420 3420 0d0a 2020 2020 2020 2020  and 4 ..        
+00013f50: 6b48 7a2c 2062 7574 2061 6c73 6f20 6120  kHz, but also a 
+00013f60: 7369 676e 616c 206c 6f77 2069 6e20 7468  signal low in th
+00013f70: 6520 7669 6369 6e69 7479 6f66 2031 2048  e vicinityof 1 H
+00013f80: 7a20 7768 6572 6520 7468 6520 7472 616e  z where the tran
+00013f90: 7369 7469 6f6e 200d 0a20 2020 2020 2020  sition ..       
+00013fa0: 2074 6f20 6d61 676e 6574 6f73 7068 6572   to magnetospher
+00013fb0: 6963 2065 6e65 7267 7920 736f 7572 6365  ic energy source
+00013fc0: 7320 6f63 6375 7273 2028 476f 6c64 616b  s occurs (Goldak
+00013fd0: 2061 6e64 204f 6c73 6f6e 2c20 3230 3135   and Olson, 2015
+00013fe0: 292e 200d 0a20 2020 2020 2020 2049 6e20  ). ..        In 
+00013ff0: 7468 6973 2062 616e 642c 206e 6174 7572  this band, natur
+00014000: 616c 2073 6f75 7263 6520 7369 676e 616c  al source signal
+00014010: 7320 6172 6520 6765 6e65 7261 6c6c 7920  s are generally 
+00014020: 2061 6273 656e 742e 2054 6865 2045 4d20   absent. The EM 
+00014030: 0d0a 2020 2020 2020 2020 656e 6572 6779  ..        energy
+00014040: 2069 7320 6469 7373 6970 6174 6564 2061   is dissipated a
+00014050: 6e64 206f 6674 656e 2063 756c 7475 7261  nd often cultura
+00014060: 6c20 7c45 4d7c 206e 6f69 7365 2066 696c  l |EM| noise fil
+00014070: 6c73 2074 6865 2067 6170 200d 0a20 2020  ls the gap ..   
+00014080: 2020 2020 2028 5a6f 6e67 652c 2032 3030       (Zonge, 200
+00014090: 3029 2e20 5468 6520 7265 7370 6f6e 7365  0). The response
+000140a0: 2069 7320 6578 7472 6170 6f6c 6174 6564   is extrapolated
+000140b0: 2066 726f 6d20 7265 7375 6c74 7320 6f62   from results ob
+000140c0: 7365 7276 6564 200d 0a20 2020 2020 2020  served ..       
+000140d0: 2074 6f70 2066 7265 7175 656e 6369 6573   top frequencies
+000140e0: 2820 466f 7220 696e 7374 616e 6365 2061  ( For instance a
+000140f0: 7420 3230 2c20 3430 2c20 3235 302c 2061  t 20, 40, 250, a
+00014100: 6e64 2035 3030 2048 7a29 2e45 7870 6572  nd 500 Hz).Exper
+00014110: 6965 6e63 650d 0a20 2020 2020 2020 2069  ience..        i
+00014120: 6e64 6963 6174 6573 2074 6861 7420 7468  ndicates that th
+00014130: 6520 6e61 7475 7261 6c20 736f 7572 6365  e natural source
+00014140: 2073 6967 6e61 6c20 6c65 7665 6c20 6174   signal level at
+00014150: 2032 3030 3020 487a 2063 616e 2062 6520   2000 Hz can be 
+00014160: 0d0a 2020 2020 2020 2020 6578 7065 6374  ..        expect
+00014170: 6564 2074 6f20 6170 7072 6f61 6368 2031  ed to approach 1
+00014180: 302d 3620 ceb3 2fe2 889a 487a 2028 5a68  0-6 ../...Hz (Zh
+00014190: 656e 672c 2032 3031 303b 205a 6f6e 6765  eng, 2010; Zonge
+000141a0: 2c20 3230 3030 292e 0d0a 2020 2020 2020  , 2000)...      
+000141b0: 2020 0d0a 2020 2020 2020 2020 5365 6520    ..        See 
+000141c0: 416c 736f 0d0a 2020 2020 2020 2020 2d2d  Also..        --
+000141d0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+000141e0: 2020 7363 6970 792e 696e 7465 7270 6f6c    scipy.interpol
+000141f0: 6174 652e 696e 7465 7270 3164 3a20 0d0a  ate.interp1d: ..
+00014200: 2020 2020 2020 2020 2020 2020 496e 7465              Inte
+00014210: 7270 6f6c 6174 6520 3144 2e20 0d0a 2020  rpolate 1D. ..  
+00014220: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00014230: 2020 2020 5265 6665 7265 6e63 6573 200d      References .
+00014240: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00014250: 2d2d 2d0d 0a20 2020 2020 2020 2047 6f6c  ---..        Gol
+00014260: 6461 6b2c 2044 2e4b 2e2c 204f 6c73 6f6e  dak, D.K., Olson
+00014270: 2c20 522e 572e 2c20 3230 3135 2e20 4e65  , R.W., 2015. Ne
+00014280: 7720 6465 7665 6c6f 706d 656e 7473 2069  w developments i
+00014290: 6e20 7c41 4d54 7c20 6578 706c 6f72 6174  n |AMT| explorat
+000142a0: 696f 6ee2 80af 3a0d 0a20 2020 2020 2020  ion...:..       
+000142b0: 2020 2020 2043 6173 6520 7374 7564 7920       Case study 
+000142c0: 6672 6f6d 2044 6172 6e6c 6579 2042 6179  from Darnley Bay
+000142d0: 2e20 4353 4547 2052 6563 2e20 3232 e280  . CSEG Rec. 22..
+000142e0: 9332 372e 0d0a 2020 2020 2020 2020 5761  .27...        Wa
+000142f0: 6e67 2c20 4b2e 2c20 5461 6e2c 2048 2e2c  ng, K., Tan, H.,
+00014300: 2032 3031 372e 2052 6573 6561 7263 6820   2017. Research 
+00014310: 6f6e 2074 6865 2066 6f72 7761 7264 206d  on the forward m
+00014320: 6f64 656c 696e 6720 6f66 207c 4353 414d  odeling of |CSAM
+00014330: 547c 2069 6e20 0d0a 2020 2020 2020 2020  T| in ..        
+00014340: 2020 2020 7468 7265 652d 6469 6d65 6e73      three-dimens
+00014350: 696f 6e61 6c20 6178 6961 6c20 616e 6973  ional axial anis
+00014360: 6f74 726f 7069 6320 6d65 6469 612e 204a  otropic media. J
+00014370: 2e20 4170 706c 2e20 4765 6f70 6879 732e  . Appl. Geophys.
+00014380: 2031 3436 2c20 3237 e280 9333 362e 0d0a   146, 27...36...
+00014390: 2020 2020 2020 2020 2020 2020 6874 7470              http
+000143a0: 733a 2f2f 646f 692e 6f72 672f 3130 2e31  s://doi.org/10.1
+000143b0: 3031 362f 6a2e 6a61 7070 6765 6f2e 3230  016/j.jappgeo.20
+000143c0: 3137 2e30 382e 3030 370d 0a20 2020 2020  17.08.007..     
+000143d0: 2020 205a 6f6e 6765 2c20 492e 2c20 3230     Zonge, I., 20
+000143e0: 3030 2e20 7c4e 5341 4d54 7c20 496d 6167  00. |NSAMT| Imag
+000143f0: 696e 672e 2033 3332 3220 4561 7374 2046  ing. 3322 East F
+00014400: 6f72 7420 4c6f 7765 6c6c 2052 6f61 642c  ort Lowell Road,
+00014410: 2054 7563 736f 6e2c 2041 5a20 3835 3731   Tucson, AZ 8571
+00014420: 3620 5553 412e 200d 0a20 2020 2020 2020  6 USA. ..       
+00014430: 205a 6f6e 6765 2c20 4c2e 2c20 4875 6768   Zonge, L., Hugh
+00014440: 6573 2c20 4c2e 4a2e 2c20 3139 3931 2e20  es, L.J., 1991. 
+00014450: 7c43 5341 4d54 7c2e 2053 6f63 2e20 4578  |CSAMT|. Soc. Ex
+00014460: 706c 6f72 2e20 4765 6f70 6879 732e 2032  plor. Geophys. 2
+00014470: 2c20 3731 33e2 8093 3830 392e 0d0a 2020  , 713...809...  
+00014480: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00014490: 2020 2045 7861 6d70 6c65 7320 0d0a 2020     Examples ..  
+000144a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a        --------..
+000144b0: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+000144c0: 7274 206e 756d 7079 2061 7320 6e70 200d  rt numpy as np .
+000144d0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+000144e0: 6f72 7420 6d61 7470 6c6f 746c 6962 2e70  ort matplotlib.p
+000144f0: 7970 6c6f 7420 6173 2070 6c74 200d 0a20  yplot as plt .. 
+00014500: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00014510: 7761 7465 782e 6d65 7468 6f64 732e 656d  watex.methods.em
+00014520: 2069 6d70 6f72 7420 5072 6f63 6573 7369   import Processi
+00014530: 6e67 0d0a 2020 2020 2020 2020 3e3e 3e20  ng..        >>> 
+00014540: 7061 7468 3265 6469 203d 2027 6461 7461  path2edi = 'data
+00014550: 2f65 6469 7327 0d0a 2020 2020 2020 2020  /edis'..        
+00014560: 3e3e 3e20 704f 626a 733d 2050 726f 6365  >>> pObjs= Proce
+00014570: 7373 696e 6728 292e 6669 7428 7061 7468  ssing().fit(path
+00014580: 3265 6469 290d 0a20 2020 2020 2020 203e  2edi)..        >
+00014590: 3e3e 2023 204f 6e65 2063 616e 2073 7065  >> # One can spe
+000145a0: 6369 6679 2074 6865 2066 7265 7175 656e  cify the frequen
+000145b0: 6379 2062 7566 6665 7220 6c69 6b65 2074  cy buffer like t
+000145c0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+000145d0: 2c20 486f 7765 7665 7220 0d0a 2020 2020  , However ..    
+000145e0: 2020 2020 3e3e 3e20 2320 6974 2069 7320      >>> # it is 
+000145f0: 6e6f 7420 6e65 6365 7373 6172 6179 2061  not necessaray a
+00014600: 7420 6c65 6173 7420 7468 6572 6520 6973  t least there is
+00014610: 2061 2061 2073 7065 6369 6669 6320 7265   a a specific re
+00014620: 6173 6f6e 2074 6f20 6669 7820 7468 6520  ason to fix the 
+00014630: 6672 6571 7565 6e63 6965 7320 0d0a 2020  frequencies ..  
+00014640: 2020 2020 2020 3e3e 3e20 6275 6666 6572        >>> buffer
+00014650: 203d 205b 312e 3435 3030 3065 2b30 342c   = [1.45000e+04,
+00014660: 312e 3131 3530 3065 2b30 315d 0d0a 2020  1.11500e+01]..  
+00014670: 2020 2020 2020 3e3e 3e20 7a6f 626a 735f        >>> zobjs_
+00014680: 6220 3d20 2070 4f62 6a73 2e7a 7265 7374  b =  pObjs.zrest
+00014690: 6f72 6528 6275 6666 6572 203d 2062 7566  ore(buffer = buf
+000146a0: 6665 720d 0a20 2020 2020 2020 2020 2020  fer..           
 000146b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000146c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146d0: 2020 2020 2020 2029 2023 2077 6974 6820         ) # with 
-000146e0: 6275 6666 6572 200d 0a20 2020 2020 2020  buffer ..       
-000146f0: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
-00014700: 2020 2020 2020 2020 7365 6c66 2e69 6e73          self.ins
-00014710: 7065 6374 200d 0a0d 0a20 2020 2020 2020  pect ....       
-00014720: 2023 2067 6574 2074 6865 2066 7265 7175   # get the frequ
-00014730: 656e 6369 6573 206f 626a 200d 0a20 2020  encies obj ..   
-00014740: 2020 2020 207a 4f62 6a73 203d 206e 702e       zObjs = np.
-00014750: 6172 7261 7920 286c 6973 7428 6d61 7028  array (list(map(
-00014760: 6c61 6d62 6461 206f 3a20 6f2e 5a2c 2073  lambda o: o.Z, s
-00014770: 656c 662e 6564 694f 626a 735f 2929 202c  elf.ediObjs_)) ,
-00014780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00014790: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-000147a0: 6520 3d6f 626a 6563 7429 200d 0a20 2020  e =object) ..   
-000147b0: 2020 2020 2023 7265 6164 2061 6c6c 2066       #read all f
-000147c0: 7265 7175 656e 6379 206c 656e 6774 6820  requency length 
-000147d0: 616e 6420 7461 6b65 2074 6865 206d 6178  and take the max
-000147e0: 2066 7265 7175 656e 6379 200d 0a20 2020   frequency ..   
-000147f0: 2020 2020 2023 206b 6e6f 776e 2020 6173       # known  as
-00014800: 2074 6865 2063 6f6d 706c 6574 6520 6672   the complete fr
-00014810: 6571 7565 6e63 6965 7320 2820 5468 6174  equencies ( That
-00014820: 2063 6f6d 706f 7365 2061 6c6c 2076 616c   compose all val
-00014830: 7565 7329 0d0a 2020 2020 2020 2020 6672  ues)..        fr
-00014840: 6571 7369 7a65 203d 206e 702e 6172 7261  eqsize = np.arra
-00014850: 7920 286c 6973 7420 286d 6170 2028 6c61  y (list (map (la
-00014860: 6d62 6461 206f 3a6c 656e 286f 2e5f 6672  mbda o:len(o._fr
-00014870: 6571 292c 207a 4f62 6a73 2929 290d 0a20  eq), zObjs))).. 
-00014880: 2020 2020 2020 2069 785f 6d61 7820 203d         ix_max  =
-00014890: 206e 702e 6172 676d 6178 2866 7265 7173   np.argmax(freqs
-000148a0: 697a 6529 0d0a 2020 2020 2020 2020 2320  ize)..        # 
-000148b0: 6765 7420 7468 6520 636f 6d70 6c65 7465  get the complete
-000148c0: 2066 7265 7120 0d0a 2020 2020 2020 2020   freq ..        
-000148d0: 6366 7265 7120 3d20 7a4f 626a 735b 6978  cfreq = zObjs[ix
-000148e0: 5f6d 6178 5d2e 5f66 7265 7120 200d 0a20  _max]._freq  .. 
-000148f0: 2020 2020 2020 2023 2063 6f6e 7472 6f6c         # control
-00014900: 2074 6865 2062 7566 6665 7220 616e 6420   the buffer and 
-00014910: 6765 7420 7468 6520 7468 6520 7261 6e67  get the the rang
-00014920: 6520 6f66 2066 7265 7175 656e 6379 200d  e of frequency .
-00014930: 0a20 2020 2020 2020 2062 7566 6665 7220  .        buffer 
-00014940: 3d20 7365 6c66 2e63 6f6e 7472 6f6c 4672  = self.controlFr
-00014950: 6571 7565 6e63 7942 7566 6665 7228 6366  equencyBuffer(cf
-00014960: 7265 712c 2062 7566 6665 7229 0d0a 2020  req, buffer)..  
-00014970: 2020 2020 2020 6978 5f62 7566 2c20 203d        ix_buf,  =
-00014980: 206e 702e 7768 6572 6520 2820 6e70 2e69   np.where ( np.i
-00014990: 7369 6e20 2863 6672 6571 2c20 6275 6666  sin (cfreq, buff
-000149a0: 6572 2929 200d 0a20 2020 2020 2020 2023  er)) ..        #
-000149b0: 2320 696e 6465 7820 666f 7220 736c 6963  # index for slic
-000149c0: 6520 7468 6520 6172 7261 7920 696e 2074  e the array in t
-000149d0: 6865 2063 6173 6520 7468 6520 6275 6666  he case the buff
-000149e0: 6572 2069 7320 7365 7420 0d0a 2020 2020  er is set ..    
-000149f0: 2020 2020 6978 5f73 202c 2069 785f 656e      ix_s , ix_en
-00014a00: 6420 3d20 6978 5f62 7566 203b 2069 785f  d = ix_buf ; ix_
-00014a10: 656e 6420 2b3d 2031 200d 0a20 2020 2020  end += 1 ..     
-00014a20: 2020 2073 6c69 6365 5f3d 2073 6c69 6365     slice_= slice
-00014a30: 2028 6978 5f73 2c20 2069 785f 656e 6429   (ix_s,  ix_end)
-00014a40: 200d 0a20 2020 2020 2020 2073 5f63 6672   ..        s_cfr
-00014a50: 6571 203d 2063 6672 6571 205b 736c 6963  eq = cfreq [slic
-00014a60: 655f 5d20 2320 736c 6963 6520 6672 6571  e_] # slice freq
-00014a70: 7565 6e63 7920 7769 7468 696e 2074 6865  uency within the
-00014a80: 2062 7566 6665 7220 0d0a 2020 2020 2020   buffer ..      
-00014a90: 2020 0d0a 2020 2020 2020 2020 2320 2d2d    ..        # --
-00014aa0: 3e20 6d61 6b65 2061 206e 6577 205a 206f  > make a new Z o
-00014ab0: 626a 6563 7473 200d 0a20 2020 2020 2020  bjects ..       
-00014ac0: 2023 206d 616b 6520 6120 6e65 7720 6f62   # make a new ob
-00014ad0: 6a65 6374 200d 0a20 2020 2020 2020 206e  ject ..        n
-00014ae0: 6577 5f7a 4f62 6a73 203d 6e70 2e7a 6572  ew_zObjs =np.zer
-00014af0: 6f73 5f6c 696b 6520 287a 4f62 6a73 2c20  os_like (zObjs, 
-00014b00: 6474 7970 6520 3d6f 626a 6563 7420 290d  dtype =object ).
-00014b10: 0a20 2020 2020 2020 2023 206c 6f6f 7020  .        # loop 
-00014b20: 746f 2063 6f72 7265 6374 2074 6865 205a  to correct the Z
-00014b30: 2069 6d70 6564 616e 6365 206f 626a 6563   impedance objec
-00014b40: 7420 7661 6c75 6573 200d 0a20 2020 2020  t values ..     
-00014b50: 2020 2066 6f72 206b 6b2c 2065 6469 4f62     for kk, ediOb
-00014b60: 6a20 696e 2065 6e75 6d65 7261 7465 2028  j in enumerate (
-00014b70: 7365 6c66 2e65 6469 4f62 6a73 5f29 3a0d  self.ediObjs_):.
-00014b80: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
-00014b90: 5f5a 203d 2045 4d7a 287a 5f61 7272 6179  _Z = EMz(z_array
-00014ba0: 3d6e 702e 7a65 726f 7328 286c 656e 2873  =np.zeros((len(s
-00014bb0: 5f63 6672 6571 292c 2032 2c20 3229 2c0d  _cfreq), 2, 2),.
-00014bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000146d0: 2029 2023 2077 6974 6820 6275 6666 6572   ) # with buffer
+000146e0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+000146f0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00014700: 2020 7365 6c66 2e69 6e73 7065 6374 200d    self.inspect .
+00014710: 0a0d 0a20 2020 2020 2020 2023 2067 6574  ...        # get
+00014720: 2074 6865 2066 7265 7175 656e 6369 6573   the frequencies
+00014730: 206f 626a 200d 0a20 2020 2020 2020 207a   obj ..        z
+00014740: 4f62 6a73 203d 206e 702e 6172 7261 7920  Objs = np.array 
+00014750: 286c 6973 7428 6d61 7028 6c61 6d62 6461  (list(map(lambda
+00014760: 206f 3a20 6f2e 5a2c 2073 656c 662e 6564   o: o.Z, self.ed
+00014770: 694f 626a 735f 2929 202c 0d0a 2020 2020  iObjs_)) ,..    
+00014780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014790: 2020 2020 2020 6474 7970 6520 3d6f 626a        dtype =obj
+000147a0: 6563 7429 200d 0a20 2020 2020 2020 2023  ect) ..        #
+000147b0: 7265 6164 2061 6c6c 2066 7265 7175 656e  read all frequen
+000147c0: 6379 206c 656e 6774 6820 616e 6420 7461  cy length and ta
+000147d0: 6b65 2074 6865 206d 6178 2066 7265 7175  ke the max frequ
+000147e0: 656e 6379 200d 0a20 2020 2020 2020 2023  ency ..        #
+000147f0: 206b 6e6f 776e 2020 6173 2074 6865 2063   known  as the c
+00014800: 6f6d 706c 6574 6520 6672 6571 7565 6e63  omplete frequenc
+00014810: 6965 7320 2820 5468 6174 2063 6f6d 706f  ies ( That compo
+00014820: 7365 2061 6c6c 2076 616c 7565 7329 0d0a  se all values)..
+00014830: 2020 2020 2020 2020 6672 6571 7369 7a65          freqsize
+00014840: 203d 206e 702e 6172 7261 7920 286c 6973   = np.array (lis
+00014850: 7420 286d 6170 2028 6c61 6d62 6461 206f  t (map (lambda o
+00014860: 3a6c 656e 286f 2e5f 6672 6571 292c 207a  :len(o._freq), z
+00014870: 4f62 6a73 2929 290d 0a20 2020 2020 2020  Objs)))..       
+00014880: 2069 785f 6d61 7820 203d 206e 702e 6172   ix_max  = np.ar
+00014890: 676d 6178 2866 7265 7173 697a 6529 0d0a  gmax(freqsize)..
+000148a0: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+000148b0: 6520 636f 6d70 6c65 7465 2066 7265 7120  e complete freq 
+000148c0: 0d0a 2020 2020 2020 2020 6366 7265 7120  ..        cfreq 
+000148d0: 3d20 7a4f 626a 735b 6978 5f6d 6178 5d2e  = zObjs[ix_max].
+000148e0: 5f66 7265 7120 200d 0a20 2020 2020 2020  _freq  ..       
+000148f0: 2023 2063 6f6e 7472 6f6c 2074 6865 2062   # control the b
+00014900: 7566 6665 7220 616e 6420 6765 7420 7468  uffer and get th
+00014910: 6520 7468 6520 7261 6e67 6520 6f66 2066  e the range of f
+00014920: 7265 7175 656e 6379 200d 0a20 2020 2020  requency ..     
+00014930: 2020 2062 7566 6665 7220 3d20 7365 6c66     buffer = self
+00014940: 2e63 6f6e 7472 6f6c 4672 6571 7565 6e63  .controlFrequenc
+00014950: 7942 7566 6665 7228 6366 7265 712c 2062  yBuffer(cfreq, b
+00014960: 7566 6665 7229 0d0a 2020 2020 2020 2020  uffer)..        
+00014970: 6978 5f62 7566 2c20 203d 206e 702e 7768  ix_buf,  = np.wh
+00014980: 6572 6520 2820 6e70 2e69 7369 6e20 2863  ere ( np.isin (c
+00014990: 6672 6571 2c20 6275 6666 6572 2929 200d  freq, buffer)) .
+000149a0: 0a20 2020 2020 2020 2023 2320 696e 6465  .        ## inde
+000149b0: 7820 666f 7220 736c 6963 6520 7468 6520  x for slice the 
+000149c0: 6172 7261 7920 696e 2074 6865 2063 6173  array in the cas
+000149d0: 6520 7468 6520 6275 6666 6572 2069 7320  e the buffer is 
+000149e0: 7365 7420 0d0a 2020 2020 2020 2020 6978  set ..        ix
+000149f0: 5f73 202c 2069 785f 656e 6420 3d20 6978  _s , ix_end = ix
+00014a00: 5f62 7566 203b 2069 785f 656e 6420 2b3d  _buf ; ix_end +=
+00014a10: 2031 200d 0a20 2020 2020 2020 2073 6c69   1 ..        sli
+00014a20: 6365 5f3d 2073 6c69 6365 2028 6978 5f73  ce_= slice (ix_s
+00014a30: 2c20 2069 785f 656e 6429 200d 0a20 2020  ,  ix_end) ..   
+00014a40: 2020 2020 2073 5f63 6672 6571 203d 2063       s_cfreq = c
+00014a50: 6672 6571 205b 736c 6963 655f 5d20 2320  freq [slice_] # 
+00014a60: 736c 6963 6520 6672 6571 7565 6e63 7920  slice frequency 
+00014a70: 7769 7468 696e 2074 6865 2062 7566 6665  within the buffe
+00014a80: 7220 0d0a 2020 2020 2020 2020 0d0a 2020  r ..        ..  
+00014a90: 2020 2020 2020 2320 2d2d 3e20 6d61 6b65        # --> make
+00014aa0: 2061 206e 6577 205a 206f 626a 6563 7473   a new Z objects
+00014ab0: 200d 0a20 2020 2020 2020 2023 206d 616b   ..        # mak
+00014ac0: 6520 6120 6e65 7720 6f62 6a65 6374 200d  e a new object .
+00014ad0: 0a20 2020 2020 2020 206e 6577 5f7a 4f62  .        new_zOb
+00014ae0: 6a73 203d 6e70 2e7a 6572 6f73 5f6c 696b  js =np.zeros_lik
+00014af0: 6520 287a 4f62 6a73 2c20 6474 7970 6520  e (zObjs, dtype 
+00014b00: 3d6f 626a 6563 7420 290d 0a20 2020 2020  =object )..     
+00014b10: 2020 2023 206c 6f6f 7020 746f 2063 6f72     # loop to cor
+00014b20: 7265 6374 2074 6865 205a 2069 6d70 6564  rect the Z imped
+00014b30: 616e 6365 206f 626a 6563 7420 7661 6c75  ance object valu
+00014b40: 6573 200d 0a20 2020 2020 2020 2066 6f72  es ..        for
+00014b50: 206b 6b2c 2065 6469 4f62 6a20 696e 2065   kk, ediObj in e
+00014b60: 6e75 6d65 7261 7465 2028 7365 6c66 2e65  numerate (self.e
+00014b70: 6469 4f62 6a73 5f29 3a0d 0a20 2020 2020  diObjs_):..     
+00014b80: 2020 2020 2020 206e 6577 5f5a 203d 2045         new_Z = E
+00014b90: 4d7a 287a 5f61 7272 6179 3d6e 702e 7a65  Mz(z_array=np.ze
+00014ba0: 726f 7328 286c 656e 2873 5f63 6672 6571  ros((len(s_cfreq
+00014bb0: 292c 2032 2c20 3229 2c0d 0a20 2020 2020  ), 2, 2),..     
+00014bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00014bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014be0: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-00014bf0: 653d 2763 6f6d 706c 6578 2729 2c0d 0a20  e='complex'),.. 
+00014be0: 2020 2020 2020 6474 7970 653d 2763 6f6d        dtype='com
+00014bf0: 706c 6578 2729 2c0d 0a20 2020 2020 2020  plex'),..       
 00014c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c10: 2020 2020 2020 207a 5f65 7272 5f61 7272         z_err_arr
-00014c20: 6179 3d6e 702e 7a65 726f 7328 286c 656e  ay=np.zeros((len
-00014c30: 2873 5f63 6672 6571 292c 2032 2c20 3229  (s_cfreq), 2, 2)
-00014c40: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-00014c50: 2020 2020 2020 2020 2020 2020 6672 6571              freq
-00014c60: 3d73 5f63 6672 6571 290d 0a20 2020 2020  =s_cfreq)..     
-00014c70: 2020 2020 2020 206e 6577 5f5a 203d 2073         new_Z = s
-00014c80: 656c 662e 5f74 6675 6e63 5a74 7261 6e73  elf._tfuncZtrans
-00014c90: 666f 726d 6572 280d 0a20 2020 2020 2020  former(..       
-00014ca0: 2020 2020 2020 2020 2065 6469 4f62 6a2c           ediObj,
-00014cb0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00014cc0: 2020 206e 6577 5f5a 2c20 0d0a 2020 2020     new_Z, ..    
-00014cd0: 2020 2020 2020 2020 2020 2020 7466 756e              tfun
-00014ce0: 633d 2073 656c 662e 5f7a 5f74 7261 6e73  c= self._z_trans
-00014cf0: 666f 726d 2c0d 0a20 2020 2020 2020 2020  form,..         
-00014d00: 2020 2020 2020 2073 6c69 6365 5f3d 2073         slice_= s
-00014d10: 6c69 6365 5f2c 200d 0a20 2020 2020 2020  lice_, ..       
-00014d20: 2020 2020 2020 2020 2063 6672 6571 3d20           cfreq= 
-00014d30: 6366 7265 712c 200d 0a20 2020 2020 2020  cfreq, ..       
-00014d40: 2020 2020 2020 2020 2069 785f 733d 2069           ix_s= i
-00014d50: 785f 732c 200d 0a20 2020 2020 2020 2020  x_s, ..         
-00014d60: 2020 2020 2020 2069 785f 656e 643d 2069         ix_end= i
-00014d70: 785f 656e 642c 200d 0a20 2020 2020 2020  x_end, ..       
-00014d80: 2020 2020 2020 2020 206d 6574 686f 643d           method=
-00014d90: 6d65 7468 6f64 2c20 0d0a 2020 2020 2020  method, ..      
-00014da0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-00014db0: 2020 2020 2020 2020 206e 6577 5f7a 4f62           new_zOb
-00014dc0: 6a73 5b6b 6b5d 203d 206e 6577 5f5a 200d  js[kk] = new_Z .
-00014dd0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00014de0: 2020 2020 2020 2069 6620 7465 6e73 6f72         if tensor
-00014df0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00014e00: 7465 6e73 6f72 203d 2073 7472 2874 656e  tensor = str(ten
-00014e10: 736f 7229 2e6c 6f77 6572 2829 200d 0a20  sor).lower() .. 
-00014e20: 2020 2020 2020 2020 2020 2074 656e 736f             tenso
-00014e30: 7220 3d20 2772 6573 2720 6966 2074 656e  r = 'res' if ten
-00014e40: 736f 7220 3d3d 2774 7275 6527 2065 6c73  sor =='true' els
-00014e50: 6520 7465 6e73 6f72 200d 0a20 2020 2020  e tensor ..     
-00014e60: 2020 2020 2020 206e 6577 5f7a 4f62 6a73         new_zObjs
-00014e70: 203d 2067 6574 3264 7465 6e73 6f72 280d   = get2dtensor(.
-00014e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014e90: 206e 6577 5f7a 4f62 6a73 2c20 7465 6e73   new_zObjs, tens
-00014ea0: 6f72 203d 2074 656e 736f 7220 2c20 0d0a  or = tensor , ..
-00014eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ec0: 636f 6d70 6f6e 656e 7420 3d20 636f 6d70  component = comp
-00014ed0: 6f6e 656e 7420 6f72 2073 656c 662e 636f  onent or self.co
-00014ee0: 6d70 6f6e 656e 742c 200d 0a20 2020 2020  mponent, ..     
-00014ef0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00014f00: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00014f10: 2020 2020 7265 7475 726e 206e 6577 5f7a      return new_z
-00014f20: 4f62 6a73 200d 0a20 2020 200d 0a20 2020  Objs ..    ..   
-00014f30: 2064 6566 205f 7a5f 7472 616e 7366 6f72   def _z_transfor
-00014f40: 6d20 280d 0a20 2020 2020 2020 2073 656c  m (..        sel
-00014f50: 662c 200d 0a20 2020 2020 2020 207a 202c  f, ..        z ,
-00014f60: 200d 0a20 2020 2020 2020 2072 6671 2c20   ..        rfq, 
-00014f70: 0d0a 2020 2020 2020 2020 6671 2c20 200d  ..        fq,  .
-00014f80: 0a20 2020 2020 2020 2073 6c69 6365 5f3d  .        slice_=
-00014f90: 204e 6f6e 652c 200d 0a20 2020 2020 2020   None, ..       
-00014fa0: 206d 6574 686f 643d 2027 7064 272c 2020   method= 'pd',  
-00014fb0: 0d0a 2020 2020 2020 2020 2a2a 6b77 730d  ..        **kws.
-00014fc0: 0a20 2020 2020 2020 2029 3a20 0d0a 2020  .        ): ..  
-00014fd0: 2020 2020 2020 2222 2220 526f 7574 6520        """ Route 
-00014fe0: 746f 2064 6f20 7468 6520 7361 6d65 2074  to do the same t
-00014ff0: 6173 6b20 666f 7220 7265 616c 2c20 696d  ask for real, im
-00015000: 6167 696e 6172 7920 616e 6420 6572 726f  aginary and erro
-00015010: 722e 0d0a 2020 2020 2020 2020 0d0a 2020  r...        ..  
-00015020: 2020 2020 2020 3a70 6172 616d 207a 3a20        :param z: 
-00015030: 496d 7065 6461 6e63 6520 7465 6e73 6f72  Impedance tensor
-00015040: 207a 200d 0a20 2020 2020 2020 203a 7061   z ..        :pa
-00015050: 7261 6d20 7266 713a 2072 6566 6572 656e  ram rfq: referen
-00015060: 6365 2066 7265 7175 656e 6379 2069 6e20  ce frequency in 
-00015070: 487a 200d 0a20 2020 2020 2020 203a 7061  Hz ..        :pa
-00015080: 7261 6d20 6671 3a20 636f 6d70 6c65 7465  ram fq: complete
-00015090: 2066 7265 7175 656e 6379 2069 6e20 487a   frequency in Hz
-000150a0: 0d0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000150b0: 2073 6c69 6365 5f3a 2066 7265 7175 656e   slice_: frequen
-000150c0: 6379 2062 7566 6665 7220 696e 6465 7865  cy buffer indexe
-000150d0: 7320 0d0a 2020 2020 2020 2020 3a70 6172  s ..        :par
-000150e0: 616d 206d 6574 686f 643a 2074 656e 736f  am method: tenso
-000150f0: 7220 696e 7465 7270 6f6c 6174 696f 6e20  r interpolation 
-00015100: 0d0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00015110: 206b 7773 3a20 6164 6469 7469 6f6e 616c   kws: additional
-00015120: 206b 6579 776f 7264 7320 6172 6775 6d65   keywords argume
-00015130: 6e74 7320 6672 6f6d 203a 6675 6e63 3a60  nts from :func:`
-00015140: 7e69 6e74 6572 706f 6c61 7465 3164 602e  ~interpolate1d`.
-00015150: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
-00015160: 2020 2020 2020 2020 7769 7468 206e 702e          with np.
-00015170: 6572 7273 7461 7465 2861 6c6c 3d27 6967  errstate(all='ig
-00015180: 6e6f 7265 2729 3a0d 0a20 2020 2020 2020  nore'):..       
-00015190: 2020 2020 207a 203d 2072 6573 6861 7065       z = reshape
-000151a0: 287a 2920 0d0a 2020 2020 2020 2020 2020  (z) ..          
-000151b0: 2020 7a20 3d20 6669 7474 656e 736f 7228    z = fittensor(
-000151c0: 636f 6d70 6672 6571 3d20 6671 2c20 7265  compfreq= fq, re
-000151d0: 6672 6571 203d 7266 712c 207a 203d 207a  freq =rfq, z = z
-000151e0: 2020 2920 0d0a 2020 2020 2020 2020 2020    ) ..          
-000151f0: 2020 7a20 3d20 696e 7465 7270 6f6c 6174    z = interpolat
-00015200: 6531 6428 6172 723d 7a20 2c20 6d65 7468  e1d(arr=z , meth
-00015210: 6f64 203d 6d65 7468 6f64 2c20 2a2a 6b77  od =method, **kw
-00015220: 7320 290d 0a20 2020 2020 2020 2072 6574  s )..        ret
-00015230: 7572 6e20 7a20 5b73 6c69 6365 5f5d 200d  urn z [slice_] .
-00015240: 0a20 2020 200d 0a20 2020 2064 6566 205f  .    ..    def _
-00015250: 7466 756e 635a 7472 616e 7366 6f72 6d65  tfuncZtransforme
-00015260: 7220 280d 0a20 2020 2020 2020 2073 656c  r (..        sel
-00015270: 662c 2020 0d0a 2020 2020 2020 2020 6564  f,  ..        ed
-00015280: 694f 626a 3a20 4544 494f 202c 200d 0a20  iObj: EDIO , .. 
-00015290: 2020 2020 2020 206e 6577 5f5a 3a20 4e44         new_Z: ND
-000152a0: 4172 7261 7920 5b44 5479 7065 5b63 6f6d  Array [DType[com
-000152b0: 706c 6578 5d5d 2c20 0d0a 2020 2020 2020  plex]], ..      
-000152c0: 2020 7466 756e 633a 2046 2c20 0d0a 2020    tfunc: F, ..  
-000152d0: 2020 2020 2020 6366 7265 713a 2041 7272        cfreq: Arr
-000152e0: 6179 4c69 6b65 2c20 0d0a 2020 2020 2020  ayLike, ..      
-000152f0: 2020 736c 6963 655f 3a20 736c 6963 6520    slice_: slice 
-00015300: 3d4e 6f6e 652c 200d 0a20 2020 2020 2020  =None, ..       
-00015310: 2069 785f 733a 2069 6e74 203d 2030 202c   ix_s: int = 0 ,
-00015320: 200d 0a20 2020 2020 2020 2069 785f 656e   ..        ix_en
-00015330: 643a 2069 6e74 2020 3d20 2d31 2c20 0d0a  d: int  = -1, ..
-00015340: 2020 2020 2020 2020 6d65 7468 6f64 3a20          method: 
-00015350: 7374 7220 3d27 7064 272c 200d 0a20 2020  str ='pd', ..   
-00015360: 2020 2020 2029 2d3e 204e 4441 7272 6179       )-> NDArray
-00015370: 205b 4454 7970 655b 636f 6d70 6c65 785d   [DType[complex]
-00015380: 5d3a 200d 0a20 2020 2020 2020 2022 2222  ]: ..        """
-00015390: 204c 6f6f 7020 616e 6420 7472 616e 7366   Loop and transf
-000153a0: 6f72 6d20 7468 6520 7072 6576 696f 7573  orm the previous
-000153b0: 2074 656e 736f 7220 746f 2061 206e 6577   tensor to a new
-000153c0: 2074 656e 736f 7220 6672 6f6d 2061 200d   tensor from a .
-000153d0: 0a20 2020 2020 2020 2074 7261 6e73 666f  .        transfo
-000153e0: 726d 2066 756e 6374 696f 6e20 6074 6675  rm function `tfu
-000153f0: 6e63 602e 200d 0a20 2020 2020 2020 200d  nc`. ..        .
-00015400: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00015410: 6564 694f 626a 3a20 4544 492d 6f62 6a65  ediObj: EDI-obje
-00015420: 6374 2066 726f 6d20 454d 2e20 0d0a 2020  ct from EM. ..  
-00015430: 2020 2020 2020 3a70 6172 616d 206e 6577        :param new
-00015440: 5f5a 3a20 6e65 7720 7465 6e73 6f6f 7220  _Z: new tensoor 
-00015450: 6f66 2032 2078 3220 6d61 7472 6978 202c  of 2 x2 matrix ,
-00015460: 2063 6f6d 706c 6578 206e 756d 6265 7220   complex number 
-00015470: 0d0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00015480: 2074 6675 6e63 3a20 4361 6c6c 6162 6c65   tfunc: Callable
-00015490: 2c20 6675 6e63 7469 6f6e 2066 6f72 2074  , function for t
-000154a0: 7261 6e73 666f 726d 2074 6865 2074 656e  ransform the ten
-000154b0: 736f 7220 0d0a 2020 2020 2020 2020 3a70  sor ..        :p
-000154c0: 6172 616d 2063 6672 6571 3a20 6e65 7720  aram cfreq: new 
-000154d0: 696e 7465 7270 6f6c 6174 6520 6672 6571  interpolate freq
-000154e0: 7565 6e63 7920 7573 6520 746f 2069 6e69  uency use to ini
-000154f0: 7469 616c 697a 6520 7468 6520 6e65 7720  tialize the new 
-00015500: 7465 6e73 6f72 200d 0a20 2020 2020 2020  tensor ..       
-00015510: 203a 7061 7261 6d20 736c 6963 655f 3a20   :param slice_: 
-00015520: 736c 6963 6520 6f62 6a65 6374 202c 2074  slice object , t
-00015530: 6f20 7072 6573 6572 7665 2064 6174 6120  o preserve data 
-00015540: 696e 2074 6865 2070 7265 7669 6f75 7320  in the previous 
-00015550: 7465 6e73 6f72 200d 0a20 2020 2020 2020  tensor ..       
-00015560: 203a 7061 7261 6d20 6978 5f73 3a20 696e   :param ix_s: in
-00015570: 742c 2069 6e64 6578 206f 6620 7374 6172  t, index of star
-00015580: 7474 696e 6720 706f 696e 7420 746f 2072  tting point to r
-00015590: 6561 6420 7468 6520 7465 6e73 6f72 2066  ead the tensor f
-000155a0: 726f 6d20 0d0a 2020 2020 2020 2020 2020  rom ..          
-000155b0: 2020 7072 6576 696f 7573 2074 656e 736f    previous tenso
-000155c0: 7220 0d0a 2020 2020 2020 2020 3a70 6172  r ..        :par
-000155d0: 616d 2069 785f 656e 643a 2069 6e74 2c20  am ix_end: int, 
-000155e0: 656e 6420 706f 696e 7420 746f 2073 746f  end point to sto
-000155f0: 7020 7265 6164 696e 6720 7468 6520 7072  p reading the pr
-00015600: 6576 696f 7573 2074 656e 736f 722e 200d  evious tensor. .
-00015610: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00015620: 2020 203a 6e6f 7465 3a20 7468 6520 6e65     :note: the ne
-00015630: 7720 7465 6e73 6f72 2069 7320 636f 6d70  w tensor is comp
-00015640: 6f73 6564 206f 6620 7368 6170 6520 2863  osed of shape (c
-00015650: 6672 6571 2c20 3220 2c20 3220 292c 2032  freq, 2 , 2 ), 2
-00015660: 2078 3220 6d61 7472 6963 6573 0d0a 2020   x2 matrices..  
-00015670: 2020 2020 2020 2020 2020 666f 7220 7468            for th
-00015680: 6520 666f 7572 2063 6f6d 706f 6e65 6e74  e four component
-00015690: 2078 782c 2078 792c 2079 782c 2079 7920   xx, xy, yx, yy 
-000156a0: 2e20 0d0a 2020 2020 2020 2020 3a72 6574  . ..        :ret
-000156b0: 7572 6e3a 204e 4441 7272 6179 206f 6620  urn: NDArray of 
-000156c0: 7368 6170 6520 2863 6672 6571 2c20 3220  shape (cfreq, 2 
-000156d0: 2a20 3220 292c 2064 7479 7065 203d 2063  * 2 ), dtype = c
-000156e0: 6f6d 706c 6578 200d 0a20 2020 2020 2020  omplex ..       
-000156f0: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
-00015700: 2020 2020 2020 2020 666f 7220 6969 2069          for ii i
-00015710: 6e20 7261 6e67 6528 3229 3a0d 0a20 2020  n range(2):..   
-00015720: 2020 2020 2020 2020 2066 6f72 206a 6a20           for jj 
-00015730: 696e 2072 616e 6765 2832 293a 0d0a 2020  in range(2):..  
-00015740: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00015750: 6e65 6564 2074 6f20 6c6f 6f6b 206f 7574  need to look out
-00015760: 2066 6f72 207a 6572 6f73 2069 6e20 7468   for zeros in th
-00015770: 6520 696d 7065 6461 6e63 650d 0a20 2020  e impedance..   
-00015780: 2020 2020 2020 2020 2020 2020 2023 2067               # g
-00015790: 6574 2074 6865 2069 6e64 6963 6965 7320  et the indicies 
-000157a0: 6f66 206e 6f6e 2d7a 6572 6f20 636f 6d70  of non-zero comp
-000157b0: 6f6e 656e 7473 0d0a 2020 2020 2020 2020  onents..        
-000157c0: 2020 2020 2020 2020 6e7a 5f69 6e64 6578          nz_index
-000157d0: 203d 206e 702e 6e6f 6e7a 6572 6f28 6564   = np.nonzero(ed
-000157e0: 694f 626a 2e5a 2e7a 5b3a 2c20 6969 2c20  iObj.Z.z[:, ii, 
-000157f0: 6a6a 5d29 0d0a 2020 2020 2020 2020 2020  jj])..          
-00015800: 2020 2020 2020 6966 206c 656e 286e 7a5f        if len(nz_
-00015810: 696e 6465 785b 305d 2920 3d3d 2030 3a0d  index[0]) == 0:.
-00015820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015830: 2020 2020 2063 6f6e 7469 6e75 650d 0a20       continue.. 
-00015840: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00015850: 2067 6574 2074 6865 206e 6f6e 5f7a 6572   get the non_zer
-00015860: 6f73 2063 6f6d 706f 6e65 6e74 7320 616e  os components an
-00015870: 6420 696e 7465 7270 6f6c 6174 6520 0d0a  d interpolate ..
-00015880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015890: 2320 6672 6571 7565 6e63 7920 746f 2072  # frequency to r
-000158a0: 6563 6f76 6572 2074 6865 2063 6f6d 706f  ecover the compo
-000158b0: 6e65 6e74 2069 6e20 6465 6164 2d62 616e  nent in dead-ban
-000158c0: 6420 6672 6571 7565 6e63 6965 7320 0d0a  d frequencies ..
-000158d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000158e0: 2320 5573 6520 7468 6520 7768 6f6c 6520  # Use the whole 
-000158f0: 6564 690d 0a20 2020 2020 2020 2020 2020  edi..           
-00015900: 2020 2020 2077 6974 6820 6e70 2e65 7272       with np.err
-00015910: 7374 6174 6528 616c 6c3d 2769 676e 6f72  state(all='ignor
-00015920: 6527 293a 0d0a 2020 2020 2020 2020 2020  e'):..          
-00015930: 2020 2020 2020 2020 2020 7a66 7265 7120            zfreq 
-00015940: 3d20 6564 694f 626a 2e5a 2e5f 6672 6571  = ediObj.Z._freq
-00015950: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015960: 2020 2020 2020 7a5f 7265 616c 203d 2072        z_real = r
-00015970: 6573 6861 7065 2865 6469 4f62 6a2e 5a2e  eshape(ediObj.Z.
-00015980: 7a5b 6e7a 5f69 6e64 6578 2c20 6969 2c20  z[nz_index, ii, 
-00015990: 6a6a 5d2e 7265 616c 2920 0d0a 2020 2020  jj].real) ..    
-000159a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000159b0: 7a5f 7265 616c 203d 2074 6675 6e63 2028  z_real = tfunc (
-000159c0: 7a5f 7265 616c 2c20 0d0a 2020 2020 2020  z_real, ..      
+00014c10: 207a 5f65 7272 5f61 7272 6179 3d6e 702e   z_err_array=np.
+00014c20: 7a65 726f 7328 286c 656e 2873 5f63 6672  zeros((len(s_cfr
+00014c30: 6571 292c 2032 2c20 3229 292c 0d0a 2020  eq), 2, 2)),..  
+00014c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014c50: 2020 2020 2020 6672 6571 3d73 5f63 6672        freq=s_cfr
+00014c60: 6571 290d 0a20 2020 2020 2020 2020 2020  eq)..           
+00014c70: 206e 6577 5f5a 203d 2073 656c 662e 5f74   new_Z = self._t
+00014c80: 6675 6e63 5a74 7261 6e73 666f 726d 6572  funcZtransformer
+00014c90: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00014ca0: 2020 2065 6469 4f62 6a2c 200d 0a20 2020     ediObj, ..   
+00014cb0: 2020 2020 2020 2020 2020 2020 206e 6577               new
+00014cc0: 5f5a 2c20 0d0a 2020 2020 2020 2020 2020  _Z, ..          
+00014cd0: 2020 2020 2020 7466 756e 633d 2073 656c        tfunc= sel
+00014ce0: 662e 5f7a 5f74 7261 6e73 666f 726d 2c0d  f._z_transform,.
+00014cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014d00: 2073 6c69 6365 5f3d 2073 6c69 6365 5f2c   slice_= slice_,
+00014d10: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00014d20: 2020 2063 6672 6571 3d20 6366 7265 712c     cfreq= cfreq,
+00014d30: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00014d40: 2020 2069 785f 733d 2069 785f 732c 200d     ix_s= ix_s, .
+00014d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014d60: 2069 785f 656e 643d 2069 785f 656e 642c   ix_end= ix_end,
+00014d70: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00014d80: 2020 206d 6574 686f 643d 6d65 7468 6f64     method=method
+00014d90: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00014da0: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
+00014db0: 2020 206e 6577 5f7a 4f62 6a73 5b6b 6b5d     new_zObjs[kk]
+00014dc0: 203d 206e 6577 5f5a 200d 0a20 2020 2020   = new_Z ..     
+00014dd0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00014de0: 2069 6620 7465 6e73 6f72 3a20 0d0a 2020   if tensor: ..  
+00014df0: 2020 2020 2020 2020 2020 7465 6e73 6f72            tensor
+00014e00: 203d 2073 7472 2874 656e 736f 7229 2e6c   = str(tensor).l
+00014e10: 6f77 6572 2829 200d 0a20 2020 2020 2020  ower() ..       
+00014e20: 2020 2020 2074 656e 736f 7220 3d20 2772       tensor = 'r
+00014e30: 6573 2720 6966 2074 656e 736f 7220 3d3d  es' if tensor ==
+00014e40: 2774 7275 6527 2065 6c73 6520 7465 6e73  'true' else tens
+00014e50: 6f72 200d 0a20 2020 2020 2020 2020 2020  or ..           
+00014e60: 206e 6577 5f7a 4f62 6a73 203d 2067 6574   new_zObjs = get
+00014e70: 3264 7465 6e73 6f72 280d 0a20 2020 2020  2dtensor(..     
+00014e80: 2020 2020 2020 2020 2020 206e 6577 5f7a             new_z
+00014e90: 4f62 6a73 2c20 7465 6e73 6f72 203d 2074  Objs, tensor = t
+00014ea0: 656e 736f 7220 2c20 0d0a 2020 2020 2020  ensor , ..      
+00014eb0: 2020 2020 2020 2020 2020 636f 6d70 6f6e            compon
+00014ec0: 656e 7420 3d20 636f 6d70 6f6e 656e 7420  ent = component 
+00014ed0: 6f72 2073 656c 662e 636f 6d70 6f6e 656e  or self.componen
+00014ee0: 742c 200d 0a20 2020 2020 2020 2020 2020  t, ..           
+00014ef0: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00014f00: 2020 2020 0d0a 2020 2020 2020 2020 7265      ..        re
+00014f10: 7475 726e 206e 6577 5f7a 4f62 6a73 200d  turn new_zObjs .
+00014f20: 0a20 2020 200d 0a20 2020 2064 6566 205f  .    ..    def _
+00014f30: 7a5f 7472 616e 7366 6f72 6d20 280d 0a20  z_transform (.. 
+00014f40: 2020 2020 2020 2073 656c 662c 200d 0a20         self, .. 
+00014f50: 2020 2020 2020 207a 202c 200d 0a20 2020         z , ..   
+00014f60: 2020 2020 2072 6671 2c20 0d0a 2020 2020       rfq, ..    
+00014f70: 2020 2020 6671 2c20 200d 0a20 2020 2020      fq,  ..     
+00014f80: 2020 2073 6c69 6365 5f3d 204e 6f6e 652c     slice_= None,
+00014f90: 200d 0a20 2020 2020 2020 206d 6574 686f   ..        metho
+00014fa0: 643d 2027 7064 272c 2020 0d0a 2020 2020  d= 'pd',  ..    
+00014fb0: 2020 2020 2a2a 6b77 730d 0a20 2020 2020      **kws..     
+00014fc0: 2020 2029 3a20 0d0a 2020 2020 2020 2020     ): ..        
+00014fd0: 2222 2220 526f 7574 6520 746f 2064 6f20  """ Route to do 
+00014fe0: 7468 6520 7361 6d65 2074 6173 6b20 666f  the same task fo
+00014ff0: 7220 7265 616c 2c20 696d 6167 696e 6172  r real, imaginar
+00015000: 7920 616e 6420 6572 726f 722e 0d0a 2020  y and error...  
+00015010: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00015020: 3a70 6172 616d 207a 3a20 496d 7065 6461  :param z: Impeda
+00015030: 6e63 6520 7465 6e73 6f72 207a 200d 0a20  nce tensor z .. 
+00015040: 2020 2020 2020 203a 7061 7261 6d20 7266         :param rf
+00015050: 713a 2072 6566 6572 656e 6365 2066 7265  q: reference fre
+00015060: 7175 656e 6379 2069 6e20 487a 200d 0a20  quency in Hz .. 
+00015070: 2020 2020 2020 203a 7061 7261 6d20 6671         :param fq
+00015080: 3a20 636f 6d70 6c65 7465 2066 7265 7175  : complete frequ
+00015090: 656e 6379 2069 6e20 487a 0d0a 2020 2020  ency in Hz..    
+000150a0: 2020 2020 3a70 6172 616d 2073 6c69 6365      :param slice
+000150b0: 5f3a 2066 7265 7175 656e 6379 2062 7566  _: frequency buf
+000150c0: 6665 7220 696e 6465 7865 7320 0d0a 2020  fer indexes ..  
+000150d0: 2020 2020 2020 3a70 6172 616d 206d 6574        :param met
+000150e0: 686f 643a 2074 656e 736f 7220 696e 7465  hod: tensor inte
+000150f0: 7270 6f6c 6174 696f 6e20 0d0a 2020 2020  rpolation ..    
+00015100: 2020 2020 3a70 6172 616d 206b 7773 3a20      :param kws: 
+00015110: 6164 6469 7469 6f6e 616c 206b 6579 776f  additional keywo
+00015120: 7264 7320 6172 6775 6d65 6e74 7320 6672  rds arguments fr
+00015130: 6f6d 203a 6675 6e63 3a60 7e69 6e74 6572  om :func:`~inter
+00015140: 706f 6c61 7465 3164 602e 200d 0a20 2020  polate1d`. ..   
+00015150: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00015160: 2020 7769 7468 206e 702e 6572 7273 7461    with np.errsta
+00015170: 7465 2861 6c6c 3d27 6967 6e6f 7265 2729  te(all='ignore')
+00015180: 3a0d 0a20 2020 2020 2020 2020 2020 207a  :..            z
+00015190: 203d 2072 6573 6861 7065 287a 2920 0d0a   = reshape(z) ..
+000151a0: 2020 2020 2020 2020 2020 2020 7a20 3d20              z = 
+000151b0: 6669 7474 656e 736f 7228 636f 6d70 6672  fittensor(compfr
+000151c0: 6571 3d20 6671 2c20 7265 6672 6571 203d  eq= fq, refreq =
+000151d0: 7266 712c 207a 203d 207a 2020 2920 0d0a  rfq, z = z  ) ..
+000151e0: 2020 2020 2020 2020 2020 2020 7a20 3d20              z = 
+000151f0: 696e 7465 7270 6f6c 6174 6531 6428 6172  interpolate1d(ar
+00015200: 723d 7a20 2c20 6d65 7468 6f64 203d 6d65  r=z , method =me
+00015210: 7468 6f64 2c20 2a2a 6b77 7320 290d 0a20  thod, **kws ).. 
+00015220: 2020 2020 2020 2072 6574 7572 6e20 7a20         return z 
+00015230: 5b73 6c69 6365 5f5d 200d 0a20 2020 200d  [slice_] ..    .
+00015240: 0a20 2020 2064 6566 205f 7466 756e 635a  .    def _tfuncZ
+00015250: 7472 616e 7366 6f72 6d65 7220 280d 0a20  transformer (.. 
+00015260: 2020 2020 2020 2073 656c 662c 2020 0d0a         self,  ..
+00015270: 2020 2020 2020 2020 6564 694f 626a 3a20          ediObj: 
+00015280: 4544 494f 202c 200d 0a20 2020 2020 2020  EDIO , ..       
+00015290: 206e 6577 5f5a 3a20 4e44 4172 7261 7920   new_Z: NDArray 
+000152a0: 5b44 5479 7065 5b63 6f6d 706c 6578 5d5d  [DType[complex]]
+000152b0: 2c20 0d0a 2020 2020 2020 2020 7466 756e  , ..        tfun
+000152c0: 633a 2046 2c20 0d0a 2020 2020 2020 2020  c: F, ..        
+000152d0: 6366 7265 713a 2041 7272 6179 4c69 6b65  cfreq: ArrayLike
+000152e0: 2c20 0d0a 2020 2020 2020 2020 736c 6963  , ..        slic
+000152f0: 655f 3a20 736c 6963 6520 3d4e 6f6e 652c  e_: slice =None,
+00015300: 200d 0a20 2020 2020 2020 2069 785f 733a   ..        ix_s:
+00015310: 2069 6e74 203d 2030 202c 200d 0a20 2020   int = 0 , ..   
+00015320: 2020 2020 2069 785f 656e 643a 2069 6e74       ix_end: int
+00015330: 2020 3d20 2d31 2c20 0d0a 2020 2020 2020    = -1, ..      
+00015340: 2020 6d65 7468 6f64 3a20 7374 7220 3d27    method: str ='
+00015350: 7064 272c 200d 0a20 2020 2020 2020 2029  pd', ..        )
+00015360: 2d3e 204e 4441 7272 6179 205b 4454 7970  -> NDArray [DTyp
+00015370: 655b 636f 6d70 6c65 785d 5d3a 200d 0a20  e[complex]]: .. 
+00015380: 2020 2020 2020 2022 2222 204c 6f6f 7020         """ Loop 
+00015390: 616e 6420 7472 616e 7366 6f72 6d20 7468  and transform th
+000153a0: 6520 7072 6576 696f 7573 2074 656e 736f  e previous tenso
+000153b0: 7220 746f 2061 206e 6577 2074 656e 736f  r to a new tenso
+000153c0: 7220 6672 6f6d 2061 200d 0a20 2020 2020  r from a ..     
+000153d0: 2020 2074 7261 6e73 666f 726d 2066 756e     transform fun
+000153e0: 6374 696f 6e20 6074 6675 6e63 602e 200d  ction `tfunc`. .
+000153f0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00015400: 2020 203a 7061 7261 6d20 6564 694f 626a     :param ediObj
+00015410: 3a20 4544 492d 6f62 6a65 6374 2066 726f  : EDI-object fro
+00015420: 6d20 454d 2e20 0d0a 2020 2020 2020 2020  m EM. ..        
+00015430: 3a70 6172 616d 206e 6577 5f5a 3a20 6e65  :param new_Z: ne
+00015440: 7720 7465 6e73 6f6f 7220 6f66 2032 2078  w tensoor of 2 x
+00015450: 3220 6d61 7472 6978 202c 2063 6f6d 706c  2 matrix , compl
+00015460: 6578 206e 756d 6265 7220 0d0a 2020 2020  ex number ..    
+00015470: 2020 2020 3a70 6172 616d 2074 6675 6e63      :param tfunc
+00015480: 3a20 4361 6c6c 6162 6c65 2c20 6675 6e63  : Callable, func
+00015490: 7469 6f6e 2066 6f72 2074 7261 6e73 666f  tion for transfo
+000154a0: 726d 2074 6865 2074 656e 736f 7220 0d0a  rm the tensor ..
+000154b0: 2020 2020 2020 2020 3a70 6172 616d 2063          :param c
+000154c0: 6672 6571 3a20 6e65 7720 696e 7465 7270  freq: new interp
+000154d0: 6f6c 6174 6520 6672 6571 7565 6e63 7920  olate frequency 
+000154e0: 7573 6520 746f 2069 6e69 7469 616c 697a  use to initializ
+000154f0: 6520 7468 6520 6e65 7720 7465 6e73 6f72  e the new tensor
+00015500: 200d 0a20 2020 2020 2020 203a 7061 7261   ..        :para
+00015510: 6d20 736c 6963 655f 3a20 736c 6963 6520  m slice_: slice 
+00015520: 6f62 6a65 6374 202c 2074 6f20 7072 6573  object , to pres
+00015530: 6572 7665 2064 6174 6120 696e 2074 6865  erve data in the
+00015540: 2070 7265 7669 6f75 7320 7465 6e73 6f72   previous tensor
+00015550: 200d 0a20 2020 2020 2020 203a 7061 7261   ..        :para
+00015560: 6d20 6978 5f73 3a20 696e 742c 2069 6e64  m ix_s: int, ind
+00015570: 6578 206f 6620 7374 6172 7474 696e 6720  ex of startting 
+00015580: 706f 696e 7420 746f 2072 6561 6420 7468  point to read th
+00015590: 6520 7465 6e73 6f72 2066 726f 6d20 0d0a  e tensor from ..
+000155a0: 2020 2020 2020 2020 2020 2020 7072 6576              prev
+000155b0: 696f 7573 2074 656e 736f 7220 0d0a 2020  ious tensor ..  
+000155c0: 2020 2020 2020 3a70 6172 616d 2069 785f        :param ix_
+000155d0: 656e 643a 2069 6e74 2c20 656e 6420 706f  end: int, end po
+000155e0: 696e 7420 746f 2073 746f 7020 7265 6164  int to stop read
+000155f0: 696e 6720 7468 6520 7072 6576 696f 7573  ing the previous
+00015600: 2074 656e 736f 722e 200d 0a20 2020 2020   tensor. ..     
+00015610: 2020 200d 0a20 2020 2020 2020 203a 6e6f     ..        :no
+00015620: 7465 3a20 7468 6520 6e65 7720 7465 6e73  te: the new tens
+00015630: 6f72 2069 7320 636f 6d70 6f73 6564 206f  or is composed o
+00015640: 6620 7368 6170 6520 2863 6672 6571 2c20  f shape (cfreq, 
+00015650: 3220 2c20 3220 292c 2032 2078 3220 6d61  2 , 2 ), 2 x2 ma
+00015660: 7472 6963 6573 0d0a 2020 2020 2020 2020  trices..        
+00015670: 2020 2020 666f 7220 7468 6520 666f 7572      for the four
+00015680: 2063 6f6d 706f 6e65 6e74 2078 782c 2078   component xx, x
+00015690: 792c 2079 782c 2079 7920 2e20 0d0a 2020  y, yx, yy . ..  
+000156a0: 2020 2020 2020 3a72 6574 7572 6e3a 204e        :return: N
+000156b0: 4441 7272 6179 206f 6620 7368 6170 6520  DArray of shape 
+000156c0: 2863 6672 6571 2c20 3220 2a20 3220 292c  (cfreq, 2 * 2 ),
+000156d0: 2064 7479 7065 203d 2063 6f6d 706c 6578   dtype = complex
+000156e0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+000156f0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00015700: 2020 666f 7220 6969 2069 6e20 7261 6e67    for ii in rang
+00015710: 6528 3229 3a0d 0a20 2020 2020 2020 2020  e(2):..         
+00015720: 2020 2066 6f72 206a 6a20 696e 2072 616e     for jj in ran
+00015730: 6765 2832 293a 0d0a 2020 2020 2020 2020  ge(2):..        
+00015740: 2020 2020 2020 2020 2320 6e65 6564 2074          # need t
+00015750: 6f20 6c6f 6f6b 206f 7574 2066 6f72 207a  o look out for z
+00015760: 6572 6f73 2069 6e20 7468 6520 696d 7065  eros in the impe
+00015770: 6461 6e63 650d 0a20 2020 2020 2020 2020  dance..         
+00015780: 2020 2020 2020 2023 2067 6574 2074 6865         # get the
+00015790: 2069 6e64 6963 6965 7320 6f66 206e 6f6e   indicies of non
+000157a0: 2d7a 6572 6f20 636f 6d70 6f6e 656e 7473  -zero components
+000157b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000157c0: 2020 6e7a 5f69 6e64 6578 203d 206e 702e    nz_index = np.
+000157d0: 6e6f 6e7a 6572 6f28 6564 694f 626a 2e5a  nonzero(ediObj.Z
+000157e0: 2e7a 5b3a 2c20 6969 2c20 6a6a 5d29 0d0a  .z[:, ii, jj])..
+000157f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015800: 6966 206c 656e 286e 7a5f 696e 6465 785b  if len(nz_index[
+00015810: 305d 2920 3d3d 2030 3a0d 0a20 2020 2020  0]) == 0:..     
+00015820: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00015830: 6f6e 7469 6e75 650d 0a20 2020 2020 2020  ontinue..       
+00015840: 2020 2020 2020 2020 2023 2067 6574 2074           # get t
+00015850: 6865 206e 6f6e 5f7a 6572 6f73 2063 6f6d  he non_zeros com
+00015860: 706f 6e65 6e74 7320 616e 6420 696e 7465  ponents and inte
+00015870: 7270 6f6c 6174 6520 0d0a 2020 2020 2020  rpolate ..      
+00015880: 2020 2020 2020 2020 2020 2320 6672 6571            # freq
+00015890: 7565 6e63 7920 746f 2072 6563 6f76 6572  uency to recover
+000158a0: 2074 6865 2063 6f6d 706f 6e65 6e74 2069   the component i
+000158b0: 6e20 6465 6164 2d62 616e 6420 6672 6571  n dead-band freq
+000158c0: 7565 6e63 6965 7320 0d0a 2020 2020 2020  uencies ..      
+000158d0: 2020 2020 2020 2020 2020 2320 5573 6520            # Use 
+000158e0: 7468 6520 7768 6f6c 6520 6564 690d 0a20  the whole edi.. 
+000158f0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00015900: 6974 6820 6e70 2e65 7272 7374 6174 6528  ith np.errstate(
+00015910: 616c 6c3d 2769 676e 6f72 6527 293a 0d0a  all='ignore'):..
+00015920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015930: 2020 2020 7a66 7265 7120 3d20 6564 694f      zfreq = ediO
+00015940: 626a 2e5a 2e5f 6672 6571 0d0a 2020 2020  bj.Z._freq..    
+00015950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015960: 7a5f 7265 616c 203d 2072 6573 6861 7065  z_real = reshape
+00015970: 2865 6469 4f62 6a2e 5a2e 7a5b 6e7a 5f69  (ediObj.Z.z[nz_i
+00015980: 6e64 6578 2c20 6969 2c20 6a6a 5d2e 7265  ndex, ii, jj].re
+00015990: 616c 2920 0d0a 2020 2020 2020 2020 2020  al) ..          
+000159a0: 2020 2020 2020 2020 2020 7a5f 7265 616c            z_real
+000159b0: 203d 2074 6675 6e63 2028 7a5f 7265 616c   = tfunc (z_real
+000159c0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
 000159d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000159e0: 2020 2020 2020 2020 2020 2020 2020 7266                rf
-000159f0: 713d 6366 7265 712c 200d 0a20 2020 2020  q=cfreq, ..     
+000159e0: 2020 2020 2020 2020 7266 713d 6366 7265          rfq=cfre
+000159f0: 712c 200d 0a20 2020 2020 2020 2020 2020  q, ..           
 00015a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a10: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00015a20: 713d 7a66 7265 712c 200d 0a20 2020 2020  q=zfreq, ..     
+00015a10: 2020 2020 2020 2020 2066 713d 7a66 7265           fq=zfre
+00015a20: 712c 200d 0a20 2020 2020 2020 2020 2020  q, ..           
 00015a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00015a50: 6c69 6365 5f3d 736c 6963 655f 202c 200d  lice_=slice_ , .
-00015a60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a80: 2020 2020 206d 6574 686f 6420 3d6d 6574       method =met
-00015a90: 686f 642c 200d 0a20 2020 2020 2020 2020  hod, ..         
+00015a40: 2020 2020 2020 2020 2073 6c69 6365 5f3d           slice_=
+00015a50: 736c 6963 655f 202c 200d 0a20 2020 2020  slice_ , ..     
+00015a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a70: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00015a80: 6574 686f 6420 3d6d 6574 686f 642c 200d  ethod =method, .
+00015a90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00015aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ab0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00015ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ad0: 2020 7a5f 696d 6167 203d 2072 6573 6861    z_imag = resha
-00015ae0: 7065 2865 6469 4f62 6a2e 5a2e 7a5b 6e7a  pe(ediObj.Z.z[nz
-00015af0: 5f69 6e64 6578 2c20 6969 2c20 6a6a 5d2e  _index, ii, jj].
-00015b00: 696d 6167 2920 0d0a 2020 2020 2020 2020  imag) ..        
-00015b10: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00015b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b30: 2020 7a5f 696d 6167 203d 2074 6675 6e63    z_imag = tfunc
-00015b40: 2028 7a5f 696d 6167 2c20 0d0a 2020 2020   (z_imag, ..    
+00015ab0: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00015ac0: 2020 2020 2020 2020 2020 2020 7a5f 696d              z_im
+00015ad0: 6167 203d 2072 6573 6861 7065 2865 6469  ag = reshape(edi
+00015ae0: 4f62 6a2e 5a2e 7a5b 6e7a 5f69 6e64 6578  Obj.Z.z[nz_index
+00015af0: 2c20 6969 2c20 6a6a 5d2e 696d 6167 2920  , ii, jj].imag) 
+00015b00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015b10: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00015b20: 2020 2020 2020 2020 2020 2020 7a5f 696d              z_im
+00015b30: 6167 203d 2074 6675 6e63 2028 7a5f 696d  ag = tfunc (z_im
+00015b40: 6167 2c20 0d0a 2020 2020 2020 2020 2020  ag, ..          
 00015b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b70: 7266 713d 6366 7265 712c 200d 0a20 2020  rfq=cfreq, ..   
+00015b60: 2020 2020 2020 2020 2020 7266 713d 6366            rfq=cf
+00015b70: 7265 712c 200d 0a20 2020 2020 2020 2020  req, ..         
 00015b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ba0: 2066 713d 7a66 7265 712c 200d 0a20 2020   fq=zfreq, ..   
+00015b90: 2020 2020 2020 2020 2020 2066 713d 7a66             fq=zf
+00015ba0: 7265 712c 200d 0a20 2020 2020 2020 2020  req, ..         
 00015bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015bd0: 2073 6c69 6365 5f3d 736c 6963 655f 2c20   slice_=slice_, 
-00015be0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015bc0: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
+00015bd0: 5f3d 736c 6963 655f 2c20 0d0a 2020 2020  _=slice_, ..    
+00015be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00015bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c00: 2020 2020 2020 6d65 7468 6f64 203d 6d65        method =me
-00015c10: 7468 6f64 2c20 0d0a 2020 2020 2020 2020  thod, ..        
+00015c00: 6d65 7468 6f64 203d 6d65 7468 6f64 2c20  method =method, 
+00015c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00015c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c40: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-00015c50: 2020 2020 2020 2020 207a 5f65 7272 203d           z_err =
-00015c60: 2072 6573 6861 7065 2865 6469 4f62 6a2e   reshape(ediObj.
-00015c70: 5a2e 7a5f 6572 725b 6e7a 5f69 6e64 6578  Z.z_err[nz_index
-00015c80: 2c20 6969 2c20 6a6a 5d29 200d 0a20 2020  , ii, jj]) ..   
-00015c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ca0: 207a 5f65 7272 203d 2074 6675 6e63 2028   z_err = tfunc (
-00015cb0: 7a5f 6572 722c 200d 0a20 2020 2020 2020  z_err, ..       
+00015c30: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00015c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015c50: 2020 207a 5f65 7272 203d 2072 6573 6861     z_err = resha
+00015c60: 7065 2865 6469 4f62 6a2e 5a2e 7a5f 6572  pe(ediObj.Z.z_er
+00015c70: 725b 6e7a 5f69 6e64 6578 2c20 6969 2c20  r[nz_index, ii, 
+00015c80: 6a6a 5d29 200d 0a20 2020 2020 2020 2020  jj]) ..         
+00015c90: 2020 2020 2020 2020 2020 207a 5f65 7272             z_err
+00015ca0: 203d 2074 6675 6e63 2028 7a5f 6572 722c   = tfunc (z_err,
+00015cb0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
 00015cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015cd0: 2020 2020 2020 2020 2020 2020 7266 713d              rfq=
-00015ce0: 6366 7265 712c 200d 0a20 2020 2020 2020  cfreq, ..       
+00015cd0: 2020 2020 2020 7266 713d 6366 7265 712c        rfq=cfreq,
+00015ce0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
 00015cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d00: 2020 2020 2020 2020 2020 2020 6671 3d7a              fq=z
-00015d10: 6672 6571 2c0d 0a20 2020 2020 2020 2020  freq,..         
+00015d00: 2020 2020 2020 6671 3d7a 6672 6571 2c0d        fq=zfreq,.
+00015d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00015d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d30: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
-00015d40: 5f3d 736c 6963 655f 202c 200d 0a20 2020  _=slice_ , ..   
+00015d30: 2020 2020 2073 6c69 6365 5f3d 736c 6963       slice_=slic
+00015d40: 655f 202c 200d 0a20 2020 2020 2020 2020  e_ , ..         
 00015d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d70: 206d 6574 686f 6420 3d6d 6574 686f 642c   method =method,
-00015d80: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00015d60: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00015d70: 6420 3d6d 6574 686f 642c 200d 0a20 2020  d =method, ..   
+00015d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00015d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015da0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-00015db0: 2020 2020 2020 2020 2020 2320 5573 6520            # Use 
-00015dc0: 7468 6520 6e65 7720 6469 6d65 6e73 696f  the new dimensio
-00015dd0: 6e20 6f66 2074 6865 207a 2061 6e64 2073  n of the z and s
-00015de0: 6c69 6365 207a 2061 6363 6f72 6469 6e67  lice z according
-00015df0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00015e00: 2020 2023 2074 6865 2062 7566 6665 7220     # the buffer 
-00015e10: 7261 6e67 652e 206d 616b 6520 7468 6520  range. make the 
-00015e20: 6e65 7720 696e 6465 7820 7374 6172 7420  new index start 
-00015e30: 6174 2030 2e20 0d0a 2020 2020 2020 2020  at 0. ..        
-00015e40: 2020 2020 2020 2020 6e65 775f 6e7a 5f69          new_nz_i
-00015e50: 6e64 6578 203d 2073 6c69 6365 2028 0d0a  ndex = slice (..
-00015e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e70: 2020 2020 2a20 6e70 2e61 7272 6179 285b      * np.array([
-00015e80: 6978 5f73 2c20 6978 5f65 6e64 5d2c 6474  ix_s, ix_end],dt
-00015e90: 7970 653d 6e70 2e69 6e74 3332 292d 6978  ype=np.int32)-ix
-00015ea0: 5f73 290d 0a20 2020 2020 0d0a 2020 2020  _s)..     ..    
-00015eb0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00015ec0: 5a2e 7a5b 6e65 775f 6e7a 5f69 6e64 6578  Z.z[new_nz_index
-00015ed0: 2c20 6969 2c20 6a6a 5d20 3d20 7265 7368  , ii, jj] = resh
-00015ee0: 6170 6528 0d0a 2020 2020 2020 2020 2020  ape(..          
-00015ef0: 2020 2020 2020 2020 2020 7a5f 7265 616c            z_real
-00015f00: 2c20 3129 2020 202b 2031 6a20 2a20 7265  , 1)   + 1j * re
-00015f10: 7368 6170 6528 7a5f 696d 6167 2c20 3129  shape(z_imag, 1)
-00015f20: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00015f30: 2020 206e 6577 5f5a 2e7a 5f65 7272 5b6e     new_Z.z_err[n
-00015f40: 6577 5f6e 7a5f 696e 6465 782c 2069 692c  ew_nz_index, ii,
-00015f50: 206a 6a5d 203d 2072 6573 6861 7065 287a   jj] = reshape(z
-00015f60: 5f65 7272 2c20 3129 0d0a 2020 2020 2020  _err, 1)..      
-00015f70: 2020 2320 636f 6d70 7574 6520 7265 7369    # compute resi
-00015f80: 7374 6976 6974 7920 616e 6420 7068 6173  stivity and phas
-00015f90: 6520 666f 7220 6e65 7720 5a20 6f62 6a65  e for new Z obje
-00015fa0: 6374 0d0a 2020 2020 2020 2020 6e65 775f  ct..        new_
-00015fb0: 5a2e 636f 6d70 7574 655f 7265 7369 7374  Z.compute_resist
-00015fc0: 6976 6974 795f 7068 6173 6528 290d 0a20  ivity_phase().. 
-00015fd0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00015fe0: 775f 5a20 0d0a 0d0a 2020 2020 4073 7461  w_Z ....    @sta
-00015ff0: 7469 636d 6574 686f 6420 0d0a 2020 2020  ticmethod ..    
-00016000: 6465 6620 6672 6571 496e 7465 7270 6f6c  def freqInterpol
-00016010: 6174 696f 6e20 280d 0a20 2020 2020 2020  ation (..       
-00016020: 2079 3a41 7272 6179 4c69 6b65 5b44 5479   y:ArrayLike[DTy
-00016030: 7065 5b54 5d5d 202c 0d0a 2020 2020 2020  pe[T]] ,..      
-00016040: 2020 2f2c 200d 0a20 2020 2020 2020 2062    /, ..        b
-00016050: 7566 6665 723a 4f70 7469 6f6e 616c 5b54  uffer:Optional[T
-00016060: 7570 6c65 5b66 6c6f 6174 5d5d 203d 204e  uple[float]] = N
-00016070: 6f6e 6520 2c20 200d 0a20 2020 2020 2020  one ,  ..       
-00016080: 206b 696e 643a 2073 7472 2020 3d27 6672   kind: str  ='fr
-00016090: 6571 2720 0d0a 2020 2020 2020 2020 292d  eq' ..        )-
-000160a0: 3e20 4172 7261 794c 696b 655b 4454 7970  > ArrayLike[DTyp
-000160b0: 655b 545d 5d3a 200d 0a20 2020 2020 2020  e[T]]: ..       
-000160c0: 2022 2222 2049 6e74 6572 706f 6c61 7465   """ Interpolate
-000160d0: 2066 7265 7175 656e 6379 2069 6e20 6672   frequency in fr
-000160e0: 6571 7565 6e79 2062 7566 6665 7220 7261  equeny buffer ra
-000160f0: 6e67 652e 2020 0d0a 2020 2020 2020 2020  nge.  ..        
-00016100: 0d0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00016110: 2079 3a20 6172 7261 792d 6c69 6b65 2c20   y: array-like, 
-00016120: 7368 6170 6528 4e2c 2029 202d 2043 616e  shape(N, ) - Can
-00016130: 2062 6520 6120 6672 6571 7565 6e63 7920   be a frequency 
-00016140: 6172 7261 7920 6f72 2070 6572 696f 6473  array or periods
-00016150: 0d0a 2020 2020 2020 2020 2020 2020 6e6f  ..            no
-00016160: 7465 2074 6861 7420 7468 6520 6672 6571  te that the freq
-00016170: 7565 6e63 7920 6973 206e 6f74 2069 6e20  uency is not in 
-00016180: 6c6f 6731 3020 487a 2e20 0d0a 2020 2020  log10 Hz. ..    
-00016190: 2020 2020 3a70 6172 616d 2062 7566 6665      :param buffe
-000161a0: 723a 206c 6973 7420 6f66 206d 6178 696d  r: list of maxim
-000161b0: 756d 2061 6e64 206d 696e 696d 756d 2066  um and minimum f
-000161c0: 7265 7175 656e 6379 2e20 4974 2073 686f  requency. It sho
-000161d0: 756c 6420 636f 6e74 6169 6e73 200d 0a20  uld contains .. 
-000161e0: 2020 2020 2020 2020 2020 206f 6e6c 7920             only 
-000161f0: 7477 6f20 7661 6c75 6573 2e20 4966 2060  two values. If `
-00016200: 4e6f 6e65 602c 2074 6865 206d 6178 2061  None`, the max a
-00016210: 6e64 206d 696e 2066 7265 7175 656e 6369  nd min frequenci
-00016220: 6573 2061 7265 2075 7365 6420 0d0a 2020  es are used ..  
-00016230: 2020 2020 2020 3a70 6172 616d 206b 696e        :param kin
-00016240: 643a 2073 7472 200d 0a20 2020 2020 2020  d: str ..       
-00016250: 2020 2020 2074 7970 6520 6f66 2067 6976       type of giv
-00016260: 656e 2064 6174 612e 2043 616e 2062 6520  en data. Can be 
-00016270: 2770 6572 696f 6427 2020 6966 2074 6865  'period'  if the
-00016280: 2076 616c 7565 2069 7320 6769 7665 6e20   value is given 
-00016290: 6173 2070 6572 696f 6473 200d 0a20 2020  as periods ..   
-000162a0: 2020 2020 2020 2020 206f 7220 2766 7265           or 'fre
-000162b0: 7175 656e 6379 2720 6f74 6865 7277 6973  quency' otherwis
-000162c0: 652e 2041 6e79 206f 7468 6572 2076 616c  e. Any other val
-000162d0: 7565 2073 686f 756c 6420 6265 2063 6f6e  ue should be con
-000162e0: 7369 6465 7265 6420 6173 2061 0d0a 2020  sidered as a..  
-000162f0: 2020 2020 2020 2020 2020 6672 6571 7565            freque
-00016300: 6e63 7920 7661 6c75 6573 2e20 0d0a 2020  ncy values. ..  
-00016310: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00016320: 2020 2020 3a72 6574 7572 6e3a 2061 7272      :return: arr
-00016330: 6179 5f6c 696b 652c 2073 6861 7065 2028  ay_like, shape (
-00016340: 4e32 2c20 2920 0d0a 2020 2020 2020 2020  N2, ) ..        
-00016350: 2020 2020 4e65 7720 696e 7465 7270 6f6c      New interpol
-00016360: 6174 6564 2066 7265 7175 656e 6379 2077  ated frequency w
-00016370: 6974 6820 4e32 2073 697a 6520 0d0a 2020  ith N2 size ..  
-00016380: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00016390: 2020 2020 3a65 7861 6d70 6c65 3a20 0d0a      :example: ..
-000163a0: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-000163b0: 6672 6f6d 2077 6174 6578 2e6d 6574 686f  from watex.metho
-000163c0: 6473 2e65 6d20 696d 706f 7274 2050 726f  ds.em import Pro
-000163d0: 6365 7373 696e 670d 0a20 2020 2020 2020  cessing..       
-000163e0: 2020 2020 203e 3e3e 2070 6f62 6a20 3d20       >>> pobj = 
-000163f0: 5072 6f63 6573 7369 6e67 2829 2e66 6974  Processing().fit
-00016400: 2827 6461 7461 2f65 6469 7327 290d 0a20  ('data/edis').. 
-00016410: 2020 2020 2020 2020 2020 203e 3e3e 2066             >>> f
-00016420: 203d 2067 6574 6675 6c6c 6672 6571 7565   = getfullfreque
-00016430: 6e63 7920 2870 6f62 6a2e 6564 694f 626a  ncy (pobj.ediObj
-00016440: 735f 290d 0a20 2020 2020 2020 2020 2020  s_)..           
-00016450: 203e 3e3e 2062 7566 6665 7220 3d20 5b35   >>> buffer = [5
-00016460: 2e38 3630 3030 652b 3034 2c20 312e 3633  .86000e+04, 1.63
-00016470: 3030 652b 3031 5d0d 0a20 2020 2020 2020  00e+01]..       
-00016480: 2020 2020 203e 3e3e 2066 200d 0a20 2020       >>> f ..   
-00016490: 2020 2020 2020 2020 202e 2e2e 2061 7272           ... arr
-000164a0: 6179 285b 372e 3030 3030 3065 2b30 342c  ay([7.00000e+04,
-000164b0: 2035 2e38 3830 3030 652b 3034 2c20 342e   5.88000e+04, 4.
-000164c0: 3935 3030 3065 2b30 342c 2034 2e31 3630  95000e+04, 4.160
-000164d0: 3030 652b 3034 2c20 332e 3530 3030 3065  00e+04, 3.50000e
-000164e0: 2b30 342c 0d0a 2020 2020 2020 2020 2020  +04,..          
-000164f0: 2020 2020 2020 2020 2032 2e39 3430 3030           2.94000
-00016500: 652b 3034 2c20 322e 3437 3030 3065 2b30  e+04, 2.47000e+0
-00016510: 342c 2032 2e30 3830 3030 652b 3034 2c20  4, 2.08000e+04, 
-00016520: 312e 3735 3030 3065 2b30 342c 2031 2e34  1.75000e+04, 1.4
-00016530: 3730 3030 652b 3034 2c0d 0a20 2020 2020  7000e+04,..     
-00016540: 2020 2020 2020 2020 2020 2020 2020 2e2e                ..
-00016550: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00016560: 2020 2020 2020 322e 3735 3030 3065 2b30        2.75000e+0
-00016570: 312c 2032 2e32 3530 3030 652b 3031 2c20  1, 2.25000e+01, 
-00016580: 312e 3837 3530 3065 2b30 312c 2031 2e36  1.87500e+01, 1.6
-00016590: 3235 3030 652b 3031 2c20 312e 3337 3530  2500e+01, 1.3750
-000165a0: 3065 2b30 312c 0d0a 2020 2020 2020 2020  0e+01,..        
-000165b0: 2020 2020 2020 2020 2020 2031 2e31 3235             1.125
-000165c0: 3030 652b 3031 2c20 392e 3337 3530 3065  00e+01, 9.37500e
-000165d0: 2b30 302c 2038 2e31 3235 3030 652b 3030  +00, 8.12500e+00
-000165e0: 2c20 362e 3837 3530 3065 2b30 302c 2035  , 6.87500e+00, 5
-000165f0: 2e36 3235 3030 652b 3030 5d29 0d0a 2020  .62500e+00])..  
-00016600: 2020 2020 2020 2020 2020 3e3e 3e20 6e65            >>> ne
-00016610: 775f 6620 3d20 6672 6571 496e 7465 7270  w_f = freqInterp
-00016620: 6f6c 6174 696f 6e28 662c 2062 7566 6665  olation(f, buffe
-00016630: 7220 3d20 6275 6666 6572 290d 0a20 2020  r = buffer)..   
-00016640: 2020 2020 2020 2020 203e 3e3e 206e 6577           >>> new
-00016650: 5f66 200d 0a20 2020 2020 2020 2020 2020  _f ..           
-00016660: 202e 2e2e 2061 7272 6179 285b 352e 3838   ... array([5.88
-00016670: 3030 3030 3030 652b 3034 2c20 342e 3933  000000e+04, 4.93
-00016680: 3932 3834 3539 652b 3034 2c20 342e 3134  928459e+04, 4.14
-00016690: 3930 3730 3132 652b 3034 2c20 332e 3438  907012e+04, 3.48
-000166a0: 3532 3738 3539 652b 3034 2c0d 0a20 2020  527859e+04,..   
-000166b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000166c0: 322e 3932 3736 3834 3136 652b 3034 2c20  2.92768416e+04, 
-000166d0: 322e 3435 3932 3936 3831 652b 3034 2c20  2.45929681e+04, 
-000166e0: 322e 3036 3538 3434 3731 652b 3034 2c20  2.06584471e+04, 
-000166f0: 312e 3733 3533 3339 3237 652b 3034 2c0d  1.73533927e+04,.
-00016700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016710: 2020 2020 2e2e 2e0d 0a20 2020 2020 2020      .....       
-00016720: 2020 2020 2020 2020 2020 2020 322e 3734              2.74
-00016730: 3135 3331 3230 652b 3031 2c20 322e 3330  153120e+01, 2.30
-00016740: 3239 3235 3635 652b 3031 2c20 312e 3933  292565e+01, 1.93
-00016750: 3434 3930 3638 652b 3031 2c20 312e 3632  449068e+01, 1.62
-00016760: 3530 3030 3030 652b 3031 5d29 0d0a 2020  500000e+01])..  
-00016770: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-00016780: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00016790: 2020 2020 206b 696e 6420 3d73 7472 2028       kind =str (
-000167a0: 6b69 6e64 292e 6c6f 7765 7228 292e 7374  kind).lower().st
-000167b0: 7269 7028 2920 0d0a 2020 2020 2020 2020  rip() ..        
-000167c0: 6966 206b 696e 642e 6669 6e64 2827 7065  if kind.find('pe
-000167d0: 7269 2729 3e3d 3020 3a0d 0a20 2020 2020  ri')>=0 :..     
-000167e0: 2020 2020 2020 206b 696e 6420 3d27 7065         kind ='pe
-000167f0: 7269 6f64 7327 0d0a 2020 2020 2020 2020  riods'..        
-00016800: 7920 3d20 312e 2f20 6e70 2e61 7272 6179  y = 1./ np.array
-00016810: 2028 7929 2069 6620 6b69 6e64 203d 3d27   (y) if kind =='
-00016820: 7065 7269 6f64 7327 2065 6c73 6520 206e  periods' else  n
-00016830: 702e 6172 7261 7920 2879 290d 0a20 2020  p.array (y)..   
-00016840: 2020 2020 200d 0a20 2020 2020 2020 2062       ..        b
-00016850: 7566 6665 7220 3d20 5072 6f63 6573 7369  uffer = Processi
-00016860: 6e67 2e63 6f6e 7472 6f6c 4672 6571 7565  ng.controlFreque
-00016870: 6e63 7942 7566 6665 7228 792c 2062 7566  ncyBuffer(y, buf
-00016880: 6665 7220 2920 0d0a 2020 2020 2020 2020  fer ) ..        
-00016890: 6978 5f73 2c20 6978 5f65 6e64 2020 3d20  ix_s, ix_end  = 
-000168a0: 206e 702e 6172 6777 6865 7265 2028 6e70   np.argwhere (np
-000168b0: 2e69 7369 6e28 792c 2062 7566 6665 7229  .isin(y, buffer)
-000168c0: 2920 0d0a 2020 2020 0d0a 2020 2020 2020  ) ..    ..      
-000168d0: 2020 7920 3d20 795b 736c 6963 6520 2820    y = y[slice ( 
-000168e0: 696e 7428 6978 5f73 292c 2069 6e74 2869  int(ix_s), int(i
-000168f0: 785f 656e 6429 202b 3129 5d0d 0a20 2020  x_end) +1)]..   
-00016900: 2020 2020 2023 2070 7574 2066 7265 7175       # put frequ
-00016910: 656e 6379 2069 6e20 6c6f 6773 7061 6365  ency in logspace
-00016920: 2061 6e64 2072 6574 7572 6e0d 0a20 2020   and return..   
-00016930: 2020 2020 2023 2074 6865 2073 616d 6520       # the same 
-00016940: 6f72 6465 7220 6c69 6b65 2074 6865 2069  order like the i
-00016950: 6e70 7574 2076 616c 7565 0d0a 2020 2020  nput value..    
-00016960: 2020 2020 7920 3d20 6e70 2e6c 6f67 3130      y = np.log10
-00016970: 2028 7929 0d0a 2020 2020 2020 2020 6966   (y)..        if
-00016980: 2079 5b30 5d20 3c20 795b 2d31 5d3a 200d   y[0] < y[-1]: .
-00016990: 0a20 2020 2020 2020 2020 2020 2066 203d  .            f =
-000169a0: 206e 702e 6c6f 6773 7061 6365 2879 2e6d   np.logspace(y.m
-000169b0: 696e 2829 202c 792e 6d61 7828 2920 2c20  in() ,y.max() , 
-000169c0: 6c65 6e28 7929 290d 0a20 2020 2020 2020  len(y))..       
-000169d0: 2065 6c73 6520 3a20 0d0a 2020 2020 2020   else : ..      
-000169e0: 2020 2020 2020 6620 3d20 6e70 2e6c 6f67        f = np.log
-000169f0: 7370 6163 6528 792e 6d69 6e28 292c 792e  space(y.min(),y.
-00016a00: 6d61 7828 2920 2c20 6c65 6e28 7929 295b  max() , len(y))[
-00016a10: 3a3a 2d31 5d0d 0a20 2020 2020 2020 200d  ::-1]..        .
-00016a20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00016a30: 6620 0d0a 2020 2020 0d0a 2020 2020 4073  f ..    ..    @s
-00016a40: 7461 7469 636d 6574 686f 6420 0d0a 2020  taticmethod ..  
-00016a50: 2020 6465 6620 636f 6e74 726f 6c46 7265    def controlFre
-00016a60: 7175 656e 6379 4275 6666 6572 2028 0d0a  quencyBuffer (..
-00016a70: 2020 2020 2020 2020 6672 6571 3a20 4172          freq: Ar
-00016a80: 7261 794c 696b 655b 4454 7970 655b 545d  rayLike[DType[T]
-00016a90: 5d2c 200d 0a20 2020 2020 2020 2062 7566  ], ..        buf
-00016aa0: 6665 723a 4f70 7469 6f6e 616c 5b54 7570  fer:Optional[Tup
-00016ab0: 6c65 5b66 6c6f 6174 5d5d 203d 204e 6f6e  le[float]] = Non
-00016ac0: 6520 0d0a 2020 2020 2020 2020 292d 3e20  e ..        )-> 
-00016ad0: 4172 7261 794c 696b 655b 4454 7970 655b  ArrayLike[DType[
-00016ae0: 545d 5d20 3a0d 0a20 2020 2020 2020 2022  T]] :..        "
-00016af0: 2222 2041 7373 6572 7420 6275 6666 6572  "" Assert buffer
-00016b00: 2061 6e64 2066 696e 6420 7468 6520 6e65   and find the ne
-00016b10: 6172 6573 7420 7661 6c75 6520 6966 2074  arest value if t
-00016b20: 6865 200d 0a20 2020 2020 2020 2076 616c  he ..        val
-00016b30: 7565 206f 6620 7468 6520 6275 6666 6572  ue of the buffer
-00016b40: 2069 7320 6e6f 7420 696e 2066 7265 7175   is not in frequ
-00016b50: 656e 6379 2072 616e 6765 7320 2e0d 0a20  ency ranges ... 
-00016b60: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00016b70: 203a 7061 7261 6d20 6672 6571 3a20 6172   :param freq: ar
-00016b80: 7261 792d 6c69 6b65 206f 6620 6672 6571  ray-like of freq
-00016b90: 7565 6e63 6965 7320 0d0a 2020 2020 2020  uencies ..      
-00016ba0: 2020 3a70 6172 616d 2062 7566 6665 723a    :param buffer:
-00016bb0: 206c 6973 7420 6f66 206d 6178 696d 756d   list of maximum
-00016bc0: 2061 6e64 206d 696e 696d 756d 2066 7265   and minimum fre
-00016bd0: 7175 656e 6379 2e20 4974 2073 686f 756c  quency. It shoul
-00016be0: 6420 636f 6e74 6169 6e73 200d 0a20 2020  d contains ..   
-00016bf0: 2020 2020 2020 2020 206f 6e6c 7920 7477           only tw
-00016c00: 6f20 7661 6c75 6573 2e20 4966 2060 4e6f  o values. If `No
-00016c10: 6e65 602c 2074 6865 206d 6178 2061 6e64  ne`, the max and
-00016c20: 206d 696e 2066 7265 7175 656e 6369 6573   min frequencies
-00016c30: 2061 7265 2073 656c 6563 7465 6420 0d0a   are selected ..
-00016c40: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-00016c50: 3a20 4275 6666 6572 2066 7265 7175 656e  : Buffer frequen
-00016c60: 6379 2072 616e 6765 200d 0a20 2020 2020  cy range ..     
-00016c70: 2020 200d 0a20 2020 2020 2020 203a 4578     ..        :Ex
-00016c80: 616d 706c 653a 200d 0a20 2020 2020 2020  ample: ..       
-00016c90: 203e 3e3e 2069 6d70 6f72 7420 6e75 6d70   >>> import nump
-00016ca0: 7920 6173 206e 7020 0d0a 2020 2020 2020  y as np ..      
-00016cb0: 2020 3e3e 3e20 6672 6f6d 2077 6174 6578    >>> from watex
-00016cc0: 2e6d 6574 686f 6473 2e65 6d20 696d 706f  .methods.em impo
-00016cd0: 7274 2050 726f 6365 7373 696e 670d 0a20  rt Processing.. 
-00016ce0: 2020 2020 2020 203e 3e3e 2066 7265 715f         >>> freq_
-00016cf0: 203d 206e 702e 6c69 6e73 7061 6365 2837   = np.linspace(7
-00016d00: 6537 2c20 3165 302c 2032 3029 2023 2032  e7, 1e0, 20) # 2
-00016d10: 3020 6672 6571 7565 6e63 6965 7320 6173  0 frequencies as
-00016d20: 2072 6566 6572 656e 6365 0d0a 2020 2020   reference..    
-00016d30: 2020 2020 3e3e 3e20 6275 6666 6572 203d      >>> buffer =
-00016d40: 2050 726f 6365 7373 696e 672e 636f 6e74   Processing.cont
-00016d50: 726f 6c46 7265 7175 656e 6379 4275 6666  rolFrequencyBuff
-00016d60: 6572 2866 7265 715f 2c20 6275 6666 6572  er(freq_, buffer
-00016d70: 203d 5b35 2e37 3065 372c 2032 6531 5d29   =[5.70e7, 2e1])
-00016d80: 0d0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-00016d90: 6571 5f20 0d0a 2020 2020 2020 2020 2e2e  eq_ ..        ..
-00016da0: 2e20 6172 7261 7928 5b37 2e30 3030 3030  . array([7.00000
-00016db0: 3030 3065 2b30 372c 2036 2e36 3331 3537  000e+07, 6.63157
-00016dc0: 3839 3565 2b30 372c 2036 2e32 3633 3135  895e+07, 6.26315
-00016dd0: 3739 3165 2b30 372c 2035 2e38 3934 3733  791e+07, 5.89473
-00016de0: 3638 3665 2b30 372c 0d0a 2020 2020 2020  686e+07,..      
-00016df0: 2020 2020 2020 2020 2035 2e35 3236 3331           5.52631
-00016e00: 3538 3165 2b30 372c 2035 2e31 3537 3839  581e+07, 5.15789
-00016e10: 3437 3665 2b30 372c 2034 2e37 3839 3437  476e+07, 4.78947
-00016e20: 3337 3265 2b30 372c 2034 2e34 3231 3035  372e+07, 4.42105
-00016e30: 3236 3765 2b30 372c 0d0a 2020 2020 2020  267e+07,..      
-00016e40: 2020 2020 2020 2020 2034 2e30 3532 3633           4.05263
-00016e50: 3136 3265 2b30 372c 2033 2e36 3834 3231  162e+07, 3.68421
-00016e60: 3035 3765 2b30 372c 2033 2e33 3135 3738  057e+07, 3.31578
-00016e70: 3935 3365 2b30 372c 2032 2e39 3437 3336  953e+07, 2.94736
-00016e80: 3834 3865 2b30 372c 0d0a 2020 2020 2020  848e+07,..      
-00016e90: 2020 2020 2020 2020 2032 2e35 3738 3934           2.57894
-00016ea0: 3734 3365 2b30 372c 2032 2e32 3130 3532  743e+07, 2.21052
-00016eb0: 3633 3865 2b30 372c 2031 2e38 3432 3130  638e+07, 1.84210
-00016ec0: 3533 3465 2b30 372c 2031 2e34 3733 3638  534e+07, 1.47368
-00016ed0: 3432 3965 2b30 372c 0d0a 2020 2020 2020  429e+07,..      
-00016ee0: 2020 2020 2020 2020 2031 2e31 3035 3236           1.10526
-00016ef0: 3332 3465 2b30 372c 2037 2e33 3638 3432  324e+07, 7.36842
-00016f00: 3139 3565 2b30 362c 2033 2e36 3834 3231  195e+06, 3.68421
-00016f10: 3134 3765 2b30 362c 2031 2e30 3030 3030  147e+06, 1.00000
-00016f20: 3030 3065 2b30 305d 290d 0a20 2020 2020  000e+00])..     
-00016f30: 2020 203e 3e3e 2062 7566 6665 7220 0d0a     >>> buffer ..
-00016f40: 2020 2020 2020 2020 2e2e 2e20 6172 7261          ... arra
-00016f50: 7928 5b35 2e35 3236 3331 3538 3165 2b30  y([5.52631581e+0
-00016f60: 372c 2031 2e30 3030 3030 3030 3065 2b30  7, 1.00000000e+0
-00016f70: 305d 290d 0a20 2020 2020 2020 200d 0a20  0])..        .. 
-00016f80: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00016f90: 2020 2020 6d73 6720 3d28 2242 7566 6665      msg =("Buffe
-00016fa0: 7220 666f 7220 6672 6571 7565 6e63 7920  r for frequency 
-00016fb0: 6578 7065 6374 7320 7477 6f20 7661 6c75  expects two valu
-00016fc0: 6573 2028 276d 6178 272c 2027 6d69 6e27  es ('max', 'min'
-00016fd0: 292e 2022 290d 0a20 2020 2020 2020 200d  ). ")..        .
-00016fe0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00016ff0: 6861 7361 7474 7220 2866 7265 712c 2027  hasattr (freq, '
-00017000: 5f5f 6172 7261 795f 5f27 293a 200d 0a20  __array__'): .. 
-00017010: 2020 2020 2020 2020 2020 2066 7265 7120             freq 
-00017020: 3d20 6e70 2e61 7272 6179 2866 7265 7120  = np.array(freq 
-00017030: 2c20 6474 7970 6520 3d20 6e70 2e66 6c6f  , dtype = np.flo
-00017040: 6174 3634 2029 0d0a 2020 2020 2020 2020  at64 )..        
-00017050: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
-00017060: 2062 7566 6665 7220 6973 204e 6f6e 653a   buffer is None:
-00017070: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-00017080: 6574 7572 6e20 6e70 2e61 7272 6179 285b  eturn np.array([
-00017090: 6672 6571 2e6d 6178 2829 2c20 6672 6571  freq.max(), freq
-000170a0: 2e6d 696e 2829 5d29 0d0a 2020 2020 2020  .min()])..      
-000170b0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000170c0: 6966 2028 200d 0a20 2020 2020 2020 2020  if ( ..         
-000170d0: 2020 2020 2020 2069 7369 6e73 7461 6e63         isinstanc
-000170e0: 6520 2862 7566 6665 722c 2073 7472 2920  e (buffer, str) 
-000170f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00017100: 2020 6f72 206e 6f74 2068 6173 6174 7472    or not hasattr
-00017110: 2862 7566 6665 7220 2c20 275f 5f69 7465  (buffer , '__ite
-00017120: 725f 5f27 290d 0a20 2020 2020 2020 2020  r__')..         
-00017130: 2020 2020 2020 2029 3a20 0d0a 2020 2020         ): ..    
-00017140: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00017150: 6c75 6545 7272 6f72 286d 7367 202b 2066  lueError(msg + f
-00017160: 2242 7574 207b 7479 7065 2028 6275 6666  "But {type (buff
-00017170: 6572 292e 5f5f 6e61 6d65 5f5f 2172 7d20  er).__name__!r} 
-00017180: 6973 2067 6976 656e 2229 0d0a 2020 2020  is given")..    
-00017190: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000171a0: 2020 6966 206c 656e 2862 7566 6665 7229    if len(buffer)
-000171b0: 203c 2032 3a20 0d0a 2020 2020 2020 2020   < 2: ..        
-000171c0: 2020 2020 7261 6973 6520 4672 6571 7565      raise Freque
-000171d0: 6e63 7945 7272 6f72 2028 6d73 6720 2b20  ncyError (msg + 
-000171e0: 6622 476f 7420 7b6c 656e 2862 7566 6665  f"Got {len(buffe
-000171f0: 7229 7d2e 2229 200d 0a20 2020 2020 2020  r)}.") ..       
-00017200: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-00017210: 6620 6c65 6e28 6275 6666 6572 2029 203e  f len(buffer ) >
-00017220: 2032 3a20 0d0a 2020 2020 2020 2020 2020   2: ..          
-00017230: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-00017240: 6d73 6720 2b20 0d0a 2020 2020 2020 2020  msg + ..        
-00017250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017260: 2020 6622 476f 7420 7b6c 656e 2862 7566    f"Got {len(buf
-00017270: 6665 7229 7d2e 2054 6865 2066 7265 7175  fer)}. The frequ
-00017280: 656e 6369 6573 220d 0a20 2020 2020 2020  encies"..       
-00017290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000172a0: 2020 2066 2220 2728 7b6d 6178 2862 7566     f" '({max(buf
-000172b0: 6665 7229 2c20 6d69 6e28 6275 6666 6572  fer), min(buffer
-000172c0: 297d 2927 2073 686f 756c 6420 6265 2022  )})' should be "
-000172d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000172e0: 2020 2020 2020 2020 2020 2020 2275 7365              "use
-000172f0: 6420 6173 2028 276d 6178 272c 2027 6d69  d as ('max', 'mi
-00017300: 6e27 2920 696e 7374 6561 642e 2229 0d0a  n') instead.")..
-00017310: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00017320: 2020 2020 2020 6275 6666 6572 203d 206e        buffer = n
-00017330: 702e 6172 7261 7920 2820 5b20 6d61 7828  p.array ( [ max(
-00017340: 6275 6666 6572 292c 206d 696e 2862 7566  buffer), min(buf
-00017350: 6665 7229 5d20 290d 0a20 2020 2020 2020  fer)] )..       
-00017360: 200d 0a20 2020 2020 2020 2069 6620 6e6f   ..        if no
-00017370: 7420 6861 7361 7474 7228 6275 6666 6572  t hasattr(buffer
-00017380: 2c20 275f 5f61 7272 6179 5f5f 2729 3a20  , '__array__'): 
-00017390: 0d0a 2020 2020 2020 2020 2020 2020 6275  ..            bu
-000173a0: 6666 6572 203d 206e 702e 6172 7261 7920  ffer = np.array 
-000173b0: 2820 6275 6666 6572 2029 200d 0a20 2020  ( buffer ) ..   
-000173c0: 2020 2020 2020 2020 2023 6275 6666 6572           #buffer
-000173d0: 2e73 6f72 7428 2920 2320 666f 7220 636f  .sort() # for co
-000173e0: 6e73 6973 7465 6e63 7920 0d0a 2020 2020  nsistency ..    
-000173f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00017400: 2020 6966 2028 200d 0a20 2020 2020 2020    if ( ..       
-00017410: 2020 2020 2020 2020 2062 7566 6665 722e           buffer.
-00017420: 6d69 6e28 2920 3c20 6672 6571 2e6d 696e  min() < freq.min
-00017430: 2829 200d 0a20 2020 2020 2020 2020 2020  () ..           
-00017440: 2020 2020 206f 7220 6275 6666 6572 2e6d       or buffer.m
-00017450: 6178 2028 2920 3e20 6672 6571 2e6d 6178  ax () > freq.max
-00017460: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00017470: 2020 2020 293a 200d 0a20 2020 2020 2020      ): ..       
-00017480: 2020 2020 2072 6169 7365 2046 7265 7175       raise Frequ
-00017490: 656e 6379 4572 726f 7220 280d 0a20 2020  encyError (..   
-000174a0: 2020 2020 2020 2020 2020 2020 2066 2242               f"B
-000174b0: 7566 6665 7220 6672 6571 7565 6e63 7920  uffer frequency 
-000174c0: 277b 2862 7566 6665 722e 6d61 7828 292c  '{(buffer.max(),
-000174d0: 2062 7566 6665 722e 6d69 6e28 2929 7d27   buffer.min())}'
-000174e0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-000174f0: 2020 2022 2069 7320 6f75 7420 6f66 2074     " is out of t
-00017500: 6865 2072 616e 6765 2e20 4578 7065 6374  he range. Expect
-00017510: 2066 7265 7175 656e 6369 6573 2062 6522   frequencies be"
-00017520: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00017530: 2020 6622 2077 6974 6869 6e20 7b28 6672    f" within {(fr
-00017540: 6571 2e6d 696e 2829 2c66 7265 712e 6d61  eq.min(),freq.ma
-00017550: 7828 2929 7d22 0d0a 2020 2020 2020 2020  x())}"..        
-00017560: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-00017570: 2020 2023 2054 6865 2062 7566 6665 7220     # The buffer 
-00017580: 646f 6573 206e 6f74 206e 6565 6420 746f  does not need to
-00017590: 2066 6974 2074 6865 2065 7861 6374 200d   fit the exact .
-000175a0: 0a20 2020 2020 2020 2023 2066 7265 7175  .        # frequ
-000175b0: 656e 6379 2076 616c 7565 2069 6e20 7468  ency value in th
-000175c0: 6520 6672 6571 7565 6e63 7920 6461 7461  e frequency data
-000175d0: 2e20 0d0a 2020 2020 2020 2020 2320 436f  . ..        # Co
-000175e0: 756c 6420 4669 6e64 2074 6865 2061 6273  uld Find the abs
-000175f0: 6f6c 7574 6520 6469 6666 6572 656e 6365  olute difference
-00017600: 2077 6974 6820 6561 6368 2076 616c 7565   with each value
-00017610: 2020 200d 0a20 2020 2020 2020 2023 2047     ..        # G
-00017620: 6574 2074 6865 2069 6e64 6578 206f 6620  et the index of 
-00017630: 7468 6520 736d 616c 6c65 7374 2061 6273  the smallest abs
-00017640: 6f6c 7574 6520 6469 6666 6572 656e 6365  olute difference
-00017650: 2e20 0d0a 2020 2020 2020 2020 6d69 6e66  . ..        minf
-00017660: 203d 2066 7265 7120 205b 206e 702e 6162   = freq  [ np.ab
-00017670: 7320 2866 7265 7120 2d20 6275 6666 6572  s (freq - buffer
-00017680: 2e6d 696e 2829 292e 6172 676d 696e 2829  .min()).argmin()
-00017690: 205d 2020 0d0a 2020 2020 2020 2020 6d61   ]  ..        ma
-000176a0: 7866 203d 2066 7265 7120 205b 206e 702e  xf = freq  [ np.
-000176b0: 6162 7320 2866 7265 7120 2d20 6275 6666  abs (freq - buff
-000176c0: 6572 2e6d 6178 2829 292e 6172 676d 696e  er.max()).argmin
-000176d0: 2829 205d 2020 0d0a 2020 2020 2020 2020  () ]  ..        
-000176e0: 6275 6666 6572 203d 206e 702e 6172 7261  buffer = np.arra
-000176f0: 7920 2820 5b20 6d61 7866 202c 206d 696e  y ( [ maxf , min
-00017700: 6620 5d20 2920 0d0a 2020 2020 2020 2020  f ] ) ..        
-00017710: 0d0a 2020 2020 2020 2020 2320 6966 206d  ..        # if m
-00017720: 696e 2061 6e64 206d 6178 2066 7265 7175  in and max frequ
-00017730: 656e 6379 2061 7265 0d0a 2020 2020 2020  ency are..      
-00017740: 2020 2320 6964 656e 7469 6361 6c20 2c20    # identical , 
-00017750: 7261 6973 6520 6572 726f 7220 0d0a 2020  raise error ..  
-00017760: 2020 2020 2020 6966 206c 656e 2820 7365        if len( se
-00017770: 7428 6275 6666 6572 2929 2020 213d 323a  t(buffer))  !=2:
-00017780: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-00017790: 6169 7365 2046 7265 7175 656e 6379 4572  aise FrequencyEr
-000177a0: 726f 7220 2822 4672 6571 7565 6e63 7920  ror ("Frequency 
-000177b0: 6275 6666 6572 2028 276d 6178 272c 2027  buffer ('max', '
-000177c0: 6d69 6e27 2920 7368 6f75 6c64 220d 0a20  min') should".. 
+00015da0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+00015db0: 2020 2020 2320 5573 6520 7468 6520 6e65      # Use the ne
+00015dc0: 7720 6469 6d65 6e73 696f 6e20 6f66 2074  w dimension of t
+00015dd0: 6865 207a 2061 6e64 2073 6c69 6365 207a  he z and slice z
+00015de0: 2061 6363 6f72 6469 6e67 200d 0a20 2020   according ..   
+00015df0: 2020 2020 2020 2020 2020 2020 2023 2074               # t
+00015e00: 6865 2062 7566 6665 7220 7261 6e67 652e  he buffer range.
+00015e10: 206d 616b 6520 7468 6520 6e65 7720 696e   make the new in
+00015e20: 6465 7820 7374 6172 7420 6174 2030 2e20  dex start at 0. 
+00015e30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015e40: 2020 6e65 775f 6e7a 5f69 6e64 6578 203d    new_nz_index =
+00015e50: 2073 6c69 6365 2028 0d0a 2020 2020 2020   slice (..      
+00015e60: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
+00015e70: 6e70 2e61 7272 6179 285b 6978 5f73 2c20  np.array([ix_s, 
+00015e80: 6978 5f65 6e64 5d2c 6474 7970 653d 6e70  ix_end],dtype=np
+00015e90: 2e69 6e74 3332 292d 6978 5f73 290d 0a20  .int32)-ix_s).. 
+00015ea0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00015eb0: 2020 2020 2020 6e65 775f 5a2e 7a5b 6e65        new_Z.z[ne
+00015ec0: 775f 6e7a 5f69 6e64 6578 2c20 6969 2c20  w_nz_index, ii, 
+00015ed0: 6a6a 5d20 3d20 7265 7368 6170 6528 0d0a  jj] = reshape(..
+00015ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ef0: 2020 2020 7a5f 7265 616c 2c20 3129 2020      z_real, 1)  
+00015f00: 202b 2031 6a20 2a20 7265 7368 6170 6528   + 1j * reshape(
+00015f10: 7a5f 696d 6167 2c20 3129 200d 0a20 2020  z_imag, 1) ..   
+00015f20: 2020 2020 2020 2020 2020 2020 206e 6577               new
+00015f30: 5f5a 2e7a 5f65 7272 5b6e 6577 5f6e 7a5f  _Z.z_err[new_nz_
+00015f40: 696e 6465 782c 2069 692c 206a 6a5d 203d  index, ii, jj] =
+00015f50: 2072 6573 6861 7065 287a 5f65 7272 2c20   reshape(z_err, 
+00015f60: 3129 0d0a 2020 2020 2020 2020 2320 636f  1)..        # co
+00015f70: 6d70 7574 6520 7265 7369 7374 6976 6974  mpute resistivit
+00015f80: 7920 616e 6420 7068 6173 6520 666f 7220  y and phase for 
+00015f90: 6e65 7720 5a20 6f62 6a65 6374 0d0a 2020  new Z object..  
+00015fa0: 2020 2020 2020 6e65 775f 5a2e 636f 6d70        new_Z.comp
+00015fb0: 7574 655f 7265 7369 7374 6976 6974 795f  ute_resistivity_
+00015fc0: 7068 6173 6528 290d 0a20 2020 2020 2020  phase()..       
+00015fd0: 2072 6574 7572 6e20 6e65 775f 5a20 0d0a   return new_Z ..
+00015fe0: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+00015ff0: 686f 6420 0d0a 2020 2020 6465 6620 6672  hod ..    def fr
+00016000: 6571 496e 7465 7270 6f6c 6174 696f 6e20  eqInterpolation 
+00016010: 280d 0a20 2020 2020 2020 2079 3a41 7272  (..        y:Arr
+00016020: 6179 4c69 6b65 5b44 5479 7065 5b54 5d5d  ayLike[DType[T]]
+00016030: 202c 0d0a 2020 2020 2020 2020 2f2c 200d   ,..        /, .
+00016040: 0a20 2020 2020 2020 2062 7566 6665 723a  .        buffer:
+00016050: 4f70 7469 6f6e 616c 5b54 7570 6c65 5b66  Optional[Tuple[f
+00016060: 6c6f 6174 5d5d 203d 204e 6f6e 6520 2c20  loat]] = None , 
+00016070: 200d 0a20 2020 2020 2020 206b 696e 643a   ..        kind:
+00016080: 2073 7472 2020 3d27 6672 6571 2720 0d0a   str  ='freq' ..
+00016090: 2020 2020 2020 2020 292d 3e20 4172 7261          )-> Arra
+000160a0: 794c 696b 655b 4454 7970 655b 545d 5d3a  yLike[DType[T]]:
+000160b0: 200d 0a20 2020 2020 2020 2022 2222 2049   ..        """ I
+000160c0: 6e74 6572 706f 6c61 7465 2066 7265 7175  nterpolate frequ
+000160d0: 656e 6379 2069 6e20 6672 6571 7565 6e79  ency in frequeny
+000160e0: 2062 7566 6665 7220 7261 6e67 652e 2020   buffer range.  
+000160f0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00016100: 2020 2020 3a70 6172 616d 2079 3a20 6172      :param y: ar
+00016110: 7261 792d 6c69 6b65 2c20 7368 6170 6528  ray-like, shape(
+00016120: 4e2c 2029 202d 2043 616e 2062 6520 6120  N, ) - Can be a 
+00016130: 6672 6571 7565 6e63 7920 6172 7261 7920  frequency array 
+00016140: 6f72 2070 6572 696f 6473 0d0a 2020 2020  or periods..    
+00016150: 2020 2020 2020 2020 6e6f 7465 2074 6861          note tha
+00016160: 7420 7468 6520 6672 6571 7565 6e63 7920  t the frequency 
+00016170: 6973 206e 6f74 2069 6e20 6c6f 6731 3020  is not in log10 
+00016180: 487a 2e20 0d0a 2020 2020 2020 2020 3a70  Hz. ..        :p
+00016190: 6172 616d 2062 7566 6665 723a 206c 6973  aram buffer: lis
+000161a0: 7420 6f66 206d 6178 696d 756d 2061 6e64  t of maximum and
+000161b0: 206d 696e 696d 756d 2066 7265 7175 656e   minimum frequen
+000161c0: 6379 2e20 4974 2073 686f 756c 6420 636f  cy. It should co
+000161d0: 6e74 6169 6e73 200d 0a20 2020 2020 2020  ntains ..       
+000161e0: 2020 2020 206f 6e6c 7920 7477 6f20 7661       only two va
+000161f0: 6c75 6573 2e20 4966 2060 4e6f 6e65 602c  lues. If `None`,
+00016200: 2074 6865 206d 6178 2061 6e64 206d 696e   the max and min
+00016210: 2066 7265 7175 656e 6369 6573 2061 7265   frequencies are
+00016220: 2075 7365 6420 0d0a 2020 2020 2020 2020   used ..        
+00016230: 3a70 6172 616d 206b 696e 643a 2073 7472  :param kind: str
+00016240: 200d 0a20 2020 2020 2020 2020 2020 2074   ..            t
+00016250: 7970 6520 6f66 2067 6976 656e 2064 6174  ype of given dat
+00016260: 612e 2043 616e 2062 6520 2770 6572 696f  a. Can be 'perio
+00016270: 6427 2020 6966 2074 6865 2076 616c 7565  d'  if the value
+00016280: 2069 7320 6769 7665 6e20 6173 2070 6572   is given as per
+00016290: 696f 6473 200d 0a20 2020 2020 2020 2020  iods ..         
+000162a0: 2020 206f 7220 2766 7265 7175 656e 6379     or 'frequency
+000162b0: 2720 6f74 6865 7277 6973 652e 2041 6e79  ' otherwise. Any
+000162c0: 206f 7468 6572 2076 616c 7565 2073 686f   other value sho
+000162d0: 756c 6420 6265 2063 6f6e 7369 6465 7265  uld be considere
+000162e0: 6420 6173 2061 0d0a 2020 2020 2020 2020  d as a..        
+000162f0: 2020 2020 6672 6571 7565 6e63 7920 7661      frequency va
+00016300: 6c75 6573 2e20 0d0a 2020 2020 2020 2020  lues. ..        
+00016310: 2020 2020 0d0a 2020 2020 2020 2020 3a72      ..        :r
+00016320: 6574 7572 6e3a 2061 7272 6179 5f6c 696b  eturn: array_lik
+00016330: 652c 2073 6861 7065 2028 4e32 2c20 2920  e, shape (N2, ) 
+00016340: 0d0a 2020 2020 2020 2020 2020 2020 4e65  ..            Ne
+00016350: 7720 696e 7465 7270 6f6c 6174 6564 2066  w interpolated f
+00016360: 7265 7175 656e 6379 2077 6974 6820 4e32  requency with N2
+00016370: 2073 697a 6520 0d0a 2020 2020 2020 2020   size ..        
+00016380: 2020 2020 0d0a 2020 2020 2020 2020 3a65      ..        :e
+00016390: 7861 6d70 6c65 3a20 0d0a 2020 2020 2020  xample: ..      
+000163a0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2077        >>> from w
+000163b0: 6174 6578 2e6d 6574 686f 6473 2e65 6d20  atex.methods.em 
+000163c0: 696d 706f 7274 2050 726f 6365 7373 696e  import Processin
+000163d0: 670d 0a20 2020 2020 2020 2020 2020 203e  g..            >
+000163e0: 3e3e 2070 6f62 6a20 3d20 5072 6f63 6573  >> pobj = Proces
+000163f0: 7369 6e67 2829 2e66 6974 2827 6461 7461  sing().fit('data
+00016400: 2f65 6469 7327 290d 0a20 2020 2020 2020  /edis')..       
+00016410: 2020 2020 203e 3e3e 2066 203d 2067 6574       >>> f = get
+00016420: 6675 6c6c 6672 6571 7565 6e63 7920 2870  fullfrequency (p
+00016430: 6f62 6a2e 6564 694f 626a 735f 290d 0a20  obj.ediObjs_).. 
+00016440: 2020 2020 2020 2020 2020 203e 3e3e 2062             >>> b
+00016450: 7566 6665 7220 3d20 5b35 2e38 3630 3030  uffer = [5.86000
+00016460: 652b 3034 2c20 312e 3633 3030 652b 3031  e+04, 1.6300e+01
+00016470: 5d0d 0a20 2020 2020 2020 2020 2020 203e  ]..            >
+00016480: 3e3e 2066 200d 0a20 2020 2020 2020 2020  >> f ..         
+00016490: 2020 202e 2e2e 2061 7272 6179 285b 372e     ... array([7.
+000164a0: 3030 3030 3065 2b30 342c 2035 2e38 3830  00000e+04, 5.880
+000164b0: 3030 652b 3034 2c20 342e 3935 3030 3065  00e+04, 4.95000e
+000164c0: 2b30 342c 2034 2e31 3630 3030 652b 3034  +04, 4.16000e+04
+000164d0: 2c20 332e 3530 3030 3065 2b30 342c 0d0a  , 3.50000e+04,..
+000164e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000164f0: 2020 2032 2e39 3430 3030 652b 3034 2c20     2.94000e+04, 
+00016500: 322e 3437 3030 3065 2b30 342c 2032 2e30  2.47000e+04, 2.0
+00016510: 3830 3030 652b 3034 2c20 312e 3735 3030  8000e+04, 1.7500
+00016520: 3065 2b30 342c 2031 2e34 3730 3030 652b  0e+04, 1.47000e+
+00016530: 3034 2c0d 0a20 2020 2020 2020 2020 2020  04,..           
+00016540: 2020 2020 2020 2020 2e2e 2e0d 0a20 2020          .....   
+00016550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016560: 322e 3735 3030 3065 2b30 312c 2032 2e32  2.75000e+01, 2.2
+00016570: 3530 3030 652b 3031 2c20 312e 3837 3530  5000e+01, 1.8750
+00016580: 3065 2b30 312c 2031 2e36 3235 3030 652b  0e+01, 1.62500e+
+00016590: 3031 2c20 312e 3337 3530 3065 2b30 312c  01, 1.37500e+01,
+000165a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000165b0: 2020 2020 2031 2e31 3235 3030 652b 3031       1.12500e+01
+000165c0: 2c20 392e 3337 3530 3065 2b30 302c 2038  , 9.37500e+00, 8
+000165d0: 2e31 3235 3030 652b 3030 2c20 362e 3837  .12500e+00, 6.87
+000165e0: 3530 3065 2b30 302c 2035 2e36 3235 3030  500e+00, 5.62500
+000165f0: 652b 3030 5d29 0d0a 2020 2020 2020 2020  e+00])..        
+00016600: 2020 2020 3e3e 3e20 6e65 775f 6620 3d20      >>> new_f = 
+00016610: 6672 6571 496e 7465 7270 6f6c 6174 696f  freqInterpolatio
+00016620: 6e28 662c 2062 7566 6665 7220 3d20 6275  n(f, buffer = bu
+00016630: 6666 6572 290d 0a20 2020 2020 2020 2020  ffer)..         
+00016640: 2020 203e 3e3e 206e 6577 5f66 200d 0a20     >>> new_f .. 
+00016650: 2020 2020 2020 2020 2020 202e 2e2e 2061             ... a
+00016660: 7272 6179 285b 352e 3838 3030 3030 3030  rray([5.88000000
+00016670: 652b 3034 2c20 342e 3933 3932 3834 3539  e+04, 4.93928459
+00016680: 652b 3034 2c20 342e 3134 3930 3730 3132  e+04, 4.14907012
+00016690: 652b 3034 2c20 332e 3438 3532 3738 3539  e+04, 3.48527859
+000166a0: 652b 3034 2c0d 0a20 2020 2020 2020 2020  e+04,..         
+000166b0: 2020 2020 2020 2020 2020 322e 3932 3736            2.9276
+000166c0: 3834 3136 652b 3034 2c20 322e 3435 3932  8416e+04, 2.4592
+000166d0: 3936 3831 652b 3034 2c20 322e 3036 3538  9681e+04, 2.0658
+000166e0: 3434 3731 652b 3034 2c20 312e 3733 3533  4471e+04, 1.7353
+000166f0: 3339 3237 652b 3034 2c0d 0a20 2020 2020  3927e+04,..     
+00016700: 2020 2020 2020 2020 2020 2020 2020 2e2e                ..
+00016710: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00016720: 2020 2020 2020 322e 3734 3135 3331 3230        2.74153120
+00016730: 652b 3031 2c20 322e 3330 3239 3235 3635  e+01, 2.30292565
+00016740: 652b 3031 2c20 312e 3933 3434 3930 3638  e+01, 1.93449068
+00016750: 652b 3031 2c20 312e 3632 3530 3030 3030  e+01, 1.62500000
+00016760: 652b 3031 5d29 0d0a 2020 2020 2020 2020  e+01])..        
+00016770: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00016780: 2020 2222 220d 0a20 2020 2020 2020 206b    """..        k
+00016790: 696e 6420 3d73 7472 2028 6b69 6e64 292e  ind =str (kind).
+000167a0: 6c6f 7765 7228 292e 7374 7269 7028 2920  lower().strip() 
+000167b0: 0d0a 2020 2020 2020 2020 6966 206b 696e  ..        if kin
+000167c0: 642e 6669 6e64 2827 7065 7269 2729 3e3d  d.find('peri')>=
+000167d0: 3020 3a0d 0a20 2020 2020 2020 2020 2020  0 :..           
+000167e0: 206b 696e 6420 3d27 7065 7269 6f64 7327   kind ='periods'
+000167f0: 0d0a 2020 2020 2020 2020 7920 3d20 312e  ..        y = 1.
+00016800: 2f20 6e70 2e61 7272 6179 2028 7929 2069  / np.array (y) i
+00016810: 6620 6b69 6e64 203d 3d27 7065 7269 6f64  f kind =='period
+00016820: 7327 2065 6c73 6520 206e 702e 6172 7261  s' else  np.arra
+00016830: 7920 2879 290d 0a20 2020 2020 2020 200d  y (y)..        .
+00016840: 0a20 2020 2020 2020 2062 7566 6665 7220  .        buffer 
+00016850: 3d20 5072 6f63 6573 7369 6e67 2e63 6f6e  = Processing.con
+00016860: 7472 6f6c 4672 6571 7565 6e63 7942 7566  trolFrequencyBuf
+00016870: 6665 7228 792c 2062 7566 6665 7220 2920  fer(y, buffer ) 
+00016880: 0d0a 2020 2020 2020 2020 6978 5f73 2c20  ..        ix_s, 
+00016890: 6978 5f65 6e64 2020 3d20 206e 702e 6172  ix_end  =  np.ar
+000168a0: 6777 6865 7265 2028 6e70 2e69 7369 6e28  gwhere (np.isin(
+000168b0: 792c 2062 7566 6665 7229 2920 0d0a 2020  y, buffer)) ..  
+000168c0: 2020 0d0a 2020 2020 2020 2020 7920 3d20    ..        y = 
+000168d0: 795b 736c 6963 6520 2820 696e 7428 6978  y[slice ( int(ix
+000168e0: 5f73 292c 2069 6e74 2869 785f 656e 6429  _s), int(ix_end)
+000168f0: 202b 3129 5d0d 0a20 2020 2020 2020 2023   +1)]..        #
+00016900: 2070 7574 2066 7265 7175 656e 6379 2069   put frequency i
+00016910: 6e20 6c6f 6773 7061 6365 2061 6e64 2072  n logspace and r
+00016920: 6574 7572 6e0d 0a20 2020 2020 2020 2023  eturn..        #
+00016930: 2074 6865 2073 616d 6520 6f72 6465 7220   the same order 
+00016940: 6c69 6b65 2074 6865 2069 6e70 7574 2076  like the input v
+00016950: 616c 7565 0d0a 2020 2020 2020 2020 7920  alue..        y 
+00016960: 3d20 6e70 2e6c 6f67 3130 2028 7929 0d0a  = np.log10 (y)..
+00016970: 2020 2020 2020 2020 6966 2079 5b30 5d20          if y[0] 
+00016980: 3c20 795b 2d31 5d3a 200d 0a20 2020 2020  < y[-1]: ..     
+00016990: 2020 2020 2020 2066 203d 206e 702e 6c6f         f = np.lo
+000169a0: 6773 7061 6365 2879 2e6d 696e 2829 202c  gspace(y.min() ,
+000169b0: 792e 6d61 7828 2920 2c20 6c65 6e28 7929  y.max() , len(y)
+000169c0: 290d 0a20 2020 2020 2020 2065 6c73 6520  )..        else 
+000169d0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+000169e0: 6620 3d20 6e70 2e6c 6f67 7370 6163 6528  f = np.logspace(
+000169f0: 792e 6d69 6e28 292c 792e 6d61 7828 2920  y.min(),y.max() 
+00016a00: 2c20 6c65 6e28 7929 295b 3a3a 2d31 5d0d  , len(y))[::-1].
+00016a10: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00016a20: 2020 2072 6574 7572 6e20 6620 0d0a 2020     return f ..  
+00016a30: 2020 0d0a 2020 2020 4073 7461 7469 636d    ..    @staticm
+00016a40: 6574 686f 6420 0d0a 2020 2020 6465 6620  ethod ..    def 
+00016a50: 636f 6e74 726f 6c46 7265 7175 656e 6379  controlFrequency
+00016a60: 4275 6666 6572 2028 0d0a 2020 2020 2020  Buffer (..      
+00016a70: 2020 6672 6571 3a20 4172 7261 794c 696b    freq: ArrayLik
+00016a80: 655b 4454 7970 655b 545d 5d2c 200d 0a20  e[DType[T]], .. 
+00016a90: 2020 2020 2020 2062 7566 6665 723a 4f70         buffer:Op
+00016aa0: 7469 6f6e 616c 5b54 7570 6c65 5b66 6c6f  tional[Tuple[flo
+00016ab0: 6174 5d5d 203d 204e 6f6e 6520 0d0a 2020  at]] = None ..  
+00016ac0: 2020 2020 2020 292d 3e20 4172 7261 794c        )-> ArrayL
+00016ad0: 696b 655b 4454 7970 655b 545d 5d20 3a0d  ike[DType[T]] :.
+00016ae0: 0a20 2020 2020 2020 2022 2222 2041 7373  .        """ Ass
+00016af0: 6572 7420 6275 6666 6572 2061 6e64 2066  ert buffer and f
+00016b00: 696e 6420 7468 6520 6e65 6172 6573 7420  ind the nearest 
+00016b10: 7661 6c75 6520 6966 2074 6865 200d 0a20  value if the .. 
+00016b20: 2020 2020 2020 2076 616c 7565 206f 6620         value of 
+00016b30: 7468 6520 6275 6666 6572 2069 7320 6e6f  the buffer is no
+00016b40: 7420 696e 2066 7265 7175 656e 6379 2072  t in frequency r
+00016b50: 616e 6765 7320 2e0d 0a20 2020 2020 2020  anges ...       
+00016b60: 200d 0a20 2020 2020 2020 203a 7061 7261   ..        :para
+00016b70: 6d20 6672 6571 3a20 6172 7261 792d 6c69  m freq: array-li
+00016b80: 6b65 206f 6620 6672 6571 7565 6e63 6965  ke of frequencie
+00016b90: 7320 0d0a 2020 2020 2020 2020 3a70 6172  s ..        :par
+00016ba0: 616d 2062 7566 6665 723a 206c 6973 7420  am buffer: list 
+00016bb0: 6f66 206d 6178 696d 756d 2061 6e64 206d  of maximum and m
+00016bc0: 696e 696d 756d 2066 7265 7175 656e 6379  inimum frequency
+00016bd0: 2e20 4974 2073 686f 756c 6420 636f 6e74  . It should cont
+00016be0: 6169 6e73 200d 0a20 2020 2020 2020 2020  ains ..         
+00016bf0: 2020 206f 6e6c 7920 7477 6f20 7661 6c75     only two valu
+00016c00: 6573 2e20 4966 2060 4e6f 6e65 602c 2074  es. If `None`, t
+00016c10: 6865 206d 6178 2061 6e64 206d 696e 2066  he max and min f
+00016c20: 7265 7175 656e 6369 6573 2061 7265 2073  requencies are s
+00016c30: 656c 6563 7465 6420 0d0a 2020 2020 2020  elected ..      
+00016c40: 2020 3a72 6574 7572 6e73 3a20 4275 6666    :returns: Buff
+00016c50: 6572 2066 7265 7175 656e 6379 2072 616e  er frequency ran
+00016c60: 6765 200d 0a20 2020 2020 2020 200d 0a20  ge ..        .. 
+00016c70: 2020 2020 2020 203a 4578 616d 706c 653a         :Example:
+00016c80: 200d 0a20 2020 2020 2020 203e 3e3e 2069   ..        >>> i
+00016c90: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
+00016ca0: 7020 0d0a 2020 2020 2020 2020 3e3e 3e20  p ..        >>> 
+00016cb0: 6672 6f6d 2077 6174 6578 2e6d 6574 686f  from watex.metho
+00016cc0: 6473 2e65 6d20 696d 706f 7274 2050 726f  ds.em import Pro
+00016cd0: 6365 7373 696e 670d 0a20 2020 2020 2020  cessing..       
+00016ce0: 203e 3e3e 2066 7265 715f 203d 206e 702e   >>> freq_ = np.
+00016cf0: 6c69 6e73 7061 6365 2837 6537 2c20 3165  linspace(7e7, 1e
+00016d00: 302c 2032 3029 2023 2032 3020 6672 6571  0, 20) # 20 freq
+00016d10: 7565 6e63 6965 7320 6173 2072 6566 6572  uencies as refer
+00016d20: 656e 6365 0d0a 2020 2020 2020 2020 3e3e  ence..        >>
+00016d30: 3e20 6275 6666 6572 203d 2050 726f 6365  > buffer = Proce
+00016d40: 7373 696e 672e 636f 6e74 726f 6c46 7265  ssing.controlFre
+00016d50: 7175 656e 6379 4275 6666 6572 2866 7265  quencyBuffer(fre
+00016d60: 715f 2c20 6275 6666 6572 203d 5b35 2e37  q_, buffer =[5.7
+00016d70: 3065 372c 2032 6531 5d29 0d0a 2020 2020  0e7, 2e1])..    
+00016d80: 2020 2020 3e3e 3e20 6672 6571 5f20 0d0a      >>> freq_ ..
+00016d90: 2020 2020 2020 2020 2e2e 2e20 6172 7261          ... arra
+00016da0: 7928 5b37 2e30 3030 3030 3030 3065 2b30  y([7.00000000e+0
+00016db0: 372c 2036 2e36 3331 3537 3839 3565 2b30  7, 6.63157895e+0
+00016dc0: 372c 2036 2e32 3633 3135 3739 3165 2b30  7, 6.26315791e+0
+00016dd0: 372c 2035 2e38 3934 3733 3638 3665 2b30  7, 5.89473686e+0
+00016de0: 372c 0d0a 2020 2020 2020 2020 2020 2020  7,..            
+00016df0: 2020 2035 2e35 3236 3331 3538 3165 2b30     5.52631581e+0
+00016e00: 372c 2035 2e31 3537 3839 3437 3665 2b30  7, 5.15789476e+0
+00016e10: 372c 2034 2e37 3839 3437 3337 3265 2b30  7, 4.78947372e+0
+00016e20: 372c 2034 2e34 3231 3035 3236 3765 2b30  7, 4.42105267e+0
+00016e30: 372c 0d0a 2020 2020 2020 2020 2020 2020  7,..            
+00016e40: 2020 2034 2e30 3532 3633 3136 3265 2b30     4.05263162e+0
+00016e50: 372c 2033 2e36 3834 3231 3035 3765 2b30  7, 3.68421057e+0
+00016e60: 372c 2033 2e33 3135 3738 3935 3365 2b30  7, 3.31578953e+0
+00016e70: 372c 2032 2e39 3437 3336 3834 3865 2b30  7, 2.94736848e+0
+00016e80: 372c 0d0a 2020 2020 2020 2020 2020 2020  7,..            
+00016e90: 2020 2032 2e35 3738 3934 3734 3365 2b30     2.57894743e+0
+00016ea0: 372c 2032 2e32 3130 3532 3633 3865 2b30  7, 2.21052638e+0
+00016eb0: 372c 2031 2e38 3432 3130 3533 3465 2b30  7, 1.84210534e+0
+00016ec0: 372c 2031 2e34 3733 3638 3432 3965 2b30  7, 1.47368429e+0
+00016ed0: 372c 0d0a 2020 2020 2020 2020 2020 2020  7,..            
+00016ee0: 2020 2031 2e31 3035 3236 3332 3465 2b30     1.10526324e+0
+00016ef0: 372c 2037 2e33 3638 3432 3139 3565 2b30  7, 7.36842195e+0
+00016f00: 362c 2033 2e36 3834 3231 3134 3765 2b30  6, 3.68421147e+0
+00016f10: 362c 2031 2e30 3030 3030 3030 3065 2b30  6, 1.00000000e+0
+00016f20: 305d 290d 0a20 2020 2020 2020 203e 3e3e  0])..        >>>
+00016f30: 2062 7566 6665 7220 0d0a 2020 2020 2020   buffer ..      
+00016f40: 2020 2e2e 2e20 6172 7261 7928 5b35 2e35    ... array([5.5
+00016f50: 3236 3331 3538 3165 2b30 372c 2031 2e30  2631581e+07, 1.0
+00016f60: 3030 3030 3030 3065 2b30 305d 290d 0a20  0000000e+00]).. 
+00016f70: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00016f80: 2022 2222 0d0a 2020 2020 2020 2020 6d73   """..        ms
+00016f90: 6720 3d28 2242 7566 6665 7220 666f 7220  g =("Buffer for 
+00016fa0: 6672 6571 7565 6e63 7920 6578 7065 6374  frequency expect
+00016fb0: 7320 7477 6f20 7661 6c75 6573 2028 276d  s two values ('m
+00016fc0: 6178 272c 2027 6d69 6e27 292e 2022 290d  ax', 'min'). ").
+00016fd0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00016fe0: 2020 2069 6620 6e6f 7420 6861 7361 7474     if not hasatt
+00016ff0: 7220 2866 7265 712c 2027 5f5f 6172 7261  r (freq, '__arra
+00017000: 795f 5f27 293a 200d 0a20 2020 2020 2020  y__'): ..       
+00017010: 2020 2020 2066 7265 7120 3d20 6e70 2e61       freq = np.a
+00017020: 7272 6179 2866 7265 7120 2c20 6474 7970  rray(freq , dtyp
+00017030: 6520 3d20 6e70 2e66 6c6f 6174 3634 2029  e = np.float64 )
+00017040: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+00017050: 2020 2020 2020 2020 6966 2062 7566 6665          if buffe
+00017060: 7220 6973 204e 6f6e 653a 200d 0a20 2020  r is None: ..   
+00017070: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00017080: 6e70 2e61 7272 6179 285b 6672 6571 2e6d  np.array([freq.m
+00017090: 6178 2829 2c20 6672 6571 2e6d 696e 2829  ax(), freq.min()
+000170a0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+000170b0: 0d0a 2020 2020 2020 2020 6966 2028 200d  ..        if ( .
+000170c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000170d0: 2069 7369 6e73 7461 6e63 6520 2862 7566   isinstance (buf
+000170e0: 6665 722c 2073 7472 2920 0d0a 2020 2020  fer, str) ..    
+000170f0: 2020 2020 2020 2020 2020 2020 6f72 206e              or n
+00017100: 6f74 2068 6173 6174 7472 2862 7566 6665  ot hasattr(buffe
+00017110: 7220 2c20 275f 5f69 7465 725f 5f27 290d  r , '__iter__').
+00017120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017130: 2029 3a20 0d0a 2020 2020 2020 2020 2020   ): ..          
+00017140: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00017150: 6f72 286d 7367 202b 2066 2242 7574 207b  or(msg + f"But {
+00017160: 7479 7065 2028 6275 6666 6572 292e 5f5f  type (buffer).__
+00017170: 6e61 6d65 5f5f 2172 7d20 6973 2067 6976  name__!r} is giv
+00017180: 656e 2229 0d0a 2020 2020 2020 2020 2020  en")..          
+00017190: 2020 0d0a 2020 2020 2020 2020 6966 206c    ..        if l
+000171a0: 656e 2862 7566 6665 7229 203c 2032 3a20  en(buffer) < 2: 
+000171b0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+000171c0: 6973 6520 4672 6571 7565 6e63 7945 7272  ise FrequencyErr
+000171d0: 6f72 2028 6d73 6720 2b20 6622 476f 7420  or (msg + f"Got 
+000171e0: 7b6c 656e 2862 7566 6665 7229 7d2e 2229  {len(buffer)}.")
+000171f0: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
+00017200: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00017210: 6275 6666 6572 2029 203e 2032 3a20 0d0a  buffer ) > 2: ..
+00017220: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+00017230: 696e 6773 2e77 6172 6e28 6d73 6720 2b20  ings.warn(msg + 
+00017240: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017250: 2020 2020 2020 2020 2020 2020 6622 476f              f"Go
+00017260: 7420 7b6c 656e 2862 7566 6665 7229 7d2e  t {len(buffer)}.
+00017270: 2054 6865 2066 7265 7175 656e 6369 6573   The frequencies
+00017280: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+00017290: 2020 2020 2020 2020 2020 2020 2066 2220               f" 
+000172a0: 2728 7b6d 6178 2862 7566 6665 7229 2c20  '({max(buffer), 
+000172b0: 6d69 6e28 6275 6666 6572 297d 2927 2073  min(buffer)})' s
+000172c0: 686f 756c 6420 6265 2022 0d0a 2020 2020  hould be "..    
+000172d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000172e0: 2020 2020 2020 2275 7365 6420 6173 2028        "used as (
+000172f0: 276d 6178 272c 2027 6d69 6e27 2920 696e  'max', 'min') in
+00017300: 7374 6561 642e 2229 0d0a 2020 2020 2020  stead.")..      
+00017310: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+00017320: 6275 6666 6572 203d 206e 702e 6172 7261  buffer = np.arra
+00017330: 7920 2820 5b20 6d61 7828 6275 6666 6572  y ( [ max(buffer
+00017340: 292c 206d 696e 2862 7566 6665 7229 5d20  ), min(buffer)] 
+00017350: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00017360: 2020 2020 2069 6620 6e6f 7420 6861 7361       if not hasa
+00017370: 7474 7228 6275 6666 6572 2c20 275f 5f61  ttr(buffer, '__a
+00017380: 7272 6179 5f5f 2729 3a20 0d0a 2020 2020  rray__'): ..    
+00017390: 2020 2020 2020 2020 6275 6666 6572 203d          buffer =
+000173a0: 206e 702e 6172 7261 7920 2820 6275 6666   np.array ( buff
+000173b0: 6572 2029 200d 0a20 2020 2020 2020 2020  er ) ..         
+000173c0: 2020 2023 6275 6666 6572 2e73 6f72 7428     #buffer.sort(
+000173d0: 2920 2320 666f 7220 636f 6e73 6973 7465  ) # for consiste
+000173e0: 6e63 7920 0d0a 2020 2020 2020 2020 2020  ncy ..          
+000173f0: 2020 0d0a 2020 2020 2020 2020 6966 2028    ..        if (
+00017400: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00017410: 2020 2062 7566 6665 722e 6d69 6e28 2920     buffer.min() 
+00017420: 3c20 6672 6571 2e6d 696e 2829 200d 0a20  < freq.min() .. 
+00017430: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00017440: 7220 6275 6666 6572 2e6d 6178 2028 2920  r buffer.max () 
+00017450: 3e20 6672 6571 2e6d 6178 2829 0d0a 2020  > freq.max()..  
+00017460: 2020 2020 2020 2020 2020 2020 2020 293a                ):
+00017470: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
+00017480: 6169 7365 2046 7265 7175 656e 6379 4572  aise FrequencyEr
+00017490: 726f 7220 280d 0a20 2020 2020 2020 2020  ror (..         
+000174a0: 2020 2020 2020 2066 2242 7566 6665 7220         f"Buffer 
+000174b0: 6672 6571 7565 6e63 7920 277b 2862 7566  frequency '{(buf
+000174c0: 6665 722e 6d61 7828 292c 2062 7566 6665  fer.max(), buffe
+000174d0: 722e 6d69 6e28 2929 7d27 220d 0a20 2020  r.min())}'"..   
+000174e0: 2020 2020 2020 2020 2020 2020 2022 2069               " i
+000174f0: 7320 6f75 7420 6f66 2074 6865 2072 616e  s out of the ran
+00017500: 6765 2e20 4578 7065 6374 2066 7265 7175  ge. Expect frequ
+00017510: 656e 6369 6573 2062 6522 0d0a 2020 2020  encies be"..    
+00017520: 2020 2020 2020 2020 2020 2020 6622 2077              f" w
+00017530: 6974 6869 6e20 7b28 6672 6571 2e6d 696e  ithin {(freq.min
+00017540: 2829 2c66 7265 712e 6d61 7828 2929 7d22  (),freq.max())}"
+00017550: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017560: 2020 290d 0a20 2020 2020 2020 2023 2054    )..        # T
+00017570: 6865 2062 7566 6665 7220 646f 6573 206e  he buffer does n
+00017580: 6f74 206e 6565 6420 746f 2066 6974 2074  ot need to fit t
+00017590: 6865 2065 7861 6374 200d 0a20 2020 2020  he exact ..     
+000175a0: 2020 2023 2066 7265 7175 656e 6379 2076     # frequency v
+000175b0: 616c 7565 2069 6e20 7468 6520 6672 6571  alue in the freq
+000175c0: 7565 6e63 7920 6461 7461 2e20 0d0a 2020  uency data. ..  
+000175d0: 2020 2020 2020 2320 436f 756c 6420 4669        # Could Fi
+000175e0: 6e64 2074 6865 2061 6273 6f6c 7574 6520  nd the absolute 
+000175f0: 6469 6666 6572 656e 6365 2077 6974 6820  difference with 
+00017600: 6561 6368 2076 616c 7565 2020 200d 0a20  each value   .. 
+00017610: 2020 2020 2020 2023 2047 6574 2074 6865         # Get the
+00017620: 2069 6e64 6578 206f 6620 7468 6520 736d   index of the sm
+00017630: 616c 6c65 7374 2061 6273 6f6c 7574 6520  allest absolute 
+00017640: 6469 6666 6572 656e 6365 2e20 0d0a 2020  difference. ..  
+00017650: 2020 2020 2020 6d69 6e66 203d 2066 7265        minf = fre
+00017660: 7120 205b 206e 702e 6162 7320 2866 7265  q  [ np.abs (fre
+00017670: 7120 2d20 6275 6666 6572 2e6d 696e 2829  q - buffer.min()
+00017680: 292e 6172 676d 696e 2829 205d 2020 0d0a  ).argmin() ]  ..
+00017690: 2020 2020 2020 2020 6d61 7866 203d 2066          maxf = f
+000176a0: 7265 7120 205b 206e 702e 6162 7320 2866  req  [ np.abs (f
+000176b0: 7265 7120 2d20 6275 6666 6572 2e6d 6178  req - buffer.max
+000176c0: 2829 292e 6172 676d 696e 2829 205d 2020  ()).argmin() ]  
+000176d0: 0d0a 2020 2020 2020 2020 6275 6666 6572  ..        buffer
+000176e0: 203d 206e 702e 6172 7261 7920 2820 5b20   = np.array ( [ 
+000176f0: 6d61 7866 202c 206d 696e 6620 5d20 2920  maxf , minf ] ) 
+00017700: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00017710: 2020 2020 2320 6966 206d 696e 2061 6e64      # if min and
+00017720: 206d 6178 2066 7265 7175 656e 6379 2061   max frequency a
+00017730: 7265 0d0a 2020 2020 2020 2020 2320 6964  re..        # id
+00017740: 656e 7469 6361 6c20 2c20 7261 6973 6520  entical , raise 
+00017750: 6572 726f 7220 0d0a 2020 2020 2020 2020  error ..        
+00017760: 6966 206c 656e 2820 7365 7428 6275 6666  if len( set(buff
+00017770: 6572 2929 2020 213d 323a 200d 0a20 2020  er))  !=2: ..   
+00017780: 2020 2020 2020 2020 2072 6169 7365 2046           raise F
+00017790: 7265 7175 656e 6379 4572 726f 7220 2822  requencyError ("
+000177a0: 4672 6571 7565 6e63 7920 6275 6666 6572  Frequency buffer
+000177b0: 2028 276d 6178 272c 2027 6d69 6e27 2920   ('max', 'min') 
+000177c0: 7368 6f75 6c64 220d 0a20 2020 2020 2020  should"..       
 000177d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000177e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000177f0: 2066 2220 6265 2064 6973 7469 6e63 7420   f" be distinct 
-00017800: 6173 2070 6f73 7369 626c 652e 2047 6f74  as possible. Got
-00017810: 207b 6275 6666 6572 7d22 290d 0a20 2020   {buffer}")..   
-00017820: 2020 2020 2072 6574 7572 6e20 6275 6666       return buff
-00017830: 6572 200d 0a0d 0a20 2020 2064 6566 2071  er ....    def q
-00017840: 6320 280d 0a20 2020 2020 2020 2073 656c  c (..        sel
-00017850: 662c 2020 0d0a 2020 2020 2020 2020 746f  f,  ..        to
-00017860: 6c3a 2066 6c6f 6174 203d 202e 3520 2c20  l: float = .5 , 
-00017870: 0d0a 2020 2020 2020 2020 2a2c 200d 0a20  ..        *, .. 
-00017880: 2020 2020 2020 2072 6574 7572 6e5f 6672         return_fr
-00017890: 6571 3a20 626f 6f6c 203d 4661 6c73 652c  eq: bool =False,
-000178a0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000178b0: 5f72 6174 696f 3a62 6f6f 6c3d 4661 6c73  _ratio:bool=Fals
-000178c0: 652c 200d 0a20 2020 2020 2020 2074 6f5f  e, ..        to_
-000178d0: 6c6f 6731 303a 2062 6f6f 6c3d 5472 7565  log10: bool=True
-000178e0: 2c20 0d0a 2020 2020 2020 2020 292d 3e54  , ..        )->T
-000178f0: 7570 6c65 5b66 6c6f 6174 2c20 4172 7261  uple[float, Arra
-00017900: 794c 696b 655d 3a20 0d0a 2020 2020 2020  yLike]: ..      
-00017910: 2020 2222 2220 4368 6563 6b20 7468 6520    """ Check the 
-00017920: 7175 616c 6974 7920 636f 6e74 726f 6c20  quality control 
-00017930: 6f66 2074 6865 2063 6f6c 6c65 6374 6564  of the collected
-00017940: 2045 4449 732e 200d 0a20 2020 2020 2020   EDIs. ..       
-00017950: 200d 0a20 2020 2020 2020 2041 6e61 6c79   ..        Analy
-00017960: 7365 2074 6865 2064 6174 6120 696e 2074  se the data in t
-00017970: 6865 2045 4449 2063 6f6c 6c65 6374 696f  he EDI collectio
-00017980: 6e20 616e 6420 7265 7475 726e 2074 6865  n and return the
-00017990: 2071 7561 6c69 7479 2063 6f6e 7472 6f6c   quality control
-000179a0: 2076 616c 7565 2e0d 0a20 2020 2020 2020   value...       
-000179b0: 2049 7420 696e 6469 6361 7465 7320 686f   It indicates ho
-000179c0: 7720 7065 7263 656e 7461 6765 2061 7265  w percentage are
-000179d0: 2074 6865 2064 6174 6120 746f 2062 6520   the data to be 
-000179e0: 7265 7072 6573 656e 7461 7469 7665 2e0d  representative..
-000179f0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00017a00: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00017a10: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00017a20: 2d2d 2d0d 0a20 2020 2020 2020 2074 6f6c  ---..        tol
-00017a30: 3a20 666c 6f61 742c 200d 0a20 2020 2020  : float, ..     
-00017a40: 2020 2020 2020 2074 6865 2074 6f6c 6572         the toler
-00017a50: 616e 6365 2070 6172 616d 6574 6572 2e20  ance parameter. 
-00017a60: 5468 6520 7661 6c75 6520 696e 6469 6361  The value indica
-00017a70: 7465 7320 7468 6520 7261 7465 2066 726f  tes the rate fro
-00017a80: 6d20 7768 6963 6820 7468 6520 0d0a 2020  m which the ..  
-00017a90: 2020 2020 2020 2020 2020 6461 7461 2063            data c
-00017aa0: 616e 2062 6520 636f 6e73 6964 6572 2061  an be consider a
-00017ab0: 7320 6d65 616e 696e 6766 756c 2e20 5072  s meaningful. Pr
-00017ac0: 6566 6572 6162 6c79 2069 7420 7368 6f75  eferably it shou
-00017ad0: 6c64 2062 6520 6c65 7373 2074 6861 6e0d  ld be less than.
-00017ae0: 0a20 2020 2020 2020 2020 2020 2031 2061  .            1 a
-00017af0: 6e64 2067 7265 6174 6572 2074 6861 6e20  nd greater than 
-00017b00: 302e 2041 7420 7468 6973 2076 616c 7565  0. At this value
-00017b10: 2e20 4465 6661 756c 7420 6973 2060 602e  . Default is ``.
-00017b20: 3560 6020 6d65 616e 7320 3530 2025 200d  5`` means 50 % .
-00017b30: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00017b40: 2020 2020 2020 2072 6574 7572 6e5f 6672         return_fr
-00017b50: 6571 3a20 626f 6f6c 2c20 4465 6661 756c  eq: bool, Defaul
-00017b60: 7420 3d46 616c 7365 200d 0a20 2020 2020  t =False ..     
-00017b70: 2020 2020 2020 2072 6574 7572 6e20 7468         return th
-00017b80: 6520 696e 7465 7270 6f6c 6174 6564 2066  e interpolated f
-00017b90: 7265 7175 656e 6379 2069 6620 7365 7420  requency if set 
-00017ba0: 746f 2060 6054 7275 6560 602e 200d 0a20  to ``True``. .. 
-00017bb0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00017bc0: 2072 6574 7572 6e5f 7261 7469 6f3a 2062   return_ratio: b
-00017bd0: 6f6f 6c2c 2064 6566 6175 6c74 3d46 616c  ool, default=Fal
-00017be0: 7365 2c20 0d0a 2020 2020 2020 2020 2020  se, ..          
-00017bf0: 2072 6574 7572 6e20 6f6e 6c79 2074 6865   return only the
-00017c00: 2072 6174 696f 206f 6620 7468 6520 7265   ratio of the re
-00017c10: 7072 6573 656e 7461 7469 6f6e 206f 6620  presentation of 
-00017c20: 7468 6520 6461 7461 2e20 0d0a 2020 2020  the data. ..    
-00017c30: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00017c40: 2020 2020 2e2e 2076 6572 7369 6f6e 6164      .. versionad
-00017c50: 6465 643a 3a20 302e 312e 350d 0a20 2020  ded:: 0.1.5..   
-00017c60: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00017c70: 2020 746f 5f6c 6f67 3130 3a62 6f6f 6c2c    to_log10:bool,
-00017c80: 2064 6566 6175 6c74 3d46 616c 7365 0d0a   default=False..
-00017c90: 2020 2020 2020 2020 2020 2063 6f6e 7665             conve
-00017ca0: 7274 2074 6865 2069 6e74 6572 706f 6c61  rt the interpola
-00017cb0: 7465 6420 6672 6571 7565 6e63 7920 696e  ted frequency in
-00017cc0: 746f 2061 206c 6f67 3130 2e20 0d0a 2020  to a log10. ..  
-00017cd0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00017ce0: 2020 2052 6574 7572 6e73 200d 0a20 2020     Returns ..   
-00017cf0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a       ---------..
-00017d00: 2020 2020 2020 2020 5475 706c 6520 2866          Tuple (f
-00017d10: 6c6f 6174 202c 2069 6e64 6578 2029 2020  loat , index )  
-00017d20: 6f72 2028 666c 6f61 742c 2061 7272 6179  or (float, array
-00017d30: 2d6c 696b 652c 2073 6861 7065 2028 4e2c  -like, shape (N,
-00017d40: 2029 290d 0a20 2020 2020 2020 2020 2020   ))..           
-00017d50: 2072 6574 7572 6e20 7468 6520 7175 616c   return the qual
-00017d60: 6974 7920 636f 6e74 726f 6c20 7661 6c75  ity control valu
-00017d70: 6520 616e 6420 696e 7465 7270 6f6c 6174  e and interpolat
-00017d80: 6564 2066 7265 7175 656e 6379 2069 6620  ed frequency if 
-00017d90: 200d 0a20 2020 2020 2020 2020 2020 2060   ..            `
-00017da0: 7265 7475 726e 5f66 7265 7160 2020 6973  return_freq`  is
-00017db0: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
-00017dc0: 206f 7468 6572 7769 7365 2072 6574 7572   otherwise retur
-00017dd0: 6e20 7468 6520 696e 6465 7820 6f66 2075  n the index of u
-00017de0: 7365 6c65 7373 200d 0a20 2020 2020 2020  seless ..       
-00017df0: 2020 2020 2064 6174 612e 200d 0a20 2020       data. ..   
-00017e00: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00017e10: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
-00017e20: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a       ---------..
-00017e30: 2020 2020 2020 2020 3e3e 3e20 6672 6f6d          >>> from
-00017e40: 2077 6174 6578 2e6d 6574 686f 6473 2e65   watex.methods.e
-00017e50: 6d20 696d 706f 7274 2050 726f 6365 7373  m import Process
-00017e60: 696e 670d 0a20 2020 2020 2020 203e 3e3e  ing..        >>>
-00017e70: 2070 6f62 6a20 3d20 5072 6f63 6573 7369   pobj = Processi
-00017e80: 6e67 2829 2e66 6974 2827 6461 7461 2f65  ng().fit('data/e
-00017e90: 6469 7327 290d 0a20 2020 2020 2020 203e  dis')..        >
-00017ea0: 3e3e 2066 203d 2070 6f62 6a2e 6765 7466  >> f = pobj.getf
-00017eb0: 756c 6c66 7265 7175 656e 6379 2028 290d  ullfrequency ().
-00017ec0: 0a20 2020 2020 2020 203e 3e3e 2023 206c  .        >>> # l
-00017ed0: 656e 2866 290d 0a20 2020 2020 2020 203e  en(f)..        >
-00017ee0: 3e3e 2023 202e 2e2e 2035 3520 2320 3535  >> # ... 55 # 55
-00017ef0: 2066 7265 7175 656e 6369 6573 200d 0a20   frequencies .. 
-00017f00: 2020 2020 2020 203e 3e3e 2063 2c5f 203d         >>> c,_ =
-00017f10: 2070 6f62 6a2e 7163 2028 2074 6f6c 203d   pobj.qc ( tol =
-00017f20: 202e 3420 2920 2320 6d65 616e 2036 3025   .4 ) # mean 60%
-00017f30: 2074 6f20 636f 6e73 6964 6572 2074 6865   to consider the
-00017f40: 2064 6174 6120 6173 0d0a 2020 2020 2020   data as..      
-00017f50: 2020 3e3e 3e20 2320 7265 7072 6573 656e    >>> # represen
-00017f60: 7461 7469 7665 7320 0d0a 2020 2020 2020  tatives ..      
-00017f70: 2020 3e3e 3e20 6320 2023 2074 6865 2072    >>> c  # the r
-00017f80: 6570 7265 7365 6e74 6174 6976 6520 7261  epresentative ra
-00017f90: 7465 2069 6e20 7468 6520 7768 6f6c 6520  te in the whole 
-00017fa0: 4544 492d 2063 6f6c 6c65 6374 696f 6e0d  EDI- collection.
-00017fb0: 0a20 2020 2020 2020 203e 3e3e 2023 202e  .        >>> # .
-00017fc0: 2e2e 2030 2e39 3520 2320 7468 6520 7768  .. 0.95 # the wh
-00017fd0: 6f6c 6520 6461 7461 2061 7420 616c 6c20  ole data at all 
-00017fe0: 7374 6174 696f 6e73 2069 7320 7361 6665  stations is safe
-00017ff0: 2074 6f20 3935 252e 200d 0a20 2020 2020   to 95%. ..     
-00018000: 2020 203e 3e3e 2023 206e 6f77 2063 6865     >>> # now che
-00018010: 636b 2074 6865 2069 6e74 6572 706f 6c61  ck the interpola
-00018020: 7465 6420 6672 6571 7565 6e63 7920 0d0a  ted frequency ..
-00018030: 2020 2020 2020 2020 3e3e 3e20 632c 2066          >>> c, f
-00018040: 7265 715f 6e65 7720 203d 2070 6f62 6a2e  req_new  = pobj.
-00018050: 7163 2028 2074 6f6c 3d2e 3620 2c20 7265  qc ( tol=.6 , re
-00018060: 7475 726e 5f66 7265 7120 3d54 7275 6529  turn_freq =True)
-00018070: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00018080: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00018090: 2020 2020 2073 656c 662e 696e 7370 6563       self.inspec
-000180a0: 7420 0d0a 2020 2020 2020 2020 746f 6c20  t ..        tol 
-000180b0: 3d20 6173 7365 7274 5f72 6174 696f 2874  = assert_ratio(t
-000180c0: 6f6c 202c 2062 6f75 6e64 7320 3d28 302c  ol , bounds =(0,
-000180d0: 2031 292c 2065 7863 6c75 6465 5f76 616c   1), exclude_val
-000180e0: 7565 203d 302c 200d 0a20 2020 2020 2020  ue =0, ..       
-000180f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018100: 2020 2020 6e61 6d65 203d 2774 6f6c 6572      name ='toler
-00018110: 616e 6365 272c 2069 6e5f 7065 7263 656e  ance', in_percen
-00018120: 7420 3d54 7275 6520 290d 0a20 2020 2020  t =True )..     
-00018130: 2020 200d 0a20 2020 2020 2020 2066 3d73     ..        f=s
-00018140: 656c 662e 6672 6571 735f 2e63 6f70 7928  elf.freqs_.copy(
-00018150: 2920 0d0a 2020 2020 200d 0a20 2020 2020  ) ..     ..     
-00018160: 2020 2074 7279 203a 200d 0a20 2020 2020     try : ..     
-00018170: 2020 2020 2020 2023 2074 616b 6520 6120         # take a 
-00018180: 7361 6d70 6c65 206f 6620 636f 6c6c 6563  sample of collec
-00018190: 7465 6420 6564 6920 0d0a 2020 2020 2020  ted edi ..      
-000181a0: 2020 2020 2020 2320 616e 6420 6d61 6b65        # and make
-000181b0: 2074 776f 2064 6179 2061 7272 6179 0d0a   two day array..
-000181c0: 2020 2020 2020 2020 2020 2020 2320 616c              # al
-000181d0: 6c20 6672 6571 7565 6e63 7920 6174 2061  l frequency at a
-000181e0: 6c6c 2073 7461 7469 6f6e 7320 0d0a 2020  ll stations ..  
-000181f0: 2020 2020 2020 2020 2020 6172 203d 2073            ar = s
-00018200: 656c 662e 6d61 6b65 3264 2028 2766 7265  elf.make2d ('fre
-00018210: 7127 2920 0d0a 2020 2020 2020 2020 6578  q') ..        ex
-00018220: 6365 7074 203a 200d 0a20 2020 2020 2020  cept : ..       
-00018230: 2020 2020 2074 7279 203a 200d 0a20 2020       try : ..   
-00018240: 2020 2020 2020 2020 2020 2020 2061 7220               ar 
-00018250: 3d20 7365 6c66 2e6d 616b 6532 6428 2027  = self.make2d( '
-00018260: 7a78 7927 290d 0a20 2020 2020 2020 2020  zxy')..         
-00018270: 2020 2065 7863 6570 743a 2061 7220 3d20     except: ar = 
-00018280: 7365 6c66 2e6d 616b 6532 6420 2827 7a79  self.make2d ('zy
-00018290: 7827 290d 0a20 2020 2020 2020 2023 2063  x')..        # c
-000182a0: 6f6d 7075 7465 2074 6865 2072 6174 696f  ompute the ratio
-000182b0: 206f 6620 4e61 4e20 696e 2061 7869 7320   of NaN in axis 
-000182c0: 3d30 200d 0a20 2020 2020 2020 200d 0a20  =0 ..        .. 
-000182d0: 2020 2020 2020 206e 616e 5f73 756d 2020         nan_sum  
-000182e0: 3d6e 702e 6e61 6e73 756d 286e 702e 6973  =np.nansum(np.is
-000182f0: 6e61 6e28 6172 292c 2061 7869 7320 3d31  nan(ar), axis =1
-00018300: 2920 0d0a 2020 2020 2020 2020 7272 3d20  ) ..        rr= 
-00018310: 6e70 2e61 726f 756e 6420 2820 6e61 6e5f  np.around ( nan_
-00018320: 7375 6d20 2f20 6172 2e73 6861 7065 5b31  sum / ar.shape[1
-00018330: 5d20 2c20 3229 200d 0a20 2020 2020 2020  ] , 2) ..       
-00018340: 2023 2063 6f6d 7075 7465 2074 6865 2072   # compute the r
-00018350: 6174 696f 2063 6b0d 0a20 2020 2020 2020  atio ck..       
-00018360: 2023 2063 6b20 3d20 312e 202d 2020 2020   # ck = 1. -    
-00018370: 7272 5b6e 702e 6e6f 6e7a 6572 6f28 7272  rr[np.nonzero(rr
-00018380: 295b 305d 5d2e 7375 6d28 2920 2f20 280d  )[0]].sum() / (.
-00018390: 0a20 2020 2020 2020 2023 2020 2020 2031  .        #     1
-000183a0: 2069 6620 6c65 6e28 6e70 2e6e 6f6e 7a65   if len(np.nonze
-000183b0: 726f 2872 7229 5b30 5d29 3d3d 2030 2065  ro(rr)[0])== 0 e
-000183c0: 6c73 6520 6c65 6e28 6e70 2e6e 6f6e 7a65  lse len(np.nonze
-000183d0: 726f 2872 7229 5b30 5d29 2920 0d0a 2020  ro(rr)[0])) ..  
-000183e0: 2020 2020 2020 2320 636b 203d 2020 2831        # ck =  (1
-000183f0: 2e20 2a20 6c65 6e28 7272 2920 2d20 6c65  . * len(rr) - le
-00018400: 6e28 7272 5b6e 702e 6e6f 6e7a 6572 6f28  n(rr[np.nonzero(
-00018410: 7272 295b 305d 5d29 2029 2020 2f20 6c65  rr)[0]]) )  / le
-00018420: 6e28 7272 2920 0d0a 2020 2020 2020 2020  n(rr) ..        
-00018430: 636b 203d 2031 202d 206e 616e 5f73 756d  ck = 1 - nan_sum
-00018440: 2e73 756d 2829 202f 2028 6172 2e73 6861  .sum() / (ar.sha
-00018450: 7065 205b 305d 202a 2061 722e 7368 6170  pe [0] * ar.shap
-00018460: 6520 5b31 5d29 200d 0a20 2020 2020 2020  e [1]) ..       
-00018470: 200d 0a20 2020 2020 2020 2069 6e64 6578   ..        index
-00018480: 203d 2072 6573 6861 7065 2028 6e70 2e61   = reshape (np.a
-00018490: 7267 7768 6572 6520 2872 7220 3e20 746f  rgwhere (rr > to
-000184a0: 6c29 290d 0a20 2020 2020 2020 2061 725f  l))..        ar_
-000184b0: 6e65 7720 3d20 6e70 2e64 656c 6574 6520  new = np.delete 
-000184c0: 2872 7220 2c20 696e 6465 7820 2c20 6178  (rr , index , ax
-000184d0: 6973 203d 2030 2029 200d 0a20 2020 2020  is = 0 ) ..     
-000184e0: 2020 206e 6577 5f66 203d 206e 702e 6465     new_f = np.de
-000184f0: 6c65 7465 2028 665b 3a2c 204e 6f6e 655d  lete (f[:, None]
-00018500: 2c20 696e 6465 782c 2061 7869 7320 3d30  , index, axis =0
-00018510: 2029 0d0a 2020 2020 2020 2020 2320 696e   )..        # in
-00018520: 7465 7270 6f6c 6174 6520 6672 6571 200d  terpolate freq .
-00018530: 0a20 2020 2020 2020 2069 6620 665b 305d  .        if f[0]
-00018540: 203c 2066 5b2d 315d 3a20 0d0a 2020 2020   < f[-1]: ..    
-00018550: 2020 2020 2020 2020 6620 3d66 5b3a 3a2d          f =f[::-
-00018560: 315d 2023 2072 6576 6572 7365 2074 6865  1] # reverse the
-00018570: 2061 7272 6179 200d 0a20 2020 2020 2020   array ..       
-00018580: 2020 2020 2061 725f 6e65 7720 3d20 6172       ar_new = ar
-00018590: 5f6e 6577 205b 3a3a 2d31 5d20 2320 6f72  _new [::-1] # or
-000185a0: 206e 702e 666c 6970 7564 286e 702e 6973   np.flipud(np.is
-000185b0: 6e61 6e28 6172 2929 200d 0a20 2020 2020  nan(ar)) ..     
-000185c0: 2020 200d 0a20 2020 2020 2020 206e 6577     ..        new
-000185d0: 5f66 203d 206e 702e 6c6f 6773 7061 6365  _f = np.logspace
-000185e0: 286e 702e 6c6f 6731 3028 6e65 775f 662e  (np.log10(new_f.
-000185f0: 6d69 6e28 2929 202c 6e70 2e6c 6f67 3130  min()) ,np.log10
-00018600: 286e 6577 5f66 2e6d 6178 2829 292c 0d0a  (new_f.max()),..
+000177e0: 2020 2020 2020 2020 2020 2066 2220 6265             f" be
+000177f0: 2064 6973 7469 6e63 7420 6173 2070 6f73   distinct as pos
+00017800: 7369 626c 652e 2047 6f74 207b 6275 6666  sible. Got {buff
+00017810: 6572 7d22 290d 0a20 2020 2020 2020 2072  er}")..        r
+00017820: 6574 7572 6e20 6275 6666 6572 200d 0a0d  eturn buffer ...
+00017830: 0a20 2020 2064 6566 2071 6320 280d 0a20  .    def qc (.. 
+00017840: 2020 2020 2020 2073 656c 662c 2020 0d0a         self,  ..
+00017850: 2020 2020 2020 2020 746f 6c3a 2066 6c6f          tol: flo
+00017860: 6174 203d 202e 3520 2c20 0d0a 2020 2020  at = .5 , ..    
+00017870: 2020 2020 2a2c 200d 0a20 2020 2020 2020      *, ..       
+00017880: 2072 6574 7572 6e5f 6672 6571 3a20 626f   return_freq: bo
+00017890: 6f6c 203d 4661 6c73 652c 0d0a 2020 2020  ol =False,..    
+000178a0: 2020 2020 7265 7475 726e 5f72 6174 696f      return_ratio
+000178b0: 3a62 6f6f 6c3d 4661 6c73 652c 200d 0a20  :bool=False, .. 
+000178c0: 2020 2020 2020 2074 6f5f 6c6f 6731 303a         to_log10:
+000178d0: 2062 6f6f 6c3d 5472 7565 2c20 0d0a 2020   bool=True, ..  
+000178e0: 2020 2020 2020 292d 3e54 7570 6c65 5b66        )->Tuple[f
+000178f0: 6c6f 6174 2c20 4172 7261 794c 696b 655d  loat, ArrayLike]
+00017900: 3a20 0d0a 2020 2020 2020 2020 2222 2220  : ..        """ 
+00017910: 4368 6563 6b20 7468 6520 7175 616c 6974  Check the qualit
+00017920: 7920 636f 6e74 726f 6c20 6f66 2074 6865  y control of the
+00017930: 2063 6f6c 6c65 6374 6564 2045 4449 732e   collected EDIs.
+00017940: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00017950: 2020 2020 2041 6e61 6c79 7365 2074 6865       Analyse the
+00017960: 2064 6174 6120 696e 2074 6865 2045 4449   data in the EDI
+00017970: 2063 6f6c 6c65 6374 696f 6e20 616e 6420   collection and 
+00017980: 7265 7475 726e 2074 6865 2071 7561 6c69  return the quali
+00017990: 7479 2063 6f6e 7472 6f6c 2076 616c 7565  ty control value
+000179a0: 2e0d 0a20 2020 2020 2020 2049 7420 696e  ...        It in
+000179b0: 6469 6361 7465 7320 686f 7720 7065 7263  dicates how perc
+000179c0: 656e 7461 6765 2061 7265 2074 6865 2064  entage are the d
+000179d0: 6174 6120 746f 2062 6520 7265 7072 6573  ata to be repres
+000179e0: 656e 7461 7469 7665 2e0d 0a20 2020 2020  entative...     
+000179f0: 2020 200d 0a20 2020 2020 2020 2050 6172     ..        Par
+00017a00: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00017a10: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20   ------------.. 
+00017a20: 2020 2020 2020 2074 6f6c 3a20 666c 6f61         tol: floa
+00017a30: 742c 200d 0a20 2020 2020 2020 2020 2020  t, ..           
+00017a40: 2074 6865 2074 6f6c 6572 616e 6365 2070   the tolerance p
+00017a50: 6172 616d 6574 6572 2e20 5468 6520 7661  arameter. The va
+00017a60: 6c75 6520 696e 6469 6361 7465 7320 7468  lue indicates th
+00017a70: 6520 7261 7465 2066 726f 6d20 7768 6963  e rate from whic
+00017a80: 6820 7468 6520 0d0a 2020 2020 2020 2020  h the ..        
+00017a90: 2020 2020 6461 7461 2063 616e 2062 6520      data can be 
+00017aa0: 636f 6e73 6964 6572 2061 7320 6d65 616e  consider as mean
+00017ab0: 696e 6766 756c 2e20 5072 6566 6572 6162  ingful. Preferab
+00017ac0: 6c79 2069 7420 7368 6f75 6c64 2062 6520  ly it should be 
+00017ad0: 6c65 7373 2074 6861 6e0d 0a20 2020 2020  less than..     
+00017ae0: 2020 2020 2020 2031 2061 6e64 2067 7265         1 and gre
+00017af0: 6174 6572 2074 6861 6e20 302e 2041 7420  ater than 0. At 
+00017b00: 7468 6973 2076 616c 7565 2e20 4465 6661  this value. Defa
+00017b10: 756c 7420 6973 2060 602e 3560 6020 6d65  ult is ``.5`` me
+00017b20: 616e 7320 3530 2025 200d 0a20 2020 2020  ans 50 % ..     
+00017b30: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00017b40: 2072 6574 7572 6e5f 6672 6571 3a20 626f   return_freq: bo
+00017b50: 6f6c 2c20 4465 6661 756c 7420 3d46 616c  ol, Default =Fal
+00017b60: 7365 200d 0a20 2020 2020 2020 2020 2020  se ..           
+00017b70: 2072 6574 7572 6e20 7468 6520 696e 7465   return the inte
+00017b80: 7270 6f6c 6174 6564 2066 7265 7175 656e  rpolated frequen
+00017b90: 6379 2069 6620 7365 7420 746f 2060 6054  cy if set to ``T
+00017ba0: 7275 6560 602e 200d 0a20 2020 2020 2020  rue``. ..       
+00017bb0: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
+00017bc0: 6e5f 7261 7469 6f3a 2062 6f6f 6c2c 2064  n_ratio: bool, d
+00017bd0: 6566 6175 6c74 3d46 616c 7365 2c20 0d0a  efault=False, ..
+00017be0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00017bf0: 6e20 6f6e 6c79 2074 6865 2072 6174 696f  n only the ratio
+00017c00: 206f 6620 7468 6520 7265 7072 6573 656e   of the represen
+00017c10: 7461 7469 6f6e 206f 6620 7468 6520 6461  tation of the da
+00017c20: 7461 2e20 0d0a 2020 2020 2020 2020 2020  ta. ..          
+00017c30: 200d 0a20 2020 2020 2020 2020 2020 2e2e   ..           ..
+00017c40: 2076 6572 7369 6f6e 6164 6465 643a 3a20   versionadded:: 
+00017c50: 302e 312e 350d 0a20 2020 2020 2020 2020  0.1.5..         
+00017c60: 2020 0d0a 2020 2020 2020 2020 746f 5f6c    ..        to_l
+00017c70: 6f67 3130 3a62 6f6f 6c2c 2064 6566 6175  og10:bool, defau
+00017c80: 6c74 3d46 616c 7365 0d0a 2020 2020 2020  lt=False..      
+00017c90: 2020 2020 2063 6f6e 7665 7274 2074 6865       convert the
+00017ca0: 2069 6e74 6572 706f 6c61 7465 6420 6672   interpolated fr
+00017cb0: 6571 7565 6e63 7920 696e 746f 2061 206c  equency into a l
+00017cc0: 6f67 3130 2e20 0d0a 2020 2020 2020 2020  og10. ..        
+00017cd0: 2020 200d 0a20 2020 2020 2020 2052 6574     ..        Ret
+00017ce0: 7572 6e73 200d 0a20 2020 2020 2020 202d  urns ..        -
+00017cf0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00017d00: 2020 5475 706c 6520 2866 6c6f 6174 202c    Tuple (float ,
+00017d10: 2069 6e64 6578 2029 2020 6f72 2028 666c   index )  or (fl
+00017d20: 6f61 742c 2061 7272 6179 2d6c 696b 652c  oat, array-like,
+00017d30: 2073 6861 7065 2028 4e2c 2029 290d 0a20   shape (N, )).. 
+00017d40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00017d50: 6e20 7468 6520 7175 616c 6974 7920 636f  n the quality co
+00017d60: 6e74 726f 6c20 7661 6c75 6520 616e 6420  ntrol value and 
+00017d70: 696e 7465 7270 6f6c 6174 6564 2066 7265  interpolated fre
+00017d80: 7175 656e 6379 2069 6620 200d 0a20 2020  quency if  ..   
+00017d90: 2020 2020 2020 2020 2060 7265 7475 726e           `return
+00017da0: 5f66 7265 7160 2020 6973 2073 6574 2074  _freq`  is set t
+00017db0: 6f20 6060 5472 7565 6060 206f 7468 6572  o ``True`` other
+00017dc0: 7769 7365 2072 6574 7572 6e20 7468 6520  wise return the 
+00017dd0: 696e 6465 7820 6f66 2075 7365 6c65 7373  index of useless
+00017de0: 200d 0a20 2020 2020 2020 2020 2020 2064   ..            d
+00017df0: 6174 612e 200d 0a20 2020 2020 2020 2020  ata. ..         
+00017e00: 2020 200d 0a20 2020 2020 2020 2045 7861     ..        Exa
+00017e10: 6d70 6c65 730d 0a20 2020 2020 2020 202d  mples..        -
+00017e20: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00017e30: 2020 3e3e 3e20 6672 6f6d 2077 6174 6578    >>> from watex
+00017e40: 2e6d 6574 686f 6473 2e65 6d20 696d 706f  .methods.em impo
+00017e50: 7274 2050 726f 6365 7373 696e 670d 0a20  rt Processing.. 
+00017e60: 2020 2020 2020 203e 3e3e 2070 6f62 6a20         >>> pobj 
+00017e70: 3d20 5072 6f63 6573 7369 6e67 2829 2e66  = Processing().f
+00017e80: 6974 2827 6461 7461 2f65 6469 7327 290d  it('data/edis').
+00017e90: 0a20 2020 2020 2020 203e 3e3e 2066 203d  .        >>> f =
+00017ea0: 2070 6f62 6a2e 6765 7466 756c 6c66 7265   pobj.getfullfre
+00017eb0: 7175 656e 6379 2028 290d 0a20 2020 2020  quency ()..     
+00017ec0: 2020 203e 3e3e 2023 206c 656e 2866 290d     >>> # len(f).
+00017ed0: 0a20 2020 2020 2020 203e 3e3e 2023 202e  .        >>> # .
+00017ee0: 2e2e 2035 3520 2320 3535 2066 7265 7175  .. 55 # 55 frequ
+00017ef0: 656e 6369 6573 200d 0a20 2020 2020 2020  encies ..       
+00017f00: 203e 3e3e 2063 2c5f 203d 2070 6f62 6a2e   >>> c,_ = pobj.
+00017f10: 7163 2028 2074 6f6c 203d 202e 3420 2920  qc ( tol = .4 ) 
+00017f20: 2320 6d65 616e 2036 3025 2074 6f20 636f  # mean 60% to co
+00017f30: 6e73 6964 6572 2074 6865 2064 6174 6120  nsider the data 
+00017f40: 6173 0d0a 2020 2020 2020 2020 3e3e 3e20  as..        >>> 
+00017f50: 2320 7265 7072 6573 656e 7461 7469 7665  # representative
+00017f60: 7320 0d0a 2020 2020 2020 2020 3e3e 3e20  s ..        >>> 
+00017f70: 6320 2023 2074 6865 2072 6570 7265 7365  c  # the represe
+00017f80: 6e74 6174 6976 6520 7261 7465 2069 6e20  ntative rate in 
+00017f90: 7468 6520 7768 6f6c 6520 4544 492d 2063  the whole EDI- c
+00017fa0: 6f6c 6c65 6374 696f 6e0d 0a20 2020 2020  ollection..     
+00017fb0: 2020 203e 3e3e 2023 202e 2e2e 2030 2e39     >>> # ... 0.9
+00017fc0: 3520 2320 7468 6520 7768 6f6c 6520 6461  5 # the whole da
+00017fd0: 7461 2061 7420 616c 6c20 7374 6174 696f  ta at all statio
+00017fe0: 6e73 2069 7320 7361 6665 2074 6f20 3935  ns is safe to 95
+00017ff0: 252e 200d 0a20 2020 2020 2020 203e 3e3e  %. ..        >>>
+00018000: 2023 206e 6f77 2063 6865 636b 2074 6865   # now check the
+00018010: 2069 6e74 6572 706f 6c61 7465 6420 6672   interpolated fr
+00018020: 6571 7565 6e63 7920 0d0a 2020 2020 2020  equency ..      
+00018030: 2020 3e3e 3e20 632c 2066 7265 715f 6e65    >>> c, freq_ne
+00018040: 7720 203d 2070 6f62 6a2e 7163 2028 2074  w  = pobj.qc ( t
+00018050: 6f6c 3d2e 3620 2c20 7265 7475 726e 5f66  ol=.6 , return_f
+00018060: 7265 7120 3d54 7275 6529 0d0a 2020 2020  req =True)..    
+00018070: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00018080: 2020 2222 220d 0a20 2020 2020 2020 2073    """..        s
+00018090: 656c 662e 696e 7370 6563 7420 0d0a 2020  elf.inspect ..  
+000180a0: 2020 2020 2020 746f 6c20 3d20 6173 7365        tol = asse
+000180b0: 7274 5f72 6174 696f 2874 6f6c 202c 2062  rt_ratio(tol , b
+000180c0: 6f75 6e64 7320 3d28 302c 2031 292c 2065  ounds =(0, 1), e
+000180d0: 7863 6c75 6465 5f76 616c 7565 203d 302c  xclude_value =0,
+000180e0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000180f0: 2020 2020 2020 2020 2020 2020 2020 6e61                na
+00018100: 6d65 203d 2774 6f6c 6572 616e 6365 272c  me ='tolerance',
+00018110: 2069 6e5f 7065 7263 656e 7420 3d54 7275   in_percent =Tru
+00018120: 6520 290d 0a20 2020 2020 2020 200d 0a20  e )..        .. 
+00018130: 2020 2020 2020 2066 3d73 656c 662e 6672         f=self.fr
+00018140: 6571 735f 2e63 6f70 7928 2920 0d0a 2020  eqs_.copy() ..  
+00018150: 2020 200d 0a20 2020 2020 2020 2074 7279     ..        try
+00018160: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+00018170: 2023 2074 616b 6520 6120 7361 6d70 6c65   # take a sample
+00018180: 206f 6620 636f 6c6c 6563 7465 6420 6564   of collected ed
+00018190: 6920 0d0a 2020 2020 2020 2020 2020 2020  i ..            
+000181a0: 2320 616e 6420 6d61 6b65 2074 776f 2064  # and make two d
+000181b0: 6179 2061 7272 6179 0d0a 2020 2020 2020  ay array..      
+000181c0: 2020 2020 2020 2320 616c 6c20 6672 6571        # all freq
+000181d0: 7565 6e63 7920 6174 2061 6c6c 2073 7461  uency at all sta
+000181e0: 7469 6f6e 7320 0d0a 2020 2020 2020 2020  tions ..        
+000181f0: 2020 2020 6172 203d 2073 656c 662e 6d61      ar = self.ma
+00018200: 6b65 3264 2028 2766 7265 7127 2920 0d0a  ke2d ('freq') ..
+00018210: 2020 2020 2020 2020 6578 6365 7074 203a          except :
+00018220: 200d 0a20 2020 2020 2020 2020 2020 2074   ..            t
+00018230: 7279 203a 200d 0a20 2020 2020 2020 2020  ry : ..         
+00018240: 2020 2020 2020 2061 7220 3d20 7365 6c66         ar = self
+00018250: 2e6d 616b 6532 6428 2027 7a78 7927 290d  .make2d( 'zxy').
+00018260: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+00018270: 6570 743a 2061 7220 3d20 7365 6c66 2e6d  ept: ar = self.m
+00018280: 616b 6532 6420 2827 7a79 7827 290d 0a20  ake2d ('zyx').. 
+00018290: 2020 2020 2020 2023 2063 6f6d 7075 7465         # compute
+000182a0: 2074 6865 2072 6174 696f 206f 6620 4e61   the ratio of Na
+000182b0: 4e20 696e 2061 7869 7320 3d30 200d 0a20  N in axis =0 .. 
+000182c0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000182d0: 206e 616e 5f73 756d 2020 3d6e 702e 6e61   nan_sum  =np.na
+000182e0: 6e73 756d 286e 702e 6973 6e61 6e28 6172  nsum(np.isnan(ar
+000182f0: 292c 2061 7869 7320 3d31 2920 0d0a 2020  ), axis =1) ..  
+00018300: 2020 2020 2020 7272 3d20 6e70 2e61 726f        rr= np.aro
+00018310: 756e 6420 2820 6e61 6e5f 7375 6d20 2f20  und ( nan_sum / 
+00018320: 6172 2e73 6861 7065 5b31 5d20 2c20 3229  ar.shape[1] , 2)
+00018330: 200d 0a20 2020 2020 2020 2023 2063 6f6d   ..        # com
+00018340: 7075 7465 2074 6865 2072 6174 696f 2063  pute the ratio c
+00018350: 6b0d 0a20 2020 2020 2020 2023 2063 6b20  k..        # ck 
+00018360: 3d20 312e 202d 2020 2020 7272 5b6e 702e  = 1. -    rr[np.
+00018370: 6e6f 6e7a 6572 6f28 7272 295b 305d 5d2e  nonzero(rr)[0]].
+00018380: 7375 6d28 2920 2f20 280d 0a20 2020 2020  sum() / (..     
+00018390: 2020 2023 2020 2020 2031 2069 6620 6c65     #     1 if le
+000183a0: 6e28 6e70 2e6e 6f6e 7a65 726f 2872 7229  n(np.nonzero(rr)
+000183b0: 5b30 5d29 3d3d 2030 2065 6c73 6520 6c65  [0])== 0 else le
+000183c0: 6e28 6e70 2e6e 6f6e 7a65 726f 2872 7229  n(np.nonzero(rr)
+000183d0: 5b30 5d29 2920 0d0a 2020 2020 2020 2020  [0])) ..        
+000183e0: 2320 636b 203d 2020 2831 2e20 2a20 6c65  # ck =  (1. * le
+000183f0: 6e28 7272 2920 2d20 6c65 6e28 7272 5b6e  n(rr) - len(rr[n
+00018400: 702e 6e6f 6e7a 6572 6f28 7272 295b 305d  p.nonzero(rr)[0]
+00018410: 5d29 2029 2020 2f20 6c65 6e28 7272 2920  ]) )  / len(rr) 
+00018420: 0d0a 2020 2020 2020 2020 636b 203d 2031  ..        ck = 1
+00018430: 202d 206e 616e 5f73 756d 2e73 756d 2829   - nan_sum.sum()
+00018440: 202f 2028 6172 2e73 6861 7065 205b 305d   / (ar.shape [0]
+00018450: 202a 2061 722e 7368 6170 6520 5b31 5d29   * ar.shape [1])
+00018460: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00018470: 2020 2020 2069 6e64 6578 203d 2072 6573       index = res
+00018480: 6861 7065 2028 6e70 2e61 7267 7768 6572  hape (np.argwher
+00018490: 6520 2872 7220 3e20 746f 6c29 290d 0a20  e (rr > tol)).. 
+000184a0: 2020 2020 2020 2061 725f 6e65 7720 3d20         ar_new = 
+000184b0: 6e70 2e64 656c 6574 6520 2872 7220 2c20  np.delete (rr , 
+000184c0: 696e 6465 7820 2c20 6178 6973 203d 2030  index , axis = 0
+000184d0: 2029 200d 0a20 2020 2020 2020 206e 6577   ) ..        new
+000184e0: 5f66 203d 206e 702e 6465 6c65 7465 2028  _f = np.delete (
+000184f0: 665b 3a2c 204e 6f6e 655d 2c20 696e 6465  f[:, None], inde
+00018500: 782c 2061 7869 7320 3d30 2029 0d0a 2020  x, axis =0 )..  
+00018510: 2020 2020 2020 2320 696e 7465 7270 6f6c        # interpol
+00018520: 6174 6520 6672 6571 200d 0a20 2020 2020  ate freq ..     
+00018530: 2020 2069 6620 665b 305d 203c 2066 5b2d     if f[0] < f[-
+00018540: 315d 3a20 0d0a 2020 2020 2020 2020 2020  1]: ..          
+00018550: 2020 6620 3d66 5b3a 3a2d 315d 2023 2072    f =f[::-1] # r
+00018560: 6576 6572 7365 2074 6865 2061 7272 6179  everse the array
+00018570: 200d 0a20 2020 2020 2020 2020 2020 2061   ..            a
+00018580: 725f 6e65 7720 3d20 6172 5f6e 6577 205b  r_new = ar_new [
+00018590: 3a3a 2d31 5d20 2320 6f72 206e 702e 666c  ::-1] # or np.fl
+000185a0: 6970 7564 286e 702e 6973 6e61 6e28 6172  ipud(np.isnan(ar
+000185b0: 2929 200d 0a20 2020 2020 2020 200d 0a20  )) ..        .. 
+000185c0: 2020 2020 2020 206e 6577 5f66 203d 206e         new_f = n
+000185d0: 702e 6c6f 6773 7061 6365 286e 702e 6c6f  p.logspace(np.lo
+000185e0: 6731 3028 6e65 775f 662e 6d69 6e28 2929  g10(new_f.min())
+000185f0: 202c 6e70 2e6c 6f67 3130 286e 6577 5f66   ,np.log10(new_f
+00018600: 2e6d 6178 2829 292c 0d0a 2020 2020 2020  .max()),..      
 00018610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018620: 2020 2020 2020 2020 2020 2020 6c65 6e28              len(
-00018630: 6e65 775f 6629 295b 3a3a 2d31 5d0d 0a20  new_f))[::-1].. 
-00018640: 2020 2020 2020 2069 6620 6e6f 7420 746f         if not to
-00018650: 5f6c 6f67 3130 3a20 0d0a 2020 2020 2020  _log10: ..      
-00018660: 2020 2020 2020 6e65 775f 6620 3d20 6e70        new_f = np
-00018670: 2e70 6f77 6572 2831 3020 2c20 6e65 775f  .power(10 , new_
-00018680: 6629 0d0a 2020 2020 2020 2020 2020 2020  f)..            
-00018690: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000186a0: 206e 702e 6172 6f75 6e64 2028 636b 2c20   np.around (ck, 
-000186b0: 3229 2069 6620 7265 7475 726e 5f72 6174  2) if return_rat
-000186c0: 696f 2065 6c73 6520 280d 0a20 2020 2020  io else (..     
-000186d0: 2020 2020 2020 206e 702e 6172 6f75 6e64         np.around
-000186e0: 2028 636b 2c20 3229 2c20 6e65 775f 6620   (ck, 2), new_f 
-000186f0: 2020 6966 2072 6574 7572 6e5f 6672 6571    if return_freq
-00018700: 2065 6c73 6520 696e 6465 7820 2920 2020   else index )   
-00018710: 0d0a 0d0a 0d0a 2020 2020 405f 7a75 7064  ......    @_zupd
-00018720: 6174 6528 6f70 7469 6f6e 203d 2027 6e6f  ate(option = 'no
-00018730: 6e65 2729 0d0a 2020 2020 6465 6620 6765  ne')..    def ge
-00018740: 7456 616c 6964 5465 6e73 6f72 7328 0d0a  tValidTensors(..
-00018750: 2020 2020 2020 2020 7365 6c66 2c20 0d0a          self, ..
-00018760: 2020 2020 2020 2020 746f 6c3a 666c 6f61          tol:floa
-00018770: 7420 3d20 2e35 2c20 200d 0a20 2020 2020  t = .5,  ..     
-00018780: 2020 202a 2a6b 7773 200d 0a20 2020 2020     **kws ..     
-00018790: 2020 2029 2d3e 204e 4441 7272 6179 5b44     )-> NDArray[D
-000187a0: 5479 7065 5b63 6f6d 706c 6578 5d5d 3a20  Type[complex]]: 
-000187b0: 0d0a 2020 2020 2020 2020 2222 2253 656c  ..        """Sel
-000187c0: 6563 7420 7661 6c69 6420 7465 6e73 6f72  ect valid tensor
-000187d0: 7320 6672 6f6d 2074 6f6c 6572 616e 6365  s from tolerance
-000187e0: 2074 6872 6573 686f 6c64 2061 6e64 2077   threshold and w
-000187f0: 7269 7465 2045 4449 2069 6620 0d0a 2020  rite EDI if ..  
-00018800: 2020 2020 2020 6170 706c 6963 6162 6c65        applicable
-00018810: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-00018820: 2020 2020 2046 756e 6374 696f 6e20 616e       Function an
-00018830: 616c 797a 6573 2074 6865 2064 6174 6120  alyzes the data 
-00018840: 616e 6420 6b65 6570 2074 6865 2067 6f6f  and keep the goo
-00018850: 6420 6f6e 6573 2e20 5468 6520 676f 6f64  d ones. The good
-00018860: 6e65 7373 206f 6620 7468 6520 6461 7461  ness of the data
-00018870: 200d 0a20 2020 2020 2020 2064 6570 656e   ..        depen
-00018880: 6473 206f 6e20 7468 6520 2060 7468 7265  ds on the  `thre
-00018890: 7368 6f6c 6460 2072 6174 652e 2020 466f  shold` rate.  Fo
-000188a0: 7220 696e 7374 616e 6365 2035 3025 206d  r instance 50% m
-000188b0: 6561 6e73 2074 6f20 636f 6e73 6964 6572  eans to consider
-000188c0: 2061 6e20 0d0a 2020 2020 2020 2020 696d   an ..        im
-000188d0: 7065 6461 6e63 6520 7465 6e73 6f72 2027  pedance tensor '
-000188e0: 7a27 2020 7661 6c69 6420 6966 2074 6865  z'  valid if the
-000188f0: 2071 7561 6c69 7479 2063 6f6e 7472 6f6c   quality control
-00018900: 2073 686f 7773 2061 7420 6c65 6173 7420   shows at least 
-00018910: 7468 6174 2073 636f 7265 200d 0a20 2020  that score ..   
-00018920: 2020 2020 2061 7420 6561 6368 2066 7265       at each fre
-00018930: 7175 656e 6379 206f 6620 616c 6c20 7374  quency of all st
-00018940: 6174 696f 6e73 2e20 200d 0a20 2020 2020  ations.  ..     
-00018950: 2020 200d 0a20 2020 2020 2020 2050 6172     ..        Par
-00018960: 616d 6574 6572 7320 0d0a 2020 2020 2020  ameters ..      
-00018970: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00018980: 2020 2020 2020 6461 7461 3a20 5061 7468        data: Path
-00018990: 2d6c 696b 6520 6f62 6a65 6374 206f 7220  -like object or 
-000189a0: 6c69 7374 206f 6620 203a 636c 6173 733a  list of  :class:
-000189b0: 6070 7963 7361 6d74 2e63 6f72 652e 6564  `pycsamt.core.ed
-000189c0: 692e 4564 6960 2020 0d0a 2020 2020 2020  i.Edi`  ..      
-000189d0: 2020 2020 2020 636f 6c6c 6563 7469 6f6e        collection
-000189e0: 7320 6f66 2045 4449 2d6f 626a 6563 7473  s of EDI-objects
-000189f0: 2066 726f 6d20 6070 7963 7361 6d74 605f   from `pycsamt`_
-00018a00: 202e 2060 6461 7461 6020 7061 7261 6d73   . `data` params
-00018a10: 2069 7320 0d0a 2020 2020 2020 2020 2020   is ..          
-00018a20: 2020 7061 7373 6564 2074 6f20 3a6d 6574    passed to :met
-00018a30: 683a 607e 2e50 726f 6365 7373 696e 672e  h:`~.Processing.
-00018a40: 6669 7460 206d 6574 686f 642e 200d 0a20  fit` method. .. 
-00018a50: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-00018a60: 0a20 2020 2020 2020 2074 6f6c 203a 2066  .        tol : f
-00018a70: 6c6f 6174 2c20 0d0a 2020 2020 2020 2020  loat, ..        
-00018a80: 2020 2020 746f 6c65 7261 6e63 6520 7061      tolerance pa
-00018a90: 7261 6d65 7465 722e 2054 6865 2076 616c  rameter. The val
-00018aa0: 7565 2069 6e64 6963 6174 6573 2074 6865  ue indicates the
-00018ab0: 2072 6174 6520 6672 6f6d 2077 6869 6368   rate from which
-00018ac0: 2074 6865 2064 6174 6120 0d0a 2020 2020   the data ..    
-00018ad0: 2020 2020 2020 2020 6361 6e20 6265 2063          can be c
-00018ae0: 6f6e 7369 6465 7220 6173 2061 2076 616c  onsider as a val
-00018af0: 6964 2e20 5468 6520 7661 6c69 6420 6461  id. The valid da
-00018b00: 7461 2073 656c 6563 7469 6f6e 2073 686f  ta selection sho
-00018b10: 756c 6420 6265 2073 6f66 7420 7768 656e  uld be soft when
-00018b20: 0d0a 2020 2020 2020 2020 2020 2020 7468  ..            th
-00018b30: 6520 746f 6c65 7261 6e63 6520 7061 7261  e tolerance para
-00018b40: 6d65 7465 7220 2069 7320 2063 6c6f 7365  meter  is  close
-00018b50: 2074 6f20 2731 2720 616e 6420 6861 7264   to '1' and hard
-00018b60: 206f 7468 6572 7769 7365 2e20 4173 2074   otherwise. As t
-00018b70: 6865 200d 0a20 2020 2020 2020 2020 2020  he ..           
-00018b80: 2060 746f 6c60 2076 616c 7565 2064 6563   `tol` value dec
-00018b90: 7265 6173 6573 2c20 7468 6520 7365 6c65  reases, the sele
-00018ba0: 6374 696f 6e20 2062 6563 6f6d 6573 2073  ction  becomes s
-00018bb0: 6576 6572 652e 200d 0a20 2020 2020 2020  evere. ..       
-00018bc0: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
-00018bd0: 6060 2e35 6060 206d 6561 6e73 2035 3020  ``.5`` means 50 
-00018be0: 2520 200d 0a20 2020 2020 2020 2020 2020  %  ..           
-00018bf0: 200d 0a20 2020 2020 2020 206b 7773 3a20   ..        kws: 
-00018c00: 6469 6374 202c 200d 0a20 2020 2020 2020  dict , ..       
-00018c10: 2020 2020 2041 6464 6974 696f 6e61 6c20       Additional 
-00018c20: 6b65 7977 6f72 6473 2061 7267 756d 656e  keywords argumen
-00018c30: 7473 2066 6f72 2045 4449 2066 696c 6520  ts for EDI file 
-00018c40: 6578 706f 7274 696e 6720 0d0a 2020 2020  exporting ..    
-00018c50: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00018c60: 2020 5265 7475 726e 7320 0d0a 2020 2020    Returns ..    
-00018c70: 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020      --------..  
-00018c80: 2020 2020 2020 5a63 3a20 3a63 6c61 7373        Zc: :class
-00018c90: 3a60 7761 7465 782e 6578 7465 726e 616c  :`watex.external
-00018ca0: 732e 7a2e 5a60 2069 6d70 6564 616e 6365  s.z.Z` impedance
-00018cb0: 2074 656e 736f 7220 6f62 6a65 6374 732e   tensor objects.
-00018cc0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00018cd0: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-00018ce0: 200d 0a20 2020 2020 2020 202d 2d2d 2d2d   ..        -----
-00018cf0: 2d2d 2d0d 0a20 2020 2020 2020 203e 3e3e  ---..        >>>
-00018d00: 2066 726f 6d20 7761 7465 782e 6d65 7468   from watex.meth
-00018d10: 6f64 732e 656d 2069 6d70 6f72 7420 5072  ods.em import Pr
-00018d20: 6f63 6573 7369 6e67 200d 0a20 2020 2020  ocessing ..     
-00018d30: 2020 203e 3e3e 2070 4f62 6a20 3d20 5072     >>> pObj = Pr
-00018d40: 6f63 6573 7369 6e67 2028 292e 6669 7428  ocessing ().fit(
-00018d50: 2764 6174 612f 6564 6973 2729 0d0a 2020  'data/edis')..  
-00018d60: 2020 2020 2020 3e3e 3e20 663d 2070 4f62        >>> f= pOb
-00018d70: 6a2e 6672 6571 735f 0d0a 2020 2020 2020  j.freqs_..      
-00018d80: 2020 3e3e 3e20 6c65 6e28 6629 200d 0a20    >>> len(f) .. 
-00018d90: 2020 2020 2020 202e 2e2e 2035 350d 0a20         ... 55.. 
-00018da0: 2020 2020 2020 203e 3e3e 207a 4f62 6a73         >>> zObjs
-00018db0: 5f68 6172 6420 3d20 704f 626a 2e67 6574  _hard = pObj.get
-00018dc0: 5661 6c69 6454 656e 736f 7273 2028 746f  ValidTensors (to
-00018dd0: 6c3d 2030 2e33 2029 2023 204e 6f6e 6520  l= 0.3 ) # None 
-00018de0: 646f 6573 6e27 7420 6578 706f 7274 2045  doesn't export E
-00018df0: 4449 2d66 696c 650d 0a20 2020 2020 2020  DI-file..       
-00018e00: 203e 3e3e 206c 656e 287a 4f62 6a73 5f68   >>> len(zObjs_h
-00018e10: 6172 645b 305d 2e5f 6672 6571 2920 2320  ard[0]._freq) # 
-00018e20: 7375 7070 7265 7373 2033 2074 656e 736f  suppress 3 tenso
-00018e30: 7220 6461 7461 200d 0a20 2020 2020 2020  r data ..       
-00018e40: 202e 2e2e 2035 3220 0d0a 2020 2020 2020   ... 52 ..      
-00018e50: 2020 3e3e 3e20 7a4f 626a 735f 736f 6674    >>> zObjs_soft
-00018e60: 2020 3d20 704f 626a 2e67 6574 5661 6c69    = pObj.getVali
-00018e70: 6454 656e 736f 7273 2870 2e65 6469 4f62  dTensors(p.ediOb
-00018e80: 6a73 5f2c 2074 6f6c 203d 2030 2e36 202c  js_, tol = 0.6 ,
-00018e90: 206f 7074 696f 6e20 3d27 7772 6974 6527   option ='write'
-00018ea0: 290d 0a20 2020 2020 2020 203e 3e3e 206c  )..        >>> l
-00018eb0: 656e 287a 4f62 6a73 5f73 6f66 745b 305d  en(zObjs_soft[0]
-00018ec0: 2e5f 6672 6571 2920 2023 2073 7570 7072  ._freq)  # suppr
-00018ed0: 6573 7320 6f6e 6c79 2074 776f 200d 0a20  ess only two .. 
-00018ee0: 2020 2020 2020 202e 2e2e 2035 330d 0a20         ... 53.. 
-00018ef0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00018f00: 2022 2222 0d0a 2020 2020 2020 2020 0d0a   """..        ..
-00018f10: 2020 2020 2020 2020 6465 6620 6465 6c65          def dele
-00018f20: 7465 5f75 7365 6c65 7373 5f74 656e 736f  te_useless_tenso
-00018f30: 7220 287a 202c 2020 696e 6465 7820 2c20  r (z ,  index , 
-00018f40: 6178 6973 203d 2030 293a 0d0a 2020 2020  axis = 0):..    
-00018f50: 2020 2020 2020 2020 2222 2252 656d 6f76          """Remov
-00018f60: 6520 6d65 6e69 6e67 6c65 7373 2074 656e  e meningless ten
-00018f70: 736f 7220 6461 7461 2222 220d 0a20 2020  sor data"""..   
-00018f80: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00018f90: 6e70 2e64 656c 6574 6520 287a 2c20 696e  np.delete (z, in
-00018fa0: 6465 7820 2c20 6178 6973 2029 0d0a 2020  dex , axis )..  
-00018fb0: 2020 2020 2020 6465 6620 7365 745f 6e75        def set_nu
-00018fc0: 6c6c 2866 7265 712c 206f 626a 7329 3a20  ll(freq, objs): 
-00018fd0: 0d0a 2020 2020 2020 2020 2020 2020 2222  ..            ""
-00018fe0: 2253 6574 206e 756c 6c20 696e 2074 6865  "Set null in the
-00018ff0: 2063 6173 6520 7468 6520 636f 6d70 6f6e   case the compon
-00019000: 656e 7420 646f 6573 6e27 7420 6578 6973  ent doesn't exis
-00019010: 7422 2222 0d0a 2020 2020 2020 2020 2020  t"""..          
-00019020: 2020 7265 7475 726e 206e 702e 7a65 726f    return np.zero
-00019030: 7320 2828 6c65 6e28 6629 2c20 6c65 6e28  s ((len(f), len(
-00019040: 6f62 6a73 2929 2c20 6474 7970 6520 3d20  objs)), dtype = 
-00019050: 6e70 2e66 6c6f 6174 3332 290d 0a20 2020  np.float32)..   
-00019060: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
-00019070: 656c 662e 696e 7370 6563 7420 0d0a 2020  elf.inspect ..  
-00019080: 2020 2020 2020 2320 6564 694f 626a 7320        # ediObjs 
-00019090: 3d20 6765 745f 6564 694f 626a 7328 6564  = get_ediObjs(ed
-000190a0: 694f 626a 7329 200d 0a20 2020 2020 2020  iObjs) ..       
-000190b0: 205f 2c20 6e6f 5f69 7820 3d20 7365 6c66   _, no_ix = self
-000190c0: 2e71 6328 746f 6c3d 746f 6c20 2920 0d0a  .qc(tol=tol ) ..
-000190d0: 2020 2020 2020 2020 6620 3d20 7365 6c66          f = self
-000190e0: 2e66 7265 7173 5f2e 636f 7079 2829 200d  .freqs_.copy() .
-000190f0: 0a20 2020 200d 0a20 2020 2020 2020 2066  .    ..        f
-00019100: 6620 3d20 6e70 2e64 656c 6574 6520 2866  f = np.delete (f
-00019110: 5b3a 2c20 4e6f 6e65 5d2c 206e 6f5f 6978  [:, None], no_ix
-00019120: 2c20 3029 0d0a 2020 2020 2020 2020 2320  , 0)..        # 
-00019130: 696e 7465 7270 6f6c 6174 6520 6672 6571  interpolate freq
-00019140: 7565 6e63 7920 0d0a 2020 2020 2020 2020  uency ..        
-00019150: 6e65 775f 6620 203d 2050 726f 6365 7373  new_f  = Process
-00019160: 696e 672e 6672 6571 496e 7465 7270 6f6c  ing.freqInterpol
-00019170: 6174 696f 6e20 2872 6573 6861 7065 2028  ation (reshape (
-00019180: 6666 2929 200d 0a20 2020 2020 2020 200d  ff)) ..        .
-00019190: 0a20 2020 2020 2020 2023 2067 6174 6865  .        # gathe
-000191a0: 7220 7468 6520 3244 207a 206f 626a 6563  r the 2D z objec
-000191b0: 7473 0d0a 2020 2020 2020 2020 2320 2d58  ts..        # -X
-000191c0: 582d 2d0d 0a20 2020 2020 2020 2074 7279  X--..        try
-000191d0: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-000191e0: 207a 7878 203d 2064 656c 6574 655f 7573   zxx = delete_us
-000191f0: 656c 6573 735f 7465 6e73 6f72 280d 0a20  eless_tensor(.. 
-00019200: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00019210: 656c 662e 6d61 6b65 3264 2028 2027 7a78  elf.make2d ( 'zx
-00019220: 7827 292c 206e 6f5f 6978 2920 0d0a 2020  x'), no_ix) ..  
-00019230: 2020 2020 2020 2020 2020 7a78 7820 3d20            zxx = 
-00019240: 696e 7465 7270 6f6c 6174 6532 6428 7a78  interpolate2d(zx
-00019250: 7829 0d0a 2020 2020 2020 2020 2020 2020  x)..            
-00019260: 7a78 785f 6572 7220 3d20 6465 6c65 7465  zxx_err = delete
-00019270: 5f75 7365 6c65 7373 5f74 656e 736f 7228  _useless_tensor(
-00019280: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019290: 2020 7365 6c66 2e6d 616b 6532 6420 2827    self.make2d ('
-000192a0: 7a78 785f 6572 7227 2920 2c20 6e6f 5f69  zxx_err') , no_i
-000192b0: 7820 2920 0d0a 2020 2020 2020 2020 2020  x ) ..          
-000192c0: 2020 7a78 785f 6572 7220 3d20 696e 7465    zxx_err = inte
-000192d0: 7270 6f6c 6174 6532 6420 287a 7878 5f65  rpolate2d (zxx_e
-000192e0: 7272 2029 0d0a 2020 2020 2020 2020 6578  rr )..        ex
-000192f0: 6365 7074 203a 0d0a 2020 2020 2020 2020  cept :..        
-00019300: 2020 2020 7a78 7820 3d20 7365 745f 6e75      zxx = set_nu
-00019310: 6c6c 286e 6577 5f66 2c20 7365 6c66 2e65  ll(new_f, self.e
-00019320: 6469 4f62 6a73 5f29 0d0a 2020 2020 2020  diObjs_)..      
-00019330: 2020 2020 2020 7a78 785f 6572 723d 207a        zxx_err= z
-00019340: 7878 2e63 6f70 7928 2920 0d0a 2020 2020  xx.copy() ..    
-00019350: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00019360: 2020 2320 2d58 592d 2d20 2020 200d 0a20    # -XY--    .. 
-00019370: 2020 2020 2020 2074 7279 203a 0d0a 2020         try :..  
-00019380: 2020 2020 2020 2020 2020 7a78 7920 3d20            zxy = 
-00019390: 6465 6c65 7465 5f75 7365 6c65 7373 5f74  delete_useless_t
-000193a0: 656e 736f 7228 0d0a 2020 2020 2020 2020  ensor(..        
-000193b0: 2020 2020 2020 2020 7365 6c66 2e6d 616b          self.mak
-000193c0: 6532 6420 2820 277a 7879 2729 2c20 6e6f  e2d ( 'zxy'), no
-000193d0: 5f69 7820 2920 200d 0a20 2020 2020 2020  _ix )  ..       
-000193e0: 2020 2020 207a 7879 3d20 696e 7465 7270       zxy= interp
-000193f0: 6f6c 6174 6532 6428 207a 7879 290d 0a20  olate2d( zxy).. 
-00019400: 2020 2020 2020 2020 2020 207a 7879 5f65             zxy_e
-00019410: 7272 203d 2064 656c 6574 655f 7573 656c  rr = delete_usel
-00019420: 6573 735f 7465 6e73 6f72 2820 0d0a 2020  ess_tensor( ..  
-00019430: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00019440: 6c66 2e6d 616b 6532 6420 2820 277a 7879  lf.make2d ( 'zxy
-00019450: 5f65 7272 2729 202c 206e 6f5f 6978 2029  _err') , no_ix )
-00019460: 0d0a 2020 2020 2020 2020 2020 2020 7a78  ..            zx
-00019470: 795f 6572 7220 3d20 696e 7465 7270 6f6c  y_err = interpol
-00019480: 6174 6532 6428 7a78 795f 6572 7229 0d0a  ate2d(zxy_err)..
-00019490: 2020 2020 2020 2020 6578 6365 7074 3a20          except: 
-000194a0: 0d0a 2020 2020 2020 2020 2020 2020 7a78  ..            zx
-000194b0: 7920 3d20 7365 745f 6e75 6c6c 286e 6577  y = set_null(new
-000194c0: 5f66 2c20 7365 6c66 2e65 6469 4f62 6a73  _f, self.ediObjs
-000194d0: 5f29 0d0a 2020 2020 2020 2020 2020 2020  _)..            
-000194e0: 7a78 795f 6572 723d 207a 7879 2e63 6f70  zxy_err= zxy.cop
-000194f0: 7928 2920 0d0a 2020 2020 0d0a 2020 2020  y() ..    ..    
-00019500: 2020 2020 2320 2d59 582d 2d0d 0a20 2020      # -YX--..   
-00019510: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00019520: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00019530: 207a 7978 203d 2064 656c 6574 655f 7573   zyx = delete_us
-00019540: 656c 6573 735f 7465 6e73 6f72 2820 0d0a  eless_tensor( ..
-00019550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019560: 7365 6c66 2e6d 616b 6532 6420 2827 7a79  self.make2d ('zy
-00019570: 7827 2920 2c20 6e6f 5f69 7820 2920 0d0a  x') , no_ix ) ..
-00019580: 2020 2020 2020 2020 2020 2020 7a79 7820              zyx 
-00019590: 3d20 696e 7465 7270 6f6c 6174 6532 6428  = interpolate2d(
-000195a0: 7a79 7829 0d0a 2020 2020 2020 2020 2020  zyx)..          
-000195b0: 2020 7a79 785f 6572 7220 3d20 6465 6c65    zyx_err = dele
-000195c0: 7465 5f75 7365 6c65 7373 5f74 656e 736f  te_useless_tenso
-000195d0: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
-000195e0: 2020 2020 7365 6c66 2e6d 616b 6532 6420      self.make2d 
-000195f0: 2820 277a 7978 5f65 7272 2729 202c 206e  ( 'zyx_err') , n
-00019600: 6f5f 6978 2029 200d 0a20 2020 2020 2020  o_ix ) ..       
-00019610: 2020 2020 207a 7978 5f65 7272 203d 2069       zyx_err = i
-00019620: 6e74 6572 706f 6c61 7465 3264 2820 7a79  nterpolate2d( zy
-00019630: 785f 6572 7220 290d 0a20 2020 2020 2020  x_err )..       
-00019640: 2065 7863 6570 743a 200d 0a20 2020 2020   except: ..     
-00019650: 2020 2020 2020 207a 7978 203d 2073 6574         zyx = set
-00019660: 5f6e 756c 6c28 6e65 775f 662c 2073 656c  _null(new_f, sel
-00019670: 662e 6564 694f 626a 735f 290d 0a20 2020  f.ediObjs_)..   
-00019680: 2020 2020 2020 2020 207a 7978 5f65 7272           zyx_err
-00019690: 3d20 7a79 782e 636f 7079 2829 200d 0a20  = zyx.copy() .. 
-000196a0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-000196b0: 2020 2020 2023 202d 5959 2d2d 0d0a 2020       # -YY--..  
-000196c0: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-000196d0: 2020 2020 2020 2020 7a79 7920 3d20 6465          zyy = de
-000196e0: 6c65 7465 5f75 7365 6c65 7373 5f74 656e  lete_useless_ten
-000196f0: 736f 7228 0d0a 2020 2020 2020 2020 2020  sor(..          
-00019700: 2020 2020 2020 7365 6c66 2e6d 616b 6532        self.make2
-00019710: 6420 2820 277a 7979 2729 2c20 6e6f 5f69  d ( 'zyy'), no_i
-00019720: 7820 2920 0d0a 2020 2020 2020 2020 2020  x ) ..          
-00019730: 2020 7a79 7920 3d20 696e 7465 7270 6f6c    zyy = interpol
-00019740: 6174 6532 6428 7a79 7929 0d0a 2020 2020  ate2d(zyy)..    
-00019750: 2020 2020 2020 2020 7a79 795f 6572 7220          zyy_err 
-00019760: 3d20 6465 6c65 7465 5f75 7365 6c65 7373  = delete_useless
-00019770: 5f74 656e 736f 7228 0d0a 2020 2020 2020  _tensor(..      
-00019780: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00019790: 616b 6532 6420 2820 277a 7979 5f65 7272  ake2d ( 'zyy_err
-000197a0: 2729 202c 206e 6f5f 6978 2029 200d 0a20  ') , no_ix ) .. 
-000197b0: 2020 2020 2020 2020 2020 207a 7979 5f65             zyy_e
-000197c0: 7272 203d 2069 6e74 6572 706f 6c61 7465  rr = interpolate
-000197d0: 3264 287a 7979 5f65 7272 290d 0a20 2020  2d(zyy_err)..   
-000197e0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-000197f0: 2020 2065 7863 6570 7420 3a20 200d 0a20     except :  .. 
-00019800: 2020 2020 2020 2020 2020 207a 7979 203d             zyy =
-00019810: 2073 6574 5f6e 756c 6c28 6e65 775f 662c   set_null(new_f,
-00019820: 2073 656c 662e 6564 694f 626a 735f 290d   self.ediObjs_).
-00019830: 0a20 2020 2020 2020 2020 2020 207a 7979  .            zyy
-00019840: 5f65 7272 3d20 7a79 792e 636f 7079 2829  _err= zyy.copy()
-00019850: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-00019860: 0a20 2020 2020 200d 0a20 2020 2020 2020  .      ..       
-00019870: 207a 5f64 6963 7420 3d20 7b0d 0a20 2020   z_dict = {..   
-00019880: 2020 2020 2020 2020 2027 7a78 7827 3a20           'zxx': 
-00019890: 7a78 7820 2c0d 0a20 2020 2020 2020 2020  zxx ,..         
-000198a0: 2020 2027 7a78 7927 3a20 7a78 7920 2c0d     'zxy': zxy ,.
-000198b0: 0a20 2020 2020 2020 2020 2020 2027 7a79  .            'zy
-000198c0: 7827 3a20 7a79 782c 0d0a 2020 2020 2020  x': zyx,..      
-000198d0: 2020 2020 2020 277a 7979 273a 207a 7979        'zyy': zyy
-000198e0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-000198f0: 277a 7878 5f65 7272 273a 207a 7878 5f65  'zxx_err': zxx_e
-00019900: 7272 202c 0d0a 2020 2020 2020 2020 2020  rr ,..          
-00019910: 2020 277a 7879 5f65 7272 273a 207a 7879    'zxy_err': zxy
-00019920: 5f65 7272 202c 0d0a 2020 2020 2020 2020  _err ,..        
-00019930: 2020 2020 277a 7978 5f65 7272 273a 207a      'zyx_err': z
-00019940: 7978 5f65 7272 2c20 0d0a 2020 2020 2020  yx_err, ..      
-00019950: 2020 2020 2020 277a 7979 5f65 7272 273a        'zyy_err':
-00019960: 207a 7979 5f65 7272 0d0a 2020 2020 2020   zyy_err..      
-00019970: 2020 2020 2020 7d20 0d0a 2020 2020 2020        } ..      
-00019980: 2020 0d0a 2020 2020 2020 2020 7265 7475    ..        retu
-00019990: 726e 2028 7365 6c66 2e65 6469 4f62 6a73  rn (self.ediObjs
-000199a0: 5f2c 206e 6577 5f66 202c 207a 5f64 6963  _, new_f , z_dic
-000199b0: 7420 292c 206b 7773 0d0a 2020 2020 200d  t ), kws..     .
-000199c0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-000199d0: 6f64 0d0a 2020 2020 405f 7a75 7064 6174  od..    @_zupdat
-000199e0: 6520 286f 7074 696f 6e20 3d27 6e6f 6e65  e (option ='none
-000199f0: 2729 0d0a 2020 2020 6465 6620 696e 7465  ')..    def inte
-00019a00: 7270 6f6c 6174 655f 7a20 280d 0a20 2020  rpolate_z (..   
-00019a10: 2020 2020 207a 5f6f 725f 6564 6973 5f6f       z_or_edis_o
-00019a20: 626a 5f6c 6973 742c 2020 2f20 2c20 0d0a  bj_list,  / , ..
-00019a30: 2020 2020 2020 2020 2a2a 6b77 7320 0d0a          **kws ..
-00019a40: 2020 2020 2020 2020 293a 200d 0a20 2020          ): ..   
-00019a50: 2020 2020 2022 2222 2049 6e74 6572 706f       """ Interpo
-00019a60: 6c61 7465 207a 2061 6e64 2072 6574 7572  late z and retur
-00019a70: 6e20 6e65 7720 696e 7465 7270 6f6c 6174  n new interpolat
-00019a80: 6564 207a 206f 626a 6563 7473 200d 0a20  ed z objects .. 
-00019a90: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00019aa0: 2049 6e74 6572 706f 6c61 7465 6420 6672   Interpolated fr
-00019ab0: 6571 7565 6e63 6965 7320 6973 2075 7365  equencies is use
-00019ac0: 6675 6c20 746f 2068 6176 6520 616c 6c20  ful to have all 
-00019ad0: 6672 6571 7565 6e63 6965 7320 696e 746f  frequencies into
-00019ae0: 2074 6865 200d 0a20 2020 2020 2020 2073   the ..        s
-00019af0: 616d 6520 7363 616c 652e 200d 0a20 2020  ame scale. ..   
-00019b00: 2020 2020 200d 0a20 2020 2020 2020 202e       ..        .
-00019b10: 2e20 7665 7273 696f 6e61 6464 6564 3a3a  . versionadded::
-00019b20: 2030 2e32 2e30 200d 0a20 2020 2020 2020   0.2.0 ..       
-00019b30: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
-00019b40: 6574 6572 7320 0d0a 2020 2020 2020 2020  eters ..        
-00019b50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-00019b60: 2020 2020 2020 7a5f 6f72 5f65 6469 735f        z_or_edis_
-00019b70: 6f62 6a5f 6c69 7374 3a20 6c69 7374 206f  obj_list: list o
-00019b80: 6620 3a63 6c61 7373 3a60 7761 7465 782e  f :class:`watex.
-00019b90: 6564 692e 4564 6960 206f 7220 5c0d 0a20  edi.Edi` or \.. 
-00019ba0: 2020 2020 2020 2020 2020 203a 636c 6173             :clas
-00019bb0: 733a 6077 6174 6578 2e65 7874 6572 6e61  s:`watex.externa
-00019bc0: 6c73 2e7a 2e5a 6020 0d0a 2020 2020 2020  ls.z.Z` ..      
-00019bd0: 2020 2020 2020 4120 636f 6c6c 6563 7469        A collecti
-00019be0: 6f6e 206f 6620 4544 492d 206f 7220 496d  on of EDI- or Im
-00019bf0: 7065 6461 6e63 6573 2074 656e 736f 7273  pedances tensors
-00019c00: 206f 626a 6563 7473 2e0d 0a20 2020 2020   objects...     
-00019c10: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00019c20: 206b 7773 3a20 6469 6374 2c20 0d0a 2020   kws: dict, ..  
-00019c30: 2020 2020 2020 2020 2041 6464 6974 696f           Additio
-00019c40: 6e61 6c20 6b65 7977 6f72 6473 2020 746f  nal keywords  to
-00019c50: 2065 7870 6f72 7420 4544 4920 6f72 2072   export EDI or r
-00019c60: 6f74 6174 6520 4544 492f 5a2e 200d 0a20  otate EDI/Z. .. 
-00019c70: 2020 2020 2020 2020 2020 2d20 6060 226f            - ``"o
-00019c80: 7074 696f 6e22 6060 3a20 6578 706f 7274  ption"``: export
-00019c90: 2045 4449 2069 6620 7365 7420 746f 2060   EDI if set to `
-00019ca0: 6077 7269 7465 6060 2e20 0d0a 2020 2020  `write``. ..    
-00019cb0: 2020 2020 2020 202d 2060 6072 6f74 6174         - ``rotat
-00019cc0: 6560 6020 3a20 666c 6f61 742c 2061 2072  e`` : float, a r
-00019cd0: 6f74 6174 6520 616e 676c 6520 666f 7220  otate angle for 
-00019ce0: 5a20 6966 2076 616c 7565 2069 7320 6769  Z if value is gi
-00019cf0: 7665 6e2e 200d 0a20 2020 2020 2020 2020  ven. ..         
-00019d00: 2020 0d0a 2020 2020 2020 2020 0d0a 2020    ..        ..  
-00019d10: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-00019d20: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0d         --------.
-00019d30: 0a20 2020 2020 2020 205a 3a20 6c69 7374  .        Z: list
-00019d40: 206f 6620 3a63 6c61 7373 3a60 7761 7465   of :class:`wate
-00019d50: 782e 6578 7465 726e 616c 732e 7a2e 5a60  x.externals.z.Z`
-00019d60: 0d0a 2020 2020 2020 2020 2020 204c 6973  ..           Lis
-00019d70: 7420 696e 7465 7270 6f6c 6174 6564 2069  t interpolated i
-00019d80: 6d70 6564 616e 6365 2074 656e 736f 7220  mpedance tensor 
-00019d90: 4f62 6a65 6374 7320 0d0a 2020 2020 2020  Objects ..      
-00019da0: 2020 2020 206f 7220 6060 4e6f 6e65 6060       or ``None``
-00019db0: 2069 6620 606f 7074 696f 6e60 2069 7320   if `option` is 
-00019dc0: 7365 7420 746f 2060 6077 7269 7465 6060  set to ``write``
-00019dd0: 2e20 0d0a 200d 0a20 2020 2020 2020 2045  . .. ..        E
-00019de0: 7861 6d70 6c65 7320 0d0a 2020 2020 2020  xamples ..      
-00019df0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00019e00: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-00019e10: 2077 6174 6578 2061 7320 7778 200d 0a20   watex as wx .. 
-00019e20: 2020 2020 2020 203e 3e3e 2073 6564 6973         >>> sedis
-00019e30: 203d 2077 782e 6665 7463 685f 6461 7461   = wx.fetch_data
-00019e40: 2028 2768 7561 7975 616e 272c 2073 616d   ('huayuan', sam
-00019e50: 706c 6573 203d 2031 3220 2c20 0d0a 2020  ples = 12 , ..  
+00018620: 2020 2020 2020 6c65 6e28 6e65 775f 6629        len(new_f)
+00018630: 295b 3a3a 2d31 5d0d 0a20 2020 2020 2020  )[::-1]..       
+00018640: 2069 6620 6e6f 7420 746f 5f6c 6f67 3130   if not to_log10
+00018650: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00018660: 6e65 775f 6620 3d20 6e70 2e70 6f77 6572  new_f = np.power
+00018670: 2831 3020 2c20 6e65 775f 6629 0d0a 2020  (10 , new_f)..  
+00018680: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00018690: 2020 2020 7265 7475 726e 206e 702e 6172      return np.ar
+000186a0: 6f75 6e64 2028 636b 2c20 3229 2069 6620  ound (ck, 2) if 
+000186b0: 7265 7475 726e 5f72 6174 696f 2065 6c73  return_ratio els
+000186c0: 6520 280d 0a20 2020 2020 2020 2020 2020  e (..           
+000186d0: 206e 702e 6172 6f75 6e64 2028 636b 2c20   np.around (ck, 
+000186e0: 3229 2c20 6e65 775f 6620 2020 6966 2072  2), new_f   if r
+000186f0: 6574 7572 6e5f 6672 6571 2065 6c73 6520  eturn_freq else 
+00018700: 696e 6465 7820 2920 2020 0d0a 0d0a 0d0a  index )   ......
+00018710: 2020 2020 405f 7a75 7064 6174 6528 6f70      @_zupdate(op
+00018720: 7469 6f6e 203d 2027 6e6f 6e65 2729 0d0a  tion = 'none')..
+00018730: 2020 2020 6465 6620 6765 7456 616c 6964      def getValid
+00018740: 5465 6e73 6f72 7328 0d0a 2020 2020 2020  Tensors(..      
+00018750: 2020 7365 6c66 2c20 0d0a 2020 2020 2020    self, ..      
+00018760: 2020 746f 6c3a 666c 6f61 7420 3d20 2e35    tol:float = .5
+00018770: 2c20 200d 0a20 2020 2020 2020 202a 2a6b  ,  ..        **k
+00018780: 7773 200d 0a20 2020 2020 2020 2029 2d3e  ws ..        )->
+00018790: 204e 4441 7272 6179 5b44 5479 7065 5b63   NDArray[DType[c
+000187a0: 6f6d 706c 6578 5d5d 3a20 0d0a 2020 2020  omplex]]: ..    
+000187b0: 2020 2020 2222 2253 656c 6563 7420 7661      """Select va
+000187c0: 6c69 6420 7465 6e73 6f72 7320 6672 6f6d  lid tensors from
+000187d0: 2074 6f6c 6572 616e 6365 2074 6872 6573   tolerance thres
+000187e0: 686f 6c64 2061 6e64 2077 7269 7465 2045  hold and write E
+000187f0: 4449 2069 6620 0d0a 2020 2020 2020 2020  DI if ..        
+00018800: 6170 706c 6963 6162 6c65 2e0d 0a20 2020  applicable...   
+00018810: 2020 2020 200d 0a20 2020 2020 2020 2046       ..        F
+00018820: 756e 6374 696f 6e20 616e 616c 797a 6573  unction analyzes
+00018830: 2074 6865 2064 6174 6120 616e 6420 6b65   the data and ke
+00018840: 6570 2074 6865 2067 6f6f 6420 6f6e 6573  ep the good ones
+00018850: 2e20 5468 6520 676f 6f64 6e65 7373 206f  . The goodness o
+00018860: 6620 7468 6520 6461 7461 200d 0a20 2020  f the data ..   
+00018870: 2020 2020 2064 6570 656e 6473 206f 6e20       depends on 
+00018880: 7468 6520 2060 7468 7265 7368 6f6c 6460  the  `threshold`
+00018890: 2072 6174 652e 2020 466f 7220 696e 7374   rate.  For inst
+000188a0: 616e 6365 2035 3025 206d 6561 6e73 2074  ance 50% means t
+000188b0: 6f20 636f 6e73 6964 6572 2061 6e20 0d0a  o consider an ..
+000188c0: 2020 2020 2020 2020 696d 7065 6461 6e63          impedanc
+000188d0: 6520 7465 6e73 6f72 2027 7a27 2020 7661  e tensor 'z'  va
+000188e0: 6c69 6420 6966 2074 6865 2071 7561 6c69  lid if the quali
+000188f0: 7479 2063 6f6e 7472 6f6c 2073 686f 7773  ty control shows
+00018900: 2061 7420 6c65 6173 7420 7468 6174 2073   at least that s
+00018910: 636f 7265 200d 0a20 2020 2020 2020 2061  core ..        a
+00018920: 7420 6561 6368 2066 7265 7175 656e 6379  t each frequency
+00018930: 206f 6620 616c 6c20 7374 6174 696f 6e73   of all stations
+00018940: 2e20 200d 0a20 2020 2020 2020 200d 0a20  .  ..        .. 
+00018950: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00018960: 7320 0d0a 2020 2020 2020 2020 2d2d 2d2d  s ..        ----
+00018970: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00018980: 6461 7461 3a20 5061 7468 2d6c 696b 6520  data: Path-like 
+00018990: 6f62 6a65 6374 206f 7220 6c69 7374 206f  object or list o
+000189a0: 6620 203a 636c 6173 733a 6070 7963 7361  f  :class:`pycsa
+000189b0: 6d74 2e63 6f72 652e 6564 692e 4564 6960  mt.core.edi.Edi`
+000189c0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+000189d0: 636f 6c6c 6563 7469 6f6e 7320 6f66 2045  collections of E
+000189e0: 4449 2d6f 626a 6563 7473 2066 726f 6d20  DI-objects from 
+000189f0: 6070 7963 7361 6d74 605f 202e 2060 6461  `pycsamt`_ . `da
+00018a00: 7461 6020 7061 7261 6d73 2069 7320 0d0a  ta` params is ..
+00018a10: 2020 2020 2020 2020 2020 2020 7061 7373              pass
+00018a20: 6564 2074 6f20 3a6d 6574 683a 607e 2e50  ed to :meth:`~.P
+00018a30: 726f 6365 7373 696e 672e 6669 7460 206d  rocessing.fit` m
+00018a40: 6574 686f 642e 200d 0a20 2020 2020 2020  ethod. ..       
+00018a50: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00018a60: 2020 2074 6f6c 203a 2066 6c6f 6174 2c20     tol : float, 
+00018a70: 0d0a 2020 2020 2020 2020 2020 2020 746f  ..            to
+00018a80: 6c65 7261 6e63 6520 7061 7261 6d65 7465  lerance paramete
+00018a90: 722e 2054 6865 2076 616c 7565 2069 6e64  r. The value ind
+00018aa0: 6963 6174 6573 2074 6865 2072 6174 6520  icates the rate 
+00018ab0: 6672 6f6d 2077 6869 6368 2074 6865 2064  from which the d
+00018ac0: 6174 6120 0d0a 2020 2020 2020 2020 2020  ata ..          
+00018ad0: 2020 6361 6e20 6265 2063 6f6e 7369 6465    can be conside
+00018ae0: 7220 6173 2061 2076 616c 6964 2e20 5468  r as a valid. Th
+00018af0: 6520 7661 6c69 6420 6461 7461 2073 656c  e valid data sel
+00018b00: 6563 7469 6f6e 2073 686f 756c 6420 6265  ection should be
+00018b10: 2073 6f66 7420 7768 656e 0d0a 2020 2020   soft when..    
+00018b20: 2020 2020 2020 2020 7468 6520 746f 6c65          the tole
+00018b30: 7261 6e63 6520 7061 7261 6d65 7465 7220  rance parameter 
+00018b40: 2069 7320 2063 6c6f 7365 2074 6f20 2731   is  close to '1
+00018b50: 2720 616e 6420 6861 7264 206f 7468 6572  ' and hard other
+00018b60: 7769 7365 2e20 4173 2074 6865 200d 0a20  wise. As the .. 
+00018b70: 2020 2020 2020 2020 2020 2060 746f 6c60             `tol`
+00018b80: 2076 616c 7565 2064 6563 7265 6173 6573   value decreases
+00018b90: 2c20 7468 6520 7365 6c65 6374 696f 6e20  , the selection 
+00018ba0: 2062 6563 6f6d 6573 2073 6576 6572 652e   becomes severe.
+00018bb0: 200d 0a20 2020 2020 2020 2020 2020 2044   ..            D
+00018bc0: 6566 6175 6c74 2069 7320 6060 2e35 6060  efault is ``.5``
+00018bd0: 206d 6561 6e73 2035 3020 2520 200d 0a20   means 50 %  .. 
+00018be0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00018bf0: 2020 2020 206b 7773 3a20 6469 6374 202c       kws: dict ,
+00018c00: 200d 0a20 2020 2020 2020 2020 2020 2041   ..            A
+00018c10: 6464 6974 696f 6e61 6c20 6b65 7977 6f72  dditional keywor
+00018c20: 6473 2061 7267 756d 656e 7473 2066 6f72  ds arguments for
+00018c30: 2045 4449 2066 696c 6520 6578 706f 7274   EDI file export
+00018c40: 696e 6720 0d0a 2020 2020 2020 2020 2020  ing ..          
+00018c50: 2020 0d0a 2020 2020 2020 2020 5265 7475    ..        Retu
+00018c60: 726e 7320 0d0a 2020 2020 2020 2020 2d2d  rns ..        --
+00018c70: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00018c80: 5a63 3a20 3a63 6c61 7373 3a60 7761 7465  Zc: :class:`wate
+00018c90: 782e 6578 7465 726e 616c 732e 7a2e 5a60  x.externals.z.Z`
+00018ca0: 2069 6d70 6564 616e 6365 2074 656e 736f   impedance tenso
+00018cb0: 7220 6f62 6a65 6374 732e 0d0a 2020 2020  r objects...    
+00018cc0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00018cd0: 2020 4578 616d 706c 6573 200d 0a20 2020    Examples ..   
+00018ce0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20       --------.. 
+00018cf0: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+00018d00: 7761 7465 782e 6d65 7468 6f64 732e 656d  watex.methods.em
+00018d10: 2069 6d70 6f72 7420 5072 6f63 6573 7369   import Processi
+00018d20: 6e67 200d 0a20 2020 2020 2020 203e 3e3e  ng ..        >>>
+00018d30: 2070 4f62 6a20 3d20 5072 6f63 6573 7369   pObj = Processi
+00018d40: 6e67 2028 292e 6669 7428 2764 6174 612f  ng ().fit('data/
+00018d50: 6564 6973 2729 0d0a 2020 2020 2020 2020  edis')..        
+00018d60: 3e3e 3e20 663d 2070 4f62 6a2e 6672 6571  >>> f= pObj.freq
+00018d70: 735f 0d0a 2020 2020 2020 2020 3e3e 3e20  s_..        >>> 
+00018d80: 6c65 6e28 6629 200d 0a20 2020 2020 2020  len(f) ..       
+00018d90: 202e 2e2e 2035 350d 0a20 2020 2020 2020   ... 55..       
+00018da0: 203e 3e3e 207a 4f62 6a73 5f68 6172 6420   >>> zObjs_hard 
+00018db0: 3d20 704f 626a 2e67 6574 5661 6c69 6454  = pObj.getValidT
+00018dc0: 656e 736f 7273 2028 746f 6c3d 2030 2e33  ensors (tol= 0.3
+00018dd0: 2029 2023 204e 6f6e 6520 646f 6573 6e27   ) # None doesn'
+00018de0: 7420 6578 706f 7274 2045 4449 2d66 696c  t export EDI-fil
+00018df0: 650d 0a20 2020 2020 2020 203e 3e3e 206c  e..        >>> l
+00018e00: 656e 287a 4f62 6a73 5f68 6172 645b 305d  en(zObjs_hard[0]
+00018e10: 2e5f 6672 6571 2920 2320 7375 7070 7265  ._freq) # suppre
+00018e20: 7373 2033 2074 656e 736f 7220 6461 7461  ss 3 tensor data
+00018e30: 200d 0a20 2020 2020 2020 202e 2e2e 2035   ..        ... 5
+00018e40: 3220 0d0a 2020 2020 2020 2020 3e3e 3e20  2 ..        >>> 
+00018e50: 7a4f 626a 735f 736f 6674 2020 3d20 704f  zObjs_soft  = pO
+00018e60: 626a 2e67 6574 5661 6c69 6454 656e 736f  bj.getValidTenso
+00018e70: 7273 2870 2e65 6469 4f62 6a73 5f2c 2074  rs(p.ediObjs_, t
+00018e80: 6f6c 203d 2030 2e36 202c 206f 7074 696f  ol = 0.6 , optio
+00018e90: 6e20 3d27 7772 6974 6527 290d 0a20 2020  n ='write')..   
+00018ea0: 2020 2020 203e 3e3e 206c 656e 287a 4f62       >>> len(zOb
+00018eb0: 6a73 5f73 6f66 745b 305d 2e5f 6672 6571  js_soft[0]._freq
+00018ec0: 2920 2023 2073 7570 7072 6573 7320 6f6e  )  # suppress on
+00018ed0: 6c79 2074 776f 200d 0a20 2020 2020 2020  ly two ..       
+00018ee0: 202e 2e2e 2035 330d 0a20 2020 2020 2020   ... 53..       
+00018ef0: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
+00018f00: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00018f10: 2020 6465 6620 6465 6c65 7465 5f75 7365    def delete_use
+00018f20: 6c65 7373 5f74 656e 736f 7220 287a 202c  less_tensor (z ,
+00018f30: 2020 696e 6465 7820 2c20 6178 6973 203d    index , axis =
+00018f40: 2030 293a 0d0a 2020 2020 2020 2020 2020   0):..          
+00018f50: 2020 2222 2252 656d 6f76 6520 6d65 6e69    """Remove meni
+00018f60: 6e67 6c65 7373 2074 656e 736f 7220 6461  ngless tensor da
+00018f70: 7461 2222 220d 0a20 2020 2020 2020 2020  ta"""..         
+00018f80: 2020 2072 6574 7572 6e20 6e70 2e64 656c     return np.del
+00018f90: 6574 6520 287a 2c20 696e 6465 7820 2c20  ete (z, index , 
+00018fa0: 6178 6973 2029 0d0a 2020 2020 2020 2020  axis )..        
+00018fb0: 6465 6620 7365 745f 6e75 6c6c 2866 7265  def set_null(fre
+00018fc0: 712c 206f 626a 7329 3a20 0d0a 2020 2020  q, objs): ..    
+00018fd0: 2020 2020 2020 2020 2222 2253 6574 206e          """Set n
+00018fe0: 756c 6c20 696e 2074 6865 2063 6173 6520  ull in the case 
+00018ff0: 7468 6520 636f 6d70 6f6e 656e 7420 646f  the component do
+00019000: 6573 6e27 7420 6578 6973 7422 2222 0d0a  esn't exist"""..
+00019010: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00019020: 726e 206e 702e 7a65 726f 7320 2828 6c65  rn np.zeros ((le
+00019030: 6e28 6629 2c20 6c65 6e28 6f62 6a73 2929  n(f), len(objs))
+00019040: 2c20 6474 7970 6520 3d20 6e70 2e66 6c6f  , dtype = np.flo
+00019050: 6174 3332 290d 0a20 2020 2020 2020 200d  at32)..        .
+00019060: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
+00019070: 7370 6563 7420 0d0a 2020 2020 2020 2020  spect ..        
+00019080: 2320 6564 694f 626a 7320 3d20 6765 745f  # ediObjs = get_
+00019090: 6564 694f 626a 7328 6564 694f 626a 7329  ediObjs(ediObjs)
+000190a0: 200d 0a20 2020 2020 2020 205f 2c20 6e6f   ..        _, no
+000190b0: 5f69 7820 3d20 7365 6c66 2e71 6328 746f  _ix = self.qc(to
+000190c0: 6c3d 746f 6c20 2920 0d0a 2020 2020 2020  l=tol ) ..      
+000190d0: 2020 6620 3d20 7365 6c66 2e66 7265 7173    f = self.freqs
+000190e0: 5f2e 636f 7079 2829 200d 0a20 2020 200d  _.copy() ..    .
+000190f0: 0a20 2020 2020 2020 2066 6620 3d20 6e70  .        ff = np
+00019100: 2e64 656c 6574 6520 2866 5b3a 2c20 4e6f  .delete (f[:, No
+00019110: 6e65 5d2c 206e 6f5f 6978 2c20 3029 0d0a  ne], no_ix, 0)..
+00019120: 2020 2020 2020 2020 2320 696e 7465 7270          # interp
+00019130: 6f6c 6174 6520 6672 6571 7565 6e63 7920  olate frequency 
+00019140: 0d0a 2020 2020 2020 2020 6e65 775f 6620  ..        new_f 
+00019150: 203d 2050 726f 6365 7373 696e 672e 6672   = Processing.fr
+00019160: 6571 496e 7465 7270 6f6c 6174 696f 6e20  eqInterpolation 
+00019170: 2872 6573 6861 7065 2028 6666 2929 200d  (reshape (ff)) .
+00019180: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00019190: 2020 2023 2067 6174 6865 7220 7468 6520     # gather the 
+000191a0: 3244 207a 206f 626a 6563 7473 0d0a 2020  2D z objects..  
+000191b0: 2020 2020 2020 2320 2d58 582d 2d0d 0a20        # -XX--.. 
+000191c0: 2020 2020 2020 2074 7279 203a 200d 0a20         try : .. 
+000191d0: 2020 2020 2020 2020 2020 207a 7878 203d             zxx =
+000191e0: 2064 656c 6574 655f 7573 656c 6573 735f   delete_useless_
+000191f0: 7465 6e73 6f72 280d 0a20 2020 2020 2020  tensor(..       
+00019200: 2020 2020 2020 2020 2073 656c 662e 6d61           self.ma
+00019210: 6b65 3264 2028 2027 7a78 7827 292c 206e  ke2d ( 'zxx'), n
+00019220: 6f5f 6978 2920 0d0a 2020 2020 2020 2020  o_ix) ..        
+00019230: 2020 2020 7a78 7820 3d20 696e 7465 7270      zxx = interp
+00019240: 6f6c 6174 6532 6428 7a78 7829 0d0a 2020  olate2d(zxx)..  
+00019250: 2020 2020 2020 2020 2020 7a78 785f 6572            zxx_er
+00019260: 7220 3d20 6465 6c65 7465 5f75 7365 6c65  r = delete_usele
+00019270: 7373 5f74 656e 736f 7228 0d0a 2020 2020  ss_tensor(..    
+00019280: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00019290: 2e6d 616b 6532 6420 2827 7a78 785f 6572  .make2d ('zxx_er
+000192a0: 7227 2920 2c20 6e6f 5f69 7820 2920 0d0a  r') , no_ix ) ..
+000192b0: 2020 2020 2020 2020 2020 2020 7a78 785f              zxx_
+000192c0: 6572 7220 3d20 696e 7465 7270 6f6c 6174  err = interpolat
+000192d0: 6532 6420 287a 7878 5f65 7272 2029 0d0a  e2d (zxx_err )..
+000192e0: 2020 2020 2020 2020 6578 6365 7074 203a          except :
+000192f0: 0d0a 2020 2020 2020 2020 2020 2020 7a78  ..            zx
+00019300: 7820 3d20 7365 745f 6e75 6c6c 286e 6577  x = set_null(new
+00019310: 5f66 2c20 7365 6c66 2e65 6469 4f62 6a73  _f, self.ediObjs
+00019320: 5f29 0d0a 2020 2020 2020 2020 2020 2020  _)..            
+00019330: 7a78 785f 6572 723d 207a 7878 2e63 6f70  zxx_err= zxx.cop
+00019340: 7928 2920 0d0a 2020 2020 2020 2020 2020  y() ..          
+00019350: 2020 0d0a 2020 2020 2020 2020 2320 2d58    ..        # -X
+00019360: 592d 2d20 2020 200d 0a20 2020 2020 2020  Y--    ..       
+00019370: 2074 7279 203a 0d0a 2020 2020 2020 2020   try :..        
+00019380: 2020 2020 7a78 7920 3d20 6465 6c65 7465      zxy = delete
+00019390: 5f75 7365 6c65 7373 5f74 656e 736f 7228  _useless_tensor(
+000193a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000193b0: 2020 7365 6c66 2e6d 616b 6532 6420 2820    self.make2d ( 
+000193c0: 277a 7879 2729 2c20 6e6f 5f69 7820 2920  'zxy'), no_ix ) 
+000193d0: 200d 0a20 2020 2020 2020 2020 2020 207a   ..            z
+000193e0: 7879 3d20 696e 7465 7270 6f6c 6174 6532  xy= interpolate2
+000193f0: 6428 207a 7879 290d 0a20 2020 2020 2020  d( zxy)..       
+00019400: 2020 2020 207a 7879 5f65 7272 203d 2064       zxy_err = d
+00019410: 656c 6574 655f 7573 656c 6573 735f 7465  elete_useless_te
+00019420: 6e73 6f72 2820 0d0a 2020 2020 2020 2020  nsor( ..        
+00019430: 2020 2020 2020 2020 7365 6c66 2e6d 616b          self.mak
+00019440: 6532 6420 2820 277a 7879 5f65 7272 2729  e2d ( 'zxy_err')
+00019450: 202c 206e 6f5f 6978 2029 0d0a 2020 2020   , no_ix )..    
+00019460: 2020 2020 2020 2020 7a78 795f 6572 7220          zxy_err 
+00019470: 3d20 696e 7465 7270 6f6c 6174 6532 6428  = interpolate2d(
+00019480: 7a78 795f 6572 7229 0d0a 2020 2020 2020  zxy_err)..      
+00019490: 2020 6578 6365 7074 3a20 0d0a 2020 2020    except: ..    
+000194a0: 2020 2020 2020 2020 7a78 7920 3d20 7365          zxy = se
+000194b0: 745f 6e75 6c6c 286e 6577 5f66 2c20 7365  t_null(new_f, se
+000194c0: 6c66 2e65 6469 4f62 6a73 5f29 0d0a 2020  lf.ediObjs_)..  
+000194d0: 2020 2020 2020 2020 2020 7a78 795f 6572            zxy_er
+000194e0: 723d 207a 7879 2e63 6f70 7928 2920 0d0a  r= zxy.copy() ..
+000194f0: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
+00019500: 2d59 582d 2d0d 0a20 2020 2020 2020 2074  -YX--..        t
+00019510: 7279 3a0d 0a20 2020 2020 2020 200d 0a20  ry:..        .. 
+00019520: 2020 2020 2020 2020 2020 207a 7978 203d             zyx =
+00019530: 2064 656c 6574 655f 7573 656c 6573 735f   delete_useless_
+00019540: 7465 6e73 6f72 2820 0d0a 2020 2020 2020  tensor( ..      
+00019550: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00019560: 616b 6532 6420 2827 7a79 7827 2920 2c20  ake2d ('zyx') , 
+00019570: 6e6f 5f69 7820 2920 0d0a 2020 2020 2020  no_ix ) ..      
+00019580: 2020 2020 2020 7a79 7820 3d20 696e 7465        zyx = inte
+00019590: 7270 6f6c 6174 6532 6428 7a79 7829 0d0a  rpolate2d(zyx)..
+000195a0: 2020 2020 2020 2020 2020 2020 7a79 785f              zyx_
+000195b0: 6572 7220 3d20 6465 6c65 7465 5f75 7365  err = delete_use
+000195c0: 6c65 7373 5f74 656e 736f 7228 0d0a 2020  less_tensor(..  
+000195d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000195e0: 6c66 2e6d 616b 6532 6420 2820 277a 7978  lf.make2d ( 'zyx
+000195f0: 5f65 7272 2729 202c 206e 6f5f 6978 2029  _err') , no_ix )
+00019600: 200d 0a20 2020 2020 2020 2020 2020 207a   ..            z
+00019610: 7978 5f65 7272 203d 2069 6e74 6572 706f  yx_err = interpo
+00019620: 6c61 7465 3264 2820 7a79 785f 6572 7220  late2d( zyx_err 
+00019630: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
+00019640: 743a 200d 0a20 2020 2020 2020 2020 2020  t: ..           
+00019650: 207a 7978 203d 2073 6574 5f6e 756c 6c28   zyx = set_null(
+00019660: 6e65 775f 662c 2073 656c 662e 6564 694f  new_f, self.ediO
+00019670: 626a 735f 290d 0a20 2020 2020 2020 2020  bjs_)..         
+00019680: 2020 207a 7978 5f65 7272 3d20 7a79 782e     zyx_err= zyx.
+00019690: 636f 7079 2829 200d 0a20 2020 2020 2020  copy() ..       
+000196a0: 2020 2020 200d 0a20 2020 2020 2020 2023       ..        #
+000196b0: 202d 5959 2d2d 0d0a 2020 2020 2020 2020   -YY--..        
+000196c0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+000196d0: 2020 7a79 7920 3d20 6465 6c65 7465 5f75    zyy = delete_u
+000196e0: 7365 6c65 7373 5f74 656e 736f 7228 0d0a  seless_tensor(..
+000196f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019700: 7365 6c66 2e6d 616b 6532 6420 2820 277a  self.make2d ( 'z
+00019710: 7979 2729 2c20 6e6f 5f69 7820 2920 0d0a  yy'), no_ix ) ..
+00019720: 2020 2020 2020 2020 2020 2020 7a79 7920              zyy 
+00019730: 3d20 696e 7465 7270 6f6c 6174 6532 6428  = interpolate2d(
+00019740: 7a79 7929 0d0a 2020 2020 2020 2020 2020  zyy)..          
+00019750: 2020 7a79 795f 6572 7220 3d20 6465 6c65    zyy_err = dele
+00019760: 7465 5f75 7365 6c65 7373 5f74 656e 736f  te_useless_tenso
+00019770: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00019780: 2020 2020 7365 6c66 2e6d 616b 6532 6420      self.make2d 
+00019790: 2820 277a 7979 5f65 7272 2729 202c 206e  ( 'zyy_err') , n
+000197a0: 6f5f 6978 2029 200d 0a20 2020 2020 2020  o_ix ) ..       
+000197b0: 2020 2020 207a 7979 5f65 7272 203d 2069       zyy_err = i
+000197c0: 6e74 6572 706f 6c61 7465 3264 287a 7979  nterpolate2d(zyy
+000197d0: 5f65 7272 290d 0a20 2020 2020 2020 2020  _err)..         
+000197e0: 2020 200d 0a20 2020 2020 2020 2065 7863     ..        exc
+000197f0: 6570 7420 3a20 200d 0a20 2020 2020 2020  ept :  ..       
+00019800: 2020 2020 207a 7979 203d 2073 6574 5f6e       zyy = set_n
+00019810: 756c 6c28 6e65 775f 662c 2073 656c 662e  ull(new_f, self.
+00019820: 6564 694f 626a 735f 290d 0a20 2020 2020  ediObjs_)..     
+00019830: 2020 2020 2020 207a 7979 5f65 7272 3d20         zyy_err= 
+00019840: 7a79 792e 636f 7079 2829 200d 0a20 2020  zyy.copy() ..   
+00019850: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00019860: 200d 0a20 2020 2020 2020 207a 5f64 6963   ..        z_dic
+00019870: 7420 3d20 7b0d 0a20 2020 2020 2020 2020  t = {..         
+00019880: 2020 2027 7a78 7827 3a20 7a78 7820 2c0d     'zxx': zxx ,.
+00019890: 0a20 2020 2020 2020 2020 2020 2027 7a78  .            'zx
+000198a0: 7927 3a20 7a78 7920 2c0d 0a20 2020 2020  y': zxy ,..     
+000198b0: 2020 2020 2020 2027 7a79 7827 3a20 7a79         'zyx': zy
+000198c0: 782c 0d0a 2020 2020 2020 2020 2020 2020  x,..            
+000198d0: 277a 7979 273a 207a 7979 2c20 0d0a 2020  'zyy': zyy, ..  
+000198e0: 2020 2020 2020 2020 2020 277a 7878 5f65            'zxx_e
+000198f0: 7272 273a 207a 7878 5f65 7272 202c 0d0a  rr': zxx_err ,..
+00019900: 2020 2020 2020 2020 2020 2020 277a 7879              'zxy
+00019910: 5f65 7272 273a 207a 7879 5f65 7272 202c  _err': zxy_err ,
+00019920: 0d0a 2020 2020 2020 2020 2020 2020 277a  ..            'z
+00019930: 7978 5f65 7272 273a 207a 7978 5f65 7272  yx_err': zyx_err
+00019940: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00019950: 277a 7979 5f65 7272 273a 207a 7979 5f65  'zyy_err': zyy_e
+00019960: 7272 0d0a 2020 2020 2020 2020 2020 2020  rr..            
+00019970: 7d20 0d0a 2020 2020 2020 2020 0d0a 2020  } ..        ..  
+00019980: 2020 2020 2020 7265 7475 726e 2028 7365        return (se
+00019990: 6c66 2e65 6469 4f62 6a73 5f2c 206e 6577  lf.ediObjs_, new
+000199a0: 5f66 202c 207a 5f64 6963 7420 292c 206b  _f , z_dict ), k
+000199b0: 7773 0d0a 2020 2020 200d 0a20 2020 2040  ws..     ..    @
+000199c0: 7374 6174 6963 6d65 7468 6f64 0d0a 2020  staticmethod..  
+000199d0: 2020 405f 7a75 7064 6174 6520 286f 7074    @_zupdate (opt
+000199e0: 696f 6e20 3d27 6e6f 6e65 2729 0d0a 2020  ion ='none')..  
+000199f0: 2020 6465 6620 696e 7465 7270 6f6c 6174    def interpolat
+00019a00: 655f 7a20 280d 0a20 2020 2020 2020 207a  e_z (..        z
+00019a10: 5f6f 725f 6564 6973 5f6f 626a 5f6c 6973  _or_edis_obj_lis
+00019a20: 742c 2020 2f20 2c20 0d0a 2020 2020 2020  t,  / , ..      
+00019a30: 2020 2a2a 6b77 7320 0d0a 2020 2020 2020    **kws ..      
+00019a40: 2020 293a 200d 0a20 2020 2020 2020 2022    ): ..        "
+00019a50: 2222 2049 6e74 6572 706f 6c61 7465 207a  "" Interpolate z
+00019a60: 2061 6e64 2072 6574 7572 6e20 6e65 7720   and return new 
+00019a70: 696e 7465 7270 6f6c 6174 6564 207a 206f  interpolated z o
+00019a80: 626a 6563 7473 200d 0a20 2020 2020 2020  bjects ..       
+00019a90: 200d 0a20 2020 2020 2020 2049 6e74 6572   ..        Inter
+00019aa0: 706f 6c61 7465 6420 6672 6571 7565 6e63  polated frequenc
+00019ab0: 6965 7320 6973 2075 7365 6675 6c20 746f  ies is useful to
+00019ac0: 2068 6176 6520 616c 6c20 6672 6571 7565   have all freque
+00019ad0: 6e63 6965 7320 696e 746f 2074 6865 200d  ncies into the .
+00019ae0: 0a20 2020 2020 2020 2073 616d 6520 7363  .        same sc
+00019af0: 616c 652e 200d 0a20 2020 2020 2020 200d  ale. ..        .
+00019b00: 0a20 2020 2020 2020 202e 2e20 7665 7273  .        .. vers
+00019b10: 696f 6e61 6464 6564 3a3a 2030 2e32 2e30  ionadded:: 0.2.0
+00019b20: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00019b30: 2020 2020 2050 6172 616d 6574 6572 7320       Parameters 
+00019b40: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00019b50: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00019b60: 7a5f 6f72 5f65 6469 735f 6f62 6a5f 6c69  z_or_edis_obj_li
+00019b70: 7374 3a20 6c69 7374 206f 6620 3a63 6c61  st: list of :cla
+00019b80: 7373 3a60 7761 7465 782e 6564 692e 4564  ss:`watex.edi.Ed
+00019b90: 6960 206f 7220 5c0d 0a20 2020 2020 2020  i` or \..       
+00019ba0: 2020 2020 203a 636c 6173 733a 6077 6174       :class:`wat
+00019bb0: 6578 2e65 7874 6572 6e61 6c73 2e7a 2e5a  ex.externals.z.Z
+00019bc0: 6020 0d0a 2020 2020 2020 2020 2020 2020  ` ..            
+00019bd0: 4120 636f 6c6c 6563 7469 6f6e 206f 6620  A collection of 
+00019be0: 4544 492d 206f 7220 496d 7065 6461 6e63  EDI- or Impedanc
+00019bf0: 6573 2074 656e 736f 7273 206f 626a 6563  es tensors objec
+00019c00: 7473 2e0d 0a20 2020 2020 2020 2020 2020  ts...           
+00019c10: 200d 0a20 2020 2020 2020 206b 7773 3a20   ..        kws: 
+00019c20: 6469 6374 2c20 0d0a 2020 2020 2020 2020  dict, ..        
+00019c30: 2020 2041 6464 6974 696f 6e61 6c20 6b65     Additional ke
+00019c40: 7977 6f72 6473 2020 746f 2065 7870 6f72  ywords  to expor
+00019c50: 7420 4544 4920 6f72 2072 6f74 6174 6520  t EDI or rotate 
+00019c60: 4544 492f 5a2e 200d 0a20 2020 2020 2020  EDI/Z. ..       
+00019c70: 2020 2020 2d20 6060 226f 7074 696f 6e22      - ``"option"
+00019c80: 6060 3a20 6578 706f 7274 2045 4449 2069  ``: export EDI i
+00019c90: 6620 7365 7420 746f 2060 6077 7269 7465  f set to ``write
+00019ca0: 6060 2e20 0d0a 2020 2020 2020 2020 2020  ``. ..          
+00019cb0: 202d 2060 6072 6f74 6174 6560 6020 3a20   - ``rotate`` : 
+00019cc0: 666c 6f61 742c 2061 2072 6f74 6174 6520  float, a rotate 
+00019cd0: 616e 676c 6520 666f 7220 5a20 6966 2076  angle for Z if v
+00019ce0: 616c 7565 2069 7320 6769 7665 6e2e 200d  alue is given. .
+00019cf0: 0a20 2020 2020 2020 2020 2020 0d0a 2020  .           ..  
+00019d00: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00019d10: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+00019d20: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020   --------..     
+00019d30: 2020 205a 3a20 6c69 7374 206f 6620 3a63     Z: list of :c
+00019d40: 6c61 7373 3a60 7761 7465 782e 6578 7465  lass:`watex.exte
+00019d50: 726e 616c 732e 7a2e 5a60 0d0a 2020 2020  rnals.z.Z`..    
+00019d60: 2020 2020 2020 204c 6973 7420 696e 7465         List inte
+00019d70: 7270 6f6c 6174 6564 2069 6d70 6564 616e  rpolated impedan
+00019d80: 6365 2074 656e 736f 7220 4f62 6a65 6374  ce tensor Object
+00019d90: 7320 0d0a 2020 2020 2020 2020 2020 206f  s ..           o
+00019da0: 7220 6060 4e6f 6e65 6060 2069 6620 606f  r ``None`` if `o
+00019db0: 7074 696f 6e60 2069 7320 7365 7420 746f  ption` is set to
+00019dc0: 2060 6077 7269 7465 6060 2e20 0d0a 200d   ``write``. .. .
+00019dd0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00019de0: 7320 0d0a 2020 2020 2020 2020 2d2d 2d2d  s ..        ----
+00019df0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00019e00: 3e3e 3e20 696d 706f 7274 2077 6174 6578  >>> import watex
+00019e10: 2061 7320 7778 200d 0a20 2020 2020 2020   as wx ..       
+00019e20: 203e 3e3e 2073 6564 6973 203d 2077 782e   >>> sedis = wx.
+00019e30: 6665 7463 685f 6461 7461 2028 2768 7561  fetch_data ('hua
+00019e40: 7975 616e 272c 2073 616d 706c 6573 203d  yuan', samples =
+00019e50: 2031 3220 2c20 0d0a 2020 2020 2020 2020   12 , ..        
 00019e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00019e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019e80: 2020 2020 2020 2072 6574 7572 6e5f 6461         return_da
-00019e90: 7461 203d 5472 7565 202c 206b 6579 3d27  ta =True , key='
-00019ea0: 7261 7727 290d 0a20 2020 2020 2020 203e  raw')..        >
-00019eb0: 3e3e 2070 203d 2077 782e 454d 5072 6f63  >> p = wx.EMProc
-00019ec0: 6573 7369 6e67 2028 292e 6669 7428 7365  essing ().fit(se
-00019ed0: 6469 7329 200d 0a20 2020 2020 2020 203e  dis) ..        >
-00019ee0: 3e3e 2066 6620 3d20 5b20 6c65 6e28 6564  >> ff = [ len(ed
-00019ef0: 696f 626a 2e5a 2e5f 6672 6571 2920 2066  iobj.Z._freq)  f
-00019f00: 6f72 2065 6469 6f62 6a20 696e 2070 2e65  or ediobj in p.e
-00019f10: 6469 4f62 6a73 5f5d 200d 0a20 2020 2020  diObjs_] ..     
-00019f20: 2020 205b 3533 2c20 3532 2c20 3533 2c20     [53, 52, 53, 
-00019f30: 3535 2c20 3534 2c20 3535 2c20 3536 2c20  55, 54, 55, 56, 
-00019f40: 3531 2c20 3531 2c20 3533 2c20 3535 2c20  51, 51, 53, 55, 
-00019f50: 3533 5d0d 0a20 2020 2020 2020 203e 3e3e  53]..        >>>
-00019f60: 205a 636f 6c20 3d20 702e 696e 7465 7270   Zcol = p.interp
-00019f70: 6f6c 6174 655f 7a20 2873 6564 6973 290d  olate_z (sedis).
-00019f80: 0a20 2020 2020 2020 203e 3e3e 2066 6669  .        >>> ffi
-00019f90: 203d 205b 206c 656e 287a 2e66 7265 7129   = [ len(z.freq)
-00019fa0: 2066 6f72 207a 2069 6e20 5a63 6f6c 205d   for z in Zcol ]
-00019fb0: 0d0a 2020 2020 2020 2020 5b35 362c 2035  ..        [56, 5
-00019fc0: 362c 2035 362c 2035 362c 2035 362c 2035  6, 56, 56, 56, 5
-00019fd0: 362c 2035 362c 2035 362c 2035 362c 2035  6, 56, 56, 56, 5
-00019fe0: 362c 2035 362c 2035 365d 0d0a 2020 2020  6, 56, 56]..    
-00019ff0: 2020 2020 3e3e 3e20 2320 7669 7375 616c      >>> # visual
-0001a000: 697a 6520 7365 7665 6e20 5a20 7661 6c75  ize seven Z valu
-0001a010: 6573 2061 7420 7468 6520 6669 7273 7420  es at the first 
-0001a020: 7369 7465 2063 6f6d 706f 6e65 6e74 2078  site component x
-0001a030: 7920 0d0a 2020 2020 2020 2020 3e3e 3e20  y ..        >>> 
-0001a040: 702e 6564 694f 626a 735f 5b30 5d2e 5a2e  p.ediObjs_[0].Z.
-0001a050: 7a5b 3a2c 2030 2c20 315d 5b3a 375d 0d0a  z[:, 0, 1][:7]..
-0001a060: 2020 2020 2020 2020 6172 7261 7928 5b20          array([ 
-0001a070: 3431 3635 2e36 202b 3230 3730 2e31 336a  4165.6 +2070.13j
-0001a080: 2c20 2037 3037 322e 3831 2b36 3839 322e  ,  7072.81+6892.
-0001a090: 3431 6a2c 2020 3837 3235 2e38 342b 3538  41j,  8725.84+58
-0001a0a0: 3734 2e31 356a 2c0d 0a20 2020 2020 2020  74.15j,..       
-0001a0b0: 2020 2020 2020 2020 3134 3737 312e 3820          14771.8 
-0001a0c0: 2d32 3833 312e 3238 6a2c 2032 3132 3433  -2831.28j, 21243
-0001a0d0: 2e37 202d 3638 3032 2e33 366a 2c20 2036  .7 -6802.36j,  6
-0001a0e0: 3338 312e 3438 2b33 3431 312e 3635 6a2c  381.48+3411.65j,
-0001a0f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001a100: 2020 3539 3237 2e38 352b 3530 3734 2e32    5927.85+5074.2
-0001a110: 376a 5d29 0d0a 2020 2020 2020 2020 3e3e  7j])..        >>
-0001a120: 3e20 5a63 6f6c 205b 305d 2e7a 5b3a 2c20  > Zcol [0].z[:, 
-0001a130: 302c 2031 205d 5b3a 375d 0d0a 2020 2020  0, 1 ][:7]..    
-0001a140: 2020 2020 6172 7261 7928 5b20 3431 3635      array([ 4165
-0001a150: 2e36 202b 3230 3730 2e31 336a 2c20 2034  .6 +2070.13j,  4
-0001a160: 3136 352e 3620 2b32 3037 302e 3133 6a2c  165.6 +2070.13j,
-0001a170: 2020 3730 3732 2e38 312b 3638 3932 2e34    7072.81+6892.4
-0001a180: 316a 2c0d 0a20 2020 2020 2020 2020 2020  1j,..           
-0001a190: 2020 2020 2038 3732 352e 3834 2b35 3837       8725.84+587
-0001a1a0: 342e 3135 6a2c 2031 3437 3731 2e38 202d  4.15j, 14771.8 -
-0001a1b0: 3238 3331 2e32 386a 2c20 3231 3234 332e  2831.28j, 21243.
-0001a1c0: 3720 2d36 3830 322e 3336 6a2c 0d0a 2020  7 -6802.36j,..  
-0001a1d0: 2020 2020 2020 2020 2020 2020 2020 3633                63
-0001a1e0: 3831 2e34 382b 3334 3131 2e36 356a 5d29  81.48+3411.65j])
-0001a1f0: 0d0a 0d0a 2020 2020 2020 2020 2222 2220  ....        """ 
-0001a200: 0d0a 2020 2020 2020 2020 6465 6620 7365  ..        def se
-0001a210: 745f 6e75 6c6c 2866 7265 712c 206f 626a  t_null(freq, obj
-0001a220: 7329 3a20 0d0a 2020 2020 2020 2020 2020  s): ..          
-0001a230: 2020 2222 2253 6574 206e 756c 6c20 696e    """Set null in
-0001a240: 2074 6865 2063 6173 6520 7468 6520 636f   the case the co
-0001a250: 6d70 6f6e 656e 7420 646f 6573 6e27 7420  mponent doesn't 
-0001a260: 6578 6973 7422 2222 0d0a 2020 2020 2020  exist"""..      
-0001a270: 2020 2020 2020 7265 7475 726e 206e 702e        return np.
-0001a280: 7a65 726f 7320 2828 6c65 6e28 6629 2c20  zeros ((len(f), 
-0001a290: 6c65 6e28 6f62 6a73 2929 2c20 6474 7970  len(objs)), dtyp
-0001a2a0: 6520 3d20 6e70 2e66 6c6f 6174 3332 290d  e = np.float32).
-0001a2b0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0001a2c0: 2020 207a 6f62 6a73 5f69 6e69 7420 3d20     zobjs_init = 
-0001a2d0: 454d 2e67 6574 5f7a 5f66 726f 6d20 287a  EM.get_z_from (z
-0001a2e0: 5f6f 725f 6564 6973 5f6f 626a 5f6c 6973  _or_edis_obj_lis
-0001a2f0: 7429 0d0a 2020 2020 2020 2020 2320 6761  t)..        # ga
-0001a300: 7468 6572 2074 6865 2032 4420 7a20 6f62  ther the 2D z ob
-0001a310: 6a65 6374 730d 0a20 2020 2020 2020 2066  jects..        f
-0001a320: 203d 2067 6574 5f66 756c 6c5f 6672 6571   = get_full_freq
-0001a330: 7565 6e63 7928 7a6f 626a 735f 696e 6974  uency(zobjs_init
-0001a340: 2029 0d0a 0d0a 2020 2020 2020 2020 7a64   )....        zd
-0001a350: 6963 7420 3d20 7b7d 0d0a 2020 2020 2020  ict = {}..      
-0001a360: 2020 666f 7220 636f 6d70 2069 6e20 2827    for comp in ('
-0001a370: 7878 272c 2027 7879 272c 2027 7978 272c  xx', 'xy', 'yx',
-0001a380: 2027 7979 2729 3a20 0d0a 2020 2020 2020   'yy'): ..      
-0001a390: 2020 2020 2020 7472 7920 3a20 0d0a 2020        try : ..  
-0001a3a0: 2020 2020 2020 2020 2020 2020 2020 7a78                zx
-0001a3b0: 3d20 6765 7432 6474 656e 736f 7228 7a6f  = get2dtensor(zo
-0001a3c0: 626a 735f 696e 6974 2c20 636f 6d70 6f6e  bjs_init, compon
-0001a3d0: 656e 743d 636f 6d70 2c20 0d0a 2020 2020  ent=comp, ..    
+00019e80: 2072 6574 7572 6e5f 6461 7461 203d 5472   return_data =Tr
+00019e90: 7565 202c 206b 6579 3d27 7261 7727 290d  ue , key='raw').
+00019ea0: 0a20 2020 2020 2020 203e 3e3e 2070 203d  .        >>> p =
+00019eb0: 2077 782e 454d 5072 6f63 6573 7369 6e67   wx.EMProcessing
+00019ec0: 2028 292e 6669 7428 7365 6469 7329 200d   ().fit(sedis) .
+00019ed0: 0a20 2020 2020 2020 203e 3e3e 2066 6620  .        >>> ff 
+00019ee0: 3d20 5b20 6c65 6e28 6564 696f 626a 2e5a  = [ len(ediobj.Z
+00019ef0: 2e5f 6672 6571 2920 2066 6f72 2065 6469  ._freq)  for edi
+00019f00: 6f62 6a20 696e 2070 2e65 6469 4f62 6a73  obj in p.ediObjs
+00019f10: 5f5d 200d 0a20 2020 2020 2020 205b 3533  _] ..        [53
+00019f20: 2c20 3532 2c20 3533 2c20 3535 2c20 3534  , 52, 53, 55, 54
+00019f30: 2c20 3535 2c20 3536 2c20 3531 2c20 3531  , 55, 56, 51, 51
+00019f40: 2c20 3533 2c20 3535 2c20 3533 5d0d 0a20  , 53, 55, 53].. 
+00019f50: 2020 2020 2020 203e 3e3e 205a 636f 6c20         >>> Zcol 
+00019f60: 3d20 702e 696e 7465 7270 6f6c 6174 655f  = p.interpolate_
+00019f70: 7a20 2873 6564 6973 290d 0a20 2020 2020  z (sedis)..     
+00019f80: 2020 203e 3e3e 2066 6669 203d 205b 206c     >>> ffi = [ l
+00019f90: 656e 287a 2e66 7265 7129 2066 6f72 207a  en(z.freq) for z
+00019fa0: 2069 6e20 5a63 6f6c 205d 0d0a 2020 2020   in Zcol ]..    
+00019fb0: 2020 2020 5b35 362c 2035 362c 2035 362c      [56, 56, 56,
+00019fc0: 2035 362c 2035 362c 2035 362c 2035 362c   56, 56, 56, 56,
+00019fd0: 2035 362c 2035 362c 2035 362c 2035 362c   56, 56, 56, 56,
+00019fe0: 2035 365d 0d0a 2020 2020 2020 2020 3e3e   56]..        >>
+00019ff0: 3e20 2320 7669 7375 616c 697a 6520 7365  > # visualize se
+0001a000: 7665 6e20 5a20 7661 6c75 6573 2061 7420  ven Z values at 
+0001a010: 7468 6520 6669 7273 7420 7369 7465 2063  the first site c
+0001a020: 6f6d 706f 6e65 6e74 2078 7920 0d0a 2020  omponent xy ..  
+0001a030: 2020 2020 2020 3e3e 3e20 702e 6564 694f        >>> p.ediO
+0001a040: 626a 735f 5b30 5d2e 5a2e 7a5b 3a2c 2030  bjs_[0].Z.z[:, 0
+0001a050: 2c20 315d 5b3a 375d 0d0a 2020 2020 2020  , 1][:7]..      
+0001a060: 2020 6172 7261 7928 5b20 3431 3635 2e36    array([ 4165.6
+0001a070: 202b 3230 3730 2e31 336a 2c20 2037 3037   +2070.13j,  707
+0001a080: 322e 3831 2b36 3839 322e 3431 6a2c 2020  2.81+6892.41j,  
+0001a090: 3837 3235 2e38 342b 3538 3734 2e31 356a  8725.84+5874.15j
+0001a0a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0001a0b0: 2020 3134 3737 312e 3820 2d32 3833 312e    14771.8 -2831.
+0001a0c0: 3238 6a2c 2032 3132 3433 2e37 202d 3638  28j, 21243.7 -68
+0001a0d0: 3032 2e33 366a 2c20 2036 3338 312e 3438  02.36j,  6381.48
+0001a0e0: 2b33 3431 312e 3635 6a2c 0d0a 2020 2020  +3411.65j,..    
+0001a0f0: 2020 2020 2020 2020 2020 2020 3539 3237              5927
+0001a100: 2e38 352b 3530 3734 2e32 376a 5d29 0d0a  .85+5074.27j])..
+0001a110: 2020 2020 2020 2020 3e3e 3e20 5a63 6f6c          >>> Zcol
+0001a120: 205b 305d 2e7a 5b3a 2c20 302c 2031 205d   [0].z[:, 0, 1 ]
+0001a130: 5b3a 375d 0d0a 2020 2020 2020 2020 6172  [:7]..        ar
+0001a140: 7261 7928 5b20 3431 3635 2e36 202b 3230  ray([ 4165.6 +20
+0001a150: 3730 2e31 336a 2c20 2034 3136 352e 3620  70.13j,  4165.6 
+0001a160: 2b32 3037 302e 3133 6a2c 2020 3730 3732  +2070.13j,  7072
+0001a170: 2e38 312b 3638 3932 2e34 316a 2c0d 0a20  .81+6892.41j,.. 
+0001a180: 2020 2020 2020 2020 2020 2020 2020 2038                 8
+0001a190: 3732 352e 3834 2b35 3837 342e 3135 6a2c  725.84+5874.15j,
+0001a1a0: 2031 3437 3731 2e38 202d 3238 3331 2e32   14771.8 -2831.2
+0001a1b0: 386a 2c20 3231 3234 332e 3720 2d36 3830  8j, 21243.7 -680
+0001a1c0: 322e 3336 6a2c 0d0a 2020 2020 2020 2020  2.36j,..        
+0001a1d0: 2020 2020 2020 2020 3633 3831 2e34 382b          6381.48+
+0001a1e0: 3334 3131 2e36 356a 5d29 0d0a 0d0a 2020  3411.65j])....  
+0001a1f0: 2020 2020 2020 2222 2220 0d0a 2020 2020        """ ..    
+0001a200: 2020 2020 6465 6620 7365 745f 6e75 6c6c      def set_null
+0001a210: 2866 7265 712c 206f 626a 7329 3a20 0d0a  (freq, objs): ..
+0001a220: 2020 2020 2020 2020 2020 2020 2222 2253              """S
+0001a230: 6574 206e 756c 6c20 696e 2074 6865 2063  et null in the c
+0001a240: 6173 6520 7468 6520 636f 6d70 6f6e 656e  ase the componen
+0001a250: 7420 646f 6573 6e27 7420 6578 6973 7422  t doesn't exist"
+0001a260: 2222 0d0a 2020 2020 2020 2020 2020 2020  ""..            
+0001a270: 7265 7475 726e 206e 702e 7a65 726f 7320  return np.zeros 
+0001a280: 2828 6c65 6e28 6629 2c20 6c65 6e28 6f62  ((len(f), len(ob
+0001a290: 6a73 2929 2c20 6474 7970 6520 3d20 6e70  js)), dtype = np
+0001a2a0: 2e66 6c6f 6174 3332 290d 0a20 2020 2020  .float32)..     
+0001a2b0: 2020 200d 0a20 2020 2020 2020 207a 6f62     ..        zob
+0001a2c0: 6a73 5f69 6e69 7420 3d20 454d 2e67 6574  js_init = EM.get
+0001a2d0: 5f7a 5f66 726f 6d20 287a 5f6f 725f 6564  _z_from (z_or_ed
+0001a2e0: 6973 5f6f 626a 5f6c 6973 7429 0d0a 2020  is_obj_list)..  
+0001a2f0: 2020 2020 2020 2320 6761 7468 6572 2074        # gather t
+0001a300: 6865 2032 4420 7a20 6f62 6a65 6374 730d  he 2D z objects.
+0001a310: 0a20 2020 2020 2020 2066 203d 2067 6574  .        f = get
+0001a320: 5f66 756c 6c5f 6672 6571 7565 6e63 7928  _full_frequency(
+0001a330: 7a6f 626a 735f 696e 6974 2029 0d0a 0d0a  zobjs_init )....
+0001a340: 2020 2020 2020 2020 7a64 6963 7420 3d20          zdict = 
+0001a350: 7b7d 0d0a 2020 2020 2020 2020 666f 7220  {}..        for 
+0001a360: 636f 6d70 2069 6e20 2827 7878 272c 2027  comp in ('xx', '
+0001a370: 7879 272c 2027 7978 272c 2027 7979 2729  xy', 'yx', 'yy')
+0001a380: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0001a390: 7472 7920 3a20 0d0a 2020 2020 2020 2020  try : ..        
+0001a3a0: 2020 2020 2020 2020 7a78 3d20 6765 7432          zx= get2
+0001a3b0: 6474 656e 736f 7228 7a6f 626a 735f 696e  dtensor(zobjs_in
+0001a3c0: 6974 2c20 636f 6d70 6f6e 656e 743d 636f  it, component=co
+0001a3d0: 6d70 2c20 0d0a 2020 2020 2020 2020 2020  mp, ..          
 0001a3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a3f0: 2020 2020 2020 2020 2020 2020 6b69 6e64              kind
-0001a400: 203d 2763 6f6d 706c 6578 272c 200d 0a20   ='complex', .. 
+0001a3f0: 2020 2020 2020 6b69 6e64 203d 2763 6f6d        kind ='com
+0001a400: 706c 6578 272c 200d 0a20 2020 2020 2020  plex', ..       
 0001a410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a420: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0001a430: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001a440: 2020 7a78 3d20 696e 7465 7270 6f6c 6174    zx= interpolat
-0001a450: 6532 6428 7a78 290d 0a20 2020 2020 2020  e2d(zx)..       
-0001a460: 2020 2020 2020 2020 207a 785f 6572 7220           zx_err 
-0001a470: 3d20 6765 7432 6474 656e 736f 7228 0d0a  = get2dtensor(..
-0001a480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a490: 2020 2020 7a6f 626a 735f 696e 6974 2c20      zobjs_init, 
-0001a4a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001a4b0: 2020 2020 2020 7465 6e73 6f72 203d 277a        tensor ='z
-0001a4c0: 5f65 7272 272c 200d 0a20 2020 2020 2020  _err', ..       
-0001a4d0: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-0001a4e0: 706f 6e65 6e74 3d63 6f6d 702c 206b 696e  ponent=comp, kin
-0001a4f0: 643d 2772 6561 6c27 0d0a 2020 2020 2020  d='real'..      
-0001a500: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-0001a510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a520: 207a 785f 6572 7220 3d20 696e 7465 7270   zx_err = interp
-0001a530: 6f6c 6174 6532 6420 287a 785f 6572 7229  olate2d (zx_err)
-0001a540: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
-0001a550: 6365 7074 203a 0d0a 2020 2020 2020 2020  cept :..        
-0001a560: 2020 2020 2020 2020 2320 6966 2063 6f6d          # if com
-0001a570: 706f 6e65 6e74 2064 6f65 7320 6e6f 7420  ponent does not 
-0001a580: 6578 6973 7420 0d0a 2020 2020 2020 2020  exist ..        
-0001a590: 2020 2020 2020 2020 7a78 203d 2073 6574          zx = set
-0001a5a0: 5f6e 756c 6c28 662c 207a 6f62 6a73 5f69  _null(f, zobjs_i
-0001a5b0: 6e69 7429 0d0a 2020 2020 2020 2020 2020  nit)..          
-0001a5c0: 2020 2020 2020 7a78 5f65 7272 3d20 7a78        zx_err= zx
-0001a5d0: 2e63 6f70 7928 2920 0d0a 2020 2020 2020  .copy() ..      
-0001a5e0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001a5f0: 2020 2020 7a64 6963 7420 5b66 277a 7b63      zdict [f'z{c
-0001a600: 6f6d 707d 275d 3d7a 7820 0d0a 2020 2020  omp}']=zx ..    
-0001a610: 2020 2020 2020 2020 7a64 6963 7420 5b66          zdict [f
-0001a620: 277a 7b63 6f6d 707d 5f65 7272 275d 203d  'z{comp}_err'] =
-0001a630: 207a 785f 6572 7220 0d0a 2020 2020 2020   zx_err ..      
-0001a640: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001a650: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0001a660: 2028 7a6f 626a 735f 696e 6974 2c20 662c   (zobjs_init, f,
-0001a670: 207a 6469 6374 292c 206b 7773 200d 0a0d   zdict), kws ...
-0001a680: 0a20 2020 2064 6566 2064 726f 705f 6672  .    def drop_fr
-0001a690: 6571 7565 6e63 6965 7320 280d 0a20 2020  equencies (..   
-0001a6a0: 2020 2020 2020 2020 2073 656c 662c 200d           self, .
-0001a6b0: 0a20 2020 2020 2020 2020 2020 2066 7265  .            fre
-0001a6c0: 7173 3d20 4e6f 6e65 2c20 0d0a 2020 2020  qs= None, ..    
-0001a6d0: 2020 2020 2020 2020 746f 6c20 3d4e 6f6e          tol =Non
-0001a6e0: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
-0001a6f0: 2069 6e74 6572 706f 6c61 7465 3a20 626f   interpolate: bo
-0001a700: 6f6c 203d 4661 6c73 652c 200d 0a20 2020  ol =False, ..   
-0001a710: 2020 2020 2020 2020 2072 6f74 6174 653d           rotate=
-0001a720: 2030 2e20 2c20 0d0a 2020 2020 2020 2020   0. , ..        
-0001a730: 2020 2020 6578 706f 7274 203d 4661 6c73      export =Fals
-0001a740: 6520 2c20 0d0a 2020 2020 2020 2020 2020  e , ..          
-0001a750: 2020 2a2a 6b77 7320 0d0a 2020 2020 2020    **kws ..      
-0001a760: 2020 2020 2020 293a 200d 0a20 2020 2020        ): ..     
-0001a770: 2020 2022 2222 2044 726f 7020 7573 656c     """ Drop usel
-0001a780: 6573 7320 6672 6571 7565 6e63 6965 7320  ess frequencies 
-0001a790: 696e 2074 6865 2045 4449 2064 6174 612e  in the EDI data.
-0001a7a0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001a7b0: 2020 2020 4475 6520 746f 2074 6865 2074      Due to the t
-0001a7c0: 6572 7261 696e 2063 6f6e 7374 7261 696e  errain constrain
-0001a7d0: 7473 2c20 746f 706f 6772 6170 6869 6320  ts, topographic 
-0001a7e0: 616e 6420 696e 7465 7266 6572 656e 6365  and interference
-0001a7f0: 7320 6e6f 6973 6573 200d 0a20 2020 2020  s noises ..     
-0001a800: 2020 2073 6f6d 6520 6672 6571 7565 6e63     some frequenc
-0001a810: 6965 7320 6172 6520 6e6f 7420 6d65 616e  ies are not mean
-0001a820: 696e 6766 756c 2074 6f20 6265 206b 6570  ingful to be kep
-0001a830: 7420 696e 2074 6865 2064 6174 612e 2054  t in the data. T
-0001a840: 6865 200d 0a20 2020 2020 2020 2066 756e  he ..        fun
-0001a850: 6374 696f 6e20 616c 6c6f 7773 2074 6f20  ction allows to 
-0001a860: 6578 706c 6963 6974 656c 7920 7265 6d6f  explicitely remo
-0001a870: 7665 2074 6865 2062 6164 2066 7265 7175  ve the bad frequ
-0001a880: 656e 6369 6573 2061 6674 6572 200d 0a20  encies after .. 
-0001a890: 2020 2020 2020 2061 6e61 6c79 7365 7320         analyses 
-0001a8a0: 616e 6420 696e 7465 7270 6f6c 6174 6564  and interpolated
-0001a8b0: 2074 6865 2072 656d 6169 6e73 2e20 4966   the remains. If
-0001a8c0: 2062 6164 2066 7265 7175 656e 6369 6573   bad frequencies
-0001a8d0: 2061 7265 206e 6f74 206b 6e6f 776e 0d0a   are not known..
-0001a8e0: 2020 2020 2020 2020 7768 6963 6820 6973          which is
-0001a8f0: 2063 6f6d 6d6f 6e20 696e 2072 6561 6c20   common in real 
-0001a900: 776f 726c 642c 2074 6865 2074 6f6c 6572  world, the toler
-0001a910: 616e 6365 2070 6172 616d 6574 6572 2060  ance parameter `
-0001a920: 746f 6c60 2063 616e 2062 6520 0d0a 2020  tol` can be ..  
-0001a930: 2020 2020 2020 7365 7420 746f 2061 7574        set to aut
-0001a940: 6f6d 6174 6963 616c 6c79 2064 6574 6563  omatically detec
-0001a950: 7420 7769 7468 2035 3025 2073 6d6f 6f74  t with 50% smoot
-0001a960: 686e 6573 7320 696e 2064 6174 6120 7365  hness in data se
-0001a970: 6c65 6374 696f 6e2e 200d 0a20 2020 2020  lection. ..     
-0001a980: 2020 200d 0a20 2020 2020 2020 202e 2e20     ..        .. 
-0001a990: 7665 7273 696f 6e61 6464 6564 3a3a 2076  versionadded:: v
-0001a9a0: 302e 322e 3020 0d0a 2020 2020 2020 2020  0.2.0 ..        
-0001a9b0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001a9c0: 2020 2020 5061 7261 6d65 7465 7273 200d      Parameters .
-0001a9d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001a9e0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 746f  ----..        to
-0001a9f0: 6c3a 2066 6c6f 6174 2c20 0d0a 2020 2020  l: float, ..    
-0001aa00: 2020 2020 2020 2020 7468 6520 746f 6c65          the tole
-0001aa10: 7261 6e63 6520 7061 7261 6d65 7465 722e  rance parameter.
-0001aa20: 2054 6865 2076 616c 7565 2069 6e64 6963   The value indic
-0001aa30: 6174 6573 2074 6865 2072 6174 6520 6672  ates the rate fr
-0001aa40: 6f6d 2077 6869 6368 2074 6865 200d 0a20  om which the .. 
-0001aa50: 2020 2020 2020 2020 2020 2064 6174 6120             data 
-0001aa60: 6361 6e20 6265 2063 6f6e 7369 6465 7220  can be consider 
-0001aa70: 6173 206d 6561 6e69 6e67 6675 6c2e 2050  as meaningful. P
-0001aa80: 7265 6665 7261 626c 7920 6974 2073 686f  referably it sho
-0001aa90: 756c 6420 6265 206c 6573 7320 7468 616e  uld be less than
-0001aaa0: 0d0a 2020 2020 2020 2020 2020 2020 3120  ..            1 
-0001aab0: 616e 6420 6772 6561 7465 7220 7468 616e  and greater than
-0001aac0: 2030 2e20 4174 2074 6869 7320 7661 6c75   0. At this valu
-0001aad0: 652e 2049 6620 6060 4e6f 6e65 6060 2c20  e. If ``None``, 
-0001aae0: 7468 6520 6c69 7374 206f 6620 0d0a 2020  the list of ..  
-0001aaf0: 2020 2020 2020 2020 2020 6672 6571 7565            freque
-0001ab00: 6e63 6965 7320 746f 2064 726f 7020 6d75  ncies to drop mu
-0001ab10: 7374 2062 6520 7072 6f76 6964 6564 2e20  st be provided. 
-0001ab20: 4966 2074 6865 2060 746f 6c60 2070 6172  If the `tol` par
-0001ab30: 616d 6574 6572 2069 7320 0d0a 2020 2020  ameter is ..    
-0001ab40: 2020 2020 2020 2020 7365 7420 746f 2060          set to `
-0001ab50: 6061 7574 6f60 602c 2074 6865 2073 656c  `auto``, the sel
-0001ab60: 6563 7469 6f6e 206f 6620 7573 656c 6573  ection of useles
-0001ab70: 7320 6672 6571 7565 6e63 6965 7320 6973  s frequencies is
-0001ab80: 2074 6f6c 6572 6174 6520 0d0a 2020 2020   tolerate ..    
-0001ab90: 2020 2020 2020 2020 746f 2035 3025 2e20          to 50%. 
-0001aba0: 0d0a 0d0a 2020 2020 2020 2020 6672 6571  ....        freq
-0001abb0: 733a 206c 6973 7420 2c20 4f70 7469 6f6e  s: list , Option
-0001abc0: 616c 200d 0a20 2020 2020 2020 2020 2020  al ..           
-0001abd0: 5468 6520 6c69 7374 206f 6620 6672 6571  The list of freq
-0001abe0: 7565 6e63 6965 7320 746f 2072 656d 6f76  uencies to remov
-0001abf0: 6520 696e 2074 6865 3a20 7465 726d 3a60  e in the: term:`
-0001ac00: 4544 4960 6f62 6a65 6374 732e 2049 6620  EDI`objects. If 
-0001ac10: 0d0a 2020 2020 2020 2020 2020 2060 604e  ..           ``N
-0001ac20: 6f6e 6560 602c 2074 6865 2060 746f 6c60  one``, the `tol`
-0001ac30: 2070 6172 616d 6574 6572 206d 7573 7420   parameter must 
-0001ac40: 6265 2070 726f 7669 6465 642c 206f 7468  be provided, oth
-0001ac50: 6572 7769 7365 2061 6e20 6572 726f 720d  erwise an error.
-0001ac60: 0a20 2020 2020 2020 2020 2020 7769 6c6c  .           will
-0001ac70: 2072 6169 7365 2e20 4966 2074 6865 0d0a   raise. If the..
-0001ac80: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-0001ac90: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-0001aca0: 6865 2069 6e74 6572 706f 6c61 7465 6420  he interpolated 
-0001acb0: 6672 6571 7565 6e63 7920 6966 2073 6574  frequency if set
-0001acc0: 2074 6f20 6060 5472 7565 6060 2e20 0d0a   to ``True``. ..
-0001acd0: 2020 2020 2020 2020 496e 7465 7270 6f6c          Interpol
-0001ace0: 6174 653a 2062 6f6f 6c2c 2064 6566 6175  ate: bool, defau
-0001acf0: 6c74 3d46 616c 7365 2c20 0d0a 2020 2020  lt=False, ..    
-0001ad00: 2020 2020 2020 2049 6e74 6572 706f 6c61         Interpola
-0001ad10: 7465 2074 6865 2066 7265 7175 656e 6369  te the frequenci
-0001ad20: 6573 2061 6674 6572 2062 6164 2066 7265  es after bad fre
-0001ad30: 7175 656e 6369 6573 2072 656d 6f76 616c  quencies removal
-0001ad40: 2e20 0d0a 2020 2020 2020 2020 2020 200d  . ..           .
-0001ad50: 0a20 2020 2020 2020 2072 6f74 6174 653a  .        rotate:
-0001ad60: 2066 6c6f 6174 2c20 6465 6661 756c 743d   float, default=
-0001ad70: 302e 2020 0d0a 2020 2020 2020 2020 2020  0.  ..          
-0001ad80: 2020 526f 7461 7465 205a 2061 7272 6179    Rotate Z array
-0001ad90: 2062 7920 616e 676c 6520 616c 7068 6120   by angle alpha 
-0001ada0: 696e 2064 6567 7265 6573 2e20 2041 6c6c  in degrees.  All
-0001adb0: 2061 6e67 6c65 7320 6172 6520 0d0a 2020   angles are ..  
-0001adc0: 2020 2020 2020 2020 2020 7265 6665 7265            refere
-0001add0: 6e63 6564 2074 6f20 6765 6f67 7261 7068  nced to geograph
-0001ade0: 6963 204e 6f72 7468 2c20 706f 7369 7469  ic North, positi
-0001adf0: 7665 2069 6e20 636c 6f63 6b77 6973 6520  ve in clockwise 
-0001ae00: 6469 7265 6374 696f 6e2e 0d0a 2020 2020  direction...    
-0001ae10: 2020 2020 2020 2020 284d 6174 6865 6d61          (Mathema
-0001ae20: 7469 6361 6c6c 7920 6e65 6761 7469 7665  tically negative
-0001ae30: 2129 2e20 496e 206e 6f6e 2d72 6f74 6174  !). In non-rotat
-0001ae40: 6564 2073 7461 7465 2c20 5820 7265 6673  ed state, X refs
-0001ae50: 2074 6f20 4e6f 7274 6820 0d0a 2020 2020   to North ..    
-0001ae60: 2020 2020 2020 2020 616e 6420 5920 746f          and Y to
-0001ae70: 2045 6173 7420 6469 7265 6374 696f 6e2e   East direction.
-0001ae80: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
-0001ae90: 0a20 2020 2020 2020 2020 2020 204e 6f74  .            Not
-0001aea0: 6520 7468 6174 2069 6620 6072 6f74 6174  e that if `rotat
-0001aeb0: 6560 2069 7320 6769 7665 6e2c 2069 7420  e` is given, it 
-0001aec0: 6973 206f 6e6c 7920 7573 6564 2069 6e20  is only used in 
-0001aed0: 6069 6e74 6572 706f 6c61 7469 6f6e 600d  `interpolation`.
-0001aee0: 0a20 2020 2020 2020 2020 2020 2069 2e65  .            i.e
-0001aef0: 2069 6e74 6572 706f 6c61 7469 6f6e 2069   interpolation i
-0001af00: 7320 7365 7420 746f 2060 6054 7275 6560  s set to ``True`
-0001af10: 602e 200d 0a0d 0a20 2020 2020 2020 2065  `. ....        e
-0001af20: 7870 6f72 743a 2062 6f6f 6c20 2c20 6465  xport: bool , de
-0001af30: 6661 756c 7420 3d46 616c 7365 2c20 0d0a  fault =False, ..
-0001af40: 2020 2020 2020 2020 2020 204f 7574 7075             Outpu
-0001af50: 7420 6e65 7720 7361 6e69 7469 7a65 6420  t new sanitized 
-0001af60: 4544 4973 2e20 0d0a 2020 2020 2020 2020  EDIs. ..        
-0001af70: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0001af80: 7320 0d0a 2020 2020 2020 2020 2d2d 2d2d  s ..        ----
-0001af90: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 205a  -----..        Z
-0001afa0: 636f 6c3a 2020 6f72 2028 666c 6f61 742c  col:  or (float,
-0001afb0: 2061 7272 6179 2d6c 696b 652c 2073 6861   array-like, sha
-0001afc0: 7065 2028 4e2c 2029 290d 0a20 2020 2020  pe (N, ))..     
-0001afd0: 2020 2020 2020 2072 6574 7572 6e20 7468         return th
-0001afe0: 6520 7175 616c 6974 7920 636f 6e74 726f  e quality contro
-0001aff0: 6c20 7661 6c75 6520 616e 6420 696e 7465  l value and inte
-0001b000: 7270 6f6c 6174 6564 2066 7265 7175 656e  rpolated frequen
-0001b010: 6379 2069 6620 200d 0a20 2020 2020 2020  cy if  ..       
-0001b020: 2020 2020 2060 7265 7475 726e 5f66 7265       `return_fre
-0001b030: 7160 2020 6973 2073 6574 2074 6f20 6060  q`  is set to ``
-0001b040: 5472 7565 6060 206f 7468 6572 7769 7365  True`` otherwise
-0001b050: 2072 6574 7572 6e20 7468 6520 696e 6465   return the inde
-0001b060: 7820 6f66 2075 7365 6c65 7373 200d 0a20  x of useless .. 
-0001b070: 2020 2020 2020 2020 2020 2064 6174 612e             data.
-0001b080: 200d 0a20 2020 0d0a 2020 2020 2020 2020   ..   ..        
-0001b090: 4578 616d 706c 6573 200d 0a20 2020 2020  Examples ..     
-0001b0a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0001b0b0: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
-0001b0c0: 7420 7761 7465 7820 6173 2077 7820 0d0a  t watex as wx ..
-0001b0d0: 2020 2020 2020 2020 3e3e 3e20 7365 6469          >>> sedi
-0001b0e0: 7320 3d20 7778 2e66 6574 6368 5f64 6174  s = wx.fetch_dat
-0001b0f0: 6120 2827 6875 6179 7561 6e27 2c20 7361  a ('huayuan', sa
-0001b100: 6d70 6c65 7320 3d20 3132 202c 200d 0a20  mples = 12 , .. 
+0001a420: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+0001a430: 2020 2020 2020 2020 2020 2020 7a78 3d20              zx= 
+0001a440: 696e 7465 7270 6f6c 6174 6532 6428 7a78  interpolate2d(zx
+0001a450: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0001a460: 2020 207a 785f 6572 7220 3d20 6765 7432     zx_err = get2
+0001a470: 6474 656e 736f 7228 0d0a 2020 2020 2020  dtensor(..      
+0001a480: 2020 2020 2020 2020 2020 2020 2020 7a6f                zo
+0001a490: 626a 735f 696e 6974 2c20 0d0a 2020 2020  bjs_init, ..    
+0001a4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a4b0: 7465 6e73 6f72 203d 277a 5f65 7272 272c  tensor ='z_err',
+0001a4c0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0001a4d0: 2020 2020 2020 2063 6f6d 706f 6e65 6e74         component
+0001a4e0: 3d63 6f6d 702c 206b 696e 643d 2772 6561  =comp, kind='rea
+0001a4f0: 6c27 0d0a 2020 2020 2020 2020 2020 2020  l'..            
+0001a500: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+0001a510: 2020 2020 2020 2020 2020 207a 785f 6572             zx_er
+0001a520: 7220 3d20 696e 7465 7270 6f6c 6174 6532  r = interpolate2
+0001a530: 6420 287a 785f 6572 7229 0d0a 2020 2020  d (zx_err)..    
+0001a540: 2020 2020 2020 2020 6578 6365 7074 203a          except :
+0001a550: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001a560: 2020 2320 6966 2063 6f6d 706f 6e65 6e74    # if component
+0001a570: 2064 6f65 7320 6e6f 7420 6578 6973 7420   does not exist 
+0001a580: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001a590: 2020 7a78 203d 2073 6574 5f6e 756c 6c28    zx = set_null(
+0001a5a0: 662c 207a 6f62 6a73 5f69 6e69 7429 0d0a  f, zobjs_init)..
+0001a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a5c0: 7a78 5f65 7272 3d20 7a78 2e63 6f70 7928  zx_err= zx.copy(
+0001a5d0: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
+0001a5e0: 0d0a 2020 2020 2020 2020 2020 2020 7a64  ..            zd
+0001a5f0: 6963 7420 5b66 277a 7b63 6f6d 707d 275d  ict [f'z{comp}']
+0001a600: 3d7a 7820 0d0a 2020 2020 2020 2020 2020  =zx ..          
+0001a610: 2020 7a64 6963 7420 5b66 277a 7b63 6f6d    zdict [f'z{com
+0001a620: 707d 5f65 7272 275d 203d 207a 785f 6572  p}_err'] = zx_er
+0001a630: 7220 0d0a 2020 2020 2020 2020 2020 2020  r ..            
+0001a640: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0001a650: 2020 2020 7265 7475 726e 2028 7a6f 626a      return (zobj
+0001a660: 735f 696e 6974 2c20 662c 207a 6469 6374  s_init, f, zdict
+0001a670: 292c 206b 7773 200d 0a0d 0a20 2020 2064  ), kws ....    d
+0001a680: 6566 2064 726f 705f 6672 6571 7565 6e63  ef drop_frequenc
+0001a690: 6965 7320 280d 0a20 2020 2020 2020 2020  ies (..         
+0001a6a0: 2020 2073 656c 662c 200d 0a20 2020 2020     self, ..     
+0001a6b0: 2020 2020 2020 2066 7265 7173 3d20 4e6f         freqs= No
+0001a6c0: 6e65 2c20 0d0a 2020 2020 2020 2020 2020  ne, ..          
+0001a6d0: 2020 746f 6c20 3d4e 6f6e 652c 200d 0a20    tol =None, .. 
+0001a6e0: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
+0001a6f0: 706f 6c61 7465 3a20 626f 6f6c 203d 4661  polate: bool =Fa
+0001a700: 6c73 652c 200d 0a20 2020 2020 2020 2020  lse, ..         
+0001a710: 2020 2072 6f74 6174 653d 2030 2e20 2c20     rotate= 0. , 
+0001a720: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
+0001a730: 706f 7274 203d 4661 6c73 6520 2c20 0d0a  port =False , ..
+0001a740: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
+0001a750: 7320 0d0a 2020 2020 2020 2020 2020 2020  s ..            
+0001a760: 293a 200d 0a20 2020 2020 2020 2022 2222  ): ..        """
+0001a770: 2044 726f 7020 7573 656c 6573 7320 6672   Drop useless fr
+0001a780: 6571 7565 6e63 6965 7320 696e 2074 6865  equencies in the
+0001a790: 2045 4449 2064 6174 612e 0d0a 2020 2020   EDI data...    
+0001a7a0: 2020 2020 0d0a 2020 2020 2020 2020 4475      ..        Du
+0001a7b0: 6520 746f 2074 6865 2074 6572 7261 696e  e to the terrain
+0001a7c0: 2063 6f6e 7374 7261 696e 7473 2c20 746f   constraints, to
+0001a7d0: 706f 6772 6170 6869 6320 616e 6420 696e  pographic and in
+0001a7e0: 7465 7266 6572 656e 6365 7320 6e6f 6973  terferences nois
+0001a7f0: 6573 200d 0a20 2020 2020 2020 2073 6f6d  es ..        som
+0001a800: 6520 6672 6571 7565 6e63 6965 7320 6172  e frequencies ar
+0001a810: 6520 6e6f 7420 6d65 616e 696e 6766 756c  e not meaningful
+0001a820: 2074 6f20 6265 206b 6570 7420 696e 2074   to be kept in t
+0001a830: 6865 2064 6174 612e 2054 6865 200d 0a20  he data. The .. 
+0001a840: 2020 2020 2020 2066 756e 6374 696f 6e20         function 
+0001a850: 616c 6c6f 7773 2074 6f20 6578 706c 6963  allows to explic
+0001a860: 6974 656c 7920 7265 6d6f 7665 2074 6865  itely remove the
+0001a870: 2062 6164 2066 7265 7175 656e 6369 6573   bad frequencies
+0001a880: 2061 6674 6572 200d 0a20 2020 2020 2020   after ..       
+0001a890: 2061 6e61 6c79 7365 7320 616e 6420 696e   analyses and in
+0001a8a0: 7465 7270 6f6c 6174 6564 2074 6865 2072  terpolated the r
+0001a8b0: 656d 6169 6e73 2e20 4966 2062 6164 2066  emains. If bad f
+0001a8c0: 7265 7175 656e 6369 6573 2061 7265 206e  requencies are n
+0001a8d0: 6f74 206b 6e6f 776e 0d0a 2020 2020 2020  ot known..      
+0001a8e0: 2020 7768 6963 6820 6973 2063 6f6d 6d6f    which is commo
+0001a8f0: 6e20 696e 2072 6561 6c20 776f 726c 642c  n in real world,
+0001a900: 2074 6865 2074 6f6c 6572 616e 6365 2070   the tolerance p
+0001a910: 6172 616d 6574 6572 2060 746f 6c60 2063  arameter `tol` c
+0001a920: 616e 2062 6520 0d0a 2020 2020 2020 2020  an be ..        
+0001a930: 7365 7420 746f 2061 7574 6f6d 6174 6963  set to automatic
+0001a940: 616c 6c79 2064 6574 6563 7420 7769 7468  ally detect with
+0001a950: 2035 3025 2073 6d6f 6f74 686e 6573 7320   50% smoothness 
+0001a960: 696e 2064 6174 6120 7365 6c65 6374 696f  in data selectio
+0001a970: 6e2e 200d 0a20 2020 2020 2020 200d 0a20  n. ..        .. 
+0001a980: 2020 2020 2020 202e 2e20 7665 7273 696f         .. versio
+0001a990: 6e61 6464 6564 3a3a 2076 302e 322e 3020  nadded:: v0.2.0 
+0001a9a0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0001a9b0: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
+0001a9c0: 7261 6d65 7465 7273 200d 0a20 2020 2020  rameters ..     
+0001a9d0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a     -----------..
+0001a9e0: 2020 2020 2020 2020 746f 6c3a 2066 6c6f          tol: flo
+0001a9f0: 6174 2c20 0d0a 2020 2020 2020 2020 2020  at, ..          
+0001aa00: 2020 7468 6520 746f 6c65 7261 6e63 6520    the tolerance 
+0001aa10: 7061 7261 6d65 7465 722e 2054 6865 2076  parameter. The v
+0001aa20: 616c 7565 2069 6e64 6963 6174 6573 2074  alue indicates t
+0001aa30: 6865 2072 6174 6520 6672 6f6d 2077 6869  he rate from whi
+0001aa40: 6368 2074 6865 200d 0a20 2020 2020 2020  ch the ..       
+0001aa50: 2020 2020 2064 6174 6120 6361 6e20 6265       data can be
+0001aa60: 2063 6f6e 7369 6465 7220 6173 206d 6561   consider as mea
+0001aa70: 6e69 6e67 6675 6c2e 2050 7265 6665 7261  ningful. Prefera
+0001aa80: 626c 7920 6974 2073 686f 756c 6420 6265  bly it should be
+0001aa90: 206c 6573 7320 7468 616e 0d0a 2020 2020   less than..    
+0001aaa0: 2020 2020 2020 2020 3120 616e 6420 6772          1 and gr
+0001aab0: 6561 7465 7220 7468 616e 2030 2e20 4174  eater than 0. At
+0001aac0: 2074 6869 7320 7661 6c75 652e 2049 6620   this value. If 
+0001aad0: 6060 4e6f 6e65 6060 2c20 7468 6520 6c69  ``None``, the li
+0001aae0: 7374 206f 6620 0d0a 2020 2020 2020 2020  st of ..        
+0001aaf0: 2020 2020 6672 6571 7565 6e63 6965 7320      frequencies 
+0001ab00: 746f 2064 726f 7020 6d75 7374 2062 6520  to drop must be 
+0001ab10: 7072 6f76 6964 6564 2e20 4966 2074 6865  provided. If the
+0001ab20: 2060 746f 6c60 2070 6172 616d 6574 6572   `tol` parameter
+0001ab30: 2069 7320 0d0a 2020 2020 2020 2020 2020   is ..          
+0001ab40: 2020 7365 7420 746f 2060 6061 7574 6f60    set to ``auto`
+0001ab50: 602c 2074 6865 2073 656c 6563 7469 6f6e  `, the selection
+0001ab60: 206f 6620 7573 656c 6573 7320 6672 6571   of useless freq
+0001ab70: 7565 6e63 6965 7320 6973 2074 6f6c 6572  uencies is toler
+0001ab80: 6174 6520 0d0a 2020 2020 2020 2020 2020  ate ..          
+0001ab90: 2020 746f 2035 3025 2e20 0d0a 0d0a 2020    to 50%. ....  
+0001aba0: 2020 2020 2020 6672 6571 733a 206c 6973        freqs: lis
+0001abb0: 7420 2c20 4f70 7469 6f6e 616c 200d 0a20  t , Optional .. 
+0001abc0: 2020 2020 2020 2020 2020 5468 6520 6c69            The li
+0001abd0: 7374 206f 6620 6672 6571 7565 6e63 6965  st of frequencie
+0001abe0: 7320 746f 2072 656d 6f76 6520 696e 2074  s to remove in t
+0001abf0: 6865 3a20 7465 726d 3a60 4544 4960 6f62  he: term:`EDI`ob
+0001ac00: 6a65 6374 732e 2049 6620 0d0a 2020 2020  jects. If ..    
+0001ac10: 2020 2020 2020 2060 604e 6f6e 6560 602c         ``None``,
+0001ac20: 2074 6865 2060 746f 6c60 2070 6172 616d   the `tol` param
+0001ac30: 6574 6572 206d 7573 7420 6265 2070 726f  eter must be pro
+0001ac40: 7669 6465 642c 206f 7468 6572 7769 7365  vided, otherwise
+0001ac50: 2061 6e20 6572 726f 720d 0a20 2020 2020   an error..     
+0001ac60: 2020 2020 2020 7769 6c6c 2072 6169 7365        will raise
+0001ac70: 2e20 4966 2074 6865 0d0a 2020 2020 2020  . If the..      
+0001ac80: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+0001ac90: 2020 7265 7475 726e 2074 6865 2069 6e74    return the int
+0001aca0: 6572 706f 6c61 7465 6420 6672 6571 7565  erpolated freque
+0001acb0: 6e63 7920 6966 2073 6574 2074 6f20 6060  ncy if set to ``
+0001acc0: 5472 7565 6060 2e20 0d0a 2020 2020 2020  True``. ..      
+0001acd0: 2020 496e 7465 7270 6f6c 6174 653a 2062    Interpolate: b
+0001ace0: 6f6f 6c2c 2064 6566 6175 6c74 3d46 616c  ool, default=Fal
+0001acf0: 7365 2c20 0d0a 2020 2020 2020 2020 2020  se, ..          
+0001ad00: 2049 6e74 6572 706f 6c61 7465 2074 6865   Interpolate the
+0001ad10: 2066 7265 7175 656e 6369 6573 2061 6674   frequencies aft
+0001ad20: 6572 2062 6164 2066 7265 7175 656e 6369  er bad frequenci
+0001ad30: 6573 2072 656d 6f76 616c 2e20 0d0a 2020  es removal. ..  
+0001ad40: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0001ad50: 2020 2072 6f74 6174 653a 2066 6c6f 6174     rotate: float
+0001ad60: 2c20 6465 6661 756c 743d 302e 2020 0d0a  , default=0.  ..
+0001ad70: 2020 2020 2020 2020 2020 2020 526f 7461              Rota
+0001ad80: 7465 205a 2061 7272 6179 2062 7920 616e  te Z array by an
+0001ad90: 676c 6520 616c 7068 6120 696e 2064 6567  gle alpha in deg
+0001ada0: 7265 6573 2e20 2041 6c6c 2061 6e67 6c65  rees.  All angle
+0001adb0: 7320 6172 6520 0d0a 2020 2020 2020 2020  s are ..        
+0001adc0: 2020 2020 7265 6665 7265 6e63 6564 2074      referenced t
+0001add0: 6f20 6765 6f67 7261 7068 6963 204e 6f72  o geographic Nor
+0001ade0: 7468 2c20 706f 7369 7469 7665 2069 6e20  th, positive in 
+0001adf0: 636c 6f63 6b77 6973 6520 6469 7265 6374  clockwise direct
+0001ae00: 696f 6e2e 0d0a 2020 2020 2020 2020 2020  ion...          
+0001ae10: 2020 284d 6174 6865 6d61 7469 6361 6c6c    (Mathematicall
+0001ae20: 7920 6e65 6761 7469 7665 2129 2e20 496e  y negative!). In
+0001ae30: 206e 6f6e 2d72 6f74 6174 6564 2073 7461   non-rotated sta
+0001ae40: 7465 2c20 5820 7265 6673 2074 6f20 4e6f  te, X refs to No
+0001ae50: 7274 6820 0d0a 2020 2020 2020 2020 2020  rth ..          
+0001ae60: 2020 616e 6420 5920 746f 2045 6173 7420    and Y to East 
+0001ae70: 6469 7265 6374 696f 6e2e 200d 0a20 2020  direction. ..   
+0001ae80: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0001ae90: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
+0001aea0: 2069 6620 6072 6f74 6174 6560 2069 7320   if `rotate` is 
+0001aeb0: 6769 7665 6e2c 2069 7420 6973 206f 6e6c  given, it is onl
+0001aec0: 7920 7573 6564 2069 6e20 6069 6e74 6572  y used in `inter
+0001aed0: 706f 6c61 7469 6f6e 600d 0a20 2020 2020  polation`..     
+0001aee0: 2020 2020 2020 2069 2e65 2069 6e74 6572         i.e inter
+0001aef0: 706f 6c61 7469 6f6e 2069 7320 7365 7420  polation is set 
+0001af00: 746f 2060 6054 7275 6560 602e 200d 0a0d  to ``True``. ...
+0001af10: 0a20 2020 2020 2020 2065 7870 6f72 743a  .        export:
+0001af20: 2062 6f6f 6c20 2c20 6465 6661 756c 7420   bool , default 
+0001af30: 3d46 616c 7365 2c20 0d0a 2020 2020 2020  =False, ..      
+0001af40: 2020 2020 204f 7574 7075 7420 6e65 7720       Output new 
+0001af50: 7361 6e69 7469 7a65 6420 4544 4973 2e20  sanitized EDIs. 
+0001af60: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0001af70: 2020 2020 5265 7475 726e 7320 0d0a 2020      Returns ..  
+0001af80: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0d        ---------.
+0001af90: 0a20 2020 2020 2020 205a 636f 6c3a 2020  .        Zcol:  
+0001afa0: 6f72 2028 666c 6f61 742c 2061 7272 6179  or (float, array
+0001afb0: 2d6c 696b 652c 2073 6861 7065 2028 4e2c  -like, shape (N,
+0001afc0: 2029 290d 0a20 2020 2020 2020 2020 2020   ))..           
+0001afd0: 2072 6574 7572 6e20 7468 6520 7175 616c   return the qual
+0001afe0: 6974 7920 636f 6e74 726f 6c20 7661 6c75  ity control valu
+0001aff0: 6520 616e 6420 696e 7465 7270 6f6c 6174  e and interpolat
+0001b000: 6564 2066 7265 7175 656e 6379 2069 6620  ed frequency if 
+0001b010: 200d 0a20 2020 2020 2020 2020 2020 2060   ..            `
+0001b020: 7265 7475 726e 5f66 7265 7160 2020 6973  return_freq`  is
+0001b030: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
+0001b040: 206f 7468 6572 7769 7365 2072 6574 7572   otherwise retur
+0001b050: 6e20 7468 6520 696e 6465 7820 6f66 2075  n the index of u
+0001b060: 7365 6c65 7373 200d 0a20 2020 2020 2020  seless ..       
+0001b070: 2020 2020 2064 6174 612e 200d 0a20 2020       data. ..   
+0001b080: 0d0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+0001b090: 6573 200d 0a20 2020 2020 2020 202d 2d2d  es ..        ---
+0001b0a0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001b0b0: 203e 3e3e 2069 6d70 6f72 7420 7761 7465   >>> import wate
+0001b0c0: 7820 6173 2077 7820 0d0a 2020 2020 2020  x as wx ..      
+0001b0d0: 2020 3e3e 3e20 7365 6469 7320 3d20 7778    >>> sedis = wx
+0001b0e0: 2e66 6574 6368 5f64 6174 6120 2827 6875  .fetch_data ('hu
+0001b0f0: 6179 7561 6e27 2c20 7361 6d70 6c65 7320  ayuan', samples 
+0001b100: 3d20 3132 202c 200d 0a20 2020 2020 2020  = 12 , ..       
 0001b110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b130: 2020 7265 7475 726e 5f64 6174 6120 3d54    return_data =T
-0001b140: 7275 6520 2c20 6b65 793d 2772 6177 2729  rue , key='raw')
-0001b150: 0d0a 2020 2020 2020 2020 3e3e 3e20 7020  ..        >>> p 
-0001b160: 3d20 7778 2e45 4d50 726f 6365 7373 696e  = wx.EMProcessin
-0001b170: 6720 2829 2e66 6974 2873 6564 6973 2920  g ().fit(sedis) 
-0001b180: 0d0a 2020 2020 2020 2020 3e3e 3e20 6666  ..        >>> ff
-0001b190: 203d 205b 206c 656e 2865 6469 6f62 6a2e   = [ len(ediobj.
-0001b1a0: 5a2e 5f66 7265 7129 2020 666f 7220 6564  Z._freq)  for ed
-0001b1b0: 696f 626a 2069 6e20 702e 6564 694f 626a  iobj in p.ediObj
-0001b1c0: 735f 5d20 0d0a 2020 2020 2020 2020 3e3e  s_] ..        >>
-0001b1d0: 3e20 6666 0d0a 2020 2020 2020 2020 5b35  > ff..        [5
-0001b1e0: 332c 2035 322c 2035 332c 2035 352c 2035  3, 52, 53, 55, 5
-0001b1f0: 342c 2035 352c 2035 362c 2035 312c 2035  4, 55, 56, 51, 5
-0001b200: 312c 2035 332c 2035 352c 2035 335d 0d0a  1, 53, 55, 53]..
-0001b210: 2020 2020 2020 2020 3e3e 3e20 702e 6564          >>> p.ed
-0001b220: 694f 626a 735f 5b30 5d2e 5a2e 7a5b 3a2c  iObjs_[0].Z.z[:,
-0001b230: 2030 2c20 315d 5b3a 375d 0d0a 2020 2020   0, 1][:7]..    
-0001b240: 2020 2020 6172 7261 7928 5b20 3431 3635      array([ 4165
-0001b250: 2e36 202b 3230 3730 2e31 336a 2c20 2037  .6 +2070.13j,  7
-0001b260: 3037 322e 3831 2b36 3839 322e 3431 6a2c  072.81+6892.41j,
-0001b270: 2020 3837 3235 2e38 342b 3538 3734 2e31    8725.84+5874.1
-0001b280: 356a 2c0d 0a20 2020 2020 2020 2020 2020  5j,..           
-0001b290: 2020 2020 3134 3737 312e 3820 2d32 3833      14771.8 -283
-0001b2a0: 312e 3238 6a2c 2032 3132 3433 2e37 202d  1.28j, 21243.7 -
-0001b2b0: 3638 3032 2e33 366a 2c20 2036 3338 312e  6802.36j,  6381.
-0001b2c0: 3438 2b33 3431 312e 3635 6a2c 0d0a 2020  48+3411.65j,..  
-0001b2d0: 2020 2020 2020 2020 2020 2020 2020 3539                59
-0001b2e0: 3237 2e38 352b 3530 3734 2e32 376a 5d29  27.85+5074.27j])
-0001b2f0: 0d0a 2020 2020 2020 2020 3e3e 3e20 5a63  ..        >>> Zc
-0001b300: 6f6c 203d 2070 2e64 726f 705f 6672 6571  ol = p.drop_freq
-0001b310: 7565 6e63 6965 7320 2874 6f6c 203d 2e32  uencies (tol =.2
-0001b320: 2029 0d0a 2020 2020 2020 2020 3e3e 3e20   )..        >>> 
-0001b330: 5a63 6f6c 205b 305d 2e7a 5b3a 2c20 302c  Zcol [0].z[:, 0,
-0001b340: 2031 205d 5b3a 375d 0d0a 2020 2020 2020   1 ][:7]..      
-0001b350: 2020 6172 7261 7928 5b20 3431 3635 2e36    array([ 4165.6
-0001b360: 202b 3230 3730 2e31 336a 2c20 2037 3037   +2070.13j,  707
-0001b370: 322e 3831 2b36 3839 322e 3431 6a2c 2020  2.81+6892.41j,  
-0001b380: 3837 3235 2e38 342b 3538 3734 2e31 356a  8725.84+5874.15j
-0001b390: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0001b3a0: 2020 3134 3737 312e 3820 2d32 3833 312e    14771.8 -2831.
-0001b3b0: 3238 6a2c 2032 3132 3433 2e37 202d 3638  28j, 21243.7 -68
-0001b3c0: 3032 2e33 366a 2c20 2036 3338 312e 3438  02.36j,  6381.48
-0001b3d0: 2b33 3431 312e 3635 6a2c 0d0a 2020 2020  +3411.65j,..    
-0001b3e0: 2020 2020 2020 2020 2020 2020 3539 3237              5927
-0001b3f0: 2e38 352b 3530 3734 2e32 376a 5d29 0d0a  .85+5074.27j])..
-0001b400: 2020 2020 2020 2020 3e3e 3e20 5b20 6c65          >>> [ le
-0001b410: 6e28 7a2e 6672 6571 2920 666f 7220 7a20  n(z.freq) for z 
-0001b420: 696e 205a 636f 6c20 5d0d 0a20 2020 2020  in Zcol ]..     
-0001b430: 2020 205b 3533 2c20 3532 2c20 3532 2c20     [53, 52, 52, 
-0001b440: 3533 2c20 3533 2c20 3533 2c20 3533 2c20  53, 53, 53, 53, 
-0001b450: 3530 2c20 3439 2c20 3533 2c20 3533 2c20  50, 49, 53, 53, 
-0001b460: 3532 5d0d 0a20 2020 2020 2020 203e 3e3e  52]..        >>>
-0001b470: 2070 2e76 6572 626f 7365 203d 5472 7565   p.verbose =True
-0001b480: 200d 0a20 2020 2020 2020 203e 3e3e 205a   ..        >>> Z
-0001b490: 636f 6c20 3d20 702e 6472 6f70 5f66 7265  col = p.drop_fre
-0001b4a0: 7175 656e 6369 6573 2028 746f 6c20 3d2e  quencies (tol =.
-0001b4b0: 3220 2c20 696e 7465 7270 6f6c 6174 653d  2 , interpolate=
-0001b4c0: 2054 7275 6520 290d 0a20 2020 2020 2020   True )..       
-0001b4d0: 2046 7265 7175 656e 6369 6573 3a20 2020   Frequencies:   
-0001b4e0: 2020 312d 2038 3139 3230 2e30 2020 2020    1- 81920.0    
-0001b4f0: 322d 2034 382e 3532 3934 2020 2020 332d  2- 48.5294    3-
-0001b500: 2035 2e36 3235 2020 487a 2068 6176 6520   5.625  Hz have 
-0001b510: 6265 656e 2064 726f 7070 6564 2e0d 0a20  been dropped... 
-0001b520: 2020 2020 2020 203e 3e3e 205b 206c 656e         >>> [ len
-0001b530: 287a 2e66 7265 7129 2066 6f72 207a 2069  (z.freq) for z i
-0001b540: 6e20 5a63 6f6c 205d 2023 2061 6c6c 2061  n Zcol ] # all a
-0001b550: 7265 2069 6e74 6572 706f 6c61 7465 6420  re interpolated 
-0001b560: 746f 2035 3320 6672 6571 7565 6e63 6965  to 53 frequencie
-0001b570: 730d 0a20 2020 2020 2020 205b 3533 2c20  s..        [53, 
-0001b580: 3533 2c20 3533 2c20 3533 2c20 3533 2c20  53, 53, 53, 53, 
-0001b590: 3533 2c20 3533 2c20 3533 2c20 3533 2c20  53, 53, 53, 53, 
-0001b5a0: 3533 2c20 3533 2c20 3533 5d0d 0a20 2020  53, 53, 53]..   
-0001b5b0: 2020 2020 203e 3e3e 205a 636f 6c20 3d20       >>> Zcol = 
-0001b5c0: 702e 6472 6f70 5f66 7265 7175 656e 6369  p.drop_frequenci
-0001b5d0: 6573 2028 746f 6c20 3d2e 3220 2c20 696e  es (tol =.2 , in
-0001b5e0: 7465 7270 6f6c 6174 653d 2054 7275 6520  terpolate= True 
-0001b5f0: 2c20 6578 706f 7274 203d 5472 7565 2029  , export =True )
-0001b600: 0d0a 2020 2020 2020 2020 3e3e 3e20 2320  ..        >>> # 
-0001b610: 6472 6f70 2061 2073 7065 6369 6669 6320  drop a specific 
-0001b620: 6672 6571 7565 6e63 6965 7320 0d0a 2020  frequencies ..  
-0001b630: 2020 2020 2020 3e3e 3e20 2320 6c65 7420        >>> # let 
-0001b640: 7669 7375 616c 697a 6520 7468 6520 3720  visualize the 7 
-0001b650: 6672 6571 7565 6e63 6965 7320 6f66 206f  frequencies of o
-0001b660: 7572 2065 6469 4f62 6a73 200d 0a20 2020  ur ediObjs ..   
-0001b670: 2020 2020 203e 3e3e 2070 2e66 7265 7173       >>> p.freqs
-0001b680: 5f20 5b3a 375d 0d0a 2020 2020 2020 2020  _ [:7]..        
-0001b690: 6172 7261 7928 5b38 3139 3230 2e2c 2037  array([81920., 7
-0001b6a0: 3030 3030 2e2c 2035 3838 3030 2e2c 2034  0000., 58800., 4
-0001b6b0: 3935 3030 2e2c 2034 3136 3030 2e2c 2033  9500., 41600., 3
-0001b6c0: 3530 3030 2e2c 2032 3934 3030 2e5d 290d  5000., 29400.]).
-0001b6d0: 0a20 2020 2020 2020 203e 3e3e 2023 206c  .        >>> # l
-0001b6e0: 6574 2074 7279 2074 6f20 6472 6f70 2034  et try to drop 4
-0001b6f0: 3935 3030 2061 6e64 2032 3934 3030 2066  9500 and 29400 f
-0001b700: 7265 7175 656e 6369 6573 2065 7870 6c69  requencies expli
-0001b710: 6369 746c 792e 200d 0a20 2020 2020 2020  citly. ..       
-0001b720: 203e 3e3e 205a 636f 6c20 3d20 702e 6472   >>> Zcol = p.dr
-0001b730: 6f70 5f66 7265 7175 656e 6369 6573 2028  op_frequencies (
-0001b740: 6672 6571 7320 3d20 5b34 3935 3030 202c  freqs = [49500 ,
-0001b750: 2032 3934 3030 5d20 290d 0a20 2020 2020   29400] )..     
-0001b760: 2020 203e 3e3e 2023 206c 6574 2063 6865     >>> # let che
-0001b770: 636b 2077 6865 7468 6572 2074 6869 7320  ck whether this 
-0001b780: 6672 6571 7565 6e63 6965 7320 7374 696c  frequencies stil
-0001b790: 6c20 6176 6169 6c61 626c 6520 696e 2074  l available in t
-0001b7a0: 6865 2064 6174 6120 0d0a 2020 2020 2020  he data ..      
-0001b7b0: 2020 3e3e 3e20 5a63 6f6c 205b 355d 2e66    >>> Zcol [5].f
-0001b7c0: 7265 715b 3a37 5d20 0d0a 2020 2020 2020  req[:7] ..      
-0001b7d0: 2020 6172 7261 7928 5b38 3139 3230 2e2c    array([81920.,
-0001b7e0: 2037 3030 3030 2e2c 2035 3838 3030 2e2c   70000., 58800.,
-0001b7f0: 2034 3136 3030 2e2c 2033 3530 3030 2e2c   41600., 35000.,
-0001b800: 2032 3437 3030 2e2c 2032 3038 3030 2e5d   24700., 20800.]
-0001b810: 290d 0a20 2020 2020 2020 203e 3e3e 2023  )..        >>> #
-0001b820: 2066 7265 7175 656e 6369 6573 2064 6f20   frequencies do 
-0001b830: 6e6f 7420 6e65 6564 2074 6f20 6d61 7463  not need to matc
-0001b840: 6820 6578 6163 746c 7920 7468 6520 7661  h exactly the va
-0001b850: 6c75 6520 696e 2066 7265 7175 656e 7920  lue in frequeny 
-0001b860: 0d0a 2020 2020 2020 2020 3e3e 3e20 2320  ..        >>> # 
-0001b870: 7261 6e67 652e 2048 6572 6520 6973 2061  range. Here is a
-0001b880: 6e20 6578 616d 706c 6520 0d0a 2020 2020  n example ..    
-0001b890: 2020 2020 3e3e 3e20 5a63 6f6c 203d 2070      >>> Zcol = p
-0001b8a0: 2e64 726f 705f 6672 6571 7565 6e63 6965  .drop_frequencie
-0001b8b0: 7320 2866 7265 7173 203d 205b 3439 3830  s (freqs = [4980
-0001b8c0: 3020 2c20 3239 3730 305d 2029 0d0a 2020  0 , 29700] )..  
-0001b8d0: 2020 2020 2020 4672 6571 7565 6e63 6965        Frequencie
-0001b8e0: 733a 2020 2020 2031 2d20 3439 3530 302e  s:     1- 49500.
-0001b8f0: 3020 2020 2032 2d20 3239 3430 302e 3020  0    2- 29400.0 
-0001b900: 2048 7a20 6861 7665 2062 6565 6e20 6472   Hz have been dr
-0001b910: 6f70 7065 642e 0d0a 2020 2020 2020 2020  opped...        
-0001b920: 3e3e 3e20 2320 6578 706c 6963 6974 6c79  >>> # explicitly
-0001b930: 2069 7420 6472 6f70 7320 7468 6520 3439   it drops the 49
-0001b940: 3530 3020 616e 6420 3239 3430 3020 487a  500 and 29400 Hz
-0001b950: 2074 6865 2063 6c6f 7365 7374 2e20 0d0a   the closest. ..
-0001b960: 0d0a 2020 2020 2020 2020 2222 2220 0d0a  ..        """ ..
-0001b970: 0d0a 2020 2020 2020 2020 7365 6c66 2e69  ..        self.i
-0001b980: 6e73 7065 6374 200d 0a20 2020 2020 2020  nspect ..       
-0001b990: 200d 0a20 2020 2020 2020 2069 6620 746f   ..        if to
-0001b9a0: 6c20 6973 204e 6f6e 6520 616e 6420 6672  l is None and fr
-0001b9b0: 6571 7320 6973 204e 6f6e 653a 200d 0a20  eqs is None: .. 
-0001b9c0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001b9d0: 2045 4d45 7272 6f72 2028 2274 6f6c 6572   EMError ("toler
-0001b9e0: 616e 6365 2070 6172 616d 6574 6572 206f  ance parameter o
-0001b9f0: 7220 6672 6571 7565 6e63 7920 7661 6c75  r frequency valu
-0001ba00: 6573 2074 6f20 6465 6c65 7465 220d 0a20  es to delete".. 
+0001b120: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001b130: 726e 5f64 6174 6120 3d54 7275 6520 2c20  rn_data =True , 
+0001b140: 6b65 793d 2772 6177 2729 0d0a 2020 2020  key='raw')..    
+0001b150: 2020 2020 3e3e 3e20 7020 3d20 7778 2e45      >>> p = wx.E
+0001b160: 4d50 726f 6365 7373 696e 6720 2829 2e66  MProcessing ().f
+0001b170: 6974 2873 6564 6973 2920 0d0a 2020 2020  it(sedis) ..    
+0001b180: 2020 2020 3e3e 3e20 6666 203d 205b 206c      >>> ff = [ l
+0001b190: 656e 2865 6469 6f62 6a2e 5a2e 5f66 7265  en(ediobj.Z._fre
+0001b1a0: 7129 2020 666f 7220 6564 696f 626a 2069  q)  for ediobj i
+0001b1b0: 6e20 702e 6564 694f 626a 735f 5d20 0d0a  n p.ediObjs_] ..
+0001b1c0: 2020 2020 2020 2020 3e3e 3e20 6666 0d0a          >>> ff..
+0001b1d0: 2020 2020 2020 2020 5b35 332c 2035 322c          [53, 52,
+0001b1e0: 2035 332c 2035 352c 2035 342c 2035 352c   53, 55, 54, 55,
+0001b1f0: 2035 362c 2035 312c 2035 312c 2035 332c   56, 51, 51, 53,
+0001b200: 2035 352c 2035 335d 0d0a 2020 2020 2020   55, 53]..      
+0001b210: 2020 3e3e 3e20 702e 6564 694f 626a 735f    >>> p.ediObjs_
+0001b220: 5b30 5d2e 5a2e 7a5b 3a2c 2030 2c20 315d  [0].Z.z[:, 0, 1]
+0001b230: 5b3a 375d 0d0a 2020 2020 2020 2020 6172  [:7]..        ar
+0001b240: 7261 7928 5b20 3431 3635 2e36 202b 3230  ray([ 4165.6 +20
+0001b250: 3730 2e31 336a 2c20 2037 3037 322e 3831  70.13j,  7072.81
+0001b260: 2b36 3839 322e 3431 6a2c 2020 3837 3235  +6892.41j,  8725
+0001b270: 2e38 342b 3538 3734 2e31 356a 2c0d 0a20  .84+5874.15j,.. 
+0001b280: 2020 2020 2020 2020 2020 2020 2020 3134                14
+0001b290: 3737 312e 3820 2d32 3833 312e 3238 6a2c  771.8 -2831.28j,
+0001b2a0: 2032 3132 3433 2e37 202d 3638 3032 2e33   21243.7 -6802.3
+0001b2b0: 366a 2c20 2036 3338 312e 3438 2b33 3431  6j,  6381.48+341
+0001b2c0: 312e 3635 6a2c 0d0a 2020 2020 2020 2020  1.65j,..        
+0001b2d0: 2020 2020 2020 2020 3539 3237 2e38 352b          5927.85+
+0001b2e0: 3530 3734 2e32 376a 5d29 0d0a 2020 2020  5074.27j])..    
+0001b2f0: 2020 2020 3e3e 3e20 5a63 6f6c 203d 2070      >>> Zcol = p
+0001b300: 2e64 726f 705f 6672 6571 7565 6e63 6965  .drop_frequencie
+0001b310: 7320 2874 6f6c 203d 2e32 2029 0d0a 2020  s (tol =.2 )..  
+0001b320: 2020 2020 2020 3e3e 3e20 5a63 6f6c 205b        >>> Zcol [
+0001b330: 305d 2e7a 5b3a 2c20 302c 2031 205d 5b3a  0].z[:, 0, 1 ][:
+0001b340: 375d 0d0a 2020 2020 2020 2020 6172 7261  7]..        arra
+0001b350: 7928 5b20 3431 3635 2e36 202b 3230 3730  y([ 4165.6 +2070
+0001b360: 2e31 336a 2c20 2037 3037 322e 3831 2b36  .13j,  7072.81+6
+0001b370: 3839 322e 3431 6a2c 2020 3837 3235 2e38  892.41j,  8725.8
+0001b380: 342b 3538 3734 2e31 356a 2c0d 0a20 2020  4+5874.15j,..   
+0001b390: 2020 2020 2020 2020 2020 2020 3134 3737              1477
+0001b3a0: 312e 3820 2d32 3833 312e 3238 6a2c 2032  1.8 -2831.28j, 2
+0001b3b0: 3132 3433 2e37 202d 3638 3032 2e33 366a  1243.7 -6802.36j
+0001b3c0: 2c20 2036 3338 312e 3438 2b33 3431 312e  ,  6381.48+3411.
+0001b3d0: 3635 6a2c 0d0a 2020 2020 2020 2020 2020  65j,..          
+0001b3e0: 2020 2020 2020 3539 3237 2e38 352b 3530        5927.85+50
+0001b3f0: 3734 2e32 376a 5d29 0d0a 2020 2020 2020  74.27j])..      
+0001b400: 2020 3e3e 3e20 5b20 6c65 6e28 7a2e 6672    >>> [ len(z.fr
+0001b410: 6571 2920 666f 7220 7a20 696e 205a 636f  eq) for z in Zco
+0001b420: 6c20 5d0d 0a20 2020 2020 2020 205b 3533  l ]..        [53
+0001b430: 2c20 3532 2c20 3532 2c20 3533 2c20 3533  , 52, 52, 53, 53
+0001b440: 2c20 3533 2c20 3533 2c20 3530 2c20 3439  , 53, 53, 50, 49
+0001b450: 2c20 3533 2c20 3533 2c20 3532 5d0d 0a20  , 53, 53, 52].. 
+0001b460: 2020 2020 2020 203e 3e3e 2070 2e76 6572         >>> p.ver
+0001b470: 626f 7365 203d 5472 7565 200d 0a20 2020  bose =True ..   
+0001b480: 2020 2020 203e 3e3e 205a 636f 6c20 3d20       >>> Zcol = 
+0001b490: 702e 6472 6f70 5f66 7265 7175 656e 6369  p.drop_frequenci
+0001b4a0: 6573 2028 746f 6c20 3d2e 3220 2c20 696e  es (tol =.2 , in
+0001b4b0: 7465 7270 6f6c 6174 653d 2054 7275 6520  terpolate= True 
+0001b4c0: 290d 0a20 2020 2020 2020 2046 7265 7175  )..        Frequ
+0001b4d0: 656e 6369 6573 3a20 2020 2020 312d 2038  encies:     1- 8
+0001b4e0: 3139 3230 2e30 2020 2020 322d 2034 382e  1920.0    2- 48.
+0001b4f0: 3532 3934 2020 2020 332d 2035 2e36 3235  5294    3- 5.625
+0001b500: 2020 487a 2068 6176 6520 6265 656e 2064    Hz have been d
+0001b510: 726f 7070 6564 2e0d 0a20 2020 2020 2020  ropped...       
+0001b520: 203e 3e3e 205b 206c 656e 287a 2e66 7265   >>> [ len(z.fre
+0001b530: 7129 2066 6f72 207a 2069 6e20 5a63 6f6c  q) for z in Zcol
+0001b540: 205d 2023 2061 6c6c 2061 7265 2069 6e74   ] # all are int
+0001b550: 6572 706f 6c61 7465 6420 746f 2035 3320  erpolated to 53 
+0001b560: 6672 6571 7565 6e63 6965 730d 0a20 2020  frequencies..   
+0001b570: 2020 2020 205b 3533 2c20 3533 2c20 3533       [53, 53, 53
+0001b580: 2c20 3533 2c20 3533 2c20 3533 2c20 3533  , 53, 53, 53, 53
+0001b590: 2c20 3533 2c20 3533 2c20 3533 2c20 3533  , 53, 53, 53, 53
+0001b5a0: 2c20 3533 5d0d 0a20 2020 2020 2020 203e  , 53]..        >
+0001b5b0: 3e3e 205a 636f 6c20 3d20 702e 6472 6f70  >> Zcol = p.drop
+0001b5c0: 5f66 7265 7175 656e 6369 6573 2028 746f  _frequencies (to
+0001b5d0: 6c20 3d2e 3220 2c20 696e 7465 7270 6f6c  l =.2 , interpol
+0001b5e0: 6174 653d 2054 7275 6520 2c20 6578 706f  ate= True , expo
+0001b5f0: 7274 203d 5472 7565 2029 0d0a 2020 2020  rt =True )..    
+0001b600: 2020 2020 3e3e 3e20 2320 6472 6f70 2061      >>> # drop a
+0001b610: 2073 7065 6369 6669 6320 6672 6571 7565   specific freque
+0001b620: 6e63 6965 7320 0d0a 2020 2020 2020 2020  ncies ..        
+0001b630: 3e3e 3e20 2320 6c65 7420 7669 7375 616c  >>> # let visual
+0001b640: 697a 6520 7468 6520 3720 6672 6571 7565  ize the 7 freque
+0001b650: 6e63 6965 7320 6f66 206f 7572 2065 6469  ncies of our edi
+0001b660: 4f62 6a73 200d 0a20 2020 2020 2020 203e  Objs ..        >
+0001b670: 3e3e 2070 2e66 7265 7173 5f20 5b3a 375d  >> p.freqs_ [:7]
+0001b680: 0d0a 2020 2020 2020 2020 6172 7261 7928  ..        array(
+0001b690: 5b38 3139 3230 2e2c 2037 3030 3030 2e2c  [81920., 70000.,
+0001b6a0: 2035 3838 3030 2e2c 2034 3935 3030 2e2c   58800., 49500.,
+0001b6b0: 2034 3136 3030 2e2c 2033 3530 3030 2e2c   41600., 35000.,
+0001b6c0: 2032 3934 3030 2e5d 290d 0a20 2020 2020   29400.])..     
+0001b6d0: 2020 203e 3e3e 2023 206c 6574 2074 7279     >>> # let try
+0001b6e0: 2074 6f20 6472 6f70 2034 3935 3030 2061   to drop 49500 a
+0001b6f0: 6e64 2032 3934 3030 2066 7265 7175 656e  nd 29400 frequen
+0001b700: 6369 6573 2065 7870 6c69 6369 746c 792e  cies explicitly.
+0001b710: 200d 0a20 2020 2020 2020 203e 3e3e 205a   ..        >>> Z
+0001b720: 636f 6c20 3d20 702e 6472 6f70 5f66 7265  col = p.drop_fre
+0001b730: 7175 656e 6369 6573 2028 6672 6571 7320  quencies (freqs 
+0001b740: 3d20 5b34 3935 3030 202c 2032 3934 3030  = [49500 , 29400
+0001b750: 5d20 290d 0a20 2020 2020 2020 203e 3e3e  ] )..        >>>
+0001b760: 2023 206c 6574 2063 6865 636b 2077 6865   # let check whe
+0001b770: 7468 6572 2074 6869 7320 6672 6571 7565  ther this freque
+0001b780: 6e63 6965 7320 7374 696c 6c20 6176 6169  ncies still avai
+0001b790: 6c61 626c 6520 696e 2074 6865 2064 6174  lable in the dat
+0001b7a0: 6120 0d0a 2020 2020 2020 2020 3e3e 3e20  a ..        >>> 
+0001b7b0: 5a63 6f6c 205b 355d 2e66 7265 715b 3a37  Zcol [5].freq[:7
+0001b7c0: 5d20 0d0a 2020 2020 2020 2020 6172 7261  ] ..        arra
+0001b7d0: 7928 5b38 3139 3230 2e2c 2037 3030 3030  y([81920., 70000
+0001b7e0: 2e2c 2035 3838 3030 2e2c 2034 3136 3030  ., 58800., 41600
+0001b7f0: 2e2c 2033 3530 3030 2e2c 2032 3437 3030  ., 35000., 24700
+0001b800: 2e2c 2032 3038 3030 2e5d 290d 0a20 2020  ., 20800.])..   
+0001b810: 2020 2020 203e 3e3e 2023 2066 7265 7175       >>> # frequ
+0001b820: 656e 6369 6573 2064 6f20 6e6f 7420 6e65  encies do not ne
+0001b830: 6564 2074 6f20 6d61 7463 6820 6578 6163  ed to match exac
+0001b840: 746c 7920 7468 6520 7661 6c75 6520 696e  tly the value in
+0001b850: 2066 7265 7175 656e 7920 0d0a 2020 2020   frequeny ..    
+0001b860: 2020 2020 3e3e 3e20 2320 7261 6e67 652e      >>> # range.
+0001b870: 2048 6572 6520 6973 2061 6e20 6578 616d   Here is an exam
+0001b880: 706c 6520 0d0a 2020 2020 2020 2020 3e3e  ple ..        >>
+0001b890: 3e20 5a63 6f6c 203d 2070 2e64 726f 705f  > Zcol = p.drop_
+0001b8a0: 6672 6571 7565 6e63 6965 7320 2866 7265  frequencies (fre
+0001b8b0: 7173 203d 205b 3439 3830 3020 2c20 3239  qs = [49800 , 29
+0001b8c0: 3730 305d 2029 0d0a 2020 2020 2020 2020  700] )..        
+0001b8d0: 4672 6571 7565 6e63 6965 733a 2020 2020  Frequencies:    
+0001b8e0: 2031 2d20 3439 3530 302e 3020 2020 2032   1- 49500.0    2
+0001b8f0: 2d20 3239 3430 302e 3020 2048 7a20 6861  - 29400.0  Hz ha
+0001b900: 7665 2062 6565 6e20 6472 6f70 7065 642e  ve been dropped.
+0001b910: 0d0a 2020 2020 2020 2020 3e3e 3e20 2320  ..        >>> # 
+0001b920: 6578 706c 6963 6974 6c79 2069 7420 6472  explicitly it dr
+0001b930: 6f70 7320 7468 6520 3439 3530 3020 616e  ops the 49500 an
+0001b940: 6420 3239 3430 3020 487a 2074 6865 2063  d 29400 Hz the c
+0001b950: 6c6f 7365 7374 2e20 0d0a 0d0a 2020 2020  losest. ....    
+0001b960: 2020 2020 2222 2220 0d0a 0d0a 2020 2020      """ ....    
+0001b970: 2020 2020 7365 6c66 2e69 6e73 7065 6374      self.inspect
+0001b980: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0001b990: 2020 2020 2069 6620 746f 6c20 6973 204e       if tol is N
+0001b9a0: 6f6e 6520 616e 6420 6672 6571 7320 6973  one and freqs is
+0001b9b0: 204e 6f6e 653a 200d 0a20 2020 2020 2020   None: ..       
+0001b9c0: 2020 2020 2072 6169 7365 2045 4d45 7272       raise EMErr
+0001b9d0: 6f72 2028 2274 6f6c 6572 616e 6365 2070  or ("tolerance p
+0001b9e0: 6172 616d 6574 6572 206f 7220 6672 6571  arameter or freq
+0001b9f0: 7565 6e63 7920 7661 6c75 6573 2074 6f20  uency values to 
+0001ba00: 6465 6c65 7465 220d 0a20 2020 2020 2020  delete"..       
 0001ba10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ba20: 2020 2020 2020 2020 2020 2220 636f 756c            " coul
-0001ba30: 6420 6e6f 7420 6265 204e 6f6e 652e 2043  d not be None. C
-0001ba40: 6f6e 7369 6465 7220 6060 746f 6c3d 2761  onsider ``tol='a
-0001ba50: 7574 6f27 6060 746f 220d 0a20 2020 2020  uto'``to"..     
+0001ba20: 2020 2020 2220 636f 756c 6420 6e6f 7420      " could not 
+0001ba30: 6265 204e 6f6e 652e 2043 6f6e 7369 6465  be None. Conside
+0001ba40: 7220 6060 746f 6c3d 2761 7574 6f27 6060  r ``tol='auto'``
+0001ba50: 746f 220d 0a20 2020 2020 2020 2020 2020  to"..           
 0001ba60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ba70: 2020 2020 2020 2220 2061 7574 6f6d 6174        "  automat
-0001ba80: 6963 616c 6c79 2064 656c 6563 7420 7468  ically delect th
-0001ba90: 6520 6261 6420 6672 6571 7565 6e63 6965  e bad frequencie
-0001baa0: 732e 2229 0d0a 2020 2020 2020 2020 2020  s.")..          
-0001bab0: 2020 0d0a 2020 2020 2020 2020 6966 2073    ..        if s
-0001bac0: 7472 2874 6f6c 292e 6c6f 7765 7228 2920  tr(tol).lower() 
-0001bad0: 3d3d 2027 6175 746f 273a 200d 0a20 2020  == 'auto': ..   
-0001bae0: 2020 2020 2020 2020 2074 6f6c 203d 2e35           tol =.5
-0001baf0: 200d 0a20 2020 0d0a 2020 2020 2020 2020   ..   ..        
-0001bb00: 2320 6d61 6b65 2061 2063 6f70 7920 6f66  # make a copy of
-0001bb10: 2065 6469 6f62 6a73 2020 0d0a 2020 2020   ediobjs  ..    
-0001bb20: 2020 2020 6564 694f 626a 7320 3d20 6e70      ediObjs = np
-0001bb30: 2e61 7272 6179 2820 7365 6c66 2e65 6469  .array( self.edi
-0001bb40: 4f62 6a73 5f2c 2064 7479 7065 203d 6f62  Objs_, dtype =ob
-0001bb50: 6a65 6374 2920 0d0a 2020 2020 2020 2020  ject) ..        
-0001bb60: 0d0a 2020 2020 2020 2020 6966 2074 6f6c  ..        if tol
-0001bb70: 2069 7320 6e6f 7420 4e6f 6e65 3a20 0d0a   is not None: ..
-0001bb80: 2020 2020 2020 2020 2020 2020 5f20 2c20              _ , 
-0001bb90: 696e 6465 785f 6672 6571 203d 2073 656c  index_freq = sel
-0001bba0: 662e 7163 2028 746f 6c20 3d20 746f 6c20  f.qc (tol = tol 
-0001bbb0: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
-0001bbc0: 6672 6571 7320 3d20 7365 6c66 2e66 7265  freqs = self.fre
-0001bbd0: 7173 5f20 5b20 696e 6465 785f 6672 6571  qs_ [ index_freq
-0001bbe0: 205d 0d0a 0d0a 2020 2020 2020 2020 6966   ]....        if
-0001bbf0: 2066 7265 7173 2069 7320 6e6f 7420 4e6f   freqs is not No
-0001bc00: 6e65 3a20 0d0a 2020 2020 2020 2020 2020  ne: ..          
-0001bc10: 2020 6966 2069 735f 6974 6572 6162 6c65    if is_iterable
-0001bc20: 2866 7265 7173 2c20 6578 636c 7564 655f  (freqs, exclude_
-0001bc30: 7374 7269 6e67 3d54 7275 6529 3a20 0d0a  string=True): ..
-0001bc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bc50: 2320 6669 6e64 2074 6865 2063 6c6f 7365  # find the close
-0001bc60: 7374 2066 7265 7175 656e 6379 2074 6861  st frequency tha
-0001bc70: 7420 6d61 7463 6820 7468 6520 0d0a 2020  t match the ..  
-0001bc80: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0001bc90: 6672 6571 7565 6e63 7920 696e 2074 6865  frequency in the
-0001bca0: 2063 6f6d 706c 6574 6520 6672 6571 200d   complete freq .
-0001bcb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001bcc0: 2066 7265 7173 203d 2066 696e 645f 636c   freqs = find_cl
-0001bcd0: 6f73 6573 7420 2873 656c 662e 6672 6571  osest (self.freq
-0001bce0: 735f 2c20 6672 6571 7320 290d 0a20 2020  s_, freqs )..   
-0001bcf0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0001bd00: 2020 2023 2072 616e 646f 6d6c 7920 7365     # randomly se
-0001bd10: 6c65 6374 2066 7265 7175 656e 6379 200d  lect frequency .
-0001bd20: 0a20 2020 2020 2020 2066 7265 7173 203d  .        freqs =
-0001bd30: 2072 616e 646f 6d5f 7365 6c65 6374 6f72   random_selector
-0001bd40: 2028 7365 6c66 2e66 7265 7173 5f20 2c20   (self.freqs_ , 
-0001bd50: 7661 6c75 6520 3d20 6672 6571 7329 200d  value = freqs) .
-0001bd60: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0001bd70: 2020 2020 2020 2023 2070 7574 2062 6163         # put bac
-0001bd80: 6b20 6672 6571 7565 6e63 7920 6672 6f6d  k frequency from
-0001bd90: 2068 6967 6865 7374 2074 6f20 6c6f 7765   highest to lowe
-0001bda0: 7374 200d 0a20 2020 2020 2020 2023 2066  st ..        # f
-0001bdb0: 6f72 2063 6f6e 7369 7374 656e 6379 200d  or consistency .
-0001bdc0: 0a20 2020 2020 2020 2066 7265 7173 203d  .        freqs =
-0001bdd0: 206e 702e 736f 7274 2028 6672 6571 7320   np.sort (freqs 
-0001bde0: 295b 3a3a 2d31 205d 200d 0a20 2020 2020  )[::-1 ] ..     
-0001bdf0: 2020 0d0a 2020 2020 2020 2020 2369 6620    ..        #if 
-0001be00: 7365 6c66 2e76 6572 626f 7365 3a20 0d0a  self.verbose: ..
-0001be10: 2020 2020 2020 2020 6c69 7374 696e 675f          listing_
-0001be20: 6974 656d 735f 666f 726d 6174 2866 7265  items_format(fre
-0001be30: 7173 202c 6265 6769 6e74 6578 743d 2022  qs ,begintext= "
-0001be40: 4672 6571 7565 6e63 6965 7322 202c 200d  Frequencies" , .
-0001be50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001be60: 2020 2020 2020 2020 2020 2020 2020 656e                en
-0001be70: 6474 6578 743d 2248 7a20 6861 7665 2062  dtext="Hz have b
-0001be80: 6565 6e20 6472 6f70 7065 642e 222c 200d  een dropped.", .
-0001be90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001bea0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0001beb0: 6c69 6e65 203d 5472 7565 202c 2076 6572  line =True , ver
-0001bec0: 626f 7365 203d 7365 6c66 2e76 6572 626f  bose =self.verbo
-0001bed0: 7365 200d 0a20 2020 2020 2020 2020 2020  se ..           
-0001bee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bef0: 2020 290d 0a20 2020 2020 2020 2023 2075    )..        # u
-0001bf00: 7365 206d 6173 6b20 746f 2073 6574 2061  se mask to set a
-0001bf10: 206e 6577 2063 6f6c 6c65 6374 696f 6e20   new collection 
-0001bf20: 6f66 205a 200d 0a20 2020 2020 2020 205a  of Z ..        Z
-0001bf30: 6f62 6a20 3d20 5b5d 0d0a 2020 2020 2020  obj = []..      
-0001bf40: 2020 666f 7220 6b6b 202c 2065 6469 6f20    for kk , edio 
-0001bf50: 2069 6e20 656e 756d 6572 6174 6520 2865   in enumerate (e
-0001bf60: 6469 4f62 6a73 2029 3a20 0d0a 2020 2020  diObjs ): ..    
-0001bf70: 2020 2020 2020 2020 6d61 736b 2020 3d20          mask  = 
-0001bf80: 6e70 2e69 7369 6e20 2820 6564 696f 2e5a  np.isin ( edio.Z
-0001bf90: 2e5f 6672 6571 2c20 2066 7265 7173 290d  ._freq,  freqs).
-0001bfa0: 0a20 2020 2020 2020 2020 2020 2023 206d  .            # m
-0001bfb0: 6173 6b20 3d20 6e70 2e6f 6e65 7320 2820  ask = np.ones ( 
-0001bfc0: 6c65 6e28 2065 6469 6f2e 5a2e 5f66 7265  len( edio.Z._fre
-0001bfd0: 7129 2c20 6474 7970 6520 3d20 626f 6f6c  q), dtype = bool
-0001bfe0: 2029 200d 0a20 2020 2020 2020 2020 2020   ) ..           
-0001bff0: 2023 206d 6173 6b20 5b20 755f 6672 6571   # mask [ u_freq
-0001c000: 735d 203d 2046 616c 7365 200d 0a20 2020  s] = False ..   
-0001c010: 2020 2020 2020 2020 207a 5f6e 6577 2020           z_new  
-0001c020: 3d20 6564 696f 2e5a 2e5f 7a20 5b7e 6d61  = edio.Z._z [~ma
-0001c030: 736b 202c 203a 2c20 3a5d 2020 0d0a 2020  sk , :, :]  ..  
-0001c040: 2020 2020 2020 2020 2020 2320 7369 6d69            # simi
-0001c050: 6c61 7220 746f 206e 702e 6465 6c65 7465  lar to np.delete
-0001c060: 2028 6564 696f 2e5a 2e5f 7a20 2c20 755f   (edio.Z._z , u_
-0001c070: 6672 6571 732c 2061 7869 7320 3d30 2029  freqs, axis =0 )
-0001c080: 0d0a 2020 2020 2020 2020 2020 2020 7a5f  ..            z_
-0001c090: 6572 725f 6e65 7720 203d 2065 6469 6f2e  err_new  = edio.
-0001c0a0: 5a2e 5f7a 5f65 7272 205b 7e6d 6173 6b20  Z._z_err [~mask 
-0001c0b0: 2c20 3a2c 203a 5d20 0d0a 2020 2020 2020  , :, :] ..      
-0001c0c0: 2020 2020 2020 6e65 775f 6672 6571 203d        new_freq =
-0001c0d0: 2065 6469 6f2e 5a2e 5f66 7265 715b 207e   edio.Z._freq[ ~
-0001c0e0: 6d61 736b 205d 200d 0a20 2020 2020 2020  mask ] ..       
-0001c0f0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0001c100: 2020 205a 203d 454d 7a20 280d 0a20 2020     Z =EMz (..   
-0001c110: 2020 2020 2020 2020 2020 2020 207a 5f61               z_a
-0001c120: 7272 6179 3d20 7a5f 6e65 7720 2c20 7a5f  rray= z_new , z_
-0001c130: 6572 725f 6172 7261 793d 207a 5f65 7272  err_array= z_err
-0001c140: 5f6e 6577 202c 2066 7265 7120 3d20 6e65  _new , freq = ne
-0001c150: 775f 6672 6571 0d0a 2020 2020 2020 2020  w_freq..        
-0001c160: 2020 2020 2020 2020 2920 0d0a 2020 2020          ) ..    
-0001c170: 2020 2020 2020 2020 5a6f 626a 2e61 7070          Zobj.app
-0001c180: 656e 6428 5a20 290d 0a20 2020 2020 2020  end(Z )..       
-0001c190: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-0001c1a0: 6620 696e 7465 7270 6f6c 6174 653a 0d0a  f interpolate:..
-0001c1b0: 2020 2020 2020 2020 2020 2020 5a6f 626a              Zobj
-0001c1c0: 203d 2073 656c 662e 696e 7465 7270 6f6c   = self.interpol
-0001c1d0: 6174 655f 7a20 285a 6f62 6a2c 200d 0a20  ate_z (Zobj, .. 
+0001ba70: 2220 2061 7574 6f6d 6174 6963 616c 6c79  "  automatically
+0001ba80: 2064 656c 6563 7420 7468 6520 6261 6420   delect the bad 
+0001ba90: 6672 6571 7565 6e63 6965 732e 2229 0d0a  frequencies.")..
+0001baa0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0001bab0: 2020 2020 2020 6966 2073 7472 2874 6f6c        if str(tol
+0001bac0: 292e 6c6f 7765 7228 2920 3d3d 2027 6175  ).lower() == 'au
+0001bad0: 746f 273a 200d 0a20 2020 2020 2020 2020  to': ..         
+0001bae0: 2020 2074 6f6c 203d 2e35 200d 0a20 2020     tol =.5 ..   
+0001baf0: 0d0a 2020 2020 2020 2020 2320 6d61 6b65  ..        # make
+0001bb00: 2061 2063 6f70 7920 6f66 2065 6469 6f62   a copy of ediob
+0001bb10: 6a73 2020 0d0a 2020 2020 2020 2020 6564  js  ..        ed
+0001bb20: 694f 626a 7320 3d20 6e70 2e61 7272 6179  iObjs = np.array
+0001bb30: 2820 7365 6c66 2e65 6469 4f62 6a73 5f2c  ( self.ediObjs_,
+0001bb40: 2064 7479 7065 203d 6f62 6a65 6374 2920   dtype =object) 
+0001bb50: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0001bb60: 2020 2020 6966 2074 6f6c 2069 7320 6e6f      if tol is no
+0001bb70: 7420 4e6f 6e65 3a20 0d0a 2020 2020 2020  t None: ..      
+0001bb80: 2020 2020 2020 5f20 2c20 696e 6465 785f        _ , index_
+0001bb90: 6672 6571 203d 2073 656c 662e 7163 2028  freq = self.qc (
+0001bba0: 746f 6c20 3d20 746f 6c20 2920 0d0a 2020  tol = tol ) ..  
+0001bbb0: 2020 2020 2020 2020 2020 6672 6571 7320            freqs 
+0001bbc0: 3d20 7365 6c66 2e66 7265 7173 5f20 5b20  = self.freqs_ [ 
+0001bbd0: 696e 6465 785f 6672 6571 205d 0d0a 0d0a  index_freq ]....
+0001bbe0: 2020 2020 2020 2020 6966 2066 7265 7173          if freqs
+0001bbf0: 2069 7320 6e6f 7420 4e6f 6e65 3a20 0d0a   is not None: ..
+0001bc00: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0001bc10: 735f 6974 6572 6162 6c65 2866 7265 7173  s_iterable(freqs
+0001bc20: 2c20 6578 636c 7564 655f 7374 7269 6e67  , exclude_string
+0001bc30: 3d54 7275 6529 3a20 0d0a 2020 2020 2020  =True): ..      
+0001bc40: 2020 2020 2020 2020 2020 2320 6669 6e64            # find
+0001bc50: 2074 6865 2063 6c6f 7365 7374 2066 7265   the closest fre
+0001bc60: 7175 656e 6379 2074 6861 7420 6d61 7463  quency that matc
+0001bc70: 6820 7468 6520 0d0a 2020 2020 2020 2020  h the ..        
+0001bc80: 2020 2020 2020 2020 2320 6672 6571 7565          # freque
+0001bc90: 6e63 7920 696e 2074 6865 2063 6f6d 706c  ncy in the compl
+0001bca0: 6574 6520 6672 6571 200d 0a20 2020 2020  ete freq ..     
+0001bcb0: 2020 2020 2020 2020 2020 2066 7265 7173             freqs
+0001bcc0: 203d 2066 696e 645f 636c 6f73 6573 7420   = find_closest 
+0001bcd0: 2873 656c 662e 6672 6571 735f 2c20 6672  (self.freqs_, fr
+0001bce0: 6571 7320 290d 0a20 2020 2020 2020 2020  eqs )..         
+0001bcf0: 2020 200d 0a20 2020 2020 2020 2023 2072     ..        # r
+0001bd00: 616e 646f 6d6c 7920 7365 6c65 6374 2066  andomly select f
+0001bd10: 7265 7175 656e 6379 200d 0a20 2020 2020  requency ..     
+0001bd20: 2020 2066 7265 7173 203d 2072 616e 646f     freqs = rando
+0001bd30: 6d5f 7365 6c65 6374 6f72 2028 7365 6c66  m_selector (self
+0001bd40: 2e66 7265 7173 5f20 2c20 7661 6c75 6520  .freqs_ , value 
+0001bd50: 3d20 6672 6571 7329 200d 0a20 2020 2020  = freqs) ..     
+0001bd60: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0001bd70: 2023 2070 7574 2062 6163 6b20 6672 6571   # put back freq
+0001bd80: 7565 6e63 7920 6672 6f6d 2068 6967 6865  uency from highe
+0001bd90: 7374 2074 6f20 6c6f 7765 7374 200d 0a20  st to lowest .. 
+0001bda0: 2020 2020 2020 2023 2066 6f72 2063 6f6e         # for con
+0001bdb0: 7369 7374 656e 6379 200d 0a20 2020 2020  sistency ..     
+0001bdc0: 2020 2066 7265 7173 203d 206e 702e 736f     freqs = np.so
+0001bdd0: 7274 2028 6672 6571 7320 295b 3a3a 2d31  rt (freqs )[::-1
+0001bde0: 205d 200d 0a20 2020 2020 2020 0d0a 2020   ] ..       ..  
+0001bdf0: 2020 2020 2020 2369 6620 7365 6c66 2e76        #if self.v
+0001be00: 6572 626f 7365 3a20 0d0a 2020 2020 2020  erbose: ..      
+0001be10: 2020 6c69 7374 696e 675f 6974 656d 735f    listing_items_
+0001be20: 666f 726d 6174 2866 7265 7173 202c 6265  format(freqs ,be
+0001be30: 6769 6e74 6578 743d 2022 4672 6571 7565  gintext= "Freque
+0001be40: 6e63 6965 7322 202c 200d 0a20 2020 2020  ncies" , ..     
+0001be50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be60: 2020 2020 2020 2020 656e 6474 6578 743d          endtext=
+0001be70: 2248 7a20 6861 7665 2062 6565 6e20 6472  "Hz have been dr
+0001be80: 6f70 7065 642e 222c 200d 0a20 2020 2020  opped.", ..     
+0001be90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bea0: 2020 2020 2020 2020 696e 6c69 6e65 203d          inline =
+0001beb0: 5472 7565 202c 2076 6572 626f 7365 203d  True , verbose =
+0001bec0: 7365 6c66 2e76 6572 626f 7365 200d 0a20  self.verbose .. 
+0001bed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bee0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+0001bef0: 2020 2020 2020 2023 2075 7365 206d 6173         # use mas
+0001bf00: 6b20 746f 2073 6574 2061 206e 6577 2063  k to set a new c
+0001bf10: 6f6c 6c65 6374 696f 6e20 6f66 205a 200d  ollection of Z .
+0001bf20: 0a20 2020 2020 2020 205a 6f62 6a20 3d20  .        Zobj = 
+0001bf30: 5b5d 0d0a 2020 2020 2020 2020 666f 7220  []..        for 
+0001bf40: 6b6b 202c 2065 6469 6f20 2069 6e20 656e  kk , edio  in en
+0001bf50: 756d 6572 6174 6520 2865 6469 4f62 6a73  umerate (ediObjs
+0001bf60: 2029 3a20 0d0a 2020 2020 2020 2020 2020   ): ..          
+0001bf70: 2020 6d61 736b 2020 3d20 6e70 2e69 7369    mask  = np.isi
+0001bf80: 6e20 2820 6564 696f 2e5a 2e5f 6672 6571  n ( edio.Z._freq
+0001bf90: 2c20 2066 7265 7173 290d 0a20 2020 2020  ,  freqs)..     
+0001bfa0: 2020 2020 2020 2023 206d 6173 6b20 3d20         # mask = 
+0001bfb0: 6e70 2e6f 6e65 7320 2820 6c65 6e28 2065  np.ones ( len( e
+0001bfc0: 6469 6f2e 5a2e 5f66 7265 7129 2c20 6474  dio.Z._freq), dt
+0001bfd0: 7970 6520 3d20 626f 6f6c 2029 200d 0a20  ype = bool ) .. 
+0001bfe0: 2020 2020 2020 2020 2020 2023 206d 6173             # mas
+0001bff0: 6b20 5b20 755f 6672 6571 735d 203d 2046  k [ u_freqs] = F
+0001c000: 616c 7365 200d 0a20 2020 2020 2020 2020  alse ..         
+0001c010: 2020 207a 5f6e 6577 2020 3d20 6564 696f     z_new  = edio
+0001c020: 2e5a 2e5f 7a20 5b7e 6d61 736b 202c 203a  .Z._z [~mask , :
+0001c030: 2c20 3a5d 2020 0d0a 2020 2020 2020 2020  , :]  ..        
+0001c040: 2020 2020 2320 7369 6d69 6c61 7220 746f      # similar to
+0001c050: 206e 702e 6465 6c65 7465 2028 6564 696f   np.delete (edio
+0001c060: 2e5a 2e5f 7a20 2c20 755f 6672 6571 732c  .Z._z , u_freqs,
+0001c070: 2061 7869 7320 3d30 2029 0d0a 2020 2020   axis =0 )..    
+0001c080: 2020 2020 2020 2020 7a5f 6572 725f 6e65          z_err_ne
+0001c090: 7720 203d 2065 6469 6f2e 5a2e 5f7a 5f65  w  = edio.Z._z_e
+0001c0a0: 7272 205b 7e6d 6173 6b20 2c20 3a2c 203a  rr [~mask , :, :
+0001c0b0: 5d20 0d0a 2020 2020 2020 2020 2020 2020  ] ..            
+0001c0c0: 6e65 775f 6672 6571 203d 2065 6469 6f2e  new_freq = edio.
+0001c0d0: 5a2e 5f66 7265 715b 207e 6d61 736b 205d  Z._freq[ ~mask ]
+0001c0e0: 200d 0a20 2020 2020 2020 2020 2020 200d   ..            .
+0001c0f0: 0a20 2020 2020 2020 2020 2020 205a 203d  .            Z =
+0001c100: 454d 7a20 280d 0a20 2020 2020 2020 2020  EMz (..         
+0001c110: 2020 2020 2020 207a 5f61 7272 6179 3d20         z_array= 
+0001c120: 7a5f 6e65 7720 2c20 7a5f 6572 725f 6172  z_new , z_err_ar
+0001c130: 7261 793d 207a 5f65 7272 5f6e 6577 202c  ray= z_err_new ,
+0001c140: 2066 7265 7120 3d20 6e65 775f 6672 6571   freq = new_freq
+0001c150: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001c160: 2020 2920 0d0a 2020 2020 2020 2020 2020    ) ..          
+0001c170: 2020 5a6f 626a 2e61 7070 656e 6428 5a20    Zobj.append(Z 
+0001c180: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
+0001c190: 0a20 2020 2020 2020 2069 6620 696e 7465  .        if inte
+0001c1a0: 7270 6f6c 6174 653a 0d0a 2020 2020 2020  rpolate:..      
+0001c1b0: 2020 2020 2020 5a6f 626a 203d 2073 656c        Zobj = sel
+0001c1c0: 662e 696e 7465 7270 6f6c 6174 655f 7a20  f.interpolate_z 
+0001c1d0: 285a 6f62 6a2c 200d 0a20 2020 2020 2020  (Zobj, ..       
 0001c1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c200: 2020 2020 2020 726f 7461 7465 203d 2072        rotate = r
-0001c210: 6f74 6174 650d 0a20 2020 2020 2020 2020  otate..         
+0001c200: 726f 7461 7465 203d 2072 6f74 6174 650d  rotate = rotate.
+0001c210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0001c220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c230: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-0001c240: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-0001c250: 2020 2069 6620 6578 706f 7274 3a20 0d0a     if export: ..
-0001c260: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001c270: 2e65 7870 6f72 7465 6469 7328 6564 694f  .exportedis(ediO
-0001c280: 626a 733d 2065 6469 4f62 6a73 2c20 6e65  bjs= ediObjs, ne
-0001c290: 775f 5a3d 5a6f 626a 2c20 0d0a 2020 2020  w_Z=Zobj, ..    
+0001c230: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+0001c240: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
+0001c250: 6578 706f 7274 3a20 0d0a 2020 2020 2020  export: ..      
+0001c260: 2020 2020 2020 7365 6c66 2e65 7870 6f72        self.expor
+0001c270: 7465 6469 7328 6564 694f 626a 733d 2065  tedis(ediObjs= e
+0001c280: 6469 4f62 6a73 2c20 6e65 775f 5a3d 5a6f  diObjs, new_Z=Zo
+0001c290: 626a 2c20 0d0a 2020 2020 2020 2020 2020  bj, ..          
 0001c2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2b0: 2020 2020 2020 2020 2a2a 6b77 7329 0d0a          **kws)..
-0001c2c0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0001c2d0: 205a 6f62 6a0d 0a20 2020 200d 0a63 6c61   Zobj..    ..cla
-0001c2e0: 7373 205a 4328 454d 293a 200d 0a20 2020  ss ZC(EM): ..   
-0001c2f0: 2022 2222 496d 7065 6461 6e63 6520 7465   """Impedance te
-0001c300: 6e73 6f72 206d 756c 7469 706c 6520 4544  nsor multiple ED
-0001c310: 4920 636f 7272 6563 7469 6f6e 2063 6c61  I correction cla
-0001c320: 7373 2e20 0d0a 2020 2020 0d0a 2020 2020  ss. ..    ..    
-0001c330: 4170 706c 6965 6420 6669 6c74 6572 7320  Applied filters 
-0001c340: 696e 2061 2063 6f6c 6c65 6374 696f 6e73  in a collections
-0001c350: 206f 6620 3a74 6572 6d3a 6045 4449 6020   of :term:`EDI` 
-0001c360: 6f62 6a65 6374 732e 200d 0a20 2020 200d  objects. ..    .
-0001c370: 0a20 2020 202e 2e20 7665 7273 696f 6e61  .    .. versiona
-0001c380: 6464 6564 3a3a 2076 302e 322e 3020 0d0a  dded:: v0.2.0 ..
-0001c390: 2020 2020 0d0a 2020 2020 5061 7261 6d65      ..    Parame
-0001c3a0: 7465 7273 200d 0a20 2020 202d 2d2d 2d2d  ters ..    -----
-0001c3b0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 200d 0a20  -------..    .. 
-0001c3c0: 2020 2064 6174 613a 2050 6174 682d 6c69     data: Path-li
-0001c3d0: 6b65 206f 626a 6563 7420 6f72 206c 6973  ke object or lis
-0001c3e0: 7420 206f 6620 203a 636c 6173 733a 7761  t  of  :class:wa
-0001c3f0: 7465 782e 6564 692e 4564 6960 206f 7220  tex.edi.Edi` or 
-0001c400: 5c0d 0a20 2020 2020 2020 2060 7079 6373  \..        `pycs
-0001c410: 616d 742e 636f 7265 2e65 6469 2e45 6469  amt.core.edi.Edi
-0001c420: 6020 6f62 6a65 6374 7320 0d0a 2020 2020  ` objects ..    
-0001c430: 2020 2020 436f 6c6c 6563 7469 6f6e 7320      Collections 
-0001c440: 6f66 2045 4449 2d6f 626a 6563 7473 200d  of EDI-objects .
-0001c450: 0a0d 0a20 2020 2077 696e 646f 775f 7369  ...    window_si
-0001c460: 7a65 203a 2069 6e74 0d0a 2020 2020 2020  ze : int..      
-0001c470: 2020 7468 6520 6c65 6e67 7468 206f 6620    the length of 
-0001c480: 7468 6520 7769 6e64 6f77 2e20 4d75 7374  the window. Must
-0001c490: 2062 6520 6772 6561 7465 7220 7468 616e   be greater than
-0001c4a0: 2031 2061 6e64 2070 7265 6665 7261 626c   1 and preferabl
-0001c4b0: 790d 0a20 2020 2020 2020 2061 6e20 6f64  y..        an od
-0001c4c0: 6420 696e 7465 6765 7220 6e75 6d62 6572  d integer number
-0001c4d0: 2e20 4465 6661 756c 7420 6973 2060 6035  . Default is ``5
-0001c4e0: 6060 0d0a 2020 2020 2020 2020 0d0a 2020  ``..        ..  
-0001c4f0: 2020 6320 3a20 696e 742c 2064 6566 6175    c : int, defau
-0001c500: 6c74 3d32 200d 0a20 2020 2020 2020 2041  lt=2 ..        A
-0001c510: 2077 696e 646f 772d 7769 6474 6820 6578   window-width ex
-0001c520: 7061 6e73 696f 6e20 6661 6374 6f72 2074  pansion factor t
-0001c530: 6861 7420 6d75 7374 2062 6520 696e 7075  hat must be inpu
-0001c540: 7420 746f 2074 6865 2066 696c 7465 7220  t to the filter 
-0001c550: 0d0a 2020 2020 2020 2020 6164 6170 7461  ..        adapta
-0001c560: 7469 6f6e 2070 726f 6365 7373 2074 6f20  tion process to 
-0001c570: 636f 6e74 726f 6c20 7468 6520 726f 6c6c  control the roll
-0001c580: 2d6f 6666 2063 6861 7261 6374 6572 6973  -off characteris
-0001c590: 7469 6373 0d0a 2020 2020 2020 2020 6f66  tics..        of
-0001c5a0: 2074 6865 2061 7070 6c69 6564 2048 616e   the applied Han
-0001c5b0: 6e69 6e67 2077 696e 646f 772e 2049 7420  ning window. It 
-0001c5c0: 6973 2072 6563 6f6d 6d65 6e64 6564 2074  is recommended t
-0001c5d0: 6f20 7365 6c65 6374 2060 6360 200d 0a20  o select `c` .. 
-0001c5e0: 2020 2020 2020 2062 6574 7765 656e 2060         between `
-0001c5f0: 6031 6060 2020 616e 6420 6060 3460 6020  `1``  and ``4`` 
-0001c600: 5b31 5d5f 2e20 0d0a 0d0a 2020 2020 5265  [1]_. ....    Re
-0001c610: 6665 7265 6e63 6573 200d 0a20 2020 202d  ferences ..    -
-0001c620: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-0001c630: 2e2e 205b 315d 2054 6f72 7265 732d 5665  .. [1] Torres-Ve
-0001c640: 7264 696e 2061 6e64 2042 6f73 7469 636b  rdin and Bostick
-0001c650: 2c20 3139 3932 2c20 2050 7269 6e63 6970  , 1992,  Princip
-0001c660: 6c65 7320 6f66 2073 7061 7469 616c 2073  les of spatial s
-0001c670: 7572 6661 6365 200d 0a20 2020 2020 2020  urface ..       
-0001c680: 2020 2020 656c 6563 7472 6963 2066 6965      electric fie
-0001c690: 6c64 2066 696c 7465 7269 6e67 2069 6e20  ld filtering in 
-0001c6a0: 6d61 676e 6574 6f74 656c 6c75 7269 6373  magnetotellurics
-0001c6b0: 3a20 656c 6563 7472 6f6d 6167 6e65 7469  : electromagneti
-0001c6c0: 6320 6172 7261 7920 0d0a 2020 2020 2020  c array ..      
-0001c6d0: 2020 2020 2070 726f 6669 6c69 6e67 2845       profiling(E
-0001c6e0: 4d41 5029 2c20 4765 6f70 6879 7369 6373  MAP), Geophysics
-0001c6f0: 2c20 7635 372c 2070 3630 332d 3632 322e  , v57, p603-622.
-0001c700: 6874 7470 733a 2f2f 646f 692e 6f72 672f  https://doi.org/
-0001c710: 3130 2e31 3139 302f 312e 3234 3030 3632  10.1190/1.240062
-0001c720: 350d 0a20 2020 2020 2020 2020 2020 0d0a  5..           ..
-0001c730: 2020 2020 4578 616d 706c 6573 200d 0a20      Examples .. 
-0001c740: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0001c750: 2020 203e 3e3e 2069 6d70 6f72 7420 7761     >>> import wa
-0001c760: 7465 780d 0a20 2020 203e 3e3e 2066 726f  tex..    >>> fro
-0001c770: 6d20 7761 7465 782e 6d65 7468 6f64 7320  m watex.methods 
-0001c780: 696d 706f 7274 205a 4320 0d0a 2020 2020  import ZC ..    
-0001c790: 3e3e 3e20 6564 695f 7361 6d70 6c65 203d  >>> edi_sample =
-0001c7a0: 2077 6174 6578 2e66 6574 6368 5f64 6174   watex.fetch_dat
-0001c7b0: 6120 2827 6564 6973 272c 2073 616d 706c  a ('edis', sampl
-0001c7c0: 6573 203d 3137 2c20 7265 7475 726e 5f64  es =17, return_d
-0001c7d0: 6174 6120 3d54 7275 6529 200d 0a20 2020  ata =True) ..   
-0001c7e0: 203e 3e3e 207a 6f20 3d20 5a43 2028 292e   >>> zo = ZC ().
-0001c7f0: 6669 7428 6564 695f 7361 6d70 6c65 2920  fit(edi_sample) 
-0001c800: 0d0a 2020 2020 3e3e 3e20 7a6f 2e65 6469  ..    >>> zo.edi
-0001c810: 4f62 6a73 5f5b 305d 2e5a 2e72 6573 6973  Objs_[0].Z.resis
-0001c820: 7469 7669 7479 5b3a 2c20 302c 2031 5d5b  tivity[:, 0, 1][
-0001c830: 3a31 305d 2023 2066 6f72 2078 7920 636f  :10] # for xy co
-0001c840: 6d70 6f6e 656e 7473 200d 0a20 2020 2061  mponents ..    a
-0001c850: 7272 6179 285b 2034 3237 2e34 3336 3930  rray([ 427.43690
-0001c860: 3430 312c 2020 3532 342e 3837 3339 3131  401,  524.873911
-0001c870: 3432 2c20 2037 3332 2e38 3534 3735 3431  42,  732.8547541
-0001c880: 392c 2031 3535 342e 3331 3839 3337 3120  9, 1554.3189371 
-0001c890: 2c0d 0a20 2020 2020 2020 2020 2020 3330  ,..           30
-0001c8a0: 3738 2e38 3736 3231 3634 392c 2031 3535  78.87621649, 155
-0001c8b0: 302e 3632 3638 3030 3933 2c20 2034 3832  0.62680093,  482
-0001c8c0: 2e36 3437 3039 3434 332c 2020 3630 352e  .64709443,  605.
-0001c8d0: 3331 3533 3638 3720 2c0d 0a20 2020 2020  3153687 ,..     
-0001c8e0: 2020 2020 2020 2034 3939 2e34 3931 3931         499.49191
-0001c8f0: 3933 362c 2020 3436 382e 3838 3639 3238  936,  468.886928
-0001c900: 3739 5d29 0d0a 2020 2020 3e3e 3e20 7a73  79])..    >>> zs
-0001c910: 7320 3d20 7a6f 2e72 656d 6f76 655f 7374  s = zo.remove_st
-0001c920: 6174 6963 5f73 6869 6674 2873 735f 6678  atic_shift(ss_fx
-0001c930: 203d 302e 3720 2c20 7373 5f66 7920 3d30   =0.7 , ss_fy =0
-0001c940: 2e38 3520 290d 0a20 2020 203e 3e3e 207a  .85 )..    >>> z
-0001c950: 7373 5b30 5d2e 7265 7369 7374 6976 6974  ss[0].resistivit
-0001c960: 795b 3a2c 2030 2c20 315d 5b3a 3130 5d20  y[:, 0, 1][:10] 
-0001c970: 2320 636f 7272 6563 7465 6420 7879 2063  # corrected xy c
-0001c980: 6f6d 706f 6e65 6e74 7320 0d0a 2020 2020  omponents ..    
-0001c990: 6172 7261 7928 5b20 3237 382e 3936 3339  array([ 278.9639
-0001c9a0: 3532 3633 2c20 2033 3139 2e31 3131 3837  5263,  319.11187
-0001c9b0: 3935 392c 2020 3336 362e 3433 3137 3032  959,  366.431702
-0001c9c0: 3331 2c20 2036 3732 2e32 3434 3436 3239  31,  672.2444629
-0001c9d0: 352c 0d0a 2020 2020 2020 2020 2020 2031  5,..           1
-0001c9e0: 3334 342e 3230 3132 3034 3837 2c20 2036  344.20120487,  6
-0001c9f0: 3931 2e34 3932 3730 3638 382c 2020 3236  91.49270688,  26
-0001ca00: 302e 3235 3632 3539 3936 2c20 2033 3630  0.25625996,  360
-0001ca10: 2e30 3234 3532 3439 382c 0d0a 2020 2020  .02452498,..    
-0001ca20: 2020 2020 2020 2020 3330 352e 3937 3338          305.9738
-0001ca30: 3135 3837 2c20 2032 3733 2e34 3632 3531  1587,  273.46251
-0001ca40: 3936 315d 290d 0a20 2020 2022 2222 0d0a  961])..    """..
-0001ca50: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-0001ca60: 280d 0a20 2020 2020 2020 2073 656c 662c  (..        self,
-0001ca70: 200d 0a20 2020 2020 2020 2077 696e 646f   ..        windo
-0001ca80: 775f 7369 7a65 3a69 6e74 203d 352c 200d  w_size:int =5, .
-0001ca90: 0a20 2020 2020 2020 2063 3a20 696e 7420  .        c: int 
-0001caa0: 3d32 2c20 0d0a 2020 2020 2020 2020 2a2a  =2, ..        **
-0001cab0: 6b77 730d 0a20 2020 2020 2020 2029 3a20  kws..        ): 
-0001cac0: 0d0a 2020 2020 2020 2020 7375 7065 7228  ..        super(
-0001cad0: 292e 5f5f 696e 6974 5f5f 282a 2a6b 7773  ).__init__(**kws
-0001cae0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-0001caf0: 2020 2020 2073 656c 662e 7769 6e64 6f77       self.window
-0001cb00: 5f73 697a 653d 7769 6e64 6f77 5f73 697a  _size=window_siz
-0001cb10: 6520 0d0a 2020 2020 2020 2020 7365 6c66  e ..        self
-0001cb20: 2e63 3d63 200d 0a0d 0a20 2020 200d 0a20  .c=c ....    .. 
-0001cb30: 2020 2040 5f7a 7570 6461 7465 2028 6f70     @_zupdate (op
-0001cb40: 7469 6f6e 203d 276e 6f6e 6527 290d 0a20  tion ='none').. 
-0001cb50: 2020 2064 6566 2072 656d 6f76 655f 7373     def remove_ss
-0001cb60: 5f65 6d61 7020 280d 0a20 2020 2020 2020  _emap (..       
-0001cb70: 2020 2020 2073 656c 662c 200d 0a20 2020       self, ..   
-0001cb80: 2020 2020 2020 2020 2066 6c74 723a 7374           fltr:st
-0001cb90: 7220 3d27 616d 6127 2c20 0d0a 2020 2020  r ='ama', ..    
-0001cba0: 2020 2020 2020 2020 6f75 743a 626f 6f6c          out:bool
-0001cbb0: 3d20 4661 6c73 652c 200d 0a20 2020 2020  = False, ..     
-0001cbc0: 2020 2020 2020 2073 6d6f 6f74 683a 626f         smooth:bo
-0001cbd0: 6f6c 3d20 5472 7565 2c20 0d0a 2020 2020  ol= True, ..    
-0001cbe0: 2020 2020 2020 2020 6472 6f70 5f6f 7574          drop_out
-0001cbf0: 6c69 6572 733a 626f 6f6c 3d54 7275 652c  liers:bool=True,
-0001cc00: 200d 0a20 2020 2020 2020 2020 2020 202a   ..            *
-0001cc10: 2a6b 7773 0d0a 2020 2020 2020 2020 2020  *kws..          
-0001cc20: 2020 293a 200d 0a20 2020 2020 2020 2022    ): ..        "
-0001cc30: 2222 0d0a 2020 2020 2020 2020 4669 6c74  ""..        Filt
-0001cc40: 6572 205a 2074 6f20 7265 6d6f 7665 2074  er Z to remove t
-0001cc50: 6865 2073 7461 7469 6320 7363 6869 6674  he static schift
-0001cc60: 2075 7369 6e67 2074 6865 2045 4d41 5020   using the EMAP 
-0001cc70: 6d6f 7669 6e67 2061 7665 7261 6765 200d  moving average .
-0001cc80: 0a20 2020 2020 2020 2066 696c 7465 7273  .        filters
-0001cc90: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
-0001cca0: 2020 2020 2020 5468 7265 6520 6176 6169        Three avai
-0001ccb0: 6c61 626c 6520 6669 6c74 6572 733a 200d  lable filters: .
-0001ccc0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-0001ccd0: 2020 2020 2020 2020 2020 202d 2027 616d             - 'am
-0001cce0: 6127 3a20 4164 6170 7461 7469 7665 206d  a': Adaptative m
-0001ccf0: 6f76 696e 6720 6176 6572 6167 6520 0d0a  oving average ..
-0001cd00: 2020 2020 2020 2020 2020 2020 2d20 2774              - 't
-0001cd10: 6d61 273a 2054 7269 6d6d 696e 6720 6d6f  ma': Trimming mo
-0001cd20: 7669 6e67 2d61 7665 7261 6765 200d 0a20  ving-average .. 
-0001cd30: 2020 2020 2020 2020 2020 202d 2027 666c             - 'fl
-0001cd40: 6d61 273a 2046 6978 6564 2d6c 656e 6774  ma': Fixed-lengt
-0001cd50: 6820 6469 706f 6c65 206d 6f76 696e 6720  h dipole moving 
-0001cd60: 6176 6572 6167 6520 0d0a 2020 2020 2020  average ..      
-0001cd70: 2020 0d0a 2020 2020 2020 2020 436f 756c    ..        Coul
-0001cd80: 6420 6578 706f 7274 206e 6577 2045 6469  d export new Edi
-0001cd90: 2069 6620 7468 6520 6b65 7977 6f72 6420   if the keyword 
-0001cda0: 6172 6775 6d65 6e74 2060 6578 706f 7274  argument `export
-0001cdb0: 6020 6973 2073 6574 200d 0a20 2020 2020  ` is set ..     
-0001cdc0: 2020 2074 6f20 6060 5472 7565 6060 0d0a     to ``True``..
-0001cdd0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001cde0: 2020 5061 7261 6d65 7465 7273 200d 0a20    Parameters .. 
-0001cdf0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0001ce00: 2d2d 2d0d 0a20 2020 2020 2020 2066 6c74  ---..        flt
-0001ce10: 723a 2073 7472 202c 2064 6566 6175 6c74  r: str , default
-0001ce20: 3d27 616d 6127 0d0a 2020 2020 2020 2020  ='ama'..        
-0001ce30: 2020 2054 7970 6520 6f66 2066 696c 7465     Type of filte
-0001ce40: 7220 746f 2061 7070 6c79 2e20 4465 6661  r to apply. Defa
-0001ce50: 756c 7420 6973 2041 6461 7074 6174 6976  ult is Adaptativ
-0001ce60: 6520 6d6f 7669 6e67 2d61 7665 7261 6765  e moving-average
-0001ce70: 206f 6620 0d0a 2020 2020 2020 2020 2020   of ..          
-0001ce80: 2054 6f72 7265 732d 7665 7264 696e 205b   Torres-verdin [
-0001ce90: 315d 5f2e 2043 616e 2062 6520 5b27 616d  1]_. Can be ['am
-0001cea0: 6127 7c27 746d 6127 7c27 666c 6d61 275d  a'|'tma'|'flma']
-0001ceb0: 0d0a 200d 0a20 2020 2020 2020 2020 2020  .. ..           
-0001cec0: 5468 6520 414d 4120 6669 6c74 6572 2065  The AMA filter e
-0001ced0: 7374 696d 6174 6573 2073 7461 7469 632d  stimates static-
-0001cee0: 636f 7272 6563 7465 6420 6170 7061 7265  corrected appare
-0001cef0: 6e74 2072 6573 6973 7469 7669 7469 6573  nt resistivities
-0001cf00: 2061 7420 0d0a 2020 2020 2020 2020 2020   at ..          
-0001cf10: 2061 2073 696e 676c 6520 7265 6665 7265   a single refere
-0001cf20: 6e63 6520 6672 6571 7565 6e63 7920 6279  nce frequency by
-0001cf30: 2063 616c 6375 6c61 7469 6e67 2061 2070   calculating a p
-0001cf40: 726f 6669 6c65 206f 6620 6176 6572 6167  rofile of averag
-0001cf50: 6520 0d0a 2020 2020 2020 2020 2020 2069  e ..           i
-0001cf60: 6d70 6564 616e 6365 7320 2061 6c6f 6e67  mpedances  along
-0001cf70: 2074 6865 206c 656e 6774 6820 6f66 2074   the length of t
-0001cf80: 6865 206c 696e 652e 2053 6f75 6e64 696e  he line. Soundin
-0001cf90: 6720 6375 7276 6573 2061 7265 200d 0a20  g curves are .. 
-0001cfa0: 2020 2020 2020 2020 2020 7468 656e 2073            then s
-0001cfb0: 6869 6674 6564 2073 6f20 7468 6174 2074  hifted so that t
-0001cfc0: 6865 7920 696e 7465 7273 6563 7420 7468  hey intersect th
-0001cfd0: 6520 6176 6572 6167 6564 2070 726f 6669  e averaged profi
-0001cfe0: 6c65 2e20 0d0a 2020 2020 2020 2020 2020  le. ..          
-0001cff0: 200d 0a20 2020 2020 2020 206f 7574 3a20   ..        out: 
-0001d000: 626f 6f6c 202c 2064 6566 6175 6c74 203d  bool , default =
-0001d010: 4661 6c73 652c 200d 0a20 2020 2020 2020  False, ..       
-0001d020: 2020 2020 4f75 7470 7574 206e 6577 2066      Output new f
-0001d030: 696c 7465 7265 6420 4544 492e 204f 7468  iltered EDI. Oth
-0001d040: 6572 7769 7365 2072 6574 7572 6e20 5a20  erwise return Z 
-0001d050: 636f 6c6c 6563 7469 6f6e 7320 6f62 6a65  collections obje
-0001d060: 6374 7320 0d0a 2020 2020 2020 2020 2020  cts ..          
-0001d070: 206f 6620 636f 7272 6563 7465 6420 5465   of corrected Te
-0001d080: 6e73 6f72 732e 200d 0a20 2020 2020 2020  nsors. ..       
-0001d090: 2020 2020 0d0a 2020 2020 2020 2020 736d      ..        sm
-0001d0a0: 6f6f 7468 3a20 626f 6f6c 2c20 6465 6661  ooth: bool, defa
-0001d0b0: 756c 743d 4661 6c73 652c 200d 0a20 2020  ult=False, ..   
-0001d0c0: 2020 2020 2020 2020 536d 6f6f 7468 2074          Smooth t
-0001d0d0: 6865 2074 656e 736f 7220 6461 7461 2061  he tensor data a
-0001d0e0: 6c6f 6e67 2074 6865 2066 7265 7175 656e  long the frequen
-0001d0f0: 6369 6573 2e20 0d0a 2020 2020 2020 2020  cies. ..        
-0001d100: 0d0a 2020 2020 2020 2020 2e2e 2076 6572  ..        .. ver
-0001d110: 7369 6f6e 6164 6465 643a 2030 2e32 2e31  sionadded: 0.2.1
-0001d120: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-0001d130: 2020 2020 2064 726f 705f 6f75 746c 6965       drop_outlie
-0001d140: 7273 3a20 626f 6f6c 2c20 6465 6661 756c  rs: bool, defaul
-0001d150: 743d 5472 7565 200d 0a20 2020 2020 2020  t=True ..       
-0001d160: 2020 2020 5375 7070 7265 7373 206f 7574      Suppress out
-0001d170: 6c69 6572 7320 696e 2074 6865 2064 6174  liers in the dat
-0001d180: 6120 7768 656e 2073 6d6f 6f74 6869 6e67  a when smoothing
-0001d190: 2064 6174 6120 616c 6f6e 6720 0d0a 2020   data along ..  
-0001d1a0: 2020 2020 2020 2020 2074 6865 2066 7265           the fre
-0001d1b0: 7175 656e 6369 6573 2061 7869 732e 204e  quencies axis. N
-0001d1c0: 6f74 6520 7468 6174 2060 6472 6f70 5f6f  ote that `drop_o
-0001d1d0: 7574 6c69 6572 7360 2064 6f65 7320 6e6f  utliers` does no
-0001d1e0: 7420 7461 6b65 200d 0a20 2020 2020 2020  t take ..       
-0001d1f0: 2020 2020 6566 6665 6374 2069 6620 6073      effect if `s
-0001d200: 6d6f 6f74 6860 2069 7320 6060 4661 6c73  mooth` is ``Fals
-0001d210: 6560 602e 200d 0a20 2020 2020 2020 2020  e``. ..         
-0001d220: 2020 0d0a 2020 2020 2020 2020 2e2e 2076    ..        .. v
-0001d230: 6572 7369 6f6e 6164 6465 643a 2030 2e32  ersionadded: 0.2
-0001d240: 2e31 200d 0a20 2020 2020 2020 2020 2020  .1 ..           
-0001d250: 506f 6c69 7368 2074 6865 2074 656e 736f  Polish the tenso
-0001d260: 7220 6461 7461 2061 6c6f 6e67 2074 6865  r data along the
-0001d270: 2066 7265 7175 656e 6379 2061 7869 7320   frequency axis 
-0001d280: 7265 6d6f 7665 206e 6f69 7365 7320 0d0a  remove noises ..
-0001d290: 2020 2020 2020 2020 2020 2061 6e64 2064             and d
-0001d2a0: 6561 6c20 7769 7468 2074 6865 2073 7461  eal with the sta
-0001d2b0: 7469 6320 7368 6966 7420 6566 6665 6374  tic shift effect
-0001d2c0: 2077 6865 6e20 696e 7465 7266 6572 656e   when interferen
-0001d2d0: 6365 7320 6e6f 6973 6573 200d 0a20 2020  ces noises ..   
-0001d2e0: 2020 2020 2020 2020 6172 6520 7374 726f          are stro
-0001d2f0: 6e67 2065 6e6f 7567 682e 200d 0a20 2020  ng enough. ..   
-0001d300: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001d310: 2020 5265 7475 726e 7320 0d0a 2020 2020    Returns ..    
-0001d320: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0d 0a20      ---------.. 
-0001d330: 2020 2020 2020 205a 3a20 6c69 7374 206f         Z: list o
-0001d340: 6620 3a63 6c61 7373 3a60 7761 7465 782e  f :class:`watex.
-0001d350: 6578 7465 726e 616c 732e 7a60 206f 626a  externals.z` obj
-0001d360: 6563 7473 206f 7220 4e6f 6e65 200d 0a20  ects or None .. 
-0001d370: 2020 2020 2020 2020 2020 5265 7475 726e            Return
-0001d380: 2060 604e 6f6e 6560 6020 6279 2064 6566   ``None`` by def
-0001d390: 6175 6c74 2028 7768 656e 2065 7870 6f72  ault (when expor
-0001d3a0: 7420 6973 2073 6574 2074 6f20 6060 4661  t is set to ``Fa
-0001d3b0: 6c73 6560 6029 200d 0a20 2020 2020 2020  lse``) ..       
-0001d3c0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0001d3d0: 0d0a 2020 2020 2020 2020 5265 6665 7265  ..        Refere
-0001d3e0: 6e63 6573 200d 0a20 2020 2020 2020 202d  nces ..        -
-0001d3f0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-0001d400: 2020 2020 2e2e 205b 315d 2054 6f72 7265      .. [1] Torre
-0001d410: 732d 5665 7264 696e 2061 6e64 2042 6f73  s-Verdin and Bos
-0001d420: 7469 636b 2c20 3139 3932 2c20 2050 7269  tick, 1992,  Pri
-0001d430: 6e63 6970 6c65 7320 6f66 2073 7061 7469  nciples of spati
-0001d440: 616c 2073 7572 6661 6365 200d 0a20 2020  al surface ..   
-0001d450: 2020 2020 2020 2020 2020 2020 656c 6563              elec
-0001d460: 7472 6963 2066 6965 6c64 2066 696c 7465  tric field filte
-0001d470: 7269 6e67 2069 6e20 6d61 676e 6574 6f74  ring in magnetot
-0001d480: 656c 6c75 7269 6373 3a20 656c 6563 7472  ellurics: electr
-0001d490: 6f6d 6167 6e65 7469 6320 6172 7261 7920  omagnetic array 
-0001d4a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001d4b0: 2070 726f 6669 6c69 6e67 2845 4d41 5029   profiling(EMAP)
-0001d4c0: 2c20 4765 6f70 6879 7369 6373 2c20 7635  , Geophysics, v5
-0001d4d0: 372c 2070 3630 332d 3632 322e 6874 7470  7, p603-622.http
-0001d4e0: 733a 2f2f 646f 692e 6f72 672f 3130 2e31  s://doi.org/10.1
-0001d4f0: 3139 302f 312e 3234 3030 3632 350d 0a20  190/1.2400625.. 
-0001d500: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
-0001d510: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-0001d520: 200d 0a20 2020 2020 2020 202d 2d2d 2d2d   ..        -----
-0001d530: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7265  ----..        re
-0001d540: 6d6f 7665 5f73 7461 7469 635f 7368 6966  move_static_shif
-0001d550: 743a 200d 0a20 2020 2020 2020 2020 2020  t: ..           
-0001d560: 2052 656d 6f76 6520 7374 6174 6963 2073   Remove static s
-0001d570: 6869 6674 2075 7369 6e67 2074 6865 2073  hift using the s
-0001d580: 7061 7469 616c 2066 696c 7465 7220 6d65  patial filter me
-0001d590: 6469 616e 2061 6e64 2077 7269 7465 200d  dian and write .
-0001d5a0: 0a20 2020 2020 2020 2020 2020 2061 206e  .            a n
-0001d5b0: 6577 2065 6469 6669 6c65 2e20 0d0a 2020  ew edifile. ..  
-0001d5c0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0001d5d0: 2020 2020 4578 616d 706c 6573 200d 0a20      Examples .. 
-0001d5e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0001d5f0: 0d0a 2020 2020 2020 2020 3e3e 3e20 696d  ..        >>> im
-0001d600: 706f 7274 2077 6174 6578 200d 0a20 2020  port watex ..   
-0001d610: 2020 2020 203e 3e3e 2066 726f 6d20 7761       >>> from wa
-0001d620: 7465 782e 6d65 7468 6f64 7320 696d 706f  tex.methods impo
-0001d630: 7274 205a 4320 0d0a 2020 2020 2020 2020  rt ZC ..        
-0001d640: 3e3e 3e20 6564 695f 7361 6d70 6c65 203d  >>> edi_sample =
-0001d650: 2077 6174 6578 2e66 6574 6368 5f64 6174   watex.fetch_dat
-0001d660: 6120 2827 6564 6973 272c 2073 616d 706c  a ('edis', sampl
-0001d670: 6573 203d 3137 202c 2072 6574 7572 6e5f  es =17 , return_
-0001d680: 6461 7461 203d 5472 7565 2029 200d 0a20  data =True ) .. 
-0001d690: 2020 2020 2020 203e 3e3e 207a 6f20 3d20         >>> zo = 
-0001d6a0: 5a43 2028 292e 6669 7428 6564 695f 7361  ZC ().fit(edi_sa
-0001d6b0: 6d70 6c65 290d 0a20 2020 2020 2020 203e  mple)..        >
-0001d6c0: 3e3e 207a 6f2e 6564 694f 626a 735f 5b30  >> zo.ediObjs_[0
-0001d6d0: 5d2e 5a2e 7a5b 3a2c 2030 2c20 315d 5b3a  ].Z.z[:, 0, 1][:
-0001d6e0: 375d 0d0a 2020 2020 2020 2020 6172 7261  7]..        arra
-0001d6f0: 7928 5b31 3030 3032 2e34 3620 2b39 3734  y([10002.46 +974
-0001d700: 372e 3334 6a20 2c20 3131 3637 392e 3434  7.34j , 11679.44
-0001d710: 202b 3837 3134 2e33 3239 6a2c 2031 3538   +8714.329j, 158
-0001d720: 3936 2e34 3520 2b33 3138 362e 3733 376a  96.45 +3186.737j
-0001d730: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0001d740: 2020 3231 3736 332e 3031 202d 3435 3339    21763.01 -4539
-0001d750: 2e34 3035 6a2c 2032 3832 3039 2e33 3620  .405j, 28209.36 
-0001d760: 2d38 3439 342e 3830 386a 2c20 3139 3533  -8494.808j, 1953
-0001d770: 382e 3638 202d 3234 3030 2e38 3434 6a2c  8.68 -2400.844j,
-0001d780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001d790: 2020 3839 3038 2e34 3438 2b35 3235 312e    8908.448+5251.
-0001d7a0: 3135 376a 5d29 0d0a 2020 2020 2020 2020  157j])..        
-0001d7b0: 3e3e 3e20 7a63 203d 207a 6f2e 7265 6d6f  >>> zc = zo.remo
-0001d7c0: 7665 5f73 735f 656d 6170 2829 200d 0a20  ve_ss_emap() .. 
-0001d7d0: 2020 2020 2020 203e 3e3e 207a 635b 305d         >>> zc[0]
-0001d7e0: 2e7a 5b3a 2c20 302c 2031 5d20 5b3a 375d  .z[:, 0, 1] [:7]
-0001d7f0: 0d0a 2020 2020 2020 2020 6172 7261 7928  ..        array(
-0001d800: 5b31 3231 3230 2e30 3833 3230 3830 342b  [12120.08320804+
-0001d810: 3639 3339 2e39 3837 3437 3533 6a20 2c20  6939.9874753j , 
-0001d820: 3133 3033 302e 3931 3436 3236 3036 2b36  13030.91462606+6
-0001d830: 3532 322e 3538 3438 3132 3935 6a2c 0d0a  522.58481295j,..
-0001d840: 2020 2020 2020 2020 2020 2020 2020 2031                 1
-0001d850: 3534 3332 2e30 3230 3631 3234 202b 3439  5432.0206124 +49
-0001d860: 3730 2e34 3238 3036 3238 376a 2c20 3231  70.42806287j, 21
-0001d870: 3839 392e 3630 3934 3232 3434 2b33 3832  899.60942244+382
-0001d880: 362e 3437 3437 3639 3132 6a2c 0d0a 2020  6.47476912j,..  
-0001d890: 2020 2020 2020 2020 2020 2020 2032 3931               291
-0001d8a0: 3039 2e31 3731 3030 3038 352b 3435 3337  09.17100085+4537
-0001d8b0: 2e31 3730 3732 3734 316a 2c20 3139 3235  .17072741j, 1925
-0001d8c0: 322e 3037 3833 3937 3332 2b34 3130 382e  2.07839732+4108.
-0001d8d0: 3731 3537 3839 3433 6a2c 0d0a 2020 2020  71578943j,..    
-0001d8e0: 2020 2020 2020 2020 2020 2020 3934 3733              9473
-0001d8f0: 2e32 3034 3634 3332 362b 3431 3436 2e35  .20464326+4146.5
-0001d900: 3033 3237 3331 356a 5d29 0d0a 2020 2020  0327315j])..    
-0001d910: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-0001d920: 2073 656c 662e 696e 7370 6563 7420 0d0a   self.inspect ..
-0001d930: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001d940: 2020 7020 3d20 5072 6f63 6573 7369 6e67    p = Processing
-0001d950: 286f 7574 203d 277a 2027 2920 0d0a 2020  (out ='z ') ..  
-0001d960: 2020 2020 2020 702e 6564 694f 626a 735f        p.ediObjs_
-0001d970: 203d 2073 656c 662e 6564 694f 626a 735f   = self.ediObjs_
-0001d980: 0d0a 2020 2020 2020 2020 702e 6672 6571  ..        p.freq
-0001d990: 735f 203d 2073 656c 662e 6672 6571 735f  s_ = self.freqs_
-0001d9a0: 0d0a 0d0a 2020 2020 2020 2020 666c 7220  ....        flr 
-0001d9b0: 3d20 7374 7228 666c 7472 292e 6c6f 7765  = str(fltr).lowe
-0001d9c0: 7228 292e 7374 7269 7028 2920 0d0a 2020  r().strip() ..  
-0001d9d0: 2020 2020 2020 6173 7365 7274 2066 6c72        assert flr
-0001d9e0: 2069 6e20 7b22 616d 6122 2c20 2274 6d61   in {"ama", "tma
-0001d9f0: 222c 2022 666c 6d61 227d 2c20 280d 0a20  ", "flma"}, (.. 
-0001da00: 2020 2020 2020 2020 2020 2066 2246 696c             f"Fil
-0001da10: 7465 7220 7b66 6c74 7221 727d 2069 7320  ter {fltr!r} is 
-0001da20: 6e6f 7420 6176 6169 6c61 626c 652e 2045  not available. E
-0001da30: 7870 6563 7422 0d0a 2020 2020 2020 2020  xpect"..        
-0001da40: 2020 2020 2220 6164 6170 7461 7469 7665      " adaptative
-0001da50: 206d 6f76 696e 672d 6176 6572 6167 653a   moving-average:
-0001da60: 2027 616d 6127 2c22 0d0a 2020 2020 2020   'ama',"..      
-0001da70: 2020 2020 2020 2220 7472 696d 6d69 6e67        " trimming
-0001da80: 206d 6f76 696e 672d 6176 6572 6167 653a   moving-average:
-0001da90: 2027 746d 6127 206f 7222 0d0a 2020 2020   'tma' or"..    
-0001daa0: 2020 2020 2020 2020 2220 6669 7865 642d          " fixed-
-0001dab0: 6469 706f 6c65 206c 656e 6774 6820 6d6f  dipole length mo
-0001dac0: 7669 6e67 2d61 7665 7261 6765 3a20 2766  ving-average: 'f
-0001dad0: 6c6d 6127 2220 0d0a 2020 2020 2020 2020  lma'" ..        
-0001dae0: 2020 2020 290d 0a20 2020 2020 2020 2023      )..        #
-0001daf0: 2047 6174 6865 7220 7468 6520 3244 2069   Gather the 2D i
-0001db00: 6e74 6f20 7a20 6f62 6a65 6374 730d 0a20  nto z objects.. 
-0001db10: 2020 2020 2020 207a 6420 3d20 6469 6374         zd = dict
-0001db20: 2028 2920 0d0a 2020 2020 2020 2020 2320   () ..        # 
-0001db30: 636f 7272 6563 7420 616c 6c20 636f 6d70  correct all comp
-0001db40: 6f6e 656e 7473 2069 6620 6170 706c 6963  onents if applic
-0001db50: 6162 6c65 200d 0a20 2020 2020 2020 2066  able ..        f
-0001db60: 6f72 2063 6f6d 7020 696e 2028 2778 7827  or comp in ('xx'
-0001db70: 2c20 2778 7927 2c20 2779 7827 2c20 2779  , 'xy', 'yx', 'y
-0001db80: 7927 293a 200d 0a20 2020 2020 2020 2020  y'): ..         
-0001db90: 2020 2070 2e63 6f6d 706f 6e65 6e74 203d     p.component =
-0001dba0: 2063 6f6d 7020 0d0a 2020 2020 2020 2020   comp ..        
-0001dbb0: 2020 2020 7472 793a 200d 0a20 2020 2020      try: ..     
-0001dbc0: 2020 2020 2020 2020 2020 2069 6620 666c             if fl
-0001dbd0: 723d 3d27 746d 6127 3a20 0d0a 2020 2020  r=='tma': ..    
-0001dbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dbf0: 7a63 203d 2070 2e61 6d61 2028 736d 6f6f  zc = p.ama (smoo
-0001dc00: 7468 203d 2073 6d6f 6f74 6820 2c20 0d0a  th = smooth , ..
+0001c2b0: 2020 2a2a 6b77 7329 0d0a 0d0a 2020 2020    **kws)....    
+0001c2c0: 2020 2020 7265 7475 726e 205a 6f62 6a0d      return Zobj.
+0001c2d0: 0a20 2020 200d 0a63 6c61 7373 205a 4328  .    ..class ZC(
+0001c2e0: 454d 293a 200d 0a20 2020 2022 2222 496d  EM): ..    """Im
+0001c2f0: 7065 6461 6e63 6520 7465 6e73 6f72 206d  pedance tensor m
+0001c300: 756c 7469 706c 6520 4544 4920 636f 7272  ultiple EDI corr
+0001c310: 6563 7469 6f6e 2063 6c61 7373 2e20 0d0a  ection class. ..
+0001c320: 2020 2020 0d0a 2020 2020 4170 706c 6965      ..    Applie
+0001c330: 6420 6669 6c74 6572 7320 696e 2061 2063  d filters in a c
+0001c340: 6f6c 6c65 6374 696f 6e73 206f 6620 3a74  ollections of :t
+0001c350: 6572 6d3a 6045 4449 6020 6f62 6a65 6374  erm:`EDI` object
+0001c360: 732e 200d 0a20 2020 200d 0a20 2020 202e  s. ..    ..    .
+0001c370: 2e20 7665 7273 696f 6e61 6464 6564 3a3a  . versionadded::
+0001c380: 2076 302e 322e 3020 0d0a 2020 2020 0d0a   v0.2.0 ..    ..
+0001c390: 2020 2020 5061 7261 6d65 7465 7273 200d      Parameters .
+0001c3a0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
+0001c3b0: 2d0d 0a20 2020 200d 0a20 2020 2064 6174  -..    ..    dat
+0001c3c0: 613a 2050 6174 682d 6c69 6b65 206f 626a  a: Path-like obj
+0001c3d0: 6563 7420 6f72 206c 6973 7420 206f 6620  ect or list  of 
+0001c3e0: 203a 636c 6173 733a 7761 7465 782e 6564   :class:watex.ed
+0001c3f0: 692e 4564 6960 206f 7220 5c0d 0a20 2020  i.Edi` or \..   
+0001c400: 2020 2020 2060 7079 6373 616d 742e 636f       `pycsamt.co
+0001c410: 7265 2e65 6469 2e45 6469 6020 6f62 6a65  re.edi.Edi` obje
+0001c420: 6374 7320 0d0a 2020 2020 2020 2020 436f  cts ..        Co
+0001c430: 6c6c 6563 7469 6f6e 7320 6f66 2045 4449  llections of EDI
+0001c440: 2d6f 626a 6563 7473 200d 0a0d 0a20 2020  -objects ....   
+0001c450: 2077 696e 646f 775f 7369 7a65 203a 2069   window_size : i
+0001c460: 6e74 0d0a 2020 2020 2020 2020 7468 6520  nt..        the 
+0001c470: 6c65 6e67 7468 206f 6620 7468 6520 7769  length of the wi
+0001c480: 6e64 6f77 2e20 4d75 7374 2062 6520 6772  ndow. Must be gr
+0001c490: 6561 7465 7220 7468 616e 2031 2061 6e64  eater than 1 and
+0001c4a0: 2070 7265 6665 7261 626c 790d 0a20 2020   preferably..   
+0001c4b0: 2020 2020 2061 6e20 6f64 6420 696e 7465       an odd inte
+0001c4c0: 6765 7220 6e75 6d62 6572 2e20 4465 6661  ger number. Defa
+0001c4d0: 756c 7420 6973 2060 6035 6060 0d0a 2020  ult is ``5``..  
+0001c4e0: 2020 2020 2020 0d0a 2020 2020 6320 3a20        ..    c : 
+0001c4f0: 696e 742c 2064 6566 6175 6c74 3d32 200d  int, default=2 .
+0001c500: 0a20 2020 2020 2020 2041 2077 696e 646f  .        A windo
+0001c510: 772d 7769 6474 6820 6578 7061 6e73 696f  w-width expansio
+0001c520: 6e20 6661 6374 6f72 2074 6861 7420 6d75  n factor that mu
+0001c530: 7374 2062 6520 696e 7075 7420 746f 2074  st be input to t
+0001c540: 6865 2066 696c 7465 7220 0d0a 2020 2020  he filter ..    
+0001c550: 2020 2020 6164 6170 7461 7469 6f6e 2070      adaptation p
+0001c560: 726f 6365 7373 2074 6f20 636f 6e74 726f  rocess to contro
+0001c570: 6c20 7468 6520 726f 6c6c 2d6f 6666 2063  l the roll-off c
+0001c580: 6861 7261 6374 6572 6973 7469 6373 0d0a  haracteristics..
+0001c590: 2020 2020 2020 2020 6f66 2074 6865 2061          of the a
+0001c5a0: 7070 6c69 6564 2048 616e 6e69 6e67 2077  pplied Hanning w
+0001c5b0: 696e 646f 772e 2049 7420 6973 2072 6563  indow. It is rec
+0001c5c0: 6f6d 6d65 6e64 6564 2074 6f20 7365 6c65  ommended to sele
+0001c5d0: 6374 2060 6360 200d 0a20 2020 2020 2020  ct `c` ..       
+0001c5e0: 2062 6574 7765 656e 2060 6031 6060 2020   between ``1``  
+0001c5f0: 616e 6420 6060 3460 6020 5b31 5d5f 2e20  and ``4`` [1]_. 
+0001c600: 0d0a 0d0a 2020 2020 5265 6665 7265 6e63  ....    Referenc
+0001c610: 6573 200d 0a20 2020 202d 2d2d 2d2d 2d2d  es ..    -------
+0001c620: 2d2d 2d2d 0d0a 2020 2020 2e2e 205b 315d  ----..    .. [1]
+0001c630: 2054 6f72 7265 732d 5665 7264 696e 2061   Torres-Verdin a
+0001c640: 6e64 2042 6f73 7469 636b 2c20 3139 3932  nd Bostick, 1992
+0001c650: 2c20 2050 7269 6e63 6970 6c65 7320 6f66  ,  Principles of
+0001c660: 2073 7061 7469 616c 2073 7572 6661 6365   spatial surface
+0001c670: 200d 0a20 2020 2020 2020 2020 2020 656c   ..           el
+0001c680: 6563 7472 6963 2066 6965 6c64 2066 696c  ectric field fil
+0001c690: 7465 7269 6e67 2069 6e20 6d61 676e 6574  tering in magnet
+0001c6a0: 6f74 656c 6c75 7269 6373 3a20 656c 6563  otellurics: elec
+0001c6b0: 7472 6f6d 6167 6e65 7469 6320 6172 7261  tromagnetic arra
+0001c6c0: 7920 0d0a 2020 2020 2020 2020 2020 2070  y ..           p
+0001c6d0: 726f 6669 6c69 6e67 2845 4d41 5029 2c20  rofiling(EMAP), 
+0001c6e0: 4765 6f70 6879 7369 6373 2c20 7635 372c  Geophysics, v57,
+0001c6f0: 2070 3630 332d 3632 322e 6874 7470 733a   p603-622.https:
+0001c700: 2f2f 646f 692e 6f72 672f 3130 2e31 3139  //doi.org/10.119
+0001c710: 302f 312e 3234 3030 3632 350d 0a20 2020  0/1.2400625..   
+0001c720: 2020 2020 2020 2020 0d0a 2020 2020 4578          ..    Ex
+0001c730: 616d 706c 6573 200d 0a20 2020 202d 2d2d  amples ..    ---
+0001c740: 2d2d 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e  -------..    >>>
+0001c750: 2069 6d70 6f72 7420 7761 7465 780d 0a20   import watex.. 
+0001c760: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
+0001c770: 782e 6d65 7468 6f64 7320 696d 706f 7274  x.methods import
+0001c780: 205a 4320 0d0a 2020 2020 3e3e 3e20 6564   ZC ..    >>> ed
+0001c790: 695f 7361 6d70 6c65 203d 2077 6174 6578  i_sample = watex
+0001c7a0: 2e66 6574 6368 5f64 6174 6120 2827 6564  .fetch_data ('ed
+0001c7b0: 6973 272c 2073 616d 706c 6573 203d 3137  is', samples =17
+0001c7c0: 2c20 7265 7475 726e 5f64 6174 6120 3d54  , return_data =T
+0001c7d0: 7275 6529 200d 0a20 2020 203e 3e3e 207a  rue) ..    >>> z
+0001c7e0: 6f20 3d20 5a43 2028 292e 6669 7428 6564  o = ZC ().fit(ed
+0001c7f0: 695f 7361 6d70 6c65 2920 0d0a 2020 2020  i_sample) ..    
+0001c800: 3e3e 3e20 7a6f 2e65 6469 4f62 6a73 5f5b  >>> zo.ediObjs_[
+0001c810: 305d 2e5a 2e72 6573 6973 7469 7669 7479  0].Z.resistivity
+0001c820: 5b3a 2c20 302c 2031 5d5b 3a31 305d 2023  [:, 0, 1][:10] #
+0001c830: 2066 6f72 2078 7920 636f 6d70 6f6e 656e   for xy componen
+0001c840: 7473 200d 0a20 2020 2061 7272 6179 285b  ts ..    array([
+0001c850: 2034 3237 2e34 3336 3930 3430 312c 2020   427.43690401,  
+0001c860: 3532 342e 3837 3339 3131 3432 2c20 2037  524.87391142,  7
+0001c870: 3332 2e38 3534 3735 3431 392c 2031 3535  32.85475419, 155
+0001c880: 342e 3331 3839 3337 3120 2c0d 0a20 2020  4.3189371 ,..   
+0001c890: 2020 2020 2020 2020 3330 3738 2e38 3736          3078.876
+0001c8a0: 3231 3634 392c 2031 3535 302e 3632 3638  21649, 1550.6268
+0001c8b0: 3030 3933 2c20 2034 3832 2e36 3437 3039  0093,  482.64709
+0001c8c0: 3434 332c 2020 3630 352e 3331 3533 3638  443,  605.315368
+0001c8d0: 3720 2c0d 0a20 2020 2020 2020 2020 2020  7 ,..           
+0001c8e0: 2034 3939 2e34 3931 3931 3933 362c 2020   499.49191936,  
+0001c8f0: 3436 382e 3838 3639 3238 3739 5d29 0d0a  468.88692879])..
+0001c900: 2020 2020 3e3e 3e20 7a73 7320 3d20 7a6f      >>> zss = zo
+0001c910: 2e72 656d 6f76 655f 7374 6174 6963 5f73  .remove_static_s
+0001c920: 6869 6674 2873 735f 6678 203d 302e 3720  hift(ss_fx =0.7 
+0001c930: 2c20 7373 5f66 7920 3d30 2e38 3520 290d  , ss_fy =0.85 ).
+0001c940: 0a20 2020 203e 3e3e 207a 7373 5b30 5d2e  .    >>> zss[0].
+0001c950: 7265 7369 7374 6976 6974 795b 3a2c 2030  resistivity[:, 0
+0001c960: 2c20 315d 5b3a 3130 5d20 2320 636f 7272  , 1][:10] # corr
+0001c970: 6563 7465 6420 7879 2063 6f6d 706f 6e65  ected xy compone
+0001c980: 6e74 7320 0d0a 2020 2020 6172 7261 7928  nts ..    array(
+0001c990: 5b20 3237 382e 3936 3339 3532 3633 2c20  [ 278.96395263, 
+0001c9a0: 2033 3139 2e31 3131 3837 3935 392c 2020   319.11187959,  
+0001c9b0: 3336 362e 3433 3137 3032 3331 2c20 2036  366.43170231,  6
+0001c9c0: 3732 2e32 3434 3436 3239 352c 0d0a 2020  72.24446295,..  
+0001c9d0: 2020 2020 2020 2020 2031 3334 342e 3230           1344.20
+0001c9e0: 3132 3034 3837 2c20 2036 3931 2e34 3932  120487,  691.492
+0001c9f0: 3730 3638 382c 2020 3236 302e 3235 3632  70688,  260.2562
+0001ca00: 3539 3936 2c20 2033 3630 2e30 3234 3532  5996,  360.02452
+0001ca10: 3439 382c 0d0a 2020 2020 2020 2020 2020  498,..          
+0001ca20: 2020 3330 352e 3937 3338 3135 3837 2c20    305.97381587, 
+0001ca30: 2032 3733 2e34 3632 3531 3936 315d 290d   273.46251961]).
+0001ca40: 0a20 2020 2022 2222 0d0a 2020 2020 6465  .    """..    de
+0001ca50: 6620 5f5f 696e 6974 5f5f 280d 0a20 2020  f __init__(..   
+0001ca60: 2020 2020 2073 656c 662c 200d 0a20 2020       self, ..   
+0001ca70: 2020 2020 2077 696e 646f 775f 7369 7a65       window_size
+0001ca80: 3a69 6e74 203d 352c 200d 0a20 2020 2020  :int =5, ..     
+0001ca90: 2020 2063 3a20 696e 7420 3d32 2c20 0d0a     c: int =2, ..
+0001caa0: 2020 2020 2020 2020 2a2a 6b77 730d 0a20          **kws.. 
+0001cab0: 2020 2020 2020 2029 3a20 0d0a 2020 2020         ): ..    
+0001cac0: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
+0001cad0: 6974 5f5f 282a 2a6b 7773 290d 0a20 2020  it__(**kws)..   
+0001cae0: 2020 2020 200d 0a20 2020 2020 2020 2073       ..        s
+0001caf0: 656c 662e 7769 6e64 6f77 5f73 697a 653d  elf.window_size=
+0001cb00: 7769 6e64 6f77 5f73 697a 6520 0d0a 2020  window_size ..  
+0001cb10: 2020 2020 2020 7365 6c66 2e63 3d63 200d        self.c=c .
+0001cb20: 0a0d 0a20 2020 200d 0a20 2020 2040 5f7a  ...    ..    @_z
+0001cb30: 7570 6461 7465 2028 6f70 7469 6f6e 203d  update (option =
+0001cb40: 276e 6f6e 6527 290d 0a20 2020 2064 6566  'none')..    def
+0001cb50: 2072 656d 6f76 655f 7373 5f65 6d61 7020   remove_ss_emap 
+0001cb60: 280d 0a20 2020 2020 2020 2020 2020 2073  (..            s
+0001cb70: 656c 662c 200d 0a20 2020 2020 2020 2020  elf, ..         
+0001cb80: 2020 2066 6c74 723a 7374 7220 3d27 616d     fltr:str ='am
+0001cb90: 6127 2c20 0d0a 2020 2020 2020 2020 2020  a', ..          
+0001cba0: 2020 6f75 743a 626f 6f6c 3d20 4661 6c73    out:bool= Fals
+0001cbb0: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
+0001cbc0: 2073 6d6f 6f74 683a 626f 6f6c 3d20 5472   smooth:bool= Tr
+0001cbd0: 7565 2c20 0d0a 2020 2020 2020 2020 2020  ue, ..          
+0001cbe0: 2020 6472 6f70 5f6f 7574 6c69 6572 733a    drop_outliers:
+0001cbf0: 626f 6f6c 3d54 7275 652c 200d 0a20 2020  bool=True, ..   
+0001cc00: 2020 2020 2020 2020 202a 2a6b 7773 0d0a           **kws..
+0001cc10: 2020 2020 2020 2020 2020 2020 293a 200d              ): .
+0001cc20: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+0001cc30: 2020 2020 2020 4669 6c74 6572 205a 2074        Filter Z t
+0001cc40: 6f20 7265 6d6f 7665 2074 6865 2073 7461  o remove the sta
+0001cc50: 7469 6320 7363 6869 6674 2075 7369 6e67  tic schift using
+0001cc60: 2074 6865 2045 4d41 5020 6d6f 7669 6e67   the EMAP moving
+0001cc70: 2061 7665 7261 6765 200d 0a20 2020 2020   average ..     
+0001cc80: 2020 2066 696c 7465 7273 2e20 0d0a 2020     filters. ..  
+0001cc90: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0001cca0: 5468 7265 6520 6176 6169 6c61 626c 6520  Three available 
+0001ccb0: 6669 6c74 6572 733a 200d 0a20 2020 2020  filters: ..     
+0001ccc0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0001ccd0: 2020 2020 202d 2027 616d 6127 3a20 4164       - 'ama': Ad
+0001cce0: 6170 7461 7469 7665 206d 6f76 696e 6720  aptative moving 
+0001ccf0: 6176 6572 6167 6520 0d0a 2020 2020 2020  average ..      
+0001cd00: 2020 2020 2020 2d20 2774 6d61 273a 2054        - 'tma': T
+0001cd10: 7269 6d6d 696e 6720 6d6f 7669 6e67 2d61  rimming moving-a
+0001cd20: 7665 7261 6765 200d 0a20 2020 2020 2020  verage ..       
+0001cd30: 2020 2020 202d 2027 666c 6d61 273a 2046       - 'flma': F
+0001cd40: 6978 6564 2d6c 656e 6774 6820 6469 706f  ixed-length dipo
+0001cd50: 6c65 206d 6f76 696e 6720 6176 6572 6167  le moving averag
+0001cd60: 6520 0d0a 2020 2020 2020 2020 0d0a 2020  e ..        ..  
+0001cd70: 2020 2020 2020 436f 756c 6420 6578 706f        Could expo
+0001cd80: 7274 206e 6577 2045 6469 2069 6620 7468  rt new Edi if th
+0001cd90: 6520 6b65 7977 6f72 6420 6172 6775 6d65  e keyword argume
+0001cda0: 6e74 2060 6578 706f 7274 6020 6973 2073  nt `export` is s
+0001cdb0: 6574 200d 0a20 2020 2020 2020 2074 6f20  et ..        to 
+0001cdc0: 6060 5472 7565 6060 0d0a 2020 2020 2020  ``True``..      
+0001cdd0: 2020 0d0a 2020 2020 2020 2020 5061 7261    ..        Para
+0001cde0: 6d65 7465 7273 200d 0a20 2020 2020 2020  meters ..       
+0001cdf0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20   ------------.. 
+0001ce00: 2020 2020 2020 2066 6c74 723a 2073 7472         fltr: str
+0001ce10: 202c 2064 6566 6175 6c74 3d27 616d 6127   , default='ama'
+0001ce20: 0d0a 2020 2020 2020 2020 2020 2054 7970  ..           Typ
+0001ce30: 6520 6f66 2066 696c 7465 7220 746f 2061  e of filter to a
+0001ce40: 7070 6c79 2e20 4465 6661 756c 7420 6973  pply. Default is
+0001ce50: 2041 6461 7074 6174 6976 6520 6d6f 7669   Adaptative movi
+0001ce60: 6e67 2d61 7665 7261 6765 206f 6620 0d0a  ng-average of ..
+0001ce70: 2020 2020 2020 2020 2020 2054 6f72 7265             Torre
+0001ce80: 732d 7665 7264 696e 205b 315d 5f2e 2043  s-verdin [1]_. C
+0001ce90: 616e 2062 6520 5b27 616d 6127 7c27 746d  an be ['ama'|'tm
+0001cea0: 6127 7c27 666c 6d61 275d 0d0a 200d 0a20  a'|'flma'].. .. 
+0001ceb0: 2020 2020 2020 2020 2020 5468 6520 414d            The AM
+0001cec0: 4120 6669 6c74 6572 2065 7374 696d 6174  A filter estimat
+0001ced0: 6573 2073 7461 7469 632d 636f 7272 6563  es static-correc
+0001cee0: 7465 6420 6170 7061 7265 6e74 2072 6573  ted apparent res
+0001cef0: 6973 7469 7669 7469 6573 2061 7420 0d0a  istivities at ..
+0001cf00: 2020 2020 2020 2020 2020 2061 2073 696e             a sin
+0001cf10: 676c 6520 7265 6665 7265 6e63 6520 6672  gle reference fr
+0001cf20: 6571 7565 6e63 7920 6279 2063 616c 6375  equency by calcu
+0001cf30: 6c61 7469 6e67 2061 2070 726f 6669 6c65  lating a profile
+0001cf40: 206f 6620 6176 6572 6167 6520 0d0a 2020   of average ..  
+0001cf50: 2020 2020 2020 2020 2069 6d70 6564 616e           impedan
+0001cf60: 6365 7320 2061 6c6f 6e67 2074 6865 206c  ces  along the l
+0001cf70: 656e 6774 6820 6f66 2074 6865 206c 696e  ength of the lin
+0001cf80: 652e 2053 6f75 6e64 696e 6720 6375 7276  e. Sounding curv
+0001cf90: 6573 2061 7265 200d 0a20 2020 2020 2020  es are ..       
+0001cfa0: 2020 2020 7468 656e 2073 6869 6674 6564      then shifted
+0001cfb0: 2073 6f20 7468 6174 2074 6865 7920 696e   so that they in
+0001cfc0: 7465 7273 6563 7420 7468 6520 6176 6572  tersect the aver
+0001cfd0: 6167 6564 2070 726f 6669 6c65 2e20 0d0a  aged profile. ..
+0001cfe0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0001cff0: 2020 2020 206f 7574 3a20 626f 6f6c 202c       out: bool ,
+0001d000: 2064 6566 6175 6c74 203d 4661 6c73 652c   default =False,
+0001d010: 200d 0a20 2020 2020 2020 2020 2020 4f75   ..           Ou
+0001d020: 7470 7574 206e 6577 2066 696c 7465 7265  tput new filtere
+0001d030: 6420 4544 492e 204f 7468 6572 7769 7365  d EDI. Otherwise
+0001d040: 2072 6574 7572 6e20 5a20 636f 6c6c 6563   return Z collec
+0001d050: 7469 6f6e 7320 6f62 6a65 6374 7320 0d0a  tions objects ..
+0001d060: 2020 2020 2020 2020 2020 206f 6620 636f             of co
+0001d070: 7272 6563 7465 6420 5465 6e73 6f72 732e  rrected Tensors.
+0001d080: 200d 0a20 2020 2020 2020 2020 2020 0d0a   ..           ..
+0001d090: 2020 2020 2020 2020 736d 6f6f 7468 3a20          smooth: 
+0001d0a0: 626f 6f6c 2c20 6465 6661 756c 743d 4661  bool, default=Fa
+0001d0b0: 6c73 652c 200d 0a20 2020 2020 2020 2020  lse, ..         
+0001d0c0: 2020 536d 6f6f 7468 2074 6865 2074 656e    Smooth the ten
+0001d0d0: 736f 7220 6461 7461 2061 6c6f 6e67 2074  sor data along t
+0001d0e0: 6865 2066 7265 7175 656e 6369 6573 2e20  he frequencies. 
+0001d0f0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0001d100: 2020 2020 2e2e 2076 6572 7369 6f6e 6164      .. versionad
+0001d110: 6465 643a 2030 2e32 2e31 200d 0a20 2020  ded: 0.2.1 ..   
+0001d120: 2020 2020 200d 0a20 2020 2020 2020 2064       ..        d
+0001d130: 726f 705f 6f75 746c 6965 7273 3a20 626f  rop_outliers: bo
+0001d140: 6f6c 2c20 6465 6661 756c 743d 5472 7565  ol, default=True
+0001d150: 200d 0a20 2020 2020 2020 2020 2020 5375   ..           Su
+0001d160: 7070 7265 7373 206f 7574 6c69 6572 7320  ppress outliers 
+0001d170: 696e 2074 6865 2064 6174 6120 7768 656e  in the data when
+0001d180: 2073 6d6f 6f74 6869 6e67 2064 6174 6120   smoothing data 
+0001d190: 616c 6f6e 6720 0d0a 2020 2020 2020 2020  along ..        
+0001d1a0: 2020 2074 6865 2066 7265 7175 656e 6369     the frequenci
+0001d1b0: 6573 2061 7869 732e 204e 6f74 6520 7468  es axis. Note th
+0001d1c0: 6174 2060 6472 6f70 5f6f 7574 6c69 6572  at `drop_outlier
+0001d1d0: 7360 2064 6f65 7320 6e6f 7420 7461 6b65  s` does not take
+0001d1e0: 200d 0a20 2020 2020 2020 2020 2020 6566   ..           ef
+0001d1f0: 6665 6374 2069 6620 6073 6d6f 6f74 6860  fect if `smooth`
+0001d200: 2069 7320 6060 4661 6c73 6560 602e 200d   is ``False``. .
+0001d210: 0a20 2020 2020 2020 2020 2020 0d0a 2020  .           ..  
+0001d220: 2020 2020 2020 2e2e 2076 6572 7369 6f6e        .. version
+0001d230: 6164 6465 643a 2030 2e32 2e31 200d 0a20  added: 0.2.1 .. 
+0001d240: 2020 2020 2020 2020 2020 506f 6c69 7368            Polish
+0001d250: 2074 6865 2074 656e 736f 7220 6461 7461   the tensor data
+0001d260: 2061 6c6f 6e67 2074 6865 2066 7265 7175   along the frequ
+0001d270: 656e 6379 2061 7869 7320 7265 6d6f 7665  ency axis remove
+0001d280: 206e 6f69 7365 7320 0d0a 2020 2020 2020   noises ..      
+0001d290: 2020 2020 2061 6e64 2064 6561 6c20 7769       and deal wi
+0001d2a0: 7468 2074 6865 2073 7461 7469 6320 7368  th the static sh
+0001d2b0: 6966 7420 6566 6665 6374 2077 6865 6e20  ift effect when 
+0001d2c0: 696e 7465 7266 6572 656e 6365 7320 6e6f  interferences no
+0001d2d0: 6973 6573 200d 0a20 2020 2020 2020 2020  ises ..         
+0001d2e0: 2020 6172 6520 7374 726f 6e67 2065 6e6f    are strong eno
+0001d2f0: 7567 682e 200d 0a20 2020 2020 2020 2020  ugh. ..         
+0001d300: 2020 0d0a 2020 2020 2020 2020 5265 7475    ..        Retu
+0001d310: 726e 7320 0d0a 2020 2020 2020 2020 2d2d  rns ..        --
+0001d320: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001d330: 205a 3a20 6c69 7374 206f 6620 3a63 6c61   Z: list of :cla
+0001d340: 7373 3a60 7761 7465 782e 6578 7465 726e  ss:`watex.extern
+0001d350: 616c 732e 7a60 206f 626a 6563 7473 206f  als.z` objects o
+0001d360: 7220 4e6f 6e65 200d 0a20 2020 2020 2020  r None ..       
+0001d370: 2020 2020 5265 7475 726e 2060 604e 6f6e      Return ``Non
+0001d380: 6560 6020 6279 2064 6566 6175 6c74 2028  e`` by default (
+0001d390: 7768 656e 2065 7870 6f72 7420 6973 2073  when export is s
+0001d3a0: 6574 2074 6f20 6060 4661 6c73 6560 6029  et to ``False``)
+0001d3b0: 200d 0a20 2020 2020 2020 2020 0d0a 2020   ..         ..  
+0001d3c0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0001d3d0: 2020 2020 5265 6665 7265 6e63 6573 200d      References .
+0001d3e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001d3f0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 2e2e  ----..        ..
+0001d400: 205b 315d 2054 6f72 7265 732d 5665 7264   [1] Torres-Verd
+0001d410: 696e 2061 6e64 2042 6f73 7469 636b 2c20  in and Bostick, 
+0001d420: 3139 3932 2c20 2050 7269 6e63 6970 6c65  1992,  Principle
+0001d430: 7320 6f66 2073 7061 7469 616c 2073 7572  s of spatial sur
+0001d440: 6661 6365 200d 0a20 2020 2020 2020 2020  face ..         
+0001d450: 2020 2020 2020 656c 6563 7472 6963 2066        electric f
+0001d460: 6965 6c64 2066 696c 7465 7269 6e67 2069  ield filtering i
+0001d470: 6e20 6d61 676e 6574 6f74 656c 6c75 7269  n magnetotelluri
+0001d480: 6373 3a20 656c 6563 7472 6f6d 6167 6e65  cs: electromagne
+0001d490: 7469 6320 6172 7261 7920 0d0a 2020 2020  tic array ..    
+0001d4a0: 2020 2020 2020 2020 2020 2070 726f 6669             profi
+0001d4b0: 6c69 6e67 2845 4d41 5029 2c20 4765 6f70  ling(EMAP), Geop
+0001d4c0: 6879 7369 6373 2c20 7635 372c 2070 3630  hysics, v57, p60
+0001d4d0: 332d 3632 322e 6874 7470 733a 2f2f 646f  3-622.https://do
+0001d4e0: 692e 6f72 672f 3130 2e31 3139 302f 312e  i.org/10.1190/1.
+0001d4f0: 3234 3030 3632 350d 0a20 2020 2020 2020  2400625..       
+0001d500: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0001d510: 2020 5365 6520 416c 736f 200d 0a20 2020    See Also ..   
+0001d520: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a       ---------..
+0001d530: 2020 2020 2020 2020 7265 6d6f 7665 5f73          remove_s
+0001d540: 7461 7469 635f 7368 6966 743a 200d 0a20  tatic_shift: .. 
+0001d550: 2020 2020 2020 2020 2020 2052 656d 6f76             Remov
+0001d560: 6520 7374 6174 6963 2073 6869 6674 2075  e static shift u
+0001d570: 7369 6e67 2074 6865 2073 7061 7469 616c  sing the spatial
+0001d580: 2066 696c 7465 7220 6d65 6469 616e 2061   filter median a
+0001d590: 6e64 2077 7269 7465 200d 0a20 2020 2020  nd write ..     
+0001d5a0: 2020 2020 2020 2061 206e 6577 2065 6469         a new edi
+0001d5b0: 6669 6c65 2e20 0d0a 2020 2020 2020 2020  file. ..        
+0001d5c0: 2020 2020 0d0a 2020 2020 2020 2020 4578      ..        Ex
+0001d5d0: 616d 706c 6573 200d 0a20 2020 2020 2020  amples ..       
+0001d5e0: 202d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020   ---------..    
+0001d5f0: 2020 2020 3e3e 3e20 696d 706f 7274 2077      >>> import w
+0001d600: 6174 6578 200d 0a20 2020 2020 2020 203e  atex ..        >
+0001d610: 3e3e 2066 726f 6d20 7761 7465 782e 6d65  >> from watex.me
+0001d620: 7468 6f64 7320 696d 706f 7274 205a 4320  thods import ZC 
+0001d630: 0d0a 2020 2020 2020 2020 3e3e 3e20 6564  ..        >>> ed
+0001d640: 695f 7361 6d70 6c65 203d 2077 6174 6578  i_sample = watex
+0001d650: 2e66 6574 6368 5f64 6174 6120 2827 6564  .fetch_data ('ed
+0001d660: 6973 272c 2073 616d 706c 6573 203d 3137  is', samples =17
+0001d670: 202c 2072 6574 7572 6e5f 6461 7461 203d   , return_data =
+0001d680: 5472 7565 2029 200d 0a20 2020 2020 2020  True ) ..       
+0001d690: 203e 3e3e 207a 6f20 3d20 5a43 2028 292e   >>> zo = ZC ().
+0001d6a0: 6669 7428 6564 695f 7361 6d70 6c65 290d  fit(edi_sample).
+0001d6b0: 0a20 2020 2020 2020 203e 3e3e 207a 6f2e  .        >>> zo.
+0001d6c0: 6564 694f 626a 735f 5b30 5d2e 5a2e 7a5b  ediObjs_[0].Z.z[
+0001d6d0: 3a2c 2030 2c20 315d 5b3a 375d 0d0a 2020  :, 0, 1][:7]..  
+0001d6e0: 2020 2020 2020 6172 7261 7928 5b31 3030        array([100
+0001d6f0: 3032 2e34 3620 2b39 3734 372e 3334 6a20  02.46 +9747.34j 
+0001d700: 2c20 3131 3637 392e 3434 202b 3837 3134  , 11679.44 +8714
+0001d710: 2e33 3239 6a2c 2031 3538 3936 2e34 3520  .329j, 15896.45 
+0001d720: 2b33 3138 362e 3733 376a 2c0d 0a20 2020  +3186.737j,..   
+0001d730: 2020 2020 2020 2020 2020 2020 3231 3736              2176
+0001d740: 332e 3031 202d 3435 3339 2e34 3035 6a2c  3.01 -4539.405j,
+0001d750: 2032 3832 3039 2e33 3620 2d38 3439 342e   28209.36 -8494.
+0001d760: 3830 386a 2c20 3139 3533 382e 3638 202d  808j, 19538.68 -
+0001d770: 3234 3030 2e38 3434 6a2c 0d0a 2020 2020  2400.844j,..    
+0001d780: 2020 2020 2020 2020 2020 2020 3839 3038              8908
+0001d790: 2e34 3438 2b35 3235 312e 3135 376a 5d29  .448+5251.157j])
+0001d7a0: 0d0a 2020 2020 2020 2020 3e3e 3e20 7a63  ..        >>> zc
+0001d7b0: 203d 207a 6f2e 7265 6d6f 7665 5f73 735f   = zo.remove_ss_
+0001d7c0: 656d 6170 2829 200d 0a20 2020 2020 2020  emap() ..       
+0001d7d0: 203e 3e3e 207a 635b 305d 2e7a 5b3a 2c20   >>> zc[0].z[:, 
+0001d7e0: 302c 2031 5d20 5b3a 375d 0d0a 2020 2020  0, 1] [:7]..    
+0001d7f0: 2020 2020 6172 7261 7928 5b31 3231 3230      array([12120
+0001d800: 2e30 3833 3230 3830 342b 3639 3339 2e39  .08320804+6939.9
+0001d810: 3837 3437 3533 6a20 2c20 3133 3033 302e  874753j , 13030.
+0001d820: 3931 3436 3236 3036 2b36 3532 322e 3538  91462606+6522.58
+0001d830: 3438 3132 3935 6a2c 0d0a 2020 2020 2020  481295j,..      
+0001d840: 2020 2020 2020 2020 2031 3534 3332 2e30           15432.0
+0001d850: 3230 3631 3234 202b 3439 3730 2e34 3238  206124 +4970.428
+0001d860: 3036 3238 376a 2c20 3231 3839 392e 3630  06287j, 21899.60
+0001d870: 3934 3232 3434 2b33 3832 362e 3437 3437  942244+3826.4747
+0001d880: 3639 3132 6a2c 0d0a 2020 2020 2020 2020  6912j,..        
+0001d890: 2020 2020 2020 2032 3931 3039 2e31 3731         29109.171
+0001d8a0: 3030 3038 352b 3435 3337 2e31 3730 3732  00085+4537.17072
+0001d8b0: 3734 316a 2c20 3139 3235 322e 3037 3833  741j, 19252.0783
+0001d8c0: 3937 3332 2b34 3130 382e 3731 3537 3839  9732+4108.715789
+0001d8d0: 3433 6a2c 0d0a 2020 2020 2020 2020 2020  43j,..          
+0001d8e0: 2020 2020 2020 3934 3733 2e32 3034 3634        9473.20464
+0001d8f0: 3332 362b 3431 3436 2e35 3033 3237 3331  326+4146.5032731
+0001d900: 356a 5d29 0d0a 2020 2020 2020 2020 2222  5j])..        ""
+0001d910: 220d 0a20 2020 2020 2020 2073 656c 662e  "..        self.
+0001d920: 696e 7370 6563 7420 0d0a 2020 2020 2020  inspect ..      
+0001d930: 2020 0d0a 2020 2020 2020 2020 7020 3d20    ..        p = 
+0001d940: 5072 6f63 6573 7369 6e67 286f 7574 203d  Processing(out =
+0001d950: 277a 2027 2920 0d0a 2020 2020 2020 2020  'z ') ..        
+0001d960: 702e 6564 694f 626a 735f 203d 2073 656c  p.ediObjs_ = sel
+0001d970: 662e 6564 694f 626a 735f 0d0a 2020 2020  f.ediObjs_..    
+0001d980: 2020 2020 702e 6672 6571 735f 203d 2073      p.freqs_ = s
+0001d990: 656c 662e 6672 6571 735f 0d0a 0d0a 2020  elf.freqs_....  
+0001d9a0: 2020 2020 2020 666c 7220 3d20 7374 7228        flr = str(
+0001d9b0: 666c 7472 292e 6c6f 7765 7228 292e 7374  fltr).lower().st
+0001d9c0: 7269 7028 2920 0d0a 2020 2020 2020 2020  rip() ..        
+0001d9d0: 6173 7365 7274 2066 6c72 2069 6e20 7b22  assert flr in {"
+0001d9e0: 616d 6122 2c20 2274 6d61 222c 2022 666c  ama", "tma", "fl
+0001d9f0: 6d61 227d 2c20 280d 0a20 2020 2020 2020  ma"}, (..       
+0001da00: 2020 2020 2066 2246 696c 7465 7220 7b66       f"Filter {f
+0001da10: 6c74 7221 727d 2069 7320 6e6f 7420 6176  ltr!r} is not av
+0001da20: 6169 6c61 626c 652e 2045 7870 6563 7422  ailable. Expect"
+0001da30: 0d0a 2020 2020 2020 2020 2020 2020 2220  ..            " 
+0001da40: 6164 6170 7461 7469 7665 206d 6f76 696e  adaptative movin
+0001da50: 672d 6176 6572 6167 653a 2027 616d 6127  g-average: 'ama'
+0001da60: 2c22 0d0a 2020 2020 2020 2020 2020 2020  ,"..            
+0001da70: 2220 7472 696d 6d69 6e67 206d 6f76 696e  " trimming movin
+0001da80: 672d 6176 6572 6167 653a 2027 746d 6127  g-average: 'tma'
+0001da90: 206f 7222 0d0a 2020 2020 2020 2020 2020   or"..          
+0001daa0: 2020 2220 6669 7865 642d 6469 706f 6c65    " fixed-dipole
+0001dab0: 206c 656e 6774 6820 6d6f 7669 6e67 2d61   length moving-a
+0001dac0: 7665 7261 6765 3a20 2766 6c6d 6127 2220  verage: 'flma'" 
+0001dad0: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
+0001dae0: 0a20 2020 2020 2020 2023 2047 6174 6865  .        # Gathe
+0001daf0: 7220 7468 6520 3244 2069 6e74 6f20 7a20  r the 2D into z 
+0001db00: 6f62 6a65 6374 730d 0a20 2020 2020 2020  objects..       
+0001db10: 207a 6420 3d20 6469 6374 2028 2920 0d0a   zd = dict () ..
+0001db20: 2020 2020 2020 2020 2320 636f 7272 6563          # correc
+0001db30: 7420 616c 6c20 636f 6d70 6f6e 656e 7473  t all components
+0001db40: 2069 6620 6170 706c 6963 6162 6c65 200d   if applicable .
+0001db50: 0a20 2020 2020 2020 2066 6f72 2063 6f6d  .        for com
+0001db60: 7020 696e 2028 2778 7827 2c20 2778 7927  p in ('xx', 'xy'
+0001db70: 2c20 2779 7827 2c20 2779 7927 293a 200d  , 'yx', 'yy'): .
+0001db80: 0a20 2020 2020 2020 2020 2020 2070 2e63  .            p.c
+0001db90: 6f6d 706f 6e65 6e74 203d 2063 6f6d 7020  omponent = comp 
+0001dba0: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
+0001dbb0: 793a 200d 0a20 2020 2020 2020 2020 2020  y: ..           
+0001dbc0: 2020 2020 2069 6620 666c 723d 3d27 746d       if flr=='tm
+0001dbd0: 6127 3a20 0d0a 2020 2020 2020 2020 2020  a': ..          
+0001dbe0: 2020 2020 2020 2020 2020 7a63 203d 2070            zc = p
+0001dbf0: 2e61 6d61 2028 736d 6f6f 7468 203d 2073  .ama (smooth = s
+0001dc00: 6d6f 6f74 6820 2c20 0d0a 2020 2020 2020  mooth , ..      
 0001dc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc30: 6472 6f70 5f6f 7574 6c69 6572 733d 2064  drop_outliers= d
-0001dc40: 726f 705f 6f75 746c 6965 7273 0d0a 2020  rop_outliers..  
+0001dc20: 2020 2020 2020 2020 2020 6472 6f70 5f6f            drop_o
+0001dc30: 7574 6c69 6572 733d 2064 726f 705f 6f75  utliers= drop_ou
+0001dc40: 746c 6965 7273 0d0a 2020 2020 2020 2020  tliers..        
 0001dc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc60: 2020 2020 2020 2020 2020 2020 2020 2920                ) 
-0001dc70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001dc80: 2020 656c 6966 2066 6c72 3d3d 2766 6c6d    elif flr=='flm
-0001dc90: 6127 3a20 0d0a 2020 2020 2020 2020 2020  a': ..          
-0001dca0: 2020 2020 2020 2020 2020 7a63 203d 2070            zc = p
-0001dcb0: 2e66 6c6d 6120 2873 6d6f 6f74 6820 3d20  .flma (smooth = 
-0001dcc0: 736d 6f6f 7468 202c 200d 0a20 2020 2020  smooth , ..     
+0001dc60: 2020 2020 2020 2020 2920 0d0a 2020 2020          ) ..    
+0001dc70: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0001dc80: 2066 6c72 3d3d 2766 6c6d 6127 3a20 0d0a   flr=='flma': ..
+0001dc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dca0: 2020 2020 7a63 203d 2070 2e66 6c6d 6120      zc = p.flma 
+0001dcb0: 2873 6d6f 6f74 6820 3d20 736d 6f6f 7468  (smooth = smooth
+0001dcc0: 202c 200d 0a20 2020 2020 2020 2020 2020   , ..           
 0001dcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dce0: 2020 2020 2020 2020 2020 2064 726f 705f             drop_
-0001dcf0: 6f75 746c 6965 7273 3d20 6472 6f70 5f6f  outliers= drop_o
-0001dd00: 7574 6c69 6572 7329 200d 0a20 2020 2020  utliers) ..     
-0001dd10: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
-0001dd20: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0001dd30: 2020 2020 2020 2020 7a63 203d 2070 2e61          zc = p.a
-0001dd40: 6d61 2028 736d 6f6f 7468 203d 2073 6d6f  ma (smooth = smo
-0001dd50: 6f74 6820 2c20 0d0a 2020 2020 2020 2020  oth , ..        
+0001dce0: 2020 2020 2064 726f 705f 6f75 746c 6965       drop_outlie
+0001dcf0: 7273 3d20 6472 6f70 5f6f 7574 6c69 6572  rs= drop_outlier
+0001dd00: 7329 200d 0a20 2020 2020 2020 2020 2020  s) ..           
+0001dd10: 2020 2020 2065 6c73 6520 3a20 0d0a 2020       else : ..  
+0001dd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd30: 2020 7a63 203d 2070 2e61 6d61 2028 736d    zc = p.ama (sm
+0001dd40: 6f6f 7468 203d 2073 6d6f 6f74 6820 2c20  ooth = smooth , 
+0001dd50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 0001dd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd70: 2020 2020 2020 2020 6472 6f70 5f6f 7574          drop_out
-0001dd80: 6c69 6572 733d 2064 726f 705f 6f75 746c  liers= drop_outl
-0001dd90: 6965 7273 0d0a 2020 2020 2020 2020 2020  iers..          
+0001dd70: 2020 6472 6f70 5f6f 7574 6c69 6572 733d    drop_outliers=
+0001dd80: 2064 726f 705f 6f75 746c 6965 7273 0d0a   drop_outliers..
+0001dd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001dda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ddb0: 2020 2020 2020 2920 0d0a 2020 2020 0d0a        ) ..    ..
-0001ddc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ddd0: 7a63 5f65 7272 203d 2073 656c 662e 6d61  zc_err = self.ma
-0001dde0: 6b65 3264 2028 6622 7a7b 636f 6d70 7d5f  ke2d (f"z{comp}_
-0001ddf0: 6572 7222 2920 0d0a 2020 2020 2020 2020  err") ..        
-0001de00: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001de10: 2020 2020 2020 6578 6365 7074 203a 200d        except : .
-0001de20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001de30: 2023 2049 6e20 7468 6520 6361 7365 2073   # In the case s
-0001de40: 6f6d 6520 636f 6d70 6f6e 656e 7473 200d  ome components .
-0001de50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001de60: 2023 2061 7265 206d 6973 7369 6e67 2c20   # are missing, 
-0001de70: 7365 7420 746f 206e 756c 6c20 0d0a 2020  set to null ..  
-0001de80: 2020 2020 2020 2020 2020 2020 2020 7a63                zc
-0001de90: 203d 206e 702e 7a65 726f 7320 280d 0a20   = np.zeros (.. 
-0001dea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001deb0: 2020 2028 6c65 6e28 7365 6c66 2e66 7265     (len(self.fre
-0001dec0: 7173 5f29 2c20 6c65 6e28 7365 6c66 2e65  qs_), len(self.e
-0001ded0: 6469 4f62 6a73 5f29 292c 0d0a 2020 2020  diObjs_)),..    
-0001dee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001def0: 6474 7970 6520 3d20 6e70 2e63 6f6d 706c  dtype = np.compl
-0001df00: 6578 3132 3829 0d0a 2020 2020 2020 2020  ex128)..        
-0001df10: 2020 2020 2020 2020 7a63 5f65 7272 3d20          zc_err= 
-0001df20: 7a63 2e63 6f70 7928 2920 0d0a 2020 2020  zc.copy() ..    
-0001df30: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001df40: 2020 2020 2020 7a64 5b66 277a 7b63 6f6d        zd[f'z{com
-0001df50: 707d 275d 203d 207a 6320 0d0a 2020 2020  p}'] = zc ..    
-0001df60: 2020 2020 2020 2020 7a64 5b66 277a 7b63          zd[f'z{c
-0001df70: 6f6d 707d 5f65 7272 275d 3d7a 635f 6572  omp}_err']=zc_er
-0001df80: 720d 0a20 2020 2020 2020 2020 2020 200d  r..            .
-0001df90: 0a20 2020 2020 2020 2023 206d 616e 6167  .        # manag
-0001dfa0: 6520 6564 6920 2d65 7870 6f72 7420 0d0a  e edi -export ..
-0001dfb0: 2020 2020 2020 2020 6f70 7469 6f6e 203d          option =
-0001dfc0: 6b77 732e 706f 7028 276f 7074 696f 6e27  kws.pop('option'
-0001dfd0: 2c20 4e6f 6e65 2029 0d0a 2020 2020 2020  , None )..      
-0001dfe0: 2020 6f70 7469 6f6e 203d 2027 7772 6974    option = 'writ
-0001dff0: 6527 2069 6620 6f75 7420 656c 7365 204e  e' if out else N
-0001e000: 6f6e 6520 0d0a 2020 2020 2020 2020 2320  one ..        # 
-0001e010: 7265 7365 7420 206f 7074 696f 6e20 0d0a  reset  option ..
-0001e020: 2020 2020 2020 2020 6b77 732e 5f5f 7365          kws.__se
-0001e030: 7469 7465 6d5f 5f28 276f 7074 696f 6e27  titem__('option'
-0001e040: 2c20 6f70 7469 6f6e 2029 200d 0a20 2020  , option ) ..   
-0001e050: 2020 2020 200d 0a20 2020 200d 0a20 2020       ..    ..   
-0001e060: 2020 2020 2072 6574 7572 6e20 2873 656c       return (sel
-0001e070: 662e 6564 694f 626a 735f 2c20 7365 6c66  f.ediObjs_, self
-0001e080: 2e66 7265 7173 5f20 2c20 7a64 2029 2c20  .freqs_ , zd ), 
-0001e090: 6b77 730d 0a20 2020 0d0a 2020 2020 405f  kws..   ..    @_
-0001e0a0: 7a75 7064 6174 6520 286f 7074 696f 6e20  zupdate (option 
-0001e0b0: 3d27 6e6f 6e65 2729 0d0a 2020 2020 6465  ='none')..    de
-0001e0c0: 6620 7265 6d6f 7665 5f73 7461 7469 635f  f remove_static_
-0001e0d0: 7368 6966 7420 280d 0a20 2020 2020 2020  shift (..       
-0001e0e0: 2073 656c 662c 200d 0a20 2020 2020 2020   self, ..       
-0001e0f0: 2073 735f 6678 3a66 6c6f 6174 203d 4e6f   ss_fx:float =No
-0001e100: 6e65 2c20 0d0a 2020 2020 2020 2020 7373  ne, ..        ss
-0001e110: 5f66 793a 666c 6f61 743d 204e 6f6e 652c  _fy:float= None,
-0001e120: 200d 0a20 2020 2020 2020 206f 7574 3a62   ..        out:b
-0001e130: 6f6f 6c20 3d46 616c 7365 202c 200d 0a20  ool =False , .. 
-0001e140: 2020 2020 2020 2072 6f74 6174 653a 666c         rotate:fl
-0001e150: 6f61 743d 302e 2c20 0d0a 2020 2020 2020  oat=0., ..      
-0001e160: 2020 2a2a 6b77 730d 0a20 2020 2020 2020    **kws..       
-0001e170: 2029 3a20 0d0a 2020 2020 2020 2020 2222   ): ..        ""
-0001e180: 220d 0a20 2020 2020 2020 2052 656d 6f76  "..        Remov
-0001e190: 6520 7468 6520 7374 6174 6963 2073 6869  e the static shi
-0001e1a0: 6674 2066 726f 6d20 636f 7272 6563 7469  ft from correcti
-0001e1b0: 6f6e 2066 6163 746f 7220 6672 6f6d 2078  on factor from x
-0001e1c0: 2061 6e64 2079 2e20 0d0a 2020 2020 2020   and y. ..      
-0001e1d0: 2020 0d0a 2020 2020 2020 2020 5468 6520    ..        The 
-0001e1e0: 636f 7272 6563 7469 6f6e 2066 6163 746f  correction facto
-0001e1f0: 7273 2060 7373 5f66 7860 2061 6e64 2060  rs `ss_fx` and `
-0001e200: 7373 5f66 7960 2061 7265 2075 7365 6420  ss_fy` are used 
-0001e210: 666f 7220 7468 6520 0d0a 2020 2020 2020  for the ..      
-0001e220: 2020 7265 7369 7374 6976 6974 7920 696e    resistivity in
-0001e230: 2074 6865 2078 2061 6e64 2079 2020 636f   the x and y  co
-0001e240: 6d70 6f6e 656e 7473 2066 6f72 2073 7461  mponents for sta
-0001e250: 7469 6320 7368 6966 7420 7265 6d6f 7661  tic shift remova
-0001e260: 6c2e 0d0a 2020 2020 2020 2020 0d0a 2020  l...        ..  
-0001e270: 2020 2020 2020 4661 6374 6f72 7320 6361        Factors ca
-0001e280: 6e20 6265 2064 6574 6572 6d69 6e65 6420  n be determined 
-0001e290: 6279 2075 7369 6e67 2074 6865 203a 6d65  by using the :me
-0001e2a0: 7468 3a60 6765 745f 7373 5f63 6f72 7265  th:`get_ss_corre
-0001e2b0: 6374 696f 6e5f 6661 6374 6f72 7360 0d0a  ction_factors`..
-0001e2c0: 2020 2020 2020 2020 4966 2060 604e 6f6e          If ``Non
-0001e2d0: 6560 602c 2066 6163 746f 7273 2061 7265  e``, factors are
-0001e2e0: 2066 6f75 6e64 2075 7369 6e67 2074 6865   found using the
-0001e2f0: 2073 7061 7469 616c 206d 6564 6961 6e20   spatial median 
-0001e300: 6669 6c74 6572 2e20 0d0a 2020 2020 2020  filter. ..      
-0001e310: 2020 4173 7375 6d65 2074 6865 206f 7269    Assume the ori
-0001e320: 6769 6e61 6c20 6f62 7365 7276 6564 2074  ginal observed t
-0001e330: 656e 736f 7220 5a20 6973 2062 7569 6c74  ensor Z is built
-0001e340: 2062 7920 6120 7374 6174 6963 2073 6869   by a static shi
-0001e350: 6674 200d 0a20 2020 2020 2020 203a 6d61  ft ..        :ma
-0001e360: 7468 3a60 5360 2061 6e64 2061 6e20 756e  th:`S` and an un
-0001e370: 7065 7274 7572 6261 7465 6420 2263 6f72  perturbated "cor
-0001e380: 7265 6374 2220 3a6d 6174 683a 605a 5f7b  rect" :math:`Z_{
-0001e390: 307d 203a 0d0a 2020 2020 2020 2020 0d0a  0} :..        ..
-0001e3a0: 2020 2020 2020 2020 2e2e 206d 6174 683a          .. math:
-0001e3b0: 3a0d 0a20 200d 0a20 2020 2020 2020 2020  :..  ..         
-0001e3c0: 2020 2020 5a20 3d20 5320 2a20 5a5f 7b30      Z = S * Z_{0
-0001e3d0: 7d0d 0a0d 0a20 2020 2020 2020 2074 6865  }....        the
-0001e3e0: 7265 666f 7265 2074 6865 2063 6f72 7265  refore the corre
-0001e3f0: 6374 205a 2077 696c 6c20 6265 3a20 0d0a  ct Z will be: ..
-0001e400: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001e410: 2020 2e2e 206d 6174 683a 3a0d 0a20 2020    .. math::..   
-0001e420: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0001e430: 2020 2020 2020 205a 5f7b 307d 203d 2053         Z_{0} = S
-0001e440: 5e7b 282d 3129 7d20 2a20 5a0d 0a0d 0a20  ^{(-1)} * Z.... 
-0001e450: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0001e460: 7320 0d0a 2020 2020 2020 2020 2d2d 2d2d  s ..        ----
-0001e470: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0001e480: 200d 0a20 2020 2020 2020 2073 735f 6678   ..        ss_fx
-0001e490: 3a20 666c 6f61 742c 204f 7074 696f 6e61  : float, Optiona
-0001e4a0: 6c20 200d 0a20 2020 2020 2020 2020 2020  l  ..           
-0001e4b0: 7374 6174 6963 2073 6869 6674 2066 6163  static shift fac
-0001e4c0: 746f 7220 746f 2062 6520 6170 706c 6965  tor to be applie
-0001e4d0: 6420 746f 2078 2063 6f6d 706f 6e65 6e74  d to x component
-0001e4e0: 730d 0a20 2020 2020 2020 2020 2020 2869  s..           (i
-0001e4f0: 6520 7a5b 3a2c 2030 2c20 3a5d 292e 2020  e z[:, 0, :]).  
-0001e500: 5468 6973 2069 7320 6173 7375 6d65 6420  This is assumed 
-0001e510: 746f 2062 6520 696e 2072 6573 6973 7469  to be in resisti
-0001e520: 7669 7479 2073 6361 6c65 2e20 0d0a 2020  vity scale. ..  
-0001e530: 2020 2020 2020 2020 2049 6620 4e6f 6e65           If None
-0001e540: 2073 686f 756c 6420 6265 2061 7574 6f6d   should be autom
-0001e550: 6174 6963 616c 6c79 2063 6f6d 7075 7465  atically compute
-0001e560: 6420 7573 696e 6720 2074 6865 200d 0a20  d using  the .. 
-0001e570: 2020 2020 2020 2020 2020 7370 6174 6961            spatia
-0001e580: 6c20 6d65 6469 616e 2066 696c 7465 722e  l median filter.
-0001e590: 200d 0a20 2020 2020 2020 2020 2020 0d0a   ..           ..
-0001e5a0: 2020 2020 2020 2020 7373 5f66 793a 2066          ss_fy: f
-0001e5b0: 6c6f 6174 2c20 6f70 7469 6f6e 616c 200d  loat, optional .
-0001e5c0: 0a20 2020 2020 2020 2020 2020 7374 6174  .           stat
-0001e5d0: 6963 2073 6869 6674 2066 6163 746f 7220  ic shift factor 
-0001e5e0: 746f 2062 6520 6170 706c 6965 6420 746f  to be applied to
-0001e5f0: 2079 2063 6f6d 706f 6e65 6e74 7320 0d0a   y components ..
-0001e600: 2020 2020 2020 2020 2020 2028 6965 207a             (ie z
-0001e610: 5b3a 2c20 312c 203a 5d29 2e20 2054 6869  [:, 1, :]).  Thi
-0001e620: 7320 6973 2061 7373 756d 6564 2074 6f20  s is assumed to 
-0001e630: 6265 2069 6e20 7265 7369 7374 6976 6974  be in resistivit
-0001e640: 7920 7363 616c 652e 2049 660d 0a20 2020  y scale. If..   
-0001e650: 2020 2020 2020 2020 6060 4e6f 6e65 6060          ``None``
-0001e660: 202c 2073 686f 756c 6420 6265 2063 6f6d   , should be com
-0001e670: 7075 7465 6420 7573 696e 6720 7468 6520  puted using the 
-0001e680: 7370 6174 6961 6c20 6669 6c74 6572 206d  spatial filter m
-0001e690: 6564 6961 6e2e 200d 0a20 2020 2020 2020  edian. ..       
-0001e6a0: 200d 0a20 2020 2020 2020 2072 6f74 6174   ..        rotat
-0001e6b0: 653a 2066 6c6f 6174 2c20 6465 6661 756c  e: float, defaul
-0001e6c0: 743d 302e 2020 0d0a 2020 2020 2020 2020  t=0.  ..        
-0001e6d0: 2020 2020 526f 7461 7465 205a 2061 7272      Rotate Z arr
-0001e6e0: 6179 2062 7920 616e 676c 6520 616c 7068  ay by angle alph
-0001e6f0: 6120 696e 2064 6567 7265 6573 2e20 2041  a in degrees.  A
-0001e700: 6c6c 2061 6e67 6c65 7320 6172 6520 7265  ll angles are re
-0001e710: 6665 7265 6e63 6564 0d0a 2020 2020 2020  ferenced..      
-0001e720: 2020 2020 2020 746f 2067 656f 6772 6170        to geograp
-0001e730: 6869 6320 4e6f 7274 682c 2070 6f73 6974  hic North, posit
-0001e740: 6976 6520 696e 2063 6c6f 636b 7769 7365  ive in clockwise
-0001e750: 2064 6972 6563 7469 6f6e 2e0d 0a20 2020   direction...   
-0001e760: 2020 2020 2020 2020 2028 4d61 7468 656d           (Mathem
-0001e770: 6174 6963 616c 6c79 206e 6567 6174 6976  atically negativ
-0001e780: 6521 292e 0d0a 2020 2020 2020 2020 2020  e!)...          
-0001e790: 2020 496e 206e 6f6e 2d72 6f74 6174 6564    In non-rotated
-0001e7a0: 2073 7461 7465 2c20 5820 7265 6673 2074   state, X refs t
-0001e7b0: 6f20 4e6f 7274 6820 616e 6420 5920 746f  o North and Y to
-0001e7c0: 2045 6173 7420 6469 7265 6374 696f 6e2e   East direction.
-0001e7d0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-0001e7e0: 2020 2020 2020 2020 6f75 743a 2062 6f6f          out: boo
-0001e7f0: 6c20 2c20 6465 6661 756c 7420 3d46 616c  l , default =Fal
-0001e800: 7365 2c20 0d0a 2020 2020 2020 2020 2020  se, ..          
-0001e810: 204f 7574 7075 7420 6e65 7720 6669 6c74   Output new filt
-0001e820: 6572 6564 2045 4449 2e20 4f74 6865 7277  ered EDI. Otherw
-0001e830: 6973 6520 7265 7475 726e 205a 2063 6f6c  ise return Z col
-0001e840: 6c65 6374 696f 6e73 206f 626a 6563 7473  lections objects
-0001e850: 200d 0a20 2020 2020 2020 2020 2020 6f66   ..           of
-0001e860: 2063 6f72 7265 6374 6564 2054 656e 736f   corrected Tenso
-0001e870: 7273 2e20 0d0a 2020 2020 2020 2020 2020  rs. ..          
-0001e880: 200d 0a20 2020 2020 2020 2073 733a 2064   ..        ss: d
-0001e890: 6963 742c 200d 0a20 2020 2020 2020 2020  ict, ..         
-0001e8a0: 2020 4164 6469 7469 6f6e 616c 206b 7765    Additional kwe
-0001e8b0: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
-0001e8c0: 7061 7373 6564 2074 6f20 0d0a 2020 2020  passed to ..    
-0001e8d0: 2020 2020 2020 203a 6d65 7468 3a60 6765         :meth:`ge
-0001e8e0: 745f 7373 5f63 6f72 7265 6374 696f 6e5f  t_ss_correction_
-0001e8f0: 6661 6374 6f72 7360 0d0a 2020 2020 2020  factors`..      
-0001e900: 2020 2020 200d 0a20 2020 2020 2020 2052       ..        R
-0001e910: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-0001e920: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-0001e930: 2020 0d0a 2020 2020 2020 2020 2820 7374    ..        ( st
-0001e940: 6174 6963 2073 6869 6674 206d 6174 7269  atic shift matri
-0001e950: 782c 636f 6f72 6563 7465 645f 7a29 203a  x,coorected_z) :
-0001e960: 206e 702e 6e64 6172 7261 7920 2828 322c   np.ndarray ((2,
-0001e970: 2032 2929 206f 7220 5c0d 0a20 2020 2020   2)) or \..     
-0001e980: 2020 2020 2020 2077 6174 6578 2e65 7874         watex.ext
-0001e990: 6572 6e61 6c73 2e7a 2e5a 0d0a 2020 2020  ernals.z.Z..    
-0001e9a0: 2020 2020 2020 2020 4966 2060 6065 7870          If ``exp
-0001e9b0: 6f72 7460 6020 6973 2060 6054 7275 6560  ort`` is ``True`
-0001e9c0: 6020 6578 706f 7274 2074 6f20 6e65 7720  ` export to new 
-0001e9d0: 6564 6973 2061 6e64 2072 6574 7572 6e73  edis and returns
-0001e9e0: 200d 0a20 2020 2020 2020 2020 2020 206e   ..            n
-0001e9f0: 6f74 6869 6e67 2e20 0d0a 2020 2020 2020  othing. ..      
-0001ea00: 2020 0d0a 2020 2020 2020 2020 4e6f 7465    ..        Note
-0001ea10: 200d 0a20 2020 2020 2020 202d 2d2d 2d2d   ..        -----
-0001ea20: 0d0a 2020 2020 2020 2020 5468 6520 6661  ..        The fa
-0001ea30: 6374 6f72 7320 6172 6520 696e 2072 6573  ctors are in res
-0001ea40: 6973 7469 7669 7479 2073 6361 6c65 2c20  istivity scale, 
-0001ea50: 736f 2074 6865 2065 6e74 7269 6573 206f  so the entries o
-0001ea60: 6620 2074 6865 206d 6174 7269 7820 0d0a  f  the matrix ..
-0001ea70: 2020 2020 2020 2020 2253 2220 6e65 6564          "S" need
-0001ea80: 2074 6f20 6265 2067 6976 656e 2062 7920   to be given by 
-0001ea90: 7468 6569 7220 7371 7561 7265 2d72 6f6f  their square-roo
-0001eaa0: 7473 2e20 4675 7268 6572 6d6f 7265 2c20  ts. Furhermore, 
-0001eab0: 6073 735f 6678 6020 616e 6420 0d0a 2020  `ss_fx` and ..  
-0001eac0: 2020 2020 2020 6073 735f 6679 6020 6d75        `ss_fy` mu
-0001ead0: 7374 2062 6520 7375 7070 6c69 6564 2066  st be supplied f
-0001eae0: 6f72 2061 206d 616e 7561 6c20 636f 7272  or a manual corr
-0001eaf0: 6563 7469 6f6e 2e20 4966 206f 6e65 2061  ection. If one a
-0001eb00: 7267 756d 656e 7420 6f66 200d 0a20 2020  rgument of ..   
-0001eb10: 2020 2020 2074 6865 2061 666f 7265 6d65       the aforeme
-0001eb20: 6e74 696f 6e6e 6564 2070 6172 616d 6574  ntionned paramet
-0001eb30: 6572 7320 6172 6520 6d69 7373 696e 672c  ers are missing,
-0001eb40: 2074 6865 2061 7574 6f20 6661 6374 6f72   the auto factor
-0001eb50: 2063 6f6d 7075 7461 7469 6f6e 200d 0a20   computation .. 
-0001eb60: 2020 2020 2020 2063 6f75 6c64 2062 6520         could be 
-0001eb70: 7472 6967 6765 7265 6420 616e 6420 7265  triggered and re
-0001eb80: 7365 7420 7468 6520 6769 7665 6e20 7072  set the given pr
-0001eb90: 6576 696f 7573 2067 6976 656e 2066 6163  evious given fac
-0001eba0: 746f 722e 200d 0a20 2020 2020 2020 200d  tor. ..        .
-0001ebb0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-0001ebc0: 7320 0d0a 2020 2020 2020 2020 2d2d 2d2d  s ..        ----
-0001ebd0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0001ebe0: 3e3e 3e20 696d 706f 7274 2077 6174 6578  >>> import watex
-0001ebf0: 200d 0a20 2020 2020 2020 203e 3e3e 2066   ..        >>> f
-0001ec00: 726f 6d20 7761 7465 782e 6d65 7468 6f64  rom watex.method
-0001ec10: 7320 696d 706f 7274 205a 4320 0d0a 2020  s import ZC ..  
-0001ec20: 2020 2020 2020 3e3e 3e20 6564 695f 7361        >>> edi_sa
-0001ec30: 6d70 6c65 203d 2077 6174 6578 2e66 6574  mple = watex.fet
-0001ec40: 6368 5f64 6174 6120 2827 6564 6973 272c  ch_data ('edis',
-0001ec50: 2073 616d 706c 6573 203d 3137 202c 2072   samples =17 , r
-0001ec60: 6574 7572 6e5f 6461 7461 203d 5472 7565  eturn_data =True
-0001ec70: 2029 200d 0a20 2020 2020 2020 203e 3e3e   ) ..        >>>
-0001ec80: 207a 6f20 3d20 5a43 2028 292e 6669 7428   zo = ZC ().fit(
-0001ec90: 6564 695f 7361 6d70 6c65 290d 0a20 2020  edi_sample)..   
-0001eca0: 2020 2020 203e 3e3e 207a 6f2e 6564 694f       >>> zo.ediO
-0001ecb0: 626a 735f 5b30 5d2e 5a2e 7a5b 3a2c 2030  bjs_[0].Z.z[:, 0
-0001ecc0: 2c20 315d 5b3a 375d 0d0a 2020 2020 2020  , 1][:7]..      
-0001ecd0: 2020 6172 7261 7928 5b31 3030 3032 2e34    array([10002.4
-0001ece0: 3620 2b39 3734 372e 3334 6a20 2c20 3131  6 +9747.34j , 11
-0001ecf0: 3637 392e 3434 202b 3837 3134 2e33 3239  679.44 +8714.329
-0001ed00: 6a2c 2031 3538 3936 2e34 3520 2b33 3138  j, 15896.45 +318
-0001ed10: 362e 3733 376a 2c0d 0a20 2020 2020 2020  6.737j,..       
-0001ed20: 2020 2020 2020 2020 3231 3736 332e 3031          21763.01
-0001ed30: 202d 3435 3339 2e34 3035 6a2c 2032 3832   -4539.405j, 282
-0001ed40: 3039 2e33 3620 2d38 3439 342e 3830 386a  09.36 -8494.808j
-0001ed50: 2c20 3139 3533 382e 3638 202d 3234 3030  , 19538.68 -2400
-0001ed60: 2e38 3434 6a2c 0d0a 2020 2020 2020 2020  .844j,..        
-0001ed70: 2020 2020 2020 2020 3839 3038 2e34 3438          8908.448
-0001ed80: 2b35 3235 312e 3135 376a 5d29 0d0a 2020  +5251.157j])..  
-0001ed90: 2020 2020 2020 3e3e 3e20 7a63 203d 207a        >>> zc = z
-0001eda0: 6f2e 7265 6d6f 7665 5f73 7461 7469 635f  o.remove_static_
-0001edb0: 7368 6966 7420 2829 200d 0a20 2020 2020  shift () ..     
-0001edc0: 2020 203e 3e3e 207a 635b 305d 2e7a 5b3a     >>> zc[0].z[:
-0001edd0: 2c20 302c 2031 5d20 5b3a 375d 0d0a 2020  , 0, 1] [:7]..  
-0001ede0: 2020 2020 2020 6172 7261 7928 5b20 3830        array([ 80
-0001edf0: 3238 2e34 3635 3738 3637 362b 3738 3233  28.46578676+7823
-0001ee00: 2e36 3933 3934 3134 386a 2c20 2039 3337  .69394148j,  937
-0001ee10: 342e 3439 3233 3139 3734 2b36 3939 342e  4.49231974+6994.
-0001ee20: 3534 3835 3634 3136 6a2c 0d0a 2020 2020  54856416j,..    
-0001ee30: 2020 2020 2020 2020 2020 2031 3237 3539             12759
-0001ee40: 2e32 3731 3731 3437 352b 3235 3537 2e38  .27171475+2557.8
-0001ee50: 3331 3637 316a 2020 2c20 3137 3436 382e  31671j  , 17468.
-0001ee60: 3036 3039 3737 3139 2d33 3634 332e 3534  06097719-3643.54
-0001ee70: 3934 3630 3331 6a2c 0d0a 2020 2020 2020  946031j,..      
-0001ee80: 2020 2020 2020 2020 2032 3236 3432 2e32           22642.2
-0001ee90: 3138 3137 3639 372d 3638 3138 2e33 3530  1817697-6818.350
-0001eea0: 3232 3531 366a 2c20 3135 3638 322e 3730  22516j, 15682.70
-0001eeb0: 3434 3434 3535 2d31 3932 372e 3033 3533  444455-1927.0353
-0001eec0: 3430 3634 6a2c 0d0a 2020 2020 2020 2020  4064j,..        
-0001eed0: 2020 2020 2020 2020 3731 3530 2e33 3538          7150.358
-0001eee0: 3031 3030 342b 3432 3134 2e38 3336 3538  01004+4214.83658
-0001eef0: 3137 346a 5d29 0d0a 2020 2020 2020 2020  174j])..        
-0001ef00: 2222 220d 0a20 2020 2020 2020 2073 656c  """..        sel
-0001ef10: 662e 696e 7370 6563 7420 0d0a 2020 2020  f.inspect ..    
-0001ef20: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
-0001ef30: 2028 7373 5f66 7820 6973 204e 6f6e 6520   (ss_fx is None 
-0001ef40: 6f72 2073 735f 6679 2069 7320 4e6f 6e65  or ss_fy is None
-0001ef50: 2029 3a20 0d0a 2020 2020 2020 2020 2020   ): ..          
-0001ef60: 2020 7373 5f66 7820 2c20 7373 5f66 7920    ss_fx , ss_fy 
-0001ef70: 3d20 7365 6c66 2e67 6574 5f73 735f 636f  = self.get_ss_co
-0001ef80: 7272 6563 7469 6f6e 5f66 6163 746f 7273  rrection_factors
-0001ef90: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0001efa0: 2020 202a 2a6b 7773 2029 0d0a 2020 2020     **kws )..    
-0001efb0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001efc0: 2020 5a4f 626a 7320 3d5b 5d0d 0a20 2020    ZObjs =[]..   
-0001efd0: 2020 2020 206e 6577 5f65 6469 4f62 6a73       new_ediObjs
-0001efe0: 3d5b 5d0d 0a0d 0a20 2020 2020 2020 2066  =[]....        f
-0001eff0: 6f72 2069 692c 2065 6469 4f62 6a20 696e  or ii, ediObj in
-0001f000: 2065 6e75 6d65 7261 7465 2028 7365 6c66   enumerate (self
-0001f010: 2e65 6469 4f62 6a73 5f29 3a20 0d0a 2020  .ediObjs_): ..  
-0001f020: 2020 2020 2020 2020 2020 7a30 203d 2045            z0 = E
-0001f030: 4d7a 287a 5f61 7272 6179 3d65 6469 4f62  Mz(z_array=ediOb
-0001f040: 6a2e 5a2e 5f7a 202c 200d 0a20 2020 2020  j.Z._z , ..     
-0001f050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f060: 7a5f 6572 725f 6172 7261 793d 2065 6469  z_err_array= edi
-0001f070: 4f62 6a2e 5a2e 5f7a 5f65 7272 2c20 0d0a  Obj.Z._z_err, ..
-0001f080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f090: 6672 6571 203d 2065 6469 4f62 6a2e 5a2e  freq = ediObj.Z.
-0001f0a0: 5f66 7265 7120 0d0a 2020 2020 2020 2020  _freq ..        
-0001f0b0: 2020 2020 2020 2020 2920 0d0a 2020 2020          ) ..    
-0001f0c0: 2020 2020 2020 2020 2320 6e6f 7720 726f          # now ro
-0001f0d0: 7461 7465 2069 6620 706f 7373 6962 6c65  tate if possible
-0001f0e0: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
-0001f0f0: 2061 6e64 2063 6f72 7265 6374 2064 6174   and correct dat
-0001f100: 612e 200d 0a20 2020 2020 2020 2020 2020  a. ..           
-0001f110: 2069 6620 726f 7461 7465 3a20 0d0a 2020   if rotate: ..  
-0001f120: 2020 2020 2020 2020 2020 2020 2020 7a30                z0
-0001f130: 2e72 6f74 6174 6520 2872 6f74 6174 6520  .rotate (rotate 
-0001f140: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
-0001f150: 7373 5f63 6f72 2c20 7a63 6f72 203d 207a  ss_cor, zcor = z
-0001f160: 302e 7265 6d6f 7665 5f73 7328 0d0a 2020  0.remove_ss(..  
-0001f170: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001f180: 6475 6365 5f72 6573 5f66 6163 746f 725f  duce_res_factor_
-0001f190: 783d 7373 5f66 782c 0d0a 2020 2020 2020  x=ss_fx,..      
-0001f1a0: 2020 2020 2020 2020 2020 7265 6475 6365            reduce
-0001f1b0: 5f72 6573 5f66 6163 746f 725f 793d 7373  _res_factor_y=ss
-0001f1c0: 5f66 792c 200d 0a20 2020 2020 2020 2020  _fy, ..         
-0001f1d0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-0001f1e0: 2020 2020 2020 2320 7265 7365 7420 7468        # reset th
-0001f1f0: 6520 6564 694f 626a 7320 746f 2074 6865  e ediObjs to the
-0001f200: 206e 6577 205a 200d 0a20 2020 2020 2020   new Z ..       
-0001f210: 2020 2020 207a 302e 5f7a 203d 207a 636f       z0._z = zco
-0001f220: 7220 200d 0a20 2020 2020 2020 2020 2020  r  ..           
-0001f230: 2065 6469 4f62 6a2e 5a2e 5f7a 3d20 7a63   ediObj.Z._z= zc
-0001f240: 6f72 200d 0a20 2020 2020 2020 2020 2020  or ..           
-0001f250: 200d 0a20 2020 2020 2020 2020 2020 205a   ..            Z
-0001f260: 4f62 6a73 2e61 7070 656e 6420 287a 3020  Objs.append (z0 
-0001f270: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
-0001f280: 6e65 775f 6564 694f 626a 732e 6170 7065  new_ediObjs.appe
-0001f290: 6e64 2028 6564 694f 626a 2029 0d0a 2020  nd (ediObj )..  
-0001f2a0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0001f2b0: 2020 2020 2320 6578 706f 7274 2064 6174      # export dat
-0001f2c0: 6120 746f 200d 0a20 2020 2020 2020 2023  a to ..        #
-0001f2d0: 206e 6577 2065 6469 7320 0d0a 2020 2020   new edis ..    
-0001f2e0: 2020 2020 0d0a 2020 2020 2020 2020 736b      ..        sk
-0001f2f0: 7773 203d 7b0d 0a20 2020 2020 2020 2020  ws ={..         
-0001f300: 2020 2020 2020 226f 7074 696f 6e22 3a20        "option": 
-0001f310: 2777 7269 7465 2720 6966 206f 7574 2020  'write' if out  
-0001f320: 656c 7365 2020 4e6f 6e65 2c20 0d0a 2020  else  None, ..  
-0001f330: 2020 2020 2020 2020 2020 2020 207d 200d               } .
-0001f340: 0a20 2020 2020 2020 2023 7072 696e 7428  .        #print(
-0001f350: 6e65 775f 6564 694f 626a 7329 0d0a 2020  new_ediObjs)..  
-0001f360: 2020 2020 2023 2070 7269 6e74 286e 6577       # print(new
-0001f370: 5f65 6469 4f62 6a73 290d 0a20 2020 2020  _ediObjs)..     
-0001f380: 2020 2072 6574 7572 6e20 2820 6e65 775f     return ( new_
-0001f390: 6564 694f 626a 732c 200d 0a20 2020 2020  ediObjs, ..     
-0001f3a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001f3b0: 6672 6571 735f 2c20 0d0a 2020 2020 2020  freqs_, ..      
-0001f3c0: 2020 2020 2020 2020 2020 5a4f 626a 7320            ZObjs 
-0001f3d0: 292c 2073 6b77 7320 0d0a 2020 2020 0d0a  ), skws ..    ..
-0001f3e0: 2020 2020 0d0a 2020 2020 405f 7a75 7064      ..    @_zupd
-0001f3f0: 6174 6520 286f 7074 696f 6e20 3d27 6e6f  ate (option ='no
-0001f400: 6e65 2729 0d0a 2020 2020 6465 6620 7265  ne')..    def re
-0001f410: 6d6f 7665 5f64 6973 746f 7274 696f 6e20  move_distortion 
-0001f420: 280d 0a20 2020 2020 2020 2073 656c 662c  (..        self,
-0001f430: 0d0a 2020 2020 2020 2020 6469 7374 6f72  ..        distor
-0001f440: 7469 6f6e 3a20 4e44 4172 7261 792c 200d  tion: NDArray, .
-0001f450: 0a20 2020 2020 2020 202f 2c20 0d0a 2020  .        /, ..  
-0001f460: 2020 2020 2020 6572 726f 723a 4e44 4172        error:NDAr
-0001f470: 7261 793d 4e6f 6e65 2c20 0d0a 2020 2020  ray=None, ..    
-0001f480: 2020 2020 6f75 7420 3d46 616c 7365 2c20      out =False, 
-0001f490: 0d0a 2020 2020 2020 2020 2a2a 6b77 732c  ..        **kws,
-0001f4a0: 200d 0a20 2020 2020 2020 2029 3a0d 0a20   ..        ):.. 
-0001f4b0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-0001f4c0: 2020 2020 5265 6d6f 7665 2064 6973 746f      Remove disto
-0001f4d0: 7274 696f 6e20 4420 666f 726d 2061 6e20  rtion D form an 
-0001f4e0: 6f62 7365 7276 6564 2069 6d70 6564 616e  observed impedan
-0001f4f0: 6365 2074 656e 736f 7220 5a2e 200d 0a20  ce tensor Z. .. 
-0001f500: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0001f510: 2041 6c6c 6f77 2074 6f20 6f62 7461 696e   Allow to obtain
-0001f520: 2074 6865 2075 7065 7274 7572 6265 6420   the uperturbed 
-0001f530: 2263 6f72 7265 6374 2220 3a6d 6174 683a  "correct" :math:
-0001f540: 605a 5f7b 307d 6020 6578 7072 6573 7365  `Z_{0}` expresse
-0001f550: 6420 6173 3a20 0d0a 2020 2020 2020 2020  d as: ..        
-0001f560: 2020 2020 0d0a 2020 2020 2020 2020 2e2e      ..        ..
-0001f570: 206d 6174 683a 3a20 0d0a 2020 2020 2020   math:: ..      
-0001f580: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001f590: 2020 205a 203d 2044 202a 205a 5f7b 307d     Z = D * Z_{0}
-0001f5a0: 0d0a 0d0a 0d0a 2020 2020 2020 2020 5061  ......        Pa
-0001f5b0: 7261 6d65 7465 7273 200d 0a20 2020 2020  rameters ..     
-0001f5c0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0001f5d0: 2020 2020 2020 2064 6973 746f 7274 696f         distortio
-0001f5e0: 6e5f 7465 6e73 6f72 3a20 6e70 2e6e 6461  n_tensor: np.nda
-0001f5f0: 7272 6179 2832 2c20 322c 2064 7479 7065  rray(2, 2, dtype
-0001f600: 3d72 6561 6c29 200d 0a20 2020 2020 2020  =real) ..       
-0001f610: 2020 2020 5265 616c 2064 6973 746f 7274      Real distort
-0001f620: 696f 6e20 7465 6e73 6f72 2061 7320 6120  ion tensor as a 
-0001f630: 3278 320d 0a20 2020 0d0a 2020 2020 2020  2x2..   ..      
-0001f640: 2020 6572 726f 723a 206e 702e 6e64 6172    error: np.ndar
-0001f650: 7261 7928 322c 2032 2c20 6474 7970 653d  ray(2, 2, dtype=
-0001f660: 7265 616c 292c 204f 7074 696f 6e61 6c20  real), Optional 
-0001f670: 0d0a 2020 2020 2020 2020 2020 5072 6f70  ..          Prop
-0001f680: 6167 6174 696f 6e20 6f66 2065 7272 6f72  agation of error
-0001f690: 732f 756e 6365 7274 6169 6e74 6965 7320  s/uncertainties 
-0001f6a0: 696e 636c 7564 6564 200d 0a20 2020 2020  included ..     
-0001f6b0: 2020 2020 200d 0a20 2020 2020 2020 206f       ..        o
-0001f6c0: 7574 3a20 626f 6f6c 202c 2064 6566 6175  ut: bool , defau
-0001f6d0: 6c74 203d 4661 6c73 652c 200d 0a20 2020  lt =False, ..   
-0001f6e0: 2020 2020 2020 2020 4f75 7470 7574 206e          Output n
-0001f6f0: 6577 2066 696c 7465 7265 6420 4544 492e  ew filtered EDI.
-0001f700: 204f 7468 6572 7769 7365 2072 6574 7572   Otherwise retur
-0001f710: 6e20 5a20 636f 6c6c 6563 7469 6f6e 7320  n Z collections 
-0001f720: 6f62 6a65 6374 7320 0d0a 2020 2020 2020  objects ..      
-0001f730: 2020 2020 206f 6620 636f 7272 6563 7465       of correcte
-0001f740: 6420 5465 6e73 6f72 732e 200d 0a0d 0a20  d Tensors. .... 
-0001f750: 2020 2020 2020 2052 6574 7572 6e73 200d         Returns .
-0001f760: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001f770: 2d2d 2d0d 0a20 2020 2020 2020 2064 2c20  ---..        d, 
-0001f780: 6e65 775f 7a2c 206e 6577 5f7a 5f65 7272  new_z, new_z_err
-0001f790: 3a20 4e44 4172 7261 7920 2820 3220 7832  : NDArray ( 2 x2
-0001f7a0: 202c 2064 7479 7065 203d 7265 616c 2029   , dtype =real )
-0001f7b0: 0d0a 2020 2020 2020 2020 2020 2d20 696e  ..          - in
-0001f7c0: 7075 7420 6469 7374 6f72 7469 6f6e 2074  put distortion t
-0001f7d0: 656e 736f 720d 0a20 2020 2020 2020 2020  ensor..         
-0001f7e0: 202d 2069 6d70 6564 616e 6365 2074 656e   - impedance ten
-0001f7f0: 736f 7220 7769 7468 2064 6973 746f 7269  sor with distori
-0001f800: 6f6e 2072 656d 6f76 6564 0d0a 2020 2020  on removed..    
-0001f810: 2020 2020 2020 2d20 2069 6d70 6564 616e        -  impedan
-0001f820: 6365 2074 656e 736f 7220 6572 726f 7220  ce tensor error 
-0001f830: 6166 7465 7220 6469 7374 6f72 7469 6f6e  after distortion
-0001f840: 2069 7320 7265 6d6f 7665 6420 0d0a 2020   is removed ..  
-0001f850: 2020 2020 2020 2020 4966 2060 6065 7870          If ``exp
-0001f860: 6f72 743d 5472 7565 6060 2c20 6578 706f  ort=True``, expo
-0001f870: 7274 2074 6f20 6e65 7720 4544 4920 616e  rt to new EDI an
-0001f880: 6420 7265 7475 726e 204e 6f6e 652e 200d  d return None. .
-0001f890: 0a20 2020 2020 2020 2020 200d 0a20 2020  .          ..   
-0001f8a0: 2020 2020 2045 7861 6d70 6c65 7320 0d0a       Examples ..
-0001f8b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001f8c0: 2d0d 0a20 2020 2020 2020 203e 3e3e 2069  -..        >>> i
-0001f8d0: 6d70 6f72 7420 7761 7465 7820 0d0a 2020  mport watex ..  
-0001f8e0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2077        >>> from w
-0001f8f0: 6174 6578 2e6d 6574 686f 6473 2069 6d70  atex.methods imp
-0001f900: 6f72 7420 5a43 200d 0a20 2020 2020 2020  ort ZC ..       
-0001f910: 203e 3e3e 2065 6469 5f73 616d 706c 6520   >>> edi_sample 
-0001f920: 3d20 7761 7465 782e 6665 7463 685f 6461  = watex.fetch_da
-0001f930: 7461 2028 2765 6469 7327 2c20 7361 6d70  ta ('edis', samp
-0001f940: 6c65 7320 3d31 3720 2c20 7265 7475 726e  les =17 , return
-0001f950: 5f64 6174 6120 3d54 7275 6520 2920 0d0a  _data =True ) ..
-0001f960: 2020 2020 2020 2020 3e3e 3e20 7a6f 203d          >>> zo =
-0001f970: 205a 4320 2829 2e66 6974 2865 6469 5f73   ZC ().fit(edi_s
-0001f980: 616d 706c 6529 0d0a 2020 2020 2020 2020  ample)..        
-0001f990: 3e3e 3e20 7a6f 2e65 6469 4f62 6a73 5f5b  >>> zo.ediObjs_[
-0001f9a0: 305d 2e5a 2e7a 5b3a 2c20 302c 2031 5d5b  0].Z.z[:, 0, 1][
-0001f9b0: 3a37 5d0d 0a20 2020 2020 2020 2061 7272  :7]..        arr
-0001f9c0: 6179 285b 3130 3030 322e 3436 202b 3937  ay([10002.46 +97
-0001f9d0: 3437 2e33 346a 202c 2031 3136 3739 2e34  47.34j , 11679.4
-0001f9e0: 3420 2b38 3731 342e 3332 396a 2c20 3135  4 +8714.329j, 15
-0001f9f0: 3839 362e 3435 202b 3331 3836 2e37 3337  896.45 +3186.737
-0001fa00: 6a2c 0d0a 2020 2020 2020 2020 2020 2020  j,..            
-0001fa10: 2020 2032 3137 3633 2e30 3120 2d34 3533     21763.01 -453
-0001fa20: 392e 3430 356a 2c20 3238 3230 392e 3336  9.405j, 28209.36
-0001fa30: 202d 3834 3934 2e38 3038 6a2c 2031 3935   -8494.808j, 195
-0001fa40: 3338 2e36 3820 2d32 3430 302e 3834 346a  38.68 -2400.844j
-0001fa50: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0001fa60: 2020 2038 3930 382e 3434 382b 3532 3531     8908.448+5251
-0001fa70: 2e31 3537 6a5d 290d 0a20 0909 3e3e 3e20  .157j]).. ..>>> 
-0001fa80: 6469 7374 6f72 7469 6f6e 203d 206e 702e  distortion = np.
-0001fa90: 6172 7261 7928 5b5b 312e 322c 202e 355d  array([[1.2, .5]
-0001faa0: 2c5b 2e33 352c 2032 2e31 5d5d 290d 0a20  ,[.35, 2.1]]).. 
-0001fab0: 2020 2020 2020 203e 3e3e 207a 6320 3d20         >>> zc = 
-0001fac0: 7a6f 2e72 656d 6f76 655f 6469 7374 6f72  zo.remove_distor
-0001fad0: 7469 6f6e 2028 6469 7374 6f72 7469 6f6e  tion (distortion
-0001fae0: 290d 0a20 2020 2020 2020 203e 3e3e 207a  )..        >>> z
-0001faf0: 635b 305d 2e7a 5b3a 2c20 302c 2031 5d20  c[0].z[:, 0, 1] 
-0001fb00: 5b3a 375d 0d0a 2009 0961 7272 6179 285b  [:7].. ..array([
-0001fb10: 2039 3732 342e 3532 3634 3339 3233 2b39   9724.52643923+9
-0001fb20: 3433 392e 3936 3530 3331 3938 6a2c 2031  439.96503198j, 1
-0001fb30: 3131 3539 2e32 3539 3237 3530 352b 3834  1159.25927505+84
-0001fb40: 3331 2e31 3130 3139 3139 6a20 2c0d 0a20  31.1101919j ,.. 
-0001fb50: 2020 2020 2020 2020 2020 2020 2020 2031                 1
-0001fb60: 3437 3835 2e35 3236 3433 3932 332b 3331  4785.52643923+31
-0001fb70: 3435 2e33 3833 3234 3039 346a 2c20 3139  45.38324094j, 19
-0001fb80: 3836 342e 3730 3837 3432 2020 2d34 3236  864.708742  -426
-0001fb90: 352e 3830 3136 3633 3131 6a2c 0d0a 2020  5.80166311j,..  
-0001fba0: 2020 2020 2020 2020 2020 2020 2020 3235                25
-0001fbb0: 3633 322e 3533 3531 3831 3234 2d38 3330  632.53518124-830
-0001fbc0: 342e 3838 3039 3338 3137 6a2c 2031 3738  4.88093817j, 178
-0001fbd0: 3839 2e31 3533 3733 3133 342d 3234 3834  89.15373134-2484
-0001fbe0: 2e36 3031 3434 3938 396a 2c0d 0a20 2020  .60144989j,..   
-0001fbf0: 2020 2020 2020 2020 2020 2020 2020 3834                84
-0001fc00: 3133 2e31 3936 3731 3634 322b 3439 3235  13.19671642+4925
-0001fc10: 2e34 3636 3630 3938 316a 5d29 0d0a 2020  .46660981j])..  
-0001fc20: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0001fc30: 2222 220d 0a20 2020 2020 2020 2073 656c  """..        sel
-0001fc40: 662e 696e 7370 6563 7420 0d0a 2020 2020  f.inspect ..    
-0001fc50: 2020 2020 0d0a 2020 2020 2020 2020 6469      ..        di
-0001fc60: 7374 6f72 7469 6f6e 203d 206e 702e 6172  stortion = np.ar
-0001fc70: 7261 7920 2864 6973 746f 7274 696f 6e20  ray (distortion 
-0001fc80: 290d 0a20 2020 2020 2020 2069 6620 6469  )..        if di
-0001fc90: 7374 6f72 7469 6f6e 2e73 6861 7065 2021  stortion.shape !
-0001fca0: 3d20 2832 2c20 3229 203a 0d0a 2020 2020  = (2, 2) :..    
-0001fcb0: 2020 2020 2020 2020 7261 6973 6520 5a45          raise ZE
-0001fcc0: 7272 6f72 2028 2257 726f 6e67 2073 6861  rror ("Wrong sha
-0001fcd0: 7065 2066 6f72 2064 6973 746f 7274 696f  pe for distortio
-0001fce0: 6e2e 2045 7870 6563 7420 7368 6170 653d  n. Expect shape=
-0001fcf0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-0001fd00: 2020 2020 2020 2020 2020 2020 2022 2832               "(2
-0001fd10: 2c20 322c 2064 7479 7065 3d72 6561 6c29  , 2, dtype=real)
-0001fd20: 2066 6f72 2078 782c 2078 792c 2079 7820   for xx, xy, yx 
-0001fd30: 616e 6420 7979 2063 6f6d 706f 6e65 6e74  and yy component
-0001fd40: 732e 2229 0d0a 2020 2020 2020 2020 5a4f  s.")..        ZO
-0001fd50: 626a 7320 3d5b 5d0d 0a20 2020 2020 2020  bjs =[]..       
-0001fd60: 206e 6577 5f65 6469 4f62 6a73 203d 5b5d   new_ediObjs =[]
-0001fd70: 0d0a 2020 2020 2020 2020 666f 7220 6969  ..        for ii
-0001fd80: 2c20 6564 694f 626a 2069 6e20 656e 756d  , ediObj in enum
-0001fd90: 6572 6174 6520 2873 656c 662e 6564 694f  erate (self.ediO
-0001fda0: 626a 735f 293a 200d 0a20 2020 2020 2020  bjs_): ..       
-0001fdb0: 2020 2020 207a 3020 3d20 454d 7a28 7a5f       z0 = EMz(z_
-0001fdc0: 6172 7261 793d 6564 694f 626a 2e5a 2e7a  array=ediObj.Z.z
-0001fdd0: 202c 0d0a 2020 2020 2020 2020 2020 2020   ,..            
-0001fde0: 2020 2020 2020 2020 207a 5f65 7272 5f61           z_err_a
-0001fdf0: 7272 6179 203d 2065 6469 4f62 6a2e 5a2e  rray = ediObj.Z.
-0001fe00: 7a5f 6572 722c 200d 0a20 2020 2020 2020  z_err, ..       
-0001fe10: 2020 2020 2020 2020 2066 7265 7120 3d20           freq = 
-0001fe20: 6564 694f 626a 2e5a 2e5f 6672 6571 200d  ediObj.Z._freq .
-0001fe30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fe40: 2029 200d 0a20 2020 2020 2020 2020 2020   ) ..           
-0001fe50: 2064 2c20 6e65 775f 7a2c 206e 6577 5f7a   d, new_z, new_z
-0001fe60: 5f65 7272 203d 207a 302e 7265 6d6f 7665  _err = z0.remove
-0001fe70: 5f64 6973 746f 7274 696f 6e28 0d0a 2020  _distortion(..  
-0001fe80: 2020 2020 2020 2020 2020 2020 2020 6469                di
-0001fe90: 7374 6f72 7469 6f6e 5f74 656e 736f 723d  stortion_tensor=
-0001fea0: 6469 7374 6f72 7469 6f6e 2c20 6469 7374  distortion, dist
-0001feb0: 6f72 7469 6f6e 5f65 7272 5f74 656e 736f  ortion_err_tenso
-0001fec0: 723d 6572 726f 7229 0d0a 2020 2020 2020  r=error)..      
-0001fed0: 2020 2020 2020 7a30 2e5f 7a20 3d20 6e65        z0._z = ne
-0001fee0: 775f 7a0d 0a20 2020 2020 2020 2020 2020  w_z..           
-0001fef0: 207a 302e 5f7a 5f65 7272 203d 206e 6577   z0._z_err = new
-0001ff00: 5f7a 5f65 7272 0d0a 2020 2020 2020 2020  _z_err..        
-0001ff10: 2020 2020 6564 694f 626a 2e5a 2e5f 7a3d      ediObj.Z._z=
-0001ff20: 206e 6577 5f7a 200d 0a20 2020 2020 2020   new_z ..       
-0001ff30: 2020 2020 2023 7a30 2e63 6f6d 7075 7465       #z0.compute
-0001ff40: 5f72 6573 6973 7469 7669 7479 5f70 6861  _resistivity_pha
-0001ff50: 7365 286e 6577 5f7a 2c20 6e65 775f 7a5f  se(new_z, new_z_
-0001ff60: 6572 7220 2920 0d0a 2020 2020 2020 2020  err ) ..        
-0001ff70: 2020 2020 2320 666f 7220 636f 6e73 6973      # for consis
-0001ff80: 7465 6e63 7920 0d0a 2020 2020 2020 2020  tency ..        
-0001ff90: 2020 2020 5a4f 626a 732e 6170 7065 6e64      ZObjs.append
-0001ffa0: 2028 7a30 2029 200d 0a20 2020 2020 2020   (z0 ) ..       
-0001ffb0: 2020 2020 206e 6577 5f65 6469 4f62 6a73       new_ediObjs
-0001ffc0: 2e61 7070 656e 6420 2865 6469 4f62 6a20  .append (ediObj 
-0001ffd0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
-0001ffe0: 0a20 2020 2020 2020 2023 2065 7870 6f72  .        # expor
-0001fff0: 7420 6461 7461 2074 6f20 0d0a 2020 2020  t data to ..    
-00020000: 2020 2020 2320 6e65 7720 6564 6973 200d      # new edis .
-00020010: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00020020: 2020 2073 6b77 7320 3d7b 0d0a 2020 2020     skws ={..    
-00020030: 2020 2020 2020 2020 2020 2022 6f70 7469             "opti
-00020040: 6f6e 223a 2027 7772 6974 6527 2069 6620  on": 'write' if 
-00020050: 6f75 7420 2065 6c73 6520 204e 6f6e 652c  out  else  None,
-00020060: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00020070: 2020 2023 2022 6564 694f 626a 7322 3a20     # "ediObjs": 
-00020080: 6e65 775f 6564 694f 626a 730d 0a20 2020  new_ediObjs..   
-00020090: 2020 2020 2020 2020 2020 2020 7d20 0d0a              } ..
-000200a0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000200b0: 2028 6e65 775f 6564 694f 626a 732c 200d   (new_ediObjs, .
-000200c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000200d0: 2073 656c 662e 6672 6571 735f 2c20 0d0a   self.freqs_, ..
-000200e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000200f0: 5a4f 626a 7320 292c 2073 6b77 7320 0d0a  ZObjs ), skws ..
-00020100: 2020 2020 0d0a 2020 2020 6465 6620 6765      ..    def ge
-00020110: 745f 7373 5f63 6f72 7265 6374 696f 6e5f  t_ss_correction_
-00020120: 6661 6374 6f72 7328 0d0a 2020 2020 2020  factors(..      
-00020130: 2020 7365 6c66 2c20 0d0a 2020 2020 2020    self, ..      
-00020140: 2020 2f2c 200d 0a20 2020 2020 2020 2072    /, ..        r
-00020150: 3d31 3030 302e 2c20 0d0a 2020 2020 2020  =1000., ..      
-00020160: 2020 6e66 7265 713d 3231 2c0d 0a20 2020    nfreq=21,..   
-00020170: 2020 2020 2073 6b69 7066 7265 713d 352c       skipfreq=5,
-00020180: 200d 0a20 2020 2020 2020 2074 6f6c 3d2e   ..        tol=.
-00020190: 3132 0d0a 2020 2020 2020 2020 2920 2d3e  12..        ) ->
-000201a0: 2054 7570 6c65 5b66 6c6f 6174 2c20 666c   Tuple[float, fl
-000201b0: 6f61 745d 3a0d 0a20 2020 2020 2020 2022  oat]:..        "
-000201c0: 2222 0d0a 2020 2020 2020 2020 436f 6d70  ""..        Comp
-000201d0: 7574 6520 7468 6520 2073 7461 7469 6320  ute the  static 
-000201e0: 7368 6966 7420 636f 7272 6563 7469 6f6e  shift correction
-000201f0: 2066 6163 746f 7220 6672 6f6d 2061 2073   factor from a s
-00020200: 7461 7469 6f6e 200d 0a20 2020 2020 2020  tation ..       
-00020210: 2075 7369 6e67 2061 2073 7061 7469 616c   using a spatial
-00020220: 206d 6564 6961 6e20 6669 6c74 6572 2e20   median filter. 
-00020230: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00020240: 2020 2020 2054 6869 7320 7769 6c6c 2066       This will f
-00020250: 696e 6420 7468 6f73 6520 7374 6174 696f  ind those statio
-00020260: 6e20 7769 7468 696e 2074 6865 2067 6976  n within the giv
-00020270: 656e 2072 6164 6975 7320 286d 6574 6572  en radius (meter
-00020280: 7329 2e20 200d 0a20 2020 2020 2020 2054  s).  ..        T
-00020290: 6865 6e20 6974 2077 696c 6c20 6669 6e64  hen it will find
-000202a0: 2074 6865 206d 6564 6961 6e20 7374 6174   the median stat
-000202b0: 6963 2073 6869 6674 2066 6f72 2074 6865  ic shift for the
-000202c0: 2078 2061 6e64 2079 206d 6f64 6573 200d   x and y modes .
-000202d0: 0a20 2020 2020 2020 2061 6e64 2072 656d  .        and rem
-000202e0: 6f76 6520 6974 2c20 6769 7665 6e20 7468  ove it, given th
-000202f0: 6174 2069 7420 6973 206c 6172 6765 7220  at it is larger 
-00020300: 7468 616e 2074 6865 2073 6869 6674 200d  than the shift .
-00020310: 0a20 2020 2020 2020 2074 6f6c 6572 616e  .        toleran
-00020320: 6365 2061 7761 7920 6672 6f6d 2031 2e20  ce away from 1. 
-00020330: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00020340: 2020 2020 2050 6172 616d 6574 6572 7320       Parameters 
-00020350: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00020360: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00020370: 2072 3a20 666c 6f61 742c 2064 6566 6175   r: float, defau
-00020380: 6c74 3d31 3030 302e 200d 0a20 2020 2020  lt=1000. ..     
-00020390: 2020 2020 2020 7261 6469 7573 2074 6f20        radius to 
-000203a0: 6c6f 6f6b 2066 6f72 206e 6561 7262 7920  look for nearby 
-000203b0: 7374 6174 696f 6e73 2c20 696e 206d 6574  stations, in met
-000203c0: 6572 732e 0d0a 200d 0a20 2020 2020 2020  ers... ..       
-000203d0: 206e 6672 6571 3a20 696e 742c 2064 6566   nfreq: int, def
-000203e0: 6175 6c74 3d32 3120 0d0a 2020 2020 2020  ault=21 ..      
-000203f0: 2020 2020 206e 756d 6265 7220 6f66 2066       number of f
-00020400: 7265 7175 656e 6369 6573 2063 616c 6375  requencies calcu
-00020410: 6c61 7465 2074 6865 206d 6564 6961 6e20  late the median 
-00020420: 7374 6174 6963 2073 6869 6674 2e20 200d  static shift.  .
-00020430: 0a20 2020 2020 2020 2020 2020 5468 6973  .           This
-00020440: 2069 7320 6173 7375 6d69 6e67 2074 6865   is assuming the
-00020450: 2066 6972 7374 2066 7265 7175 656e 6379   first frequency
-00020460: 2069 7320 7468 6520 6869 6768 6573 7420   is the highest 
-00020470: 6672 6571 7565 6e63 792e 2020 0d0a 2020  frequency.  ..  
-00020480: 2020 2020 2020 2020 2043 6175 7365 2075           Cause u
-00020490: 7375 616c 6c79 2068 6967 6865 7374 2066  sually highest f
-000204a0: 7265 7175 656e 6369 6573 2061 7265 2073  requencies are s
-000204b0: 616d 706c 696e 6720 6120 3144 2065 6172  ampling a 1D ear
-000204c0: 7468 2e20 200d 0a20 2020 200d 0a20 2020  th.  ..    ..   
-000204d0: 2020 2020 2073 6b69 7066 7265 712a 2a20       skipfreq** 
-000204e0: 3a20 696e 742c 2064 6566 6175 6c74 3d35  : int, default=5
-000204f0: 200d 0a20 2020 2020 2020 2020 2020 6e75   ..           nu
-00020500: 6d62 6572 206f 6620 6672 6571 7565 6e63  mber of frequenc
-00020510: 6965 7320 746f 2073 6b69 7020 6672 6f6d  ies to skip from
-00020520: 2074 6865 2068 6967 6865 7374 2066 7265   the highest fre
-00020530: 7175 656e 6379 2e20 200d 0a20 2020 2020  quency.  ..     
-00020540: 2020 2020 2020 536f 6d65 7469 6d65 7320        Sometimes 
-00020550: 7468 6520 6869 6768 6573 7420 6672 6571  the highest freq
-00020560: 7565 6e63 6965 7320 6172 6520 6e6f 7420  uencies are not 
-00020570: 7265 6c69 6162 6c65 2064 7565 2074 6f20  reliable due to 
-00020580: 6e6f 6973 6520 0d0a 2020 2020 2020 2020  noise ..        
-00020590: 2020 206f 7220 6c6f 7720 7369 676e 616c     or low signal
-000205a0: 2069 6e20 7468 6520 3a74 6572 6d3a 6041   in the :term:`A
-000205b0: 4d54 6020 6465 6164 6261 6e64 2e20 2054  MT` deadband.  T
-000205c0: 6869 7320 616c 6c6f 7773 2079 6f75 2074  his allows you t
-000205d0: 6f20 0d0a 2020 2020 2020 2020 2020 2073  o ..           s
-000205e0: 6b69 7020 7468 6f73 6520 6672 6571 7565  kip those freque
-000205f0: 6e63 6965 732e 0d0a 2020 2020 2020 2020  ncies...        
-00020600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020610: 2020 200d 0a20 2020 200d 0a20 2020 2020     ..    ..     
-00020620: 2020 2074 6f6c 3a20 666c 6f61 742c 2064     tol: float, d
-00020630: 6566 6175 6c74 3d30 2e31 320d 0a20 2020  efault=0.12..   
-00020640: 2020 2020 2020 2020 546f 6c65 7261 6e63          Toleranc
-00020650: 6520 6f6e 2074 6865 206d 6564 6961 6e20  e on the median 
-00020660: 7374 6174 6963 2073 6869 6674 2063 6f72  static shift cor
-00020670: 7265 6374 696f 6e2e 2020 4966 2074 6865  rection.  If the
-00020680: 2064 6174 6120 6973 200d 0a20 2020 2020   data is ..     
-00020690: 2020 2020 2020 6e6f 6973 7920 7468 6520        noisy the 
-000206a0: 636f 7272 6563 7469 6f6e 2066 6163 746f  correction facto
-000206b0: 7220 6361 6e20 6265 2062 6961 7365 6420  r can be biased 
-000206c0: 6177 6179 2066 726f 6d20 312e 2020 5468  away from 1.  Th
-000206d0: 6572 6566 6f72 6520 0d0a 2020 2020 2020  erefore ..      
-000206e0: 2020 2020 2074 6865 2073 6869 6674 5f74       the shift_t
-000206f0: 6f6c 2069 7320 7573 6564 2074 6f20 7374  ol is used to st
-00020700: 6f70 2074 6861 7420 6269 6173 2e20 2049  op that bias.  I
-00020710: 6620 0d0a 2020 2020 2020 2020 2020 2060  f ..           `
-00020720: 6031 2d74 6f6c 203c 2063 6f72 7265 6374  `1-tol < correct
-00020730: 696f 6e20 3c20 312b 746f 6c60 6020 7468  ion < 1+tol`` th
-00020740: 656e 2074 6865 2063 6f72 7265 6374 696f  en the correctio
-00020750: 6e20 6661 6374 6f72 2069 7320 7365 7420  n factor is set 
-00020760: 0d0a 2020 2020 2020 2020 2020 2074 6f20  ..           to 
-00020770: 6060 3160 600d 0a20 200d 0a20 2020 2020  ``1``..  ..     
-00020780: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-00020790: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
-000207a0: 2020 2020 2028 7378 5f78 2c20 2073 735f       (sx_x,  ss_
-000207b0: 7929 3a20 2866 6c6f 6174 2c20 666c 6f61  y): (float, floa
-000207c0: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-000207d0: 7374 6174 6963 2073 6869 6674 2063 6f72  static shift cor
-000207e0: 7265 6374 696f 6e73 2066 6163 746f 7220  rections factor 
-000207f0: 666f 7220 7820 616e 6420 7920 6d6f 6465  for x and y mode
-00020800: 730d 0a20 2020 200d 0a20 2020 2020 2020  s..    ..       
-00020810: 2045 7861 6d70 6c65 7320 0d0a 2020 2020   Examples ..    
-00020820: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0d 0a20      ---------.. 
-00020830: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
-00020840: 7420 7761 7465 7820 0d0a 2020 2020 2020  t watex ..      
-00020850: 2020 3e3e 3e20 6672 6f6d 2077 6174 6578    >>> from watex
-00020860: 2e6d 6574 686f 6473 2069 6d70 6f72 7420  .methods import 
-00020870: 5a43 200d 0a20 2020 2020 2020 203e 3e3e  ZC ..        >>>
-00020880: 2065 6469 5f73 616d 706c 6520 3d20 7761   edi_sample = wa
-00020890: 7465 782e 6665 7463 685f 6461 7461 2028  tex.fetch_data (
-000208a0: 2765 6469 7327 2c20 7361 6d70 6c65 7320  'edis', samples 
-000208b0: 3d31 3720 2c0d 0a20 2020 2020 2020 2020  =17 ,..         
+0001ddb0: 2920 0d0a 2020 2020 0d0a 2020 2020 2020  ) ..    ..      
+0001ddc0: 2020 2020 2020 2020 2020 7a63 5f65 7272            zc_err
+0001ddd0: 203d 2073 656c 662e 6d61 6b65 3264 2028   = self.make2d (
+0001dde0: 6622 7a7b 636f 6d70 7d5f 6572 7222 2920  f"z{comp}_err") 
+0001ddf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001de00: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0001de10: 6578 6365 7074 203a 200d 0a20 2020 2020  except : ..     
+0001de20: 2020 2020 2020 2020 2020 2023 2049 6e20             # In 
+0001de30: 7468 6520 6361 7365 2073 6f6d 6520 636f  the case some co
+0001de40: 6d70 6f6e 656e 7473 200d 0a20 2020 2020  mponents ..     
+0001de50: 2020 2020 2020 2020 2020 2023 2061 7265             # are
+0001de60: 206d 6973 7369 6e67 2c20 7365 7420 746f   missing, set to
+0001de70: 206e 756c 6c20 0d0a 2020 2020 2020 2020   null ..        
+0001de80: 2020 2020 2020 2020 7a63 203d 206e 702e          zc = np.
+0001de90: 7a65 726f 7320 280d 0a20 2020 2020 2020  zeros (..       
+0001dea0: 2020 2020 2020 2020 2020 2020 2028 6c65               (le
+0001deb0: 6e28 7365 6c66 2e66 7265 7173 5f29 2c20  n(self.freqs_), 
+0001dec0: 6c65 6e28 7365 6c66 2e65 6469 4f62 6a73  len(self.ediObjs
+0001ded0: 5f29 292c 0d0a 2020 2020 2020 2020 2020  _)),..          
+0001dee0: 2020 2020 2020 2020 2020 6474 7970 6520            dtype 
+0001def0: 3d20 6e70 2e63 6f6d 706c 6578 3132 3829  = np.complex128)
+0001df00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001df10: 2020 7a63 5f65 7272 3d20 7a63 2e63 6f70    zc_err= zc.cop
+0001df20: 7928 2920 0d0a 2020 2020 2020 2020 2020  y() ..          
+0001df30: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0001df40: 7a64 5b66 277a 7b63 6f6d 707d 275d 203d  zd[f'z{comp}'] =
+0001df50: 207a 6320 0d0a 2020 2020 2020 2020 2020   zc ..          
+0001df60: 2020 7a64 5b66 277a 7b63 6f6d 707d 5f65    zd[f'z{comp}_e
+0001df70: 7272 275d 3d7a 635f 6572 720d 0a20 2020  rr']=zc_err..   
+0001df80: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0001df90: 2020 2023 206d 616e 6167 6520 6564 6920     # manage edi 
+0001dfa0: 2d65 7870 6f72 7420 0d0a 2020 2020 2020  -export ..      
+0001dfb0: 2020 6f70 7469 6f6e 203d 6b77 732e 706f    option =kws.po
+0001dfc0: 7028 276f 7074 696f 6e27 2c20 4e6f 6e65  p('option', None
+0001dfd0: 2029 0d0a 2020 2020 2020 2020 6f70 7469   )..        opti
+0001dfe0: 6f6e 203d 2027 7772 6974 6527 2069 6620  on = 'write' if 
+0001dff0: 6f75 7420 656c 7365 204e 6f6e 6520 0d0a  out else None ..
+0001e000: 2020 2020 2020 2020 2320 7265 7365 7420          # reset 
+0001e010: 206f 7074 696f 6e20 0d0a 2020 2020 2020   option ..      
+0001e020: 2020 6b77 732e 5f5f 7365 7469 7465 6d5f    kws.__setitem_
+0001e030: 5f28 276f 7074 696f 6e27 2c20 6f70 7469  _('option', opti
+0001e040: 6f6e 2029 200d 0a20 2020 2020 2020 200d  on ) ..        .
+0001e050: 0a20 2020 200d 0a20 2020 2020 2020 2072  .    ..        r
+0001e060: 6574 7572 6e20 2873 656c 662e 6564 694f  eturn (self.ediO
+0001e070: 626a 735f 2c20 7365 6c66 2e66 7265 7173  bjs_, self.freqs
+0001e080: 5f20 2c20 7a64 2029 2c20 6b77 730d 0a20  _ , zd ), kws.. 
+0001e090: 2020 0d0a 2020 2020 405f 7a75 7064 6174    ..    @_zupdat
+0001e0a0: 6520 286f 7074 696f 6e20 3d27 6e6f 6e65  e (option ='none
+0001e0b0: 2729 0d0a 2020 2020 6465 6620 7265 6d6f  ')..    def remo
+0001e0c0: 7665 5f73 7461 7469 635f 7368 6966 7420  ve_static_shift 
+0001e0d0: 280d 0a20 2020 2020 2020 2073 656c 662c  (..        self,
+0001e0e0: 200d 0a20 2020 2020 2020 2073 735f 6678   ..        ss_fx
+0001e0f0: 3a66 6c6f 6174 203d 4e6f 6e65 2c20 0d0a  :float =None, ..
+0001e100: 2020 2020 2020 2020 7373 5f66 793a 666c          ss_fy:fl
+0001e110: 6f61 743d 204e 6f6e 652c 200d 0a20 2020  oat= None, ..   
+0001e120: 2020 2020 206f 7574 3a62 6f6f 6c20 3d46       out:bool =F
+0001e130: 616c 7365 202c 200d 0a20 2020 2020 2020  alse , ..       
+0001e140: 2072 6f74 6174 653a 666c 6f61 743d 302e   rotate:float=0.
+0001e150: 2c20 0d0a 2020 2020 2020 2020 2a2a 6b77  , ..        **kw
+0001e160: 730d 0a20 2020 2020 2020 2029 3a20 0d0a  s..        ): ..
+0001e170: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0001e180: 2020 2020 2052 656d 6f76 6520 7468 6520       Remove the 
+0001e190: 7374 6174 6963 2073 6869 6674 2066 726f  static shift fro
+0001e1a0: 6d20 636f 7272 6563 7469 6f6e 2066 6163  m correction fac
+0001e1b0: 746f 7220 6672 6f6d 2078 2061 6e64 2079  tor from x and y
+0001e1c0: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
+0001e1d0: 2020 2020 2020 5468 6520 636f 7272 6563        The correc
+0001e1e0: 7469 6f6e 2066 6163 746f 7273 2060 7373  tion factors `ss
+0001e1f0: 5f66 7860 2061 6e64 2060 7373 5f66 7960  _fx` and `ss_fy`
+0001e200: 2061 7265 2075 7365 6420 666f 7220 7468   are used for th
+0001e210: 6520 0d0a 2020 2020 2020 2020 7265 7369  e ..        resi
+0001e220: 7374 6976 6974 7920 696e 2074 6865 2078  stivity in the x
+0001e230: 2061 6e64 2079 2020 636f 6d70 6f6e 656e   and y  componen
+0001e240: 7473 2066 6f72 2073 7461 7469 6320 7368  ts for static sh
+0001e250: 6966 7420 7265 6d6f 7661 6c2e 0d0a 2020  ift removal...  
+0001e260: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0001e270: 4661 6374 6f72 7320 6361 6e20 6265 2064  Factors can be d
+0001e280: 6574 6572 6d69 6e65 6420 6279 2075 7369  etermined by usi
+0001e290: 6e67 2074 6865 203a 6d65 7468 3a60 6765  ng the :meth:`ge
+0001e2a0: 745f 7373 5f63 6f72 7265 6374 696f 6e5f  t_ss_correction_
+0001e2b0: 6661 6374 6f72 7360 0d0a 2020 2020 2020  factors`..      
+0001e2c0: 2020 4966 2060 604e 6f6e 6560 602c 2066    If ``None``, f
+0001e2d0: 6163 746f 7273 2061 7265 2066 6f75 6e64  actors are found
+0001e2e0: 2075 7369 6e67 2074 6865 2073 7061 7469   using the spati
+0001e2f0: 616c 206d 6564 6961 6e20 6669 6c74 6572  al median filter
+0001e300: 2e20 0d0a 2020 2020 2020 2020 4173 7375  . ..        Assu
+0001e310: 6d65 2074 6865 206f 7269 6769 6e61 6c20  me the original 
+0001e320: 6f62 7365 7276 6564 2074 656e 736f 7220  observed tensor 
+0001e330: 5a20 6973 2062 7569 6c74 2062 7920 6120  Z is built by a 
+0001e340: 7374 6174 6963 2073 6869 6674 200d 0a20  static shift .. 
+0001e350: 2020 2020 2020 203a 6d61 7468 3a60 5360         :math:`S`
+0001e360: 2061 6e64 2061 6e20 756e 7065 7274 7572   and an unpertur
+0001e370: 6261 7465 6420 2263 6f72 7265 6374 2220  bated "correct" 
+0001e380: 3a6d 6174 683a 605a 5f7b 307d 203a 0d0a  :math:`Z_{0} :..
+0001e390: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0001e3a0: 2020 2e2e 206d 6174 683a 3a0d 0a20 200d    .. math::..  .
+0001e3b0: 0a20 2020 2020 2020 2020 2020 2020 5a20  .             Z 
+0001e3c0: 3d20 5320 2a20 5a5f 7b30 7d0d 0a0d 0a20  = S * Z_{0}.... 
+0001e3d0: 2020 2020 2020 2074 6865 7265 666f 7265         therefore
+0001e3e0: 2074 6865 2063 6f72 7265 6374 205a 2077   the correct Z w
+0001e3f0: 696c 6c20 6265 3a20 0d0a 2020 2020 2020  ill be: ..      
+0001e400: 2020 0d0a 2020 2020 2020 2020 2e2e 206d    ..        .. m
+0001e410: 6174 683a 3a0d 0a20 2020 2020 2020 2020  ath::..         
+0001e420: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+0001e430: 205a 5f7b 307d 203d 2053 5e7b 282d 3129   Z_{0} = S^{(-1)
+0001e440: 7d20 2a20 5a0d 0a0d 0a20 2020 2020 2020  } * Z....       
+0001e450: 2050 6172 616d 6574 6572 7320 0d0a 2020   Parameters ..  
+0001e460: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001e470: 2d0d 0a20 2020 2020 2020 200d 0a20 2020  -..        ..   
+0001e480: 2020 2020 2073 735f 6678 3a20 666c 6f61       ss_fx: floa
+0001e490: 742c 204f 7074 696f 6e61 6c20 200d 0a20  t, Optional  .. 
+0001e4a0: 2020 2020 2020 2020 2020 7374 6174 6963            static
+0001e4b0: 2073 6869 6674 2066 6163 746f 7220 746f   shift factor to
+0001e4c0: 2062 6520 6170 706c 6965 6420 746f 2078   be applied to x
+0001e4d0: 2063 6f6d 706f 6e65 6e74 730d 0a20 2020   components..   
+0001e4e0: 2020 2020 2020 2020 2869 6520 7a5b 3a2c          (ie z[:,
+0001e4f0: 2030 2c20 3a5d 292e 2020 5468 6973 2069   0, :]).  This i
+0001e500: 7320 6173 7375 6d65 6420 746f 2062 6520  s assumed to be 
+0001e510: 696e 2072 6573 6973 7469 7669 7479 2073  in resistivity s
+0001e520: 6361 6c65 2e20 0d0a 2020 2020 2020 2020  cale. ..        
+0001e530: 2020 2049 6620 4e6f 6e65 2073 686f 756c     If None shoul
+0001e540: 6420 6265 2061 7574 6f6d 6174 6963 616c  d be automatical
+0001e550: 6c79 2063 6f6d 7075 7465 6420 7573 696e  ly computed usin
+0001e560: 6720 2074 6865 200d 0a20 2020 2020 2020  g  the ..       
+0001e570: 2020 2020 7370 6174 6961 6c20 6d65 6469      spatial medi
+0001e580: 616e 2066 696c 7465 722e 200d 0a20 2020  an filter. ..   
+0001e590: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0001e5a0: 2020 7373 5f66 793a 2066 6c6f 6174 2c20    ss_fy: float, 
+0001e5b0: 6f70 7469 6f6e 616c 200d 0a20 2020 2020  optional ..     
+0001e5c0: 2020 2020 2020 7374 6174 6963 2073 6869        static shi
+0001e5d0: 6674 2066 6163 746f 7220 746f 2062 6520  ft factor to be 
+0001e5e0: 6170 706c 6965 6420 746f 2079 2063 6f6d  applied to y com
+0001e5f0: 706f 6e65 6e74 7320 0d0a 2020 2020 2020  ponents ..      
+0001e600: 2020 2020 2028 6965 207a 5b3a 2c20 312c       (ie z[:, 1,
+0001e610: 203a 5d29 2e20 2054 6869 7320 6973 2061   :]).  This is a
+0001e620: 7373 756d 6564 2074 6f20 6265 2069 6e20  ssumed to be in 
+0001e630: 7265 7369 7374 6976 6974 7920 7363 616c  resistivity scal
+0001e640: 652e 2049 660d 0a20 2020 2020 2020 2020  e. If..         
+0001e650: 2020 6060 4e6f 6e65 6060 202c 2073 686f    ``None`` , sho
+0001e660: 756c 6420 6265 2063 6f6d 7075 7465 6420  uld be computed 
+0001e670: 7573 696e 6720 7468 6520 7370 6174 6961  using the spatia
+0001e680: 6c20 6669 6c74 6572 206d 6564 6961 6e2e  l filter median.
+0001e690: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0001e6a0: 2020 2020 2072 6f74 6174 653a 2066 6c6f       rotate: flo
+0001e6b0: 6174 2c20 6465 6661 756c 743d 302e 2020  at, default=0.  
+0001e6c0: 0d0a 2020 2020 2020 2020 2020 2020 526f  ..            Ro
+0001e6d0: 7461 7465 205a 2061 7272 6179 2062 7920  tate Z array by 
+0001e6e0: 616e 676c 6520 616c 7068 6120 696e 2064  angle alpha in d
+0001e6f0: 6567 7265 6573 2e20 2041 6c6c 2061 6e67  egrees.  All ang
+0001e700: 6c65 7320 6172 6520 7265 6665 7265 6e63  les are referenc
+0001e710: 6564 0d0a 2020 2020 2020 2020 2020 2020  ed..            
+0001e720: 746f 2067 656f 6772 6170 6869 6320 4e6f  to geographic No
+0001e730: 7274 682c 2070 6f73 6974 6976 6520 696e  rth, positive in
+0001e740: 2063 6c6f 636b 7769 7365 2064 6972 6563   clockwise direc
+0001e750: 7469 6f6e 2e0d 0a20 2020 2020 2020 2020  tion...         
+0001e760: 2020 2028 4d61 7468 656d 6174 6963 616c     (Mathematical
+0001e770: 6c79 206e 6567 6174 6976 6521 292e 0d0a  ly negative!)...
+0001e780: 2020 2020 2020 2020 2020 2020 496e 206e              In n
+0001e790: 6f6e 2d72 6f74 6174 6564 2073 7461 7465  on-rotated state
+0001e7a0: 2c20 5820 7265 6673 2074 6f20 4e6f 7274  , X refs to Nort
+0001e7b0: 6820 616e 6420 5920 746f 2045 6173 7420  h and Y to East 
+0001e7c0: 6469 7265 6374 696f 6e2e 0d0a 2020 2020  direction...    
+0001e7d0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+0001e7e0: 2020 6f75 743a 2062 6f6f 6c20 2c20 6465    out: bool , de
+0001e7f0: 6661 756c 7420 3d46 616c 7365 2c20 0d0a  fault =False, ..
+0001e800: 2020 2020 2020 2020 2020 204f 7574 7075             Outpu
+0001e810: 7420 6e65 7720 6669 6c74 6572 6564 2045  t new filtered E
+0001e820: 4449 2e20 4f74 6865 7277 6973 6520 7265  DI. Otherwise re
+0001e830: 7475 726e 205a 2063 6f6c 6c65 6374 696f  turn Z collectio
+0001e840: 6e73 206f 626a 6563 7473 200d 0a20 2020  ns objects ..   
+0001e850: 2020 2020 2020 2020 6f66 2063 6f72 7265          of corre
+0001e860: 6374 6564 2054 656e 736f 7273 2e20 0d0a  cted Tensors. ..
+0001e870: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0001e880: 2020 2020 2073 733a 2064 6963 742c 200d       ss: dict, .
+0001e890: 0a20 2020 2020 2020 2020 2020 4164 6469  .           Addi
+0001e8a0: 7469 6f6e 616c 206b 7765 7977 6f72 6420  tional kweyword 
+0001e8b0: 6172 6775 6d65 6e74 7320 7061 7373 6564  arguments passed
+0001e8c0: 2074 6f20 0d0a 2020 2020 2020 2020 2020   to ..          
+0001e8d0: 203a 6d65 7468 3a60 6765 745f 7373 5f63   :meth:`get_ss_c
+0001e8e0: 6f72 7265 6374 696f 6e5f 6661 6374 6f72  orrection_factor
+0001e8f0: 7360 0d0a 2020 2020 2020 2020 2020 200d  s`..           .
+0001e900: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0001e910: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0001e920: 2d2d 0d0a 2020 2020 2020 2020 0d0a 2020  --..        ..  
+0001e930: 2020 2020 2020 2820 7374 6174 6963 2073        ( static s
+0001e940: 6869 6674 206d 6174 7269 782c 636f 6f72  hift matrix,coor
+0001e950: 6563 7465 645f 7a29 203a 206e 702e 6e64  ected_z) : np.nd
+0001e960: 6172 7261 7920 2828 322c 2032 2929 206f  array ((2, 2)) o
+0001e970: 7220 5c0d 0a20 2020 2020 2020 2020 2020  r \..           
+0001e980: 2077 6174 6578 2e65 7874 6572 6e61 6c73   watex.externals
+0001e990: 2e7a 2e5a 0d0a 2020 2020 2020 2020 2020  .z.Z..          
+0001e9a0: 2020 4966 2060 6065 7870 6f72 7460 6020    If ``export`` 
+0001e9b0: 6973 2060 6054 7275 6560 6020 6578 706f  is ``True`` expo
+0001e9c0: 7274 2074 6f20 6e65 7720 6564 6973 2061  rt to new edis a
+0001e9d0: 6e64 2072 6574 7572 6e73 200d 0a20 2020  nd returns ..   
+0001e9e0: 2020 2020 2020 2020 206e 6f74 6869 6e67           nothing
+0001e9f0: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
+0001ea00: 2020 2020 2020 4e6f 7465 200d 0a20 2020        Note ..   
+0001ea10: 2020 2020 202d 2d2d 2d2d 0d0a 2020 2020       -----..    
+0001ea20: 2020 2020 5468 6520 6661 6374 6f72 7320      The factors 
+0001ea30: 6172 6520 696e 2072 6573 6973 7469 7669  are in resistivi
+0001ea40: 7479 2073 6361 6c65 2c20 736f 2074 6865  ty scale, so the
+0001ea50: 2065 6e74 7269 6573 206f 6620 2074 6865   entries of  the
+0001ea60: 206d 6174 7269 7820 0d0a 2020 2020 2020   matrix ..      
+0001ea70: 2020 2253 2220 6e65 6564 2074 6f20 6265    "S" need to be
+0001ea80: 2067 6976 656e 2062 7920 7468 6569 7220   given by their 
+0001ea90: 7371 7561 7265 2d72 6f6f 7473 2e20 4675  square-roots. Fu
+0001eaa0: 7268 6572 6d6f 7265 2c20 6073 735f 6678  rhermore, `ss_fx
+0001eab0: 6020 616e 6420 0d0a 2020 2020 2020 2020  ` and ..        
+0001eac0: 6073 735f 6679 6020 6d75 7374 2062 6520  `ss_fy` must be 
+0001ead0: 7375 7070 6c69 6564 2066 6f72 2061 206d  supplied for a m
+0001eae0: 616e 7561 6c20 636f 7272 6563 7469 6f6e  anual correction
+0001eaf0: 2e20 4966 206f 6e65 2061 7267 756d 656e  . If one argumen
+0001eb00: 7420 6f66 200d 0a20 2020 2020 2020 2074  t of ..        t
+0001eb10: 6865 2061 666f 7265 6d65 6e74 696f 6e6e  he aforementionn
+0001eb20: 6564 2070 6172 616d 6574 6572 7320 6172  ed parameters ar
+0001eb30: 6520 6d69 7373 696e 672c 2074 6865 2061  e missing, the a
+0001eb40: 7574 6f20 6661 6374 6f72 2063 6f6d 7075  uto factor compu
+0001eb50: 7461 7469 6f6e 200d 0a20 2020 2020 2020  tation ..       
+0001eb60: 2063 6f75 6c64 2062 6520 7472 6967 6765   could be trigge
+0001eb70: 7265 6420 616e 6420 7265 7365 7420 7468  red and reset th
+0001eb80: 6520 6769 7665 6e20 7072 6576 696f 7573  e given previous
+0001eb90: 2067 6976 656e 2066 6163 746f 722e 200d   given factor. .
+0001eba0: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0001ebb0: 2020 2045 7861 6d70 6c65 7320 0d0a 2020     Examples ..  
+0001ebc0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001ebd0: 0d0a 2020 2020 2020 2020 3e3e 3e20 696d  ..        >>> im
+0001ebe0: 706f 7274 2077 6174 6578 200d 0a20 2020  port watex ..   
+0001ebf0: 2020 2020 203e 3e3e 2066 726f 6d20 7761       >>> from wa
+0001ec00: 7465 782e 6d65 7468 6f64 7320 696d 706f  tex.methods impo
+0001ec10: 7274 205a 4320 0d0a 2020 2020 2020 2020  rt ZC ..        
+0001ec20: 3e3e 3e20 6564 695f 7361 6d70 6c65 203d  >>> edi_sample =
+0001ec30: 2077 6174 6578 2e66 6574 6368 5f64 6174   watex.fetch_dat
+0001ec40: 6120 2827 6564 6973 272c 2073 616d 706c  a ('edis', sampl
+0001ec50: 6573 203d 3137 202c 2072 6574 7572 6e5f  es =17 , return_
+0001ec60: 6461 7461 203d 5472 7565 2029 200d 0a20  data =True ) .. 
+0001ec70: 2020 2020 2020 203e 3e3e 207a 6f20 3d20         >>> zo = 
+0001ec80: 5a43 2028 292e 6669 7428 6564 695f 7361  ZC ().fit(edi_sa
+0001ec90: 6d70 6c65 290d 0a20 2020 2020 2020 203e  mple)..        >
+0001eca0: 3e3e 207a 6f2e 6564 694f 626a 735f 5b30  >> zo.ediObjs_[0
+0001ecb0: 5d2e 5a2e 7a5b 3a2c 2030 2c20 315d 5b3a  ].Z.z[:, 0, 1][:
+0001ecc0: 375d 0d0a 2020 2020 2020 2020 6172 7261  7]..        arra
+0001ecd0: 7928 5b31 3030 3032 2e34 3620 2b39 3734  y([10002.46 +974
+0001ece0: 372e 3334 6a20 2c20 3131 3637 392e 3434  7.34j , 11679.44
+0001ecf0: 202b 3837 3134 2e33 3239 6a2c 2031 3538   +8714.329j, 158
+0001ed00: 3936 2e34 3520 2b33 3138 362e 3733 376a  96.45 +3186.737j
+0001ed10: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0001ed20: 2020 3231 3736 332e 3031 202d 3435 3339    21763.01 -4539
+0001ed30: 2e34 3035 6a2c 2032 3832 3039 2e33 3620  .405j, 28209.36 
+0001ed40: 2d38 3439 342e 3830 386a 2c20 3139 3533  -8494.808j, 1953
+0001ed50: 382e 3638 202d 3234 3030 2e38 3434 6a2c  8.68 -2400.844j,
+0001ed60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001ed70: 2020 3839 3038 2e34 3438 2b35 3235 312e    8908.448+5251.
+0001ed80: 3135 376a 5d29 0d0a 2020 2020 2020 2020  157j])..        
+0001ed90: 3e3e 3e20 7a63 203d 207a 6f2e 7265 6d6f  >>> zc = zo.remo
+0001eda0: 7665 5f73 7461 7469 635f 7368 6966 7420  ve_static_shift 
+0001edb0: 2829 200d 0a20 2020 2020 2020 203e 3e3e  () ..        >>>
+0001edc0: 207a 635b 305d 2e7a 5b3a 2c20 302c 2031   zc[0].z[:, 0, 1
+0001edd0: 5d20 5b3a 375d 0d0a 2020 2020 2020 2020  ] [:7]..        
+0001ede0: 6172 7261 7928 5b20 3830 3238 2e34 3635  array([ 8028.465
+0001edf0: 3738 3637 362b 3738 3233 2e36 3933 3934  78676+7823.69394
+0001ee00: 3134 386a 2c20 2039 3337 342e 3439 3233  148j,  9374.4923
+0001ee10: 3139 3734 2b36 3939 342e 3534 3835 3634  1974+6994.548564
+0001ee20: 3136 6a2c 0d0a 2020 2020 2020 2020 2020  16j,..          
+0001ee30: 2020 2020 2031 3237 3539 2e32 3731 3731       12759.27171
+0001ee40: 3437 352b 3235 3537 2e38 3331 3637 316a  475+2557.831671j
+0001ee50: 2020 2c20 3137 3436 382e 3036 3039 3737    , 17468.060977
+0001ee60: 3139 2d33 3634 332e 3534 3934 3630 3331  19-3643.54946031
+0001ee70: 6a2c 0d0a 2020 2020 2020 2020 2020 2020  j,..            
+0001ee80: 2020 2032 3236 3432 2e32 3138 3137 3639     22642.2181769
+0001ee90: 372d 3638 3138 2e33 3530 3232 3531 366a  7-6818.35022516j
+0001eea0: 2c20 3135 3638 322e 3730 3434 3434 3535  , 15682.70444455
+0001eeb0: 2d31 3932 372e 3033 3533 3430 3634 6a2c  -1927.03534064j,
+0001eec0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001eed0: 2020 3731 3530 2e33 3538 3031 3030 342b    7150.35801004+
+0001eee0: 3432 3134 2e38 3336 3538 3137 346a 5d29  4214.83658174j])
+0001eef0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0001ef00: 2020 2020 2020 2073 656c 662e 696e 7370         self.insp
+0001ef10: 6563 7420 0d0a 2020 2020 2020 2020 0d0a  ect ..        ..
+0001ef20: 2020 2020 2020 2020 6966 2028 7373 5f66          if (ss_f
+0001ef30: 7820 6973 204e 6f6e 6520 6f72 2073 735f  x is None or ss_
+0001ef40: 6679 2069 7320 4e6f 6e65 2029 3a20 0d0a  fy is None ): ..
+0001ef50: 2020 2020 2020 2020 2020 2020 7373 5f66              ss_f
+0001ef60: 7820 2c20 7373 5f66 7920 3d20 7365 6c66  x , ss_fy = self
+0001ef70: 2e67 6574 5f73 735f 636f 7272 6563 7469  .get_ss_correcti
+0001ef80: 6f6e 5f66 6163 746f 7273 280d 0a20 2020  on_factors(..   
+0001ef90: 2020 2020 2020 2020 2020 2020 202a 2a6b               **k
+0001efa0: 7773 2029 0d0a 2020 2020 2020 2020 2020  ws )..          
+0001efb0: 2020 0d0a 2020 2020 2020 2020 5a4f 626a    ..        ZObj
+0001efc0: 7320 3d5b 5d0d 0a20 2020 2020 2020 206e  s =[]..        n
+0001efd0: 6577 5f65 6469 4f62 6a73 3d5b 5d0d 0a0d  ew_ediObjs=[]...
+0001efe0: 0a20 2020 2020 2020 2066 6f72 2069 692c  .        for ii,
+0001eff0: 2065 6469 4f62 6a20 696e 2065 6e75 6d65   ediObj in enume
+0001f000: 7261 7465 2028 7365 6c66 2e65 6469 4f62  rate (self.ediOb
+0001f010: 6a73 5f29 3a20 0d0a 2020 2020 2020 2020  js_): ..        
+0001f020: 2020 2020 7a30 203d 2045 4d7a 287a 5f61      z0 = EMz(z_a
+0001f030: 7272 6179 3d65 6469 4f62 6a2e 5a2e 5f7a  rray=ediObj.Z._z
+0001f040: 202c 200d 0a20 2020 2020 2020 2020 2020   , ..           
+0001f050: 2020 2020 2020 2020 2020 7a5f 6572 725f            z_err_
+0001f060: 6172 7261 793d 2065 6469 4f62 6a2e 5a2e  array= ediObj.Z.
+0001f070: 5f7a 5f65 7272 2c20 0d0a 2020 2020 2020  _z_err, ..      
+0001f080: 2020 2020 2020 2020 2020 6672 6571 203d            freq =
+0001f090: 2065 6469 4f62 6a2e 5a2e 5f66 7265 7120   ediObj.Z._freq 
+0001f0a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001f0b0: 2020 2920 0d0a 2020 2020 2020 2020 2020    ) ..          
+0001f0c0: 2020 2320 6e6f 7720 726f 7461 7465 2069    # now rotate i
+0001f0d0: 6620 706f 7373 6962 6c65 200d 0a20 2020  f possible ..   
+0001f0e0: 2020 2020 2020 2020 2023 2061 6e64 2063           # and c
+0001f0f0: 6f72 7265 6374 2064 6174 612e 200d 0a20  orrect data. .. 
+0001f100: 2020 2020 2020 2020 2020 2069 6620 726f             if ro
+0001f110: 7461 7465 3a20 0d0a 2020 2020 2020 2020  tate: ..        
+0001f120: 2020 2020 2020 2020 7a30 2e72 6f74 6174          z0.rotat
+0001f130: 6520 2872 6f74 6174 6520 2920 0d0a 2020  e (rotate ) ..  
+0001f140: 2020 2020 2020 2020 2020 7373 5f63 6f72            ss_cor
+0001f150: 2c20 7a63 6f72 203d 207a 302e 7265 6d6f  , zcor = z0.remo
+0001f160: 7665 5f73 7328 0d0a 2020 2020 2020 2020  ve_ss(..        
+0001f170: 2020 2020 2020 2020 7265 6475 6365 5f72          reduce_r
+0001f180: 6573 5f66 6163 746f 725f 783d 7373 5f66  es_factor_x=ss_f
+0001f190: 782c 0d0a 2020 2020 2020 2020 2020 2020  x,..            
+0001f1a0: 2020 2020 7265 6475 6365 5f72 6573 5f66      reduce_res_f
+0001f1b0: 6163 746f 725f 793d 7373 5f66 792c 200d  actor_y=ss_fy, .
+0001f1c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f1d0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+0001f1e0: 2320 7265 7365 7420 7468 6520 6564 694f  # reset the ediO
+0001f1f0: 626a 7320 746f 2074 6865 206e 6577 205a  bjs to the new Z
+0001f200: 200d 0a20 2020 2020 2020 2020 2020 207a   ..            z
+0001f210: 302e 5f7a 203d 207a 636f 7220 200d 0a20  0._z = zcor  .. 
+0001f220: 2020 2020 2020 2020 2020 2065 6469 4f62             ediOb
+0001f230: 6a2e 5a2e 5f7a 3d20 7a63 6f72 200d 0a20  j.Z._z= zcor .. 
+0001f240: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0001f250: 2020 2020 2020 2020 205a 4f62 6a73 2e61           ZObjs.a
+0001f260: 7070 656e 6420 287a 3020 2920 0d0a 2020  ppend (z0 ) ..  
+0001f270: 2020 2020 2020 2020 2020 6e65 775f 6564            new_ed
+0001f280: 694f 626a 732e 6170 7065 6e64 2028 6564  iObjs.append (ed
+0001f290: 694f 626a 2029 0d0a 2020 2020 2020 2020  iObj )..        
+0001f2a0: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
+0001f2b0: 6578 706f 7274 2064 6174 6120 746f 200d  export data to .
+0001f2c0: 0a20 2020 2020 2020 2023 206e 6577 2065  .        # new e
+0001f2d0: 6469 7320 0d0a 2020 2020 2020 2020 0d0a  dis ..        ..
+0001f2e0: 2020 2020 2020 2020 736b 7773 203d 7b0d          skws ={.
+0001f2f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f300: 226f 7074 696f 6e22 3a20 2777 7269 7465  "option": 'write
+0001f310: 2720 6966 206f 7574 2020 656c 7365 2020  ' if out  else  
+0001f320: 4e6f 6e65 2c20 0d0a 2020 2020 2020 2020  None, ..        
+0001f330: 2020 2020 2020 207d 200d 0a20 2020 2020         } ..     
+0001f340: 2020 2023 7072 696e 7428 6e65 775f 6564     #print(new_ed
+0001f350: 694f 626a 7329 0d0a 2020 2020 2020 2023  iObjs)..       #
+0001f360: 2070 7269 6e74 286e 6577 5f65 6469 4f62   print(new_ediOb
+0001f370: 6a73 290d 0a20 2020 2020 2020 2072 6574  js)..        ret
+0001f380: 7572 6e20 2820 6e65 775f 6564 694f 626a  urn ( new_ediObj
+0001f390: 732c 200d 0a20 2020 2020 2020 2020 2020  s, ..           
+0001f3a0: 2020 2020 2073 656c 662e 6672 6571 735f       self.freqs_
+0001f3b0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0001f3c0: 2020 2020 5a4f 626a 7320 292c 2073 6b77      ZObjs ), skw
+0001f3d0: 7320 0d0a 2020 2020 0d0a 2020 2020 0d0a  s ..    ..    ..
+0001f3e0: 2020 2020 405f 7a75 7064 6174 6520 286f      @_zupdate (o
+0001f3f0: 7074 696f 6e20 3d27 6e6f 6e65 2729 0d0a  ption ='none')..
+0001f400: 2020 2020 6465 6620 7265 6d6f 7665 5f64      def remove_d
+0001f410: 6973 746f 7274 696f 6e20 280d 0a20 2020  istortion (..   
+0001f420: 2020 2020 2073 656c 662c 0d0a 2020 2020       self,..    
+0001f430: 2020 2020 6469 7374 6f72 7469 6f6e 3a20      distortion: 
+0001f440: 4e44 4172 7261 792c 200d 0a20 2020 2020  NDArray, ..     
+0001f450: 2020 202f 2c20 0d0a 2020 2020 2020 2020     /, ..        
+0001f460: 6572 726f 723a 4e44 4172 7261 793d 4e6f  error:NDArray=No
+0001f470: 6e65 2c20 0d0a 2020 2020 2020 2020 6f75  ne, ..        ou
+0001f480: 7420 3d46 616c 7365 2c20 0d0a 2020 2020  t =False, ..    
+0001f490: 2020 2020 2a2a 6b77 732c 200d 0a20 2020      **kws, ..   
+0001f4a0: 2020 2020 2029 3a0d 0a20 2020 2020 2020       ):..       
+0001f4b0: 2022 2222 0d0a 2020 2020 2020 2020 5265   """..        Re
+0001f4c0: 6d6f 7665 2064 6973 746f 7274 696f 6e20  move distortion 
+0001f4d0: 4420 666f 726d 2061 6e20 6f62 7365 7276  D form an observ
+0001f4e0: 6564 2069 6d70 6564 616e 6365 2074 656e  ed impedance ten
+0001f4f0: 736f 7220 5a2e 200d 0a20 2020 2020 2020  sor Z. ..       
+0001f500: 200d 0a20 2020 2020 2020 2041 6c6c 6f77   ..        Allow
+0001f510: 2074 6f20 6f62 7461 696e 2074 6865 2075   to obtain the u
+0001f520: 7065 7274 7572 6265 6420 2263 6f72 7265  perturbed "corre
+0001f530: 6374 2220 3a6d 6174 683a 605a 5f7b 307d  ct" :math:`Z_{0}
+0001f540: 6020 6578 7072 6573 7365 6420 6173 3a20  ` expressed as: 
+0001f550: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+0001f560: 2020 2020 2020 2020 2e2e 206d 6174 683a          .. math:
+0001f570: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0001f580: 0d0a 2020 2020 2020 2020 2020 205a 203d  ..           Z =
+0001f590: 2044 202a 205a 5f7b 307d 0d0a 0d0a 0d0a   D * Z_{0}......
+0001f5a0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0001f5b0: 7273 200d 0a20 2020 2020 2020 202d 2d2d  rs ..        ---
+0001f5c0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001f5d0: 2064 6973 746f 7274 696f 6e5f 7465 6e73   distortion_tens
+0001f5e0: 6f72 3a20 6e70 2e6e 6461 7272 6179 2832  or: np.ndarray(2
+0001f5f0: 2c20 322c 2064 7479 7065 3d72 6561 6c29  , 2, dtype=real)
+0001f600: 200d 0a20 2020 2020 2020 2020 2020 5265   ..           Re
+0001f610: 616c 2064 6973 746f 7274 696f 6e20 7465  al distortion te
+0001f620: 6e73 6f72 2061 7320 6120 3278 320d 0a20  nsor as a 2x2.. 
+0001f630: 2020 0d0a 2020 2020 2020 2020 6572 726f    ..        erro
+0001f640: 723a 206e 702e 6e64 6172 7261 7928 322c  r: np.ndarray(2,
+0001f650: 2032 2c20 6474 7970 653d 7265 616c 292c   2, dtype=real),
+0001f660: 204f 7074 696f 6e61 6c20 0d0a 2020 2020   Optional ..    
+0001f670: 2020 2020 2020 5072 6f70 6167 6174 696f        Propagatio
+0001f680: 6e20 6f66 2065 7272 6f72 732f 756e 6365  n of errors/unce
+0001f690: 7274 6169 6e74 6965 7320 696e 636c 7564  rtainties includ
+0001f6a0: 6564 200d 0a20 2020 2020 2020 2020 200d  ed ..          .
+0001f6b0: 0a20 2020 2020 2020 206f 7574 3a20 626f  .        out: bo
+0001f6c0: 6f6c 202c 2064 6566 6175 6c74 203d 4661  ol , default =Fa
+0001f6d0: 6c73 652c 200d 0a20 2020 2020 2020 2020  lse, ..         
+0001f6e0: 2020 4f75 7470 7574 206e 6577 2066 696c    Output new fil
+0001f6f0: 7465 7265 6420 4544 492e 204f 7468 6572  tered EDI. Other
+0001f700: 7769 7365 2072 6574 7572 6e20 5a20 636f  wise return Z co
+0001f710: 6c6c 6563 7469 6f6e 7320 6f62 6a65 6374  llections object
+0001f720: 7320 0d0a 2020 2020 2020 2020 2020 206f  s ..           o
+0001f730: 6620 636f 7272 6563 7465 6420 5465 6e73  f corrected Tens
+0001f740: 6f72 732e 200d 0a0d 0a20 2020 2020 2020  ors. ....       
+0001f750: 2052 6574 7572 6e73 200d 0a20 2020 2020   Returns ..     
+0001f760: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0001f770: 2020 2020 2020 2064 2c20 6e65 775f 7a2c         d, new_z,
+0001f780: 206e 6577 5f7a 5f65 7272 3a20 4e44 4172   new_z_err: NDAr
+0001f790: 7261 7920 2820 3220 7832 202c 2064 7479  ray ( 2 x2 , dty
+0001f7a0: 7065 203d 7265 616c 2029 0d0a 2020 2020  pe =real )..    
+0001f7b0: 2020 2020 2020 2d20 696e 7075 7420 6469        - input di
+0001f7c0: 7374 6f72 7469 6f6e 2074 656e 736f 720d  stortion tensor.
+0001f7d0: 0a20 2020 2020 2020 2020 202d 2069 6d70  .          - imp
+0001f7e0: 6564 616e 6365 2074 656e 736f 7220 7769  edance tensor wi
+0001f7f0: 7468 2064 6973 746f 7269 6f6e 2072 656d  th distorion rem
+0001f800: 6f76 6564 0d0a 2020 2020 2020 2020 2020  oved..          
+0001f810: 2d20 2069 6d70 6564 616e 6365 2074 656e  -  impedance ten
+0001f820: 736f 7220 6572 726f 7220 6166 7465 7220  sor error after 
+0001f830: 6469 7374 6f72 7469 6f6e 2069 7320 7265  distortion is re
+0001f840: 6d6f 7665 6420 0d0a 2020 2020 2020 2020  moved ..        
+0001f850: 2020 4966 2060 6065 7870 6f72 743d 5472    If ``export=Tr
+0001f860: 7565 6060 2c20 6578 706f 7274 2074 6f20  ue``, export to 
+0001f870: 6e65 7720 4544 4920 616e 6420 7265 7475  new EDI and retu
+0001f880: 726e 204e 6f6e 652e 200d 0a20 2020 2020  rn None. ..     
+0001f890: 2020 2020 200d 0a20 2020 2020 2020 2045       ..        E
+0001f8a0: 7861 6d70 6c65 7320 0d0a 2020 2020 2020  xamples ..      
+0001f8b0: 2020 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020    ---------..   
+0001f8c0: 2020 2020 203e 3e3e 2069 6d70 6f72 7420       >>> import 
+0001f8d0: 7761 7465 7820 0d0a 2020 2020 2020 2020  watex ..        
+0001f8e0: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e6d  >>> from watex.m
+0001f8f0: 6574 686f 6473 2069 6d70 6f72 7420 5a43  ethods import ZC
+0001f900: 200d 0a20 2020 2020 2020 203e 3e3e 2065   ..        >>> e
+0001f910: 6469 5f73 616d 706c 6520 3d20 7761 7465  di_sample = wate
+0001f920: 782e 6665 7463 685f 6461 7461 2028 2765  x.fetch_data ('e
+0001f930: 6469 7327 2c20 7361 6d70 6c65 7320 3d31  dis', samples =1
+0001f940: 3720 2c20 7265 7475 726e 5f64 6174 6120  7 , return_data 
+0001f950: 3d54 7275 6520 2920 0d0a 2020 2020 2020  =True ) ..      
+0001f960: 2020 3e3e 3e20 7a6f 203d 205a 4320 2829    >>> zo = ZC ()
+0001f970: 2e66 6974 2865 6469 5f73 616d 706c 6529  .fit(edi_sample)
+0001f980: 0d0a 2020 2020 2020 2020 3e3e 3e20 7a6f  ..        >>> zo
+0001f990: 2e65 6469 4f62 6a73 5f5b 305d 2e5a 2e7a  .ediObjs_[0].Z.z
+0001f9a0: 5b3a 2c20 302c 2031 5d5b 3a37 5d0d 0a20  [:, 0, 1][:7].. 
+0001f9b0: 2020 2020 2020 2061 7272 6179 285b 3130         array([10
+0001f9c0: 3030 322e 3436 202b 3937 3437 2e33 346a  002.46 +9747.34j
+0001f9d0: 202c 2031 3136 3739 2e34 3420 2b38 3731   , 11679.44 +871
+0001f9e0: 342e 3332 396a 2c20 3135 3839 362e 3435  4.329j, 15896.45
+0001f9f0: 202b 3331 3836 2e37 3337 6a2c 0d0a 2020   +3186.737j,..  
+0001fa00: 2020 2020 2020 2020 2020 2020 2032 3137               217
+0001fa10: 3633 2e30 3120 2d34 3533 392e 3430 356a  63.01 -4539.405j
+0001fa20: 2c20 3238 3230 392e 3336 202d 3834 3934  , 28209.36 -8494
+0001fa30: 2e38 3038 6a2c 2031 3935 3338 2e36 3820  .808j, 19538.68 
+0001fa40: 2d32 3430 302e 3834 346a 2c0d 0a20 2020  -2400.844j,..   
+0001fa50: 2020 2020 2020 2020 2020 2020 2038 3930               890
+0001fa60: 382e 3434 382b 3532 3531 2e31 3537 6a5d  8.448+5251.157j]
+0001fa70: 290d 0a20 0909 3e3e 3e20 6469 7374 6f72  ).. ..>>> distor
+0001fa80: 7469 6f6e 203d 206e 702e 6172 7261 7928  tion = np.array(
+0001fa90: 5b5b 312e 322c 202e 355d 2c5b 2e33 352c  [[1.2, .5],[.35,
+0001faa0: 2032 2e31 5d5d 290d 0a20 2020 2020 2020   2.1]])..       
+0001fab0: 203e 3e3e 207a 6320 3d20 7a6f 2e72 656d   >>> zc = zo.rem
+0001fac0: 6f76 655f 6469 7374 6f72 7469 6f6e 2028  ove_distortion (
+0001fad0: 6469 7374 6f72 7469 6f6e 290d 0a20 2020  distortion)..   
+0001fae0: 2020 2020 203e 3e3e 207a 635b 305d 2e7a       >>> zc[0].z
+0001faf0: 5b3a 2c20 302c 2031 5d20 5b3a 375d 0d0a  [:, 0, 1] [:7]..
+0001fb00: 2009 0961 7272 6179 285b 2039 3732 342e   ..array([ 9724.
+0001fb10: 3532 3634 3339 3233 2b39 3433 392e 3936  52643923+9439.96
+0001fb20: 3530 3331 3938 6a2c 2031 3131 3539 2e32  503198j, 11159.2
+0001fb30: 3539 3237 3530 352b 3834 3331 2e31 3130  5927505+8431.110
+0001fb40: 3139 3139 6a20 2c0d 0a20 2020 2020 2020  1919j ,..       
+0001fb50: 2020 2020 2020 2020 2031 3437 3835 2e35           14785.5
+0001fb60: 3236 3433 3932 332b 3331 3435 2e33 3833  2643923+3145.383
+0001fb70: 3234 3039 346a 2c20 3139 3836 342e 3730  24094j, 19864.70
+0001fb80: 3837 3432 2020 2d34 3236 352e 3830 3136  8742  -4265.8016
+0001fb90: 3633 3131 6a2c 0d0a 2020 2020 2020 2020  6311j,..        
+0001fba0: 2020 2020 2020 2020 3235 3633 322e 3533          25632.53
+0001fbb0: 3531 3831 3234 2d38 3330 342e 3838 3039  518124-8304.8809
+0001fbc0: 3338 3137 6a2c 2031 3738 3839 2e31 3533  3817j, 17889.153
+0001fbd0: 3733 3133 342d 3234 3834 2e36 3031 3434  73134-2484.60144
+0001fbe0: 3938 396a 2c0d 0a20 2020 2020 2020 2020  989j,..         
+0001fbf0: 2020 2020 2020 2020 3834 3133 2e31 3936          8413.196
+0001fc00: 3731 3634 322b 3439 3235 2e34 3636 3630  71642+4925.46660
+0001fc10: 3938 316a 5d29 0d0a 2020 2020 2020 2020  981j])..        
+0001fc20: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0001fc30: 2020 2020 2020 2073 656c 662e 696e 7370         self.insp
+0001fc40: 6563 7420 0d0a 2020 2020 2020 2020 0d0a  ect ..        ..
+0001fc50: 2020 2020 2020 2020 6469 7374 6f72 7469          distorti
+0001fc60: 6f6e 203d 206e 702e 6172 7261 7920 2864  on = np.array (d
+0001fc70: 6973 746f 7274 696f 6e20 290d 0a20 2020  istortion )..   
+0001fc80: 2020 2020 2069 6620 6469 7374 6f72 7469       if distorti
+0001fc90: 6f6e 2e73 6861 7065 2021 3d20 2832 2c20  on.shape != (2, 
+0001fca0: 3229 203a 0d0a 2020 2020 2020 2020 2020  2) :..          
+0001fcb0: 2020 7261 6973 6520 5a45 7272 6f72 2028    raise ZError (
+0001fcc0: 2257 726f 6e67 2073 6861 7065 2066 6f72  "Wrong shape for
+0001fcd0: 2064 6973 746f 7274 696f 6e2e 2045 7870   distortion. Exp
+0001fce0: 6563 7420 7368 6170 653d 220d 0a20 2020  ect shape="..   
+0001fcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fd00: 2020 2020 2020 2022 2832 2c20 322c 2064         "(2, 2, d
+0001fd10: 7479 7065 3d72 6561 6c29 2066 6f72 2078  type=real) for x
+0001fd20: 782c 2078 792c 2079 7820 616e 6420 7979  x, xy, yx and yy
+0001fd30: 2063 6f6d 706f 6e65 6e74 732e 2229 0d0a   components.")..
+0001fd40: 2020 2020 2020 2020 5a4f 626a 7320 3d5b          ZObjs =[
+0001fd50: 5d0d 0a20 2020 2020 2020 206e 6577 5f65  ]..        new_e
+0001fd60: 6469 4f62 6a73 203d 5b5d 0d0a 2020 2020  diObjs =[]..    
+0001fd70: 2020 2020 666f 7220 6969 2c20 6564 694f      for ii, ediO
+0001fd80: 626a 2069 6e20 656e 756d 6572 6174 6520  bj in enumerate 
+0001fd90: 2873 656c 662e 6564 694f 626a 735f 293a  (self.ediObjs_):
+0001fda0: 200d 0a20 2020 2020 2020 2020 2020 207a   ..            z
+0001fdb0: 3020 3d20 454d 7a28 7a5f 6172 7261 793d  0 = EMz(z_array=
+0001fdc0: 6564 694f 626a 2e5a 2e7a 202c 0d0a 2020  ediObj.Z.z ,..  
+0001fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fde0: 2020 207a 5f65 7272 5f61 7272 6179 203d     z_err_array =
+0001fdf0: 2065 6469 4f62 6a2e 5a2e 7a5f 6572 722c   ediObj.Z.z_err,
+0001fe00: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0001fe10: 2020 2066 7265 7120 3d20 6564 694f 626a     freq = ediObj
+0001fe20: 2e5a 2e5f 6672 6571 200d 0a20 2020 2020  .Z._freq ..     
+0001fe30: 2020 2020 2020 2020 2020 2029 200d 0a20             ) .. 
+0001fe40: 2020 2020 2020 2020 2020 2064 2c20 6e65             d, ne
+0001fe50: 775f 7a2c 206e 6577 5f7a 5f65 7272 203d  w_z, new_z_err =
+0001fe60: 207a 302e 7265 6d6f 7665 5f64 6973 746f   z0.remove_disto
+0001fe70: 7274 696f 6e28 0d0a 2020 2020 2020 2020  rtion(..        
+0001fe80: 2020 2020 2020 2020 6469 7374 6f72 7469          distorti
+0001fe90: 6f6e 5f74 656e 736f 723d 6469 7374 6f72  on_tensor=distor
+0001fea0: 7469 6f6e 2c20 6469 7374 6f72 7469 6f6e  tion, distortion
+0001feb0: 5f65 7272 5f74 656e 736f 723d 6572 726f  _err_tensor=erro
+0001fec0: 7229 0d0a 2020 2020 2020 2020 2020 2020  r)..            
+0001fed0: 7a30 2e5f 7a20 3d20 6e65 775f 7a0d 0a20  z0._z = new_z.. 
+0001fee0: 2020 2020 2020 2020 2020 207a 302e 5f7a             z0._z
+0001fef0: 5f65 7272 203d 206e 6577 5f7a 5f65 7272  _err = new_z_err
+0001ff00: 0d0a 2020 2020 2020 2020 2020 2020 6564  ..            ed
+0001ff10: 694f 626a 2e5a 2e5f 7a3d 206e 6577 5f7a  iObj.Z._z= new_z
+0001ff20: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
+0001ff30: 7a30 2e63 6f6d 7075 7465 5f72 6573 6973  z0.compute_resis
+0001ff40: 7469 7669 7479 5f70 6861 7365 286e 6577  tivity_phase(new
+0001ff50: 5f7a 2c20 6e65 775f 7a5f 6572 7220 2920  _z, new_z_err ) 
+0001ff60: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0001ff70: 666f 7220 636f 6e73 6973 7465 6e63 7920  for consistency 
+0001ff80: 0d0a 2020 2020 2020 2020 2020 2020 5a4f  ..            ZO
+0001ff90: 626a 732e 6170 7065 6e64 2028 7a30 2029  bjs.append (z0 )
+0001ffa0: 200d 0a20 2020 2020 2020 2020 2020 206e   ..            n
+0001ffb0: 6577 5f65 6469 4f62 6a73 2e61 7070 656e  ew_ediObjs.appen
+0001ffc0: 6420 2865 6469 4f62 6a20 290d 0a20 2020  d (ediObj )..   
+0001ffd0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0001ffe0: 2020 2023 2065 7870 6f72 7420 6461 7461     # export data
+0001fff0: 2074 6f20 0d0a 2020 2020 2020 2020 2320   to ..        # 
+00020000: 6e65 7720 6564 6973 200d 0a20 2020 2020  new edis ..     
+00020010: 2020 200d 0a20 2020 2020 2020 2073 6b77     ..        skw
+00020020: 7320 3d7b 0d0a 2020 2020 2020 2020 2020  s ={..          
+00020030: 2020 2020 2022 6f70 7469 6f6e 223a 2027       "option": '
+00020040: 7772 6974 6527 2069 6620 6f75 7420 2065  write' if out  e
+00020050: 6c73 6520 204e 6f6e 652c 2020 0d0a 2020  lse  None,  ..  
+00020060: 2020 2020 2020 2020 2020 2020 2023 2022               # "
+00020070: 6564 694f 626a 7322 3a20 6e65 775f 6564  ediObjs": new_ed
+00020080: 694f 626a 730d 0a20 2020 2020 2020 2020  iObjs..         
+00020090: 2020 2020 2020 7d20 0d0a 0d0a 2020 2020        } ....    
+000200a0: 2020 2020 7265 7475 726e 2028 6e65 775f      return (new_
+000200b0: 6564 694f 626a 732c 200d 0a20 2020 2020  ediObjs, ..     
+000200c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000200d0: 6672 6571 735f 2c20 0d0a 2020 2020 2020  freqs_, ..      
+000200e0: 2020 2020 2020 2020 2020 5a4f 626a 7320            ZObjs 
+000200f0: 292c 2073 6b77 7320 0d0a 2020 2020 0d0a  ), skws ..    ..
+00020100: 2020 2020 6465 6620 6765 745f 7373 5f63      def get_ss_c
+00020110: 6f72 7265 6374 696f 6e5f 6661 6374 6f72  orrection_factor
+00020120: 7328 0d0a 2020 2020 2020 2020 7365 6c66  s(..        self
+00020130: 2c20 0d0a 2020 2020 2020 2020 2f2c 200d  , ..        /, .
+00020140: 0a20 2020 2020 2020 2072 3d31 3030 302e  .        r=1000.
+00020150: 2c20 0d0a 2020 2020 2020 2020 6e66 7265  , ..        nfre
+00020160: 713d 3231 2c0d 0a20 2020 2020 2020 2073  q=21,..        s
+00020170: 6b69 7066 7265 713d 352c 200d 0a20 2020  kipfreq=5, ..   
+00020180: 2020 2020 2074 6f6c 3d2e 3132 0d0a 2020       tol=.12..  
+00020190: 2020 2020 2020 2920 2d3e 2054 7570 6c65        ) -> Tuple
+000201a0: 5b66 6c6f 6174 2c20 666c 6f61 745d 3a0d  [float, float]:.
+000201b0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+000201c0: 2020 2020 2020 436f 6d70 7574 6520 7468        Compute th
+000201d0: 6520 2073 7461 7469 6320 7368 6966 7420  e  static shift 
+000201e0: 636f 7272 6563 7469 6f6e 2066 6163 746f  correction facto
+000201f0: 7220 6672 6f6d 2061 2073 7461 7469 6f6e  r from a station
+00020200: 200d 0a20 2020 2020 2020 2075 7369 6e67   ..        using
+00020210: 2061 2073 7061 7469 616c 206d 6564 6961   a spatial media
+00020220: 6e20 6669 6c74 6572 2e20 200d 0a20 2020  n filter.  ..   
+00020230: 2020 2020 200d 0a20 2020 2020 2020 2054       ..        T
+00020240: 6869 7320 7769 6c6c 2066 696e 6420 7468  his will find th
+00020250: 6f73 6520 7374 6174 696f 6e20 7769 7468  ose station with
+00020260: 696e 2074 6865 2067 6976 656e 2072 6164  in the given rad
+00020270: 6975 7320 286d 6574 6572 7329 2e20 200d  ius (meters).  .
+00020280: 0a20 2020 2020 2020 2054 6865 6e20 6974  .        Then it
+00020290: 2077 696c 6c20 6669 6e64 2074 6865 206d   will find the m
+000202a0: 6564 6961 6e20 7374 6174 6963 2073 6869  edian static shi
+000202b0: 6674 2066 6f72 2074 6865 2078 2061 6e64  ft for the x and
+000202c0: 2079 206d 6f64 6573 200d 0a20 2020 2020   y modes ..     
+000202d0: 2020 2061 6e64 2072 656d 6f76 6520 6974     and remove it
+000202e0: 2c20 6769 7665 6e20 7468 6174 2069 7420  , given that it 
+000202f0: 6973 206c 6172 6765 7220 7468 616e 2074  is larger than t
+00020300: 6865 2073 6869 6674 200d 0a20 2020 2020  he shift ..     
+00020310: 2020 2074 6f6c 6572 616e 6365 2061 7761     tolerance awa
+00020320: 7920 6672 6f6d 2031 2e20 200d 0a20 2020  y from 1.  ..   
+00020330: 2020 2020 200d 0a20 2020 2020 2020 2050       ..        P
+00020340: 6172 616d 6574 6572 7320 0d0a 2020 2020  arameters ..    
+00020350: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d      ------------
+00020360: 2d0d 0a20 2020 2020 2020 2072 3a20 666c  -..        r: fl
+00020370: 6f61 742c 2064 6566 6175 6c74 3d31 3030  oat, default=100
+00020380: 302e 200d 0a20 2020 2020 2020 2020 2020  0. ..           
+00020390: 7261 6469 7573 2074 6f20 6c6f 6f6b 2066  radius to look f
+000203a0: 6f72 206e 6561 7262 7920 7374 6174 696f  or nearby statio
+000203b0: 6e73 2c20 696e 206d 6574 6572 732e 0d0a  ns, in meters...
+000203c0: 200d 0a20 2020 2020 2020 206e 6672 6571   ..        nfreq
+000203d0: 3a20 696e 742c 2064 6566 6175 6c74 3d32  : int, default=2
+000203e0: 3120 0d0a 2020 2020 2020 2020 2020 206e  1 ..           n
+000203f0: 756d 6265 7220 6f66 2066 7265 7175 656e  umber of frequen
+00020400: 6369 6573 2063 616c 6375 6c61 7465 2074  cies calculate t
+00020410: 6865 206d 6564 6961 6e20 7374 6174 6963  he median static
+00020420: 2073 6869 6674 2e20 200d 0a20 2020 2020   shift.  ..     
+00020430: 2020 2020 2020 5468 6973 2069 7320 6173        This is as
+00020440: 7375 6d69 6e67 2074 6865 2066 6972 7374  suming the first
+00020450: 2066 7265 7175 656e 6379 2069 7320 7468   frequency is th
+00020460: 6520 6869 6768 6573 7420 6672 6571 7565  e highest freque
+00020470: 6e63 792e 2020 0d0a 2020 2020 2020 2020  ncy.  ..        
+00020480: 2020 2043 6175 7365 2075 7375 616c 6c79     Cause usually
+00020490: 2068 6967 6865 7374 2066 7265 7175 656e   highest frequen
+000204a0: 6369 6573 2061 7265 2073 616d 706c 696e  cies are samplin
+000204b0: 6720 6120 3144 2065 6172 7468 2e20 200d  g a 1D earth.  .
+000204c0: 0a20 2020 200d 0a20 2020 2020 2020 2073  .    ..        s
+000204d0: 6b69 7066 7265 712a 2a20 3a20 696e 742c  kipfreq** : int,
+000204e0: 2064 6566 6175 6c74 3d35 200d 0a20 2020   default=5 ..   
+000204f0: 2020 2020 2020 2020 6e75 6d62 6572 206f          number o
+00020500: 6620 6672 6571 7565 6e63 6965 7320 746f  f frequencies to
+00020510: 2073 6b69 7020 6672 6f6d 2074 6865 2068   skip from the h
+00020520: 6967 6865 7374 2066 7265 7175 656e 6379  ighest frequency
+00020530: 2e20 200d 0a20 2020 2020 2020 2020 2020  .  ..           
+00020540: 536f 6d65 7469 6d65 7320 7468 6520 6869  Sometimes the hi
+00020550: 6768 6573 7420 6672 6571 7565 6e63 6965  ghest frequencie
+00020560: 7320 6172 6520 6e6f 7420 7265 6c69 6162  s are not reliab
+00020570: 6c65 2064 7565 2074 6f20 6e6f 6973 6520  le due to noise 
+00020580: 0d0a 2020 2020 2020 2020 2020 206f 7220  ..           or 
+00020590: 6c6f 7720 7369 676e 616c 2069 6e20 7468  low signal in th
+000205a0: 6520 3a74 6572 6d3a 6041 4d54 6020 6465  e :term:`AMT` de
+000205b0: 6164 6261 6e64 2e20 2054 6869 7320 616c  adband.  This al
+000205c0: 6c6f 7773 2079 6f75 2074 6f20 0d0a 2020  lows you to ..  
+000205d0: 2020 2020 2020 2020 2073 6b69 7020 7468           skip th
+000205e0: 6f73 6520 6672 6571 7565 6e63 6965 732e  ose frequencies.
+000205f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00020600: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+00020610: 2020 200d 0a20 2020 2020 2020 2074 6f6c     ..        tol
+00020620: 3a20 666c 6f61 742c 2064 6566 6175 6c74  : float, default
+00020630: 3d30 2e31 320d 0a20 2020 2020 2020 2020  =0.12..         
+00020640: 2020 546f 6c65 7261 6e63 6520 6f6e 2074    Tolerance on t
+00020650: 6865 206d 6564 6961 6e20 7374 6174 6963  he median static
+00020660: 2073 6869 6674 2063 6f72 7265 6374 696f   shift correctio
+00020670: 6e2e 2020 4966 2074 6865 2064 6174 6120  n.  If the data 
+00020680: 6973 200d 0a20 2020 2020 2020 2020 2020  is ..           
+00020690: 6e6f 6973 7920 7468 6520 636f 7272 6563  noisy the correc
+000206a0: 7469 6f6e 2066 6163 746f 7220 6361 6e20  tion factor can 
+000206b0: 6265 2062 6961 7365 6420 6177 6179 2066  be biased away f
+000206c0: 726f 6d20 312e 2020 5468 6572 6566 6f72  rom 1.  Therefor
+000206d0: 6520 0d0a 2020 2020 2020 2020 2020 2074  e ..           t
+000206e0: 6865 2073 6869 6674 5f74 6f6c 2069 7320  he shift_tol is 
+000206f0: 7573 6564 2074 6f20 7374 6f70 2074 6861  used to stop tha
+00020700: 7420 6269 6173 2e20 2049 6620 0d0a 2020  t bias.  If ..  
+00020710: 2020 2020 2020 2020 2060 6031 2d74 6f6c           ``1-tol
+00020720: 203c 2063 6f72 7265 6374 696f 6e20 3c20   < correction < 
+00020730: 312b 746f 6c60 6020 7468 656e 2074 6865  1+tol`` then the
+00020740: 2063 6f72 7265 6374 696f 6e20 6661 6374   correction fact
+00020750: 6f72 2069 7320 7365 7420 0d0a 2020 2020  or is set ..    
+00020760: 2020 2020 2020 2074 6f20 6060 3160 600d         to ``1``.
+00020770: 0a20 200d 0a20 2020 2020 2020 2052 6574  .  ..        Ret
+00020780: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+00020790: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2028  -----..        (
+000207a0: 7378 5f78 2c20 2073 735f 7929 3a20 2866  sx_x,  ss_y): (f
+000207b0: 6c6f 6174 2c20 666c 6f61 7429 0d0a 2020  loat, float)..  
+000207c0: 2020 2020 2020 2020 2020 7374 6174 6963            static
+000207d0: 2073 6869 6674 2063 6f72 7265 6374 696f   shift correctio
+000207e0: 6e73 2066 6163 746f 7220 666f 7220 7820  ns factor for x 
+000207f0: 616e 6420 7920 6d6f 6465 730d 0a20 2020  and y modes..   
+00020800: 200d 0a20 2020 2020 2020 2045 7861 6d70   ..        Examp
+00020810: 6c65 7320 0d0a 2020 2020 2020 2020 2d2d  les ..        --
+00020820: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00020830: 203e 3e3e 2069 6d70 6f72 7420 7761 7465   >>> import wate
+00020840: 7820 0d0a 2020 2020 2020 2020 3e3e 3e20  x ..        >>> 
+00020850: 6672 6f6d 2077 6174 6578 2e6d 6574 686f  from watex.metho
+00020860: 6473 2069 6d70 6f72 7420 5a43 200d 0a20  ds import ZC .. 
+00020870: 2020 2020 2020 203e 3e3e 2065 6469 5f73         >>> edi_s
+00020880: 616d 706c 6520 3d20 7761 7465 782e 6665  ample = watex.fe
+00020890: 7463 685f 6461 7461 2028 2765 6469 7327  tch_data ('edis'
+000208a0: 2c20 7361 6d70 6c65 7320 3d31 3720 2c0d  , samples =17 ,.
+000208b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000208c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000208d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000208e0: 2020 7265 7475 726e 5f64 6174 6120 3d54    return_data =T
-000208f0: 7275 6520 2920 0d0a 2020 2020 2020 2020  rue ) ..        
-00020900: 3e3e 3e20 7a6f 203d 205a 4320 2829 2e66  >>> zo = ZC ().f
-00020910: 6974 2865 6469 5f73 616d 706c 6529 2e67  it(edi_sample).g
-00020920: 6574 5f73 735f 636f 7272 6563 7469 6f6e  et_ss_correction
-00020930: 5f66 6163 746f 7273 2028 2920 0d0a 2020  _factors () ..  
-00020940: 2020 2020 2020 4f75 745b 3136 5d3a 2028        Out[16]: (
-00020950: 312e 3535 3232 3033 3032 3231 3236 3636  1.55220302212666
-00020960: 3433 2c20 302e 3734 3236 3832 3334 3034  43, 0.7426823404
-00020970: 3237 3635 3129 0d0a 2020 2020 2020 2020  27651)..        
-00020980: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00020990: 2020 2020 2020 2073 656c 662e 696e 7370         self.insp
-000209a0: 6563 7420 0d0a 2020 2020 2020 2020 2320  ect ..        # 
-000209b0: 636f 6e76 6572 7420 6d65 7465 7273 2074  convert meters t
-000209c0: 6f20 6465 6369 6d61 6c20 6465 6772 6565  o decimal degree
-000209d0: 7320 736f 200d 0a20 2020 2020 2020 2023  s so ..        #
-000209e0: 2077 6520 646f 6e27 7420 6861 7665 2074   we don't have t
-000209f0: 6f20 6465 616c 2077 6974 6820 7a6f 6e65  o deal with zone
-00020a00: 0d0a 2020 2020 2020 2020 2320 6368 616e  ..        # chan
-00020a10: 6765 730d 0a20 2020 2020 2020 206d 6574  ges..        met
-00020a20: 6572 5f74 6f5f 6465 675f 6661 6374 6f72  er_to_deg_factor
-00020a30: 203d 2038 2e39 3934 3432 3334 3537 3435   = 8.99442345745
-00020a40: 3633 3737 652d 3036 0d0a 2020 2020 2020  6377e-06..      
-00020a50: 2020 646d 5f64 6567 203d 2072 202a 206d    dm_deg = r * m
-00020a60: 6574 6572 5f74 6f5f 6465 675f 6661 6374  eter_to_deg_fact
-00020a70: 6f72 0d0a 0d0a 2020 2020 2020 2020 6564  or....        ed
-00020a80: 695f 6f62 6a5f 696e 6974 3d20 7365 6c66  i_obj_init= self
-00020a90: 2e65 6469 4f62 6a73 5f5b 305d 200d 0a20  .ediObjs_[0] .. 
-00020aa0: 2020 2020 2020 2065 6469 5f6f 626a 5f69         edi_obj_i
-00020ab0: 6e69 742e 5a2e 636f 6d70 7574 655f 7265  nit.Z.compute_re
-00020ac0: 7369 7374 6976 6974 795f 7068 6173 6528  sistivity_phase(
-00020ad0: 290d 0a0d 0a20 2020 2020 2020 2069 6e74  )....        int
-00020ae0: 6572 705f 6672 6571 203d 2073 656c 662e  erp_freq = self.
-00020af0: 6672 6571 735f 5b73 6b69 7066 7265 713a  freqs_[skipfreq:
-00020b00: 6e66 7265 7120 2b20 736b 6970 6672 6571  nfreq + skipfreq
-00020b10: 5d0d 0a0d 0a20 2020 2020 2020 2023 2046  ]....        # F
-00020b20: 696e 6420 7374 6174 696f 6e73 206e 6561  ind stations nea
-00020b30: 7220 6279 2061 6e64 2073 746f 7265 2074  r by and store t
-00020b40: 6865 6d20 696e 2061 206c 6973 740d 0a20  hem in a list.. 
-00020b50: 2020 2020 2020 2065 6d61 705f 6f62 6a20         emap_obj 
-00020b60: 3d20 5b5d 0d0a 2020 2020 2020 2020 2320  = []..        # 
-00020b70: 666f 7220 6b6b 2c20 6564 6920 696e 2065  for kk, edi in e
-00020b80: 6e75 6d65 7261 7465 2865 6469 5f6c 6973  numerate(edi_lis
-00020b90: 7429 3a0d 0a20 2020 2020 2020 2066 6f72  t):..        for
-00020ba0: 206b 6b2c 2065 6469 2069 6e20 656e 756d   kk, edi in enum
-00020bb0: 6572 6174 6520 2873 656c 662e 6564 694f  erate (self.ediO
-00020bc0: 626a 735f 293a 200d 0a20 2020 2020 2020  bjs_): ..       
-00020bd0: 2020 2020 2065 6469 5f6f 626a 203d 2065       edi_obj = e
-00020be0: 6469 0d0a 2020 2020 2020 2020 2020 2020  di..            
-00020bf0: 6465 6c74 615f 6420 3d20 6e70 2e73 7172  delta_d = np.sqr
-00020c00: 7428 2865 6469 5f6f 626a 5f69 6e69 742e  t((edi_obj_init.
-00020c10: 6c61 7420 2d20 6564 695f 6f62 6a2e 6c61  lat - edi_obj.la
-00020c20: 7429 202a 2a20 3220 2b0d 0a20 2020 2020  t) ** 2 +..     
-00020c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020c40: 2020 2020 2028 6564 695f 6f62 6a5f 696e       (edi_obj_in
-00020c50: 6974 2e6c 6f6e 202d 2065 6469 5f6f 626a  it.lon - edi_obj
-00020c60: 2e6c 6f6e 2920 2a2a 2032 290d 0a20 2020  .lon) ** 2)..   
-00020c70: 2020 2020 2020 2020 2069 6620 6465 6c74           if delt
-00020c80: 615f 6420 3c3d 2064 6d5f 6465 673a 0d0a  a_d <= dm_deg:..
-00020c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020ca0: 6564 695f 6f62 6a2e 6465 6c74 615f 6420  edi_obj.delta_d 
-00020cb0: 3d20 666c 6f61 7428 6465 6c74 615f 6429  = float(delta_d)
-00020cc0: 202f 206d 6574 6572 5f74 6f5f 6465 675f   / meter_to_deg_
-00020cd0: 6661 6374 6f72 0d0a 2020 2020 2020 2020  factor..        
-00020ce0: 2020 2020 2020 2020 656d 6170 5f6f 626a          emap_obj
-00020cf0: 2e61 7070 656e 6428 6564 695f 6f62 6a29  .append(edi_obj)
-00020d00: 0d0a 0d0a 2020 2020 2020 2020 6966 206c  ....        if l
-00020d10: 656e 2865 6d61 705f 6f62 6a29 203d 3d20  en(emap_obj) == 
-00020d20: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-00020d30: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
-00020d40: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00020d50: 2020 2070 7269 6e74 2827 4e6f 2073 7461     print('No sta
-00020d60: 7469 6f6e 7320 666f 756e 6420 7769 7468  tions found with
-00020d70: 696e 2067 6976 656e 2027 0d0a 2020 2020  in given '..    
-00020d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020d90: 2020 2772 6164 6975 7320 7b30 3a2e 3266    'radius {0:.2f
-00020da0: 7d20 6d27 2e66 6f72 6d61 7428 7229 290d  } m'.format(r)).
-00020db0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00020dc0: 7572 6e20 312e 302c 2031 2e30 0d0a 0d0a  urn 1.0, 1.0....
-00020dd0: 2020 2020 2020 2020 2320 6578 7472 6163          # extrac
-00020de0: 7420 7468 6520 7265 7369 7374 6976 6974  t the resistivit
-00020df0: 7920 7661 6c75 6573 200d 0a20 2020 2020  y values ..     
-00020e00: 2020 2023 2066 726f 6d20 7468 6520 6e65     # from the ne
-00020e10: 6172 2062 7920 7374 6174 696f 6e73 0d0a  ar by stations..
-00020e20: 2020 2020 2020 2020 7265 735f 6172 7261          res_arra
-00020e30: 7920 3d20 6e70 2e7a 6572 6f73 2828 6c65  y = np.zeros((le
-00020e40: 6e28 656d 6170 5f6f 626a 292c 206e 6672  n(emap_obj), nfr
-00020e50: 6571 2c20 322c 2032 2929 0d0a 2020 2020  eq, 2, 2))..    
-00020e60: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
-00020e70: 6f73 653a 200d 0a20 2020 2020 2020 2020  ose: ..         
-00020e80: 2020 2070 7269 6e74 2827 5468 6573 6520     print('These 
-00020e90: 7374 6174 696f 6e73 2061 7265 2077 6974  stations are wit
-00020ea0: 6869 6e20 7468 6520 6769 7665 6e27 0d0a  hin the given'..
-00020eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020ec0: 2020 2720 7b30 7d20 6d20 7261 6469 7573    ' {0} m radius
-00020ed0: 3a27 2e66 6f72 6d61 7428 7229 290d 0a20  :'.format(r)).. 
-00020ee0: 2020 2020 2020 2066 6f72 206b 6b2c 2065         for kk, e
-00020ef0: 6d61 705f 6f62 6a5f 6b6b 2069 6e20 656e  map_obj_kk in en
-00020f00: 756d 6572 6174 6528 656d 6170 5f6f 626a  umerate(emap_obj
-00020f10: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00020f20: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
-00020f30: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00020f40: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-00020f50: 2020 2020 2070 7269 6e74 2827 5c74 7b30       print('\t{0
-00020f60: 7d20 2d2d 3e20 7b31 3a2e 3166 7d20 6d27  } --> {1:.1f} m'
-00020f70: 2e66 6f72 6d61 7428 0d0a 2020 2020 2020  .format(..      
-00020f80: 2020 2020 2020 2020 2020 2020 2020 656d                em
-00020f90: 6170 5f6f 626a 5f6b 6b2e 7374 6174 696f  ap_obj_kk.statio
-00020fa0: 6e2c 2065 6d61 705f 6f62 6a5f 6b6b 2e64  n, emap_obj_kk.d
-00020fb0: 656c 7461 5f64 2929 0d0a 2020 2020 2020  elta_d))..      
-00020fc0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00020fd0: 2020 2020 2020 2020 696e 7465 7270 5f69          interp_i
-00020fe0: 6478 203d 206e 702e 7768 6572 6528 2869  dx = np.where((i
-00020ff0: 6e74 6572 705f 6672 6571 203e 3d20 656d  nterp_freq >= em
-00021000: 6170 5f6f 626a 5f6b 6b2e 5a2e 6672 6571  ap_obj_kk.Z.freq
-00021010: 2e6d 696e 2829 2920 260d 0a20 2020 2020  .min()) &..     
+000208d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000208e0: 726e 5f64 6174 6120 3d54 7275 6520 2920  rn_data =True ) 
+000208f0: 0d0a 2020 2020 2020 2020 3e3e 3e20 7a6f  ..        >>> zo
+00020900: 203d 205a 4320 2829 2e66 6974 2865 6469   = ZC ().fit(edi
+00020910: 5f73 616d 706c 6529 2e67 6574 5f73 735f  _sample).get_ss_
+00020920: 636f 7272 6563 7469 6f6e 5f66 6163 746f  correction_facto
+00020930: 7273 2028 2920 0d0a 2020 2020 2020 2020  rs () ..        
+00020940: 4f75 745b 3136 5d3a 2028 312e 3535 3232  Out[16]: (1.5522
+00020950: 3033 3032 3231 3236 3636 3433 2c20 302e  030221266643, 0.
+00020960: 3734 3236 3832 3334 3034 3237 3635 3129  742682340427651)
+00020970: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00020980: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00020990: 2073 656c 662e 696e 7370 6563 7420 0d0a   self.inspect ..
+000209a0: 2020 2020 2020 2020 2320 636f 6e76 6572          # conver
+000209b0: 7420 6d65 7465 7273 2074 6f20 6465 6369  t meters to deci
+000209c0: 6d61 6c20 6465 6772 6565 7320 736f 200d  mal degrees so .
+000209d0: 0a20 2020 2020 2020 2023 2077 6520 646f  .        # we do
+000209e0: 6e27 7420 6861 7665 2074 6f20 6465 616c  n't have to deal
+000209f0: 2077 6974 6820 7a6f 6e65 0d0a 2020 2020   with zone..    
+00020a00: 2020 2020 2320 6368 616e 6765 730d 0a20      # changes.. 
+00020a10: 2020 2020 2020 206d 6574 6572 5f74 6f5f         meter_to_
+00020a20: 6465 675f 6661 6374 6f72 203d 2038 2e39  deg_factor = 8.9
+00020a30: 3934 3432 3334 3537 3435 3633 3737 652d  94423457456377e-
+00020a40: 3036 0d0a 2020 2020 2020 2020 646d 5f64  06..        dm_d
+00020a50: 6567 203d 2072 202a 206d 6574 6572 5f74  eg = r * meter_t
+00020a60: 6f5f 6465 675f 6661 6374 6f72 0d0a 0d0a  o_deg_factor....
+00020a70: 2020 2020 2020 2020 6564 695f 6f62 6a5f          edi_obj_
+00020a80: 696e 6974 3d20 7365 6c66 2e65 6469 4f62  init= self.ediOb
+00020a90: 6a73 5f5b 305d 200d 0a20 2020 2020 2020  js_[0] ..       
+00020aa0: 2065 6469 5f6f 626a 5f69 6e69 742e 5a2e   edi_obj_init.Z.
+00020ab0: 636f 6d70 7574 655f 7265 7369 7374 6976  compute_resistiv
+00020ac0: 6974 795f 7068 6173 6528 290d 0a0d 0a20  ity_phase().... 
+00020ad0: 2020 2020 2020 2069 6e74 6572 705f 6672         interp_fr
+00020ae0: 6571 203d 2073 656c 662e 6672 6571 735f  eq = self.freqs_
+00020af0: 5b73 6b69 7066 7265 713a 6e66 7265 7120  [skipfreq:nfreq 
+00020b00: 2b20 736b 6970 6672 6571 5d0d 0a0d 0a20  + skipfreq].... 
+00020b10: 2020 2020 2020 2023 2046 696e 6420 7374         # Find st
+00020b20: 6174 696f 6e73 206e 6561 7220 6279 2061  ations near by a
+00020b30: 6e64 2073 746f 7265 2074 6865 6d20 696e  nd store them in
+00020b40: 2061 206c 6973 740d 0a20 2020 2020 2020   a list..       
+00020b50: 2065 6d61 705f 6f62 6a20 3d20 5b5d 0d0a   emap_obj = []..
+00020b60: 2020 2020 2020 2020 2320 666f 7220 6b6b          # for kk
+00020b70: 2c20 6564 6920 696e 2065 6e75 6d65 7261  , edi in enumera
+00020b80: 7465 2865 6469 5f6c 6973 7429 3a0d 0a20  te(edi_list):.. 
+00020b90: 2020 2020 2020 2066 6f72 206b 6b2c 2065         for kk, e
+00020ba0: 6469 2069 6e20 656e 756d 6572 6174 6520  di in enumerate 
+00020bb0: 2873 656c 662e 6564 694f 626a 735f 293a  (self.ediObjs_):
+00020bc0: 200d 0a20 2020 2020 2020 2020 2020 2065   ..            e
+00020bd0: 6469 5f6f 626a 203d 2065 6469 0d0a 2020  di_obj = edi..  
+00020be0: 2020 2020 2020 2020 2020 6465 6c74 615f            delta_
+00020bf0: 6420 3d20 6e70 2e73 7172 7428 2865 6469  d = np.sqrt((edi
+00020c00: 5f6f 626a 5f69 6e69 742e 6c61 7420 2d20  _obj_init.lat - 
+00020c10: 6564 695f 6f62 6a2e 6c61 7429 202a 2a20  edi_obj.lat) ** 
+00020c20: 3220 2b0d 0a20 2020 2020 2020 2020 2020  2 +..           
+00020c30: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00020c40: 6564 695f 6f62 6a5f 696e 6974 2e6c 6f6e  edi_obj_init.lon
+00020c50: 202d 2065 6469 5f6f 626a 2e6c 6f6e 2920   - edi_obj.lon) 
+00020c60: 2a2a 2032 290d 0a20 2020 2020 2020 2020  ** 2)..         
+00020c70: 2020 2069 6620 6465 6c74 615f 6420 3c3d     if delta_d <=
+00020c80: 2064 6d5f 6465 673a 0d0a 2020 2020 2020   dm_deg:..      
+00020c90: 2020 2020 2020 2020 2020 6564 695f 6f62            edi_ob
+00020ca0: 6a2e 6465 6c74 615f 6420 3d20 666c 6f61  j.delta_d = floa
+00020cb0: 7428 6465 6c74 615f 6429 202f 206d 6574  t(delta_d) / met
+00020cc0: 6572 5f74 6f5f 6465 675f 6661 6374 6f72  er_to_deg_factor
+00020cd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00020ce0: 2020 656d 6170 5f6f 626a 2e61 7070 656e    emap_obj.appen
+00020cf0: 6428 6564 695f 6f62 6a29 0d0a 0d0a 2020  d(edi_obj)....  
+00020d00: 2020 2020 2020 6966 206c 656e 2865 6d61        if len(ema
+00020d10: 705f 6f62 6a29 203d 3d20 303a 0d0a 2020  p_obj) == 0:..  
+00020d20: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00020d30: 662e 7665 7262 6f73 653a 200d 0a20 2020  f.verbose: ..   
+00020d40: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00020d50: 6e74 2827 4e6f 2073 7461 7469 6f6e 7320  nt('No stations 
+00020d60: 666f 756e 6420 7769 7468 696e 2067 6976  found within giv
+00020d70: 656e 2027 0d0a 2020 2020 2020 2020 2020  en '..          
+00020d80: 2020 2020 2020 2020 2020 2020 2772 6164              'rad
+00020d90: 6975 7320 7b30 3a2e 3266 7d20 6d27 2e66  ius {0:.2f} m'.f
+00020da0: 6f72 6d61 7428 7229 290d 0a20 2020 2020  ormat(r))..     
+00020db0: 2020 2020 2020 2072 6574 7572 6e20 312e         return 1.
+00020dc0: 302c 2031 2e30 0d0a 0d0a 2020 2020 2020  0, 1.0....      
+00020dd0: 2020 2320 6578 7472 6163 7420 7468 6520    # extract the 
+00020de0: 7265 7369 7374 6976 6974 7920 7661 6c75  resistivity valu
+00020df0: 6573 200d 0a20 2020 2020 2020 2023 2066  es ..        # f
+00020e00: 726f 6d20 7468 6520 6e65 6172 2062 7920  rom the near by 
+00020e10: 7374 6174 696f 6e73 0d0a 2020 2020 2020  stations..      
+00020e20: 2020 7265 735f 6172 7261 7920 3d20 6e70    res_array = np
+00020e30: 2e7a 6572 6f73 2828 6c65 6e28 656d 6170  .zeros((len(emap
+00020e40: 5f6f 626a 292c 206e 6672 6571 2c20 322c  _obj), nfreq, 2,
+00020e50: 2032 2929 0d0a 2020 2020 2020 2020 6966   2))..        if
+00020e60: 2073 656c 662e 7665 7262 6f73 653a 200d   self.verbose: .
+00020e70: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00020e80: 6e74 2827 5468 6573 6520 7374 6174 696f  nt('These statio
+00020e90: 6e73 2061 7265 2077 6974 6869 6e20 7468  ns are within th
+00020ea0: 6520 6769 7665 6e27 0d0a 2020 2020 2020  e given'..      
+00020eb0: 2020 2020 2020 2020 2020 2020 2720 7b30              ' {0
+00020ec0: 7d20 6d20 7261 6469 7573 3a27 2e66 6f72  } m radius:'.for
+00020ed0: 6d61 7428 7229 290d 0a20 2020 2020 2020  mat(r))..       
+00020ee0: 2066 6f72 206b 6b2c 2065 6d61 705f 6f62   for kk, emap_ob
+00020ef0: 6a5f 6b6b 2069 6e20 656e 756d 6572 6174  j_kk in enumerat
+00020f00: 6528 656d 6170 5f6f 626a 293a 0d0a 2020  e(emap_obj):..  
+00020f10: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00020f20: 662e 7665 7262 6f73 653a 200d 0a20 2020  f.verbose: ..   
+00020f30: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+00020f40: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00020f50: 7269 6e74 2827 5c74 7b30 7d20 2d2d 3e20  rint('\t{0} --> 
+00020f60: 7b31 3a2e 3166 7d20 6d27 2e66 6f72 6d61  {1:.1f} m'.forma
+00020f70: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
+00020f80: 2020 2020 2020 2020 656d 6170 5f6f 626a          emap_obj
+00020f90: 5f6b 6b2e 7374 6174 696f 6e2c 2065 6d61  _kk.station, ema
+00020fa0: 705f 6f62 6a5f 6b6b 2e64 656c 7461 5f64  p_obj_kk.delta_d
+00020fb0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00020fc0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00020fd0: 2020 696e 7465 7270 5f69 6478 203d 206e    interp_idx = n
+00020fe0: 702e 7768 6572 6528 2869 6e74 6572 705f  p.where((interp_
+00020ff0: 6672 6571 203e 3d20 656d 6170 5f6f 626a  freq >= emap_obj
+00021000: 5f6b 6b2e 5a2e 6672 6571 2e6d 696e 2829  _kk.Z.freq.min()
+00021010: 2920 260d 0a20 2020 2020 2020 2020 2020  ) &..           
 00021020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021030: 2020 2020 2020 2020 2028 696e 7465 7270           (interp
-00021040: 5f66 7265 7120 3c3d 2065 6d61 705f 6f62  _freq <= emap_ob
-00021050: 6a5f 6b6b 2e5a 2e66 7265 712e 6d61 7828  j_kk.Z.freq.max(
-00021060: 2929 290d 0a0d 0a20 2020 2020 2020 2020  )))....         
-00021070: 2020 2069 6e74 6572 705f 6672 6571 5f6b     interp_freq_k
-00021080: 6b20 3d20 696e 7465 7270 5f66 7265 715b  k = interp_freq[
-00021090: 696e 7465 7270 5f69 6478 5d0d 0a20 2020  interp_idx]..   
-000210a0: 2020 2020 2020 2020 205a 5f69 6e74 6572           Z_inter
-000210b0: 7020 3d20 656d 6170 5f6f 626a 5f6b 6b2e  p = emap_obj_kk.
-000210c0: 696e 7465 7270 6f6c 6174 655a 2869 6e74  interpolateZ(int
-000210d0: 6572 705f 6672 6571 5f6b 6b29 0d0a 2020  erp_freq_kk)..  
-000210e0: 2020 2020 2020 2020 2020 5a5f 696e 7465            Z_inte
-000210f0: 7270 2e63 6f6d 7075 7465 5f72 6573 6973  rp.compute_resis
-00021100: 7469 7669 7479 5f70 6861 7365 2829 0d0a  tivity_phase()..
-00021110: 2020 2020 2020 2020 2020 2020 7265 735f              res_
-00021120: 6172 7261 795b 0d0a 2020 2020 2020 2020  array[..        
-00021130: 2020 2020 2020 2020 6b6b 2c0d 0a20 2020          kk,..   
-00021140: 2020 2020 2020 2020 2020 2020 2069 6e74               int
-00021150: 6572 705f 6964 782c 0d0a 2020 2020 2020  erp_idx,..      
-00021160: 2020 2020 2020 2020 2020 3a2c 0d0a 2020            :,..  
-00021170: 2020 2020 2020 2020 2020 2020 2020 3a5d                :]
-00021180: 203d 205a 5f69 6e74 6572 702e 7265 7369   = Z_interp.resi
-00021190: 7374 6976 6974 795b 0d0a 2020 2020 2020  stivity[..      
-000211a0: 2020 2020 2020 2020 2020 303a 6c65 6e28            0:len(
-000211b0: 696e 7465 7270 5f66 7265 715f 6b6b 292c  interp_freq_kk),
-000211c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000211d0: 2020 3a2c 0d0a 2020 2020 2020 2020 2020    :,..          
-000211e0: 2020 2020 2020 3a5d 0d0a 0d0a 2020 2020        :]....    
-000211f0: 2020 2020 2320 636f 6d70 7574 6520 7468      # compute th
-00021200: 6520 7374 6174 6963 2073 6869 6674 206f  e static shift o
-00021210: 6620 782d 636f 6d70 6f6e 656e 7473 0d0a  f x-components..
-00021220: 2020 2020 2020 2020 7373 5f78 203d 2065          ss_x = e
-00021230: 6469 5f6f 626a 5f69 6e69 742e 5a2e 7265  di_obj_init.Z.re
-00021240: 7369 7374 6976 6974 795b 0d0a 2020 2020  sistivity[..    
-00021250: 2020 2020 2020 2020 736b 6970 6672 6571          skipfreq
-00021260: 3a6e 6672 6571 202b 2073 6b69 7066 7265  :nfreq + skipfre
-00021270: 712c 2030 2c20 315d 202f 206e 702e 6d65  q, 0, 1] / np.me
-00021280: 6469 616e 280d 0a20 2020 2020 2020 2020  dian(..         
-00021290: 2020 2020 2020 2072 6573 5f61 7272 6179         res_array
-000212a0: 5b3a 2c20 3a2c 2030 2c20 315d 2c20 6178  [:, :, 0, 1], ax
-000212b0: 6973 3d30 290d 0a20 2020 2020 2020 2073  is=0)..        s
-000212c0: 735f 7820 3d20 6e70 2e6d 6564 6961 6e28  s_x = np.median(
-000212d0: 7373 5f78 290d 0a0d 0a20 2020 2020 2020  ss_x)....       
-000212e0: 2023 2063 6865 636b 2074 6f20 7365 6520   # check to see 
-000212f0: 6966 2074 6865 2065 7374 696d 6174 6564  if the estimated
-00021300: 2073 7461 7469 630d 0a20 2020 2020 2020   static..       
-00021310: 2023 2073 6869 6674 2069 7320 7769 7468   # shift is with
-00021320: 696e 2067 6976 656e 2074 6f6c 6572 616e  in given toleran
-00021330: 6365 0d0a 2020 2020 2020 2020 6966 2020  ce..        if  
-00021340: 2820 0d0a 2020 2020 2020 2020 2020 2020  ( ..            
-00021350: 2020 2020 3120 2d20 746f 6c20 3c20 7373      1 - tol < ss
-00021360: 5f78 200d 0a20 2020 2020 2020 2020 2020  _x ..           
-00021370: 2020 2020 2061 6e64 2073 735f 7820 3c20       and ss_x < 
-00021380: 3120 2b20 746f 6c0d 0a20 2020 2020 2020  1 + tol..       
-00021390: 2020 2020 2020 2020 2029 3a0d 0a20 2020           ):..   
-000213a0: 2020 2020 2020 2020 2073 735f 7820 3d20           ss_x = 
-000213b0: 312e 300d 0a0d 0a20 2020 2020 2020 2023  1.0....        #
-000213c0: 2063 6f6d 7075 7465 2074 6865 2073 7461   compute the sta
-000213d0: 7469 6320 7368 6966 7420 6f66 2079 2d63  tic shift of y-c
-000213e0: 6f6d 706f 6e65 6e74 730d 0a20 2020 2020  omponents..     
-000213f0: 2020 2073 735f 7920 3d20 6564 695f 6f62     ss_y = edi_ob
-00021400: 6a5f 696e 6974 2e5a 2e72 6573 6973 7469  j_init.Z.resisti
-00021410: 7669 7479 5b0d 0a20 2020 2020 2020 2020  vity[..         
-00021420: 2020 2073 6b69 7066 7265 713a 6e66 7265     skipfreq:nfre
-00021430: 7120 2b20 736b 6970 6672 6571 2c20 312c  q + skipfreq, 1,
-00021440: 2030 5d20 2f20 6e70 2e6d 6564 6961 6e28   0] / np.median(
-00021450: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00021460: 2020 7265 735f 6172 7261 795b 3a2c 203a    res_array[:, :
-00021470: 2c20 312c 2030 5d2c 2061 7869 733d 3029  , 1, 0], axis=0)
-00021480: 0d0a 2020 2020 2020 2020 7373 5f79 203d  ..        ss_y =
-00021490: 206e 702e 6d65 6469 616e 2873 735f 7929   np.median(ss_y)
-000214a0: 0d0a 0d0a 2020 2020 2020 2020 2320 6368  ....        # ch
-000214b0: 6563 6b20 746f 2073 6565 2069 6620 7468  eck to see if th
-000214c0: 6520 6573 7469 6d61 7465 6420 7374 6174  e estimated stat
-000214d0: 6963 200d 0a20 2020 2020 2020 2023 2073  ic ..        # s
-000214e0: 6869 6674 2069 7320 7769 7468 696e 2067  hift is within g
-000214f0: 6976 656e 2074 6f6c 6572 616e 6365 0d0a  iven tolerance..
-00021500: 2020 2020 2020 2020 6966 2028 200d 0a20          if ( .. 
-00021510: 2020 2020 2020 2020 2020 2020 2020 2031                 1
-00021520: 202d 2074 6f6c 203c 2073 735f 7920 0d0a   - tol < ss_y ..
-00021530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021540: 616e 6420 7373 5f79 203c 2031 202b 2074  and ss_y < 1 + t
-00021550: 6f6c 0d0a 2020 2020 2020 2020 2020 2020  ol..            
-00021560: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
-00021570: 2020 2020 7373 5f79 203d 2031 2e30 0d0a      ss_y = 1.0..
-00021580: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00021590: 2073 735f 782c 2073 735f 790d 0a20 2020   ss_x, ss_y..   
-000215a0: 200d 0a20 200d 0a20 2020 200d 0a20 200d   ..  ..    ..  .
-000215b0: 0a20 2020 200d 0a20 200d 0a20 2020 200d  .    ..  ..    .
-000215c0: 0a20 200d 0a20 2020 200d 0a20 200d 0a20  .  ..    ..  .. 
-000215d0: 2020 200d 0a20 200d 0a20 2020 200d 0a20     ..  ..    .. 
-000215e0: 200d 0a20 2020 200d 0a20 200d 0a          ..    ..  ..
+00021030: 2020 2028 696e 7465 7270 5f66 7265 7120     (interp_freq 
+00021040: 3c3d 2065 6d61 705f 6f62 6a5f 6b6b 2e5a  <= emap_obj_kk.Z
+00021050: 2e66 7265 712e 6d61 7828 2929 290d 0a0d  .freq.max()))...
+00021060: 0a20 2020 2020 2020 2020 2020 2069 6e74  .            int
+00021070: 6572 705f 6672 6571 5f6b 6b20 3d20 696e  erp_freq_kk = in
+00021080: 7465 7270 5f66 7265 715b 696e 7465 7270  terp_freq[interp
+00021090: 5f69 6478 5d0d 0a20 2020 2020 2020 2020  _idx]..         
+000210a0: 2020 205a 5f69 6e74 6572 7020 3d20 656d     Z_interp = em
+000210b0: 6170 5f6f 626a 5f6b 6b2e 696e 7465 7270  ap_obj_kk.interp
+000210c0: 6f6c 6174 655a 2869 6e74 6572 705f 6672  olateZ(interp_fr
+000210d0: 6571 5f6b 6b29 0d0a 2020 2020 2020 2020  eq_kk)..        
+000210e0: 2020 2020 5a5f 696e 7465 7270 2e63 6f6d      Z_interp.com
+000210f0: 7075 7465 5f72 6573 6973 7469 7669 7479  pute_resistivity
+00021100: 5f70 6861 7365 2829 0d0a 2020 2020 2020  _phase()..      
+00021110: 2020 2020 2020 7265 735f 6172 7261 795b        res_array[
+00021120: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021130: 2020 6b6b 2c0d 0a20 2020 2020 2020 2020    kk,..         
+00021140: 2020 2020 2020 2069 6e74 6572 705f 6964         interp_id
+00021150: 782c 0d0a 2020 2020 2020 2020 2020 2020  x,..            
+00021160: 2020 2020 3a2c 0d0a 2020 2020 2020 2020      :,..        
+00021170: 2020 2020 2020 2020 3a5d 203d 205a 5f69          :] = Z_i
+00021180: 6e74 6572 702e 7265 7369 7374 6976 6974  nterp.resistivit
+00021190: 795b 0d0a 2020 2020 2020 2020 2020 2020  y[..            
+000211a0: 2020 2020 303a 6c65 6e28 696e 7465 7270      0:len(interp
+000211b0: 5f66 7265 715f 6b6b 292c 0d0a 2020 2020  _freq_kk),..    
+000211c0: 2020 2020 2020 2020 2020 2020 3a2c 0d0a              :,..
+000211d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000211e0: 3a5d 0d0a 0d0a 2020 2020 2020 2020 2320  :]....        # 
+000211f0: 636f 6d70 7574 6520 7468 6520 7374 6174  compute the stat
+00021200: 6963 2073 6869 6674 206f 6620 782d 636f  ic shift of x-co
+00021210: 6d70 6f6e 656e 7473 0d0a 2020 2020 2020  mponents..      
+00021220: 2020 7373 5f78 203d 2065 6469 5f6f 626a    ss_x = edi_obj
+00021230: 5f69 6e69 742e 5a2e 7265 7369 7374 6976  _init.Z.resistiv
+00021240: 6974 795b 0d0a 2020 2020 2020 2020 2020  ity[..          
+00021250: 2020 736b 6970 6672 6571 3a6e 6672 6571    skipfreq:nfreq
+00021260: 202b 2073 6b69 7066 7265 712c 2030 2c20   + skipfreq, 0, 
+00021270: 315d 202f 206e 702e 6d65 6469 616e 280d  1] / np.median(.
+00021280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021290: 2072 6573 5f61 7272 6179 5b3a 2c20 3a2c   res_array[:, :,
+000212a0: 2030 2c20 315d 2c20 6178 6973 3d30 290d   0, 1], axis=0).
+000212b0: 0a20 2020 2020 2020 2073 735f 7820 3d20  .        ss_x = 
+000212c0: 6e70 2e6d 6564 6961 6e28 7373 5f78 290d  np.median(ss_x).
+000212d0: 0a0d 0a20 2020 2020 2020 2023 2063 6865  ...        # che
+000212e0: 636b 2074 6f20 7365 6520 6966 2074 6865  ck to see if the
+000212f0: 2065 7374 696d 6174 6564 2073 7461 7469   estimated stati
+00021300: 630d 0a20 2020 2020 2020 2023 2073 6869  c..        # shi
+00021310: 6674 2069 7320 7769 7468 696e 2067 6976  ft is within giv
+00021320: 656e 2074 6f6c 6572 616e 6365 0d0a 2020  en tolerance..  
+00021330: 2020 2020 2020 6966 2020 2820 0d0a 2020        if  ( ..  
+00021340: 2020 2020 2020 2020 2020 2020 2020 3120                1 
+00021350: 2d20 746f 6c20 3c20 7373 5f78 200d 0a20  - tol < ss_x .. 
+00021360: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00021370: 6e64 2073 735f 7820 3c20 3120 2b20 746f  nd ss_x < 1 + to
+00021380: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+00021390: 2020 2029 3a0d 0a20 2020 2020 2020 2020     ):..         
+000213a0: 2020 2073 735f 7820 3d20 312e 300d 0a0d     ss_x = 1.0...
+000213b0: 0a20 2020 2020 2020 2023 2063 6f6d 7075  .        # compu
+000213c0: 7465 2074 6865 2073 7461 7469 6320 7368  te the static sh
+000213d0: 6966 7420 6f66 2079 2d63 6f6d 706f 6e65  ift of y-compone
+000213e0: 6e74 730d 0a20 2020 2020 2020 2073 735f  nts..        ss_
+000213f0: 7920 3d20 6564 695f 6f62 6a5f 696e 6974  y = edi_obj_init
+00021400: 2e5a 2e72 6573 6973 7469 7669 7479 5b0d  .Z.resistivity[.
+00021410: 0a20 2020 2020 2020 2020 2020 2073 6b69  .            ski
+00021420: 7066 7265 713a 6e66 7265 7120 2b20 736b  pfreq:nfreq + sk
+00021430: 6970 6672 6571 2c20 312c 2030 5d20 2f20  ipfreq, 1, 0] / 
+00021440: 6e70 2e6d 6564 6961 6e28 0d0a 2020 2020  np.median(..    
+00021450: 2020 2020 2020 2020 2020 2020 7265 735f              res_
+00021460: 6172 7261 795b 3a2c 203a 2c20 312c 2030  array[:, :, 1, 0
+00021470: 5d2c 2061 7869 733d 3029 0d0a 2020 2020  ], axis=0)..    
+00021480: 2020 2020 7373 5f79 203d 206e 702e 6d65      ss_y = np.me
+00021490: 6469 616e 2873 735f 7929 0d0a 0d0a 2020  dian(ss_y)....  
+000214a0: 2020 2020 2020 2320 6368 6563 6b20 746f        # check to
+000214b0: 2073 6565 2069 6620 7468 6520 6573 7469   see if the esti
+000214c0: 6d61 7465 6420 7374 6174 6963 200d 0a20  mated static .. 
+000214d0: 2020 2020 2020 2023 2073 6869 6674 2069         # shift i
+000214e0: 7320 7769 7468 696e 2067 6976 656e 2074  s within given t
+000214f0: 6f6c 6572 616e 6365 0d0a 2020 2020 2020  olerance..      
+00021500: 2020 6966 2028 200d 0a20 2020 2020 2020    if ( ..       
+00021510: 2020 2020 2020 2020 2031 202d 2074 6f6c           1 - tol
+00021520: 203c 2073 735f 7920 0d0a 2020 2020 2020   < ss_y ..      
+00021530: 2020 2020 2020 2020 2020 616e 6420 7373            and ss
+00021540: 5f79 203c 2031 202b 2074 6f6c 0d0a 2020  _y < 1 + tol..  
+00021550: 2020 2020 2020 2020 2020 2020 2020 293a                ):
+00021560: 0d0a 2020 2020 2020 2020 2020 2020 7373  ..            ss
+00021570: 5f79 203d 2031 2e30 0d0a 0d0a 2020 2020  _y = 1.0....    
+00021580: 2020 2020 7265 7475 726e 2073 735f 782c      return ss_x,
+00021590: 2073 735f 790d 0a20 2020 200d 0a20 200d   ss_y..    ..  .
+000215a0: 0a20 2020 200d 0a20 200d 0a20 2020 200d  .    ..  ..    .
+000215b0: 0a20 200d 0a20 2020 200d 0a20 200d 0a20  .  ..    ..  .. 
+000215c0: 2020 200d 0a20 200d 0a20 2020 200d 0a20     ..  ..    .. 
+000215d0: 200d 0a20 2020 200d 0a20 200d 0a20 2020   ..    ..  ..   
+000215e0: 200d 0a20 200d 0a                         ..  ..
```

### Comparing `watex-0.2.3/watex/methods/erp.py` & `watex-0.2.4/watex/methods/erp.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/methods/hydro.py` & `watex-0.2.4/watex/methods/hydro.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/metrics.py` & `watex-0.2.4/watex/metrics.py`

 * *Files 14% similar despite different names*

```diff
@@ -36,15 +36,22 @@
     f1_score,
     roc_curve, 
     roc_auc_score,
     cross_val_predict, 
     accuracy_score, 
     confusion_matrix as cfsmx ,
     )
-from .utils.validator import get_estimator_name 
+from .utils.validator import ( 
+    get_estimator_name, 
+    _is_numeric_dtype 
+    ) 
+from .utils.funcutils import ( 
+    is_iterable, 
+    _assert_all_types 
+    )
 
 _logger = watexlog().get_watex_logger(__name__)
 
 __all__=['precision_recall_tradeoff',
          'ROC_curve',
          'confusion_matrix', 
          "get_metrics", 
@@ -75,15 +82,98 @@
     """
     )
 _param_docs = DocstringComponents.from_nested_components(
     core=_core_docs["params"],
     metric=DocstringComponents(_metrics_params ), 
     )
 
-# ------
+
+def information_value (Xp:ArrayLike, /,  Np:ArrayLike, Sp:ArrayLike, *, 
+                       return_tot :bool = ... ): 
+    """The information value (InV) constructs with the influencing factors 
+    landslide areas and calculates the sensitivity of each influencing 
+    factor.
+    
+    InV method is a statistical approach for the prediction of spatial events
+    on the basis of associated parameters and landslide relationships [1]_. 
+    The inV :math:`I_i` of each causative factor :math:`X_i` can be 
+    expressed as: 
+        
+    .. math:: 
+        
+        I_i= \log \frac{\frac{S_i}{N_i}{\frac{S}{N}} 
+                        
+    where :math:`S_i`  is the landslide pixel number in the presence of a 
+    causative factor :math:`X_i`, :math:`N_i` is the number of pixels 
+    associated with causative factor :math:`X_i` . :math:`S` is the total 
+    number of landslide pixels, and:math:`N` is the total number of pixels in 
+    the study area. Then, the overall information value :math:`I` can be 
+    calculated by:
+        
+    .. math:: 
+        
+        I_i= \sum{i=1}{n} \log \frac{\frac{S_i}{N_i}}{\frac{S}{N}}
+        
+    Thus Negative and positive values of :math:\I_i` irrepresent the relevant  
+    and relevant correlation between the presence of a certain causative factor 
+    and landslide event, respectively. The stronger the correlation is, the 
+    higher the value of :math:`I_i`. See more details in the paper of Chen 
+    Tao with the following :doi:`https://doi.org/10.1007/s11629-019-5839-3` .
+    
+    
+    Parameters 
+    ----------
+    
+    Xp: Arraylike, Shape (n_samples ) of pixels 
+       Causative factor. 
+       
+    Sp: Arraylike ,Shape of (n_samples) of pixels  
+        The landslide pixel number in the presence of a causative factor 
+        :math:`X_i`.
+    Np: Arraylike, Shape of n_samples of pixels 
+       Number of pixels associated to the causative factor :math:`X_i`. 
+       
+    return_tot: bool, default=False 
+      Returns the overall information value. 
+
+    Returns 
+    ---------
+    I: Arraylike 
+       Information value of caustive factor :math:`X_p`. 
+       
+    
+    References 
+    ------------
+    .. [1] Sarkar S, Kanungo D, Patra A (2006) GIS Based Landslide 
+           Susceptibility Mapping - A Case Study in Indian Himalaya in 
+           Disaster Mitigation of Debris Flows, Slope Failures and 
+           Landslides, Universal Academic Press, Tokyo, 617-624 
+    """
+    if not _is_numeric_dtype(Xp, to_array= True ): 
+        raise TypeError ("Causative factor expect a numeric array."
+                         f" Got {np.array(Xp).dtype!r}")
+    Xp = np.array ( is_iterable(Xp , transform =True ))
+    
+    if Np: Np = _assert_all_types(Np , float , int, 
+                                  objname= "Number of pixel 'Ni'")
+
+    I = np.zeros_like ( Xp , dtype = float )
+
+    for i in len(Xp ): 
+        Ii = _information_value ( Sp[i], Np[i], Sp, Np )
+        # Ii = np.log10 ( ( Sp[i] / Np[i])/( len(Sp)/len(Np) ))
+        I[i]= Ii 
+    return I if not return_tot else np.sum (I )
+    
+
+def _information_value ( Si, Ni, S, N ): 
+    """ Compute the information value :math:`I_i` of each causative factor
+    :math:`X_i` """
+    return np.log10 ( Si/Ni * ( S/ N )) 
+
 
 def get_metrics(): 
     """
     Get the list of  available metrics. 
     
     Metrics are measures of quantitative assessment commonly used for 
     assessing, comparing, and tracking performance or production. Generally,
```

#### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

### Comparing `watex-0.2.3/watex/models/__init__.py` & `watex-0.2.4/watex/models/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/models/_metapredictors.py` & `watex-0.2.4/watex/models/_metapredictors.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/models/premodels.py` & `watex-0.2.4/watex/models/premodels.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/models/validation.py` & `watex-0.2.4/watex/models/validation.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/property.py` & `watex-0.2.4/watex/property.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/site.py` & `watex-0.2.4/watex/site.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/transformers.py` & `watex-0.2.4/watex/transformers.py`

 * *Files 3% similar despite different names*

```diff
@@ -2,44 +2,50 @@
 #   Licence:BSD 3-Clause
 #   Author: LKouadio <etanoyau@gmail.com>
 #   created date Wed Jul 14 20:00:26 2021
 #   Edited on Mon Sep  6 17:53:06 2021
 """
 Gives some efficient tools for data manipulation and transformation.
 """
-from __future__ import division 
+from __future__ import division, annotations  
 
 import inspect
 import warnings 
 import numpy as np 
 import pandas as pd 
+from scipy import sparse 
 # from pandas.api.types import is_integer_dtype
 from .exlib.sklearn  import ( 
     StratifiedShuffleSplit, 
     train_test_split,
     BaseEstimator,
     TransformerMixin,
     StandardScaler,
     MinMaxScaler,
     OrdinalEncoder,
     OneHotEncoder, 
     KMeans 
 )
  
 from ._watexlog import watexlog 
+from ._typing import F 
+from .exceptions import EstimatorError
 from .utils.funcutils import ( 
     _assert_all_types, 
-    parse_attrs , to_numeric_dtypes
+    parse_attrs , 
+    to_numeric_dtypes,
+    assert_ratio 
     )
 from .utils.mlutils import (  
     discretizeCategoriesforStratification, 
     stratifiedUsingDiscretedCategories, 
     existfeatures 
     )
 from .utils.hydroutils import categorize_flow 
+from .utils.validator import get_estimator_name 
 
 __docformat__='restructuredtext'
 
 _logger = watexlog().get_watex_logger(__name__)
 
 
 __all__= ['KMeansFeaturizer',
@@ -47,90 +53,14 @@
           'StratifiedUsingBaseCategory', 
           'FrameUnion', 
           'DataFrameSelector',
           'CombinedAttributesAdder', 
           'featurize_X'
           ]
 
-def featurize_X (
-    X, y=None, *, 
-    n_clusters=7, 
-    target_scale = 5 ,
-    random_state=None, 
-    n_components=None, 
-    split_X_y = False, 
-    test_ratio = 0.2 , 
-    shuffle=True, 
-    return_model =False  
-    ): 
-    """ Featurize X with the cluster based on the KMeans featurization
-    
-    Parameters 
-    -----------
-    X, y : 
-    n_clusters: int, default=7
-       Number of initial clusters
-    target_scale: float, default=5.0 
-       Apply appropriate scaling and include it in the input data to k-means.
-    n_components: int, optional
-       Number of components for reduced down the predictor X. It uses the PCA 
-       to reduce down dimension to the importance components. 
-    random_state: int, Optional 
-       State for shuffling the data 
-    split_X_y: bool, default=False, 
-       Split the X, y into train data and test data  according to the test_size 
-    test_ratio: int, default=0.2 
-       ratio to keep for a test data. 
-       
-    shuffle: bool, default=True
-       Suffling the data set. 
-       
-    return_model: bool, default =False 
-       If ``True`` return the KMeans featurization mode and the transformed X.
-       
-    Returns 
-    -------- 
-    X : NDArray shape ( M, 2N)
-      Array like train data X transformed  and test if `split_X_y` is set to 
-      ``True``. 
-      
-    """ 
-    from scipy import sparse 
-    from watex.analysis import nPCA 
-    # reduce down feature to two. 
-    kmf_data = []
-    if n_components: 
-        X =nPCA (X, n_components = n_components  ) 
-        
-    if split_X_y: 
-        X, test_data , y, y_test = train_test_split ( 
-            X, y ,test_size = test_ratio, random_state = random_state ,
-            shuffle =shuffle)
-    # create a kmeaturization with hint model     
-    kmf_hint = KMeansFeaturizer(
-        n_clusters=n_clusters, 
-        target_scale=target_scale, 
-        random_state = random_state, 
-        ).fit(X,y)
-    ### Use the k-means featurizer to generate cluster features
-    training_cluster_features = kmf_hint.transform(X)
-    ### Form new input features with cluster features
-    # training_with_cluster
-    Xkmf = sparse.hstack((X, sparse.coo_matrix (training_cluster_features) ))
-    kmf_data.append(Xkmf)
-    kmf_data.append(y) 
-    if split_X_y: 
-        test_cluster_features = kmf_hint.transform(test_data)
-        test_with_cluster = sparse.hstack(
-            (test_data, sparse.coo_matrix (test_cluster_features)))
-        
-        kmf_data.insert(1,test_with_cluster )
-        kmf_data.append( y_test)
-    
-    return  tuple (kmf_data ) + (kmf_hint, ) if return_model else tuple(kmf_data )
 
 class KMeansFeaturizer:
     """Transforms numeric data into k-means cluster memberships.
      
     This transformer runs k-means on the input data and converts each data point
     into the ID of the closest cluster. If a target variable is present, it is 
     scaled and included as input to k-means in order to derive clusters that
@@ -147,34 +77,33 @@
        to reduce down dimension to the importance components. 
 
     random_state: int, Optional 
        State for shuffling the data 
     
     Attributes 
     -----------
-    km_model: KMeans featurization model used to transfor
+    km_model: KMeans featurization model used to transform
 
     Examples 
     --------
-    (1) Use a common dataset 
+    >>> # (1) Use a common dataset 
     >>> import matplotlib.pyplot as plt 
     >>> from sklearn.datasets import make_moons
     >>> from watex.utils.plotutils import plot_voronoi 
     >>> from watex.datasets import load_mxs 
     >>> X, y = make_moons(n_samples=5000, noise=0.2)
     >>> kmf_hint = KMeansFeaturizer(n_clusters=50, target_scale=10).fit(X,y)
     >>> kmf_no_hint = KMeansFeaturizer(n_clusters=50, target_scale=0).fit(X, y)
     >>> fig, ax = plt.subplots(2,1, figsize =(7, 7)) 
     >>> plot_voronoi ( X, y ,cluster_centers=kmf_hint.cluster_centers_, 
                       fig_title ='KMeans with hint', ax = ax [0] )
     >>> plot_voronoi ( X, y ,cluster_centers=kmf_no_hint.cluster_centers_, 
                       fig_title ='KMeans No hint' , ax = ax[1])
-    Out[84]: <AxesSubplot:title={'center':'KMeans No hint'}>
-    
-    (2)  Use a concrete data set 
+    <AxesSubplot:title={'center':'KMeans No hint'}>
+    >>> # (2)  Use a concrete data set 
     >>> X, y = load_mxs ( return_X_y =True, key ='numeric' ) 
     >>> # get the most principal components 
     >>> from watex.analysis import nPCA 
     >>> Xpca =nPCA (X, n_components = 2  ) # veronoi plot expect two dimensional data 
     >>> kmf_hint = KMeansFeaturizer(n_clusters=7, target_scale=10).fit(Xpca,y)
     >>> kmf_no_hint = KMeansFeaturizer(n_clusters=7, target_scale=0).fit(Xpca, y)
     >>> fig, ax = plt.subplots(2,1, figsize =(7, 7)) 
@@ -246,16 +175,16 @@
         # recomputation.
         km_model = KMeans(n_clusters=self.n_clusters,
                     init=km_model_pretrain.cluster_centers_[:,:-1] , #[:, :-1]
                     n_init=1,
                     max_iter=1)
         km_model.fit(X)
         
-        self.km_model = km_model
-        self.cluster_centers_ = km_model.cluster_centers_
+        self.km_model_ = km_model
+        self.cluster_centers_ = self.km_model_.cluster_centers_
         
         return self
 
     def transform(self, X):
         """Outputs the closest cluster ID for each input data point.
         
         Parameters
@@ -264,15 +193,15 @@
             New data to predict.
 
         Returns
         -------
         labels : ndarray of shape (n_samples,)
             Index of the cluster each sample belongs to.
         """
-        clusters = self.km_model.predict(X)
+        clusters = self.km_model_.predict(X)
         return clusters[:,np.newaxis]
 
     def fit_transform(self, X, y=None):
         """ Fit and transform the data 
         
         X : {array-like, sparse matrix} of shape (n_samples, n_features)
             Training vector, where `n_samples` is the number of samples and
@@ -286,14 +215,24 @@
         labels : ndarray of shape (n_samples,)
             Index of the cluster each sample belongs to. 
         
         """
         self.fit(X, y)
         return self.transform(X, y)
 
+    def __repr__(self):
+        """ Pretty format for guidance following the API... """
+        _t = ("n_clusters", "target_scale", "random_state", "n_components")
+        outm = ( '<{!r}:' + ', '.join(
+            [f"{k}={ False if getattr(self, k)==... else  getattr(self, k)!r}" 
+             for k in _t]) + '>' 
+            ) 
+        return  outm.format(self.__class__.__name__)
+    
+    
 class StratifiedWithCategoryAdder( BaseEstimator, TransformerMixin ): 
     """
     Stratified sampling transformer based on new generated category 
     from numerical attributes and return stratified trainset and test set.
     
     Parameters  
     ---------- 
@@ -1433,14 +1372,193 @@
                              self.X_.shape), UserWarning)
             self._logging.info('X become a spared matrix. The new shape is'
                                '{X.shape!r} against the orignal '
                                '{self.X_shape!r}')
             
         return X
         
+def featurize_X (
+    X, 
+    y =None, *, 
+    n_clusters:int=7, 
+    target_scale:float= 5 ,
+    random_state:F|int=None, 
+    n_components: int=None,  
+    model: F =None, 
+    split_X_y:bool = False,
+    test_ratio:float|str= .2 , 
+    shuffle:bool=True, 
+    return_model:bool=...,
+    to_sparse: bool=..., 
+    sparsity:str ='coo' 
+    ): 
+    """ Featurize X with the cluster based on the KMeans featurization
+    
+    Parameters 
+    -----------
+    X : {array-like, sparse matrix} of shape (n_samples, n_features)
+        Training vector, where `n_samples` is the number of samples and
+        `n_features` is the number of features. 
+        Note ttaht when `n_components` is set, sparse matrix for `X` is not 
+        acceptable. 
+
+    y : array-like of shape (n_samples,)
+        Target vector relative to X.
+        
+    n_clusters: int, default=7
+       Number of initial clusters
+       
+    target_scale: float, default=5.0 
+       Apply appropriate scaling and include it in the input data to k-means.
+    n_components: int, optional
+       Number of components for reduced down the predictor X. It uses the PCA 
+       to reduce down dimension to the importance components. 
+       
+    model: :class:`KMeansFeaturizer`. 
+       KMeasFeaturizer model. Model can be provided to featurize the 
+       test data seperated from the train data. 
+       
+       .. versionadded:: 0.2.4 
+       
+    random_state: int, Optional 
+       State for shuffling the data 
+       
+    split_X_y: bool, default=False, 
+       Split the X, y into train data and test data  according to the test_size 
+       
+    test_ratio: int, default=0.2 
+       ratio to keep for a test data. 
+       
+    shuffle: bool, default=True
+       Suffling the data set. 
+       
+    return_model: bool, default =False 
+       If ``True`` return the KMeans featurization mode and the transformed X.
+       
+    to_sparse: bool, default=False 
+       Convert X data to sparse matrix, by default the sparse matrix is 
+       coordinates matrix (COO) 
+       
+    sparsity:str, default='coo'
+       Kind of sparse matrix use to convert `X`. It can be ['csr'|'coo']. Any 
+       other values with return a coordinates matrix unless `to_sparse` is 
+       turned to ``False``. 
+ 
+       .. versionadded:: 0.2.4 
+ 
+    Returns 
+    -------- 
+    X, y : NDArray shape (m_samples, n_features +1) or \
+        shape (m_samples, n_sparse_features)
+        Returns NDArray of m_features plus the clusters features from KMF 
+        feturization procedures. The `n_sparse_features` is created if 
+        `to_sparse` is set to ``True``. 
+   X, y, KMFmodel: NDarray and KMF models 
+       Returns transformed array X and y and model if   ``return_model`` is 
+       set to ``True``. 
+   
+      Array like train data X transformed  and test if `split_X_y` is set to 
+      ``True``. 
+    
+    Examples 
+    --------
+    >>> import numpy as np 
+    >>> from watex.transformers import featurize_X 
+    >>> X = np.random.randn (12 , 7 ) ; y = np.arange(12 )
+    >>> y[ y < 6 ]= 0 ; y [y >0 ]= 1  # for binary data 
+    >>> Xtransf , _ = featurize_X (X, to_sparse =False)
+    >>> X.shape, Xtransf.shape 
+    ((12, 7), (12, 8))
+    >>> Xtransf, y  = featurize_X (X,y,  to_sparse =True )
+    >>> Xtransf , y
+    (<12x8 sparse matrix of type '<class 'numpy.float64'>'
+     	with 93 stored elements in COOrdinate format>,
+     array([0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1]))
+    >>> featurize_X (X,y,  to_sparse =True, split_X_y=True  )
+    (<9x8 sparse matrix of type '<class 'numpy.float64'>'
+     	with 71 stored elements in COOrdinate format>,
+     <3x8 sparse matrix of type '<class 'numpy.float64'>'
+     	with 24 stored elements in COOrdinate format>,
+     array([0, 1, 1, 0, 0, 0, 0, 1, 1]),
+     array([0, 1, 1]))
+    >>> *_, kmf_model = featurize_X (X,y,  to_sparse =True, return_model =True)
+    >>> kmf_model 
+    <'KMeansFeaturizer':n_clusters=7, target_scale=5, random_state=None, 
+    n_components=None>
+    """ 
+    # set False to value use 
+    # ellipsis...
+    if return_model is ...:
+        return_model =False 
+    if to_sparse is ...:
+        to_sparse =False 
+    
+    # if sparse convert X  to sparse matrix 
+    if to_sparse: 
+        d_sparsity  = dict ( csr =  sparse.csr_matrix , 
+            coo=  sparse.coo_matrix ) 
+        sparse_func = sparse.coo_matrix  if str(sparsity) not in (
+            'coo', 'csr')  else d_sparsity.get (sparsity ) 
+    
+    # reduce down feature to two. 
+    kmf_data = []
+    if n_components: 
+        from watex.analysis import nPCA 
+        X =nPCA (X, n_components = n_components  ) 
+        
+    if split_X_y: 
+        X, test_data , y, y_test = train_test_split ( 
+            X, y ,test_size = assert_ratio(test_ratio) , 
+            random_state = random_state ,
+            shuffle =shuffle)
+        
+    # create a kmeaturization with hint model
+    if model: 
+        if get_estimator_name(model ) !='KMeansFeaturizer': 
+            raise EstimatorError(
+                "Wrong model estimator. Expect 'KMeansFeaturizer'"
+                f" as the valid estimator. Got {get_estimator_name (model)!r}")
+            
+        if callable ( model ): 
+            model = model (n_clusters=n_clusters, 
+            target_scale=target_scale, 
+            random_state = random_state)
+    else: 
+        model = KMeansFeaturizer(
+            n_clusters=n_clusters, 
+            target_scale=target_scale, 
+            random_state = random_state, 
+            ).fit(X,y)
+        
+    ### Use the k-means featurizer to generate cluster features
+    transf_cluster = model.transform(X)
+    ### Form new input features with cluster features
+    # training_with_cluster
+    
+    Xkmf = np.concatenate (
+        (X, transf_cluster), axis =1 )
+    if to_sparse: 
+        Xkmf= sparse_func(Xkmf )
+
+    kmf_data.append(Xkmf)
+    kmf_data.append(y) 
+    if split_X_y: 
+
+        transf_test_cluster= model.transform(test_data)
+        test_with_cluster = np.concatenate (
+            (test_data, transf_test_cluster),axis =1 )
+        if sparse: 
+            test_with_cluster= sparse_func(test_with_cluster)
+ 
+        kmf_data.insert(1,test_with_cluster )
+        kmf_data.append( y_test)
+
+        
+    return  tuple (kmf_data ) + (model, ) \
+        if return_model else tuple(kmf_data )
```

### Comparing `watex-0.2.3/watex/utils/__init__.py` & `watex-0.2.4/watex/utils/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/_array_api.py` & `watex-0.2.4/watex/utils/_array_api.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/_arraytools.py` & `watex-0.2.4/watex/utils/_arraytools.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/_dependency.py` & `watex-0.2.4/watex/utils/_dependency.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/_openmp_helpers.pyx` & `watex-0.2.4/watex/utils/_openmp_helpers.pyx`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/_packaging_version.py` & `watex-0.2.4/watex/utils/_packaging_version.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/_set_gdal.py` & `watex-0.2.4/watex/utils/_set_gdal.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/_show_versions.py` & `watex-0.2.4/watex/utils/_show_versions.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/coreutils.py` & `watex-0.2.4/watex/utils/coreutils.py`

 * *Files 0% similar despite different names*

```diff
@@ -2025,15 +2025,15 @@
     reflong: float or string or list of [start, stop]
         Reference longitude  in degree decimal or in DD:MM:SS for the first 
         site considered as the origin of the landmark.
         
     reflat: float or string or list of [start, stop]
         Reference latitude in degree decimal or in DD:MM:SS for the reference  
         site considered as the landmark origin. If value is given in a list, 
-        it can containt the start point and the stop point. 
+        it can contain the start point and the stop point. 
         
     nsites: int or float 
         Number of site to generate the coordinates onto. 
         
     r: float or int 
         The rotate angle in degrees. Rotate the angle features the direction
         of the projection line. Default value is ``45`` degrees.
```

### Comparing `watex-0.2.3/watex/utils/epsg.npy` & `watex-0.2.4/watex/utils/epsg.npy`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/exmath.py` & `watex-0.2.4/watex/utils/exmath.py`

 * *Files 0% similar despite different names*

```diff
@@ -5303,15 +5303,15 @@
                             color="k",
                             linestyle="--", 
                             lw=1. 
                             )
                 
         ax.set_xlabel ('Distance (m)', fontsize =1.2 * fontsize,
                        fontdict ={'weight': 'bold'})
-        ax.set_ylabel (f"Confidence ratio in {clab}", fontsize = 1.2 * fontsize , 
+        ax.set_ylabel ("Confidence ratio x100 (%)", fontsize = 1.2 * fontsize , 
                        fontdict ={'weight': 'bold'}
                        )
         ax.tick_params (labelsize = fontsize)
         ax.set_xlim ([ d.min(), d.max() ])
         
         # make twin axis to upload the stations 
         #--> set second axis 
@@ -5481,18 +5481,21 @@
     nan_sum  =np.nansum(np.isnan(ar), axis =1) 
 
     rr= np.around ( nan_sum / ar.shape[1] , 2) 
  
     # compute the ratio ck
     # ck = 1. -    rr[np.nonzero(rr)[0]].sum() / (
     #     1 if len(np.nonzero(rr)[0])== 0 else len(np.nonzero(rr)[0])) 
-    # ck =  (1. * len(rr) - len(rr[np.nonzero(rr)[0]]) )  / len(rr) 
-    ck = 1 - nan_sum[np.nonzero(rr)[0]].sum() / (
+    # ck =  (1. * len(rr) - len(rr[np.nonzero(rr)[0]]) )  / len(rr)
+    
+    # using np.nonzero(rr) seems deprecated 
+    # ck = 1 - nan_sum[np.nonzero(rr)[0]].sum() / (
+    #     ar.shape [0] * ar.shape [1]) 
+    ck = 1 - nan_sum[rr[0]].sum() / (
         ar.shape [0] * ar.shape [1]) 
-  
     # now consider dirty data where the value is higher 
     # than the tol parameter and safe otherwise. 
     index = reshape (np.argwhere (rr > tol))
     ar_new = np.delete (rr , index , axis = 0 ) 
     new_f = np.delete (f[:, None], index, axis =0 )
     # interpolate freq 
     if f[0] < f[-1]:
```

### Comparing `watex-0.2.3/watex/utils/funcutils.py` & `watex-0.2.4/watex/utils/funcutils.py`

 * *Files 2% similar despite different names*

```diff
@@ -81,20 +81,25 @@
     
     interp_import = False
     
 #-----
 
 def to_numeric_dtypes (
     arr: NDArray | DataFrame, *, 
-    columns:List[str] = None, 
+    columns:List[str, ...] = None, 
     return_feature_types:bool =False , 
     missing_values:float = np.nan, 
     pop_cat_features:bool=False, 
     sanitize_columns:bool=False, 
-    regex=None, 
+    regex: re | str =None, 
+    fill_pattern: str=None, 
+    drop_nan_columns: bool=True, 
+    how:str='all', 
+    reset_index:bool= False, 
+    drop_index: bool=True, 
     verbose:bool= False,
     )-> DataFrame : 
     """ Convert array to dataframe and coerce arguments to appropriate dtypes. 
     
     Parameters 
     -----------
     arr: Ndarray or Dataframe, shape (M=samples, N=features)
@@ -123,14 +128,39 @@
         the default is:: 
             
         >>> import re 
         >>> re.compile (r'[_#&.)(*@!_,;\s-]\s*', flags=re.IGNORECASE)
           
        .. versionadded:: 0.1.9
        
+    fill_pattern: str, default='' 
+        Pattern to replace the non-alphabetic character in each item of 
+        columns.  
+        
+    drop_nan_columns: bool, default=True 
+       Remove all columns filled by NaN values. 
+        
+       .. versionadded: 0.2.4
+          By default, it auto-removes columns with all NaN values. To 
+          deactive this functionality, set it to ``False``. 
+         
+    how: str, default='all'
+       Drop also the NaN row data. The row data which is composed entirely  
+       with NaN or Null values.
+       
+    reset_index: bool, default=False 
+       Reset the index of the dataframe. 
+       
+       .. versionadded: 0.2.4
+       
+    drop_index: bool, default=True, 
+       Drop index in the dataframe after reseting. 
+       
+       .. versionadded: 0.2.4
+       
     verbose: bool, default=False, 
         outputs a message by listing the categorial items dropped from 
         the dataframe if exists. 
         
     Returns 
     --------
     df or (df, nf, cf): Dataframe of values casted to numeric types 
@@ -152,37 +182,69 @@
     >>> df.dtypes 
     ... shape         object
         power        float64
         magnitude    float64
         dtype: object
         
     """
-    if isinstance (arr, np.ndarray) and columns is None: 
-        warnings.warn("Array is given while columns is not supplied.")
-    # reconvert data to frame 
-    df = pd.DataFrame (arr, columns =columns  
-                       ) if isinstance (arr, np.ndarray) else arr 
-    
-    if sanitize_columns: df = sanitize_frame_cols(df, regex=regex)  
-        
-    nf,cf =[], []
+    from .validator import _is_numeric_dtype
+
+    if hasattr ( arr, '__array__') and hasattr ( arr, 'columns'): 
+        df = arr.copy()
+        if columns is not None: 
+            if verbose: 
+                print("Dataframe is passed. Columns should be replaced.")
+            df =pd.DataFrame ( np.array ( arr), columns =columns )
+            
+    else: df = pd.DataFrame (arr, columns =columns  ) 
+        
+    # sanitize columns 
+    if sanitize_columns: 
+        # Pass in the case columns are all integer values. 
+        if not _is_numeric_dtype(df.columns , to_array=True): 
+           # for consistency reconvert to str 
+           df.columns = df.columns.astype(str) 
+           df = sanitize_frame_cols(
+               df, regex=regex, fill_pattern=fill_pattern ) 
+
     #replace empty string by Nan if NaN exist in dataframe  
     df= df.replace(r'^\s*$', missing_values, regex=True)
     
     # check the possibililty to cast all 
     # the numerical data 
     for serie in df.columns: 
         try: 
             df= df.astype(
                 {serie:np.float64})
+        except:continue
+    
+    # drop nan  columns if exists 
+    if drop_nan_columns: 
+        if verbose: 
+            nan_columns = df.columns [ df.isna().all()].tolist() 
+            print("No NaN column found.") if len(
+                nan_columns)==0 else listing_items_format (nan_columns, 
+                    "NaN columns found in the data",
+                    " ", inline =True, lstyle='.')                               
+        # drop rows and columns with NaN values everywhere.                                                   
+        df.dropna ( axis=1, how='all', inplace =True)
+        if str(how).lower()=='all': 
+            df.dropna ( axis=0, how='all', inplace =True)
+    
+    # reset_index of the dataframe
+    # This is useful after droping rows
+    if reset_index: 
+        df.reset_index (inplace =True, drop = drop_index )
+    # collect numeric and non-numeric data 
+    nf, cf =[], []    
+    for serie in df.columns: 
+        if _is_numeric_dtype(df[serie], to_array =True ): 
             nf.append(serie)
-        except:
-            cf.append(serie)
-            continue
-        
+        else: cf.append(serie)
+
     if pop_cat_features: 
         [ df.pop(item) for item in cf ] 
         if verbose: 
             msg ="Dataframe does not contain any categorial features."
             b= f"Feature{'s' if len(cf)>1 else ''}"
             e = (f"{'have' if len(cf) >1 else 'has'} been dropped"
                  " from the dataframe.")
@@ -5697,37 +5759,37 @@
     parse_on:bool=False, 
     mode: str='strict', 
     coerce:bool = False, 
     force:bool =False, 
     decimals: int = 7, 
     raise_warn:bool =True 
 )-> DataFrame : 
-    """ Find indentical object in all data and concatenate them  using merge 
+    """ Find indentical object in all data and concatenate them using merge 
      intersection (`cross`) strategy.
     
     Parameters 
     ---------- 
     d: List of DataFrames 
        List of pandas DataFrames 
     on: str, label or list 
        Column or index level names to join on. These must be found in 
-       all DataFrames. If `on` is None and not merging on indexes then 
+       all DataFrames. If `on` is ``None`` and not merging on indexes then 
        a concatenation along columns axis is performed in all DataFrames. 
        Note that `on` works with `parse_on` if its argument is  a list of 
        columns names passed into single litteral string. For instance:: 
            
         on ='longitude latitude' --[parse_on=True]-> ['longitude' , 'latitude'] 
         
     parse_on: bool, default=False 
        Parse `on` arguments if given as string and return_iterable objects. 
        
     mode: str, default='strict' 
       Mode to the data. Can be ['soft'|'strict']. In ``strict`` mode, all the 
       data passed must be a DataFrame, otherwise an error raises. in ``soft``
-      mode , ignore the non-DataFrame. Note that any other values should be 
+      mode, ignore the non-DataFrame. Note that any other values should be 
       in ``strict`` mode. 
       
     coerce: bool, default=False 
        Truncate all DataFrame size to much the shorter one before performing 
        the ``merge``. 
         
     force: bool, default=False, 
@@ -5775,16 +5837,16 @@
     None  200.0  20.0  schlumberger  ...      1  110.486111  26.05174
     >>> twinning (table1, table.table_,  ) 
            dipole   longitude  latitude  ...  nareas   longitude  latitude
     line1    10.0  110.486111  26.05174  ...     NaN         NaN       NaN
     None      NaN         NaN       NaN  ...     1.0  110.486111  26.05174
     >>> twinning (table1, table.table_, on =['longitude', 'latitude'] ) 
     Empty DataFrame 
-    >>> # comments: Empty dataframe appears because , decimal is too large 
-    >>> # then consider values longitude and latitude differents 
+    >>> # comments: Empty dataframe appears because, decimal is too large 
+    >>> # then it considers values longitude and latitude differents 
     >>> twinning (table1, table.table_, on =['longitude', 'latitude'], decimals =5 ) 
         dipole  longitude  latitude  ...  max_depth  ohmic_area  nareas
     0      10  110.48611  26.05174  ...      109.0  690.063003       1
     >>> # Now is able to find existing dataframe with identical closer coordinates. 
     
     """
     from .validator import _is_numeric_dtype  
@@ -5847,16 +5909,16 @@
             except : 
                 pass 
             else:
                 repl_twd = o [ on ]
                 break 
             
         if repl_twd is None: 
-            raise ValueError("To force data that have not consistent items."
-                             f" At least {smart_format(on)} items must"
+            raise ValueError("To force data that have not consistent items,"
+                             f" at least {smart_format(on)} items must"
                              " be included in one DataFrame.")
         # make add twin_data if 
         for o in d : 
             try : exist_features(o, on) 
             except : 
                 a = o.copy()  
                 a [ on ] = repl_twd 
@@ -6053,27 +6115,29 @@
        Allow or disallow sampling of the same row more than once. 
        
     random_state: int, array-like, BitGenerator, np.random.RandomState, \
         np.random.Generator, optional
        If int, array-like, or BitGenerator, seed for random number generator. 
        If np.random.RandomState or np.random.Generator, use as given.
        
+    split_Xy: 
     Returns 
     ----------
     d: {array-like, sparse matrix} of shape (n_samples, n_features)
     samples data based on the given samples. 
     
     Examples
     ---------
     >>> from watex.utils.funcutils import random_sampling 
     >>> from watex.datasets import load_hlogs 
     >>> data= load_hlogs().frame
     >>> random_sampling( data, samples = 7 ).shape 
     (7, 27)
     """
+
     n= None ; is_percent = False
     orig= copy.deepcopy(samples )
     if not hasattr(d, "__iter__"): 
         d = is_iterable(d, exclude_string= True, transform =True )
     
     if ( 
             samples is None 
@@ -6104,28 +6168,28 @@
         
     # reset samples and use number of samples instead    
     samples =None  
     # get the total length of d
     dlen = ( d.shape[0] if scipy.sparse.issparse(d) else len(d))
     # if number is greater than the length 
     # block to the length so to retrieve all 
-    # value no matter the arangement. 
+    # value no matter the arrangement. 
     if n > dlen: 
         n = dlen
     if hasattr (d, 'columns') or hasattr (d, 'name'): 
         # data frame 
         return d.sample ( n= n , frac=samples , replace = replace ,
                          random_state = random_state  
                      ) if shuffle else d.iloc [ :n , ::] 
-    
+        
     np.random.seed ( random_state)
     if scipy.sparse.issparse(d) : 
         if scipy.sparse.isspmatrix_coo(d): 
-            warnings.warn("coo_matrix does not support indexing. It should be "
-                          "to convert it to a CSR matrix")
+            warnings.warn("coo_matrix does not support indexing. Conversion"
+                          " should be performed in CSR matrix")
             d = d.tocsr() 
             
         return d [ np.random.choice(
             np.arange(d.shape[0]), n, replace=replace )] if shuffle else d [
                 [ i for i in range (n)]]
                 
         #d = d[idx ]
@@ -6139,16 +6203,19 @@
     else: d = d[idx , :]
         
     return d 
 
 
 def make_obj_consistent_if ( 
         item= ... , default = ..., size =None, from_index: bool =True ): 
-    """Combine default values to item to create default consistent iterable objects if 
-    the size of item does not fit the number of expected iterable objects.     
+    """Combine default values to item to create default consistent iterable 
+    objects. 
+    
+    This is valid if  the size of item does not fit the number of 
+    expected iterable objects.     
     
     Parameters 
     ------------
     item : Any 
        Object to construct it default values 
        
     default: Any 
@@ -6254,17 +6321,70 @@
     if not hasattr (y, '__array__') and y is not None : 
         y = np.array(y)
 
     return concat_data ( X) if y is None else (
             concat_data( X) , concat_data(y))
         
         
+def convert_value_in (v, /, unit ='m'): 
+    """Convert value based on the reference unit.
     
+    Parameters 
+    ------------
+    v: str, float, int, 
+      value to convert 
+    unit: str, default='m'
+      Reference unit to convert value in. Default is 'meters'. Could be 
+      'kg' or else. 
+      
+    Returns
+    -------
+    v: float, 
+       Value converted. 
+       
+    Examples 
+    ---------
+    >>> from watex.utils.funcutils import convert_value_in 
+    >>> convert_value_in (20) 
+    20.0
+    >>> convert_value_in ('20mm') 
+    20000.0
+    >>> convert_value_in ('20kg', unit='g') 
+    0.02
+    >>> convert_value_in ('20') 
+    20.0
+    >>> convert_value_in ('20m', unit='g')
+    ValueError: Unknwon unit 'm'...
+    """
+    c= { 'k':1e3 , 
+        'h':1e2 , 
+        'dc':1e1 , 
+        '':1e0 , 
+        'd':1e-1, 
+        'c':1e-2 , 
+        'm':1e-3  
+        }
+    c = {k +str(unit).lower(): v for k, v in c.items() }
+
+    v = str(v).lower()  
+
+    regex = re.findall(r'[a-zA-Z]', v) 
+    
+    if len(regex) !=0: 
+        unit = ''.join( regex ) 
+        v = v.replace (unit, '')
+
+    if unit not in c.keys(): 
+        raise ValueError (
+            f"Unknwon unit {unit!r}. Expect {smart_format(c.keys(), 'or' )}."
+            f" Or rename the `unit` parameter maybe to {unit[-1]!r}.")
     
-    
+    return float ( v)/ (c.get(unit) or 1e0) 
+
+
```

### Comparing `watex-0.2.3/watex/utils/geotools.py` & `watex-0.2.4/watex/utils/geotools.py`

 * *Files 2% similar despite different names*

```diff
@@ -15,19 +15,124 @@
 import pandas as pd 
 import matplotlib.pyplot as plt
 import matplotlib.gridspec as GridSpec
 
 from .funcutils import ( 
     smart_format, 
     station_id, 
+    convert_value_in 
     )
-from ..exceptions import StrataError 
+from ..exceptions import StrataError, DepthError  
 from .._watexlog import watexlog 
 _logger = watexlog().get_watex_logger(__name__ )
 
+def get_random_thickness(
+    depth, / , 
+    n_layers=None, 
+    h0= 1 , 
+    shuffle = True , 
+    dirichlet_dist=False, 
+    random_state= None, 
+    unit ='m'
+): 
+    """ Generate a random thickness value for number of layers 
+    in deeper. 
+    
+    Parameters 
+    -----------
+    depth: ArrayLike, float 
+       Depth data. If ``float`` the number of layers `n_layers` must 
+       be specified. Otherwise an error occurs. 
+    n_layers: int, Optional 
+       Number of layers that fit the samples in depth. If depth is passed 
+       as an ArrayLike, `n_layers` is ignored instead. 
+    h0: int, default='1m' 
+      Thickness of the first layer. 
+      
+    shuffle: bool, default=True 
+      Shuffle the random generated thicknesses. 
+
+    dirichlet_dis: bool, default=False 
+      Draw samples from the Dirichlet distribution. A Dirichlet-distributed 
+      random variable can be seen as a multivariate generalization of a 
+      Beta distribution. The Dirichlet distribution is a conjugate prior 
+      of a multinomial distribution in Bayesian inference.
+      
+    random_state: int, array-like, BitGenerator, np.random.RandomState, \
+         np.random.Generator, optional
+      If int, array-like, or BitGenerator, seed for random number generator. 
+      If np.random.RandomState or np.random.Generator, use as given.
+      
+    unit: str, default='m' 
+      The reference unit for generated layer thicknesses. Default is 
+      ``meters``
+      
+    Return 
+    ------ 
+    thickness: Arraylike of shape (n_layers, )
+      ArrayLike of shape equals to the number of layers.
+      
+    Examples
+    ---------
+    >>> from watex.utils.geotools import get_random_thickness 
+    >>> get_random_thickness (7, 10, random_state =42  )
+    array([0.41865079, 0.31785714, 1.0234127 , 1.12420635, 0.51944444,
+           0.92261905, 0.6202381 , 0.8218254 , 0.72103175, 1.225     ])
+    >>> get_random_thickness (7, 10, random_state =42 , dirichlet_dist=True )
+    array([1.31628992, 0.83342521, 1.16073915, 1.03137592, 0.79986286,
+           0.8967135 , 0.97709521, 1.34502617, 1.01632075, 0.62315132])
+    """
+
+    if hasattr (depth , '__array__'): 
+        max_depth = max( depth )
+        n_layers = len(depth )
+        
+    else: 
+        try: 
+            max_depth = float( depth )
+        except: 
+            raise DepthError("Depth must be a numeric or arraylike of float."
+                             f"Got {type (depth).__name__!r}")
+
+    if n_layers is None: 
+        raise DepthError ("'n_layers' is needed when depth is not an arraylike.")
+
+    layer0 = copy.deepcopy(h0)
+
+    try: 
+        h0= convert_value_in (h0 , unit=unit)
+    except : 
+        raise TypeError(f"Invalid thickness {layer0}. The thickness for each"
+                        f" stratum should be numeric.Got {type(layer0).__name__!r}")
+
+    thickness = np.linspace  (h0 , max_depth, n_layers) 
+    thickness /= max_depth 
+    # add remain data value to depth. 
+    if  round ( max_depth - thickness.sum(), 2)!=0: 
+        
+        thickness +=  np.linspace (h0, abs (max_depth - thickness.sum()),
+                                   n_layers )/thickness.sum()
+    if dirichlet_dist: 
+        if random_state: 
+            np.random.seed (random_state )
+        if n_layers < 32: 
+            thickness= np.random.dirichlet (
+                np.ones ( n_layers), size =n_layers) 
+            thickness= np.sum (thickness, axis = 0 )
+        else: 
+            thickness= np.random.dirichlet (thickness) 
+            thickness *= max_depth  
+    
+    if shuffle: 
+        ix = np.random.permutation (
+            np.arange ( len(thickness)))
+        thickness= thickness[ix ]
+  
+    return thickness 
+
 
 def lns_and_tres_split(ix,  lns, tres):
     """ Indeed lns and tres from `GeoStratigraphy` model are updated. 
     
     Then splitting the `lns` and `tres` from the topped up values is necessary.
     Kind to resetting `tres` and `ln `back to original and return each split
     of inputting layers and TRES and the automatic rocks topped up
@@ -811,17 +916,14 @@
     print('{:~^108}'.format(
         f' Survey Line: {inversion_software} files properties '))
     print('|' + ''.join([ "{0:<5} = {1:<17}|".format(
         i, os.path.basename( str(getattr(obj, f'{i}_fn'))))  
      for i in ['model', 'iter', 'mesh', 'data']]) )
     print('~'*108)
 
-
-
-
 def map_bottom (bottom, data, origin=None): 
     """Reduce the plot map from the top assumes to start at 0. to the
     bottom value.
     
     :param bottom: float, is the bottom value from
         which the plot must be end 
     :param data: the list of layers thicknesses in meters
```

### Comparing `watex-0.2.3/watex/utils/gistools.py` & `watex-0.2.4/watex/utils/gistools.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/hydroutils.py` & `watex-0.2.4/watex/utils/hydroutils.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/mlutils.py` & `watex-0.2.4/watex/utils/mlutils.py`

 * *Files 0% similar despite different names*

```diff
@@ -2639,18 +2639,19 @@
     prefit = True , 
     verbose = 0 ,
     return_selector =False, 
     **kws
     ): 
     """
     Select feature importance  based on a user-specified threshold 
-    after model fitting, which is useful if one want to use 
-    `RandomForestClassifier` as a feature selector and intermediate step in 
-    scikit-learn ``Pipeline`` object, which allows us to connect different 
-    processing steps  with an estimator. 
+    after model fitting. 
+    
+    This is useful if one want to use `RandomForestClassifier` as a feature 
+    selector and intermediate step in scikit-learn ``Pipeline`` object, which 
+    allows us to connect different processing steps  with an estimator. 
   
     Parameters 
     ----------
     clf : estimator object
         The base estimator from which the transformer is built.
         This can be both a fitted (if ``prefit`` is set to True)
         or a non-fitted estimator. The estimator should have a
```

### Comparing `watex-0.2.3/watex/utils/plotutils.py` & `watex-0.2.4/watex/utils/plotutils.py`

 * *Files 0% similar despite different names*

```diff
@@ -86,8513 +86,8548 @@
 00000550: 6772 6573 7369 6f6e 2c20 0d0a 2020 2020  gression, ..    
 00000560: 2020 2020 4d69 6e4d 6178 5363 616c 6572      MinMaxScaler
 00000570: 2c20 0d0a 2020 2020 2020 2020 5369 6d70  , ..        Simp
 00000580: 6c65 496d 7075 7465 722c 200d 0a20 2020  leImputer, ..   
 00000590: 2020 2020 204b 4d65 616e 732c 200d 0a20       KMeans, .. 
 000005a0: 2020 2020 2020 2073 696c 686f 7565 7474         silhouett
 000005b0: 655f 7361 6d70 6c65 732c 200d 0a20 2020  e_samples, ..   
-000005c0: 2020 2020 2072 6f63 5f63 7572 7665 0d0a       roc_curve..
-000005d0: 2020 2020 2020 2020 2920 0d0a 6578 6365          ) ..exce
-000005e0: 7074 203a 2070 6173 7320 0d0a 200d 0a74  pt : pass .. ..t
-000005f0: 7279 203a 200d 0a20 2020 2066 726f 6d20  ry : ..    from 
-00000600: 7965 6c6c 6f77 6272 6963 6b2e 636c 6173  yellowbrick.clas
-00000610: 7369 6669 6572 2069 6d70 6f72 7420 436f  sifier import Co
-00000620: 6e66 7573 696f 6e4d 6174 7269 7820 0d0a  nfusionMatrix ..
-00000630: 6578 6365 7074 3a20 7061 7373 200d 0a0d  except: pass ...
-00000640: 0a44 5f43 4f4c 4f52 5320 3d5b 0d0a 2020  .D_COLORS =[..  
-00000650: 2020 2767 272c 0d0a 2020 2020 2767 7261    'g',..    'gra
-00000660: 7927 2c0d 0a20 2020 2027 7927 2c20 0d0a  y',..    'y', ..
-00000670: 2020 2020 2762 6c75 6527 2c0d 0a20 2020      'blue',..   
-00000680: 2027 6f72 616e 6765 272c 0d0a 2020 2020   'orange',..    
-00000690: 2770 7572 706c 6527 2c0d 0a20 2020 2027  'purple',..    '
-000006a0: 6c69 6d65 272c 0d0a 2020 2020 276b 272c  lime',..    'k',
-000006b0: 200d 0a20 2020 2027 6379 616e 272c 200d   ..    'cyan', .
-000006c0: 0a20 2020 2028 2e36 2c20 2e36 2c20 2e36  .    (.6, .6, .6
-000006d0: 292c 0d0a 2020 2020 2830 2c20 2e36 2c20  ),..    (0, .6, 
-000006e0: 2e33 292c 200d 0a20 2020 2028 2e39 2c20  .3), ..    (.9, 
-000006f0: 302c 202e 3829 2c0d 0a20 2020 2028 2e38  0, .8),..    (.8
-00000700: 2c20 2e32 2c20 2e38 292c 0d0a 2020 2020  , .2, .8),..    
-00000710: 282e 302c 202e 392c 202e 3429 0d0a 5d0d  (.0, .9, .4)..].
-00000720: 0a0d 0a44 5f4d 4152 4b45 5253 203d 5b0d  ...D_MARKERS =[.
-00000730: 0a20 2020 2027 6f27 2c0d 0a20 2020 2027  .    'o',..    '
-00000740: 5e27 2c0d 0a20 2020 2027 7827 2c0d 0a20  ^',..    'x',.. 
-00000750: 2020 2027 4427 2c0d 0a20 2020 2027 3827     'D',..    '8'
-00000760: 2c0d 0a20 2020 2027 2a27 2c0d 0a20 2020  ,..    '*',..   
-00000770: 2027 6827 2c0d 0a20 2020 2027 7027 2c0d   'h',..    'p',.
-00000780: 0a20 2020 2027 3e27 2c0d 0a20 2020 2027  .    '>',..    '
-00000790: 6f27 2c0d 0a20 2020 2027 6427 2c0d 0a20  o',..    'd',.. 
-000007a0: 2020 2027 4827 0d0a 5d0d 0a0d 0a44 5f53     'H'..]....D_S
-000007b0: 5459 4c45 5320 3d20 5b0d 0a20 2020 2027  TYLES = [..    '
-000007c0: 2d27 2c0d 0a20 2020 2027 2d27 2c0d 0a20  -',..    '-',.. 
-000007d0: 2020 2027 2d2d 272c 0d0a 2020 2020 272d     '--',..    '-
-000007e0: 2e27 2c0d 0a20 2020 2027 3a27 2c20 0d0a  .',..    ':', ..
-000007f0: 2020 2020 274e 6f6e 6527 2c0d 0a20 2020      'None',..   
-00000800: 2027 2027 2c0d 0a20 2020 2027 272c 0d0a   ' ',..    '',..
-00000810: 2020 2020 2773 6f6c 6964 272c 200d 0a20      'solid', .. 
-00000820: 2020 2027 6461 7368 6564 272c 0d0a 2020     'dashed',..  
-00000830: 2020 2764 6173 6864 6f74 272c 0d0a 2020    'dashdot',..  
-00000840: 2020 2764 6f74 7465 6427 200d 0a5d 0d0a    'dotted' ..]..
-00000850: 232d 2d2d 2d0d 0a0d 0a0d 0a64 6566 2070  #----......def p
-00000860: 6c6f 745f 6c6f 6767 696e 6720 2820 0d0a  lot_logging ( ..
-00000870: 2020 2020 582c 200d 0a20 2020 2079 3d4e      X, ..    y=N
-00000880: 6f6e 652c 200d 0a20 2020 207a 6e61 6d65  one, ..    zname
-00000890: 203d 204e 6f6e 652c 200d 0a20 2020 2074   = None, ..    t
-000008a0: 6e61 6d65 203d 204e 6f6e 652c 200d 0a20  name = None, .. 
-000008b0: 2020 206c 6162 656c 733d 4e6f 6e65 2c0d     labels=None,.
-000008c0: 0a20 2020 2069 6d70 7574 655f 6e61 6e3d  .    impute_nan=
-000008d0: 5472 7565 202c 200d 0a20 2020 206e 6f72  True , ..    nor
-000008e0: 6d61 6c69 7a65 203d 2046 616c 7365 2c20  malize = False, 
-000008f0: 0d0a 2020 2020 6c6f 6731 303d 4661 6c73  ..    log10=Fals
-00000900: 652c 200d 0a20 2020 2063 6f6c 756d 6e73  e, ..    columns
-00000910: 5f74 6f5f 736b 6970 203d 4e6f 6e65 2c20  _to_skip =None, 
-00000920: 0d0a 2020 2020 7061 7474 6572 6e20 3d20  ..    pattern = 
-00000930: 4e6f 6e65 2c20 0d0a 2020 2020 7374 7261  None, ..    stra
-00000940: 7465 6779 3d27 6d65 616e 272c 2020 0d0a  tegy='mean',  ..
-00000950: 2020 2020 706f 7369 793d 204e 6f6e 652c      posiy= None,
-00000960: 200d 0a20 2020 2066 696c 6c5f 7661 6c75   ..    fill_valu
-00000970: 6520 3d20 4e6f 6e65 2c20 200d 0a20 2020  e = None,  ..   
-00000980: 2066 6967 5f73 697a 6520 3d20 2831 362c   fig_size = (16,
-00000990: 2037 292c 0d0a 2020 2020 6669 675f 6470   7),..    fig_dp
-000009a0: 6920 3d20 3330 302c 200d 0a20 2020 2063  i = 300, ..    c
-000009b0: 6f6c 6f72 7320 3d20 4e6f 6e65 2c0d 0a20  olors = None,.. 
-000009c0: 2020 2063 7334 5f63 6f6c 6f72 733d 4661     cs4_colors=Fa
-000009d0: 6c73 652c 200d 0a20 2020 2073 6e73 5f73  lse, ..    sns_s
-000009e0: 7479 6c65 203d 4661 6c73 652c 200d 0a20  tyle =False, .. 
-000009f0: 2020 2073 6176 6566 6967 203d 204e 6f6e     savefig = Non
-00000a00: 652c 0d0a 2020 2020 6472 6177 5f73 7069  e,..    draw_spi
-00000a10: 6e65 733d 4661 6c73 652c 200d 0a20 2020  nes=False, ..   
-00000a20: 2073 6565 643d 4e6f 6e65 2c20 0d0a 2020   seed=None, ..  
-00000a30: 2020 7665 7262 6f73 653d 302c 200d 0a20    verbose=0, .. 
-00000a40: 2020 202a 2a6b 7773 0d0a 2020 2020 293a     **kws..    ):
-00000a50: 200d 0a20 2020 2022 2222 2050 6c6f 7420   ..    """ Plot 
-00000a60: 6c6f 6767 696e 6720 6461 7461 2020 0d0a  logging data  ..
-00000a70: 2020 2020 0d0a 2020 2020 506c 6f74 2065      ..    Plot e
-00000a80: 7870 6563 7473 2061 2063 6f6c 6c65 6374  xpects a collect
-00000a90: 696f 6e20 6f66 206c 6f67 6769 6e67 2064  ion of logging d
-00000aa0: 6174 612e 2045 6163 6820 6c6f 6767 696e  ata. Each loggin
-00000ab0: 6720 6461 7461 2063 6f6d 706f 7365 7320  g data composes 
-00000ac0: 6120 0d0a 2020 2020 636f 6c75 6d6e 206f  a ..    column o
-00000ad0: 6620 6461 7461 2063 6f6c 6c65 6374 6564  f data collected
-00000ae0: 206f 6e20 7468 6520 6669 656c 642e 4e6f   on the field.No
-00000af0: 7465 2074 6861 7420 6361 6e20 616c 736f  te that can also
-00000b00: 2070 6c6f 7420 616e 796b 696e 6420 6f66   plot anykind of
-00000b10: 200d 0a20 2020 2064 6174 6120 7265 6c61   ..    data rela
-00000b20: 7465 6420 7468 6174 2069 7420 636f 6e74  ted that it cont
-00000b30: 6169 6e73 206e 756d 6572 6963 616c 2076  ains numerical v
-00000b40: 616c 7565 732e 2054 6865 2066 756e 6374  alues. The funct
-00000b50: 696f 6e20 646f 6573 206e 6f74 200d 0a20  ion does not .. 
-00000b60: 2020 2061 6363 6570 7420 6361 7465 676f     accept catego
-00000b70: 7269 6361 6c20 6461 7461 2e20 2020 4966  rical data.   If
-00000b80: 2063 6174 6567 6f72 6963 616c 2064 6174   categorical dat
-00000b90: 6120 6172 6520 6769 7665 6e2c 2074 6865  a are given, the
-00000ba0: 7920 7368 6f75 6c64 2062 6520 0d0a 2020  y should be ..  
-00000bb0: 2020 6469 7363 6172 6465 642e 200d 0a20    discarded. .. 
-00000bc0: 2020 200d 0a20 2020 2050 6172 616d 6574     ..    Paramet
-00000bd0: 6572 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  ers ..    ------
-00000be0: 2d2d 2d2d 2d0d 0a20 2020 2058 203a 2044  -----..    X : D
-00000bf0: 6174 6166 7261 6d65 206f 6620 7368 6170  ataframe of shap
-00000c00: 6520 286e 5f73 616d 706c 6573 2c20 6e5f  e (n_samples, n_
-00000c10: 6665 6174 7572 6573 290d 0a20 2020 2020  features)..     
-00000c20: 2020 2020 7768 6572 6520 606e 5f73 616d      where `n_sam
-00000c30: 706c 6573 6020 6973 2074 6865 206e 756d  ples` is the num
-00000c40: 6265 7220 6f66 2064 6174 612c 2065 7870  ber of data, exp
-00000c50: 6563 7465 6420 746f 2062 6520 7468 6520  ected to be the 
-00000c60: 6461 7461 200d 0a20 2020 2020 2020 2020  data ..         
-00000c70: 636f 6c6c 6563 7465 6420 6174 2064 6966  collected at dif
-00000c80: 6665 7265 6e74 2064 6570 7468 7320 616e  ferent depths an
-00000c90: 6420 606e 5f66 6561 7475 7265 7360 2069  d `n_features` i
-00000ca0: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
-00000cb0: 0d0a 2020 2020 2020 2020 2063 6f6c 756d  ..         colum
-00000cc0: 6e73 2028 6665 6174 7572 6573 2920 7468  ns (features) th
-00000cd0: 6174 2073 7570 706f 7365 6420 746f 2062  at supposed to b
-00000ce0: 6520 706c 6f74 2e20 0d0a 2020 2020 2020  e plot. ..      
-00000cf0: 2020 204e 6f74 6520 7468 6174 2060 5860     Note that `X`
-00000d00: 206d 7573 7420 696e 636c 7564 6520 7468   must include th
-00000d10: 6520 6060 6465 7074 6860 6020 636f 6c75  e ``depth`` colu
-00000d20: 6d6e 732e 2049 6620 6e6f 7420 6769 7665  mns. If not give
-00000d30: 6e20 6120 0d0a 2020 2020 2020 2020 2072  n a ..         r
-00000d40: 656c 6174 6976 6520 6465 7074 6820 7368  elative depth sh
-00000d50: 6f75 6c64 2062 6520 6372 6561 7465 6420  ould be created 
-00000d60: 6163 636f 7264 696e 6720 746f 2074 6865  according to the
-00000d70: 206e 756d 6265 7220 6f66 2073 616d 706c   number of sampl
-00000d80: 6520 0d0a 2020 2020 2020 2020 2074 6861  e ..         tha
-00000d90: 7420 636f 6d70 6f73 6573 2060 5860 2e0d  t composes `X`..
-00000da0: 0a20 0d0a 2020 2020 7920 3a20 6172 7261  . ..    y : arra
-00000db0: 792d 6c69 6b65 206f 7220 7365 7269 6573  y-like or series
-00000dc0: 206f 6620 7368 6170 6520 286e 5f73 616d   of shape (n_sam
-00000dd0: 706c 6573 2c29 2c20 6f70 7469 6f6e 616c  ples,), optional
-00000de0: 0d0a 2020 2020 2020 2020 5461 7267 6574  ..        Target
-00000df0: 2072 656c 6174 6976 6520 746f 2058 2066   relative to X f
-00000e00: 6f72 2063 6c61 7373 6966 6963 6174 696f  or classificatio
-00000e10: 6e20 6f72 2072 6567 7265 7373 696f 6e3b  n or regression;
-00000e20: 2049 6620 6769 7665 6e2c 2062 7920 0d0a   If given, by ..
-00000e30: 2020 2020 2020 2020 6465 6661 756c 7420          default 
-00000e40: 7468 6520 7461 7267 6574 2070 6c6f 7420  the target plot 
-00000e50: 7368 6f75 6c64 2062 6520 6c6f 6361 7465  should be locate
-00000e60: 6420 6174 2074 6865 206c 6173 7420 706f  d at the last po
-00000e70: 7369 7469 6f6e 2e20 0d0a 2020 2020 2020  sition. ..      
-00000e80: 2020 486f 7765 7665 7220 7769 7468 2074    However with t
-00000e90: 6865 2061 7267 756d 656e 7420 6f66 2060  he argument of `
-00000ea0: 706f 7369 7960 202c 2074 6172 6765 7420  posiy` , target 
-00000eb0: 706c 6f74 2063 616e 2062 6520 746f 6767  plot can be togg
-00000ec0: 6c65 6420 746f 2020 0d0a 2020 2020 2020  led to  ..      
-00000ed0: 2020 7468 6520 6465 7369 7265 6420 706f    the desired po
-00000ee0: 7369 7469 6f6e 2e20 0d0a 0d0a 2020 2020  sition. ....    
-00000ef0: 7a6e 616d 653a 2073 7472 2c20 6465 6661  zname: str, defa
-00000f00: 756c 743d 2764 6570 7468 2720 6f72 2027  ult='depth' or '
-00000f10: 4e6f 6e65 270d 0a20 2020 2020 2020 2054  None'..        T
-00000f20: 6865 206e 616d 6520 6f66 2074 6865 2064  he name of the d
-00000f30: 6570 7468 2063 6f6c 756d 6e20 696e 2060  epth column in `
-00000f40: 5860 2e20 4966 2074 6865 206e 616d 6520  X`. If the name 
-00000f50: 2764 6570 7468 2720 6973 206e 6f74 2020  'depth' is not  
-00000f60: 0d0a 2020 2020 2020 2020 7370 6563 6966  ..        specif
-00000f70: 6965 6420 6173 2074 6865 206d 6169 6e20  ied as the main 
-00000f80: 6465 7074 6820 636f 6c75 6d6e 732c 2061  depth columns, a
-00000f90: 6e20 6f74 6865 7220 6e61 6d65 2069 6e20  n other name in 
-00000fa0: 7468 6520 636f 6c75 6d6e 7320 0d0a 2020  the columns ..  
-00000fb0: 2020 2020 2020 7468 6174 206d 6174 6368        that match
-00000fc0: 6573 2074 6865 2064 6570 7468 2063 616e  es the depth can
-00000fd0: 2061 6c73 6f20 6265 2069 6e64 6963 6174   also be indicat
-00000fe0: 6564 2073 6f20 7468 6520 6675 6e63 7469  ed so the functi
-00000ff0: 6f6e 2077 696c 6c20 7075 7420 0d0a 2020  on will put ..  
-00001000: 2020 2020 2020 6173 6964 6520 7468 6973        aside this
-00001010: 2063 6f6c 756d 6d20 6173 2064 6570 7468   columm as depth
-00001020: 2063 6f6c 756d 6e20 666f 7220 706c 6f74   column for plot
-00001030: 2070 7572 706f 7365 2e20 4966 2073 6574   purpose. If set
-00001040: 2074 6f20 6060 4e6f 6e65 6060 2c20 0d0a   to ``None``, ..
-00001050: 2020 2020 2020 2020 607a 6e61 6d65 6020          `zname` 
-00001060: 686f 6c64 7320 7468 6520 6e61 6d65 2060  holds the name `
-00001070: 6064 6570 7468 6060 2061 6e64 2061 7373  `depth`` and ass
-00001080: 756d 6573 2074 6861 7420 6465 7074 6820  umes that depth 
-00001090: 6578 6973 7473 2069 6e20 0d0a 2020 2020  exists in ..    
-000010a0: 2020 2020 6058 6020 636f 6c75 6d6e 732e      `X` columns.
-000010b0: 0d0a 2020 2020 746e 616d 653a 2073 7472  ..    tname: str
-000010c0: 2c20 6f70 7469 6f6e 616c 2c20 0d0a 2020  , optional, ..  
-000010d0: 2020 2020 2020 6e61 6d65 206f 6620 7468        name of th
-000010e0: 6520 7461 7267 6574 2e20 5468 6973 2063  e target. This c
-000010f0: 616e 2072 656e 616d 6520 6f66 2074 6865  an rename of the
-00001100: 2074 6172 6765 7420 6e61 6d65 2069 6620   target name if 
-00001110: 6769 7665 6e20 6079 600d 0a20 2020 2020  given `y`..     
-00001120: 2020 2061 7320 6120 7061 6e64 6173 2073     as a pandas s
-00001130: 6572 6965 7320 206f 7220 6164 6420 7468  eries  or add th
-00001140: 6520 6e61 6d65 206f 6620 7461 7267 6574  e name of target
-00001150: 2069 6620 6769 7665 6e20 6173 2061 6e20   if given as an 
-00001160: 6172 7261 792d 6c69 6b65 2e20 0d0a 2020  array-like. ..  
-00001170: 2020 2020 2020 4966 206e 6f74 2070 726f        If not pro
-00001180: 7669 6465 642c 2069 7420 7368 6f75 6c64  vided, it should
-00001190: 2075 7365 2074 6865 206e 616d 6520 6f66   use the name of
-000011a0: 2074 6865 2074 6172 6765 7420 7365 7269   the target seri
-000011b0: 6573 2069 6620 6079 6020 6973 0d0a 2020  es if `y` is..  
-000011c0: 2020 2020 2020 6e6f 7420 4e6f 6e65 2e20        not None. 
-000011d0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-000011e0: 6e6f 726d 616c 697a 653a 2062 6f6f 6c2c  normalize: bool,
-000011f0: 2064 6566 6175 6c74 203d 2046 616c 7365   default = False
-00001200: 0d0a 2020 2020 2020 2020 4e6f 726d 616c  ..        Normal
-00001210: 697a 6520 616c 6c20 7468 6520 6461 7461  ize all the data
-00001220: 2074 6f20 6265 2072 616e 6765 2062 6574   to be range bet
-00001230: 7765 656e 2028 302c 2031 2920 6578 6365  ween (0, 1) exce
-00001240: 7074 2074 6865 2060 6465 7074 6860 2c20  pt the `depth`, 
-00001250: 2020 200d 0a20 2020 2020 2020 200d 0a20     ..        .. 
-00001260: 2020 206c 6162 656c 733a 206c 6973 7420     labels: list 
-00001270: 6f72 2073 7472 2c20 6f70 7469 6f6e 616c  or str, optional
-00001280: 0d0a 2020 2020 2020 2020 4966 206c 6162  ..        If lab
-00001290: 656c 7320 6172 6520 6769 7665 6e2c 2074  els are given, t
-000012a0: 6865 7920 7368 6f75 6c64 2066 6974 2074  hey should fit t
-000012b0: 6865 2073 697a 6520 6f66 2074 6865 206e  he size of the n
-000012c0: 756d 6265 7220 6f66 200d 0a20 2020 2020  umber of ..     
-000012d0: 2020 2063 6f6c 756d 6e73 2e20 5468 6520     columns. The 
-000012e0: 6769 7665 6e20 6c61 6265 6c73 2073 686f  given labels sho
-000012f0: 756c 6420 7265 706c 6163 6520 7468 6520  uld replace the 
-00001300: 6f6c 6420 636f 6c75 6d6e 7320 696e 2060  old columns in `
-00001310: 5860 2061 6e64 200d 0a20 2020 2020 2020  X` and ..       
-00001320: 2073 686f 756c 6420 6669 6775 6520 6f75   should figue ou
-00001330: 7420 696e 2074 6865 2070 6c6f 742e 2054  t in the plot. T
-00001340: 6869 7320 6973 2075 7365 6675 6c6c 2074  his is usefull t
-00001350: 6f20 6368 616e 6765 2074 6865 2063 6f6c  o change the col
-00001360: 756d 6e73 200d 0a20 2020 2020 2020 206c  umns ..        l
-00001370: 6162 656c 7320 696e 2074 6865 2064 6174  abels in the dat
-00001380: 6166 7261 6d65 2074 6f20 6120 6e65 7720  aframe to a new 
-00001390: 6c61 6265 6c73 2074 6861 7420 6465 7363  labels that desc
-000013a0: 7269 6265 2074 6865 2062 6573 7420 7468  ribe the best th
-000013b0: 6520 0d0a 2020 2020 2020 2020 706c 6f74  e ..        plot
-000013c0: 203b 2066 6f72 2069 6e73 7461 6e63 6520   ; for instance 
-000013d0: 6279 2069 6e6c 7564 696e 6720 7468 6520  by inluding the 
-000013e0: 756e 6974 7320 696e 2074 6865 206e 6577  units in the new
-000013f0: 206c 6162 656c 732e 204e 6f74 6520 7468   labels. Note th
-00001400: 6174 200d 0a20 2020 2020 2020 2069 6620  at ..        if 
-00001410: 7468 6520 6c61 6265 6c73 2064 6f20 6e6f  the labels do no
-00001420: 7420 6d61 7463 6820 7468 6520 7369 7a65  t match the size
-00001430: 206f 6620 7468 6520 6f6c 6420 636f 6c75   of the old colu
-00001440: 6d6e 7320 696e 2060 5860 2061 2077 6172  mns in `X` a war
-00001450: 6e69 6e67 200d 0a20 2020 2020 2020 2073  ning ..        s
-00001460: 686f 756c 6420 6265 206c 6574 2074 6f20  hould be let to 
-00001470: 7468 6520 7573 6572 2061 6e64 206e 6f6e  the user and non
-00001480: 6520 6f70 6572 6174 696f 6e20 7769 6c6c  e operation will
-00001490: 2062 6520 7065 7266 6f72 6d65 642e 200d   be performed. .
-000014a0: 0a20 2020 2020 2020 200d 0a20 2020 2069  .        ..    i
-000014b0: 6d70 7574 655f 6e61 6e3a 2062 6f6f 6c2c  mpute_nan: bool,
-000014c0: 2064 6566 6175 6c74 3d54 7275 652c 200d   default=True, .
-000014d0: 0a20 2020 2020 2020 2052 6570 6c61 6365  .        Replace
-000014e0: 2074 6865 204e 614e 2076 616c 7565 7320   the NaN values 
-000014f0: 696e 2074 6865 2064 6174 6166 7261 6d65  in the dataframe
-00001500: 2e20 4e6f 7465 2074 6861 7420 7468 6520  . Note that the 
-00001510: 6465 6661 756c 7420 0d0a 2020 2020 2020  default ..      
-00001520: 2020 6265 6861 7669 6f75 7220 666f 7220    behaviour for 
-00001530: 7265 706c 6163 696e 6720 4e61 4e20 6973  replacing NaN is
-00001540: 2074 6865 2060 606d 6561 6e60 602e 2048   the ``mean``. H
-00001550: 6f77 6576 6572 2069 6620 7468 6520 6172  owever if the ar
-00001560: 6775 6d65 6e74 200d 0a20 2020 2020 2020  gument ..       
-00001570: 206f 6620 6066 696c 6c5f 7661 6c75 6560   of `fill_value`
-00001580: 2069 7320 7072 6f76 6964 6564 2c74 6865   is provided,the
-00001590: 206c 6174 7465 7220 7368 6f75 6c64 2062   latter should b
-000015a0: 6520 7573 6564 2074 6f20 7265 706c 6163  e used to replac
-000015b0: 6520 274e 614e 2720 0d0a 2020 2020 2020  e 'NaN' ..      
-000015c0: 2020 696e 2060 5860 2e20 0d0a 2020 2020    in `X`. ..    
-000015d0: 2020 2020 0d0a 2020 2020 6c6f 6731 303a      ..    log10:
-000015e0: 2062 6f6f 6c2c 2064 6566 6175 6c74 3d46   bool, default=F
-000015f0: 616c 7365 0d0a 2020 2020 2020 2020 436f  alse..        Co
-00001600: 6e76 6572 7420 7661 6c75 6573 2074 6f20  nvert values to 
-00001610: 6c6f 6731 302e 2054 6869 7320 6361 6e20  log10. This can 
-00001620: 6265 2075 7365 6675 6c6c 2077 6865 6e20  be usefull when 
-00001630: 7573 696e 6720 7468 6520 6c6f 6761 7269  using the logari
-00001640: 7468 6d20 0d0a 2020 2020 2020 2020 6461  thm ..        da
-00001650: 7461 2e20 486f 7765 7665 722c 2069 7420  ta. However, it 
-00001660: 7365 656d 7320 6e6f 7420 616c 6c20 7468  seems not all th
-00001670: 6520 6461 7461 2063 616e 2062 6520 7573  e data can be us
-00001680: 6564 2074 6869 7320 6f70 6572 6174 696f  ed this operatio
-00001690: 6e2c 200d 0a20 2020 2020 2020 2066 6f72  n, ..        for
-000016a0: 2069 6e73 7461 6e63 652c 2061 206e 6567   instance, a neg
-000016b0: 6174 6976 6520 6461 7461 2e20 496e 2074  ative data. In t
-000016c0: 6861 7420 6361 7365 2c20 6063 6f6c 756d  hat case, `colum
-000016d0: 6e5f 746f 5f73 6b69 7060 2061 7267 756d  n_to_skip` argum
-000016e0: 656e 740d 0a20 2020 2020 2020 2069 7320  ent..        is 
-000016f0: 7573 6566 756c 6c20 746f 2070 726f 7669  usefull to provi
-00001700: 6465 2073 6f20 746f 2073 6b69 7020 7468  de so to skip th
-00001710: 6174 2063 6f6c 756d 6e73 2077 6865 6e20  at columns when 
-00001720: 636f 6e76 6572 7469 6e67 2076 616c 7565  converting value
-00001730: 7320 0d0a 2020 2020 2020 2020 746f 206c  s ..        to l
-00001740: 6f67 3130 2e20 0d0a 200d 0a20 2020 2063  og10. .. ..    c
-00001750: 6f6c 756d 6e73 5f74 6f5f 736b 6970 3a20  olumns_to_skip: 
-00001760: 6c69 7374 206f 7220 7374 722c 206f 7074  list or str, opt
-00001770: 696f 6e61 6c2c 200d 0a20 2020 2020 2020  ional, ..       
-00001780: 2043 6f6c 756d 6e73 2074 6f20 736b 6970   Columns to skip
-00001790: 2077 6865 6e20 7065 7266 6f72 6d69 6e67   when performing
-000017a0: 2073 6f6d 6520 6f70 6572 6174 696f 6e20   some operation 
-000017b0: 6c69 6b65 2027 6c6f 6731 3027 2e20 5468  like 'log10'. Th
-000017c0: 6573 6520 0d0a 2020 2020 2020 2020 636f  ese ..        co
-000017d0: 6c75 6d6e 7320 7769 7468 206e 6f74 2062  lumns with not b
-000017e0: 6520 6166 6665 6374 6564 2062 7920 7468  e affected by th
-000017f0: 6520 276c 6f67 3130 2720 6f70 6572 6174  e 'log10' operat
-00001800: 696f 6e73 2e20 4e6f 7465 2074 6861 7420  ions. Note that 
-00001810: 0d0a 2020 2020 2020 2060 636f 6c75 6d6e  ..       `column
-00001820: 735f 746f 5f73 6b69 7060 2063 616e 2061  s_to_skip` can a
-00001830: 6c73 6f20 6769 7665 7320 6173 206c 6974  lso gives as lit
-00001840: 7465 7261 6c20 7374 7269 6e67 2e20 496e  teral string. In
-00001850: 2074 6861 7420 6361 7365 2c20 7468 6520   that case, the 
-00001860: 0d0a 2020 2020 2020 2060 7061 7474 6572  ..       `patter
-00001870: 6e60 2069 7320 6e65 6564 2074 6f20 7061  n` is need to pa
-00001880: 7273 6520 7468 6520 636f 6c75 6d6e 7320  rse the columns 
-00001890: 696e 746f 2061 206c 6973 7420 6f66 2073  into a list of s
-000018a0: 7472 696e 672e 200d 0a20 2020 2020 2020  tring. ..       
-000018b0: 0d0a 2020 2020 7061 7474 6572 6e3a 2073  ..    pattern: s
-000018c0: 7472 2c20 6465 6661 756c 7420 3d20 275b  tr, default = '[
-000018d0: 2326 2a40 212c 3b5c 735d 5c73 2a27 0d0a  #&*@!,;\s]\s*'..
-000018e0: 2020 2020 2020 2020 5265 6765 7820 7061          Regex pa
-000018f0: 7474 6572 6e20 746f 2070 6172 7365 2074  ttern to parse t
-00001900: 6865 2060 636f 6c75 6d6e 735f 746f 5f73  he `columns_to_s
-00001910: 6b69 7060 2069 6e74 6f20 6120 6c69 7374  kip` into a list
-00001920: 206f 6620 7374 7269 6e67 200d 0a20 2020   of string ..   
-00001930: 2020 2020 2077 6865 7265 2065 6163 6820       where each 
-00001940: 6974 656d 2069 7320 6120 636f 6c75 6d6e  item is a column
-00001950: 206e 616d 6520 6573 7065 6369 616c 6c79   name especially
-00001960: 2077 6865 6e20 7468 6520 6c61 7474 6572   when the latter
-00001970: 2069 7320 6769 7665 6e20 0d0a 2020 2020   is given ..    
-00001980: 2020 2020 6173 206c 6974 7465 7261 6c20      as litteral 
-00001990: 7465 7874 2073 7472 696e 672e 2046 6f72  text string. For
-000019a0: 2069 6e73 7461 6e63 653a 3a20 0d0a 2020   instance:: ..  
-000019b0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-000019c0: 2020 2020 2020 2020 636f 6c75 6d6e 735f          columns_
-000019d0: 746f 5f73 6b69 703d 2764 6570 7468 5f74  to_skip='depth_t
-000019e0: 6f70 2c20 7468 6963 6b6e 6573 732c 2073  op, thickness, s
-000019f0: 702c 2067 616d 6d61 5f67 616d 6d61 2720  p, gamma_gamma' 
-00001a00: 200d 0a20 2020 2020 2020 2020 2020 202d   ..            -
-00001a10: 3e20 5b27 6465 7074 685f 746f 7027 2c20  > ['depth_top', 
-00001a20: 2774 6869 636b 6e65 7373 272c 2027 7370  'thickness', 'sp
-00001a30: 272c 2027 6761 6d6d 615f 6761 6d6d 6127  ', 'gamma_gamma'
-00001a40: 5d0d 0a20 2020 2020 2020 2020 2020 200d  ]..            .
-00001a50: 0a20 2020 2020 2020 2062 7920 7573 696e  .        by usin
-00001a60: 6720 7468 6520 6465 6661 756c 7420 7061  g the default pa
-00001a70: 7474 6572 6e2e 2054 6f20 6861 7665 2066  ttern. To have f
-00001a80: 756c 6c20 636f 6e74 726f 6c20 6f66 2063  ull control of c
-00001a90: 6f6c 756d 6e73 2073 706c 6974 7465 640d  olumns splitted.
-00001aa0: 0a20 2020 2020 2020 2069 7420 6973 2072  .        it is r
-00001ab0: 6563 6f6d 6d65 6e64 6564 2074 6f20 7072  ecommended to pr
-00001ac0: 6f76 6964 6564 2079 6f75 7220 6f77 6e20  ovided your own 
-00001ad0: 7061 7474 6572 6e20 746f 2061 766f 6964  pattern to avoid
-00001ae0: 2077 726f 6e67 2070 6172 7369 6e67 200d   wrong parsing .
-00001af0: 0a20 2020 2020 2020 2061 6e64 2063 616e  .        and can
-00001b00: 206c 6561 6420 746f 2061 6e20 6572 726f   lead to an erro
-00001b10: 722e 200d 0a20 2020 2020 2020 200d 0a20  r. ..        .. 
-00001b20: 2020 2073 7472 6174 6567 7920 3a20 7374     strategy : st
-00001b30: 722c 2064 6566 6175 6c74 3d27 6d65 616e  r, default='mean
-00001b40: 270d 0a20 2020 2020 2020 2054 6865 2069  '..        The i
-00001b50: 6d70 7574 6174 696f 6e20 7374 7261 7465  mputation strate
-00001b60: 6779 2e0d 0a0d 0a20 2020 2020 2020 202d  gy.....        -
-00001b70: 2049 6620 226d 6561 6e22 2c20 7468 656e   If "mean", then
-00001b80: 2072 6570 6c61 6365 206d 6973 7369 6e67   replace missing
-00001b90: 2076 616c 7565 7320 7573 696e 6720 7468   values using th
-00001ba0: 6520 6d65 616e 2061 6c6f 6e67 0d0a 2020  e mean along..  
-00001bb0: 2020 2020 2020 2020 6561 6368 2063 6f6c          each col
-00001bc0: 756d 6e2e 2043 616e 206f 6e6c 7920 6265  umn. Can only be
-00001bd0: 2075 7365 6420 7769 7468 206e 756d 6572   used with numer
-00001be0: 6963 2064 6174 612e 0d0a 2020 2020 2020  ic data...      
-00001bf0: 2020 2d20 4966 2022 6d65 6469 616e 222c    - If "median",
-00001c00: 2074 6865 6e20 7265 706c 6163 6520 6d69   then replace mi
-00001c10: 7373 696e 6720 7661 6c75 6573 2075 7369  ssing values usi
-00001c20: 6e67 2074 6865 206d 6564 6961 6e20 616c  ng the median al
-00001c30: 6f6e 670d 0a20 2020 2020 2020 2020 2065  ong..          e
-00001c40: 6163 6820 636f 6c75 6d6e 2e20 4361 6e20  ach column. Can 
-00001c50: 6f6e 6c79 2062 6520 7573 6564 2077 6974  only be used wit
-00001c60: 6820 6e75 6d65 7269 6320 6461 7461 2e0d  h numeric data..
-00001c70: 0a20 2020 2020 2020 202d 2049 6620 226d  .        - If "m
-00001c80: 6f73 745f 6672 6571 7565 6e74 222c 2074  ost_frequent", t
-00001c90: 6865 6e20 7265 706c 6163 6520 6d69 7373  hen replace miss
-00001ca0: 696e 6720 7573 696e 6720 7468 6520 6d6f  ing using the mo
-00001cb0: 7374 2066 7265 7175 656e 740d 0a20 2020  st frequent..   
-00001cc0: 2020 2020 2020 2076 616c 7565 2061 6c6f         value alo
-00001cd0: 6e67 2065 6163 6820 636f 6c75 6d6e 2e20  ng each column. 
-00001ce0: 4361 6e20 6265 2075 7365 6420 7769 7468  Can be used with
-00001cf0: 2073 7472 696e 6773 206f 7220 6e75 6d65   strings or nume
-00001d00: 7269 6320 6461 7461 2e0d 0a20 2020 2020  ric data...     
-00001d10: 2020 2020 2049 6620 7468 6572 6520 6973       If there is
-00001d20: 206d 6f72 6520 7468 616e 206f 6e65 2073   more than one s
-00001d30: 7563 6820 7661 6c75 652c 206f 6e6c 7920  uch value, only 
-00001d40: 7468 6520 736d 616c 6c65 7374 2069 7320  the smallest is 
-00001d50: 7265 7475 726e 6564 2e0d 0a20 2020 2020  returned...     
-00001d60: 2020 202d 2049 6620 2263 6f6e 7374 616e     - If "constan
-00001d70: 7422 2c20 7468 656e 2072 6570 6c61 6365  t", then replace
-00001d80: 206d 6973 7369 6e67 2076 616c 7565 7320   missing values 
-00001d90: 7769 7468 2066 696c 6c5f 7661 6c75 652e  with fill_value.
-00001da0: 2043 616e 2062 650d 0a20 2020 2020 2020   Can be..       
-00001db0: 2020 2075 7365 6420 7769 7468 2073 7472     used with str
-00001dc0: 696e 6773 206f 7220 6e75 6d65 7269 6320  ings or numeric 
-00001dd0: 6461 7461 2e0d 0a0d 0a20 2020 2066 696c  data.....    fil
-00001de0: 6c5f 7661 6c75 6520 3a20 7374 7220 6f72  l_value : str or
-00001df0: 206e 756d 6572 6963 616c 2076 616c 7565   numerical value
-00001e00: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-00001e10: 2020 2020 5768 656e 2073 7472 6174 6567      When strateg
-00001e20: 7920 3d3d 2022 636f 6e73 7461 6e74 222c  y == "constant",
-00001e30: 2066 696c 6c5f 7661 6c75 6520 6973 2075   fill_value is u
-00001e40: 7365 6420 746f 2072 6570 6c61 6365 2061  sed to replace a
-00001e50: 6c6c 0d0a 2020 2020 2020 2020 6f63 6375  ll..        occu
-00001e60: 7272 656e 6365 7320 6f66 206d 6973 7369  rrences of missi
-00001e70: 6e67 5f76 616c 7565 732e 0d0a 2020 2020  ng_values...    
-00001e80: 2020 2020 4966 206c 6566 7420 746f 2074      If left to t
-00001e90: 6865 2064 6566 6175 6c74 2c20 6669 6c6c  he default, fill
-00001ea0: 5f76 616c 7565 2077 696c 6c20 6265 2030  _value will be 0
-00001eb0: 2077 6865 6e20 696d 7075 7469 6e67 206e   when imputing n
-00001ec0: 756d 6572 6963 616c 0d0a 2020 2020 2020  umerical..      
-00001ed0: 2020 6461 7461 2061 6e64 2022 6d69 7373    data and "miss
-00001ee0: 696e 675f 7661 6c75 6522 2066 6f72 2073  ing_value" for s
-00001ef0: 7472 696e 6773 206f 7220 6f62 6a65 6374  trings or object
-00001f00: 2064 6174 6120 7479 7065 732e 2049 6620   data types. If 
-00001f10: 6e6f 7420 0d0a 2020 2020 2020 2020 6769  not ..        gi
-00001f20: 7665 6e20 616e 6420 6069 6d70 7574 655f  ven and `impute_
-00001f30: 6e61 6e60 2069 7320 6060 5472 7565 6060  nan` is ``True``
-00001f40: 2c20 7468 6520 6d65 616e 2073 7472 6174  , the mean strat
-00001f50: 6567 7920 6973 2075 7365 6420 696e 7374  egy is used inst
-00001f60: 6561 642e 0d0a 0d0a 2020 2020 706f 7369  ead.....    posi
-00001f70: 793a 2069 6e74 2c20 6f70 7469 6f6e 616c  y: int, optional
-00001f80: 200d 0a20 2020 2020 2020 2074 6865 2070   ..        the p
-00001f90: 6f73 6974 696f 6e20 746f 2070 6c61 6365  osition to place
-00001fa0: 2074 6865 2074 6172 6765 7420 706c 6f74   the target plot
-00001fb0: 2060 7960 202e 2042 7920 6465 6661 756c   `y` . By defaul
-00001fc0: 7420 7468 6520 7461 7267 6574 2070 6c6f  t the target plo
-00001fd0: 7420 0d0a 2020 2020 2020 2020 6966 2067  t ..        if g
-00001fe0: 6976 656e 2069 7320 6c6f 6361 7465 6420  iven is located 
-00001ff0: 6174 2074 6865 206c 6173 7420 706f 7369  at the last posi
-00002000: 7469 6f6e 2062 6568 696e 6420 7468 6520  tion behind the 
-00002010: 6c6f 6767 696e 6720 706c 6f74 732e 200d  logging plots. .
-00002020: 0a20 2020 200d 0a20 2020 2063 6f6c 6f72  .    ..    color
-00002030: 733a 2073 7472 2c20 6c69 7374 206f 6620  s: str, list of 
-00002040: 4d61 7470 6c6f 746c 6962 2e63 6f6c 6f72  Matplotlib.color
-00002050: 7320 6d61 702c 206f 7074 696f 6e61 6c20  s map, optional 
-00002060: 0d0a 2020 2020 2020 2020 5468 6520 636f  ..        The co
-00002070: 6c6f 7273 2066 6f72 2070 6c6f 7474 696e  lors for plottin
-00002080: 6720 6561 6368 2063 6f6c 756d 6e73 206f  g each columns o
-00002090: 6620 6058 6020 6578 6365 7074 2074 6865  f `X` except the
-000020a0: 2064 6570 7468 2e20 4966 206e 6f74 0d0a   depth. If not..
-000020b0: 2020 2020 2020 2020 6769 7665 6e2c 2064          given, d
-000020c0: 6566 6175 6c74 2063 6f6c 6f72 7320 6172  efault colors ar
-000020d0: 6520 6175 746f 2d67 656e 6572 6174 6564  e auto-generated
-000020e0: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-000020f0: 2020 2020 2049 6620 6063 6f6c 6f72 7360       If `colors`
-00002100: 2069 7320 7374 7269 6e67 2061 6e64 2027   is string and '
-00002110: 6373 3427 6f72 2027 786b 6364 2720 6973  cs4'or 'xkcd' is
-00002120: 2069 6e63 6c75 6465 642e 200d 0a20 2020   included. ..   
-00002130: 2020 2020 204d 6174 706c 6f74 6c69 622e       Matplotlib.
-00002140: 636f 6c6f 7273 2e43 5334 5f43 4f4c 4f52  colors.CS4_COLOR
-00002150: 5320 6f72 204d 6174 706c 6f74 6c69 622e  S or Matplotlib.
-00002160: 636f 6c6f 7273 2e58 4b43 445f 434f 4c4f  colors.XKCD_COLO
-00002170: 5253 200d 0a20 2020 2020 2020 2073 686f  RS ..        sho
-00002180: 756c 6420 6265 2075 7365 6420 696e 7374  uld be used inst
-00002190: 6561 642e 2049 6e20 6164 6469 7469 6f6e  ead. In addition
-000021a0: 2069 6620 7468 6520 6027 6373 3427 6020   if the `'cs4'` 
-000021b0: 6f72 2060 2778 6b63 6427 6020 6973 2020  or `'xkcd'` is  
-000021c0: 0d0a 2020 2020 2020 2020 7375 6666 6978  ..        suffix
-000021d0: 6564 2062 7920 636f 6c6f 6e73 2061 6e64  ed by colons and
-000021e0: 2069 6e74 6567 6572 2076 616c 7565 206c   integer value l
-000021f0: 696b 6520 6060 6373 343a 3460 6020 6f72  ike ``cs4:4`` or
-00002200: 2060 6078 6b63 643a 3460 602c 2074 6865   ``xkcd:4``, the
-00002210: 200d 0a20 2020 2020 2020 2043 5334 206f   ..        CS4 o
-00002220: 7220 584b 4344 2063 6f6c 6f72 7320 7368  r XKCD colors sh
-00002230: 6f75 6c64 2062 6520 7573 6564 2066 726f  ould be used fro
-00002240: 6d20 696e 6465 7820 6571 7561 6c73 2074  m index equals t
-00002250: 6f20 6060 3460 602e 200d 0a20 2020 2020  o ``4``. ..     
-00002260: 2020 200d 0a20 2020 2020 2020 202e 2e20     ..        .. 
-00002270: 7665 7273 696f 6e61 6464 6564 3a3a 2030  versionadded:: 0
-00002280: 2e32 2e33 200d 0a20 2020 2020 2020 2020  .2.3 ..         
-00002290: 2020 4d61 7470 6c6f 746c 6962 2e63 6f6c    Matplotlib.col
-000022a0: 6f72 732e 4353 345f 434f 4c4f 5253 206f  ors.CS4_COLORS o
-000022b0: 7220 4d61 7470 6c6f 746c 6962 2e63 6f6c  r Matplotlib.col
-000022c0: 6f72 732e 584b 4344 5f43 4f4c 4f52 5320  ors.XKCD_COLORS 
-000022d0: 6361 6e20 0d0a 2020 2020 2020 2020 2020  can ..          
-000022e0: 2062 6520 7573 6564 2062 7920 7365 7474   be used by sett
-000022f0: 696e 6720 6063 6f6c 6f72 7360 2074 6f20  ing `colors` to 
-00002300: 6060 2763 7334 2760 6020 6f72 2060 6027  ``'cs4'`` or ``'
-00002310: 786b 6364 2760 602e 2054 6f20 7265 7072  xkcd'``. To repr
-00002320: 6f64 7563 6520 0d0a 2020 2020 2020 2020  oduce ..        
-00002330: 2020 2074 6865 2073 616d 6520 4353 3420     the same CS4 
-00002340: 6f72 2058 4b43 4420 636f 6c6f 7273 2c20  or XKCD colors, 
-00002350: 7365 7420 7468 6520 6073 6565 6460 2070  set the `seed` p
-00002360: 6172 616d 6574 6572 2074 6f20 6120 0d0a  arameter to a ..
-00002370: 2020 2020 2020 2020 2020 2073 7065 6369             speci
-00002380: 6669 6320 7661 6c75 652e 200d 0a20 2020  fic value. ..   
-00002390: 2020 2020 200d 0a20 2020 2064 7261 775f       ..    draw_
-000023a0: 7370 696e 6573 3a20 626f 6f6c 2c20 7475  spines: bool, tu
-000023b0: 706c 6520 282d 6c69 6d2c 202b 6c69 6d29  ple (-lim, +lim)
-000023c0: 2c20 6465 6661 756c 743d 2046 616c 7365  , default= False
-000023d0: 2c20 0d0a 2020 2020 2020 2020 4f6e 6c79  , ..        Only
-000023e0: 2064 7261 7720 7370 696e 6520 6265 7477   draw spine betw
-000023f0: 6565 6e20 7468 6520 792d 7469 636b 732e  een the y-ticks.
-00002400: 2060 602d 6c69 6d60 6020 616e 6420 6060   ``-lim`` and ``
-00002410: 2b6c 696d 6060 2061 7265 206c 6f77 6572  +lim`` are lower
-00002420: 200d 0a20 2020 2020 2020 2061 6e64 2075   ..        and u
-00002430: 7070 6572 2062 6f75 6e64 2069 2e65 2e20  pper bound i.e. 
-00002440: 6120 7261 6e67 6520 746f 2064 7261 7720  a range to draw 
-00002450: 7468 6520 7370 696e 6573 2069 6e20 792d  the spines in y-
-00002460: 6178 6973 2e20 0d0a 2020 2020 2020 2020  axis. ..        
-00002470: 0d0a 2020 2020 6669 675f 7369 7a65 203a  ..    fig_size :
-00002480: 2074 7570 6c65 2028 7769 6474 682c 2068   tuple (width, h
-00002490: 6569 6768 7429 2c20 6465 6661 756c 7420  eight), default 
-000024a0: 3d28 382c 2036 290d 0a20 2020 2020 2020  =(8, 6)..       
-000024b0: 2074 6865 206d 6174 706c 6f74 6c69 6220   the matplotlib 
-000024c0: 6669 6775 7265 2073 697a 6520 6769 7665  figure size give
-000024d0: 6e20 6173 2061 2074 7570 6c65 206f 6620  n as a tuple of 
-000024e0: 7769 6474 6820 616e 6420 6865 6967 6874  width and height
-000024f0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00002500: 6669 675f 6470 693a 2066 6c6f 6174 206f  fig_dpi: float o
-00002510: 7220 2766 6967 7572 6527 2c20 6465 6661  r 'figure', defa
-00002520: 756c 743a 2072 6350 6172 616d 735b 2273  ult: rcParams["s
-00002530: 6176 6566 6967 2e64 7069 225d 205c 0d0a  avefig.dpi"] \..
-00002540: 2020 2020 2020 2020 2864 6566 6175 6c74          (default
-00002550: 3a20 2766 6967 7572 6527 290d 0a20 2020  : 'figure')..   
-00002560: 2020 2020 2054 6865 2072 6573 6f6c 7574       The resolut
-00002570: 696f 6e20 696e 2064 6f74 7320 7065 7220  ion in dots per 
-00002580: 696e 6368 2e20 4966 2027 6669 6775 7265  inch. If 'figure
-00002590: 272c 2075 7365 2074 6865 2066 6967 7572  ', use the figur
-000025a0: 6527 7320 6470 6920 7661 6c75 652e 0d0a  e's dpi value...
-000025b0: 2020 2020 2020 2020 0d0a 2020 2020 7361          ..    sa
-000025c0: 7665 6669 673a 2073 7472 2c20 6465 6661  vefig: str, defa
-000025d0: 756c 7420 3d4e 6f6e 6520 2c20 0d0a 2020  ult =None , ..  
-000025e0: 2020 2020 2020 7468 6520 7061 7468 2074        the path t
-000025f0: 6f20 7361 7665 2074 6865 2066 6967 7572  o save the figur
-00002600: 652e 2041 7267 756d 656e 7420 6973 2070  e. Argument is p
-00002610: 6173 7365 6420 746f 200d 0a20 2020 2020  assed to ..     
-00002620: 2020 203a 636c 6173 733a 606d 6174 706c     :class:`matpl
-00002630: 6f74 6c69 622e 4669 6775 7265 6020 636c  otlib.Figure` cl
-00002640: 6173 732e 200d 0a0d 0a20 2020 2073 6e73  ass. ....    sns
-00002650: 5f73 7479 6c65 3a20 7374 722c 206f 7074  _style: str, opt
-00002660: 696f 6e61 6c2c 200d 0a20 2020 2020 2020  ional, ..       
-00002670: 2074 6865 2073 6561 626f 726e 2073 7479   the seaborn sty
-00002680: 6c65 2e0d 0a20 2020 2020 2020 200d 0a20  le...        .. 
-00002690: 2020 2073 6565 643a 2069 6e74 2c20 6f70     seed: int, op
-000026a0: 7469 6f6e 616c 200d 0a20 2020 2020 2020  tional ..       
-000026b0: 416c 6c6f 7720 746f 2072 6570 726f 6475  Allow to reprodu
-000026c0: 6365 2074 6865 204d 6174 706c 6f74 6c69  ce the Matplotli
-000026d0: 622e 636f 6c6f 7273 2e43 5334 5f43 4f4c  b.colors.CS4_COL
-000026e0: 4f52 5320 6966 2060 636f 6c6f 7273 6020  ORS if `colors` 
-000026f0: 6973 200d 0a20 2020 2020 2020 7365 7420  is ..       set 
-00002700: 746f 2060 6063 7334 6060 2e20 0d0a 2020  to ``cs4``. ..  
-00002710: 2020 2020 200d 0a20 2020 2020 2020 2e2e       ..       ..
-00002720: 2076 6572 7369 6f6e 6164 6465 643a 3a20   versionadded:: 
-00002730: 302e 322e 3320 0d0a 2020 2020 2020 200d  0.2.3 ..       .
-00002740: 0a20 2020 2076 6572 626f 7365 3a20 696e  .    verbose: in
-00002750: 742c 2064 6566 6175 6c74 3d30 200d 0a20  t, default=0 .. 
-00002760: 2020 2020 2020 204f 7574 7075 7420 7468         Output th
-00002770: 6520 6e75 6d62 6572 206f 6620 6361 7465  e number of cate
-00002780: 676f 7269 616c 2066 6561 7475 7265 7320  gorial features 
-00002790: 6472 6f70 7065 6420 696e 2074 6865 2064  dropped in the d
-000027a0: 6174 6166 7261 6d65 2e20 200d 0a20 2020  ataframe.  ..   
-000027b0: 2020 2020 200d 0a20 2020 206b 7773 3a20       ..    kws: 
-000027c0: 6469 6374 2c20 0d0a 2020 2020 2020 2020  dict, ..        
-000027d0: 4164 6469 7469 6f6e 616c 206b 6579 776f  Additional keywo
-000027e0: 7264 2061 7267 756d 656e 7473 2070 6173  rd arguments pas
-000027f0: 7365 6420 746f 203a 6675 6e63 3a60 6d61  sed to :func:`ma
-00002800: 7470 6c6f 746c 6962 2e61 7865 732e 706c  tplotlib.axes.pl
-00002810: 6f74 600d 0a20 2020 2020 2020 200d 0a20  ot`..        .. 
-00002820: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
-00002830: 202d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020   ---------..    
-00002840: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e64  >>> from watex.d
-00002850: 6174 6173 6574 7320 696d 706f 7274 206c  atasets import l
-00002860: 6f61 645f 686c 6f67 7320 0d0a 2020 2020  oad_hlogs ..    
-00002870: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e75  >>> from watex.u
-00002880: 7469 6c73 2e70 6c6f 7475 7469 6c73 2069  tils.plotutils i
-00002890: 6d70 6f72 7420 706c 6f74 5f6c 6f67 6769  mport plot_loggi
-000028a0: 6e67 0d0a 2020 2020 3e3e 3e20 5830 2c20  ng..    >>> X0, 
-000028b0: 7920 3d20 6c6f 6164 5f68 6c6f 6773 2028  y = load_hlogs (
-000028c0: 6173 5f66 7261 6d65 203d 5472 7565 2920  as_frame =True) 
-000028d0: 2320 6765 7420 7468 6520 6672 616d 6573  # get the frames
-000028e0: 2072 6174 6865 7220 7468 616e 206f 626a   rather than obj
-000028f0: 6563 7420 0d0a 2020 2020 3e3e 3e20 2320  ect ..    >>> # 
-00002900: 706c 6f74 2074 6865 2064 6566 6175 6c74  plot the default
-00002910: 206c 6f67 6769 6e67 2077 6974 6820 4e6f   logging with No
-00002920: 726d 616c 697a 6520 3d54 7275 6520 0d0a  rmalize =True ..
-00002930: 2020 2020 3e3e 3e20 706c 6f74 5f6c 6f67      >>> plot_log
-00002940: 6769 6e67 2028 5830 2c20 6e6f 726d 616c  ging (X0, normal
-00002950: 697a 6520 3d54 7275 6529 200d 0a20 2020  ize =True) ..   
-00002960: 203e 3e3e 2023 2049 6e63 6c75 6465 2074   >>> # Include t
-00002970: 6865 2074 6172 6765 7420 696e 2074 6865  he target in the
-00002980: 2070 6c6f 7420 0d0a 2020 2020 3e3e 3e20   plot ..    >>> 
-00002990: 706c 6f74 5f6c 6f67 6769 6e67 2028 2058  plot_logging ( X
-000029a0: 302c 2020 7920 3d20 792e 6b70 202c 2070  0,  y = y.kp , p
-000029b0: 6f73 6979 203d 2030 2c20 0d0a 2020 2020  osiy = 0, ..    
-000029c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000029d0: 2020 636f 6c75 6d6e 735f 746f 5f73 6b69    columns_to_ski
-000029e0: 703d 5b27 7468 6963 6b6e 6573 7327 2c20  p=['thickness', 
-000029f0: 2773 7027 5d2c 200d 0a20 2020 2020 2020  'sp'], ..       
-00002a00: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00002a10: 6f67 3130 203d 5472 7565 2c20 0d0a 2020  og10 =True, ..  
-00002a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a30: 2020 2020 290d 0a20 2020 203e 3e3e 2023      )..    >>> #
-00002a40: 2064 7261 7720 7370 696e 6573 2061 6e64   draw spines and
-00002a50: 206c 696d 6974 2070 6c6f 7420 6672 6f6d   limit plot from
-00002a60: 2028 302c 2037 3030 2920 6d20 6465 7074   (0, 700) m dept
-00002a70: 6820 0d0a 2020 2020 3e3e 3e20 706c 6f74  h ..    >>> plot
-00002a80: 5f6c 6f67 6769 6e67 2028 5830 202c 2079  _logging (X0 , y
-00002a90: 3d20 792e 6b70 2c20 6472 6177 5f73 7069  = y.kp, draw_spi
-00002aa0: 6e65 7320 3d28 302c 2037 3030 2920 290d  nes =(0, 700) ).
-00002ab0: 0a20 2020 2022 2222 0d0a 2020 2020 0d0a  .    """..    ..
-00002ac0: 2020 2020 5820 3d20 5f61 7373 6572 745f      X = _assert_
-00002ad0: 616c 6c5f 7479 7065 7328 582c 2070 642e  all_types(X, pd.
-00002ae0: 4461 7461 4672 616d 652c 2070 642e 5365  DataFrame, pd.Se
-00002af0: 7269 6573 202c 206e 702e 6e64 6172 7261  ries , np.ndarra
-00002b00: 7920 2920 0d0a 2020 2020 583d 2063 6865  y ) ..    X= che
-00002b10: 636b 5f61 7272 6179 2028 0d0a 2020 2020  ck_array (..    
-00002b20: 2020 2020 582c 200d 0a20 2020 2020 2020      X, ..       
-00002b30: 2064 7479 7065 203d 6f62 6a65 6374 2c20   dtype =object, 
-00002b40: 0d0a 2020 2020 2020 2020 666f 7263 655f  ..        force_
-00002b50: 616c 6c5f 6669 6e69 7465 3d22 616c 6c6f  all_finite="allo
-00002b60: 772d 6e61 6e22 2c20 0d0a 2020 2020 2020  w-nan", ..      
-00002b70: 2020 696e 7075 745f 6e61 6d65 203d 224c    input_name ="L
-00002b80: 6f67 6769 6e67 2064 6174 6173 6574 222c  ogging dataset",
-00002b90: 0d0a 2020 2020 2020 2020 746f 5f66 7261  ..        to_fra
-00002ba0: 6d65 203d 5472 7565 2020 0d0a 2020 2020  me =True  ..    
-00002bb0: 2020 2020 290d 0a20 2020 2023 2044 6973      )..    # Dis
-00002bc0: 6361 7264 2061 6c6c 2063 6174 6567 6f72  card all categor
-00002bd0: 6963 616c 2076 616c 7565 7320 616e 6420  ical values and 
-00002be0: 0d0a 2020 2020 2320 6b65 6570 206f 6e6c  ..    # keep onl
-00002bf0: 7920 7468 6520 6e75 6d65 7269 6361 6c20  y the numerical 
-00002c00: 6665 6174 7572 6573 2e0d 0a20 2020 2058  features...    X
-00002c10: 203d 2074 6f5f 6e75 6d65 7269 635f 6474   = to_numeric_dt
-00002c20: 7970 6573 2858 2c20 706f 705f 6361 745f  ypes(X, pop_cat_
-00002c30: 6665 6174 7572 6573 3d54 7275 652c 2076  features=True, v
-00002c40: 6572 626f 7365 203d 2076 6572 626f 7365  erbose = verbose
-00002c50: 2029 200d 0a20 2020 200d 0a20 2020 2069   ) ..    ..    i
-00002c60: 6620 7920 6973 206e 6f74 204e 6f6e 653a  f y is not None:
-00002c70: 200d 0a20 2020 2020 2020 6966 2069 7369   ..       if isi
-00002c80: 6e73 7461 6e63 6520 2879 2c20 286c 6973  nstance (y, (lis
-00002c90: 742c 2074 7570 6c65 2929 3a20 0d0a 2020  t, tuple)): ..  
-00002ca0: 2020 2020 2020 2020 2023 2069 6e20 7468           # in th
-00002cb0: 6520 6361 7365 2061 206c 7374 2069 7320  e case a lst is 
-00002cc0: 6769 7665 6e20 0d0a 2020 2020 2020 2020  given ..        
-00002cd0: 2020 2079 203d 206e 702e 6172 7261 7920     y = np.array 
-00002ce0: 2879 2920 0d0a 2020 2020 2020 2069 6620  (y) ..       if 
-00002cf0: 6e6f 7420 6973 5f69 7465 7261 626c 6520  not is_iterable 
-00002d00: 2879 293a 200d 0a20 2020 2020 2020 2020  (y): ..         
-00002d10: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00002d20: 7220 2822 7920 6578 7065 6374 7320 616e  r ("y expects an
-00002d30: 2069 7465 7261 626c 6520 6f62 6a65 6374   iterable object
-00002d40: 2e22 0d0a 2020 2020 2020 2020 2020 2020  ."..            
-00002d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002d60: 2020 6622 2067 6f74 207b 7479 7065 2879    f" got {type(y
-00002d70: 292e 5f5f 6e61 6d65 5f5f 2172 7d22 290d  ).__name__!r}").
-00002d80: 0a20 2020 2020 2020 7920 3d20 5f61 7373  .       y = _ass
-00002d90: 6572 745f 616c 6c5f 7479 7065 7328 792c  ert_all_types(y,
-00002da0: 2070 642e 5365 7269 6573 2c20 7064 2e44   pd.Series, pd.D
-00002db0: 6174 6146 7261 6d65 2c20 6e70 2e6e 6461  ataFrame, np.nda
-00002dc0: 7272 6179 290d 0a20 2020 2020 2020 0d0a  rray)..       ..
-00002dd0: 2020 2020 2020 2079 3d63 6865 636b 5f79         y=check_y
-00002de0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-00002df0: 792c 200d 0a20 2020 2020 2020 2020 2020  y, ..           
-00002e00: 2074 6f5f 6672 616d 6520 3d54 7275 652c   to_frame =True,
-00002e10: 200d 0a20 2020 2020 2020 2020 2020 2061   ..            a
-00002e20: 6c6c 6f77 5f6e 616e 3d20 5472 7565 2c0d  llow_nan= True,.
-00002e30: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
-00002e40: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00002e50: 6966 206c 656e 2879 2920 213d 6c65 6e28  if len(y) !=len(
-00002e60: 5829 3a20 0d0a 2020 2020 2020 2020 2020  X): ..          
-00002e70: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00002e80: 7220 2822 7920 616e 6420 5820 7369 7a65  r ("y and X size
-00002e90: 7320 616c 6f6e 6720 6178 6973 2030 206d  s along axis 0 m
-00002ea0: 7573 7420 6265 2063 6f6e 7369 7374 656e  ust be consisten
-00002eb0: 743b 220d 0a20 2020 2020 2020 2020 2020  t;"..           
-00002ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002ed0: 2020 6622 207b 6c65 6e28 7929 7d20 616e    f" {len(y)} an
-00002ee0: 6420 7b6c 656e 2858 297d 2061 7265 2067  d {len(X)} are g
-00002ef0: 6976 656e 2e22 290d 0a20 2020 2023 2072  iven.")..    # r
-00002f00: 6574 7572 6e20 5820 616e 6420 6465 7074  eturn X and dept
-00002f10: 6820 0d0a 2020 2020 582c 2064 6570 7468  h ..    X, depth
-00002f20: 203d 2069 735f 6465 7074 685f 696e 2858   = is_depth_in(X
-00002f30: 2c20 7a6e 616d 6520 6f72 2027 6465 7074  , zname or 'dept
-00002f40: 6827 2c20 636f 6c75 6d6e 7320 3d20 6c61  h', columns = la
-00002f50: 6265 6c73 200d 0a20 2020 2020 2020 2020  bels ..         
-00002f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002f70: 2020 2029 0d0a 2020 2020 2320 6665 7463     )..    # fetc
-00002f80: 6820 7461 7267 6574 2069 6620 6973 2067  h target if is g
-00002f90: 6976 656e 2020 0d0a 2020 2020 582c 2079  iven  ..    X, y
-00002fa0: 2020 203d 205f 6973 5f74 6172 6765 745f     = _is_target_
-00002fb0: 696e 2858 2c20 7920 3d20 7920 2c20 746e  in(X, y = y , tn
-00002fc0: 616d 6520 3d20 746e 616d 6520 290d 0a20  ame = tname ).. 
-00002fd0: 2020 200d 0a20 2020 2023 2073 6b69 7020     ..    # skip 
-00002fe0: 6c6f 6731 3020 636f 6c75 6d6e 7320 6966  log10 columns if
-00002ff0: 206c 6f67 2031 3020 6973 2073 6574 2074   log 10 is set t
-00003000: 6f20 5472 7565 200d 0a20 2020 2069 6620  o True ..    if 
-00003010: 6c6f 6731 303a 200d 0a20 2020 2020 2020  log10: ..       
-00003020: 2058 203d 205f 736b 6970 5f6c 6f67 3130   X = _skip_log10
-00003030: 5f63 6f6c 756d 6e73 2028 582c 2063 6f6c  _columns (X, col
-00003040: 756d 6e32 736b 6970 203d 2063 6f6c 756d  umn2skip = colum
-00003050: 6e73 5f74 6f5f 736b 6970 202c 200d 0a20  ns_to_skip , .. 
-00003060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003080: 2070 6174 7465 726e 3d20 7061 7474 6572   pattern= patter
-00003090: 6e2c 2069 6e70 6c61 6365 203d 4661 6c73  n, inplace =Fals
-000030a0: 6529 200d 0a20 2020 2023 2069 6620 6e6f  e) ..    # if no
-000030b0: 726d 616c 697a 6520 7468 656e 2020 0d0a  rmalize then  ..
-000030c0: 2020 2020 6966 206e 6f72 6d61 6c69 7a65      if normalize
-000030d0: 3a0d 0a20 2020 2020 2020 206d 7363 203d  :..        msc =
-000030e0: 204d 696e 4d61 7853 6361 6c65 7228 290d   MinMaxScaler().
-000030f0: 0a20 2020 2020 2020 2058 7363 203d 206d  .        Xsc = m
-00003100: 7363 2e66 6974 5f74 7261 6e73 666f 726d  sc.fit_transform
-00003110: 2028 5829 0d0a 2020 2020 2020 2020 2320   (X)..        # 
-00003120: 7365 7420 6120 6e65 7720 6461 7461 6672  set a new datafr
-00003130: 616d 6520 7769 7468 2066 6561 7475 7265  ame with feature
-00003140: 730d 0a20 2020 2020 2020 2069 6620 6861  s..        if ha
-00003150: 7361 7474 7220 286d 7363 202c 2027 6665  sattr (msc , 'fe
-00003160: 6174 7572 655f 6e61 6d65 735f 696e 5f27  ature_names_in_'
-00003170: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
-00003180: 2058 203d 2070 642e 4461 7461 4672 616d   X = pd.DataFram
-00003190: 6520 2858 7363 202c 2063 6f6c 756d 6e73  e (Xsc , columns
-000031a0: 203d 206c 6973 7428 6d73 632e 6665 6174   = list(msc.feat
-000031b0: 7572 655f 6e61 6d65 735f 696e 5f20 290d  ure_names_in_ ).
-000031c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000031d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000031e0: 2029 0d0a 2020 2020 2020 2020 656c 7365   )..        else
-000031f0: 203a 2058 203d 2070 642e 4461 7461 4672   : X = pd.DataFr
-00003200: 616d 6528 5873 632c 2063 6f6c 756d 6e73  ame(Xsc, columns
-00003210: 203d 6c69 7374 2858 2e63 6f6c 756d 6e73   =list(X.columns
-00003220: 2029 2920 0d0a 2020 2020 2020 2020 2320   )) ..        # 
-00003230: 7365 7420 7468 6520 7820 6178 6973 2061  set the x axis a
-00003240: 6e64 2064 656c 6574 6520 7468 6520 6e6f  nd delete the no
-00003250: 726d 616c 697a 6520 6672 6f6d 2058 200d  rmalize from X .
-00003260: 0a20 2020 2020 2020 2023 2061 7420 696e  .        # at in
-00003270: 6465 7820 3020 7375 7070 6f73 6564 2074  dex 0 supposed t
-00003280: 6f20 6265 2074 6865 2078 2061 7869 7320  o be the x axis 
-00003290: 0d0a 2020 2020 2020 2020 2320 5873 632e  ..        # Xsc.
-000032a0: 696c 6f63 205b 3a2c 2030 205d 203d 2078  iloc [:, 0 ] = x
-000032b0: 5f73 6572 200d 0a20 2020 2020 2020 2023  _ser ..        #
-000032c0: 2058 3d20 5873 632e 636f 7079 2829 2020   X= Xsc.copy()  
-000032d0: 0d0a 2020 2020 2320 696d 7075 7465 5f6e  ..    # impute_n
-000032e0: 616e 200d 0a20 2020 2069 6620 696d 7075  an ..    if impu
-000032f0: 7465 5f6e 616e 3a20 0d0a 2020 2020 2020  te_nan: ..      
-00003300: 2020 2320 6368 6563 6b20 7768 6574 6865    # check whethe
-00003310: 7220 7468 6572 6520 6973 2061 204e 616e  r there is a Nan
-00003320: 2076 616c 7565 2020 696e 2074 6865 2064   value  in the d
-00003330: 6174 6120 0d0a 2020 2020 2020 2020 2320  ata ..        # 
-00003340: 696d 7075 7465 2064 6174 6120 7573 696e  impute data usin
-00003350: 6720 6d65 616e 2076 616c 7565 730d 0a20  g mean values.. 
-00003360: 2020 2020 2020 2069 6620 582e 6973 6e75         if X.isnu
-00003370: 6c6c 2829 2e76 616c 7565 732e 616e 7928  ll().values.any(
-00003380: 293a 200d 0a20 2020 2020 2020 2020 2020  ): ..           
-00003390: 2058 693d 2053 696d 706c 6549 6d70 7574   Xi= SimpleImput
-000033a0: 6572 2873 7472 6174 6567 793d 2073 7472  er(strategy= str
-000033b0: 6174 6567 7920 6966 206e 6f74 2066 696c  ategy if not fil
-000033c0: 6c5f 7661 6c75 6520 656c 7365 204e 6f6e  l_value else Non
-000033d0: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
-000033e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000033f0: 2020 6669 6c6c 5f76 616c 7565 3d20 6669    fill_value= fi
-00003400: 6c6c 5f76 616c 7565 0d0a 2020 2020 2020  ll_value..      
-00003410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003420: 2020 2020 2020 2029 2e66 6974 5f74 7261         ).fit_tra
-00003430: 6e73 666f 726d 2858 290d 0a20 2020 2020  nsform(X)..     
-00003440: 2020 2020 2020 2058 203d 2070 642e 4461         X = pd.Da
-00003450: 7461 4672 616d 6528 5869 2c20 636f 6c75  taFrame(Xi, colu
-00003460: 6d6e 733d 2058 2e63 6f6c 756d 6e73 290d  mns= X.columns).
-00003470: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00003480: 2020 2023 2074 6f67 676c 6520 7920 0d0a     # toggle y ..
-00003490: 2020 2020 6966 2079 2069 7320 6e6f 7420      if y is not 
-000034a0: 4e6f 6e65 3a20 0d0a 2020 2020 2020 2020  None: ..        
-000034b0: 5820 3d20 5f74 6f67 676c 655f 7461 7267  X = _toggle_targ
-000034c0: 6574 5f69 6e28 582c 2079 2c20 706f 7320  et_in(X, y, pos 
-000034d0: 3d20 706f 7369 7929 0d0a 2020 2020 2020  = posiy)..      
-000034e0: 2020 0d0a 2020 2020 236d 616e 6167 6520    ..    #manage 
-000034f0: 636f 6c6f 7273 2061 6c6f 6e67 2063 6f6c  colors along col
-00003500: 6f72 7320 0d0a 2020 2020 636f 6c6f 7273  ors ..    colors
-00003510: 203d 206d 616b 655f 706c 6f74 5f63 6f6c   = make_plot_col
-00003520: 6f72 7320 280d 0a20 2020 2020 2020 2058  ors (..        X
-00003530: 2c20 636f 6c6f 7273 203d 2063 6f6c 6f72  , colors = color
-00003540: 7320 2c20 6178 6973 203d 2031 2c20 7365  s , axis = 1, se
-00003550: 6564 203d 2073 6565 6420 2c20 6368 756e  ed = seed , chun
-00003560: 6b3d 4661 6c73 6520 290d 0a0d 0a20 2020  k=False )....   
-00003570: 2066 6967 2c20 6178 203d 2070 6c74 2e73   fig, ax = plt.s
-00003580: 7562 706c 6f74 7320 2831 2c20 6e63 6f6c  ubplots (1, ncol
-00003590: 7320 3d20 582e 7368 6170 6520 5b31 5d2c  s = X.shape [1],
-000035a0: 2073 6861 7265 7920 3d20 5472 7565 202c   sharey = True ,
-000035b0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000035c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000035d0: 6967 7369 7a65 203d 2066 6967 5f73 697a  igsize = fig_siz
-000035e0: 6520 290d 0a20 2020 200d 0a20 2020 2023  e )..    ..    #
-000035f0: 2063 7573 746f 6d69 7a65 2062 6f75 6e64   customize bound
-00003600: 2061 6e64 2073 6574 2073 7069 6e65 7320   and set spines 
-00003610: 0d0a 2020 2020 666f 7220 6b20 696e 2072  ..    for k in r
-00003620: 616e 6765 2028 582e 7368 6170 6520 5b31  ange (X.shape [1
-00003630: 5d29 3a20 0d0a 2020 2020 200d 0a20 2020  ]): ..     ..   
-00003640: 2020 2020 2061 785b 6b5d 2e70 6c6f 7420       ax[k].plot 
-00003650: 2820 582e 696c 6f63 5b3a 2c20 6b5d 2c20  ( X.iloc[:, k], 
-00003660: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00003670: 2020 2020 2020 6465 7074 682c 200d 0a20        depth, .. 
-00003680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003690: 2020 2063 6f6c 6f72 203d 2063 6f6c 6f72     color = color
-000036a0: 735b 6b5d 2c20 0d0a 2020 2020 2020 2020  s[k], ..        
-000036b0: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
-000036c0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-000036d0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-000036e0: 2020 6178 5b6b 5d2e 7469 636b 5f70 6172    ax[k].tick_par
-000036f0: 616d 7328 746f 703d 5472 7565 2c20 0d0a  ams(top=True, ..
-00003700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003710: 2020 2020 2020 2020 2020 6c61 6265 6c74            labelt
-00003720: 6f70 3d54 7275 652c 200d 0a20 2020 2020  op=True, ..     
-00003730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003740: 2020 2020 2062 6f74 746f 6d3d 4661 6c73       bottom=Fals
-00003750: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
-00003760: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00003770: 6162 656c 626f 7474 6f6d 3d46 616c 7365  abelbottom=False
-00003780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00003790: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-000037a0: 2020 2020 6178 5b6b 5d2e 7365 745f 7469      ax[k].set_ti
-000037b0: 746c 6520 2858 2e63 6f6c 756d 6e73 205b  tle (X.columns [
-000037c0: 6b5d 290d 0a20 2020 2020 2020 2061 785b  k])..        ax[
-000037d0: 6b5d 2e73 7069 6e65 735b 2772 6967 6874  k].spines['right
-000037e0: 275d 2e73 6574 5f76 6973 6962 6c65 2846  '].set_visible(F
-000037f0: 616c 7365 290d 0a20 2020 2020 2020 2061  alse)..        a
-00003800: 785b 6b5d 2e73 7069 6e65 735b 2762 6f74  x[k].spines['bot
-00003810: 746f 6d27 5d2e 7365 745f 7669 7369 626c  tom'].set_visibl
-00003820: 6528 4661 6c73 6529 0d0a 2020 2020 2020  e(False)..      
-00003830: 2020 2320 6f6e 6c79 2073 686f 7720 7469    # only show ti
-00003840: 636b 206f 6e20 7468 6520 746f 7020 616e  ck on the top an
-00003850: 6420 6c65 6674 200d 0a20 2020 2020 2020  d left ..       
-00003860: 2061 785b 6b5d 2e78 6178 6973 2e73 6574   ax[k].xaxis.set
-00003870: 5f74 6963 6b73 5f70 6f73 6974 696f 6e28  _ticks_position(
-00003880: 2774 6f70 2729 0d0a 2020 2020 2020 2020  'top')..        
-00003890: 6966 2079 2069 7320 6e6f 7420 4e6f 6e65  if y is not None
-000038a0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-000038b0: 2320 6d61 6b65 2058 2061 7869 7320 6f66  # make X axis of
-000038c0: 2074 6865 2074 6172 6765 7420 746f 2072   the target to r
-000038d0: 6564 200d 0a20 2020 2020 2020 2020 2020  ed ..           
-000038e0: 2023 2066 6f72 2064 6966 6665 7265 6e63   # for differenc
-000038f0: 6961 7469 6f6e 2066 726f 6d20 6665 6174  iation from feat
-00003900: 7572 6573 2e20 0d0a 2020 2020 2020 2020  ures. ..        
-00003910: 2020 2020 6966 2058 2e63 6f6c 756d 6e73      if X.columns
-00003920: 205b 6b5d 203d 3d79 2e6e 616d 653a 200d   [k] ==y.name: .
-00003930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003940: 2061 785b 6b5d 2e73 7069 6e65 735b 2774   ax[k].spines['t
-00003950: 6f70 275d 2e73 6574 5f63 6f6c 6f72 2827  op'].set_color('
-00003960: 7265 6427 2920 200d 0a20 2020 2020 2020  red')  ..       
-00003970: 2020 0d0a 2020 2020 2020 2020 6966 2064    ..        if d
-00003980: 7261 775f 7370 696e 6573 3a20 0d0a 2020  raw_spines: ..  
-00003990: 2020 2020 2020 2020 2020 2320 4f6e 6c79            # Only
-000039a0: 2064 7261 7720 7370 696e 6520 6265 7477   draw spine betw
-000039b0: 6565 6e20 7468 6520 792d 7469 636b 730d  een the y-ticks.
-000039c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000039d0: 6973 5f69 7465 7261 626c 6528 6472 6177  is_iterable(draw
-000039e0: 5f73 7069 6e65 7329 3a20 0d0a 2020 2020  _spines): ..    
-000039f0: 2020 2020 2020 2020 2020 2020 2320 666f              # fo
-00003a00: 7220 636f 6e73 6973 7465 6e63 7920 6368  r consistency ch
-00003a10: 6563 6b20 7768 6574 6865 7220 7661 6c75  eck whether valu
-00003a20: 6573 200d 0a20 2020 2020 2020 2020 2020  es ..           
-00003a30: 2020 2020 2023 2061 7265 206e 756d 6572       # are numer
-00003a40: 6963 0d0a 2020 2020 2020 2020 2020 2020  ic..            
-00003a50: 2020 2020 6472 6177 5f73 7069 6e65 7320      draw_spines 
-00003a60: 3d20 736f 7274 6564 2028 0d0a 2020 2020  = sorted (..    
-00003a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003a80: 6c69 7374 286d 6170 2028 6c61 6d62 6461  list(map (lambda
-00003a90: 2078 3a20 666c 6f61 7420 2878 2920 2c20   x: float (x) , 
-00003aa0: 6472 6177 5f73 7069 6e65 735b 3a32 5d29  draw_spines[:2])
-00003ab0: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
-00003ac0: 2020 2020 2020 2020 2920 0d0a 2020 2020          ) ..    
-00003ad0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00003ae0: 656e 2864 7261 775f 7370 696e 6573 2920  en(draw_spines) 
-00003af0: 3c32 3a20 0d0a 2020 2020 2020 2020 2020  <2: ..          
-00003b00: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-00003b10: 6773 2e77 6172 6e28 0d0a 2020 2020 2020  gs.warn(..      
-00003b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003b30: 2020 2253 7069 6e65 2062 6f75 6e64 7320    "Spine bounds 
-00003b40: 6973 2061 2074 7570 6c65 206f 6620 2873  is a tuple of (s
-00003b50: 7461 7274 706f 696e 742c 2065 6e64 706f  tartpoint, endpo
-00003b60: 696e 7429 220d 0a20 2020 2020 2020 2020  int)"..         
-00003b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003b80: 2220 5369 6e67 6c65 206c 696d 6974 2076  " Single limit v
-00003b90: 616c 7565 2069 7320 6e6f 7420 616c 6c6f  alue is not allo
-00003ba0: 7765 642e 220d 0a20 2020 2020 2020 2020  wed."..         
+000005c0: 2020 2020 2072 6f63 5f63 7572 7665 2c20       roc_curve, 
+000005d0: 0d0a 2020 2020 2020 2020 726f 635f 6175  ..        roc_au
+000005e0: 635f 7363 6f72 652c 200d 0a20 2020 2020  c_score, ..     
+000005f0: 2020 2029 200d 0a65 7863 6570 7420 3a20     ) ..except : 
+00000600: 7061 7373 200d 0a20 0d0a 7472 7920 3a20  pass .. ..try : 
+00000610: 0d0a 2020 2020 6672 6f6d 2079 656c 6c6f  ..    from yello
+00000620: 7762 7269 636b 2e63 6c61 7373 6966 6965  wbrick.classifie
+00000630: 7220 696d 706f 7274 2043 6f6e 6675 7369  r import Confusi
+00000640: 6f6e 4d61 7472 6978 200d 0a65 7863 6570  onMatrix ..excep
+00000650: 743a 2070 6173 7320 0d0a 0d0a 445f 434f  t: pass ....D_CO
+00000660: 4c4f 5253 203d 5b0d 0a20 2020 2027 6727  LORS =[..    'g'
+00000670: 2c0d 0a20 2020 2027 6772 6179 272c 0d0a  ,..    'gray',..
+00000680: 2020 2020 2779 272c 200d 0a20 2020 2027      'y', ..    '
+00000690: 626c 7565 272c 0d0a 2020 2020 276f 7261  blue',..    'ora
+000006a0: 6e67 6527 2c0d 0a20 2020 2027 7075 7270  nge',..    'purp
+000006b0: 6c65 272c 0d0a 2020 2020 276c 696d 6527  le',..    'lime'
+000006c0: 2c0d 0a20 2020 2027 6b27 2c20 0d0a 2020  ,..    'k', ..  
+000006d0: 2020 2763 7961 6e27 2c20 0d0a 2020 2020    'cyan', ..    
+000006e0: 282e 362c 202e 362c 202e 3629 2c0d 0a20  (.6, .6, .6),.. 
+000006f0: 2020 2028 302c 202e 362c 202e 3329 2c20     (0, .6, .3), 
+00000700: 0d0a 2020 2020 282e 392c 2030 2c20 2e38  ..    (.9, 0, .8
+00000710: 292c 0d0a 2020 2020 282e 382c 202e 322c  ),..    (.8, .2,
+00000720: 202e 3829 2c0d 0a20 2020 2028 2e30 2c20   .8),..    (.0, 
+00000730: 2e39 2c20 2e34 290d 0a5d 0d0a 0d0a 445f  .9, .4)..]....D_
+00000740: 4d41 524b 4552 5320 3d5b 0d0a 2020 2020  MARKERS =[..    
+00000750: 276f 272c 0d0a 2020 2020 275e 272c 0d0a  'o',..    '^',..
+00000760: 2020 2020 2778 272c 0d0a 2020 2020 2744      'x',..    'D
+00000770: 272c 0d0a 2020 2020 2738 272c 0d0a 2020  ',..    '8',..  
+00000780: 2020 272a 272c 0d0a 2020 2020 2768 272c    '*',..    'h',
+00000790: 0d0a 2020 2020 2770 272c 0d0a 2020 2020  ..    'p',..    
+000007a0: 273e 272c 0d0a 2020 2020 276f 272c 0d0a  '>',..    'o',..
+000007b0: 2020 2020 2764 272c 0d0a 2020 2020 2748      'd',..    'H
+000007c0: 270d 0a5d 0d0a 0d0a 445f 5354 594c 4553  '..]....D_STYLES
+000007d0: 203d 205b 0d0a 2020 2020 272d 272c 0d0a   = [..    '-',..
+000007e0: 2020 2020 272d 272c 0d0a 2020 2020 272d      '-',..    '-
+000007f0: 2d27 2c0d 0a20 2020 2027 2d2e 272c 0d0a  -',..    '-.',..
+00000800: 2020 2020 273a 272c 200d 0a20 2020 2027      ':', ..    '
+00000810: 4e6f 6e65 272c 0d0a 2020 2020 2720 272c  None',..    ' ',
+00000820: 0d0a 2020 2020 2727 2c0d 0a20 2020 2027  ..    '',..    '
+00000830: 736f 6c69 6427 2c20 0d0a 2020 2020 2764  solid', ..    'd
+00000840: 6173 6865 6427 2c0d 0a20 2020 2027 6461  ashed',..    'da
+00000850: 7368 646f 7427 2c0d 0a20 2020 2027 646f  shdot',..    'do
+00000860: 7474 6564 2720 0d0a 5d0d 0a23 2d2d 2d2d  tted' ..]..#----
+00000870: 0d0a 0d0a 0d0a 6465 6620 706c 6f74 5f6c  ......def plot_l
+00000880: 6f67 6769 6e67 2028 200d 0a20 2020 2058  ogging ( ..    X
+00000890: 2c20 0d0a 2020 2020 793d 4e6f 6e65 2c20  , ..    y=None, 
+000008a0: 0d0a 2020 2020 7a6e 616d 6520 3d20 4e6f  ..    zname = No
+000008b0: 6e65 2c20 0d0a 2020 2020 746e 616d 6520  ne, ..    tname 
+000008c0: 3d20 4e6f 6e65 2c20 0d0a 2020 2020 6c61  = None, ..    la
+000008d0: 6265 6c73 3d4e 6f6e 652c 0d0a 2020 2020  bels=None,..    
+000008e0: 696d 7075 7465 5f6e 616e 3d54 7275 6520  impute_nan=True 
+000008f0: 2c20 0d0a 2020 2020 6e6f 726d 616c 697a  , ..    normaliz
+00000900: 6520 3d20 4661 6c73 652c 200d 0a20 2020  e = False, ..   
+00000910: 206c 6f67 3130 3d46 616c 7365 2c20 0d0a   log10=False, ..
+00000920: 2020 2020 636f 6c75 6d6e 735f 746f 5f73      columns_to_s
+00000930: 6b69 7020 3d4e 6f6e 652c 200d 0a20 2020  kip =None, ..   
+00000940: 2070 6174 7465 726e 203d 204e 6f6e 652c   pattern = None,
+00000950: 200d 0a20 2020 2073 7472 6174 6567 793d   ..    strategy=
+00000960: 276d 6561 6e27 2c20 200d 0a20 2020 2070  'mean',  ..    p
+00000970: 6f73 6979 3d20 4e6f 6e65 2c20 0d0a 2020  osiy= None, ..  
+00000980: 2020 6669 6c6c 5f76 616c 7565 203d 204e    fill_value = N
+00000990: 6f6e 652c 2020 0d0a 2020 2020 6669 675f  one,  ..    fig_
+000009a0: 7369 7a65 203d 2028 3136 2c20 3729 2c0d  size = (16, 7),.
+000009b0: 0a20 2020 2066 6967 5f64 7069 203d 2033  .    fig_dpi = 3
+000009c0: 3030 2c20 0d0a 2020 2020 636f 6c6f 7273  00, ..    colors
+000009d0: 203d 204e 6f6e 652c 0d0a 2020 2020 6373   = None,..    cs
+000009e0: 345f 636f 6c6f 7273 3d46 616c 7365 2c20  4_colors=False, 
+000009f0: 0d0a 2020 2020 736e 735f 7374 796c 6520  ..    sns_style 
+00000a00: 3d46 616c 7365 2c20 0d0a 2020 2020 7361  =False, ..    sa
+00000a10: 7665 6669 6720 3d20 4e6f 6e65 2c0d 0a20  vefig = None,.. 
+00000a20: 2020 2064 7261 775f 7370 696e 6573 3d46     draw_spines=F
+00000a30: 616c 7365 2c20 0d0a 2020 2020 7365 6564  alse, ..    seed
+00000a40: 3d4e 6f6e 652c 200d 0a20 2020 2076 6572  =None, ..    ver
+00000a50: 626f 7365 3d30 2c20 0d0a 2020 2020 2a2a  bose=0, ..    **
+00000a60: 6b77 730d 0a20 2020 2029 3a20 0d0a 2020  kws..    ): ..  
+00000a70: 2020 2222 2220 506c 6f74 206c 6f67 6769    """ Plot loggi
+00000a80: 6e67 2064 6174 6120 200d 0a20 2020 200d  ng data  ..    .
+00000a90: 0a20 2020 2050 6c6f 7420 6578 7065 6374  .    Plot expect
+00000aa0: 7320 6120 636f 6c6c 6563 7469 6f6e 206f  s a collection o
+00000ab0: 6620 6c6f 6767 696e 6720 6461 7461 2e20  f logging data. 
+00000ac0: 4561 6368 206c 6f67 6769 6e67 2064 6174  Each logging dat
+00000ad0: 6120 636f 6d70 6f73 6573 2061 200d 0a20  a composes a .. 
+00000ae0: 2020 2063 6f6c 756d 6e20 6f66 2064 6174     column of dat
+00000af0: 6120 636f 6c6c 6563 7465 6420 6f6e 2074  a collected on t
+00000b00: 6865 2066 6965 6c64 2e4e 6f74 6520 7468  he field.Note th
+00000b10: 6174 2063 616e 2061 6c73 6f20 706c 6f74  at can also plot
+00000b20: 2061 6e79 6b69 6e64 206f 6620 0d0a 2020   anykind of ..  
+00000b30: 2020 6461 7461 2072 656c 6174 6564 2074    data related t
+00000b40: 6861 7420 6974 2063 6f6e 7461 696e 7320  hat it contains 
+00000b50: 6e75 6d65 7269 6361 6c20 7661 6c75 6573  numerical values
+00000b60: 2e20 5468 6520 6675 6e63 7469 6f6e 2064  . The function d
+00000b70: 6f65 7320 6e6f 7420 0d0a 2020 2020 6163  oes not ..    ac
+00000b80: 6365 7074 2063 6174 6567 6f72 6963 616c  cept categorical
+00000b90: 2064 6174 612e 2020 2049 6620 6361 7465   data.   If cate
+00000ba0: 676f 7269 6361 6c20 6461 7461 2061 7265  gorical data are
+00000bb0: 2067 6976 656e 2c20 7468 6579 2073 686f   given, they sho
+00000bc0: 756c 6420 6265 200d 0a20 2020 2064 6973  uld be ..    dis
+00000bd0: 6361 7264 6564 2e20 0d0a 2020 2020 0d0a  carded. ..    ..
+00000be0: 2020 2020 5061 7261 6d65 7465 7273 200d      Parameters .
+00000bf0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
+00000c00: 0d0a 2020 2020 5820 3a20 4461 7461 6672  ..    X : Datafr
+00000c10: 616d 6520 6f66 2073 6861 7065 2028 6e5f  ame of shape (n_
+00000c20: 7361 6d70 6c65 732c 206e 5f66 6561 7475  samples, n_featu
+00000c30: 7265 7329 0d0a 2020 2020 2020 2020 2077  res)..         w
+00000c40: 6865 7265 2060 6e5f 7361 6d70 6c65 7360  here `n_samples`
+00000c50: 2069 7320 7468 6520 6e75 6d62 6572 206f   is the number o
+00000c60: 6620 6461 7461 2c20 6578 7065 6374 6564  f data, expected
+00000c70: 2074 6f20 6265 2074 6865 2064 6174 6120   to be the data 
+00000c80: 0d0a 2020 2020 2020 2020 2063 6f6c 6c65  ..         colle
+00000c90: 6374 6564 2061 7420 6469 6666 6572 656e  cted at differen
+00000ca0: 7420 6465 7074 6873 2061 6e64 2060 6e5f  t depths and `n_
+00000cb0: 6665 6174 7572 6573 6020 6973 2074 6865  features` is the
+00000cc0: 206e 756d 6265 7220 6f66 200d 0a20 2020   number of ..   
+00000cd0: 2020 2020 2020 636f 6c75 6d6e 7320 2866        columns (f
+00000ce0: 6561 7475 7265 7329 2074 6861 7420 7375  eatures) that su
+00000cf0: 7070 6f73 6564 2074 6f20 6265 2070 6c6f  pposed to be plo
+00000d00: 742e 200d 0a20 2020 2020 2020 2020 4e6f  t. ..         No
+00000d10: 7465 2074 6861 7420 6058 6020 6d75 7374  te that `X` must
+00000d20: 2069 6e63 6c75 6465 2074 6865 2060 6064   include the ``d
+00000d30: 6570 7468 6060 2063 6f6c 756d 6e73 2e20  epth`` columns. 
+00000d40: 4966 206e 6f74 2067 6976 656e 2061 200d  If not given a .
+00000d50: 0a20 2020 2020 2020 2020 7265 6c61 7469  .         relati
+00000d60: 7665 2064 6570 7468 2073 686f 756c 6420  ve depth should 
+00000d70: 6265 2063 7265 6174 6564 2061 6363 6f72  be created accor
+00000d80: 6469 6e67 2074 6f20 7468 6520 6e75 6d62  ding to the numb
+00000d90: 6572 206f 6620 7361 6d70 6c65 200d 0a20  er of sample .. 
+00000da0: 2020 2020 2020 2020 7468 6174 2063 6f6d          that com
+00000db0: 706f 7365 7320 6058 602e 0d0a 200d 0a20  poses `X`... .. 
+00000dc0: 2020 2079 203a 2061 7272 6179 2d6c 696b     y : array-lik
+00000dd0: 6520 6f72 2073 6572 6965 7320 6f66 2073  e or series of s
+00000de0: 6861 7065 2028 6e5f 7361 6d70 6c65 732c  hape (n_samples,
+00000df0: 292c 206f 7074 696f 6e61 6c0d 0a20 2020  ), optional..   
+00000e00: 2020 2020 2054 6172 6765 7420 7265 6c61       Target rela
+00000e10: 7469 7665 2074 6f20 5820 666f 7220 636c  tive to X for cl
+00000e20: 6173 7369 6669 6361 7469 6f6e 206f 7220  assification or 
+00000e30: 7265 6772 6573 7369 6f6e 3b20 4966 2067  regression; If g
+00000e40: 6976 656e 2c20 6279 200d 0a20 2020 2020  iven, by ..     
+00000e50: 2020 2064 6566 6175 6c74 2074 6865 2074     default the t
+00000e60: 6172 6765 7420 706c 6f74 2073 686f 756c  arget plot shoul
+00000e70: 6420 6265 206c 6f63 6174 6564 2061 7420  d be located at 
+00000e80: 7468 6520 6c61 7374 2070 6f73 6974 696f  the last positio
+00000e90: 6e2e 200d 0a20 2020 2020 2020 2048 6f77  n. ..        How
+00000ea0: 6576 6572 2077 6974 6820 7468 6520 6172  ever with the ar
+00000eb0: 6775 6d65 6e74 206f 6620 6070 6f73 6979  gument of `posiy
+00000ec0: 6020 2c20 7461 7267 6574 2070 6c6f 7420  ` , target plot 
+00000ed0: 6361 6e20 6265 2074 6f67 676c 6564 2074  can be toggled t
+00000ee0: 6f20 200d 0a20 2020 2020 2020 2074 6865  o  ..        the
+00000ef0: 2064 6573 6972 6564 2070 6f73 6974 696f   desired positio
+00000f00: 6e2e 200d 0a0d 0a20 2020 207a 6e61 6d65  n. ....    zname
+00000f10: 3a20 7374 722c 2064 6566 6175 6c74 3d27  : str, default='
+00000f20: 6465 7074 6827 206f 7220 274e 6f6e 6527  depth' or 'None'
+00000f30: 0d0a 2020 2020 2020 2020 5468 6520 6e61  ..        The na
+00000f40: 6d65 206f 6620 7468 6520 6465 7074 6820  me of the depth 
+00000f50: 636f 6c75 6d6e 2069 6e20 6058 602e 2049  column in `X`. I
+00000f60: 6620 7468 6520 6e61 6d65 2027 6465 7074  f the name 'dept
+00000f70: 6827 2069 7320 6e6f 7420 200d 0a20 2020  h' is not  ..   
+00000f80: 2020 2020 2073 7065 6369 6669 6564 2061       specified a
+00000f90: 7320 7468 6520 6d61 696e 2064 6570 7468  s the main depth
+00000fa0: 2063 6f6c 756d 6e73 2c20 616e 206f 7468   columns, an oth
+00000fb0: 6572 206e 616d 6520 696e 2074 6865 2063  er name in the c
+00000fc0: 6f6c 756d 6e73 200d 0a20 2020 2020 2020  olumns ..       
+00000fd0: 2074 6861 7420 6d61 7463 6865 7320 7468   that matches th
+00000fe0: 6520 6465 7074 6820 6361 6e20 616c 736f  e depth can also
+00000ff0: 2062 6520 696e 6469 6361 7465 6420 736f   be indicated so
+00001000: 2074 6865 2066 756e 6374 696f 6e20 7769   the function wi
+00001010: 6c6c 2070 7574 200d 0a20 2020 2020 2020  ll put ..       
+00001020: 2061 7369 6465 2074 6869 7320 636f 6c75   aside this colu
+00001030: 6d6d 2061 7320 6465 7074 6820 636f 6c75  mm as depth colu
+00001040: 6d6e 2066 6f72 2070 6c6f 7420 7075 7270  mn for plot purp
+00001050: 6f73 652e 2049 6620 7365 7420 746f 2060  ose. If set to `
+00001060: 604e 6f6e 6560 602c 200d 0a20 2020 2020  `None``, ..     
+00001070: 2020 2060 7a6e 616d 6560 2068 6f6c 6473     `zname` holds
+00001080: 2074 6865 206e 616d 6520 6060 6465 7074   the name ``dept
+00001090: 6860 6020 616e 6420 6173 7375 6d65 7320  h`` and assumes 
+000010a0: 7468 6174 2064 6570 7468 2065 7869 7374  that depth exist
+000010b0: 7320 696e 200d 0a20 2020 2020 2020 2060  s in ..        `
+000010c0: 5860 2063 6f6c 756d 6e73 2e0d 0a20 2020  X` columns...   
+000010d0: 2074 6e61 6d65 3a20 7374 722c 206f 7074   tname: str, opt
+000010e0: 696f 6e61 6c2c 200d 0a20 2020 2020 2020  ional, ..       
+000010f0: 206e 616d 6520 6f66 2074 6865 2074 6172   name of the tar
+00001100: 6765 742e 2054 6869 7320 6361 6e20 7265  get. This can re
+00001110: 6e61 6d65 206f 6620 7468 6520 7461 7267  name of the targ
+00001120: 6574 206e 616d 6520 6966 2067 6976 656e  et name if given
+00001130: 2060 7960 0d0a 2020 2020 2020 2020 6173   `y`..        as
+00001140: 2061 2070 616e 6461 7320 7365 7269 6573   a pandas series
+00001150: 2020 6f72 2061 6464 2074 6865 206e 616d    or add the nam
+00001160: 6520 6f66 2074 6172 6765 7420 6966 2067  e of target if g
+00001170: 6976 656e 2061 7320 616e 2061 7272 6179  iven as an array
+00001180: 2d6c 696b 652e 200d 0a20 2020 2020 2020  -like. ..       
+00001190: 2049 6620 6e6f 7420 7072 6f76 6964 6564   If not provided
+000011a0: 2c20 6974 2073 686f 756c 6420 7573 6520  , it should use 
+000011b0: 7468 6520 6e61 6d65 206f 6620 7468 6520  the name of the 
+000011c0: 7461 7267 6574 2073 6572 6965 7320 6966  target series if
+000011d0: 2060 7960 2069 730d 0a20 2020 2020 2020   `y` is..       
+000011e0: 206e 6f74 204e 6f6e 652e 200d 0a20 2020   not None. ..   
+000011f0: 2020 2020 200d 0a20 2020 206e 6f72 6d61       ..    norma
+00001200: 6c69 7a65 3a20 626f 6f6c 2c20 6465 6661  lize: bool, defa
+00001210: 756c 7420 3d20 4661 6c73 650d 0a20 2020  ult = False..   
+00001220: 2020 2020 204e 6f72 6d61 6c69 7a65 2061       Normalize a
+00001230: 6c6c 2074 6865 2064 6174 6120 746f 2062  ll the data to b
+00001240: 6520 7261 6e67 6520 6265 7477 6565 6e20  e range between 
+00001250: 2830 2c20 3129 2065 7863 6570 7420 7468  (0, 1) except th
+00001260: 6520 6064 6570 7468 602c 2020 2020 0d0a  e `depth`,    ..
+00001270: 2020 2020 2020 2020 0d0a 2020 2020 6c61          ..    la
+00001280: 6265 6c73 3a20 6c69 7374 206f 7220 7374  bels: list or st
+00001290: 722c 206f 7074 696f 6e61 6c0d 0a20 2020  r, optional..   
+000012a0: 2020 2020 2049 6620 6c61 6265 6c73 2061       If labels a
+000012b0: 7265 2067 6976 656e 2c20 7468 6579 2073  re given, they s
+000012c0: 686f 756c 6420 6669 7420 7468 6520 7369  hould fit the si
+000012d0: 7a65 206f 6620 7468 6520 6e75 6d62 6572  ze of the number
+000012e0: 206f 6620 0d0a 2020 2020 2020 2020 636f   of ..        co
+000012f0: 6c75 6d6e 732e 2054 6865 2067 6976 656e  lumns. The given
+00001300: 206c 6162 656c 7320 7368 6f75 6c64 2072   labels should r
+00001310: 6570 6c61 6365 2074 6865 206f 6c64 2063  eplace the old c
+00001320: 6f6c 756d 6e73 2069 6e20 6058 6020 616e  olumns in `X` an
+00001330: 6420 0d0a 2020 2020 2020 2020 7368 6f75  d ..        shou
+00001340: 6c64 2066 6967 7565 206f 7574 2069 6e20  ld figue out in 
+00001350: 7468 6520 706c 6f74 2e20 5468 6973 2069  the plot. This i
+00001360: 7320 7573 6566 756c 6c20 746f 2063 6861  s usefull to cha
+00001370: 6e67 6520 7468 6520 636f 6c75 6d6e 7320  nge the columns 
+00001380: 0d0a 2020 2020 2020 2020 6c61 6265 6c73  ..        labels
+00001390: 2069 6e20 7468 6520 6461 7461 6672 616d   in the datafram
+000013a0: 6520 746f 2061 206e 6577 206c 6162 656c  e to a new label
+000013b0: 7320 7468 6174 2064 6573 6372 6962 6520  s that describe 
+000013c0: 7468 6520 6265 7374 2074 6865 200d 0a20  the best the .. 
+000013d0: 2020 2020 2020 2070 6c6f 7420 3b20 666f         plot ; fo
+000013e0: 7220 696e 7374 616e 6365 2062 7920 696e  r instance by in
+000013f0: 6c75 6469 6e67 2074 6865 2075 6e69 7473  luding the units
+00001400: 2069 6e20 7468 6520 6e65 7720 6c61 6265   in the new labe
+00001410: 6c73 2e20 4e6f 7465 2074 6861 7420 0d0a  ls. Note that ..
+00001420: 2020 2020 2020 2020 6966 2074 6865 206c          if the l
+00001430: 6162 656c 7320 646f 206e 6f74 206d 6174  abels do not mat
+00001440: 6368 2074 6865 2073 697a 6520 6f66 2074  ch the size of t
+00001450: 6865 206f 6c64 2063 6f6c 756d 6e73 2069  he old columns i
+00001460: 6e20 6058 6020 6120 7761 726e 696e 6720  n `X` a warning 
+00001470: 0d0a 2020 2020 2020 2020 7368 6f75 6c64  ..        should
+00001480: 2062 6520 6c65 7420 746f 2074 6865 2075   be let to the u
+00001490: 7365 7220 616e 6420 6e6f 6e65 206f 7065  ser and none ope
+000014a0: 7261 7469 6f6e 2077 696c 6c20 6265 2070  ration will be p
+000014b0: 6572 666f 726d 6564 2e20 0d0a 2020 2020  erformed. ..    
+000014c0: 2020 2020 0d0a 2020 2020 696d 7075 7465      ..    impute
+000014d0: 5f6e 616e 3a20 626f 6f6c 2c20 6465 6661  _nan: bool, defa
+000014e0: 756c 743d 5472 7565 2c20 0d0a 2020 2020  ult=True, ..    
+000014f0: 2020 2020 5265 706c 6163 6520 7468 6520      Replace the 
+00001500: 4e61 4e20 7661 6c75 6573 2069 6e20 7468  NaN values in th
+00001510: 6520 6461 7461 6672 616d 652e 204e 6f74  e dataframe. Not
+00001520: 6520 7468 6174 2074 6865 2064 6566 6175  e that the defau
+00001530: 6c74 200d 0a20 2020 2020 2020 2062 6568  lt ..        beh
+00001540: 6176 696f 7572 2066 6f72 2072 6570 6c61  aviour for repla
+00001550: 6369 6e67 204e 614e 2069 7320 7468 6520  cing NaN is the 
+00001560: 6060 6d65 616e 6060 2e20 486f 7765 7665  ``mean``. Howeve
+00001570: 7220 6966 2074 6865 2061 7267 756d 656e  r if the argumen
+00001580: 7420 0d0a 2020 2020 2020 2020 6f66 2060  t ..        of `
+00001590: 6669 6c6c 5f76 616c 7565 6020 6973 2070  fill_value` is p
+000015a0: 726f 7669 6465 642c 7468 6520 6c61 7474  rovided,the latt
+000015b0: 6572 2073 686f 756c 6420 6265 2075 7365  er should be use
+000015c0: 6420 746f 2072 6570 6c61 6365 2027 4e61  d to replace 'Na
+000015d0: 4e27 200d 0a20 2020 2020 2020 2069 6e20  N' ..        in 
+000015e0: 6058 602e 200d 0a20 2020 2020 2020 200d  `X`. ..        .
+000015f0: 0a20 2020 206c 6f67 3130 3a20 626f 6f6c  .    log10: bool
+00001600: 2c20 6465 6661 756c 743d 4661 6c73 650d  , default=False.
+00001610: 0a20 2020 2020 2020 2043 6f6e 7665 7274  .        Convert
+00001620: 2076 616c 7565 7320 746f 206c 6f67 3130   values to log10
+00001630: 2e20 5468 6973 2063 616e 2062 6520 7573  . This can be us
+00001640: 6566 756c 6c20 7768 656e 2075 7369 6e67  efull when using
+00001650: 2074 6865 206c 6f67 6172 6974 686d 200d   the logarithm .
+00001660: 0a20 2020 2020 2020 2064 6174 612e 2048  .        data. H
+00001670: 6f77 6576 6572 2c20 6974 2073 6565 6d73  owever, it seems
+00001680: 206e 6f74 2061 6c6c 2074 6865 2064 6174   not all the dat
+00001690: 6120 6361 6e20 6265 2075 7365 6420 7468  a can be used th
+000016a0: 6973 206f 7065 7261 7469 6f6e 2c20 0d0a  is operation, ..
+000016b0: 2020 2020 2020 2020 666f 7220 696e 7374          for inst
+000016c0: 616e 6365 2c20 6120 6e65 6761 7469 7665  ance, a negative
+000016d0: 2064 6174 612e 2049 6e20 7468 6174 2063   data. In that c
+000016e0: 6173 652c 2060 636f 6c75 6d6e 5f74 6f5f  ase, `column_to_
+000016f0: 736b 6970 6020 6172 6775 6d65 6e74 0d0a  skip` argument..
+00001700: 2020 2020 2020 2020 6973 2075 7365 6675          is usefu
+00001710: 6c6c 2074 6f20 7072 6f76 6964 6520 736f  ll to provide so
+00001720: 2074 6f20 736b 6970 2074 6861 7420 636f   to skip that co
+00001730: 6c75 6d6e 7320 7768 656e 2063 6f6e 7665  lumns when conve
+00001740: 7274 696e 6720 7661 6c75 6573 200d 0a20  rting values .. 
+00001750: 2020 2020 2020 2074 6f20 6c6f 6731 302e         to log10.
+00001760: 200d 0a20 0d0a 2020 2020 636f 6c75 6d6e   .. ..    column
+00001770: 735f 746f 5f73 6b69 703a 206c 6973 7420  s_to_skip: list 
+00001780: 6f72 2073 7472 2c20 6f70 7469 6f6e 616c  or str, optional
+00001790: 2c20 0d0a 2020 2020 2020 2020 436f 6c75  , ..        Colu
+000017a0: 6d6e 7320 746f 2073 6b69 7020 7768 656e  mns to skip when
+000017b0: 2070 6572 666f 726d 696e 6720 736f 6d65   performing some
+000017c0: 206f 7065 7261 7469 6f6e 206c 696b 6520   operation like 
+000017d0: 276c 6f67 3130 272e 2054 6865 7365 200d  'log10'. These .
+000017e0: 0a20 2020 2020 2020 2063 6f6c 756d 6e73  .        columns
+000017f0: 2077 6974 6820 6e6f 7420 6265 2061 6666   with not be aff
+00001800: 6563 7465 6420 6279 2074 6865 2027 6c6f  ected by the 'lo
+00001810: 6731 3027 206f 7065 7261 7469 6f6e 732e  g10' operations.
+00001820: 204e 6f74 6520 7468 6174 200d 0a20 2020   Note that ..   
+00001830: 2020 2020 6063 6f6c 756d 6e73 5f74 6f5f      `columns_to_
+00001840: 736b 6970 6020 6361 6e20 616c 736f 2067  skip` can also g
+00001850: 6976 6573 2061 7320 6c69 7474 6572 616c  ives as litteral
+00001860: 2073 7472 696e 672e 2049 6e20 7468 6174   string. In that
+00001870: 2063 6173 652c 2074 6865 200d 0a20 2020   case, the ..   
+00001880: 2020 2020 6070 6174 7465 726e 6020 6973      `pattern` is
+00001890: 206e 6565 6420 746f 2070 6172 7365 2074   need to parse t
+000018a0: 6865 2063 6f6c 756d 6e73 2069 6e74 6f20  he columns into 
+000018b0: 6120 6c69 7374 206f 6620 7374 7269 6e67  a list of string
+000018c0: 2e20 0d0a 2020 2020 2020 200d 0a20 2020  . ..       ..   
+000018d0: 2070 6174 7465 726e 3a20 7374 722c 2064   pattern: str, d
+000018e0: 6566 6175 6c74 203d 2027 5b23 262a 4021  efault = '[#&*@!
+000018f0: 2c3b 5c73 5d5c 732a 270d 0a20 2020 2020  ,;\s]\s*'..     
+00001900: 2020 2052 6567 6578 2070 6174 7465 726e     Regex pattern
+00001910: 2074 6f20 7061 7273 6520 7468 6520 6063   to parse the `c
+00001920: 6f6c 756d 6e73 5f74 6f5f 736b 6970 6020  olumns_to_skip` 
+00001930: 696e 746f 2061 206c 6973 7420 6f66 2073  into a list of s
+00001940: 7472 696e 6720 0d0a 2020 2020 2020 2020  tring ..        
+00001950: 7768 6572 6520 6561 6368 2069 7465 6d20  where each item 
+00001960: 6973 2061 2063 6f6c 756d 6e20 6e61 6d65  is a column name
+00001970: 2065 7370 6563 6961 6c6c 7920 7768 656e   especially when
+00001980: 2074 6865 206c 6174 7465 7220 6973 2067   the latter is g
+00001990: 6976 656e 200d 0a20 2020 2020 2020 2061  iven ..        a
+000019a0: 7320 6c69 7474 6572 616c 2074 6578 7420  s litteral text 
+000019b0: 7374 7269 6e67 2e20 466f 7220 696e 7374  string. For inst
+000019c0: 616e 6365 3a3a 200d 0a20 2020 2020 2020  ance:: ..       
+000019d0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+000019e0: 2020 2063 6f6c 756d 6e73 5f74 6f5f 736b     columns_to_sk
+000019f0: 6970 3d27 6465 7074 685f 746f 702c 2074  ip='depth_top, t
+00001a00: 6869 636b 6e65 7373 2c20 7370 2c20 6761  hickness, sp, ga
+00001a10: 6d6d 615f 6761 6d6d 6127 2020 0d0a 2020  mma_gamma'  ..  
+00001a20: 2020 2020 2020 2020 2020 2d3e 205b 2764            -> ['d
+00001a30: 6570 7468 5f74 6f70 272c 2027 7468 6963  epth_top', 'thic
+00001a40: 6b6e 6573 7327 2c20 2773 7027 2c20 2767  kness', 'sp', 'g
+00001a50: 616d 6d61 5f67 616d 6d61 275d 0d0a 2020  amma_gamma']..  
+00001a60: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00001a70: 2020 2020 6279 2075 7369 6e67 2074 6865      by using the
+00001a80: 2064 6566 6175 6c74 2070 6174 7465 726e   default pattern
+00001a90: 2e20 546f 2068 6176 6520 6675 6c6c 2063  . To have full c
+00001aa0: 6f6e 7472 6f6c 206f 6620 636f 6c75 6d6e  ontrol of column
+00001ab0: 7320 7370 6c69 7474 6564 0d0a 2020 2020  s splitted..    
+00001ac0: 2020 2020 6974 2069 7320 7265 636f 6d6d      it is recomm
+00001ad0: 656e 6465 6420 746f 2070 726f 7669 6465  ended to provide
+00001ae0: 6420 796f 7572 206f 776e 2070 6174 7465  d your own patte
+00001af0: 726e 2074 6f20 6176 6f69 6420 7772 6f6e  rn to avoid wron
+00001b00: 6720 7061 7273 696e 6720 0d0a 2020 2020  g parsing ..    
+00001b10: 2020 2020 616e 6420 6361 6e20 6c65 6164      and can lead
+00001b20: 2074 6f20 616e 2065 7272 6f72 2e20 0d0a   to an error. ..
+00001b30: 2020 2020 2020 2020 0d0a 2020 2020 7374          ..    st
+00001b40: 7261 7465 6779 203a 2073 7472 2c20 6465  rategy : str, de
+00001b50: 6661 756c 743d 276d 6561 6e27 0d0a 2020  fault='mean'..  
+00001b60: 2020 2020 2020 5468 6520 696d 7075 7461        The imputa
+00001b70: 7469 6f6e 2073 7472 6174 6567 792e 0d0a  tion strategy...
+00001b80: 0d0a 2020 2020 2020 2020 2d20 4966 2022  ..        - If "
+00001b90: 6d65 616e 222c 2074 6865 6e20 7265 706c  mean", then repl
+00001ba0: 6163 6520 6d69 7373 696e 6720 7661 6c75  ace missing valu
+00001bb0: 6573 2075 7369 6e67 2074 6865 206d 6561  es using the mea
+00001bc0: 6e20 616c 6f6e 670d 0a20 2020 2020 2020  n along..       
+00001bd0: 2020 2065 6163 6820 636f 6c75 6d6e 2e20     each column. 
+00001be0: 4361 6e20 6f6e 6c79 2062 6520 7573 6564  Can only be used
+00001bf0: 2077 6974 6820 6e75 6d65 7269 6320 6461   with numeric da
+00001c00: 7461 2e0d 0a20 2020 2020 2020 202d 2049  ta...        - I
+00001c10: 6620 226d 6564 6961 6e22 2c20 7468 656e  f "median", then
+00001c20: 2072 6570 6c61 6365 206d 6973 7369 6e67   replace missing
+00001c30: 2076 616c 7565 7320 7573 696e 6720 7468   values using th
+00001c40: 6520 6d65 6469 616e 2061 6c6f 6e67 0d0a  e median along..
+00001c50: 2020 2020 2020 2020 2020 6561 6368 2063            each c
+00001c60: 6f6c 756d 6e2e 2043 616e 206f 6e6c 7920  olumn. Can only 
+00001c70: 6265 2075 7365 6420 7769 7468 206e 756d  be used with num
+00001c80: 6572 6963 2064 6174 612e 0d0a 2020 2020  eric data...    
+00001c90: 2020 2020 2d20 4966 2022 6d6f 7374 5f66      - If "most_f
+00001ca0: 7265 7175 656e 7422 2c20 7468 656e 2072  requent", then r
+00001cb0: 6570 6c61 6365 206d 6973 7369 6e67 2075  eplace missing u
+00001cc0: 7369 6e67 2074 6865 206d 6f73 7420 6672  sing the most fr
+00001cd0: 6571 7565 6e74 0d0a 2020 2020 2020 2020  equent..        
+00001ce0: 2020 7661 6c75 6520 616c 6f6e 6720 6561    value along ea
+00001cf0: 6368 2063 6f6c 756d 6e2e 2043 616e 2062  ch column. Can b
+00001d00: 6520 7573 6564 2077 6974 6820 7374 7269  e used with stri
+00001d10: 6e67 7320 6f72 206e 756d 6572 6963 2064  ngs or numeric d
+00001d20: 6174 612e 0d0a 2020 2020 2020 2020 2020  ata...          
+00001d30: 4966 2074 6865 7265 2069 7320 6d6f 7265  If there is more
+00001d40: 2074 6861 6e20 6f6e 6520 7375 6368 2076   than one such v
+00001d50: 616c 7565 2c20 6f6e 6c79 2074 6865 2073  alue, only the s
+00001d60: 6d61 6c6c 6573 7420 6973 2072 6574 7572  mallest is retur
+00001d70: 6e65 642e 0d0a 2020 2020 2020 2020 2d20  ned...        - 
+00001d80: 4966 2022 636f 6e73 7461 6e74 222c 2074  If "constant", t
+00001d90: 6865 6e20 7265 706c 6163 6520 6d69 7373  hen replace miss
+00001da0: 696e 6720 7661 6c75 6573 2077 6974 6820  ing values with 
+00001db0: 6669 6c6c 5f76 616c 7565 2e20 4361 6e20  fill_value. Can 
+00001dc0: 6265 0d0a 2020 2020 2020 2020 2020 7573  be..          us
+00001dd0: 6564 2077 6974 6820 7374 7269 6e67 7320  ed with strings 
+00001de0: 6f72 206e 756d 6572 6963 2064 6174 612e  or numeric data.
+00001df0: 0d0a 0d0a 2020 2020 6669 6c6c 5f76 616c  ....    fill_val
+00001e00: 7565 203a 2073 7472 206f 7220 6e75 6d65  ue : str or nume
+00001e10: 7269 6361 6c20 7661 6c75 652c 206f 7074  rical value, opt
+00001e20: 696f 6e61 6c0d 0a20 2020 2020 2020 2057  ional..        W
+00001e30: 6865 6e20 7374 7261 7465 6779 203d 3d20  hen strategy == 
+00001e40: 2263 6f6e 7374 616e 7422 2c20 6669 6c6c  "constant", fill
+00001e50: 5f76 616c 7565 2069 7320 7573 6564 2074  _value is used t
+00001e60: 6f20 7265 706c 6163 6520 616c 6c0d 0a20  o replace all.. 
+00001e70: 2020 2020 2020 206f 6363 7572 7265 6e63         occurrenc
+00001e80: 6573 206f 6620 6d69 7373 696e 675f 7661  es of missing_va
+00001e90: 6c75 6573 2e0d 0a20 2020 2020 2020 2049  lues...        I
+00001ea0: 6620 6c65 6674 2074 6f20 7468 6520 6465  f left to the de
+00001eb0: 6661 756c 742c 2066 696c 6c5f 7661 6c75  fault, fill_valu
+00001ec0: 6520 7769 6c6c 2062 6520 3020 7768 656e  e will be 0 when
+00001ed0: 2069 6d70 7574 696e 6720 6e75 6d65 7269   imputing numeri
+00001ee0: 6361 6c0d 0a20 2020 2020 2020 2064 6174  cal..        dat
+00001ef0: 6120 616e 6420 226d 6973 7369 6e67 5f76  a and "missing_v
+00001f00: 616c 7565 2220 666f 7220 7374 7269 6e67  alue" for string
+00001f10: 7320 6f72 206f 626a 6563 7420 6461 7461  s or object data
+00001f20: 2074 7970 6573 2e20 4966 206e 6f74 200d   types. If not .
+00001f30: 0a20 2020 2020 2020 2067 6976 656e 2061  .        given a
+00001f40: 6e64 2060 696d 7075 7465 5f6e 616e 6020  nd `impute_nan` 
+00001f50: 6973 2060 6054 7275 6560 602c 2074 6865  is ``True``, the
+00001f60: 206d 6561 6e20 7374 7261 7465 6779 2069   mean strategy i
+00001f70: 7320 7573 6564 2069 6e73 7465 6164 2e0d  s used instead..
+00001f80: 0a0d 0a20 2020 2070 6f73 6979 3a20 696e  ...    posiy: in
+00001f90: 742c 206f 7074 696f 6e61 6c20 0d0a 2020  t, optional ..  
+00001fa0: 2020 2020 2020 7468 6520 706f 7369 7469        the positi
+00001fb0: 6f6e 2074 6f20 706c 6163 6520 7468 6520  on to place the 
+00001fc0: 7461 7267 6574 2070 6c6f 7420 6079 6020  target plot `y` 
+00001fd0: 2e20 4279 2064 6566 6175 6c74 2074 6865  . By default the
+00001fe0: 2074 6172 6765 7420 706c 6f74 200d 0a20   target plot .. 
+00001ff0: 2020 2020 2020 2069 6620 6769 7665 6e20         if given 
+00002000: 6973 206c 6f63 6174 6564 2061 7420 7468  is located at th
+00002010: 6520 6c61 7374 2070 6f73 6974 696f 6e20  e last position 
+00002020: 6265 6869 6e64 2074 6865 206c 6f67 6769  behind the loggi
+00002030: 6e67 2070 6c6f 7473 2e20 0d0a 2020 2020  ng plots. ..    
+00002040: 0d0a 2020 2020 636f 6c6f 7273 3a20 7374  ..    colors: st
+00002050: 722c 206c 6973 7420 6f66 204d 6174 706c  r, list of Matpl
+00002060: 6f74 6c69 622e 636f 6c6f 7273 206d 6170  otlib.colors map
+00002070: 2c20 6f70 7469 6f6e 616c 200d 0a20 2020  , optional ..   
+00002080: 2020 2020 2054 6865 2063 6f6c 6f72 7320       The colors 
+00002090: 666f 7220 706c 6f74 7469 6e67 2065 6163  for plotting eac
+000020a0: 6820 636f 6c75 6d6e 7320 6f66 2060 5860  h columns of `X`
+000020b0: 2065 7863 6570 7420 7468 6520 6465 7074   except the dept
+000020c0: 682e 2049 6620 6e6f 740d 0a20 2020 2020  h. If not..     
+000020d0: 2020 2067 6976 656e 2c20 6465 6661 756c     given, defaul
+000020e0: 7420 636f 6c6f 7273 2061 7265 2061 7574  t colors are aut
+000020f0: 6f2d 6765 6e65 7261 7465 642e 0d0a 2020  o-generated...  
+00002100: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00002110: 4966 2060 636f 6c6f 7273 6020 6973 2073  If `colors` is s
+00002120: 7472 696e 6720 616e 6420 2763 7334 276f  tring and 'cs4'o
+00002130: 7220 2778 6b63 6427 2069 7320 696e 636c  r 'xkcd' is incl
+00002140: 7564 6564 2e20 0d0a 2020 2020 2020 2020  uded. ..        
+00002150: 4d61 7470 6c6f 746c 6962 2e63 6f6c 6f72  Matplotlib.color
+00002160: 732e 4353 345f 434f 4c4f 5253 206f 7220  s.CS4_COLORS or 
+00002170: 4d61 7470 6c6f 746c 6962 2e63 6f6c 6f72  Matplotlib.color
+00002180: 732e 584b 4344 5f43 4f4c 4f52 5320 0d0a  s.XKCD_COLORS ..
+00002190: 2020 2020 2020 2020 7368 6f75 6c64 2062          should b
+000021a0: 6520 7573 6564 2069 6e73 7465 6164 2e20  e used instead. 
+000021b0: 496e 2061 6464 6974 696f 6e20 6966 2074  In addition if t
+000021c0: 6865 2060 2763 7334 2760 206f 7220 6027  he `'cs4'` or `'
+000021d0: 786b 6364 2760 2069 7320 200d 0a20 2020  xkcd'` is  ..   
+000021e0: 2020 2020 2073 7566 6669 7865 6420 6279       suffixed by
+000021f0: 2063 6f6c 6f6e 7320 616e 6420 696e 7465   colons and inte
+00002200: 6765 7220 7661 6c75 6520 6c69 6b65 2060  ger value like `
+00002210: 6063 7334 3a34 6060 206f 7220 6060 786b  `cs4:4`` or ``xk
+00002220: 6364 3a34 6060 2c20 7468 6520 0d0a 2020  cd:4``, the ..  
+00002230: 2020 2020 2020 4353 3420 6f72 2058 4b43        CS4 or XKC
+00002240: 4420 636f 6c6f 7273 2073 686f 756c 6420  D colors should 
+00002250: 6265 2075 7365 6420 6672 6f6d 2069 6e64  be used from ind
+00002260: 6578 2065 7175 616c 7320 746f 2060 6034  ex equals to ``4
+00002270: 6060 2e20 0d0a 2020 2020 2020 2020 0d0a  ``. ..        ..
+00002280: 2020 2020 2020 2020 2e2e 2076 6572 7369          .. versi
+00002290: 6f6e 6164 6465 643a 3a20 302e 322e 3320  onadded:: 0.2.3 
+000022a0: 0d0a 2020 2020 2020 2020 2020 204d 6174  ..           Mat
+000022b0: 706c 6f74 6c69 622e 636f 6c6f 7273 2e43  plotlib.colors.C
+000022c0: 5334 5f43 4f4c 4f52 5320 6f72 204d 6174  S4_COLORS or Mat
+000022d0: 706c 6f74 6c69 622e 636f 6c6f 7273 2e58  plotlib.colors.X
+000022e0: 4b43 445f 434f 4c4f 5253 2063 616e 200d  KCD_COLORS can .
+000022f0: 0a20 2020 2020 2020 2020 2020 6265 2075  .           be u
+00002300: 7365 6420 6279 2073 6574 7469 6e67 2060  sed by setting `
+00002310: 636f 6c6f 7273 6020 746f 2060 6027 6373  colors` to ``'cs
+00002320: 3427 6060 206f 7220 6060 2778 6b63 6427  4'`` or ``'xkcd'
+00002330: 6060 2e20 546f 2072 6570 726f 6475 6365  ``. To reproduce
+00002340: 200d 0a20 2020 2020 2020 2020 2020 7468   ..           th
+00002350: 6520 7361 6d65 2043 5334 206f 7220 584b  e same CS4 or XK
+00002360: 4344 2063 6f6c 6f72 732c 2073 6574 2074  CD colors, set t
+00002370: 6865 2060 7365 6564 6020 7061 7261 6d65  he `seed` parame
+00002380: 7465 7220 746f 2061 200d 0a20 2020 2020  ter to a ..     
+00002390: 2020 2020 2020 7370 6563 6966 6963 2076        specific v
+000023a0: 616c 7565 2e20 0d0a 2020 2020 2020 2020  alue. ..        
+000023b0: 0d0a 2020 2020 6472 6177 5f73 7069 6e65  ..    draw_spine
+000023c0: 733a 2062 6f6f 6c2c 2074 7570 6c65 2028  s: bool, tuple (
+000023d0: 2d6c 696d 2c20 2b6c 696d 292c 2064 6566  -lim, +lim), def
+000023e0: 6175 6c74 3d20 4661 6c73 652c 200d 0a20  ault= False, .. 
+000023f0: 2020 2020 2020 204f 6e6c 7920 6472 6177         Only draw
+00002400: 2073 7069 6e65 2062 6574 7765 656e 2074   spine between t
+00002410: 6865 2079 2d74 6963 6b73 2e20 6060 2d6c  he y-ticks. ``-l
+00002420: 696d 6060 2061 6e64 2060 602b 6c69 6d60  im`` and ``+lim`
+00002430: 6020 6172 6520 6c6f 7765 7220 0d0a 2020  ` are lower ..  
+00002440: 2020 2020 2020 616e 6420 7570 7065 7220        and upper 
+00002450: 626f 756e 6420 692e 652e 2061 2072 616e  bound i.e. a ran
+00002460: 6765 2074 6f20 6472 6177 2074 6865 2073  ge to draw the s
+00002470: 7069 6e65 7320 696e 2079 2d61 7869 732e  pines in y-axis.
+00002480: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00002490: 2066 6967 5f73 697a 6520 3a20 7475 706c   fig_size : tupl
+000024a0: 6520 2877 6964 7468 2c20 6865 6967 6874  e (width, height
+000024b0: 292c 2064 6566 6175 6c74 203d 2838 2c20  ), default =(8, 
+000024c0: 3629 0d0a 2020 2020 2020 2020 7468 6520  6)..        the 
+000024d0: 6d61 7470 6c6f 746c 6962 2066 6967 7572  matplotlib figur
+000024e0: 6520 7369 7a65 2067 6976 656e 2061 7320  e size given as 
+000024f0: 6120 7475 706c 6520 6f66 2077 6964 7468  a tuple of width
+00002500: 2061 6e64 2068 6569 6768 740d 0a20 2020   and height..   
+00002510: 2020 2020 200d 0a20 2020 2066 6967 5f64       ..    fig_d
+00002520: 7069 3a20 666c 6f61 7420 6f72 2027 6669  pi: float or 'fi
+00002530: 6775 7265 272c 2064 6566 6175 6c74 3a20  gure', default: 
+00002540: 7263 5061 7261 6d73 5b22 7361 7665 6669  rcParams["savefi
+00002550: 672e 6470 6922 5d20 5c0d 0a20 2020 2020  g.dpi"] \..     
+00002560: 2020 2028 6465 6661 756c 743a 2027 6669     (default: 'fi
+00002570: 6775 7265 2729 0d0a 2020 2020 2020 2020  gure')..        
+00002580: 5468 6520 7265 736f 6c75 7469 6f6e 2069  The resolution i
+00002590: 6e20 646f 7473 2070 6572 2069 6e63 682e  n dots per inch.
+000025a0: 2049 6620 2766 6967 7572 6527 2c20 7573   If 'figure', us
+000025b0: 6520 7468 6520 6669 6775 7265 2773 2064  e the figure's d
+000025c0: 7069 2076 616c 7565 2e0d 0a20 2020 2020  pi value...     
+000025d0: 2020 200d 0a20 2020 2073 6176 6566 6967     ..    savefig
+000025e0: 3a20 7374 722c 2064 6566 6175 6c74 203d  : str, default =
+000025f0: 4e6f 6e65 202c 200d 0a20 2020 2020 2020  None , ..       
+00002600: 2074 6865 2070 6174 6820 746f 2073 6176   the path to sav
+00002610: 6520 7468 6520 6669 6775 7265 2e20 4172  e the figure. Ar
+00002620: 6775 6d65 6e74 2069 7320 7061 7373 6564  gument is passed
+00002630: 2074 6f20 0d0a 2020 2020 2020 2020 3a63   to ..        :c
+00002640: 6c61 7373 3a60 6d61 7470 6c6f 746c 6962  lass:`matplotlib
+00002650: 2e46 6967 7572 6560 2063 6c61 7373 2e20  .Figure` class. 
+00002660: 0d0a 0d0a 2020 2020 736e 735f 7374 796c  ....    sns_styl
+00002670: 653a 2073 7472 2c20 6f70 7469 6f6e 616c  e: str, optional
+00002680: 2c20 0d0a 2020 2020 2020 2020 7468 6520  , ..        the 
+00002690: 7365 6162 6f72 6e20 7374 796c 652e 0d0a  seaborn style...
+000026a0: 2020 2020 2020 2020 0d0a 2020 2020 7365          ..    se
+000026b0: 6564 3a20 696e 742c 206f 7074 696f 6e61  ed: int, optiona
+000026c0: 6c20 0d0a 2020 2020 2020 2041 6c6c 6f77  l ..       Allow
+000026d0: 2074 6f20 7265 7072 6f64 7563 6520 7468   to reproduce th
+000026e0: 6520 4d61 7470 6c6f 746c 6962 2e63 6f6c  e Matplotlib.col
+000026f0: 6f72 732e 4353 345f 434f 4c4f 5253 2069  ors.CS4_COLORS i
+00002700: 6620 6063 6f6c 6f72 7360 2069 7320 0d0a  f `colors` is ..
+00002710: 2020 2020 2020 2073 6574 2074 6f20 6060         set to ``
+00002720: 6373 3460 602e 200d 0a20 2020 2020 2020  cs4``. ..       
+00002730: 0d0a 2020 2020 2020 202e 2e20 7665 7273  ..       .. vers
+00002740: 696f 6e61 6464 6564 3a3a 2030 2e32 2e33  ionadded:: 0.2.3
+00002750: 200d 0a20 2020 2020 2020 0d0a 2020 2020   ..       ..    
+00002760: 7665 7262 6f73 653a 2069 6e74 2c20 6465  verbose: int, de
+00002770: 6661 756c 743d 3020 0d0a 2020 2020 2020  fault=0 ..      
+00002780: 2020 4f75 7470 7574 2074 6865 206e 756d    Output the num
+00002790: 6265 7220 6f66 2063 6174 6567 6f72 6961  ber of categoria
+000027a0: 6c20 6665 6174 7572 6573 2064 726f 7070  l features dropp
+000027b0: 6564 2069 6e20 7468 6520 6461 7461 6672  ed in the datafr
+000027c0: 616d 652e 2020 0d0a 2020 2020 2020 2020  ame.  ..        
+000027d0: 0d0a 2020 2020 6b77 733a 2064 6963 742c  ..    kws: dict,
+000027e0: 200d 0a20 2020 2020 2020 2041 6464 6974   ..        Addit
+000027f0: 696f 6e61 6c20 6b65 7977 6f72 6420 6172  ional keyword ar
+00002800: 6775 6d65 6e74 7320 7061 7373 6564 2074  guments passed t
+00002810: 6f20 3a66 756e 633a 606d 6174 706c 6f74  o :func:`matplot
+00002820: 6c69 622e 6178 6573 2e70 6c6f 7460 0d0a  lib.axes.plot`..
+00002830: 2020 2020 2020 2020 0d0a 2020 2020 4578          ..    Ex
+00002840: 616d 706c 6573 0d0a 2020 2020 2d2d 2d2d  amples..    ----
+00002850: 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e 2066  -----..    >>> f
+00002860: 726f 6d20 7761 7465 782e 6461 7461 7365  rom watex.datase
+00002870: 7473 2069 6d70 6f72 7420 6c6f 6164 5f68  ts import load_h
+00002880: 6c6f 6773 200d 0a20 2020 203e 3e3e 2066  logs ..    >>> f
+00002890: 726f 6d20 7761 7465 782e 7574 696c 732e  rom watex.utils.
+000028a0: 706c 6f74 7574 696c 7320 696d 706f 7274  plotutils import
+000028b0: 2070 6c6f 745f 6c6f 6767 696e 670d 0a20   plot_logging.. 
+000028c0: 2020 203e 3e3e 2058 302c 2079 203d 206c     >>> X0, y = l
+000028d0: 6f61 645f 686c 6f67 7320 2861 735f 6672  oad_hlogs (as_fr
+000028e0: 616d 6520 3d54 7275 6529 2023 2067 6574  ame =True) # get
+000028f0: 2074 6865 2066 7261 6d65 7320 7261 7468   the frames rath
+00002900: 6572 2074 6861 6e20 6f62 6a65 6374 200d  er than object .
+00002910: 0a20 2020 203e 3e3e 2023 2070 6c6f 7420  .    >>> # plot 
+00002920: 7468 6520 6465 6661 756c 7420 6c6f 6767  the default logg
+00002930: 696e 6720 7769 7468 204e 6f72 6d61 6c69  ing with Normali
+00002940: 7a65 203d 5472 7565 200d 0a20 2020 203e  ze =True ..    >
+00002950: 3e3e 2070 6c6f 745f 6c6f 6767 696e 6720  >> plot_logging 
+00002960: 2858 302c 206e 6f72 6d61 6c69 7a65 203d  (X0, normalize =
+00002970: 5472 7565 2920 0d0a 2020 2020 3e3e 3e20  True) ..    >>> 
+00002980: 2320 496e 636c 7564 6520 7468 6520 7461  # Include the ta
+00002990: 7267 6574 2069 6e20 7468 6520 706c 6f74  rget in the plot
+000029a0: 200d 0a20 2020 203e 3e3e 2070 6c6f 745f   ..    >>> plot_
+000029b0: 6c6f 6767 696e 6720 2820 5830 2c20 2079  logging ( X0,  y
+000029c0: 203d 2079 2e6b 7020 2c20 706f 7369 7920   = y.kp , posiy 
+000029d0: 3d20 302c 200d 0a20 2020 2020 2020 2020  = 0, ..         
+000029e0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+000029f0: 756d 6e73 5f74 6f5f 736b 6970 3d5b 2774  umns_to_skip=['t
+00002a00: 6869 636b 6e65 7373 272c 2027 7370 275d  hickness', 'sp']
+00002a10: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00002a20: 2020 2020 2020 2020 2020 6c6f 6731 3020            log10 
+00002a30: 3d54 7275 652c 200d 0a20 2020 2020 2020  =True, ..       
+00002a40: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00002a50: 0d0a 2020 2020 3e3e 3e20 2320 6472 6177  ..    >>> # draw
+00002a60: 2073 7069 6e65 7320 616e 6420 6c69 6d69   spines and limi
+00002a70: 7420 706c 6f74 2066 726f 6d20 2830 2c20  t plot from (0, 
+00002a80: 3730 3029 206d 2064 6570 7468 200d 0a20  700) m depth .. 
+00002a90: 2020 203e 3e3e 2070 6c6f 745f 6c6f 6767     >>> plot_logg
+00002aa0: 696e 6720 2858 3020 2c20 793d 2079 2e6b  ing (X0 , y= y.k
+00002ab0: 702c 2064 7261 775f 7370 696e 6573 203d  p, draw_spines =
+00002ac0: 2830 2c20 3730 3029 2029 0d0a 2020 2020  (0, 700) )..    
+00002ad0: 2222 220d 0a20 2020 200d 0a20 2020 2058  """..    ..    X
+00002ae0: 203d 205f 6173 7365 7274 5f61 6c6c 5f74   = _assert_all_t
+00002af0: 7970 6573 2858 2c20 7064 2e44 6174 6146  ypes(X, pd.DataF
+00002b00: 7261 6d65 2c20 7064 2e53 6572 6965 7320  rame, pd.Series 
+00002b10: 2c20 6e70 2e6e 6461 7272 6179 2029 200d  , np.ndarray ) .
+00002b20: 0a20 2020 2058 3d20 6368 6563 6b5f 6172  .    X= check_ar
+00002b30: 7261 7920 280d 0a20 2020 2020 2020 2058  ray (..        X
+00002b40: 2c20 0d0a 2020 2020 2020 2020 6474 7970  , ..        dtyp
+00002b50: 6520 3d6f 626a 6563 742c 200d 0a20 2020  e =object, ..   
+00002b60: 2020 2020 2066 6f72 6365 5f61 6c6c 5f66       force_all_f
+00002b70: 696e 6974 653d 2261 6c6c 6f77 2d6e 616e  inite="allow-nan
+00002b80: 222c 200d 0a20 2020 2020 2020 2069 6e70  ", ..        inp
+00002b90: 7574 5f6e 616d 6520 3d22 4c6f 6767 696e  ut_name ="Loggin
+00002ba0: 6720 6461 7461 7365 7422 2c0d 0a20 2020  g dataset",..   
+00002bb0: 2020 2020 2074 6f5f 6672 616d 6520 3d54       to_frame =T
+00002bc0: 7275 6520 200d 0a20 2020 2020 2020 2029  rue  ..        )
+00002bd0: 0d0a 2020 2020 2320 4469 7363 6172 6420  ..    # Discard 
+00002be0: 616c 6c20 6361 7465 676f 7269 6361 6c20  all categorical 
+00002bf0: 7661 6c75 6573 2061 6e64 200d 0a20 2020  values and ..   
+00002c00: 2023 206b 6565 7020 6f6e 6c79 2074 6865   # keep only the
+00002c10: 206e 756d 6572 6963 616c 2066 6561 7475   numerical featu
+00002c20: 7265 732e 0d0a 2020 2020 2320 6472 6f70  res...    # drop
+00002c30: 2074 6865 2063 6f6d 706c 6574 6520 4e61   the complete Na
+00002c40: 6e20 636f 6c75 6d6e 7320 616e 6420 726f  n columns and ro
+00002c50: 7773 0d0a 2020 2020 5820 3d20 746f 5f6e  ws..    X = to_n
+00002c60: 756d 6572 6963 5f64 7479 7065 7328 582c  umeric_dtypes(X,
+00002c70: 2070 6f70 5f63 6174 5f66 6561 7475 7265   pop_cat_feature
+00002c80: 733d 5472 7565 2c20 7665 7262 6f73 6520  s=True, verbose 
+00002c90: 3d20 7665 7262 6f73 6520 2920 0d0a 0d0a  = verbose ) ....
+00002ca0: 2020 2020 6966 2079 2069 7320 6e6f 7420      if y is not 
+00002cb0: 4e6f 6e65 3a20 0d0a 2020 2020 2020 2069  None: ..       i
+00002cc0: 6620 6973 696e 7374 616e 6365 2028 792c  f isinstance (y,
+00002cd0: 2028 6c69 7374 2c20 7475 706c 6529 293a   (list, tuple)):
+00002ce0: 200d 0a20 2020 2020 2020 2020 2020 2320   ..           # 
+00002cf0: 696e 2074 6865 2063 6173 6520 6120 6c73  in the case a ls
+00002d00: 7420 6973 2067 6976 656e 200d 0a20 2020  t is given ..   
+00002d10: 2020 2020 2020 2020 7920 3d20 6e70 2e61          y = np.a
+00002d20: 7272 6179 2028 7929 200d 0a20 2020 2020  rray (y) ..     
+00002d30: 2020 6966 206e 6f74 2069 735f 6974 6572    if not is_iter
+00002d40: 6162 6c65 2028 7929 3a20 0d0a 2020 2020  able (y): ..    
+00002d50: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00002d60: 6545 7272 6f72 2028 2279 2065 7870 6563  eError ("y expec
+00002d70: 7473 2061 6e20 6974 6572 6162 6c65 206f  ts an iterable o
+00002d80: 626a 6563 742e 220d 0a20 2020 2020 2020  bject."..       
+00002d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002da0: 2020 2020 2020 2066 2220 676f 7420 7b74         f" got {t
+00002db0: 7970 6528 7929 2e5f 5f6e 616d 655f 5f21  ype(y).__name__!
+00002dc0: 727d 2229 0d0a 2020 2020 2020 2079 203d  r}")..       y =
+00002dd0: 205f 6173 7365 7274 5f61 6c6c 5f74 7970   _assert_all_typ
+00002de0: 6573 2879 2c20 7064 2e53 6572 6965 732c  es(y, pd.Series,
+00002df0: 2070 642e 4461 7461 4672 616d 652c 206e   pd.DataFrame, n
+00002e00: 702e 6e64 6172 7261 7929 0d0a 2020 2020  p.ndarray)..    
+00002e10: 2020 200d 0a20 2020 2020 2020 793d 6368     ..       y=ch
+00002e20: 6563 6b5f 7920 280d 0a20 2020 2020 2020  eck_y (..       
+00002e30: 2020 2020 2079 2c20 0d0a 2020 2020 2020       y, ..      
+00002e40: 2020 2020 2020 746f 5f66 7261 6d65 203d        to_frame =
+00002e50: 5472 7565 2c20 0d0a 2020 2020 2020 2020  True, ..        
+00002e60: 2020 2020 616c 6c6f 775f 6e61 6e3d 2054      allow_nan= T
+00002e70: 7275 652c 0d0a 2020 2020 2020 2020 2020  rue,..          
+00002e80: 2020 290d 0a20 2020 2020 2020 0d0a 2020    )..       ..  
+00002e90: 2020 2020 2069 6620 6c65 6e28 7929 2021       if len(y) !
+00002ea0: 3d6c 656e 2858 293a 200d 0a20 2020 2020  =len(X): ..     
+00002eb0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00002ec0: 6545 7272 6f72 2028 2279 2061 6e64 2058  eError ("y and X
+00002ed0: 2073 697a 6573 2061 6c6f 6e67 2061 7869   sizes along axi
+00002ee0: 7320 3020 6d75 7374 2062 6520 636f 6e73  s 0 must be cons
+00002ef0: 6973 7465 6e74 3b22 0d0a 2020 2020 2020  istent;"..      
+00002f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002f10: 2020 2020 2020 2066 2220 7b6c 656e 2879         f" {len(y
+00002f20: 297d 2061 6e64 207b 6c65 6e28 5829 7d20  )} and {len(X)} 
+00002f30: 6172 6520 6769 7665 6e2e 2229 0d0a 2020  are given.")..  
+00002f40: 2020 2320 7265 7475 726e 2058 2061 6e64    # return X and
+00002f50: 2064 6570 7468 200d 0a20 2020 2058 2c20   depth ..    X, 
+00002f60: 6465 7074 6820 3d20 6973 5f64 6570 7468  depth = is_depth
+00002f70: 5f69 6e28 582c 207a 6e61 6d65 206f 7220  _in(X, zname or 
+00002f80: 2764 6570 7468 272c 2063 6f6c 756d 6e73  'depth', columns
+00002f90: 203d 206c 6162 656c 7320 0d0a 2020 2020   = labels ..    
+00002fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002fb0: 2020 2020 2020 2020 290d 0a20 2020 2023          )..    #
+00002fc0: 2066 6574 6368 2074 6172 6765 7420 6966   fetch target if
+00002fd0: 2069 7320 6769 7665 6e20 200d 0a20 2020   is given  ..   
+00002fe0: 2058 2c20 7920 2020 3d20 5f69 735f 7461   X, y   = _is_ta
+00002ff0: 7267 6574 5f69 6e28 582c 2079 203d 2079  rget_in(X, y = y
+00003000: 202c 2074 6e61 6d65 203d 2074 6e61 6d65   , tname = tname
+00003010: 2029 0d0a 2020 2020 0d0a 2020 2020 2320   )..    ..    # 
+00003020: 736b 6970 206c 6f67 3130 2063 6f6c 756d  skip log10 colum
+00003030: 6e73 2069 6620 6c6f 6720 3130 2069 7320  ns if log 10 is 
+00003040: 7365 7420 746f 2054 7275 6520 0d0a 2020  set to True ..  
+00003050: 2020 6966 206c 6f67 3130 3a20 0d0a 2020    if log10: ..  
+00003060: 2020 2020 2020 5820 3d20 5f73 6b69 705f        X = _skip_
+00003070: 6c6f 6731 305f 636f 6c75 6d6e 7320 2858  log10_columns (X
+00003080: 2c20 636f 6c75 6d6e 3273 6b69 7020 3d20  , column2skip = 
+00003090: 636f 6c75 6d6e 735f 746f 5f73 6b69 7020  columns_to_skip 
+000030a0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+000030b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000030c0: 2020 2020 2020 7061 7474 6572 6e3d 2070        pattern= p
+000030d0: 6174 7465 726e 2c20 696e 706c 6163 6520  attern, inplace 
+000030e0: 3d46 616c 7365 2920 0d0a 2020 2020 2320  =False) ..    # 
+000030f0: 6966 206e 6f72 6d61 6c69 7a65 2074 6865  if normalize the
+00003100: 6e20 200d 0a20 2020 2069 6620 6e6f 726d  n  ..    if norm
+00003110: 616c 697a 653a 0d0a 2020 2020 2020 2020  alize:..        
+00003120: 6d73 6320 3d20 4d69 6e4d 6178 5363 616c  msc = MinMaxScal
+00003130: 6572 2829 0d0a 2020 2020 2020 2020 5873  er()..        Xs
+00003140: 6320 3d20 6d73 632e 6669 745f 7472 616e  c = msc.fit_tran
+00003150: 7366 6f72 6d20 2858 290d 0a20 2020 2020  sform (X)..     
+00003160: 2020 2023 2073 6574 2061 206e 6577 2064     # set a new d
+00003170: 6174 6166 7261 6d65 2077 6974 6820 6665  ataframe with fe
+00003180: 6174 7572 6573 0d0a 2020 2020 2020 2020  atures..        
+00003190: 6966 2068 6173 6174 7472 2028 6d73 6320  if hasattr (msc 
+000031a0: 2c20 2766 6561 7475 7265 5f6e 616d 6573  , 'feature_names
+000031b0: 5f69 6e5f 2729 3a20 0d0a 2020 2020 2020  _in_'): ..      
+000031c0: 2020 2020 2020 5820 3d20 7064 2e44 6174        X = pd.Dat
+000031d0: 6146 7261 6d65 2028 5873 6320 2c20 636f  aFrame (Xsc , co
+000031e0: 6c75 6d6e 7320 3d20 6c69 7374 286d 7363  lumns = list(msc
+000031f0: 2e66 6561 7475 7265 5f6e 616d 6573 5f69  .feature_names_i
+00003200: 6e5f 2029 0d0a 2020 2020 2020 2020 2020  n_ )..          
+00003210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003220: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+00003230: 2065 6c73 6520 3a20 5820 3d20 7064 2e44   else : X = pd.D
+00003240: 6174 6146 7261 6d65 2858 7363 2c20 636f  ataFrame(Xsc, co
+00003250: 6c75 6d6e 7320 3d6c 6973 7428 582e 636f  lumns =list(X.co
+00003260: 6c75 6d6e 7320 2929 200d 0a20 2020 2020  lumns )) ..     
+00003270: 2020 2023 2073 6574 2074 6865 2078 2061     # set the x a
+00003280: 7869 7320 616e 6420 6465 6c65 7465 2074  xis and delete t
+00003290: 6865 206e 6f72 6d61 6c69 7a65 2066 726f  he normalize fro
+000032a0: 6d20 5820 0d0a 2020 2020 2020 2020 2320  m X ..        # 
+000032b0: 6174 2069 6e64 6578 2030 2073 7570 706f  at index 0 suppo
+000032c0: 7365 6420 746f 2062 6520 7468 6520 7820  sed to be the x 
+000032d0: 6178 6973 200d 0a20 2020 2020 2020 2023  axis ..        #
+000032e0: 2058 7363 2e69 6c6f 6320 5b3a 2c20 3020   Xsc.iloc [:, 0 
+000032f0: 5d20 3d20 785f 7365 7220 0d0a 2020 2020  ] = x_ser ..    
+00003300: 2020 2020 2320 583d 2058 7363 2e63 6f70      # X= Xsc.cop
+00003310: 7928 2920 200d 0a20 2020 2023 2069 6d70  y()  ..    # imp
+00003320: 7574 655f 6e61 6e20 0d0a 2020 2020 6966  ute_nan ..    if
+00003330: 2069 6d70 7574 655f 6e61 6e3a 200d 0a20   impute_nan: .. 
+00003340: 2020 2020 2020 2023 2063 6865 636b 2077         # check w
+00003350: 6865 7468 6572 2074 6865 7265 2069 7320  hether there is 
+00003360: 6120 4e61 6e20 7661 6c75 6520 2069 6e20  a Nan value  in 
+00003370: 7468 6520 6461 7461 200d 0a20 2020 2020  the data ..     
+00003380: 2020 2023 2069 6d70 7574 6520 6461 7461     # impute data
+00003390: 2075 7369 6e67 206d 6561 6e20 7661 6c75   using mean valu
+000033a0: 6573 0d0a 2020 2020 2020 2020 6966 2058  es..        if X
+000033b0: 2e69 736e 756c 6c28 292e 7661 6c75 6573  .isnull().values
+000033c0: 2e61 6e79 2829 3a20 0d0a 2020 2020 2020  .any(): ..      
+000033d0: 2020 2020 2020 5869 3d20 5369 6d70 6c65        Xi= Simple
+000033e0: 496d 7075 7465 7228 7374 7261 7465 6779  Imputer(strategy
+000033f0: 3d20 7374 7261 7465 6779 2069 6620 6e6f  = strategy if no
+00003400: 7420 6669 6c6c 5f76 616c 7565 2065 6c73  t fill_value els
+00003410: 6520 4e6f 6e65 2c20 0d0a 2020 2020 2020  e None, ..      
+00003420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003430: 2020 2020 2020 2066 696c 6c5f 7661 6c75         fill_valu
+00003440: 653d 2066 696c 6c5f 7661 6c75 650d 0a20  e= fill_value.. 
+00003450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003460: 2020 2020 2020 2020 2020 2020 292e 6669              ).fi
+00003470: 745f 7472 616e 7366 6f72 6d28 5829 0d0a  t_transform(X)..
+00003480: 2020 2020 2020 2020 2020 2020 5820 3d20              X = 
+00003490: 7064 2e44 6174 6146 7261 6d65 2858 692c  pd.DataFrame(Xi,
+000034a0: 2063 6f6c 756d 6e73 3d20 582e 636f 6c75   columns= X.colu
+000034b0: 6d6e 7329 0d0a 2020 2020 2020 2020 2020  mns)..          
+000034c0: 2020 0d0a 2020 2020 2320 746f 6767 6c65    ..    # toggle
+000034d0: 2079 200d 0a20 2020 2069 6620 7920 6973   y ..    if y is
+000034e0: 206e 6f74 204e 6f6e 653a 200d 0a20 2020   not None: ..   
+000034f0: 2020 2020 2058 203d 205f 746f 6767 6c65       X = _toggle
+00003500: 5f74 6172 6765 745f 696e 2858 2c20 792c  _target_in(X, y,
+00003510: 2070 6f73 203d 2070 6f73 6979 290d 0a20   pos = posiy).. 
+00003520: 2020 2020 2020 200d 0a20 2020 2023 6d61         ..    #ma
+00003530: 6e61 6765 2063 6f6c 6f72 7320 616c 6f6e  nage colors alon
+00003540: 6720 636f 6c6f 7273 200d 0a20 2020 2063  g colors ..    c
+00003550: 6f6c 6f72 7320 3d20 6d61 6b65 5f70 6c6f  olors = make_plo
+00003560: 745f 636f 6c6f 7273 2028 0d0a 2020 2020  t_colors (..    
+00003570: 2020 2020 582c 2063 6f6c 6f72 7320 3d20      X, colors = 
+00003580: 636f 6c6f 7273 202c 2061 7869 7320 3d20  colors , axis = 
+00003590: 312c 2073 6565 6420 3d20 7365 6564 202c  1, seed = seed ,
+000035a0: 2063 6875 6e6b 3d46 616c 7365 2029 0d0a   chunk=False )..
+000035b0: 0d0a 2020 2020 6669 672c 2061 7820 3d20  ..    fig, ax = 
+000035c0: 706c 742e 7375 6270 6c6f 7473 2028 312c  plt.subplots (1,
+000035d0: 206e 636f 6c73 203d 2058 2e73 6861 7065   ncols = X.shape
+000035e0: 205b 315d 2c20 7368 6172 6579 203d 2054   [1], sharey = T
+000035f0: 7275 6520 2c20 0d0a 2020 2020 2020 2020  rue , ..        
+00003600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003610: 2020 2020 6669 6773 697a 6520 3d20 6669      figsize = fi
+00003620: 675f 7369 7a65 2029 0d0a 2020 2020 0d0a  g_size )..    ..
+00003630: 2020 2020 2320 6375 7374 6f6d 697a 6520      # customize 
+00003640: 626f 756e 6420 616e 6420 7365 7420 7370  bound and set sp
+00003650: 696e 6573 200d 0a20 2020 2066 6f72 206b  ines ..    for k
+00003660: 2069 6e20 7261 6e67 6520 2858 2e73 6861   in range (X.sha
+00003670: 7065 205b 315d 293a 200d 0a20 2020 2020  pe [1]): ..     
+00003680: 0d0a 2020 2020 2020 2020 6178 5b6b 5d2e  ..        ax[k].
+00003690: 706c 6f74 2028 2058 2e69 6c6f 635b 3a2c  plot ( X.iloc[:,
+000036a0: 206b 5d2c 200d 0a20 2020 2020 2020 2020   k], ..         
+000036b0: 2020 2020 2020 2020 2020 2064 6570 7468             depth
+000036c0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+000036d0: 2020 2020 2020 2020 636f 6c6f 7220 3d20          color = 
+000036e0: 636f 6c6f 7273 5b6b 5d2c 200d 0a20 2020  colors[k], ..   
+000036f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003700: 202a 2a6b 7773 0d0a 2020 2020 2020 2020   **kws..        
+00003710: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00003720: 2020 2020 2020 2061 785b 6b5d 2e74 6963         ax[k].tic
+00003730: 6b5f 7061 7261 6d73 2874 6f70 3d54 7275  k_params(top=Tru
+00003740: 652c 200d 0a20 2020 2020 2020 2020 2020  e, ..           
+00003750: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00003760: 6162 656c 746f 703d 5472 7565 2c20 0d0a  abeltop=True, ..
+00003770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003780: 2020 2020 2020 2020 2020 626f 7474 6f6d            bottom
+00003790: 3d46 616c 7365 2c20 0d0a 2020 2020 2020  =False, ..      
+000037a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000037b0: 2020 2020 6c61 6265 6c62 6f74 746f 6d3d      labelbottom=
+000037c0: 4661 6c73 650d 0a20 2020 2020 2020 2020  False..         
+000037d0: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+000037e0: 0a20 2020 2020 2020 2061 785b 6b5d 2e73  .        ax[k].s
+000037f0: 6574 5f74 6974 6c65 2028 582e 636f 6c75  et_title (X.colu
+00003800: 6d6e 7320 5b6b 5d29 0d0a 2020 2020 2020  mns [k])..      
+00003810: 2020 6178 5b6b 5d2e 7370 696e 6573 5b27    ax[k].spines['
+00003820: 7269 6768 7427 5d2e 7365 745f 7669 7369  right'].set_visi
+00003830: 626c 6528 4661 6c73 6529 0d0a 2020 2020  ble(False)..    
+00003840: 2020 2020 6178 5b6b 5d2e 7370 696e 6573      ax[k].spines
+00003850: 5b27 626f 7474 6f6d 275d 2e73 6574 5f76  ['bottom'].set_v
+00003860: 6973 6962 6c65 2846 616c 7365 290d 0a20  isible(False).. 
+00003870: 2020 2020 2020 2023 206f 6e6c 7920 7368         # only sh
+00003880: 6f77 2074 6963 6b20 6f6e 2074 6865 2074  ow tick on the t
+00003890: 6f70 2061 6e64 206c 6566 7420 0d0a 2020  op and left ..  
+000038a0: 2020 2020 2020 6178 5b6b 5d2e 7861 7869        ax[k].xaxi
+000038b0: 732e 7365 745f 7469 636b 735f 706f 7369  s.set_ticks_posi
+000038c0: 7469 6f6e 2827 746f 7027 290d 0a20 2020  tion('top')..   
+000038d0: 2020 2020 2069 6620 7920 6973 206e 6f74       if y is not
+000038e0: 204e 6f6e 653a 200d 0a20 2020 2020 2020   None: ..       
+000038f0: 2020 2020 2023 206d 616b 6520 5820 6178       # make X ax
+00003900: 6973 206f 6620 7468 6520 7461 7267 6574  is of the target
+00003910: 2074 6f20 7265 6420 0d0a 2020 2020 2020   to red ..      
+00003920: 2020 2020 2020 2320 666f 7220 6469 6666        # for diff
+00003930: 6572 656e 6369 6174 696f 6e20 6672 6f6d  erenciation from
+00003940: 2066 6561 7475 7265 732e 200d 0a20 2020   features. ..   
+00003950: 2020 2020 2020 2020 2069 6620 582e 636f           if X.co
+00003960: 6c75 6d6e 7320 5b6b 5d20 3d3d 792e 6e61  lumns [k] ==y.na
+00003970: 6d65 3a20 0d0a 2020 2020 2020 2020 2020  me: ..          
+00003980: 2020 2020 2020 6178 5b6b 5d2e 7370 696e        ax[k].spin
+00003990: 6573 5b27 746f 7027 5d2e 7365 745f 636f  es['top'].set_co
+000039a0: 6c6f 7228 2772 6564 2729 2020 0d0a 2020  lor('red')  ..  
+000039b0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+000039c0: 2069 6620 6472 6177 5f73 7069 6e65 733a   if draw_spines:
+000039d0: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
+000039e0: 204f 6e6c 7920 6472 6177 2073 7069 6e65   Only draw spine
+000039f0: 2062 6574 7765 656e 2074 6865 2079 2d74   between the y-t
+00003a00: 6963 6b73 0d0a 2020 2020 2020 2020 2020  icks..          
+00003a10: 2020 6966 2069 735f 6974 6572 6162 6c65    if is_iterable
+00003a20: 2864 7261 775f 7370 696e 6573 293a 200d  (draw_spines): .
+00003a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003a40: 2023 2066 6f72 2063 6f6e 7369 7374 656e   # for consisten
+00003a50: 6379 2063 6865 636b 2077 6865 7468 6572  cy check whether
+00003a60: 2076 616c 7565 7320 0d0a 2020 2020 2020   values ..      
+00003a70: 2020 2020 2020 2020 2020 2320 6172 6520            # are 
+00003a80: 6e75 6d65 7269 630d 0a20 2020 2020 2020  numeric..       
+00003a90: 2020 2020 2020 2020 2064 7261 775f 7370           draw_sp
+00003aa0: 696e 6573 203d 2073 6f72 7465 6420 280d  ines = sorted (.
+00003ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003ac0: 2020 2020 206c 6973 7428 6d61 7020 286c       list(map (l
+00003ad0: 616d 6264 6120 783a 2066 6c6f 6174 2028  ambda x: float (
+00003ae0: 7829 202c 2064 7261 775f 7370 696e 6573  x) , draw_spines
+00003af0: 5b3a 325d 2929 200d 0a20 2020 2020 2020  [:2])) ..       
+00003b00: 2020 2020 2020 2020 2020 2020 2029 200d               ) .
+00003b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003b20: 2069 6620 6c65 6e28 6472 6177 5f73 7069   if len(draw_spi
+00003b30: 6e65 7329 203c 323a 200d 0a20 2020 2020  nes) <2: ..     
+00003b40: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00003b50: 6172 6e69 6e67 732e 7761 726e 280d 0a20  arnings.warn(.. 
+00003b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b70: 2020 2020 2020 2022 5370 696e 6520 626f         "Spine bo
+00003b80: 756e 6473 2069 7320 6120 7475 706c 6520  unds is a tuple 
+00003b90: 6f66 2028 7374 6172 7470 6f69 6e74 2c20  of (startpoint, 
+00003ba0: 656e 6470 6f69 6e74 2922 0d0a 2020 2020  endpoint)"..    
 00003bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003bc0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00003bd0: 6c73 653a 200d 0a20 2020 2020 2020 2020  lse: ..         
-00003be0: 2020 2020 2020 2023 2069 6e20 6361 7365         # in case
-00003bf0: 206f 6e6c 7920 5472 7565 2069 7320 6769   only True is gi
-00003c00: 7665 6e20 0d0a 2020 2020 2020 2020 2020  ven ..          
-00003c10: 2020 2020 2020 2320 7573 6520 7468 6520        # use the 
-00003c20: 6465 6661 756c 7420 706c 6f74 0d0a 2020  default plot..  
-00003c30: 2020 2020 2020 2020 2020 2020 2020 7974                yt
-00003c40: 763d 2061 785b 305d 2e67 6574 5f79 7469  v= ax[0].get_yti
-00003c50: 636b 7320 2829 200d 0a20 2020 2020 2020  cks () ..       
-00003c60: 2020 2020 2020 2020 2073 7061 6369 6e67           spacing
-00003c70: 203d 2028 7974 765b 2d31 5d20 2d20 7974   = (ytv[-1] - yt
-00003c80: 765b 305d 2029 2f28 6c65 6e28 7974 7629  v[0] )/(len(ytv)
-00003c90: 2d31 2920 0d0a 2020 2020 2020 2020 2020  -1) ..          
-00003ca0: 2020 2020 2020 2320 636f 6d6d 6f6e 6c79        # commonly
-00003cb0: 206d 6174 706c 6f74 6c69 6220 6178 6973   matplotlib axis
-00003cc0: 2065 7874 7261 706f 6c65 6420 7468 6520   extrapoled the 
-00003cd0: 6c69 6d69 7420 736f 200d 0a20 2020 2020  limit so ..     
-00003ce0: 2020 2020 2020 2020 2020 2023 2073 7461             # sta
-00003cf0: 7274 2077 6974 6820 7468 6520 6669 7273  rt with the firs
-00003d00: 7420 616e 6420 6c61 7374 2069 6e64 6578  t and last index
-00003d10: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00003d20: 2020 2064 7261 775f 7370 696e 6573 3d20     draw_spines= 
-00003d30: 2028 7974 765b 305d 202b 2073 7061 6369   (ytv[0] + spaci
-00003d40: 6e67 2f32 202c 2079 7476 5b2d 315d 202d  ng/2 , ytv[-1] -
-00003d50: 2073 7061 6369 6e67 2f32 2029 200d 0a20   spacing/2 ) .. 
-00003d60: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-00003d70: 0a20 2020 2020 2020 2020 2020 2061 785b  .            ax[
-00003d80: 6b5d 2e73 7069 6e65 735b 276c 6566 7427  k].spines['left'
-00003d90: 5d2e 7365 745f 626f 756e 6473 282a 6472  ].set_bounds(*dr
-00003da0: 6177 5f73 7069 6e65 7320 290d 0a20 2020  aw_spines )..   
-00003db0: 2020 0d0a 2020 2020 2320 7365 7420 6c61    ..    # set la
-00003dc0: 6265 6c73 0d0a 2020 2020 6178 5b30 5d2e  bels..    ax[0].
-00003dd0: 7365 745f 796c 6162 656c 2028 2244 6570  set_ylabel ("Dep
-00003de0: 7468 2028 6d29 2229 0d0a 2020 2020 2020  th (m)")..      
-00003df0: 2020 2320 5477 6561 6b20 7370 6163 696e    # Tweak spacin
-00003e00: 6720 6265 7477 6565 6e20 7375 6270 6c6f  g between subplo
-00003e10: 7473 2074 6f20 7072 6576 656e 7420 6c61  ts to prevent la
-00003e20: 6265 6c73 200d 0a20 2020 2020 2020 2023  bels ..        #
-00003e30: 2066 726f 6d20 6f76 6572 6c61 7070 696e   from overlappin
-00003e40: 6720 0d0a 2020 2020 2020 2020 2320 706c  g ..        # pl
-00003e50: 742e 7375 6270 6c6f 7473 5f61 646a 7573  t.subplots_adjus
-00003e60: 7428 6873 7061 6365 3d30 2e35 292d 3e20  t(hspace=0.5)-> 
-00003e70: 7265 6d6f 7665 640d 0a20 2020 2070 6c74  removed..    plt
-00003e80: 2e67 6361 2829 2e69 6e76 6572 745f 7961  .gca().invert_ya
-00003e90: 7869 7328 290d 0a20 2020 200d 0a20 2020  xis()..    ..   
-00003ea0: 2069 6620 7361 7665 6669 6720 6973 206e   if savefig is n
-00003eb0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-00003ec0: 2020 706c 742e 7361 7665 6669 6728 7361    plt.savefig(sa
-00003ed0: 7665 6669 672c 2064 7069 203d 2066 6967  vefig, dpi = fig
-00003ee0: 5f64 7069 2029 0d0a 2020 2020 2020 2020  _dpi )..        
-00003ef0: 0d0a 2020 2020 706c 742e 636c 6f73 6520  ..    plt.close 
-00003f00: 2829 2069 6620 7361 7665 6669 6720 6973  () if savefig is
-00003f10: 206e 6f74 204e 6f6e 6520 656c 7365 2070   not None else p
-00003f20: 6c74 2e73 686f 7728 2920 0d0a 2020 2020  lt.show() ..    
-00003f30: 0d0a 6465 6620 6d61 6b65 5f70 6c6f 745f  ..def make_plot_
-00003f40: 636f 6c6f 7273 2864 202c 202f 202c 2063  colors(d , / , c
-00003f50: 6f6c 6f72 733a 7374 7220 7c20 6c69 7374  olors:str | list
-00003f60: 5b73 7472 5d3d 4e6f 6e65 202c 2061 7869  [str]=None , axi
-00003f70: 733a 696e 7420 3d20 302c 200d 0a20 2020  s:int = 0, ..   
-00003f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003f90: 2020 7365 6564 3a69 6e74 2020 3d4e 6f6e    seed:int  =Non
-00003fa0: 652c 2063 6875 6e6b 3a62 6f6f 6c20 3d2e  e, chunk:bool =.
-00003fb0: 2e2e 2029 3a20 0d0a 2020 2020 2222 2220  .. ): ..    """ 
-00003fc0: 5365 6c65 6374 2063 6f6c 6f72 7320 6163  Select colors ac
-00003fd0: 636f 7264 696e 6720 746f 2074 6865 2064  cording to the d
-00003fe0: 6174 6120 7369 7a65 2061 6c6f 6e67 2061  ata size along a
-00003ff0: 7869 7320 0d0a 2020 2020 0d0a 2020 2020  xis ..    ..    
-00004000: 5061 7261 6d65 7465 7273 200d 0a20 2020  Parameters ..   
-00004010: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00004020: 2064 3a20 4172 7261 796c 696b 6520 0d0a   d: Arraylike ..
-00004030: 2020 2020 2020 2041 7272 6179 2064 6174         Array dat
-00004040: 6120 746f 2073 656c 6563 7420 636f 6c6f  a to select colo
-00004050: 7273 2061 6363 6f72 6469 6e67 2074 6f20  rs according to 
-00004060: 7468 6520 6178 6973 200d 0a20 2020 2063  the axis ..    c
-00004070: 6f6c 6f72 733a 2073 7472 2c20 6c69 7374  olors: str, list
-00004080: 206f 6620 4d61 7470 6c6f 746c 6962 2e63   of Matplotlib.c
-00004090: 6f6c 6f72 7320 6d61 702c 206f 7074 696f  olors map, optio
-000040a0: 6e61 6c20 0d0a 2020 2020 2020 2020 5468  nal ..        Th
-000040b0: 6520 636f 6c6f 7273 2066 6f72 2070 6c6f  e colors for plo
-000040c0: 7474 696e 6720 6561 6368 2063 6f6c 756d  tting each colum
-000040d0: 6e73 206f 6620 6058 6020 6578 6365 7074  ns of `X` except
-000040e0: 2074 6865 2064 6570 7468 2e20 4966 206e   the depth. If n
-000040f0: 6f74 0d0a 2020 2020 2020 2020 6769 7665  ot..        give
-00004100: 6e2c 2064 6566 6175 6c74 2063 6f6c 6f72  n, default color
-00004110: 7320 6172 6520 6175 746f 2d67 656e 6572  s are auto-gener
-00004120: 6174 6564 2e0d 0a20 2020 2020 2020 2049  ated...        I
-00004130: 6620 6063 6f6c 6f72 7360 2069 7320 7374  f `colors` is st
-00004140: 7269 6e67 2061 6e64 2027 6373 3427 6f72  ring and 'cs4'or
-00004150: 2027 786b 6364 2720 6973 2069 6e63 6c75   'xkcd' is inclu
-00004160: 6465 642e 200d 0a20 2020 2020 2020 204d  ded. ..        M
-00004170: 6174 706c 6f74 6c69 622e 636f 6c6f 7273  atplotlib.colors
-00004180: 2e43 5334 5f43 4f4c 4f52 5320 6f72 204d  .CS4_COLORS or M
-00004190: 6174 706c 6f74 6c69 622e 636f 6c6f 7273  atplotlib.colors
-000041a0: 2e58 4b43 445f 434f 4c4f 5253 200d 0a20  .XKCD_COLORS .. 
-000041b0: 2020 2020 2020 2073 686f 756c 6420 6265         should be
-000041c0: 2075 7365 6420 696e 7374 6561 642e 2049   used instead. I
-000041d0: 6e20 6164 6469 7469 6f6e 2069 6620 7468  n addition if th
-000041e0: 6520 6027 6373 3427 6020 6f72 2060 2778  e `'cs4'` or `'x
-000041f0: 6b63 6427 6020 6973 2020 0d0a 2020 2020  kcd'` is  ..    
-00004200: 2020 2020 7375 6666 6978 6564 2062 7920      suffixed by 
-00004210: 636f 6c6f 6e73 2061 6e64 2069 6e74 6567  colons and integ
-00004220: 6572 2076 616c 7565 206c 696b 6520 6060  er value like ``
-00004230: 6373 343a 3460 6020 6f72 2060 6078 6b63  cs4:4`` or ``xkc
-00004240: 643a 3460 602c 2074 6865 200d 0a20 2020  d:4``, the ..   
-00004250: 2020 2020 2043 5334 206f 7220 584b 4344       CS4 or XKCD
-00004260: 2063 6f6c 6f72 7320 7368 6f75 6c64 2062   colors should b
-00004270: 6520 7573 6564 2066 726f 6d20 696e 6465  e used from inde
-00004280: 7820 6571 7561 6c73 2074 6f20 6060 3460  x equals to ``4`
-00004290: 602e 200d 0a20 2020 2020 2020 200d 0a20  `. ..        .. 
-000042a0: 2020 2020 2020 202e 2e20 7665 7273 696f         .. versio
-000042b0: 6e61 6464 6564 3a3a 2030 2e32 2e33 200d  nadded:: 0.2.3 .
-000042c0: 0a20 2020 2020 2020 2020 2020 4d61 7470  .           Matp
-000042d0: 6c6f 746c 6962 2e63 6f6c 6f72 732e 4353  lotlib.colors.CS
-000042e0: 345f 434f 4c4f 5253 206f 7220 4d61 7470  4_COLORS or Matp
-000042f0: 6c6f 746c 6962 2e63 6f6c 6f72 732e 584b  lotlib.colors.XK
-00004300: 4344 5f43 4f4c 4f52 5320 6361 6e20 0d0a  CD_COLORS can ..
-00004310: 2020 2020 2020 2020 2020 2062 6520 7573             be us
-00004320: 6564 2062 7920 7365 7474 696e 6720 6063  ed by setting `c
-00004330: 6f6c 6f72 7360 2074 6f20 6060 2763 7334  olors` to ``'cs4
-00004340: 2760 6020 6f72 2060 6027 786b 6364 2760  '`` or ``'xkcd'`
-00004350: 602e 2054 6f20 7265 7072 6f64 7563 6520  `. To reproduce 
-00004360: 0d0a 2020 2020 2020 2020 2020 2074 6865  ..           the
-00004370: 2073 616d 6520 4353 3420 6f72 2058 4b43   same CS4 or XKC
-00004380: 4420 636f 6c6f 7273 2c20 7365 7420 7468  D colors, set th
-00004390: 6520 6073 6565 6460 2070 6172 616d 6574  e `seed` paramet
-000043a0: 6572 2074 6f20 6120 0d0a 2020 2020 2020  er to a ..      
-000043b0: 2020 2020 2073 7065 6369 6669 6320 7661       specific va
-000043c0: 6c75 652e 200d 0a20 2020 2020 2020 2020  lue. ..         
-000043d0: 2020 0d0a 2020 2020 6178 6973 3a20 696e    ..    axis: in
-000043e0: 742c 2064 6566 6175 6c74 3d30 200d 0a20  t, default=0 .. 
-000043f0: 2020 2020 2020 4178 6973 2061 6c6f 6e67        Axis along
-00004400: 2077 6974 6820 7468 6520 636f 6c6f 7273   with the colors
-00004410: 206d 7573 7420 6265 2067 656e 6572 6174   must be generat
-00004420: 6564 2e20 4279 2064 6566 6175 6c74 2063  ed. By default c
-00004430: 6f6c 6f72 7320 6973 200d 0a20 2020 2020  olors is ..     
-00004440: 2020 6765 6e65 7261 7465 6420 616c 6f6e    generated alon
-00004450: 6720 7468 6520 726f 7720 6178 6973 200d  g the row axis .
-00004460: 0a20 2020 2020 2020 0d0a 2020 2020 7365  .       ..    se
-00004470: 6564 3a20 696e 742c 206f 7074 696f 6e61  ed: int, optiona
-00004480: 6c20 0d0a 2020 2020 2020 2041 6c6c 6f77  l ..       Allow
-00004490: 2074 6f20 7265 7072 6f64 7563 6520 7468   to reproduce th
-000044a0: 6520 4d61 7470 6c6f 746c 6962 2e63 6f6c  e Matplotlib.col
-000044b0: 6f72 732e 4353 345f 434f 4c4f 5253 2069  ors.CS4_COLORS i
-000044c0: 6620 6063 6f6c 6f72 7360 2069 7320 0d0a  f `colors` is ..
-000044d0: 2020 2020 2020 2073 6574 2074 6f20 6060         set to ``
-000044e0: 6373 3460 602e 200d 0a20 2020 2020 2020  cs4``. ..       
-000044f0: 0d0a 2020 2020 6368 756e 6b3a 2062 6f6f  ..    chunk: boo
-00004500: 6c2c 2064 6566 6175 6c74 3d54 7275 6520  l, default=True 
-00004510: 0d0a 2020 2020 2020 2043 6875 6e6b 2067  ..       Chunk g
-00004520: 656e 6572 6174 6564 2063 6f6c 6f72 7320  enerated colors 
-00004530: 746f 2066 6974 2074 6865 2065 7861 6374  to fit the exact
-00004540: 206c 656e 6774 6820 6f66 2074 6865 2060   length of the `
-00004550: 6460 2073 697a 6520 0d0a 2020 2020 2020  d` size ..      
-00004560: 200d 0a20 2020 2052 6574 7572 6e73 200d   ..    Returns .
-00004570: 0a20 2020 202d 2d2d 2d2d 2d2d 0d0a 2020  .    -------..  
-00004580: 2020 636f 6c6f 7273 3a20 6c69 7374 200d    colors: list .
-00004590: 0a20 2020 2020 2020 4c69 7374 206f 6620  .       List of 
-000045a0: 6e65 7720 6765 6e65 7261 7465 6420 636f  new generated co
-000045b0: 6c6f 7273 200d 0a20 2020 2020 2020 0d0a  lors ..       ..
-000045c0: 2020 2020 4578 616d 706c 6573 200d 0a20      Examples .. 
-000045d0: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
-000045e0: 203e 3e3e 2069 6d70 6f72 7420 6e75 6d70   >>> import nump
-000045f0: 7920 6173 206e 7020 0d0a 2020 2020 3e3e  y as np ..    >>
-00004600: 3e20 6672 6f6d 2077 6174 6578 2e75 7469  > from watex.uti
-00004610: 6c73 2e70 6c6f 7475 7469 6c73 2069 6d70  ls.plotutils imp
-00004620: 6f72 7420 6d61 6b65 5f70 6c6f 745f 636f  ort make_plot_co
-00004630: 6c6f 7273 0d0a 2020 2020 3e3e 3e20 6172  lors..    >>> ar
-00004640: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
-00004650: 646e 2028 372c 2032 2920 0d0a 2020 2020  dn (7, 2) ..    
-00004660: 3e3e 3e20 6d61 6b65 5f70 6c6f 745f 636f  >>> make_plot_co
-00004670: 6c6f 7273 2028 6172 2029 0d0a 2020 2020  lors (ar )..    
-00004680: 5b27 6727 2c20 2767 7261 7927 2c20 2779  ['g', 'gray', 'y
-00004690: 272c 2027 626c 7565 272c 2027 6f72 616e  ', 'blue', 'oran
-000046a0: 6765 272c 2027 7075 7270 6c65 272c 2027  ge', 'purple', '
-000046b0: 6c69 6d65 275d 0d0a 2020 2020 3e3e 3e20  lime']..    >>> 
-000046c0: 6d61 6b65 5f70 6c6f 745f 636f 6c6f 7273  make_plot_colors
-000046d0: 2028 6172 202c 2061 7869 7320 3d31 2029   (ar , axis =1 )
-000046e0: 200d 0a20 2020 204f 7574 5b36 5d3a 205b   ..    Out[6]: [
-000046f0: 2767 272c 2027 6772 6179 275d 0d0a 2020  'g', 'gray']..  
-00004700: 2020 3e3e 3e20 6d61 6b65 5f70 6c6f 745f    >>> make_plot_
-00004710: 636f 6c6f 7273 2028 6172 202c 2061 7869  colors (ar , axi
-00004720: 7320 3d31 202c 2063 6f6c 6f72 7320 3d27  s =1 , colors ='
-00004730: 6373 3427 290d 0a20 2020 205b 2723 4630  cs4')..    ['#F0
-00004740: 4638 4646 272c 2027 2346 4145 4244 3727  F8FF', '#FAEBD7'
-00004750: 5d0d 0a20 2020 203e 3e3e 206c 656e 286d  ]..    >>> len(m
-00004760: 616b 655f 706c 6f74 5f63 6f6c 6f72 7320  ake_plot_colors 
-00004770: 2861 7220 2c20 6178 6973 203d 3120 2c20  (ar , axis =1 , 
-00004780: 636f 6c6f 7273 203d 2763 7334 272c 2063  colors ='cs4', c
-00004790: 6875 6e6b 3d46 616c 7365 2929 0d0a 2020  hunk=False))..  
-000047a0: 2020 3135 300d 0a20 2020 203e 3e3e 206d    150..    >>> m
-000047b0: 616b 655f 706c 6f74 5f63 6f6c 6f72 7320  ake_plot_colors 
-000047c0: 2861 7220 2c20 6178 6973 203d 3120 2c20  (ar , axis =1 , 
-000047d0: 636f 6c6f 7273 203d 2763 7334 3a34 2729  colors ='cs4:4')
-000047e0: 0d0a 2020 2020 5b27 2346 3046 4646 4627  ..    ['#F0FFFF'
-000047f0: 2c20 2723 4635 4635 4443 275d 0d0a 2020  , '#F5F5DC']..  
-00004800: 2020 2222 220d 0a20 2020 200d 0a20 2020    """..    ..   
-00004810: 2023 2067 6574 2074 6865 2064 6174 6120   # get the data 
-00004820: 7369 7a65 2077 6865 7265 2063 6f6c 6f72  size where color
-00004830: 7320 6d75 7374 2062 6520 6669 7474 6564  s must be fitted
-00004840: 2e20 0d0a 2020 2020 2320 6e6f 7465 2063  . ..    # note c
-00004850: 6f6c 6f72 7320 7368 6f75 6c64 206d 6174  olors should mat
-00004860: 6368 2065 6974 6865 7220 7468 6520 726f  ch either the ro
-00004870: 7720 6178 6973 206f 7220 636f 6c75 726d  w axis or colurm
-00004880: 7320 6178 6973 200d 0a20 2020 2061 7869  s axis ..    axi
-00004890: 7320 3d20 7374 7228 6178 6973 292e 6c6f  s = str(axis).lo
-000048a0: 7765 7228 2920 0d0a 2020 2020 6966 2027  wer() ..    if '
-000048b0: 636f 6c75 6d6e 7331 272e 6669 6e64 2028  columns1'.find (
-000048c0: 6178 6973 293e 3d30 3a20 0d0a 2020 2020  axis)>=0: ..    
-000048d0: 2020 2020 6178 6973 203d 3120 0d0a 2020      axis =1 ..  
-000048e0: 2020 656c 7365 3a20 6178 6973 203d 300d    else: axis =0.
-000048f0: 0a20 2020 200d 0a20 2020 2023 206d 616e  .    ..    # man
-00004900: 6167 6520 7468 6520 6172 7261 7920 0d0a  age the array ..
-00004910: 2020 2020 643d 2069 735f 6974 6572 6162      d= is_iterab
-00004920: 6c65 2820 642c 2065 7863 6c75 6465 5f73  le( d, exclude_s
-00004930: 7472 696e 673d 5472 7565 2c20 7472 616e  tring=True, tran
-00004940: 7366 6f72 6d3d 5472 7565 290d 0a20 2020  sform=True)..   
-00004950: 2069 6620 6e6f 7420 6861 7361 7474 7220   if not hasattr 
-00004960: 2864 2c20 275f 5f61 7272 6179 5f5f 2729  (d, '__array__')
-00004970: 3a20 0d0a 2020 2020 2020 2020 6420 3d20  : ..        d = 
-00004980: 6e70 2e61 7272 6179 2864 2029 200d 0a20  np.array(d ) .. 
-00004990: 2020 200d 0a20 2020 2061 7869 735f 6c65     ..    axis_le
-000049a0: 6e67 7468 203d 206c 656e 2864 2920 6966  ngth = len(d) if
-000049b0: 206c 656e 2864 2e73 6861 7065 2029 3d3d   len(d.shape )==
-000049c0: 3120 656c 7365 2064 2e73 6861 7065 205b  1 else d.shape [
-000049d0: 6178 6973 5d0d 0a20 2020 206d 5f63 7320  axis]..    m_cs 
-000049e0: 3d20 6d61 6b65 5f6d 706c 5f70 726f 7065  = make_mpl_prope
-000049f0: 7274 6965 7328 6178 6973 5f6c 656e 6774  rties(axis_lengt
-00004a00: 6820 290d 0a20 2020 200d 0a20 2020 2020  h )..    ..     
-00004a10: 236d 616e 6167 6520 636f 6c6f 7273 200d  #manage colors .
-00004a20: 0a20 2020 2023 2077 6520 6173 7375 6d65  .    # we assume
-00004a30: 2074 6865 2066 6972 7374 2063 6f6c 756d   the first colum
-00004a40: 6e73 2069 7320 6465 6469 6361 7465 6420  ns is dedicated 
-00004a50: 666f 7220 0d0a 2020 2020 6966 2063 6f6c  for ..    if col
-00004a60: 6f72 7320 3d3d 2e2e 2e3a 2063 6f6c 6f72  ors ==...: color
-00004a70: 7320 3d4e 6f6e 6520 0d0a 2020 2020 6966  s =None ..    if
-00004a80: 2028 200d 0a20 2020 2020 2020 2020 2020   ( ..           
-00004a90: 2069 7369 6e73 7461 6e63 6520 2863 6f6c   isinstance (col
-00004aa0: 6f72 732c 2073 7472 2920 616e 6420 0d0a  ors, str) and ..
-00004ab0: 2020 2020 2020 2020 2020 2020 2820 0d0a              ( ..
-00004ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ad0: 2263 7334 2220 696e 2073 7472 2863 6f6c  "cs4" in str(col
-00004ae0: 6f72 7329 2e6c 6f77 6572 2829 200d 0a20  ors).lower() .. 
-00004af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004b00: 6f72 2027 786b 6364 2720 696e 2073 7472  or 'xkcd' in str
-00004b10: 2863 6f6c 6f72 7329 2e6c 6f77 6572 2829  (colors).lower()
-00004b20: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00004b30: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
-00004b40: 2020 2029 3a20 0d0a 2020 2020 2020 2020     ): ..        
-00004b50: 2369 6e69 7469 6c69 7a65 2063 6f6c 6f72  #initilize color
-00004b60: 7320 696e 666f 730d 0a20 2020 2020 2020  s infos..       
-00004b70: 2063 203d 2063 6f70 792e 6465 6570 636f   c = copy.deepco
-00004b80: 7079 2863 6f6c 6f72 7329 0d0a 2020 2020  py(colors)..    
-00004b90: 2020 2020 6966 2027 6373 3427 2069 6e20      if 'cs4' in 
-00004ba0: 7374 7228 636f 6c6f 7273 292e 6c6f 7765  str(colors).lowe
-00004bb0: 7228 2920 3a20 0d0a 2020 2020 2020 2020  r() : ..        
-00004bc0: 2020 2020 4443 4f4c 4f52 5320 3d20 6d63      DCOLORS = mc
-00004bd0: 6f6c 6f72 732e 4353 5334 5f43 4f4c 4f52  olors.CSS4_COLOR
-00004be0: 530d 0a20 2020 2020 2020 2065 6c73 653a  S..        else:
-00004bf0: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
-00004c00: 2072 656d 616b 6520 7468 6520 6463 6f6c   remake the dcol
-00004c10: 6f72 7320 6d79 2072 656d 6f76 696e 6720  ors my removing 
-00004c20: 7468 6520 786b 6364 3a20 696e 2074 6865  the xkcd: in the
-00004c30: 206b 6579 733a 200d 0a20 2020 2020 2020   keys: ..       
-00004c40: 2020 2020 2044 434f 4c4f 5253 203d 2064       DCOLORS = d
-00004c50: 6963 7428 2820 286b 2e72 6570 6c61 6365  ict(( (k.replace
-00004c60: 2028 2778 6b63 643a 272c 2027 2729 2c20   ('xkcd:', ''), 
-00004c70: 6329 200d 0a20 2020 2020 2020 2020 2020  c) ..           
-00004c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004c90: 2066 6f72 206b 2c20 6320 696e 206d 636f   for k, c in mco
-00004ca0: 6c6f 7273 2e58 4b43 445f 434f 4c4f 5253  lors.XKCD_COLORS
-00004cb0: 2e69 7465 6d73 2829 2929 2020 0d0a 2020  .items()))  ..  
-00004cc0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00004cd0: 6b65 795f 636f 6c6f 7273 203d 206c 6973  key_colors = lis
-00004ce0: 7428 4443 4f4c 4f52 532e 6b65 7973 2028  t(DCOLORS.keys (
-00004cf0: 2929 0d0a 2020 2020 2020 2020 636f 6c6f  ))..        colo
-00004d00: 7273 203d 206c 6973 7428 4443 4f4c 4f52  rs = list(DCOLOR
-00004d10: 532e 7661 6c75 6573 2829 2029 0d0a 2020  S.values() )..  
-00004d20: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00004d30: 7368 7566 666c 655f 6373 343d 5472 7565  shuffle_cs4=True
-00004d40: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00004d50: 2020 2020 2063 7334 5f73 7461 7274 3d20       cs4_start= 
-00004d60: 4e6f 6e65 0d0a 2020 2020 2020 2020 232d  None..        #-
-00004d70: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2069  -----..        i
-00004d80: 6620 273a 2720 696e 2073 7472 2863 292e  f ':' in str(c).
-00004d90: 6c6f 7765 7228 293a 0d0a 2020 2020 2020  lower():..      
-00004da0: 2020 2020 2020 6373 345f 7374 6172 7420        cs4_start 
-00004db0: 3d20 7374 7228 6329 2e6c 6f77 6572 2829  = str(c).lower()
-00004dc0: 2e73 706c 6974 2827 3a27 295b 2d31 5d0d  .split(':')[-1].
-00004dd0: 0a20 2020 2020 2020 2023 7472 7920 746f  .        #try to
-00004de0: 2063 6f6e 7665 7265 7274 2069 6e74 6f20   converert into 
-00004df0: 696e 7465 6765 7220 0d0a 2020 2020 2020  integer ..      
-00004e00: 2020 7472 793a 200d 0a20 2020 2020 2020    try: ..       
-00004e10: 2020 2020 2063 7334 5f73 7461 7274 3d20       cs4_start= 
-00004e20: 696e 7420 2863 7334 5f73 7461 7274 290d  int (cs4_start).
-00004e30: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00004e40: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00004e50: 6966 2073 7472 2863 7334 5f73 7461 7274  if str(cs4_start
-00004e60: 292e 6c6f 7765 7228 2920 696e 206b 6579  ).lower() in key
-00004e70: 5f63 6f6c 6f72 733a 200d 0a20 2020 2020  _colors: ..     
-00004e80: 2020 2020 2020 2020 2020 2063 7334 5f73             cs4_s
-00004e90: 7461 7274 3d20 6b65 795f 636f 6c6f 7273  tart= key_colors
-00004ea0: 2e69 6e64 6578 2028 6373 345f 7374 6172  .index (cs4_star
-00004eb0: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-00004ec0: 2020 2020 7368 7566 666c 655f 6373 343d      shuffle_cs4=
-00004ed0: 4661 6c73 650d 0a20 2020 2020 2020 2020  False..         
-00004ee0: 2020 2065 6c73 653a 200d 0a20 2020 2020     else: ..     
-00004ef0: 2020 2020 2020 2020 2020 2070 6173 7320             pass 
-00004f00: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00004f10: 2020 2020 656c 7365 3a20 7368 7566 666c      else: shuffl
-00004f20: 655f 6373 343d 4661 6c73 6520 2320 6b65  e_cs4=False # ke
-00004f30: 6570 2043 5334 2061 6e64 2064 6f6e 7420  ep CS4 and dont 
-00004f40: 7368 7566 666c 6520 0d0a 2020 2020 2020  shuffle ..      
-00004f50: 2020 0d0a 2020 2020 2020 2020 6373 345f    ..        cs4_
-00004f60: 7374 6172 743d 2063 7334 5f73 7461 7274  start= cs4_start
-00004f70: 206f 7220 300d 0a20 2020 2020 2020 200d   or 0..        .
-00004f80: 0a20 2020 2020 2020 2069 6620 7368 7566  .        if shuf
-00004f90: 666c 655f 6373 343a 200d 0a20 2020 2020  fle_cs4: ..     
-00004fa0: 2020 2020 2020 206e 702e 7261 6e64 6f6d         np.random
-00004fb0: 2e73 6565 6420 2873 6565 6420 290d 0a20  .seed (seed ).. 
-00004fc0: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
-00004fd0: 7320 3d20 6c69 7374 286e 702e 7261 6e64  s = list(np.rand
-00004fe0: 6f6d 2e63 686f 6963 6528 636f 6c6f 7273  om.choice(colors
-00004ff0: 2020 2c20 6c65 6e28 6d5f 6373 2929 290d    , len(m_cs))).
-00005000: 0a20 2020 2020 2020 2065 6c73 653a 200d  .        else: .
-00005010: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00005020: 6373 345f 7374 6172 7420 3e20 6c65 6e28  cs4_start > len(
-00005030: 636f 6c6f 7273 292d 313a 200d 0a20 2020  colors)-1: ..   
-00005040: 2020 2020 2020 2020 2020 2020 2063 7334               cs4
-00005050: 5f73 7461 7274 203d 2030 200d 0a20 2020  _start = 0 ..   
-00005060: 200d 0a20 2020 2020 2020 2020 2020 2063   ..            c
-00005070: 6f6c 6f72 7320 3d20 636f 6c6f 7273 5b20  olors = colors[ 
-00005080: 6373 345f 7374 6172 743a 5d0d 0a20 2020  cs4_start:]..   
-00005090: 200d 0a20 2020 2069 6620 636f 6c6f 7273   ..    if colors
-000050a0: 2069 7320 6e6f 7420 4e6f 6e65 3a20 0d0a   is not None: ..
-000050b0: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-000050c0: 735f 6974 6572 6162 6c65 2863 6f6c 6f72  s_iterable(color
-000050d0: 7329 3a20 0d0a 2020 2020 2020 2020 2020  s): ..          
-000050e0: 2020 636f 6c6f 7273 203d 5b63 6f6c 6f72    colors =[color
-000050f0: 735d 0d0a 2020 2020 2020 2020 636f 6c6f  s]..        colo
-00005100: 7273 202b 3d20 6d5f 6373 200d 0a20 2020  rs += m_cs ..   
-00005110: 2065 6c73 6520 3a0d 0a20 2020 2020 2020   else :..       
-00005120: 2063 6f6c 6f72 7320 3d20 6d5f 6373 200d   colors = m_cs .
-00005130: 0a20 2020 2020 2020 200d 0a20 2020 2023  .        ..    #
-00005140: 2073 6872 756e 6b20 6461 7461 2074 6f20   shrunk data to 
-00005150: 6d61 7020 7468 6520 6578 6163 7420 636f  map the exact co
-00005160: 6c6f 7273 200d 0a20 2020 2063 6875 6e6b  lors ..    chunk
-00005170: 203d 5472 7565 2069 6620 6368 756e 6b20   =True if chunk 
-00005180: 6973 202e 2e2e 2065 6c73 6520 4661 6c73  is ... else Fals
-00005190: 6520 0d0a 2020 2020 7265 7475 726e 2063  e ..    return c
-000051a0: 6f6c 6f72 735b 3a61 7869 735f 6c65 6e67  olors[:axis_leng
-000051b0: 7468 5d20 6966 2063 6875 6e6b 2065 6c73  th] if chunk els
-000051c0: 6520 636f 6c6f 7273 200d 0a0d 0a0d 0a64  e colors ......d
-000051d0: 6566 2070 6c6f 745f 7369 6c68 6f75 6574  ef plot_silhouet
-000051e0: 7465 2028 582c 206c 6162 656c 732c 206d  te (X, labels, m
-000051f0: 6574 7269 6320 3d27 6575 636c 6964 6561  etric ='euclidea
-00005200: 6e27 2c73 6176 6566 6967 203d 4e6f 6e65  n',savefig =None
-00005210: 202c 202a 2a6b 7764 7320 293a 0d0a 2020   , **kwds ):..  
-00005220: 2020 7222 2222 506c 6f74 2071 7561 6e74    r"""Plot quant
-00005230: 6966 7969 6e67 2074 6865 2071 7561 6c69  ifying the quali
-00005240: 7479 2020 6f66 2063 6c75 7374 6572 696e  ty  of clusterin
-00005250: 6720 7369 6c68 6f75 6574 7465 200d 0a20  g silhouette .. 
-00005260: 2020 200d 0a20 2020 2050 6172 616d 6574     ..    Paramet
-00005270: 6572 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  ers ..    ------
-00005280: 2d2d 2d0d 0a20 2020 2058 203a 2061 7272  ---..    X : arr
-00005290: 6179 2d6c 696b 6520 6f66 2073 6861 7065  ay-like of shape
-000052a0: 2028 6e5f 7361 6d70 6c65 735f 612c 206e   (n_samples_a, n
-000052b0: 5f73 616d 706c 6573 5f61 2920 6966 206d  _samples_a) if m
-000052c0: 6574 7269 6320 3d3d 205c 0d0a 2020 2020  etric == \..    
-000052d0: 2020 2020 2020 2020 2270 7265 636f 6d70          "precomp
-000052e0: 7574 6564 2220 6f72 2028 6e5f 7361 6d70  uted" or (n_samp
-000052f0: 6c65 735f 612c 206e 5f66 6561 7475 7265  les_a, n_feature
-00005300: 7329 206f 7468 6572 7769 7365 0d0a 2020  s) otherwise..  
-00005310: 2020 2020 2020 416e 2061 7272 6179 206f        An array o
-00005320: 6620 7061 6972 7769 7365 2064 6973 7461  f pairwise dista
-00005330: 6e63 6573 2062 6574 7765 656e 2073 616d  nces between sam
-00005340: 706c 6573 2c20 6f72 2061 2066 6561 7475  ples, or a featu
-00005350: 7265 2061 7272 6179 2e0d 0a0d 0a20 2020  re array.....   
-00005360: 206c 6162 656c 7320 3a20 6172 7261 792d   labels : array-
-00005370: 6c69 6b65 206f 6620 7368 6170 6520 286e  like of shape (n
-00005380: 5f73 616d 706c 6573 2c29 0d0a 2020 2020  _samples,)..    
-00005390: 2020 2020 4c61 6265 6c20 7661 6c75 6573      Label values
-000053a0: 2066 6f72 2065 6163 6820 7361 6d70 6c65   for each sample
-000053b0: 2e0d 0a0d 0a20 2020 206d 6574 7269 6320  .....    metric 
-000053c0: 3a20 7374 7220 6f72 2063 616c 6c61 626c  : str or callabl
-000053d0: 652c 2064 6566 6175 6c74 3d27 6575 636c  e, default='eucl
-000053e0: 6964 6561 6e27 0d0a 2020 2020 2020 2020  idean'..        
-000053f0: 5468 6520 6d65 7472 6963 2074 6f20 7573  The metric to us
-00005400: 6520 7768 656e 2063 616c 6375 6c61 7469  e when calculati
-00005410: 6e67 2064 6973 7461 6e63 6520 6265 7477  ng distance betw
-00005420: 6565 6e20 696e 7374 616e 6365 7320 696e  een instances in
-00005430: 2061 0d0a 2020 2020 2020 2020 6665 6174   a..        feat
-00005440: 7572 6520 6172 7261 792e 2049 6620 6d65  ure array. If me
-00005450: 7472 6963 2069 7320 6120 7374 7269 6e67  tric is a string
-00005460: 2c20 6974 206d 7573 7420 6265 206f 6e65  , it must be one
-00005470: 206f 6620 7468 6520 6f70 7469 6f6e 730d   of the options.
-00005480: 0a20 2020 2020 2020 2061 6c6c 6f77 6564  .        allowed
-00005490: 2062 7920 3a66 756e 633a 6073 6b6c 6561   by :func:`sklea
-000054a0: 726e 2e6d 6574 7269 6373 2e70 6169 7277  rn.metrics.pairw
-000054b0: 6973 652e 7061 6972 7769 7365 5f64 6973  ise.pairwise_dis
-000054c0: 7461 6e63 6573 602e 0d0a 2020 2020 2020  tances`...      
-000054d0: 2020 4966 2060 6058 6060 2069 7320 7468    If ``X`` is th
-000054e0: 6520 6469 7374 616e 6365 2061 7272 6179  e distance array
-000054f0: 2069 7473 656c 662c 2075 7365 2022 7072   itself, use "pr
-00005500: 6563 6f6d 7075 7465 6422 2061 7320 7468  ecomputed" as th
-00005510: 6520 6d65 7472 6963 2e0d 0a20 2020 2020  e metric...     
-00005520: 2020 2050 7265 636f 6d70 7574 6564 2064     Precomputed d
-00005530: 6973 7461 6e63 6520 6d61 7472 6963 6573  istance matrices
-00005540: 206d 7573 7420 6861 7665 2030 2061 6c6f   must have 0 alo
-00005550: 6e67 2074 6865 2064 6961 676f 6e61 6c2e  ng the diagonal.
-00005560: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00005570: 7361 7665 6669 673a 2073 7472 2c20 6465  savefig: str, de
-00005580: 6661 756c 7420 3d4e 6f6e 6520 2c20 0d0a  fault =None , ..
-00005590: 2020 2020 2020 2020 7468 6520 7061 7468          the path
-000055a0: 2074 6f20 7361 7665 2074 6865 2066 6967   to save the fig
-000055b0: 7572 652e 2041 7267 756d 656e 7420 6973  ure. Argument is
-000055c0: 2070 6173 7365 6420 746f 200d 0a20 2020   passed to ..   
-000055d0: 2020 2020 203a 636c 6173 733a 606d 6174       :class:`mat
-000055e0: 706c 6f74 6c69 622e 4669 6775 7265 6020  plotlib.Figure` 
-000055f0: 636c 6173 732e 200d 0a20 2020 2020 2020  class. ..       
-00005600: 200d 0a20 2020 202a 2a6b 7764 7320 3a20   ..    **kwds : 
-00005610: 6f70 7469 6f6e 616c 206b 6579 776f 7264  optional keyword
-00005620: 2070 6172 616d 6574 6572 730d 0a20 2020   parameters..   
-00005630: 2020 2020 2041 6e79 2066 7572 7468 6572       Any further
-00005640: 2070 6172 616d 6574 6572 7320 6172 6520   parameters are 
-00005650: 7061 7373 6564 2064 6972 6563 746c 7920  passed directly 
-00005660: 746f 2074 6865 2064 6973 7461 6e63 6520  to the distance 
-00005670: 6675 6e63 7469 6f6e 2e0d 0a20 2020 2020  function...     
-00005680: 2020 2049 6620 7573 696e 6720 6120 6060     If using a ``
-00005690: 7363 6970 792e 7370 6174 6961 6c2e 6469  scipy.spatial.di
-000056a0: 7374 616e 6365 6060 206d 6574 7269 632c  stance`` metric,
-000056b0: 2074 6865 2070 6172 616d 6574 6572 7320   the parameters 
-000056c0: 6172 6520 7374 696c 6c0d 0a20 2020 2020  are still..     
-000056d0: 2020 206d 6574 7269 6320 6465 7065 6e64     metric depend
-000056e0: 656e 742e 2053 6565 2074 6865 2073 6369  ent. See the sci
-000056f0: 7079 2064 6f63 7320 666f 7220 7573 6167  py docs for usag
-00005700: 6520 6578 616d 706c 6573 2e0d 0a20 2020  e examples...   
-00005710: 2020 2020 200d 0a20 2020 2020 2020 200d       ..        .
-00005720: 0a20 2020 2053 6565 2041 6c73 6f0d 0a20  .    See Also.. 
-00005730: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
-00005740: 2077 6174 6578 2e76 6965 772e 6d6c 706c   watex.view.mlpl
-00005750: 6f74 2e70 6c6f 7453 696c 686f 7565 7474  ot.plotSilhouett
-00005760: 653a 200d 0a20 2020 2020 2020 2047 6976  e: ..        Giv
-00005770: 6573 2063 6f6e 7369 7374 656e 6379 2070  es consistency p
-00005780: 6c6f 7420 6173 2074 6865 2075 7365 206f  lot as the use o
-00005790: 6620 6070 7265 6669 7460 2070 6172 616d  f `prefit` param
-000057a0: 6574 6572 2077 6869 6368 2063 6865 636b  eter which check
-000057b0: 7320 0d0a 2020 2020 2020 2020 7768 6574  s ..        whet
-000057c0: 6865 7260 6c61 6265 6c73 6020 6172 6520  her`labels` are 
-000057d0: 6578 7065 6374 6564 2074 6f20 6265 2070  expected to be p
-000057e0: 6173 7365 6420 696e 746f 2074 6865 2066  assed into the f
-000057f0: 756e 6374 696f 6e20 0d0a 2020 2020 2020  unction ..      
-00005800: 2020 6469 7265 6374 6c79 206f 7220 6e6f    directly or no
-00005810: 742e 200d 0a20 2020 200d 0a20 2020 2045  t. ..    ..    E
-00005820: 7861 6d70 6c65 730d 0a20 2020 202d 2d2d  xamples..    ---
-00005830: 2d2d 2d2d 2d2d 0d0a 2020 2020 3e3e 3e20  ------..    >>> 
-00005840: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-00005850: 6e70 200d 0a20 2020 203e 3e3e 2066 726f  np ..    >>> fro
-00005860: 6d20 7761 7465 782e 6578 6c69 622e 736b  m watex.exlib.sk
-00005870: 6c65 6172 6e20 696d 706f 7274 204b 4d65  learn import KMe
-00005880: 616e 7320 0d0a 2020 2020 3e3e 3e20 6672  ans ..    >>> fr
-00005890: 6f6d 2077 6174 6578 2e64 6174 6173 6574  om watex.dataset
-000058a0: 7320 696d 706f 7274 206c 6f61 645f 6972  s import load_ir
-000058b0: 6973 200d 0a20 2020 203e 3e3e 2066 726f  is ..    >>> fro
-000058c0: 6d20 7761 7465 782e 7574 696c 732e 706c  m watex.utils.pl
-000058d0: 6f74 7574 696c 7320 696d 706f 7274 2070  otutils import p
-000058e0: 6c6f 745f 7369 6c68 6f75 6574 7465 0d0a  lot_silhouette..
-000058f0: 2020 2020 3e3e 3e20 643d 206c 6f61 645f      >>> d= load_
-00005900: 6972 6973 2028 290d 0a20 2020 203e 3e3e  iris ()..    >>>
-00005910: 2058 3d20 642e 6461 7461 205b 3a2c 2030   X= d.data [:, 0
-00005920: 5d5b 3a2c 206e 702e 6e65 7761 7869 735d  ][:, np.newaxis]
-00005930: 2023 2074 616b 6520 7468 6520 6669 7273   # take the firs
-00005940: 7420 6178 6973 200d 0a20 2020 203e 3e3e  t axis ..    >>>
-00005950: 206b 6d3d 204b 4d65 616e 7320 286e 5f63   km= KMeans (n_c
-00005960: 6c75 7374 6572 7320 3d33 202c 2069 6e69  lusters =3 , ini
-00005970: 743d 276b 2d6d 6561 6e73 2b2b 272c 206e  t='k-means++', n
-00005980: 5f69 6e69 7420 3d31 3020 2c20 0d0a 2020  _init =10 , ..  
-00005990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000059a0: 2020 6d61 785f 6974 6572 203d 2033 3030    max_iter = 300
-000059b0: 202c 200d 0a20 2020 2020 2020 2020 2020   , ..           
-000059c0: 2020 2020 2020 2020 2074 6f6c 3d31 652d           tol=1e-
-000059d0: 342c 200d 0a20 2020 2020 2020 2020 2020  4, ..           
-000059e0: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
-000059f0: 7374 6174 6520 3d30 200d 0a20 2020 2020  state =0 ..     
-00005a00: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00005a10: 0d0a 2020 2020 3e3e 3e20 795f 6b6d 203d  ..    >>> y_km =
-00005a20: 206b 6d2e 6669 745f 7072 6564 6963 7428   km.fit_predict(
-00005a30: 5829 200d 0a20 2020 203e 3e3e 2070 6c6f  X) ..    >>> plo
-00005a40: 745f 7369 6c68 6f75 6574 7465 2028 582c  t_silhouette (X,
-00005a50: 2079 5f6b 6d29 0d0a 0d0a 2020 2020 2222   y_km)....    ""
-00005a60: 220d 0a20 2020 2058 2c20 6c61 6265 6c73  "..    X, labels
-00005a70: 203d 2063 6865 636b 5f58 5f79 280d 0a20   = check_X_y(.. 
-00005a80: 2020 2020 2020 2058 2c20 0d0a 2020 2020         X, ..    
-00005a90: 2020 2020 6c61 6265 6c73 2c20 0d0a 2020      labels, ..  
-00005aa0: 2020 2020 2020 746f 5f66 7261 6d65 3d20        to_frame= 
-00005ab0: 5472 7565 2c20 0d0a 2020 2020 2020 2020  True, ..        
-00005ac0: 290d 0a20 2020 2063 6c75 7374 6572 5f6c  )..    cluster_l
-00005ad0: 6162 656c 7320 3d20 6e70 2e75 6e69 7175  abels = np.uniqu
-00005ae0: 6520 286c 6162 656c 7329 200d 0a20 2020  e (labels) ..   
-00005af0: 206e 5f63 6c75 7374 6572 7320 3d20 636c   n_clusters = cl
-00005b00: 7573 7465 725f 6c61 6265 6c73 2e73 6861  uster_labels.sha
-00005b10: 7065 205b 305d 200d 0a20 2020 2073 696c  pe [0] ..    sil
-00005b20: 686f 7565 7474 655f 7661 6c73 203d 2073  houette_vals = s
-00005b30: 696c 686f 7565 7474 655f 7361 6d70 6c65  ilhouette_sample
-00005b40: 7328 0d0a 2020 2020 2020 2020 582c 206c  s(..        X, l
-00005b50: 6162 656c 733d 206c 6162 656c 732c 206d  abels= labels, m
-00005b60: 6574 7269 6320 3d20 6d65 7472 6963 202c  etric = metric ,
-00005b70: 2a2a 6b77 6473 290d 0a20 2020 2079 5f61  **kwds)..    y_a
-00005b80: 785f 6c6f 7765 7220 2c20 795f 6178 5f75  x_lower , y_ax_u
-00005b90: 7070 6572 203d 2030 2c20 3020 0d0a 2020  pper = 0, 0 ..  
-00005ba0: 2020 7974 6963 6b73 203d 5b5d 0d0a 2020    yticks =[]..  
-00005bb0: 2020 0d0a 2020 2020 666f 7220 692c 2063    ..    for i, c
-00005bc0: 2020 696e 2065 6e75 6d65 7261 7465 2028    in enumerate (
-00005bd0: 636c 7573 7465 725f 6c61 6265 6c73 2029  cluster_labels )
-00005be0: 203a 200d 0a20 2020 2020 2020 2063 5f73   : ..        c_s
-00005bf0: 696c 686f 7565 7474 655f 7661 6c73 203d  ilhouette_vals =
-00005c00: 2073 696c 686f 7565 7474 655f 7661 6c73   silhouette_vals
-00005c10: 5b6c 6162 656c 7320 3d3d 6320 5d20 0d0a  [labels ==c ] ..
-00005c20: 2020 2020 2020 2020 635f 7369 6c68 6f75          c_silhou
-00005c30: 6574 7465 5f76 616c 732e 736f 7274 2829  ette_vals.sort()
-00005c40: 0d0a 2020 2020 2020 2020 795f 6178 5f75  ..        y_ax_u
-00005c50: 7070 6572 202b 3d20 6c65 6e28 635f 7369  pper += len(c_si
-00005c60: 6c68 6f75 6574 7465 5f76 616c 7329 0d0a  lhouette_vals)..
-00005c70: 2020 2020 2020 2020 636f 6c6f 7220 3d6d          color =m
-00005c80: 706c 2e63 6d2e 6a65 7420 2866 6c6f 6174  pl.cm.jet (float
-00005c90: 2869 292f 6e5f 636c 7573 7465 7273 2029  (i)/n_clusters )
-00005ca0: 0d0a 2020 2020 2020 2020 706c 742e 6261  ..        plt.ba
-00005cb0: 7268 2872 616e 6765 2879 5f61 785f 6c6f  rh(range(y_ax_lo
-00005cc0: 7765 722c 2079 5f61 785f 7570 7065 7229  wer, y_ax_upper)
-00005cd0: 2c20 635f 7369 6c68 6f75 6574 7465 5f76  , c_silhouette_v
-00005ce0: 616c 732c 200d 0a20 2020 2020 2020 2020  als, ..         
-00005cf0: 2020 2020 2020 2020 6865 6967 6874 203d          height =
-00005d00: 312e 3020 2c20 0d0a 2020 2020 2020 2020  1.0 , ..        
-00005d10: 2020 2020 2020 2020 2065 6467 6563 6f6c           edgecol
-00005d20: 6f72 203d 276e 6f6e 6527 2c20 0d0a 2020  or ='none', ..  
-00005d30: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00005d40: 6f6c 6f72 203d 636f 6c6f 722c 200d 0a20  olor =color, .. 
-00005d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d60: 290d 0a20 2020 2020 2020 2079 7469 636b  )..        ytick
-00005d70: 732e 6170 7065 6e64 2828 795f 6178 5f6c  s.append((y_ax_l
-00005d80: 6f77 6572 202b 2079 5f61 785f 7570 7065  ower + y_ax_uppe
-00005d90: 7229 2f32 2e29 0d0a 2020 2020 2020 2020  r)/2.)..        
-00005da0: 795f 6178 5f6c 6f77 6572 202b 3d20 6c65  y_ax_lower += le
-00005db0: 6e28 635f 7369 6c68 6f75 6574 7465 5f76  n(c_silhouette_v
-00005dc0: 616c 7329 0d0a 2020 2020 7369 6c68 6f75  als)..    silhou
-00005dd0: 6574 7465 5f61 7667 203d 206e 702e 6d65  ette_avg = np.me
-00005de0: 616e 2873 696c 686f 7565 7474 655f 7661  an(silhouette_va
-00005df0: 6c73 2920 0d0a 2020 2020 706c 742e 6178  ls) ..    plt.ax
-00005e00: 766c 696e 6520 2873 696c 686f 7565 7474  vline (silhouett
-00005e10: 655f 6176 672c 200d 0a20 2020 2020 2020  e_avg, ..       
-00005e20: 2020 2020 2020 2020 2020 636f 6c6f 723d            color=
-00005e30: 2772 6564 272c 200d 0a20 2020 2020 2020  'red', ..       
-00005e40: 2020 2020 2020 2020 2020 6c69 6e65 7374            linest
-00005e50: 796c 6520 3d27 2d2d 270d 0a20 2020 2020  yle ='--'..     
-00005e60: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-00005e70: 2020 2070 6c74 2e79 7469 636b 7328 7974     plt.yticks(yt
-00005e80: 6963 6b73 2c20 636c 7573 7465 725f 6c61  icks, cluster_la
-00005e90: 6265 6c73 202b 3120 2920 0d0a 2020 2020  bels +1 ) ..    
-00005ea0: 706c 742e 796c 6162 656c 2028 2243 6c75  plt.ylabel ("Clu
-00005eb0: 7374 6572 2229 200d 0a20 2020 2070 6c74  ster") ..    plt
-00005ec0: 2e78 6c61 6265 6c20 2822 5369 6c68 6f75  .xlabel ("Silhou
-00005ed0: 6574 7465 2063 6f65 6666 6963 6965 6e74  ette coefficient
-00005ee0: 2229 0d0a 2020 2020 706c 742e 7469 6768  ")..    plt.tigh
-00005ef0: 745f 6c61 796f 7574 2829 0d0a 0d0a 2020  t_layout()....  
-00005f00: 2020 6966 2073 6176 6566 6967 2069 7320    if savefig is 
-00005f10: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-00005f20: 2020 2070 6c74 2e73 6176 6566 6967 2873     plt.savefig(s
-00005f30: 6176 6566 6967 2c20 6470 6920 3d20 3330  avefig, dpi = 30
-00005f40: 3020 290d 0a20 2020 2020 2020 200d 0a20  0 )..        .. 
-00005f50: 2020 2070 6c74 2e63 6c6f 7365 2028 2920     plt.close () 
-00005f60: 6966 2073 6176 6566 6967 2069 7320 6e6f  if savefig is no
-00005f70: 7420 4e6f 6e65 2065 6c73 6520 706c 742e  t None else plt.
-00005f80: 7368 6f77 2829 200d 0a20 2020 200d 0a0d  show() ..    ...
-00005f90: 0a64 6566 2070 6c6f 745f 7362 735f 6665  .def plot_sbs_fe
-00005fa0: 6174 7572 655f 7365 6c65 6374 696f 6e20  ature_selection 
-00005fb0: 280d 0a20 2020 2020 2020 2073 6273 5f65  (..        sbs_e
-00005fc0: 7374 696d 6174 6f72 2c2f 2c20 2058 3d4e  stimator,/,  X=N
-00005fd0: 6f6e 652c 2079 3d4e 6f6e 6520 2c66 6967  one, y=None ,fig
-00005fe0: 5f73 697a 653d 2838 2c20 3529 2c20 0d0a  _size=(8, 5), ..
-00005ff0: 2020 2020 2020 2020 736e 735f 7374 796c          sns_styl
-00006000: 6520 3d46 616c 7365 2c20 7361 7665 6669  e =False, savefi
-00006010: 6720 3d20 4e6f 6e65 2c20 7665 7262 6f73  g = None, verbos
-00006020: 653d 3020 2c20 0d0a 2020 2020 2020 2020  e=0 , ..        
-00006030: 2a2a 7362 735f 6b77 730d 0a20 2020 2020  **sbs_kws..     
-00006040: 2020 2029 3a20 0d0a 2020 2020 2222 2270     ): ..    """p
-00006050: 6c6f 7420 5365 7175 656e 7469 616c 2042  lot Sequential B
-00006060: 6163 6b77 6172 6420 5365 6c65 6374 696f  ackward Selectio
-00006070: 6e20 2853 4253 2920 666f 7220 6665 6174  n (SBS) for feat
-00006080: 7572 6520 7365 6c65 6374 696f 6e2e 2020  ure selection.  
-00006090: 0d0a 2020 2020 0d0a 2020 2020 5342 5320  ..    ..    SBS 
-000060a0: 636f 6c6c 6563 7473 2074 6865 2073 636f  collects the sco
-000060b0: 7265 7320 6f66 2074 6865 2020 6265 7374  res of the  best
-000060c0: 2066 6561 7475 7265 2073 7562 7365 7420   feature subset 
-000060d0: 6174 2065 6163 6820 7374 6167 652e 200d  at each stage. .
-000060e0: 0a20 2020 200d 0a20 2020 2050 6172 616d  .    ..    Param
-000060f0: 6574 6572 7320 0d0a 2020 2020 2d2d 2d2d  eters ..    ----
-00006100: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 7362  --------..    sb
-00006110: 735f 6573 7469 6d61 746f 7220 3a20 3a63  s_estimator : :c
-00006120: 6c61 7373 3a60 7e2e 7761 7465 782e 6261  lass:`~.watex.ba
-00006130: 7365 2e53 6571 7565 6e74 6961 6c42 6163  se.SequentialBac
-00006140: 6b77 6172 6453 656c 6563 7469 6f6e 605c  kwardSelection`\
-00006150: 0d0a 2020 2020 2020 2020 6573 7469 6d61  ..        estima
-00006160: 746f 7220 6f62 6a65 6374 0d0a 2020 2020  tor object..    
-00006170: 2020 2020 5468 6520 5365 7175 656e 7469      The Sequenti
-00006180: 616c 2042 6163 6b77 6172 6420 5365 6c65  al Backward Sele
-00006190: 6374 696f 6e20 6573 7469 6d61 746f 7220  ction estimator 
-000061a0: 6361 6e20 6569 7468 6572 2062 6520 6669  can either be fi
-000061b0: 7474 6564 206f 7220 0d0a 2020 2020 2020  tted or ..      
-000061c0: 2020 6e6f 742e 2049 6620 6e6f 7420 6669    not. If not fi
-000061d0: 7474 6564 2e20 506c 6561 7365 2070 726f  tted. Please pro
-000061e0: 7669 6465 2074 6865 2074 7261 696e 696e  vide the trainin
-000061f0: 6720 6058 6020 616e 6420 6079 602c 200d  g `X` and `y`, .
-00006200: 0a20 2020 2020 2020 206f 7468 6572 7769  .        otherwi
-00006210: 7365 2061 6e20 6572 726f 7220 7769 6c6c  se an error will
-00006220: 206f 6363 7572 732e 0d0a 2020 2020 2020   occurs...      
-00006230: 2020 0d0a 2020 2020 5820 3a20 6172 7261    ..    X : arra
-00006240: 792d 6c69 6b65 206f 6620 7368 6170 6520  y-like of shape 
-00006250: 286e 5f73 616d 706c 6573 2c20 6e5f 6665  (n_samples, n_fe
-00006260: 6174 7572 6573 290d 0a20 2020 2020 2020  atures)..       
-00006270: 2054 7261 696e 696e 6720 7665 6374 6f72   Training vector
-00006280: 2c20 7768 6572 6520 606e 5f73 616d 706c  , where `n_sampl
-00006290: 6573 6020 6973 2074 6865 206e 756d 6265  es` is the numbe
-000062a0: 7220 6f66 2073 616d 706c 6573 2061 6e64  r of samples and
-000062b0: 0d0a 2020 2020 2020 2020 606e 5f66 6561  ..        `n_fea
-000062c0: 7475 7265 7360 2069 7320 7468 6520 6e75  tures` is the nu
-000062d0: 6d62 6572 206f 6620 6665 6174 7572 6573  mber of features
-000062e0: 2e0d 0a0d 0a20 2020 2079 203a 2061 7272  .....    y : arr
-000062f0: 6179 2d6c 696b 6520 6f66 2073 6861 7065  ay-like of shape
-00006300: 2028 6e5f 7361 6d70 6c65 732c 2920 6f72   (n_samples,) or
-00006310: 2028 6e5f 7361 6d70 6c65 732c 206e 5f6f   (n_samples, n_o
-00006320: 7574 7075 7473 290d 0a20 2020 2020 2020  utputs)..       
-00006330: 2054 6172 6765 7420 7265 6c61 7469 7665   Target relative
-00006340: 2074 6f20 5820 666f 7220 636c 6173 7369   to X for classi
-00006350: 6669 6361 7469 6f6e 206f 7220 7265 6772  fication or regr
-00006360: 6573 7369 6f6e 3b0d 0a20 2020 2020 2020  ession;..       
-00006370: 204e 6f6e 6520 666f 7220 756e 7375 7065   None for unsupe
-00006380: 7276 6973 6564 206c 6561 726e 696e 672e  rvised learning.
-00006390: 0d0a 2020 2020 2020 200d 0a20 2020 206e  ..       ..    n
-000063a0: 5f65 7374 696d 6174 6f72 7320 3a20 696e  _estimators : in
-000063b0: 742c 2064 6566 6175 6c74 3d35 3030 0d0a  t, default=500..
-000063c0: 2020 2020 2020 2020 5468 6520 6e75 6d62          The numb
-000063d0: 6572 206f 6620 7472 6565 7320 696e 2074  er of trees in t
-000063e0: 6865 2066 6f72 6573 742e 0d0a 2020 2020  he forest...    
-000063f0: 2020 2020 0d0a 2020 2020 6669 675f 7369      ..    fig_si
-00006400: 7a65 203a 2074 7570 6c65 2028 7769 6474  ze : tuple (widt
-00006410: 682c 2068 6569 6768 7429 2c20 6465 6661  h, height), defa
-00006420: 756c 7420 3d28 382c 2036 290d 0a20 2020  ult =(8, 6)..   
-00006430: 2020 2020 2074 6865 206d 6174 706c 6f74       the matplot
-00006440: 6c69 6220 6669 6775 7265 2073 697a 6520  lib figure size 
-00006450: 6769 7665 6e20 6173 2061 2074 7570 6c65  given as a tuple
-00006460: 206f 6620 7769 6474 6820 616e 6420 6865   of width and he
-00006470: 6967 6874 0d0a 2020 2020 2020 2020 0d0a  ight..        ..
-00006480: 2020 2020 7361 7665 6669 673a 2073 7472      savefig: str
-00006490: 2c20 6465 6661 756c 7420 3d4e 6f6e 6520  , default =None 
-000064a0: 2c20 0d0a 2020 2020 2020 2020 7468 6520  , ..        the 
-000064b0: 7061 7468 2074 6f20 7361 7665 2074 6865  path to save the
-000064c0: 2066 6967 7572 6573 2e20 4172 6775 6d65   figures. Argume
-000064d0: 6e74 2069 7320 7061 7373 6564 2074 6f20  nt is passed to 
-000064e0: 6d61 7470 6c6f 746c 6962 2e46 6967 7572  matplotlib.Figur
-000064f0: 6520 0d0a 2020 2020 2020 2020 636c 6173  e ..        clas
-00006500: 732e 200d 0a20 2020 2073 6e73 5f73 7479  s. ..    sns_sty
-00006510: 6c65 3a20 7374 722c 206f 7074 696f 6e61  le: str, optiona
-00006520: 6c2c 200d 0a20 2020 2020 2020 2074 6865  l, ..        the
-00006530: 2073 6561 626f 726e 2073 7479 6c65 2e0d   seaborn style..
-00006540: 0a20 2020 2076 6572 626f 7365 3a20 696e  .    verbose: in
-00006550: 742c 2064 6566 6175 6c74 3d30 200d 0a20  t, default=0 .. 
-00006560: 2020 2020 2020 2070 7269 6e74 2074 6865         print the
-00006570: 2066 6561 7475 7265 206c 6162 656c 7320   feature labels 
-00006580: 7769 7468 2074 6865 2072 6174 6520 6f66  with the rate of
-00006590: 2074 6865 6972 2069 6d70 6f72 7461 6e63   their importanc
-000065a0: 6573 2e20 0d0a 2020 2020 7362 735f 6b77  es. ..    sbs_kw
-000065b0: 733a 2064 6963 742c 200d 0a20 2020 2020  s: dict, ..     
-000065c0: 2020 2041 6464 6974 696f 6e61 6c20 6b65     Additional ke
-000065d0: 7979 776f 7264 2061 7267 756d 656e 7473  yyword arguments
-000065e0: 2070 6173 7365 6420 746f 200d 0a20 2020   passed to ..   
-000065f0: 2020 2020 203a 636c 6173 733a 607e 2e77       :class:`~.w
-00006600: 6174 6578 2e62 6173 652e 5365 7175 656e  atex.base.Sequen
-00006610: 7469 616c 4261 636b 7761 7264 5365 6c65  tialBackwardSele
-00006620: 6374 696f 6e60 0d0a 2020 2020 2020 2020  ction`..        
-00006630: 0d0a 2020 2020 4578 616d 706c 6573 200d  ..    Examples .
-00006640: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d  .    ----------.
-00006650: 0a20 2020 2028 3129 2d3e 2050 6c6f 7420  .    (1)-> Plot 
-00006660: 6669 7474 6564 2053 4253 2069 6e20 6163  fitted SBS in ac
-00006670: 7469 6f6e 200d 0a20 2020 203e 3e3e 2066  tion ..    >>> f
-00006680: 726f 6d20 7761 7465 782e 6578 6c69 622e  rom watex.exlib.
-00006690: 736b 6c65 6172 6e20 696d 706f 7274 204b  sklearn import K
-000066a0: 4e65 6967 6862 6f72 7343 6c61 7373 6966  NeighborsClassif
-000066b0: 6965 7220 2c20 7472 6169 6e5f 7465 7374  ier , train_test
-000066c0: 5f73 706c 6974 0d0a 2020 2020 3e3e 3e20  _split..    >>> 
-000066d0: 6672 6f6d 2077 6174 6578 2e64 6174 6173  from watex.datas
-000066e0: 6574 7320 696d 706f 7274 2066 6574 6368  ets import fetch
-000066f0: 5f64 6174 610d 0a20 2020 203e 3e3e 2066  _data..    >>> f
-00006700: 726f 6d20 7761 7465 782e 6261 7365 2069  rom watex.base i
-00006710: 6d70 6f72 7420 5365 7175 656e 7469 616c  mport Sequential
-00006720: 4261 636b 7761 7264 5365 6c65 6374 696f  BackwardSelectio
-00006730: 6e0d 0a20 2020 203e 3e3e 2066 726f 6d20  n..    >>> from 
-00006740: 7761 7465 782e 7574 696c 732e 706c 6f74  watex.utils.plot
-00006750: 7574 696c 7320 696d 706f 7274 2070 6c6f  utils import plo
-00006760: 745f 7362 735f 6665 6174 7572 655f 7365  t_sbs_feature_se
-00006770: 6c65 6374 696f 6e0d 0a20 2020 203e 3e3e  lection..    >>>
-00006780: 2058 2c20 7920 3d20 6665 7463 685f 6461   X, y = fetch_da
-00006790: 7461 2827 6261 676f 7565 2061 6e61 6c79  ta('bagoue analy
-000067a0: 7365 6427 2920 2320 6461 7461 2061 6c72  sed') # data alr
-000067b0: 6561 6479 2073 7461 6e64 6172 6469 7a65  eady standardize
-000067c0: 640d 0a20 2020 203e 3e3e 2058 7472 6169  d..    >>> Xtrai
-000067d0: 6e2c 2058 742c 2079 7472 6169 6e2c 2020  n, Xt, ytrain,  
-000067e0: 7974 203d 2074 7261 696e 5f74 6573 745f  yt = train_test_
-000067f0: 7370 6c69 7428 582c 2079 290d 0a20 2020  split(X, y)..   
-00006800: 203e 3e3e 206b 6e6e 203d 204b 4e65 6967   >>> knn = KNeig
-00006810: 6862 6f72 7343 6c61 7373 6966 6965 7228  hborsClassifier(
-00006820: 6e5f 6e65 6967 6862 6f72 733d 3529 0d0a  n_neighbors=5)..
-00006830: 2020 2020 3e3e 3e20 7362 733d 2053 6571      >>> sbs= Seq
-00006840: 7565 6e74 6961 6c42 6163 6b77 6172 6453  uentialBackwardS
-00006850: 656c 6563 7469 6f6e 2028 6b6e 6e29 0d0a  election (knn)..
-00006860: 2020 2020 3e3e 3e20 7362 732e 6669 7428      >>> sbs.fit(
-00006870: 5874 7261 696e 2c20 7974 7261 696e 2029  Xtrain, ytrain )
-00006880: 0d0a 2020 2020 3e3e 3e20 706c 6f74 5f73  ..    >>> plot_s
-00006890: 6273 5f66 6561 7475 7265 5f73 656c 6563  bs_feature_selec
-000068a0: 7469 6f6e 2873 6273 2c20 736e 735f 7374  tion(sbs, sns_st
-000068b0: 796c 653d 2054 7275 6529 200d 0a20 2020  yle= True) ..   
-000068c0: 200d 0a20 2020 2028 3229 2d3e 2050 6c6f   ..    (2)-> Plo
-000068d0: 7420 6573 7469 6d61 746f 7220 7769 7468  t estimator with
-000068e0: 206e 6f20 7072 6566 6974 2053 4253 2e20   no prefit SBS. 
-000068f0: 0d0a 2020 2020 3e3e 3e20 706c 6f74 5f73  ..    >>> plot_s
-00006900: 6273 5f66 6561 7475 7265 5f73 656c 6563  bs_feature_selec
-00006910: 7469 6f6e 286b 6e6e 2c20 5874 7261 696e  tion(knn, Xtrain
-00006920: 2c20 7974 7261 696e 2920 2320 7969 656c  , ytrain) # yiel
-00006930: 6420 7468 6520 7361 6d65 2072 6573 756c  d the same resul
-00006940: 740d 0a0d 0a20 2020 2022 2222 0d0a 2020  t....    """..  
-00006950: 2020 6672 6f6d 202e 2e62 6173 6520 696d    from ..base im
-00006960: 706f 7274 2053 6571 7565 6e74 6961 6c42  port SequentialB
-00006970: 6163 6b77 6172 6453 656c 6563 7469 6f6e  ackwardSelection
-00006980: 2061 7320 5342 5320 0d0a 2020 2020 6966   as SBS ..    if
-00006990: 2028 200d 0a20 2020 2020 2020 206e 6f74   ( ..        not
-000069a0: 2068 6173 6174 7472 2028 7362 735f 6573   hasattr (sbs_es
-000069b0: 7469 6d61 746f 722c 2027 7363 6f72 6573  timator, 'scores
-000069c0: 5f27 2920 0d0a 2020 2020 2020 2020 616e  _') ..        an
-000069d0: 6420 6e6f 7420 6861 7361 7474 7220 2873  d not hasattr (s
-000069e0: 6273 5f65 7374 696d 6174 6f72 2c20 276b  bs_estimator, 'k
-000069f0: 5f73 636f 7265 5f27 290d 0a20 2020 2020  _score_')..     
-00006a00: 2020 2020 2020 2029 3a20 0d0a 2020 2020         ): ..    
-00006a10: 2020 2020 6966 2028 2058 2069 7320 4e6f      if ( X is No
-00006a20: 6e65 206f 7220 7920 6973 204e 6f6e 6520  ne or y is None 
-00006a30: 2920 3a20 0d0a 2020 2020 2020 2020 2020  ) : ..          
-00006a40: 2020 636c 666e 203d 2067 6574 5f65 7374    clfn = get_est
-00006a50: 696d 6174 6f72 5f6e 616d 6528 2073 6273  imator_name( sbs
-00006a60: 5f65 7374 696d 6174 6f72 290d 0a20 2020  _estimator)..   
-00006a70: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00006a80: 7970 6545 7272 6f72 2028 6622 5768 656e  ypeError (f"When
-00006a90: 207b 636c 666e 7d20 6973 206e 6f74 2061   {clfn} is not a
-00006aa0: 2066 6974 7465 6420 220d 0a20 2020 2020   fitted "..     
-00006ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ac0: 2020 2020 2020 2020 2265 7374 696d 6174          "estimat
-00006ad0: 6f72 2c20 5820 616e 6420 7920 6172 6520  or, X and y are 
-00006ae0: 6e65 6564 6564 2e22 0d0a 2020 2020 2020  needed."..      
-00006af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006b00: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-00006b10: 2020 7362 735f 6573 7469 6d61 746f 7220    sbs_estimator 
-00006b20: 3d20 5342 5328 6573 7469 6d61 746f 7220  = SBS(estimator 
-00006b30: 3d20 7362 735f 6573 7469 6d61 746f 722c  = sbs_estimator,
-00006b40: 202a 2a73 6273 5f6b 7773 290d 0a20 2020   **sbs_kws)..   
-00006b50: 2020 2020 2073 6273 5f65 7374 696d 6174       sbs_estimat
-00006b60: 6f72 2e66 6974 2858 2c20 7920 290d 0a20  or.fit(X, y ).. 
-00006b70: 2020 2020 2020 200d 0a20 2020 206b 5f66         ..    k_f
-00006b80: 6561 7420 3d20 5b6c 656e 286b 2920 666f  eat = [len(k) fo
-00006b90: 7220 6b20 696e 2073 6273 5f65 7374 696d  r k in sbs_estim
-00006ba0: 6174 6f72 2e73 7562 7365 7473 5f5d 0d0a  ator.subsets_]..
-00006bb0: 2020 2020 0d0a 2020 2020 6966 2076 6572      ..    if ver
-00006bc0: 626f 7365 3a20 0d0a 2020 2020 2020 2020  bose: ..        
-00006bd0: 666c 6162 656c 7320 3d4e 6f6e 6520 0d0a  flabels =None ..
-00006be0: 2020 2020 2020 2020 6966 2020 2820 6e6f          if  ( no
-00006bf0: 7420 6861 7361 7474 7220 2858 2c20 2763  t hasattr (X, 'c
-00006c00: 6f6c 756d 6e73 2729 2061 6e64 2058 2069  olumns') and X i
-00006c10: 7320 6e6f 7420 4e6f 6e65 2029 3a20 0d0a  s not None ): ..
-00006c20: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00006c30: 696e 6773 2e77 6172 6e28 224e 6f6e 6520  ings.warn("None 
-00006c40: 636f 6c75 6d6e 7320 6e61 6d65 2069 7320  columns name is 
-00006c50: 6465 7465 6374 6564 2e22 0d0a 2020 2020  detected."..    
-00006c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c70: 2020 2020 2020 2220 4372 6561 7465 6420        " Created 
-00006c80: 7573 696e 6720 696e 6465 7820 2229 0d0a  using index ")..
-00006c90: 2020 2020 2020 2020 2020 2020 666c 6162              flab
-00006ca0: 656c 7320 3d5b 6627 7b69 3a3e 377d 2720  els =[f'{i:>7}' 
-00006cb0: 666f 7220 6920 696e 2072 616e 6765 2028  for i in range (
-00006cc0: 582e 7368 6170 655b 315d 295d 0d0a 2020  X.shape[1])]..  
-00006cd0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00006ce0: 2020 2020 656c 6966 2068 6173 6174 7472      elif hasattr
-00006cf0: 2028 582c 2027 636f 6c75 6d6e 7327 293a   (X, 'columns'):
-00006d00: 0d0a 2020 2020 2020 2020 2020 2020 666c  ..            fl
-00006d10: 6162 656c 7320 3d20 6c69 7374 2858 2e63  abels = list(X.c
-00006d20: 6f6c 756d 6e73 2920 200d 0a20 2020 2020  olumns)  ..     
-00006d30: 2020 2065 6c69 6620 6861 7361 7474 7220     elif hasattr 
-00006d40: 2820 7362 735f 6573 7469 6d61 746f 7220  ( sbs_estimator 
-00006d50: 2c20 2766 6561 7475 7265 5f6e 616d 6573  , 'feature_names
-00006d60: 5f69 6e27 293a 200d 0a20 2020 2020 2020  _in'): ..       
-00006d70: 2020 2020 2066 6c61 6265 6c73 203d 2073       flabels = s
-00006d80: 6273 5f65 7374 696d 6174 6f72 2e66 6561  bs_estimator.fea
-00006d90: 7475 7265 5f6e 616d 6573 5f69 6e20 0d0a  ture_names_in ..
-00006da0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00006db0: 2020 2020 2020 6966 2066 6c61 6265 6c73        if flabels
-00006dc0: 2069 7320 6e6f 7420 4e6f 6e65 3a20 0d0a   is not None: ..
-00006dd0: 2020 2020 2020 2020 2020 2020 6b33 203d              k3 =
-00006de0: 206c 6973 7420 2873 6273 5f65 7374 696d   list (sbs_estim
-00006df0: 6174 6f72 2e73 7562 7365 7473 5f5b 582e  ator.subsets_[X.
-00006e00: 7368 6170 655b 315d 5d29 0d0a 2020 2020  shape[1]])..    
-00006e10: 2020 2020 2020 2020 7072 696e 7428 2253          print("S
-00006e20: 6d61 6c6c 6573 7420 6665 6174 7572 6520  mallest feature 
-00006e30: 666f 7220 7375 6273 6574 2028 6b3d 3329  for subset (k=3)
-00006e40: 2022 290d 0a20 2020 2020 2020 2020 2020   ")..           
-00006e50: 2070 7269 6e74 2866 6c61 6265 6c73 205b   print(flabels [
-00006e60: 6b33 5d29 0d0a 2020 2020 2020 2020 2020  k3])..          
-00006e70: 2020 0d0a 2020 2020 2020 2020 656c 7365    ..        else
-00006e80: 203a 2070 7269 6e74 2822 4e6f 2063 6f6c   : print("No col
-00006e90: 756d 6e20 6c61 6265 6c73 2064 6574 6563  umn labels detec
-00006ea0: 7465 642e 2043 616e 2774 2070 7269 6e74  ted. Can't print
-00006eb0: 2074 6865 2022 0d0a 2020 2020 2020 2020   the "..        
-00006ec0: 2020 2020 2020 2020 2020 2020 2022 736d               "sm
-00006ed0: 616c 6c65 7374 2066 6561 7475 7265 2073  allest feature s
-00006ee0: 7562 7365 742e 2229 0d0a 2020 2020 2020  ubset.")..      
-00006ef0: 2020 0d0a 2020 2020 6966 2073 6e73 5f73    ..    if sns_s
-00006f00: 7479 6c65 3a20 0d0a 2020 2020 2020 2020  tyle: ..        
-00006f10: 5f73 6574 5f73 6e73 5f73 7479 6c65 2028  _set_sns_style (
-00006f20: 736e 735f 7374 796c 6529 0d0a 2020 2020  sns_style)..    
-00006f30: 2020 2020 0d0a 2020 2020 706c 742e 6669      ..    plt.fi
-00006f40: 6775 7265 2866 6967 7369 7a65 203d 2066  gure(figsize = f
-00006f50: 6967 5f73 697a 6529 0d0a 2020 2020 706c  ig_size)..    pl
-00006f60: 742e 706c 6f74 2028 6b5f 6665 6174 202c  t.plot (k_feat ,
-00006f70: 2073 6273 5f65 7374 696d 6174 6f72 2e73   sbs_estimator.s
-00006f80: 636f 7265 735f 2c20 6d61 726b 6572 3d27  cores_, marker='
-00006f90: 6f27 2029 200d 0a20 2020 2070 6c74 2e79  o' ) ..    plt.y
-00006fa0: 6c69 6d20 285b 6d69 6e28 7362 735f 6573  lim ([min(sbs_es
-00006fb0: 7469 6d61 746f 722e 7363 6f72 6573 5f29  timator.scores_)
-00006fc0: 202d 2e32 3520 2c0d 0a20 2020 2020 2020   -.25 ,..       
-00006fd0: 2020 2020 2020 2020 6d61 7828 7362 735f          max(sbs_
-00006fe0: 6573 7469 6d61 746f 722e 7363 6f72 6573  estimator.scores
-00006ff0: 5f29 202b 2e32 205d 290d 0a20 2020 2070  _) +.2 ])..    p
-00007000: 6c74 2e79 6c61 6265 6c20 2873 6273 5f65  lt.ylabel (sbs_e
-00007010: 7374 696d 6174 6f72 2e73 636f 7265 725f  stimator.scorer_
-00007020: 6e61 6d65 5f20 290d 0a20 2020 2070 6c74  name_ )..    plt
-00007030: 2e78 6c61 6265 6c20 2827 4e75 6d62 6572  .xlabel ('Number
-00007040: 206f 6620 6665 6174 7572 6573 2729 0d0a   of features')..
-00007050: 2020 2020 706c 742e 7469 6768 745f 6c61      plt.tight_la
-00007060: 796f 7574 2829 200d 0a20 2020 200d 0a20  yout() ..    .. 
-00007070: 2020 2069 6620 7361 7665 6669 6720 6973     if savefig is
-00007080: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-00007090: 2020 2020 706c 742e 7361 7665 6669 6728      plt.savefig(
-000070a0: 7361 7665 6669 6720 290d 0a20 2020 2020  savefig )..     
-000070b0: 2020 200d 0a20 2020 2070 6c74 2e63 6c6f     ..    plt.clo
-000070c0: 7365 2028 2920 6966 2073 6176 6566 6967  se () if savefig
-000070d0: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
-000070e0: 6520 706c 742e 7368 6f77 2829 200d 0a20  e plt.show() .. 
-000070f0: 2020 200d 0a0d 0a64 6566 2070 6c6f 745f     ....def plot_
-00007100: 7265 6775 6c61 7269 7a61 7469 6f6e 5f70  regularization_p
-00007110: 6174 6820 2820 0d0a 2020 2020 2020 2020  ath ( ..        
-00007120: 582c 2079 202c 2063 5f72 616e 6765 3d28  X, y , c_range=(
-00007130: 2d34 2e2c 2036 2e20 292c 2066 6967 5f73  -4., 6. ), fig_s
-00007140: 697a 653d 2838 2c20 3529 2c20 736e 735f  ize=(8, 5), sns_
-00007150: 7374 796c 6520 3d46 616c 7365 2c20 0d0a  style =False, ..
-00007160: 2020 2020 2020 2020 7361 7665 6669 6720          savefig 
-00007170: 3d20 4e6f 6e65 2c20 2a2a 6b77 7320 0d0a  = None, **kws ..
-00007180: 2020 2020 2020 2020 293a 200d 0a20 2020          ): ..   
-00007190: 2072 2222 2220 506c 6f74 2074 6865 2072   r""" Plot the r
-000071a0: 6567 756c 6172 6973 6174 696f 6e20 7061  egularisation pa
-000071b0: 7468 2066 726f 6d20 4c6f 6769 7420 2f20  th from Logit / 
-000071c0: 4c6f 6769 7374 6963 5265 6772 6573 7369  LogisticRegressi
-000071d0: 6f6e 200d 0a20 2020 200d 0a20 2020 2056  on ..    ..    V
-000071e0: 6172 7969 6e67 2074 6865 2020 6469 6666  arying the  diff
-000071f0: 6572 656e 7420 7265 6775 6c61 7269 7a61  erent regulariza
-00007200: 7469 6f6e 2073 7472 656e 6774 6873 2061  tion strengths a
-00007210: 6e64 2070 6c6f 7420 7468 6520 2077 6569  nd plot the  wei
-00007220: 6768 7420 0d0a 2020 2020 636f 6566 6669  ght ..    coeffi
-00007230: 6369 656e 7420 6f66 2074 6865 2064 6966  cient of the dif
-00007240: 6665 7265 6e74 2066 6561 7475 7265 7320  ferent features 
-00007250: 666f 7220 6469 6666 6572 656e 7420 7265  for different re
-00007260: 6775 6c61 7269 7a61 7469 6f6e 200d 0a20  gularization .. 
-00007270: 2020 2073 7472 656e 6774 682e 200d 0a20     strength. .. 
-00007280: 2020 200d 0a20 2020 204e 6f74 6520 7468     ..    Note th
-00007290: 6174 2c20 6974 2069 7320 7265 636f 6d6d  at, it is recomm
-000072a0: 656e 6465 6420 746f 2073 7461 6e64 6172  ended to standar
-000072b0: 6469 7a65 2074 6865 2064 6174 6120 6669  dize the data fi
-000072c0: 7273 742e 200d 0a20 2020 200d 0a20 2020  rst. ..    ..   
-000072d0: 2050 6172 616d 6574 6572 7320 0d0a 2020   Parameters ..  
-000072e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20    -----------.. 
-000072f0: 2020 2058 203a 2061 7272 6179 2d6c 696b     X : array-lik
-00007300: 6520 6f66 2073 6861 7065 2028 6e5f 7361  e of shape (n_sa
-00007310: 6d70 6c65 732c 206e 5f66 6561 7475 7265  mples, n_feature
-00007320: 7329 0d0a 2020 2020 2020 2020 5472 6169  s)..        Trai
-00007330: 6e69 6e67 2076 6563 746f 722c 2077 6865  ning vector, whe
-00007340: 7265 2060 6e5f 7361 6d70 6c65 7360 2069  re `n_samples` i
-00007350: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
-00007360: 7361 6d70 6c65 7320 616e 640d 0a20 2020  samples and..   
-00007370: 2020 2020 2060 6e5f 6665 6174 7572 6573       `n_features
-00007380: 6020 6973 2074 6865 206e 756d 6265 7220  ` is the number 
-00007390: 6f66 2066 6561 7475 7265 732e 2058 2069  of features. X i
-000073a0: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
-000073b0: 200d 0a20 2020 2020 2020 2073 7461 6e64   ..        stand
-000073c0: 6172 6469 7a65 642e 200d 0a0d 0a20 2020  ardized. ....   
-000073d0: 2079 203a 2061 7272 6179 2d6c 696b 6520   y : array-like 
-000073e0: 6f66 2073 6861 7065 2028 6e5f 7361 6d70  of shape (n_samp
-000073f0: 6c65 732c 2920 6f72 2028 6e5f 7361 6d70  les,) or (n_samp
-00007400: 6c65 732c 206e 5f6f 7574 7075 7473 290d  les, n_outputs).
-00007410: 0a20 2020 2020 2020 2054 6172 6765 7420  .        Target 
-00007420: 7265 6c61 7469 7665 2074 6f20 5820 666f  relative to X fo
-00007430: 7220 636c 6173 7369 6669 6361 7469 6f6e  r classification
-00007440: 206f 7220 7265 6772 6573 7369 6f6e 3b0d   or regression;.
-00007450: 0a20 2020 2020 2020 204e 6f6e 6520 666f  .        None fo
-00007460: 7220 756e 7375 7065 7276 6973 6564 206c  r unsupervised l
-00007470: 6561 726e 696e 672e 0d0a 2020 2020 635f  earning...    c_
-00007480: 7261 6e67 653a 206c 6973 7420 6f72 2074  range: list or t
-00007490: 7570 6c65 205b 7374 6172 742c 2073 746f  uple [start, sto
-000074a0: 705d 200d 0a20 2020 2020 2020 2052 6567  p] ..        Reg
-000074b0: 756c 6172 697a 6174 696f 6e20 7374 7265  ularization stre
-000074c0: 6e67 7468 206c 6973 742e 2049 7420 6973  ngth list. It is
-000074d0: 2061 2072 616e 6765 2066 726f 6d20 7468   a range from th
-000074e0: 6520 7374 726f 6e67 2020 0d0a 2020 2020  e strong  ..    
-000074f0: 2020 2020 7374 726f 6e67 2028 2073 7461      strong ( sta
-00007500: 7274 2920 746f 206c 6f77 6572 2028 7374  rt) to lower (st
-00007510: 6f70 2920 7265 6775 6c61 7269 7a61 7469  op) regularizati
-00007520: 6f6e 2e20 4e6f 7465 2074 6861 7420 2743  on. Note that 'C
-00007530: 2720 6973 200d 0a20 2020 2020 2020 2074  ' is ..        t
-00007540: 6865 2069 6e76 6572 7365 206f 6620 7468  he inverse of th
-00007550: 6520 4c6f 6769 7374 6963 2052 6567 7265  e Logistic Regre
-00007560: 7373 696f 6e20 7265 6775 6c61 7269 7a61  ssion regulariza
-00007570: 7469 6f6e 2070 6172 616d 6574 6572 200d  tion parameter .
-00007580: 0a20 2020 2020 2020 203a 6d61 7468 3a60  .        :math:`
-00007590: 5c6c 616d 6264 6160 2e20 0d0a 2020 2020  \lambda`. ..    
-000075a0: 6669 675f 7369 7a65 203a 2074 7570 6c65  fig_size : tuple
-000075b0: 2028 7769 6474 682c 2068 6569 6768 7429   (width, height)
-000075c0: 2c20 6465 6661 756c 7420 3d28 382c 2036  , default =(8, 6
-000075d0: 290d 0a20 2020 2020 2020 2074 6865 206d  )..        the m
-000075e0: 6174 706c 6f74 6c69 6220 6669 6775 7265  atplotlib figure
-000075f0: 2073 697a 6520 6769 7665 6e20 6173 2061   size given as a
-00007600: 2074 7570 6c65 206f 6620 7769 6474 6820   tuple of width 
-00007610: 616e 6420 6865 6967 6874 0d0a 2020 2020  and height..    
-00007620: 2020 2020 0d0a 2020 2020 7361 7665 6669      ..    savefi
-00007630: 673a 2073 7472 2c20 6465 6661 756c 7420  g: str, default 
-00007640: 3d4e 6f6e 6520 2c20 0d0a 2020 2020 2020  =None , ..      
-00007650: 2020 7468 6520 7061 7468 2074 6f20 7361    the path to sa
-00007660: 7665 2074 6865 2066 6967 7572 6573 2e20  ve the figures. 
-00007670: 4172 6775 6d65 6e74 2069 7320 7061 7373  Argument is pass
-00007680: 6564 2074 6f20 6d61 7470 6c6f 746c 6962  ed to matplotlib
-00007690: 2e46 6967 7572 6520 0d0a 2020 2020 2020  .Figure ..      
-000076a0: 2020 636c 6173 732e 200d 0a20 2020 2073    class. ..    s
-000076b0: 6e73 5f73 7479 6c65 3a20 7374 722c 206f  ns_style: str, o
-000076c0: 7074 696f 6e61 6c2c 200d 0a20 2020 2020  ptional, ..     
-000076d0: 2020 2074 6865 2073 6561 626f 726e 2073     the seaborn s
-000076e0: 7479 6c65 2e0d 0a20 2020 2020 2020 200d  tyle...        .
-000076f0: 0a20 2020 206b 7773 3a20 6469 6374 2c20  .    kws: dict, 
-00007700: 0d0a 2020 2020 2020 2020 4164 6469 7469  ..        Additi
-00007710: 6f6e 616c 206b 6579 776f 7264 7320 6172  onal keywords ar
-00007720: 6775 6d65 6e74 7320 7061 7373 6564 2074  guments passed t
-00007730: 6f20 0d0a 2020 2020 2020 2020 3a63 6c61  o ..        :cla
-00007740: 7373 3a60 736b 6c65 6172 6e2e 6c69 6e65  ss:`sklearn.line
-00007750: 6172 5f6d 6f64 656c 2e4c 6f67 6973 7469  ar_model.Logisti
-00007760: 6352 6567 7265 7373 696f 6e60 0d0a 2020  cRegression`..  
-00007770: 2020 0d0a 2020 2020 4578 616d 706c 6573    ..    Examples
-00007780: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a  ..    --------..
-00007790: 2020 2020 3e3e 3e20 6672 6f6d 2077 6174      >>> from wat
-000077a0: 6578 2e75 7469 6c73 2e70 6c6f 7475 7469  ex.utils.plotuti
-000077b0: 6c73 2069 6d70 6f72 7420 706c 6f74 5f72  ls import plot_r
-000077c0: 6567 756c 6172 697a 6174 696f 6e5f 7061  egularization_pa
-000077d0: 7468 200d 0a20 2020 203e 3e3e 2066 726f  th ..    >>> fro
-000077e0: 6d20 7761 7465 782e 6461 7461 7365 7473  m watex.datasets
-000077f0: 2069 6d70 6f72 7420 6665 7463 685f 6461   import fetch_da
-00007800: 7461 0d0a 2020 2020 3e3e 3e20 582c 2079  ta..    >>> X, y
-00007810: 203d 2066 6574 6368 5f64 6174 6120 2827   = fetch_data ('
-00007820: 6261 676f 7565 2061 6e61 6c79 7365 6427  bagoue analysed'
-00007830: 2029 2023 2064 6174 6120 616c 6561 7264   ) # data aleard
-00007840: 7920 7374 616e 6461 7264 697a 6564 0d0a  y standardized..
-00007850: 2020 2020 3e3e 3e20 706c 6f74 5f72 6567      >>> plot_reg
-00007860: 756c 6172 697a 6174 696f 6e5f 7061 7468  ularization_path
-00007870: 2028 582c 2079 2029 200d 0a0d 0a20 2020   (X, y ) ....   
-00007880: 2022 2222 0d0a 2020 2020 582c 2079 203d   """..    X, y =
-00007890: 2063 6865 636b 5f58 5f79 280d 0a20 2020   check_X_y(..   
-000078a0: 2020 2020 2058 2c20 0d0a 2020 2020 2020       X, ..      
-000078b0: 2020 792c 200d 0a20 2020 2020 2020 2074    y, ..        t
-000078c0: 6f5f 6672 616d 653d 2054 7275 652c 200d  o_frame= True, .
-000078d0: 0a20 2020 2020 2020 2029 0d0a 2020 2020  .        )..    
-000078e0: 0d0a 2020 2020 6966 206e 6f74 2069 735f  ..    if not is_
-000078f0: 6974 6572 6162 6c65 2863 5f72 616e 6765  iterable(c_range
-00007900: 293a 200d 0a20 2020 2020 2020 2072 6169  ): ..        rai
-00007910: 7365 2054 7970 6545 7272 6f72 2028 2227  se TypeError ("'
-00007920: 4327 2072 6567 756c 6172 697a 6174 696f  C' regularizatio
-00007930: 6e20 7374 7265 6e67 7468 2069 7320 6120  n strength is a 
-00007940: 7261 6e67 6520 6f66 2043 2022 200d 0a20  range of C " .. 
-00007950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007960: 2020 2020 2020 2020 2220 4c6f 6769 7420          " Logit 
-00007970: 7061 7261 6d65 7465 723a 2028 7374 6172  parameter: (star
-00007980: 742c 2073 746f 7029 2e22 290d 0a20 2020  t, stop).")..   
-00007990: 2063 5f72 616e 6765 203d 2073 6f72 7465   c_range = sorte
-000079a0: 6420 2863 5f72 616e 6765 2029 0d0a 2020  d (c_range )..  
-000079b0: 2020 0d0a 2020 2020 6966 206c 656e 2863    ..    if len(c
-000079c0: 5f72 616e 6765 2920 3c20 323a 200d 0a20  _range) < 2: .. 
-000079d0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-000079e0: 7565 4572 726f 7220 2822 2743 2720 7261  ueError ("'C' ra
-000079f0: 6e67 6520 6578 7065 6374 7320 7477 6f20  nge expects two 
-00007a00: 7661 6c75 6573 205b 7374 6172 742c 2073  values [start, s
-00007a10: 746f 705d 2229 0d0a 2020 2020 2020 2020  top]")..        
-00007a20: 0d0a 2020 2020 6966 206c 656e 2863 5f72  ..    if len(c_r
-00007a30: 616e 6765 2920 3e32 203a 200d 0a20 2020  ange) >2 : ..   
-00007a40: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00007a50: 726e 2028 2227 4327 2072 616e 6765 2065  rn ("'C' range e
-00007a60: 7870 6563 7473 2074 776f 2076 616c 7565  xpects two value
-00007a70: 7320 5b73 7461 7274 2c20 7374 6f70 5d2e  s [start, stop].
-00007a80: 2056 616c 7565 7322 0d0a 2020 2020 2020   Values"..      
-00007a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007aa0: 2066 2220 6172 6520 7368 7275 6e6b 2074   f" are shrunk t
-00007ab0: 6f20 7468 6520 6669 7273 7420 7477 6f20  o the first two 
-00007ac0: 7661 6c75 6573 3a20 7b63 5f72 616e 6765  values: {c_range
-00007ad0: 5b3a 325d 7d20 220d 0a20 2020 2020 2020  [:2]} "..       
+00003bc0: 2020 2020 2022 2053 696e 676c 6520 6c69       " Single li
+00003bd0: 6d69 7420 7661 6c75 6520 6973 206e 6f74  mit value is not
+00003be0: 2061 6c6c 6f77 6564 2e22 0d0a 2020 2020   allowed."..    
+00003bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003c00: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00003c10: 2020 2020 656c 7365 3a20 0d0a 2020 2020      else: ..    
+00003c20: 2020 2020 2020 2020 2020 2020 2320 696e              # in
+00003c30: 2063 6173 6520 6f6e 6c79 2054 7275 6520   case only True 
+00003c40: 6973 2067 6976 656e 200d 0a20 2020 2020  is given ..     
+00003c50: 2020 2020 2020 2020 2020 2023 2075 7365             # use
+00003c60: 2074 6865 2064 6566 6175 6c74 2070 6c6f   the default plo
+00003c70: 740d 0a20 2020 2020 2020 2020 2020 2020  t..             
+00003c80: 2020 2079 7476 3d20 6178 5b30 5d2e 6765     ytv= ax[0].ge
+00003c90: 745f 7974 6963 6b73 2028 2920 0d0a 2020  t_yticks () ..  
+00003ca0: 2020 2020 2020 2020 2020 2020 2020 7370                sp
+00003cb0: 6163 696e 6720 3d20 2879 7476 5b2d 315d  acing = (ytv[-1]
+00003cc0: 202d 2079 7476 5b30 5d20 292f 286c 656e   - ytv[0] )/(len
+00003cd0: 2879 7476 292d 3129 200d 0a20 2020 2020  (ytv)-1) ..     
+00003ce0: 2020 2020 2020 2020 2020 2023 2063 6f6d             # com
+00003cf0: 6d6f 6e6c 7920 6d61 7470 6c6f 746c 6962  monly matplotlib
+00003d00: 2061 7869 7320 6578 7472 6170 6f6c 6564   axis extrapoled
+00003d10: 2074 6865 206c 696d 6974 2073 6f20 0d0a   the limit so ..
+00003d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d30: 2320 7374 6172 7420 7769 7468 2074 6865  # start with the
+00003d40: 2066 6972 7374 2061 6e64 206c 6173 7420   first and last 
+00003d50: 696e 6465 7820 0d0a 2020 2020 2020 2020  index ..        
+00003d60: 2020 2020 2020 2020 6472 6177 5f73 7069          draw_spi
+00003d70: 6e65 733d 2020 2879 7476 5b30 5d20 2b20  nes=  (ytv[0] + 
+00003d80: 7370 6163 696e 672f 3220 2c20 7974 765b  spacing/2 , ytv[
+00003d90: 2d31 5d20 2d20 7370 6163 696e 672f 3220  -1] - spacing/2 
+00003da0: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
+00003db0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00003dc0: 2020 6178 5b6b 5d2e 7370 696e 6573 5b27    ax[k].spines['
+00003dd0: 6c65 6674 275d 2e73 6574 5f62 6f75 6e64  left'].set_bound
+00003de0: 7328 2a64 7261 775f 7370 696e 6573 2029  s(*draw_spines )
+00003df0: 0d0a 2020 2020 200d 0a20 2020 2023 2073  ..     ..    # s
+00003e00: 6574 206c 6162 656c 730d 0a20 2020 2061  et labels..    a
+00003e10: 785b 305d 2e73 6574 5f79 6c61 6265 6c20  x[0].set_ylabel 
+00003e20: 2822 4465 7074 6820 286d 2922 290d 0a20  ("Depth (m)").. 
+00003e30: 2020 2020 2020 2023 2054 7765 616b 2073         # Tweak s
+00003e40: 7061 6369 6e67 2062 6574 7765 656e 2073  pacing between s
+00003e50: 7562 706c 6f74 7320 746f 2070 7265 7665  ubplots to preve
+00003e60: 6e74 206c 6162 656c 7320 0d0a 2020 2020  nt labels ..    
+00003e70: 2020 2020 2320 6672 6f6d 206f 7665 726c      # from overl
+00003e80: 6170 7069 6e67 200d 0a20 2020 2020 2020  apping ..       
+00003e90: 2023 2070 6c74 2e73 7562 706c 6f74 735f   # plt.subplots_
+00003ea0: 6164 6a75 7374 2868 7370 6163 653d 302e  adjust(hspace=0.
+00003eb0: 3529 2d3e 2072 656d 6f76 6564 0d0a 2020  5)-> removed..  
+00003ec0: 2020 706c 742e 6763 6128 292e 696e 7665    plt.gca().inve
+00003ed0: 7274 5f79 6178 6973 2829 0d0a 2020 2020  rt_yaxis()..    
+00003ee0: 0d0a 2020 2020 6966 2073 6176 6566 6967  ..    if savefig
+00003ef0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+00003f00: 2020 2020 2020 2070 6c74 2e73 6176 6566         plt.savef
+00003f10: 6967 2873 6176 6566 6967 2c20 6470 6920  ig(savefig, dpi 
+00003f20: 3d20 6669 675f 6470 6920 290d 0a20 2020  = fig_dpi )..   
+00003f30: 2020 2020 200d 0a20 2020 2070 6c74 2e63       ..    plt.c
+00003f40: 6c6f 7365 2028 2920 6966 2073 6176 6566  lose () if savef
+00003f50: 6967 2069 7320 6e6f 7420 4e6f 6e65 2065  ig is not None e
+00003f60: 6c73 6520 706c 742e 7368 6f77 2829 200d  lse plt.show() .
+00003f70: 0a20 2020 200d 0a64 6566 206d 616b 655f  .    ..def make_
+00003f80: 706c 6f74 5f63 6f6c 6f72 7328 6420 2c20  plot_colors(d , 
+00003f90: 2f20 2c20 636f 6c6f 7273 3a73 7472 207c  / , colors:str |
+00003fa0: 206c 6973 745b 7374 725d 3d4e 6f6e 6520   list[str]=None 
+00003fb0: 2c20 6178 6973 3a69 6e74 203d 2030 2c20  , axis:int = 0, 
+00003fc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003fd0: 2020 2020 2020 2073 6565 643a 696e 7420         seed:int 
+00003fe0: 203d 4e6f 6e65 2c20 6368 756e 6b3a 626f   =None, chunk:bo
+00003ff0: 6f6c 203d 2e2e 2e20 293a 200d 0a20 2020  ol =... ): ..   
+00004000: 2022 2222 2053 656c 6563 7420 636f 6c6f   """ Select colo
+00004010: 7273 2061 6363 6f72 6469 6e67 2074 6f20  rs according to 
+00004020: 7468 6520 6461 7461 2073 697a 6520 616c  the data size al
+00004030: 6f6e 6720 6178 6973 200d 0a20 2020 200d  ong axis ..    .
+00004040: 0a20 2020 2050 6172 616d 6574 6572 7320  .    Parameters 
+00004050: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
+00004060: 0d0a 2020 2020 643a 2041 7272 6179 6c69  ..    d: Arrayli
+00004070: 6b65 200d 0a20 2020 2020 2020 4172 7261  ke ..       Arra
+00004080: 7920 6461 7461 2074 6f20 7365 6c65 6374  y data to select
+00004090: 2063 6f6c 6f72 7320 6163 636f 7264 696e   colors accordin
+000040a0: 6720 746f 2074 6865 2061 7869 7320 0d0a  g to the axis ..
+000040b0: 2020 2020 636f 6c6f 7273 3a20 7374 722c      colors: str,
+000040c0: 206c 6973 7420 6f66 204d 6174 706c 6f74   list of Matplot
+000040d0: 6c69 622e 636f 6c6f 7273 206d 6170 2c20  lib.colors map, 
+000040e0: 6f70 7469 6f6e 616c 200d 0a20 2020 2020  optional ..     
+000040f0: 2020 2054 6865 2063 6f6c 6f72 7320 666f     The colors fo
+00004100: 7220 706c 6f74 7469 6e67 2065 6163 6820  r plotting each 
+00004110: 636f 6c75 6d6e 7320 6f66 2060 5860 2065  columns of `X` e
+00004120: 7863 6570 7420 7468 6520 6465 7074 682e  xcept the depth.
+00004130: 2049 6620 6e6f 740d 0a20 2020 2020 2020   If not..       
+00004140: 2067 6976 656e 2c20 6465 6661 756c 7420   given, default 
+00004150: 636f 6c6f 7273 2061 7265 2061 7574 6f2d  colors are auto-
+00004160: 6765 6e65 7261 7465 642e 0d0a 2020 2020  generated...    
+00004170: 2020 2020 4966 2060 636f 6c6f 7273 6020      If `colors` 
+00004180: 6973 2073 7472 696e 6720 616e 6420 2763  is string and 'c
+00004190: 7334 276f 7220 2778 6b63 6427 2069 7320  s4'or 'xkcd' is 
+000041a0: 696e 636c 7564 6564 2e20 0d0a 2020 2020  included. ..    
+000041b0: 2020 2020 4d61 7470 6c6f 746c 6962 2e63      Matplotlib.c
+000041c0: 6f6c 6f72 732e 4353 345f 434f 4c4f 5253  olors.CS4_COLORS
+000041d0: 206f 7220 4d61 7470 6c6f 746c 6962 2e63   or Matplotlib.c
+000041e0: 6f6c 6f72 732e 584b 4344 5f43 4f4c 4f52  olors.XKCD_COLOR
+000041f0: 5320 0d0a 2020 2020 2020 2020 7368 6f75  S ..        shou
+00004200: 6c64 2062 6520 7573 6564 2069 6e73 7465  ld be used inste
+00004210: 6164 2e20 496e 2061 6464 6974 696f 6e20  ad. In addition 
+00004220: 6966 2074 6865 2060 2763 7334 2760 206f  if the `'cs4'` o
+00004230: 7220 6027 786b 6364 2760 2069 7320 200d  r `'xkcd'` is  .
+00004240: 0a20 2020 2020 2020 2073 7566 6669 7865  .        suffixe
+00004250: 6420 6279 2063 6f6c 6f6e 7320 616e 6420  d by colons and 
+00004260: 696e 7465 6765 7220 7661 6c75 6520 6c69  integer value li
+00004270: 6b65 2060 6063 7334 3a34 6060 206f 7220  ke ``cs4:4`` or 
+00004280: 6060 786b 6364 3a34 6060 2c20 7468 6520  ``xkcd:4``, the 
+00004290: 0d0a 2020 2020 2020 2020 4353 3420 6f72  ..        CS4 or
+000042a0: 2058 4b43 4420 636f 6c6f 7273 2073 686f   XKCD colors sho
+000042b0: 756c 6420 6265 2075 7365 6420 6672 6f6d  uld be used from
+000042c0: 2069 6e64 6578 2065 7175 616c 7320 746f   index equals to
+000042d0: 2060 6034 6060 2e20 0d0a 2020 2020 2020   ``4``. ..      
+000042e0: 2020 0d0a 2020 2020 2020 2020 2e2e 2076    ..        .. v
+000042f0: 6572 7369 6f6e 6164 6465 643a 3a20 302e  ersionadded:: 0.
+00004300: 322e 3320 0d0a 2020 2020 2020 2020 2020  2.3 ..          
+00004310: 204d 6174 706c 6f74 6c69 622e 636f 6c6f   Matplotlib.colo
+00004320: 7273 2e43 5334 5f43 4f4c 4f52 5320 6f72  rs.CS4_COLORS or
+00004330: 204d 6174 706c 6f74 6c69 622e 636f 6c6f   Matplotlib.colo
+00004340: 7273 2e58 4b43 445f 434f 4c4f 5253 2063  rs.XKCD_COLORS c
+00004350: 616e 200d 0a20 2020 2020 2020 2020 2020  an ..           
+00004360: 6265 2075 7365 6420 6279 2073 6574 7469  be used by setti
+00004370: 6e67 2060 636f 6c6f 7273 6020 746f 2060  ng `colors` to `
+00004380: 6027 6373 3427 6060 206f 7220 6060 2778  `'cs4'`` or ``'x
+00004390: 6b63 6427 6060 2e20 546f 2072 6570 726f  kcd'``. To repro
+000043a0: 6475 6365 200d 0a20 2020 2020 2020 2020  duce ..         
+000043b0: 2020 7468 6520 7361 6d65 2043 5334 206f    the same CS4 o
+000043c0: 7220 584b 4344 2063 6f6c 6f72 732c 2073  r XKCD colors, s
+000043d0: 6574 2074 6865 2060 7365 6564 6020 7061  et the `seed` pa
+000043e0: 7261 6d65 7465 7220 746f 2061 200d 0a20  rameter to a .. 
+000043f0: 2020 2020 2020 2020 2020 7370 6563 6966            specif
+00004400: 6963 2076 616c 7565 2e20 0d0a 2020 2020  ic value. ..    
+00004410: 2020 2020 2020 200d 0a20 2020 2061 7869         ..    axi
+00004420: 733a 2069 6e74 2c20 6465 6661 756c 743d  s: int, default=
+00004430: 3020 0d0a 2020 2020 2020 2041 7869 7320  0 ..       Axis 
+00004440: 616c 6f6e 6720 7769 7468 2074 6865 2063  along with the c
+00004450: 6f6c 6f72 7320 6d75 7374 2062 6520 6765  olors must be ge
+00004460: 6e65 7261 7465 642e 2042 7920 6465 6661  nerated. By defa
+00004470: 756c 7420 636f 6c6f 7273 2069 7320 0d0a  ult colors is ..
+00004480: 2020 2020 2020 2067 656e 6572 6174 6564         generated
+00004490: 2061 6c6f 6e67 2074 6865 2072 6f77 2061   along the row a
+000044a0: 7869 7320 0d0a 2020 2020 2020 200d 0a20  xis ..       .. 
+000044b0: 2020 2073 6565 643a 2069 6e74 2c20 6f70     seed: int, op
+000044c0: 7469 6f6e 616c 200d 0a20 2020 2020 2020  tional ..       
+000044d0: 416c 6c6f 7720 746f 2072 6570 726f 6475  Allow to reprodu
+000044e0: 6365 2074 6865 204d 6174 706c 6f74 6c69  ce the Matplotli
+000044f0: 622e 636f 6c6f 7273 2e43 5334 5f43 4f4c  b.colors.CS4_COL
+00004500: 4f52 5320 6966 2060 636f 6c6f 7273 6020  ORS if `colors` 
+00004510: 6973 200d 0a20 2020 2020 2020 7365 7420  is ..       set 
+00004520: 746f 2060 6063 7334 6060 2e20 0d0a 2020  to ``cs4``. ..  
+00004530: 2020 2020 200d 0a20 2020 2063 6875 6e6b       ..    chunk
+00004540: 3a20 626f 6f6c 2c20 6465 6661 756c 743d  : bool, default=
+00004550: 5472 7565 200d 0a20 2020 2020 2020 4368  True ..       Ch
+00004560: 756e 6b20 6765 6e65 7261 7465 6420 636f  unk generated co
+00004570: 6c6f 7273 2074 6f20 6669 7420 7468 6520  lors to fit the 
+00004580: 6578 6163 7420 6c65 6e67 7468 206f 6620  exact length of 
+00004590: 7468 6520 6064 6020 7369 7a65 200d 0a20  the `d` size .. 
+000045a0: 2020 2020 2020 0d0a 2020 2020 5265 7475        ..    Retu
+000045b0: 726e 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  rns ..    ------
+000045c0: 2d0d 0a20 2020 2063 6f6c 6f72 733a 206c  -..    colors: l
+000045d0: 6973 7420 0d0a 2020 2020 2020 204c 6973  ist ..       Lis
+000045e0: 7420 6f66 206e 6577 2067 656e 6572 6174  t of new generat
+000045f0: 6564 2063 6f6c 6f72 7320 0d0a 2020 2020  ed colors ..    
+00004600: 2020 200d 0a20 2020 2045 7861 6d70 6c65     ..    Example
+00004610: 7320 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  s ..    --------
+00004620: 0d0a 2020 2020 3e3e 3e20 696d 706f 7274  ..    >>> import
+00004630: 206e 756d 7079 2061 7320 6e70 200d 0a20   numpy as np .. 
+00004640: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
+00004650: 782e 7574 696c 732e 706c 6f74 7574 696c  x.utils.plotutil
+00004660: 7320 696d 706f 7274 206d 616b 655f 706c  s import make_pl
+00004670: 6f74 5f63 6f6c 6f72 730d 0a20 2020 203e  ot_colors..    >
+00004680: 3e3e 2061 7220 3d20 6e70 2e72 616e 646f  >> ar = np.rando
+00004690: 6d2e 7261 6e64 6e20 2837 2c20 3229 200d  m.randn (7, 2) .
+000046a0: 0a20 2020 203e 3e3e 206d 616b 655f 706c  .    >>> make_pl
+000046b0: 6f74 5f63 6f6c 6f72 7320 2861 7220 290d  ot_colors (ar ).
+000046c0: 0a20 2020 205b 2767 272c 2027 6772 6179  .    ['g', 'gray
+000046d0: 272c 2027 7927 2c20 2762 6c75 6527 2c20  ', 'y', 'blue', 
+000046e0: 276f 7261 6e67 6527 2c20 2770 7572 706c  'orange', 'purpl
+000046f0: 6527 2c20 276c 696d 6527 5d0d 0a20 2020  e', 'lime']..   
+00004700: 203e 3e3e 206d 616b 655f 706c 6f74 5f63   >>> make_plot_c
+00004710: 6f6c 6f72 7320 2861 7220 2c20 6178 6973  olors (ar , axis
+00004720: 203d 3120 2920 0d0a 2020 2020 4f75 745b   =1 ) ..    Out[
+00004730: 365d 3a20 5b27 6727 2c20 2767 7261 7927  6]: ['g', 'gray'
+00004740: 5d0d 0a20 2020 203e 3e3e 206d 616b 655f  ]..    >>> make_
+00004750: 706c 6f74 5f63 6f6c 6f72 7320 2861 7220  plot_colors (ar 
+00004760: 2c20 6178 6973 203d 3120 2c20 636f 6c6f  , axis =1 , colo
+00004770: 7273 203d 2763 7334 2729 0d0a 2020 2020  rs ='cs4')..    
+00004780: 5b27 2346 3046 3846 4627 2c20 2723 4641  ['#F0F8FF', '#FA
+00004790: 4542 4437 275d 0d0a 2020 2020 3e3e 3e20  EBD7']..    >>> 
+000047a0: 6c65 6e28 6d61 6b65 5f70 6c6f 745f 636f  len(make_plot_co
+000047b0: 6c6f 7273 2028 6172 202c 2061 7869 7320  lors (ar , axis 
+000047c0: 3d31 202c 2063 6f6c 6f72 7320 3d27 6373  =1 , colors ='cs
+000047d0: 3427 2c20 6368 756e 6b3d 4661 6c73 6529  4', chunk=False)
+000047e0: 290d 0a20 2020 2031 3530 0d0a 2020 2020  )..    150..    
+000047f0: 3e3e 3e20 6d61 6b65 5f70 6c6f 745f 636f  >>> make_plot_co
+00004800: 6c6f 7273 2028 6172 202c 2061 7869 7320  lors (ar , axis 
+00004810: 3d31 202c 2063 6f6c 6f72 7320 3d27 6373  =1 , colors ='cs
+00004820: 343a 3427 290d 0a20 2020 205b 2723 4630  4:4')..    ['#F0
+00004830: 4646 4646 272c 2027 2346 3546 3544 4327  FFFF', '#F5F5DC'
+00004840: 5d0d 0a20 2020 2022 2222 0d0a 2020 2020  ]..    """..    
+00004850: 0d0a 2020 2020 2320 6765 7420 7468 6520  ..    # get the 
+00004860: 6461 7461 2073 697a 6520 7768 6572 6520  data size where 
+00004870: 636f 6c6f 7273 206d 7573 7420 6265 2066  colors must be f
+00004880: 6974 7465 642e 200d 0a20 2020 2023 206e  itted. ..    # n
+00004890: 6f74 6520 636f 6c6f 7273 2073 686f 756c  ote colors shoul
+000048a0: 6420 6d61 7463 6820 6569 7468 6572 2074  d match either t
+000048b0: 6865 2072 6f77 2061 7869 7320 6f72 2063  he row axis or c
+000048c0: 6f6c 7572 6d73 2061 7869 7320 0d0a 2020  olurms axis ..  
+000048d0: 2020 6178 6973 203d 2073 7472 2861 7869    axis = str(axi
+000048e0: 7329 2e6c 6f77 6572 2829 200d 0a20 2020  s).lower() ..   
+000048f0: 2069 6620 2763 6f6c 756d 6e73 3127 2e66   if 'columns1'.f
+00004900: 696e 6420 2861 7869 7329 3e3d 303a 200d  ind (axis)>=0: .
+00004910: 0a20 2020 2020 2020 2061 7869 7320 3d31  .        axis =1
+00004920: 200d 0a20 2020 2065 6c73 653a 2061 7869   ..    else: axi
+00004930: 7320 3d30 0d0a 2020 2020 0d0a 2020 2020  s =0..    ..    
+00004940: 2320 6d61 6e61 6765 2074 6865 2061 7272  # manage the arr
+00004950: 6179 200d 0a20 2020 2064 3d20 6973 5f69  ay ..    d= is_i
+00004960: 7465 7261 626c 6528 2064 2c20 6578 636c  terable( d, excl
+00004970: 7564 655f 7374 7269 6e67 3d54 7275 652c  ude_string=True,
+00004980: 2074 7261 6e73 666f 726d 3d54 7275 6529   transform=True)
+00004990: 0d0a 2020 2020 6966 206e 6f74 2068 6173  ..    if not has
+000049a0: 6174 7472 2028 642c 2027 5f5f 6172 7261  attr (d, '__arra
+000049b0: 795f 5f27 293a 200d 0a20 2020 2020 2020  y__'): ..       
+000049c0: 2064 203d 206e 702e 6172 7261 7928 642c   d = np.array(d,
+000049d0: 2064 7479 7065 203d 6f62 6a65 6374 2029   dtype =object )
+000049e0: 200d 0a20 2020 200d 0a20 2020 2061 7869   ..    ..    axi
+000049f0: 735f 6c65 6e67 7468 203d 206c 656e 2864  s_length = len(d
+00004a00: 2920 6966 206c 656e 2864 2e73 6861 7065  ) if len(d.shape
+00004a10: 2029 3d3d 3120 656c 7365 2064 2e73 6861   )==1 else d.sha
+00004a20: 7065 205b 6178 6973 5d0d 0a20 2020 206d  pe [axis]..    m
+00004a30: 5f63 7320 3d20 6d61 6b65 5f6d 706c 5f70  _cs = make_mpl_p
+00004a40: 726f 7065 7274 6965 7328 6178 6973 5f6c  roperties(axis_l
+00004a50: 656e 6774 6820 290d 0a20 2020 200d 0a20  ength )..    .. 
+00004a60: 2020 2020 236d 616e 6167 6520 636f 6c6f      #manage colo
+00004a70: 7273 200d 0a20 2020 2023 2077 6520 6173  rs ..    # we as
+00004a80: 7375 6d65 2074 6865 2066 6972 7374 2063  sume the first c
+00004a90: 6f6c 756d 6e73 2069 7320 6465 6469 6361  olumns is dedica
+00004aa0: 7465 6420 666f 7220 0d0a 2020 2020 6966  ted for ..    if
+00004ab0: 2063 6f6c 6f72 7320 3d3d 2e2e 2e3a 2063   colors ==...: c
+00004ac0: 6f6c 6f72 7320 3d4e 6f6e 6520 0d0a 2020  olors =None ..  
+00004ad0: 2020 6966 2028 200d 0a20 2020 2020 2020    if ( ..       
+00004ae0: 2020 2020 2069 7369 6e73 7461 6e63 6520       isinstance 
+00004af0: 2863 6f6c 6f72 732c 2073 7472 2920 616e  (colors, str) an
+00004b00: 6420 0d0a 2020 2020 2020 2020 2020 2020  d ..            
+00004b10: 2820 0d0a 2020 2020 2020 2020 2020 2020  ( ..            
+00004b20: 2020 2020 2263 7334 2220 696e 2073 7472      "cs4" in str
+00004b30: 2863 6f6c 6f72 7329 2e6c 6f77 6572 2829  (colors).lower()
+00004b40: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00004b50: 2020 2020 6f72 2027 786b 6364 2720 696e      or 'xkcd' in
+00004b60: 2073 7472 2863 6f6c 6f72 7329 2e6c 6f77   str(colors).low
+00004b70: 6572 2829 200d 0a20 2020 2020 2020 2020  er() ..         
+00004b80: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+00004b90: 2020 2020 2020 2029 3a20 0d0a 2020 2020         ): ..    
+00004ba0: 2020 2020 2369 6e69 7469 6c69 7a65 2063      #initilize c
+00004bb0: 6f6c 6f72 7320 696e 666f 730d 0a20 2020  olors infos..   
+00004bc0: 2020 2020 2063 203d 2063 6f70 792e 6465       c = copy.de
+00004bd0: 6570 636f 7079 2863 6f6c 6f72 7329 0d0a  epcopy(colors)..
+00004be0: 2020 2020 2020 2020 6966 2027 6373 3427          if 'cs4'
+00004bf0: 2069 6e20 7374 7228 636f 6c6f 7273 292e   in str(colors).
+00004c00: 6c6f 7765 7228 2920 3a20 0d0a 2020 2020  lower() : ..    
+00004c10: 2020 2020 2020 2020 4443 4f4c 4f52 5320          DCOLORS 
+00004c20: 3d20 6d63 6f6c 6f72 732e 4353 5334 5f43  = mcolors.CSS4_C
+00004c30: 4f4c 4f52 530d 0a20 2020 2020 2020 2065  OLORS..        e
+00004c40: 6c73 653a 200d 0a20 2020 2020 2020 2020  lse: ..         
+00004c50: 2020 2023 2072 656d 616b 6520 7468 6520     # remake the 
+00004c60: 6463 6f6c 6f72 7320 6d79 2072 656d 6f76  dcolors my remov
+00004c70: 696e 6720 7468 6520 786b 6364 3a20 696e  ing the xkcd: in
+00004c80: 2074 6865 206b 6579 733a 200d 0a20 2020   the keys: ..   
+00004c90: 2020 2020 2020 2020 2044 434f 4c4f 5253           DCOLORS
+00004ca0: 203d 2064 6963 7428 2820 286b 2e72 6570   = dict(( (k.rep
+00004cb0: 6c61 6365 2028 2778 6b63 643a 272c 2027  lace ('xkcd:', '
+00004cc0: 2729 2c20 6329 200d 0a20 2020 2020 2020  '), c) ..       
+00004cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ce0: 2020 2020 2066 6f72 206b 2c20 6320 696e       for k, c in
+00004cf0: 206d 636f 6c6f 7273 2e58 4b43 445f 434f   mcolors.XKCD_CO
+00004d00: 4c4f 5253 2e69 7465 6d73 2829 2929 2020  LORS.items()))  
+00004d10: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00004d20: 2020 2020 6b65 795f 636f 6c6f 7273 203d      key_colors =
+00004d30: 206c 6973 7428 4443 4f4c 4f52 532e 6b65   list(DCOLORS.ke
+00004d40: 7973 2028 2929 0d0a 2020 2020 2020 2020  ys ())..        
+00004d50: 636f 6c6f 7273 203d 206c 6973 7428 4443  colors = list(DC
+00004d60: 4f4c 4f52 532e 7661 6c75 6573 2829 2029  OLORS.values() )
+00004d70: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00004d80: 2020 2020 7368 7566 666c 655f 6373 343d      shuffle_cs4=
+00004d90: 5472 7565 200d 0a20 2020 2020 2020 200d  True ..        .
+00004da0: 0a20 2020 2020 2020 2063 7334 5f73 7461  .        cs4_sta
+00004db0: 7274 3d20 4e6f 6e65 0d0a 2020 2020 2020  rt= None..      
+00004dc0: 2020 232d 2d2d 2d2d 2d0d 0a20 2020 2020    #------..     
+00004dd0: 2020 2069 6620 273a 2720 696e 2073 7472     if ':' in str
+00004de0: 2863 292e 6c6f 7765 7228 293a 0d0a 2020  (c).lower():..  
+00004df0: 2020 2020 2020 2020 2020 6373 345f 7374            cs4_st
+00004e00: 6172 7420 3d20 7374 7228 6329 2e6c 6f77  art = str(c).low
+00004e10: 6572 2829 2e73 706c 6974 2827 3a27 295b  er().split(':')[
+00004e20: 2d31 5d0d 0a20 2020 2020 2020 2023 7472  -1]..        #tr
+00004e30: 7920 746f 2063 6f6e 7665 7265 7274 2069  y to converert i
+00004e40: 6e74 6f20 696e 7465 6765 7220 0d0a 2020  nto integer ..  
+00004e50: 2020 2020 2020 7472 793a 200d 0a20 2020        try: ..   
+00004e60: 2020 2020 2020 2020 2063 7334 5f73 7461           cs4_sta
+00004e70: 7274 3d20 696e 7420 2863 7334 5f73 7461  rt= int (cs4_sta
+00004e80: 7274 290d 0a20 2020 2020 2020 2065 7863  rt)..        exc
+00004e90: 6570 7420 3a20 0d0a 2020 2020 2020 2020  ept : ..        
+00004ea0: 2020 2020 6966 2073 7472 2863 7334 5f73      if str(cs4_s
+00004eb0: 7461 7274 292e 6c6f 7765 7228 2920 696e  tart).lower() in
+00004ec0: 206b 6579 5f63 6f6c 6f72 733a 200d 0a20   key_colors: .. 
+00004ed0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00004ee0: 7334 5f73 7461 7274 3d20 6b65 795f 636f  s4_start= key_co
+00004ef0: 6c6f 7273 2e69 6e64 6578 2028 6373 345f  lors.index (cs4_
+00004f00: 7374 6172 7429 0d0a 2020 2020 2020 2020  start)..        
+00004f10: 2020 2020 2020 2020 7368 7566 666c 655f          shuffle_
+00004f20: 6373 343d 4661 6c73 650d 0a20 2020 2020  cs4=False..     
+00004f30: 2020 2020 2020 2065 6c73 653a 200d 0a20         else: .. 
+00004f40: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00004f50: 6173 7320 0d0a 2020 2020 2020 2020 0d0a  ass ..        ..
+00004f60: 2020 2020 2020 2020 656c 7365 3a20 7368          else: sh
+00004f70: 7566 666c 655f 6373 343d 4661 6c73 6520  uffle_cs4=False 
+00004f80: 2320 6b65 6570 2043 5334 2061 6e64 2064  # keep CS4 and d
+00004f90: 6f6e 7420 7368 7566 666c 6520 0d0a 2020  ont shuffle ..  
+00004fa0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00004fb0: 6373 345f 7374 6172 743d 2063 7334 5f73  cs4_start= cs4_s
+00004fc0: 7461 7274 206f 7220 300d 0a20 2020 2020  tart or 0..     
+00004fd0: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
+00004fe0: 7368 7566 666c 655f 6373 343a 200d 0a20  shuffle_cs4: .. 
+00004ff0: 2020 2020 2020 2020 2020 206e 702e 7261             np.ra
+00005000: 6e64 6f6d 2e73 6565 6420 2873 6565 6420  ndom.seed (seed 
+00005010: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
+00005020: 6f6c 6f72 7320 3d20 6c69 7374 286e 702e  olors = list(np.
+00005030: 7261 6e64 6f6d 2e63 686f 6963 6528 636f  random.choice(co
+00005040: 6c6f 7273 2020 2c20 6c65 6e28 6d5f 6373  lors  , len(m_cs
+00005050: 2929 290d 0a20 2020 2020 2020 2065 6c73  )))..        els
+00005060: 653a 200d 0a20 2020 2020 2020 2020 2020  e: ..           
+00005070: 2069 6620 6373 345f 7374 6172 7420 3e20   if cs4_start > 
+00005080: 6c65 6e28 636f 6c6f 7273 292d 313a 200d  len(colors)-1: .
+00005090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000050a0: 2063 7334 5f73 7461 7274 203d 2030 200d   cs4_start = 0 .
+000050b0: 0a20 2020 200d 0a20 2020 2020 2020 2020  .    ..         
+000050c0: 2020 2063 6f6c 6f72 7320 3d20 636f 6c6f     colors = colo
+000050d0: 7273 5b20 6373 345f 7374 6172 743a 5d0d  rs[ cs4_start:].
+000050e0: 0a20 2020 200d 0a20 2020 2069 6620 636f  .    ..    if co
+000050f0: 6c6f 7273 2069 7320 6e6f 7420 4e6f 6e65  lors is not None
+00005100: 3a20 0d0a 2020 2020 2020 2020 6966 206e  : ..        if n
+00005110: 6f74 2069 735f 6974 6572 6162 6c65 2863  ot is_iterable(c
+00005120: 6f6c 6f72 7329 3a20 0d0a 2020 2020 2020  olors): ..      
+00005130: 2020 2020 2020 636f 6c6f 7273 203d 5b63        colors =[c
+00005140: 6f6c 6f72 735d 0d0a 2020 2020 2020 2020  olors]..        
+00005150: 636f 6c6f 7273 202b 3d20 6d5f 6373 200d  colors += m_cs .
+00005160: 0a20 2020 2065 6c73 6520 3a0d 0a20 2020  .    else :..   
+00005170: 2020 2020 2063 6f6c 6f72 7320 3d20 6d5f       colors = m_
+00005180: 6373 200d 0a20 2020 2020 2020 200d 0a20  cs ..        .. 
+00005190: 2020 2023 2073 6872 756e 6b20 6461 7461     # shrunk data
+000051a0: 2074 6f20 6d61 7020 7468 6520 6578 6163   to map the exac
+000051b0: 7420 636f 6c6f 7273 200d 0a20 2020 2063  t colors ..    c
+000051c0: 6875 6e6b 203d 5472 7565 2069 6620 6368  hunk =True if ch
+000051d0: 756e 6b20 6973 202e 2e2e 2065 6c73 6520  unk is ... else 
+000051e0: 4661 6c73 6520 0d0a 2020 2020 7265 7475  False ..    retu
+000051f0: 726e 2063 6f6c 6f72 735b 3a61 7869 735f  rn colors[:axis_
+00005200: 6c65 6e67 7468 5d20 6966 2063 6875 6e6b  length] if chunk
+00005210: 2065 6c73 6520 636f 6c6f 7273 200d 0a0d   else colors ...
+00005220: 0a0d 0a64 6566 2070 6c6f 745f 7369 6c68  ...def plot_silh
+00005230: 6f75 6574 7465 2028 582c 206c 6162 656c  ouette (X, label
+00005240: 732c 206d 6574 7269 6320 3d27 6575 636c  s, metric ='eucl
+00005250: 6964 6561 6e27 2c73 6176 6566 6967 203d  idean',savefig =
+00005260: 4e6f 6e65 202c 202a 2a6b 7764 7320 293a  None , **kwds ):
+00005270: 0d0a 2020 2020 7222 2222 506c 6f74 2071  ..    r"""Plot q
+00005280: 7561 6e74 6966 7969 6e67 2074 6865 2071  uantifying the q
+00005290: 7561 6c69 7479 2020 6f66 2063 6c75 7374  uality  of clust
+000052a0: 6572 696e 6720 7369 6c68 6f75 6574 7465  ering silhouette
+000052b0: 200d 0a20 2020 200d 0a20 2020 2050 6172   ..    ..    Par
+000052c0: 616d 6574 6572 7320 0d0a 2020 2020 2d2d  ameters ..    --
+000052d0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2058 203a  -------..    X :
+000052e0: 2061 7272 6179 2d6c 696b 6520 6f66 2073   array-like of s
+000052f0: 6861 7065 2028 6e5f 7361 6d70 6c65 735f  hape (n_samples_
+00005300: 612c 206e 5f73 616d 706c 6573 5f61 2920  a, n_samples_a) 
+00005310: 6966 206d 6574 7269 6320 3d3d 205c 0d0a  if metric == \..
+00005320: 2020 2020 2020 2020 2020 2020 2270 7265              "pre
+00005330: 636f 6d70 7574 6564 2220 6f72 2028 6e5f  computed" or (n_
+00005340: 7361 6d70 6c65 735f 612c 206e 5f66 6561  samples_a, n_fea
+00005350: 7475 7265 7329 206f 7468 6572 7769 7365  tures) otherwise
+00005360: 0d0a 2020 2020 2020 2020 416e 2061 7272  ..        An arr
+00005370: 6179 206f 6620 7061 6972 7769 7365 2064  ay of pairwise d
+00005380: 6973 7461 6e63 6573 2062 6574 7765 656e  istances between
+00005390: 2073 616d 706c 6573 2c20 6f72 2061 2066   samples, or a f
+000053a0: 6561 7475 7265 2061 7272 6179 2e0d 0a0d  eature array....
+000053b0: 0a20 2020 206c 6162 656c 7320 3a20 6172  .    labels : ar
+000053c0: 7261 792d 6c69 6b65 206f 6620 7368 6170  ray-like of shap
+000053d0: 6520 286e 5f73 616d 706c 6573 2c29 0d0a  e (n_samples,)..
+000053e0: 2020 2020 2020 2020 4c61 6265 6c20 7661          Label va
+000053f0: 6c75 6573 2066 6f72 2065 6163 6820 7361  lues for each sa
+00005400: 6d70 6c65 2e0d 0a0d 0a20 2020 206d 6574  mple.....    met
+00005410: 7269 6320 3a20 7374 7220 6f72 2063 616c  ric : str or cal
+00005420: 6c61 626c 652c 2064 6566 6175 6c74 3d27  lable, default='
+00005430: 6575 636c 6964 6561 6e27 0d0a 2020 2020  euclidean'..    
+00005440: 2020 2020 5468 6520 6d65 7472 6963 2074      The metric t
+00005450: 6f20 7573 6520 7768 656e 2063 616c 6375  o use when calcu
+00005460: 6c61 7469 6e67 2064 6973 7461 6e63 6520  lating distance 
+00005470: 6265 7477 6565 6e20 696e 7374 616e 6365  between instance
+00005480: 7320 696e 2061 0d0a 2020 2020 2020 2020  s in a..        
+00005490: 6665 6174 7572 6520 6172 7261 792e 2049  feature array. I
+000054a0: 6620 6d65 7472 6963 2069 7320 6120 7374  f metric is a st
+000054b0: 7269 6e67 2c20 6974 206d 7573 7420 6265  ring, it must be
+000054c0: 206f 6e65 206f 6620 7468 6520 6f70 7469   one of the opti
+000054d0: 6f6e 730d 0a20 2020 2020 2020 2061 6c6c  ons..        all
+000054e0: 6f77 6564 2062 7920 3a66 756e 633a 6073  owed by :func:`s
+000054f0: 6b6c 6561 726e 2e6d 6574 7269 6373 2e70  klearn.metrics.p
+00005500: 6169 7277 6973 652e 7061 6972 7769 7365  airwise.pairwise
+00005510: 5f64 6973 7461 6e63 6573 602e 0d0a 2020  _distances`...  
+00005520: 2020 2020 2020 4966 2060 6058 6060 2069        If ``X`` i
+00005530: 7320 7468 6520 6469 7374 616e 6365 2061  s the distance a
+00005540: 7272 6179 2069 7473 656c 662c 2075 7365  rray itself, use
+00005550: 2022 7072 6563 6f6d 7075 7465 6422 2061   "precomputed" a
+00005560: 7320 7468 6520 6d65 7472 6963 2e0d 0a20  s the metric... 
+00005570: 2020 2020 2020 2050 7265 636f 6d70 7574         Precomput
+00005580: 6564 2064 6973 7461 6e63 6520 6d61 7472  ed distance matr
+00005590: 6963 6573 206d 7573 7420 6861 7665 2030  ices must have 0
+000055a0: 2061 6c6f 6e67 2074 6865 2064 6961 676f   along the diago
+000055b0: 6e61 6c2e 0d0a 2020 2020 2020 2020 0d0a  nal...        ..
+000055c0: 2020 2020 7361 7665 6669 673a 2073 7472      savefig: str
+000055d0: 2c20 6465 6661 756c 7420 3d4e 6f6e 6520  , default =None 
+000055e0: 2c20 0d0a 2020 2020 2020 2020 7468 6520  , ..        the 
+000055f0: 7061 7468 2074 6f20 7361 7665 2074 6865  path to save the
+00005600: 2066 6967 7572 652e 2041 7267 756d 656e   figure. Argumen
+00005610: 7420 6973 2070 6173 7365 6420 746f 200d  t is passed to .
+00005620: 0a20 2020 2020 2020 203a 636c 6173 733a  .        :class:
+00005630: 606d 6174 706c 6f74 6c69 622e 4669 6775  `matplotlib.Figu
+00005640: 7265 6020 636c 6173 732e 200d 0a20 2020  re` class. ..   
+00005650: 2020 2020 200d 0a20 2020 202a 2a6b 7764       ..    **kwd
+00005660: 7320 3a20 6f70 7469 6f6e 616c 206b 6579  s : optional key
+00005670: 776f 7264 2070 6172 616d 6574 6572 730d  word parameters.
+00005680: 0a20 2020 2020 2020 2041 6e79 2066 7572  .        Any fur
+00005690: 7468 6572 2070 6172 616d 6574 6572 7320  ther parameters 
+000056a0: 6172 6520 7061 7373 6564 2064 6972 6563  are passed direc
+000056b0: 746c 7920 746f 2074 6865 2064 6973 7461  tly to the dista
+000056c0: 6e63 6520 6675 6e63 7469 6f6e 2e0d 0a20  nce function... 
+000056d0: 2020 2020 2020 2049 6620 7573 696e 6720         If using 
+000056e0: 6120 6060 7363 6970 792e 7370 6174 6961  a ``scipy.spatia
+000056f0: 6c2e 6469 7374 616e 6365 6060 206d 6574  l.distance`` met
+00005700: 7269 632c 2074 6865 2070 6172 616d 6574  ric, the paramet
+00005710: 6572 7320 6172 6520 7374 696c 6c0d 0a20  ers are still.. 
+00005720: 2020 2020 2020 206d 6574 7269 6320 6465         metric de
+00005730: 7065 6e64 656e 742e 2053 6565 2074 6865  pendent. See the
+00005740: 2073 6369 7079 2064 6f63 7320 666f 7220   scipy docs for 
+00005750: 7573 6167 6520 6578 616d 706c 6573 2e0d  usage examples..
+00005760: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00005770: 2020 200d 0a20 2020 2053 6565 2041 6c73     ..    See Als
+00005780: 6f0d 0a20 2020 202d 2d2d 2d2d 2d2d 2d0d  o..    --------.
+00005790: 0a20 2020 2077 6174 6578 2e76 6965 772e  .    watex.view.
+000057a0: 6d6c 706c 6f74 2e70 6c6f 7453 696c 686f  mlplot.plotSilho
+000057b0: 7565 7474 653a 200d 0a20 2020 2020 2020  uette: ..       
+000057c0: 2047 6976 6573 2063 6f6e 7369 7374 656e   Gives consisten
+000057d0: 6379 2070 6c6f 7420 6173 2074 6865 2075  cy plot as the u
+000057e0: 7365 206f 6620 6070 7265 6669 7460 2070  se of `prefit` p
+000057f0: 6172 616d 6574 6572 2077 6869 6368 2063  arameter which c
+00005800: 6865 636b 7320 0d0a 2020 2020 2020 2020  hecks ..        
+00005810: 7768 6574 6865 7260 6c61 6265 6c73 6020  whether`labels` 
+00005820: 6172 6520 6578 7065 6374 6564 2074 6f20  are expected to 
+00005830: 6265 2070 6173 7365 6420 696e 746f 2074  be passed into t
+00005840: 6865 2066 756e 6374 696f 6e20 0d0a 2020  he function ..  
+00005850: 2020 2020 2020 6469 7265 6374 6c79 206f        directly o
+00005860: 7220 6e6f 742e 200d 0a20 2020 200d 0a20  r not. ..    .. 
+00005870: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
+00005880: 202d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020   ---------..    
+00005890: 3e3e 3e20 696d 706f 7274 206e 756d 7079  >>> import numpy
+000058a0: 2061 7320 6e70 200d 0a20 2020 203e 3e3e   as np ..    >>>
+000058b0: 2066 726f 6d20 7761 7465 782e 6578 6c69   from watex.exli
+000058c0: 622e 736b 6c65 6172 6e20 696d 706f 7274  b.sklearn import
+000058d0: 204b 4d65 616e 7320 0d0a 2020 2020 3e3e   KMeans ..    >>
+000058e0: 3e20 6672 6f6d 2077 6174 6578 2e64 6174  > from watex.dat
+000058f0: 6173 6574 7320 696d 706f 7274 206c 6f61  asets import loa
+00005900: 645f 6972 6973 200d 0a20 2020 203e 3e3e  d_iris ..    >>>
+00005910: 2066 726f 6d20 7761 7465 782e 7574 696c   from watex.util
+00005920: 732e 706c 6f74 7574 696c 7320 696d 706f  s.plotutils impo
+00005930: 7274 2070 6c6f 745f 7369 6c68 6f75 6574  rt plot_silhouet
+00005940: 7465 0d0a 2020 2020 3e3e 3e20 643d 206c  te..    >>> d= l
+00005950: 6f61 645f 6972 6973 2028 290d 0a20 2020  oad_iris ()..   
+00005960: 203e 3e3e 2058 3d20 642e 6461 7461 205b   >>> X= d.data [
+00005970: 3a2c 2030 5d5b 3a2c 206e 702e 6e65 7761  :, 0][:, np.newa
+00005980: 7869 735d 2023 2074 616b 6520 7468 6520  xis] # take the 
+00005990: 6669 7273 7420 6178 6973 200d 0a20 2020  first axis ..   
+000059a0: 203e 3e3e 206b 6d3d 204b 4d65 616e 7320   >>> km= KMeans 
+000059b0: 286e 5f63 6c75 7374 6572 7320 3d33 202c  (n_clusters =3 ,
+000059c0: 2069 6e69 743d 276b 2d6d 6561 6e73 2b2b   init='k-means++
+000059d0: 272c 206e 5f69 6e69 7420 3d31 3020 2c20  ', n_init =10 , 
+000059e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000059f0: 2020 2020 2020 6d61 785f 6974 6572 203d        max_iter =
+00005a00: 2033 3030 202c 200d 0a20 2020 2020 2020   300 , ..       
+00005a10: 2020 2020 2020 2020 2020 2020 2074 6f6c               tol
+00005a20: 3d31 652d 342c 200d 0a20 2020 2020 2020  =1e-4, ..       
+00005a30: 2020 2020 2020 2020 2020 2020 2072 616e               ran
+00005a40: 646f 6d5f 7374 6174 6520 3d30 200d 0a20  dom_state =0 .. 
+00005a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005a60: 2020 2029 0d0a 2020 2020 3e3e 3e20 795f     )..    >>> y_
+00005a70: 6b6d 203d 206b 6d2e 6669 745f 7072 6564  km = km.fit_pred
+00005a80: 6963 7428 5829 200d 0a20 2020 203e 3e3e  ict(X) ..    >>>
+00005a90: 2070 6c6f 745f 7369 6c68 6f75 6574 7465   plot_silhouette
+00005aa0: 2028 582c 2079 5f6b 6d29 0d0a 0d0a 2020   (X, y_km)....  
+00005ab0: 2020 2222 220d 0a20 2020 2058 2c20 6c61    """..    X, la
+00005ac0: 6265 6c73 203d 2063 6865 636b 5f58 5f79  bels = check_X_y
+00005ad0: 280d 0a20 2020 2020 2020 2058 2c20 0d0a  (..        X, ..
+00005ae0: 2020 2020 2020 2020 6c61 6265 6c73 2c20          labels, 
+00005af0: 0d0a 2020 2020 2020 2020 746f 5f66 7261  ..        to_fra
+00005b00: 6d65 3d20 5472 7565 2c20 0d0a 2020 2020  me= True, ..    
+00005b10: 2020 2020 290d 0a20 2020 2063 6c75 7374      )..    clust
+00005b20: 6572 5f6c 6162 656c 7320 3d20 6e70 2e75  er_labels = np.u
+00005b30: 6e69 7175 6520 286c 6162 656c 7329 200d  nique (labels) .
+00005b40: 0a20 2020 206e 5f63 6c75 7374 6572 7320  .    n_clusters 
+00005b50: 3d20 636c 7573 7465 725f 6c61 6265 6c73  = cluster_labels
+00005b60: 2e73 6861 7065 205b 305d 200d 0a20 2020  .shape [0] ..   
+00005b70: 2073 696c 686f 7565 7474 655f 7661 6c73   silhouette_vals
+00005b80: 203d 2073 696c 686f 7565 7474 655f 7361   = silhouette_sa
+00005b90: 6d70 6c65 7328 0d0a 2020 2020 2020 2020  mples(..        
+00005ba0: 582c 206c 6162 656c 733d 206c 6162 656c  X, labels= label
+00005bb0: 732c 206d 6574 7269 6320 3d20 6d65 7472  s, metric = metr
+00005bc0: 6963 202c 2a2a 6b77 6473 290d 0a20 2020  ic ,**kwds)..   
+00005bd0: 2079 5f61 785f 6c6f 7765 7220 2c20 795f   y_ax_lower , y_
+00005be0: 6178 5f75 7070 6572 203d 2030 2c20 3020  ax_upper = 0, 0 
+00005bf0: 0d0a 2020 2020 7974 6963 6b73 203d 5b5d  ..    yticks =[]
+00005c00: 0d0a 2020 2020 0d0a 2020 2020 666f 7220  ..    ..    for 
+00005c10: 692c 2063 2020 696e 2065 6e75 6d65 7261  i, c  in enumera
+00005c20: 7465 2028 636c 7573 7465 725f 6c61 6265  te (cluster_labe
+00005c30: 6c73 2029 203a 200d 0a20 2020 2020 2020  ls ) : ..       
+00005c40: 2063 5f73 696c 686f 7565 7474 655f 7661   c_silhouette_va
+00005c50: 6c73 203d 2073 696c 686f 7565 7474 655f  ls = silhouette_
+00005c60: 7661 6c73 5b6c 6162 656c 7320 3d3d 6320  vals[labels ==c 
+00005c70: 5d20 0d0a 2020 2020 2020 2020 635f 7369  ] ..        c_si
+00005c80: 6c68 6f75 6574 7465 5f76 616c 732e 736f  lhouette_vals.so
+00005c90: 7274 2829 0d0a 2020 2020 2020 2020 795f  rt()..        y_
+00005ca0: 6178 5f75 7070 6572 202b 3d20 6c65 6e28  ax_upper += len(
+00005cb0: 635f 7369 6c68 6f75 6574 7465 5f76 616c  c_silhouette_val
+00005cc0: 7329 0d0a 2020 2020 2020 2020 636f 6c6f  s)..        colo
+00005cd0: 7220 3d6d 706c 2e63 6d2e 6a65 7420 2866  r =mpl.cm.jet (f
+00005ce0: 6c6f 6174 2869 292f 6e5f 636c 7573 7465  loat(i)/n_cluste
+00005cf0: 7273 2029 0d0a 2020 2020 2020 2020 706c  rs )..        pl
+00005d00: 742e 6261 7268 2872 616e 6765 2879 5f61  t.barh(range(y_a
+00005d10: 785f 6c6f 7765 722c 2079 5f61 785f 7570  x_lower, y_ax_up
+00005d20: 7065 7229 2c20 635f 7369 6c68 6f75 6574  per), c_silhouet
+00005d30: 7465 5f76 616c 732c 200d 0a20 2020 2020  te_vals, ..     
+00005d40: 2020 2020 2020 2020 2020 2020 6865 6967              heig
+00005d50: 6874 203d 312e 3020 2c20 0d0a 2020 2020  ht =1.0 , ..    
+00005d60: 2020 2020 2020 2020 2020 2020 2065 6467               edg
+00005d70: 6563 6f6c 6f72 203d 276e 6f6e 6527 2c20  ecolor ='none', 
+00005d80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005d90: 2020 2063 6f6c 6f72 203d 636f 6c6f 722c     color =color,
+00005da0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00005db0: 2020 2020 290d 0a20 2020 2020 2020 2079      )..        y
+00005dc0: 7469 636b 732e 6170 7065 6e64 2828 795f  ticks.append((y_
+00005dd0: 6178 5f6c 6f77 6572 202b 2079 5f61 785f  ax_lower + y_ax_
+00005de0: 7570 7065 7229 2f32 2e29 0d0a 2020 2020  upper)/2.)..    
+00005df0: 2020 2020 795f 6178 5f6c 6f77 6572 202b      y_ax_lower +
+00005e00: 3d20 6c65 6e28 635f 7369 6c68 6f75 6574  = len(c_silhouet
+00005e10: 7465 5f76 616c 7329 0d0a 2020 2020 7369  te_vals)..    si
+00005e20: 6c68 6f75 6574 7465 5f61 7667 203d 206e  lhouette_avg = n
+00005e30: 702e 6d65 616e 2873 696c 686f 7565 7474  p.mean(silhouett
+00005e40: 655f 7661 6c73 2920 0d0a 2020 2020 706c  e_vals) ..    pl
+00005e50: 742e 6178 766c 696e 6520 2873 696c 686f  t.axvline (silho
+00005e60: 7565 7474 655f 6176 672c 200d 0a20 2020  uette_avg, ..   
+00005e70: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00005e80: 6c6f 723d 2772 6564 272c 200d 0a20 2020  lor='red', ..   
+00005e90: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00005ea0: 6e65 7374 796c 6520 3d27 2d2d 270d 0a20  nestyle ='--'.. 
+00005eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ec0: 290d 0a20 2020 2070 6c74 2e79 7469 636b  )..    plt.ytick
+00005ed0: 7328 7974 6963 6b73 2c20 636c 7573 7465  s(yticks, cluste
+00005ee0: 725f 6c61 6265 6c73 202b 3120 2920 0d0a  r_labels +1 ) ..
+00005ef0: 2020 2020 706c 742e 796c 6162 656c 2028      plt.ylabel (
+00005f00: 2243 6c75 7374 6572 2229 200d 0a20 2020  "Cluster") ..   
+00005f10: 2070 6c74 2e78 6c61 6265 6c20 2822 5369   plt.xlabel ("Si
+00005f20: 6c68 6f75 6574 7465 2063 6f65 6666 6963  lhouette coeffic
+00005f30: 6965 6e74 2229 0d0a 2020 2020 706c 742e  ient")..    plt.
+00005f40: 7469 6768 745f 6c61 796f 7574 2829 0d0a  tight_layout()..
+00005f50: 0d0a 2020 2020 6966 2073 6176 6566 6967  ..    if savefig
+00005f60: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+00005f70: 2020 2020 2020 2070 6c74 2e73 6176 6566         plt.savef
+00005f80: 6967 2873 6176 6566 6967 2c20 6470 6920  ig(savefig, dpi 
+00005f90: 3d20 3330 3020 290d 0a20 2020 2020 2020  = 300 )..       
+00005fa0: 200d 0a20 2020 2070 6c74 2e63 6c6f 7365   ..    plt.close
+00005fb0: 2028 2920 6966 2073 6176 6566 6967 2069   () if savefig i
+00005fc0: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
+00005fd0: 706c 742e 7368 6f77 2829 200d 0a20 2020  plt.show() ..   
+00005fe0: 200d 0a0d 0a64 6566 2070 6c6f 745f 7362   ....def plot_sb
+00005ff0: 735f 6665 6174 7572 655f 7365 6c65 6374  s_feature_select
+00006000: 696f 6e20 280d 0a20 2020 2020 2020 2073  ion (..        s
+00006010: 6273 5f65 7374 696d 6174 6f72 2c2f 2c20  bs_estimator,/, 
+00006020: 2058 3d4e 6f6e 652c 2079 3d4e 6f6e 6520   X=None, y=None 
+00006030: 2c66 6967 5f73 697a 653d 2838 2c20 3529  ,fig_size=(8, 5)
+00006040: 2c20 0d0a 2020 2020 2020 2020 736e 735f  , ..        sns_
+00006050: 7374 796c 6520 3d46 616c 7365 2c20 7361  style =False, sa
+00006060: 7665 6669 6720 3d20 4e6f 6e65 2c20 7665  vefig = None, ve
+00006070: 7262 6f73 653d 3020 2c20 0d0a 2020 2020  rbose=0 , ..    
+00006080: 2020 2020 2a2a 7362 735f 6b77 730d 0a20      **sbs_kws.. 
+00006090: 2020 2020 2020 2029 3a20 0d0a 2020 2020         ): ..    
+000060a0: 2222 2270 6c6f 7420 5365 7175 656e 7469  """plot Sequenti
+000060b0: 616c 2042 6163 6b77 6172 6420 5365 6c65  al Backward Sele
+000060c0: 6374 696f 6e20 2853 4253 2920 666f 7220  ction (SBS) for 
+000060d0: 6665 6174 7572 6520 7365 6c65 6374 696f  feature selectio
+000060e0: 6e2e 2020 0d0a 2020 2020 0d0a 2020 2020  n.  ..    ..    
+000060f0: 5342 5320 636f 6c6c 6563 7473 2074 6865  SBS collects the
+00006100: 2073 636f 7265 7320 6f66 2074 6865 2020   scores of the  
+00006110: 6265 7374 2066 6561 7475 7265 2073 7562  best feature sub
+00006120: 7365 7420 6174 2065 6163 6820 7374 6167  set at each stag
+00006130: 652e 200d 0a20 2020 200d 0a20 2020 2050  e. ..    ..    P
+00006140: 6172 616d 6574 6572 7320 0d0a 2020 2020  arameters ..    
+00006150: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
+00006160: 2020 7362 735f 6573 7469 6d61 746f 7220    sbs_estimator 
+00006170: 3a20 3a63 6c61 7373 3a60 7e2e 7761 7465  : :class:`~.wate
+00006180: 782e 6261 7365 2e53 6571 7565 6e74 6961  x.base.Sequentia
+00006190: 6c42 6163 6b77 6172 6453 656c 6563 7469  lBackwardSelecti
+000061a0: 6f6e 605c 0d0a 2020 2020 2020 2020 6573  on`\..        es
+000061b0: 7469 6d61 746f 7220 6f62 6a65 6374 0d0a  timator object..
+000061c0: 2020 2020 2020 2020 5468 6520 5365 7175          The Sequ
+000061d0: 656e 7469 616c 2042 6163 6b77 6172 6420  ential Backward 
+000061e0: 5365 6c65 6374 696f 6e20 6573 7469 6d61  Selection estima
+000061f0: 746f 7220 6361 6e20 6569 7468 6572 2062  tor can either b
+00006200: 6520 6669 7474 6564 206f 7220 0d0a 2020  e fitted or ..  
+00006210: 2020 2020 2020 6e6f 742e 2049 6620 6e6f        not. If no
+00006220: 7420 6669 7474 6564 2e20 506c 6561 7365  t fitted. Please
+00006230: 2070 726f 7669 6465 2074 6865 2074 7261   provide the tra
+00006240: 696e 696e 6720 6058 6020 616e 6420 6079  ining `X` and `y
+00006250: 602c 200d 0a20 2020 2020 2020 206f 7468  `, ..        oth
+00006260: 6572 7769 7365 2061 6e20 6572 726f 7220  erwise an error 
+00006270: 7769 6c6c 206f 6363 7572 732e 0d0a 2020  will occurs...  
+00006280: 2020 2020 2020 0d0a 2020 2020 5820 3a20        ..    X : 
+00006290: 6172 7261 792d 6c69 6b65 206f 6620 7368  array-like of sh
+000062a0: 6170 6520 286e 5f73 616d 706c 6573 2c20  ape (n_samples, 
+000062b0: 6e5f 6665 6174 7572 6573 290d 0a20 2020  n_features)..   
+000062c0: 2020 2020 2054 7261 696e 696e 6720 7665       Training ve
+000062d0: 6374 6f72 2c20 7768 6572 6520 606e 5f73  ctor, where `n_s
+000062e0: 616d 706c 6573 6020 6973 2074 6865 206e  amples` is the n
+000062f0: 756d 6265 7220 6f66 2073 616d 706c 6573  umber of samples
+00006300: 2061 6e64 0d0a 2020 2020 2020 2020 606e   and..        `n
+00006310: 5f66 6561 7475 7265 7360 2069 7320 7468  _features` is th
+00006320: 6520 6e75 6d62 6572 206f 6620 6665 6174  e number of feat
+00006330: 7572 6573 2e0d 0a0d 0a20 2020 2079 203a  ures.....    y :
+00006340: 2061 7272 6179 2d6c 696b 6520 6f66 2073   array-like of s
+00006350: 6861 7065 2028 6e5f 7361 6d70 6c65 732c  hape (n_samples,
+00006360: 2920 6f72 2028 6e5f 7361 6d70 6c65 732c  ) or (n_samples,
+00006370: 206e 5f6f 7574 7075 7473 290d 0a20 2020   n_outputs)..   
+00006380: 2020 2020 2054 6172 6765 7420 7265 6c61       Target rela
+00006390: 7469 7665 2074 6f20 5820 666f 7220 636c  tive to X for cl
+000063a0: 6173 7369 6669 6361 7469 6f6e 206f 7220  assification or 
+000063b0: 7265 6772 6573 7369 6f6e 3b0d 0a20 2020  regression;..   
+000063c0: 2020 2020 204e 6f6e 6520 666f 7220 756e       None for un
+000063d0: 7375 7065 7276 6973 6564 206c 6561 726e  supervised learn
+000063e0: 696e 672e 0d0a 2020 2020 2020 200d 0a20  ing...       .. 
+000063f0: 2020 206e 5f65 7374 696d 6174 6f72 7320     n_estimators 
+00006400: 3a20 696e 742c 2064 6566 6175 6c74 3d35  : int, default=5
+00006410: 3030 0d0a 2020 2020 2020 2020 5468 6520  00..        The 
+00006420: 6e75 6d62 6572 206f 6620 7472 6565 7320  number of trees 
+00006430: 696e 2074 6865 2066 6f72 6573 742e 0d0a  in the forest...
+00006440: 2020 2020 2020 2020 0d0a 2020 2020 6669          ..    fi
+00006450: 675f 7369 7a65 203a 2074 7570 6c65 2028  g_size : tuple (
+00006460: 7769 6474 682c 2068 6569 6768 7429 2c20  width, height), 
+00006470: 6465 6661 756c 7420 3d28 382c 2036 290d  default =(8, 6).
+00006480: 0a20 2020 2020 2020 2074 6865 206d 6174  .        the mat
+00006490: 706c 6f74 6c69 6220 6669 6775 7265 2073  plotlib figure s
+000064a0: 697a 6520 6769 7665 6e20 6173 2061 2074  ize given as a t
+000064b0: 7570 6c65 206f 6620 7769 6474 6820 616e  uple of width an
+000064c0: 6420 6865 6967 6874 0d0a 2020 2020 2020  d height..      
+000064d0: 2020 0d0a 2020 2020 7361 7665 6669 673a    ..    savefig:
+000064e0: 2073 7472 2c20 6465 6661 756c 7420 3d4e   str, default =N
+000064f0: 6f6e 6520 2c20 0d0a 2020 2020 2020 2020  one , ..        
+00006500: 7468 6520 7061 7468 2074 6f20 7361 7665  the path to save
+00006510: 2074 6865 2066 6967 7572 6573 2e20 4172   the figures. Ar
+00006520: 6775 6d65 6e74 2069 7320 7061 7373 6564  gument is passed
+00006530: 2074 6f20 6d61 7470 6c6f 746c 6962 2e46   to matplotlib.F
+00006540: 6967 7572 6520 0d0a 2020 2020 2020 2020  igure ..        
+00006550: 636c 6173 732e 200d 0a20 2020 2073 6e73  class. ..    sns
+00006560: 5f73 7479 6c65 3a20 7374 722c 206f 7074  _style: str, opt
+00006570: 696f 6e61 6c2c 200d 0a20 2020 2020 2020  ional, ..       
+00006580: 2074 6865 2073 6561 626f 726e 2073 7479   the seaborn sty
+00006590: 6c65 2e0d 0a20 2020 2076 6572 626f 7365  le...    verbose
+000065a0: 3a20 696e 742c 2064 6566 6175 6c74 3d30  : int, default=0
+000065b0: 200d 0a20 2020 2020 2020 2070 7269 6e74   ..        print
+000065c0: 2074 6865 2066 6561 7475 7265 206c 6162   the feature lab
+000065d0: 656c 7320 7769 7468 2074 6865 2072 6174  els with the rat
+000065e0: 6520 6f66 2074 6865 6972 2069 6d70 6f72  e of their impor
+000065f0: 7461 6e63 6573 2e20 0d0a 2020 2020 7362  tances. ..    sb
+00006600: 735f 6b77 733a 2064 6963 742c 200d 0a20  s_kws: dict, .. 
+00006610: 2020 2020 2020 2041 6464 6974 696f 6e61         Additiona
+00006620: 6c20 6b65 7979 776f 7264 2061 7267 756d  l keyyword argum
+00006630: 656e 7473 2070 6173 7365 6420 746f 200d  ents passed to .
+00006640: 0a20 2020 2020 2020 203a 636c 6173 733a  .        :class:
+00006650: 607e 2e77 6174 6578 2e62 6173 652e 5365  `~.watex.base.Se
+00006660: 7175 656e 7469 616c 4261 636b 7761 7264  quentialBackward
+00006670: 5365 6c65 6374 696f 6e60 0d0a 2020 2020  Selection`..    
+00006680: 2020 2020 0d0a 2020 2020 4578 616d 706c      ..    Exampl
+00006690: 6573 200d 0a20 2020 202d 2d2d 2d2d 2d2d  es ..    -------
+000066a0: 2d2d 2d0d 0a20 2020 2028 3129 2d3e 2050  ---..    (1)-> P
+000066b0: 6c6f 7420 6669 7474 6564 2053 4253 2069  lot fitted SBS i
+000066c0: 6e20 6163 7469 6f6e 200d 0a20 2020 203e  n action ..    >
+000066d0: 3e3e 2066 726f 6d20 7761 7465 782e 6578  >> from watex.ex
+000066e0: 6c69 622e 736b 6c65 6172 6e20 696d 706f  lib.sklearn impo
+000066f0: 7274 204b 4e65 6967 6862 6f72 7343 6c61  rt KNeighborsCla
+00006700: 7373 6966 6965 7220 2c20 7472 6169 6e5f  ssifier , train_
+00006710: 7465 7374 5f73 706c 6974 0d0a 2020 2020  test_split..    
+00006720: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e64  >>> from watex.d
+00006730: 6174 6173 6574 7320 696d 706f 7274 2066  atasets import f
+00006740: 6574 6368 5f64 6174 610d 0a20 2020 203e  etch_data..    >
+00006750: 3e3e 2066 726f 6d20 7761 7465 782e 6261  >> from watex.ba
+00006760: 7365 2069 6d70 6f72 7420 5365 7175 656e  se import Sequen
+00006770: 7469 616c 4261 636b 7761 7264 5365 6c65  tialBackwardSele
+00006780: 6374 696f 6e0d 0a20 2020 203e 3e3e 2066  ction..    >>> f
+00006790: 726f 6d20 7761 7465 782e 7574 696c 732e  rom watex.utils.
+000067a0: 706c 6f74 7574 696c 7320 696d 706f 7274  plotutils import
+000067b0: 2070 6c6f 745f 7362 735f 6665 6174 7572   plot_sbs_featur
+000067c0: 655f 7365 6c65 6374 696f 6e0d 0a20 2020  e_selection..   
+000067d0: 203e 3e3e 2058 2c20 7920 3d20 6665 7463   >>> X, y = fetc
+000067e0: 685f 6461 7461 2827 6261 676f 7565 2061  h_data('bagoue a
+000067f0: 6e61 6c79 7365 6427 2920 2320 6461 7461  nalysed') # data
+00006800: 2061 6c72 6561 6479 2073 7461 6e64 6172   already standar
+00006810: 6469 7a65 640d 0a20 2020 203e 3e3e 2058  dized..    >>> X
+00006820: 7472 6169 6e2c 2058 742c 2079 7472 6169  train, Xt, ytrai
+00006830: 6e2c 2020 7974 203d 2074 7261 696e 5f74  n,  yt = train_t
+00006840: 6573 745f 7370 6c69 7428 582c 2079 290d  est_split(X, y).
+00006850: 0a20 2020 203e 3e3e 206b 6e6e 203d 204b  .    >>> knn = K
+00006860: 4e65 6967 6862 6f72 7343 6c61 7373 6966  NeighborsClassif
+00006870: 6965 7228 6e5f 6e65 6967 6862 6f72 733d  ier(n_neighbors=
+00006880: 3529 0d0a 2020 2020 3e3e 3e20 7362 733d  5)..    >>> sbs=
+00006890: 2053 6571 7565 6e74 6961 6c42 6163 6b77   SequentialBackw
+000068a0: 6172 6453 656c 6563 7469 6f6e 2028 6b6e  ardSelection (kn
+000068b0: 6e29 0d0a 2020 2020 3e3e 3e20 7362 732e  n)..    >>> sbs.
+000068c0: 6669 7428 5874 7261 696e 2c20 7974 7261  fit(Xtrain, ytra
+000068d0: 696e 2029 0d0a 2020 2020 3e3e 3e20 706c  in )..    >>> pl
+000068e0: 6f74 5f73 6273 5f66 6561 7475 7265 5f73  ot_sbs_feature_s
+000068f0: 656c 6563 7469 6f6e 2873 6273 2c20 736e  election(sbs, sn
+00006900: 735f 7374 796c 653d 2054 7275 6529 200d  s_style= True) .
+00006910: 0a20 2020 200d 0a20 2020 2028 3229 2d3e  .    ..    (2)->
+00006920: 2050 6c6f 7420 6573 7469 6d61 746f 7220   Plot estimator 
+00006930: 7769 7468 206e 6f20 7072 6566 6974 2053  with no prefit S
+00006940: 4253 2e20 0d0a 2020 2020 3e3e 3e20 706c  BS. ..    >>> pl
+00006950: 6f74 5f73 6273 5f66 6561 7475 7265 5f73  ot_sbs_feature_s
+00006960: 656c 6563 7469 6f6e 286b 6e6e 2c20 5874  election(knn, Xt
+00006970: 7261 696e 2c20 7974 7261 696e 2920 2320  rain, ytrain) # 
+00006980: 7969 656c 6420 7468 6520 7361 6d65 2072  yield the same r
+00006990: 6573 756c 740d 0a0d 0a20 2020 2022 2222  esult....    """
+000069a0: 0d0a 2020 2020 6672 6f6d 202e 2e62 6173  ..    from ..bas
+000069b0: 6520 696d 706f 7274 2053 6571 7565 6e74  e import Sequent
+000069c0: 6961 6c42 6163 6b77 6172 6453 656c 6563  ialBackwardSelec
+000069d0: 7469 6f6e 2061 7320 5342 5320 0d0a 2020  tion as SBS ..  
+000069e0: 2020 6966 2028 200d 0a20 2020 2020 2020    if ( ..       
+000069f0: 206e 6f74 2068 6173 6174 7472 2028 7362   not hasattr (sb
+00006a00: 735f 6573 7469 6d61 746f 722c 2027 7363  s_estimator, 'sc
+00006a10: 6f72 6573 5f27 2920 0d0a 2020 2020 2020  ores_') ..      
+00006a20: 2020 616e 6420 6e6f 7420 6861 7361 7474    and not hasatt
+00006a30: 7220 2873 6273 5f65 7374 696d 6174 6f72  r (sbs_estimator
+00006a40: 2c20 276b 5f73 636f 7265 5f27 290d 0a20  , 'k_score_').. 
+00006a50: 2020 2020 2020 2020 2020 2029 3a20 0d0a             ): ..
+00006a60: 2020 2020 2020 2020 6966 2028 2058 2069          if ( X i
+00006a70: 7320 4e6f 6e65 206f 7220 7920 6973 204e  s None or y is N
+00006a80: 6f6e 6520 2920 3a20 0d0a 2020 2020 2020  one ) : ..      
+00006a90: 2020 2020 2020 636c 666e 203d 2067 6574        clfn = get
+00006aa0: 5f65 7374 696d 6174 6f72 5f6e 616d 6528  _estimator_name(
+00006ab0: 2073 6273 5f65 7374 696d 6174 6f72 290d   sbs_estimator).
+00006ac0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00006ad0: 7365 2054 7970 6545 7272 6f72 2028 6622  se TypeError (f"
+00006ae0: 5768 656e 207b 636c 666e 7d20 6973 206e  When {clfn} is n
+00006af0: 6f74 2061 2066 6974 7465 6420 220d 0a20  ot a fitted ".. 
+00006b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006b10: 2020 2020 2020 2020 2020 2020 2265 7374              "est
+00006b20: 696d 6174 6f72 2c20 5820 616e 6420 7920  imator, X and y 
+00006b30: 6172 6520 6e65 6564 6564 2e22 0d0a 2020  are needed."..  
+00006b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006b50: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00006b60: 2020 2020 2020 7362 735f 6573 7469 6d61        sbs_estima
+00006b70: 746f 7220 3d20 5342 5328 6573 7469 6d61  tor = SBS(estima
+00006b80: 746f 7220 3d20 7362 735f 6573 7469 6d61  tor = sbs_estima
+00006b90: 746f 722c 202a 2a73 6273 5f6b 7773 290d  tor, **sbs_kws).
+00006ba0: 0a20 2020 2020 2020 2073 6273 5f65 7374  .        sbs_est
+00006bb0: 696d 6174 6f72 2e66 6974 2858 2c20 7920  imator.fit(X, y 
+00006bc0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00006bd0: 206b 5f66 6561 7420 3d20 5b6c 656e 286b   k_feat = [len(k
+00006be0: 2920 666f 7220 6b20 696e 2073 6273 5f65  ) for k in sbs_e
+00006bf0: 7374 696d 6174 6f72 2e73 7562 7365 7473  stimator.subsets
+00006c00: 5f5d 0d0a 2020 2020 0d0a 2020 2020 6966  _]..    ..    if
+00006c10: 2076 6572 626f 7365 3a20 0d0a 2020 2020   verbose: ..    
+00006c20: 2020 2020 666c 6162 656c 7320 3d4e 6f6e      flabels =Non
+00006c30: 6520 0d0a 2020 2020 2020 2020 6966 2020  e ..        if  
+00006c40: 2820 6e6f 7420 6861 7361 7474 7220 2858  ( not hasattr (X
+00006c50: 2c20 2763 6f6c 756d 6e73 2729 2061 6e64  , 'columns') and
+00006c60: 2058 2069 7320 6e6f 7420 4e6f 6e65 2029   X is not None )
+00006c70: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00006c80: 7761 726e 696e 6773 2e77 6172 6e28 224e  warnings.warn("N
+00006c90: 6f6e 6520 636f 6c75 6d6e 7320 6e61 6d65  one columns name
+00006ca0: 2069 7320 6465 7465 6374 6564 2e22 0d0a   is detected."..
+00006cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006cc0: 2020 2020 2020 2020 2020 2220 4372 6561            " Crea
+00006cd0: 7465 6420 7573 696e 6720 696e 6465 7820  ted using index 
+00006ce0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+00006cf0: 666c 6162 656c 7320 3d5b 6627 7b69 3a3e  flabels =[f'{i:>
+00006d00: 377d 2720 666f 7220 6920 696e 2072 616e  7}' for i in ran
+00006d10: 6765 2028 582e 7368 6170 655b 315d 295d  ge (X.shape[1])]
+00006d20: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+00006d30: 2020 2020 2020 2020 656c 6966 2068 6173          elif has
+00006d40: 6174 7472 2028 582c 2027 636f 6c75 6d6e  attr (X, 'column
+00006d50: 7327 293a 0d0a 2020 2020 2020 2020 2020  s'):..          
+00006d60: 2020 666c 6162 656c 7320 3d20 6c69 7374    flabels = list
+00006d70: 2858 2e63 6f6c 756d 6e73 2920 200d 0a20  (X.columns)  .. 
+00006d80: 2020 2020 2020 2065 6c69 6620 6861 7361         elif hasa
+00006d90: 7474 7220 2820 7362 735f 6573 7469 6d61  ttr ( sbs_estima
+00006da0: 746f 7220 2c20 2766 6561 7475 7265 5f6e  tor , 'feature_n
+00006db0: 616d 6573 5f69 6e27 293a 200d 0a20 2020  ames_in'): ..   
+00006dc0: 2020 2020 2020 2020 2066 6c61 6265 6c73           flabels
+00006dd0: 203d 2073 6273 5f65 7374 696d 6174 6f72   = sbs_estimator
+00006de0: 2e66 6561 7475 7265 5f6e 616d 6573 5f69  .feature_names_i
+00006df0: 6e20 0d0a 2020 2020 2020 2020 2020 2020  n ..            
+00006e00: 0d0a 2020 2020 2020 2020 6966 2066 6c61  ..        if fla
+00006e10: 6265 6c73 2069 7320 6e6f 7420 4e6f 6e65  bels is not None
+00006e20: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00006e30: 6b33 203d 206c 6973 7420 2873 6273 5f65  k3 = list (sbs_e
+00006e40: 7374 696d 6174 6f72 2e73 7562 7365 7473  stimator.subsets
+00006e50: 5f5b 582e 7368 6170 655b 315d 5d29 0d0a  _[X.shape[1]])..
+00006e60: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00006e70: 7428 2253 6d61 6c6c 6573 7420 6665 6174  t("Smallest feat
+00006e80: 7572 6520 666f 7220 7375 6273 6574 2028  ure for subset (
+00006e90: 6b3d 3329 2022 290d 0a20 2020 2020 2020  k=3) ")..       
+00006ea0: 2020 2020 2070 7269 6e74 2866 6c61 6265       print(flabe
+00006eb0: 6c73 205b 6b33 5d29 0d0a 2020 2020 2020  ls [k3])..      
+00006ec0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00006ed0: 656c 7365 203a 2070 7269 6e74 2822 4e6f  else : print("No
+00006ee0: 2063 6f6c 756d 6e20 6c61 6265 6c73 2064   column labels d
+00006ef0: 6574 6563 7465 642e 2043 616e 2774 2070  etected. Can't p
+00006f00: 7269 6e74 2074 6865 2022 0d0a 2020 2020  rint the "..    
+00006f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006f20: 2022 736d 616c 6c65 7374 2066 6561 7475   "smallest featu
+00006f30: 7265 2073 7562 7365 742e 2229 0d0a 2020  re subset.")..  
+00006f40: 2020 2020 2020 0d0a 2020 2020 6966 2073        ..    if s
+00006f50: 6e73 5f73 7479 6c65 3a20 0d0a 2020 2020  ns_style: ..    
+00006f60: 2020 2020 5f73 6574 5f73 6e73 5f73 7479      _set_sns_sty
+00006f70: 6c65 2028 736e 735f 7374 796c 6529 0d0a  le (sns_style)..
+00006f80: 2020 2020 2020 2020 0d0a 2020 2020 706c          ..    pl
+00006f90: 742e 6669 6775 7265 2866 6967 7369 7a65  t.figure(figsize
+00006fa0: 203d 2066 6967 5f73 697a 6529 0d0a 2020   = fig_size)..  
+00006fb0: 2020 706c 742e 706c 6f74 2028 6b5f 6665    plt.plot (k_fe
+00006fc0: 6174 202c 2073 6273 5f65 7374 696d 6174  at , sbs_estimat
+00006fd0: 6f72 2e73 636f 7265 735f 2c20 6d61 726b  or.scores_, mark
+00006fe0: 6572 3d27 6f27 2029 200d 0a20 2020 2070  er='o' ) ..    p
+00006ff0: 6c74 2e79 6c69 6d20 285b 6d69 6e28 7362  lt.ylim ([min(sb
+00007000: 735f 6573 7469 6d61 746f 722e 7363 6f72  s_estimator.scor
+00007010: 6573 5f29 202d 2e32 3520 2c0d 0a20 2020  es_) -.25 ,..   
+00007020: 2020 2020 2020 2020 2020 2020 6d61 7828              max(
+00007030: 7362 735f 6573 7469 6d61 746f 722e 7363  sbs_estimator.sc
+00007040: 6f72 6573 5f29 202b 2e32 205d 290d 0a20  ores_) +.2 ]).. 
+00007050: 2020 2070 6c74 2e79 6c61 6265 6c20 2873     plt.ylabel (s
+00007060: 6273 5f65 7374 696d 6174 6f72 2e73 636f  bs_estimator.sco
+00007070: 7265 725f 6e61 6d65 5f20 290d 0a20 2020  rer_name_ )..   
+00007080: 2070 6c74 2e78 6c61 6265 6c20 2827 4e75   plt.xlabel ('Nu
+00007090: 6d62 6572 206f 6620 6665 6174 7572 6573  mber of features
+000070a0: 2729 0d0a 2020 2020 706c 742e 7469 6768  ')..    plt.tigh
+000070b0: 745f 6c61 796f 7574 2829 200d 0a20 2020  t_layout() ..   
+000070c0: 200d 0a20 2020 2069 6620 7361 7665 6669   ..    if savefi
+000070d0: 6720 6973 206e 6f74 204e 6f6e 653a 0d0a  g is not None:..
+000070e0: 2020 2020 2020 2020 706c 742e 7361 7665          plt.save
+000070f0: 6669 6728 7361 7665 6669 6720 290d 0a20  fig(savefig ).. 
+00007100: 2020 2020 2020 200d 0a20 2020 2070 6c74         ..    plt
+00007110: 2e63 6c6f 7365 2028 2920 6966 2073 6176  .close () if sav
+00007120: 6566 6967 2069 7320 6e6f 7420 4e6f 6e65  efig is not None
+00007130: 2065 6c73 6520 706c 742e 7368 6f77 2829   else plt.show()
+00007140: 200d 0a20 2020 200d 0a0d 0a64 6566 2070   ..    ....def p
+00007150: 6c6f 745f 7265 6775 6c61 7269 7a61 7469  lot_regularizati
+00007160: 6f6e 5f70 6174 6820 2820 0d0a 2020 2020  on_path ( ..    
+00007170: 2020 2020 582c 2079 202c 2063 5f72 616e      X, y , c_ran
+00007180: 6765 3d28 2d34 2e2c 2036 2e20 292c 2066  ge=(-4., 6. ), f
+00007190: 6967 5f73 697a 653d 2838 2c20 3529 2c20  ig_size=(8, 5), 
+000071a0: 736e 735f 7374 796c 6520 3d46 616c 7365  sns_style =False
+000071b0: 2c20 0d0a 2020 2020 2020 2020 7361 7665  , ..        save
+000071c0: 6669 6720 3d20 4e6f 6e65 2c20 2a2a 6b77  fig = None, **kw
+000071d0: 7320 0d0a 2020 2020 2020 2020 293a 200d  s ..        ): .
+000071e0: 0a20 2020 2072 2222 2220 506c 6f74 2074  .    r""" Plot t
+000071f0: 6865 2072 6567 756c 6172 6973 6174 696f  he regularisatio
+00007200: 6e20 7061 7468 2066 726f 6d20 4c6f 6769  n path from Logi
+00007210: 7420 2f20 4c6f 6769 7374 6963 5265 6772  t / LogisticRegr
+00007220: 6573 7369 6f6e 200d 0a20 2020 200d 0a20  ession ..    .. 
+00007230: 2020 2056 6172 7969 6e67 2074 6865 2020     Varying the  
+00007240: 6469 6666 6572 656e 7420 7265 6775 6c61  different regula
+00007250: 7269 7a61 7469 6f6e 2073 7472 656e 6774  rization strengt
+00007260: 6873 2061 6e64 2070 6c6f 7420 7468 6520  hs and plot the 
+00007270: 2077 6569 6768 7420 0d0a 2020 2020 636f   weight ..    co
+00007280: 6566 6669 6369 656e 7420 6f66 2074 6865  efficient of the
+00007290: 2064 6966 6665 7265 6e74 2066 6561 7475   different featu
+000072a0: 7265 7320 666f 7220 6469 6666 6572 656e  res for differen
+000072b0: 7420 7265 6775 6c61 7269 7a61 7469 6f6e  t regularization
+000072c0: 200d 0a20 2020 2073 7472 656e 6774 682e   ..    strength.
+000072d0: 200d 0a20 2020 200d 0a20 2020 204e 6f74   ..    ..    Not
+000072e0: 6520 7468 6174 2c20 6974 2069 7320 7265  e that, it is re
+000072f0: 636f 6d6d 656e 6465 6420 746f 2073 7461  commended to sta
+00007300: 6e64 6172 6469 7a65 2074 6865 2064 6174  ndardize the dat
+00007310: 6120 6669 7273 742e 200d 0a20 2020 200d  a first. ..    .
+00007320: 0a20 2020 2050 6172 616d 6574 6572 7320  .    Parameters 
+00007330: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
+00007340: 2d0d 0a20 2020 2058 203a 2061 7272 6179  -..    X : array
+00007350: 2d6c 696b 6520 6f66 2073 6861 7065 2028  -like of shape (
+00007360: 6e5f 7361 6d70 6c65 732c 206e 5f66 6561  n_samples, n_fea
+00007370: 7475 7265 7329 0d0a 2020 2020 2020 2020  tures)..        
+00007380: 5472 6169 6e69 6e67 2076 6563 746f 722c  Training vector,
+00007390: 2077 6865 7265 2060 6e5f 7361 6d70 6c65   where `n_sample
+000073a0: 7360 2069 7320 7468 6520 6e75 6d62 6572  s` is the number
+000073b0: 206f 6620 7361 6d70 6c65 7320 616e 640d   of samples and.
+000073c0: 0a20 2020 2020 2020 2060 6e5f 6665 6174  .        `n_feat
+000073d0: 7572 6573 6020 6973 2074 6865 206e 756d  ures` is the num
+000073e0: 6265 7220 6f66 2066 6561 7475 7265 732e  ber of features.
+000073f0: 2058 2069 7320 6578 7065 6374 6564 2074   X is expected t
+00007400: 6f20 6265 200d 0a20 2020 2020 2020 2073  o be ..        s
+00007410: 7461 6e64 6172 6469 7a65 642e 200d 0a0d  tandardized. ...
+00007420: 0a20 2020 2079 203a 2061 7272 6179 2d6c  .    y : array-l
+00007430: 696b 6520 6f66 2073 6861 7065 2028 6e5f  ike of shape (n_
+00007440: 7361 6d70 6c65 732c 2920 6f72 2028 6e5f  samples,) or (n_
+00007450: 7361 6d70 6c65 732c 206e 5f6f 7574 7075  samples, n_outpu
+00007460: 7473 290d 0a20 2020 2020 2020 2054 6172  ts)..        Tar
+00007470: 6765 7420 7265 6c61 7469 7665 2074 6f20  get relative to 
+00007480: 5820 666f 7220 636c 6173 7369 6669 6361  X for classifica
+00007490: 7469 6f6e 206f 7220 7265 6772 6573 7369  tion or regressi
+000074a0: 6f6e 3b0d 0a20 2020 2020 2020 204e 6f6e  on;..        Non
+000074b0: 6520 666f 7220 756e 7375 7065 7276 6973  e for unsupervis
+000074c0: 6564 206c 6561 726e 696e 672e 0d0a 2020  ed learning...  
+000074d0: 2020 635f 7261 6e67 653a 206c 6973 7420    c_range: list 
+000074e0: 6f72 2074 7570 6c65 205b 7374 6172 742c  or tuple [start,
+000074f0: 2073 746f 705d 200d 0a20 2020 2020 2020   stop] ..       
+00007500: 2052 6567 756c 6172 697a 6174 696f 6e20   Regularization 
+00007510: 7374 7265 6e67 7468 206c 6973 742e 2049  strength list. I
+00007520: 7420 6973 2061 2072 616e 6765 2066 726f  t is a range fro
+00007530: 6d20 7468 6520 7374 726f 6e67 2020 0d0a  m the strong  ..
+00007540: 2020 2020 2020 2020 7374 726f 6e67 2028          strong (
+00007550: 2073 7461 7274 2920 746f 206c 6f77 6572   start) to lower
+00007560: 2028 7374 6f70 2920 7265 6775 6c61 7269   (stop) regulari
+00007570: 7a61 7469 6f6e 2e20 4e6f 7465 2074 6861  zation. Note tha
+00007580: 7420 2743 2720 6973 200d 0a20 2020 2020  t 'C' is ..     
+00007590: 2020 2074 6865 2069 6e76 6572 7365 206f     the inverse o
+000075a0: 6620 7468 6520 4c6f 6769 7374 6963 2052  f the Logistic R
+000075b0: 6567 7265 7373 696f 6e20 7265 6775 6c61  egression regula
+000075c0: 7269 7a61 7469 6f6e 2070 6172 616d 6574  rization paramet
+000075d0: 6572 200d 0a20 2020 2020 2020 203a 6d61  er ..        :ma
+000075e0: 7468 3a60 5c6c 616d 6264 6160 2e20 0d0a  th:`\lambda`. ..
+000075f0: 2020 2020 6669 675f 7369 7a65 203a 2074      fig_size : t
+00007600: 7570 6c65 2028 7769 6474 682c 2068 6569  uple (width, hei
+00007610: 6768 7429 2c20 6465 6661 756c 7420 3d28  ght), default =(
+00007620: 382c 2036 290d 0a20 2020 2020 2020 2074  8, 6)..        t
+00007630: 6865 206d 6174 706c 6f74 6c69 6220 6669  he matplotlib fi
+00007640: 6775 7265 2073 697a 6520 6769 7665 6e20  gure size given 
+00007650: 6173 2061 2074 7570 6c65 206f 6620 7769  as a tuple of wi
+00007660: 6474 6820 616e 6420 6865 6967 6874 0d0a  dth and height..
+00007670: 2020 2020 2020 2020 0d0a 2020 2020 7361          ..    sa
+00007680: 7665 6669 673a 2073 7472 2c20 6465 6661  vefig: str, defa
+00007690: 756c 7420 3d4e 6f6e 6520 2c20 0d0a 2020  ult =None , ..  
+000076a0: 2020 2020 2020 7468 6520 7061 7468 2074        the path t
+000076b0: 6f20 7361 7665 2074 6865 2066 6967 7572  o save the figur
+000076c0: 6573 2e20 4172 6775 6d65 6e74 2069 7320  es. Argument is 
+000076d0: 7061 7373 6564 2074 6f20 6d61 7470 6c6f  passed to matplo
+000076e0: 746c 6962 2e46 6967 7572 6520 0d0a 2020  tlib.Figure ..  
+000076f0: 2020 2020 2020 636c 6173 732e 200d 0a20        class. .. 
+00007700: 2020 2073 6e73 5f73 7479 6c65 3a20 7374     sns_style: st
+00007710: 722c 206f 7074 696f 6e61 6c2c 200d 0a20  r, optional, .. 
+00007720: 2020 2020 2020 2074 6865 2073 6561 626f         the seabo
+00007730: 726e 2073 7479 6c65 2e0d 0a20 2020 2020  rn style...     
+00007740: 2020 200d 0a20 2020 206b 7773 3a20 6469     ..    kws: di
+00007750: 6374 2c20 0d0a 2020 2020 2020 2020 4164  ct, ..        Ad
+00007760: 6469 7469 6f6e 616c 206b 6579 776f 7264  ditional keyword
+00007770: 7320 6172 6775 6d65 6e74 7320 7061 7373  s arguments pass
+00007780: 6564 2074 6f20 0d0a 2020 2020 2020 2020  ed to ..        
+00007790: 3a63 6c61 7373 3a60 736b 6c65 6172 6e2e  :class:`sklearn.
+000077a0: 6c69 6e65 6172 5f6d 6f64 656c 2e4c 6f67  linear_model.Log
+000077b0: 6973 7469 6352 6567 7265 7373 696f 6e60  isticRegression`
+000077c0: 0d0a 2020 2020 0d0a 2020 2020 4578 616d  ..    ..    Exam
+000077d0: 706c 6573 0d0a 2020 2020 2d2d 2d2d 2d2d  ples..    ------
+000077e0: 2d2d 0d0a 2020 2020 3e3e 3e20 6672 6f6d  --..    >>> from
+000077f0: 2077 6174 6578 2e75 7469 6c73 2e70 6c6f   watex.utils.plo
+00007800: 7475 7469 6c73 2069 6d70 6f72 7420 706c  tutils import pl
+00007810: 6f74 5f72 6567 756c 6172 697a 6174 696f  ot_regularizatio
+00007820: 6e5f 7061 7468 200d 0a20 2020 203e 3e3e  n_path ..    >>>
+00007830: 2066 726f 6d20 7761 7465 782e 6461 7461   from watex.data
+00007840: 7365 7473 2069 6d70 6f72 7420 6665 7463  sets import fetc
+00007850: 685f 6461 7461 0d0a 2020 2020 3e3e 3e20  h_data..    >>> 
+00007860: 582c 2079 203d 2066 6574 6368 5f64 6174  X, y = fetch_dat
+00007870: 6120 2827 6261 676f 7565 2061 6e61 6c79  a ('bagoue analy
+00007880: 7365 6427 2029 2023 2064 6174 6120 616c  sed' ) # data al
+00007890: 6561 7264 7920 7374 616e 6461 7264 697a  eardy standardiz
+000078a0: 6564 0d0a 2020 2020 3e3e 3e20 706c 6f74  ed..    >>> plot
+000078b0: 5f72 6567 756c 6172 697a 6174 696f 6e5f  _regularization_
+000078c0: 7061 7468 2028 582c 2079 2029 200d 0a0d  path (X, y ) ...
+000078d0: 0a20 2020 2022 2222 0d0a 2020 2020 582c  .    """..    X,
+000078e0: 2079 203d 2063 6865 636b 5f58 5f79 280d   y = check_X_y(.
+000078f0: 0a20 2020 2020 2020 2058 2c20 0d0a 2020  .        X, ..  
+00007900: 2020 2020 2020 792c 200d 0a20 2020 2020        y, ..     
+00007910: 2020 2074 6f5f 6672 616d 653d 2054 7275     to_frame= Tru
+00007920: 652c 200d 0a20 2020 2020 2020 2029 0d0a  e, ..        )..
+00007930: 2020 2020 0d0a 2020 2020 6966 206e 6f74      ..    if not
+00007940: 2069 735f 6974 6572 6162 6c65 2863 5f72   is_iterable(c_r
+00007950: 616e 6765 293a 200d 0a20 2020 2020 2020  ange): ..       
+00007960: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00007970: 2028 2227 4327 2072 6567 756c 6172 697a   ("'C' regulariz
+00007980: 6174 696f 6e20 7374 7265 6e67 7468 2069  ation strength i
+00007990: 7320 6120 7261 6e67 6520 6f66 2043 2022  s a range of C "
+000079a0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000079b0: 2020 2020 2020 2020 2020 2020 2220 4c6f              " Lo
+000079c0: 6769 7420 7061 7261 6d65 7465 723a 2028  git parameter: (
+000079d0: 7374 6172 742c 2073 746f 7029 2e22 290d  start, stop).").
+000079e0: 0a20 2020 2063 5f72 616e 6765 203d 2073  .    c_range = s
+000079f0: 6f72 7465 6420 2863 5f72 616e 6765 2029  orted (c_range )
+00007a00: 0d0a 2020 2020 0d0a 2020 2020 6966 206c  ..    ..    if l
+00007a10: 656e 2863 5f72 616e 6765 2920 3c20 323a  en(c_range) < 2:
+00007a20: 200d 0a20 2020 2020 2020 2072 6169 7365   ..        raise
+00007a30: 2056 616c 7565 4572 726f 7220 2822 2743   ValueError ("'C
+00007a40: 2720 7261 6e67 6520 6578 7065 6374 7320  ' range expects 
+00007a50: 7477 6f20 7661 6c75 6573 205b 7374 6172  two values [star
+00007a60: 742c 2073 746f 705d 2229 0d0a 2020 2020  t, stop]")..    
+00007a70: 2020 2020 0d0a 2020 2020 6966 206c 656e      ..    if len
+00007a80: 2863 5f72 616e 6765 2920 3e32 203a 200d  (c_range) >2 : .
+00007a90: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
+00007aa0: 732e 7761 726e 2028 2227 4327 2072 616e  s.warn ("'C' ran
+00007ab0: 6765 2065 7870 6563 7473 2074 776f 2076  ge expects two v
+00007ac0: 616c 7565 7320 5b73 7461 7274 2c20 7374  alues [start, st
+00007ad0: 6f70 5d2e 2056 616c 7565 7322 0d0a 2020  op]. Values"..  
 00007ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007af0: 290d 0a20 2020 2077 6569 6768 7473 2c20  )..    weights, 
-00007b00: 7061 7261 6d73 203d 205b 5d2c 205b 5d20  params = [], [] 
-00007b10: 2020 200d 0a20 2020 2066 6f72 2063 2069     ..    for c i
-00007b20: 6e20 6e70 2e61 7261 6e67 6520 282a 635f  n np.arange (*c_
-00007b30: 7261 6e67 6529 3a20 0d0a 2020 2020 2020  range): ..      
-00007b40: 2020 6c72 203d 204c 6f67 6973 7469 6352    lr = LogisticR
-00007b50: 6567 7265 7373 696f 6e28 7065 6e61 6c74  egression(penalt
-00007b60: 793d 276c 3127 2c20 433d 2031 302e 2a2a  y='l1', C= 10.**
-00007b70: 632c 2073 6f6c 7665 7220 3d27 6c69 626c  c, solver ='libl
-00007b80: 696e 6561 7227 2c20 0d0a 2020 2020 2020  inear', ..      
-00007b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ba0: 2020 2020 2020 2020 2020 6d75 6c74 695f            multi_
-00007bb0: 636c 6173 733d 276f 7672 272c 202a 2a6b  class='ovr', **k
-00007bc0: 7773 290d 0a20 2020 2020 2020 206c 722e  ws)..        lr.
-00007bd0: 6669 7428 582c 7920 290d 0a20 2020 2020  fit(X,y )..     
-00007be0: 2020 2077 6569 6768 7473 2e61 7070 656e     weights.appen
-00007bf0: 6420 286c 722e 636f 6566 5f5b 315d 290d  d (lr.coef_[1]).
-00007c00: 0a20 2020 2020 2020 2070 6172 616d 732e  .        params.
-00007c10: 6170 7065 6e64 2831 302a 2a63 290d 0a20  append(10**c).. 
-00007c20: 2020 2020 2020 200d 0a20 2020 2077 6569         ..    wei
-00007c30: 6768 7473 203d 206e 702e 6172 7261 7928  ghts = np.array(
-00007c40: 7765 6967 6874 7320 2920 0d0a 2020 2020  weights ) ..    
-00007c50: 636f 6c6f 7273 203d 206d 616b 655f 6d70  colors = make_mp
-00007c60: 6c5f 7072 6f70 6572 7469 6573 2877 6569  l_properties(wei
-00007c70: 6768 7473 2e73 6861 7065 5b31 5d29 0d0a  ghts.shape[1])..
-00007c80: 2020 2020 6966 206e 6f74 2068 6173 6174      if not hasat
-00007c90: 7472 2028 582c 2027 636f 6c75 6d6e 7327  tr (X, 'columns'
-00007ca0: 293a 200d 0a20 2020 2020 2020 2066 6c61  ): ..        fla
-00007cb0: 6265 6c73 203d 5b66 277b 693a 3e37 7d27  bels =[f'{i:>7}'
-00007cc0: 2066 6f72 2069 2069 6e20 7261 6e67 6520   for i in range 
-00007cd0: 2858 2e73 6861 7065 5b31 5d29 5d20 0d0a  (X.shape[1])] ..
-00007ce0: 2020 2020 656c 7365 3a20 666c 6162 656c      else: flabel
-00007cf0: 7320 3d20 582e 636f 6c75 6d6e 7320 2020  s = X.columns   
-00007d00: 0d0a 2020 2020 0d0a 2020 2020 2320 706c  ..    ..    # pl
-00007d10: 6f74 0d0a 2020 2020 6669 672c 2061 7820  ot..    fig, ax 
-00007d20: 3d20 706c 742e 7375 6270 6c6f 7473 2866  = plt.subplots(f
-00007d30: 6967 7369 7a65 203d 2066 6967 5f73 697a  igsize = fig_siz
-00007d40: 6520 290d 0a20 2020 2069 6620 736e 735f  e )..    if sns_
-00007d50: 7374 796c 653a 200d 0a20 2020 2020 2020  style: ..       
-00007d60: 205f 7365 745f 736e 735f 7374 796c 6520   _set_sns_style 
-00007d70: 2873 6e73 5f73 7479 6c65 290d 0a0d 0a20  (sns_style).... 
-00007d80: 2020 2066 6f72 2063 6f6c 756d 6e20 2c20     for column , 
-00007d90: 636f 6c6f 7220 696e 207a 6970 2820 7261  color in zip( ra
-00007da0: 6e67 6520 2877 6569 6768 7473 2e73 6861  nge (weights.sha
-00007db0: 7065 205b 315d 292c 2063 6f6c 6f72 7320  pe [1]), colors 
-00007dc0: 293a 200d 0a20 2020 2020 2020 2070 6c74  ): ..        plt
-00007dd0: 2e70 6c6f 7420 2870 6172 616d 7320 2c20  .plot (params , 
-00007de0: 7765 6967 6874 735b 3a2c 2063 6f6c 756d  weights[:, colum
-00007df0: 6e5d 2c20 0d0a 2020 2020 2020 2020 2020  n], ..          
-00007e00: 2020 2020 2020 2020 6c61 6265 6c20 3d66          label =f
-00007e10: 6c61 6265 6c73 5b63 6f6c 756d 6e5d 2c20  labels[column], 
-00007e20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007e30: 2020 2020 636f 6c6f 7220 3d20 636f 6c6f      color = colo
-00007e40: 7220 0d0a 2020 2020 2020 2020 2020 2020  r ..            
-00007e50: 2020 2020 2020 290d 0a0d 0a20 2020 2070        )....    p
-00007e60: 6c74 2e61 7868 6c69 6e65 2028 2030 202c  lt.axhline ( 0 ,
-00007e70: 2063 6f6c 6f72 203d 2762 6c61 636b 272c   color ='black',
-00007e80: 206c 733d 272d 2d27 2c20 6c77 3d20 3320   ls='--', lw= 3 
-00007e90: 290d 0a20 2020 2070 6c74 2e78 6c69 6d20  )..    plt.xlim 
-00007ea0: 2820 5b20 3130 202a 2a20 696e 7428 635f  ( [ 10 ** int(c_
-00007eb0: 7261 6e67 655b 305d 202d 3129 2c20 3130  range[0] -1), 10
-00007ec0: 202a 2a20 696e 7428 635f 7261 6e67 655b   ** int(c_range[
-00007ed0: 315d 2d31 2920 5d29 0d0a 2020 2020 706c  1]-1) ])..    pl
-00007ee0: 742e 796c 6162 656c 2028 2257 6569 6768  t.ylabel ("Weigh
-00007ef0: 7420 636f 6566 6669 6369 656e 7422 290d  t coefficient").
-00007f00: 0a20 2020 2070 6c74 2e78 6c61 6265 6c20  .    plt.xlabel 
-00007f10: 2827 4327 290d 0a20 2020 2070 6c74 2e78  ('C')..    plt.x
-00007f20: 7363 616c 6528 2027 6c6f 6727 290d 0a20  scale( 'log').. 
-00007f30: 2020 2070 6c74 2e6c 6567 656e 6420 286c     plt.legend (l
-00007f40: 6f63 203d 2775 7070 6572 206c 6566 7427  oc ='upper left'
-00007f50: 2c29 0d0a 2020 2020 6178 2e6c 6567 656e  ,)..    ax.legen
-00007f60: 6428 0d0a 2020 2020 2020 2020 2020 2020  d(..            
-00007f70: 6c6f 6320 3d27 7570 7065 7220 7269 6768  loc ='upper righ
-00007f80: 7427 2c20 0d0a 2020 2020 2020 2020 2020  t', ..          
-00007f90: 2020 6262 6f78 5f74 6f5f 616e 6368 6f72    bbox_to_anchor
-00007fa0: 203d 2831 2e33 382c 2031 2e30 3320 292c   =(1.38, 1.03 ),
-00007fb0: 200d 0a20 2020 2020 2020 2020 2020 206e   ..            n
-00007fc0: 636f 6c20 3d20 3120 2c20 6661 6e63 7962  col = 1 , fancyb
-00007fd0: 6f78 203d 5472 7565 200d 0a20 2020 2029  ox =True ..    )
-00007fe0: 0d0a 2020 2020 0d0a 2020 2020 6966 2073  ..    ..    if s
-00007ff0: 6176 6566 6967 2069 7320 6e6f 7420 4e6f  avefig is not No
-00008000: 6e65 3a0d 0a20 2020 2020 2020 2070 6c74  ne:..        plt
-00008010: 2e73 6176 6566 6967 2873 6176 6566 6967  .savefig(savefig
-00008020: 2c20 6470 6920 3d20 3330 3020 290d 0a20  , dpi = 300 ).. 
-00008030: 2020 2020 2020 200d 0a20 2020 2070 6c74         ..    plt
-00008040: 2e63 6c6f 7365 2028 2920 6966 2073 6176  .close () if sav
-00008050: 6566 6967 2069 7320 6e6f 7420 4e6f 6e65  efig is not None
-00008060: 2065 6c73 6520 706c 742e 7368 6f77 2829   else plt.show()
-00008070: 200d 0a20 2020 200d 0a64 6566 2070 6c6f   ..    ..def plo
-00008080: 745f 7266 5f66 6561 7475 7265 5f69 6d70  t_rf_feature_imp
-00008090: 6f72 7461 6e63 6573 2028 0d0a 2020 2020  ortances (..    
-000080a0: 2020 2020 636c 662c 2058 3d4e 6f6e 652c      clf, X=None,
-000080b0: 2079 3d4e 6f6e 652c 2066 6967 5f73 697a   y=None, fig_siz
-000080c0: 6520 3d20 2838 2c20 3429 2c73 6176 6566  e = (8, 4),savef
-000080d0: 6967 203d 4e6f 6e65 2c20 2020 0d0a 2020  ig =None,   ..  
-000080e0: 2020 2020 2020 6e5f 6573 7469 6d61 746f        n_estimato
-000080f0: 7273 3d20 3530 302c 2076 6572 626f 7365  rs= 500, verbose
-00008100: 203d 3020 2c20 736e 735f 7374 796c 6520   =0 , sns_style 
-00008110: 3d4e 6f6e 652c 2020 2a2a 6b77 7320 0d0a  =None,  **kws ..
-00008120: 2020 2020 2020 2020 293a 200d 0a20 2020          ): ..   
-00008130: 2022 2222 0d0a 2020 2020 506c 6f74 2066   """..    Plot f
-00008140: 6561 7475 7265 7320 696d 706f 7274 616e  eatures importan
-00008150: 6365 2077 6974 6820 5261 6e64 6f6d 466f  ce with RandomFo
-00008160: 7265 7374 2e20 200d 0a20 2020 200d 0a20  rest.  ..    .. 
-00008170: 2020 2050 6172 616d 6574 6572 7320 0d0a     Parameters ..
-00008180: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-00008190: 2020 2020 636c 6620 3a20 6573 7469 6d61      clf : estima
-000081a0: 746f 7220 6f62 6a65 6374 0d0a 2020 2020  tor object..    
-000081b0: 2020 2020 5468 6520 6261 7365 2065 7374      The base est
-000081c0: 696d 6174 6f72 2066 726f 6d20 7768 6963  imator from whic
-000081d0: 6820 7468 6520 7472 616e 7366 6f72 6d65  h the transforme
-000081e0: 7220 6973 2062 7569 6c74 2e0d 0a20 2020  r is built...   
-000081f0: 2020 2020 2054 6869 7320 6361 6e20 6265       This can be
-00008200: 2062 6f74 6820 6120 6669 7474 6564 2028   both a fitted (
-00008210: 6966 2060 6070 7265 6669 7460 6020 6973  if ``prefit`` is
-00008220: 2073 6574 2074 6f20 5472 7565 290d 0a20   set to True).. 
-00008230: 2020 2020 2020 206f 7220 6120 6e6f 6e2d         or a non-
-00008240: 6669 7474 6564 2065 7374 696d 6174 6f72  fitted estimator
-00008250: 2e20 5468 6520 6573 7469 6d61 746f 7220  . The estimator 
-00008260: 7368 6f75 6c64 2068 6176 6520 610d 0a20  should have a.. 
-00008270: 2020 2020 2020 2060 6066 6561 7475 7265         ``feature
-00008280: 5f69 6d70 6f72 7461 6e63 6573 5f60 6020  _importances_`` 
-00008290: 6f72 2060 6063 6f65 665f 6060 2061 7474  or ``coef_`` att
-000082a0: 7269 6275 7465 2061 6674 6572 2066 6974  ribute after fit
-000082b0: 7469 6e67 2e0d 0a20 2020 2020 2020 204f  ting...        O
-000082c0: 7468 6572 7769 7365 2c20 7468 6520 6060  therwise, the ``
-000082d0: 696d 706f 7274 616e 6365 5f67 6574 7465  importance_gette
-000082e0: 7260 6020 7061 7261 6d65 7465 7220 7368  r`` parameter sh
-000082f0: 6f75 6c64 2062 6520 7573 6564 2e0d 0a20  ould be used... 
-00008300: 2020 2020 2020 200d 0a20 2020 2058 203a         ..    X :
-00008310: 2061 7272 6179 2d6c 696b 6520 6f66 2073   array-like of s
-00008320: 6861 7065 2028 6e5f 7361 6d70 6c65 732c  hape (n_samples,
-00008330: 206e 5f66 6561 7475 7265 7329 0d0a 2020   n_features)..  
-00008340: 2020 2020 2020 5472 6169 6e69 6e67 2076        Training v
-00008350: 6563 746f 722c 2077 6865 7265 2060 6e5f  ector, where `n_
-00008360: 7361 6d70 6c65 7360 2069 7320 7468 6520  samples` is the 
-00008370: 6e75 6d62 6572 206f 6620 7361 6d70 6c65  number of sample
-00008380: 7320 616e 640d 0a20 2020 2020 2020 2060  s and..        `
-00008390: 6e5f 6665 6174 7572 6573 6020 6973 2074  n_features` is t
-000083a0: 6865 206e 756d 6265 7220 6f66 2066 6561  he number of fea
-000083b0: 7475 7265 732e 0d0a 0d0a 2020 2020 7920  tures.....    y 
-000083c0: 3a20 6172 7261 792d 6c69 6b65 206f 6620  : array-like of 
-000083d0: 7368 6170 6520 286e 5f73 616d 706c 6573  shape (n_samples
-000083e0: 2c29 206f 7220 286e 5f73 616d 706c 6573  ,) or (n_samples
-000083f0: 2c20 6e5f 6f75 7470 7574 7329 0d0a 2020  , n_outputs)..  
-00008400: 2020 2020 2020 5461 7267 6574 2072 656c        Target rel
-00008410: 6174 6976 6520 746f 2058 2066 6f72 2063  ative to X for c
-00008420: 6c61 7373 6966 6963 6174 696f 6e20 6f72  lassification or
-00008430: 2072 6567 7265 7373 696f 6e3b 0d0a 2020   regression;..  
-00008440: 2020 2020 2020 4e6f 6e65 2066 6f72 2075        None for u
-00008450: 6e73 7570 6572 7669 7365 6420 6c65 6172  nsupervised lear
-00008460: 6e69 6e67 2e0d 0a20 2020 2020 2020 0d0a  ning...       ..
-00008470: 2020 2020 6e5f 6573 7469 6d61 746f 7273      n_estimators
-00008480: 203a 2069 6e74 2c20 6465 6661 756c 743d   : int, default=
-00008490: 3530 300d 0a20 2020 2020 2020 2054 6865  500..        The
-000084a0: 206e 756d 6265 7220 6f66 2074 7265 6573   number of trees
-000084b0: 2069 6e20 7468 6520 666f 7265 7374 2e0d   in the forest..
-000084c0: 0a20 2020 2020 2020 200d 0a20 2020 2066  .        ..    f
-000084d0: 6967 5f73 697a 6520 3a20 7475 706c 6520  ig_size : tuple 
-000084e0: 2877 6964 7468 2c20 6865 6967 6874 292c  (width, height),
-000084f0: 2064 6566 6175 6c74 203d 2838 2c20 3629   default =(8, 6)
-00008500: 0d0a 2020 2020 2020 2020 7468 6520 6d61  ..        the ma
-00008510: 7470 6c6f 746c 6962 2066 6967 7572 6520  tplotlib figure 
-00008520: 7369 7a65 2067 6976 656e 2061 7320 6120  size given as a 
-00008530: 7475 706c 6520 6f66 2077 6964 7468 2061  tuple of width a
-00008540: 6e64 2068 6569 6768 740d 0a20 2020 2020  nd height..     
-00008550: 2020 200d 0a20 2020 2073 6176 6566 6967     ..    savefig
-00008560: 3a20 7374 722c 2064 6566 6175 6c74 203d  : str, default =
-00008570: 4e6f 6e65 202c 200d 0a20 2020 2020 2020  None , ..       
-00008580: 2074 6865 2070 6174 6820 746f 2073 6176   the path to sav
-00008590: 6520 7468 6520 6669 6775 7265 732e 2041  e the figures. A
-000085a0: 7267 756d 656e 7420 6973 2070 6173 7365  rgument is passe
-000085b0: 6420 746f 206d 6174 706c 6f74 6c69 622e  d to matplotlib.
-000085c0: 4669 6775 7265 200d 0a20 2020 2020 2020  Figure ..       
-000085d0: 2063 6c61 7373 2e20 0d0a 2020 2020 736e   class. ..    sn
-000085e0: 735f 7374 796c 653a 2073 7472 2c20 6f70  s_style: str, op
-000085f0: 7469 6f6e 616c 2c20 0d0a 2020 2020 2020  tional, ..      
-00008600: 2020 7468 6520 7365 6162 6f72 6e20 7374    the seaborn st
-00008610: 796c 652e 0d0a 2020 2020 7665 7262 6f73  yle...    verbos
-00008620: 653a 2069 6e74 2c20 6465 6661 756c 743d  e: int, default=
-00008630: 3020 0d0a 2020 2020 2020 2020 7072 696e  0 ..        prin
-00008640: 7420 7468 6520 6665 6174 7572 6520 6c61  t the feature la
-00008650: 6265 6c73 2077 6974 6820 7468 6520 7261  bels with the ra
-00008660: 7465 206f 6620 7468 6569 7220 696d 706f  te of their impo
-00008670: 7274 616e 6365 732e 200d 0a20 2020 206b  rtances. ..    k
-00008680: 7773 3a20 6469 6374 2c20 0d0a 2020 2020  ws: dict, ..    
-00008690: 2020 2020 4164 6469 7469 6f6e 616c 206b      Additional k
-000086a0: 6579 7977 6f72 6420 6172 6775 6d65 6e74  eyyword argument
-000086b0: 7320 7061 7373 6564 2074 6f20 0d0a 2020  s passed to ..  
-000086c0: 2020 2020 2020 3a63 6c61 7373 3a60 736b        :class:`sk
-000086d0: 6c65 6172 6e2e 656e 7365 6d62 6c65 2e52  learn.ensemble.R
-000086e0: 616e 646f 6d46 6f72 6573 7443 6c61 7373  andomForestClass
-000086f0: 6966 6965 7260 0d0a 2020 2020 2020 2020  ifier`..        
-00008700: 0d0a 2020 2020 4578 616d 706c 6573 0d0a  ..    Examples..
-00008710: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0d 0a20      ---------.. 
-00008720: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
-00008730: 782e 6461 7461 7365 7473 2069 6d70 6f72  x.datasets impor
-00008740: 7420 6665 7463 685f 6461 7461 0d0a 2020  t fetch_data..  
-00008750: 2020 3e3e 3e20 6672 6f6d 2077 6174 6578    >>> from watex
-00008760: 2e65 786c 6962 2e73 6b6c 6561 726e 2069  .exlib.sklearn i
-00008770: 6d70 6f72 7420 5261 6e64 6f6d 466f 7265  mport RandomFore
-00008780: 7374 436c 6173 7369 6669 6572 200d 0a20  stClassifier .. 
-00008790: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
-000087a0: 782e 7574 696c 732e 706c 6f74 7574 696c  x.utils.plotutil
-000087b0: 7320 696d 706f 7274 2070 6c6f 745f 7266  s import plot_rf
-000087c0: 5f66 6561 7475 7265 5f69 6d70 6f72 7461  _feature_importa
-000087d0: 6e63 6573 200d 0a20 2020 203e 3e3e 2058  nces ..    >>> X
-000087e0: 2c20 7920 3d20 6665 7463 685f 6461 7461  , y = fetch_data
-000087f0: 2028 2762 6167 6f75 6520 616e 616c 7973   ('bagoue analys
-00008800: 6564 2720 2920 0d0a 2020 2020 3e3e 3e20  ed' ) ..    >>> 
-00008810: 706c 6f74 5f72 665f 6665 6174 7572 655f  plot_rf_feature_
-00008820: 696d 706f 7274 616e 6365 7320 280d 0a20  importances (.. 
-00008830: 2020 2020 2020 2052 616e 646f 6d46 6f72         RandomFor
-00008840: 6573 7443 6c61 7373 6966 6965 7228 292c  estClassifier(),
-00008850: 2058 3d58 2c20 793d 7920 2c20 736e 735f   X=X, y=y , sns_
-00008860: 7374 796c 653d 5472 7565 290d 0a0d 0a20  style=True).... 
-00008870: 2020 2022 2222 0d0a 2020 2020 6966 206e     """..    if n
-00008880: 6f74 2068 6173 6174 7472 2028 636c 662c  ot hasattr (clf,
-00008890: 2027 6665 6174 7572 655f 696d 706f 7274   'feature_import
-000088a0: 616e 6365 735f 2729 3a20 0d0a 2020 2020  ances_'): ..    
-000088b0: 2020 2020 6966 2028 2058 2069 7320 4e6f      if ( X is No
-000088c0: 6e65 206f 7220 7920 6973 204e 6f6e 6520  ne or y is None 
-000088d0: 2920 3a20 0d0a 2020 2020 2020 2020 2020  ) : ..          
-000088e0: 2020 636c 666e 203d 2067 6574 5f65 7374    clfn = get_est
-000088f0: 696d 6174 6f72 5f6e 616d 6528 2063 6c66  imator_name( clf
-00008900: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00008910: 6169 7365 2054 7970 6545 7272 6f72 2028  aise TypeError (
-00008920: 6622 5768 656e 207b 636c 666e 7d20 6973  f"When {clfn} is
-00008930: 206e 6f74 2061 2066 6974 7465 6420 220d   not a fitted ".
-00008940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008950: 2020 2020 2020 2020 2020 2020 2020 2265                "e
-00008960: 7374 696d 6174 6f72 2c20 5820 616e 6420  stimator, X and 
-00008970: 7920 6172 6520 6e65 6564 6564 2e22 0d0a  y are needed."..
-00008980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008990: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
-000089a0: 2020 2020 2020 2020 636c 6620 3d20 5261          clf = Ra
-000089b0: 6e64 6f6d 466f 7265 7374 436c 6173 7369  ndomForestClassi
-000089c0: 6669 6572 286e 5f65 7374 696d 6174 6f72  fier(n_estimator
-000089d0: 733d 206e 5f65 7374 696d 6174 6f72 7320  s= n_estimators 
-000089e0: 2c20 2a2a 6b77 7329 0d0a 2020 2020 2020  , **kws)..      
-000089f0: 2020 636c 662e 6669 7428 582c 2079 2029    clf.fit(X, y )
-00008a00: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-00008a10: 2069 6d70 6f72 7461 6e63 6573 203d 2063   importances = c
-00008a20: 6c66 2e66 6561 7475 7265 5f69 6d70 6f72  lf.feature_impor
-00008a30: 7461 6e63 6573 5f20 0d0a 2020 2020 696e  tances_ ..    in
-00008a40: 6469 6365 7320 3d20 6e70 2e61 7267 736f  dices = np.argso
-00008a50: 7274 2869 6d70 6f72 7461 6e63 6573 295b  rt(importances)[
-00008a60: 3a3a 2d31 5d0d 0a20 2020 2069 6620 6861  ::-1]..    if ha
-00008a70: 7361 7474 7228 2058 2c20 2763 6f6c 756d  sattr( X, 'colum
-00008a80: 6e73 2729 3a20 0d0a 2020 2020 2020 2020  ns'): ..        
-00008a90: 666c 6162 656c 7320 3d20 582e 636f 6c75  flabels = X.colu
-00008aa0: 6d6e 7320 0d0a 2020 2020 656c 7365 203a  mns ..    else :
-00008ab0: 2066 6c61 6265 6c73 203d 5b66 277b 693a   flabels =[f'{i:
-00008ac0: 3e37 7d27 2066 6f72 2069 2069 6e20 7261  >7}' for i in ra
-00008ad0: 6e67 6520 2858 2e73 6861 7065 5b31 5d29  nge (X.shape[1])
-00008ae0: 5d0d 0a20 2020 200d 0a20 2020 2069 6620  ]..    ..    if 
-00008af0: 7665 7262 6f73 6520 3a20 0d0a 2020 2020  verbose : ..    
-00008b00: 2020 2020 666f 7220 6620 696e 2072 616e      for f in ran
-00008b10: 6765 2858 2e73 6861 7065 205b 315d 293a  ge(X.shape [1]):
-00008b20: 200d 0a20 2020 2020 2020 2020 2020 2070   ..            p
-00008b30: 7269 6e74 2822 2532 6429 2025 2d2a 7320  rint("%2d) %-*s 
-00008b40: 2566 2220 2528 6620 2b31 202c 2033 3020  %f" %(f +1 , 30 
-00008b50: 2c20 666c 6162 656c 735b 696e 6469 6365  , flabels[indice
-00008b60: 735b 665d 5d2c 200d 0a20 2020 2020 2020  s[f]], ..       
-00008b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b80: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-00008b90: 7274 616e 6365 735b 696e 6469 6365 735b  rtances[indices[
-00008ba0: 665d 5d29 0d0a 2020 2020 2020 2020 2020  f]])..          
-00008bb0: 2020 2020 2020 2020 290d 0a20 2020 2069          )..    i
-00008bc0: 6620 736e 735f 7374 796c 653a 200d 0a20  f sns_style: .. 
-00008bd0: 2020 2020 2020 205f 7365 745f 736e 735f         _set_sns_
-00008be0: 7374 796c 6520 2873 6e73 5f73 7479 6c65  style (sns_style
-00008bf0: 290d 0a0d 0a20 2020 2070 6c74 2e66 6967  )....    plt.fig
-00008c00: 7572 6528 6669 6773 697a 6520 3d20 6669  ure(figsize = fi
-00008c10: 675f 7369 7a65 290d 0a20 2020 2070 6c74  g_size)..    plt
-00008c20: 2e74 6974 6c65 2028 2246 6561 7475 7265  .title ("Feature
-00008c30: 2069 6d70 6f72 7461 6e63 6522 290d 0a20   importance").. 
-00008c40: 2020 2070 6c74 2e62 6172 2028 7261 6e67     plt.bar (rang
-00008c50: 6528 582e 7368 6170 655b 315d 2920 2c20  e(X.shape[1]) , 
-00008c60: 0d0a 2020 2020 2020 2020 2020 2020 2069  ..             i
-00008c70: 6d70 6f72 7461 6e63 6573 205b 696e 6469  mportances [indi
-00008c80: 6365 735d 2c20 0d0a 2020 2020 2020 2020  ces], ..        
-00008c90: 2020 2020 2061 6c69 676e 3d27 6365 6e74       align='cent
-00008ca0: 6572 270d 0a20 2020 2020 2020 2020 2020  er'..           
-00008cb0: 2020 290d 0a20 2020 2070 6c74 2e78 7469    )..    plt.xti
-00008cc0: 636b 7320 2872 616e 6765 2028 582e 7368  cks (range (X.sh
-00008cd0: 6170 655b 315d 292c 2066 6c61 6265 6c73  ape[1]), flabels
-00008ce0: 205b 696e 6469 6365 735d 2c20 726f 7461   [indices], rota
-00008cf0: 7469 6f6e 203d 3930 202c 200d 0a20 2020  tion =90 , ..   
-00008d00: 2020 2020 2020 2020 2020 2020 2029 200d               ) .
-00008d10: 0a20 2020 2070 6c74 2e78 6c69 6d20 285b  .    plt.xlim ([
-00008d20: 2d31 202c 2058 2e73 6861 7065 5b31 5d5d  -1 , X.shape[1]]
-00008d30: 290d 0a20 2020 2070 6c74 2e79 6c61 6265  )..    plt.ylabe
-00008d40: 6c20 2827 496d 706f 7274 616e 6365 2072  l ('Importance r
-00008d50: 6174 6527 290d 0a20 2020 2070 6c74 2e78  ate')..    plt.x
-00008d60: 6c61 6265 6c20 2827 4665 6174 7572 6520  label ('Feature 
-00008d70: 6c61 6265 6c73 2729 0d0a 2020 2020 706c  labels')..    pl
-00008d80: 742e 7469 6768 745f 6c61 796f 7574 2829  t.tight_layout()
-00008d90: 0d0a 2020 2020 0d0a 2020 2020 6966 2073  ..    ..    if s
-00008da0: 6176 6566 6967 2069 7320 6e6f 7420 4e6f  avefig is not No
-00008db0: 6e65 3a0d 0a20 2020 2020 2020 2070 6c74  ne:..        plt
-00008dc0: 2e73 6176 6566 6967 2873 6176 6566 6967  .savefig(savefig
-00008dd0: 2029 0d0a 0d0a 2020 2020 706c 742e 636c   )....    plt.cl
-00008de0: 6f73 6520 2829 2069 6620 7361 7665 6669  ose () if savefi
-00008df0: 6720 6973 206e 6f74 204e 6f6e 6520 656c  g is not None el
-00008e00: 7365 2070 6c74 2e73 686f 7728 2920 0d0a  se plt.show() ..
-00008e10: 2020 2020 0d0a 2020 2020 2020 2020 0d0a      ..        ..
-00008e20: 6465 6620 706c 6f74 5f63 6f6e 6675 7369  def plot_confusi
-00008e30: 6f6e 5f6d 6174 7269 7820 2879 742c 2079  on_matrix (yt, y
-00008e40: 5f70 7265 642c 2076 6965 7720 3d54 7275  _pred, view =Tru
-00008e50: 652c 2061 783d 4e6f 6e65 2c20 616e 6e6f  e, ax=None, anno
-00008e60: 743d 5472 7565 2c20 202a 2a6b 7773 2029  t=True,  **kws )
-00008e70: 3a0d 0a20 2020 2022 2222 2070 6c6f 7420  :..    """ plot 
-00008e80: 6120 636f 6e66 7573 696f 6e20 6d61 7472  a confusion matr
-00008e90: 6978 2066 6f72 2061 2073 696e 676c 6520  ix for a single 
-00008ea0: 636c 6173 7369 6669 6572 206d 6f64 656c  classifier model
-00008eb0: 2e0d 0a20 2020 200d 0a20 2020 203a 7061  ...    ..    :pa
-00008ec0: 7261 6d20 7974 203a 206e 6461 7272 6179  ram yt : ndarray
-00008ed0: 206f 7220 5365 7269 6573 206f 6620 6c65   or Series of le
-00008ee0: 6e67 7468 206e 0d0a 2020 2020 2020 2020  ngth n..        
-00008ef0: 416e 2061 7272 6179 206f 7220 7365 7269  An array or seri
-00008f00: 6573 206f 6620 7472 7565 2074 6172 6765  es of true targe
-00008f10: 7420 6f72 2063 6c61 7373 2076 616c 7565  t or class value
-00008f20: 732e 2050 7265 6665 7261 626c 792c 200d  s. Preferably, .
-00008f30: 0a20 2020 2020 2020 2074 6865 2061 7272  .        the arr
-00008f40: 6179 2072 6570 7265 7365 6e74 7320 7468  ay represents th
-00008f50: 6520 7465 7374 2063 6c61 7373 206c 6162  e test class lab
-00008f60: 656c 7320 6461 7461 2066 6f72 2065 7272  els data for err
-00008f70: 6f72 2065 7661 6c75 6174 696f 6e2e 0d0a  or evaluation...
-00008f80: 2020 2020 0d0a 2020 2020 3a70 6172 616d      ..    :param
-00008f90: 2079 5f70 7265 643a 206e 6461 7272 6179   y_pred: ndarray
-00008fa0: 206f 7220 5365 7269 6573 206f 6620 6c65   or Series of le
-00008fb0: 6e67 7468 206e 0d0a 2020 2020 2020 2020  ngth n..        
-00008fc0: 416e 2061 7272 6179 206f 7220 7365 7269  An array or seri
-00008fd0: 6573 206f 6620 7468 6520 7072 6564 6963  es of the predic
-00008fe0: 7465 6420 7461 7267 6574 2e20 0d0a 2020  ted target. ..  
-00008ff0: 2020 3a70 6172 616d 2076 6965 773a 2062    :param view: b
-00009000: 6f6f 6c2c 2064 6566 6175 6c74 3d54 7275  ool, default=Tru
-00009010: 6520 0d0a 2020 2020 2020 2020 4f70 7469  e ..        Opti
-00009020: 6f6e 2074 6f20 6469 7370 6c61 7920 7468  on to display th
-00009030: 6520 6d61 7473 686f 7720 6d61 702e 2053  e matshow map. S
-00009040: 6574 2074 6f20 6060 4661 6c73 6560 6020  et to ``False`` 
-00009050: 6d75 7465 7320 7468 6520 706c 6f74 2e20  mutes the plot. 
-00009060: 0d0a 2020 2020 3a70 6172 616d 2061 6e6e  ..    :param ann
-00009070: 6f74 3a20 626f 6f6c 2c20 6465 6661 756c  ot: bool, defaul
-00009080: 743d 5472 7565 200d 0a20 2020 2020 2020  t=True ..       
-00009090: 2041 6e6e 6f74 6174 6520 7468 6520 6e75   Annotate the nu
-000090a0: 6d62 6572 206f 6620 7361 6d70 6c65 7320  mber of samples 
-000090b0: 2872 6967 6874 206f 7220 7772 6f6e 6720  (right or wrong 
-000090c0: 7072 6564 6963 7469 6f6e 2029 2069 6e20  prediction ) in 
-000090d0: 7468 6520 706c 6f74 2e20 0d0a 2020 2020  the plot. ..    
-000090e0: 2020 2020 5365 7420 6060 4661 6c73 6560      Set ``False`
-000090f0: 6020 746f 206d 7574 6520 7468 6520 6469  ` to mute the di
-00009100: 7370 6c61 792e 0d0a 2020 2020 7061 7261  splay...    para
-00009110: 6d20 6b77 733a 2064 6963 742c 200d 0a20  m kws: dict, .. 
-00009120: 2020 2020 2020 2041 6464 6974 696f 6e61         Additiona
-00009130: 6c20 6b65 7977 6f72 6420 6172 6775 6d65  l keyword argume
-00009140: 6e74 7320 7061 7373 6564 2074 6f20 7468  nts passed to th
-00009150: 6520 6675 6e63 7469 6f6e 200d 0a20 2020  e function ..   
-00009160: 2020 2020 203a 6675 6e63 3a60 7363 6b69       :func:`scki
-00009170: 746c 6561 726e 2e6d 6574 7269 6373 2e63  tlearn.metrics.c
-00009180: 6f6e 6675 7369 6f6e 5f6d 6174 7269 7860  onfusion_matrix`
-00009190: 2e20 0d0a 2020 2020 3a72 6574 7572 6e73  . ..    :returns
-000091a0: 3a20 6d61 742d 2063 6f6e 6675 7369 6f6e  : mat- confusion
-000091b0: 206d 6174 7269 7820 626c 6f63 206d 6174   matrix bloc mat
-000091c0: 7269 7820 0d0a 2020 2020 0d0a 2020 2020  rix ..    ..    
-000091d0: 3a65 7861 6d70 6c65 3a20 0d0a 2020 2020  :example: ..    
-000091e0: 3e3e 3e20 2349 6d70 6f72 7420 7468 6520  >>> #Import the 
-000091f0: 7265 7175 6972 6564 206d 6f64 656c 7320  required models 
-00009200: 616e 6420 6665 7463 6820 6120 616e 2041  and fetch a an A
-00009210: 6261 626f 6f73 7420 6d6f 6465 6c20 0d0a  baboost model ..
-00009220: 2020 2020 3e3e 3e20 2320 666f 7220 696e      >>> # for in
-00009230: 7374 616e 6365 2074 6865 6e20 706c 6f74  stance then plot
-00009240: 2074 6865 2063 6f6e 6675 7369 6f6e 206d   the confusion m
-00009250: 6574 7269 6320 0d0a 2020 2020 3e3e 3e20  etric ..    >>> 
-00009260: 696d 706f 7274 206d 6174 706c 6f74 6c69  import matplotli
-00009270: 622e 7079 706c 6f74 2061 7320 706c 7420  b.pyplot as plt 
-00009280: 0d0a 2020 2020 3e3e 3e20 706c 742e 7374  ..    >>> plt.st
-00009290: 796c 652e 7573 6520 2827 636c 6173 7369  yle.use ('classi
-000092a0: 6327 290d 0a20 2020 203e 3e3e 2066 726f  c')..    >>> fro
-000092b0: 6d20 7761 7465 782e 6461 7461 7365 7473  m watex.datasets
-000092c0: 2069 6d70 6f72 7420 6665 7463 685f 6461   import fetch_da
-000092d0: 7461 0d0a 2020 2020 3e3e 3e20 6672 6f6d  ta..    >>> from
-000092e0: 2077 6174 6578 2e65 786c 6962 2e73 6b6c   watex.exlib.skl
-000092f0: 6561 726e 2069 6d70 6f72 7420 7472 6169  earn import trai
-00009300: 6e5f 7465 7374 5f73 706c 6974 200d 0a20  n_test_split .. 
-00009310: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
-00009320: 782e 6d6f 6465 6c73 2069 6d70 6f72 7420  x.models import 
-00009330: 704d 6f64 656c 7320 0d0a 2020 2020 3e3e  pModels ..    >>
-00009340: 3e20 6672 6f6d 2077 6174 6578 2e75 7469  > from watex.uti
-00009350: 6c73 2e70 6c6f 7475 7469 6c73 2069 6d70  ls.plotutils imp
-00009360: 6f72 7420 706c 6f74 5f63 6f6e 6675 7369  ort plot_confusi
-00009370: 6f6e 5f6d 6174 7269 780d 0a20 2020 203e  on_matrix..    >
-00009380: 3e3e 2023 2073 706c 6974 2074 6865 2020  >> # split the  
-00009390: 6461 7461 202e 204e 6f74 6520 7468 6174  data . Note that
-000093a0: 2066 6574 6368 5f64 6174 6120 6f75 7470   fetch_data outp
-000093b0: 7574 2058 2061 6e64 2079 200d 0a20 2020  ut X and y ..   
-000093c0: 203e 3e3e 2058 2c20 5874 2c20 792c 2079   >>> X, Xt, y, y
-000093d0: 7420 203d 2074 7261 696e 5f74 6573 745f  t  = train_test_
-000093e0: 7370 6c69 7420 282a 2066 6574 6368 5f64  split (* fetch_d
-000093f0: 6174 6120 2827 6261 676f 7565 2061 6e61  ata ('bagoue ana
-00009400: 6c79 7365 6427 292c 0d0a 2020 2020 2020  lysed'),..      
-00009410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009430: 2020 2020 7465 7374 5f73 697a 6520 3d2e      test_size =.
-00009440: 3235 2020 2920 200d 0a20 2020 203e 3e3e  25  )  ..    >>>
-00009450: 2023 2074 7261 696e 2074 6865 206d 6f64   # train the mod
-00009460: 656c 2077 6974 6820 7468 6520 6265 7374  el with the best
-00009470: 2065 7374 696d 6174 6f72 200d 0a20 2020   estimator ..   
-00009480: 203e 3e3e 2070 6d6f 203d 2070 4d6f 6465   >>> pmo = pMode
-00009490: 6c73 2028 6d6f 6465 6c20 3d27 6164 6127  ls (model ='ada'
-000094a0: 2029 200d 0a20 2020 203e 3e3e 2070 6d6f   ) ..    >>> pmo
-000094b0: 2e66 6974 2858 2c20 7920 290d 0a20 2020  .fit(X, y )..   
-000094c0: 203e 3e3e 2070 7269 6e74 2870 6d6f 2e65   >>> print(pmo.e
-000094d0: 7374 696d 6174 6f72 5f20 290d 0a20 2020  stimator_ )..   
-000094e0: 203e 3e3e 2023 2525 200d 0a20 2020 203e   >>> #%% ..    >
-000094f0: 3e3e 2023 2050 7265 6469 6374 2074 6865  >> # Predict the
-00009500: 2073 636f 7265 2075 7369 6e67 2075 6e64   score using und
-00009510: 6572 2074 6865 2068 6f6f 6420 7468 6520  er the hood the 
-00009520: 6265 7374 2065 7374 696d 6174 6f72 200d  best estimator .
-00009530: 0a20 2020 203e 3e3e 2023 2066 6f72 2061  .    >>> # for a
-00009540: 6461 626f 6f73 7420 636c 6173 7369 6669  daboost classifi
-00009550: 6572 200d 0a20 2020 203e 3e3e 2079 7072  er ..    >>> ypr
-00009560: 6564 203d 2070 6d6f 2e70 7265 6469 6374  ed = pmo.predict
-00009570: 2858 7429 200d 0a20 2020 203e 3e3e 2023  (Xt) ..    >>> #
-00009580: 206e 6f77 2070 6c6f 7420 7468 6520 7363   now plot the sc
-00009590: 6f72 6520 0d0a 2020 2020 3e3e 3e20 706c  ore ..    >>> pl
-000095a0: 6f74 5f63 6f6e 6675 7369 6f6e 5f6d 6174  ot_confusion_mat
-000095b0: 7269 7820 2879 7420 2c20 7970 7265 6420  rix (yt , ypred 
-000095c0: 290d 0a20 2020 2022 2222 0d0a 2020 2020  )..    """..    
-000095d0: 6368 6563 6b5f 636f 6e73 6973 7465 6e74  check_consistent
-000095e0: 5f6c 656e 6774 6820 2879 742c 2079 5f70  _length (yt, y_p
-000095f0: 7265 6429 0d0a 2020 2020 6d61 743d 2063  red)..    mat= c
-00009600: 6f6e 6675 7369 6f6e 5f6d 6174 7269 7820  onfusion_matrix 
-00009610: 2879 742c 2079 5f70 7265 642c 202a 2a6b  (yt, y_pred, **k
-00009620: 7773 290d 0a20 2020 2069 6620 6178 2069  ws)..    if ax i
-00009630: 7320 4e6f 6e65 3a20 0d0a 2020 2020 2020  s None: ..      
-00009640: 2020 6669 672c 2061 7820 3d20 706c 742e    fig, ax = plt.
-00009650: 7375 6270 6c6f 7473 2028 290d 0a20 2020  subplots ()..   
-00009660: 2020 2020 200d 0a20 2020 2069 6620 7669       ..    if vi
-00009670: 6577 3a20 0d0a 2020 2020 2020 2020 736e  ew: ..        sn
-00009680: 732e 6865 6174 6d61 7020 280d 0a20 2020  s.heatmap (..   
-00009690: 2020 2020 2020 2020 206d 6174 2e54 2c20           mat.T, 
-000096a0: 7371 7561 7265 203d 5472 7565 2c20 616e  square =True, an
-000096b0: 6e6f 7420 3d61 6e6e 6f74 2c20 6362 6172  not =annot, cbar
-000096c0: 3d46 616c 7365 2c20 6178 3d61 7829 0d0a  =False, ax=ax)..
-000096d0: 2020 2020 2020 2020 2320 7874 6963 6b6c          # xtickl
-000096e0: 6162 656c 733d 206c 6973 7428 6e70 2e75  abels= list(np.u
-000096f0: 6e69 7175 6528 7974 7275 652e 7661 6c75  nique(ytrue.valu
-00009700: 6573 2929 2c20 0d0a 2020 2020 2020 2020  es)), ..        
-00009710: 2320 7974 6963 6b6c 6162 656c 733d 206c  # yticklabels= l
-00009720: 6973 7428 6e70 2e75 6e69 7175 6528 7974  ist(np.unique(yt
-00009730: 7275 652e 7661 6c75 6573 2929 290d 0a20  rue.values))).. 
-00009740: 2020 2020 2020 2061 782e 7365 745f 786c         ax.set_xl
-00009750: 6162 656c 2827 7472 7565 206c 6162 656c  abel('true label
-00009760: 7327 2029 0d0a 2020 2020 2020 2020 6178  s' )..        ax
-00009770: 2e73 6574 5f79 6c61 6265 6c20 2827 7072  .set_ylabel ('pr
-00009780: 6564 6963 7465 6420 6c61 6265 6c73 2729  edicted labels')
-00009790: 0d0a 2020 2020 7265 7475 726e 206d 6174  ..    return mat
-000097a0: 200d 0a0d 0a64 6566 2070 6c6f 745f 7962   ....def plot_yb
-000097b0: 5f63 6f6e 6675 7369 6f6e 5f6d 6174 7269  _confusion_matri
-000097c0: 7820 280d 0a20 2020 2020 2020 2063 6c66  x (..        clf
-000097d0: 2c20 5874 2c20 7974 2c20 6c61 6265 6c73  , Xt, yt, labels
-000097e0: 203d 204e 6f6e 6520 2c20 656e 636f 6465   = None , encode
-000097f0: 7220 3d20 4e6f 6e65 2c20 7361 7665 6669  r = None, savefi
-00009800: 6720 3d4e 6f6e 652c 200d 0a20 2020 2020  g =None, ..     
-00009810: 2020 2066 6967 5f73 697a 6520 3d28 362c     fig_size =(6,
-00009820: 2036 292c 202a 2a6b 7773 0d0a 2020 2020   6), **kws..    
-00009830: 2020 2020 293a 200d 0a20 2020 2022 2222      ): ..    """
-00009840: 2043 6f6e 6675 7369 6f6e 206d 6174 7269   Confusion matri
-00009850: 7820 706c 6f74 2075 7369 6e67 2074 6865  x plot using the
-00009860: 2027 7965 6c6c 6f77 6272 6963 6b27 2070   'yellowbrick' p
-00009870: 6163 6b61 6765 2e20 200d 0a20 2020 200d  ackage.  ..    .
-00009880: 0a20 2020 2043 7265 6174 6573 2061 2068  .    Creates a h
-00009890: 6561 746d 6170 2076 6973 7561 6c69 7a61  eatmap visualiza
-000098a0: 7469 6f6e 206f 6620 7468 6520 736b 6c65  tion of the skle
-000098b0: 6172 6e2e 6d65 7472 6963 732e 636f 6e66  arn.metrics.conf
-000098c0: 7573 696f 6e5f 6d61 7472 6978 2829 2e0d  usion_matrix()..
-000098d0: 0a20 2020 2041 2063 6f6e 6675 7369 6f6e  .    A confusion
-000098e0: 206d 6174 7269 7820 7368 6f77 7320 6561   matrix shows ea
-000098f0: 6368 2063 6f6d 6269 6e61 7469 6f6e 206f  ch combination o
-00009900: 6620 7468 6520 7472 7565 2061 6e64 2070  f the true and p
-00009910: 7265 6469 6374 6564 0d0a 2020 2020 636c  redicted..    cl
-00009920: 6173 7365 7320 666f 7220 6120 7465 7374  asses for a test
-00009930: 2064 6174 6120 7365 742e 0d0a 0d0a 2020   data set.....  
-00009940: 2020 5468 6520 6465 6661 756c 7420 636f    The default co
-00009950: 6c6f 7220 6d61 7020 7573 6573 2061 2079  lor map uses a y
-00009960: 656c 6c6f 772f 6f72 616e 6765 2f72 6564  ellow/orange/red
-00009970: 2063 6f6c 6f72 2073 6361 6c65 2e20 5468   color scale. Th
-00009980: 6520 7573 6572 2063 616e 0d0a 2020 2020  e user can..    
-00009990: 6368 6f6f 7365 2062 6574 7765 656e 2064  choose between d
-000099a0: 6973 706c 6179 696e 6720 7661 6c75 6573  isplaying values
-000099b0: 2061 7320 7468 6520 7065 7263 656e 7420   as the percent 
-000099c0: 6f66 2074 7275 6520 2863 656c 6c20 7661  of true (cell va
-000099d0: 6c75 650d 0a20 2020 2064 6976 6964 6564  lue..    divided
-000099e0: 2062 7920 7375 6d20 6f66 2072 6f77 2920   by sum of row) 
-000099f0: 6f72 2061 7320 6469 7265 6374 2063 6f75  or as direct cou
-00009a00: 6e74 732e 2049 6620 7065 7263 656e 7420  nts. If percent 
-00009a10: 6f66 2074 7275 6520 6d6f 6465 2069 730d  of true mode is.
-00009a20: 0a20 2020 2073 656c 6563 7465 642c 2031  .    selected, 1
-00009a30: 3030 2520 6163 6375 7261 7465 2070 7265  00% accurate pre
-00009a40: 6469 6374 696f 6e73 2061 7265 2068 6967  dictions are hig
-00009a50: 686c 6967 6874 6564 2069 6e20 6772 6565  hlighted in gree
-00009a60: 6e2e 0d0a 0d0a 2020 2020 5265 7175 6972  n.....    Requir
-00009a70: 6573 2061 2063 6c61 7373 6966 6963 6174  es a classificat
-00009a80: 696f 6e20 6d6f 6465 6c2e 0d0a 2020 2020  ion model...    
-00009a90: 0d0a 2020 2020 4265 2073 7572 6520 2779  ..    Be sure 'y
-00009aa0: 656c 6c6f 7762 7269 636b 2720 6973 2069  ellowbrick' is i
-00009ab0: 6e73 7461 6c6c 6564 2062 6566 6f72 6520  nstalled before 
-00009ac0: 7573 696e 6720 7468 6520 6675 6e63 7469  using the functi
-00009ad0: 6f6e 2c20 6f74 6865 7277 6973 6520 616e  on, otherwise an
-00009ae0: 200d 0a20 2020 2049 6d70 6f72 7445 7272   ..    ImportErr
-00009af0: 6f72 2077 696c 6c20 7261 6973 652e 200d  or will raise. .
-00009b00: 0a20 2020 200d 0a20 2020 2050 6172 616d  .    ..    Param
-00009b10: 6574 6572 7320 0d0a 2020 2020 2d2d 2d2d  eters ..    ----
-00009b20: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2063 6c66  -------..    clf
-00009b30: 203a 2063 6c61 7373 6966 6965 7220 6573   : classifier es
-00009b40: 7469 6d61 746f 720d 0a20 2020 2020 2020  timator..       
-00009b50: 2041 2073 6369 6b69 742d 6c65 6172 6e20   A scikit-learn 
-00009b60: 6573 7469 6d61 746f 7220 7468 6174 2073  estimator that s
-00009b70: 686f 756c 6420 6265 2061 2063 6c61 7373  hould be a class
-00009b80: 6966 6965 722e 2049 6620 7468 6520 6d6f  ifier. If the mo
-00009b90: 6465 6c20 6973 0d0a 2020 2020 2020 2020  del is..        
-00009ba0: 6e6f 7420 6120 636c 6173 7369 6669 6572  not a classifier
-00009bb0: 2c20 616e 2065 7863 6570 7469 6f6e 2069  , an exception i
-00009bc0: 7320 7261 6973 6564 2e20 4966 2074 6865  s raised. If the
-00009bd0: 2069 6e74 6572 6e61 6c20 6d6f 6465 6c20   internal model 
-00009be0: 6973 206e 6f74 0d0a 2020 2020 2020 2020  is not..        
-00009bf0: 6669 7474 6564 2c20 6974 2069 7320 6669  fitted, it is fi
-00009c00: 7420 7768 656e 2074 6865 2076 6973 7561  t when the visua
-00009c10: 6c69 7a65 7220 6973 2066 6974 7465 642c  lizer is fitted,
-00009c20: 2075 6e6c 6573 7320 6f74 6865 7277 6973   unless otherwis
-00009c30: 6520 7370 6563 6966 6965 640d 0a20 2020  e specified..   
-00009c40: 2020 2020 2062 7920 6060 6973 5f66 6974       by ``is_fit
-00009c50: 7465 6460 602e 0d0a 2020 2020 2020 2020  ted``...        
-00009c60: 0d0a 2020 2020 5874 203a 206e 6461 7272  ..    Xt : ndarr
-00009c70: 6179 206f 7220 4461 7461 4672 616d 6520  ay or DataFrame 
-00009c80: 6f66 2073 6861 7065 206e 2078 206d 0d0a  of shape n x m..
-00009c90: 2020 2020 2020 2020 4120 6d61 7472 6978          A matrix
-00009ca0: 206f 6620 6e20 696e 7374 616e 6365 7320   of n instances 
-00009cb0: 7769 7468 206d 2066 6561 7475 7265 732e  with m features.
-00009cc0: 2050 7265 6665 7261 626c 792c 206d 6174   Preferably, mat
-00009cd0: 7269 7820 7265 7072 6573 656e 7473 200d  rix represents .
-00009ce0: 0a20 2020 2020 2020 2074 6865 2074 6573  .        the tes
-00009cf0: 7420 6461 7461 2066 6f72 2065 7272 6f72  t data for error
-00009d00: 2065 7661 6c75 6174 696f 6e2e 2020 0d0a   evaluation.  ..
-00009d10: 0d0a 2020 2020 7974 203a 206e 6461 7272  ..    yt : ndarr
-00009d20: 6179 206f 7220 5365 7269 6573 206f 6620  ay or Series of 
-00009d30: 6c65 6e67 7468 206e 0d0a 2020 2020 2020  length n..      
-00009d40: 2020 416e 2061 7272 6179 206f 7220 7365    An array or se
-00009d50: 7269 6573 206f 6620 7461 7267 6574 206f  ries of target o
-00009d60: 7220 636c 6173 7320 7661 6c75 6573 2e20  r class values. 
-00009d70: 5072 6566 6572 6162 6c79 2c20 7468 6520  Preferably, the 
-00009d80: 6172 7261 7920 0d0a 2020 2020 2020 2020  array ..        
-00009d90: 7265 7072 6573 656e 7420 7468 6520 7465  represent the te
-00009da0: 7374 2063 6c61 7373 206c 6162 656c 7320  st class labels 
-00009db0: 6461 7461 2066 6f72 2065 7272 6f72 2065  data for error e
-00009dc0: 7661 6c75 6174 696f 6e2e 2020 0d0a 0d0a  valuation.  ....
-00009dd0: 2020 2020 6178 203a 206d 6174 706c 6f74      ax : matplot
-00009de0: 6c69 6220 4178 6573 2c20 6465 6661 756c  lib Axes, defaul
-00009df0: 743a 204e 6f6e 650d 0a20 2020 2020 2020  t: None..       
-00009e00: 2054 6865 2061 7865 7320 746f 2070 6c6f   The axes to plo
-00009e10: 7420 7468 6520 6669 6775 7265 206f 6e2e  t the figure on.
-00009e20: 2049 6620 6e6f 7420 7370 6563 6966 6965   If not specifie
-00009e30: 6420 7468 6520 6375 7272 656e 7420 6178  d the current ax
-00009e40: 6573 2077 696c 6c20 6265 0d0a 2020 2020  es will be..    
-00009e50: 2020 2020 7573 6564 2028 6f72 2067 656e      used (or gen
-00009e60: 6572 6174 6564 2069 6620 7265 7175 6972  erated if requir
-00009e70: 6564 292e 0d0a 0d0a 2020 2020 7361 6d70  ed).....    samp
-00009e80: 6c65 5f77 6569 6768 743a 2061 7272 6179  le_weight: array
-00009e90: 2d6c 696b 6520 6f66 2073 6861 7065 203d  -like of shape =
-00009ea0: 205b 6e5f 7361 6d70 6c65 735d 2c20 6f70   [n_samples], op
-00009eb0: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-00009ec0: 5061 7373 6564 2074 6f20 6060 636f 6e66  Passed to ``conf
-00009ed0: 7573 696f 6e5f 6d61 7472 6978 6060 2074  usion_matrix`` t
-00009ee0: 6f20 7765 6967 6874 2074 6865 2073 616d  o weight the sam
-00009ef0: 706c 6573 2e0d 0a20 2020 2020 2020 200d  ples...        .
-00009f00: 0a20 2020 2065 6e63 6f64 6572 203a 2064  .    encoder : d
-00009f10: 6963 7420 6f72 204c 6162 656c 456e 636f  ict or LabelEnco
-00009f20: 6465 722c 2064 6566 6175 6c74 3a20 4e6f  der, default: No
-00009f30: 6e65 0d0a 2020 2020 2020 2020 4120 6d61  ne..        A ma
-00009f40: 7070 696e 6720 6f66 2063 6c61 7373 6573  pping of classes
-00009f50: 2074 6f20 6875 6d61 6e20 7265 6164 6162   to human readab
-00009f60: 6c65 206c 6162 656c 732e 204f 6674 656e  le labels. Often
-00009f70: 2074 6865 7265 2069 7320 6120 6d69 736d   there is a mism
-00009f80: 6174 6368 0d0a 2020 2020 2020 2020 6265  atch..        be
-00009f90: 7477 6565 6e20 6465 7369 7265 6420 636c  tween desired cl
-00009fa0: 6173 7320 6c61 6265 6c73 2061 6e64 2074  ass labels and t
-00009fb0: 686f 7365 2063 6f6e 7461 696e 6564 2069  hose contained i
-00009fc0: 6e20 7468 6520 7461 7267 6574 2076 6172  n the target var
-00009fd0: 6961 626c 650d 0a20 2020 2020 2020 2070  iable..        p
-00009fe0: 6173 7365 6420 746f 2060 6066 6974 2829  assed to ``fit()
-00009ff0: 6060 206f 7220 6060 7363 6f72 6528 2960  `` or ``score()`
-0000a000: 602e 2054 6865 2065 6e63 6f64 6572 2064  `. The encoder d
-0000a010: 6973 616d 6269 6775 6174 6573 2074 6869  isambiguates thi
-0000a020: 7320 6d69 736d 6174 6368 0d0a 2020 2020  s mismatch..    
-0000a030: 2020 2020 656e 7375 7269 6e67 2074 6861      ensuring tha
-0000a040: 7420 636c 6173 7365 7320 6172 6520 6c61  t classes are la
-0000a050: 6265 6c65 6420 636f 7272 6563 746c 7920  beled correctly 
-0000a060: 696e 2074 6865 2076 6973 7561 6c69 7a61  in the visualiza
-0000a070: 7469 6f6e 2e0d 0a20 2020 2020 2020 200d  tion...        .
-0000a080: 0a20 2020 206c 6162 656c 7320 3a20 6c69  .    labels : li
-0000a090: 7374 206f 6620 7374 722c 2064 6566 6175  st of str, defau
-0000a0a0: 6c74 3a20 4e6f 6e65 0d0a 2020 2020 2020  lt: None..      
-0000a0b0: 2020 5468 6520 636c 6173 7320 6c61 6265    The class labe
-0000a0c0: 6c73 2074 6f20 7573 6520 666f 7220 7468  ls to use for th
-0000a0d0: 6520 6c65 6765 6e64 206f 7264 6572 6564  e legend ordered
-0000a0e0: 2062 7920 7468 6520 696e 6465 7820 6f66   by the index of
-0000a0f0: 2074 6865 2073 6f72 7465 640d 0a20 2020   the sorted..   
-0000a100: 2020 2020 2063 6c61 7373 6573 2064 6973       classes dis
-0000a110: 636f 7665 7265 6420 696e 2074 6865 2060  covered in the `
-0000a120: 6066 6974 2829 6060 206d 6574 686f 642e  `fit()`` method.
-0000a130: 2053 7065 6369 6679 696e 6720 636c 6173   Specifying clas
-0000a140: 7365 7320 696e 2074 6869 730d 0a20 2020  ses in this..   
-0000a150: 2020 2020 206d 616e 6e65 7220 6973 2075       manner is u
-0000a160: 7365 6420 746f 2063 6861 6e67 6520 7468  sed to change th
-0000a170: 6520 636c 6173 7320 6e61 6d65 7320 746f  e class names to
-0000a180: 2061 206d 6f72 6520 7370 6563 6966 6963   a more specific
-0000a190: 2066 6f72 6d61 7420 6f72 0d0a 2020 2020   format or..    
-0000a1a0: 2020 2020 746f 206c 6162 656c 2065 6e63      to label enc
-0000a1b0: 6f64 6564 2069 6e74 6567 6572 2063 6c61  oded integer cla
-0000a1c0: 7373 6573 2e20 536f 6d65 2076 6973 7561  sses. Some visua
-0000a1d0: 6c69 7a65 7273 206d 6179 2061 6c73 6f20  lizers may also 
-0000a1e0: 7573 6520 7468 6973 0d0a 2020 2020 2020  use this..      
-0000a1f0: 2020 6669 656c 6420 746f 2066 696c 7465    field to filte
-0000a200: 7220 7468 6520 7669 7375 616c 697a 6174  r the visualizat
-0000a210: 696f 6e20 666f 7220 7370 6563 6966 6963  ion for specific
-0000a220: 2063 6c61 7373 6573 2e20 466f 7220 6d6f   classes. For mo
-0000a230: 7265 2061 6476 616e 6365 640d 0a20 2020  re advanced..   
-0000a240: 2020 2020 2075 7361 6765 2073 7065 6369       usage speci
-0000a250: 6679 2061 6e20 656e 636f 6465 7220 7261  fy an encoder ra
-0000a260: 7468 6572 2074 6861 6e20 636c 6173 7320  ther than class 
-0000a270: 6c61 6265 6c73 2e0d 0a20 2020 2020 2020  labels...       
-0000a280: 200d 0a20 2020 2066 6967 5f73 697a 6520   ..    fig_size 
-0000a290: 3a20 7475 706c 6520 2877 6964 7468 2c20  : tuple (width, 
-0000a2a0: 6865 6967 6874 292c 2064 6566 6175 6c74  height), default
-0000a2b0: 203d 2838 2c20 3629 0d0a 2020 2020 2020   =(8, 6)..      
-0000a2c0: 2020 7468 6520 6d61 7470 6c6f 746c 6962    the matplotlib
-0000a2d0: 2066 6967 7572 6520 7369 7a65 2067 6976   figure size giv
-0000a2e0: 656e 2061 7320 6120 7475 706c 6520 6f66  en as a tuple of
-0000a2f0: 2077 6964 7468 2061 6e64 2068 6569 6768   width and heigh
-0000a300: 740d 0a20 2020 2020 2020 200d 0a20 2020  t..        ..   
-0000a310: 2073 6176 6566 6967 3a20 7374 722c 2064   savefig: str, d
-0000a320: 6566 6175 6c74 203d 4e6f 6e65 202c 200d  efault =None , .
-0000a330: 0a20 2020 2020 2020 2074 6865 2070 6174  .        the pat
-0000a340: 6820 746f 2073 6176 6520 7468 6520 6669  h to save the fi
-0000a350: 6775 7265 732e 2041 7267 756d 656e 7420  gures. Argument 
-0000a360: 6973 2070 6173 7365 6420 746f 206d 6174  is passed to mat
-0000a370: 706c 6f74 6c69 622e 4669 6775 7265 200d  plotlib.Figure .
-0000a380: 0a20 2020 2020 2020 2063 6c61 7373 2e20  .        class. 
-0000a390: 0d0a 2020 2020 2020 2020 2020 0d0a 2020  ..          ..  
-0000a3a0: 2020 5265 7475 726e 7320 0d0a 2020 2020    Returns ..    
-0000a3b0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 636d  --------..    cm
-0000a3c0: 6f3a 203a 636c 6173 733a 6079 656c 6c6f  o: :class:`yello
-0000a3d0: 7762 7269 636b 2e63 6c61 7373 6966 6965  wbrick.classifie
-0000a3e0: 722e 636f 6e66 7573 696f 6e5f 6d61 7472  r.confusion_matr
-0000a3f0: 6978 2e43 6f6e 6675 7369 6f6e 4d61 7472  ix.ConfusionMatr
-0000a400: 6978 600d 0a20 2020 2020 2020 2072 6574  ix`..        ret
-0000a410: 7572 6e20 6120 7965 6c6c 6f77 6272 6963  urn a yellowbric
-0000a420: 6b20 636f 6e66 7573 696f 6e20 6d61 7472  k confusion matr
-0000a430: 6978 206f 626a 6563 7420 696e 7374 616e  ix object instan
-0000a440: 6365 2e20 0d0a 2020 2020 0d0a 2020 2020  ce. ..    ..    
-0000a450: 4578 616d 706c 6573 200d 0a20 2020 202d  Examples ..    -
-0000a460: 2d2d 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e  -------..    >>>
-0000a470: 2023 496d 706f 7274 2074 6865 2072 6571   #Import the req
-0000a480: 7569 7265 6420 6d6f 6465 6c73 2061 6e64  uired models and
-0000a490: 2066 6574 6368 2061 2061 6e20 6578 7472   fetch a an extr
-0000a4a0: 656d 6520 6772 6164 6965 6e74 2062 6f6f  eme gradient boo
-0000a4b0: 7374 696e 6720 0d0a 2020 2020 3e3e 3e20  sting ..    >>> 
-0000a4c0: 2320 666f 7220 696e 7374 616e 6365 2074  # for instance t
-0000a4d0: 6865 6e20 706c 6f74 2074 6865 2063 6f6e  hen plot the con
-0000a4e0: 6675 7369 6f6e 206d 6574 7269 6320 0d0a  fusion metric ..
-0000a4f0: 2020 2020 3e3e 3e20 696d 706f 7274 206d      >>> import m
-0000a500: 6174 706c 6f74 6c69 622e 7079 706c 6f74  atplotlib.pyplot
-0000a510: 2061 7320 706c 7420 0d0a 2020 2020 3e3e   as plt ..    >>
-0000a520: 3e20 706c 742e 7374 796c 652e 7573 6520  > plt.style.use 
-0000a530: 2827 636c 6173 7369 6327 290d 0a20 2020  ('classic')..   
-0000a540: 203e 3e3e 2066 726f 6d20 7761 7465 782e   >>> from watex.
-0000a550: 6461 7461 7365 7473 2069 6d70 6f72 7420  datasets import 
-0000a560: 6665 7463 685f 6461 7461 0d0a 2020 2020  fetch_data..    
-0000a570: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e65  >>> from watex.e
-0000a580: 786c 6962 2e73 6b6c 6561 726e 2069 6d70  xlib.sklearn imp
-0000a590: 6f72 7420 7472 6169 6e5f 7465 7374 5f73  ort train_test_s
-0000a5a0: 706c 6974 200d 0a20 2020 203e 3e3e 2066  plit ..    >>> f
-0000a5b0: 726f 6d20 7761 7465 782e 6d6f 6465 6c73  rom watex.models
-0000a5c0: 2069 6d70 6f72 7420 704d 6f64 656c 7320   import pModels 
-0000a5d0: 0d0a 2020 2020 3e3e 3e20 6672 6f6d 2077  ..    >>> from w
-0000a5e0: 6174 6578 2e75 7469 6c73 2e70 6c6f 7475  atex.utils.plotu
-0000a5f0: 7469 6c73 2069 6d70 6f72 7420 706c 6f74  tils import plot
-0000a600: 5f79 625f 636f 6e66 7573 696f 6e5f 6d61  _yb_confusion_ma
-0000a610: 7472 6978 0d0a 2020 2020 3e3e 3e20 2320  trix..    >>> # 
-0000a620: 7370 6c69 7420 7468 6520 2064 6174 6120  split the  data 
-0000a630: 2e20 4e6f 7465 2074 6861 7420 6665 7463  . Note that fetc
-0000a640: 685f 6461 7461 206f 7574 7075 7420 5820  h_data output X 
-0000a650: 616e 6420 7920 0d0a 2020 2020 3e3e 3e20  and y ..    >>> 
-0000a660: 582c 2058 742c 2079 2c20 7974 2020 3d20  X, Xt, y, yt  = 
-0000a670: 7472 6169 6e5f 7465 7374 5f73 706c 6974  train_test_split
-0000a680: 2028 2a20 6665 7463 685f 6461 7461 2028   (* fetch_data (
-0000a690: 2762 6167 6f75 6520 616e 616c 7973 6564  'bagoue analysed
-0000a6a0: 2729 2c0d 0a20 2020 2020 2020 2020 2020  '),..           
-0000a6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a6c0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0000a6d0: 6573 745f 7369 7a65 203d 2e32 3520 2029  est_size =.25  )
-0000a6e0: 2020 0d0a 2020 2020 3e3e 3e20 2320 7472    ..    >>> # tr
-0000a6f0: 6169 6e20 7468 6520 6d6f 6465 6c20 7769  ain the model wi
-0000a700: 7468 2074 6865 2062 6573 7420 6573 7469  th the best esti
-0000a710: 6d61 746f 7220 0d0a 2020 2020 3e3e 3e20  mator ..    >>> 
-0000a720: 706d 6f20 3d20 704d 6f64 656c 7320 286d  pmo = pModels (m
-0000a730: 6f64 656c 203d 2778 6762 6f6f 7374 2720  odel ='xgboost' 
-0000a740: 2920 0d0a 2020 2020 3e3e 3e20 706d 6f2e  ) ..    >>> pmo.
-0000a750: 6669 7428 582c 2079 2029 0d0a 2020 2020  fit(X, y )..    
-0000a760: 3e3e 3e20 7072 696e 7428 706d 6f2e 6573  >>> print(pmo.es
-0000a770: 7469 6d61 746f 725f 2029 2023 2070 6d6f  timator_ ) # pmo
-0000a780: 2e58 4742 2e62 6573 745f 6573 7469 6d61  .XGB.best_estima
-0000a790: 746f 725f 0d0a 2020 2020 3e3e 3e20 2325  tor_..    >>> #%
-0000a7a0: 2520 0d0a 2020 2020 3e3e 3e20 2320 5072  % ..    >>> # Pr
-0000a7b0: 6564 6963 7420 7468 6520 7363 6f72 6520  edict the score 
-0000a7c0: 7573 696e 6720 756e 6465 7220 7468 6520  using under the 
-0000a7d0: 686f 6f64 2074 6865 2062 6573 7420 6573  hood the best es
-0000a7e0: 7469 6d61 746f 7220 0d0a 2020 2020 3e3e  timator ..    >>
-0000a7f0: 3e20 2320 666f 7220 6164 6162 6f6f 7374  > # for adaboost
-0000a800: 2063 6c61 7373 6966 6965 7220 0d0a 2020   classifier ..  
-0000a810: 2020 3e3e 3e20 7970 7265 6420 3d20 706d    >>> ypred = pm
-0000a820: 6f2e 7072 6564 6963 7428 5874 2920 0d0a  o.predict(Xt) ..
-0000a830: 2020 2020 0d0a 2020 2020 3e3e 3e20 2320      ..    >>> # 
-0000a840: 6e6f 7720 706c 6f74 2074 6865 2073 636f  now plot the sco
-0000a850: 7265 200d 0a20 2020 203e 3e3e 2070 6c6f  re ..    >>> plo
-0000a860: 745f 7962 5f63 6f6e 6675 7369 6f6e 5f6d  t_yb_confusion_m
-0000a870: 6174 7269 7820 2870 6d6f 2e58 4742 2e62  atrix (pmo.XGB.b
-0000a880: 6573 745f 6573 7469 6d61 746f 725f 2c20  est_estimator_, 
-0000a890: 5874 2c20 7974 2020 290d 0a20 2020 2022  Xt, yt  )..    "
-0000a8a0: 2222 0d0a 2020 2020 696d 706f 7274 5f6f  ""..    import_o
-0000a8b0: 7074 696f 6e61 6c5f 6465 7065 6e64 656e  ptional_dependen
-0000a8c0: 6379 2827 7965 6c6c 6f77 6272 6963 6b27  cy('yellowbrick'
-0000a8d0: 2c20 280d 0a20 2020 2020 2020 2022 4361  , (..        "Ca
-0000a8e0: 6e6e 6f74 2070 6c6f 7420 7468 6520 636f  nnot plot the co
-0000a8f0: 6e66 7573 696f 6e20 6d61 7472 6978 2076  nfusion matrix v
-0000a900: 6961 2027 7965 6c6c 6f77 6272 6963 6b27  ia 'yellowbrick'
-0000a910: 2070 6163 6b61 6765 2e22 0d0a 2020 2020   package."..    
-0000a920: 2020 2020 2220 416c 7465 726e 6174 6976      " Alternativ
-0000a930: 656c 792c 2079 6f75 206d 6179 2075 7365  ely, you may use
-0000a940: 2075 6675 6e63 2060 7e2e 706c 6f74 5f63   ufunc `~.plot_c
-0000a950: 6f6e 6675 7369 6f6e 5f6d 6174 7269 7860  onfusion_matrix`
-0000a960: 2c22 0d0a 2020 2020 2020 2020 2220 6f74  ,"..        " ot
-0000a970: 6865 7277 6973 6520 696e 7374 616c 6c20  herwise install 
-0000a980: 6974 206d 616e 6e75 616c 6c79 2e22 290d  it mannually.").
-0000a990: 0a20 2020 2020 2020 2029 0d0a 2020 2020  .        )..    
-0000a9a0: 6669 672c 2061 7820 3d20 706c 742e 7375  fig, ax = plt.su
-0000a9b0: 6270 6c6f 7473 2866 6967 7369 7a65 203d  bplots(figsize =
-0000a9c0: 2066 6967 5f73 697a 6520 290d 0a20 2020   fig_size )..   
-0000a9d0: 2063 6d6f 3d20 436f 6e66 7573 696f 6e4d   cmo= ConfusionM
-0000a9e0: 6174 7269 7820 2863 6c66 2c20 636c 6173  atrix (clf, clas
-0000a9f0: 7365 733d 6c61 6265 6c73 2c20 0d0a 2020  ses=labels, ..  
-0000aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aa10: 2020 2020 2020 206c 6162 656c 5f65 6e63         label_enc
-0000aa20: 6f64 6572 203d 2065 6e63 6f64 6572 2c20  oder = encoder, 
-0000aa30: 2a2a 6b77 730d 0a20 2020 2020 2020 2020  **kws..         
-0000aa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aa50: 290d 0a20 2020 2063 6d6f 2e73 636f 7265  )..    cmo.score
-0000aa60: 2858 742c 2079 7429 0d0a 2020 2020 636d  (Xt, yt)..    cm
-0000aa70: 6f2e 7368 6f77 2829 0d0a 0d0a 2020 2020  o.show()....    
-0000aa80: 6966 2073 6176 6566 6967 2069 7320 6e6f  if savefig is no
-0000aa90: 7420 4e6f 6e65 3a20 0d0a 2020 2020 2020  t None: ..      
-0000aaa0: 2020 6669 672e 7361 7665 6669 6728 7361    fig.savefig(sa
-0000aab0: 7665 6669 672c 2064 7069 203d 3330 3029  vefig, dpi =300)
-0000aac0: 0d0a 0d0a 2020 2020 706c 742e 636c 6f73  ....    plt.clos
-0000aad0: 6520 2829 2069 6620 7361 7665 6669 6720  e () if savefig 
-0000aae0: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
-0000aaf0: 2070 6c74 2e73 686f 7728 2920 0d0a 2020   plt.show() ..  
-0000ab00: 2020 0d0a 2020 2020 7265 7475 726e 2063    ..    return c
-0000ab10: 6d6f 200d 0a0d 0a64 6566 2070 6c6f 745f  mo ....def plot_
-0000ab20: 636f 6e66 7573 696f 6e5f 6d61 7472 6963  confusion_matric
-0000ab30: 6573 2028 0d0a 2020 2020 636c 6673 2c20  es (..    clfs, 
-0000ab40: 0d0a 2020 2020 5874 2c20 0d0a 2020 2020  ..    Xt, ..    
-0000ab50: 7974 2c20 200d 0a20 2020 2061 6e6e 6f74  yt,  ..    annot
-0000ab60: 203d 5472 7565 2c20 0d0a 2020 2020 706b   =True, ..    pk
-0000ab70: 673d 4e6f 6e65 2c20 0d0a 2020 2020 6e6f  g=None, ..    no
-0000ab80: 726d 616c 697a 653d 2774 7275 6527 2c20  rmalize='true', 
-0000ab90: 0d0a 2020 2020 7361 6d70 6c65 5f77 6569  ..    sample_wei
-0000aba0: 6768 743d 4e6f 6e65 2c0d 0a20 2020 2065  ght=None,..    e
-0000abb0: 6e63 6f64 6572 3d4e 6f6e 652c 200d 0a20  ncoder=None, .. 
-0000abc0: 2020 2066 6967 5f73 697a 6520 3d20 2832     fig_size = (2
-0000abd0: 322c 2036 292c 0d0a 2020 2020 7361 7665  2, 6),..    save
-0000abe0: 6669 6720 3d4e 6f6e 652c 200d 0a20 2020  fig =None, ..   
-0000abf0: 2073 7562 706c 6f74 5f6b 7773 3d4e 6f6e   subplot_kws=Non
-0000ac00: 652c 0d0a 2020 2020 2a2a 7363 6f72 6572  e,..    **scorer
-0000ac10: 5f6b 7773 0d0a 2020 2020 293a 0d0a 2020  _kws..    ):..  
-0000ac20: 2020 2222 2220 0d0a 2020 2020 506c 6f74    """ ..    Plot
-0000ac30: 2069 6e6c 696e 6520 6d75 6c74 6970 6c65   inline multiple
-0000ac40: 206d 6f64 656c 2063 6f6e 6675 7369 6f6e   model confusion
-0000ac50: 206d 6174 7269 6365 7320 7573 696e 6720   matrices using 
-0000ac60: 6569 7468 6572 2074 6865 2073 636b 6974  either the sckit
-0000ac70: 6c65 6172 6e20 0d0a 2020 2020 6f72 2027  learn ..    or '
-0000ac80: 7965 6c6c 6f77 6272 6963 6b27 0d0a 2020  yellowbrick'..  
-0000ac90: 2020 0d0a 2020 2020 5061 7261 6d65 7465    ..    Paramete
-0000aca0: 7273 200d 0a20 2020 202d 2d2d 2d2d 2d2d  rs ..    -------
-0000acb0: 2d2d 2d2d 0d0a 2020 2020 636c 6673 203a  ----..    clfs :
-0000acc0: 206c 6973 7420 6f66 2063 6c61 7373 6966   list of classif
-0000acd0: 6965 7220 6573 7469 6d61 746f 7273 0d0a  ier estimators..
-0000ace0: 2020 2020 2020 2020 4120 7363 696b 6974          A scikit
-0000acf0: 2d6c 6561 726e 2065 7374 696d 6174 6f72  -learn estimator
-0000ad00: 2074 6861 7420 7368 6f75 6c64 2062 6520   that should be 
-0000ad10: 6120 636c 6173 7369 6669 6572 2e20 4966  a classifier. If
-0000ad20: 2074 6865 206d 6f64 656c 2069 730d 0a20   the model is.. 
-0000ad30: 2020 2020 2020 206e 6f74 2061 2063 6c61         not a cla
-0000ad40: 7373 6966 6965 722c 2061 6e20 6578 6365  ssifier, an exce
-0000ad50: 7074 696f 6e20 6973 2072 6169 7365 642e  ption is raised.
-0000ad60: 204e 6f74 6520 7468 6174 2074 6865 2063   Note that the c
-0000ad70: 6c61 7373 6966 6965 7220 0d0a 2020 2020  lassifier ..    
-0000ad80: 2020 2020 6d75 7374 2062 6520 6669 7474      must be fitt
-0000ad90: 6564 2062 6566 6f72 6568 616e 642e 0d0a  ed beforehand...
-0000ada0: 2020 2020 2020 2020 0d0a 2020 2020 5874          ..    Xt
-0000adb0: 203a 206e 6461 7272 6179 206f 7220 4461   : ndarray or Da
-0000adc0: 7461 4672 616d 6520 6f66 2073 6861 7065  taFrame of shape
-0000add0: 2028 4d20 5820 4e29 0d0a 2020 2020 2020   (M X N)..      
-0000ade0: 2020 4120 6d61 7472 6978 206f 6620 6e20    A matrix of n 
-0000adf0: 696e 7374 616e 6365 7320 7769 7468 206d  instances with m
-0000ae00: 2066 6561 7475 7265 732e 2050 7265 6665   features. Prefe
-0000ae10: 7261 626c 792c 206d 6174 7269 7820 7265  rably, matrix re
-0000ae20: 7072 6573 656e 7473 200d 0a20 2020 2020  presents ..     
-0000ae30: 2020 2074 6865 2074 6573 7420 6461 7461     the test data
-0000ae40: 2066 6f72 2065 7272 6f72 2065 7661 6c75   for error evalu
-0000ae50: 6174 696f 6e2e 2020 0d0a 0d0a 2020 2020  ation.  ....    
-0000ae60: 7974 203a 206e 6461 7272 6179 206f 6620  yt : ndarray of 
-0000ae70: 7368 6170 6520 284d 2c20 2920 6f72 2053  shape (M, ) or S
-0000ae80: 6572 6965 7320 6f46 206c 656e 6774 6820  eries oF length 
-0000ae90: 284d 2c20 290d 0a20 2020 2020 2020 2041  (M, )..        A
-0000aea0: 6e20 6172 7261 7920 6f72 2073 6572 6965  n array or serie
-0000aeb0: 7320 6f66 2074 6172 6765 7420 6f72 2063  s of target or c
-0000aec0: 6c61 7373 2076 616c 7565 732e 2050 7265  lass values. Pre
-0000aed0: 6665 7261 626c 792c 2074 6865 2061 7272  ferably, the arr
-0000aee0: 6179 200d 0a20 2020 2020 2020 2072 6570  ay ..        rep
-0000aef0: 7265 7365 6e74 2074 6865 2074 6573 7420  resent the test 
-0000af00: 636c 6173 7320 6c61 6265 6c73 2064 6174  class labels dat
-0000af10: 6120 666f 7220 6572 726f 7220 6576 616c  a for error eval
-0000af20: 7561 7469 6f6e 2e20 200d 0a20 2020 200d  uation.  ..    .
-0000af30: 0a20 2020 2070 6b67 3a20 7374 722c 206f  .    pkg: str, o
-0000af40: 7074 696f 6e61 6c20 2c20 6465 6661 756c  ptional , defaul
-0000af50: 7420 3d27 736b 6c65 6172 6e27 0d0a 2020  t ='sklearn'..  
-0000af60: 2020 2020 2020 7468 6520 6c69 6272 6172        the librar
-0000af70: 7920 746f 2068 616e 646c 6520 7468 6520  y to handle the 
-0000af80: 706c 6f74 2e20 4974 2063 6f75 6c64 2062  plot. It could b
-0000af90: 6520 2779 656c 6c6f 7762 7269 636b 272e  e 'yellowbrick'.
-0000afa0: 2054 6865 2062 6173 6963 200d 0a20 2020   The basic ..   
-0000afb0: 2020 2020 2063 6f6e 6675 7369 6f6e 206d       confusion m
-0000afc0: 6174 7269 7820 6973 2068 616e 646c 6564  atrix is handled
-0000afd0: 2062 7920 7468 6520 7363 696b 6974 2d6c   by the scikit-l
-0000afe0: 6561 726e 2070 6163 6b61 6765 2e20 0d0a  earn package. ..
-0000aff0: 0d0a 2020 2020 6e6f 726d 616c 697a 6520  ..    normalize 
-0000b000: 3a20 7b27 7472 7565 272c 2027 7072 6564  : {'true', 'pred
-0000b010: 272c 2027 616c 6c27 7d2c 2064 6566 6175  ', 'all'}, defau
-0000b020: 6c74 3d4e 6f6e 650d 0a20 2020 2020 2020  lt=None..       
-0000b030: 204e 6f72 6d61 6c69 7a65 7320 636f 6e66   Normalizes conf
-0000b040: 7573 696f 6e20 6d61 7472 6978 206f 7665  usion matrix ove
-0000b050: 7220 7468 6520 7472 7565 2028 726f 7773  r the true (rows
-0000b060: 292c 2070 7265 6469 6374 6564 2028 636f  ), predicted (co
-0000b070: 6c75 6d6e 7329 0d0a 2020 2020 2020 2020  lumns)..        
-0000b080: 636f 6e64 6974 696f 6e73 206f 7220 616c  conditions or al
-0000b090: 6c20 7468 6520 706f 7075 6c61 7469 6f6e  l the population
-0000b0a0: 2e20 4966 204e 6f6e 652c 2063 6f6e 6675  . If None, confu
-0000b0b0: 7369 6f6e 206d 6174 7269 7820 7769 6c6c  sion matrix will
-0000b0c0: 206e 6f74 2062 650d 0a20 2020 2020 2020   not be..       
-0000b0d0: 206e 6f72 6d61 6c69 7a65 642e 0d0a 0d0a   normalized.....
-0000b0e0: 2020 2020 7361 6d70 6c65 5f77 6569 6768      sample_weigh
-0000b0f0: 7420 3a20 6172 7261 792d 6c69 6b65 206f  t : array-like o
-0000b100: 6620 7368 6170 6520 286e 5f73 616d 706c  f shape (n_sampl
-0000b110: 6573 2c29 2c20 6465 6661 756c 743d 4e6f  es,), default=No
-0000b120: 6e65 0d0a 2020 2020 2020 2020 5361 6d70  ne..        Samp
-0000b130: 6c65 2077 6569 6768 7473 2e0d 0a20 2020  le weights...   
-0000b140: 2020 2020 200d 0a20 2020 2065 6e63 6f64       ..    encod
-0000b150: 6572 203a 2064 6963 7420 6f72 204c 6162  er : dict or Lab
-0000b160: 656c 456e 636f 6465 722c 2064 6566 6175  elEncoder, defau
-0000b170: 6c74 3a20 4e6f 6e65 0d0a 2020 2020 2020  lt: None..      
-0000b180: 2020 4120 6d61 7070 696e 6720 6f66 2063    A mapping of c
-0000b190: 6c61 7373 6573 2074 6f20 6875 6d61 6e20  lasses to human 
-0000b1a0: 7265 6164 6162 6c65 206c 6162 656c 732e  readable labels.
-0000b1b0: 204f 6674 656e 2074 6865 7265 2069 7320   Often there is 
-0000b1c0: 6120 6d69 736d 6174 6368 0d0a 2020 2020  a mismatch..    
-0000b1d0: 2020 2020 6265 7477 6565 6e20 6465 7369      between desi
-0000b1e0: 7265 6420 636c 6173 7320 6c61 6265 6c73  red class labels
-0000b1f0: 2061 6e64 2074 686f 7365 2063 6f6e 7461   and those conta
-0000b200: 696e 6564 2069 6e20 7468 6520 7461 7267  ined in the targ
-0000b210: 6574 2076 6172 6961 626c 650d 0a20 2020  et variable..   
-0000b220: 2020 2020 2070 6173 7365 6420 746f 2060       passed to `
-0000b230: 6066 6974 2829 6060 206f 7220 6060 7363  `fit()`` or ``sc
-0000b240: 6f72 6528 2960 602e 2054 6865 2065 6e63  ore()``. The enc
-0000b250: 6f64 6572 2064 6973 616d 6269 6775 6174  oder disambiguat
-0000b260: 6573 2074 6869 7320 6d69 736d 6174 6368  es this mismatch
-0000b270: 0d0a 2020 2020 2020 2020 656e 7375 7269  ..        ensuri
-0000b280: 6e67 2074 6861 7420 636c 6173 7365 7320  ng that classes 
-0000b290: 6172 6520 6c61 6265 6c65 6420 636f 7272  are labeled corr
-0000b2a0: 6563 746c 7920 696e 2074 6865 2076 6973  ectly in the vis
-0000b2b0: 7561 6c69 7a61 7469 6f6e 2e0d 0a20 2020  ualization...   
-0000b2c0: 2020 2020 200d 0a20 2020 2020 2020 200d       ..        .
-0000b2d0: 0a20 2020 2061 6e6e 6f74 3a20 626f 6f6c  .    annot: bool
-0000b2e0: 2c20 6465 6661 756c 743d 5472 7565 200d  , default=True .
-0000b2f0: 0a20 2020 2020 2020 2041 6e6e 6f74 6174  .        Annotat
-0000b300: 6520 7468 6520 6e75 6d62 6572 206f 6620  e the number of 
-0000b310: 7361 6d70 6c65 7320 2872 6967 6874 206f  samples (right o
-0000b320: 7220 7772 6f6e 6720 7072 6564 6963 7469  r wrong predicti
-0000b330: 6f6e 2029 2069 6e20 7468 6520 706c 6f74  on ) in the plot
-0000b340: 2e20 0d0a 2020 2020 2020 2020 5365 7420  . ..        Set 
-0000b350: 6060 4661 6c73 6560 6020 746f 206d 7574  ``False`` to mut
-0000b360: 6520 7468 6520 6469 7370 6c61 792e 200d  e the display. .
-0000b370: 0a20 2020 200d 0a20 2020 2066 6967 5f73  .    ..    fig_s
-0000b380: 697a 6520 3a20 7475 706c 6520 2877 6964  ize : tuple (wid
-0000b390: 7468 2c20 6865 6967 6874 292c 2064 6566  th, height), def
-0000b3a0: 6175 6c74 203d 2838 2c20 3629 0d0a 2020  ault =(8, 6)..  
-0000b3b0: 2020 2020 2020 7468 6520 6d61 7470 6c6f        the matplo
-0000b3c0: 746c 6962 2066 6967 7572 6520 7369 7a65  tlib figure size
-0000b3d0: 2067 6976 656e 2061 7320 6120 7475 706c   given as a tupl
-0000b3e0: 6520 6f66 2077 6964 7468 2061 6e64 2068  e of width and h
-0000b3f0: 6569 6768 740d 0a20 2020 2020 2020 200d  eight..        .
-0000b400: 0a20 2020 2073 6176 6566 6967 3a20 7374  .    savefig: st
-0000b410: 722c 2064 6566 6175 6c74 203d 4e6f 6e65  r, default =None
-0000b420: 202c 200d 0a20 2020 2020 2020 2074 6865   , ..        the
-0000b430: 2070 6174 6820 746f 2073 6176 6520 7468   path to save th
-0000b440: 6520 6669 6775 7265 732e 2041 7267 756d  e figures. Argum
-0000b450: 656e 7420 6973 2070 6173 7365 6420 746f  ent is passed to
-0000b460: 206d 6174 706c 6f74 6c69 622e 4669 6775   matplotlib.Figu
-0000b470: 7265 200d 0a20 2020 2020 2020 2063 6c61  re ..        cla
-0000b480: 7373 2e20 0d0a 2020 2020 2020 2020 0d0a  ss. ..        ..
-0000b490: 2020 2020 4578 616d 706c 6573 0d0a 2020      Examples..  
-0000b4a0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-0000b4b0: 2020 3e3e 3e20 696d 706f 7274 206d 6174    >>> import mat
-0000b4c0: 706c 6f74 6c69 622e 7079 706c 6f74 2061  plotlib.pyplot a
-0000b4d0: 7320 706c 7420 0d0a 2020 2020 3e3e 3e20  s plt ..    >>> 
-0000b4e0: 706c 742e 7374 796c 652e 7573 6520 2827  plt.style.use ('
-0000b4f0: 636c 6173 7369 6327 290d 0a20 2020 203e  classic')..    >
-0000b500: 3e3e 2066 726f 6d20 7761 7465 782e 6461  >> from watex.da
-0000b510: 7461 7365 7473 2069 6d70 6f72 7420 6665  tasets import fe
-0000b520: 7463 685f 6461 7461 0d0a 2020 2020 3e3e  tch_data..    >>
-0000b530: 3e20 6672 6f6d 2077 6174 6578 2e65 786c  > from watex.exl
-0000b540: 6962 2e73 6b6c 6561 726e 2069 6d70 6f72  ib.sklearn impor
-0000b550: 7420 7472 6169 6e5f 7465 7374 5f73 706c  t train_test_spl
-0000b560: 6974 200d 0a20 2020 203e 3e3e 2066 726f  it ..    >>> fro
-0000b570: 6d20 7761 7465 782e 6d6f 6465 6c73 2e70  m watex.models.p
-0000b580: 7265 6d6f 6465 6c73 2069 6d70 6f72 7420  remodels import 
-0000b590: 700d 0a20 2020 203e 3e3e 2066 726f 6d20  p..    >>> from 
-0000b5a0: 7761 7465 782e 7574 696c 732e 706c 6f74  watex.utils.plot
-0000b5b0: 7574 696c 7320 696d 706f 7274 2070 6c6f  utils import plo
-0000b5c0: 745f 636f 6e66 7573 696f 6e5f 6d61 7472  t_confusion_matr
-0000b5d0: 6963 6573 200d 0a20 2020 203e 3e3e 2023  ices ..    >>> #
-0000b5e0: 2073 706c 6974 2074 6865 2020 6461 7461   split the  data
-0000b5f0: 202e 204e 6f74 6520 7468 6174 2066 6574   . Note that fet
-0000b600: 6368 5f64 6174 6120 6f75 7470 7574 2058  ch_data output X
-0000b610: 2061 6e64 2079 200d 0a20 2020 203e 3e3e   and y ..    >>>
-0000b620: 2058 2c20 5874 2c20 792c 2079 7420 203d   X, Xt, y, yt  =
-0000b630: 2074 7261 696e 5f74 6573 745f 7370 6c69   train_test_spli
-0000b640: 7420 282a 2066 6574 6368 5f64 6174 6120  t (* fetch_data 
-0000b650: 2827 6261 676f 7565 2061 6e61 6c79 7365  ('bagoue analyse
-0000b660: 6427 292c 2074 6573 745f 7369 7a65 203d  d'), test_size =
-0000b670: 2e32 3520 2029 2020 0d0a 2020 2020 3e3e  .25  )  ..    >>
-0000b680: 3e20 2320 636f 6d70 6f73 6520 7468 6520  > # compose the 
-0000b690: 6d6f 6465 6c73 200d 0a20 2020 203e 3e3e  models ..    >>>
-0000b6a0: 2023 2066 726f 6d20 5242 462c 2061 6e64   # from RBF, and
-0000b6b0: 2070 6f6c 7920 0d0a 2020 2020 3e3e 3e20   poly ..    >>> 
-0000b6c0: 6d6f 6465 6c73 203d 5b20 702e 5356 4d2e  models =[ p.SVM.
-0000b6d0: 7262 662e 6265 7374 5f65 7374 696d 6174  rbf.best_estimat
-0000b6e0: 6f72 5f2c 0d0a 2020 2020 2020 2020 2020  or_,..          
-0000b6f0: 2020 2070 2e4c 6f67 6973 7469 6352 6567     p.LogisticReg
-0000b700: 7265 7373 696f 6e2e 6265 7374 5f65 7374  ression.best_est
-0000b710: 696d 6174 6f72 5f2c 0d0a 2020 2020 2020  imator_,..      
-0000b720: 2020 2020 2020 2070 2e52 616e 646f 6d46         p.RandomF
-0000b730: 6f72 6573 742e 6265 7374 5f65 7374 696d  orest.best_estim
-0000b740: 6174 6f72 5f20 0d0a 2020 2020 2020 2020  ator_ ..        
-0000b750: 2020 2020 205d 0d0a 2020 2020 3e3e 3e20       ]..    >>> 
-0000b760: 6d6f 6465 6c73 200d 0a20 2020 205b 5356  models ..    [SV
-0000b770: 4328 433d 322e 302c 2063 6f65 6630 3d30  C(C=2.0, coef0=0
-0000b780: 2c20 6465 6772 6565 3d31 2c20 6761 6d6d  , degree=1, gamm
-0000b790: 613d 302e 3132 3529 2c20 4c6f 6769 7374  a=0.125), Logist
-0000b7a0: 6963 5265 6772 6573 7369 6f6e 2829 2c20  icRegression(), 
-0000b7b0: 0d0a 2020 2020 2052 616e 646f 6d46 6f72  ..     RandomFor
-0000b7c0: 6573 7443 6c61 7373 6966 6965 7228 6372  estClassifier(cr
-0000b7d0: 6974 6572 696f 6e3d 2765 6e74 726f 7079  iterion='entropy
-0000b7e0: 272c 206d 6178 5f64 6570 7468 3d31 362c  ', max_depth=16,
-0000b7f0: 206e 5f65 7374 696d 6174 6f72 733d 3335   n_estimators=35
-0000b800: 3029 5d0d 0a20 2020 203e 3e3e 2023 206e  0)]..    >>> # n
-0000b810: 6f77 2066 6974 2061 6c6c 2065 7374 696d  ow fit all estim
-0000b820: 6174 6f72 7320 0d0a 2020 2020 3e3e 3e20  ators ..    >>> 
-0000b830: 6669 7474 6564 5f6d 6f64 656c 7320 3d20  fitted_models = 
-0000b840: 5b6d 6f64 656c 2e66 6974 2858 2c20 7929  [model.fit(X, y)
-0000b850: 2066 6f72 206d 6f64 656c 2069 6e20 6d6f   for model in mo
-0000b860: 6465 6c73 205d 0d0a 2020 2020 3e3e 3e20  dels ]..    >>> 
-0000b870: 706c 6f74 5f63 6f6e 6675 7369 6f6e 5f6d  plot_confusion_m
-0000b880: 6174 7269 6365 7328 6669 7474 6564 5f6d  atrices(fitted_m
-0000b890: 6f64 656c 7320 2c20 5874 2c20 7974 290d  odels , Xt, yt).
-0000b8a0: 0a20 2020 2022 2222 0d0a 2020 2020 706b  .    """..    pk
-0000b8b0: 6720 3d20 706b 6720 6f72 2027 736b 6c65  g = pkg or 'skle
-0000b8c0: 6172 6e27 0d0a 2020 2020 706b 673d 2073  arn'..    pkg= s
-0000b8d0: 7472 2870 6b67 292e 6c6f 7765 7228 2920  tr(pkg).lower() 
-0000b8e0: 0d0a 2020 2020 6173 7365 7274 2070 6b67  ..    assert pkg
-0000b8f0: 2069 6e20 7b22 736b 6c65 6172 6e22 2c20   in {"sklearn", 
-0000b900: 2273 6369 6b69 742d 6c65 6172 6e22 2c20  "scikit-learn", 
-0000b910: 2779 656c 6c6f 7762 7269 636b 272c 2022  'yellowbrick', "
-0000b920: 7962 227d 2c20 280d 0a20 2020 2020 2020  yb"}, (..       
-0000b930: 2066 2220 4163 6365 7074 7320 6f6e 6c79   f" Accepts only
-0000b940: 2027 736b 6c65 6172 6e27 206f 7220 2779   'sklearn' or 'y
-0000b950: 656c 6c6f 7762 7269 636b 2720 7061 636b  ellowbrick' pack
-0000b960: 6167 6573 2c20 676f 7420 7b70 6b67 2172  ages, got {pkg!r
-0000b970: 7d22 2920 0d0a 2020 2020 0d0a 2020 2020  }") ..    ..    
-0000b980: 6966 206e 6f74 2069 735f 6974 6572 6162  if not is_iterab
-0000b990: 6c65 2820 636c 6673 293a 200d 0a20 2020  le( clfs): ..   
-0000b9a0: 2020 2020 2063 6c66 7320 3d5b 636c 6673       clfs =[clfs
-0000b9b0: 5d0d 0a0d 0a20 2020 206d 6f64 656c 5f6e  ]....    model_n
-0000b9c0: 616d 6573 203d 205b 6765 745f 6573 7469  ames = [get_esti
-0000b9d0: 6d61 746f 725f 6e61 6d65 286e 616d 6529  mator_name(name)
-0000b9e0: 2066 6f72 206e 616d 6520 696e 2063 6c66   for name in clf
-0000b9f0: 7320 5d0d 0a20 2020 2023 2063 7265 6174  s ]..    # creat
-0000ba00: 6520 6120 6669 6775 7265 200d 0a20 2020  e a figure ..   
-0000ba10: 2073 7562 706c 6f74 5f6b 7773 203d 2073   subplot_kws = s
-0000ba20: 7562 706c 6f74 5f6b 7773 206f 7220 6469  ubplot_kws or di
-0000ba30: 6374 2028 6c65 6674 3d30 2e30 3632 352c  ct (left=0.0625,
-0000ba40: 2072 6967 6874 203d 2030 2e39 352c 200d   right = 0.95, .
-0000ba50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ba60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ba70: 2020 2020 2020 2020 7773 7061 6365 203d          wspace =
-0000ba80: 2030 2e31 3229 0d0a 2020 2020 6669 672c   0.12)..    fig,
-0000ba90: 2061 7865 7320 3d20 706c 742e 7375 6270   axes = plt.subp
-0000baa0: 6c6f 7473 2831 2c20 6c65 6e28 636c 6673  lots(1, len(clfs
-0000bab0: 292c 2066 6967 7369 7a65 203d 2832 322c  ), figsize =(22,
-0000bac0: 2036 2929 0d0a 2020 2020 6669 672e 7375   6))..    fig.su
-0000bad0: 6270 6c6f 7473 5f61 646a 7573 7428 2a2a  bplots_adjust(**
-0000bae0: 7375 6270 6c6f 745f 6b77 7329 0d0a 2020  subplot_kws)..  
-0000baf0: 2020 6966 206e 6f74 2069 735f 6974 6572    if not is_iter
-0000bb00: 6162 6c65 2861 7865 7329 3a20 0d0a 2020  able(axes): ..  
-0000bb10: 2020 2020 2061 7865 7320 3d5b 6178 6573       axes =[axes
-0000bb20: 5d20 0d0a 2020 2020 666f 7220 6b6b 2c20  ] ..    for kk, 
-0000bb30: 286d 6f64 656c 202c 206d 6e61 6d65 2920  (model , mname) 
-0000bb40: 696e 2065 6e75 6d65 7261 7465 287a 6970  in enumerate(zip
-0000bb50: 2863 6c66 732c 206d 6f64 656c 5f6e 616d  (clfs, model_nam
-0000bb60: 6573 2029 293a 200d 0a20 2020 2020 2020  es )): ..       
-0000bb70: 2079 7072 6564 203d 206d 6f64 656c 2e70   ypred = model.p
-0000bb80: 7265 6469 6374 2858 7429 0d0a 2020 2020  redict(Xt)..    
-0000bb90: 2020 2020 6966 2070 6b67 2069 6e20 2827      if pkg in ('
-0000bba0: 736b 6c65 6172 6e27 2c20 2773 6369 6b69  sklearn', 'sciki
-0000bbb0: 742d 6c65 6172 6e27 293a 200d 0a20 2020  t-learn'): ..   
-0000bbc0: 2020 2020 2020 2020 2070 6c6f 745f 636f           plot_co
-0000bbd0: 6e66 7573 696f 6e5f 6d61 7472 6978 2879  nfusion_matrix(y
-0000bbe0: 742c 2079 7072 6564 2c20 616e 6e6f 7420  t, ypred, annot 
-0000bbf0: 3d61 6e6e 6f74 202c 2061 7820 3d20 6178  =annot , ax = ax
-0000bc00: 6573 5b6b 6b5d 2c20 0d0a 2020 2020 2020  es[kk], ..      
-0000bc10: 2020 2020 2020 2020 2020 6e6f 726d 616c            normal
-0000bc20: 697a 653d 206e 6f72 6d61 6c69 7a65 202c  ize= normalize ,
-0000bc30: 2073 616d 706c 655f 7765 6967 6874 3d20   sample_weight= 
-0000bc40: 7361 6d70 6c65 5f77 6569 6768 7420 2920  sample_weight ) 
-0000bc50: 0d0a 2020 2020 2020 2020 2020 2020 6178  ..            ax
-0000bc60: 6573 5b6b 6b5d 2e73 6574 5f74 6974 6c65  es[kk].set_title
-0000bc70: 2028 6d6e 616d 6529 0d0a 2020 2020 2020   (mname)..      
-0000bc80: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-0000bc90: 656c 6966 2070 6b67 2069 6e20 2827 7965  elif pkg in ('ye
-0000bca0: 6c6c 6f77 6272 6963 6b27 2c20 2779 6227  llowbrick', 'yb'
-0000bcb0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0000bcc0: 706c 6f74 5f79 625f 636f 6e66 7573 696f  plot_yb_confusio
-0000bcd0: 6e5f 6d61 7472 6978 280d 0a20 2020 2020  n_matrix(..     
-0000bce0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-0000bcf0: 2c20 5874 2c20 7974 2c20 6178 3d61 7865  , Xt, yt, ax=axe
-0000bd00: 735b 6b6b 5d2c 2065 6e63 6f64 6572 203d  s[kk], encoder =
-0000bd10: 656e 636f 6465 7220 290d 0a20 2020 2069  encoder )..    i
-0000bd20: 6620 7361 7665 6669 6720 6973 206e 6f74  f savefig is not
-0000bd30: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0000bd40: 706c 742e 7361 7665 6669 6728 7361 7665  plt.savefig(save
-0000bd50: 6669 672c 2064 7069 203d 2033 3030 2029  fig, dpi = 300 )
-0000bd60: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0000bd70: 706c 742e 636c 6f73 6520 2829 2069 6620  plt.close () if 
-0000bd80: 7361 7665 6669 6720 6973 206e 6f74 204e  savefig is not N
-0000bd90: 6f6e 6520 656c 7365 2070 6c74 2e73 686f  one else plt.sho
-0000bda0: 7728 2920 0d0a 2020 2020 0d0a 6465 6620  w() ..    ..def 
-0000bdb0: 706c 6f74 5f6c 6561 726e 696e 675f 6375  plot_learning_cu
-0000bdc0: 7276 6573 280d 0a20 2020 206d 6f64 656c  rves(..    model
-0000bdd0: 732c 200d 0a20 2020 2058 202c 0d0a 2020  s, ..    X ,..  
-0000bde0: 2020 792c 200d 0a20 2020 202a 2c20 0d0a    y, ..    *, ..
-0000bdf0: 2020 2020 6376 203d 4e6f 6e65 2c20 0d0a      cv =None, ..
-0000be00: 2020 2020 7472 6169 6e5f 7369 7a65 733d      train_sizes=
-0000be10: 204e 6f6e 652c 200d 0a20 2020 2062 6173   None, ..    bas
-0000be20: 656c 696e 655f 7363 6f72 6520 3d30 2e34  eline_score =0.4
-0000be30: 2c0d 0a20 2020 2063 6f6e 7665 7267 656e  ,..    convergen
-0000be40: 6365 5f6c 696e 6520 3d54 7275 652c 200d  ce_line =True, .
-0000be50: 0a20 2020 2066 6967 5f73 697a 653d 2832  .    fig_size=(2
-0000be60: 302c 2036 292c 0d0a 2020 2020 736e 735f  0, 6),..    sns_
-0000be70: 7374 796c 6520 3d4e 6f6e 652c 200d 0a20  style =None, .. 
-0000be80: 2020 2073 6176 6566 6967 3d4e 6f6e 652c     savefig=None,
-0000be90: 200d 0a20 2020 2073 6574 5f6c 6567 656e   ..    set_legen
-0000bea0: 643d 5472 7565 2c20 0d0a 2020 2020 7375  d=True, ..    su
-0000beb0: 6270 6c6f 745f 6b77 733d 4e6f 6e65 2c0d  bplot_kws=None,.
-0000bec0: 0a20 2020 202a 2a6b 7773 0d0a 2020 2020  .    **kws..    
-0000bed0: 293a 200d 0a20 2020 2022 2222 200d 0a20  ): ..    """ .. 
-0000bee0: 2020 2048 6f72 697a 6f6e 7461 6c6c 7920     Horizontally 
-0000bef0: 7669 7375 616c 697a 6174 696f 6e20 6f66  visualization of
-0000bf00: 206d 756c 7469 706c 6520 6d6f 6465 6c73   multiple models
-0000bf10: 206c 6561 726e 696e 6720 6375 7276 6573   learning curves
-0000bf20: 2e20 0d0a 2020 2020 0d0a 2020 2020 4465  . ..    ..    De
-0000bf30: 7465 726d 696e 6573 2063 726f 7373 2d76  termines cross-v
-0000bf40: 616c 6964 6174 6564 2074 7261 696e 696e  alidated trainin
-0000bf50: 6720 616e 6420 7465 7374 2073 636f 7265  g and test score
-0000bf60: 7320 666f 7220 6469 6666 6572 656e 7420  s for different 
-0000bf70: 7472 6169 6e69 6e67 0d0a 2020 2020 7365  training..    se
-0000bf80: 7420 7369 7a65 732e 0d0a 2020 2020 0d0a  t sizes...    ..
-0000bf90: 2020 2020 5061 7261 6d65 7465 7273 200d      Parameters .
-0000bfa0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d  .    ----------.
-0000bfb0: 0a20 2020 206d 6f64 656c 733a 206c 6973  .    models: lis
-0000bfc0: 7420 6f72 2065 7374 696d 6174 6f72 7320  t or estimators 
-0000bfd0: 200d 0a20 2020 2020 2020 2041 6e20 6573   ..        An es
-0000bfe0: 7469 6d61 746f 7220 696e 7374 616e 6365  timator instance
-0000bff0: 206f 7220 6e6f 7420 7468 6174 2069 6d70   or not that imp
-0000c000: 6c65 6d65 6e74 7320 6066 6974 6020 616e  lements `fit` an
-0000c010: 6420 6070 7265 6469 6374 6020 0d0a 2020  d `predict` ..  
-0000c020: 2020 2020 2020 6d65 7468 6f64 7320 7768        methods wh
-0000c030: 6963 6820 7769 6c6c 2062 6520 636c 6f6e  ich will be clon
-0000c040: 6564 2066 6f72 2065 6163 6820 7661 6c69  ed for each vali
-0000c050: 6461 7469 6f6e 2e20 0d0a 2020 2020 2020  dation. ..      
-0000c060: 2020 0d0a 2020 2020 5820 3a20 6172 7261    ..    X : arra
-0000c070: 792d 6c69 6b65 206f 6620 7368 6170 6520  y-like of shape 
-0000c080: 286e 5f73 616d 706c 6573 2c20 6e5f 6665  (n_samples, n_fe
-0000c090: 6174 7572 6573 290d 0a20 2020 2020 2020  atures)..       
-0000c0a0: 2054 7261 696e 696e 6720 7665 6374 6f72   Training vector
-0000c0b0: 2c20 7768 6572 6520 606e 5f73 616d 706c  , where `n_sampl
-0000c0c0: 6573 6020 6973 2074 6865 206e 756d 6265  es` is the numbe
-0000c0d0: 7220 6f66 2073 616d 706c 6573 2061 6e64  r of samples and
-0000c0e0: 0d0a 2020 2020 2020 2020 606e 5f66 6561  ..        `n_fea
-0000c0f0: 7475 7265 7360 2069 7320 7468 6520 6e75  tures` is the nu
-0000c100: 6d62 6572 206f 6620 6665 6174 7572 6573  mber of features
-0000c110: 2e0d 0a0d 0a20 2020 2079 203a 2061 7272  .....    y : arr
-0000c120: 6179 2d6c 696b 6520 6f66 2073 6861 7065  ay-like of shape
-0000c130: 2028 6e5f 7361 6d70 6c65 732c 2920 6f72   (n_samples,) or
-0000c140: 2028 6e5f 7361 6d70 6c65 732c 206e 5f6f   (n_samples, n_o
-0000c150: 7574 7075 7473 290d 0a20 2020 2020 2020  utputs)..       
-0000c160: 2054 6172 6765 7420 7265 6c61 7469 7665   Target relative
-0000c170: 2074 6f20 5820 666f 7220 636c 6173 7369   to X for classi
-0000c180: 6669 6361 7469 6f6e 206f 7220 7265 6772  fication or regr
-0000c190: 6573 7369 6f6e 3b0d 0a20 2020 2020 2020  ession;..       
-0000c1a0: 204e 6f6e 6520 666f 7220 756e 7375 7065   None for unsupe
-0000c1b0: 7276 6973 6564 206c 6561 726e 696e 672e  rvised learning.
-0000c1c0: 0d0a 2020 200d 0a20 2020 2063 7620 3a20  ..   ..    cv : 
-0000c1d0: 696e 742c 2063 726f 7373 2d76 616c 6964  int, cross-valid
-0000c1e0: 6174 696f 6e20 6765 6e65 7261 746f 7220  ation generator 
-0000c1f0: 6f72 2061 6e20 6974 6572 6162 6c65 2c20  or an iterable, 
-0000c200: 6465 6661 756c 743d 4e6f 6e65 0d0a 2020  default=None..  
-0000c210: 2020 2020 2020 4465 7465 726d 696e 6573        Determines
-0000c220: 2074 6865 2063 726f 7373 2d76 616c 6964   the cross-valid
-0000c230: 6174 696f 6e20 7370 6c69 7474 696e 6720  ation splitting 
-0000c240: 7374 7261 7465 6779 2e0d 0a20 2020 2020  strategy...     
-0000c250: 2020 2050 6f73 7369 626c 6520 696e 7075     Possible inpu
-0000c260: 7473 2066 6f72 2063 7620 6172 653a 0d0a  ts for cv are:..
-0000c270: 0d0a 2020 2020 2020 2020 2d20 4e6f 6e65  ..        - None
-0000c280: 2c20 746f 2075 7365 2074 6865 2064 6566  , to use the def
-0000c290: 6175 6c74 2035 2d66 6f6c 6420 6372 6f73  ault 5-fold cros
-0000c2a0: 7320 7661 6c69 6461 7469 6f6e 2c0d 0a20  s validation,.. 
-0000c2b0: 2020 2020 2020 202d 2069 6e74 2c20 746f         - int, to
-0000c2c0: 2073 7065 6369 6679 2074 6865 206e 756d   specify the num
-0000c2d0: 6265 7220 6f66 2066 6f6c 6473 2069 6e20  ber of folds in 
-0000c2e0: 6120 6028 5374 7261 7469 6669 6564 294b  a `(Stratified)K
-0000c2f0: 466f 6c64 602c 0d0a 2020 2020 2020 2020  Fold`,..        
-0000c300: 2d20 3a74 6572 6d3a 6043 5620 7370 6c69  - :term:`CV spli
-0000c310: 7474 6572 602c 0d0a 2020 2020 2020 2020  tter`,..        
-0000c320: 2d20 416e 2069 7465 7261 626c 6520 7969  - An iterable yi
-0000c330: 656c 6469 6e67 2028 7472 6169 6e2c 2074  elding (train, t
-0000c340: 6573 7429 2073 706c 6974 7320 6173 2061  est) splits as a
-0000c350: 7272 6179 7320 6f66 2069 6e64 6963 6573  rrays of indices
-0000c360: 2e0d 0a0d 0a20 2020 2020 2020 2046 6f72  .....        For
-0000c370: 2069 6e74 2f4e 6f6e 6520 696e 7075 7473   int/None inputs
-0000c380: 2c20 6966 2074 6865 2065 7374 696d 6174  , if the estimat
-0000c390: 6f72 2069 7320 6120 636c 6173 7369 6669  or is a classifi
-0000c3a0: 6572 2061 6e64 2060 6079 6060 2069 730d  er and ``y`` is.
-0000c3b0: 0a20 2020 2020 2020 2065 6974 6865 7220  .        either 
-0000c3c0: 6269 6e61 7279 206f 7220 6d75 6c74 6963  binary or multic
-0000c3d0: 6c61 7373 2c20 3a63 6c61 7373 3a60 5374  lass, :class:`St
-0000c3e0: 7261 7469 6669 6564 4b46 6f6c 6460 2069  ratifiedKFold` i
-0000c3f0: 7320 7573 6564 2e20 496e 2061 6c6c 0d0a  s used. In all..
-0000c400: 2020 2020 2020 2020 6f74 6865 7220 6361          other ca
-0000c410: 7365 732c 203a 636c 6173 733a 604b 466f  ses, :class:`KFo
-0000c420: 6c64 6020 6973 2075 7365 642e 2054 6865  ld` is used. The
-0000c430: 7365 2073 706c 6974 7465 7273 2061 7265  se splitters are
-0000c440: 2069 6e73 7461 6e74 6961 7465 640d 0a20   instantiated.. 
-0000c450: 2020 2020 2020 2077 6974 6820 6073 6875         with `shu
-0000c460: 6666 6c65 3d46 616c 7365 6020 736f 2074  ffle=False` so t
-0000c470: 6865 2073 706c 6974 7320 7769 6c6c 2062  he splits will b
-0000c480: 6520 7468 6520 7361 6d65 2061 6372 6f73  e the same acros
-0000c490: 7320 6361 6c6c 732e 0d0a 0d0a 2020 2020  s calls.....    
-0000c4a0: 2020 2020 5265 6665 7220 3a72 6566 3a60      Refer :ref:`
-0000c4b0: 5573 6572 2047 7569 6465 203c 6372 6f73  User Guide <cros
-0000c4c0: 735f 7661 6c69 6461 7469 6f6e 3e60 2066  s_validation>` f
-0000c4d0: 6f72 2074 6865 2076 6172 696f 7573 0d0a  or the various..
-0000c4e0: 2020 2020 2020 2020 6372 6f73 732d 7661          cross-va
-0000c4f0: 6c69 6461 7469 6f6e 2073 7472 6174 6567  lidation strateg
-0000c500: 6965 7320 7468 6174 2063 616e 2062 6520  ies that can be 
-0000c510: 7573 6564 2068 6572 652e 0d0a 0d0a 2020  used here.....  
-0000c520: 2020 2020 2020 6060 6376 6060 2064 6566        ``cv`` def
-0000c530: 6175 6c74 2076 616c 7565 2069 6620 4e6f  ault value if No
-0000c540: 6e65 2063 6861 6e67 6564 2066 726f 6d20  ne changed from 
-0000c550: 332d 666f 6c64 2074 6f20 342d 666f 6c64  3-fold to 4-fold
-0000c560: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-0000c570: 2020 7472 6169 6e5f 7369 7a65 7320 3a20    train_sizes : 
-0000c580: 6172 7261 792d 6c69 6b65 206f 6620 7368  array-like of sh
-0000c590: 6170 6520 286e 5f74 6963 6b73 2c29 2c20  ape (n_ticks,), 
-0000c5a0: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
-0000c5b0: 6465 6661 756c 743d 6e70 2e6c 696e 7370  default=np.linsp
-0000c5c0: 6163 6528 302e 312c 2031 2c20 3530 290d  ace(0.1, 1, 50).
-0000c5d0: 0a20 2020 2020 2020 2020 5265 6c61 7469  .         Relati
-0000c5e0: 7665 206f 7220 6162 736f 6c75 7465 206e  ve or absolute n
-0000c5f0: 756d 6265 7273 206f 6620 7472 6169 6e69  umbers of traini
-0000c600: 6e67 2065 7861 6d70 6c65 7320 7468 6174  ng examples that
-0000c610: 2077 696c 6c20 6265 2075 7365 6420 746f   will be used to
-0000c620: 0d0a 2020 2020 2020 2020 2067 656e 6572  ..         gener
-0000c630: 6174 6520 7468 6520 6c65 6172 6e69 6e67  ate the learning
-0000c640: 2063 7572 7665 2e20 4966 2074 6865 2064   curve. If the d
-0000c650: 7479 7065 2069 7320 666c 6f61 742c 2069  type is float, i
-0000c660: 7420 6973 2072 6567 6172 6465 6420 6173  t is regarded as
-0000c670: 2061 0d0a 2020 2020 2020 2020 2066 7261   a..         fra
-0000c680: 6374 696f 6e20 6f66 2074 6865 206d 6178  ction of the max
-0000c690: 696d 756d 2073 697a 6520 6f66 2074 6865  imum size of the
-0000c6a0: 2074 7261 696e 696e 6720 7365 7420 2874   training set (t
-0000c6b0: 6861 7420 6973 2064 6574 6572 6d69 6e65  hat is determine
-0000c6c0: 640d 0a20 2020 2020 2020 2020 6279 2074  d..         by t
-0000c6d0: 6865 2073 656c 6563 7465 6420 7661 6c69  he selected vali
-0000c6e0: 6461 7469 6f6e 206d 6574 686f 6429 2c20  dation method), 
-0000c6f0: 692e 652e 2069 7420 6861 7320 746f 2062  i.e. it has to b
-0000c700: 6520 7769 7468 696e 2028 302c 2031 5d2e  e within (0, 1].
-0000c710: 0d0a 2020 2020 2020 2020 204f 7468 6572  ..         Other
-0000c720: 7769 7365 2069 7420 6973 2069 6e74 6572  wise it is inter
-0000c730: 7072 6574 6564 2061 7320 6162 736f 6c75  preted as absolu
-0000c740: 7465 2073 697a 6573 206f 6620 7468 6520  te sizes of the 
-0000c750: 7472 6169 6e69 6e67 2073 6574 732e 0d0a  training sets...
-0000c760: 2020 2020 2020 2020 204e 6f74 6520 7468           Note th
-0000c770: 6174 2066 6f72 2063 6c61 7373 6966 6963  at for classific
-0000c780: 6174 696f 6e20 7468 6520 6e75 6d62 6572  ation the number
-0000c790: 206f 6620 7361 6d70 6c65 7320 7573 7561   of samples usua
-0000c7a0: 6c6c 7920 6861 7665 2074 6f0d 0a20 2020  lly have to..   
-0000c7b0: 2020 2020 2020 6265 2062 6967 2065 6e6f        be big eno
-0000c7c0: 7567 6820 746f 2063 6f6e 7461 696e 2061  ugh to contain a
-0000c7d0: 7420 6c65 6173 7420 6f6e 6520 7361 6d70  t least one samp
-0000c7e0: 6c65 2066 726f 6d20 6561 6368 2063 6c61  le from each cla
-0000c7f0: 7373 2e0d 0a20 2020 2020 2020 2020 0d0a  ss...         ..
-0000c800: 2020 2020 6261 7365 6c69 6e65 5f73 636f      baseline_sco
-0000c810: 7265 3a20 666c 6f61 746d 2064 6566 6175  re: floatm defau
-0000c820: 6c74 3d2e 3420 0d0a 2020 2020 2020 2020  lt=.4 ..        
-0000c830: 6261 7365 2073 636f 7265 2074 6f20 7374  base score to st
-0000c840: 6172 7420 636f 756e 7469 6e67 2069 6e20  art counting in 
-0000c850: 7363 6f72 6520 792d 6178 6973 2020 2873  score y-axis  (s
-0000c860: 636f 7265 290d 0a20 2020 2020 2020 200d  core)..        .
-0000c870: 0a20 2020 2063 6f6e 7665 7267 656e 6365  .    convergence
-0000c880: 5f6c 696e 653a 2062 6f6f 6c2c 2064 6566  _line: bool, def
-0000c890: 6175 6c74 3d54 7275 6520 0d0a 2020 2020  ault=True ..    
-0000c8a0: 2020 2020 6469 7370 6c61 7920 7468 6520      display the 
-0000c8b0: 636f 6e76 6572 6765 6e63 6520 6c69 6e65  convergence line
-0000c8c0: 206f 7220 6e6f 7420 7468 6174 2069 6e64   or not that ind
-0000c8d0: 6963 6174 6520 7468 6520 6c65 7665 6c20  icate the level 
-0000c8e0: 6f66 2062 6961 7320 0d0a 2020 2020 2020  of bias ..      
-0000c8f0: 2020 6265 7477 6565 6e20 7468 6520 7472    between the tr
-0000c900: 6169 6e69 6e67 2061 6e64 2076 616c 6964  aining and valid
-0000c910: 6174 696f 6e20 6375 7276 652e 200d 0a20  ation curve. .. 
-0000c920: 2020 2020 2020 200d 0a20 2020 2066 6967         ..    fig
-0000c930: 5f73 697a 6520 3a20 7475 706c 6520 2877  _size : tuple (w
-0000c940: 6964 7468 2c20 6865 6967 6874 292c 2064  idth, height), d
-0000c950: 6566 6175 6c74 203d 2831 342c 2036 290d  efault =(14, 6).
-0000c960: 0a20 2020 2020 2020 2074 6865 206d 6174  .        the mat
-0000c970: 706c 6f74 6c69 6220 6669 6775 7265 2073  plotlib figure s
-0000c980: 697a 6520 6769 7665 6e20 6173 2061 2074  ize given as a t
-0000c990: 7570 6c65 206f 6620 7769 6474 6820 616e  uple of width an
-0000c9a0: 6420 6865 6967 6874 0d0a 2020 2020 2020  d height..      
-0000c9b0: 2020 0d0a 2020 2020 736e 735f 7374 796c    ..    sns_styl
-0000c9c0: 653a 2073 7472 2c20 6f70 7469 6f6e 616c  e: str, optional
-0000c9d0: 2c20 0d0a 2020 2020 2020 2020 7468 6520  , ..        the 
-0000c9e0: 7365 6162 6f72 6e20 7374 796c 6520 2e20  seaborn style . 
-0000c9f0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0000ca00: 7365 745f 6c65 6765 6e64 3a20 626f 6f6c  set_legend: bool
-0000ca10: 2c20 6465 6661 756c 743d 5472 7565 200d  , default=True .
-0000ca20: 0a20 2020 2020 2020 2064 6973 706c 6179  .        display
-0000ca30: 206c 6567 656e 6420 696e 2065 6163 6820   legend in each 
-0000ca40: 6669 6775 7265 2e20 4e6f 7465 2074 6865  figure. Note the
-0000ca50: 2064 6566 6175 6c74 206c 6f63 6174 696f   default locatio
-0000ca60: 6e20 6f66 2074 6865 200d 0a20 2020 2020  n of the ..     
-0000ca70: 2020 206c 6567 656e 6420 6973 2027 6265     legend is 'be
-0000ca80: 7374 2720 6672 6f6d 203a 6675 6e63 3a60  st' from :func:`
-0000ca90: 7e6d 6174 706c 6f74 6c69 622e 4178 6573  ~matplotlib.Axes
-0000caa0: 2e6c 6567 656e 6460 0d0a 2020 2020 2020  .legend`..      
-0000cab0: 2020 0d0a 2020 2020 7375 6270 6c6f 745f    ..    subplot_
-0000cac0: 6b77 733a 2064 6963 742c 2064 6566 6175  kws: dict, defau
-0000cad0: 6c74 2069 7320 5c0d 0a20 2020 2020 2020  lt is \..       
-0000cae0: 2064 6963 7428 6c65 6674 3d30 2e30 3632   dict(left=0.062
-0000caf0: 352c 2072 6967 6874 203d 2030 2e39 352c  5, right = 0.95,
-0000cb00: 2077 7370 6163 6520 3d20 302e 3129 200d   wspace = 0.1) .
-0000cb10: 0a20 2020 2020 2020 2074 6865 2073 7562  .        the sub
-0000cb20: 706c 6f74 206b 6579 776f 7264 7320 6172  plot keywords ar
-0000cb30: 6775 6d65 6e74 7320 7061 7373 6564 2074  guments passed t
-0000cb40: 6f20 0d0a 2020 2020 2020 2020 3a66 756e  o ..        :fun
-0000cb50: 633a 606d 6174 706c 6f74 6c69 622e 7375  c:`matplotlib.su
-0000cb60: 6270 6c6f 7473 5f61 646a 7573 7460 200d  bplots_adjust` .
-0000cb70: 0a20 2020 206b 7773 3a20 6469 6374 2c20  .    kws: dict, 
-0000cb80: 0d0a 2020 2020 2020 2020 6b65 7977 6f72  ..        keywor
-0000cb90: 6420 6172 6775 6d65 6e74 7320 7061 7373  d arguments pass
-0000cba0: 6564 2074 6f20 3a66 756e 633a 6073 6b6c  ed to :func:`skl
-0000cbb0: 6561 726e 2e6d 6f64 656c 5f73 656c 6563  earn.model_selec
-0000cbc0: 7469 6f6e 2e6c 6561 726e 696e 675f 6375  tion.learning_cu
-0000cbd0: 7276 6560 0d0a 2020 2020 2020 2020 0d0a  rve`..        ..
-0000cbe0: 2020 2020 4578 616d 706c 6573 200d 0a20      Examples .. 
-0000cbf0: 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a 2020     ---------..  
-0000cc00: 2020 2831 2920 2d3e 2070 6c6f 7420 7669    (1) -> plot vi
-0000cc10: 6120 6120 6d65 7461 6573 7469 6d61 746f  a a metaestimato
-0000cc20: 7220 616c 7265 6164 7920 6372 6f73 732d  r already cross-
-0000cc30: 7661 6c69 6461 7465 642e 200d 0a20 2020  validated. ..   
-0000cc40: 200d 0a20 2020 203e 3e3e 2066 726f 6d20   ..    >>> from 
-0000cc50: 7761 7465 782e 6d6f 6465 6c73 2e70 7265  watex.models.pre
-0000cc60: 6d6f 6465 6c73 2069 6d70 6f72 7420 7020  models import p 
-0000cc70: 0d0a 2020 2020 3e3e 3e20 6672 6f6d 2077  ..    >>> from w
-0000cc80: 6174 6578 2e64 6174 6173 6574 7320 696d  atex.datasets im
-0000cc90: 706f 7274 2066 6574 6368 5f64 6174 6120  port fetch_data 
-0000cca0: 0d0a 2020 2020 3e3e 3e20 6672 6f6d 2077  ..    >>> from w
-0000ccb0: 6174 6578 2e75 7469 6c73 2e70 6c6f 7475  atex.utils.plotu
-0000ccc0: 7469 6c73 2069 6d70 6f72 7420 706c 6f74  tils import plot
-0000ccd0: 5f6c 6561 726e 696e 675f 6375 7276 6573  _learning_curves
-0000cce0: 0d0a 2020 2020 3e3e 3e20 582c 2079 203d  ..    >>> X, y =
-0000ccf0: 2066 6574 6368 5f64 6174 6120 2827 6261   fetch_data ('ba
-0000cd00: 676f 7565 2070 7265 7061 7265 6427 2920  goue prepared') 
-0000cd10: 2320 7969 656c 6473 2061 2073 7061 7273  # yields a spars
-0000cd20: 6520 6d61 7472 6978 200d 0a20 2020 203e  e matrix ..    >
-0000cd30: 3e3e 2023 206c 6574 2063 6f6c 6c65 6374  >> # let collect
-0000cd40: 2030 3420 6573 7469 6d61 746f 7273 2061   04 estimators a
-0000cd50: 6c72 6561 6479 2063 726f 7373 2d76 616c  lready cross-val
-0000cd60: 6964 6174 6564 2066 726f 6d20 5356 4d73  idated from SVMs
-0000cd70: 0d0a 2020 2020 3e3e 3e20 6d6f 6465 6c73  ..    >>> models
-0000cd80: 203d 205b 2070 2e53 564d 2e6c 696e 6561   = [ p.SVM.linea
-0000cd90: 7220 2c20 702e 5356 4d2e 7262 6620 2c20  r , p.SVM.rbf , 
-0000cda0: 702e 5356 4d2e 7369 676d 6f69 6420 2c20  p.SVM.sigmoid , 
-0000cdb0: 702e 5356 4d2e 706f 6c79 205d 0d0a 2020  p.SVM.poly ]..  
-0000cdc0: 2020 3e3e 3e20 706c 6f74 5f6c 6561 726e    >>> plot_learn
-0000cdd0: 696e 675f 6375 7276 6573 2028 6d6f 6465  ing_curves (mode
-0000cde0: 6c73 2c20 582c 2079 2c20 6376 3d34 2c20  ls, X, y, cv=4, 
-0000cdf0: 736e 735f 7374 796c 6520 3d20 2764 6172  sns_style = 'dar
-0000ce00: 6b67 7269 6427 290d 0a20 2020 200d 0a20  kgrid')..    .. 
-0000ce10: 2020 2028 3229 202d 3e20 706c 6f74 2077     (2) -> plot w
-0000ce20: 6974 6820 206d 756c 7469 706c 6573 206d  ith  multiples m
-0000ce30: 6f64 656c 7320 6e6f 7420 6372 6f73 7376  odels not crossv
-0000ce40: 616c 6964 6174 6564 2079 6574 2e0d 0a20  alidated yet... 
-0000ce50: 2020 200d 0a20 2020 203e 3e3e 2066 726f     ..    >>> fro
-0000ce60: 6d20 7761 7465 782e 6578 6c69 622e 736b  m watex.exlib.sk
-0000ce70: 6c65 6172 6e20 696d 706f 7274 2028 4c6f  learn import (Lo
-0000ce80: 6769 7374 6963 5265 6772 6573 7369 6f6e  gisticRegression
-0000ce90: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-0000cea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ceb0: 2020 2020 2020 2020 2020 2020 2052 616e               Ran
-0000cec0: 646f 6d46 6f72 6573 7443 6c61 7373 6966  domForestClassif
-0000ced0: 6965 722c 200d 0a20 2020 2020 2020 2020  ier, ..         
-0000cee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007af0: 2020 2020 2066 2220 6172 6520 7368 7275       f" are shru
+00007b00: 6e6b 2074 6f20 7468 6520 6669 7273 7420  nk to the first 
+00007b10: 7477 6f20 7661 6c75 6573 3a20 7b63 5f72  two values: {c_r
+00007b20: 616e 6765 5b3a 325d 7d20 220d 0a20 2020  ange[:2]} "..   
+00007b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007b40: 2020 2020 290d 0a20 2020 2077 6569 6768      )..    weigh
+00007b50: 7473 2c20 7061 7261 6d73 203d 205b 5d2c  ts, params = [],
+00007b60: 205b 5d20 2020 200d 0a20 2020 2066 6f72   []    ..    for
+00007b70: 2063 2069 6e20 6e70 2e61 7261 6e67 6520   c in np.arange 
+00007b80: 282a 635f 7261 6e67 6529 3a20 0d0a 2020  (*c_range): ..  
+00007b90: 2020 2020 2020 6c72 203d 204c 6f67 6973        lr = Logis
+00007ba0: 7469 6352 6567 7265 7373 696f 6e28 7065  ticRegression(pe
+00007bb0: 6e61 6c74 793d 276c 3127 2c20 433d 2031  nalty='l1', C= 1
+00007bc0: 302e 2a2a 632c 2073 6f6c 7665 7220 3d27  0.**c, solver ='
+00007bd0: 6c69 626c 696e 6561 7227 2c20 0d0a 2020  liblinear', ..  
+00007be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007bf0: 2020 2020 2020 2020 2020 2020 2020 6d75                mu
+00007c00: 6c74 695f 636c 6173 733d 276f 7672 272c  lti_class='ovr',
+00007c10: 202a 2a6b 7773 290d 0a20 2020 2020 2020   **kws)..       
+00007c20: 206c 722e 6669 7428 582c 7920 290d 0a20   lr.fit(X,y ).. 
+00007c30: 2020 2020 2020 2077 6569 6768 7473 2e61         weights.a
+00007c40: 7070 656e 6420 286c 722e 636f 6566 5f5b  ppend (lr.coef_[
+00007c50: 315d 290d 0a20 2020 2020 2020 2070 6172  1])..        par
+00007c60: 616d 732e 6170 7065 6e64 2831 302a 2a63  ams.append(10**c
+00007c70: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00007c80: 2077 6569 6768 7473 203d 206e 702e 6172   weights = np.ar
+00007c90: 7261 7928 7765 6967 6874 7320 2920 0d0a  ray(weights ) ..
+00007ca0: 2020 2020 636f 6c6f 7273 203d 206d 616b      colors = mak
+00007cb0: 655f 6d70 6c5f 7072 6f70 6572 7469 6573  e_mpl_properties
+00007cc0: 2877 6569 6768 7473 2e73 6861 7065 5b31  (weights.shape[1
+00007cd0: 5d29 0d0a 2020 2020 6966 206e 6f74 2068  ])..    if not h
+00007ce0: 6173 6174 7472 2028 582c 2027 636f 6c75  asattr (X, 'colu
+00007cf0: 6d6e 7327 293a 200d 0a20 2020 2020 2020  mns'): ..       
+00007d00: 2066 6c61 6265 6c73 203d 5b66 277b 693a   flabels =[f'{i:
+00007d10: 3e37 7d27 2066 6f72 2069 2069 6e20 7261  >7}' for i in ra
+00007d20: 6e67 6520 2858 2e73 6861 7065 5b31 5d29  nge (X.shape[1])
+00007d30: 5d20 0d0a 2020 2020 656c 7365 3a20 666c  ] ..    else: fl
+00007d40: 6162 656c 7320 3d20 582e 636f 6c75 6d6e  abels = X.column
+00007d50: 7320 2020 0d0a 2020 2020 0d0a 2020 2020  s   ..    ..    
+00007d60: 2320 706c 6f74 0d0a 2020 2020 6669 672c  # plot..    fig,
+00007d70: 2061 7820 3d20 706c 742e 7375 6270 6c6f   ax = plt.subplo
+00007d80: 7473 2866 6967 7369 7a65 203d 2066 6967  ts(figsize = fig
+00007d90: 5f73 697a 6520 290d 0a20 2020 2069 6620  _size )..    if 
+00007da0: 736e 735f 7374 796c 653a 200d 0a20 2020  sns_style: ..   
+00007db0: 2020 2020 205f 7365 745f 736e 735f 7374       _set_sns_st
+00007dc0: 796c 6520 2873 6e73 5f73 7479 6c65 290d  yle (sns_style).
+00007dd0: 0a0d 0a20 2020 2066 6f72 2063 6f6c 756d  ...    for colum
+00007de0: 6e20 2c20 636f 6c6f 7220 696e 207a 6970  n , color in zip
+00007df0: 2820 7261 6e67 6520 2877 6569 6768 7473  ( range (weights
+00007e00: 2e73 6861 7065 205b 315d 292c 2063 6f6c  .shape [1]), col
+00007e10: 6f72 7320 293a 200d 0a20 2020 2020 2020  ors ): ..       
+00007e20: 2070 6c74 2e70 6c6f 7420 2870 6172 616d   plt.plot (param
+00007e30: 7320 2c20 7765 6967 6874 735b 3a2c 2063  s , weights[:, c
+00007e40: 6f6c 756d 6e5d 2c20 0d0a 2020 2020 2020  olumn], ..      
+00007e50: 2020 2020 2020 2020 2020 2020 6c61 6265              labe
+00007e60: 6c20 3d66 6c61 6265 6c73 5b63 6f6c 756d  l =flabels[colum
+00007e70: 6e5d 2c20 0d0a 2020 2020 2020 2020 2020  n], ..          
+00007e80: 2020 2020 2020 2020 636f 6c6f 7220 3d20          color = 
+00007e90: 636f 6c6f 7220 0d0a 2020 2020 2020 2020  color ..        
+00007ea0: 2020 2020 2020 2020 2020 290d 0a0d 0a20            ).... 
+00007eb0: 2020 2070 6c74 2e61 7868 6c69 6e65 2028     plt.axhline (
+00007ec0: 2030 202c 2063 6f6c 6f72 203d 2762 6c61   0 , color ='bla
+00007ed0: 636b 272c 206c 733d 272d 2d27 2c20 6c77  ck', ls='--', lw
+00007ee0: 3d20 3320 290d 0a20 2020 2070 6c74 2e78  = 3 )..    plt.x
+00007ef0: 6c69 6d20 2820 5b20 3130 202a 2a20 696e  lim ( [ 10 ** in
+00007f00: 7428 635f 7261 6e67 655b 305d 202d 3129  t(c_range[0] -1)
+00007f10: 2c20 3130 202a 2a20 696e 7428 635f 7261  , 10 ** int(c_ra
+00007f20: 6e67 655b 315d 2d31 2920 5d29 0d0a 2020  nge[1]-1) ])..  
+00007f30: 2020 706c 742e 796c 6162 656c 2028 2257    plt.ylabel ("W
+00007f40: 6569 6768 7420 636f 6566 6669 6369 656e  eight coefficien
+00007f50: 7422 290d 0a20 2020 2070 6c74 2e78 6c61  t")..    plt.xla
+00007f60: 6265 6c20 2827 4327 290d 0a20 2020 2070  bel ('C')..    p
+00007f70: 6c74 2e78 7363 616c 6528 2027 6c6f 6727  lt.xscale( 'log'
+00007f80: 290d 0a20 2020 2070 6c74 2e6c 6567 656e  )..    plt.legen
+00007f90: 6420 286c 6f63 203d 2775 7070 6572 206c  d (loc ='upper l
+00007fa0: 6566 7427 2c29 0d0a 2020 2020 6178 2e6c  eft',)..    ax.l
+00007fb0: 6567 656e 6428 0d0a 2020 2020 2020 2020  egend(..        
+00007fc0: 2020 2020 6c6f 6320 3d27 7570 7065 7220      loc ='upper 
+00007fd0: 7269 6768 7427 2c20 0d0a 2020 2020 2020  right', ..      
+00007fe0: 2020 2020 2020 6262 6f78 5f74 6f5f 616e        bbox_to_an
+00007ff0: 6368 6f72 203d 2831 2e33 382c 2031 2e30  chor =(1.38, 1.0
+00008000: 3320 292c 200d 0a20 2020 2020 2020 2020  3 ), ..         
+00008010: 2020 206e 636f 6c20 3d20 3120 2c20 6661     ncol = 1 , fa
+00008020: 6e63 7962 6f78 203d 5472 7565 200d 0a20  ncybox =True .. 
+00008030: 2020 2029 0d0a 2020 2020 0d0a 2020 2020     )..    ..    
+00008040: 6966 2073 6176 6566 6967 2069 7320 6e6f  if savefig is no
+00008050: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
+00008060: 2070 6c74 2e73 6176 6566 6967 2873 6176   plt.savefig(sav
+00008070: 6566 6967 2c20 6470 6920 3d20 3330 3020  efig, dpi = 300 
+00008080: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00008090: 2070 6c74 2e63 6c6f 7365 2028 2920 6966   plt.close () if
+000080a0: 2073 6176 6566 6967 2069 7320 6e6f 7420   savefig is not 
+000080b0: 4e6f 6e65 2065 6c73 6520 706c 742e 7368  None else plt.sh
+000080c0: 6f77 2829 200d 0a20 2020 200d 0a64 6566  ow() ..    ..def
+000080d0: 2070 6c6f 745f 7266 5f66 6561 7475 7265   plot_rf_feature
+000080e0: 5f69 6d70 6f72 7461 6e63 6573 2028 0d0a  _importances (..
+000080f0: 2020 2020 2020 2020 636c 662c 2058 3d4e          clf, X=N
+00008100: 6f6e 652c 2079 3d4e 6f6e 652c 2066 6967  one, y=None, fig
+00008110: 5f73 697a 6520 3d20 2838 2c20 3429 2c73  _size = (8, 4),s
+00008120: 6176 6566 6967 203d 4e6f 6e65 2c20 2020  avefig =None,   
+00008130: 0d0a 2020 2020 2020 2020 6e5f 6573 7469  ..        n_esti
+00008140: 6d61 746f 7273 3d20 3530 302c 2076 6572  mators= 500, ver
+00008150: 626f 7365 203d 3020 2c20 736e 735f 7374  bose =0 , sns_st
+00008160: 796c 6520 3d4e 6f6e 652c 2020 2a2a 6b77  yle =None,  **kw
+00008170: 7320 0d0a 2020 2020 2020 2020 293a 200d  s ..        ): .
+00008180: 0a20 2020 2022 2222 0d0a 2020 2020 506c  .    """..    Pl
+00008190: 6f74 2066 6561 7475 7265 7320 696d 706f  ot features impo
+000081a0: 7274 616e 6365 2077 6974 6820 5261 6e64  rtance with Rand
+000081b0: 6f6d 466f 7265 7374 2e20 200d 0a20 2020  omForest.  ..   
+000081c0: 200d 0a20 2020 2050 6172 616d 6574 6572   ..    Parameter
+000081d0: 7320 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  s ..    --------
+000081e0: 2d2d 0d0a 2020 2020 636c 6620 3a20 6573  --..    clf : es
+000081f0: 7469 6d61 746f 7220 6f62 6a65 6374 0d0a  timator object..
+00008200: 2020 2020 2020 2020 5468 6520 6261 7365          The base
+00008210: 2065 7374 696d 6174 6f72 2066 726f 6d20   estimator from 
+00008220: 7768 6963 6820 7468 6520 7472 616e 7366  which the transf
+00008230: 6f72 6d65 7220 6973 2062 7569 6c74 2e0d  ormer is built..
+00008240: 0a20 2020 2020 2020 2054 6869 7320 6361  .        This ca
+00008250: 6e20 6265 2062 6f74 6820 6120 6669 7474  n be both a fitt
+00008260: 6564 2028 6966 2060 6070 7265 6669 7460  ed (if ``prefit`
+00008270: 6020 6973 2073 6574 2074 6f20 5472 7565  ` is set to True
+00008280: 290d 0a20 2020 2020 2020 206f 7220 6120  )..        or a 
+00008290: 6e6f 6e2d 6669 7474 6564 2065 7374 696d  non-fitted estim
+000082a0: 6174 6f72 2e20 5468 6520 6573 7469 6d61  ator. The estima
+000082b0: 746f 7220 7368 6f75 6c64 2068 6176 6520  tor should have 
+000082c0: 610d 0a20 2020 2020 2020 2060 6066 6561  a..        ``fea
+000082d0: 7475 7265 5f69 6d70 6f72 7461 6e63 6573  ture_importances
+000082e0: 5f60 6020 6f72 2060 6063 6f65 665f 6060  _`` or ``coef_``
+000082f0: 2061 7474 7269 6275 7465 2061 6674 6572   attribute after
+00008300: 2066 6974 7469 6e67 2e0d 0a20 2020 2020   fitting...     
+00008310: 2020 204f 7468 6572 7769 7365 2c20 7468     Otherwise, th
+00008320: 6520 6060 696d 706f 7274 616e 6365 5f67  e ``importance_g
+00008330: 6574 7465 7260 6020 7061 7261 6d65 7465  etter`` paramete
+00008340: 7220 7368 6f75 6c64 2062 6520 7573 6564  r should be used
+00008350: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
+00008360: 2058 203a 2061 7272 6179 2d6c 696b 6520   X : array-like 
+00008370: 6f66 2073 6861 7065 2028 6e5f 7361 6d70  of shape (n_samp
+00008380: 6c65 732c 206e 5f66 6561 7475 7265 7329  les, n_features)
+00008390: 0d0a 2020 2020 2020 2020 5472 6169 6e69  ..        Traini
+000083a0: 6e67 2076 6563 746f 722c 2077 6865 7265  ng vector, where
+000083b0: 2060 6e5f 7361 6d70 6c65 7360 2069 7320   `n_samples` is 
+000083c0: 7468 6520 6e75 6d62 6572 206f 6620 7361  the number of sa
+000083d0: 6d70 6c65 7320 616e 640d 0a20 2020 2020  mples and..     
+000083e0: 2020 2060 6e5f 6665 6174 7572 6573 6020     `n_features` 
+000083f0: 6973 2074 6865 206e 756d 6265 7220 6f66  is the number of
+00008400: 2066 6561 7475 7265 732e 0d0a 0d0a 2020   features.....  
+00008410: 2020 7920 3a20 6172 7261 792d 6c69 6b65    y : array-like
+00008420: 206f 6620 7368 6170 6520 286e 5f73 616d   of shape (n_sam
+00008430: 706c 6573 2c29 206f 7220 286e 5f73 616d  ples,) or (n_sam
+00008440: 706c 6573 2c20 6e5f 6f75 7470 7574 7329  ples, n_outputs)
+00008450: 0d0a 2020 2020 2020 2020 5461 7267 6574  ..        Target
+00008460: 2072 656c 6174 6976 6520 746f 2058 2066   relative to X f
+00008470: 6f72 2063 6c61 7373 6966 6963 6174 696f  or classificatio
+00008480: 6e20 6f72 2072 6567 7265 7373 696f 6e3b  n or regression;
+00008490: 0d0a 2020 2020 2020 2020 4e6f 6e65 2066  ..        None f
+000084a0: 6f72 2075 6e73 7570 6572 7669 7365 6420  or unsupervised 
+000084b0: 6c65 6172 6e69 6e67 2e0d 0a20 2020 2020  learning...     
+000084c0: 2020 0d0a 2020 2020 6e5f 6573 7469 6d61    ..    n_estima
+000084d0: 746f 7273 203a 2069 6e74 2c20 6465 6661  tors : int, defa
+000084e0: 756c 743d 3530 300d 0a20 2020 2020 2020  ult=500..       
+000084f0: 2054 6865 206e 756d 6265 7220 6f66 2074   The number of t
+00008500: 7265 6573 2069 6e20 7468 6520 666f 7265  rees in the fore
+00008510: 7374 2e0d 0a20 2020 2020 2020 200d 0a20  st...        .. 
+00008520: 2020 2066 6967 5f73 697a 6520 3a20 7475     fig_size : tu
+00008530: 706c 6520 2877 6964 7468 2c20 6865 6967  ple (width, heig
+00008540: 6874 292c 2064 6566 6175 6c74 203d 2838  ht), default =(8
+00008550: 2c20 3629 0d0a 2020 2020 2020 2020 7468  , 6)..        th
+00008560: 6520 6d61 7470 6c6f 746c 6962 2066 6967  e matplotlib fig
+00008570: 7572 6520 7369 7a65 2067 6976 656e 2061  ure size given a
+00008580: 7320 6120 7475 706c 6520 6f66 2077 6964  s a tuple of wid
+00008590: 7468 2061 6e64 2068 6569 6768 740d 0a20  th and height.. 
+000085a0: 2020 2020 2020 200d 0a20 2020 2073 6176         ..    sav
+000085b0: 6566 6967 3a20 7374 722c 2064 6566 6175  efig: str, defau
+000085c0: 6c74 203d 4e6f 6e65 202c 200d 0a20 2020  lt =None , ..   
+000085d0: 2020 2020 2074 6865 2070 6174 6820 746f       the path to
+000085e0: 2073 6176 6520 7468 6520 6669 6775 7265   save the figure
+000085f0: 732e 2041 7267 756d 656e 7420 6973 2070  s. Argument is p
+00008600: 6173 7365 6420 746f 206d 6174 706c 6f74  assed to matplot
+00008610: 6c69 622e 4669 6775 7265 200d 0a20 2020  lib.Figure ..   
+00008620: 2020 2020 2063 6c61 7373 2e20 0d0a 2020       class. ..  
+00008630: 2020 736e 735f 7374 796c 653a 2073 7472    sns_style: str
+00008640: 2c20 6f70 7469 6f6e 616c 2c20 0d0a 2020  , optional, ..  
+00008650: 2020 2020 2020 7468 6520 7365 6162 6f72        the seabor
+00008660: 6e20 7374 796c 652e 0d0a 2020 2020 7665  n style...    ve
+00008670: 7262 6f73 653a 2069 6e74 2c20 6465 6661  rbose: int, defa
+00008680: 756c 743d 3020 0d0a 2020 2020 2020 2020  ult=0 ..        
+00008690: 7072 696e 7420 7468 6520 6665 6174 7572  print the featur
+000086a0: 6520 6c61 6265 6c73 2077 6974 6820 7468  e labels with th
+000086b0: 6520 7261 7465 206f 6620 7468 6569 7220  e rate of their 
+000086c0: 696d 706f 7274 616e 6365 732e 200d 0a20  importances. .. 
+000086d0: 2020 206b 7773 3a20 6469 6374 2c20 0d0a     kws: dict, ..
+000086e0: 2020 2020 2020 2020 4164 6469 7469 6f6e          Addition
+000086f0: 616c 206b 6579 7977 6f72 6420 6172 6775  al keyyword argu
+00008700: 6d65 6e74 7320 7061 7373 6564 2074 6f20  ments passed to 
+00008710: 0d0a 2020 2020 2020 2020 3a63 6c61 7373  ..        :class
+00008720: 3a60 736b 6c65 6172 6e2e 656e 7365 6d62  :`sklearn.ensemb
+00008730: 6c65 2e52 616e 646f 6d46 6f72 6573 7443  le.RandomForestC
+00008740: 6c61 7373 6966 6965 7260 0d0a 2020 2020  lassifier`..    
+00008750: 2020 2020 0d0a 2020 2020 4578 616d 706c      ..    Exampl
+00008760: 6573 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  es..    --------
+00008770: 2d0d 0a20 2020 203e 3e3e 2066 726f 6d20  -..    >>> from 
+00008780: 7761 7465 782e 6461 7461 7365 7473 2069  watex.datasets i
+00008790: 6d70 6f72 7420 6665 7463 685f 6461 7461  mport fetch_data
+000087a0: 0d0a 2020 2020 3e3e 3e20 6672 6f6d 2077  ..    >>> from w
+000087b0: 6174 6578 2e65 786c 6962 2e73 6b6c 6561  atex.exlib.sklea
+000087c0: 726e 2069 6d70 6f72 7420 5261 6e64 6f6d  rn import Random
+000087d0: 466f 7265 7374 436c 6173 7369 6669 6572  ForestClassifier
+000087e0: 200d 0a20 2020 203e 3e3e 2066 726f 6d20   ..    >>> from 
+000087f0: 7761 7465 782e 7574 696c 732e 706c 6f74  watex.utils.plot
+00008800: 7574 696c 7320 696d 706f 7274 2070 6c6f  utils import plo
+00008810: 745f 7266 5f66 6561 7475 7265 5f69 6d70  t_rf_feature_imp
+00008820: 6f72 7461 6e63 6573 200d 0a20 2020 203e  ortances ..    >
+00008830: 3e3e 2058 2c20 7920 3d20 6665 7463 685f  >> X, y = fetch_
+00008840: 6461 7461 2028 2762 6167 6f75 6520 616e  data ('bagoue an
+00008850: 616c 7973 6564 2720 2920 0d0a 2020 2020  alysed' ) ..    
+00008860: 3e3e 3e20 706c 6f74 5f72 665f 6665 6174  >>> plot_rf_feat
+00008870: 7572 655f 696d 706f 7274 616e 6365 7320  ure_importances 
+00008880: 280d 0a20 2020 2020 2020 2052 616e 646f  (..        Rando
+00008890: 6d46 6f72 6573 7443 6c61 7373 6966 6965  mForestClassifie
+000088a0: 7228 292c 2058 3d58 2c20 793d 7920 2c20  r(), X=X, y=y , 
+000088b0: 736e 735f 7374 796c 653d 5472 7565 290d  sns_style=True).
+000088c0: 0a0d 0a20 2020 2022 2222 0d0a 2020 2020  ...    """..    
+000088d0: 6966 206e 6f74 2068 6173 6174 7472 2028  if not hasattr (
+000088e0: 636c 662c 2027 6665 6174 7572 655f 696d  clf, 'feature_im
+000088f0: 706f 7274 616e 6365 735f 2729 3a20 0d0a  portances_'): ..
+00008900: 2020 2020 2020 2020 6966 2028 2058 2069          if ( X i
+00008910: 7320 4e6f 6e65 206f 7220 7920 6973 204e  s None or y is N
+00008920: 6f6e 6520 2920 3a20 0d0a 2020 2020 2020  one ) : ..      
+00008930: 2020 2020 2020 636c 666e 203d 2067 6574        clfn = get
+00008940: 5f65 7374 696d 6174 6f72 5f6e 616d 6528  _estimator_name(
+00008950: 2063 6c66 290d 0a20 2020 2020 2020 2020   clf)..         
+00008960: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00008970: 6f72 2028 6622 5768 656e 207b 636c 666e  or (f"When {clfn
+00008980: 7d20 6973 206e 6f74 2061 2066 6974 7465  } is not a fitte
+00008990: 6420 220d 0a20 2020 2020 2020 2020 2020  d "..           
+000089a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000089b0: 2020 2265 7374 696d 6174 6f72 2c20 5820    "estimator, X 
+000089c0: 616e 6420 7920 6172 6520 6e65 6564 6564  and y are needed
+000089d0: 2e22 0d0a 2020 2020 2020 2020 2020 2020  ."..            
+000089e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000089f0: 2029 0d0a 2020 2020 2020 2020 636c 6620   )..        clf 
+00008a00: 3d20 5261 6e64 6f6d 466f 7265 7374 436c  = RandomForestCl
+00008a10: 6173 7369 6669 6572 286e 5f65 7374 696d  assifier(n_estim
+00008a20: 6174 6f72 733d 206e 5f65 7374 696d 6174  ators= n_estimat
+00008a30: 6f72 7320 2c20 2a2a 6b77 7329 0d0a 2020  ors , **kws)..  
+00008a40: 2020 2020 2020 636c 662e 6669 7428 582c        clf.fit(X,
+00008a50: 2079 2029 200d 0a20 2020 2020 2020 200d   y ) ..        .
+00008a60: 0a20 2020 2069 6d70 6f72 7461 6e63 6573  .    importances
+00008a70: 203d 2063 6c66 2e66 6561 7475 7265 5f69   = clf.feature_i
+00008a80: 6d70 6f72 7461 6e63 6573 5f20 0d0a 2020  mportances_ ..  
+00008a90: 2020 696e 6469 6365 7320 3d20 6e70 2e61    indices = np.a
+00008aa0: 7267 736f 7274 2869 6d70 6f72 7461 6e63  rgsort(importanc
+00008ab0: 6573 295b 3a3a 2d31 5d0d 0a20 2020 2069  es)[::-1]..    i
+00008ac0: 6620 6861 7361 7474 7228 2058 2c20 2763  f hasattr( X, 'c
+00008ad0: 6f6c 756d 6e73 2729 3a20 0d0a 2020 2020  olumns'): ..    
+00008ae0: 2020 2020 666c 6162 656c 7320 3d20 582e      flabels = X.
+00008af0: 636f 6c75 6d6e 7320 0d0a 2020 2020 656c  columns ..    el
+00008b00: 7365 203a 2066 6c61 6265 6c73 203d 5b66  se : flabels =[f
+00008b10: 277b 693a 3e37 7d27 2066 6f72 2069 2069  '{i:>7}' for i i
+00008b20: 6e20 7261 6e67 6520 2858 2e73 6861 7065  n range (X.shape
+00008b30: 5b31 5d29 5d0d 0a20 2020 200d 0a20 2020  [1])]..    ..   
+00008b40: 2069 6620 7665 7262 6f73 6520 3a20 0d0a   if verbose : ..
+00008b50: 2020 2020 2020 2020 666f 7220 6620 696e          for f in
+00008b60: 2072 616e 6765 2858 2e73 6861 7065 205b   range(X.shape [
+00008b70: 315d 293a 200d 0a20 2020 2020 2020 2020  1]): ..         
+00008b80: 2020 2070 7269 6e74 2822 2532 6429 2025     print("%2d) %
+00008b90: 2d2a 7320 2566 2220 2528 6620 2b31 202c  -*s %f" %(f +1 ,
+00008ba0: 2033 3020 2c20 666c 6162 656c 735b 696e   30 , flabels[in
+00008bb0: 6469 6365 735b 665d 5d2c 200d 0a20 2020  dices[f]], ..   
+00008bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008be0: 696d 706f 7274 616e 6365 735b 696e 6469  importances[indi
+00008bf0: 6365 735b 665d 5d29 0d0a 2020 2020 2020  ces[f]])..      
+00008c00: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00008c10: 2020 2069 6620 736e 735f 7374 796c 653a     if sns_style:
+00008c20: 200d 0a20 2020 2020 2020 205f 7365 745f   ..        _set_
+00008c30: 736e 735f 7374 796c 6520 2873 6e73 5f73  sns_style (sns_s
+00008c40: 7479 6c65 290d 0a0d 0a20 2020 2070 6c74  tyle)....    plt
+00008c50: 2e66 6967 7572 6528 6669 6773 697a 6520  .figure(figsize 
+00008c60: 3d20 6669 675f 7369 7a65 290d 0a20 2020  = fig_size)..   
+00008c70: 2070 6c74 2e74 6974 6c65 2028 2246 6561   plt.title ("Fea
+00008c80: 7475 7265 2069 6d70 6f72 7461 6e63 6522  ture importance"
+00008c90: 290d 0a20 2020 2070 6c74 2e62 6172 2028  )..    plt.bar (
+00008ca0: 7261 6e67 6528 582e 7368 6170 655b 315d  range(X.shape[1]
+00008cb0: 2920 2c20 0d0a 2020 2020 2020 2020 2020  ) , ..          
+00008cc0: 2020 2069 6d70 6f72 7461 6e63 6573 205b     importances [
+00008cd0: 696e 6469 6365 735d 2c20 0d0a 2020 2020  indices], ..    
+00008ce0: 2020 2020 2020 2020 2061 6c69 676e 3d27           align='
+00008cf0: 6365 6e74 6572 270d 0a20 2020 2020 2020  center'..       
+00008d00: 2020 2020 2020 290d 0a20 2020 2070 6c74        )..    plt
+00008d10: 2e78 7469 636b 7320 2872 616e 6765 2028  .xticks (range (
+00008d20: 582e 7368 6170 655b 315d 292c 2066 6c61  X.shape[1]), fla
+00008d30: 6265 6c73 205b 696e 6469 6365 735d 2c20  bels [indices], 
+00008d40: 726f 7461 7469 6f6e 203d 3930 202c 200d  rotation =90 , .
+00008d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008d60: 2029 200d 0a20 2020 2070 6c74 2e78 6c69   ) ..    plt.xli
+00008d70: 6d20 285b 2d31 202c 2058 2e73 6861 7065  m ([-1 , X.shape
+00008d80: 5b31 5d5d 290d 0a20 2020 2070 6c74 2e79  [1]])..    plt.y
+00008d90: 6c61 6265 6c20 2827 496d 706f 7274 616e  label ('Importan
+00008da0: 6365 2072 6174 6527 290d 0a20 2020 2070  ce rate')..    p
+00008db0: 6c74 2e78 6c61 6265 6c20 2827 4665 6174  lt.xlabel ('Feat
+00008dc0: 7572 6520 6c61 6265 6c73 2729 0d0a 2020  ure labels')..  
+00008dd0: 2020 706c 742e 7469 6768 745f 6c61 796f    plt.tight_layo
+00008de0: 7574 2829 0d0a 2020 2020 0d0a 2020 2020  ut()..    ..    
+00008df0: 6966 2073 6176 6566 6967 2069 7320 6e6f  if savefig is no
+00008e00: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
+00008e10: 2070 6c74 2e73 6176 6566 6967 2873 6176   plt.savefig(sav
+00008e20: 6566 6967 2029 0d0a 0d0a 2020 2020 706c  efig )....    pl
+00008e30: 742e 636c 6f73 6520 2829 2069 6620 7361  t.close () if sa
+00008e40: 7665 6669 6720 6973 206e 6f74 204e 6f6e  vefig is not Non
+00008e50: 6520 656c 7365 2070 6c74 2e73 686f 7728  e else plt.show(
+00008e60: 2920 0d0a 2020 2020 0d0a 2020 2020 2020  ) ..    ..      
+00008e70: 2020 0d0a 6465 6620 706c 6f74 5f63 6f6e    ..def plot_con
+00008e80: 6675 7369 6f6e 5f6d 6174 7269 7820 2879  fusion_matrix (y
+00008e90: 742c 2079 5f70 7265 642c 2076 6965 7720  t, y_pred, view 
+00008ea0: 3d54 7275 652c 2061 783d 4e6f 6e65 2c20  =True, ax=None, 
+00008eb0: 616e 6e6f 743d 5472 7565 2c20 202a 2a6b  annot=True,  **k
+00008ec0: 7773 2029 3a0d 0a20 2020 2022 2222 2070  ws ):..    """ p
+00008ed0: 6c6f 7420 6120 636f 6e66 7573 696f 6e20  lot a confusion 
+00008ee0: 6d61 7472 6978 2066 6f72 2061 2073 696e  matrix for a sin
+00008ef0: 676c 6520 636c 6173 7369 6669 6572 206d  gle classifier m
+00008f00: 6f64 656c 2e0d 0a20 2020 200d 0a20 2020  odel...    ..   
+00008f10: 203a 7061 7261 6d20 7974 203a 206e 6461   :param yt : nda
+00008f20: 7272 6179 206f 7220 5365 7269 6573 206f  rray or Series o
+00008f30: 6620 6c65 6e67 7468 206e 0d0a 2020 2020  f length n..    
+00008f40: 2020 2020 416e 2061 7272 6179 206f 7220      An array or 
+00008f50: 7365 7269 6573 206f 6620 7472 7565 2074  series of true t
+00008f60: 6172 6765 7420 6f72 2063 6c61 7373 2076  arget or class v
+00008f70: 616c 7565 732e 2050 7265 6665 7261 626c  alues. Preferabl
+00008f80: 792c 200d 0a20 2020 2020 2020 2074 6865  y, ..        the
+00008f90: 2061 7272 6179 2072 6570 7265 7365 6e74   array represent
+00008fa0: 7320 7468 6520 7465 7374 2063 6c61 7373  s the test class
+00008fb0: 206c 6162 656c 7320 6461 7461 2066 6f72   labels data for
+00008fc0: 2065 7272 6f72 2065 7661 6c75 6174 696f   error evaluatio
+00008fd0: 6e2e 0d0a 2020 2020 0d0a 2020 2020 3a70  n...    ..    :p
+00008fe0: 6172 616d 2079 5f70 7265 643a 206e 6461  aram y_pred: nda
+00008ff0: 7272 6179 206f 7220 5365 7269 6573 206f  rray or Series o
+00009000: 6620 6c65 6e67 7468 206e 0d0a 2020 2020  f length n..    
+00009010: 2020 2020 416e 2061 7272 6179 206f 7220      An array or 
+00009020: 7365 7269 6573 206f 6620 7468 6520 7072  series of the pr
+00009030: 6564 6963 7465 6420 7461 7267 6574 2e20  edicted target. 
+00009040: 0d0a 2020 2020 3a70 6172 616d 2076 6965  ..    :param vie
+00009050: 773a 2062 6f6f 6c2c 2064 6566 6175 6c74  w: bool, default
+00009060: 3d54 7275 6520 0d0a 2020 2020 2020 2020  =True ..        
+00009070: 4f70 7469 6f6e 2074 6f20 6469 7370 6c61  Option to displa
+00009080: 7920 7468 6520 6d61 7473 686f 7720 6d61  y the matshow ma
+00009090: 702e 2053 6574 2074 6f20 6060 4661 6c73  p. Set to ``Fals
+000090a0: 6560 6020 6d75 7465 7320 7468 6520 706c  e`` mutes the pl
+000090b0: 6f74 2e20 0d0a 2020 2020 3a70 6172 616d  ot. ..    :param
+000090c0: 2061 6e6e 6f74 3a20 626f 6f6c 2c20 6465   annot: bool, de
+000090d0: 6661 756c 743d 5472 7565 200d 0a20 2020  fault=True ..   
+000090e0: 2020 2020 2041 6e6e 6f74 6174 6520 7468       Annotate th
+000090f0: 6520 6e75 6d62 6572 206f 6620 7361 6d70  e number of samp
+00009100: 6c65 7320 2872 6967 6874 206f 7220 7772  les (right or wr
+00009110: 6f6e 6720 7072 6564 6963 7469 6f6e 2029  ong prediction )
+00009120: 2069 6e20 7468 6520 706c 6f74 2e20 0d0a   in the plot. ..
+00009130: 2020 2020 2020 2020 5365 7420 6060 4661          Set ``Fa
+00009140: 6c73 6560 6020 746f 206d 7574 6520 7468  lse`` to mute th
+00009150: 6520 6469 7370 6c61 792e 0d0a 2020 2020  e display...    
+00009160: 7061 7261 6d20 6b77 733a 2064 6963 742c  param kws: dict,
+00009170: 200d 0a20 2020 2020 2020 2041 6464 6974   ..        Addit
+00009180: 696f 6e61 6c20 6b65 7977 6f72 6420 6172  ional keyword ar
+00009190: 6775 6d65 6e74 7320 7061 7373 6564 2074  guments passed t
+000091a0: 6f20 7468 6520 6675 6e63 7469 6f6e 200d  o the function .
+000091b0: 0a20 2020 2020 2020 203a 6675 6e63 3a60  .        :func:`
+000091c0: 7363 6b69 746c 6561 726e 2e6d 6574 7269  sckitlearn.metri
+000091d0: 6373 2e63 6f6e 6675 7369 6f6e 5f6d 6174  cs.confusion_mat
+000091e0: 7269 7860 2e20 0d0a 2020 2020 3a72 6574  rix`. ..    :ret
+000091f0: 7572 6e73 3a20 6d61 742d 2063 6f6e 6675  urns: mat- confu
+00009200: 7369 6f6e 206d 6174 7269 7820 626c 6f63  sion matrix bloc
+00009210: 206d 6174 7269 7820 0d0a 2020 2020 0d0a   matrix ..    ..
+00009220: 2020 2020 3a65 7861 6d70 6c65 3a20 0d0a      :example: ..
+00009230: 2020 2020 3e3e 3e20 2349 6d70 6f72 7420      >>> #Import 
+00009240: 7468 6520 7265 7175 6972 6564 206d 6f64  the required mod
+00009250: 656c 7320 616e 6420 6665 7463 6820 6120  els and fetch a 
+00009260: 616e 2041 6261 626f 6f73 7420 6d6f 6465  an Ababoost mode
+00009270: 6c20 0d0a 2020 2020 3e3e 3e20 2320 666f  l ..    >>> # fo
+00009280: 7220 696e 7374 616e 6365 2074 6865 6e20  r instance then 
+00009290: 706c 6f74 2074 6865 2063 6f6e 6675 7369  plot the confusi
+000092a0: 6f6e 206d 6574 7269 6320 0d0a 2020 2020  on metric ..    
+000092b0: 3e3e 3e20 696d 706f 7274 206d 6174 706c  >>> import matpl
+000092c0: 6f74 6c69 622e 7079 706c 6f74 2061 7320  otlib.pyplot as 
+000092d0: 706c 7420 0d0a 2020 2020 3e3e 3e20 706c  plt ..    >>> pl
+000092e0: 742e 7374 796c 652e 7573 6520 2827 636c  t.style.use ('cl
+000092f0: 6173 7369 6327 290d 0a20 2020 203e 3e3e  assic')..    >>>
+00009300: 2066 726f 6d20 7761 7465 782e 6461 7461   from watex.data
+00009310: 7365 7473 2069 6d70 6f72 7420 6665 7463  sets import fetc
+00009320: 685f 6461 7461 0d0a 2020 2020 3e3e 3e20  h_data..    >>> 
+00009330: 6672 6f6d 2077 6174 6578 2e65 786c 6962  from watex.exlib
+00009340: 2e73 6b6c 6561 726e 2069 6d70 6f72 7420  .sklearn import 
+00009350: 7472 6169 6e5f 7465 7374 5f73 706c 6974  train_test_split
+00009360: 200d 0a20 2020 203e 3e3e 2066 726f 6d20   ..    >>> from 
+00009370: 7761 7465 782e 6d6f 6465 6c73 2069 6d70  watex.models imp
+00009380: 6f72 7420 704d 6f64 656c 7320 0d0a 2020  ort pModels ..  
+00009390: 2020 3e3e 3e20 6672 6f6d 2077 6174 6578    >>> from watex
+000093a0: 2e75 7469 6c73 2e70 6c6f 7475 7469 6c73  .utils.plotutils
+000093b0: 2069 6d70 6f72 7420 706c 6f74 5f63 6f6e   import plot_con
+000093c0: 6675 7369 6f6e 5f6d 6174 7269 780d 0a20  fusion_matrix.. 
+000093d0: 2020 203e 3e3e 2023 2073 706c 6974 2074     >>> # split t
+000093e0: 6865 2020 6461 7461 202e 204e 6f74 6520  he  data . Note 
+000093f0: 7468 6174 2066 6574 6368 5f64 6174 6120  that fetch_data 
+00009400: 6f75 7470 7574 2058 2061 6e64 2079 200d  output X and y .
+00009410: 0a20 2020 203e 3e3e 2058 2c20 5874 2c20  .    >>> X, Xt, 
+00009420: 792c 2079 7420 203d 2074 7261 696e 5f74  y, yt  = train_t
+00009430: 6573 745f 7370 6c69 7420 282a 2066 6574  est_split (* fet
+00009440: 6368 5f64 6174 6120 2827 6261 676f 7565  ch_data ('bagoue
+00009450: 2061 6e61 6c79 7365 6427 292c 0d0a 2020   analysed'),..  
+00009460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009480: 2020 2020 2020 2020 7465 7374 5f73 697a          test_siz
+00009490: 6520 3d2e 3235 2020 2920 200d 0a20 2020  e =.25  )  ..   
+000094a0: 203e 3e3e 2023 2074 7261 696e 2074 6865   >>> # train the
+000094b0: 206d 6f64 656c 2077 6974 6820 7468 6520   model with the 
+000094c0: 6265 7374 2065 7374 696d 6174 6f72 200d  best estimator .
+000094d0: 0a20 2020 203e 3e3e 2070 6d6f 203d 2070  .    >>> pmo = p
+000094e0: 4d6f 6465 6c73 2028 6d6f 6465 6c20 3d27  Models (model ='
+000094f0: 6164 6127 2029 200d 0a20 2020 203e 3e3e  ada' ) ..    >>>
+00009500: 2070 6d6f 2e66 6974 2858 2c20 7920 290d   pmo.fit(X, y ).
+00009510: 0a20 2020 203e 3e3e 2070 7269 6e74 2870  .    >>> print(p
+00009520: 6d6f 2e65 7374 696d 6174 6f72 5f20 290d  mo.estimator_ ).
+00009530: 0a20 2020 203e 3e3e 2023 2525 200d 0a20  .    >>> #%% .. 
+00009540: 2020 203e 3e3e 2023 2050 7265 6469 6374     >>> # Predict
+00009550: 2074 6865 2073 636f 7265 2075 7369 6e67   the score using
+00009560: 2075 6e64 6572 2074 6865 2068 6f6f 6420   under the hood 
+00009570: 7468 6520 6265 7374 2065 7374 696d 6174  the best estimat
+00009580: 6f72 200d 0a20 2020 203e 3e3e 2023 2066  or ..    >>> # f
+00009590: 6f72 2061 6461 626f 6f73 7420 636c 6173  or adaboost clas
+000095a0: 7369 6669 6572 200d 0a20 2020 203e 3e3e  sifier ..    >>>
+000095b0: 2079 7072 6564 203d 2070 6d6f 2e70 7265   ypred = pmo.pre
+000095c0: 6469 6374 2858 7429 200d 0a20 2020 203e  dict(Xt) ..    >
+000095d0: 3e3e 2023 206e 6f77 2070 6c6f 7420 7468  >> # now plot th
+000095e0: 6520 7363 6f72 6520 0d0a 2020 2020 3e3e  e score ..    >>
+000095f0: 3e20 706c 6f74 5f63 6f6e 6675 7369 6f6e  > plot_confusion
+00009600: 5f6d 6174 7269 7820 2879 7420 2c20 7970  _matrix (yt , yp
+00009610: 7265 6420 290d 0a20 2020 2022 2222 0d0a  red )..    """..
+00009620: 2020 2020 6368 6563 6b5f 636f 6e73 6973      check_consis
+00009630: 7465 6e74 5f6c 656e 6774 6820 2879 742c  tent_length (yt,
+00009640: 2079 5f70 7265 6429 0d0a 2020 2020 6d61   y_pred)..    ma
+00009650: 743d 2063 6f6e 6675 7369 6f6e 5f6d 6174  t= confusion_mat
+00009660: 7269 7820 2879 742c 2079 5f70 7265 642c  rix (yt, y_pred,
+00009670: 202a 2a6b 7773 290d 0a20 2020 2069 6620   **kws)..    if 
+00009680: 6178 2069 7320 4e6f 6e65 3a20 0d0a 2020  ax is None: ..  
+00009690: 2020 2020 2020 6669 672c 2061 7820 3d20        fig, ax = 
+000096a0: 706c 742e 7375 6270 6c6f 7473 2028 290d  plt.subplots ().
+000096b0: 0a20 2020 2020 2020 200d 0a20 2020 2069  .        ..    i
+000096c0: 6620 7669 6577 3a20 0d0a 2020 2020 2020  f view: ..      
+000096d0: 2020 736e 732e 6865 6174 6d61 7020 280d    sns.heatmap (.
+000096e0: 0a20 2020 2020 2020 2020 2020 206d 6174  .            mat
+000096f0: 2e54 2c20 7371 7561 7265 203d 5472 7565  .T, square =True
+00009700: 2c20 616e 6e6f 7420 3d61 6e6e 6f74 2c20  , annot =annot, 
+00009710: 6362 6172 3d46 616c 7365 2c20 6178 3d61  cbar=False, ax=a
+00009720: 7829 0d0a 2020 2020 2020 2020 2320 7874  x)..        # xt
+00009730: 6963 6b6c 6162 656c 733d 206c 6973 7428  icklabels= list(
+00009740: 6e70 2e75 6e69 7175 6528 7974 7275 652e  np.unique(ytrue.
+00009750: 7661 6c75 6573 2929 2c20 0d0a 2020 2020  values)), ..    
+00009760: 2020 2020 2320 7974 6963 6b6c 6162 656c      # yticklabel
+00009770: 733d 206c 6973 7428 6e70 2e75 6e69 7175  s= list(np.uniqu
+00009780: 6528 7974 7275 652e 7661 6c75 6573 2929  e(ytrue.values))
+00009790: 290d 0a20 2020 2020 2020 2061 782e 7365  )..        ax.se
+000097a0: 745f 786c 6162 656c 2827 7472 7565 206c  t_xlabel('true l
+000097b0: 6162 656c 7327 2029 0d0a 2020 2020 2020  abels' )..      
+000097c0: 2020 6178 2e73 6574 5f79 6c61 6265 6c20    ax.set_ylabel 
+000097d0: 2827 7072 6564 6963 7465 6420 6c61 6265  ('predicted labe
+000097e0: 6c73 2729 0d0a 2020 2020 7265 7475 726e  ls')..    return
+000097f0: 206d 6174 200d 0a0d 0a64 6566 2070 6c6f   mat ....def plo
+00009800: 745f 7962 5f63 6f6e 6675 7369 6f6e 5f6d  t_yb_confusion_m
+00009810: 6174 7269 7820 280d 0a20 2020 2020 2020  atrix (..       
+00009820: 2063 6c66 2c20 5874 2c20 7974 2c20 6c61   clf, Xt, yt, la
+00009830: 6265 6c73 203d 204e 6f6e 6520 2c20 656e  bels = None , en
+00009840: 636f 6465 7220 3d20 4e6f 6e65 2c20 7361  coder = None, sa
+00009850: 7665 6669 6720 3d4e 6f6e 652c 200d 0a20  vefig =None, .. 
+00009860: 2020 2020 2020 2066 6967 5f73 697a 6520         fig_size 
+00009870: 3d28 362c 2036 292c 202a 2a6b 7773 0d0a  =(6, 6), **kws..
+00009880: 2020 2020 2020 2020 293a 200d 0a20 2020          ): ..   
+00009890: 2022 2222 2043 6f6e 6675 7369 6f6e 206d   """ Confusion m
+000098a0: 6174 7269 7820 706c 6f74 2075 7369 6e67  atrix plot using
+000098b0: 2074 6865 2027 7965 6c6c 6f77 6272 6963   the 'yellowbric
+000098c0: 6b27 2070 6163 6b61 6765 2e20 200d 0a20  k' package.  .. 
+000098d0: 2020 200d 0a20 2020 2043 7265 6174 6573     ..    Creates
+000098e0: 2061 2068 6561 746d 6170 2076 6973 7561   a heatmap visua
+000098f0: 6c69 7a61 7469 6f6e 206f 6620 7468 6520  lization of the 
+00009900: 736b 6c65 6172 6e2e 6d65 7472 6963 732e  sklearn.metrics.
+00009910: 636f 6e66 7573 696f 6e5f 6d61 7472 6978  confusion_matrix
+00009920: 2829 2e0d 0a20 2020 2041 2063 6f6e 6675  ()...    A confu
+00009930: 7369 6f6e 206d 6174 7269 7820 7368 6f77  sion matrix show
+00009940: 7320 6561 6368 2063 6f6d 6269 6e61 7469  s each combinati
+00009950: 6f6e 206f 6620 7468 6520 7472 7565 2061  on of the true a
+00009960: 6e64 2070 7265 6469 6374 6564 0d0a 2020  nd predicted..  
+00009970: 2020 636c 6173 7365 7320 666f 7220 6120    classes for a 
+00009980: 7465 7374 2064 6174 6120 7365 742e 0d0a  test data set...
+00009990: 0d0a 2020 2020 5468 6520 6465 6661 756c  ..    The defaul
+000099a0: 7420 636f 6c6f 7220 6d61 7020 7573 6573  t color map uses
+000099b0: 2061 2079 656c 6c6f 772f 6f72 616e 6765   a yellow/orange
+000099c0: 2f72 6564 2063 6f6c 6f72 2073 6361 6c65  /red color scale
+000099d0: 2e20 5468 6520 7573 6572 2063 616e 0d0a  . The user can..
+000099e0: 2020 2020 6368 6f6f 7365 2062 6574 7765      choose betwe
+000099f0: 656e 2064 6973 706c 6179 696e 6720 7661  en displaying va
+00009a00: 6c75 6573 2061 7320 7468 6520 7065 7263  lues as the perc
+00009a10: 656e 7420 6f66 2074 7275 6520 2863 656c  ent of true (cel
+00009a20: 6c20 7661 6c75 650d 0a20 2020 2064 6976  l value..    div
+00009a30: 6964 6564 2062 7920 7375 6d20 6f66 2072  ided by sum of r
+00009a40: 6f77 2920 6f72 2061 7320 6469 7265 6374  ow) or as direct
+00009a50: 2063 6f75 6e74 732e 2049 6620 7065 7263   counts. If perc
+00009a60: 656e 7420 6f66 2074 7275 6520 6d6f 6465  ent of true mode
+00009a70: 2069 730d 0a20 2020 2073 656c 6563 7465   is..    selecte
+00009a80: 642c 2031 3030 2520 6163 6375 7261 7465  d, 100% accurate
+00009a90: 2070 7265 6469 6374 696f 6e73 2061 7265   predictions are
+00009aa0: 2068 6967 686c 6967 6874 6564 2069 6e20   highlighted in 
+00009ab0: 6772 6565 6e2e 0d0a 0d0a 2020 2020 5265  green.....    Re
+00009ac0: 7175 6972 6573 2061 2063 6c61 7373 6966  quires a classif
+00009ad0: 6963 6174 696f 6e20 6d6f 6465 6c2e 0d0a  ication model...
+00009ae0: 2020 2020 0d0a 2020 2020 4265 2073 7572      ..    Be sur
+00009af0: 6520 2779 656c 6c6f 7762 7269 636b 2720  e 'yellowbrick' 
+00009b00: 6973 2069 6e73 7461 6c6c 6564 2062 6566  is installed bef
+00009b10: 6f72 6520 7573 696e 6720 7468 6520 6675  ore using the fu
+00009b20: 6e63 7469 6f6e 2c20 6f74 6865 7277 6973  nction, otherwis
+00009b30: 6520 616e 200d 0a20 2020 2049 6d70 6f72  e an ..    Impor
+00009b40: 7445 7272 6f72 2077 696c 6c20 7261 6973  tError will rais
+00009b50: 652e 200d 0a20 2020 200d 0a20 2020 2050  e. ..    ..    P
+00009b60: 6172 616d 6574 6572 7320 0d0a 2020 2020  arameters ..    
+00009b70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
+00009b80: 2063 6c66 203a 2063 6c61 7373 6966 6965   clf : classifie
+00009b90: 7220 6573 7469 6d61 746f 720d 0a20 2020  r estimator..   
+00009ba0: 2020 2020 2041 2073 6369 6b69 742d 6c65       A scikit-le
+00009bb0: 6172 6e20 6573 7469 6d61 746f 7220 7468  arn estimator th
+00009bc0: 6174 2073 686f 756c 6420 6265 2061 2063  at should be a c
+00009bd0: 6c61 7373 6966 6965 722e 2049 6620 7468  lassifier. If th
+00009be0: 6520 6d6f 6465 6c20 6973 0d0a 2020 2020  e model is..    
+00009bf0: 2020 2020 6e6f 7420 6120 636c 6173 7369      not a classi
+00009c00: 6669 6572 2c20 616e 2065 7863 6570 7469  fier, an excepti
+00009c10: 6f6e 2069 7320 7261 6973 6564 2e20 4966  on is raised. If
+00009c20: 2074 6865 2069 6e74 6572 6e61 6c20 6d6f   the internal mo
+00009c30: 6465 6c20 6973 206e 6f74 0d0a 2020 2020  del is not..    
+00009c40: 2020 2020 6669 7474 6564 2c20 6974 2069      fitted, it i
+00009c50: 7320 6669 7420 7768 656e 2074 6865 2076  s fit when the v
+00009c60: 6973 7561 6c69 7a65 7220 6973 2066 6974  isualizer is fit
+00009c70: 7465 642c 2075 6e6c 6573 7320 6f74 6865  ted, unless othe
+00009c80: 7277 6973 6520 7370 6563 6966 6965 640d  rwise specified.
+00009c90: 0a20 2020 2020 2020 2062 7920 6060 6973  .        by ``is
+00009ca0: 5f66 6974 7465 6460 602e 0d0a 2020 2020  _fitted``...    
+00009cb0: 2020 2020 0d0a 2020 2020 5874 203a 206e      ..    Xt : n
+00009cc0: 6461 7272 6179 206f 7220 4461 7461 4672  darray or DataFr
+00009cd0: 616d 6520 6f66 2073 6861 7065 206e 2078  ame of shape n x
+00009ce0: 206d 0d0a 2020 2020 2020 2020 4120 6d61   m..        A ma
+00009cf0: 7472 6978 206f 6620 6e20 696e 7374 616e  trix of n instan
+00009d00: 6365 7320 7769 7468 206d 2066 6561 7475  ces with m featu
+00009d10: 7265 732e 2050 7265 6665 7261 626c 792c  res. Preferably,
+00009d20: 206d 6174 7269 7820 7265 7072 6573 656e   matrix represen
+00009d30: 7473 200d 0a20 2020 2020 2020 2074 6865  ts ..        the
+00009d40: 2074 6573 7420 6461 7461 2066 6f72 2065   test data for e
+00009d50: 7272 6f72 2065 7661 6c75 6174 696f 6e2e  rror evaluation.
+00009d60: 2020 0d0a 0d0a 2020 2020 7974 203a 206e    ....    yt : n
+00009d70: 6461 7272 6179 206f 7220 5365 7269 6573  darray or Series
+00009d80: 206f 6620 6c65 6e67 7468 206e 0d0a 2020   of length n..  
+00009d90: 2020 2020 2020 416e 2061 7272 6179 206f        An array o
+00009da0: 7220 7365 7269 6573 206f 6620 7461 7267  r series of targ
+00009db0: 6574 206f 7220 636c 6173 7320 7661 6c75  et or class valu
+00009dc0: 6573 2e20 5072 6566 6572 6162 6c79 2c20  es. Preferably, 
+00009dd0: 7468 6520 6172 7261 7920 0d0a 2020 2020  the array ..    
+00009de0: 2020 2020 7265 7072 6573 656e 7420 7468      represent th
+00009df0: 6520 7465 7374 2063 6c61 7373 206c 6162  e test class lab
+00009e00: 656c 7320 6461 7461 2066 6f72 2065 7272  els data for err
+00009e10: 6f72 2065 7661 6c75 6174 696f 6e2e 2020  or evaluation.  
+00009e20: 0d0a 0d0a 2020 2020 6178 203a 206d 6174  ....    ax : mat
+00009e30: 706c 6f74 6c69 6220 4178 6573 2c20 6465  plotlib Axes, de
+00009e40: 6661 756c 743a 204e 6f6e 650d 0a20 2020  fault: None..   
+00009e50: 2020 2020 2054 6865 2061 7865 7320 746f       The axes to
+00009e60: 2070 6c6f 7420 7468 6520 6669 6775 7265   plot the figure
+00009e70: 206f 6e2e 2049 6620 6e6f 7420 7370 6563   on. If not spec
+00009e80: 6966 6965 6420 7468 6520 6375 7272 656e  ified the curren
+00009e90: 7420 6178 6573 2077 696c 6c20 6265 0d0a  t axes will be..
+00009ea0: 2020 2020 2020 2020 7573 6564 2028 6f72          used (or
+00009eb0: 2067 656e 6572 6174 6564 2069 6620 7265   generated if re
+00009ec0: 7175 6972 6564 292e 0d0a 0d0a 2020 2020  quired).....    
+00009ed0: 7361 6d70 6c65 5f77 6569 6768 743a 2061  sample_weight: a
+00009ee0: 7272 6179 2d6c 696b 6520 6f66 2073 6861  rray-like of sha
+00009ef0: 7065 203d 205b 6e5f 7361 6d70 6c65 735d  pe = [n_samples]
+00009f00: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
+00009f10: 2020 2020 5061 7373 6564 2074 6f20 6060      Passed to ``
+00009f20: 636f 6e66 7573 696f 6e5f 6d61 7472 6978  confusion_matrix
+00009f30: 6060 2074 6f20 7765 6967 6874 2074 6865  `` to weight the
+00009f40: 2073 616d 706c 6573 2e0d 0a20 2020 2020   samples...     
+00009f50: 2020 200d 0a20 2020 2065 6e63 6f64 6572     ..    encoder
+00009f60: 203a 2064 6963 7420 6f72 204c 6162 656c   : dict or Label
+00009f70: 456e 636f 6465 722c 2064 6566 6175 6c74  Encoder, default
+00009f80: 3a20 4e6f 6e65 0d0a 2020 2020 2020 2020  : None..        
+00009f90: 4120 6d61 7070 696e 6720 6f66 2063 6c61  A mapping of cla
+00009fa0: 7373 6573 2074 6f20 6875 6d61 6e20 7265  sses to human re
+00009fb0: 6164 6162 6c65 206c 6162 656c 732e 204f  adable labels. O
+00009fc0: 6674 656e 2074 6865 7265 2069 7320 6120  ften there is a 
+00009fd0: 6d69 736d 6174 6368 0d0a 2020 2020 2020  mismatch..      
+00009fe0: 2020 6265 7477 6565 6e20 6465 7369 7265    between desire
+00009ff0: 6420 636c 6173 7320 6c61 6265 6c73 2061  d class labels a
+0000a000: 6e64 2074 686f 7365 2063 6f6e 7461 696e  nd those contain
+0000a010: 6564 2069 6e20 7468 6520 7461 7267 6574  ed in the target
+0000a020: 2076 6172 6961 626c 650d 0a20 2020 2020   variable..     
+0000a030: 2020 2070 6173 7365 6420 746f 2060 6066     passed to ``f
+0000a040: 6974 2829 6060 206f 7220 6060 7363 6f72  it()`` or ``scor
+0000a050: 6528 2960 602e 2054 6865 2065 6e63 6f64  e()``. The encod
+0000a060: 6572 2064 6973 616d 6269 6775 6174 6573  er disambiguates
+0000a070: 2074 6869 7320 6d69 736d 6174 6368 0d0a   this mismatch..
+0000a080: 2020 2020 2020 2020 656e 7375 7269 6e67          ensuring
+0000a090: 2074 6861 7420 636c 6173 7365 7320 6172   that classes ar
+0000a0a0: 6520 6c61 6265 6c65 6420 636f 7272 6563  e labeled correc
+0000a0b0: 746c 7920 696e 2074 6865 2076 6973 7561  tly in the visua
+0000a0c0: 6c69 7a61 7469 6f6e 2e0d 0a20 2020 2020  lization...     
+0000a0d0: 2020 200d 0a20 2020 206c 6162 656c 7320     ..    labels 
+0000a0e0: 3a20 6c69 7374 206f 6620 7374 722c 2064  : list of str, d
+0000a0f0: 6566 6175 6c74 3a20 4e6f 6e65 0d0a 2020  efault: None..  
+0000a100: 2020 2020 2020 5468 6520 636c 6173 7320        The class 
+0000a110: 6c61 6265 6c73 2074 6f20 7573 6520 666f  labels to use fo
+0000a120: 7220 7468 6520 6c65 6765 6e64 206f 7264  r the legend ord
+0000a130: 6572 6564 2062 7920 7468 6520 696e 6465  ered by the inde
+0000a140: 7820 6f66 2074 6865 2073 6f72 7465 640d  x of the sorted.
+0000a150: 0a20 2020 2020 2020 2063 6c61 7373 6573  .        classes
+0000a160: 2064 6973 636f 7665 7265 6420 696e 2074   discovered in t
+0000a170: 6865 2060 6066 6974 2829 6060 206d 6574  he ``fit()`` met
+0000a180: 686f 642e 2053 7065 6369 6679 696e 6720  hod. Specifying 
+0000a190: 636c 6173 7365 7320 696e 2074 6869 730d  classes in this.
+0000a1a0: 0a20 2020 2020 2020 206d 616e 6e65 7220  .        manner 
+0000a1b0: 6973 2075 7365 6420 746f 2063 6861 6e67  is used to chang
+0000a1c0: 6520 7468 6520 636c 6173 7320 6e61 6d65  e the class name
+0000a1d0: 7320 746f 2061 206d 6f72 6520 7370 6563  s to a more spec
+0000a1e0: 6966 6963 2066 6f72 6d61 7420 6f72 0d0a  ific format or..
+0000a1f0: 2020 2020 2020 2020 746f 206c 6162 656c          to label
+0000a200: 2065 6e63 6f64 6564 2069 6e74 6567 6572   encoded integer
+0000a210: 2063 6c61 7373 6573 2e20 536f 6d65 2076   classes. Some v
+0000a220: 6973 7561 6c69 7a65 7273 206d 6179 2061  isualizers may a
+0000a230: 6c73 6f20 7573 6520 7468 6973 0d0a 2020  lso use this..  
+0000a240: 2020 2020 2020 6669 656c 6420 746f 2066        field to f
+0000a250: 696c 7465 7220 7468 6520 7669 7375 616c  ilter the visual
+0000a260: 697a 6174 696f 6e20 666f 7220 7370 6563  ization for spec
+0000a270: 6966 6963 2063 6c61 7373 6573 2e20 466f  ific classes. Fo
+0000a280: 7220 6d6f 7265 2061 6476 616e 6365 640d  r more advanced.
+0000a290: 0a20 2020 2020 2020 2075 7361 6765 2073  .        usage s
+0000a2a0: 7065 6369 6679 2061 6e20 656e 636f 6465  pecify an encode
+0000a2b0: 7220 7261 7468 6572 2074 6861 6e20 636c  r rather than cl
+0000a2c0: 6173 7320 6c61 6265 6c73 2e0d 0a20 2020  ass labels...   
+0000a2d0: 2020 2020 200d 0a20 2020 2066 6967 5f73       ..    fig_s
+0000a2e0: 697a 6520 3a20 7475 706c 6520 2877 6964  ize : tuple (wid
+0000a2f0: 7468 2c20 6865 6967 6874 292c 2064 6566  th, height), def
+0000a300: 6175 6c74 203d 2838 2c20 3629 0d0a 2020  ault =(8, 6)..  
+0000a310: 2020 2020 2020 7468 6520 6d61 7470 6c6f        the matplo
+0000a320: 746c 6962 2066 6967 7572 6520 7369 7a65  tlib figure size
+0000a330: 2067 6976 656e 2061 7320 6120 7475 706c   given as a tupl
+0000a340: 6520 6f66 2077 6964 7468 2061 6e64 2068  e of width and h
+0000a350: 6569 6768 740d 0a20 2020 2020 2020 200d  eight..        .
+0000a360: 0a20 2020 2073 6176 6566 6967 3a20 7374  .    savefig: st
+0000a370: 722c 2064 6566 6175 6c74 203d 4e6f 6e65  r, default =None
+0000a380: 202c 200d 0a20 2020 2020 2020 2074 6865   , ..        the
+0000a390: 2070 6174 6820 746f 2073 6176 6520 7468   path to save th
+0000a3a0: 6520 6669 6775 7265 732e 2041 7267 756d  e figures. Argum
+0000a3b0: 656e 7420 6973 2070 6173 7365 6420 746f  ent is passed to
+0000a3c0: 206d 6174 706c 6f74 6c69 622e 4669 6775   matplotlib.Figu
+0000a3d0: 7265 200d 0a20 2020 2020 2020 2063 6c61  re ..        cla
+0000a3e0: 7373 2e20 0d0a 2020 2020 2020 2020 2020  ss. ..          
+0000a3f0: 0d0a 2020 2020 5265 7475 726e 7320 0d0a  ..    Returns ..
+0000a400: 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020      --------..  
+0000a410: 2020 636d 6f3a 203a 636c 6173 733a 6079    cmo: :class:`y
+0000a420: 656c 6c6f 7762 7269 636b 2e63 6c61 7373  ellowbrick.class
+0000a430: 6966 6965 722e 636f 6e66 7573 696f 6e5f  ifier.confusion_
+0000a440: 6d61 7472 6978 2e43 6f6e 6675 7369 6f6e  matrix.Confusion
+0000a450: 4d61 7472 6978 600d 0a20 2020 2020 2020  Matrix`..       
+0000a460: 2072 6574 7572 6e20 6120 7965 6c6c 6f77   return a yellow
+0000a470: 6272 6963 6b20 636f 6e66 7573 696f 6e20  brick confusion 
+0000a480: 6d61 7472 6978 206f 626a 6563 7420 696e  matrix object in
+0000a490: 7374 616e 6365 2e20 0d0a 2020 2020 0d0a  stance. ..    ..
+0000a4a0: 2020 2020 4578 616d 706c 6573 200d 0a20      Examples .. 
+0000a4b0: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
+0000a4c0: 203e 3e3e 2023 496d 706f 7274 2074 6865   >>> #Import the
+0000a4d0: 2072 6571 7569 7265 6420 6d6f 6465 6c73   required models
+0000a4e0: 2061 6e64 2066 6574 6368 2061 2061 6e20   and fetch a an 
+0000a4f0: 6578 7472 656d 6520 6772 6164 6965 6e74  extreme gradient
+0000a500: 2062 6f6f 7374 696e 6720 0d0a 2020 2020   boosting ..    
+0000a510: 3e3e 3e20 2320 666f 7220 696e 7374 616e  >>> # for instan
+0000a520: 6365 2074 6865 6e20 706c 6f74 2074 6865  ce then plot the
+0000a530: 2063 6f6e 6675 7369 6f6e 206d 6574 7269   confusion metri
+0000a540: 6320 0d0a 2020 2020 3e3e 3e20 696d 706f  c ..    >>> impo
+0000a550: 7274 206d 6174 706c 6f74 6c69 622e 7079  rt matplotlib.py
+0000a560: 706c 6f74 2061 7320 706c 7420 0d0a 2020  plot as plt ..  
+0000a570: 2020 3e3e 3e20 706c 742e 7374 796c 652e    >>> plt.style.
+0000a580: 7573 6520 2827 636c 6173 7369 6327 290d  use ('classic').
+0000a590: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
+0000a5a0: 7465 782e 6461 7461 7365 7473 2069 6d70  tex.datasets imp
+0000a5b0: 6f72 7420 6665 7463 685f 6461 7461 0d0a  ort fetch_data..
+0000a5c0: 2020 2020 3e3e 3e20 6672 6f6d 2077 6174      >>> from wat
+0000a5d0: 6578 2e65 786c 6962 2e73 6b6c 6561 726e  ex.exlib.sklearn
+0000a5e0: 2069 6d70 6f72 7420 7472 6169 6e5f 7465   import train_te
+0000a5f0: 7374 5f73 706c 6974 200d 0a20 2020 203e  st_split ..    >
+0000a600: 3e3e 2066 726f 6d20 7761 7465 782e 6d6f  >> from watex.mo
+0000a610: 6465 6c73 2069 6d70 6f72 7420 704d 6f64  dels import pMod
+0000a620: 656c 7320 0d0a 2020 2020 3e3e 3e20 6672  els ..    >>> fr
+0000a630: 6f6d 2077 6174 6578 2e75 7469 6c73 2e70  om watex.utils.p
+0000a640: 6c6f 7475 7469 6c73 2069 6d70 6f72 7420  lotutils import 
+0000a650: 706c 6f74 5f79 625f 636f 6e66 7573 696f  plot_yb_confusio
+0000a660: 6e5f 6d61 7472 6978 0d0a 2020 2020 3e3e  n_matrix..    >>
+0000a670: 3e20 2320 7370 6c69 7420 7468 6520 2064  > # split the  d
+0000a680: 6174 6120 2e20 4e6f 7465 2074 6861 7420  ata . Note that 
+0000a690: 6665 7463 685f 6461 7461 206f 7574 7075  fetch_data outpu
+0000a6a0: 7420 5820 616e 6420 7920 0d0a 2020 2020  t X and y ..    
+0000a6b0: 3e3e 3e20 582c 2058 742c 2079 2c20 7974  >>> X, Xt, y, yt
+0000a6c0: 2020 3d20 7472 6169 6e5f 7465 7374 5f73    = train_test_s
+0000a6d0: 706c 6974 2028 2a20 6665 7463 685f 6461  plit (* fetch_da
+0000a6e0: 7461 2028 2762 6167 6f75 6520 616e 616c  ta ('bagoue anal
+0000a6f0: 7973 6564 2729 2c0d 0a20 2020 2020 2020  ysed'),..       
+0000a700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a720: 2020 2074 6573 745f 7369 7a65 203d 2e32     test_size =.2
+0000a730: 3520 2029 2020 0d0a 2020 2020 3e3e 3e20  5  )  ..    >>> 
+0000a740: 2320 7472 6169 6e20 7468 6520 6d6f 6465  # train the mode
+0000a750: 6c20 7769 7468 2074 6865 2062 6573 7420  l with the best 
+0000a760: 6573 7469 6d61 746f 7220 0d0a 2020 2020  estimator ..    
+0000a770: 3e3e 3e20 706d 6f20 3d20 704d 6f64 656c  >>> pmo = pModel
+0000a780: 7320 286d 6f64 656c 203d 2778 6762 6f6f  s (model ='xgboo
+0000a790: 7374 2720 2920 0d0a 2020 2020 3e3e 3e20  st' ) ..    >>> 
+0000a7a0: 706d 6f2e 6669 7428 582c 2079 2029 0d0a  pmo.fit(X, y )..
+0000a7b0: 2020 2020 3e3e 3e20 7072 696e 7428 706d      >>> print(pm
+0000a7c0: 6f2e 6573 7469 6d61 746f 725f 2029 2023  o.estimator_ ) #
+0000a7d0: 2070 6d6f 2e58 4742 2e62 6573 745f 6573   pmo.XGB.best_es
+0000a7e0: 7469 6d61 746f 725f 0d0a 2020 2020 3e3e  timator_..    >>
+0000a7f0: 3e20 2325 2520 0d0a 2020 2020 3e3e 3e20  > #%% ..    >>> 
+0000a800: 2320 5072 6564 6963 7420 7468 6520 7363  # Predict the sc
+0000a810: 6f72 6520 7573 696e 6720 756e 6465 7220  ore using under 
+0000a820: 7468 6520 686f 6f64 2074 6865 2062 6573  the hood the bes
+0000a830: 7420 6573 7469 6d61 746f 7220 0d0a 2020  t estimator ..  
+0000a840: 2020 3e3e 3e20 2320 666f 7220 6164 6162    >>> # for adab
+0000a850: 6f6f 7374 2063 6c61 7373 6966 6965 7220  oost classifier 
+0000a860: 0d0a 2020 2020 3e3e 3e20 7970 7265 6420  ..    >>> ypred 
+0000a870: 3d20 706d 6f2e 7072 6564 6963 7428 5874  = pmo.predict(Xt
+0000a880: 2920 0d0a 2020 2020 0d0a 2020 2020 3e3e  ) ..    ..    >>
+0000a890: 3e20 2320 6e6f 7720 706c 6f74 2074 6865  > # now plot the
+0000a8a0: 2073 636f 7265 200d 0a20 2020 203e 3e3e   score ..    >>>
+0000a8b0: 2070 6c6f 745f 7962 5f63 6f6e 6675 7369   plot_yb_confusi
+0000a8c0: 6f6e 5f6d 6174 7269 7820 2870 6d6f 2e58  on_matrix (pmo.X
+0000a8d0: 4742 2e62 6573 745f 6573 7469 6d61 746f  GB.best_estimato
+0000a8e0: 725f 2c20 5874 2c20 7974 2020 290d 0a20  r_, Xt, yt  ).. 
+0000a8f0: 2020 2022 2222 0d0a 2020 2020 696d 706f     """..    impo
+0000a900: 7274 5f6f 7074 696f 6e61 6c5f 6465 7065  rt_optional_depe
+0000a910: 6e64 656e 6379 2827 7965 6c6c 6f77 6272  ndency('yellowbr
+0000a920: 6963 6b27 2c20 280d 0a20 2020 2020 2020  ick', (..       
+0000a930: 2022 4361 6e6e 6f74 2070 6c6f 7420 7468   "Cannot plot th
+0000a940: 6520 636f 6e66 7573 696f 6e20 6d61 7472  e confusion matr
+0000a950: 6978 2076 6961 2027 7965 6c6c 6f77 6272  ix via 'yellowbr
+0000a960: 6963 6b27 2070 6163 6b61 6765 2e22 0d0a  ick' package."..
+0000a970: 2020 2020 2020 2020 2220 416c 7465 726e          " Altern
+0000a980: 6174 6976 656c 792c 2079 6f75 206d 6179  atively, you may
+0000a990: 2075 7365 2075 6675 6e63 2060 7e2e 706c   use ufunc `~.pl
+0000a9a0: 6f74 5f63 6f6e 6675 7369 6f6e 5f6d 6174  ot_confusion_mat
+0000a9b0: 7269 7860 2c22 0d0a 2020 2020 2020 2020  rix`,"..        
+0000a9c0: 2220 6f74 6865 7277 6973 6520 696e 7374  " otherwise inst
+0000a9d0: 616c 6c20 6974 206d 616e 6e75 616c 6c79  all it mannually
+0000a9e0: 2e22 290d 0a20 2020 2020 2020 2029 0d0a  .")..        )..
+0000a9f0: 2020 2020 6669 672c 2061 7820 3d20 706c      fig, ax = pl
+0000aa00: 742e 7375 6270 6c6f 7473 2866 6967 7369  t.subplots(figsi
+0000aa10: 7a65 203d 2066 6967 5f73 697a 6520 290d  ze = fig_size ).
+0000aa20: 0a20 2020 2063 6d6f 3d20 436f 6e66 7573  .    cmo= Confus
+0000aa30: 696f 6e4d 6174 7269 7820 2863 6c66 2c20  ionMatrix (clf, 
+0000aa40: 636c 6173 7365 733d 6c61 6265 6c73 2c20  classes=labels, 
+0000aa50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000aa60: 2020 2020 2020 2020 2020 206c 6162 656c             label
+0000aa70: 5f65 6e63 6f64 6572 203d 2065 6e63 6f64  _encoder = encod
+0000aa80: 6572 2c20 2a2a 6b77 730d 0a20 2020 2020  er, **kws..     
+0000aa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aaa0: 2020 2020 290d 0a20 2020 2063 6d6f 2e73      )..    cmo.s
+0000aab0: 636f 7265 2858 742c 2079 7429 0d0a 2020  core(Xt, yt)..  
+0000aac0: 2020 636d 6f2e 7368 6f77 2829 0d0a 0d0a    cmo.show()....
+0000aad0: 2020 2020 6966 2073 6176 6566 6967 2069      if savefig i
+0000aae0: 7320 6e6f 7420 4e6f 6e65 3a20 0d0a 2020  s not None: ..  
+0000aaf0: 2020 2020 2020 6669 672e 7361 7665 6669        fig.savefi
+0000ab00: 6728 7361 7665 6669 672c 2064 7069 203d  g(savefig, dpi =
+0000ab10: 3330 3029 0d0a 0d0a 2020 2020 706c 742e  300)....    plt.
+0000ab20: 636c 6f73 6520 2829 2069 6620 7361 7665  close () if save
+0000ab30: 6669 6720 6973 206e 6f74 204e 6f6e 6520  fig is not None 
+0000ab40: 656c 7365 2070 6c74 2e73 686f 7728 2920  else plt.show() 
+0000ab50: 0d0a 2020 2020 0d0a 2020 2020 7265 7475  ..    ..    retu
+0000ab60: 726e 2063 6d6f 200d 0a0d 0a64 6566 2070  rn cmo ....def p
+0000ab70: 6c6f 745f 636f 6e66 7573 696f 6e5f 6d61  lot_confusion_ma
+0000ab80: 7472 6963 6573 2028 0d0a 2020 2020 636c  trices (..    cl
+0000ab90: 6673 2c20 0d0a 2020 2020 5874 2c20 0d0a  fs, ..    Xt, ..
+0000aba0: 2020 2020 7974 2c20 200d 0a20 2020 2061      yt,  ..    a
+0000abb0: 6e6e 6f74 203d 5472 7565 2c20 0d0a 2020  nnot =True, ..  
+0000abc0: 2020 706b 673d 4e6f 6e65 2c20 0d0a 2020    pkg=None, ..  
+0000abd0: 2020 6e6f 726d 616c 697a 653d 2774 7275    normalize='tru
+0000abe0: 6527 2c20 0d0a 2020 2020 7361 6d70 6c65  e', ..    sample
+0000abf0: 5f77 6569 6768 743d 4e6f 6e65 2c0d 0a20  _weight=None,.. 
+0000ac00: 2020 2065 6e63 6f64 6572 3d4e 6f6e 652c     encoder=None,
+0000ac10: 200d 0a20 2020 2066 6967 5f73 697a 6520   ..    fig_size 
+0000ac20: 3d20 2832 322c 2036 292c 0d0a 2020 2020  = (22, 6),..    
+0000ac30: 7361 7665 6669 6720 3d4e 6f6e 652c 200d  savefig =None, .
+0000ac40: 0a20 2020 2073 7562 706c 6f74 5f6b 7773  .    subplot_kws
+0000ac50: 3d4e 6f6e 652c 0d0a 2020 2020 2a2a 7363  =None,..    **sc
+0000ac60: 6f72 6572 5f6b 7773 0d0a 2020 2020 293a  orer_kws..    ):
+0000ac70: 0d0a 2020 2020 2222 2220 0d0a 2020 2020  ..    """ ..    
+0000ac80: 506c 6f74 2069 6e6c 696e 6520 6d75 6c74  Plot inline mult
+0000ac90: 6970 6c65 206d 6f64 656c 2063 6f6e 6675  iple model confu
+0000aca0: 7369 6f6e 206d 6174 7269 6365 7320 7573  sion matrices us
+0000acb0: 696e 6720 6569 7468 6572 2074 6865 2073  ing either the s
+0000acc0: 636b 6974 6c65 6172 6e20 0d0a 2020 2020  ckitlearn ..    
+0000acd0: 6f72 2027 7965 6c6c 6f77 6272 6963 6b27  or 'yellowbrick'
+0000ace0: 0d0a 2020 2020 0d0a 2020 2020 5061 7261  ..    ..    Para
+0000acf0: 6d65 7465 7273 200d 0a20 2020 202d 2d2d  meters ..    ---
+0000ad00: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 636c  --------..    cl
+0000ad10: 6673 203a 206c 6973 7420 6f66 2063 6c61  fs : list of cla
+0000ad20: 7373 6966 6965 7220 6573 7469 6d61 746f  ssifier estimato
+0000ad30: 7273 0d0a 2020 2020 2020 2020 4120 7363  rs..        A sc
+0000ad40: 696b 6974 2d6c 6561 726e 2065 7374 696d  ikit-learn estim
+0000ad50: 6174 6f72 2074 6861 7420 7368 6f75 6c64  ator that should
+0000ad60: 2062 6520 6120 636c 6173 7369 6669 6572   be a classifier
+0000ad70: 2e20 4966 2074 6865 206d 6f64 656c 2069  . If the model i
+0000ad80: 730d 0a20 2020 2020 2020 206e 6f74 2061  s..        not a
+0000ad90: 2063 6c61 7373 6966 6965 722c 2061 6e20   classifier, an 
+0000ada0: 6578 6365 7074 696f 6e20 6973 2072 6169  exception is rai
+0000adb0: 7365 642e 204e 6f74 6520 7468 6174 2074  sed. Note that t
+0000adc0: 6865 2063 6c61 7373 6966 6965 7220 0d0a  he classifier ..
+0000add0: 2020 2020 2020 2020 6d75 7374 2062 6520          must be 
+0000ade0: 6669 7474 6564 2062 6566 6f72 6568 616e  fitted beforehan
+0000adf0: 642e 0d0a 2020 2020 2020 2020 0d0a 2020  d...        ..  
+0000ae00: 2020 5874 203a 206e 6461 7272 6179 206f    Xt : ndarray o
+0000ae10: 7220 4461 7461 4672 616d 6520 6f66 2073  r DataFrame of s
+0000ae20: 6861 7065 2028 4d20 5820 4e29 0d0a 2020  hape (M X N)..  
+0000ae30: 2020 2020 2020 4120 6d61 7472 6978 206f        A matrix o
+0000ae40: 6620 6e20 696e 7374 616e 6365 7320 7769  f n instances wi
+0000ae50: 7468 206d 2066 6561 7475 7265 732e 2050  th m features. P
+0000ae60: 7265 6665 7261 626c 792c 206d 6174 7269  referably, matri
+0000ae70: 7820 7265 7072 6573 656e 7473 200d 0a20  x represents .. 
+0000ae80: 2020 2020 2020 2074 6865 2074 6573 7420         the test 
+0000ae90: 6461 7461 2066 6f72 2065 7272 6f72 2065  data for error e
+0000aea0: 7661 6c75 6174 696f 6e2e 2020 0d0a 0d0a  valuation.  ....
+0000aeb0: 2020 2020 7974 203a 206e 6461 7272 6179      yt : ndarray
+0000aec0: 206f 6620 7368 6170 6520 284d 2c20 2920   of shape (M, ) 
+0000aed0: 6f72 2053 6572 6965 7320 6f46 206c 656e  or Series oF len
+0000aee0: 6774 6820 284d 2c20 290d 0a20 2020 2020  gth (M, )..     
+0000aef0: 2020 2041 6e20 6172 7261 7920 6f72 2073     An array or s
+0000af00: 6572 6965 7320 6f66 2074 6172 6765 7420  eries of target 
+0000af10: 6f72 2063 6c61 7373 2076 616c 7565 732e  or class values.
+0000af20: 2050 7265 6665 7261 626c 792c 2074 6865   Preferably, the
+0000af30: 2061 7272 6179 200d 0a20 2020 2020 2020   array ..       
+0000af40: 2072 6570 7265 7365 6e74 2074 6865 2074   represent the t
+0000af50: 6573 7420 636c 6173 7320 6c61 6265 6c73  est class labels
+0000af60: 2064 6174 6120 666f 7220 6572 726f 7220   data for error 
+0000af70: 6576 616c 7561 7469 6f6e 2e20 200d 0a20  evaluation.  .. 
+0000af80: 2020 200d 0a20 2020 2070 6b67 3a20 7374     ..    pkg: st
+0000af90: 722c 206f 7074 696f 6e61 6c20 2c20 6465  r, optional , de
+0000afa0: 6661 756c 7420 3d27 736b 6c65 6172 6e27  fault ='sklearn'
+0000afb0: 0d0a 2020 2020 2020 2020 7468 6520 6c69  ..        the li
+0000afc0: 6272 6172 7920 746f 2068 616e 646c 6520  brary to handle 
+0000afd0: 7468 6520 706c 6f74 2e20 4974 2063 6f75  the plot. It cou
+0000afe0: 6c64 2062 6520 2779 656c 6c6f 7762 7269  ld be 'yellowbri
+0000aff0: 636b 272e 2054 6865 2062 6173 6963 200d  ck'. The basic .
+0000b000: 0a20 2020 2020 2020 2063 6f6e 6675 7369  .        confusi
+0000b010: 6f6e 206d 6174 7269 7820 6973 2068 616e  on matrix is han
+0000b020: 646c 6564 2062 7920 7468 6520 7363 696b  dled by the scik
+0000b030: 6974 2d6c 6561 726e 2070 6163 6b61 6765  it-learn package
+0000b040: 2e20 0d0a 0d0a 2020 2020 6e6f 726d 616c  . ....    normal
+0000b050: 697a 6520 3a20 7b27 7472 7565 272c 2027  ize : {'true', '
+0000b060: 7072 6564 272c 2027 616c 6c27 7d2c 2064  pred', 'all'}, d
+0000b070: 6566 6175 6c74 3d4e 6f6e 650d 0a20 2020  efault=None..   
+0000b080: 2020 2020 204e 6f72 6d61 6c69 7a65 7320       Normalizes 
+0000b090: 636f 6e66 7573 696f 6e20 6d61 7472 6978  confusion matrix
+0000b0a0: 206f 7665 7220 7468 6520 7472 7565 2028   over the true (
+0000b0b0: 726f 7773 292c 2070 7265 6469 6374 6564  rows), predicted
+0000b0c0: 2028 636f 6c75 6d6e 7329 0d0a 2020 2020   (columns)..    
+0000b0d0: 2020 2020 636f 6e64 6974 696f 6e73 206f      conditions o
+0000b0e0: 7220 616c 6c20 7468 6520 706f 7075 6c61  r all the popula
+0000b0f0: 7469 6f6e 2e20 4966 204e 6f6e 652c 2063  tion. If None, c
+0000b100: 6f6e 6675 7369 6f6e 206d 6174 7269 7820  onfusion matrix 
+0000b110: 7769 6c6c 206e 6f74 2062 650d 0a20 2020  will not be..   
+0000b120: 2020 2020 206e 6f72 6d61 6c69 7a65 642e       normalized.
+0000b130: 0d0a 0d0a 2020 2020 7361 6d70 6c65 5f77  ....    sample_w
+0000b140: 6569 6768 7420 3a20 6172 7261 792d 6c69  eight : array-li
+0000b150: 6b65 206f 6620 7368 6170 6520 286e 5f73  ke of shape (n_s
+0000b160: 616d 706c 6573 2c29 2c20 6465 6661 756c  amples,), defaul
+0000b170: 743d 4e6f 6e65 0d0a 2020 2020 2020 2020  t=None..        
+0000b180: 5361 6d70 6c65 2077 6569 6768 7473 2e0d  Sample weights..
+0000b190: 0a20 2020 2020 2020 200d 0a20 2020 2065  .        ..    e
+0000b1a0: 6e63 6f64 6572 203a 2064 6963 7420 6f72  ncoder : dict or
+0000b1b0: 204c 6162 656c 456e 636f 6465 722c 2064   LabelEncoder, d
+0000b1c0: 6566 6175 6c74 3a20 4e6f 6e65 0d0a 2020  efault: None..  
+0000b1d0: 2020 2020 2020 4120 6d61 7070 696e 6720        A mapping 
+0000b1e0: 6f66 2063 6c61 7373 6573 2074 6f20 6875  of classes to hu
+0000b1f0: 6d61 6e20 7265 6164 6162 6c65 206c 6162  man readable lab
+0000b200: 656c 732e 204f 6674 656e 2074 6865 7265  els. Often there
+0000b210: 2069 7320 6120 6d69 736d 6174 6368 0d0a   is a mismatch..
+0000b220: 2020 2020 2020 2020 6265 7477 6565 6e20          between 
+0000b230: 6465 7369 7265 6420 636c 6173 7320 6c61  desired class la
+0000b240: 6265 6c73 2061 6e64 2074 686f 7365 2063  bels and those c
+0000b250: 6f6e 7461 696e 6564 2069 6e20 7468 6520  ontained in the 
+0000b260: 7461 7267 6574 2076 6172 6961 626c 650d  target variable.
+0000b270: 0a20 2020 2020 2020 2070 6173 7365 6420  .        passed 
+0000b280: 746f 2060 6066 6974 2829 6060 206f 7220  to ``fit()`` or 
+0000b290: 6060 7363 6f72 6528 2960 602e 2054 6865  ``score()``. The
+0000b2a0: 2065 6e63 6f64 6572 2064 6973 616d 6269   encoder disambi
+0000b2b0: 6775 6174 6573 2074 6869 7320 6d69 736d  guates this mism
+0000b2c0: 6174 6368 0d0a 2020 2020 2020 2020 656e  atch..        en
+0000b2d0: 7375 7269 6e67 2074 6861 7420 636c 6173  suring that clas
+0000b2e0: 7365 7320 6172 6520 6c61 6265 6c65 6420  ses are labeled 
+0000b2f0: 636f 7272 6563 746c 7920 696e 2074 6865  correctly in the
+0000b300: 2076 6973 7561 6c69 7a61 7469 6f6e 2e0d   visualization..
+0000b310: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0000b320: 2020 200d 0a20 2020 2061 6e6e 6f74 3a20     ..    annot: 
+0000b330: 626f 6f6c 2c20 6465 6661 756c 743d 5472  bool, default=Tr
+0000b340: 7565 200d 0a20 2020 2020 2020 2041 6e6e  ue ..        Ann
+0000b350: 6f74 6174 6520 7468 6520 6e75 6d62 6572  otate the number
+0000b360: 206f 6620 7361 6d70 6c65 7320 2872 6967   of samples (rig
+0000b370: 6874 206f 7220 7772 6f6e 6720 7072 6564  ht or wrong pred
+0000b380: 6963 7469 6f6e 2029 2069 6e20 7468 6520  iction ) in the 
+0000b390: 706c 6f74 2e20 0d0a 2020 2020 2020 2020  plot. ..        
+0000b3a0: 5365 7420 6060 4661 6c73 6560 6020 746f  Set ``False`` to
+0000b3b0: 206d 7574 6520 7468 6520 6469 7370 6c61   mute the displa
+0000b3c0: 792e 200d 0a20 2020 200d 0a20 2020 2066  y. ..    ..    f
+0000b3d0: 6967 5f73 697a 6520 3a20 7475 706c 6520  ig_size : tuple 
+0000b3e0: 2877 6964 7468 2c20 6865 6967 6874 292c  (width, height),
+0000b3f0: 2064 6566 6175 6c74 203d 2838 2c20 3629   default =(8, 6)
+0000b400: 0d0a 2020 2020 2020 2020 7468 6520 6d61  ..        the ma
+0000b410: 7470 6c6f 746c 6962 2066 6967 7572 6520  tplotlib figure 
+0000b420: 7369 7a65 2067 6976 656e 2061 7320 6120  size given as a 
+0000b430: 7475 706c 6520 6f66 2077 6964 7468 2061  tuple of width a
+0000b440: 6e64 2068 6569 6768 740d 0a20 2020 2020  nd height..     
+0000b450: 2020 200d 0a20 2020 2073 6176 6566 6967     ..    savefig
+0000b460: 3a20 7374 722c 2064 6566 6175 6c74 203d  : str, default =
+0000b470: 4e6f 6e65 202c 200d 0a20 2020 2020 2020  None , ..       
+0000b480: 2074 6865 2070 6174 6820 746f 2073 6176   the path to sav
+0000b490: 6520 7468 6520 6669 6775 7265 732e 2041  e the figures. A
+0000b4a0: 7267 756d 656e 7420 6973 2070 6173 7365  rgument is passe
+0000b4b0: 6420 746f 206d 6174 706c 6f74 6c69 622e  d to matplotlib.
+0000b4c0: 4669 6775 7265 200d 0a20 2020 2020 2020  Figure ..       
+0000b4d0: 2063 6c61 7373 2e20 0d0a 2020 2020 2020   class. ..      
+0000b4e0: 2020 0d0a 2020 2020 4578 616d 706c 6573    ..    Examples
+0000b4f0: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
+0000b500: 0d0a 2020 2020 3e3e 3e20 696d 706f 7274  ..    >>> import
+0000b510: 206d 6174 706c 6f74 6c69 622e 7079 706c   matplotlib.pypl
+0000b520: 6f74 2061 7320 706c 7420 0d0a 2020 2020  ot as plt ..    
+0000b530: 3e3e 3e20 706c 742e 7374 796c 652e 7573  >>> plt.style.us
+0000b540: 6520 2827 636c 6173 7369 6327 290d 0a20  e ('classic').. 
+0000b550: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
+0000b560: 782e 6461 7461 7365 7473 2069 6d70 6f72  x.datasets impor
+0000b570: 7420 6665 7463 685f 6461 7461 0d0a 2020  t fetch_data..  
+0000b580: 2020 3e3e 3e20 6672 6f6d 2077 6174 6578    >>> from watex
+0000b590: 2e65 786c 6962 2e73 6b6c 6561 726e 2069  .exlib.sklearn i
+0000b5a0: 6d70 6f72 7420 7472 6169 6e5f 7465 7374  mport train_test
+0000b5b0: 5f73 706c 6974 200d 0a20 2020 203e 3e3e  _split ..    >>>
+0000b5c0: 2066 726f 6d20 7761 7465 782e 6d6f 6465   from watex.mode
+0000b5d0: 6c73 2e70 7265 6d6f 6465 6c73 2069 6d70  ls.premodels imp
+0000b5e0: 6f72 7420 700d 0a20 2020 203e 3e3e 2066  ort p..    >>> f
+0000b5f0: 726f 6d20 7761 7465 782e 7574 696c 732e  rom watex.utils.
+0000b600: 706c 6f74 7574 696c 7320 696d 706f 7274  plotutils import
+0000b610: 2070 6c6f 745f 636f 6e66 7573 696f 6e5f   plot_confusion_
+0000b620: 6d61 7472 6963 6573 200d 0a20 2020 203e  matrices ..    >
+0000b630: 3e3e 2023 2073 706c 6974 2074 6865 2020  >> # split the  
+0000b640: 6461 7461 202e 204e 6f74 6520 7468 6174  data . Note that
+0000b650: 2066 6574 6368 5f64 6174 6120 6f75 7470   fetch_data outp
+0000b660: 7574 2058 2061 6e64 2079 200d 0a20 2020  ut X and y ..   
+0000b670: 203e 3e3e 2058 2c20 5874 2c20 792c 2079   >>> X, Xt, y, y
+0000b680: 7420 203d 2074 7261 696e 5f74 6573 745f  t  = train_test_
+0000b690: 7370 6c69 7420 282a 2066 6574 6368 5f64  split (* fetch_d
+0000b6a0: 6174 6120 2827 6261 676f 7565 2061 6e61  ata ('bagoue ana
+0000b6b0: 6c79 7365 6427 292c 2074 6573 745f 7369  lysed'), test_si
+0000b6c0: 7a65 203d 2e32 3520 2029 2020 0d0a 2020  ze =.25  )  ..  
+0000b6d0: 2020 3e3e 3e20 2320 636f 6d70 6f73 6520    >>> # compose 
+0000b6e0: 7468 6520 6d6f 6465 6c73 200d 0a20 2020  the models ..   
+0000b6f0: 203e 3e3e 2023 2066 726f 6d20 5242 462c   >>> # from RBF,
+0000b700: 2061 6e64 2070 6f6c 7920 0d0a 2020 2020   and poly ..    
+0000b710: 3e3e 3e20 6d6f 6465 6c73 203d 5b20 702e  >>> models =[ p.
+0000b720: 5356 4d2e 7262 662e 6265 7374 5f65 7374  SVM.rbf.best_est
+0000b730: 696d 6174 6f72 5f2c 0d0a 2020 2020 2020  imator_,..      
+0000b740: 2020 2020 2020 2070 2e4c 6f67 6973 7469         p.Logisti
+0000b750: 6352 6567 7265 7373 696f 6e2e 6265 7374  cRegression.best
+0000b760: 5f65 7374 696d 6174 6f72 5f2c 0d0a 2020  _estimator_,..  
+0000b770: 2020 2020 2020 2020 2020 2070 2e52 616e             p.Ran
+0000b780: 646f 6d46 6f72 6573 742e 6265 7374 5f65  domForest.best_e
+0000b790: 7374 696d 6174 6f72 5f20 0d0a 2020 2020  stimator_ ..    
+0000b7a0: 2020 2020 2020 2020 205d 0d0a 2020 2020           ]..    
+0000b7b0: 3e3e 3e20 6d6f 6465 6c73 200d 0a20 2020  >>> models ..   
+0000b7c0: 205b 5356 4328 433d 322e 302c 2063 6f65   [SVC(C=2.0, coe
+0000b7d0: 6630 3d30 2c20 6465 6772 6565 3d31 2c20  f0=0, degree=1, 
+0000b7e0: 6761 6d6d 613d 302e 3132 3529 2c20 4c6f  gamma=0.125), Lo
+0000b7f0: 6769 7374 6963 5265 6772 6573 7369 6f6e  gisticRegression
+0000b800: 2829 2c20 0d0a 2020 2020 2052 616e 646f  (), ..     Rando
+0000b810: 6d46 6f72 6573 7443 6c61 7373 6966 6965  mForestClassifie
+0000b820: 7228 6372 6974 6572 696f 6e3d 2765 6e74  r(criterion='ent
+0000b830: 726f 7079 272c 206d 6178 5f64 6570 7468  ropy', max_depth
+0000b840: 3d31 362c 206e 5f65 7374 696d 6174 6f72  =16, n_estimator
+0000b850: 733d 3335 3029 5d0d 0a20 2020 203e 3e3e  s=350)]..    >>>
+0000b860: 2023 206e 6f77 2066 6974 2061 6c6c 2065   # now fit all e
+0000b870: 7374 696d 6174 6f72 7320 0d0a 2020 2020  stimators ..    
+0000b880: 3e3e 3e20 6669 7474 6564 5f6d 6f64 656c  >>> fitted_model
+0000b890: 7320 3d20 5b6d 6f64 656c 2e66 6974 2858  s = [model.fit(X
+0000b8a0: 2c20 7929 2066 6f72 206d 6f64 656c 2069  , y) for model i
+0000b8b0: 6e20 6d6f 6465 6c73 205d 0d0a 2020 2020  n models ]..    
+0000b8c0: 3e3e 3e20 706c 6f74 5f63 6f6e 6675 7369  >>> plot_confusi
+0000b8d0: 6f6e 5f6d 6174 7269 6365 7328 6669 7474  on_matrices(fitt
+0000b8e0: 6564 5f6d 6f64 656c 7320 2c20 5874 2c20  ed_models , Xt, 
+0000b8f0: 7974 290d 0a20 2020 2022 2222 0d0a 2020  yt)..    """..  
+0000b900: 2020 706b 6720 3d20 706b 6720 6f72 2027    pkg = pkg or '
+0000b910: 736b 6c65 6172 6e27 0d0a 2020 2020 706b  sklearn'..    pk
+0000b920: 673d 2073 7472 2870 6b67 292e 6c6f 7765  g= str(pkg).lowe
+0000b930: 7228 2920 0d0a 2020 2020 6173 7365 7274  r() ..    assert
+0000b940: 2070 6b67 2069 6e20 7b22 736b 6c65 6172   pkg in {"sklear
+0000b950: 6e22 2c20 2273 6369 6b69 742d 6c65 6172  n", "scikit-lear
+0000b960: 6e22 2c20 2779 656c 6c6f 7762 7269 636b  n", 'yellowbrick
+0000b970: 272c 2022 7962 227d 2c20 280d 0a20 2020  ', "yb"}, (..   
+0000b980: 2020 2020 2066 2220 4163 6365 7074 7320       f" Accepts 
+0000b990: 6f6e 6c79 2027 736b 6c65 6172 6e27 206f  only 'sklearn' o
+0000b9a0: 7220 2779 656c 6c6f 7762 7269 636b 2720  r 'yellowbrick' 
+0000b9b0: 7061 636b 6167 6573 2c20 676f 7420 7b70  packages, got {p
+0000b9c0: 6b67 2172 7d22 2920 0d0a 2020 2020 0d0a  kg!r}") ..    ..
+0000b9d0: 2020 2020 6966 206e 6f74 2069 735f 6974      if not is_it
+0000b9e0: 6572 6162 6c65 2820 636c 6673 293a 200d  erable( clfs): .
+0000b9f0: 0a20 2020 2020 2020 2063 6c66 7320 3d5b  .        clfs =[
+0000ba00: 636c 6673 5d0d 0a0d 0a20 2020 206d 6f64  clfs]....    mod
+0000ba10: 656c 5f6e 616d 6573 203d 205b 6765 745f  el_names = [get_
+0000ba20: 6573 7469 6d61 746f 725f 6e61 6d65 286e  estimator_name(n
+0000ba30: 616d 6529 2066 6f72 206e 616d 6520 696e  ame) for name in
+0000ba40: 2063 6c66 7320 5d0d 0a20 2020 2023 2063   clfs ]..    # c
+0000ba50: 7265 6174 6520 6120 6669 6775 7265 200d  reate a figure .
+0000ba60: 0a20 2020 2073 7562 706c 6f74 5f6b 7773  .    subplot_kws
+0000ba70: 203d 2073 7562 706c 6f74 5f6b 7773 206f   = subplot_kws o
+0000ba80: 7220 6469 6374 2028 6c65 6674 3d30 2e30  r dict (left=0.0
+0000ba90: 3632 352c 2072 6967 6874 203d 2030 2e39  625, right = 0.9
+0000baa0: 352c 200d 0a20 2020 2020 2020 2020 2020  5, ..           
+0000bab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bac0: 2020 2020 2020 2020 2020 2020 7773 7061              wspa
+0000bad0: 6365 203d 2030 2e31 3229 0d0a 2020 2020  ce = 0.12)..    
+0000bae0: 6669 672c 2061 7865 7320 3d20 706c 742e  fig, axes = plt.
+0000baf0: 7375 6270 6c6f 7473 2831 2c20 6c65 6e28  subplots(1, len(
+0000bb00: 636c 6673 292c 2066 6967 7369 7a65 203d  clfs), figsize =
+0000bb10: 2832 322c 2036 2929 0d0a 2020 2020 6669  (22, 6))..    fi
+0000bb20: 672e 7375 6270 6c6f 7473 5f61 646a 7573  g.subplots_adjus
+0000bb30: 7428 2a2a 7375 6270 6c6f 745f 6b77 7329  t(**subplot_kws)
+0000bb40: 0d0a 2020 2020 6966 206e 6f74 2069 735f  ..    if not is_
+0000bb50: 6974 6572 6162 6c65 2861 7865 7329 3a20  iterable(axes): 
+0000bb60: 0d0a 2020 2020 2020 2061 7865 7320 3d5b  ..       axes =[
+0000bb70: 6178 6573 5d20 0d0a 2020 2020 666f 7220  axes] ..    for 
+0000bb80: 6b6b 2c20 286d 6f64 656c 202c 206d 6e61  kk, (model , mna
+0000bb90: 6d65 2920 696e 2065 6e75 6d65 7261 7465  me) in enumerate
+0000bba0: 287a 6970 2863 6c66 732c 206d 6f64 656c  (zip(clfs, model
+0000bbb0: 5f6e 616d 6573 2029 293a 200d 0a20 2020  _names )): ..   
+0000bbc0: 2020 2020 2079 7072 6564 203d 206d 6f64       ypred = mod
+0000bbd0: 656c 2e70 7265 6469 6374 2858 7429 0d0a  el.predict(Xt)..
+0000bbe0: 2020 2020 2020 2020 6966 2070 6b67 2069          if pkg i
+0000bbf0: 6e20 2827 736b 6c65 6172 6e27 2c20 2773  n ('sklearn', 's
+0000bc00: 6369 6b69 742d 6c65 6172 6e27 293a 200d  cikit-learn'): .
+0000bc10: 0a20 2020 2020 2020 2020 2020 2070 6c6f  .            plo
+0000bc20: 745f 636f 6e66 7573 696f 6e5f 6d61 7472  t_confusion_matr
+0000bc30: 6978 2879 742c 2079 7072 6564 2c20 616e  ix(yt, ypred, an
+0000bc40: 6e6f 7420 3d61 6e6e 6f74 202c 2061 7820  not =annot , ax 
+0000bc50: 3d20 6178 6573 5b6b 6b5d 2c20 0d0a 2020  = axes[kk], ..  
+0000bc60: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
+0000bc70: 726d 616c 697a 653d 206e 6f72 6d61 6c69  rmalize= normali
+0000bc80: 7a65 202c 2073 616d 706c 655f 7765 6967  ze , sample_weig
+0000bc90: 6874 3d20 7361 6d70 6c65 5f77 6569 6768  ht= sample_weigh
+0000bca0: 7420 2920 0d0a 2020 2020 2020 2020 2020  t ) ..          
+0000bcb0: 2020 6178 6573 5b6b 6b5d 2e73 6574 5f74    axes[kk].set_t
+0000bcc0: 6974 6c65 2028 6d6e 616d 6529 0d0a 2020  itle (mname)..  
+0000bcd0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000bce0: 2020 2020 656c 6966 2070 6b67 2069 6e20      elif pkg in 
+0000bcf0: 2827 7965 6c6c 6f77 6272 6963 6b27 2c20  ('yellowbrick', 
+0000bd00: 2779 6227 293a 0d0a 2020 2020 2020 2020  'yb'):..        
+0000bd10: 2020 2020 706c 6f74 5f79 625f 636f 6e66      plot_yb_conf
+0000bd20: 7573 696f 6e5f 6d61 7472 6978 280d 0a20  usion_matrix(.. 
+0000bd30: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000bd40: 6f64 656c 2c20 5874 2c20 7974 2c20 6178  odel, Xt, yt, ax
+0000bd50: 3d61 7865 735b 6b6b 5d2c 2065 6e63 6f64  =axes[kk], encod
+0000bd60: 6572 203d 656e 636f 6465 7220 290d 0a20  er =encoder ).. 
+0000bd70: 2020 2069 6620 7361 7665 6669 6720 6973     if savefig is
+0000bd80: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+0000bd90: 2020 2020 706c 742e 7361 7665 6669 6728      plt.savefig(
+0000bda0: 7361 7665 6669 672c 2064 7069 203d 2033  savefig, dpi = 3
+0000bdb0: 3030 2029 0d0a 2020 2020 2020 2020 0d0a  00 )..        ..
+0000bdc0: 2020 2020 706c 742e 636c 6f73 6520 2829      plt.close ()
+0000bdd0: 2069 6620 7361 7665 6669 6720 6973 206e   if savefig is n
+0000bde0: 6f74 204e 6f6e 6520 656c 7365 2070 6c74  ot None else plt
+0000bdf0: 2e73 686f 7728 2920 0d0a 2020 2020 0d0a  .show() ..    ..
+0000be00: 6465 6620 706c 6f74 5f6c 6561 726e 696e  def plot_learnin
+0000be10: 675f 6375 7276 6573 280d 0a20 2020 206d  g_curves(..    m
+0000be20: 6f64 656c 732c 200d 0a20 2020 2058 202c  odels, ..    X ,
+0000be30: 0d0a 2020 2020 792c 200d 0a20 2020 202a  ..    y, ..    *
+0000be40: 2c20 0d0a 2020 2020 6376 203d 4e6f 6e65  , ..    cv =None
+0000be50: 2c20 0d0a 2020 2020 7472 6169 6e5f 7369  , ..    train_si
+0000be60: 7a65 733d 204e 6f6e 652c 200d 0a20 2020  zes= None, ..   
+0000be70: 2062 6173 656c 696e 655f 7363 6f72 6520   baseline_score 
+0000be80: 3d30 2e34 2c0d 0a20 2020 2063 6f6e 7665  =0.4,..    conve
+0000be90: 7267 656e 6365 5f6c 696e 6520 3d54 7275  rgence_line =Tru
+0000bea0: 652c 200d 0a20 2020 2066 6967 5f73 697a  e, ..    fig_siz
+0000beb0: 653d 2832 302c 2036 292c 0d0a 2020 2020  e=(20, 6),..    
+0000bec0: 736e 735f 7374 796c 6520 3d4e 6f6e 652c  sns_style =None,
+0000bed0: 200d 0a20 2020 2073 6176 6566 6967 3d4e   ..    savefig=N
+0000bee0: 6f6e 652c 200d 0a20 2020 2073 6574 5f6c  one, ..    set_l
+0000bef0: 6567 656e 643d 5472 7565 2c20 0d0a 2020  egend=True, ..  
+0000bf00: 2020 7375 6270 6c6f 745f 6b77 733d 4e6f    subplot_kws=No
+0000bf10: 6e65 2c0d 0a20 2020 202a 2a6b 7773 0d0a  ne,..    **kws..
+0000bf20: 2020 2020 293a 200d 0a20 2020 2022 2222      ): ..    """
+0000bf30: 200d 0a20 2020 2048 6f72 697a 6f6e 7461   ..    Horizonta
+0000bf40: 6c6c 7920 7669 7375 616c 697a 6174 696f  lly visualizatio
+0000bf50: 6e20 6f66 206d 756c 7469 706c 6520 6d6f  n of multiple mo
+0000bf60: 6465 6c73 206c 6561 726e 696e 6720 6375  dels learning cu
+0000bf70: 7276 6573 2e20 0d0a 2020 2020 0d0a 2020  rves. ..    ..  
+0000bf80: 2020 4465 7465 726d 696e 6573 2063 726f    Determines cro
+0000bf90: 7373 2d76 616c 6964 6174 6564 2074 7261  ss-validated tra
+0000bfa0: 696e 696e 6720 616e 6420 7465 7374 2073  ining and test s
+0000bfb0: 636f 7265 7320 666f 7220 6469 6666 6572  cores for differ
+0000bfc0: 656e 7420 7472 6169 6e69 6e67 0d0a 2020  ent training..  
+0000bfd0: 2020 7365 7420 7369 7a65 732e 0d0a 2020    set sizes...  
+0000bfe0: 2020 0d0a 2020 2020 5061 7261 6d65 7465    ..    Paramete
+0000bff0: 7273 200d 0a20 2020 202d 2d2d 2d2d 2d2d  rs ..    -------
+0000c000: 2d2d 2d0d 0a20 2020 206d 6f64 656c 733a  ---..    models:
+0000c010: 206c 6973 7420 6f72 2065 7374 696d 6174   list or estimat
+0000c020: 6f72 7320 200d 0a20 2020 2020 2020 2041  ors  ..        A
+0000c030: 6e20 6573 7469 6d61 746f 7220 696e 7374  n estimator inst
+0000c040: 616e 6365 206f 7220 6e6f 7420 7468 6174  ance or not that
+0000c050: 2069 6d70 6c65 6d65 6e74 7320 6066 6974   implements `fit
+0000c060: 6020 616e 6420 6070 7265 6469 6374 6020  ` and `predict` 
+0000c070: 0d0a 2020 2020 2020 2020 6d65 7468 6f64  ..        method
+0000c080: 7320 7768 6963 6820 7769 6c6c 2062 6520  s which will be 
+0000c090: 636c 6f6e 6564 2066 6f72 2065 6163 6820  cloned for each 
+0000c0a0: 7661 6c69 6461 7469 6f6e 2e20 0d0a 2020  validation. ..  
+0000c0b0: 2020 2020 2020 0d0a 2020 2020 5820 3a20        ..    X : 
+0000c0c0: 6172 7261 792d 6c69 6b65 206f 6620 7368  array-like of sh
+0000c0d0: 6170 6520 286e 5f73 616d 706c 6573 2c20  ape (n_samples, 
+0000c0e0: 6e5f 6665 6174 7572 6573 290d 0a20 2020  n_features)..   
+0000c0f0: 2020 2020 2054 7261 696e 696e 6720 7665       Training ve
+0000c100: 6374 6f72 2c20 7768 6572 6520 606e 5f73  ctor, where `n_s
+0000c110: 616d 706c 6573 6020 6973 2074 6865 206e  amples` is the n
+0000c120: 756d 6265 7220 6f66 2073 616d 706c 6573  umber of samples
+0000c130: 2061 6e64 0d0a 2020 2020 2020 2020 606e   and..        `n
+0000c140: 5f66 6561 7475 7265 7360 2069 7320 7468  _features` is th
+0000c150: 6520 6e75 6d62 6572 206f 6620 6665 6174  e number of feat
+0000c160: 7572 6573 2e0d 0a0d 0a20 2020 2079 203a  ures.....    y :
+0000c170: 2061 7272 6179 2d6c 696b 6520 6f66 2073   array-like of s
+0000c180: 6861 7065 2028 6e5f 7361 6d70 6c65 732c  hape (n_samples,
+0000c190: 2920 6f72 2028 6e5f 7361 6d70 6c65 732c  ) or (n_samples,
+0000c1a0: 206e 5f6f 7574 7075 7473 290d 0a20 2020   n_outputs)..   
+0000c1b0: 2020 2020 2054 6172 6765 7420 7265 6c61       Target rela
+0000c1c0: 7469 7665 2074 6f20 5820 666f 7220 636c  tive to X for cl
+0000c1d0: 6173 7369 6669 6361 7469 6f6e 206f 7220  assification or 
+0000c1e0: 7265 6772 6573 7369 6f6e 3b0d 0a20 2020  regression;..   
+0000c1f0: 2020 2020 204e 6f6e 6520 666f 7220 756e       None for un
+0000c200: 7375 7065 7276 6973 6564 206c 6561 726e  supervised learn
+0000c210: 696e 672e 0d0a 2020 200d 0a20 2020 2063  ing...   ..    c
+0000c220: 7620 3a20 696e 742c 2063 726f 7373 2d76  v : int, cross-v
+0000c230: 616c 6964 6174 696f 6e20 6765 6e65 7261  alidation genera
+0000c240: 746f 7220 6f72 2061 6e20 6974 6572 6162  tor or an iterab
+0000c250: 6c65 2c20 6465 6661 756c 743d 4e6f 6e65  le, default=None
+0000c260: 0d0a 2020 2020 2020 2020 4465 7465 726d  ..        Determ
+0000c270: 696e 6573 2074 6865 2063 726f 7373 2d76  ines the cross-v
+0000c280: 616c 6964 6174 696f 6e20 7370 6c69 7474  alidation splitt
+0000c290: 696e 6720 7374 7261 7465 6779 2e0d 0a20  ing strategy... 
+0000c2a0: 2020 2020 2020 2050 6f73 7369 626c 6520         Possible 
+0000c2b0: 696e 7075 7473 2066 6f72 2063 7620 6172  inputs for cv ar
+0000c2c0: 653a 0d0a 0d0a 2020 2020 2020 2020 2d20  e:....        - 
+0000c2d0: 4e6f 6e65 2c20 746f 2075 7365 2074 6865  None, to use the
+0000c2e0: 2064 6566 6175 6c74 2035 2d66 6f6c 6420   default 5-fold 
+0000c2f0: 6372 6f73 7320 7661 6c69 6461 7469 6f6e  cross validation
+0000c300: 2c0d 0a20 2020 2020 2020 202d 2069 6e74  ,..        - int
+0000c310: 2c20 746f 2073 7065 6369 6679 2074 6865  , to specify the
+0000c320: 206e 756d 6265 7220 6f66 2066 6f6c 6473   number of folds
+0000c330: 2069 6e20 6120 6028 5374 7261 7469 6669   in a `(Stratifi
+0000c340: 6564 294b 466f 6c64 602c 0d0a 2020 2020  ed)KFold`,..    
+0000c350: 2020 2020 2d20 3a74 6572 6d3a 6043 5620      - :term:`CV 
+0000c360: 7370 6c69 7474 6572 602c 0d0a 2020 2020  splitter`,..    
+0000c370: 2020 2020 2d20 416e 2069 7465 7261 626c      - An iterabl
+0000c380: 6520 7969 656c 6469 6e67 2028 7472 6169  e yielding (trai
+0000c390: 6e2c 2074 6573 7429 2073 706c 6974 7320  n, test) splits 
+0000c3a0: 6173 2061 7272 6179 7320 6f66 2069 6e64  as arrays of ind
+0000c3b0: 6963 6573 2e0d 0a0d 0a20 2020 2020 2020  ices.....       
+0000c3c0: 2046 6f72 2069 6e74 2f4e 6f6e 6520 696e   For int/None in
+0000c3d0: 7075 7473 2c20 6966 2074 6865 2065 7374  puts, if the est
+0000c3e0: 696d 6174 6f72 2069 7320 6120 636c 6173  imator is a clas
+0000c3f0: 7369 6669 6572 2061 6e64 2060 6079 6060  sifier and ``y``
+0000c400: 2069 730d 0a20 2020 2020 2020 2065 6974   is..        eit
+0000c410: 6865 7220 6269 6e61 7279 206f 7220 6d75  her binary or mu
+0000c420: 6c74 6963 6c61 7373 2c20 3a63 6c61 7373  lticlass, :class
+0000c430: 3a60 5374 7261 7469 6669 6564 4b46 6f6c  :`StratifiedKFol
+0000c440: 6460 2069 7320 7573 6564 2e20 496e 2061  d` is used. In a
+0000c450: 6c6c 0d0a 2020 2020 2020 2020 6f74 6865  ll..        othe
+0000c460: 7220 6361 7365 732c 203a 636c 6173 733a  r cases, :class:
+0000c470: 604b 466f 6c64 6020 6973 2075 7365 642e  `KFold` is used.
+0000c480: 2054 6865 7365 2073 706c 6974 7465 7273   These splitters
+0000c490: 2061 7265 2069 6e73 7461 6e74 6961 7465   are instantiate
+0000c4a0: 640d 0a20 2020 2020 2020 2077 6974 6820  d..        with 
+0000c4b0: 6073 6875 6666 6c65 3d46 616c 7365 6020  `shuffle=False` 
+0000c4c0: 736f 2074 6865 2073 706c 6974 7320 7769  so the splits wi
+0000c4d0: 6c6c 2062 6520 7468 6520 7361 6d65 2061  ll be the same a
+0000c4e0: 6372 6f73 7320 6361 6c6c 732e 0d0a 0d0a  cross calls.....
+0000c4f0: 2020 2020 2020 2020 5265 6665 7220 3a72          Refer :r
+0000c500: 6566 3a60 5573 6572 2047 7569 6465 203c  ef:`User Guide <
+0000c510: 6372 6f73 735f 7661 6c69 6461 7469 6f6e  cross_validation
+0000c520: 3e60 2066 6f72 2074 6865 2076 6172 696f  >` for the vario
+0000c530: 7573 0d0a 2020 2020 2020 2020 6372 6f73  us..        cros
+0000c540: 732d 7661 6c69 6461 7469 6f6e 2073 7472  s-validation str
+0000c550: 6174 6567 6965 7320 7468 6174 2063 616e  ategies that can
+0000c560: 2062 6520 7573 6564 2068 6572 652e 0d0a   be used here...
+0000c570: 0d0a 2020 2020 2020 2020 6060 6376 6060  ..        ``cv``
+0000c580: 2064 6566 6175 6c74 2076 616c 7565 2069   default value i
+0000c590: 6620 4e6f 6e65 2063 6861 6e67 6564 2066  f None changed f
+0000c5a0: 726f 6d20 332d 666f 6c64 2074 6f20 342d  rom 3-fold to 4-
+0000c5b0: 666f 6c64 2e0d 0a20 2020 2020 2020 200d  fold...        .
+0000c5c0: 0a20 2020 2020 7472 6169 6e5f 7369 7a65  .     train_size
+0000c5d0: 7320 3a20 6172 7261 792d 6c69 6b65 206f  s : array-like o
+0000c5e0: 6620 7368 6170 6520 286e 5f74 6963 6b73  f shape (n_ticks
+0000c5f0: 2c29 2c20 5c0d 0a20 2020 2020 2020 2020  ,), \..         
+0000c600: 2020 2020 6465 6661 756c 743d 6e70 2e6c      default=np.l
+0000c610: 696e 7370 6163 6528 302e 312c 2031 2c20  inspace(0.1, 1, 
+0000c620: 3530 290d 0a20 2020 2020 2020 2020 5265  50)..         Re
+0000c630: 6c61 7469 7665 206f 7220 6162 736f 6c75  lative or absolu
+0000c640: 7465 206e 756d 6265 7273 206f 6620 7472  te numbers of tr
+0000c650: 6169 6e69 6e67 2065 7861 6d70 6c65 7320  aining examples 
+0000c660: 7468 6174 2077 696c 6c20 6265 2075 7365  that will be use
+0000c670: 6420 746f 0d0a 2020 2020 2020 2020 2067  d to..         g
+0000c680: 656e 6572 6174 6520 7468 6520 6c65 6172  enerate the lear
+0000c690: 6e69 6e67 2063 7572 7665 2e20 4966 2074  ning curve. If t
+0000c6a0: 6865 2064 7479 7065 2069 7320 666c 6f61  he dtype is floa
+0000c6b0: 742c 2069 7420 6973 2072 6567 6172 6465  t, it is regarde
+0000c6c0: 6420 6173 2061 0d0a 2020 2020 2020 2020  d as a..        
+0000c6d0: 2066 7261 6374 696f 6e20 6f66 2074 6865   fraction of the
+0000c6e0: 206d 6178 696d 756d 2073 697a 6520 6f66   maximum size of
+0000c6f0: 2074 6865 2074 7261 696e 696e 6720 7365   the training se
+0000c700: 7420 2874 6861 7420 6973 2064 6574 6572  t (that is deter
+0000c710: 6d69 6e65 640d 0a20 2020 2020 2020 2020  mined..         
+0000c720: 6279 2074 6865 2073 656c 6563 7465 6420  by the selected 
+0000c730: 7661 6c69 6461 7469 6f6e 206d 6574 686f  validation metho
+0000c740: 6429 2c20 692e 652e 2069 7420 6861 7320  d), i.e. it has 
+0000c750: 746f 2062 6520 7769 7468 696e 2028 302c  to be within (0,
+0000c760: 2031 5d2e 0d0a 2020 2020 2020 2020 204f   1]...         O
+0000c770: 7468 6572 7769 7365 2069 7420 6973 2069  therwise it is i
+0000c780: 6e74 6572 7072 6574 6564 2061 7320 6162  nterpreted as ab
+0000c790: 736f 6c75 7465 2073 697a 6573 206f 6620  solute sizes of 
+0000c7a0: 7468 6520 7472 6169 6e69 6e67 2073 6574  the training set
+0000c7b0: 732e 0d0a 2020 2020 2020 2020 204e 6f74  s...         Not
+0000c7c0: 6520 7468 6174 2066 6f72 2063 6c61 7373  e that for class
+0000c7d0: 6966 6963 6174 696f 6e20 7468 6520 6e75  ification the nu
+0000c7e0: 6d62 6572 206f 6620 7361 6d70 6c65 7320  mber of samples 
+0000c7f0: 7573 7561 6c6c 7920 6861 7665 2074 6f0d  usually have to.
+0000c800: 0a20 2020 2020 2020 2020 6265 2062 6967  .         be big
+0000c810: 2065 6e6f 7567 6820 746f 2063 6f6e 7461   enough to conta
+0000c820: 696e 2061 7420 6c65 6173 7420 6f6e 6520  in at least one 
+0000c830: 7361 6d70 6c65 2066 726f 6d20 6561 6368  sample from each
+0000c840: 2063 6c61 7373 2e0d 0a20 2020 2020 2020   class...       
+0000c850: 2020 0d0a 2020 2020 6261 7365 6c69 6e65    ..    baseline
+0000c860: 5f73 636f 7265 3a20 666c 6f61 746d 2064  _score: floatm d
+0000c870: 6566 6175 6c74 3d2e 3420 0d0a 2020 2020  efault=.4 ..    
+0000c880: 2020 2020 6261 7365 2073 636f 7265 2074      base score t
+0000c890: 6f20 7374 6172 7420 636f 756e 7469 6e67  o start counting
+0000c8a0: 2069 6e20 7363 6f72 6520 792d 6178 6973   in score y-axis
+0000c8b0: 2020 2873 636f 7265 290d 0a20 2020 2020    (score)..     
+0000c8c0: 2020 200d 0a20 2020 2063 6f6e 7665 7267     ..    converg
+0000c8d0: 656e 6365 5f6c 696e 653a 2062 6f6f 6c2c  ence_line: bool,
+0000c8e0: 2064 6566 6175 6c74 3d54 7275 6520 0d0a   default=True ..
+0000c8f0: 2020 2020 2020 2020 6469 7370 6c61 7920          display 
+0000c900: 7468 6520 636f 6e76 6572 6765 6e63 6520  the convergence 
+0000c910: 6c69 6e65 206f 7220 6e6f 7420 7468 6174  line or not that
+0000c920: 2069 6e64 6963 6174 6520 7468 6520 6c65   indicate the le
+0000c930: 7665 6c20 6f66 2062 6961 7320 0d0a 2020  vel of bias ..  
+0000c940: 2020 2020 2020 6265 7477 6565 6e20 7468        between th
+0000c950: 6520 7472 6169 6e69 6e67 2061 6e64 2076  e training and v
+0000c960: 616c 6964 6174 696f 6e20 6375 7276 652e  alidation curve.
+0000c970: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0000c980: 2066 6967 5f73 697a 6520 3a20 7475 706c   fig_size : tupl
+0000c990: 6520 2877 6964 7468 2c20 6865 6967 6874  e (width, height
+0000c9a0: 292c 2064 6566 6175 6c74 203d 2831 342c  ), default =(14,
+0000c9b0: 2036 290d 0a20 2020 2020 2020 2074 6865   6)..        the
+0000c9c0: 206d 6174 706c 6f74 6c69 6220 6669 6775   matplotlib figu
+0000c9d0: 7265 2073 697a 6520 6769 7665 6e20 6173  re size given as
+0000c9e0: 2061 2074 7570 6c65 206f 6620 7769 6474   a tuple of widt
+0000c9f0: 6820 616e 6420 6865 6967 6874 0d0a 2020  h and height..  
+0000ca00: 2020 2020 2020 0d0a 2020 2020 736e 735f        ..    sns_
+0000ca10: 7374 796c 653a 2073 7472 2c20 6f70 7469  style: str, opti
+0000ca20: 6f6e 616c 2c20 0d0a 2020 2020 2020 2020  onal, ..        
+0000ca30: 7468 6520 7365 6162 6f72 6e20 7374 796c  the seaborn styl
+0000ca40: 6520 2e20 0d0a 2020 2020 2020 2020 0d0a  e . ..        ..
+0000ca50: 2020 2020 7365 745f 6c65 6765 6e64 3a20      set_legend: 
+0000ca60: 626f 6f6c 2c20 6465 6661 756c 743d 5472  bool, default=Tr
+0000ca70: 7565 200d 0a20 2020 2020 2020 2064 6973  ue ..        dis
+0000ca80: 706c 6179 206c 6567 656e 6420 696e 2065  play legend in e
+0000ca90: 6163 6820 6669 6775 7265 2e20 4e6f 7465  ach figure. Note
+0000caa0: 2074 6865 2064 6566 6175 6c74 206c 6f63   the default loc
+0000cab0: 6174 696f 6e20 6f66 2074 6865 200d 0a20  ation of the .. 
+0000cac0: 2020 2020 2020 206c 6567 656e 6420 6973         legend is
+0000cad0: 2027 6265 7374 2720 6672 6f6d 203a 6675   'best' from :fu
+0000cae0: 6e63 3a60 7e6d 6174 706c 6f74 6c69 622e  nc:`~matplotlib.
+0000caf0: 4178 6573 2e6c 6567 656e 6460 0d0a 2020  Axes.legend`..  
+0000cb00: 2020 2020 2020 0d0a 2020 2020 7375 6270        ..    subp
+0000cb10: 6c6f 745f 6b77 733a 2064 6963 742c 2064  lot_kws: dict, d
+0000cb20: 6566 6175 6c74 2069 7320 5c0d 0a20 2020  efault is \..   
+0000cb30: 2020 2020 2064 6963 7428 6c65 6674 3d30       dict(left=0
+0000cb40: 2e30 3632 352c 2072 6967 6874 203d 2030  .0625, right = 0
+0000cb50: 2e39 352c 2077 7370 6163 6520 3d20 302e  .95, wspace = 0.
+0000cb60: 3129 200d 0a20 2020 2020 2020 2074 6865  1) ..        the
+0000cb70: 2073 7562 706c 6f74 206b 6579 776f 7264   subplot keyword
+0000cb80: 7320 6172 6775 6d65 6e74 7320 7061 7373  s arguments pass
+0000cb90: 6564 2074 6f20 0d0a 2020 2020 2020 2020  ed to ..        
+0000cba0: 3a66 756e 633a 606d 6174 706c 6f74 6c69  :func:`matplotli
+0000cbb0: 622e 7375 6270 6c6f 7473 5f61 646a 7573  b.subplots_adjus
+0000cbc0: 7460 200d 0a20 2020 206b 7773 3a20 6469  t` ..    kws: di
+0000cbd0: 6374 2c20 0d0a 2020 2020 2020 2020 6b65  ct, ..        ke
+0000cbe0: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
+0000cbf0: 7061 7373 6564 2074 6f20 3a66 756e 633a  passed to :func:
+0000cc00: 6073 6b6c 6561 726e 2e6d 6f64 656c 5f73  `sklearn.model_s
+0000cc10: 656c 6563 7469 6f6e 2e6c 6561 726e 696e  election.learnin
+0000cc20: 675f 6375 7276 6560 0d0a 2020 2020 2020  g_curve`..      
+0000cc30: 2020 0d0a 2020 2020 4578 616d 706c 6573    ..    Examples
+0000cc40: 200d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d   ..    ---------
+0000cc50: 0d0a 2020 2020 2831 2920 2d3e 2070 6c6f  ..    (1) -> plo
+0000cc60: 7420 7669 6120 6120 6d65 7461 6573 7469  t via a metaesti
+0000cc70: 6d61 746f 7220 616c 7265 6164 7920 6372  mator already cr
+0000cc80: 6f73 732d 7661 6c69 6461 7465 642e 200d  oss-validated. .
+0000cc90: 0a20 2020 200d 0a20 2020 203e 3e3e 2066  .    ..    >>> f
+0000cca0: 726f 6d20 7761 7465 782e 6d6f 6465 6c73  rom watex.models
+0000ccb0: 2e70 7265 6d6f 6465 6c73 2069 6d70 6f72  .premodels impor
+0000ccc0: 7420 7020 0d0a 2020 2020 3e3e 3e20 6672  t p ..    >>> fr
+0000ccd0: 6f6d 2077 6174 6578 2e64 6174 6173 6574  om watex.dataset
+0000cce0: 7320 696d 706f 7274 2066 6574 6368 5f64  s import fetch_d
+0000ccf0: 6174 6120 0d0a 2020 2020 3e3e 3e20 6672  ata ..    >>> fr
+0000cd00: 6f6d 2077 6174 6578 2e75 7469 6c73 2e70  om watex.utils.p
+0000cd10: 6c6f 7475 7469 6c73 2069 6d70 6f72 7420  lotutils import 
+0000cd20: 706c 6f74 5f6c 6561 726e 696e 675f 6375  plot_learning_cu
+0000cd30: 7276 6573 0d0a 2020 2020 3e3e 3e20 582c  rves..    >>> X,
+0000cd40: 2079 203d 2066 6574 6368 5f64 6174 6120   y = fetch_data 
+0000cd50: 2827 6261 676f 7565 2070 7265 7061 7265  ('bagoue prepare
+0000cd60: 6427 2920 2320 7969 656c 6473 2061 2073  d') # yields a s
+0000cd70: 7061 7273 6520 6d61 7472 6978 200d 0a20  parse matrix .. 
+0000cd80: 2020 203e 3e3e 2023 206c 6574 2063 6f6c     >>> # let col
+0000cd90: 6c65 6374 2030 3420 6573 7469 6d61 746f  lect 04 estimato
+0000cda0: 7273 2061 6c72 6561 6479 2063 726f 7373  rs already cross
+0000cdb0: 2d76 616c 6964 6174 6564 2066 726f 6d20  -validated from 
+0000cdc0: 5356 4d73 0d0a 2020 2020 3e3e 3e20 6d6f  SVMs..    >>> mo
+0000cdd0: 6465 6c73 203d 205b 2070 2e53 564d 2e6c  dels = [ p.SVM.l
+0000cde0: 696e 6561 7220 2c20 702e 5356 4d2e 7262  inear , p.SVM.rb
+0000cdf0: 6620 2c20 702e 5356 4d2e 7369 676d 6f69  f , p.SVM.sigmoi
+0000ce00: 6420 2c20 702e 5356 4d2e 706f 6c79 205d  d , p.SVM.poly ]
+0000ce10: 0d0a 2020 2020 3e3e 3e20 706c 6f74 5f6c  ..    >>> plot_l
+0000ce20: 6561 726e 696e 675f 6375 7276 6573 2028  earning_curves (
+0000ce30: 6d6f 6465 6c73 2c20 582c 2079 2c20 6376  models, X, y, cv
+0000ce40: 3d34 2c20 736e 735f 7374 796c 6520 3d20  =4, sns_style = 
+0000ce50: 2764 6172 6b67 7269 6427 290d 0a20 2020  'darkgrid')..   
+0000ce60: 200d 0a20 2020 2028 3229 202d 3e20 706c   ..    (2) -> pl
+0000ce70: 6f74 2077 6974 6820 206d 756c 7469 706c  ot with  multipl
+0000ce80: 6573 206d 6f64 656c 7320 6e6f 7420 6372  es models not cr
+0000ce90: 6f73 7376 616c 6964 6174 6564 2079 6574  ossvalidated yet
+0000cea0: 2e0d 0a20 2020 200d 0a20 2020 203e 3e3e  ...    ..    >>>
+0000ceb0: 2066 726f 6d20 7761 7465 782e 6578 6c69   from watex.exli
+0000cec0: 622e 736b 6c65 6172 6e20 696d 706f 7274  b.sklearn import
+0000ced0: 2028 4c6f 6769 7374 6963 5265 6772 6573   (LogisticRegres
+0000cee0: 7369 6f6e 2c20 0d0a 2020 2020 2020 2020  sion, ..        
 0000cef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cf00: 5356 4320 2c20 4b4e 6569 6768 626f 7273  SVC , KNeighbors
-0000cf10: 436c 6173 7369 6669 6572 200d 0a20 2020  Classifier ..   
-0000cf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cf10: 2052 616e 646f 6d46 6f72 6573 7443 6c61   RandomForestCla
+0000cf20: 7373 6966 6965 722c 200d 0a20 2020 2020  ssifier, ..     
 0000cf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cf40: 2020 2020 2020 290d 0a20 2020 203e 3e3e        )..    >>>
-0000cf50: 206d 6f64 656c 7320 3d5b 4c6f 6769 7374   models =[Logist
-0000cf60: 6963 5265 6772 6573 7369 6f6e 2829 2c20  icRegression(), 
-0000cf70: 5261 6e64 6f6d 466f 7265 7374 436c 6173  RandomForestClas
-0000cf80: 7369 6669 6572 2829 2c20 5356 4328 2920  sifier(), SVC() 
-0000cf90: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0000cfa0: 2020 2020 4b4e 6569 6768 626f 7273 436c      KNeighborsCl
-0000cfb0: 6173 7369 6669 6572 2829 205d 0d0a 2020  assifier() ]..  
-0000cfc0: 2020 3e3e 3e20 706c 6f74 5f6c 6561 726e    >>> plot_learn
-0000cfd0: 696e 675f 6375 7276 6573 2028 6d6f 6465  ing_curves (mode
-0000cfe0: 6c73 2c20 582c 2079 2c20 6376 3d34 2c20  ls, X, y, cv=4, 
-0000cff0: 736e 735f 7374 796c 6520 3d20 2764 6172  sns_style = 'dar
-0000d000: 6b67 7269 6427 290d 0a20 2020 200d 0a20  kgrid')..    .. 
-0000d010: 2020 2022 2222 0d0a 2020 2020 6966 206e     """..    if n
-0000d020: 6f74 2069 735f 6974 6572 6162 6c65 286d  ot is_iterable(m
-0000d030: 6f64 656c 7329 3a20 0d0a 2020 2020 2020  odels): ..      
-0000d040: 2020 6d6f 6465 6c73 203d 5b6d 6f64 656c    models =[model
-0000d050: 735d 0d0a 2020 2020 0d0a 2020 2020 7375  s]..    ..    su
-0000d060: 6270 6c6f 745f 6b77 7320 3d20 7375 6270  bplot_kws = subp
-0000d070: 6c6f 745f 6b77 7320 6f72 2020 6469 6374  lot_kws or  dict
-0000d080: 280d 0a20 2020 2020 2020 206c 6566 743d  (..        left=
-0000d090: 302e 3036 3235 2c20 7269 6768 7420 3d20  0.0625, right = 
-0000d0a0: 302e 3935 2c20 7773 7061 6365 203d 2030  0.95, wspace = 0
-0000d0b0: 2e31 2920 0d0a 2020 2020 7472 6169 6e5f  .1) ..    train_
-0000d0c0: 7369 7a65 7320 3d20 7472 6169 6e5f 7369  sizes = train_si
-0000d0d0: 7a65 7320 6f72 206e 702e 6c69 6e73 7061  zes or np.linspa
-0000d0e0: 6365 2830 2e31 2c20 312c 2035 3029 0d0a  ce(0.1, 1, 50)..
-0000d0f0: 2020 2020 6376 203d 2063 7620 6f72 2034      cv = cv or 4
-0000d100: 200d 0a20 2020 2069 6620 2820 0d0a 2020   ..    if ( ..  
-0000d110: 2020 2020 2020 6261 7365 6c69 6e65 5f73        baseline_s
-0000d120: 636f 7265 203e 3d31 200d 0a20 2020 2020  core >=1 ..     
-0000d130: 2020 2061 6e64 2062 6173 656c 696e 655f     and baseline_
-0000d140: 7363 6f72 6520 3c20 3020 0d0a 2020 2020  score < 0 ..    
-0000d150: 2020 2020 293a 200d 0a20 2020 2020 2020      ): ..       
-0000d160: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0000d170: 7220 2822 5363 6f72 6520 666f 7220 7468  r ("Score for th
-0000d180: 6520 6261 7365 206c 696e 6520 6d75 7374  e base line must
-0000d190: 2062 6520 6c65 7373 2031 2061 6e64 2022   be less 1 and "
-0000d1a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d1b0: 2020 2020 2020 2020 2020 2020 6622 6772              f"gr
-0000d1c0: 6561 7465 7220 7468 616e 2030 3b20 676f  eater than 0; go
-0000d1d0: 7420 7b62 6173 656c 696e 655f 7363 6f72  t {baseline_scor
-0000d1e0: 657d 2229 0d0a 2020 2020 0d0a 2020 2020  e}")..    ..    
-0000d1f0: 6966 2073 6e73 5f73 7479 6c65 3a20 0d0a  if sns_style: ..
-0000d200: 2020 2020 2020 2020 5f73 6574 5f73 6e73          _set_sns
-0000d210: 5f73 7479 6c65 2028 736e 735f 7374 796c  _style (sns_styl
-0000d220: 6529 0d0a 2020 2020 2020 2020 0d0a 2020  e)..        ..  
-0000d230: 2020 6d6e 616d 6573 203d 205b 6765 745f    mnames = [get_
-0000d240: 6573 7469 6d61 746f 725f 6e61 6d65 286e  estimator_name(n
-0000d250: 2920 666f 7220 6e20 696e 206d 6f64 656c  ) for n in model
-0000d260: 735d 0d0a 0d0a 2020 2020 6669 672c 2061  s]....    fig, a
-0000d270: 7865 7320 3d20 706c 742e 7375 6270 6c6f  xes = plt.subplo
-0000d280: 7473 286e 726f 7773 3d31 2c20 6e63 6f6c  ts(nrows=1, ncol
-0000d290: 733d 6c65 6e28 6d6f 6465 6c73 292c 2066  s=len(models), f
-0000d2a0: 6967 7369 7a65 203d 6669 675f 7369 7a65  igsize =fig_size
-0000d2b0: 290d 0a20 2020 2023 2066 6f72 2063 6f6e  )..    # for con
-0000d2c0: 7369 7374 656e 6379 2c20 7075 7420 6178  sistency, put ax
-0000d2d0: 6573 206f 6e20 6c69 7374 2077 6865 6e20  es on list when 
-0000d2e0: 0d0a 2020 2020 2320 6120 7369 6e67 6c65  ..    # a single
-0000d2f0: 206d 6f64 656c 2069 7320 7072 6f76 6964   model is provid
-0000d300: 6564 200d 0a20 2020 2069 6620 6e6f 7420  ed ..    if not 
-0000d310: 6973 5f69 7465 7261 626c 6528 6178 6573  is_iterable(axes
-0000d320: 293a 200d 0a20 2020 2020 2020 2061 7865  ): ..        axe
-0000d330: 7320 3d5b 6178 6573 5d20 0d0a 2020 2020  s =[axes] ..    
-0000d340: 6669 672e 7375 6270 6c6f 7473 5f61 646a  fig.subplots_adj
-0000d350: 7573 7428 2a2a 7375 6270 6c6f 745f 6b77  ust(**subplot_kw
-0000d360: 7329 0d0a 0d0a 2020 2020 666f 7220 6b2c  s)....    for k,
-0000d370: 2028 6d6f 6465 6c2c 206e 616d 6529 2069   (model, name) i
-0000d380: 6e20 656e 756d 6572 6174 6528 7a69 7028  n enumerate(zip(
-0000d390: 6d6f 6465 6c73 2c20 206d 6e61 6d65 7329  models,  mnames)
-0000d3a0: 293a 0d0a 2020 2020 2020 2020 636d 6f64  ):..        cmod
-0000d3b0: 656c 203d 206d 6f64 656c 2e62 6573 745f  el = model.best_
-0000d3c0: 6573 7469 6d61 746f 725f 2020 6966 205f  estimator_  if _
-0000d3d0: 6973 5f63 726f 7373 5f76 616c 6964 6174  is_cross_validat
-0000d3e0: 6564 280d 0a20 2020 2020 2020 2020 2020  ed(..           
-0000d3f0: 206d 6f64 656c 2029 2065 6c73 6520 6d6f   model ) else mo
-0000d400: 6465 6c20 0d0a 2020 2020 2020 2020 6178  del ..        ax
-0000d410: 203d 206c 6973 7428 6178 6573 295b 6b5d   = list(axes)[k]
-0000d420: 0d0a 0d0a 2020 2020 2020 2020 4e2c 2074  ....        N, t
-0000d430: 7261 696e 5f6c 6320 2c20 7661 6c5f 6c63  rain_lc , val_lc
-0000d440: 203d 206c 6561 726e 696e 675f 6375 7276   = learning_curv
-0000d450: 6528 0d0a 2020 2020 2020 2020 2020 2020  e(..            
-0000d460: 636d 6f64 656c 202c 200d 0a20 2020 2020  cmodel , ..     
-0000d470: 2020 2020 2020 2058 2c20 0d0a 2020 2020         X, ..    
-0000d480: 2020 2020 2020 2020 792c 200d 0a20 2020          y, ..   
-0000d490: 2020 2020 2020 2020 2074 7261 696e 5f73           train_s
-0000d4a0: 697a 6573 203d 206e 702e 6c69 6e73 7061  izes = np.linspa
-0000d4b0: 6365 2830 2e31 2c20 312c 2035 3029 2c0d  ce(0.1, 1, 50),.
-0000d4c0: 0a20 2020 2020 2020 2020 2020 2063 763d  .            cv=
-0000d4d0: 6376 2c20 0d0a 2020 2020 2020 2020 2020  cv, ..          
-0000d4e0: 2020 2a2a 6b77 730d 0a20 2020 2020 2020    **kws..       
-0000d4f0: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-0000d500: 6178 2e70 6c6f 7428 4e2c 206e 702e 6d65  ax.plot(N, np.me
-0000d510: 616e 2874 7261 696e 5f6c 632c 2031 292c  an(train_lc, 1),
-0000d520: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000d530: 2020 2020 2020 636f 6c6f 7220 3d22 626c        color ="bl
-0000d540: 7565 222c 200d 0a20 2020 2020 2020 2020  ue", ..         
-0000d550: 2020 2020 2020 2020 2020 6c61 6265 6c20            label 
-0000d560: 3d22 7472 6169 6e20 7363 6f72 6522 0d0a  ="train score"..
-0000d570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d580: 2020 2029 0d0a 2020 2020 2020 2020 6178     )..        ax
-0000d590: 2e70 6c6f 7428 4e2c 206e 702e 6d65 616e  .plot(N, np.mean
-0000d5a0: 2876 616c 5f6c 632c 2031 292c 200d 0a20  (val_lc, 1), .. 
-0000d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d5c0: 2020 636f 6c6f 7220 3d22 7222 2c20 0d0a    color ="r", ..
-0000d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d5e0: 2020 206c 6162 656c 203d 2276 616c 6964     label ="valid
-0000d5f0: 6174 696f 6e20 7363 6f72 6522 0d0a 2020  ation score"..  
-0000d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d610: 2029 0d0a 2020 2020 2020 2020 6966 2063   )..        if c
-0000d620: 6f6e 7665 7267 656e 6365 5f6c 696e 6520  onvergence_line 
-0000d630: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-0000d640: 6178 2e68 6c69 6e65 7328 6e70 2e6d 6561  ax.hlines(np.mea
-0000d650: 6e28 5b74 7261 696e 5f6c 635b 2d31 5d2c  n([train_lc[-1],
-0000d660: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d680: 2020 2020 2076 616c 5f6c 635b 2d31 5d5d       val_lc[-1]]
-0000d690: 292c 200d 0a20 2020 2020 2020 2020 2020  ), ..           
-0000d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d6b0: 2020 2020 2020 4e5b 305d 2c20 4e5b 2d31        N[0], N[-1
-0000d6c0: 5d2c 200d 0a20 2020 2020 2020 2020 2020  ], ..           
-0000d6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d6e0: 2020 2020 2020 636f 6c6f 723d 226b 222c        color="k",
-0000d6f0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d710: 2020 2020 6c69 6e65 7374 796c 6520 3d22      linestyle ="
-0000d720: 2d2d 220d 0a20 2020 2020 2020 2020 2020  --"..           
-0000d730: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-0000d740: 0a20 2020 2020 2020 2061 782e 7365 745f  .        ax.set_
-0000d750: 796c 696d 2862 6173 656c 696e 655f 7363  ylim(baseline_sc
-0000d760: 6f72 652c 2031 290d 0a20 2020 2020 2020  ore, 1)..       
-0000d770: 2023 6178 5b6b 5d2e 7365 745f 786c 696d   #ax[k].set_xlim
-0000d780: 2028 4e5b 305d 2c20 4e5b 315d 290d 0a20   (N[0], N[1]).. 
-0000d790: 2020 2020 2020 2061 782e 7365 745f 786c         ax.set_xl
-0000d7a0: 6162 656c 2822 7472 6169 6e69 6e67 2073  abel("training s
-0000d7b0: 697a 6522 290d 0a20 2020 2020 2020 2061  ize")..        a
-0000d7c0: 782e 7365 745f 7469 746c 6528 6e61 6d65  x.set_title(name
-0000d7d0: 2c20 7369 7a65 3d31 3429 0d0a 2020 2020  , size=14)..    
-0000d7e0: 2020 2020 6966 2073 6574 5f6c 6567 656e      if set_legen
-0000d7f0: 643a 200d 0a20 2020 2020 2020 2020 2020  d: ..           
-0000d800: 2061 782e 6c65 6765 6e64 286c 6f63 3d27   ax.legend(loc='
-0000d810: 6265 7374 2729 0d0a 2020 2020 2320 666f  best')..    # fo
-0000d820: 7220 636f 6e73 6973 7465 6e63 790d 0a20  r consistency.. 
-0000d830: 2020 2061 7820 3d20 6c69 7374 2861 7865     ax = list(axe
-0000d840: 7329 5b30 5d0d 0a20 2020 2061 782e 7365  s)[0]..    ax.se
-0000d850: 745f 796c 6162 656c 2822 7363 6f72 6522  t_ylabel("score"
-0000d860: 290d 0a20 2020 200d 0a20 2020 2069 6620  )..    ..    if 
-0000d870: 7361 7665 6669 6720 6973 206e 6f74 204e  savefig is not N
-0000d880: 6f6e 653a 0d0a 2020 2020 2020 2020 706c  one:..        pl
-0000d890: 742e 7361 7665 6669 6728 7361 7665 6669  t.savefig(savefi
-0000d8a0: 672c 2064 7069 203d 2033 3030 2029 0d0a  g, dpi = 300 )..
-0000d8b0: 2020 2020 2020 2020 0d0a 2020 2020 706c          ..    pl
-0000d8c0: 742e 636c 6f73 6520 2829 2069 6620 7361  t.close () if sa
-0000d8d0: 7665 6669 6720 6973 206e 6f74 204e 6f6e  vefig is not Non
-0000d8e0: 6520 656c 7365 2070 6c74 2e73 686f 7728  e else plt.show(
-0000d8f0: 2920 0d0a 2020 2020 2020 2020 0d0a 6465  ) ..        ..de
-0000d900: 6620 706c 6f74 5f6e 6169 7665 5f64 656e  f plot_naive_den
-0000d910: 6472 6f67 7261 6d20 280d 0a20 2020 2020  drogram (..     
-0000d920: 2020 2058 2c20 0d0a 2020 2020 2020 2020     X, ..        
-0000d930: 2a79 626f 756e 6473 2c20 0d0a 2020 2020  *ybounds, ..    
-0000d940: 2020 2020 6669 675f 7369 7a65 203d 2028      fig_size = (
-0000d950: 3132 2c20 3520 292c 200d 0a20 2020 2020  12, 5 ), ..     
-0000d960: 2020 2073 6176 6566 6967 3d4e 6f6e 652c     savefig=None,
-0000d970: 2020 0d0a 2020 2020 2020 2020 2a2a 6b77    ..        **kw
-0000d980: 730d 0a20 2020 2020 2020 2029 3a20 0d0a  s..        ): ..
-0000d990: 2020 2020 2222 2220 5175 6963 6b20 706c      """ Quick pl
-0000d9a0: 6f74 2064 656e 6472 6f67 7261 6d20 7573  ot dendrogram us
-0000d9b0: 696e 6720 7468 6520 7761 7264 2063 6c75  ing the ward clu
-0000d9c0: 7374 6572 696e 6720 6675 6e63 7469 6f6e  stering function
-0000d9d0: 2066 726f 6d20 5363 6970 792e 0d0a 2020   from Scipy...  
-0000d9e0: 2020 0d0a 2020 2020 3a70 6172 616d 2058    ..    :param X
-0000d9f0: 3a20 6e64 6172 7261 7920 6f66 2073 6861  : ndarray of sha
-0000da00: 7065 2028 6e5f 7361 6d70 6c65 732c 206e  pe (n_samples, n
-0000da10: 5f66 6561 7475 7265 7329 200d 0a20 2020  _features) ..   
-0000da20: 2020 2020 2041 7272 6179 206f 6620 6665       Array of fe
-0000da30: 6174 7572 6573 200d 0a20 2020 203a 7061  atures ..    :pa
-0000da40: 7261 6d20 7962 6f75 6e64 733a 2069 6e74  ram ybounds: int
-0000da50: 2c20 0d0a 2020 2020 2020 2020 696e 7465  , ..        inte
-0000da60: 6772 6572 2076 616c 7565 7320 746f 2064  grer values to d
-0000da70: 7261 7720 686f 7269 7a6f 6e74 616c 2063  raw horizontal c
-0000da80: 6c75 7374 6572 206c 696e 6573 2074 6861  luster lines tha
-0000da90: 7420 696e 6469 6361 7465 2074 6865 200d  t indicate the .
-0000daa0: 0a20 2020 2020 2020 206e 756d 6265 7220  .        number 
-0000dab0: 6f66 2063 6c75 7374 6572 732e 200d 0a20  of clusters. .. 
-0000dac0: 2020 203a 7061 7261 6d20 6669 675f 7369     :param fig_si
-0000dad0: 7a65 3a20 7475 706c 6520 2877 6964 7468  ze: tuple (width
-0000dae0: 2c20 6865 6967 6874 292c 2064 6566 6175  , height), defau
-0000daf0: 6c74 203d 2831 322c 3529 200d 0a20 2020  lt =(12,5) ..   
-0000db00: 2020 2020 2074 6865 206d 6174 706c 6f74       the matplot
-0000db10: 6c69 6220 6669 6775 7265 2073 697a 6520  lib figure size 
-0000db20: 6769 7665 6e20 6173 2061 2074 7570 6c65  given as a tuple
-0000db30: 206f 6620 7769 6474 6820 616e 6420 6865   of width and he
-0000db40: 6967 6874 200d 0a20 2020 203a 7061 7261  ight ..    :para
-0000db50: 6d20 6b77 733a 2064 6963 7420 2c20 0d0a  m kws: dict , ..
-0000db60: 2020 2020 2020 2020 4164 6464 6974 696f          Addditio
-0000db70: 6e61 6c20 6b65 7977 6f72 6420 6172 6775  nal keyword argu
-0000db80: 6d65 6e74 7320 7061 7373 6564 2074 6f20  ments passed to 
-0000db90: 0d0a 2020 2020 2020 2020 3a66 756e 633a  ..        :func:
-0000dba0: 6073 6369 7079 2e63 6c75 7374 6572 2e68  `scipy.cluster.h
-0000dbb0: 6965 7261 7263 6879 2e64 656e 6472 6f67  ierarchy.dendrog
-0000dbc0: 7261 6d60 0d0a 2020 2020 3a45 7861 6d70  ram`..    :Examp
-0000dbd0: 6c65 733a 200d 0a20 2020 2020 2020 203e  les: ..        >
-0000dbe0: 3e3e 2066 726f 6d20 7761 7465 782e 6461  >> from watex.da
-0000dbf0: 7461 7365 7473 2069 6d70 6f72 7420 6665  tasets import fe
-0000dc00: 7463 685f 6461 7461 200d 0a20 2020 2020  tch_data ..     
-0000dc10: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
-0000dc20: 782e 7574 696c 732e 706c 6f74 7574 696c  x.utils.plotutil
-0000dc30: 7320 696d 706f 7274 2070 6c6f 745f 6e61  s import plot_na
-0000dc40: 6976 655f 6465 6e64 726f 6772 616d 0d0a  ive_dendrogram..
-0000dc50: 2020 2020 2020 2020 3e3e 3e20 582c 205f          >>> X, _
-0000dc60: 3d20 6665 7463 685f 6461 7461 2827 4261  = fetch_data('Ba
-0000dc70: 676f 7565 2061 6e61 6c79 7365 6427 2920  goue analysed') 
-0000dc80: 2320 6461 7461 2069 7320 616c 7265 6164  # data is alread
-0000dc90: 7920 7363 616c 6564 200d 0a20 2020 2020  y scaled ..     
-0000dca0: 2020 203e 3e3e 2023 2067 6574 2074 6865     >>> # get the
-0000dcb0: 2074 776f 2066 6561 7475 7265 7320 2770   two features 'p
-0000dcc0: 6f77 6572 2720 616e 6420 2027 6d61 676e  ower' and  'magn
-0000dcd0: 6974 7564 6527 0d0a 2020 2020 2020 2020  itude'..        
-0000dce0: 3e3e 3e20 6461 7461 203d 2058 5b5b 2770  >>> data = X[['p
-0000dcf0: 6f77 6572 272c 2027 6d61 676e 6974 7564  ower', 'magnitud
-0000dd00: 6527 5d5d 0d0a 2020 2020 2020 2020 3e3e  e']]..        >>
-0000dd10: 3e20 706c 6f74 5f6e 6169 7665 5f64 656e  > plot_naive_den
-0000dd20: 6472 6f67 7261 6d28 6461 7461 2029 200d  drogram(data ) .
-0000dd30: 0a20 2020 2020 2020 203e 3e3e 2023 2061  .        >>> # a
-0000dd40: 6464 2074 6865 2068 6f72 697a 6f6e 7461  dd the horizonta
-0000dd50: 6c20 6c69 6e65 206f 6620 7468 6520 636c  l line of the cl
-0000dd60: 7573 7465 7220 6174 2079 626f 756e 6473  uster at ybounds
-0000dd70: 203d 2028 3230 202c 2032 3020 290d 0a20   = (20 , 20 ).. 
-0000dd80: 2020 2020 2020 203e 3e3e 2023 2066 6f72         >>> # for
-0000dd90: 2061 2073 696e 676c 6520 636c 7573 7465   a single cluste
-0000dda0: 7220 2863 6c75 7365 7220 3129 0d0a 2020  r (cluser 1)..  
-0000ddb0: 2020 2020 2020 3e3e 3e20 706c 6f74 5f6e        >>> plot_n
-0000ddc0: 6169 7665 5f64 656e 6472 6f67 7261 6d28  aive_dendrogram(
-0000ddd0: 6461 7461 202c 2032 302c 2032 3020 2920  data , 20, 20 ) 
-0000dde0: 0d0a 2020 200d 0a20 2020 2022 2222 0d0a  ..   ..    """..
-0000ddf0: 2020 2020 2320 6173 7365 7274 2079 626f      # assert ybo
-0000de00: 756e 6473 2061 6775 6d65 6e74 2069 6620  unds agument if 
-0000de10: 6769 7665 6e0d 0a20 2020 206d 7367 203d  given..    msg =
-0000de20: 2822 2e20 4e6f 7465 2074 6861 7420 7468  (". Note that th
-0000de30: 6520 626f 756e 6473 2069 6e20 792d 6178  e bounds in y-ax
-0000de40: 6973 2061 7265 2074 6865 2079 2d63 6f6f  is are the y-coo
-0000de50: 7264 696e 6174 6573 2066 6f72 220d 0a20  rdinates for".. 
-0000de60: 2020 2020 2020 2020 2022 2068 6f72 697a           " horiz
-0000de70: 6f6e 7461 6c20 6c69 6e65 7320 7265 6761  ontal lines rega
-0000de80: 7264 696e 6720 746f 2074 6865 206e 756d  rding to the num
-0000de90: 6265 7220 6f66 2063 6c75 7374 6572 7320  ber of clusters 
-0000dea0: 7468 6174 220d 0a20 2020 2020 2020 2020  that"..         
-0000deb0: 2022 206d 6967 6874 2062 6520 6375 7474   " might be cutt
-0000dec0: 6564 2e22 290d 0a20 2020 2074 7279 203a  ed.")..    try :
-0000ded0: 200d 0a20 2020 2020 2020 2079 626f 756e   ..        yboun
-0000dee0: 6473 203d 205b 2069 6e74 2028 6129 2066  ds = [ int (a) f
-0000def0: 6f72 2061 2069 6e20 7962 6f75 6e64 7320  or a in ybounds 
-0000df00: 5d20 0d0a 2020 2020 6578 6365 7074 2045  ] ..    except E
-0000df10: 7863 6570 7469 6f6e 2061 7320 7479 7065  xception as type
-0000df20: 7272 6f72 3a20 0d0a 2020 2020 2020 2020  rror: ..        
-0000df30: 7261 6973 6520 5479 7065 4572 726f 7220  raise TypeError 
-0000df40: 2028 7374 7228 7479 7065 7272 6f72 2920   (str(typerror) 
-0000df50: 2b20 6d73 6729 0d0a 2020 2020 656c 7365  + msg)..    else
-0000df60: 203a 200d 0a20 2020 2020 2020 2069 6620   : ..        if 
-0000df70: 6c65 6e28 7962 6f75 6e64 7329 3d3d 3020  len(ybounds)==0 
-0000df80: 3a20 7962 6f75 6e64 7320 3d20 4e6f 6e65  : ybounds = None
-0000df90: 200d 0a20 2020 2023 2074 6865 2073 6369   ..    # the sci
-0000dfa0: 7079 2077 6172 6420 6675 6e63 7469 6f6e  py ward function
-0000dfb0: 2072 6574 7572 6e73 200d 0a20 2020 2023   returns ..    #
-0000dfc0: 2061 6e20 6172 7261 7920 7468 6174 2073   an array that s
-0000dfd0: 7065 6369 6669 6573 2074 6865 200d 0a20  pecifies the .. 
-0000dfe0: 2020 2023 2064 6973 7461 6e63 6520 6272     # distance br
-0000dff0: 6964 6765 6420 7768 656e 2070 6572 666f  idged when perfo
-0000e000: 726d 6564 200d 0a20 2020 2023 2061 6767  rmed ..    # agg
-0000e010: 6c6f 6d65 7261 7465 2063 6c75 7374 6572  lomerate cluster
-0000e020: 696e 670d 0a20 2020 206c 696e 6b61 6765  ing..    linkage
-0000e030: 5f61 7272 6179 203d 2077 6172 6428 5829  _array = ward(X)
-0000e040: 200d 0a20 2020 200d 0a20 2020 2023 2070   ..    ..    # p
-0000e050: 6c6f 7420 7468 6520 6465 6e64 726f 6772  lot the dendrogr
-0000e060: 616d 2066 6f72 2074 6865 206c 696e 6b61  am for the linka
-0000e070: 6765 2061 7272 6179 200d 0a20 2020 2023  ge array ..    #
-0000e080: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-0000e090: 6469 7374 616e 6365 7320 6265 7477 6565  distances betwee
-0000e0a0: 6e20 636c 7573 7465 7273 200d 0a20 2020  n clusters ..   
-0000e0b0: 2064 656e 6472 6f67 7261 6d28 206c 696e   dendrogram( lin
-0000e0c0: 6b61 6765 5f61 7272 6179 202c 202a 2a6b  kage_array , **k
-0000e0d0: 7773 2029 0d0a 2020 2020 0d0a 2020 2020  ws )..    ..    
-0000e0e0: 2320 6d61 726b 2074 6865 2063 7574 7320  # mark the cuts 
-0000e0f0: 6f6e 2074 6865 2074 7265 6520 7468 6174  on the tree that
-0000e100: 2073 6967 6e69 6679 2074 776f 206f 7220   signify two or 
-0000e110: 7468 7265 6520 636c 7573 7465 7273 0d0a  three clusters..
-0000e120: 2020 2020 2320 6368 616e 6765 2074 6865      # change the
-0000e130: 2067 6361 2066 6967 7369 7a65 200d 0a20   gca figsize .. 
-0000e140: 2020 2070 6c74 2e72 6350 6172 616d 735b     plt.rcParams[
-0000e150: 2266 6967 7572 652e 6669 6773 697a 6522  "figure.figsize"
-0000e160: 5d20 3d20 6669 675f 7369 7a65 0d0a 2020  ] = fig_size..  
-0000e170: 2020 6178 3d20 706c 742e 6763 6120 2829    ax= plt.gca ()
-0000e180: 200d 0a20 200d 0a20 2020 2069 6620 7962   ..  ..    if yb
-0000e190: 6f75 6e64 7320 6973 206e 6f74 204e 6f6e  ounds is not Non
-0000e1a0: 653a 200d 0a20 2020 2020 2020 2069 6620  e: ..        if 
-0000e1b0: 6e6f 7420 6973 5f69 7465 7261 626c 6528  not is_iterable(
-0000e1c0: 7962 6f75 6e64 7329 3a20 0d0a 2020 2020  ybounds): ..    
-0000e1d0: 2020 2020 2020 2020 7962 6f75 6e64 7320          ybounds 
-0000e1e0: 3d5b 7962 6f75 6e64 735d 200d 0a20 2020  =[ybounds] ..   
-0000e1f0: 2020 2020 2069 6620 6c65 6e28 7962 6f75       if len(ybou
-0000e200: 6e64 7329 203c 3d31 203a 200d 0a20 2020  nds) <=1 : ..   
-0000e210: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
-0000e220: 732e 7761 726e 2866 2261 7869 7320 7920  s.warn(f"axis y 
-0000e230: 626f 756e 6420 6d69 6768 7420 6265 2067  bound might be g
-0000e240: 7265 6174 6572 2074 6861 6e20 7b6c 656e  reater than {len
-0000e250: 2879 626f 756e 6473 297d 2229 0d0a 2020  (ybounds)}")..  
-0000e260: 2020 2020 2020 656c 7365 203a 200d 0a20        else : .. 
-0000e270: 2020 2020 2020 2020 2020 2023 2073 706c             # spl
-0000e280: 6974 2079 626f 756e 6420 696e 746f 2073  it ybound into s
-0000e290: 7562 6c69 7374 206f 6620 7061 6972 2028  ublist of pair (
-0000e2a0: 782c 2079 2920 636f 6f72 6469 6e61 7465  x, y) coordinate
-0000e2b0: 730d 0a20 2020 2020 2020 2020 2020 206e  s..            n
-0000e2c0: 7370 6c69 7473 203d 206c 656e 2879 626f  splits = len(ybo
-0000e2d0: 756e 6473 292f 2f32 200d 0a20 2020 2020  unds)//2 ..     
-0000e2e0: 2020 2020 2020 206c 656e 5f73 706c 6974         len_split
-0000e2f0: 7320 3d20 5b20 3220 666f 7220 6920 696e  s = [ 2 for i in
-0000e300: 2072 616e 6765 2028 6e73 706c 6974 7329   range (nsplits)
-0000e310: 5d0d 0a20 2020 2020 2020 2020 2020 2023  ]..            #
-0000e320: 2063 6f6d 706f 7365 2074 6865 2070 6972   compose the pir
-0000e330: 206c 6973 7420 2878 2c79 2029 0d0a 2020   list (x,y )..  
-0000e340: 2020 2020 2020 2020 2020 6974 6220 3d20            itb = 
-0000e350: 6974 6572 2028 7962 6f75 6e64 7329 0d0a  iter (ybounds)..
-0000e360: 2020 2020 2020 2020 2020 2020 7962 6f75              ybou
-0000e370: 6e64 7320 3d20 5b6c 6973 7428 6974 6572  nds = [list(iter
-0000e380: 746f 6f6c 732e 6973 6c69 6365 2028 6974  tools.islice (it
-0000e390: 622c 2069 7429 2920 666f 7220 6974 2069  b, it)) for it i
-0000e3a0: 6e20 6c65 6e5f 7370 6c69 7473 5d0d 0a20  n len_splits].. 
-0000e3b0: 2020 2020 2020 2020 2020 2062 6f75 6e64             bound
-0000e3c0: 7320 3d20 6178 2e67 6574 5f78 626f 756e  s = ax.get_xboun
-0000e3d0: 6420 2829 200d 0a20 2020 2020 2020 2020  d () ..         
-0000e3e0: 2020 2066 6f72 2069 202c 2028 2078 2c20     for i , ( x, 
-0000e3f0: 7929 2020 696e 2065 6e75 6d65 7261 7465  y)  in enumerate
-0000e400: 2028 7962 6f75 6e64 7329 2020 3a20 0d0a   (ybounds)  : ..
-0000e410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e420: 6178 2e70 6c6f 7428 626f 756e 6473 2c20  ax.plot(bounds, 
-0000e430: 5b78 2c20 795d 2c20 272d 2d27 2c20 633d  [x, y], '--', c=
-0000e440: 276b 2729 200d 0a20 2020 2020 2020 2020  'k') ..         
-0000e450: 2020 2020 2020 2061 782e 7465 7874 2028         ax.text (
-0000e460: 2062 6f75 6e64 7320 5b31 5d2c 2079 202c   bounds [1], y ,
-0000e470: 2066 2263 6c75 7374 6572 207b 6920 2b31   f"cluster {i +1
-0000e480: 3a30 327d 222c 0d0a 2020 2020 2020 2020  :02}",..        
-0000e490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e4a0: 2076 613d 2763 656e 7465 7227 2c20 0d0a   va='center', ..
-0000e4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e4c0: 2020 2020 2020 2020 2066 6f6e 7464 6963           fontdic
-0000e4d0: 7420 3d7b 2773 697a 6527 3a20 3135 7d0d  t ={'size': 15}.
-0000e4e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e4f0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-0000e500: 2023 2067 6574 2078 7469 636b 7320 616e   # get xticks an
-0000e510: 6420 666f 726d 6174 206c 6162 656c 730d  d format labels.
-0000e520: 0a20 2020 2078 7469 636b 735f 6c6f 6320  .    xticks_loc 
-0000e530: 3d20 6c69 7374 2861 782e 6765 745f 7874  = list(ax.get_xt
-0000e540: 6963 6b73 2829 290d 0a20 2020 205f 6765  icks())..    _ge
-0000e550: 745f 7874 6963 6b73 5f66 6f72 6d61 7461  t_xticks_formata
-0000e560: 6765 2861 782c 2078 7469 636b 735f 6c6f  ge(ax, xticks_lo
-0000e570: 632c 2073 7061 6365 203d 3134 2029 0d0a  c, space =14 )..
-0000e580: 2020 2020 0d0a 2020 2020 706c 742e 786c      ..    plt.xl
-0000e590: 6162 656c 2028 2253 616d 706c 6520 696e  abel ("Sample in
-0000e5a0: 6465 7820 2229 0d0a 2020 2020 706c 742e  dex ")..    plt.
-0000e5b0: 796c 6162 656c 2028 2243 6c75 7374 6572  ylabel ("Cluster
-0000e5c0: 2064 6973 7461 6e63 6522 290d 0a20 2020   distance")..   
-0000e5d0: 2020 2020 2020 2020 200d 0a20 2020 2069           ..    i
-0000e5e0: 6620 7361 7665 6669 6720 6973 206e 6f74  f savefig is not
-0000e5f0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0000e600: 706c 742e 7361 7665 6669 6728 7361 7665  plt.savefig(save
-0000e610: 6669 672c 2064 7069 203d 2033 3030 2029  fig, dpi = 300 )
-0000e620: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0000e630: 706c 742e 636c 6f73 6520 2829 2069 6620  plt.close () if 
-0000e640: 7361 7665 6669 6720 6973 206e 6f74 204e  savefig is not N
-0000e650: 6f6e 6520 656c 7365 2070 6c74 2e73 686f  one else plt.sho
-0000e660: 7728 2920 0d0a 2020 2020 0d0a 6465 6620  w() ..    ..def 
-0000e670: 706c 6f74 5f70 6361 5f63 6f6d 706f 6e65  plot_pca_compone
-0000e680: 6e74 7320 280d 0a20 2020 2020 2020 2063  nts (..        c
-0000e690: 6f6d 706f 6e65 6e74 732c 202a 2c20 6665  omponents, *, fe
-0000e6a0: 6174 7572 655f 6e61 6d65 7320 3d20 4e6f  ature_names = No
-0000e6b0: 6e65 202c 2063 6d61 703d 2027 7669 7269  ne , cmap= 'viri
-0000e6c0: 6469 7327 2c20 0d0a 2020 2020 2020 2020  dis', ..        
-0000e6d0: 7361 7665 6669 673d 4e6f 6e65 2c20 2a2a  savefig=None, **
-0000e6e0: 6b77 730d 0a20 2020 2020 2020 2029 3a20  kws..        ): 
-0000e6f0: 0d0a 2020 2020 2222 2220 5669 7375 616c  ..    """ Visual
-0000e700: 697a 6520 7468 6520 636f 6566 6669 6369  ize the coeffici
-0000e710: 656e 7420 6f66 2070 7269 6e63 6970 616c  ent of principal
-0000e720: 2063 6f6d 706f 6e65 6e74 2061 6e61 6c79   component analy
-0000e730: 7369 7320 2850 4341 2920 6173 200d 0a20  sis (PCA) as .. 
-0000e740: 2020 2061 2068 6561 746d 6170 2020 0d0a     a heatmap  ..
-0000e750: 2020 0d0a 2020 2020 3a70 6172 616d 2063    ..    :param c
-0000e760: 6f6d 706f 6e65 6e74 733a 204e 6461 7272  omponents: Ndarr
-0000e770: 6179 2c20 7368 6170 6520 286e 5f63 6f6d  ay, shape (n_com
-0000e780: 706f 6e65 6e74 732c 206e 5f66 6561 7475  ponents, n_featu
-0000e790: 7265 7329 6f72 2050 4341 206f 626a 6563  res)or PCA objec
-0000e7a0: 7420 0d0a 2020 2020 2020 2020 4172 7261  t ..        Arra
-0000e7b0: 7920 6f66 2074 6865 2050 4341 2063 6f6d  y of the PCA com
-0000e7c0: 706f 6d65 6e74 7320 6f72 206f 626a 6563  poments or objec
-0000e7d0: 7420 6672 6f6d 200d 0a20 2020 2020 2020  t from ..       
-0000e7e0: 203a 636c 6173 733a 6077 6174 6578 2e61   :class:`watex.a
-0000e7f0: 6e61 6c79 7369 732e 6469 6d65 6e73 696f  nalysis.dimensio
-0000e800: 6e61 6c69 7479 2e6e 5043 4160 2e20 4966  nality.nPCA`. If
-0000e810: 2074 6865 206f 626a 6563 7420 6973 2067   the object is g
-0000e820: 6976 656e 200d 0a20 2020 2020 2020 2069  iven ..        i
-0000e830: 7420 6973 206e 6f74 206e 6563 6573 7361  t is not necessa
-0000e840: 7279 2074 6f20 7365 7420 7468 6520 6066  ry to set the `f
-0000e850: 6561 7475 7265 5f6e 616d 6573 600d 0a20  eature_names`.. 
-0000e860: 2020 203a 7061 7261 6d20 6665 6174 7572     :param featur
-0000e870: 655f 6e61 6d65 733a 206c 6973 7420 6f72  e_names: list or
-0000e880: 2073 7472 2c20 6f70 7469 6f6e 616c 200d   str, optional .
-0000e890: 0a20 2020 2020 2020 206c 6973 7420 6f66  .        list of
-0000e8a0: 2074 6865 2066 6561 7475 7265 206e 616d   the feature nam
-0000e8b0: 6573 2074 6f20 6c6f 6361 7465 2069 6e20  es to locate in 
-0000e8c0: 7468 6520 6d61 702e 2060 4665 6174 7572  the map. `Featur
-0000e8d0: 655f 6e61 6d65 7360 2061 6e64 200d 0a20  e_names` and .. 
-0000e8e0: 2020 2020 2020 2074 6865 206e 756d 6265         the numbe
-0000e8f0: 7220 6f66 2065 6967 656e 2076 6563 746f  r of eigen vecto
-0000e900: 7273 206d 7573 7420 6265 2074 6865 2073  rs must be the s
-0000e910: 616d 6520 6c65 6e67 7468 2e20 4966 2050  ame length. If P
-0000e920: 4341 206f 626a 6563 7420 6973 2020 0d0a  CA object is  ..
-0000e930: 2020 2020 2020 2020 7061 7373 6564 2061          passed a
-0000e940: 7320 6063 6f6d 706f 6e65 6e74 7360 2061  s `components` a
-0000e950: 7267 756d 656e 7473 2c20 6e6f 206e 6565  rguments, no nee
-0000e960: 6420 746f 2073 6574 2074 6865 2060 6665  d to set the `fe
-0000e970: 6174 7572 655f 6e61 6d65 7360 2e20 0d0a  ature_names`. ..
-0000e980: 2020 2020 2020 2020 5468 6520 6e61 6d65          The name
-0000e990: 206f 6620 6665 6174 7572 6573 2069 7320   of features is 
-0000e9a0: 7265 7472 6569 7665 6420 6175 746f 6d61  retreived automa
-0000e9b0: 7469 6361 6c6c 792e 200d 0a20 2020 203a  tically. ..    :
-0000e9c0: 7061 7261 6d20 636d 6170 3a20 7374 722c  param cmap: str,
-0000e9d0: 2064 6566 6175 6c74 3d27 7669 7269 6469   default='viridi
-0000e9e0: 7327 0d0a 2020 2020 2020 2020 7468 6520  s'..        the 
-0000e9f0: 6d61 7470 6c6f 746c 6962 2063 6f6c 6f72  matplotlib color
-0000ea00: 206d 6170 2066 6f72 206d 6174 7368 6f77   map for matshow
-0000ea10: 2076 6973 7561 6c69 7a61 7469 6f6e 2e20   visualization. 
-0000ea20: 0d0a 2020 2020 3a70 6172 616d 206b 7773  ..    :param kws
-0000ea30: 3a20 6469 6374 2c20 0d0a 2020 2020 2020  : dict, ..      
-0000ea40: 2020 4164 6469 7469 6f6e 616c 206b 6579    Additional key
-0000ea50: 776f 7264 7320 6172 6775 6d65 6e74 7320  words arguments 
-0000ea60: 7061 7373 6564 2074 6f20 0d0a 2020 2020  passed to ..    
-0000ea70: 2020 2020 3a63 6c61 7373 3a60 6d61 7470      :class:`matp
-0000ea80: 6c6f 746c 6962 2e70 7970 6c6f 742e 6d61  lotlib.pyplot.ma
-0000ea90: 7473 686f 7760 0d0a 2020 2020 2020 2020  tshow`..        
-0000eaa0: 0d0a 2020 2020 3a45 7861 6d70 6c65 733a  ..    :Examples:
-0000eab0: 200d 0a20 2020 2028 3129 2d3e 2077 6974   ..    (1)-> wit
-0000eac0: 6820 5043 4120 6f62 6a65 6374 200d 0a20  h PCA object .. 
-0000ead0: 2020 200d 0a20 2020 203e 3e3e 2066 726f     ..    >>> fro
-0000eae0: 6d20 7761 7465 782e 6461 7461 7365 7473  m watex.datasets
-0000eaf0: 2069 6d70 6f72 7420 6665 7463 685f 6461   import fetch_da
-0000eb00: 7461 0d0a 2020 2020 3e3e 3e20 6672 6f6d  ta..    >>> from
-0000eb10: 2077 6174 6578 2e75 7469 6c73 2e70 6c6f   watex.utils.plo
-0000eb20: 7475 7469 6c73 2069 6d70 6f72 7420 706c  tutils import pl
-0000eb30: 6f74 5f70 6361 5f63 6f6d 706f 6e65 6e74  ot_pca_component
-0000eb40: 730d 0a20 2020 203e 3e3e 2066 726f 6d20  s..    >>> from 
-0000eb50: 7761 7465 782e 616e 616c 7973 6973 2069  watex.analysis i
-0000eb60: 6d70 6f72 7420 6e50 4341 200d 0a20 2020  mport nPCA ..   
-0000eb70: 203e 3e3e 2058 2c20 5f3d 2066 6574 6368   >>> X, _= fetch
-0000eb80: 5f64 6174 6128 2762 6167 6f75 6520 7063  _data('bagoue pc
-0000eb90: 6127 2920 0d0a 2020 2020 3e3e 3e20 7063  a') ..    >>> pc
-0000eba0: 6120 3d20 6e50 4341 2028 582c 206e 5f63  a = nPCA (X, n_c
-0000ebb0: 6f6d 706f 6e65 6e74 733d 322c 2072 6574  omponents=2, ret
-0000ebc0: 7572 6e5f 5820 3d46 616c 7365 2923 2074  urn_X =False)# t
-0000ebd0: 6f20 7265 7475 726e 206f 626a 6563 7420  o return object 
-0000ebe0: 0d0a 2020 2020 3e3e 3e20 706c 6f74 5f70  ..    >>> plot_p
-0000ebf0: 6361 5f63 6f6d 706f 6e65 6e74 7320 2870  ca_components (p
-0000ec00: 6361 290d 0a20 2020 200d 0a20 2020 2028  ca)..    ..    (
-0000ec10: 3229 2d3e 2075 7365 2074 6865 2063 6f6d  2)-> use the com
-0000ec20: 706f 6e65 6e74 7320 616e 6420 6665 6174  ponents and feat
-0000ec30: 7572 6573 2069 6e64 6976 6964 7561 6c6c  ures individuall
-0000ec40: 7920 0d0a 2020 2020 0d0a 2020 2020 3e3e  y ..    ..    >>
-0000ec50: 3e20 636f 6d70 6f6e 656e 7473 203d 2070  > components = p
-0000ec60: 6361 2e63 6f6d 706f 6e65 6e74 735f 200d  ca.components_ .
-0000ec70: 0a20 2020 203e 3e3e 2066 6561 7475 7265  .    >>> feature
-0000ec80: 7320 3d20 7063 612e 6665 6174 7572 655f  s = pca.feature_
-0000ec90: 6e61 6d65 735f 696e 5f0d 0a20 2020 203e  names_in_..    >
-0000eca0: 3e3e 2070 6c6f 745f 7063 615f 636f 6d70  >> plot_pca_comp
-0000ecb0: 6f6e 656e 7473 2028 636f 6d70 6f6e 656e  onents (componen
-0000ecc0: 7473 2c20 6665 6174 7572 655f 6e61 6d65  ts, feature_name
-0000ecd0: 733d 2066 6561 7475 7265 732c 200d 0a20  s= features, .. 
-0000ece0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ecf0: 2020 2020 2020 2020 2020 2020 636d 6170              cmap
-0000ed00: 3d27 6a65 745f 7227 290d 0a20 2020 200d  ='jet_r')..    .
-0000ed10: 0a20 2020 2022 2222 0d0a 2020 2020 6966  .    """..    if
-0000ed20: 2073 702e 6973 7370 6172 7365 2028 636f   sp.issparse (co
-0000ed30: 6d70 6f6e 656e 7473 293a 200d 0a20 2020  mponents): ..   
-0000ed40: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0000ed50: 7272 6f72 2028 2253 7061 7273 6520 6172  rror ("Sparse ar
-0000ed60: 7261 7920 6973 206e 6f74 2073 7570 706f  ray is not suppo
-0000ed70: 7274 6564 2066 6f72 2050 4341 2022 0d0a  rted for PCA "..
-0000ed80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed90: 2020 2020 2020 2020 2022 636f 6d70 6f6e           "compon
-0000eda0: 656e 7473 2076 6973 7561 6c69 7a61 7469  ents visualizati
-0000edb0: 6f6e 2e22 0d0a 2020 2020 2020 2020 2020  on."..          
-0000edc0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000edd0: 0d0a 2020 2020 2320 6966 2070 6361 206f  ..    # if pca o
-0000ede0: 626a 6563 7420 6973 2067 6976 656e 202c  bject is given ,
-0000edf0: 2067 6574 2074 6865 2066 6561 7475 7265   get the feature
-0000ee00: 7320 6e61 6d65 730d 0a20 2020 2069 6620  s names..    if 
-0000ee10: 6861 7361 7474 7228 636f 6d70 6f6e 656e  hasattr(componen
-0000ee20: 7473 2c20 2266 6561 7475 7265 5f6e 616d  ts, "feature_nam
-0000ee30: 6573 5f69 6e5f 2229 3a20 0d0a 2020 2020  es_in_"): ..    
-0000ee40: 2020 2020 6665 6174 7572 655f 6e61 6d65      feature_name
-0000ee50: 7320 3d20 6c69 7374 2028 6765 7461 7474  s = list (getatt
-0000ee60: 7220 2863 6f6d 706f 6e65 6e74 7320 2c20  r (components , 
-0000ee70: 2266 6561 7475 7265 5f6e 616d 6573 5f69  "feature_names_i
-0000ee80: 6e5f 2220 2920 2920 0d0a 2020 2020 2020  n_" ) ) ..      
-0000ee90: 2020 0d0a 2020 2020 6966 206e 6f74 2068    ..    if not h
-0000eea0: 6173 6174 7472 2028 636f 6d70 6f6e 656e  asattr (componen
-0000eeb0: 7473 202c 2022 5f5f 6172 7261 795f 5f22  ts , "__array__"
-0000eec0: 293a 200d 0a20 2020 2020 2020 2063 6f6d  ): ..        com
-0000eed0: 706f 6e65 6e74 7320 3d20 5f63 6865 636b  ponents = _check
-0000eee0: 5f61 7272 6179 5f69 6e20 2028 636f 6d70  _array_in  (comp
-0000eef0: 6f6e 656e 7473 2c20 2763 6f6d 706f 6e65  onents, 'compone
-0000ef00: 6e74 735f 2729 0d0a 2020 2020 2020 2020  nts_')..        
-0000ef10: 0d0a 2020 2020 706c 742e 6d61 7473 686f  ..    plt.matsho
-0000ef20: 7728 636f 6d70 6f6e 656e 7473 2c20 636d  w(components, cm
-0000ef30: 6170 203d 636d 6170 202c 202a 2a6b 7773  ap =cmap , **kws
-0000ef40: 290d 0a20 2020 2070 6c74 2e79 7469 636b  )..    plt.ytick
-0000ef50: 7320 285b 3020 2c20 315d 2c20 5b27 4669  s ([0 , 1], ['Fi
-0000ef60: 7273 7420 636f 6d70 6f6e 656e 7427 2c20  rst component', 
-0000ef70: 2753 6563 6f6e 6420 636f 6d70 6f6e 656e  'Second componen
-0000ef80: 7427 5d29 200d 0a20 2020 2063 623d 706c  t']) ..    cb=pl
-0000ef90: 742e 636f 6c6f 7262 6172 2829 200d 0a20  t.colorbar() .. 
-0000efa0: 2020 2063 622e 7365 745f 6c61 6265 6c28     cb.set_label(
-0000efb0: 2743 6f65 6666 2076 616c 7565 2729 0d0a  'Coeff value')..
-0000efc0: 2020 2020 6966 206e 6f74 2069 735f 6974      if not is_it
-0000efd0: 6572 6162 6c65 2866 6561 7475 7265 5f6e  erable(feature_n
-0000efe0: 616d 6573 2029 3a20 0d0a 2020 2020 2020  ames ): ..      
-0000eff0: 2020 6665 6174 7572 655f 6e61 6d65 7320    feature_names 
-0000f000: 3d20 5b66 6561 7475 7265 5f6e 616d 6573  = [feature_names
-0000f010: 205d 0d0a 2020 2020 2020 2020 0d0a 2020   ]..        ..  
-0000f020: 2020 6966 206c 656e 2866 6561 7475 7265    if len(feature
-0000f030: 5f6e 616d 6573 2921 3d20 636f 6d70 6f6e  _names)!= compon
-0000f040: 656e 7473 2e73 6861 7065 205b 315d 203a  ents.shape [1] :
-0000f050: 0d0a 2020 2020 2020 2020 7761 726e 696e  ..        warnin
-0000f060: 6773 2e77 6172 6e28 224e 756d 6265 7220  gs.warn("Number 
-0000f070: 6f66 2066 6561 7475 7265 7320 616e 6420  of features and 
-0000f080: 6569 6765 6e76 6563 746f 7273 206d 6967  eigenvectors mig
-0000f090: 6874 220d 0a20 2020 2020 2020 2020 2020  ht"..           
-0000f0a0: 2020 2020 2020 2020 2020 2022 2062 6520             " be 
-0000f0b0: 636f 6e73 6973 7465 6e74 2c20 6578 7065  consistent, expe
-0000f0c0: 6374 207b 307d 2c20 676f 7420 7b31 7d22  ct {0}, got {1}"
-0000f0d0: 2e20 666f 726d 6174 2820 0d0a 2020 2020  . format( ..    
-0000f0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f0f0: 2020 2020 2020 636f 6d70 6f6e 656e 7473        components
-0000f100: 2e73 6861 7065 5b31 5d2c 206c 656e 2866  .shape[1], len(f
-0000f110: 6561 7475 7265 5f6e 616d 6573 2929 0d0a  eature_names))..
-0000f120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f130: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-0000f140: 2066 6561 7475 7265 5f6e 616d 6573 3d4e   feature_names=N
-0000f150: 6f6e 6520 0d0a 2020 2020 6966 2066 6561  one ..    if fea
-0000f160: 7475 7265 5f6e 616d 6573 2069 7320 6e6f  ture_names is no
-0000f170: 7420 4e6f 6e65 3a20 0d0a 2020 2020 2020  t None: ..      
-0000f180: 2020 706c 742e 7874 6963 6b73 2028 7261    plt.xticks (ra
-0000f190: 6e67 6520 286c 656e 2866 6561 7475 7265  nge (len(feature
-0000f1a0: 5f6e 616d 6573 2929 2c20 0d0a 2020 2020  _names)), ..    
-0000f1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f1c0: 6665 6174 7572 655f 6e61 6d65 7320 2c20  feature_names , 
-0000f1d0: 726f 7461 7469 6f6e 203d 2036 3020 2c20  rotation = 60 , 
-0000f1e0: 6861 3d27 6c65 6674 2720 0d0a 2020 2020  ha='left' ..    
-0000f1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f200: 290d 0a20 2020 2070 6c74 2e78 6c61 6265  )..    plt.xlabe
-0000f210: 6c20 2822 4665 6174 7572 6522 2920 0d0a  l ("Feature") ..
-0000f220: 2020 2020 706c 742e 796c 6162 656c 2028      plt.ylabel (
-0000f230: 2250 7269 6e63 6970 616c 2063 6f6d 706f  "Principal compo
-0000f240: 6e65 6e74 7322 2920 0d0a 2020 2020 0d0a  nents") ..    ..
-0000f250: 2020 2020 6966 2073 6176 6566 6967 2069      if savefig i
-0000f260: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-0000f270: 2020 2020 2070 6c74 2e73 6176 6566 6967       plt.savefig
-0000f280: 2873 6176 6566 6967 2c20 6470 6920 3d20  (savefig, dpi = 
-0000f290: 3330 3020 290d 0a20 2020 2020 2020 200d  300 )..        .
-0000f2a0: 0a20 2020 2070 6c74 2e63 6c6f 7365 2028  .    plt.close (
-0000f2b0: 2920 6966 2073 6176 6566 6967 2069 7320  ) if savefig is 
-0000f2c0: 6e6f 7420 4e6f 6e65 2065 6c73 6520 706c  not None else pl
-0000f2d0: 742e 7368 6f77 2829 200d 0a20 2020 200d  t.show() ..    .
-0000f2e0: 0a20 2020 2020 2020 200d 0a64 6566 2070  .        ..def p
-0000f2f0: 6c6f 745f 636c 7573 7465 7273 2028 0d0a  lot_clusters (..
-0000f300: 2020 2020 2020 2020 6e5f 636c 7573 7465          n_cluste
-0000f310: 7273 2c20 582c 2079 5f70 7265 642c 2063  rs, X, y_pred, c
-0000f320: 6c75 7374 6572 5f63 656e 7465 7273 203d  luster_centers =
-0000f330: 4e6f 6e65 202c 2073 6176 6566 6967 203d  None , savefig =
-0000f340: 4e6f 6e65 2c20 0d0a 2020 2020 2020 2020  None, ..        
-0000f350: 293a 200d 0a20 2020 2022 2222 2056 6973  ): ..    """ Vis
-0000f360: 7561 6c69 7a65 2074 6865 2063 6c75 7374  ualize the clust
-0000f370: 6572 2074 6861 7420 6b2d 6d65 616e 7320  er that k-means 
-0000f380: 6964 656e 7469 6669 6564 2069 6e20 7468  identified in th
-0000f390: 6520 6461 7461 7365 7420 0d0a 2020 2020  e dataset ..    
-0000f3a0: 0d0a 2020 2020 3a70 6172 616d 206e 5f63  ..    :param n_c
-0000f3b0: 6c75 7374 6572 733a 2069 6e74 2c20 6e75  lusters: int, nu
-0000f3c0: 6d62 6572 206f 6620 636c 7573 7465 7220  mber of cluster 
-0000f3d0: 746f 2076 6973 7561 6c69 7a65 200d 0a20  to visualize .. 
-0000f3e0: 2020 203a 7061 7261 6d20 583a 204e 4441     :param X: NDA
-0000f3f0: 7272 6179 2c20 6461 7461 2063 6f6e 7461  rray, data conta
-0000f400: 696e 696e 6720 7468 6520 6665 6174 7572  ining the featur
-0000f410: 6573 2c20 6578 7065 6374 2074 6f20 6265  es, expect to be
-0000f420: 2061 2074 776f 200d 0a20 2020 2020 2020   a two ..       
-0000f430: 2064 696d 656e 7369 6f6e 616c 2064 6174   dimensional dat
-0000f440: 6120 0d0a 2020 2020 3a70 6172 616d 2079  a ..    :param y
-0000f450: 5f70 7265 643a 2061 7272 6179 2d6c 696b  _pred: array-lik
-0000f460: 652c 2061 7272 6179 2063 6f6e 7461 696e  e, array contain
-0000f470: 696e 6720 7468 6520 7072 6564 6963 7465  ing the predicte
-0000f480: 6420 636c 6173 7320 6c61 6265 6c73 2e20  d class labels. 
-0000f490: 0d0a 2020 2020 3a70 6172 616d 2063 6c75  ..    :param clu
-0000f4a0: 7374 6572 5f63 656e 7465 7273 5f3a 204e  ster_centers_: N
-0000f4b0: 4441 7272 6179 2063 6f6e 7461 696e 6720  DArray containg 
-0000f4c0: 7468 6520 636f 6f72 6469 6e61 7465 7320  the coordinates 
-0000f4d0: 6f66 2074 6865 200d 0a20 2020 2020 2020  of the ..       
-0000f4e0: 2063 656e 7472 6f69 6473 206f 7220 7468   centroids or th
-0000f4f0: 6520 7369 6d69 6c61 7220 706f 696e 7473  e similar points
-0000f500: 2077 6974 6820 636f 6e74 696e 6f75 7320   with continous 
-0000f510: 6665 6174 7572 6573 2e20 0d0a 2020 2020  features. ..    
-0000f520: 2020 2020 0d0a 2020 2020 3a45 7861 6d70      ..    :Examp
-0000f530: 6c65 3a20 0d0a 2020 2020 3e3e 3e20 6672  le: ..    >>> fr
-0000f540: 6f6d 2077 6174 6578 2e65 786c 6962 2e73  om watex.exlib.s
-0000f550: 6b6c 6561 726e 2069 6d70 6f72 7420 4b4d  klearn import KM
-0000f560: 6561 6e73 2c20 4d69 6e4d 6178 5363 616c  eans, MinMaxScal
-0000f570: 6572 0d0a 2020 2020 3e3e 3e20 6672 6f6d  er..    >>> from
-0000f580: 2077 6174 6578 2e75 7469 6c73 2e70 6c6f   watex.utils.plo
-0000f590: 7475 7469 6c73 2069 6d70 6f72 7420 706c  tutils import pl
-0000f5a0: 6f74 5f63 6c75 7374 6572 730d 0a20 2020  ot_clusters..   
-0000f5b0: 203e 3e3e 2066 726f 6d20 7761 7465 782e   >>> from watex.
-0000f5c0: 6461 7461 7365 7473 2069 6d70 6f72 7420  datasets import 
-0000f5d0: 6665 7463 685f 6461 7461 200d 0a20 2020  fetch_data ..   
-0000f5e0: 203e 3e3e 2068 3d20 6665 7463 685f 6461   >>> h= fetch_da
-0000f5f0: 7461 2827 686c 6f67 7327 292e 6672 616d  ta('hlogs').fram
-0000f600: 6520 0d0a 2020 2020 3e3e 3e20 2320 636f  e ..    >>> # co
-0000f610: 6c6c 6563 7420 7477 6f20 6665 6174 7572  llect two featur
-0000f620: 6573 2027 7265 7369 7374 6976 6974 7927  es 'resistivity'
-0000f630: 2061 6e64 2067 616d 6d61 2d67 616d 6d61   and gamma-gamma
-0000f640: 206c 6f67 6769 6e67 2076 616c 7565 730d   logging values.
-0000f650: 0a20 2020 203e 3e3e 2068 3220 3d20 685b  .    >>> h2 = h[
-0000f660: 5b27 7265 7369 7374 6976 6974 7927 2c20  ['resistivity', 
-0000f670: 2767 616d 6d61 5f67 616d 6d61 275d 5d20  'gamma_gamma']] 
-0000f680: 0d0a 2020 2020 3e3e 3e20 6b6d 203d 204b  ..    >>> km = K
-0000f690: 4d65 616e 7320 286e 5f63 6c75 7374 6572  Means (n_cluster
-0000f6a0: 7320 3d33 202c 2069 6e69 743d 2027 7261  s =3 , init= 'ra
-0000f6b0: 6e64 6f6d 2720 2920 0d0a 2020 2020 3e3e  ndom' ) ..    >>
-0000f6c0: 3e20 2320 7363 616c 6564 2074 6865 2064  > # scaled the d
-0000f6d0: 6174 6120 7769 7468 204d 696e 4d61 7820  ata with MinMax 
-0000f6e0: 7363 616c 6572 2069 2e65 2e20 6265 7477  scaler i.e. betw
-0000f6f0: 6565 6e20 2820 302d 3129 200d 0a20 2020  een ( 0-1) ..   
-0000f700: 203e 3e3e 2068 325f 7363 616c 6564 203d   >>> h2_scaled =
-0000f710: 204d 696e 4d61 7853 6361 6c65 7228 292e   MinMaxScaler().
-0000f720: 6669 745f 7472 616e 7366 6f72 6d28 6832  fit_transform(h2
-0000f730: 290d 0a20 2020 203e 3e3e 2079 6b6d 203d  )..    >>> ykm =
-0000f740: 206b 6d2e 6669 745f 7072 6564 6963 7428   km.fit_predict(
-0000f750: 6832 5f73 6361 6c65 6420 290d 0a20 2020  h2_scaled )..   
-0000f760: 203e 3e3e 2070 6c6f 745f 636c 7573 7465   >>> plot_cluste
-0000f770: 7273 2028 3320 2c20 6832 5f73 6361 6c65  rs (3 , h2_scale
-0000f780: 642c 2079 6b6d 202c 206b 6d2e 636c 7573  d, ykm , km.clus
-0000f790: 7465 725f 6365 6e74 6572 735f 2029 0d0a  ter_centers_ )..
-0000f7a0: 2020 2020 2020 2020 0d0a 2020 2020 2222          ..    ""
-0000f7b0: 220d 0a20 2020 206e 5f63 6c75 7374 6572  "..    n_cluster
-0000f7c0: 7320 3d20 696e 7428 0d0a 2020 2020 2020  s = int(..      
-0000f7d0: 2020 5f61 7373 6572 745f 616c 6c5f 7479    _assert_all_ty
-0000f7e0: 7065 7328 6e5f 636c 7573 7465 7273 2c20  pes(n_clusters, 
-0000f7f0: 696e 742c 2066 6c6f 6174 2c20 206f 626a  int, float,  obj
-0000f800: 6e61 6d65 203d 2227 6e5f 636c 7573 7465  name ="'n_cluste
-0000f810: 7273 2722 2029 0d0a 2020 2020 2020 2020  rs'" )..        
-0000f820: 290d 0a20 2020 2058 2c20 795f 7072 6564  )..    X, y_pred
-0000f830: 203d 2063 6865 636b 5f58 5f79 280d 0a20   = check_X_y(.. 
-0000f840: 2020 2020 2020 2058 2c20 0d0a 2020 2020         X, ..    
-0000f850: 2020 2020 795f 7072 6564 2c20 0d0a 2020      y_pred, ..  
-0000f860: 2020 2020 2020 290d 0a0d 0a20 2020 2069        )....    i
-0000f870: 6620 6c65 6e28 582e 7368 6170 6520 2921  f len(X.shape )!
-0000f880: 3d32 206f 7220 582e 7368 6170 655b 315d  =2 or X.shape[1]
-0000f890: 3d3d 313a 200d 0a20 2020 2020 2020 206e  ==1: ..        n
-0000f8a0: 6469 6d20 3d20 3120 6966 2058 2e73 6861  dim = 1 if X.sha
-0000f8b0: 7065 5b31 5d20 3d3d 3120 656c 7365 206e  pe[1] ==1 else n
-0000f8c0: 702e 6e64 696d 2028 5820 290d 0a20 2020  p.ndim (X )..   
-0000f8d0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000f8e0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
-0000f8f0: 2020 2020 6622 5820 6973 2065 7870 6563      f"X is expec
-0000f900: 7465 6420 746f 2062 6520 6120 7477 6f20  ted to be a two 
-0000f910: 6469 6d65 6e73 696f 6e61 6c20 6461 7461  dimensional data
-0000f920: 2e20 476f 7420 7b6e 6469 6d7d 2122 290d  . Got {ndim}!").
-0000f930: 0a20 2020 2023 2066 6f72 2063 6f6e 7369  .    # for consi
-0000f940: 7374 656e 6379 202c 2063 6f6e 7665 7274  stency , convert
-0000f950: 2079 2074 6f20 6172 7261 7920 2020 200d   y to array    .
-0000f960: 0a20 2020 2079 5f70 7265 6420 3d20 6e70  .    y_pred = np
-0000f970: 2e61 7272 6179 2879 5f70 7265 6429 0d0a  .array(y_pred)..
-0000f980: 2020 2020 0d0a 2020 2020 636f 6c6f 7273      ..    colors
-0000f990: 203d 206d 616b 655f 6d70 6c5f 7072 6f70   = make_mpl_prop
-0000f9a0: 6572 7469 6573 286e 5f63 6c75 7374 6572  erties(n_cluster
-0000f9b0: 7329 0d0a 2020 2020 6d61 726b 6572 7320  s)..    markers 
-0000f9c0: 3d20 6d61 6b65 5f6d 706c 5f70 726f 7065  = make_mpl_prope
-0000f9d0: 7274 6965 7328 6e5f 636c 7573 7465 7273  rties(n_clusters
-0000f9e0: 2c20 276d 6172 6b65 7273 2729 0d0a 2020  , 'markers')..  
-0000f9f0: 2020 666f 7220 6e20 696e 2072 616e 6765    for n in range
-0000fa00: 2028 6e5f 636c 7573 7465 7273 293a 0d0a   (n_clusters):..
-0000fa10: 2020 2020 2020 2020 706c 742e 7363 6174          plt.scat
-0000fa20: 7465 7220 2858 5b79 5f70 7265 6420 3d3d  ter (X[y_pred ==
-0000fa30: 6e2c 2030 5d2c 200d 0a20 2020 2020 2020  n, 0], ..       
-0000fa40: 2020 2020 2020 2020 2020 2020 2020 585b                X[
-0000fa50: 795f 7072 6564 203d 3d6e 202c 2031 5d2c  y_pred ==n , 1],
-0000fa60: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0000fa70: 2020 2020 2020 2020 2073 3d20 3530 202c           s= 50 ,
-0000fa80: 2063 3d20 636f 6c6f 7273 205b 6e20 5d2c   c= colors [n ],
-0000fa90: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000faa0: 2020 2020 2020 2020 6d61 726b 6572 3d6d          marker=m
-0000fab0: 6172 6b65 7273 205b 6e5d 2c20 0d0a 2020  arkers [n], ..  
-0000fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fad0: 2020 2065 6467 6563 6f6c 6f72 733d 4e6f     edgecolors=No
-0000fae0: 6e65 2069 6620 6d61 726b 6572 7320 5b6e  ne if markers [n
-0000faf0: 5d20 3d3d 2778 2720 656c 7365 2027 626c  ] =='x' else 'bl
-0000fb00: 6163 6b27 2c20 0d0a 2020 2020 2020 2020  ack', ..        
-0000fb10: 2020 2020 2020 2020 2020 2020 206c 6162               lab
-0000fb20: 656c 203d 2066 2743 6c75 7374 6572 207b  el = f'Cluster {
-0000fb30: 6e20 2b31 7d27 0d0a 2020 2020 2020 2020  n +1}'..        
-0000fb40: 2020 2020 2020 2020 2020 2020 2029 200d               ) .
-0000fb50: 0a20 2020 2069 6620 636c 7573 7465 725f  .    if cluster_
-0000fb60: 6365 6e74 6572 7320 6973 206e 6f74 204e  centers is not N
-0000fb70: 6f6e 653a 200d 0a20 2020 2020 2020 2063  one: ..        c
-0000fb80: 6c75 7374 6572 5f63 656e 7465 7273 203d  luster_centers =
-0000fb90: 206e 702e 6172 7261 7920 2863 6c75 7374   np.array (clust
-0000fba0: 6572 5f63 656e 7465 7273 290d 0a20 2020  er_centers)..   
-0000fbb0: 2020 2020 2070 6c74 2e73 6361 7474 6572       plt.scatter
-0000fbc0: 2028 636c 7573 7465 725f 6365 6e74 6572   (cluster_center
-0000fbd0: 735b 3a2c 2030 205d 2c20 0d0a 2020 2020  s[:, 0 ], ..    
-0000fbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fbf0: 2063 6c75 7374 6572 5f63 656e 7465 7273   cluster_centers
-0000fc00: 205b 3a2c 2031 5d2c 200d 0a20 2020 2020   [:, 1], ..     
-0000fc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fc20: 733d 2032 3530 2e20 2c20 6d61 726b 6572  s= 250. , marker
-0000fc30: 203d 272a 272c 200d 0a20 2020 2020 2020   ='*', ..       
-0000fc40: 2020 2020 2020 2020 2020 2020 2020 633d                c=
-0000fc50: 2772 6564 272c 2065 6467 6563 6f6c 6f72  'red', edgecolor
-0000fc60: 733d 2762 6c61 636b 272c 200d 0a20 2020  s='black', ..   
-0000fc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fc80: 2020 6c61 6265 6c3d 2763 656e 7472 6f69    label='centroi
-0000fc90: 6473 2720 0d0a 2020 2020 2020 2020 2020  ds' ..          
-0000fca0: 2020 2020 2020 2020 2020 2029 200d 0a20             ) .. 
-0000fcb0: 2020 2070 6c74 2e6c 6567 656e 6420 2873     plt.legend (s
-0000fcc0: 6361 7474 6572 706f 696e 7473 203d 3120  catterpoints =1 
-0000fcd0: 2920 0d0a 2020 2020 706c 742e 6772 6964  ) ..    plt.grid
-0000fce0: 2829 200d 0a20 2020 2070 6c74 2e74 6967  () ..    plt.tig
-0000fcf0: 6874 5f6c 6179 6f75 7428 2920 0d0a 2020  ht_layout() ..  
-0000fd00: 2020 0d0a 2020 2020 6966 2073 6176 6566    ..    if savef
-0000fd10: 6967 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ig is not None:.
-0000fd20: 0a20 2020 2020 2020 2020 7361 7665 6669  .         savefi
-0000fd30: 6775 7265 2873 6176 6566 6967 2c20 7361  gure(savefig, sa
-0000fd40: 7665 6669 6720 290d 0a20 2020 2070 6c74  vefig )..    plt
-0000fd50: 2e63 6c6f 7365 2028 2920 6966 2073 6176  .close () if sav
-0000fd60: 6566 6967 2069 7320 6e6f 7420 4e6f 6e65  efig is not None
-0000fd70: 2065 6c73 6520 706c 742e 7368 6f77 2829   else plt.show()
-0000fd80: 200d 0a20 2020 200d 0a20 2020 200d 0a64   ..    ..    ..d
-0000fd90: 6566 2070 6c6f 745f 656c 626f 7720 280d  ef plot_elbow (.
-0000fda0: 0a20 2020 2020 2020 2058 2c20 206e 5f63  .        X,  n_c
-0000fdb0: 6c75 7374 6572 7320 2c20 6e5f 696e 6974  lusters , n_init
-0000fdc0: 203d 2031 3020 2c20 6d61 785f 6974 6572   = 10 , max_iter
-0000fdd0: 203d 2033 3030 202c 2072 616e 646f 6d5f   = 300 , random_
-0000fde0: 7374 6174 653d 3432 202c 0d0a 2020 2020  state=42 ,..    
-0000fdf0: 2020 2020 6669 675f 7369 7a65 203d 2028      fig_size = (
-0000fe00: 3130 2c20 3420 292c 206d 6172 6b65 7220  10, 4 ), marker 
-0000fe10: 3d20 276f 272c 2073 6176 6566 6967 3d20  = 'o', savefig= 
-0000fe20: 4e6f 6e65 2c20 0d0a 2020 2020 2020 2020  None, ..        
-0000fe30: 2a2a 6b77 6429 3a20 0d0a 2020 2020 2222  **kwd): ..    ""
-0000fe40: 2220 506c 6f74 2065 6c62 6f77 206d 6574  " Plot elbow met
-0000fe50: 686f 6420 746f 2066 696e 6420 7468 6520  hod to find the 
-0000fe60: 6f70 7469 6d61 6c20 6e75 6d62 6572 206f  optimal number o
-0000fe70: 6620 636c 7573 7465 722c 206b 272c 200d  f cluster, k', .
-0000fe80: 0a20 2020 2066 6f72 2061 2067 6976 656e  .    for a given
-0000fe90: 2064 6174 612e 200d 0a20 2020 200d 0a20   data. ..    .. 
-0000fea0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0000feb0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0000fec0: 2020 2058 203a 207b 6172 7261 792d 6c69     X : {array-li
-0000fed0: 6b65 2c20 7370 6172 7365 206d 6174 7269  ke, sparse matri
-0000fee0: 787d 206f 6620 7368 6170 6520 286e 5f73  x} of shape (n_s
-0000fef0: 616d 706c 6573 2c20 6e5f 6665 6174 7572  amples, n_featur
-0000ff00: 6573 290d 0a20 2020 2020 2020 2054 7261  es)..        Tra
-0000ff10: 696e 696e 6720 696e 7374 616e 6365 7320  ining instances 
-0000ff20: 746f 2063 6c75 7374 6572 2e20 4974 206d  to cluster. It m
-0000ff30: 7573 7420 6265 206e 6f74 6564 2074 6861  ust be noted tha
-0000ff40: 7420 7468 6520 6461 7461 0d0a 2020 2020  t the data..    
-0000ff50: 2020 2020 7769 6c6c 2062 6520 636f 6e76      will be conv
-0000ff60: 6572 7465 6420 746f 2043 206f 7264 6572  erted to C order
-0000ff70: 696e 672c 2077 6869 6368 2077 696c 6c20  ing, which will 
-0000ff80: 6361 7573 6520 6120 6d65 6d6f 7279 0d0a  cause a memory..
-0000ff90: 2020 2020 2020 2020 636f 7079 2069 6620          copy if 
-0000ffa0: 7468 6520 6769 7665 6e20 6461 7461 2069  the given data i
-0000ffb0: 7320 6e6f 7420 432d 636f 6e74 6967 756f  s not C-contiguo
-0000ffc0: 7573 2e0d 0a20 2020 2020 2020 2049 6620  us...        If 
-0000ffd0: 6120 7370 6172 7365 206d 6174 7269 7820  a sparse matrix 
-0000ffe0: 6973 2070 6173 7365 642c 2061 2063 6f70  is passed, a cop
-0000fff0: 7920 7769 6c6c 2062 6520 6d61 6465 2069  y will be made i
-00010000: 6620 6974 2773 206e 6f74 2069 6e0d 0a20  f it's not in.. 
-00010010: 2020 2020 2020 2043 5352 2066 6f72 6d61         CSR forma
-00010020: 742e 0d0a 0d0a 2020 2020 6e5f 636c 7573  t.....    n_clus
-00010030: 7465 7273 203a 2069 6e74 2c20 6465 6661  ters : int, defa
-00010040: 756c 743d 380d 0a20 2020 2020 2020 2054  ult=8..        T
-00010050: 6865 206e 756d 6265 7220 6f66 2063 6c75  he number of clu
-00010060: 7374 6572 7320 746f 2066 6f72 6d20 6173  sters to form as
-00010070: 2077 656c 6c20 6173 2074 6865 206e 756d   well as the num
-00010080: 6265 7220 6f66 0d0a 2020 2020 2020 2020  ber of..        
-00010090: 6365 6e74 726f 6964 7320 746f 2067 656e  centroids to gen
-000100a0: 6572 6174 652e 0d0a 0d0a 2020 2020 6e5f  erate.....    n_
-000100b0: 696e 6974 203a 2069 6e74 2c20 6465 6661  init : int, defa
-000100c0: 756c 743d 3130 0d0a 2020 2020 2020 2020  ult=10..        
-000100d0: 4e75 6d62 6572 206f 6620 7469 6d65 2074  Number of time t
-000100e0: 6865 206b 2d6d 6561 6e73 2061 6c67 6f72  he k-means algor
-000100f0: 6974 686d 2077 696c 6c20 6265 2072 756e  ithm will be run
-00010100: 2077 6974 6820 6469 6666 6572 656e 740d   with different.
-00010110: 0a20 2020 2020 2020 2063 656e 7472 6f69  .        centroi
-00010120: 6420 7365 6564 732e 2054 6865 2066 696e  d seeds. The fin
-00010130: 616c 2072 6573 756c 7473 2077 696c 6c20  al results will 
-00010140: 6265 2074 6865 2062 6573 7420 6f75 7470  be the best outp
-00010150: 7574 206f 660d 0a20 2020 2020 2020 206e  ut of..        n
-00010160: 5f69 6e69 7420 636f 6e73 6563 7574 6976  _init consecutiv
-00010170: 6520 7275 6e73 2069 6e20 7465 726d 7320  e runs in terms 
-00010180: 6f66 2069 6e65 7274 6961 2e0d 0a0d 0a20  of inertia..... 
-00010190: 2020 206d 6178 5f69 7465 7220 3a20 696e     max_iter : in
-000101a0: 742c 2064 6566 6175 6c74 3d33 3030 0d0a  t, default=300..
-000101b0: 2020 2020 2020 2020 4d61 7869 6d75 6d20          Maximum 
-000101c0: 6e75 6d62 6572 206f 6620 6974 6572 6174  number of iterat
-000101d0: 696f 6e73 206f 6620 7468 6520 6b2d 6d65  ions of the k-me
-000101e0: 616e 7320 616c 676f 7269 7468 6d20 666f  ans algorithm fo
-000101f0: 7220 610d 0a20 2020 2020 2020 2073 696e  r a..        sin
-00010200: 676c 6520 7275 6e2e 0d0a 0d0a 2020 2020  gle run.....    
-00010210: 746f 6c20 3a20 666c 6f61 742c 2064 6566  tol : float, def
-00010220: 6175 6c74 3d31 652d 340d 0a20 2020 2020  ault=1e-4..     
-00010230: 2020 2052 656c 6174 6976 6520 746f 6c65     Relative tole
-00010240: 7261 6e63 6520 7769 7468 2072 6567 6172  rance with regar
-00010250: 6473 2074 6f20 4672 6f62 656e 6975 7320  ds to Frobenius 
-00010260: 6e6f 726d 206f 6620 7468 6520 6469 6666  norm of the diff
-00010270: 6572 656e 6365 0d0a 2020 2020 2020 2020  erence..        
-00010280: 696e 2074 6865 2063 6c75 7374 6572 2063  in the cluster c
-00010290: 656e 7465 7273 206f 6620 7477 6f20 636f  enters of two co
-000102a0: 6e73 6563 7574 6976 6520 6974 6572 6174  nsecutive iterat
-000102b0: 696f 6e73 2074 6f20 6465 636c 6172 650d  ions to declare.
-000102c0: 0a20 2020 2020 2020 2063 6f6e 7665 7267  .        converg
-000102d0: 656e 6365 2e0d 0a0d 0a20 2020 2076 6572  ence.....    ver
-000102e0: 626f 7365 203a 2069 6e74 2c20 6465 6661  bose : int, defa
-000102f0: 756c 743d 300d 0a20 2020 2020 2020 2056  ult=0..        V
-00010300: 6572 626f 7369 7479 206d 6f64 652e 0d0a  erbosity mode...
-00010310: 0d0a 2020 2020 7261 6e64 6f6d 5f73 7461  ..    random_sta
-00010320: 7465 203a 2069 6e74 2c20 5261 6e64 6f6d  te : int, Random
-00010330: 5374 6174 6520 696e 7374 616e 6365 206f  State instance o
-00010340: 7220 4e6f 6e65 2c20 6465 6661 756c 743d  r None, default=
-00010350: 3432 0d0a 2020 2020 2020 2020 4465 7465  42..        Dete
-00010360: 726d 696e 6573 2072 616e 646f 6d20 6e75  rmines random nu
-00010370: 6d62 6572 2067 656e 6572 6174 696f 6e20  mber generation 
-00010380: 666f 7220 6365 6e74 726f 6964 2069 6e69  for centroid ini
-00010390: 7469 616c 697a 6174 696f 6e2e 2055 7365  tialization. Use
-000103a0: 0d0a 2020 2020 2020 2020 616e 2069 6e74  ..        an int
-000103b0: 2074 6f20 6d61 6b65 2074 6865 2072 616e   to make the ran
-000103c0: 646f 6d6e 6573 7320 6465 7465 726d 696e  domness determin
-000103d0: 6973 7469 632e 0d0a 2020 2020 2020 2020  istic...        
-000103e0: 0d0a 2020 2020 7361 7665 6669 673a 2073  ..    savefig: s
-000103f0: 7472 2c20 6465 6661 756c 7420 3d4e 6f6e  tr, default =Non
-00010400: 6520 2c20 0d0a 2020 2020 2020 2020 7468  e , ..        th
-00010410: 6520 7061 7468 2074 6f20 7361 7665 2074  e path to save t
-00010420: 6865 2066 6967 7572 652e 2041 7267 756d  he figure. Argum
-00010430: 656e 7420 6973 2070 6173 7365 6420 746f  ent is passed to
-00010440: 200d 0a20 2020 2020 2020 203a 636c 6173   ..        :clas
-00010450: 733a 606d 6174 706c 6f74 6c69 622e 4669  s:`matplotlib.Fi
-00010460: 6775 7265 6020 636c 6173 732e 200d 0a20  gure` class. .. 
-00010470: 2020 206d 6172 6b65 723a 2073 7472 2c20     marker: str, 
-00010480: 6465 6661 756c 743d 276f 272c 200d 0a20  default='o', .. 
-00010490: 2020 2020 2020 2063 6c75 7374 6572 206d         cluster m
-000104a0: 6172 6b65 7220 706f 696e 742e 200d 0a20  arker point. .. 
-000104b0: 2020 2020 2020 200d 0a20 2020 206b 7764         ..    kwd
-000104c0: 3a20 6469 6374 0d0a 2020 2020 2020 2020  : dict..        
-000104d0: 4164 6469 6f6e 6e61 6c20 6b65 7977 6f72  Addionnal keywor
-000104e0: 6473 2061 7267 756d 656e 7473 2070 6173  ds arguments pas
-000104f0: 7365 6420 746f 203a 6675 6e63 3a60 6d61  sed to :func:`ma
-00010500: 7470 6c6f 746c 6962 2e70 7970 6c6f 742e  tplotlib.pyplot.
-00010510: 706c 6f74 600d 0a20 2020 2020 2020 200d  plot`..        .
-00010520: 0a20 2020 2052 6574 7572 6e73 200d 0a20  .    Returns .. 
-00010530: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
-00010540: 2061 783a 204d 6174 706c 6f74 6c69 622e   ax: Matplotlib.
-00010550: 7079 706c 6f74 2061 7865 7320 6f62 6a65  pyplot axes obje
-00010560: 6374 7320 0d0a 2020 2020 0d0a 2020 2020  cts ..    ..    
-00010570: 4578 616d 706c 650d 0a20 2020 202d 2d2d  Example..    ---
-00010580: 2d2d 2d2d 2d2d 0d0a 2020 2020 3e3e 3e20  ------..    >>> 
-00010590: 6672 6f6d 2077 6174 6578 2e64 6174 6173  from watex.datas
-000105a0: 6574 7320 696d 706f 7274 206c 6f61 645f  ets import load_
-000105b0: 686c 6f67 7320 0d0a 2020 2020 3e3e 3e20  hlogs ..    >>> 
-000105c0: 6672 6f6d 2077 6174 6578 2e75 7469 6c73  from watex.utils
-000105d0: 2e70 6c6f 7475 7469 6c73 2069 6d70 6f72  .plotutils impor
-000105e0: 7420 706c 6f74 5f65 6c62 6f77 200d 0a20  t plot_elbow .. 
-000105f0: 2020 203e 3e3e 2023 2067 6574 2074 6865     >>> # get the
-00010600: 206f 6e6c 7920 7265 7369 7374 6976 7920   only resistivy 
-00010610: 616e 6420 6761 6d6d 612d 6761 6d61 2076  and gamma-gama v
-00010620: 616c 7565 7320 666f 7220 6578 616d 706c  alues for exampl
-00010630: 650d 0a20 2020 203e 3e3e 2072 6573 5f67  e..    >>> res_g
-00010640: 616d 6d61 203d 206c 6f61 645f 686c 6f67  amma = load_hlog
-00010650: 7320 2829 2e66 7261 6d65 5b5b 2772 6573  s ().frame[['res
-00010660: 6973 7469 7669 7479 272c 2027 6761 6d6d  istivity', 'gamm
-00010670: 615f 6761 6d6d 6127 5d5d 2020 0d0a 2020  a_gamma']]  ..  
-00010680: 2020 3e3e 3e20 706c 6f74 5f65 6c62 6f77    >>> plot_elbow
-00010690: 2872 6573 5f67 616d 6d61 2c20 6e5f 636c  (res_gamma, n_cl
-000106a0: 7573 7465 7273 3d31 3129 0d0a 2020 2020  usters=11)..    
-000106b0: 0d0a 2020 2020 2222 220d 0a20 2020 2064  ..    """..    d
-000106c0: 6973 746f 7273 696f 6e73 203d 5b5d 203b  istorsions =[] ;
-000106d0: 206e 5f63 6c75 7374 6572 7320 3d20 3131   n_clusters = 11
-000106e0: 0d0a 2020 2020 666f 7220 6920 696e 2072  ..    for i in r
-000106f0: 616e 6765 2028 312c 206e 5f63 6c75 7374  ange (1, n_clust
-00010700: 6572 7320 293a 200d 0a20 2020 2020 2020  ers ): ..       
-00010710: 206b 6d20 3d4b 4d65 616e 7320 286e 5f63   km =KMeans (n_c
-00010720: 6c75 7374 6572 7320 3d69 202c 2069 6e69  lusters =i , ini
-00010730: 743d 2027 6b2d 6d65 616e 732b 2b27 2c20  t= 'k-means++', 
-00010740: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010750: 2020 2020 2020 6e5f 696e 6974 3d6e 5f69        n_init=n_i
-00010760: 6e69 7420 2c20 6d61 785f 6974 6572 3d6d  nit , max_iter=m
-00010770: 6178 5f69 7465 722c 200d 0a20 2020 2020  ax_iter, ..     
-00010780: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00010790: 616e 646f 6d5f 7374 6174 6520 3d72 616e  andom_state =ran
-000107a0: 646f 6d5f 7374 6174 6520 0d0a 2020 2020  dom_state ..    
-000107b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000107c0: 290d 0a20 2020 2020 2020 206b 6d2e 6669  )..        km.fi
-000107d0: 7428 5829 200d 0a20 2020 2020 2020 2064  t(X) ..        d
-000107e0: 6973 746f 7273 696f 6e73 2e61 7070 656e  istorsions.appen
-000107f0: 6428 6b6d 2e69 6e65 7274 6961 5f29 200d  d(km.inertia_) .
-00010800: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
-00010810: 2020 2061 7820 3d20 5f70 6c6f 745f 656c     ax = _plot_el
-00010820: 626f 7720 2864 6973 746f 7273 696f 6e73  bow (distorsions
-00010830: 2c20 6e5f 636c 7573 7465 7273 203d 6e5f  , n_clusters =n_
-00010840: 636c 7573 7465 7273 2c66 6967 5f73 697a  clusters,fig_siz
-00010850: 6520 3d20 6669 675f 7369 7a65 202c 0d0a  e = fig_size ,..
-00010860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010870: 2020 2020 2020 6d61 726b 6572 203d 6d61        marker =ma
-00010880: 726b 6572 202c 2073 6176 6566 6967 203d  rker , savefig =
-00010890: 7361 7665 6669 672c 202a 2a6b 7764 2920  savefig, **kwd) 
-000108a0: 0d0a 0d0a 2020 2020 7265 7475 726e 2061  ....    return a
-000108b0: 7820 0d0a 2020 2020 0d0a 6465 6620 5f70  x ..    ..def _p
-000108c0: 6c6f 745f 656c 626f 7720 2864 6973 746f  lot_elbow (disto
-000108d0: 7273 696f 6e73 3a20 6c69 7374 2020 2c20  rsions: list  , 
-000108e0: 6e5f 636c 7573 7465 7273 3a69 6e74 202c  n_clusters:int ,
-000108f0: 6669 675f 7369 7a65 203d 2028 3130 202c  fig_size = (10 ,
-00010900: 2034 2029 2c20 200d 0a20 2020 2020 2020   4 ),  ..       
-00010910: 2020 2020 2020 2020 6d61 726b 6572 3d27          marker='
-00010920: 6f27 2c20 7361 7665 6669 6720 3d4e 6f6e  o', savefig =Non
-00010930: 652c 202a 2a6b 7764 293a 200d 0a20 2020  e, **kwd): ..   
-00010940: 2022 2222 2050 6c6f 7420 7468 6520 6f70   """ Plot the op
-00010950: 7469 6d61 6c20 6e75 6d62 6572 206f 6620  timal number of 
-00010960: 636c 7573 7465 722c 206b 272c 2066 6f72  cluster, k', for
-00010970: 2061 2067 6976 656e 2063 6c61 7373 200d   a given class .
-00010980: 0a20 2020 200d 0a20 2020 203a 7061 7261  .    ..    :para
-00010990: 6d20 6469 7374 6f72 7369 6f6e 733a 206c  m distorsions: l
-000109a0: 6973 7420 2d20 6c69 7374 206f 6620 7661  ist - list of va
-000109b0: 6c75 6573 2077 6974 6869 6e67 2074 6865  lues withing the
-000109c0: 2073 756d 2d73 7175 6172 6564 2d65 7272   sum-squared-err
-000109d0: 6f72 200d 0a20 2020 2020 2020 2028 5353  or ..        (SS
-000109e0: 4529 2061 6c73 6f20 6361 6c6c 6564 2020  E) also called  
-000109f0: 6069 6e65 7274 6961 5f60 2069 6e20 7363  `inertia_` in sc
-00010a00: 6b69 742d 6c65 6172 6e2e 200d 0a20 2020  kit-learn. ..   
-00010a10: 200d 0a20 2020 203a 7061 7261 6d20 6e5f   ..    :param n_
-00010a20: 636c 7573 7465 7273 3a20 6e75 6d62 6572  clusters: number
-00010a30: 206f 6620 636c 7573 7465 7273 2e20 7768   of clusters. wh
-00010a40: 6572 6520 6b20 7374 6172 7473 2061 6e64  ere k starts and
-00010a50: 2065 6e64 2e20 0d0a 2020 2020 0d0a 2020   end. ..    ..  
-00010a60: 2020 3a72 6574 7572 6e73 3a20 6178 3a20    :returns: ax: 
-00010a70: 4d61 7470 6c6f 746c 6962 2e70 7970 6c6f  Matplotlib.pyplo
-00010a80: 7420 6178 6573 206f 626a 6563 7473 200d  t axes objects .
-00010a90: 0a20 2020 200d 0a20 2020 203a 4578 616d  .    ..    :Exam
-00010aa0: 706c 653a 200d 0a20 2020 203e 3e3e 2069  ple: ..    >>> i
-00010ab0: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
-00010ac0: 7020 0d0a 2020 2020 3e3e 3e20 6672 6f6d  p ..    >>> from
-00010ad0: 2073 6b6c 6561 726e 2e63 6c75 7374 6572   sklearn.cluster
-00010ae0: 2069 6d70 6f72 7420 4b4d 6561 6e73 200d   import KMeans .
-00010af0: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
-00010b00: 7465 782e 6461 7461 7365 7473 2069 6d70  tex.datasets imp
-00010b10: 6f72 7420 6c6f 6164 5f69 7269 7320 0d0a  ort load_iris ..
-00010b20: 2020 2020 3e3e 3e20 6672 6f6d 2077 6174      >>> from wat
-00010b30: 6578 2e75 7469 6c73 2e70 6c6f 7475 7469  ex.utils.plotuti
-00010b40: 6c73 2069 6d70 6f72 7420 706c 6f74 5f65  ls import plot_e
-00010b50: 6c62 6f77 0d0a 2020 2020 3e3e 3e20 643d  lbow..    >>> d=
-00010b60: 206c 6f61 645f 6972 6973 2028 290d 0a20   load_iris ().. 
-00010b70: 2020 203e 3e3e 2058 3d20 642e 6461 7461     >>> X= d.data
-00010b80: 205b 3a2c 2030 5d5b 3a2c 206e 702e 6e65   [:, 0][:, np.ne
-00010b90: 7761 7869 735d 2023 2074 616b 6520 7468  waxis] # take th
-00010ba0: 6520 6669 7273 7420 6178 6973 200d 0a20  e first axis .. 
-00010bb0: 2020 203e 3e3e 2023 2063 6f6d 7075 7465     >>> # compute
-00010bc0: 2064 6973 746f 7273 696f 736e 2066 6f72   distorsiosn for
-00010bd0: 204b 4d65 616e 7320 7261 6e67 6520 0d0a   KMeans range ..
-00010be0: 2020 2020 3e3e 3e20 6469 7374 6f72 7369      >>> distorsi
-00010bf0: 6f6e 7320 3d5b 5d20 3b20 6e5f 636c 7573  ons =[] ; n_clus
-00010c00: 7465 7273 203d 2031 310d 0a20 2020 203e  ters = 11..    >
-00010c10: 3e3e 2066 6f72 2069 2069 6e20 7261 6e67  >> for i in rang
-00010c20: 6520 2831 2c20 6e5f 636c 7573 7465 7273  e (1, n_clusters
-00010c30: 2029 3a20 0d0a 2020 2020 2020 2020 2020   ): ..          
-00010c40: 2020 6b6d 203d 4b4d 6561 6e73 2028 6e5f    km =KMeans (n_
-00010c50: 636c 7573 7465 7273 203d 6920 2c20 0d0a  clusters =i , ..
-00010c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010c70: 2020 2020 2020 2020 696e 6974 3d20 276b          init= 'k
-00010c80: 2d6d 6561 6e73 2b2b 272c 200d 0a20 2020  -means++', ..   
-00010c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ca0: 2020 2020 206e 5f69 6e69 743d 3130 202c       n_init=10 ,
-00010cb0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00010cc0: 2020 2020 2020 2020 2020 206d 6178 5f69             max_i
-00010cd0: 7465 723d 3330 302c 200d 0a20 2020 2020  ter=300, ..     
-00010ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010cf0: 2020 2072 616e 646f 6d5f 7374 6174 6520     random_state 
-00010d00: 3d30 200d 0a20 2020 2020 2020 2020 2020  =0 ..           
-00010d10: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
-00010d20: 2020 2020 2020 2020 2020 2020 6b6d 2e66              km.f
-00010d30: 6974 2858 2920 0d0a 2020 2020 2020 2020  it(X) ..        
-00010d40: 2020 2020 6469 7374 6f72 7369 6f6e 732e      distorsions.
-00010d50: 6170 7065 6e64 286b 6d2e 696e 6572 7469  append(km.inerti
-00010d60: 615f 2920 0d0a 2020 2020 3e3e 3e20 706c  a_) ..    >>> pl
-00010d70: 6f74 5f65 6c62 6f77 2028 6469 7374 6f72  ot_elbow (distor
-00010d80: 7369 6f6e 732c 206e 5f63 6c75 7374 6572  sions, n_cluster
-00010d90: 7320 3d6e 5f63 6c75 7374 6572 7329 0d0a  s =n_clusters)..
-00010da0: 2020 2020 2020 2020 0d0a 2020 2020 2222          ..    ""
-00010db0: 220d 0a20 2020 2066 6967 2c20 6178 203d  "..    fig, ax =
-00010dc0: 2070 6c74 2e73 7562 706c 6f74 7320 2820   plt.subplots ( 
-00010dd0: 6e72 6f77 733d 3120 2c20 6e63 6f6c 7320  nrows=1 , ncols 
-00010de0: 3d31 202c 2066 6967 7369 7a65 203d 2066  =1 , figsize = f
-00010df0: 6967 5f73 697a 6520 2920 0d0a 2020 2020  ig_size ) ..    
-00010e00: 0d0a 2020 2020 6178 2e70 6c6f 7420 2872  ..    ax.plot (r
-00010e10: 616e 6765 2028 312c 206e 5f63 6c75 7374  ange (1, n_clust
-00010e20: 6572 7329 2c20 6469 7374 6f72 7369 6f6e  ers), distorsion
-00010e30: 7320 2c20 6d61 726b 6572 203d 206d 6172  s , marker = mar
-00010e40: 6b65 722c 200d 0a20 2020 2020 2020 2020  ker, ..         
-00010e50: 2020 2020 202a 2a6b 7764 2029 0d0a 2020       **kwd )..  
-00010e60: 2020 706c 742e 786c 6162 656c 2028 224e    plt.xlabel ("N
-00010e70: 756d 6265 7220 6f66 2063 6c75 7374 6572  umber of cluster
-00010e80: 7322 2920 0d0a 2020 2020 706c 742e 796c  s") ..    plt.yl
-00010e90: 6162 656c 2028 2244 6973 746f 7273 696f  abel ("Distorsio
-00010ea0: 6e22 290d 0a20 2020 2070 6c74 2e74 6967  n")..    plt.tig
-00010eb0: 6874 5f6c 6179 6f75 7428 290d 0a20 2020  ht_layout()..   
-00010ec0: 200d 0a20 2020 2069 6620 7361 7665 6669   ..    if savefi
-00010ed0: 6720 6973 206e 6f74 204e 6f6e 653a 200d  g is not None: .
-00010ee0: 0a20 2020 2020 2020 2073 6176 6566 6967  .        savefig
-00010ef0: 7572 6528 6669 672c 2073 6176 6566 6967  ure(fig, savefig
-00010f00: 2029 0d0a 2020 2020 706c 742e 7368 6f77   )..    plt.show
-00010f10: 2829 2069 6620 7361 7665 6669 6720 6973  () if savefig is
-00010f20: 204e 6f6e 6520 656c 7365 2070 6c74 2e63   None else plt.c
-00010f30: 6c6f 7365 2028 2920 0d0a 2020 2020 0d0a  lose () ..    ..
-00010f40: 2020 2020 7265 7475 726e 2061 7820 0d0a      return ax ..
-00010f50: 0d0a 0d0a 6465 6620 706c 6f74 5f63 6f73  ....def plot_cos
-00010f60: 745f 7673 5f65 706f 6368 7328 7265 6773  t_vs_epochs(regs
-00010f70: 2c20 2a2c 2020 6669 675f 7369 7a65 203d  , *,  fig_size =
-00010f80: 2028 3130 202c 2034 2029 2c20 6d61 726b   (10 , 4 ), mark
-00010f90: 6572 203d 276f 272c 200d 0a20 2020 2020  er ='o', ..     
-00010fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010fb0: 7361 7665 6669 6720 3d4e 6f6e 652c 202a  savefig =None, *
-00010fc0: 2a6b 7773 293a 200d 0a20 2020 2022 2222  *kws): ..    """
-00010fd0: 2050 6c6f 7420 7468 6520 636f 7374 2061   Plot the cost a
-00010fe0: 6761 696e 7374 2074 6865 206e 756d 6265  gainst the numbe
-00010ff0: 7220 6f66 2065 706f 6368 7320 2066 6f72  r of epochs  for
-00011000: 2074 6865 2074 776f 2064 6966 6665 7265   the two differe
-00011010: 6e74 200d 0a20 2020 206c 6561 726e 696e  nt ..    learnin
-00011020: 6773 2072 6174 6573 200d 0a20 2020 200d  gs rates ..    .
-00011030: 0a20 2020 2050 6172 616d 6574 6572 7320  .    Parameters 
-00011040: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
-00011050: 0d0a 2020 2020 7265 6773 3a20 4361 6c6c  ..    regs: Call
-00011060: 6162 6c65 2c20 7369 6e67 6c65 206f 7220  able, single or 
-00011070: 6c69 7374 206f 6620 7265 6772 6573 7369  list of regressi
-00011080: 6f6e 2065 7374 696d 6174 6f72 7320 0d0a  on estimators ..
-00011090: 2020 2020 2020 2020 4573 7469 6d61 746f          Estimato
-000110a0: 7220 7368 6f75 6c64 2062 6520 616c 7265  r should be alre
-000110b0: 6164 7920 6669 7474 6564 2e0d 0a20 2020  ady fitted...   
-000110c0: 2066 6967 5f73 697a 653a 2074 7570 6c65   fig_size: tuple
-000110d0: 202c 2064 6566 6175 6c74 2069 7320 2831   , default is (1
-000110e0: 302c 2034 290d 0a20 2020 2020 2020 2074  0, 4)..        t
-000110f0: 6865 2073 697a 6520 6f66 2066 6967 7572  he size of figur
-00011100: 6520 0d0a 2020 2020 6b77 733a 2064 6963  e ..    kws: dic
-00011110: 7420 2c20 0d0a 2020 2020 2020 2020 4164  t , ..        Ad
-00011120: 6469 7469 6f6e 6e61 6c20 6b65 7977 6f72  ditionnal keywor
-00011130: 6473 2061 7267 756d 656e 7473 2070 6173  ds arguments pas
-00011140: 7365 7320 746f 203a 6675 6e63 3a60 6d61  ses to :func:`ma
-00011150: 7470 6c6f 746c 6962 2e70 7970 6c6f 742e  tplotlib.pyplot.
-00011160: 706c 6f74 600d 0a20 2020 2052 6574 7572  plot`..    Retur
-00011170: 6e73 200d 0a20 2020 202d 2d2d 2d2d 2d2d  ns ..    -------
-00011180: 200d 0a20 2020 2061 783a 204d 6174 706c   ..    ax: Matpl
-00011190: 6f74 6c69 622e 7079 706c 6f74 2061 7865  otlib.pyplot axe
-000111a0: 7320 6f62 6a65 6374 7320 0d0a 2020 2020  s objects ..    
-000111b0: 0d0a 2020 2020 4578 616d 706c 6573 200d  ..    Examples .
-000111c0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a  .    ---------..
-000111d0: 0d0a 2020 2020 3e3e 3e20 6672 6f6d 2077  ..    >>> from w
-000111e0: 6174 6578 2e64 6174 6173 6574 7320 696d  atex.datasets im
-000111f0: 706f 7274 206c 6f61 645f 6972 6973 200d  port load_iris .
-00011200: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
-00011210: 7465 782e 6261 7365 2069 6d70 6f72 7420  tex.base import 
-00011220: 4164 616c 696e 6547 7261 6469 656e 7444  AdalineGradientD
-00011230: 6573 6365 6e74 0d0a 2020 2020 3e3e 3e20  escent..    >>> 
-00011240: 6672 6f6d 2077 6174 6578 2e75 7469 6c73  from watex.utils
-00011250: 2e70 6c6f 7475 7469 6c73 2069 6d70 6f72  .plotutils impor
-00011260: 7420 706c 6f74 5f63 6f73 745f 7673 5f65  t plot_cost_vs_e
-00011270: 706f 6368 730d 0a20 2020 203e 3e3e 2058  pochs..    >>> X
-00011280: 2c20 7920 3d20 6c6f 6164 5f69 7269 7320  , y = load_iris 
-00011290: 2872 6574 7572 6e5f 585f 793d 2054 7275  (return_X_y= Tru
-000112a0: 6520 290d 0a20 2020 203e 3e3e 2061 6461  e )..    >>> ada
-000112b0: 3120 3d20 4164 616c 696e 6547 7261 6469  1 = AdalineGradi
-000112c0: 656e 7444 6573 6365 6e74 2028 6e5f 6974  entDescent (n_it
-000112d0: 6572 3d20 3130 202c 2065 7461 3d20 2e30  er= 10 , eta= .0
-000112e0: 3120 292e 6669 7428 582c 2079 2920 0d0a  1 ).fit(X, y) ..
-000112f0: 2020 2020 3e3e 3e20 6164 6132 203d 2041      >>> ada2 = A
-00011300: 6461 6c69 6e65 4772 6164 6965 6e74 4465  dalineGradientDe
-00011310: 7363 656e 7420 286e 5f69 7465 723d 3130  scent (n_iter=10
-00011320: 202c 2065 7461 203d 2e30 3030 3120 292e   , eta =.0001 ).
-00011330: 6669 7428 582c 2079 290d 0a20 2020 203e  fit(X, y)..    >
-00011340: 3e3e 2070 6c6f 745f 636f 7374 5f76 735f  >> plot_cost_vs_
-00011350: 6570 6f63 6873 2028 7265 6773 203d 205b  epochs (regs = [
-00011360: 6164 6131 2c20 6164 6132 5d20 2920 0d0a  ada1, ada2] ) ..
-00011370: 2020 2020 2222 220d 0a20 2020 2069 6620      """..    if 
-00011380: 6e6f 7420 6973 696e 7374 616e 6365 2028  not isinstance (
-00011390: 7265 6773 2c20 286c 6973 742c 2074 7570  regs, (list, tup
-000113a0: 6c65 2c20 6e70 2e61 7272 6179 2929 3a20  le, np.array)): 
-000113b0: 0d0a 2020 2020 2020 2020 7265 6773 203d  ..        regs =
-000113c0: 5b72 6567 735d 0d0a 2020 2020 7320 3d20  [regs]..    s = 
-000113d0: 7365 7420 285b 6861 7361 7474 7228 6f2c  set ([hasattr(o,
-000113e0: 2027 5f5f 636c 6173 735f 5f27 2920 666f   '__class__') fo
-000113f0: 7220 6f20 696e 2072 6567 7320 5d29 0d0a  r o in regs ])..
-00011400: 0d0a 2020 2020 6966 206c 656e 2873 2920  ..    if len(s) 
-00011410: 213d 2031 3a20 0d0a 2020 2020 2020 2020  != 1: ..        
-00011420: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00011430: 2822 416c 6c20 7265 6772 6573 7369 6f6e  ("All regression
-00011440: 206d 6f64 656c 7320 7368 6f75 6c64 2062   models should b
-00011450: 6520 6573 7469 6d61 746f 7273 220d 0a20  e estimators".. 
-00011460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011470: 2020 2020 2020 2020 2220 616c 7265 6164          " alread
-00011480: 7920 6669 7474 6564 2e22 290d 0a20 2020  y fitted.")..   
-00011490: 2069 6620 6e6f 7420 6c69 7374 2873 2920   if not list(s) 
-000114a0: 5b30 5d20 3a20 0d0a 2020 2020 2020 2020  [0] : ..        
-000114b0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-000114c0: 6622 4e65 6564 7320 616e 2065 7374 696d  f"Needs an estim
-000114d0: 6174 6f72 2c20 676f 7420 7b74 7970 6528  ator, got {type(
-000114e0: 735b 305d 292e 5f5f 6e61 6d65 5f5f 2172  s[0]).__name__!r
-000114f0: 7d22 290d 0a20 2020 200d 0a20 2020 2066  }")..    ..    f
-00011500: 6967 2c20 6178 203d 2070 6c74 2e73 7562  ig, ax = plt.sub
-00011510: 706c 6f74 7320 2820 6e72 6f77 733d 3120  plots ( nrows=1 
-00011520: 2c20 6e63 6f6c 7320 3d6c 656e 2872 6567  , ncols =len(reg
-00011530: 7329 202c 2066 6967 7369 7a65 203d 2066  s) , figsize = f
-00011540: 6967 5f73 697a 6520 2920 0d0a 2020 2020  ig_size ) ..    
-00011550: 0d0a 2020 2020 666f 7220 6b2c 206d 2069  ..    for k, m i
-00011560: 6e20 656e 756d 6572 6174 6520 2872 6567  n enumerate (reg
-00011570: 7329 2020 3a20 0d0a 2020 2020 2020 2020  s)  : ..        
-00011580: 0d0a 2020 2020 2020 2020 6178 5b6b 5d2e  ..        ax[k].
-00011590: 706c 6f74 2872 616e 6765 2831 2c20 6c65  plot(range(1, le
-000115a0: 6e28 6d2e 636f 7374 5f29 2b20 3120 292c  n(m.cost_)+ 1 ),
-000115b0: 206e 702e 6c6f 6731 3020 286d 2e63 6f73   np.log10 (m.cos
-000115c0: 745f 292c 0d0a 2020 2020 2020 2020 2020  t_),..          
-000115d0: 2020 2020 2020 2020 206d 6172 6b65 7220           marker 
-000115e0: 3d6d 6172 6b65 722c 202a 2a6b 7773 290d  =marker, **kws).
-000115f0: 0a20 2020 2020 2020 2061 785b 6b5d 2e73  .        ax[k].s
-00011600: 6574 5f78 6c61 6265 6c20 2822 4570 6f63  et_xlabel ("Epoc
-00011610: 6873 2229 200d 0a20 2020 2020 2020 2061  hs") ..        a
-00011620: 785b 6b5d 2e73 6574 5f79 6c61 6265 6c20  x[k].set_ylabel 
-00011630: 2822 4c6f 6728 7375 6d2d 7371 7561 7265  ("Log(sum-square
-00011640: 642d 6572 726f 7229 2229 0d0a 2020 2020  d-error)")..    
-00011650: 2020 2020 6178 5b6b 5d2e 7365 745f 7469      ax[k].set_ti
-00011660: 746c 6528 2225 7320 2d4c 6561 726e 696e  tle("%s -Learnin
-00011670: 6720 7261 7465 2025 2e34 6622 2025 2028  g rate %.4f" % (
-00011680: 6d2e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  m.__class__.__na
-00011690: 6d65 5f5f 2c20 6d2e 6574 6120 2929 200d  me__, m.eta )) .
-000116a0: 0a20 2020 2020 2020 200d 0a20 2020 2069  .        ..    i
-000116b0: 6620 7361 7665 6669 6720 6973 206e 6f74  f savefig is not
-000116c0: 204e 6f6e 653a 200d 0a20 2020 2020 2020   None: ..       
-000116d0: 2073 6176 6566 6967 7572 6528 6669 672c   savefigure(fig,
-000116e0: 2073 6176 6566 6967 2029 0d0a 2020 2020   savefig )..    
-000116f0: 706c 742e 7368 6f77 2829 2069 6620 7361  plt.show() if sa
-00011700: 7665 6669 6720 6973 204e 6f6e 6520 656c  vefig is None el
-00011710: 7365 2070 6c74 2e63 6c6f 7365 2028 2920  se plt.close () 
-00011720: 0d0a 2020 2020 0d0a 2020 2020 7265 7475  ..    ..    retu
-00011730: 726e 2061 7820 0d0a 0d0a 6465 6620 706c  rn ax ....def pl
-00011740: 6f74 5f6d 6c78 7465 6e64 5f68 6561 746d  ot_mlxtend_heatm
-00011750: 6170 2028 6466 2c20 636f 6c75 6d6e 7320  ap (df, columns 
-00011760: 3d4e 6f6e 652c 2073 6176 6566 6967 3d4e  =None, savefig=N
-00011770: 6f6e 652c 2020 2a2a 6b77 7329 3a20 0d0a  one,  **kws): ..
-00011780: 2020 2020 2222 2220 506c 6f74 2063 6f72      """ Plot cor
-00011790: 7265 6c61 7469 6f6e 206d 6174 7269 7820  relation matrix 
-000117a0: 6172 7261 7920 2061 7320 6120 6865 6174  array  as a heat
-000117b0: 206d 6170 200d 0a20 2020 200d 0a20 2020   map ..    ..   
-000117c0: 203a 7061 7261 6d20 6466 3a20 6461 7461   :param df: data
-000117d0: 6672 616d 6520 7061 6e64 6173 2020 0d0a  frame pandas  ..
-000117e0: 2020 2020 3a70 6172 616d 2063 6f6c 756d      :param colum
-000117f0: 6e73 3a20 6c69 7374 206f 6620 6665 6174  ns: list of feat
-00011800: 7572 6573 2c20 0d0a 2020 2020 2020 2020  ures, ..        
-00011810: 4966 2067 6976 656e 2c20 6f6e 6c79 2074  If given, only t
-00011820: 6865 2064 6174 6166 7261 6d65 2077 6974  he dataframe wit
-00011830: 6820 7468 6174 2066 6561 7475 7265 7320  h that features 
-00011840: 6973 2063 6f6e 7369 6465 7265 642e 200d  is considered. .
-00011850: 0a20 2020 203a 7061 7261 6d20 6b77 733a  .    :param kws:
-00011860: 2061 6464 6974 696f 6e61 6c20 6b65 7977   additional keyw
-00011870: 6f72 6420 6172 6775 6d65 6e74 7320 7061  ord arguments pa
-00011880: 7373 6564 2074 6f20 0d0a 2020 2020 2020  ssed to ..      
-00011890: 2020 3a66 756e 633a 606d 6c78 7465 6e64    :func:`mlxtend
-000118a0: 2e70 6c6f 7474 696e 672e 6865 6174 6d61  .plotting.heatma
-000118b0: 7060 0d0a 2020 2020 3a72 6574 7572 6e3a  p`..    :return:
-000118c0: 203a 6675 6e63 3a60 6d6c 7874 656e 642e   :func:`mlxtend.
-000118d0: 706c 6f74 7469 6e67 2e68 6561 746d 6170  plotting.heatmap
-000118e0: 6020 6178 6573 206f 626a 6563 7420 0d0a  ` axes object ..
-000118f0: 2020 2020 0d0a 2020 2020 3a65 7861 6d70      ..    :examp
-00011900: 6c65 3a20 0d0a 2020 2020 2020 2020 0d0a  le: ..        ..
-00011910: 2020 2020 3e3e 3e20 6672 6f6d 2077 6174      >>> from wat
-00011920: 6578 2e64 6174 6173 6574 7320 696d 706f  ex.datasets impo
-00011930: 7274 206c 6f61 645f 686c 6f67 7320 0d0a  rt load_hlogs ..
-00011940: 2020 2020 3e3e 3e20 6672 6f6d 2077 6174      >>> from wat
-00011950: 6578 2e75 7469 6c73 2e70 6c6f 7475 7469  ex.utils.plotuti
-00011960: 6c73 2069 6d70 6f72 7420 706c 6f74 5f6d  ls import plot_m
-00011970: 6c78 7465 6e64 5f68 6561 746d 6170 0d0a  lxtend_heatmap..
-00011980: 2020 2020 3e3e 3e20 683d 6c6f 6164 5f68      >>> h=load_h
-00011990: 6c6f 6773 2829 0d0a 2020 2020 3e3e 3e20  logs()..    >>> 
-000119a0: 6665 6174 7572 6573 203d 205b 2767 616d  features = ['gam
-000119b0: 6d61 5f67 616d 6d61 272c 2027 7370 272c  ma_gamma', 'sp',
-000119c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000119d0: 2020 276e 6174 7572 616c 5f67 616d 6d61    'natural_gamma
-000119e0: 272c 2027 7265 7369 7374 6976 6974 7927  ', 'resistivity'
-000119f0: 5d0d 0a20 2020 203e 3e3e 2070 6c6f 745f  ]..    >>> plot_
-00011a00: 6d6c 7874 656e 645f 6865 6174 6d61 7020  mlxtend_heatmap 
-00011a10: 2868 2e66 7261 6d65 202c 2063 6f6c 756d  (h.frame , colum
-00011a20: 6e73 203d 6665 6174 7572 6573 2c20 636d  ns =features, cm
-00011a30: 6170 203d 2750 754f 7227 290d 0a20 2020  ap ='PuOr')..   
-00011a40: 2022 2222 0d0a 2020 2020 696d 706f 7274   """..    import
-00011a50: 5f6f 7074 696f 6e61 6c5f 6465 7065 6e64  _optional_depend
-00011a60: 656e 6379 2827 6d6c 7874 656e 6427 2c20  ency('mlxtend', 
-00011a70: 6578 7472 613d 280d 0a20 2020 2020 2020  extra=(..       
-00011a80: 2022 4361 6e27 7420 706c 6f74 2068 6561   "Can't plot hea
-00011a90: 746d 6170 2075 7369 6e67 2027 6d6c 7874  tmap using 'mlxt
-00011aa0: 656e 6427 2070 6163 6b61 6765 2e22 2929  end' package."))
-00011ab0: 0d0a 2020 0d0a 2020 2020 6672 6f6d 206d  ..  ..    from m
-00011ac0: 6c78 7465 6e64 2e70 6c6f 7474 696e 6720  lxtend.plotting 
-00011ad0: 696d 706f 7274 2028 2020 6865 6174 6d61  import (  heatma
-00011ae0: 7020 0d0a 2020 2020 2020 2020 2020 2020  p ..            
-00011af0: 2920 0d0a 2020 2020 636d 203d 206e 702e  ) ..    cm = np.
-00011b00: 636f 7272 636f 6566 2864 665b 636f 6c75  corrcoef(df[colu
-00011b10: 6d6e 735d 2e20 7661 6c75 6573 2e54 290d  mns]. values.T).
-00011b20: 0a20 2020 2061 783d 2068 6561 746d 6170  .    ax= heatmap
-00011b30: 2863 6d2c 2072 6f77 5f6e 616d 6573 203d  (cm, row_names =
-00011b40: 2063 6f6c 756d 6e73 202c 2063 6f6c 756d   columns , colum
-00011b50: 6e5f 6e61 6d65 7320 3d20 636f 6c75 6d6e  n_names = column
-00011b60: 732c 202a 2a6b 7773 2029 0d0a 2020 2020  s, **kws )..    
-00011b70: 0d0a 2020 2020 6966 2073 6176 6566 6967  ..    if savefig
-00011b80: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
-00011b90: 2020 2020 2020 2020 7361 7665 6669 6775          savefigu
-00011ba0: 7265 2873 6176 6566 6967 2c20 7361 7665  re(savefig, save
-00011bb0: 6669 6720 290d 0a20 2020 2070 6c74 2e63  fig )..    plt.c
-00011bc0: 6c6f 7365 2028 2920 6966 2073 6176 6566  lose () if savef
-00011bd0: 6967 2069 7320 6e6f 7420 4e6f 6e65 2065  ig is not None e
-00011be0: 6c73 6520 706c 742e 7368 6f77 2829 200d  lse plt.show() .
-00011bf0: 0a20 2020 200d 0a20 2020 2072 6574 7572  .    ..    retur
-00011c00: 6e20 6178 200d 0a0d 0a64 6566 2070 6c6f  n ax ....def plo
-00011c10: 745f 6d6c 7874 656e 645f 6d61 7472 6978  t_mlxtend_matrix
-00011c20: 2864 662c 2063 6f6c 756d 6e73 203d 4e6f  (df, columns =No
-00011c30: 6e65 2c20 6669 675f 7369 7a65 203d 2028  ne, fig_size = (
-00011c40: 3130 202c 2038 2029 2c0d 0a20 2020 2020  10 , 8 ),..     
-00011c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011c60: 2020 2061 6c70 6861 203d 2e35 2c20 7361     alpha =.5, sa
-00011c70: 7665 6669 673d 4e6f 6e65 2020 293a 0d0a  vefig=None  ):..
-00011c80: 2020 2020 2222 2220 5669 7375 616c 697a      """ Visualiz
-00011c90: 6520 7468 6520 7061 6972 2077 6973 6520  e the pair wise 
-00011ca0: 636f 7272 656c 6174 696f 6e20 6265 7477  correlation betw
-00011cb0: 6565 6e20 7468 6520 6469 6666 6572 656e  een the differen
-00011cc0: 7420 6665 6174 7572 6573 2069 6e20 200d  t features in  .
-00011cd0: 0a20 2020 2074 6865 2064 6174 6173 6574  .    the dataset
-00011ce0: 2069 6e20 6f6e 6520 706c 6163 652e 200d   in one place. .
-00011cf0: 0a20 2020 200d 0a20 2020 203a 7061 7261  .    ..    :para
-00011d00: 6d20 6466 3a20 6461 7461 6672 616d 6520  m df: dataframe 
-00011d10: 7061 6e64 6173 2020 0d0a 2020 2020 3a70  pandas  ..    :p
-00011d20: 6172 616d 2063 6f6c 756d 6e73 3a20 6c69  aram columns: li
-00011d30: 7374 206f 6620 6665 6174 7572 6573 2c20  st of features, 
-00011d40: 0d0a 2020 2020 2020 2020 4966 2067 6976  ..        If giv
-00011d50: 656e 2c20 6f6e 6c79 2074 6865 2064 6174  en, only the dat
-00011d60: 6166 7261 6d65 2077 6974 6820 7468 6174  aframe with that
-00011d70: 2066 6561 7475 7265 7320 6973 2063 6f6e   features is con
-00011d80: 7369 6465 7265 642e 200d 0a20 2020 203a  sidered. ..    :
-00011d90: 7061 7261 6d20 6669 675f 7369 7a65 3a20  param fig_size: 
-00011da0: 7475 706c 6520 6f66 2069 6e74 2028 7769  tuple of int (wi
-00011db0: 6474 682c 2068 6569 6768 2920 0d0a 2020  dth, heigh) ..  
-00011dc0: 2020 2020 2020 5369 7a65 206f 6620 7468        Size of th
-00011dd0: 6520 6469 7370 6c61 7965 6420 6669 6775  e displayed figu
-00011de0: 7265 200d 0a20 2020 203a 7061 7261 6d20  re ..    :param 
-00011df0: 616c 7068 613a 2066 6967 7572 6520 7472  alpha: figure tr
-00011e00: 616e 7370 6172 656e 6379 2c20 6465 6661  ansparency, defa
-00011e10: 756c 7420 6973 2060 602e 3560 602e 200d  ult is ``.5``. .
-00011e20: 0a20 2020 200d 0a20 2020 203a 7265 7475  .    ..    :retu
-00011e30: 726e 3a20 3a66 756e 633a 606d 6c78 7465  rn: :func:`mlxte
-00011e40: 6e64 2e70 6c6f 7474 696e 672e 7363 6174  nd.plotting.scat
-00011e50: 7465 7270 6c6f 746d 6174 7269 7860 2061  terplotmatrix` a
-00011e60: 7865 7320 6f62 6a65 6374 200d 0a20 2020  xes object ..   
-00011e70: 203a 6578 616d 706c 653a 200d 0a20 2020   :example: ..   
-00011e80: 203e 3e3e 2066 726f 6d20 7761 7465 782e   >>> from watex.
-00011e90: 6461 7461 7365 7473 2069 6d70 6f72 7420  datasets import 
-00011ea0: 6c6f 6164 5f68 6c6f 6773 200d 0a20 2020  load_hlogs ..   
-00011eb0: 203e 3e3e 2066 726f 6d20 7761 7465 782e   >>> from watex.
-00011ec0: 7574 696c 732e 706c 6f74 7574 696c 7320  utils.plotutils 
-00011ed0: 696d 706f 7274 2070 6c6f 745f 6d6c 7874  import plot_mlxt
-00011ee0: 656e 645f 6d61 7472 6978 0d0a 2020 2020  end_matrix..    
-00011ef0: 3e3e 3e20 696d 706f 7274 2070 616e 6461  >>> import panda
-00011f00: 7320 6173 2070 6420 0d0a 2020 2020 3e3e  s as pd ..    >>
-00011f10: 3e20 696d 706f 7274 206e 756d 7079 2061  > import numpy a
-00011f20: 7320 6e70 200d 0a20 2020 203e 3e3e 2068  s np ..    >>> h
-00011f30: 3d6c 6f61 645f 686c 6f67 7328 290d 0a20  =load_hlogs().. 
-00011f40: 2020 203e 3e3e 2066 6561 7475 7265 7320     >>> features 
-00011f50: 3d20 5b27 6761 6d6d 615f 6761 6d6d 6127  = ['gamma_gamma'
-00011f60: 2c20 276e 6174 7572 616c 5f67 616d 6d61  , 'natural_gamma
-00011f70: 272c 2027 7265 7369 7374 6976 6974 7927  ', 'resistivity'
-00011f80: 5d0d 0a20 2020 203e 3e3e 2064 6174 6120  ]..    >>> data 
-00011f90: 3d20 7064 2e44 6174 6146 7261 6d65 2028  = pd.DataFrame (
-00011fa0: 206e 702e 6c6f 6731 3020 2868 2e66 7261   np.log10 (h.fra
-00011fb0: 6d65 5b66 6561 7475 7265 735d 292c 2063  me[features]), c
-00011fc0: 6f6c 756d 6e73 203d 6665 6174 7572 6573  olumns =features
-00011fd0: 2029 0d0a 2020 2020 3e3e 3e20 706c 6f74   )..    >>> plot
-00011fe0: 5f6d 6c78 7465 6e64 5f6d 6174 7269 7820  _mlxtend_matrix 
-00011ff0: 2864 6174 612c 2063 6f6c 756d 6e73 203d  (data, columns =
-00012000: 6665 6174 7572 6573 290d 0a0d 0a20 2020  features)....   
-00012010: 2022 2222 0d0a 2020 2020 696d 706f 7274   """..    import
-00012020: 5f6f 7074 696f 6e61 6c5f 6465 7065 6e64  _optional_depend
-00012030: 656e 6379 2822 6d6c 7874 656e 6422 2c20  ency("mlxtend", 
-00012040: 6578 7472 6120 3d20 280d 0a20 2020 2020  extra = (..     
-00012050: 2020 2022 4361 6e27 7420 706c 6f74 2074     "Can't plot t
-00012060: 6865 2073 6361 7474 6572 206d 6174 7269  he scatter matri
-00012070: 7820 7573 696e 6720 276d 6c78 7465 6e64  x using 'mlxtend
-00012080: 2720 7061 636b 6167 652e 2229 200d 0a20  ' package.") .. 
-00012090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000120a0: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-000120b0: 0a20 2020 2066 726f 6d20 6d6c 7874 656e  .    from mlxten
-000120c0: 642e 706c 6f74 7469 6e67 2069 6d70 6f72  d.plotting impor
-000120d0: 7420 7363 6174 7465 7270 6c6f 746d 6174  t scatterplotmat
-000120e0: 7269 780d 0a20 2020 2020 2020 2020 2020  rix..           
+0000cf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cf50: 2020 2020 5356 4320 2c20 4b4e 6569 6768      SVC , KNeigh
+0000cf60: 626f 7273 436c 6173 7369 6669 6572 200d  borsClassifier .
+0000cf70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cf90: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+0000cfa0: 203e 3e3e 206d 6f64 656c 7320 3d5b 4c6f   >>> models =[Lo
+0000cfb0: 6769 7374 6963 5265 6772 6573 7369 6f6e  gisticRegression
+0000cfc0: 2829 2c20 5261 6e64 6f6d 466f 7265 7374  (), RandomForest
+0000cfd0: 436c 6173 7369 6669 6572 2829 2c20 5356  Classifier(), SV
+0000cfe0: 4328 2920 2c0d 0a20 2020 2020 2020 2020  C() ,..         
+0000cff0: 2020 2020 2020 2020 4b4e 6569 6768 626f          KNeighbo
+0000d000: 7273 436c 6173 7369 6669 6572 2829 205d  rsClassifier() ]
+0000d010: 0d0a 2020 2020 3e3e 3e20 706c 6f74 5f6c  ..    >>> plot_l
+0000d020: 6561 726e 696e 675f 6375 7276 6573 2028  earning_curves (
+0000d030: 6d6f 6465 6c73 2c20 582c 2079 2c20 6376  models, X, y, cv
+0000d040: 3d34 2c20 736e 735f 7374 796c 6520 3d20  =4, sns_style = 
+0000d050: 2764 6172 6b67 7269 6427 290d 0a20 2020  'darkgrid')..   
+0000d060: 200d 0a20 2020 2022 2222 0d0a 2020 2020   ..    """..    
+0000d070: 6966 206e 6f74 2069 735f 6974 6572 6162  if not is_iterab
+0000d080: 6c65 286d 6f64 656c 7329 3a20 0d0a 2020  le(models): ..  
+0000d090: 2020 2020 2020 6d6f 6465 6c73 203d 5b6d        models =[m
+0000d0a0: 6f64 656c 735d 0d0a 2020 2020 0d0a 2020  odels]..    ..  
+0000d0b0: 2020 7375 6270 6c6f 745f 6b77 7320 3d20    subplot_kws = 
+0000d0c0: 7375 6270 6c6f 745f 6b77 7320 6f72 2020  subplot_kws or  
+0000d0d0: 6469 6374 280d 0a20 2020 2020 2020 206c  dict(..        l
+0000d0e0: 6566 743d 302e 3036 3235 2c20 7269 6768  eft=0.0625, righ
+0000d0f0: 7420 3d20 302e 3935 2c20 7773 7061 6365  t = 0.95, wspace
+0000d100: 203d 2030 2e31 2920 0d0a 2020 2020 7472   = 0.1) ..    tr
+0000d110: 6169 6e5f 7369 7a65 7320 3d20 7472 6169  ain_sizes = trai
+0000d120: 6e5f 7369 7a65 7320 6f72 206e 702e 6c69  n_sizes or np.li
+0000d130: 6e73 7061 6365 2830 2e31 2c20 312c 2035  nspace(0.1, 1, 5
+0000d140: 3029 0d0a 2020 2020 6376 203d 2063 7620  0)..    cv = cv 
+0000d150: 6f72 2034 200d 0a20 2020 2069 6620 2820  or 4 ..    if ( 
+0000d160: 0d0a 2020 2020 2020 2020 6261 7365 6c69  ..        baseli
+0000d170: 6e65 5f73 636f 7265 203e 3d31 200d 0a20  ne_score >=1 .. 
+0000d180: 2020 2020 2020 2061 6e64 2062 6173 656c         and basel
+0000d190: 696e 655f 7363 6f72 6520 3c20 3020 0d0a  ine_score < 0 ..
+0000d1a0: 2020 2020 2020 2020 293a 200d 0a20 2020          ): ..   
+0000d1b0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000d1c0: 4572 726f 7220 2822 5363 6f72 6520 666f  Error ("Score fo
+0000d1d0: 7220 7468 6520 6261 7365 206c 696e 6520  r the base line 
+0000d1e0: 6d75 7374 2062 6520 6c65 7373 2031 2061  must be less 1 a
+0000d1f0: 6e64 2022 0d0a 2020 2020 2020 2020 2020  nd "..          
+0000d200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d210: 6622 6772 6561 7465 7220 7468 616e 2030  f"greater than 0
+0000d220: 3b20 676f 7420 7b62 6173 656c 696e 655f  ; got {baseline_
+0000d230: 7363 6f72 657d 2229 0d0a 2020 2020 0d0a  score}")..    ..
+0000d240: 2020 2020 6966 2073 6e73 5f73 7479 6c65      if sns_style
+0000d250: 3a20 0d0a 2020 2020 2020 2020 5f73 6574  : ..        _set
+0000d260: 5f73 6e73 5f73 7479 6c65 2028 736e 735f  _sns_style (sns_
+0000d270: 7374 796c 6529 0d0a 2020 2020 2020 2020  style)..        
+0000d280: 0d0a 2020 2020 6d6e 616d 6573 203d 205b  ..    mnames = [
+0000d290: 6765 745f 6573 7469 6d61 746f 725f 6e61  get_estimator_na
+0000d2a0: 6d65 286e 2920 666f 7220 6e20 696e 206d  me(n) for n in m
+0000d2b0: 6f64 656c 735d 0d0a 0d0a 2020 2020 6669  odels]....    fi
+0000d2c0: 672c 2061 7865 7320 3d20 706c 742e 7375  g, axes = plt.su
+0000d2d0: 6270 6c6f 7473 286e 726f 7773 3d31 2c20  bplots(nrows=1, 
+0000d2e0: 6e63 6f6c 733d 6c65 6e28 6d6f 6465 6c73  ncols=len(models
+0000d2f0: 292c 2066 6967 7369 7a65 203d 6669 675f  ), figsize =fig_
+0000d300: 7369 7a65 290d 0a20 2020 2023 2066 6f72  size)..    # for
+0000d310: 2063 6f6e 7369 7374 656e 6379 2c20 7075   consistency, pu
+0000d320: 7420 6178 6573 206f 6e20 6c69 7374 2077  t axes on list w
+0000d330: 6865 6e20 0d0a 2020 2020 2320 6120 7369  hen ..    # a si
+0000d340: 6e67 6c65 206d 6f64 656c 2069 7320 7072  ngle model is pr
+0000d350: 6f76 6964 6564 200d 0a20 2020 2069 6620  ovided ..    if 
+0000d360: 6e6f 7420 6973 5f69 7465 7261 626c 6528  not is_iterable(
+0000d370: 6178 6573 293a 200d 0a20 2020 2020 2020  axes): ..       
+0000d380: 2061 7865 7320 3d5b 6178 6573 5d20 0d0a   axes =[axes] ..
+0000d390: 2020 2020 6669 672e 7375 6270 6c6f 7473      fig.subplots
+0000d3a0: 5f61 646a 7573 7428 2a2a 7375 6270 6c6f  _adjust(**subplo
+0000d3b0: 745f 6b77 7329 0d0a 0d0a 2020 2020 666f  t_kws)....    fo
+0000d3c0: 7220 6b2c 2028 6d6f 6465 6c2c 206e 616d  r k, (model, nam
+0000d3d0: 6529 2069 6e20 656e 756d 6572 6174 6528  e) in enumerate(
+0000d3e0: 7a69 7028 6d6f 6465 6c73 2c20 206d 6e61  zip(models,  mna
+0000d3f0: 6d65 7329 293a 0d0a 2020 2020 2020 2020  mes)):..        
+0000d400: 636d 6f64 656c 203d 206d 6f64 656c 2e62  cmodel = model.b
+0000d410: 6573 745f 6573 7469 6d61 746f 725f 2020  est_estimator_  
+0000d420: 6966 205f 6973 5f63 726f 7373 5f76 616c  if _is_cross_val
+0000d430: 6964 6174 6564 280d 0a20 2020 2020 2020  idated(..       
+0000d440: 2020 2020 206d 6f64 656c 2029 2065 6c73       model ) els
+0000d450: 6520 6d6f 6465 6c20 0d0a 2020 2020 2020  e model ..      
+0000d460: 2020 6178 203d 206c 6973 7428 6178 6573    ax = list(axes
+0000d470: 295b 6b5d 0d0a 0d0a 2020 2020 2020 2020  )[k]....        
+0000d480: 4e2c 2074 7261 696e 5f6c 6320 2c20 7661  N, train_lc , va
+0000d490: 6c5f 6c63 203d 206c 6561 726e 696e 675f  l_lc = learning_
+0000d4a0: 6375 7276 6528 0d0a 2020 2020 2020 2020  curve(..        
+0000d4b0: 2020 2020 636d 6f64 656c 202c 200d 0a20      cmodel , .. 
+0000d4c0: 2020 2020 2020 2020 2020 2058 2c20 0d0a             X, ..
+0000d4d0: 2020 2020 2020 2020 2020 2020 792c 200d              y, .
+0000d4e0: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
+0000d4f0: 696e 5f73 697a 6573 203d 206e 702e 6c69  in_sizes = np.li
+0000d500: 6e73 7061 6365 2830 2e31 2c20 312c 2035  nspace(0.1, 1, 5
+0000d510: 3029 2c0d 0a20 2020 2020 2020 2020 2020  0),..           
+0000d520: 2063 763d 6376 2c20 0d0a 2020 2020 2020   cv=cv, ..      
+0000d530: 2020 2020 2020 2a2a 6b77 730d 0a20 2020        **kws..   
+0000d540: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+0000d550: 2020 2020 6178 2e70 6c6f 7428 4e2c 206e      ax.plot(N, n
+0000d560: 702e 6d65 616e 2874 7261 696e 5f6c 632c  p.mean(train_lc,
+0000d570: 2031 292c 200d 0a20 2020 2020 2020 2020   1), ..         
+0000d580: 2020 2020 2020 2020 2020 636f 6c6f 7220            color 
+0000d590: 3d22 626c 7565 222c 200d 0a20 2020 2020  ="blue", ..     
+0000d5a0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+0000d5b0: 6265 6c20 3d22 7472 6169 6e20 7363 6f72  bel ="train scor
+0000d5c0: 6522 0d0a 2020 2020 2020 2020 2020 2020  e"..            
+0000d5d0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+0000d5e0: 2020 6178 2e70 6c6f 7428 4e2c 206e 702e    ax.plot(N, np.
+0000d5f0: 6d65 616e 2876 616c 5f6c 632c 2031 292c  mean(val_lc, 1),
+0000d600: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000d610: 2020 2020 2020 636f 6c6f 7220 3d22 7222        color ="r"
+0000d620: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0000d630: 2020 2020 2020 206c 6162 656c 203d 2276         label ="v
+0000d640: 616c 6964 6174 696f 6e20 7363 6f72 6522  alidation score"
+0000d650: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d660: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+0000d670: 6966 2063 6f6e 7665 7267 656e 6365 5f6c  if convergence_l
+0000d680: 696e 6520 3a20 0d0a 2020 2020 2020 2020  ine : ..        
+0000d690: 2020 2020 6178 2e68 6c69 6e65 7328 6e70      ax.hlines(np
+0000d6a0: 2e6d 6561 6e28 5b74 7261 696e 5f6c 635b  .mean([train_lc[
+0000d6b0: 2d31 5d2c 200d 0a20 2020 2020 2020 2020  -1], ..         
+0000d6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d6d0: 2020 2020 2020 2020 2076 616c 5f6c 635b           val_lc[
+0000d6e0: 2d31 5d5d 292c 200d 0a20 2020 2020 2020  -1]]), ..       
+0000d6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d700: 2020 2020 2020 2020 2020 4e5b 305d 2c20            N[0], 
+0000d710: 4e5b 2d31 5d2c 200d 0a20 2020 2020 2020  N[-1], ..       
+0000d720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d730: 2020 2020 2020 2020 2020 636f 6c6f 723d            color=
+0000d740: 226b 222c 200d 0a20 2020 2020 2020 2020  "k", ..         
+0000d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d760: 2020 2020 2020 2020 6c69 6e65 7374 796c          linestyl
+0000d770: 6520 3d22 2d2d 220d 0a20 2020 2020 2020  e ="--"..       
+0000d780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d790: 2020 290d 0a20 2020 2020 2020 2061 782e    )..        ax.
+0000d7a0: 7365 745f 796c 696d 2862 6173 656c 696e  set_ylim(baselin
+0000d7b0: 655f 7363 6f72 652c 2031 290d 0a20 2020  e_score, 1)..   
+0000d7c0: 2020 2020 2023 6178 5b6b 5d2e 7365 745f       #ax[k].set_
+0000d7d0: 786c 696d 2028 4e5b 305d 2c20 4e5b 315d  xlim (N[0], N[1]
+0000d7e0: 290d 0a20 2020 2020 2020 2061 782e 7365  )..        ax.se
+0000d7f0: 745f 786c 6162 656c 2822 7472 6169 6e69  t_xlabel("traini
+0000d800: 6e67 2073 697a 6522 290d 0a20 2020 2020  ng size")..     
+0000d810: 2020 2061 782e 7365 745f 7469 746c 6528     ax.set_title(
+0000d820: 6e61 6d65 2c20 7369 7a65 3d31 3429 0d0a  name, size=14)..
+0000d830: 2020 2020 2020 2020 6966 2073 6574 5f6c          if set_l
+0000d840: 6567 656e 643a 200d 0a20 2020 2020 2020  egend: ..       
+0000d850: 2020 2020 2061 782e 6c65 6765 6e64 286c       ax.legend(l
+0000d860: 6f63 3d27 6265 7374 2729 0d0a 2020 2020  oc='best')..    
+0000d870: 2320 666f 7220 636f 6e73 6973 7465 6e63  # for consistenc
+0000d880: 790d 0a20 2020 2061 7820 3d20 6c69 7374  y..    ax = list
+0000d890: 2861 7865 7329 5b30 5d0d 0a20 2020 2061  (axes)[0]..    a
+0000d8a0: 782e 7365 745f 796c 6162 656c 2822 7363  x.set_ylabel("sc
+0000d8b0: 6f72 6522 290d 0a20 2020 200d 0a20 2020  ore")..    ..   
+0000d8c0: 2069 6620 7361 7665 6669 6720 6973 206e   if savefig is n
+0000d8d0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+0000d8e0: 2020 706c 742e 7361 7665 6669 6728 7361    plt.savefig(sa
+0000d8f0: 7665 6669 672c 2064 7069 203d 2033 3030  vefig, dpi = 300
+0000d900: 2029 0d0a 2020 2020 2020 2020 0d0a 2020   )..        ..  
+0000d910: 2020 706c 742e 636c 6f73 6520 2829 2069    plt.close () i
+0000d920: 6620 7361 7665 6669 6720 6973 206e 6f74  f savefig is not
+0000d930: 204e 6f6e 6520 656c 7365 2070 6c74 2e73   None else plt.s
+0000d940: 686f 7728 2920 0d0a 2020 2020 2020 2020  how() ..        
+0000d950: 0d0a 6465 6620 706c 6f74 5f6e 6169 7665  ..def plot_naive
+0000d960: 5f64 656e 6472 6f67 7261 6d20 280d 0a20  _dendrogram (.. 
+0000d970: 2020 2020 2020 2058 2c20 0d0a 2020 2020         X, ..    
+0000d980: 2020 2020 2a79 626f 756e 6473 2c20 0d0a      *ybounds, ..
+0000d990: 2020 2020 2020 2020 6669 675f 7369 7a65          fig_size
+0000d9a0: 203d 2028 3132 2c20 3520 292c 200d 0a20   = (12, 5 ), .. 
+0000d9b0: 2020 2020 2020 2073 6176 6566 6967 3d4e         savefig=N
+0000d9c0: 6f6e 652c 2020 0d0a 2020 2020 2020 2020  one,  ..        
+0000d9d0: 2a2a 6b77 730d 0a20 2020 2020 2020 2029  **kws..        )
+0000d9e0: 3a20 0d0a 2020 2020 2222 2220 5175 6963  : ..    """ Quic
+0000d9f0: 6b20 706c 6f74 2064 656e 6472 6f67 7261  k plot dendrogra
+0000da00: 6d20 7573 696e 6720 7468 6520 7761 7264  m using the ward
+0000da10: 2063 6c75 7374 6572 696e 6720 6675 6e63   clustering func
+0000da20: 7469 6f6e 2066 726f 6d20 5363 6970 792e  tion from Scipy.
+0000da30: 0d0a 2020 2020 0d0a 2020 2020 3a70 6172  ..    ..    :par
+0000da40: 616d 2058 3a20 6e64 6172 7261 7920 6f66  am X: ndarray of
+0000da50: 2073 6861 7065 2028 6e5f 7361 6d70 6c65   shape (n_sample
+0000da60: 732c 206e 5f66 6561 7475 7265 7329 200d  s, n_features) .
+0000da70: 0a20 2020 2020 2020 2041 7272 6179 206f  .        Array o
+0000da80: 6620 6665 6174 7572 6573 200d 0a20 2020  f features ..   
+0000da90: 203a 7061 7261 6d20 7962 6f75 6e64 733a   :param ybounds:
+0000daa0: 2069 6e74 2c20 0d0a 2020 2020 2020 2020   int, ..        
+0000dab0: 696e 7465 6772 6572 2076 616c 7565 7320  integrer values 
+0000dac0: 746f 2064 7261 7720 686f 7269 7a6f 6e74  to draw horizont
+0000dad0: 616c 2063 6c75 7374 6572 206c 696e 6573  al cluster lines
+0000dae0: 2074 6861 7420 696e 6469 6361 7465 2074   that indicate t
+0000daf0: 6865 200d 0a20 2020 2020 2020 206e 756d  he ..        num
+0000db00: 6265 7220 6f66 2063 6c75 7374 6572 732e  ber of clusters.
+0000db10: 200d 0a20 2020 203a 7061 7261 6d20 6669   ..    :param fi
+0000db20: 675f 7369 7a65 3a20 7475 706c 6520 2877  g_size: tuple (w
+0000db30: 6964 7468 2c20 6865 6967 6874 292c 2064  idth, height), d
+0000db40: 6566 6175 6c74 203d 2831 322c 3529 200d  efault =(12,5) .
+0000db50: 0a20 2020 2020 2020 2074 6865 206d 6174  .        the mat
+0000db60: 706c 6f74 6c69 6220 6669 6775 7265 2073  plotlib figure s
+0000db70: 697a 6520 6769 7665 6e20 6173 2061 2074  ize given as a t
+0000db80: 7570 6c65 206f 6620 7769 6474 6820 616e  uple of width an
+0000db90: 6420 6865 6967 6874 200d 0a20 2020 203a  d height ..    :
+0000dba0: 7061 7261 6d20 6b77 733a 2064 6963 7420  param kws: dict 
+0000dbb0: 2c20 0d0a 2020 2020 2020 2020 4164 6464  , ..        Addd
+0000dbc0: 6974 696f 6e61 6c20 6b65 7977 6f72 6420  itional keyword 
+0000dbd0: 6172 6775 6d65 6e74 7320 7061 7373 6564  arguments passed
+0000dbe0: 2074 6f20 0d0a 2020 2020 2020 2020 3a66   to ..        :f
+0000dbf0: 756e 633a 6073 6369 7079 2e63 6c75 7374  unc:`scipy.clust
+0000dc00: 6572 2e68 6965 7261 7263 6879 2e64 656e  er.hierarchy.den
+0000dc10: 6472 6f67 7261 6d60 0d0a 2020 2020 3a45  drogram`..    :E
+0000dc20: 7861 6d70 6c65 733a 200d 0a20 2020 2020  xamples: ..     
+0000dc30: 2020 203e 3e3e 2066 726f 6d20 7761 7465     >>> from wate
+0000dc40: 782e 6461 7461 7365 7473 2069 6d70 6f72  x.datasets impor
+0000dc50: 7420 6665 7463 685f 6461 7461 200d 0a20  t fetch_data .. 
+0000dc60: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
+0000dc70: 7761 7465 782e 7574 696c 732e 706c 6f74  watex.utils.plot
+0000dc80: 7574 696c 7320 696d 706f 7274 2070 6c6f  utils import plo
+0000dc90: 745f 6e61 6976 655f 6465 6e64 726f 6772  t_naive_dendrogr
+0000dca0: 616d 0d0a 2020 2020 2020 2020 3e3e 3e20  am..        >>> 
+0000dcb0: 582c 205f 3d20 6665 7463 685f 6461 7461  X, _= fetch_data
+0000dcc0: 2827 4261 676f 7565 2061 6e61 6c79 7365  ('Bagoue analyse
+0000dcd0: 6427 2920 2320 6461 7461 2069 7320 616c  d') # data is al
+0000dce0: 7265 6164 7920 7363 616c 6564 200d 0a20  ready scaled .. 
+0000dcf0: 2020 2020 2020 203e 3e3e 2023 2067 6574         >>> # get
+0000dd00: 2074 6865 2074 776f 2066 6561 7475 7265   the two feature
+0000dd10: 7320 2770 6f77 6572 2720 616e 6420 2027  s 'power' and  '
+0000dd20: 6d61 676e 6974 7564 6527 0d0a 2020 2020  magnitude'..    
+0000dd30: 2020 2020 3e3e 3e20 6461 7461 203d 2058      >>> data = X
+0000dd40: 5b5b 2770 6f77 6572 272c 2027 6d61 676e  [['power', 'magn
+0000dd50: 6974 7564 6527 5d5d 0d0a 2020 2020 2020  itude']]..      
+0000dd60: 2020 3e3e 3e20 706c 6f74 5f6e 6169 7665    >>> plot_naive
+0000dd70: 5f64 656e 6472 6f67 7261 6d28 6461 7461  _dendrogram(data
+0000dd80: 2029 200d 0a20 2020 2020 2020 203e 3e3e   ) ..        >>>
+0000dd90: 2023 2061 6464 2074 6865 2068 6f72 697a   # add the horiz
+0000dda0: 6f6e 7461 6c20 6c69 6e65 206f 6620 7468  ontal line of th
+0000ddb0: 6520 636c 7573 7465 7220 6174 2079 626f  e cluster at ybo
+0000ddc0: 756e 6473 203d 2028 3230 202c 2032 3020  unds = (20 , 20 
+0000ddd0: 290d 0a20 2020 2020 2020 203e 3e3e 2023  )..        >>> #
+0000dde0: 2066 6f72 2061 2073 696e 676c 6520 636c   for a single cl
+0000ddf0: 7573 7465 7220 2863 6c75 7365 7220 3129  uster (cluser 1)
+0000de00: 0d0a 2020 2020 2020 2020 3e3e 3e20 706c  ..        >>> pl
+0000de10: 6f74 5f6e 6169 7665 5f64 656e 6472 6f67  ot_naive_dendrog
+0000de20: 7261 6d28 6461 7461 202c 2032 302c 2032  ram(data , 20, 2
+0000de30: 3020 2920 0d0a 2020 200d 0a20 2020 2022  0 ) ..   ..    "
+0000de40: 2222 0d0a 2020 2020 2320 6173 7365 7274  ""..    # assert
+0000de50: 2079 626f 756e 6473 2061 6775 6d65 6e74   ybounds agument
+0000de60: 2069 6620 6769 7665 6e0d 0a20 2020 206d   if given..    m
+0000de70: 7367 203d 2822 2e20 4e6f 7465 2074 6861  sg =(". Note tha
+0000de80: 7420 7468 6520 626f 756e 6473 2069 6e20  t the bounds in 
+0000de90: 792d 6178 6973 2061 7265 2074 6865 2079  y-axis are the y
+0000dea0: 2d63 6f6f 7264 696e 6174 6573 2066 6f72  -coordinates for
+0000deb0: 220d 0a20 2020 2020 2020 2020 2022 2068  "..          " h
+0000dec0: 6f72 697a 6f6e 7461 6c20 6c69 6e65 7320  orizontal lines 
+0000ded0: 7265 6761 7264 696e 6720 746f 2074 6865  regarding to the
+0000dee0: 206e 756d 6265 7220 6f66 2063 6c75 7374   number of clust
+0000def0: 6572 7320 7468 6174 220d 0a20 2020 2020  ers that"..     
+0000df00: 2020 2020 2022 206d 6967 6874 2062 6520       " might be 
+0000df10: 6375 7474 6564 2e22 290d 0a20 2020 2074  cutted.")..    t
+0000df20: 7279 203a 200d 0a20 2020 2020 2020 2079  ry : ..        y
+0000df30: 626f 756e 6473 203d 205b 2069 6e74 2028  bounds = [ int (
+0000df40: 6129 2066 6f72 2061 2069 6e20 7962 6f75  a) for a in ybou
+0000df50: 6e64 7320 5d20 0d0a 2020 2020 6578 6365  nds ] ..    exce
+0000df60: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
+0000df70: 7479 7065 7272 6f72 3a20 0d0a 2020 2020  typerror: ..    
+0000df80: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+0000df90: 726f 7220 2028 7374 7228 7479 7065 7272  ror  (str(typerr
+0000dfa0: 6f72 2920 2b20 6d73 6729 0d0a 2020 2020  or) + msg)..    
+0000dfb0: 656c 7365 203a 200d 0a20 2020 2020 2020  else : ..       
+0000dfc0: 2069 6620 6c65 6e28 7962 6f75 6e64 7329   if len(ybounds)
+0000dfd0: 3d3d 3020 3a20 7962 6f75 6e64 7320 3d20  ==0 : ybounds = 
+0000dfe0: 4e6f 6e65 200d 0a20 2020 2023 2074 6865  None ..    # the
+0000dff0: 2073 6369 7079 2077 6172 6420 6675 6e63   scipy ward func
+0000e000: 7469 6f6e 2072 6574 7572 6e73 200d 0a20  tion returns .. 
+0000e010: 2020 2023 2061 6e20 6172 7261 7920 7468     # an array th
+0000e020: 6174 2073 7065 6369 6669 6573 2074 6865  at specifies the
+0000e030: 200d 0a20 2020 2023 2064 6973 7461 6e63   ..    # distanc
+0000e040: 6520 6272 6964 6765 6420 7768 656e 2070  e bridged when p
+0000e050: 6572 666f 726d 6564 200d 0a20 2020 2023  erformed ..    #
+0000e060: 2061 6767 6c6f 6d65 7261 7465 2063 6c75   agglomerate clu
+0000e070: 7374 6572 696e 670d 0a20 2020 206c 696e  stering..    lin
+0000e080: 6b61 6765 5f61 7272 6179 203d 2077 6172  kage_array = war
+0000e090: 6428 5829 200d 0a20 2020 200d 0a20 2020  d(X) ..    ..   
+0000e0a0: 2023 2070 6c6f 7420 7468 6520 6465 6e64   # plot the dend
+0000e0b0: 726f 6772 616d 2066 6f72 2074 6865 206c  rogram for the l
+0000e0c0: 696e 6b61 6765 2061 7272 6179 200d 0a20  inkage array .. 
+0000e0d0: 2020 2023 2063 6f6e 7461 696e 696e 6720     # containing 
+0000e0e0: 7468 6520 6469 7374 616e 6365 7320 6265  the distances be
+0000e0f0: 7477 6565 6e20 636c 7573 7465 7273 200d  tween clusters .
+0000e100: 0a20 2020 2064 656e 6472 6f67 7261 6d28  .    dendrogram(
+0000e110: 206c 696e 6b61 6765 5f61 7272 6179 202c   linkage_array ,
+0000e120: 202a 2a6b 7773 2029 0d0a 2020 2020 0d0a   **kws )..    ..
+0000e130: 2020 2020 2320 6d61 726b 2074 6865 2063      # mark the c
+0000e140: 7574 7320 6f6e 2074 6865 2074 7265 6520  uts on the tree 
+0000e150: 7468 6174 2073 6967 6e69 6679 2074 776f  that signify two
+0000e160: 206f 7220 7468 7265 6520 636c 7573 7465   or three cluste
+0000e170: 7273 0d0a 2020 2020 2320 6368 616e 6765  rs..    # change
+0000e180: 2074 6865 2067 6361 2066 6967 7369 7a65   the gca figsize
+0000e190: 200d 0a20 2020 2070 6c74 2e72 6350 6172   ..    plt.rcPar
+0000e1a0: 616d 735b 2266 6967 7572 652e 6669 6773  ams["figure.figs
+0000e1b0: 697a 6522 5d20 3d20 6669 675f 7369 7a65  ize"] = fig_size
+0000e1c0: 0d0a 2020 2020 6178 3d20 706c 742e 6763  ..    ax= plt.gc
+0000e1d0: 6120 2829 200d 0a20 200d 0a20 2020 2069  a () ..  ..    i
+0000e1e0: 6620 7962 6f75 6e64 7320 6973 206e 6f74  f ybounds is not
+0000e1f0: 204e 6f6e 653a 200d 0a20 2020 2020 2020   None: ..       
+0000e200: 2069 6620 6e6f 7420 6973 5f69 7465 7261   if not is_itera
+0000e210: 626c 6528 7962 6f75 6e64 7329 3a20 0d0a  ble(ybounds): ..
+0000e220: 2020 2020 2020 2020 2020 2020 7962 6f75              ybou
+0000e230: 6e64 7320 3d5b 7962 6f75 6e64 735d 200d  nds =[ybounds] .
+0000e240: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+0000e250: 7962 6f75 6e64 7329 203c 3d31 203a 200d  ybounds) <=1 : .
+0000e260: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+0000e270: 6e69 6e67 732e 7761 726e 2866 2261 7869  nings.warn(f"axi
+0000e280: 7320 7920 626f 756e 6420 6d69 6768 7420  s y bound might 
+0000e290: 6265 2067 7265 6174 6572 2074 6861 6e20  be greater than 
+0000e2a0: 7b6c 656e 2879 626f 756e 6473 297d 2229  {len(ybounds)}")
+0000e2b0: 0d0a 2020 2020 2020 2020 656c 7365 203a  ..        else :
+0000e2c0: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
+0000e2d0: 2073 706c 6974 2079 626f 756e 6420 696e   split ybound in
+0000e2e0: 746f 2073 7562 6c69 7374 206f 6620 7061  to sublist of pa
+0000e2f0: 6972 2028 782c 2079 2920 636f 6f72 6469  ir (x, y) coordi
+0000e300: 6e61 7465 730d 0a20 2020 2020 2020 2020  nates..         
+0000e310: 2020 206e 7370 6c69 7473 203d 206c 656e     nsplits = len
+0000e320: 2879 626f 756e 6473 292f 2f32 200d 0a20  (ybounds)//2 .. 
+0000e330: 2020 2020 2020 2020 2020 206c 656e 5f73             len_s
+0000e340: 706c 6974 7320 3d20 5b20 3220 666f 7220  plits = [ 2 for 
+0000e350: 6920 696e 2072 616e 6765 2028 6e73 706c  i in range (nspl
+0000e360: 6974 7329 5d0d 0a20 2020 2020 2020 2020  its)]..         
+0000e370: 2020 2023 2063 6f6d 706f 7365 2074 6865     # compose the
+0000e380: 2070 6972 206c 6973 7420 2878 2c79 2029   pir list (x,y )
+0000e390: 0d0a 2020 2020 2020 2020 2020 2020 6974  ..            it
+0000e3a0: 6220 3d20 6974 6572 2028 7962 6f75 6e64  b = iter (ybound
+0000e3b0: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+0000e3c0: 7962 6f75 6e64 7320 3d20 5b6c 6973 7428  ybounds = [list(
+0000e3d0: 6974 6572 746f 6f6c 732e 6973 6c69 6365  itertools.islice
+0000e3e0: 2028 6974 622c 2069 7429 2920 666f 7220   (itb, it)) for 
+0000e3f0: 6974 2069 6e20 6c65 6e5f 7370 6c69 7473  it in len_splits
+0000e400: 5d0d 0a20 2020 2020 2020 2020 2020 2062  ]..            b
+0000e410: 6f75 6e64 7320 3d20 6178 2e67 6574 5f78  ounds = ax.get_x
+0000e420: 626f 756e 6420 2829 200d 0a20 2020 2020  bound () ..     
+0000e430: 2020 2020 2020 2066 6f72 2069 202c 2028         for i , (
+0000e440: 2078 2c20 7929 2020 696e 2065 6e75 6d65   x, y)  in enume
+0000e450: 7261 7465 2028 7962 6f75 6e64 7329 2020  rate (ybounds)  
+0000e460: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0000e470: 2020 2020 6178 2e70 6c6f 7428 626f 756e      ax.plot(boun
+0000e480: 6473 2c20 5b78 2c20 795d 2c20 272d 2d27  ds, [x, y], '--'
+0000e490: 2c20 633d 276b 2729 200d 0a20 2020 2020  , c='k') ..     
+0000e4a0: 2020 2020 2020 2020 2020 2061 782e 7465             ax.te
+0000e4b0: 7874 2028 2062 6f75 6e64 7320 5b31 5d2c  xt ( bounds [1],
+0000e4c0: 2079 202c 2066 2263 6c75 7374 6572 207b   y , f"cluster {
+0000e4d0: 6920 2b31 3a30 327d 222c 0d0a 2020 2020  i +1:02}",..    
+0000e4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e4f0: 2020 2020 2076 613d 2763 656e 7465 7227       va='center'
+0000e500: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0000e510: 2020 2020 2020 2020 2020 2020 2066 6f6e               fon
+0000e520: 7464 6963 7420 3d7b 2773 697a 6527 3a20  tdict ={'size': 
+0000e530: 3135 7d0d 0a20 2020 2020 2020 2020 2020  15}..           
+0000e540: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+0000e550: 0a20 2020 2023 2067 6574 2078 7469 636b  .    # get xtick
+0000e560: 7320 616e 6420 666f 726d 6174 206c 6162  s and format lab
+0000e570: 656c 730d 0a20 2020 2078 7469 636b 735f  els..    xticks_
+0000e580: 6c6f 6320 3d20 6c69 7374 2861 782e 6765  loc = list(ax.ge
+0000e590: 745f 7874 6963 6b73 2829 290d 0a20 2020  t_xticks())..   
+0000e5a0: 205f 6765 745f 7874 6963 6b73 5f66 6f72   _get_xticks_for
+0000e5b0: 6d61 7461 6765 2861 782c 2078 7469 636b  matage(ax, xtick
+0000e5c0: 735f 6c6f 632c 2073 7061 6365 203d 3134  s_loc, space =14
+0000e5d0: 2029 0d0a 2020 2020 0d0a 2020 2020 706c   )..    ..    pl
+0000e5e0: 742e 786c 6162 656c 2028 2253 616d 706c  t.xlabel ("Sampl
+0000e5f0: 6520 696e 6465 7820 2229 0d0a 2020 2020  e index ")..    
+0000e600: 706c 742e 796c 6162 656c 2028 2243 6c75  plt.ylabel ("Clu
+0000e610: 7374 6572 2064 6973 7461 6e63 6522 290d  ster distance").
+0000e620: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+0000e630: 2020 2069 6620 7361 7665 6669 6720 6973     if savefig is
+0000e640: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+0000e650: 2020 2020 706c 742e 7361 7665 6669 6728      plt.savefig(
+0000e660: 7361 7665 6669 672c 2064 7069 203d 2033  savefig, dpi = 3
+0000e670: 3030 2029 0d0a 2020 2020 2020 2020 0d0a  00 )..        ..
+0000e680: 2020 2020 706c 742e 636c 6f73 6520 2829      plt.close ()
+0000e690: 2069 6620 7361 7665 6669 6720 6973 206e   if savefig is n
+0000e6a0: 6f74 204e 6f6e 6520 656c 7365 2070 6c74  ot None else plt
+0000e6b0: 2e73 686f 7728 2920 0d0a 2020 2020 0d0a  .show() ..    ..
+0000e6c0: 6465 6620 706c 6f74 5f70 6361 5f63 6f6d  def plot_pca_com
+0000e6d0: 706f 6e65 6e74 7320 280d 0a20 2020 2020  ponents (..     
+0000e6e0: 2020 2063 6f6d 706f 6e65 6e74 732c 202a     components, *
+0000e6f0: 2c20 6665 6174 7572 655f 6e61 6d65 7320  , feature_names 
+0000e700: 3d20 4e6f 6e65 202c 2063 6d61 703d 2027  = None , cmap= '
+0000e710: 7669 7269 6469 7327 2c20 0d0a 2020 2020  viridis', ..    
+0000e720: 2020 2020 7361 7665 6669 673d 4e6f 6e65      savefig=None
+0000e730: 2c20 2a2a 6b77 730d 0a20 2020 2020 2020  , **kws..       
+0000e740: 2029 3a20 0d0a 2020 2020 2222 2220 5669   ): ..    """ Vi
+0000e750: 7375 616c 697a 6520 7468 6520 636f 6566  sualize the coef
+0000e760: 6669 6369 656e 7420 6f66 2070 7269 6e63  ficient of princ
+0000e770: 6970 616c 2063 6f6d 706f 6e65 6e74 2061  ipal component a
+0000e780: 6e61 6c79 7369 7320 2850 4341 2920 6173  nalysis (PCA) as
+0000e790: 200d 0a20 2020 2061 2068 6561 746d 6170   ..    a heatmap
+0000e7a0: 2020 0d0a 2020 0d0a 2020 2020 3a70 6172    ..  ..    :par
+0000e7b0: 616d 2063 6f6d 706f 6e65 6e74 733a 204e  am components: N
+0000e7c0: 6461 7272 6179 2c20 7368 6170 6520 286e  darray, shape (n
+0000e7d0: 5f63 6f6d 706f 6e65 6e74 732c 206e 5f66  _components, n_f
+0000e7e0: 6561 7475 7265 7329 6f72 2050 4341 206f  eatures)or PCA o
+0000e7f0: 626a 6563 7420 0d0a 2020 2020 2020 2020  bject ..        
+0000e800: 4172 7261 7920 6f66 2074 6865 2050 4341  Array of the PCA
+0000e810: 2063 6f6d 706f 6d65 6e74 7320 6f72 206f   compoments or o
+0000e820: 626a 6563 7420 6672 6f6d 200d 0a20 2020  bject from ..   
+0000e830: 2020 2020 203a 636c 6173 733a 6077 6174       :class:`wat
+0000e840: 6578 2e61 6e61 6c79 7369 732e 6469 6d65  ex.analysis.dime
+0000e850: 6e73 696f 6e61 6c69 7479 2e6e 5043 4160  nsionality.nPCA`
+0000e860: 2e20 4966 2074 6865 206f 626a 6563 7420  . If the object 
+0000e870: 6973 2067 6976 656e 200d 0a20 2020 2020  is given ..     
+0000e880: 2020 2069 7420 6973 206e 6f74 206e 6563     it is not nec
+0000e890: 6573 7361 7279 2074 6f20 7365 7420 7468  essary to set th
+0000e8a0: 6520 6066 6561 7475 7265 5f6e 616d 6573  e `feature_names
+0000e8b0: 600d 0a20 2020 203a 7061 7261 6d20 6665  `..    :param fe
+0000e8c0: 6174 7572 655f 6e61 6d65 733a 206c 6973  ature_names: lis
+0000e8d0: 7420 6f72 2073 7472 2c20 6f70 7469 6f6e  t or str, option
+0000e8e0: 616c 200d 0a20 2020 2020 2020 206c 6973  al ..        lis
+0000e8f0: 7420 6f66 2074 6865 2066 6561 7475 7265  t of the feature
+0000e900: 206e 616d 6573 2074 6f20 6c6f 6361 7465   names to locate
+0000e910: 2069 6e20 7468 6520 6d61 702e 2060 4665   in the map. `Fe
+0000e920: 6174 7572 655f 6e61 6d65 7360 2061 6e64  ature_names` and
+0000e930: 200d 0a20 2020 2020 2020 2074 6865 206e   ..        the n
+0000e940: 756d 6265 7220 6f66 2065 6967 656e 2076  umber of eigen v
+0000e950: 6563 746f 7273 206d 7573 7420 6265 2074  ectors must be t
+0000e960: 6865 2073 616d 6520 6c65 6e67 7468 2e20  he same length. 
+0000e970: 4966 2050 4341 206f 626a 6563 7420 6973  If PCA object is
+0000e980: 2020 0d0a 2020 2020 2020 2020 7061 7373    ..        pass
+0000e990: 6564 2061 7320 6063 6f6d 706f 6e65 6e74  ed as `component
+0000e9a0: 7360 2061 7267 756d 656e 7473 2c20 6e6f  s` arguments, no
+0000e9b0: 206e 6565 6420 746f 2073 6574 2074 6865   need to set the
+0000e9c0: 2060 6665 6174 7572 655f 6e61 6d65 7360   `feature_names`
+0000e9d0: 2e20 0d0a 2020 2020 2020 2020 5468 6520  . ..        The 
+0000e9e0: 6e61 6d65 206f 6620 6665 6174 7572 6573  name of features
+0000e9f0: 2069 7320 7265 7472 6569 7665 6420 6175   is retreived au
+0000ea00: 746f 6d61 7469 6361 6c6c 792e 200d 0a20  tomatically. .. 
+0000ea10: 2020 203a 7061 7261 6d20 636d 6170 3a20     :param cmap: 
+0000ea20: 7374 722c 2064 6566 6175 6c74 3d27 7669  str, default='vi
+0000ea30: 7269 6469 7327 0d0a 2020 2020 2020 2020  ridis'..        
+0000ea40: 7468 6520 6d61 7470 6c6f 746c 6962 2063  the matplotlib c
+0000ea50: 6f6c 6f72 206d 6170 2066 6f72 206d 6174  olor map for mat
+0000ea60: 7368 6f77 2076 6973 7561 6c69 7a61 7469  show visualizati
+0000ea70: 6f6e 2e20 0d0a 2020 2020 3a70 6172 616d  on. ..    :param
+0000ea80: 206b 7773 3a20 6469 6374 2c20 0d0a 2020   kws: dict, ..  
+0000ea90: 2020 2020 2020 4164 6469 7469 6f6e 616c        Additional
+0000eaa0: 206b 6579 776f 7264 7320 6172 6775 6d65   keywords argume
+0000eab0: 6e74 7320 7061 7373 6564 2074 6f20 0d0a  nts passed to ..
+0000eac0: 2020 2020 2020 2020 3a63 6c61 7373 3a60          :class:`
+0000ead0: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
+0000eae0: 742e 6d61 7473 686f 7760 0d0a 2020 2020  t.matshow`..    
+0000eaf0: 2020 2020 0d0a 2020 2020 3a45 7861 6d70      ..    :Examp
+0000eb00: 6c65 733a 200d 0a20 2020 2028 3129 2d3e  les: ..    (1)->
+0000eb10: 2077 6974 6820 5043 4120 6f62 6a65 6374   with PCA object
+0000eb20: 200d 0a20 2020 200d 0a20 2020 203e 3e3e   ..    ..    >>>
+0000eb30: 2066 726f 6d20 7761 7465 782e 6461 7461   from watex.data
+0000eb40: 7365 7473 2069 6d70 6f72 7420 6665 7463  sets import fetc
+0000eb50: 685f 6461 7461 0d0a 2020 2020 3e3e 3e20  h_data..    >>> 
+0000eb60: 6672 6f6d 2077 6174 6578 2e75 7469 6c73  from watex.utils
+0000eb70: 2e70 6c6f 7475 7469 6c73 2069 6d70 6f72  .plotutils impor
+0000eb80: 7420 706c 6f74 5f70 6361 5f63 6f6d 706f  t plot_pca_compo
+0000eb90: 6e65 6e74 730d 0a20 2020 203e 3e3e 2066  nents..    >>> f
+0000eba0: 726f 6d20 7761 7465 782e 616e 616c 7973  rom watex.analys
+0000ebb0: 6973 2069 6d70 6f72 7420 6e50 4341 200d  is import nPCA .
+0000ebc0: 0a20 2020 203e 3e3e 2058 2c20 5f3d 2066  .    >>> X, _= f
+0000ebd0: 6574 6368 5f64 6174 6128 2762 6167 6f75  etch_data('bagou
+0000ebe0: 6520 7063 6127 2920 0d0a 2020 2020 3e3e  e pca') ..    >>
+0000ebf0: 3e20 7063 6120 3d20 6e50 4341 2028 582c  > pca = nPCA (X,
+0000ec00: 206e 5f63 6f6d 706f 6e65 6e74 733d 322c   n_components=2,
+0000ec10: 2072 6574 7572 6e5f 5820 3d46 616c 7365   return_X =False
+0000ec20: 2923 2074 6f20 7265 7475 726e 206f 626a  )# to return obj
+0000ec30: 6563 7420 0d0a 2020 2020 3e3e 3e20 706c  ect ..    >>> pl
+0000ec40: 6f74 5f70 6361 5f63 6f6d 706f 6e65 6e74  ot_pca_component
+0000ec50: 7320 2870 6361 290d 0a20 2020 200d 0a20  s (pca)..    .. 
+0000ec60: 2020 2028 3229 2d3e 2075 7365 2074 6865     (2)-> use the
+0000ec70: 2063 6f6d 706f 6e65 6e74 7320 616e 6420   components and 
+0000ec80: 6665 6174 7572 6573 2069 6e64 6976 6964  features individ
+0000ec90: 7561 6c6c 7920 0d0a 2020 2020 0d0a 2020  ually ..    ..  
+0000eca0: 2020 3e3e 3e20 636f 6d70 6f6e 656e 7473    >>> components
+0000ecb0: 203d 2070 6361 2e63 6f6d 706f 6e65 6e74   = pca.component
+0000ecc0: 735f 200d 0a20 2020 203e 3e3e 2066 6561  s_ ..    >>> fea
+0000ecd0: 7475 7265 7320 3d20 7063 612e 6665 6174  tures = pca.feat
+0000ece0: 7572 655f 6e61 6d65 735f 696e 5f0d 0a20  ure_names_in_.. 
+0000ecf0: 2020 203e 3e3e 2070 6c6f 745f 7063 615f     >>> plot_pca_
+0000ed00: 636f 6d70 6f6e 656e 7473 2028 636f 6d70  components (comp
+0000ed10: 6f6e 656e 7473 2c20 6665 6174 7572 655f  onents, feature_
+0000ed20: 6e61 6d65 733d 2066 6561 7475 7265 732c  names= features,
+0000ed30: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0000ed40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed50: 636d 6170 3d27 6a65 745f 7227 290d 0a20  cmap='jet_r').. 
+0000ed60: 2020 200d 0a20 2020 2022 2222 0d0a 2020     ..    """..  
+0000ed70: 2020 6966 2073 702e 6973 7370 6172 7365    if sp.issparse
+0000ed80: 2028 636f 6d70 6f6e 656e 7473 293a 200d   (components): .
+0000ed90: 0a20 2020 2020 2020 2072 6169 7365 2054  .        raise T
+0000eda0: 7970 6545 7272 6f72 2028 2253 7061 7273  ypeError ("Spars
+0000edb0: 6520 6172 7261 7920 6973 206e 6f74 2073  e array is not s
+0000edc0: 7570 706f 7274 6564 2066 6f72 2050 4341  upported for PCA
+0000edd0: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
+0000ede0: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+0000edf0: 6d70 6f6e 656e 7473 2076 6973 7561 6c69  mponents visuali
+0000ee00: 7a61 7469 6f6e 2e22 0d0a 2020 2020 2020  zation."..      
+0000ee10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ee20: 2020 2029 0d0a 2020 2020 2320 6966 2070     )..    # if p
+0000ee30: 6361 206f 626a 6563 7420 6973 2067 6976  ca object is giv
+0000ee40: 656e 202c 2067 6574 2074 6865 2066 6561  en , get the fea
+0000ee50: 7475 7265 7320 6e61 6d65 730d 0a20 2020  tures names..   
+0000ee60: 2069 6620 6861 7361 7474 7228 636f 6d70   if hasattr(comp
+0000ee70: 6f6e 656e 7473 2c20 2266 6561 7475 7265  onents, "feature
+0000ee80: 5f6e 616d 6573 5f69 6e5f 2229 3a20 0d0a  _names_in_"): ..
+0000ee90: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+0000eea0: 6e61 6d65 7320 3d20 6c69 7374 2028 6765  names = list (ge
+0000eeb0: 7461 7474 7220 2863 6f6d 706f 6e65 6e74  tattr (component
+0000eec0: 7320 2c20 2266 6561 7475 7265 5f6e 616d  s , "feature_nam
+0000eed0: 6573 5f69 6e5f 2220 2920 2920 0d0a 2020  es_in_" ) ) ..  
+0000eee0: 2020 2020 2020 0d0a 2020 2020 6966 206e        ..    if n
+0000eef0: 6f74 2068 6173 6174 7472 2028 636f 6d70  ot hasattr (comp
+0000ef00: 6f6e 656e 7473 202c 2022 5f5f 6172 7261  onents , "__arra
+0000ef10: 795f 5f22 293a 200d 0a20 2020 2020 2020  y__"): ..       
+0000ef20: 2063 6f6d 706f 6e65 6e74 7320 3d20 5f63   components = _c
+0000ef30: 6865 636b 5f61 7272 6179 5f69 6e20 2028  heck_array_in  (
+0000ef40: 636f 6d70 6f6e 656e 7473 2c20 2763 6f6d  components, 'com
+0000ef50: 706f 6e65 6e74 735f 2729 0d0a 2020 2020  ponents_')..    
+0000ef60: 2020 2020 0d0a 2020 2020 706c 742e 6d61      ..    plt.ma
+0000ef70: 7473 686f 7728 636f 6d70 6f6e 656e 7473  tshow(components
+0000ef80: 2c20 636d 6170 203d 636d 6170 202c 202a  , cmap =cmap , *
+0000ef90: 2a6b 7773 290d 0a20 2020 2070 6c74 2e79  *kws)..    plt.y
+0000efa0: 7469 636b 7320 285b 3020 2c20 315d 2c20  ticks ([0 , 1], 
+0000efb0: 5b27 4669 7273 7420 636f 6d70 6f6e 656e  ['First componen
+0000efc0: 7427 2c20 2753 6563 6f6e 6420 636f 6d70  t', 'Second comp
+0000efd0: 6f6e 656e 7427 5d29 200d 0a20 2020 2063  onent']) ..    c
+0000efe0: 623d 706c 742e 636f 6c6f 7262 6172 2829  b=plt.colorbar()
+0000eff0: 200d 0a20 2020 2063 622e 7365 745f 6c61   ..    cb.set_la
+0000f000: 6265 6c28 2743 6f65 6666 2076 616c 7565  bel('Coeff value
+0000f010: 2729 0d0a 2020 2020 6966 206e 6f74 2069  ')..    if not i
+0000f020: 735f 6974 6572 6162 6c65 2866 6561 7475  s_iterable(featu
+0000f030: 7265 5f6e 616d 6573 2029 3a20 0d0a 2020  re_names ): ..  
+0000f040: 2020 2020 2020 6665 6174 7572 655f 6e61        feature_na
+0000f050: 6d65 7320 3d20 5b66 6561 7475 7265 5f6e  mes = [feature_n
+0000f060: 616d 6573 205d 0d0a 2020 2020 2020 2020  ames ]..        
+0000f070: 0d0a 2020 2020 6966 206c 656e 2866 6561  ..    if len(fea
+0000f080: 7475 7265 5f6e 616d 6573 2921 3d20 636f  ture_names)!= co
+0000f090: 6d70 6f6e 656e 7473 2e73 6861 7065 205b  mponents.shape [
+0000f0a0: 315d 203a 0d0a 2020 2020 2020 2020 7761  1] :..        wa
+0000f0b0: 726e 696e 6773 2e77 6172 6e28 224e 756d  rnings.warn("Num
+0000f0c0: 6265 7220 6f66 2066 6561 7475 7265 7320  ber of features 
+0000f0d0: 616e 6420 6569 6765 6e76 6563 746f 7273  and eigenvectors
+0000f0e0: 206d 6967 6874 220d 0a20 2020 2020 2020   might"..       
+0000f0f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000f100: 2062 6520 636f 6e73 6973 7465 6e74 2c20   be consistent, 
+0000f110: 6578 7065 6374 207b 307d 2c20 676f 7420  expect {0}, got 
+0000f120: 7b31 7d22 2e20 666f 726d 6174 2820 0d0a  {1}". format( ..
+0000f130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f140: 2020 2020 2020 2020 2020 636f 6d70 6f6e            compon
+0000f150: 656e 7473 2e73 6861 7065 5b31 5d2c 206c  ents.shape[1], l
+0000f160: 656e 2866 6561 7475 7265 5f6e 616d 6573  en(feature_names
+0000f170: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0000f180: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+0000f190: 2020 2020 2066 6561 7475 7265 5f6e 616d       feature_nam
+0000f1a0: 6573 3d4e 6f6e 6520 0d0a 2020 2020 6966  es=None ..    if
+0000f1b0: 2066 6561 7475 7265 5f6e 616d 6573 2069   feature_names i
+0000f1c0: 7320 6e6f 7420 4e6f 6e65 3a20 0d0a 2020  s not None: ..  
+0000f1d0: 2020 2020 2020 706c 742e 7874 6963 6b73        plt.xticks
+0000f1e0: 2028 7261 6e67 6520 286c 656e 2866 6561   (range (len(fea
+0000f1f0: 7475 7265 5f6e 616d 6573 2929 2c20 0d0a  ture_names)), ..
+0000f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f210: 2020 2020 6665 6174 7572 655f 6e61 6d65      feature_name
+0000f220: 7320 2c20 726f 7461 7469 6f6e 203d 2036  s , rotation = 6
+0000f230: 3020 2c20 6861 3d27 6c65 6674 2720 0d0a  0 , ha='left' ..
+0000f240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f250: 2020 2020 290d 0a20 2020 2070 6c74 2e78      )..    plt.x
+0000f260: 6c61 6265 6c20 2822 4665 6174 7572 6522  label ("Feature"
+0000f270: 2920 0d0a 2020 2020 706c 742e 796c 6162  ) ..    plt.ylab
+0000f280: 656c 2028 2250 7269 6e63 6970 616c 2063  el ("Principal c
+0000f290: 6f6d 706f 6e65 6e74 7322 2920 0d0a 2020  omponents") ..  
+0000f2a0: 2020 0d0a 2020 2020 6966 2073 6176 6566    ..    if savef
+0000f2b0: 6967 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ig is not None:.
+0000f2c0: 0a20 2020 2020 2020 2070 6c74 2e73 6176  .        plt.sav
+0000f2d0: 6566 6967 2873 6176 6566 6967 2c20 6470  efig(savefig, dp
+0000f2e0: 6920 3d20 3330 3020 290d 0a20 2020 2020  i = 300 )..     
+0000f2f0: 2020 200d 0a20 2020 2070 6c74 2e63 6c6f     ..    plt.clo
+0000f300: 7365 2028 2920 6966 2073 6176 6566 6967  se () if savefig
+0000f310: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
+0000f320: 6520 706c 742e 7368 6f77 2829 200d 0a20  e plt.show() .. 
+0000f330: 2020 200d 0a20 2020 2020 2020 200d 0a64     ..        ..d
+0000f340: 6566 2070 6c6f 745f 636c 7573 7465 7273  ef plot_clusters
+0000f350: 2028 0d0a 2020 2020 2020 2020 6e5f 636c   (..        n_cl
+0000f360: 7573 7465 7273 2c20 582c 2079 5f70 7265  usters, X, y_pre
+0000f370: 642c 2063 6c75 7374 6572 5f63 656e 7465  d, cluster_cente
+0000f380: 7273 203d 4e6f 6e65 202c 2073 6176 6566  rs =None , savef
+0000f390: 6967 203d 4e6f 6e65 2c20 0d0a 2020 2020  ig =None, ..    
+0000f3a0: 2020 2020 293a 200d 0a20 2020 2022 2222      ): ..    """
+0000f3b0: 2056 6973 7561 6c69 7a65 2074 6865 2063   Visualize the c
+0000f3c0: 6c75 7374 6572 2074 6861 7420 6b2d 6d65  luster that k-me
+0000f3d0: 616e 7320 6964 656e 7469 6669 6564 2069  ans identified i
+0000f3e0: 6e20 7468 6520 6461 7461 7365 7420 0d0a  n the dataset ..
+0000f3f0: 2020 2020 0d0a 2020 2020 3a70 6172 616d      ..    :param
+0000f400: 206e 5f63 6c75 7374 6572 733a 2069 6e74   n_clusters: int
+0000f410: 2c20 6e75 6d62 6572 206f 6620 636c 7573  , number of clus
+0000f420: 7465 7220 746f 2076 6973 7561 6c69 7a65  ter to visualize
+0000f430: 200d 0a20 2020 203a 7061 7261 6d20 583a   ..    :param X:
+0000f440: 204e 4441 7272 6179 2c20 6461 7461 2063   NDArray, data c
+0000f450: 6f6e 7461 696e 696e 6720 7468 6520 6665  ontaining the fe
+0000f460: 6174 7572 6573 2c20 6578 7065 6374 2074  atures, expect t
+0000f470: 6f20 6265 2061 2074 776f 200d 0a20 2020  o be a two ..   
+0000f480: 2020 2020 2064 696d 656e 7369 6f6e 616c       dimensional
+0000f490: 2064 6174 6120 0d0a 2020 2020 3a70 6172   data ..    :par
+0000f4a0: 616d 2079 5f70 7265 643a 2061 7272 6179  am y_pred: array
+0000f4b0: 2d6c 696b 652c 2061 7272 6179 2063 6f6e  -like, array con
+0000f4c0: 7461 696e 696e 6720 7468 6520 7072 6564  taining the pred
+0000f4d0: 6963 7465 6420 636c 6173 7320 6c61 6265  icted class labe
+0000f4e0: 6c73 2e20 0d0a 2020 2020 3a70 6172 616d  ls. ..    :param
+0000f4f0: 2063 6c75 7374 6572 5f63 656e 7465 7273   cluster_centers
+0000f500: 5f3a 204e 4441 7272 6179 2063 6f6e 7461  _: NDArray conta
+0000f510: 696e 6720 7468 6520 636f 6f72 6469 6e61  ing the coordina
+0000f520: 7465 7320 6f66 2074 6865 200d 0a20 2020  tes of the ..   
+0000f530: 2020 2020 2063 656e 7472 6f69 6473 206f       centroids o
+0000f540: 7220 7468 6520 7369 6d69 6c61 7220 706f  r the similar po
+0000f550: 696e 7473 2077 6974 6820 636f 6e74 696e  ints with contin
+0000f560: 6f75 7320 6665 6174 7572 6573 2e20 0d0a  ous features. ..
+0000f570: 2020 2020 2020 2020 0d0a 2020 2020 3a45          ..    :E
+0000f580: 7861 6d70 6c65 3a20 0d0a 2020 2020 3e3e  xample: ..    >>
+0000f590: 3e20 6672 6f6d 2077 6174 6578 2e65 786c  > from watex.exl
+0000f5a0: 6962 2e73 6b6c 6561 726e 2069 6d70 6f72  ib.sklearn impor
+0000f5b0: 7420 4b4d 6561 6e73 2c20 4d69 6e4d 6178  t KMeans, MinMax
+0000f5c0: 5363 616c 6572 0d0a 2020 2020 3e3e 3e20  Scaler..    >>> 
+0000f5d0: 6672 6f6d 2077 6174 6578 2e75 7469 6c73  from watex.utils
+0000f5e0: 2e70 6c6f 7475 7469 6c73 2069 6d70 6f72  .plotutils impor
+0000f5f0: 7420 706c 6f74 5f63 6c75 7374 6572 730d  t plot_clusters.
+0000f600: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
+0000f610: 7465 782e 6461 7461 7365 7473 2069 6d70  tex.datasets imp
+0000f620: 6f72 7420 6665 7463 685f 6461 7461 200d  ort fetch_data .
+0000f630: 0a20 2020 203e 3e3e 2068 3d20 6665 7463  .    >>> h= fetc
+0000f640: 685f 6461 7461 2827 686c 6f67 7327 292e  h_data('hlogs').
+0000f650: 6672 616d 6520 0d0a 2020 2020 3e3e 3e20  frame ..    >>> 
+0000f660: 2320 636f 6c6c 6563 7420 7477 6f20 6665  # collect two fe
+0000f670: 6174 7572 6573 2027 7265 7369 7374 6976  atures 'resistiv
+0000f680: 6974 7927 2061 6e64 2067 616d 6d61 2d67  ity' and gamma-g
+0000f690: 616d 6d61 206c 6f67 6769 6e67 2076 616c  amma logging val
+0000f6a0: 7565 730d 0a20 2020 203e 3e3e 2068 3220  ues..    >>> h2 
+0000f6b0: 3d20 685b 5b27 7265 7369 7374 6976 6974  = h[['resistivit
+0000f6c0: 7927 2c20 2767 616d 6d61 5f67 616d 6d61  y', 'gamma_gamma
+0000f6d0: 275d 5d20 0d0a 2020 2020 3e3e 3e20 6b6d  ']] ..    >>> km
+0000f6e0: 203d 204b 4d65 616e 7320 286e 5f63 6c75   = KMeans (n_clu
+0000f6f0: 7374 6572 7320 3d33 202c 2069 6e69 743d  sters =3 , init=
+0000f700: 2027 7261 6e64 6f6d 2720 2920 0d0a 2020   'random' ) ..  
+0000f710: 2020 3e3e 3e20 2320 7363 616c 6564 2074    >>> # scaled t
+0000f720: 6865 2064 6174 6120 7769 7468 204d 696e  he data with Min
+0000f730: 4d61 7820 7363 616c 6572 2069 2e65 2e20  Max scaler i.e. 
+0000f740: 6265 7477 6565 6e20 2820 302d 3129 200d  between ( 0-1) .
+0000f750: 0a20 2020 203e 3e3e 2068 325f 7363 616c  .    >>> h2_scal
+0000f760: 6564 203d 204d 696e 4d61 7853 6361 6c65  ed = MinMaxScale
+0000f770: 7228 292e 6669 745f 7472 616e 7366 6f72  r().fit_transfor
+0000f780: 6d28 6832 290d 0a20 2020 203e 3e3e 2079  m(h2)..    >>> y
+0000f790: 6b6d 203d 206b 6d2e 6669 745f 7072 6564  km = km.fit_pred
+0000f7a0: 6963 7428 6832 5f73 6361 6c65 6420 290d  ict(h2_scaled ).
+0000f7b0: 0a20 2020 203e 3e3e 2070 6c6f 745f 636c  .    >>> plot_cl
+0000f7c0: 7573 7465 7273 2028 3320 2c20 6832 5f73  usters (3 , h2_s
+0000f7d0: 6361 6c65 642c 2079 6b6d 202c 206b 6d2e  caled, ykm , km.
+0000f7e0: 636c 7573 7465 725f 6365 6e74 6572 735f  cluster_centers_
+0000f7f0: 2029 0d0a 2020 2020 2020 2020 0d0a 2020   )..        ..  
+0000f800: 2020 2222 220d 0a20 2020 206e 5f63 6c75    """..    n_clu
+0000f810: 7374 6572 7320 3d20 696e 7428 0d0a 2020  sters = int(..  
+0000f820: 2020 2020 2020 5f61 7373 6572 745f 616c        _assert_al
+0000f830: 6c5f 7479 7065 7328 6e5f 636c 7573 7465  l_types(n_cluste
+0000f840: 7273 2c20 696e 742c 2066 6c6f 6174 2c20  rs, int, float, 
+0000f850: 206f 626a 6e61 6d65 203d 2227 6e5f 636c   objname ="'n_cl
+0000f860: 7573 7465 7273 2722 2029 0d0a 2020 2020  usters'" )..    
+0000f870: 2020 2020 290d 0a20 2020 2058 2c20 795f      )..    X, y_
+0000f880: 7072 6564 203d 2063 6865 636b 5f58 5f79  pred = check_X_y
+0000f890: 280d 0a20 2020 2020 2020 2058 2c20 0d0a  (..        X, ..
+0000f8a0: 2020 2020 2020 2020 795f 7072 6564 2c20          y_pred, 
+0000f8b0: 0d0a 2020 2020 2020 2020 290d 0a0d 0a20  ..        ).... 
+0000f8c0: 2020 2069 6620 6c65 6e28 582e 7368 6170     if len(X.shap
+0000f8d0: 6520 2921 3d32 206f 7220 582e 7368 6170  e )!=2 or X.shap
+0000f8e0: 655b 315d 3d3d 313a 200d 0a20 2020 2020  e[1]==1: ..     
+0000f8f0: 2020 206e 6469 6d20 3d20 3120 6966 2058     ndim = 1 if X
+0000f900: 2e73 6861 7065 5b31 5d20 3d3d 3120 656c  .shape[1] ==1 el
+0000f910: 7365 206e 702e 6e64 696d 2028 5820 290d  se np.ndim (X ).
+0000f920: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+0000f930: 616c 7565 4572 726f 7228 0d0a 2020 2020  alueError(..    
+0000f940: 2020 2020 2020 2020 6622 5820 6973 2065          f"X is e
+0000f950: 7870 6563 7465 6420 746f 2062 6520 6120  xpected to be a 
+0000f960: 7477 6f20 6469 6d65 6e73 696f 6e61 6c20  two dimensional 
+0000f970: 6461 7461 2e20 476f 7420 7b6e 6469 6d7d  data. Got {ndim}
+0000f980: 2122 290d 0a20 2020 2023 2066 6f72 2063  !")..    # for c
+0000f990: 6f6e 7369 7374 656e 6379 202c 2063 6f6e  onsistency , con
+0000f9a0: 7665 7274 2079 2074 6f20 6172 7261 7920  vert y to array 
+0000f9b0: 2020 200d 0a20 2020 2079 5f70 7265 6420     ..    y_pred 
+0000f9c0: 3d20 6e70 2e61 7272 6179 2879 5f70 7265  = np.array(y_pre
+0000f9d0: 6429 0d0a 2020 2020 0d0a 2020 2020 636f  d)..    ..    co
+0000f9e0: 6c6f 7273 203d 206d 616b 655f 6d70 6c5f  lors = make_mpl_
+0000f9f0: 7072 6f70 6572 7469 6573 286e 5f63 6c75  properties(n_clu
+0000fa00: 7374 6572 7329 0d0a 2020 2020 6d61 726b  sters)..    mark
+0000fa10: 6572 7320 3d20 6d61 6b65 5f6d 706c 5f70  ers = make_mpl_p
+0000fa20: 726f 7065 7274 6965 7328 6e5f 636c 7573  roperties(n_clus
+0000fa30: 7465 7273 2c20 276d 6172 6b65 7273 2729  ters, 'markers')
+0000fa40: 0d0a 2020 2020 666f 7220 6e20 696e 2072  ..    for n in r
+0000fa50: 616e 6765 2028 6e5f 636c 7573 7465 7273  ange (n_clusters
+0000fa60: 293a 0d0a 2020 2020 2020 2020 706c 742e  ):..        plt.
+0000fa70: 7363 6174 7465 7220 2858 5b79 5f70 7265  scatter (X[y_pre
+0000fa80: 6420 3d3d 6e2c 2030 5d2c 200d 0a20 2020  d ==n, 0], ..   
+0000fa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000faa0: 2020 585b 795f 7072 6564 203d 3d6e 202c    X[y_pred ==n ,
+0000fab0: 2031 5d2c 2020 0d0a 2020 2020 2020 2020   1],  ..        
+0000fac0: 2020 2020 2020 2020 2020 2020 2073 3d20               s= 
+0000fad0: 3530 202c 2063 3d20 636f 6c6f 7273 205b  50 , c= colors [
+0000fae0: 6e20 5d2c 200d 0a20 2020 2020 2020 2020  n ], ..         
+0000faf0: 2020 2020 2020 2020 2020 2020 6d61 726b              mark
+0000fb00: 6572 3d6d 6172 6b65 7273 205b 6e5d 2c20  er=markers [n], 
+0000fb10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000fb20: 2020 2020 2020 2065 6467 6563 6f6c 6f72         edgecolor
+0000fb30: 733d 4e6f 6e65 2069 6620 6d61 726b 6572  s=None if marker
+0000fb40: 7320 5b6e 5d20 3d3d 2778 2720 656c 7365  s [n] =='x' else
+0000fb50: 2027 626c 6163 6b27 2c20 0d0a 2020 2020   'black', ..    
+0000fb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fb70: 206c 6162 656c 203d 2066 2743 6c75 7374   label = f'Clust
+0000fb80: 6572 207b 6e20 2b31 7d27 0d0a 2020 2020  er {n +1}'..    
+0000fb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fba0: 2029 200d 0a20 2020 2069 6620 636c 7573   ) ..    if clus
+0000fbb0: 7465 725f 6365 6e74 6572 7320 6973 206e  ter_centers is n
+0000fbc0: 6f74 204e 6f6e 653a 200d 0a20 2020 2020  ot None: ..     
+0000fbd0: 2020 2063 6c75 7374 6572 5f63 656e 7465     cluster_cente
+0000fbe0: 7273 203d 206e 702e 6172 7261 7920 2863  rs = np.array (c
+0000fbf0: 6c75 7374 6572 5f63 656e 7465 7273 290d  luster_centers).
+0000fc00: 0a20 2020 2020 2020 2070 6c74 2e73 6361  .        plt.sca
+0000fc10: 7474 6572 2028 636c 7573 7465 725f 6365  tter (cluster_ce
+0000fc20: 6e74 6572 735b 3a2c 2030 205d 2c20 0d0a  nters[:, 0 ], ..
+0000fc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc40: 2020 2020 2063 6c75 7374 6572 5f63 656e       cluster_cen
+0000fc50: 7465 7273 205b 3a2c 2031 5d2c 200d 0a20  ters [:, 1], .. 
+0000fc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc70: 2020 2020 733d 2032 3530 2e20 2c20 6d61      s= 250. , ma
+0000fc80: 726b 6572 203d 272a 272c 200d 0a20 2020  rker ='*', ..   
+0000fc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fca0: 2020 633d 2772 6564 272c 2065 6467 6563    c='red', edgec
+0000fcb0: 6f6c 6f72 733d 2762 6c61 636b 272c 200d  olors='black', .
+0000fcc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fcd0: 2020 2020 2020 6c61 6265 6c3d 2763 656e        label='cen
+0000fce0: 7472 6f69 6473 2720 0d0a 2020 2020 2020  troids' ..      
+0000fcf0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000fd00: 200d 0a20 2020 2070 6c74 2e6c 6567 656e   ..    plt.legen
+0000fd10: 6420 2873 6361 7474 6572 706f 696e 7473  d (scatterpoints
+0000fd20: 203d 3120 2920 0d0a 2020 2020 706c 742e   =1 ) ..    plt.
+0000fd30: 6772 6964 2829 200d 0a20 2020 2070 6c74  grid() ..    plt
+0000fd40: 2e74 6967 6874 5f6c 6179 6f75 7428 2920  .tight_layout() 
+0000fd50: 0d0a 2020 2020 0d0a 2020 2020 6966 2073  ..    ..    if s
+0000fd60: 6176 6566 6967 2069 7320 6e6f 7420 4e6f  avefig is not No
+0000fd70: 6e65 3a0d 0a20 2020 2020 2020 2020 7361  ne:..         sa
+0000fd80: 7665 6669 6775 7265 2873 6176 6566 6967  vefigure(savefig
+0000fd90: 2c20 7361 7665 6669 6720 290d 0a20 2020  , savefig )..   
+0000fda0: 2070 6c74 2e63 6c6f 7365 2028 2920 6966   plt.close () if
+0000fdb0: 2073 6176 6566 6967 2069 7320 6e6f 7420   savefig is not 
+0000fdc0: 4e6f 6e65 2065 6c73 6520 706c 742e 7368  None else plt.sh
+0000fdd0: 6f77 2829 200d 0a20 2020 200d 0a20 2020  ow() ..    ..   
+0000fde0: 200d 0a64 6566 2070 6c6f 745f 656c 626f   ..def plot_elbo
+0000fdf0: 7720 280d 0a20 2020 2020 2020 2058 2c20  w (..        X, 
+0000fe00: 206e 5f63 6c75 7374 6572 7320 2c20 6e5f   n_clusters , n_
+0000fe10: 696e 6974 203d 2031 3020 2c20 6d61 785f  init = 10 , max_
+0000fe20: 6974 6572 203d 2033 3030 202c 2072 616e  iter = 300 , ran
+0000fe30: 646f 6d5f 7374 6174 653d 3432 202c 0d0a  dom_state=42 ,..
+0000fe40: 2020 2020 2020 2020 6669 675f 7369 7a65          fig_size
+0000fe50: 203d 2028 3130 2c20 3420 292c 206d 6172   = (10, 4 ), mar
+0000fe60: 6b65 7220 3d20 276f 272c 2073 6176 6566  ker = 'o', savef
+0000fe70: 6967 3d20 4e6f 6e65 2c20 0d0a 2020 2020  ig= None, ..    
+0000fe80: 2020 2020 2a2a 6b77 6429 3a20 0d0a 2020      **kwd): ..  
+0000fe90: 2020 2222 2220 506c 6f74 2065 6c62 6f77    """ Plot elbow
+0000fea0: 206d 6574 686f 6420 746f 2066 696e 6420   method to find 
+0000feb0: 7468 6520 6f70 7469 6d61 6c20 6e75 6d62  the optimal numb
+0000fec0: 6572 206f 6620 636c 7573 7465 722c 206b  er of cluster, k
+0000fed0: 272c 200d 0a20 2020 2066 6f72 2061 2067  ', ..    for a g
+0000fee0: 6976 656e 2064 6174 612e 200d 0a20 2020  iven data. ..   
+0000fef0: 200d 0a20 2020 2050 6172 616d 6574 6572   ..    Parameter
+0000ff00: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
+0000ff10: 2d0d 0a20 2020 2058 203a 207b 6172 7261  -..    X : {arra
+0000ff20: 792d 6c69 6b65 2c20 7370 6172 7365 206d  y-like, sparse m
+0000ff30: 6174 7269 787d 206f 6620 7368 6170 6520  atrix} of shape 
+0000ff40: 286e 5f73 616d 706c 6573 2c20 6e5f 6665  (n_samples, n_fe
+0000ff50: 6174 7572 6573 290d 0a20 2020 2020 2020  atures)..       
+0000ff60: 2054 7261 696e 696e 6720 696e 7374 616e   Training instan
+0000ff70: 6365 7320 746f 2063 6c75 7374 6572 2e20  ces to cluster. 
+0000ff80: 4974 206d 7573 7420 6265 206e 6f74 6564  It must be noted
+0000ff90: 2074 6861 7420 7468 6520 6461 7461 0d0a   that the data..
+0000ffa0: 2020 2020 2020 2020 7769 6c6c 2062 6520          will be 
+0000ffb0: 636f 6e76 6572 7465 6420 746f 2043 206f  converted to C o
+0000ffc0: 7264 6572 696e 672c 2077 6869 6368 2077  rdering, which w
+0000ffd0: 696c 6c20 6361 7573 6520 6120 6d65 6d6f  ill cause a memo
+0000ffe0: 7279 0d0a 2020 2020 2020 2020 636f 7079  ry..        copy
+0000fff0: 2069 6620 7468 6520 6769 7665 6e20 6461   if the given da
+00010000: 7461 2069 7320 6e6f 7420 432d 636f 6e74  ta is not C-cont
+00010010: 6967 756f 7573 2e0d 0a20 2020 2020 2020  iguous...       
+00010020: 2049 6620 6120 7370 6172 7365 206d 6174   If a sparse mat
+00010030: 7269 7820 6973 2070 6173 7365 642c 2061  rix is passed, a
+00010040: 2063 6f70 7920 7769 6c6c 2062 6520 6d61   copy will be ma
+00010050: 6465 2069 6620 6974 2773 206e 6f74 2069  de if it's not i
+00010060: 6e0d 0a20 2020 2020 2020 2043 5352 2066  n..        CSR f
+00010070: 6f72 6d61 742e 0d0a 0d0a 2020 2020 6e5f  ormat.....    n_
+00010080: 636c 7573 7465 7273 203a 2069 6e74 2c20  clusters : int, 
+00010090: 6465 6661 756c 743d 380d 0a20 2020 2020  default=8..     
+000100a0: 2020 2054 6865 206e 756d 6265 7220 6f66     The number of
+000100b0: 2063 6c75 7374 6572 7320 746f 2066 6f72   clusters to for
+000100c0: 6d20 6173 2077 656c 6c20 6173 2074 6865  m as well as the
+000100d0: 206e 756d 6265 7220 6f66 0d0a 2020 2020   number of..    
+000100e0: 2020 2020 6365 6e74 726f 6964 7320 746f      centroids to
+000100f0: 2067 656e 6572 6174 652e 0d0a 0d0a 2020   generate.....  
+00010100: 2020 6e5f 696e 6974 203a 2069 6e74 2c20    n_init : int, 
+00010110: 6465 6661 756c 743d 3130 0d0a 2020 2020  default=10..    
+00010120: 2020 2020 4e75 6d62 6572 206f 6620 7469      Number of ti
+00010130: 6d65 2074 6865 206b 2d6d 6561 6e73 2061  me the k-means a
+00010140: 6c67 6f72 6974 686d 2077 696c 6c20 6265  lgorithm will be
+00010150: 2072 756e 2077 6974 6820 6469 6666 6572   run with differ
+00010160: 656e 740d 0a20 2020 2020 2020 2063 656e  ent..        cen
+00010170: 7472 6f69 6420 7365 6564 732e 2054 6865  troid seeds. The
+00010180: 2066 696e 616c 2072 6573 756c 7473 2077   final results w
+00010190: 696c 6c20 6265 2074 6865 2062 6573 7420  ill be the best 
+000101a0: 6f75 7470 7574 206f 660d 0a20 2020 2020  output of..     
+000101b0: 2020 206e 5f69 6e69 7420 636f 6e73 6563     n_init consec
+000101c0: 7574 6976 6520 7275 6e73 2069 6e20 7465  utive runs in te
+000101d0: 726d 7320 6f66 2069 6e65 7274 6961 2e0d  rms of inertia..
+000101e0: 0a0d 0a20 2020 206d 6178 5f69 7465 7220  ...    max_iter 
+000101f0: 3a20 696e 742c 2064 6566 6175 6c74 3d33  : int, default=3
+00010200: 3030 0d0a 2020 2020 2020 2020 4d61 7869  00..        Maxi
+00010210: 6d75 6d20 6e75 6d62 6572 206f 6620 6974  mum number of it
+00010220: 6572 6174 696f 6e73 206f 6620 7468 6520  erations of the 
+00010230: 6b2d 6d65 616e 7320 616c 676f 7269 7468  k-means algorith
+00010240: 6d20 666f 7220 610d 0a20 2020 2020 2020  m for a..       
+00010250: 2073 696e 676c 6520 7275 6e2e 0d0a 0d0a   single run.....
+00010260: 2020 2020 746f 6c20 3a20 666c 6f61 742c      tol : float,
+00010270: 2064 6566 6175 6c74 3d31 652d 340d 0a20   default=1e-4.. 
+00010280: 2020 2020 2020 2052 656c 6174 6976 6520         Relative 
+00010290: 746f 6c65 7261 6e63 6520 7769 7468 2072  tolerance with r
+000102a0: 6567 6172 6473 2074 6f20 4672 6f62 656e  egards to Froben
+000102b0: 6975 7320 6e6f 726d 206f 6620 7468 6520  ius norm of the 
+000102c0: 6469 6666 6572 656e 6365 0d0a 2020 2020  difference..    
+000102d0: 2020 2020 696e 2074 6865 2063 6c75 7374      in the clust
+000102e0: 6572 2063 656e 7465 7273 206f 6620 7477  er centers of tw
+000102f0: 6f20 636f 6e73 6563 7574 6976 6520 6974  o consecutive it
+00010300: 6572 6174 696f 6e73 2074 6f20 6465 636c  erations to decl
+00010310: 6172 650d 0a20 2020 2020 2020 2063 6f6e  are..        con
+00010320: 7665 7267 656e 6365 2e0d 0a0d 0a20 2020  vergence.....   
+00010330: 2076 6572 626f 7365 203a 2069 6e74 2c20   verbose : int, 
+00010340: 6465 6661 756c 743d 300d 0a20 2020 2020  default=0..     
+00010350: 2020 2056 6572 626f 7369 7479 206d 6f64     Verbosity mod
+00010360: 652e 0d0a 0d0a 2020 2020 7261 6e64 6f6d  e.....    random
+00010370: 5f73 7461 7465 203a 2069 6e74 2c20 5261  _state : int, Ra
+00010380: 6e64 6f6d 5374 6174 6520 696e 7374 616e  ndomState instan
+00010390: 6365 206f 7220 4e6f 6e65 2c20 6465 6661  ce or None, defa
+000103a0: 756c 743d 3432 0d0a 2020 2020 2020 2020  ult=42..        
+000103b0: 4465 7465 726d 696e 6573 2072 616e 646f  Determines rando
+000103c0: 6d20 6e75 6d62 6572 2067 656e 6572 6174  m number generat
+000103d0: 696f 6e20 666f 7220 6365 6e74 726f 6964  ion for centroid
+000103e0: 2069 6e69 7469 616c 697a 6174 696f 6e2e   initialization.
+000103f0: 2055 7365 0d0a 2020 2020 2020 2020 616e   Use..        an
+00010400: 2069 6e74 2074 6f20 6d61 6b65 2074 6865   int to make the
+00010410: 2072 616e 646f 6d6e 6573 7320 6465 7465   randomness dete
+00010420: 726d 696e 6973 7469 632e 0d0a 2020 2020  rministic...    
+00010430: 2020 2020 0d0a 2020 2020 7361 7665 6669      ..    savefi
+00010440: 673a 2073 7472 2c20 6465 6661 756c 7420  g: str, default 
+00010450: 3d4e 6f6e 6520 2c20 0d0a 2020 2020 2020  =None , ..      
+00010460: 2020 7468 6520 7061 7468 2074 6f20 7361    the path to sa
+00010470: 7665 2074 6865 2066 6967 7572 652e 2041  ve the figure. A
+00010480: 7267 756d 656e 7420 6973 2070 6173 7365  rgument is passe
+00010490: 6420 746f 200d 0a20 2020 2020 2020 203a  d to ..        :
+000104a0: 636c 6173 733a 606d 6174 706c 6f74 6c69  class:`matplotli
+000104b0: 622e 4669 6775 7265 6020 636c 6173 732e  b.Figure` class.
+000104c0: 200d 0a20 2020 206d 6172 6b65 723a 2073   ..    marker: s
+000104d0: 7472 2c20 6465 6661 756c 743d 276f 272c  tr, default='o',
+000104e0: 200d 0a20 2020 2020 2020 2063 6c75 7374   ..        clust
+000104f0: 6572 206d 6172 6b65 7220 706f 696e 742e  er marker point.
+00010500: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00010510: 206b 7764 3a20 6469 6374 0d0a 2020 2020   kwd: dict..    
+00010520: 2020 2020 4164 6469 6f6e 6e61 6c20 6b65      Addionnal ke
+00010530: 7977 6f72 6473 2061 7267 756d 656e 7473  ywords arguments
+00010540: 2070 6173 7365 6420 746f 203a 6675 6e63   passed to :func
+00010550: 3a60 6d61 7470 6c6f 746c 6962 2e70 7970  :`matplotlib.pyp
+00010560: 6c6f 742e 706c 6f74 600d 0a20 2020 2020  lot.plot`..     
+00010570: 2020 200d 0a20 2020 2052 6574 7572 6e73     ..    Returns
+00010580: 200d 0a20 2020 202d 2d2d 2d2d 2d2d 2d0d   ..    --------.
+00010590: 0a20 2020 2061 783a 204d 6174 706c 6f74  .    ax: Matplot
+000105a0: 6c69 622e 7079 706c 6f74 2061 7865 7320  lib.pyplot axes 
+000105b0: 6f62 6a65 6374 7320 0d0a 2020 2020 0d0a  objects ..    ..
+000105c0: 2020 2020 4578 616d 706c 650d 0a20 2020      Example..   
+000105d0: 202d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020   ---------..    
+000105e0: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e64  >>> from watex.d
+000105f0: 6174 6173 6574 7320 696d 706f 7274 206c  atasets import l
+00010600: 6f61 645f 686c 6f67 7320 0d0a 2020 2020  oad_hlogs ..    
+00010610: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e75  >>> from watex.u
+00010620: 7469 6c73 2e70 6c6f 7475 7469 6c73 2069  tils.plotutils i
+00010630: 6d70 6f72 7420 706c 6f74 5f65 6c62 6f77  mport plot_elbow
+00010640: 200d 0a20 2020 203e 3e3e 2023 2067 6574   ..    >>> # get
+00010650: 2074 6865 206f 6e6c 7920 7265 7369 7374   the only resist
+00010660: 6976 7920 616e 6420 6761 6d6d 612d 6761  ivy and gamma-ga
+00010670: 6d61 2076 616c 7565 7320 666f 7220 6578  ma values for ex
+00010680: 616d 706c 650d 0a20 2020 203e 3e3e 2072  ample..    >>> r
+00010690: 6573 5f67 616d 6d61 203d 206c 6f61 645f  es_gamma = load_
+000106a0: 686c 6f67 7320 2829 2e66 7261 6d65 5b5b  hlogs ().frame[[
+000106b0: 2772 6573 6973 7469 7669 7479 272c 2027  'resistivity', '
+000106c0: 6761 6d6d 615f 6761 6d6d 6127 5d5d 2020  gamma_gamma']]  
+000106d0: 0d0a 2020 2020 3e3e 3e20 706c 6f74 5f65  ..    >>> plot_e
+000106e0: 6c62 6f77 2872 6573 5f67 616d 6d61 2c20  lbow(res_gamma, 
+000106f0: 6e5f 636c 7573 7465 7273 3d31 3129 0d0a  n_clusters=11)..
+00010700: 2020 2020 0d0a 2020 2020 2222 220d 0a20      ..    """.. 
+00010710: 2020 2064 6973 746f 7273 696f 6e73 203d     distorsions =
+00010720: 5b5d 203b 206e 5f63 6c75 7374 6572 7320  [] ; n_clusters 
+00010730: 3d20 3131 0d0a 2020 2020 666f 7220 6920  = 11..    for i 
+00010740: 696e 2072 616e 6765 2028 312c 206e 5f63  in range (1, n_c
+00010750: 6c75 7374 6572 7320 293a 200d 0a20 2020  lusters ): ..   
+00010760: 2020 2020 206b 6d20 3d4b 4d65 616e 7320       km =KMeans 
+00010770: 286e 5f63 6c75 7374 6572 7320 3d69 202c  (n_clusters =i ,
+00010780: 2069 6e69 743d 2027 6b2d 6d65 616e 732b   init= 'k-means+
+00010790: 2b27 2c20 0d0a 2020 2020 2020 2020 2020  +', ..          
+000107a0: 2020 2020 2020 2020 2020 6e5f 696e 6974            n_init
+000107b0: 3d6e 5f69 6e69 7420 2c20 6d61 785f 6974  =n_init , max_it
+000107c0: 6572 3d6d 6178 5f69 7465 722c 200d 0a20  er=max_iter, .. 
+000107d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000107e0: 2020 2072 616e 646f 6d5f 7374 6174 6520     random_state 
+000107f0: 3d72 616e 646f 6d5f 7374 6174 6520 0d0a  =random_state ..
+00010800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010810: 2020 2020 290d 0a20 2020 2020 2020 206b      )..        k
+00010820: 6d2e 6669 7428 5829 200d 0a20 2020 2020  m.fit(X) ..     
+00010830: 2020 2064 6973 746f 7273 696f 6e73 2e61     distorsions.a
+00010840: 7070 656e 6428 6b6d 2e69 6e65 7274 6961  ppend(km.inertia
+00010850: 5f29 200d 0a20 2020 2020 2020 2020 2020  _) ..           
+00010860: 200d 0a20 2020 2061 7820 3d20 5f70 6c6f   ..    ax = _plo
+00010870: 745f 656c 626f 7720 2864 6973 746f 7273  t_elbow (distors
+00010880: 696f 6e73 2c20 6e5f 636c 7573 7465 7273  ions, n_clusters
+00010890: 203d 6e5f 636c 7573 7465 7273 2c66 6967   =n_clusters,fig
+000108a0: 5f73 697a 6520 3d20 6669 675f 7369 7a65  _size = fig_size
+000108b0: 202c 0d0a 2020 2020 2020 2020 2020 2020   ,..            
+000108c0: 2020 2020 2020 2020 2020 6d61 726b 6572            marker
+000108d0: 203d 6d61 726b 6572 202c 2073 6176 6566   =marker , savef
+000108e0: 6967 203d 7361 7665 6669 672c 202a 2a6b  ig =savefig, **k
+000108f0: 7764 2920 0d0a 0d0a 2020 2020 7265 7475  wd) ....    retu
+00010900: 726e 2061 7820 0d0a 2020 2020 0d0a 6465  rn ax ..    ..de
+00010910: 6620 5f70 6c6f 745f 656c 626f 7720 2864  f _plot_elbow (d
+00010920: 6973 746f 7273 696f 6e73 3a20 6c69 7374  istorsions: list
+00010930: 2020 2c20 6e5f 636c 7573 7465 7273 3a69    , n_clusters:i
+00010940: 6e74 202c 6669 675f 7369 7a65 203d 2028  nt ,fig_size = (
+00010950: 3130 202c 2034 2029 2c20 200d 0a20 2020  10 , 4 ),  ..   
+00010960: 2020 2020 2020 2020 2020 2020 6d61 726b              mark
+00010970: 6572 3d27 6f27 2c20 7361 7665 6669 6720  er='o', savefig 
+00010980: 3d4e 6f6e 652c 202a 2a6b 7764 293a 200d  =None, **kwd): .
+00010990: 0a20 2020 2022 2222 2050 6c6f 7420 7468  .    """ Plot th
+000109a0: 6520 6f70 7469 6d61 6c20 6e75 6d62 6572  e optimal number
+000109b0: 206f 6620 636c 7573 7465 722c 206b 272c   of cluster, k',
+000109c0: 2066 6f72 2061 2067 6976 656e 2063 6c61   for a given cla
+000109d0: 7373 200d 0a20 2020 200d 0a20 2020 203a  ss ..    ..    :
+000109e0: 7061 7261 6d20 6469 7374 6f72 7369 6f6e  param distorsion
+000109f0: 733a 206c 6973 7420 2d20 6c69 7374 206f  s: list - list o
+00010a00: 6620 7661 6c75 6573 2077 6974 6869 6e67  f values withing
+00010a10: 2074 6865 2073 756d 2d73 7175 6172 6564   the sum-squared
+00010a20: 2d65 7272 6f72 200d 0a20 2020 2020 2020  -error ..       
+00010a30: 2028 5353 4529 2061 6c73 6f20 6361 6c6c   (SSE) also call
+00010a40: 6564 2020 6069 6e65 7274 6961 5f60 2069  ed  `inertia_` i
+00010a50: 6e20 7363 6b69 742d 6c65 6172 6e2e 200d  n sckit-learn. .
+00010a60: 0a20 2020 200d 0a20 2020 203a 7061 7261  .    ..    :para
+00010a70: 6d20 6e5f 636c 7573 7465 7273 3a20 6e75  m n_clusters: nu
+00010a80: 6d62 6572 206f 6620 636c 7573 7465 7273  mber of clusters
+00010a90: 2e20 7768 6572 6520 6b20 7374 6172 7473  . where k starts
+00010aa0: 2061 6e64 2065 6e64 2e20 0d0a 2020 2020   and end. ..    
+00010ab0: 0d0a 2020 2020 3a72 6574 7572 6e73 3a20  ..    :returns: 
+00010ac0: 6178 3a20 4d61 7470 6c6f 746c 6962 2e70  ax: Matplotlib.p
+00010ad0: 7970 6c6f 7420 6178 6573 206f 626a 6563  yplot axes objec
+00010ae0: 7473 200d 0a20 2020 200d 0a20 2020 203a  ts ..    ..    :
+00010af0: 4578 616d 706c 653a 200d 0a20 2020 203e  Example: ..    >
+00010b00: 3e3e 2069 6d70 6f72 7420 6e75 6d70 7920  >> import numpy 
+00010b10: 6173 206e 7020 0d0a 2020 2020 3e3e 3e20  as np ..    >>> 
+00010b20: 6672 6f6d 2073 6b6c 6561 726e 2e63 6c75  from sklearn.clu
+00010b30: 7374 6572 2069 6d70 6f72 7420 4b4d 6561  ster import KMea
+00010b40: 6e73 200d 0a20 2020 203e 3e3e 2066 726f  ns ..    >>> fro
+00010b50: 6d20 7761 7465 782e 6461 7461 7365 7473  m watex.datasets
+00010b60: 2069 6d70 6f72 7420 6c6f 6164 5f69 7269   import load_iri
+00010b70: 7320 0d0a 2020 2020 3e3e 3e20 6672 6f6d  s ..    >>> from
+00010b80: 2077 6174 6578 2e75 7469 6c73 2e70 6c6f   watex.utils.plo
+00010b90: 7475 7469 6c73 2069 6d70 6f72 7420 706c  tutils import pl
+00010ba0: 6f74 5f65 6c62 6f77 0d0a 2020 2020 3e3e  ot_elbow..    >>
+00010bb0: 3e20 643d 206c 6f61 645f 6972 6973 2028  > d= load_iris (
+00010bc0: 290d 0a20 2020 203e 3e3e 2058 3d20 642e  )..    >>> X= d.
+00010bd0: 6461 7461 205b 3a2c 2030 5d5b 3a2c 206e  data [:, 0][:, n
+00010be0: 702e 6e65 7761 7869 735d 2023 2074 616b  p.newaxis] # tak
+00010bf0: 6520 7468 6520 6669 7273 7420 6178 6973  e the first axis
+00010c00: 200d 0a20 2020 203e 3e3e 2023 2063 6f6d   ..    >>> # com
+00010c10: 7075 7465 2064 6973 746f 7273 696f 736e  pute distorsiosn
+00010c20: 2066 6f72 204b 4d65 616e 7320 7261 6e67   for KMeans rang
+00010c30: 6520 0d0a 2020 2020 3e3e 3e20 6469 7374  e ..    >>> dist
+00010c40: 6f72 7369 6f6e 7320 3d5b 5d20 3b20 6e5f  orsions =[] ; n_
+00010c50: 636c 7573 7465 7273 203d 2031 310d 0a20  clusters = 11.. 
+00010c60: 2020 203e 3e3e 2066 6f72 2069 2069 6e20     >>> for i in 
+00010c70: 7261 6e67 6520 2831 2c20 6e5f 636c 7573  range (1, n_clus
+00010c80: 7465 7273 2029 3a20 0d0a 2020 2020 2020  ters ): ..      
+00010c90: 2020 2020 2020 6b6d 203d 4b4d 6561 6e73        km =KMeans
+00010ca0: 2028 6e5f 636c 7573 7465 7273 203d 6920   (n_clusters =i 
+00010cb0: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00010cc0: 2020 2020 2020 2020 2020 2020 696e 6974              init
+00010cd0: 3d20 276b 2d6d 6561 6e73 2b2b 272c 200d  = 'k-means++', .
+00010ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010cf0: 2020 2020 2020 2020 206e 5f69 6e69 743d           n_init=
+00010d00: 3130 202c 200d 0a20 2020 2020 2020 2020  10 , ..         
+00010d10: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00010d20: 6178 5f69 7465 723d 3330 302c 200d 0a20  ax_iter=300, .. 
+00010d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d40: 2020 2020 2020 2072 616e 646f 6d5f 7374         random_st
+00010d50: 6174 6520 3d30 200d 0a20 2020 2020 2020  ate =0 ..       
+00010d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d70: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
+00010d80: 6b6d 2e66 6974 2858 2920 0d0a 2020 2020  km.fit(X) ..    
+00010d90: 2020 2020 2020 2020 6469 7374 6f72 7369          distorsi
+00010da0: 6f6e 732e 6170 7065 6e64 286b 6d2e 696e  ons.append(km.in
+00010db0: 6572 7469 615f 2920 0d0a 2020 2020 3e3e  ertia_) ..    >>
+00010dc0: 3e20 706c 6f74 5f65 6c62 6f77 2028 6469  > plot_elbow (di
+00010dd0: 7374 6f72 7369 6f6e 732c 206e 5f63 6c75  storsions, n_clu
+00010de0: 7374 6572 7320 3d6e 5f63 6c75 7374 6572  sters =n_cluster
+00010df0: 7329 0d0a 2020 2020 2020 2020 0d0a 2020  s)..        ..  
+00010e00: 2020 2222 220d 0a20 2020 2066 6967 2c20    """..    fig, 
+00010e10: 6178 203d 2070 6c74 2e73 7562 706c 6f74  ax = plt.subplot
+00010e20: 7320 2820 6e72 6f77 733d 3120 2c20 6e63  s ( nrows=1 , nc
+00010e30: 6f6c 7320 3d31 202c 2066 6967 7369 7a65  ols =1 , figsize
+00010e40: 203d 2066 6967 5f73 697a 6520 2920 0d0a   = fig_size ) ..
+00010e50: 2020 2020 0d0a 2020 2020 6178 2e70 6c6f      ..    ax.plo
+00010e60: 7420 2872 616e 6765 2028 312c 206e 5f63  t (range (1, n_c
+00010e70: 6c75 7374 6572 7329 2c20 6469 7374 6f72  lusters), distor
+00010e80: 7369 6f6e 7320 2c20 6d61 726b 6572 203d  sions , marker =
+00010e90: 206d 6172 6b65 722c 200d 0a20 2020 2020   marker, ..     
+00010ea0: 2020 2020 2020 2020 202a 2a6b 7764 2029           **kwd )
+00010eb0: 0d0a 2020 2020 706c 742e 786c 6162 656c  ..    plt.xlabel
+00010ec0: 2028 224e 756d 6265 7220 6f66 2063 6c75   ("Number of clu
+00010ed0: 7374 6572 7322 2920 0d0a 2020 2020 706c  sters") ..    pl
+00010ee0: 742e 796c 6162 656c 2028 2244 6973 746f  t.ylabel ("Disto
+00010ef0: 7273 696f 6e22 290d 0a20 2020 2070 6c74  rsion")..    plt
+00010f00: 2e74 6967 6874 5f6c 6179 6f75 7428 290d  .tight_layout().
+00010f10: 0a20 2020 200d 0a20 2020 2069 6620 7361  .    ..    if sa
+00010f20: 7665 6669 6720 6973 206e 6f74 204e 6f6e  vefig is not Non
+00010f30: 653a 200d 0a20 2020 2020 2020 2073 6176  e: ..        sav
+00010f40: 6566 6967 7572 6528 6669 672c 2073 6176  efigure(fig, sav
+00010f50: 6566 6967 2029 0d0a 2020 2020 706c 742e  efig )..    plt.
+00010f60: 7368 6f77 2829 2069 6620 7361 7665 6669  show() if savefi
+00010f70: 6720 6973 204e 6f6e 6520 656c 7365 2070  g is None else p
+00010f80: 6c74 2e63 6c6f 7365 2028 2920 0d0a 2020  lt.close () ..  
+00010f90: 2020 0d0a 2020 2020 7265 7475 726e 2061    ..    return a
+00010fa0: 7820 0d0a 0d0a 0d0a 6465 6620 706c 6f74  x ......def plot
+00010fb0: 5f63 6f73 745f 7673 5f65 706f 6368 7328  _cost_vs_epochs(
+00010fc0: 7265 6773 2c20 2a2c 2020 6669 675f 7369  regs, *,  fig_si
+00010fd0: 7a65 203d 2028 3130 202c 2034 2029 2c20  ze = (10 , 4 ), 
+00010fe0: 6d61 726b 6572 203d 276f 272c 200d 0a20  marker ='o', .. 
+00010ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011000: 2020 2020 7361 7665 6669 6720 3d4e 6f6e      savefig =Non
+00011010: 652c 202a 2a6b 7773 293a 200d 0a20 2020  e, **kws): ..   
+00011020: 2022 2222 2050 6c6f 7420 7468 6520 636f   """ Plot the co
+00011030: 7374 2061 6761 696e 7374 2074 6865 206e  st against the n
+00011040: 756d 6265 7220 6f66 2065 706f 6368 7320  umber of epochs 
+00011050: 2066 6f72 2074 6865 2074 776f 2064 6966   for the two dif
+00011060: 6665 7265 6e74 200d 0a20 2020 206c 6561  ferent ..    lea
+00011070: 726e 696e 6773 2072 6174 6573 200d 0a20  rnings rates .. 
+00011080: 2020 200d 0a20 2020 2050 6172 616d 6574     ..    Paramet
+00011090: 6572 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  ers ..    ------
+000110a0: 2d2d 2d2d 0d0a 2020 2020 7265 6773 3a20  ----..    regs: 
+000110b0: 4361 6c6c 6162 6c65 2c20 7369 6e67 6c65  Callable, single
+000110c0: 206f 7220 6c69 7374 206f 6620 7265 6772   or list of regr
+000110d0: 6573 7369 6f6e 2065 7374 696d 6174 6f72  ession estimator
+000110e0: 7320 0d0a 2020 2020 2020 2020 4573 7469  s ..        Esti
+000110f0: 6d61 746f 7220 7368 6f75 6c64 2062 6520  mator should be 
+00011100: 616c 7265 6164 7920 6669 7474 6564 2e0d  already fitted..
+00011110: 0a20 2020 2066 6967 5f73 697a 653a 2074  .    fig_size: t
+00011120: 7570 6c65 202c 2064 6566 6175 6c74 2069  uple , default i
+00011130: 7320 2831 302c 2034 290d 0a20 2020 2020  s (10, 4)..     
+00011140: 2020 2074 6865 2073 697a 6520 6f66 2066     the size of f
+00011150: 6967 7572 6520 0d0a 2020 2020 6b77 733a  igure ..    kws:
+00011160: 2064 6963 7420 2c20 0d0a 2020 2020 2020   dict , ..      
+00011170: 2020 4164 6469 7469 6f6e 6e61 6c20 6b65    Additionnal ke
+00011180: 7977 6f72 6473 2061 7267 756d 656e 7473  ywords arguments
+00011190: 2070 6173 7365 7320 746f 203a 6675 6e63   passes to :func
+000111a0: 3a60 6d61 7470 6c6f 746c 6962 2e70 7970  :`matplotlib.pyp
+000111b0: 6c6f 742e 706c 6f74 600d 0a20 2020 2052  lot.plot`..    R
+000111c0: 6574 7572 6e73 200d 0a20 2020 202d 2d2d  eturns ..    ---
+000111d0: 2d2d 2d2d 200d 0a20 2020 2061 783a 204d  ---- ..    ax: M
+000111e0: 6174 706c 6f74 6c69 622e 7079 706c 6f74  atplotlib.pyplot
+000111f0: 2061 7865 7320 6f62 6a65 6374 7320 0d0a   axes objects ..
+00011200: 2020 2020 0d0a 2020 2020 4578 616d 706c      ..    Exampl
+00011210: 6573 200d 0a20 2020 202d 2d2d 2d2d 2d2d  es ..    -------
+00011220: 2d2d 0d0a 0d0a 2020 2020 3e3e 3e20 6672  --....    >>> fr
+00011230: 6f6d 2077 6174 6578 2e64 6174 6173 6574  om watex.dataset
+00011240: 7320 696d 706f 7274 206c 6f61 645f 6972  s import load_ir
+00011250: 6973 200d 0a20 2020 203e 3e3e 2066 726f  is ..    >>> fro
+00011260: 6d20 7761 7465 782e 6261 7365 2069 6d70  m watex.base imp
+00011270: 6f72 7420 4164 616c 696e 6547 7261 6469  ort AdalineGradi
+00011280: 656e 7444 6573 6365 6e74 0d0a 2020 2020  entDescent..    
+00011290: 3e3e 3e20 6672 6f6d 2077 6174 6578 2e75  >>> from watex.u
+000112a0: 7469 6c73 2e70 6c6f 7475 7469 6c73 2069  tils.plotutils i
+000112b0: 6d70 6f72 7420 706c 6f74 5f63 6f73 745f  mport plot_cost_
+000112c0: 7673 5f65 706f 6368 730d 0a20 2020 203e  vs_epochs..    >
+000112d0: 3e3e 2058 2c20 7920 3d20 6c6f 6164 5f69  >> X, y = load_i
+000112e0: 7269 7320 2872 6574 7572 6e5f 585f 793d  ris (return_X_y=
+000112f0: 2054 7275 6520 290d 0a20 2020 203e 3e3e   True )..    >>>
+00011300: 2061 6461 3120 3d20 4164 616c 696e 6547   ada1 = AdalineG
+00011310: 7261 6469 656e 7444 6573 6365 6e74 2028  radientDescent (
+00011320: 6e5f 6974 6572 3d20 3130 202c 2065 7461  n_iter= 10 , eta
+00011330: 3d20 2e30 3120 292e 6669 7428 582c 2079  = .01 ).fit(X, y
+00011340: 2920 0d0a 2020 2020 3e3e 3e20 6164 6132  ) ..    >>> ada2
+00011350: 203d 2041 6461 6c69 6e65 4772 6164 6965   = AdalineGradie
+00011360: 6e74 4465 7363 656e 7420 286e 5f69 7465  ntDescent (n_ite
+00011370: 723d 3130 202c 2065 7461 203d 2e30 3030  r=10 , eta =.000
+00011380: 3120 292e 6669 7428 582c 2079 290d 0a20  1 ).fit(X, y).. 
+00011390: 2020 203e 3e3e 2070 6c6f 745f 636f 7374     >>> plot_cost
+000113a0: 5f76 735f 6570 6f63 6873 2028 7265 6773  _vs_epochs (regs
+000113b0: 203d 205b 6164 6131 2c20 6164 6132 5d20   = [ada1, ada2] 
+000113c0: 2920 0d0a 2020 2020 2222 220d 0a20 2020  ) ..    """..   
+000113d0: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+000113e0: 6365 2028 7265 6773 2c20 286c 6973 742c  ce (regs, (list,
+000113f0: 2074 7570 6c65 2c20 6e70 2e61 7272 6179   tuple, np.array
+00011400: 2929 3a20 0d0a 2020 2020 2020 2020 7265  )): ..        re
+00011410: 6773 203d 5b72 6567 735d 0d0a 2020 2020  gs =[regs]..    
+00011420: 7320 3d20 7365 7420 285b 6861 7361 7474  s = set ([hasatt
+00011430: 7228 6f2c 2027 5f5f 636c 6173 735f 5f27  r(o, '__class__'
+00011440: 2920 666f 7220 6f20 696e 2072 6567 7320  ) for o in regs 
+00011450: 5d29 0d0a 0d0a 2020 2020 6966 206c 656e  ])....    if len
+00011460: 2873 2920 213d 2031 3a20 0d0a 2020 2020  (s) != 1: ..    
+00011470: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00011480: 7272 6f72 2822 416c 6c20 7265 6772 6573  rror("All regres
+00011490: 7369 6f6e 206d 6f64 656c 7320 7368 6f75  sion models shou
+000114a0: 6c64 2062 6520 6573 7469 6d61 746f 7273  ld be estimators
+000114b0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+000114c0: 2020 2020 2020 2020 2020 2020 2220 616c              " al
+000114d0: 7265 6164 7920 6669 7474 6564 2e22 290d  ready fitted.").
+000114e0: 0a20 2020 2069 6620 6e6f 7420 6c69 7374  .    if not list
+000114f0: 2873 2920 5b30 5d20 3a20 0d0a 2020 2020  (s) [0] : ..    
+00011500: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00011510: 726f 7228 6622 4e65 6564 7320 616e 2065  ror(f"Needs an e
+00011520: 7374 696d 6174 6f72 2c20 676f 7420 7b74  stimator, got {t
+00011530: 7970 6528 735b 305d 292e 5f5f 6e61 6d65  ype(s[0]).__name
+00011540: 5f5f 2172 7d22 290d 0a20 2020 200d 0a20  __!r}")..    .. 
+00011550: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
+00011560: 2e73 7562 706c 6f74 7320 2820 6e72 6f77  .subplots ( nrow
+00011570: 733d 3120 2c20 6e63 6f6c 7320 3d6c 656e  s=1 , ncols =len
+00011580: 2872 6567 7329 202c 2066 6967 7369 7a65  (regs) , figsize
+00011590: 203d 2066 6967 5f73 697a 6520 2920 0d0a   = fig_size ) ..
+000115a0: 2020 2020 0d0a 2020 2020 666f 7220 6b2c      ..    for k,
+000115b0: 206d 2069 6e20 656e 756d 6572 6174 6520   m in enumerate 
+000115c0: 2872 6567 7329 2020 3a20 0d0a 2020 2020  (regs)  : ..    
+000115d0: 2020 2020 0d0a 2020 2020 2020 2020 6178      ..        ax
+000115e0: 5b6b 5d2e 706c 6f74 2872 616e 6765 2831  [k].plot(range(1
+000115f0: 2c20 6c65 6e28 6d2e 636f 7374 5f29 2b20  , len(m.cost_)+ 
+00011600: 3120 292c 206e 702e 6c6f 6731 3020 286d  1 ), np.log10 (m
+00011610: 2e63 6f73 745f 292c 0d0a 2020 2020 2020  .cost_),..      
+00011620: 2020 2020 2020 2020 2020 2020 206d 6172               mar
+00011630: 6b65 7220 3d6d 6172 6b65 722c 202a 2a6b  ker =marker, **k
+00011640: 7773 290d 0a20 2020 2020 2020 2061 785b  ws)..        ax[
+00011650: 6b5d 2e73 6574 5f78 6c61 6265 6c20 2822  k].set_xlabel ("
+00011660: 4570 6f63 6873 2229 200d 0a20 2020 2020  Epochs") ..     
+00011670: 2020 2061 785b 6b5d 2e73 6574 5f79 6c61     ax[k].set_yla
+00011680: 6265 6c20 2822 4c6f 6728 7375 6d2d 7371  bel ("Log(sum-sq
+00011690: 7561 7265 642d 6572 726f 7229 2229 0d0a  uared-error)")..
+000116a0: 2020 2020 2020 2020 6178 5b6b 5d2e 7365          ax[k].se
+000116b0: 745f 7469 746c 6528 2225 7320 2d4c 6561  t_title("%s -Lea
+000116c0: 726e 696e 6720 7261 7465 2025 2e34 6622  rning rate %.4f"
+000116d0: 2025 2028 6d2e 5f5f 636c 6173 735f 5f2e   % (m.__class__.
+000116e0: 5f5f 6e61 6d65 5f5f 2c20 6d2e 6574 6120  __name__, m.eta 
+000116f0: 2929 200d 0a20 2020 2020 2020 200d 0a20  )) ..        .. 
+00011700: 2020 2069 6620 7361 7665 6669 6720 6973     if savefig is
+00011710: 206e 6f74 204e 6f6e 653a 200d 0a20 2020   not None: ..   
+00011720: 2020 2020 2073 6176 6566 6967 7572 6528       savefigure(
+00011730: 6669 672c 2073 6176 6566 6967 2029 0d0a  fig, savefig )..
+00011740: 2020 2020 706c 742e 7368 6f77 2829 2069      plt.show() i
+00011750: 6620 7361 7665 6669 6720 6973 204e 6f6e  f savefig is Non
+00011760: 6520 656c 7365 2070 6c74 2e63 6c6f 7365  e else plt.close
+00011770: 2028 2920 0d0a 2020 2020 0d0a 2020 2020   () ..    ..    
+00011780: 7265 7475 726e 2061 7820 0d0a 0d0a 6465  return ax ....de
+00011790: 6620 706c 6f74 5f6d 6c78 7465 6e64 5f68  f plot_mlxtend_h
+000117a0: 6561 746d 6170 2028 6466 2c20 636f 6c75  eatmap (df, colu
+000117b0: 6d6e 7320 3d4e 6f6e 652c 2073 6176 6566  mns =None, savef
+000117c0: 6967 3d4e 6f6e 652c 2020 2a2a 6b77 7329  ig=None,  **kws)
+000117d0: 3a20 0d0a 2020 2020 2222 2220 506c 6f74  : ..    """ Plot
+000117e0: 2063 6f72 7265 6c61 7469 6f6e 206d 6174   correlation mat
+000117f0: 7269 7820 6172 7261 7920 2061 7320 6120  rix array  as a 
+00011800: 6865 6174 206d 6170 200d 0a20 2020 200d  heat map ..    .
+00011810: 0a20 2020 203a 7061 7261 6d20 6466 3a20  .    :param df: 
+00011820: 6461 7461 6672 616d 6520 7061 6e64 6173  dataframe pandas
+00011830: 2020 0d0a 2020 2020 3a70 6172 616d 2063    ..    :param c
+00011840: 6f6c 756d 6e73 3a20 6c69 7374 206f 6620  olumns: list of 
+00011850: 6665 6174 7572 6573 2c20 0d0a 2020 2020  features, ..    
+00011860: 2020 2020 4966 2067 6976 656e 2c20 6f6e      If given, on
+00011870: 6c79 2074 6865 2064 6174 6166 7261 6d65  ly the dataframe
+00011880: 2077 6974 6820 7468 6174 2066 6561 7475   with that featu
+00011890: 7265 7320 6973 2063 6f6e 7369 6465 7265  res is considere
+000118a0: 642e 200d 0a20 2020 203a 7061 7261 6d20  d. ..    :param 
+000118b0: 6b77 733a 2061 6464 6974 696f 6e61 6c20  kws: additional 
+000118c0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+000118d0: 7320 7061 7373 6564 2074 6f20 0d0a 2020  s passed to ..  
+000118e0: 2020 2020 2020 3a66 756e 633a 606d 6c78        :func:`mlx
+000118f0: 7465 6e64 2e70 6c6f 7474 696e 672e 6865  tend.plotting.he
+00011900: 6174 6d61 7060 0d0a 2020 2020 3a72 6574  atmap`..    :ret
+00011910: 7572 6e3a 203a 6675 6e63 3a60 6d6c 7874  urn: :func:`mlxt
+00011920: 656e 642e 706c 6f74 7469 6e67 2e68 6561  end.plotting.hea
+00011930: 746d 6170 6020 6178 6573 206f 626a 6563  tmap` axes objec
+00011940: 7420 0d0a 2020 2020 0d0a 2020 2020 3a65  t ..    ..    :e
+00011950: 7861 6d70 6c65 3a20 0d0a 2020 2020 2020  xample: ..      
+00011960: 2020 0d0a 2020 2020 3e3e 3e20 6672 6f6d    ..    >>> from
+00011970: 2077 6174 6578 2e64 6174 6173 6574 7320   watex.datasets 
+00011980: 696d 706f 7274 206c 6f61 645f 686c 6f67  import load_hlog
+00011990: 7320 0d0a 2020 2020 3e3e 3e20 6672 6f6d  s ..    >>> from
+000119a0: 2077 6174 6578 2e75 7469 6c73 2e70 6c6f   watex.utils.plo
+000119b0: 7475 7469 6c73 2069 6d70 6f72 7420 706c  tutils import pl
+000119c0: 6f74 5f6d 6c78 7465 6e64 5f68 6561 746d  ot_mlxtend_heatm
+000119d0: 6170 0d0a 2020 2020 3e3e 3e20 683d 6c6f  ap..    >>> h=lo
+000119e0: 6164 5f68 6c6f 6773 2829 0d0a 2020 2020  ad_hlogs()..    
+000119f0: 3e3e 3e20 6665 6174 7572 6573 203d 205b  >>> features = [
+00011a00: 2767 616d 6d61 5f67 616d 6d61 272c 2027  'gamma_gamma', '
+00011a10: 7370 272c 0d0a 2020 2020 2020 2020 2020  sp',..          
+00011a20: 2020 2020 2020 276e 6174 7572 616c 5f67        'natural_g
+00011a30: 616d 6d61 272c 2027 7265 7369 7374 6976  amma', 'resistiv
+00011a40: 6974 7927 5d0d 0a20 2020 203e 3e3e 2070  ity']..    >>> p
+00011a50: 6c6f 745f 6d6c 7874 656e 645f 6865 6174  lot_mlxtend_heat
+00011a60: 6d61 7020 2868 2e66 7261 6d65 202c 2063  map (h.frame , c
+00011a70: 6f6c 756d 6e73 203d 6665 6174 7572 6573  olumns =features
+00011a80: 2c20 636d 6170 203d 2750 754f 7227 290d  , cmap ='PuOr').
+00011a90: 0a20 2020 2022 2222 0d0a 2020 2020 696d  .    """..    im
+00011aa0: 706f 7274 5f6f 7074 696f 6e61 6c5f 6465  port_optional_de
+00011ab0: 7065 6e64 656e 6379 2827 6d6c 7874 656e  pendency('mlxten
+00011ac0: 6427 2c20 6578 7472 613d 280d 0a20 2020  d', extra=(..   
+00011ad0: 2020 2020 2022 4361 6e27 7420 706c 6f74       "Can't plot
+00011ae0: 2068 6561 746d 6170 2075 7369 6e67 2027   heatmap using '
+00011af0: 6d6c 7874 656e 6427 2070 6163 6b61 6765  mlxtend' package
+00011b00: 2e22 2929 0d0a 2020 0d0a 2020 2020 6672  ."))..  ..    fr
+00011b10: 6f6d 206d 6c78 7465 6e64 2e70 6c6f 7474  om mlxtend.plott
+00011b20: 696e 6720 696d 706f 7274 2028 2020 6865  ing import (  he
+00011b30: 6174 6d61 7020 0d0a 2020 2020 2020 2020  atmap ..        
+00011b40: 2020 2020 2920 0d0a 2020 2020 636d 203d      ) ..    cm =
+00011b50: 206e 702e 636f 7272 636f 6566 2864 665b   np.corrcoef(df[
+00011b60: 636f 6c75 6d6e 735d 2e20 7661 6c75 6573  columns]. values
+00011b70: 2e54 290d 0a20 2020 2061 783d 2068 6561  .T)..    ax= hea
+00011b80: 746d 6170 2863 6d2c 2072 6f77 5f6e 616d  tmap(cm, row_nam
+00011b90: 6573 203d 2063 6f6c 756d 6e73 202c 2063  es = columns , c
+00011ba0: 6f6c 756d 6e5f 6e61 6d65 7320 3d20 636f  olumn_names = co
+00011bb0: 6c75 6d6e 732c 202a 2a6b 7773 2029 0d0a  lumns, **kws )..
+00011bc0: 2020 2020 0d0a 2020 2020 6966 2073 6176      ..    if sav
+00011bd0: 6566 6967 2069 7320 6e6f 7420 4e6f 6e65  efig is not None
+00011be0: 3a0d 0a20 2020 2020 2020 2020 7361 7665  :..         save
+00011bf0: 6669 6775 7265 2873 6176 6566 6967 2c20  figure(savefig, 
+00011c00: 7361 7665 6669 6720 290d 0a20 2020 2070  savefig )..    p
+00011c10: 6c74 2e63 6c6f 7365 2028 2920 6966 2073  lt.close () if s
+00011c20: 6176 6566 6967 2069 7320 6e6f 7420 4e6f  avefig is not No
+00011c30: 6e65 2065 6c73 6520 706c 742e 7368 6f77  ne else plt.show
+00011c40: 2829 200d 0a20 2020 200d 0a20 2020 2072  () ..    ..    r
+00011c50: 6574 7572 6e20 6178 200d 0a0d 0a64 6566  eturn ax ....def
+00011c60: 2070 6c6f 745f 6d6c 7874 656e 645f 6d61   plot_mlxtend_ma
+00011c70: 7472 6978 2864 662c 2063 6f6c 756d 6e73  trix(df, columns
+00011c80: 203d 4e6f 6e65 2c20 6669 675f 7369 7a65   =None, fig_size
+00011c90: 203d 2028 3130 202c 2038 2029 2c0d 0a20   = (10 , 8 ),.. 
+00011ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011cb0: 2020 2020 2020 2061 6c70 6861 203d 2e35         alpha =.5
+00011cc0: 2c20 7361 7665 6669 673d 4e6f 6e65 2020  , savefig=None  
+00011cd0: 293a 0d0a 2020 2020 2222 2220 5669 7375  ):..    """ Visu
+00011ce0: 616c 697a 6520 7468 6520 7061 6972 2077  alize the pair w
+00011cf0: 6973 6520 636f 7272 656c 6174 696f 6e20  ise correlation 
+00011d00: 6265 7477 6565 6e20 7468 6520 6469 6666  between the diff
+00011d10: 6572 656e 7420 6665 6174 7572 6573 2069  erent features i
+00011d20: 6e20 200d 0a20 2020 2074 6865 2064 6174  n  ..    the dat
+00011d30: 6173 6574 2069 6e20 6f6e 6520 706c 6163  aset in one plac
+00011d40: 652e 200d 0a20 2020 200d 0a20 2020 203a  e. ..    ..    :
+00011d50: 7061 7261 6d20 6466 3a20 6461 7461 6672  param df: datafr
+00011d60: 616d 6520 7061 6e64 6173 2020 0d0a 2020  ame pandas  ..  
+00011d70: 2020 3a70 6172 616d 2063 6f6c 756d 6e73    :param columns
+00011d80: 3a20 6c69 7374 206f 6620 6665 6174 7572  : list of featur
+00011d90: 6573 2c20 0d0a 2020 2020 2020 2020 4966  es, ..        If
+00011da0: 2067 6976 656e 2c20 6f6e 6c79 2074 6865   given, only the
+00011db0: 2064 6174 6166 7261 6d65 2077 6974 6820   dataframe with 
+00011dc0: 7468 6174 2066 6561 7475 7265 7320 6973  that features is
+00011dd0: 2063 6f6e 7369 6465 7265 642e 200d 0a20   considered. .. 
+00011de0: 2020 203a 7061 7261 6d20 6669 675f 7369     :param fig_si
+00011df0: 7a65 3a20 7475 706c 6520 6f66 2069 6e74  ze: tuple of int
+00011e00: 2028 7769 6474 682c 2068 6569 6768 2920   (width, heigh) 
+00011e10: 0d0a 2020 2020 2020 2020 5369 7a65 206f  ..        Size o
+00011e20: 6620 7468 6520 6469 7370 6c61 7965 6420  f the displayed 
+00011e30: 6669 6775 7265 200d 0a20 2020 203a 7061  figure ..    :pa
+00011e40: 7261 6d20 616c 7068 613a 2066 6967 7572  ram alpha: figur
+00011e50: 6520 7472 616e 7370 6172 656e 6379 2c20  e transparency, 
+00011e60: 6465 6661 756c 7420 6973 2060 602e 3560  default is ``.5`
+00011e70: 602e 200d 0a20 2020 200d 0a20 2020 203a  `. ..    ..    :
+00011e80: 7265 7475 726e 3a20 3a66 756e 633a 606d  return: :func:`m
+00011e90: 6c78 7465 6e64 2e70 6c6f 7474 696e 672e  lxtend.plotting.
+00011ea0: 7363 6174 7465 7270 6c6f 746d 6174 7269  scatterplotmatri
+00011eb0: 7860 2061 7865 7320 6f62 6a65 6374 200d  x` axes object .
+00011ec0: 0a20 2020 203a 6578 616d 706c 653a 200d  .    :example: .
+00011ed0: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
+00011ee0: 7465 782e 6461 7461 7365 7473 2069 6d70  tex.datasets imp
+00011ef0: 6f72 7420 6c6f 6164 5f68 6c6f 6773 200d  ort load_hlogs .
+00011f00: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
+00011f10: 7465 782e 7574 696c 732e 706c 6f74 7574  tex.utils.plotut
+00011f20: 696c 7320 696d 706f 7274 2070 6c6f 745f  ils import plot_
+00011f30: 6d6c 7874 656e 645f 6d61 7472 6978 0d0a  mlxtend_matrix..
+00011f40: 2020 2020 3e3e 3e20 696d 706f 7274 2070      >>> import p
+00011f50: 616e 6461 7320 6173 2070 6420 0d0a 2020  andas as pd ..  
+00011f60: 2020 3e3e 3e20 696d 706f 7274 206e 756d    >>> import num
+00011f70: 7079 2061 7320 6e70 200d 0a20 2020 203e  py as np ..    >
+00011f80: 3e3e 2068 3d6c 6f61 645f 686c 6f67 7328  >> h=load_hlogs(
+00011f90: 290d 0a20 2020 203e 3e3e 2066 6561 7475  )..    >>> featu
+00011fa0: 7265 7320 3d20 5b27 6761 6d6d 615f 6761  res = ['gamma_ga
+00011fb0: 6d6d 6127 2c20 276e 6174 7572 616c 5f67  mma', 'natural_g
+00011fc0: 616d 6d61 272c 2027 7265 7369 7374 6976  amma', 'resistiv
+00011fd0: 6974 7927 5d0d 0a20 2020 203e 3e3e 2064  ity']..    >>> d
+00011fe0: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
+00011ff0: 6d65 2028 206e 702e 6c6f 6731 3020 2868  me ( np.log10 (h
+00012000: 2e66 7261 6d65 5b66 6561 7475 7265 735d  .frame[features]
+00012010: 292c 2063 6f6c 756d 6e73 203d 6665 6174  ), columns =feat
+00012020: 7572 6573 2029 0d0a 2020 2020 3e3e 3e20  ures )..    >>> 
+00012030: 706c 6f74 5f6d 6c78 7465 6e64 5f6d 6174  plot_mlxtend_mat
+00012040: 7269 7820 2864 6174 612c 2063 6f6c 756d  rix (data, colum
+00012050: 6e73 203d 6665 6174 7572 6573 290d 0a0d  ns =features)...
+00012060: 0a20 2020 2022 2222 0d0a 2020 2020 696d  .    """..    im
+00012070: 706f 7274 5f6f 7074 696f 6e61 6c5f 6465  port_optional_de
+00012080: 7065 6e64 656e 6379 2822 6d6c 7874 656e  pendency("mlxten
+00012090: 6422 2c20 6578 7472 6120 3d20 280d 0a20  d", extra = (.. 
+000120a0: 2020 2020 2020 2022 4361 6e27 7420 706c         "Can't pl
+000120b0: 6f74 2074 6865 2073 6361 7474 6572 206d  ot the scatter m
+000120c0: 6174 7269 7820 7573 696e 6720 276d 6c78  atrix using 'mlx
+000120d0: 7465 6e64 2720 7061 636b 6167 652e 2229  tend' package.")
+000120e0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
 000120f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012100: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00012110: 2020 6966 2069 7369 6e73 7461 6e63 6520    if isinstance 
-00012120: 2863 6f6c 756d 6e73 2c20 7374 7229 3a20  (columns, str): 
-00012130: 0d0a 2020 2020 2020 2020 636f 6c75 6d6e  ..        column
-00012140: 7320 3d20 5b63 6f6c 756d 6e73 205d 200d  s = [columns ] .
-00012150: 0a20 2020 2074 7279 3a20 0d0a 2020 2020  .    try: ..    
-00012160: 2020 2020 6974 6572 2028 636f 6c75 6d6e      iter (column
-00012170: 7329 0d0a 2020 2020 6578 6365 7074 203a  s)..    except :
-00012180: 200d 0a20 2020 2020 2020 2072 6169 7365   ..        raise
-00012190: 2054 7970 6545 7272 6f72 2822 2043 6f6c   TypeError(" Col
-000121a0: 756d 6e73 2073 686f 756c 6420 6265 2061  umns should be a
-000121b0: 6e20 6974 6572 6162 6c65 206f 626a 6563  n iterable objec
-000121c0: 742c 206e 6f74 220d 0a20 2020 2020 2020  t, not"..       
-000121d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000121e0: 2066 2220 7b74 7970 6520 2863 6f6c 756d   f" {type (colum
-000121f0: 6e73 292e 5f5f 6e61 6d65 5f5f 2172 7d22  ns).__name__!r}"
-00012200: 290d 0a20 2020 2063 6f6c 756d 6e73 203d  )..    columns =
-00012210: 6c69 7374 2863 6f6c 756d 6e73 290d 0a20  list(columns).. 
-00012220: 2020 200d 0a20 2020 200d 0a20 2020 2069     ..    ..    i
-00012230: 6620 636f 6c75 6d6e 7320 6973 206e 6f74  f columns is not
-00012240: 204e 6f6e 653a 200d 0a20 2020 2020 2020   None: ..       
-00012250: 2064 6620 3d64 665b 636f 6c75 6d6e 7320   df =df[columns 
-00012260: 5d20 0d0a 2020 2020 2020 2020 0d0a 2020  ] ..        ..  
-00012270: 2020 6178 203d 2073 6361 7474 6572 706c    ax = scatterpl
-00012280: 6f74 6d61 7472 6978 2028 0d0a 2020 2020  otmatrix (..    
-00012290: 2020 2020 6466 5b63 6f6c 756d 6e73 5d2e      df[columns].
-000122a0: 7661 6c75 6573 202c 2066 6967 7369 7a65  values , figsize
-000122b0: 203d 6669 675f 7369 7a65 2c6e 616d 6573   =fig_size,names
-000122c0: 203d 636f 6c75 6d6e 7320 2c20 616c 7068   =columns , alph
-000122d0: 6120 3d61 6c70 6861 200d 0a20 2020 2020  a =alpha ..     
-000122e0: 2020 2029 0d0a 2020 2020 706c 742e 7469     )..    plt.ti
-000122f0: 6768 745f 6c61 796f 7574 2829 0d0a 0d0a  ght_layout()....
-00012300: 2020 2020 6966 2073 6176 6566 6967 2069      if savefig i
-00012310: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-00012320: 2020 2020 2020 7361 7665 6669 6775 7265        savefigure
-00012330: 2873 6176 6566 6967 2c20 7361 7665 6669  (savefig, savefi
-00012340: 6720 290d 0a20 2020 2070 6c74 2e63 6c6f  g )..    plt.clo
-00012350: 7365 2028 2920 6966 2073 6176 6566 6967  se () if savefig
-00012360: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
-00012370: 6520 706c 742e 7368 6f77 2829 200d 0a20  e plt.show() .. 
-00012380: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
-00012390: 6178 200d 0a0d 0a20 2020 200d 0a64 6566  ax ....    ..def
-000123a0: 2073 6176 6566 6967 7572 6520 2866 6967   savefigure (fig
-000123b0: 3a20 6f62 6a65 6374 202c 0d0a 2020 2020  : object ,..    
-000123c0: 2020 2020 2020 2020 2066 6967 6e61 6d65           figname
-000123d0: 3a20 7374 7220 3d20 4e6f 6e65 2c0d 0a20  : str = None,.. 
-000123e0: 2020 2020 2020 2020 2020 2020 6578 743a              ext:
-000123f0: 7374 7220 3d27 2e70 6e67 272c 0d0a 2020  str ='.png',..  
-00012400: 2020 2020 2020 2020 2020 202a 2a73 6b77             **skw
-00012410: 7320 293a 200d 0a20 2020 2022 2222 2073  s ): ..    """ s
-00012420: 6176 6520 6669 6775 7265 2066 726f 6d20  ave figure from 
-00012430: 7468 6520 6769 7665 6e20 6669 6775 7265  the given figure
-00012440: 206e 616d 6520 200d 0a20 2020 200d 0a20   name  ..    .. 
-00012450: 2020 203a 7061 7261 6d20 6669 673a 204d     :param fig: M
-00012460: 6174 706c 6f74 6c69 6220 6669 6775 7265  atplotlib figure
-00012470: 206f 626a 6563 7420 0d0a 2020 2020 3a70   object ..    :p
-00012480: 6172 616d 2066 6967 6e61 6d65 3a20 6e61  aram figname: na
-00012490: 6d65 206f 6620 6669 6775 7265 2074 6f20  me of figure to 
-000124a0: 6f75 7470 7574 200d 0a20 2020 203a 7061  output ..    :pa
-000124b0: 7261 6d20 6578 743a 2073 7472 202d 2065  ram ext: str - e
-000124c0: 7874 656e 7369 6f6e 206f 6620 7468 6520  xtension of the 
-000124d0: 6669 6775 7265 200d 0a20 2020 203a 7061  figure ..    :pa
-000124e0: 7261 6d20 736b 7773 3a20 4d61 7470 6c6f  ram skws: Matplo
-000124f0: 746c 6962 2073 6176 6566 6967 7572 6520  tlib savefigure 
-00012500: 6b65 7977 6172 6473 2061 6464 6974 696f  keywards additio
-00012510: 6e61 6c20 6b65 7977 6f72 6473 2061 7267  nal keywords arg
-00012520: 756d 656e 7473 200d 0a20 2020 200d 0a20  uments ..    .. 
-00012530: 2020 203a 7265 7475 726e 3a20 4d61 7470     :return: Matp
-00012540: 6c6f 746c 6962 2073 6176 6566 6967 7572  lotlib savefigur
-00012550: 6520 6f62 6a65 6374 732e 200d 0a20 2020  e objects. ..   
-00012560: 200d 0a20 2020 2022 2222 0d0a 2020 2020   ..    """..    
-00012570: 6578 7420 3d20 272e 2720 2b20 7374 7228  ext = '.' + str(
-00012580: 6578 7429 2e6c 6f77 6572 2829 2e73 7472  ext).lower().str
-00012590: 6970 2829 2e72 6570 6c61 6365 2827 2e27  ip().replace('.'
-000125a0: 2c20 2727 290d 0a0d 0a20 2020 2069 6620  , '')....    if 
-000125b0: 6669 676e 616d 6520 6973 204e 6f6e 653a  figname is None:
-000125c0: 200d 0a20 2020 2020 2020 2066 6967 6e61   ..        figna
-000125d0: 6d65 203d 2020 275f 2720 2b20 6f73 2e70  me =  '_' + os.p
-000125e0: 6174 682e 7370 6c69 7465 7874 286f 732e  ath.splitext(os.
-000125f0: 7061 7468 2e62 6173 656e 616d 6528 5f5f  path.basename(__
-00012600: 6669 6c65 5f5f 2929 202b 5c0d 0a20 2020  file__)) +\..   
-00012610: 2020 2020 2020 2020 2064 6174 6574 696d           datetim
-00012620: 652e 6461 7465 7469 6d65 2e6e 6f77 2829  e.datetime.now()
-00012630: 2e73 7472 6674 696d 6528 2725 6d2d 2564  .strftime('%m-%d
-00012640: 2d25 5920 2548 3a25 4d3a 2553 2729 202b  -%Y %H:%M:%S') +
-00012650: 2065 7874 0d0a 2020 2020 2020 2020 7761   ext..        wa
-00012660: 726e 696e 6773 2e77 6172 6e28 224e 6f20  rnings.warn("No 
-00012670: 6e61 6d65 206f 6620 6669 6775 7265 2069  name of figure i
-00012680: 7320 6769 7665 6e2e 2046 6967 7572 6520  s given. Figure 
-00012690: 7368 6f75 6c64 2062 6520 7265 6e61 6d65  should be rename
-000126a0: 6420 6173 2022 0d0a 2020 2020 2020 2020  d as "..        
-000126b0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-000126c0: 7b66 6967 6e61 6d65 2172 7d22 290d 0a20  {figname!r}").. 
-000126d0: 2020 2020 2020 200d 0a20 2020 2066 696c         ..    fil
-000126e0: 652c 2065 7820 3d20 6f73 2e70 6174 682e  e, ex = os.path.
-000126f0: 7370 6c69 7465 7874 2866 6967 6e61 6d65  splitext(figname
-00012700: 290d 0a20 2020 2069 6620 6578 2069 6e20  )..    if ex in 
-00012710: 2827 272c 204e 6f6e 6529 3a20 0d0a 2020  ('', None): ..  
-00012720: 2020 2020 2020 6578 203d 2065 7874 200d        ex = ext .
-00012730: 0a20 2020 2020 2020 2066 6967 6e61 6d65  .        figname
-00012740: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-00012750: 6669 6c65 2c20 6627 7b65 7874 7d27 290d  file, f'{ext}').
-00012760: 0a0d 0a20 2020 2072 6574 7572 6e20 2066  ...    return  f
-00012770: 6967 2e73 6176 6566 6967 2866 6967 6e61  ig.savefig(figna
-00012780: 6d65 2c20 2a2a 736b 7773 290d 0a0d 0a0d  me, **skws).....
-00012790: 0a64 6566 2072 6573 6574 7469 6e67 5f74  .def resetting_t
-000127a0: 6963 6b73 2028 2067 6574 5f78 7974 6963  icks ( get_xytic
-000127b0: 6b73 2c20 206e 756d 6265 725f 6f66 5f74  ks,  number_of_t
-000127c0: 6963 6b73 3d4e 6f6e 6520 293a 200d 0a20  icks=None ): .. 
-000127d0: 2020 2022 2222 0d0a 2020 2020 7265 7365     """..    rese
-000127e0: 7474 696e 6720 7879 7469 636b 7320 206d  tting xyticks  m
-000127f0: 6f64 756c 6f20 2c20 3130 300d 0a20 2020  odulo , 100..   
-00012800: 200d 0a20 2020 203a 7061 7261 6d20 6765   ..    :param ge
-00012810: 745f 7879 7469 636b 733a 2020 7879 7469  t_xyticks:  xyti
-00012820: 636b 7320 6c69 7374 2020 2c20 7573 6520  cks list  , use 
-00012830: 746f 2061 782e 6765 745f 787c 7974 6963  to ax.get_x|ytic
-00012840: 6b73 2829 0d0a 2020 2020 3a74 7970 6520  ks()..    :type 
-00012850: 2067 6574 5f78 7974 6963 6b73 3a20 6c69   get_xyticks: li
-00012860: 7374 200d 0a20 2020 200d 0a20 2020 203a  st ..    ..    :
-00012870: 7061 7261 6d20 6e75 6d62 6572 5f6f 665f  param number_of_
-00012880: 7469 636b 733a 2020 6d61 7962 6520 7468  ticks:  maybe th
-00012890: 6520 6e75 6d62 6572 206f 6620 7469 636b  e number of tick
-000128a0: 7320 6f6e 2078 206f 7220 7920 6178 6973  s on x or y axis
-000128b0: 200d 0a20 2020 203a 7479 7065 206e 756d   ..    :type num
-000128c0: 6265 725f 6f66 5f74 6963 6b73 3a20 696e  ber_of_ticks: in
-000128d0: 740d 0a20 2020 200d 0a20 2020 203a 7265  t..    ..    :re
-000128e0: 7475 726e 733a 2061 206e 6577 5f6c 6973  turns: a new_lis
-000128f0: 7420 6f72 206e 6461 7272 6179 200d 0a20  t or ndarray .. 
-00012900: 2020 203a 7274 7970 653a 206c 6973 7420     :rtype: list 
-00012910: 6f72 2061 7272 6179 5f6c 696b 6520 0d0a  or array_like ..
-00012920: 2020 2020 2222 220d 0a20 2020 2069 6620      """..    if 
-00012930: 6e6f 7420 6973 696e 7374 616e 6365 2867  not isinstance(g
-00012940: 6574 5f78 7974 6963 6b73 2c20 286c 6973  et_xyticks, (lis
-00012950: 742c 206e 702e 6e64 6172 7261 7929 2029  t, np.ndarray) )
-00012960: 3a20 0d0a 2020 2020 2020 2020 7761 726e  : ..        warn
-00012970: 696e 6773 2e77 6172 6e20 280d 0a20 2020  ings.warn (..   
-00012980: 2020 2020 2020 2020 2027 4172 6775 6d65           'Argume
-00012990: 6e74 7320 6765 745f 7879 7469 636b 7320  nts get_xyticks 
-000129a0: 6d75 7374 2062 6520 6120 6c69 7374 270d  must be a list'.
-000129b0: 0a20 2020 2020 2020 2020 2020 2027 206e  .            ' n
-000129c0: 6f74 203c 7b30 7d3e 2e27 2e66 6f72 6d61  ot <{0}>.'.forma
-000129d0: 7428 7479 7065 2867 6574 5f78 7974 6963  t(type(get_xytic
-000129e0: 6b73 2929 290d 0a20 2020 2020 2020 2072  ks)))..        r
-000129f0: 6169 7365 2054 6970 4572 726f 7220 280d  aise TipError (.
-00012a00: 0a20 2020 2020 2020 2020 2020 2027 3c7b  .            '<{
-00012a10: 307d 3e20 666f 756e 642e 2022 6765 745f  0}> found. "get_
-00012a20: 7879 7469 636b 7322 206d 7573 7420 6265  xyticks" must be
-00012a30: 2061 2027 0d0a 2020 2020 2020 2020 2020   a '..          
-00012a40: 2020 276c 6973 7420 6f72 2028 6e64 2e61    'list or (nd.a
-00012a50: 7272 6179 2c31 292e 272e 666f 726d 6174  rray,1).'.format
-00012a60: 2874 7970 6528 6765 745f 7879 7469 636b  (type(get_xytick
-00012a70: 7329 2929 0d0a 2020 2020 0d0a 2020 2020  s)))..    ..    
-00012a80: 6966 206e 756d 6265 725f 6f66 5f74 6963  if number_of_tic
-00012a90: 6b73 2069 7320 4e6f 6e65 203a 0d0a 2020  ks is None :..  
-00012aa0: 2020 2020 2020 6966 206c 656e 2867 6574        if len(get
-00012ab0: 5f78 7974 6963 6b73 2920 3e20 3220 3a20  _xyticks) > 2 : 
-00012ac0: 0d0a 2020 2020 2020 2020 2020 2020 6e75  ..            nu
-00012ad0: 6d62 6572 5f6f 665f 7469 636b 7320 3d20  mber_of_ticks = 
-00012ae0: 696e 7428 286c 656e 2867 6574 5f78 7974  int((len(get_xyt
-00012af0: 6963 6b73 292d 3129 2f32 290d 0a20 2020  icks)-1)/2)..   
-00012b00: 2020 2020 2065 6c73 6520 3a20 6e75 6d62       else : numb
-00012b10: 6572 5f6f 665f 7469 636b 7320 203d 206c  er_of_ticks  = l
-00012b20: 656e 2867 6574 5f78 7974 6963 6b73 290d  en(get_xyticks).
-00012b30: 0a20 2020 200d 0a20 2020 2069 6620 6e6f  .    ..    if no
-00012b40: 7428 6e75 6d62 6572 5f6f 665f 7469 636b  t(number_of_tick
-00012b50: 732c 2028 666c 6f61 742c 2069 6e74 2929  s, (float, int))
-00012b60: 3a20 0d0a 2020 2020 2020 2020 7472 7920  : ..        try 
-00012b70: 3a20 6e75 6d62 6572 5f6f 665f 7469 636b  : number_of_tick
-00012b80: 733d 696e 7428 6e75 6d62 6572 5f6f 665f  s=int(number_of_
-00012b90: 7469 636b 7329 200d 0a20 2020 2020 2020  ticks) ..       
-00012ba0: 2065 7863 6570 7420 3a20 0d0a 2020 2020   except : ..    
-00012bb0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-00012bc0: 2e77 6172 6e28 2722 4e75 6d62 6572 5f6f  .warn('"Number_o
-00012bd0: 665f 7469 636b 7322 2061 7267 756d 656e  f_ticks" argumen
-00012be0: 7473 2069 7320 7468 6520 7469 6d65 7320  ts is the times 
-00012bf0: 746f 2073 6565 2027 0d0a 2020 2020 2020  to see '..      
-00012c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c10: 2020 2020 2774 6865 2074 6963 6b73 206f      'the ticks o
-00012c20: 6e20 787c 7920 6178 6973 2e27 5c0d 0a20  n x|y axis.'\.. 
-00012c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c40: 2020 2020 2020 2020 2027 204d 7573 7420           ' Must 
-00012c50: 6265 2069 6e74 6567 6572 206e 6f74 203c  be integer not <
-00012c60: 7b30 7d3e 2e27 2e0d 0a20 2020 2020 2020  {0}>.'...       
-00012c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c80: 2020 2066 6f72 6d61 7428 7479 7065 286e     format(type(n
-00012c90: 756d 6265 725f 6f66 5f74 6963 6b73 2929  umber_of_ticks))
-00012ca0: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00012cb0: 6169 7365 2050 6c6f 7445 7272 6f72 2866  aise PlotError(f
-00012cc0: 273c 7b74 7970 6528 6e75 6d62 6572 5f6f  '<{type(number_o
-00012cd0: 665f 7469 636b 7329 2e5f 5f6e 616d 655f  f_ticks).__name_
-00012ce0: 5f7d 3e20 6465 7465 6374 6564 2e27 0d0a  _}> detected.'..
-00012cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d00: 2020 2020 2020 2020 2020 2020 2720 4d75              ' Mu
-00012d10: 7374 2062 6520 696e 7465 6765 722e 2729  st be integer.')
-00012d20: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00012d30: 6e75 6d62 6572 5f6f 665f 7469 636b 733d  number_of_ticks=
-00012d40: 696e 7428 6e75 6d62 6572 5f6f 665f 7469  int(number_of_ti
-00012d50: 636b 7329 0d0a 2020 2020 0d0a 2020 2020  cks)..    ..    
-00012d60: 6966 206c 656e 2867 6574 5f78 7974 6963  if len(get_xytic
-00012d70: 6b73 2920 3e20 3220 3a0d 0a20 2020 2020  ks) > 2 :..     
-00012d80: 2020 2069 6620 6765 745f 7879 7469 636b     if get_xytick
-00012d90: 735b 315d 2025 3130 2021 3d20 3020 3a20  s[1] %10 != 0 : 
-00012da0: 0d0a 2020 2020 2020 2020 2020 2020 6765  ..            ge
-00012db0: 745f 7879 7469 636b 735b 315d 203d 6765  t_xyticks[1] =ge
-00012dc0: 745f 7879 7469 636b 735b 315d 202b 2028  t_xyticks[1] + (
-00012dd0: 3130 202d 2067 6574 5f78 7974 6963 6b73  10 - get_xyticks
-00012de0: 5b31 5d20 2531 3029 0d0a 2020 2020 2020  [1] %10)..      
-00012df0: 2020 6966 2067 6574 5f78 7974 6963 6b73    if get_xyticks
-00012e00: 5b2d 325d 2531 3020 2021 3d30 203a 200d  [-2]%10  !=0 : .
-00012e10: 0a20 2020 2020 2020 2020 2020 2067 6574  .            get
-00012e20: 5f78 7974 6963 6b73 5b2d 325d 203d 6765  _xyticks[-2] =ge
-00012e30: 745f 7879 7469 636b 735b 2d32 5d20 2d67  t_xyticks[-2] -g
-00012e40: 6574 5f78 7974 6963 6b73 5b2d 325d 2025  et_xyticks[-2] %
-00012e50: 3130 0d0a 2020 2020 0d0a 2020 2020 2020  10..    ..      
-00012e60: 2020 6e65 775f 6172 7261 7920 3d20 6e70    new_array = np
-00012e70: 2e6c 696e 7370 6163 6528 6765 745f 7879  .linspace(get_xy
-00012e80: 7469 636b 735b 315d 2c20 6765 745f 7879  ticks[1], get_xy
-00012e90: 7469 636b 735b 2d32 5d2c 0d0a 2020 2020  ticks[-2],..    
-00012ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012eb0: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-00012ec0: 6572 5f6f 665f 7469 636b 7320 290d 0a20  er_of_ticks ).. 
-00012ed0: 2020 2065 6c69 6620 6c65 6e28 6765 745f     elif len(get_
-00012ee0: 7879 7469 636b 7329 3c20 3220 3a20 0d0a  xyticks)< 2 : ..
-00012ef0: 2020 2020 2020 2020 6e65 775f 6172 7261          new_arra
-00012f00: 7920 3d20 6e70 2e61 7272 6179 2867 6574  y = np.array(get
-00012f10: 5f78 7974 6963 6b73 290d 0a20 0d0a 2020  _xyticks).. ..  
-00012f20: 2020 7265 7475 726e 2020 6e65 775f 6172    return  new_ar
-00012f30: 7261 790d 0a20 2020 2020 2020 200d 0a64  ray..        ..d
-00012f40: 6566 206d 616b 655f 6d70 6c5f 7072 6f70  ef make_mpl_prop
-00012f50: 6572 7469 6573 286e 202c 7072 6f70 203d  erties(n ,prop =
-00012f60: 2763 6f6c 6f72 2729 3a20 0d0a 2020 2020  'color'): ..    
-00012f70: 2222 2220 6d61 6b65 206d 6174 706c 6f74  """ make matplot
-00012f80: 6c69 6220 7072 6f70 6572 7479 2028 2763  lib property ('c
-00012f90: 6f6c 6f72 7327 2c20 276d 6172 6b65 7227  olors', 'marker'
-00012fa0: 2c20 276c 696e 6527 2920 746f 2066 6974  , 'line') to fit
-00012fb0: 2074 6865 200d 0a20 2020 206e 756d 6572   the ..    numer
-00012fc0: 206f 6620 7361 6d70 6c65 730d 0a20 2020   of samples..   
-00012fd0: 200d 0a20 2020 203a 7061 7261 6d20 6e3a   ..    :param n:
-00012fe0: 2069 6e74 2c20 0d0a 2020 2020 2020 2020   int, ..        
-00012ff0: 4e75 6d62 6572 206f 6620 7072 6f70 6572  Number of proper
-00013000: 7479 2074 6861 7420 6973 206e 6565 6465  ty that is neede
-00013010: 6420 746f 2063 7265 6174 652e 2049 7420  d to create. It 
-00013020: 6765 6e65 7261 7465 7320 6120 6772 6f75  generates a grou
-00013030: 7020 6f66 200d 0a20 2020 2020 2020 2070  p of ..        p
-00013040: 726f 7065 7274 7920 6974 656d 732e 200d  roperty items. .
-00013050: 0a20 2020 203a 7061 7261 6d20 7072 6f70  .    :param prop
-00013060: 3a20 7374 722c 2064 6566 6175 6c74 3d27  : str, default='
-00013070: 636f 6c6f 7227 2c20 6e61 6d65 206f 6620  color', name of 
-00013080: 7072 6f70 6572 7479 2074 6f20 7265 7472  property to retr
-00013090: 6965 7665 2e20 4163 6365 7074 7320 0d0a  ieve. Accepts ..
-000130a0: 2020 2020 2020 2020 6f6e 6c79 2027 636f          only 'co
-000130b0: 6c6f 7273 272c 2027 6d61 726b 6572 2720  lors', 'marker' 
-000130c0: 6f72 2027 6c69 6e65 272e 0d0a 2020 2020  or 'line'...    
-000130d0: 3a72 6574 7572 6e3a 206c 6973 7420 6f66  :return: list of
-000130e0: 2070 726f 7065 7274 7920 6974 656d 7320   property items 
-000130f0: 7769 7468 2073 697a 6520 6571 7561 6c73  with size equals
-00013100: 2074 6f20 606e 602e 0d0a 2020 2020 3a45   to `n`...    :E
-00013110: 7861 6d70 6c65 3a20 0d0a 2020 2020 2020  xample: ..      
-00013120: 2020 3e3e 3e20 6672 6f6d 2077 6174 6578    >>> from watex
-00013130: 2e75 7469 6c73 2e70 6c6f 7475 7469 6c73  .utils.plotutils
-00013140: 2069 6d70 6f72 7420 6d61 6b65 5f6d 706c   import make_mpl
-00013150: 5f70 726f 7065 7274 6965 730d 0a20 2020  _properties..   
-00013160: 2020 2020 203e 3e3e 206d 616b 655f 6d70       >>> make_mp
-00013170: 6c5f 7072 6f70 6572 7469 6573 2028 3130  l_properties (10
-00013180: 2029 0d0a 2020 2020 2020 2020 2e2e 2e20   )..        ... 
-00013190: 5b27 6727 2c0d 0a20 2020 2020 2020 2020  ['g',..         
-000131a0: 2020 2020 2767 7261 7927 2c0d 0a20 2020      'gray',..   
-000131b0: 2020 2020 2020 2020 2020 2779 272c 0d0a            'y',..
-000131c0: 2020 2020 2020 2020 2020 2020 2027 626c               'bl
-000131d0: 7565 272c 0d0a 2020 2020 2020 2020 2020  ue',..          
-000131e0: 2020 2027 6f72 616e 6765 272c 0d0a 2020     'orange',..  
-000131f0: 2020 2020 2020 2020 2020 2027 7075 7270             'purp
-00013200: 6c65 272c 0d0a 2020 2020 2020 2020 2020  le',..          
-00013210: 2020 2027 6c69 6d65 272c 0d0a 2020 2020     'lime',..    
-00013220: 2020 2020 2020 2020 2027 6b27 2c0d 0a20           'k',.. 
-00013230: 2020 2020 2020 2020 2020 2020 2763 7961              'cya
-00013240: 6e27 2c0d 0a20 2020 2020 2020 2020 2020  n',..           
-00013250: 2020 2830 2e36 2c20 302e 362c 2030 2e36    (0.6, 0.6, 0.6
-00013260: 295d 0d0a 2020 2020 2020 2020 3e3e 3e20  )]..        >>> 
-00013270: 6d61 6b65 5f6d 706c 5f70 726f 7065 7274  make_mpl_propert
-00013280: 6965 7328 3130 3020 2c20 7072 6f70 203d  ies(100 , prop =
-00013290: 2027 6d61 726b 6572 2729 0d0a 2020 2020   'marker')..    
-000132a0: 2020 2020 2e2e 2e20 5b27 6f27 2c0d 0a20      ... ['o',.. 
-000132b0: 2020 2020 2020 2020 2020 2020 275e 272c              '^',
-000132c0: 0d0a 2020 2020 2020 2020 2020 2020 2027  ..             '
-000132d0: 7827 2c0d 0a20 2020 2020 2020 2020 2020  x',..           
-000132e0: 2020 2744 272c 0d0a 2020 2020 2020 2020    'D',..        
-000132f0: 2020 2020 2020 2e0d 0a20 2020 2020 2020        ...       
-00013300: 2020 2020 2020 202e 0d0a 2020 2020 2020         ...      
-00013310: 2020 2020 2020 2020 2e0d 0a20 2020 2020          ...     
-00013320: 2020 2020 2020 2020 3131 2c0d 0a20 2020          11,..   
-00013330: 2020 2020 2020 2020 2020 274e 6f6e 6527            'None'
-00013340: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00013350: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
-00013360: 2020 2020 2720 272c 0d0a 2020 2020 2020      ' ',..      
-00013370: 2020 2020 2020 2027 275d 0d0a 2020 2020         '']..    
-00013380: 2020 2020 3e3e 3e20 6d61 6b65 5f6d 706c      >>> make_mpl
-00013390: 5f70 726f 7065 7274 6965 7328 3530 202c  _properties(50 ,
-000133a0: 2070 726f 7020 3d20 276c 696e 6527 290d   prop = 'line').
-000133b0: 0a20 2020 2020 2020 202e 2e2e 205b 272d  .        ... ['-
-000133c0: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
-000133d0: 2027 2d27 2c0d 0a20 2020 2020 2020 2020   '-',..         
-000133e0: 2020 2020 272d 2d27 2c0d 0a20 2020 2020      '--',..     
-000133f0: 2020 2020 2020 2020 272d 2e27 2c0d 0a20          '-.',.. 
-00013400: 2020 2020 2020 2020 2020 2020 2020 2e0d                ..
-00013410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013420: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00013430: 2020 2e20 0d0a 2020 2020 2020 2020 2020    . ..          
-00013440: 2020 2027 736f 6c69 6427 2c0d 0a20 2020     'solid',..   
-00013450: 2020 2020 2020 2020 2020 2764 6173 6865            'dashe
-00013460: 6427 2c0d 0a20 2020 2020 2020 2020 2020  d',..           
-00013470: 2020 2764 6173 6864 6f74 272c 0d0a 2020    'dashdot',..  
-00013480: 2020 2020 2020 2020 2020 2027 646f 7474             'dott
-00013490: 6564 275d 0d0a 2020 2020 2020 2020 0d0a  ed']..        ..
-000134a0: 2020 2020 2222 2220 0d0a 2020 2020 6e3d      """ ..    n=
-000134b0: 696e 7428 5f61 7373 6572 745f 616c 6c5f  int(_assert_all_
-000134c0: 7479 7065 7328 6e2c 2069 6e74 2c20 666c  types(n, int, fl
-000134d0: 6f61 742c 206f 626a 6e61 6d65 203d 2227  oat, objname ="'
-000134e0: 6e27 2229 290d 0a20 2020 2070 726f 7020  n'"))..    prop 
-000134f0: 3d20 7374 7228 7072 6f70 292e 6c6f 7765  = str(prop).lowe
-00013500: 7228 292e 7374 7269 7028 292e 7265 706c  r().strip().repl
-00013510: 6163 6520 2827 7327 2c20 2727 2920 0d0a  ace ('s', '') ..
-00013520: 2020 2020 6966 2070 726f 7020 6e6f 7420      if prop not 
-00013530: 696e 2028 2763 6f6c 6f72 272c 2027 6d61  in ('color', 'ma
-00013540: 726b 6572 272c 2027 6c69 6e65 2729 3a20  rker', 'line'): 
-00013550: 0d0a 2020 2020 2020 2020 7261 6973 6520  ..        raise 
-00013560: 5661 6c75 6545 7272 6f72 2028 2250 726f  ValueError ("Pro
-00013570: 7065 7274 7920 7b70 726f 7021 727d 2069  perty {prop!r} i
-00013580: 7320 6e6f 7420 6176 6169 6c61 6265 2079  s not availabe y
-00013590: 6574 2e20 2c20 4578 7065 6374 220d 0a20  et. , Expect".. 
-000135a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000135b0: 2020 2020 2020 2020 2022 2027 636f 6c6f           " 'colo
-000135c0: 7273 272c 2027 6d61 726b 6572 2720 6f72  rs', 'marker' or
-000135d0: 2027 6c69 6e65 272e 2229 0d0a 2020 2020   'line'.")..    
-000135e0: 2320 6375 7374 6f6d 697a 6520 706c 6f74  # customize plot
-000135f0: 7320 7769 7468 2063 6f6c 6f72 7320 6c69  s with colors li
-00013600: 6e65 7320 616e 6420 7374 796c 6573 200d  nes and styles .
-00013610: 0a20 2020 2023 2061 6e64 2063 7265 6174  .    # and creat
-00013620: 6520 6669 6775 7265 206f 626a 0d0a 2020  e figure obj..  
-00013630: 2020 6966 2070 726f 703d 3d27 636f 6c6f    if prop=='colo
-00013640: 7227 3a20 0d0a 2020 2020 2020 2020 645f  r': ..        d_
-00013650: 636f 6c6f 7273 203d 2020 445f 434f 4c4f  colors =  D_COLO
-00013660: 5253 200d 0a20 2020 2020 2020 2064 5f63  RS ..        d_c
-00013670: 6f6c 6f72 7320 3d20 6d70 6c2e 636f 6c6f  olors = mpl.colo
-00013680: 7273 2e4c 6973 7465 6443 6f6c 6f72 6d61  rs.ListedColorma
-00013690: 7028 645f 636f 6c6f 7273 5b3a 6e5d 292e  p(d_colors[:n]).
-000136a0: 636f 6c6f 7273 0d0a 2020 2020 2020 2020  colors..        
-000136b0: 6966 206c 656e 2864 5f63 6f6c 6f72 7329  if len(d_colors)
-000136c0: 203d 3d20 6e3a 200d 0a20 2020 2020 2020   == n: ..       
-000136d0: 2020 2020 2070 726f 7073 3d20 645f 636f       props= d_co
-000136e0: 6c6f 7273 200d 0a20 2020 2020 2020 2065  lors ..        e
-000136f0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00013700: 2020 7263 6f6c 6f72 7320 3d20 6c69 7374    rcolors = list
-00013710: 2869 7465 7274 6f6f 6c73 2e72 6570 6561  (itertools.repea
-00013720: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
-00013730: 2020 2020 645f 636f 6c6f 7273 202c 2028      d_colors , (
-00013740: 6e20 2b20 6c65 6e28 645f 636f 6c6f 7273  n + len(d_colors
-00013750: 2929 2f2f 6c65 6e28 645f 636f 6c6f 7273  ))//len(d_colors
-00013760: 2929 2920 0d0a 2020 2020 0d0a 2020 2020  ))) ..    ..    
-00013770: 2020 2020 2020 2020 7072 6f70 7320 203d          props  =
-00013780: 206c 6973 7428 6974 6572 746f 6f6c 732e   list(itertools.
-00013790: 6368 6169 6e28 2a72 636f 6c6f 7273 2929  chain(*rcolors))
-000137a0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-000137b0: 6966 2070 726f 703d 3d27 6d61 726b 6572  if prop=='marker
-000137c0: 273a 200d 0a20 2020 2020 2020 200d 0a20  ': ..        .. 
-000137d0: 2020 2020 2020 2064 5f6d 6172 6b65 7273         d_markers
-000137e0: 203d 2020 445f 4d41 524b 4552 5320 2b20   =  D_MARKERS + 
-000137f0: 6c69 7374 286d 706c 2e6c 696e 6573 2e4c  list(mpl.lines.L
-00013800: 696e 6532 442e 6d61 726b 6572 732e 6b65  ine2D.markers.ke
-00013810: 7973 2829 2920 0d0a 2020 2020 2020 2020  ys()) ..        
-00013820: 726d 6172 6b65 7273 203d 206c 6973 7428  rmarkers = list(
-00013830: 6974 6572 746f 6f6c 732e 7265 7065 6174  itertools.repeat
-00013840: 280d 0a20 2020 2020 2020 2020 2020 2064  (..            d
-00013850: 5f6d 6172 6b65 7273 202c 2028 6e20 2b20  _markers , (n + 
-00013860: 6c65 6e28 645f 6d61 726b 6572 7329 292f  len(d_markers))/
-00013870: 2f6c 656e 2864 5f6d 6172 6b65 7273 2929  /len(d_markers))
-00013880: 2920 0d0a 2020 2020 2020 2020 0d0a 2020  ) ..        ..  
-00013890: 2020 2020 2020 7072 6f70 7320 203d 206c        props  = l
-000138a0: 6973 7428 6974 6572 746f 6f6c 732e 6368  ist(itertools.ch
-000138b0: 6169 6e28 2a72 6d61 726b 6572 7329 290d  ain(*rmarkers)).
-000138c0: 0a20 2020 2023 2072 6570 6561 7420 7468  .    # repeat th
-000138d0: 6520 6c69 6e65 7320 746f 206d 6565 7420  e lines to meet 
-000138e0: 7468 6520 6e75 6d62 6572 206f 6620 6376  the number of cv
-000138f0: 5f73 697a 6520 0d0a 2020 2020 6966 2070  _size ..    if p
-00013900: 726f 703d 3d27 6c69 6e65 273a 200d 0a20  rop=='line': .. 
-00013910: 2020 2020 2020 2064 5f6c 696e 6573 203d         d_lines =
-00013920: 2020 445f 5354 594c 4553 0d0a 2020 2020    D_STYLES..    
-00013930: 2020 2020 726c 696e 6573 203d 206c 6973      rlines = lis
-00013940: 7428 6974 6572 746f 6f6c 732e 7265 7065  t(itertools.repe
-00013950: 6174 280d 0a20 2020 2020 2020 2020 2020  at(..           
-00013960: 2064 5f6c 696e 6573 202c 2028 6e20 2b20   d_lines , (n + 
-00013970: 6c65 6e28 645f 6c69 6e65 7329 292f 2f6c  len(d_lines))//l
-00013980: 656e 2864 5f6c 696e 6573 2929 2920 0d0a  en(d_lines))) ..
-00013990: 2020 2020 2020 2020 2320 636f 6d62 696e          # combin
-000139a0: 6520 616c 6c20 7265 7065 6174 6c69 6e65  e all repeatline
-000139b0: 7320 0d0a 2020 2020 2020 2020 7072 6f70  s ..        prop
-000139c0: 7320 203d 206c 6973 7428 6974 6572 746f  s  = list(iterto
-000139d0: 6f6c 732e 6368 6169 6e28 2a72 6c69 6e65  ols.chain(*rline
-000139e0: 7329 290d 0a20 2020 200d 0a20 2020 2072  s))..    ..    r
-000139f0: 6574 7572 6e20 7072 6f70 7320 5b3a 206e  eturn props [: n
-00013a00: 205d 0d0a 2020 2020 2020 200d 0a64 6566   ]..       ..def
-00013a10: 2072 6573 6574 7469 6e67 5f63 6f6c 6f72   resetting_color
-00013a20: 6261 725f 626f 756e 6428 6362 6d61 7820  bar_bound(cbmax 
-00013a30: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00013a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a50: 6362 6d69 6e2c 0d0a 2020 2020 2020 2020  cbmin,..        
-00013a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a70: 2020 2020 206e 756d 6265 725f 6f66 5f74       number_of_t
-00013a80: 6963 6b73 203d 2035 2c20 0d0a 2020 2020  icks = 5, ..    
+00012100: 2020 290d 0a20 2020 2066 726f 6d20 6d6c    )..    from ml
+00012110: 7874 656e 642e 706c 6f74 7469 6e67 2069  xtend.plotting i
+00012120: 6d70 6f72 7420 7363 6174 7465 7270 6c6f  mport scatterplo
+00012130: 746d 6174 7269 780d 0a20 2020 2020 2020  tmatrix..       
+00012140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012160: 0d0a 2020 2020 6966 2069 7369 6e73 7461  ..    if isinsta
+00012170: 6e63 6520 2863 6f6c 756d 6e73 2c20 7374  nce (columns, st
+00012180: 7229 3a20 0d0a 2020 2020 2020 2020 636f  r): ..        co
+00012190: 6c75 6d6e 7320 3d20 5b63 6f6c 756d 6e73  lumns = [columns
+000121a0: 205d 200d 0a20 2020 2074 7279 3a20 0d0a   ] ..    try: ..
+000121b0: 2020 2020 2020 2020 6974 6572 2028 636f          iter (co
+000121c0: 6c75 6d6e 7329 0d0a 2020 2020 6578 6365  lumns)..    exce
+000121d0: 7074 203a 200d 0a20 2020 2020 2020 2072  pt : ..        r
+000121e0: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
+000121f0: 2043 6f6c 756d 6e73 2073 686f 756c 6420   Columns should 
+00012200: 6265 2061 6e20 6974 6572 6162 6c65 206f  be an iterable o
+00012210: 626a 6563 742c 206e 6f74 220d 0a20 2020  bject, not"..   
+00012220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012230: 2020 2020 2066 2220 7b74 7970 6520 2863       f" {type (c
+00012240: 6f6c 756d 6e73 292e 5f5f 6e61 6d65 5f5f  olumns).__name__
+00012250: 2172 7d22 290d 0a20 2020 2063 6f6c 756d  !r}")..    colum
+00012260: 6e73 203d 6c69 7374 2863 6f6c 756d 6e73  ns =list(columns
+00012270: 290d 0a20 2020 200d 0a20 2020 200d 0a20  )..    ..    .. 
+00012280: 2020 2069 6620 636f 6c75 6d6e 7320 6973     if columns is
+00012290: 206e 6f74 204e 6f6e 653a 200d 0a20 2020   not None: ..   
+000122a0: 2020 2020 2064 6620 3d64 665b 636f 6c75       df =df[colu
+000122b0: 6d6e 7320 5d20 0d0a 2020 2020 2020 2020  mns ] ..        
+000122c0: 0d0a 2020 2020 6178 203d 2073 6361 7474  ..    ax = scatt
+000122d0: 6572 706c 6f74 6d61 7472 6978 2028 0d0a  erplotmatrix (..
+000122e0: 2020 2020 2020 2020 6466 5b63 6f6c 756d          df[colum
+000122f0: 6e73 5d2e 7661 6c75 6573 202c 2066 6967  ns].values , fig
+00012300: 7369 7a65 203d 6669 675f 7369 7a65 2c6e  size =fig_size,n
+00012310: 616d 6573 203d 636f 6c75 6d6e 7320 2c20  ames =columns , 
+00012320: 616c 7068 6120 3d61 6c70 6861 200d 0a20  alpha =alpha .. 
+00012330: 2020 2020 2020 2029 0d0a 2020 2020 706c         )..    pl
+00012340: 742e 7469 6768 745f 6c61 796f 7574 2829  t.tight_layout()
+00012350: 0d0a 0d0a 2020 2020 6966 2073 6176 6566  ....    if savef
+00012360: 6967 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ig is not None:.
+00012370: 0a20 2020 2020 2020 2020 7361 7665 6669  .         savefi
+00012380: 6775 7265 2873 6176 6566 6967 2c20 7361  gure(savefig, sa
+00012390: 7665 6669 6720 290d 0a20 2020 2070 6c74  vefig )..    plt
+000123a0: 2e63 6c6f 7365 2028 2920 6966 2073 6176  .close () if sav
+000123b0: 6566 6967 2069 7320 6e6f 7420 4e6f 6e65  efig is not None
+000123c0: 2065 6c73 6520 706c 742e 7368 6f77 2829   else plt.show()
+000123d0: 200d 0a20 2020 200d 0a20 2020 2072 6574   ..    ..    ret
+000123e0: 7572 6e20 6178 200d 0a0d 0a20 2020 200d  urn ax ....    .
+000123f0: 0a64 6566 2073 6176 6566 6967 7572 6520  .def savefigure 
+00012400: 2866 6967 3a20 6f62 6a65 6374 202c 0d0a  (fig: object ,..
+00012410: 2020 2020 2020 2020 2020 2020 2066 6967               fig
+00012420: 6e61 6d65 3a20 7374 7220 3d20 4e6f 6e65  name: str = None
+00012430: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00012440: 6578 743a 7374 7220 3d27 2e70 6e67 272c  ext:str ='.png',
+00012450: 0d0a 2020 2020 2020 2020 2020 2020 202a  ..             *
+00012460: 2a73 6b77 7320 293a 200d 0a20 2020 2022  *skws ): ..    "
+00012470: 2222 2073 6176 6520 6669 6775 7265 2066  "" save figure f
+00012480: 726f 6d20 7468 6520 6769 7665 6e20 6669  rom the given fi
+00012490: 6775 7265 206e 616d 6520 200d 0a20 2020  gure name  ..   
+000124a0: 200d 0a20 2020 203a 7061 7261 6d20 6669   ..    :param fi
+000124b0: 673a 204d 6174 706c 6f74 6c69 6220 6669  g: Matplotlib fi
+000124c0: 6775 7265 206f 626a 6563 7420 0d0a 2020  gure object ..  
+000124d0: 2020 3a70 6172 616d 2066 6967 6e61 6d65    :param figname
+000124e0: 3a20 6e61 6d65 206f 6620 6669 6775 7265  : name of figure
+000124f0: 2074 6f20 6f75 7470 7574 200d 0a20 2020   to output ..   
+00012500: 203a 7061 7261 6d20 6578 743a 2073 7472   :param ext: str
+00012510: 202d 2065 7874 656e 7369 6f6e 206f 6620   - extension of 
+00012520: 7468 6520 6669 6775 7265 200d 0a20 2020  the figure ..   
+00012530: 203a 7061 7261 6d20 736b 7773 3a20 4d61   :param skws: Ma
+00012540: 7470 6c6f 746c 6962 2073 6176 6566 6967  tplotlib savefig
+00012550: 7572 6520 6b65 7977 6172 6473 2061 6464  ure keywards add
+00012560: 6974 696f 6e61 6c20 6b65 7977 6f72 6473  itional keywords
+00012570: 2061 7267 756d 656e 7473 200d 0a20 2020   arguments ..   
+00012580: 200d 0a20 2020 203a 7265 7475 726e 3a20   ..    :return: 
+00012590: 4d61 7470 6c6f 746c 6962 2073 6176 6566  Matplotlib savef
+000125a0: 6967 7572 6520 6f62 6a65 6374 732e 200d  igure objects. .
+000125b0: 0a20 2020 200d 0a20 2020 2022 2222 0d0a  .    ..    """..
+000125c0: 2020 2020 6578 7420 3d20 272e 2720 2b20      ext = '.' + 
+000125d0: 7374 7228 6578 7429 2e6c 6f77 6572 2829  str(ext).lower()
+000125e0: 2e73 7472 6970 2829 2e72 6570 6c61 6365  .strip().replace
+000125f0: 2827 2e27 2c20 2727 290d 0a0d 0a20 2020  ('.', '')....   
+00012600: 2069 6620 6669 676e 616d 6520 6973 204e   if figname is N
+00012610: 6f6e 653a 200d 0a20 2020 2020 2020 2066  one: ..        f
+00012620: 6967 6e61 6d65 203d 2020 275f 2720 2b20  igname =  '_' + 
+00012630: 6f73 2e70 6174 682e 7370 6c69 7465 7874  os.path.splitext
+00012640: 286f 732e 7061 7468 2e62 6173 656e 616d  (os.path.basenam
+00012650: 6528 5f5f 6669 6c65 5f5f 2929 202b 5c0d  e(__file__)) +\.
+00012660: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+00012670: 6574 696d 652e 6461 7465 7469 6d65 2e6e  etime.datetime.n
+00012680: 6f77 2829 2e73 7472 6674 696d 6528 2725  ow().strftime('%
+00012690: 6d2d 2564 2d25 5920 2548 3a25 4d3a 2553  m-%d-%Y %H:%M:%S
+000126a0: 2729 202b 2065 7874 0d0a 2020 2020 2020  ') + ext..      
+000126b0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+000126c0: 224e 6f20 6e61 6d65 206f 6620 6669 6775  "No name of figu
+000126d0: 7265 2069 7320 6769 7665 6e2e 2046 6967  re is given. Fig
+000126e0: 7572 6520 7368 6f75 6c64 2062 6520 7265  ure should be re
+000126f0: 6e61 6d65 6420 6173 2022 0d0a 2020 2020  named as "..    
+00012700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012710: 2020 6622 7b66 6967 6e61 6d65 2172 7d22    f"{figname!r}"
+00012720: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00012730: 2066 696c 652c 2065 7820 3d20 6f73 2e70   file, ex = os.p
+00012740: 6174 682e 7370 6c69 7465 7874 2866 6967  ath.splitext(fig
+00012750: 6e61 6d65 290d 0a20 2020 2069 6620 6578  name)..    if ex
+00012760: 2069 6e20 2827 272c 204e 6f6e 6529 3a20   in ('', None): 
+00012770: 0d0a 2020 2020 2020 2020 6578 203d 2065  ..        ex = e
+00012780: 7874 200d 0a20 2020 2020 2020 2066 6967  xt ..        fig
+00012790: 6e61 6d65 203d 206f 732e 7061 7468 2e6a  name = os.path.j
+000127a0: 6f69 6e28 6669 6c65 2c20 6627 7b65 7874  oin(file, f'{ext
+000127b0: 7d27 290d 0a0d 0a20 2020 2072 6574 7572  }')....    retur
+000127c0: 6e20 2066 6967 2e73 6176 6566 6967 2866  n  fig.savefig(f
+000127d0: 6967 6e61 6d65 2c20 2a2a 736b 7773 290d  igname, **skws).
+000127e0: 0a0d 0a0d 0a64 6566 2072 6573 6574 7469  .....def resetti
+000127f0: 6e67 5f74 6963 6b73 2028 2067 6574 5f78  ng_ticks ( get_x
+00012800: 7974 6963 6b73 2c20 206e 756d 6265 725f  yticks,  number_
+00012810: 6f66 5f74 6963 6b73 3d4e 6f6e 6520 293a  of_ticks=None ):
+00012820: 200d 0a20 2020 2022 2222 0d0a 2020 2020   ..    """..    
+00012830: 7265 7365 7474 696e 6720 7879 7469 636b  resetting xytick
+00012840: 7320 206d 6f64 756c 6f20 2c20 3130 300d  s  modulo , 100.
+00012850: 0a20 2020 200d 0a20 2020 203a 7061 7261  .    ..    :para
+00012860: 6d20 6765 745f 7879 7469 636b 733a 2020  m get_xyticks:  
+00012870: 7879 7469 636b 7320 6c69 7374 2020 2c20  xyticks list  , 
+00012880: 7573 6520 746f 2061 782e 6765 745f 787c  use to ax.get_x|
+00012890: 7974 6963 6b73 2829 0d0a 2020 2020 3a74  yticks()..    :t
+000128a0: 7970 6520 2067 6574 5f78 7974 6963 6b73  ype  get_xyticks
+000128b0: 3a20 6c69 7374 200d 0a20 2020 200d 0a20  : list ..    .. 
+000128c0: 2020 203a 7061 7261 6d20 6e75 6d62 6572     :param number
+000128d0: 5f6f 665f 7469 636b 733a 2020 6d61 7962  _of_ticks:  mayb
+000128e0: 6520 7468 6520 6e75 6d62 6572 206f 6620  e the number of 
+000128f0: 7469 636b 7320 6f6e 2078 206f 7220 7920  ticks on x or y 
+00012900: 6178 6973 200d 0a20 2020 203a 7479 7065  axis ..    :type
+00012910: 206e 756d 6265 725f 6f66 5f74 6963 6b73   number_of_ticks
+00012920: 3a20 696e 740d 0a20 2020 200d 0a20 2020  : int..    ..   
+00012930: 203a 7265 7475 726e 733a 2061 206e 6577   :returns: a new
+00012940: 5f6c 6973 7420 6f72 206e 6461 7272 6179  _list or ndarray
+00012950: 200d 0a20 2020 203a 7274 7970 653a 206c   ..    :rtype: l
+00012960: 6973 7420 6f72 2061 7272 6179 5f6c 696b  ist or array_lik
+00012970: 6520 0d0a 2020 2020 2222 220d 0a20 2020  e ..    """..   
+00012980: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+00012990: 6365 2867 6574 5f78 7974 6963 6b73 2c20  ce(get_xyticks, 
+000129a0: 286c 6973 742c 206e 702e 6e64 6172 7261  (list, np.ndarra
+000129b0: 7929 2029 3a20 0d0a 2020 2020 2020 2020  y) ): ..        
+000129c0: 7761 726e 696e 6773 2e77 6172 6e20 280d  warnings.warn (.
+000129d0: 0a20 2020 2020 2020 2020 2020 2027 4172  .            'Ar
+000129e0: 6775 6d65 6e74 7320 6765 745f 7879 7469  guments get_xyti
+000129f0: 636b 7320 6d75 7374 2062 6520 6120 6c69  cks must be a li
+00012a00: 7374 270d 0a20 2020 2020 2020 2020 2020  st'..           
+00012a10: 2027 206e 6f74 203c 7b30 7d3e 2e27 2e66   ' not <{0}>.'.f
+00012a20: 6f72 6d61 7428 7479 7065 2867 6574 5f78  ormat(type(get_x
+00012a30: 7974 6963 6b73 2929 290d 0a20 2020 2020  yticks)))..     
+00012a40: 2020 2072 6169 7365 2054 6970 4572 726f     raise TipErro
+00012a50: 7220 280d 0a20 2020 2020 2020 2020 2020  r (..           
+00012a60: 2027 3c7b 307d 3e20 666f 756e 642e 2022   '<{0}> found. "
+00012a70: 6765 745f 7879 7469 636b 7322 206d 7573  get_xyticks" mus
+00012a80: 7420 6265 2061 2027 0d0a 2020 2020 2020  t be a '..      
+00012a90: 2020 2020 2020 276c 6973 7420 6f72 2028        'list or (
+00012aa0: 6e64 2e61 7272 6179 2c31 292e 272e 666f  nd.array,1).'.fo
+00012ab0: 726d 6174 2874 7970 6528 6765 745f 7879  rmat(type(get_xy
+00012ac0: 7469 636b 7329 2929 0d0a 2020 2020 0d0a  ticks)))..    ..
+00012ad0: 2020 2020 6966 206e 756d 6265 725f 6f66      if number_of
+00012ae0: 5f74 6963 6b73 2069 7320 4e6f 6e65 203a  _ticks is None :
+00012af0: 0d0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
+00012b00: 2867 6574 5f78 7974 6963 6b73 2920 3e20  (get_xyticks) > 
+00012b10: 3220 3a20 0d0a 2020 2020 2020 2020 2020  2 : ..          
+00012b20: 2020 6e75 6d62 6572 5f6f 665f 7469 636b    number_of_tick
+00012b30: 7320 3d20 696e 7428 286c 656e 2867 6574  s = int((len(get
+00012b40: 5f78 7974 6963 6b73 292d 3129 2f32 290d  _xyticks)-1)/2).
+00012b50: 0a20 2020 2020 2020 2065 6c73 6520 3a20  .        else : 
+00012b60: 6e75 6d62 6572 5f6f 665f 7469 636b 7320  number_of_ticks 
+00012b70: 203d 206c 656e 2867 6574 5f78 7974 6963   = len(get_xytic
+00012b80: 6b73 290d 0a20 2020 200d 0a20 2020 2069  ks)..    ..    i
+00012b90: 6620 6e6f 7428 6e75 6d62 6572 5f6f 665f  f not(number_of_
+00012ba0: 7469 636b 732c 2028 666c 6f61 742c 2069  ticks, (float, i
+00012bb0: 6e74 2929 3a20 0d0a 2020 2020 2020 2020  nt)): ..        
+00012bc0: 7472 7920 3a20 6e75 6d62 6572 5f6f 665f  try : number_of_
+00012bd0: 7469 636b 733d 696e 7428 6e75 6d62 6572  ticks=int(number
+00012be0: 5f6f 665f 7469 636b 7329 200d 0a20 2020  _of_ticks) ..   
+00012bf0: 2020 2020 2065 7863 6570 7420 3a20 0d0a       except : ..
+00012c00: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+00012c10: 696e 6773 2e77 6172 6e28 2722 4e75 6d62  ings.warn('"Numb
+00012c20: 6572 5f6f 665f 7469 636b 7322 2061 7267  er_of_ticks" arg
+00012c30: 756d 656e 7473 2069 7320 7468 6520 7469  uments is the ti
+00012c40: 6d65 7320 746f 2073 6565 2027 0d0a 2020  mes to see '..  
+00012c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012c60: 2020 2020 2020 2020 2774 6865 2074 6963          'the tic
+00012c70: 6b73 206f 6e20 787c 7920 6178 6973 2e27  ks on x|y axis.'
+00012c80: 5c0d 0a20 2020 2020 2020 2020 2020 2020  \..             
+00012c90: 2020 2020 2020 2020 2020 2020 2027 204d               ' M
+00012ca0: 7573 7420 6265 2069 6e74 6567 6572 206e  ust be integer n
+00012cb0: 6f74 203c 7b30 7d3e 2e27 2e0d 0a20 2020  ot <{0}>.'...   
+00012cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012cd0: 2020 2020 2020 2066 6f72 6d61 7428 7479         format(ty
+00012ce0: 7065 286e 756d 6265 725f 6f66 5f74 6963  pe(number_of_tic
+00012cf0: 6b73 2929 290d 0a20 2020 2020 2020 2020  ks)))..         
+00012d00: 2020 2072 6169 7365 2050 6c6f 7445 7272     raise PlotErr
+00012d10: 6f72 2866 273c 7b74 7970 6528 6e75 6d62  or(f'<{type(numb
+00012d20: 6572 5f6f 665f 7469 636b 7329 2e5f 5f6e  er_of_ticks).__n
+00012d30: 616d 655f 5f7d 3e20 6465 7465 6374 6564  ame__}> detected
+00012d40: 2e27 0d0a 2020 2020 2020 2020 2020 2020  .'..            
+00012d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012d60: 2720 4d75 7374 2062 6520 696e 7465 6765  ' Must be intege
+00012d70: 722e 2729 0d0a 2020 2020 2020 2020 0d0a  r.')..        ..
+00012d80: 2020 2020 6e75 6d62 6572 5f6f 665f 7469      number_of_ti
+00012d90: 636b 733d 696e 7428 6e75 6d62 6572 5f6f  cks=int(number_o
+00012da0: 665f 7469 636b 7329 0d0a 2020 2020 0d0a  f_ticks)..    ..
+00012db0: 2020 2020 6966 206c 656e 2867 6574 5f78      if len(get_x
+00012dc0: 7974 6963 6b73 2920 3e20 3220 3a0d 0a20  yticks) > 2 :.. 
+00012dd0: 2020 2020 2020 2069 6620 6765 745f 7879         if get_xy
+00012de0: 7469 636b 735b 315d 2025 3130 2021 3d20  ticks[1] %10 != 
+00012df0: 3020 3a20 0d0a 2020 2020 2020 2020 2020  0 : ..          
+00012e00: 2020 6765 745f 7879 7469 636b 735b 315d    get_xyticks[1]
+00012e10: 203d 6765 745f 7879 7469 636b 735b 315d   =get_xyticks[1]
+00012e20: 202b 2028 3130 202d 2067 6574 5f78 7974   + (10 - get_xyt
+00012e30: 6963 6b73 5b31 5d20 2531 3029 0d0a 2020  icks[1] %10)..  
+00012e40: 2020 2020 2020 6966 2067 6574 5f78 7974        if get_xyt
+00012e50: 6963 6b73 5b2d 325d 2531 3020 2021 3d30  icks[-2]%10  !=0
+00012e60: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
+00012e70: 2067 6574 5f78 7974 6963 6b73 5b2d 325d   get_xyticks[-2]
+00012e80: 203d 6765 745f 7879 7469 636b 735b 2d32   =get_xyticks[-2
+00012e90: 5d20 2d67 6574 5f78 7974 6963 6b73 5b2d  ] -get_xyticks[-
+00012ea0: 325d 2025 3130 0d0a 2020 2020 0d0a 2020  2] %10..    ..  
+00012eb0: 2020 2020 2020 6e65 775f 6172 7261 7920        new_array 
+00012ec0: 3d20 6e70 2e6c 696e 7370 6163 6528 6765  = np.linspace(ge
+00012ed0: 745f 7879 7469 636b 735b 315d 2c20 6765  t_xyticks[1], ge
+00012ee0: 745f 7879 7469 636b 735b 2d32 5d2c 0d0a  t_xyticks[-2],..
+00012ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012f10: 6e75 6d62 6572 5f6f 665f 7469 636b 7320  number_of_ticks 
+00012f20: 290d 0a20 2020 2065 6c69 6620 6c65 6e28  )..    elif len(
+00012f30: 6765 745f 7879 7469 636b 7329 3c20 3220  get_xyticks)< 2 
+00012f40: 3a20 0d0a 2020 2020 2020 2020 6e65 775f  : ..        new_
+00012f50: 6172 7261 7920 3d20 6e70 2e61 7272 6179  array = np.array
+00012f60: 2867 6574 5f78 7974 6963 6b73 290d 0a20  (get_xyticks).. 
+00012f70: 0d0a 2020 2020 7265 7475 726e 2020 6e65  ..    return  ne
+00012f80: 775f 6172 7261 790d 0a20 2020 2020 2020  w_array..       
+00012f90: 200d 0a64 6566 206d 616b 655f 6d70 6c5f   ..def make_mpl_
+00012fa0: 7072 6f70 6572 7469 6573 286e 202c 7072  properties(n ,pr
+00012fb0: 6f70 203d 2763 6f6c 6f72 2729 3a20 0d0a  op ='color'): ..
+00012fc0: 2020 2020 2222 2220 6d61 6b65 206d 6174      """ make mat
+00012fd0: 706c 6f74 6c69 6220 7072 6f70 6572 7479  plotlib property
+00012fe0: 2028 2763 6f6c 6f72 7327 2c20 276d 6172   ('colors', 'mar
+00012ff0: 6b65 7227 2c20 276c 696e 6527 2920 746f  ker', 'line') to
+00013000: 2066 6974 2074 6865 200d 0a20 2020 206e   fit the ..    n
+00013010: 756d 6572 206f 6620 7361 6d70 6c65 730d  umer of samples.
+00013020: 0a20 2020 200d 0a20 2020 203a 7061 7261  .    ..    :para
+00013030: 6d20 6e3a 2069 6e74 2c20 0d0a 2020 2020  m n: int, ..    
+00013040: 2020 2020 4e75 6d62 6572 206f 6620 7072      Number of pr
+00013050: 6f70 6572 7479 2074 6861 7420 6973 206e  operty that is n
+00013060: 6565 6465 6420 746f 2063 7265 6174 652e  eeded to create.
+00013070: 2049 7420 6765 6e65 7261 7465 7320 6120   It generates a 
+00013080: 6772 6f75 7020 6f66 200d 0a20 2020 2020  group of ..     
+00013090: 2020 2070 726f 7065 7274 7920 6974 656d     property item
+000130a0: 732e 200d 0a20 2020 203a 7061 7261 6d20  s. ..    :param 
+000130b0: 7072 6f70 3a20 7374 722c 2064 6566 6175  prop: str, defau
+000130c0: 6c74 3d27 636f 6c6f 7227 2c20 6e61 6d65  lt='color', name
+000130d0: 206f 6620 7072 6f70 6572 7479 2074 6f20   of property to 
+000130e0: 7265 7472 6965 7665 2e20 4163 6365 7074  retrieve. Accept
+000130f0: 7320 0d0a 2020 2020 2020 2020 6f6e 6c79  s ..        only
+00013100: 2027 636f 6c6f 7273 272c 2027 6d61 726b   'colors', 'mark
+00013110: 6572 2720 6f72 2027 6c69 6e65 272e 0d0a  er' or 'line'...
+00013120: 2020 2020 3a72 6574 7572 6e3a 206c 6973      :return: lis
+00013130: 7420 6f66 2070 726f 7065 7274 7920 6974  t of property it
+00013140: 656d 7320 7769 7468 2073 697a 6520 6571  ems with size eq
+00013150: 7561 6c73 2074 6f20 606e 602e 0d0a 2020  uals to `n`...  
+00013160: 2020 3a45 7861 6d70 6c65 3a20 0d0a 2020    :Example: ..  
+00013170: 2020 2020 2020 3e3e 3e20 6672 6f6d 2077        >>> from w
+00013180: 6174 6578 2e75 7469 6c73 2e70 6c6f 7475  atex.utils.plotu
+00013190: 7469 6c73 2069 6d70 6f72 7420 6d61 6b65  tils import make
+000131a0: 5f6d 706c 5f70 726f 7065 7274 6965 730d  _mpl_properties.
+000131b0: 0a20 2020 2020 2020 203e 3e3e 206d 616b  .        >>> mak
+000131c0: 655f 6d70 6c5f 7072 6f70 6572 7469 6573  e_mpl_properties
+000131d0: 2028 3130 2029 0d0a 2020 2020 2020 2020   (10 )..        
+000131e0: 2e2e 2e20 5b27 6727 2c0d 0a20 2020 2020  ... ['g',..     
+000131f0: 2020 2020 2020 2020 2767 7261 7927 2c0d          'gray',.
+00013200: 0a20 2020 2020 2020 2020 2020 2020 2779  .             'y
+00013210: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
+00013220: 2027 626c 7565 272c 0d0a 2020 2020 2020   'blue',..      
+00013230: 2020 2020 2020 2027 6f72 616e 6765 272c         'orange',
+00013240: 0d0a 2020 2020 2020 2020 2020 2020 2027  ..             '
+00013250: 7075 7270 6c65 272c 0d0a 2020 2020 2020  purple',..      
+00013260: 2020 2020 2020 2027 6c69 6d65 272c 0d0a         'lime',..
+00013270: 2020 2020 2020 2020 2020 2020 2027 6b27               'k'
+00013280: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00013290: 2763 7961 6e27 2c0d 0a20 2020 2020 2020  'cyan',..       
+000132a0: 2020 2020 2020 2830 2e36 2c20 302e 362c        (0.6, 0.6,
+000132b0: 2030 2e36 295d 0d0a 2020 2020 2020 2020   0.6)]..        
+000132c0: 3e3e 3e20 6d61 6b65 5f6d 706c 5f70 726f  >>> make_mpl_pro
+000132d0: 7065 7274 6965 7328 3130 3020 2c20 7072  perties(100 , pr
+000132e0: 6f70 203d 2027 6d61 726b 6572 2729 0d0a  op = 'marker')..
+000132f0: 2020 2020 2020 2020 2e2e 2e20 5b27 6f27          ... ['o'
+00013300: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00013310: 275e 272c 0d0a 2020 2020 2020 2020 2020  '^',..          
+00013320: 2020 2027 7827 2c0d 0a20 2020 2020 2020     'x',..       
+00013330: 2020 2020 2020 2744 272c 0d0a 2020 2020        'D',..    
+00013340: 2020 2020 2020 2020 2020 2e0d 0a20 2020            ...   
+00013350: 2020 2020 2020 2020 2020 202e 0d0a 2020             ...  
+00013360: 2020 2020 2020 2020 2020 2020 2e0d 0a20              ... 
+00013370: 2020 2020 2020 2020 2020 2020 3131 2c0d              11,.
+00013380: 0a20 2020 2020 2020 2020 2020 2020 274e  .             'N
+00013390: 6f6e 6527 2c0d 0a20 2020 2020 2020 2020  one',..         
+000133a0: 2020 2020 4e6f 6e65 2c0d 0a20 2020 2020      None,..     
+000133b0: 2020 2020 2020 2020 2720 272c 0d0a 2020          ' ',..  
+000133c0: 2020 2020 2020 2020 2020 2027 275d 0d0a             '']..
+000133d0: 2020 2020 2020 2020 3e3e 3e20 6d61 6b65          >>> make
+000133e0: 5f6d 706c 5f70 726f 7065 7274 6965 7328  _mpl_properties(
+000133f0: 3530 202c 2070 726f 7020 3d20 276c 696e  50 , prop = 'lin
+00013400: 6527 290d 0a20 2020 2020 2020 202e 2e2e  e')..        ...
+00013410: 205b 272d 272c 0d0a 2020 2020 2020 2020   ['-',..        
+00013420: 2020 2020 2027 2d27 2c0d 0a20 2020 2020       '-',..     
+00013430: 2020 2020 2020 2020 272d 2d27 2c0d 0a20          '--',.. 
+00013440: 2020 2020 2020 2020 2020 2020 272d 2e27              '-.'
+00013450: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00013460: 2020 2e0d 0a20 2020 2020 2020 2020 2020    ...           
+00013470: 2020 2020 2e0d 0a20 2020 2020 2020 2020      ...         
+00013480: 2020 2020 2020 2e20 0d0a 2020 2020 2020        . ..      
+00013490: 2020 2020 2020 2027 736f 6c69 6427 2c0d         'solid',.
+000134a0: 0a20 2020 2020 2020 2020 2020 2020 2764  .             'd
+000134b0: 6173 6865 6427 2c0d 0a20 2020 2020 2020  ashed',..       
+000134c0: 2020 2020 2020 2764 6173 6864 6f74 272c        'dashdot',
+000134d0: 0d0a 2020 2020 2020 2020 2020 2020 2027  ..             '
+000134e0: 646f 7474 6564 275d 0d0a 2020 2020 2020  dotted']..      
+000134f0: 2020 0d0a 2020 2020 2222 2220 0d0a 2020    ..    """ ..  
+00013500: 2020 6e3d 696e 7428 5f61 7373 6572 745f    n=int(_assert_
+00013510: 616c 6c5f 7479 7065 7328 6e2c 2069 6e74  all_types(n, int
+00013520: 2c20 666c 6f61 742c 206f 626a 6e61 6d65  , float, objname
+00013530: 203d 2227 6e27 2229 290d 0a20 2020 2070   ="'n'"))..    p
+00013540: 726f 7020 3d20 7374 7228 7072 6f70 292e  rop = str(prop).
+00013550: 6c6f 7765 7228 292e 7374 7269 7028 292e  lower().strip().
+00013560: 7265 706c 6163 6520 2827 7327 2c20 2727  replace ('s', ''
+00013570: 2920 0d0a 2020 2020 6966 2070 726f 7020  ) ..    if prop 
+00013580: 6e6f 7420 696e 2028 2763 6f6c 6f72 272c  not in ('color',
+00013590: 2027 6d61 726b 6572 272c 2027 6c69 6e65   'marker', 'line
+000135a0: 2729 3a20 0d0a 2020 2020 2020 2020 7261  '): ..        ra
+000135b0: 6973 6520 5661 6c75 6545 7272 6f72 2028  ise ValueError (
+000135c0: 2250 726f 7065 7274 7920 7b70 726f 7021  "Property {prop!
+000135d0: 727d 2069 7320 6e6f 7420 6176 6169 6c61  r} is not availa
+000135e0: 6265 2079 6574 2e20 2c20 4578 7065 6374  be yet. , Expect
+000135f0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+00013600: 2020 2020 2020 2020 2020 2020 2022 2027               " '
+00013610: 636f 6c6f 7273 272c 2027 6d61 726b 6572  colors', 'marker
+00013620: 2720 6f72 2027 6c69 6e65 272e 2229 0d0a  ' or 'line'.")..
+00013630: 2020 2020 2320 6375 7374 6f6d 697a 6520      # customize 
+00013640: 706c 6f74 7320 7769 7468 2063 6f6c 6f72  plots with color
+00013650: 7320 6c69 6e65 7320 616e 6420 7374 796c  s lines and styl
+00013660: 6573 200d 0a20 2020 2023 2061 6e64 2063  es ..    # and c
+00013670: 7265 6174 6520 6669 6775 7265 206f 626a  reate figure obj
+00013680: 0d0a 2020 2020 6966 2070 726f 703d 3d27  ..    if prop=='
+00013690: 636f 6c6f 7227 3a20 0d0a 2020 2020 2020  color': ..      
+000136a0: 2020 645f 636f 6c6f 7273 203d 2020 445f    d_colors =  D_
+000136b0: 434f 4c4f 5253 200d 0a20 2020 2020 2020  COLORS ..       
+000136c0: 2064 5f63 6f6c 6f72 7320 3d20 6d70 6c2e   d_colors = mpl.
+000136d0: 636f 6c6f 7273 2e4c 6973 7465 6443 6f6c  colors.ListedCol
+000136e0: 6f72 6d61 7028 645f 636f 6c6f 7273 5b3a  ormap(d_colors[:
+000136f0: 6e5d 292e 636f 6c6f 7273 0d0a 2020 2020  n]).colors..    
+00013700: 2020 2020 6966 206c 656e 2864 5f63 6f6c      if len(d_col
+00013710: 6f72 7329 203d 3d20 6e3a 200d 0a20 2020  ors) == n: ..   
+00013720: 2020 2020 2020 2020 2070 726f 7073 3d20           props= 
+00013730: 645f 636f 6c6f 7273 200d 0a20 2020 2020  d_colors ..     
+00013740: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00013750: 2020 2020 2020 7263 6f6c 6f72 7320 3d20        rcolors = 
+00013760: 6c69 7374 2869 7465 7274 6f6f 6c73 2e72  list(itertools.r
+00013770: 6570 6561 7428 0d0a 2020 2020 2020 2020  epeat(..        
+00013780: 2020 2020 2020 2020 645f 636f 6c6f 7273          d_colors
+00013790: 202c 2028 6e20 2b20 6c65 6e28 645f 636f   , (n + len(d_co
+000137a0: 6c6f 7273 2929 2f2f 6c65 6e28 645f 636f  lors))//len(d_co
+000137b0: 6c6f 7273 2929 2920 0d0a 2020 2020 0d0a  lors))) ..    ..
+000137c0: 2020 2020 2020 2020 2020 2020 7072 6f70              prop
+000137d0: 7320 203d 206c 6973 7428 6974 6572 746f  s  = list(iterto
+000137e0: 6f6c 732e 6368 6169 6e28 2a72 636f 6c6f  ols.chain(*rcolo
+000137f0: 7273 2929 0d0a 2020 2020 2020 2020 0d0a  rs))..        ..
+00013800: 2020 2020 6966 2070 726f 703d 3d27 6d61      if prop=='ma
+00013810: 726b 6572 273a 200d 0a20 2020 2020 2020  rker': ..       
+00013820: 200d 0a20 2020 2020 2020 2064 5f6d 6172   ..        d_mar
+00013830: 6b65 7273 203d 2020 445f 4d41 524b 4552  kers =  D_MARKER
+00013840: 5320 2b20 6c69 7374 286d 706c 2e6c 696e  S + list(mpl.lin
+00013850: 6573 2e4c 696e 6532 442e 6d61 726b 6572  es.Line2D.marker
+00013860: 732e 6b65 7973 2829 2920 0d0a 2020 2020  s.keys()) ..    
+00013870: 2020 2020 726d 6172 6b65 7273 203d 206c      rmarkers = l
+00013880: 6973 7428 6974 6572 746f 6f6c 732e 7265  ist(itertools.re
+00013890: 7065 6174 280d 0a20 2020 2020 2020 2020  peat(..         
+000138a0: 2020 2064 5f6d 6172 6b65 7273 202c 2028     d_markers , (
+000138b0: 6e20 2b20 6c65 6e28 645f 6d61 726b 6572  n + len(d_marker
+000138c0: 7329 292f 2f6c 656e 2864 5f6d 6172 6b65  s))//len(d_marke
+000138d0: 7273 2929 2920 0d0a 2020 2020 2020 2020  rs))) ..        
+000138e0: 0d0a 2020 2020 2020 2020 7072 6f70 7320  ..        props 
+000138f0: 203d 206c 6973 7428 6974 6572 746f 6f6c   = list(itertool
+00013900: 732e 6368 6169 6e28 2a72 6d61 726b 6572  s.chain(*rmarker
+00013910: 7329 290d 0a20 2020 2023 2072 6570 6561  s))..    # repea
+00013920: 7420 7468 6520 6c69 6e65 7320 746f 206d  t the lines to m
+00013930: 6565 7420 7468 6520 6e75 6d62 6572 206f  eet the number o
+00013940: 6620 6376 5f73 697a 6520 0d0a 2020 2020  f cv_size ..    
+00013950: 6966 2070 726f 703d 3d27 6c69 6e65 273a  if prop=='line':
+00013960: 200d 0a20 2020 2020 2020 2064 5f6c 696e   ..        d_lin
+00013970: 6573 203d 2020 445f 5354 594c 4553 0d0a  es =  D_STYLES..
+00013980: 2020 2020 2020 2020 726c 696e 6573 203d          rlines =
+00013990: 206c 6973 7428 6974 6572 746f 6f6c 732e   list(itertools.
+000139a0: 7265 7065 6174 280d 0a20 2020 2020 2020  repeat(..       
+000139b0: 2020 2020 2064 5f6c 696e 6573 202c 2028       d_lines , (
+000139c0: 6e20 2b20 6c65 6e28 645f 6c69 6e65 7329  n + len(d_lines)
+000139d0: 292f 2f6c 656e 2864 5f6c 696e 6573 2929  )//len(d_lines))
+000139e0: 2920 0d0a 2020 2020 2020 2020 2320 636f  ) ..        # co
+000139f0: 6d62 696e 6520 616c 6c20 7265 7065 6174  mbine all repeat
+00013a00: 6c69 6e65 7320 0d0a 2020 2020 2020 2020  lines ..        
+00013a10: 7072 6f70 7320 203d 206c 6973 7428 6974  props  = list(it
+00013a20: 6572 746f 6f6c 732e 6368 6169 6e28 2a72  ertools.chain(*r
+00013a30: 6c69 6e65 7329 290d 0a20 2020 200d 0a20  lines))..    .. 
+00013a40: 2020 2072 6574 7572 6e20 7072 6f70 7320     return props 
+00013a50: 5b3a 206e 205d 0d0a 2020 2020 2020 200d  [: n ]..       .
+00013a60: 0a64 6566 2072 6573 6574 7469 6e67 5f63  .def resetting_c
+00013a70: 6f6c 6f72 6261 725f 626f 756e 6428 6362  olorbar_bound(cb
+00013a80: 6d61 7820 2c0d 0a20 2020 2020 2020 2020  max ,..         
 00013a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013aa0: 2020 2020 2020 2020 206c 6f67 7363 616c           logscal
-00013ab0: 653d 4661 6c73 6529 3a20 0d0a 2020 2020  e=False): ..    
-00013ac0: 2222 220d 0a20 2020 2046 756e 6374 696f  """..    Functio
-00013ad0: 6e20 746f 2072 6573 6574 2063 6f6c 6f72  n to reset color
-00013ae0: 6261 7220 7469 636b 7320 6d6f 7265 2065  bar ticks more e
-00013af0: 6173 7920 746f 2072 6561 6420 0d0a 2020  asy to read ..  
-00013b00: 2020 0d0a 2020 2020 3a70 6172 616d 2063    ..    :param c
-00013b10: 626d 6178 3a20 7661 6c75 6520 6d61 7869  bmax: value maxi
-00013b20: 6d75 6d20 6f66 2063 6f6c 6f72 6261 7220  mum of colorbar 
-00013b30: 0d0a 2020 2020 3a74 7970 6520 6362 6d61  ..    :type cbma
-00013b40: 783a 2066 6c6f 6174 200d 0a20 2020 200d  x: float ..    .
-00013b50: 0a20 2020 203a 7061 7261 6d20 6362 6d69  .    :param cbmi
-00013b60: 6e3a 206d 696e 696d 756d 2064 6174 6120  n: minimum data 
-00013b70: 7661 6c75 6520 0d0a 2020 2020 3a74 7970  value ..    :typ
-00013b80: 6520 6362 6d69 6e3a 2066 6c6f 6174 2020  e cbmin: float  
-00013b90: 6d69 6e69 6d75 6d20 6461 7461 2076 616c  minimum data val
-00013ba0: 7565 0d0a 2020 2020 0d0a 2020 2020 3a70  ue..    ..    :p
-00013bb0: 6172 616d 206e 756d 6265 725f 6f66 5f74  aram number_of_t
-00013bc0: 6963 6b73 3a20 206e 756d 6265 7220 6f66  icks:  number of
-00013bd0: 2074 6963 6b73 2073 686f 756c 6420 6265   ticks should be
-00013be0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00013bf0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00013c00: 6f63 6174 6564 206f 6e20 7468 6520 636f  ocated on the co
-00013c10: 6c6f 7220 6261 7220 2e20 4465 6661 756c  lor bar . Defaul
-00013c20: 7420 6973 2035 2e0d 0a20 2020 203a 7479  t is 5...    :ty
-00013c30: 7065 206e 756d 6265 725f 6f66 5f74 6963  pe number_of_tic
-00013c40: 6b73 3a20 696e 7420 0d0a 2020 2020 0d0a  ks: int ..    ..
-00013c50: 2020 2020 3a70 6172 616d 206c 6f67 7363      :param logsc
-00013c60: 616c 653a 2073 6574 2074 6f20 5472 7565  ale: set to True
-00013c70: 2069 6620 796f 7572 2064 6174 6120 6172   if your data ar
-00013c80: 6520 6c6f 6772 6169 7468 2064 6174 6120  e lograith data 
-00013c90: 2e20 0d0a 2020 2020 3a74 7970 6520 6c6f  . ..    :type lo
-00013ca0: 6773 6361 6c65 3a20 626f 6f6c 200d 0a20  gscale: bool .. 
-00013cb0: 2020 200d 0a20 2020 203a 7265 7475 726e     ..    :return
-00013cc0: 733a 2061 7272 6179 206f 6620 636f 6c6f  s: array of colo
-00013cd0: 7220 6261 7220 7469 636b 7320 7661 6c75  r bar ticks valu
-00013ce0: 652e 0d0a 2020 2020 3a72 7479 7065 3a20  e...    :rtype: 
-00013cf0: 6172 7261 795f 6c69 6b65 200d 0a20 2020  array_like ..   
-00013d00: 2022 2222 0d0a 2020 2020 6465 6620 726f   """..    def ro
-00013d10: 756e 645f 6d6f 6475 6c6f 3130 2876 616c  und_modulo10(val
-00013d20: 7565 293a 200d 0a20 2020 2020 2020 2022  ue): ..        "
-00013d30: 2222 0d0a 2020 2020 2020 2020 726f 756e  ""..        roun
-00013d40: 6420 746f 206d 6f64 756c 6f20 3130 206f  d to modulo 10 o
-00013d50: 7220 6c6f 6761 7269 7468 6d20 7363 616c  r logarithm scal
-00013d60: 6520 202c 200d 0a20 2020 2020 2020 2022  e  , ..        "
-00013d70: 2222 0d0a 2020 2020 2020 2020 6966 2076  ""..        if v
-00013d80: 616c 7565 2025 6d6f 6431 3020 203d 3d20  alue %mod10  == 
-00013d90: 3020 3a20 7265 7475 726e 2076 616c 7565  0 : return value
-00013da0: 200d 0a20 2020 2020 2020 2069 6620 7661   ..        if va
-00013db0: 6c75 6520 256d 6f64 3130 2020 213d 3020  lue %mod10  !=0 
-00013dc0: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00013dd0: 6966 2076 616c 7565 2025 286d 6f64 3130  if value %(mod10
-00013de0: 202f 3229 203d 3d30 203a 2072 6574 7572   /2) ==0 : retur
-00013df0: 6e20 7661 6c75 6520 0d0a 2020 2020 2020  n value ..      
-00013e00: 2020 2020 2020 656c 7365 203a 2072 6574        else : ret
-00013e10: 7572 6e20 2876 616c 7565 202d 2076 616c  urn (value - val
-00013e20: 7565 2025 6d6f 6431 3020 290d 0a20 2020  ue %mod10 )..   
-00013e30: 200d 0a20 2020 2069 6620 6e6f 7428 6e75   ..    if not(nu
-00013e40: 6d62 6572 5f6f 665f 7469 636b 732c 2028  mber_of_ticks, (
-00013e50: 666c 6f61 742c 2069 6e74 2929 3a20 0d0a  float, int)): ..
-00013e60: 2020 2020 2020 2020 7472 7920 3a20 6e75          try : nu
-00013e70: 6d62 6572 5f6f 665f 7469 636b 733d 696e  mber_of_ticks=in
-00013e80: 7428 6e75 6d62 6572 5f6f 665f 7469 636b  t(number_of_tick
-00013e90: 7329 200d 0a20 2020 2020 2020 2065 7863  s) ..        exc
-00013ea0: 6570 7420 3a20 0d0a 2020 2020 2020 2020  ept : ..        
-00013eb0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00013ec0: 6e28 2722 4e75 6d62 6572 5f6f 665f 7469  n('"Number_of_ti
-00013ed0: 636b 7322 2061 7267 756d 656e 7473 2027  cks" arguments '
-00013ee0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00013ef0: 2020 2020 2020 2020 2020 2020 2769 7320              'is 
-00013f00: 7468 6520 7469 6d65 7320 746f 2073 6565  the times to see
-00013f10: 2074 6865 2074 6963 6b73 206f 6e20 787c   the ticks on x|
-00013f20: 7920 6178 6973 2e27 0d0a 2020 2020 2020  y axis.'..      
-00013f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f40: 2020 2020 2720 4d75 7374 2062 6520 696e      ' Must be in
-00013f50: 7465 6765 7220 6e6f 7420 3c7b 307d 3e2e  teger not <{0}>.
-00013f60: 272e 666f 726d 6174 280d 0a20 2020 2020  '.format(..     
-00013f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f80: 2020 2020 2020 2020 2074 7970 6528 6e75           type(nu
-00013f90: 6d62 6572 5f6f 665f 7469 636b 7329 2929  mber_of_ticks)))
-00013fa0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-00013fb0: 6973 6520 5469 7045 7272 6f72 2827 3c7b  ise TipError('<{
-00013fc0: 307d 3e20 6465 7465 6374 6564 2e20 4d75  0}> detected. Mu
-00013fd0: 7374 2062 6520 696e 7465 6765 722e 2729  st be integer.')
-00013fe0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00013ff0: 6e75 6d62 6572 5f6f 665f 7469 636b 733d  number_of_ticks=
-00014000: 696e 7428 6e75 6d62 6572 5f6f 665f 7469  int(number_of_ti
-00014010: 636b 7329 0d0a 2020 2020 0d0a 2020 2020  cks)..    ..    
-00014020: 6966 206c 6f67 7363 616c 6520 6973 2054  if logscale is T
-00014030: 7275 6520 3a20 206d 6f64 3130 203d 6e70  rue :  mod10 =np
-00014040: 2e6c 6f67 3130 2831 3029 0d0a 2020 2020  .log10(10)..    
-00014050: 656c 7365 203a 6d6f 6431 3020 3d20 3130  else :mod10 = 10
-00014060: 200d 0a20 2020 2020 2020 0d0a 2020 2020   ..       ..    
-00014070: 6966 2063 626d 6178 2025 2063 626d 696e  if cbmax % cbmin
-00014080: 203d 3d20 3020 3a20 0d0a 2020 2020 2020   == 0 : ..      
-00014090: 2020 7265 7475 726e 206e 702e 6c69 6e73    return np.lins
-000140a0: 7061 6365 2863 626d 696e 2c20 6362 6d61  pace(cbmin, cbma
-000140b0: 7820 2c20 6e75 6d62 6572 5f6f 665f 7469  x , number_of_ti
-000140c0: 636b 7329 0d0a 2020 2020 656c 6966 2063  cks)..    elif c
-000140d0: 626d 6178 2520 6362 6d69 6e20 213d 2030  bmax% cbmin != 0
-000140e0: 203a 0d0a 2020 2020 2020 2020 7374 6172   :..        star
-000140f0: 7470 6f69 6e74 203d 2063 626d 696e 202b  tpoint = cbmin +
-00014100: 2028 6d6f 6431 3020 202d 2063 626d 696e   (mod10  - cbmin
-00014110: 2025 206d 6f64 3130 2029 0d0a 2020 2020   % mod10 )..    
-00014120: 2020 2020 656e 6470 6f69 6e74 203d 2063      endpoint = c
-00014130: 626d 6178 202d 2063 626d 6178 2025 206d  bmax - cbmax % m
-00014140: 6f64 3130 2020 0d0a 2020 2020 2020 2020  od10  ..        
-00014150: 7265 7475 726e 206e 702e 6172 7261 7928  return np.array(
-00014160: 0d0a 2020 2020 2020 2020 2020 2020 5b72  ..            [r
-00014170: 6f75 6e64 5f6d 6f64 756c 6f31 3028 6969  ound_modulo10(ii
-00014180: 2920 666f 7220 6969 2069 6e20 6e70 2e6c  ) for ii in np.l
-00014190: 696e 7370 6163 6528 0d0a 2020 2020 2020  inspace(..      
-000141a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000141b0: 2020 2020 2020 2073 7461 7274 706f 696e         startpoin
-000141c0: 742c 656e 6470 6f69 6e74 2c20 6e75 6d62  t,endpoint, numb
-000141d0: 6572 5f6f 665f 7469 636b 7329 5d0d 0a20  er_of_ticks)].. 
-000141e0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-000141f0: 2020 0d0a 0d0a 2020 2020 2020 2020 2020    ....          
-00014200: 2020 0d0a 6465 6620 636f 6e74 726f 6c65    ..def controle
-00014210: 5f64 656c 696e 6561 7465 5f63 7572 7665  _delineate_curve
-00014220: 2872 6573 5f64 656c 696e 6520 3d4e 6f6e  (res_deline =Non
-00014230: 6520 2c20 7068 6173 655f 6465 6c69 6e65  e , phase_deline
-00014240: 203d 4e6f 6e65 2029 3a20 0d0a 2020 2020   =None ): ..    
-00014250: 2222 220d 0a20 2020 2066 6f6e 6374 696f  """..    fonctio
-00014260: 6e20 746f 2063 6f6e 7472 6f6c 6520 6465  n to controle de
-00014270: 6c69 6e65 6174 6520 7661 6c75 6520 6769  lineate value gi
-00014280: 7665 6e20 2061 6e64 2072 6574 7572 6e20  ven  and return 
-00014290: 7661 6c75 6520 6365 696c 6c69 6e67 202e  value ceilling .
-000142a0: 0d0a 2020 2020 0d0a 2020 2020 3a70 6172  ..    ..    :par
-000142b0: 616d 2020 7265 735f 6465 6c69 6e65 3a20  am  res_deline: 
-000142c0: 2072 6573 6973 7469 7669 7479 2020 7661   resistivity  va
-000142d0: 6c75 6520 746f 6465 6c69 6e65 6174 652e  lue todelineate.
-000142e0: 2075 6e69 7420 6f66 2052 6573 2069 6e20   unit of Res in 
-000142f0: 606f 686d 2e6d 600d 0a20 2020 203a 7479  `ohm.m`..    :ty
-00014300: 7065 2020 7265 735f 6465 6c69 6e65 3a20  pe  res_deline: 
-00014310: 666c 6f61 747c 696e 747c 6c69 7374 2020  float|int|list  
-00014320: 0d0a 2020 2020 0d0a 2020 2020 3a70 6172  ..    ..    :par
-00014330: 616d 2020 7068 6173 655f 6465 6c69 6e65  am  phase_deline
-00014340: 3a20 2020 7068 6173 6520 7661 6c75 6520  :   phase value 
-00014350: 746f 2020 6465 6c69 6e65 6174 6520 2c20  to  delineate , 
-00014360: 756e 6974 206f 6620 7068 6173 6520 696e  unit of phase in
-00014370: 2064 6567 7265 650d 0a20 2020 203a 7479   degree..    :ty
-00014380: 7065 2070 6861 7365 5f64 656c 696e 653a  pe phase_deline:
-00014390: 2066 6c6f 6174 7c69 6e74 7c6c 6973 7420   float|int|list 
-000143a0: 200d 0a20 2020 200d 0a20 2020 203a 7265   ..    ..    :re
-000143b0: 7475 726e 733a 2064 656c 696e 6561 7465  turns: delineate
-000143c0: 2072 6573 6973 7469 7669 7479 206f 7220   resistivity or 
-000143d0: 7068 6173 6520 7661 6c75 6573 200d 0a20  phase values .. 
-000143e0: 2020 203a 7274 7970 653a 2061 7272 6179     :rtype: array
-000143f0: 5f6c 696b 6520 0d0a 2020 2020 2222 220d  _like ..    """.
-00014400: 0a20 2020 2066 6d74 3d5b 2772 6573 6973  .    fmt=['resis
-00014410: 7469 7669 7479 2c20 7068 6173 6527 5d0d  tivity, phase'].
-00014420: 0a20 0d0a 2020 2020 666f 7220 6969 2c20  . ..    for ii, 
-00014430: 7878 5f64 656c 696e 6520 696e 2065 6e75  xx_deline in enu
-00014440: 6d65 7261 7465 285b 7265 735f 6465 6c69  merate([res_deli
-00014450: 6e65 202c 2070 6861 7365 5f64 656c 696e  ne , phase_delin
-00014460: 655d 293a 200d 0a20 2020 2020 2020 2069  e]): ..        i
-00014470: 6620 7878 5f64 656c 696e 6520 6973 2020  f xx_deline is  
-00014480: 6e6f 7420 4e6f 6e65 2020 3a20 0d0a 2020  not None  : ..  
-00014490: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-000144a0: 6e73 7461 6e63 6528 7878 5f64 656c 696e  nstance(xx_delin
-000144b0: 652c 2028 666c 6f61 742c 2069 6e74 2c20  e, (float, int, 
-000144c0: 7374 7229 293a 0d0a 2020 2020 2020 2020  str)):..        
-000144d0: 2020 2020 2020 2020 7472 7920 3a78 785f          try :xx_
-000144e0: 6465 6c69 6e65 3d20 666c 6f61 7428 7878  deline= float(xx
-000144f0: 5f64 656c 696e 6529 0d0a 2020 2020 2020  _deline)..      
-00014500: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00014510: 203a 2072 6169 7365 2054 6970 4572 726f   : raise TipErro
-00014520: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
-00014530: 2020 2020 2020 2020 2020 2020 2756 616c              'Val
-00014540: 7565 203c 7b30 7d3e 2074 6f20 6465 6c69  ue <{0}> to deli
-00014550: 6e65 6174 6520 3c7b 317d 3e20 6973 2075  neate <{1}> is u
-00014560: 6e61 6363 6570 7461 626c 652e 275c 0d0a  nacceptable.'\..
-00014570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014580: 2020 2020 2020 2020 2027 2050 6c65 6173           ' Pleas
-00014590: 6520 636b 6563 6b20 796f 7572 2076 616c  e ckeck your val
-000145a0: 7565 2e27 2e66 6f72 6d61 7428 7878 5f64  ue.'.format(xx_d
-000145b0: 656c 696e 652c 2066 6d74 5b69 695d 2929  eline, fmt[ii]))
-000145c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000145d0: 2020 656c 7365 203a 0d0a 2020 2020 2020    else :..      
-000145e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000145f0: 2069 6920 3d3d 3020 3a20 7265 7475 726e   ii ==0 : return
-00014600: 205b 6e70 2e63 6569 6c28 6e70 2e6c 6f67   [np.ceil(np.log
-00014610: 3130 2878 785f 6465 6c69 6e65 2929 5d0d  10(xx_deline))].
-00014620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014630: 2020 2020 2069 6620 6969 203d 3d31 203a       if ii ==1 :
-00014640: 2072 6574 7572 6e20 5b6e 702e 6365 696c   return [np.ceil
-00014650: 2878 785f 6465 6c69 6e65 295d 0d0a 2020  (xx_deline)]..  
-00014660: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00014670: 2069 7369 6e73 7461 6e63 6528 7878 5f64   isinstance(xx_d
-00014680: 656c 696e 6520 2c20 286c 6973 742c 2074  eline , (list, t
-00014690: 7570 6c65 2c20 6e70 2e6e 6461 7272 6179  uple, np.ndarray
-000146a0: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
-000146b0: 2020 2020 2078 785f 6465 6c69 6e65 203d       xx_deline =
-000146c0: 6c69 7374 2878 785f 6465 6c69 6e65 290d  list(xx_deline).
-000146d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000146e0: 2074 7279 203a 0d0a 2020 2020 2020 2020   try :..        
-000146f0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00014700: 6920 3d3d 2030 203a 2078 785f 6465 6c69  i == 0 : xx_deli
-00014710: 6e65 203d 205b 0d0a 2020 2020 2020 2020  ne = [..        
-00014720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014730: 2020 2020 6e70 2e63 6569 6c28 6e70 2e6c      np.ceil(np.l
-00014740: 6f67 3130 2866 6c6f 6174 2878 7829 2929  og10(float(xx)))
-00014750: 2066 6f72 2078 7820 696e 2078 785f 6465   for xx in xx_de
-00014760: 6c69 6e65 5d0d 0a20 2020 2020 2020 2020  line]..         
-00014770: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00014780: 2069 6920 3d3d 3120 3a20 7878 5f64 656c   ii ==1 : xx_del
-00014790: 696e 6520 3d20 5b0d 0a20 2020 2020 2020  ine = [..       
-000147a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000147b0: 2020 2020 206e 702e 6365 696c 2866 6c6f       np.ceil(flo
-000147c0: 6174 2878 7829 2920 666f 7220 7878 2069  at(xx)) for xx i
-000147d0: 6e20 7878 5f64 656c 696e 655d 0d0a 2020  n xx_deline]..  
-000147e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000147f0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00014800: 2020 2020 2020 2020 6578 6365 7074 203a          except :
-00014810: 2072 6169 7365 2054 6970 4572 726f 7228   raise TipError(
-00014820: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00014830: 2020 2020 2020 2020 2020 2756 616c 7565            'Value
-00014840: 2074 6f20 6465 6c69 6e65 6174 6520 3c7b   to delineate <{
-00014850: 307d 3e20 6973 2075 6e61 6363 6570 7461  0}> is unaccepta
-00014860: 626c 652e 275c 0d0a 2020 2020 2020 2020  ble.'\..        
-00014870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014880: 2027 2050 6c65 6173 6520 636b 6563 6b20   ' Please ckeck 
-00014890: 796f 7572 2076 616c 7565 2e27 2e66 6f72  your value.'.for
-000148a0: 6d61 7428 666d 745b 6969 5d29 290d 0a20  mat(fmt[ii])).. 
-000148b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000148c0: 6c73 6520 3a20 7265 7475 726e 2078 785f  lse : return xx_
-000148d0: 6465 6c69 6e65 0d0a 0d0a 0d0a 6465 6620  deline......def 
-000148e0: 666d 745f 7465 7874 2028 6461 7461 5f74  fmt_text (data_t
-000148f0: 6578 742c 2066 6d74 3d27 7e27 2c20 6c65  ext, fmt='~', le
-00014900: 6674 7370 6163 6520 3d20 332c 2072 6574  ftspace = 3, ret
-00014910: 7572 6e5f 746f 5f6c 696e 6520 3d37 3729  urn_to_line =77)
-00014920: 203a 200d 0a20 2020 2022 2222 0d0a 2020   : ..    """..  
-00014930: 2020 416c 6c6f 7720 746f 2066 6f72 6d61    Allow to forma
-00014940: 7420 7265 706f 7274 2077 6974 6820 6461  t report with da
-00014950: 7461 2074 6578 7420 2c20 666d 2061 6e64  ta text , fm and
-00014960: 206c 6566 7473 7061 6365 200d 0a0d 0a20   leftspace .... 
-00014970: 2020 203a 7061 7261 6d20 2064 6174 615f     :param  data_
-00014980: 7465 7874 3a20 6120 6c6f 6e67 2074 6578  text: a long tex
-00014990: 7420 0d0a 2020 2020 3a74 7970 6520 2064  t ..    :type  d
-000149a0: 6174 615f 7465 7874 3a20 7374 7220 200d  ata_text: str  .
-000149b0: 0a20 2020 2020 2020 200d 0a20 2020 203a  .        ..    :
-000149c0: 7061 7261 6d20 666d 743a 2020 7479 7065  param fmt:  type
-000149d0: 206f 6620 756e 6465 726c 696e 6520 7465   of underline te
-000149e0: 7874 200d 0a20 2020 203a 7479 7065 2066  xt ..    :type f
-000149f0: 6d74 3a20 7374 720d 0a0d 0a20 2020 203a  mt: str....    :
-00014a00: 7061 7261 6d20 6c65 6674 7370 6165 3a20  param leftspae: 
-00014a10: 486f 7720 6d61 6e79 2073 7061 6365 2064  How many space d
-00014a20: 6f20 796f 7520 7761 6e74 2062 6566 6f72  o you want befor
-00014a30: 6520 7374 6172 7469 6e67 2077 7269 6e74  e starting wrint
-00014a40: 696e 6720 7265 706f 7274 202e 0d0a 2020  ing report ...  
-00014a50: 2020 3a74 7970 6520 6c65 6674 7370 6165    :type leftspae
-00014a60: 3a20 696e 7420 0d0a 2020 2020 0d0a 2020  : int ..    ..  
-00014a70: 2020 3a70 6172 616d 2072 6574 7572 6e5f    :param return_
-00014a80: 746f 5f6c 696e 653a 206e 756d 6265 7220  to_line: number 
-00014a90: 6f66 2063 6861 7261 6374 6572 2074 6f20  of character to 
-00014aa0: 7265 7475 726e 2074 6f20 6c69 6e65 0d0a  return to line..
-00014ab0: 2020 2020 3a74 7970 6520 7265 7475 726e      :type return
-00014ac0: 5f74 6f5f 6c69 6e65 3a20 696e 7420 0d0a  _to_line: int ..
-00014ad0: 2020 2020 2222 220d 0a0d 0a20 2020 2072      """....    r
-00014ae0: 6574 7572 6e5f 746f 5f6c 696e 653d 2069  eturn_to_line= i
-00014af0: 6e74 2872 6574 7572 6e5f 746f 5f6c 696e  nt(return_to_lin
-00014b00: 6529 0d0a 2020 2020 6265 6769 6e5f 7465  e)..    begin_te
-00014b10: 7874 3d20 6c65 6674 7370 6163 6520 2a27  xt= leftspace *'
-00014b20: 2027 0d0a 2020 2020 7465 7874 3d20 6265   '..    text= be
-00014b30: 6769 6e5f 7465 7874 202b 2066 6d74 2a28  gin_text + fmt*(
-00014b40: 7265 7475 726e 5f74 6f5f 6c69 6e65 202b  return_to_line +
-00014b50: 3729 202b 2027 5c6e 272b 2062 6567 696e  7) + '\n'+ begin
-00014b60: 5f74 6578 740d 0a0d 0a20 2020 200d 0a20  _text....    .. 
-00014b70: 2020 2073 733d 300d 0a20 2020 200d 0a20     ss=0..    .. 
-00014b80: 2020 2066 6f72 2020 6969 2c20 6e75 6d20     for  ii, num 
-00014b90: 696e 2065 6e75 6d65 7261 7465 2864 6174  in enumerate(dat
-00014ba0: 615f 7465 7874 2920 3a20 2320 6c6f 6f70  a_text) : # loop
-00014bb0: 2074 6865 2074 6578 7420 0d0a 2020 2020   the text ..    
-00014bc0: 2020 2020 6966 2069 6920 3d3d 206c 656e      if ii == len
-00014bd0: 2864 6174 615f 7465 7874 292d 3120 3a20  (data_text)-1 : 
-00014be0: 2020 2020 2020 2020 2023 2069 6620 6669           # if fi
-00014bf0: 6e64 2074 6865 206c 6173 7420 6368 6172  nd the last char
-00014c00: 6163 7465 7220 6f66 2074 6578 7420 0d0a  acter of text ..
-00014c10: 2020 2020 2020 2020 2020 2020 2374 6578              #tex
-00014c20: 7420 3d20 7465 7874 202b 2064 6174 615f  t = text + data_
-00014c30: 7465 7874 5b73 733a 5d20 2b20 2720 7b30  text[ss:] + ' {0
-00014c40: 7d5c 6e27 2e66 6f72 6d61 7428 666d 7429  }\n'.format(fmt)
-00014c50: 2023 2074 616b 6520 7468 6520 0d0a 2020   # take the ..  
-00014c60: 2020 2020 2020 2020 2020 2372 656d 6169            #remai
-00014c70: 6e20 616e 6420 6164 6420 7265 7475 726e  n and add return
-00014c80: 2063 6861 7269 6f74 200d 0a20 2020 2020   chariot ..     
-00014c90: 2020 2020 2020 2074 6578 7420 3d20 7465         text = te
-00014ca0: 7874 2b20 2720 7b30 7d5c 6e27 2e66 6f72  xt+ ' {0}\n'.for
-00014cb0: 6d61 7428 666d 7429 202b 5c0d 0a20 2020  mat(fmt) +\..   
-00014cc0: 2020 2020 2020 2020 2020 2020 2062 6567               beg
-00014cd0: 696e 5f74 6578 7420 2b66 6d74 2a28 7265  in_text +fmt*(re
-00014ce0: 7475 726e 5f74 6f5f 6c69 6e65 2b37 2920  turn_to_line+7) 
-00014cf0: 2b27 5c6e 2720 0d0a 2020 2020 2020 0d0a  +'\n' ..      ..
-00014d00: 200d 0a20 2020 2020 2020 2020 2020 2062   ..            b
-00014d10: 7265 616b 200d 0a20 2020 2020 2020 2069  reak ..        i
-00014d20: 6620 7373 203d 3d20 7265 7475 726e 5f74  f ss == return_t
-00014d30: 6f5f 6c69 6e65 203a 2020 2020 2020 2020  o_line :        
-00014d40: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-00014d50: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00014d60: 6461 7461 5f74 6578 745b 6969 2b31 5d20  data_text[ii+1] 
-00014d70: 213d 2720 2720 3a20 0d0a 2020 2020 2020  !=' ' : ..      
-00014d80: 2020 2020 2020 2020 2020 7465 7874 203d            text =
-00014d90: 2027 7b30 7d20 7b31 7d2d 205c 6e20 7b32   '{0} {1}- \n {2
-00014da0: 7d20 272e 666f 726d 6174 280d 0a20 2020  } '.format(..   
-00014db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014dc0: 2074 6578 742c 2066 6d74 2c20 6265 6769   text, fmt, begi
-00014dd0: 6e5f 7465 7874 202b 2066 6d74 2029 200d  n_text + fmt ) .
-00014de0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00014df0: 6520 3a20 0d0a 2020 2020 2020 2020 2020  e : ..          
-00014e00: 2020 2020 2020 7465 7874 203d 277b 307d        text ='{0}
-00014e10: 207b 317d 205c 6e20 7b32 7d20 272e 666f   {1} \n {2} '.fo
-00014e20: 726d 6174 280d 0a20 2020 2020 2020 2020  rmat(..         
-00014e30: 2020 2020 2020 2020 2020 2074 6578 742c             text,
-00014e40: 2066 6d74 2c20 6265 6769 6e5f 7465 7874   fmt, begin_text
-00014e50: 2b66 6d74 2029 200d 0a20 2020 2020 2020  +fmt ) ..       
-00014e60: 2020 2020 2073 733d 300d 0a20 2020 2020       ss=0..     
-00014e70: 2020 2074 6578 7420 2b3d 206e 756d 2020     text += num  
-00014e80: 2020 2320 6164 6420 6368 6172 6174 6563    # add charatec
-00014e90: 7465 7220 200d 0a20 2020 2020 2020 2073  ter  ..        s
-00014ea0: 7320 2b3d 310d 0a0d 0a20 2020 2072 6574  s +=1....    ret
-00014eb0: 7572 6e20 7465 7874 200d 0a0d 0a64 6566  urn text ....def
-00014ec0: 2070 6c6f 7476 6563 3128 752c 207a 2c20   plotvec1(u, z, 
-00014ed0: 7629 3a0d 0a20 2020 2022 2222 0d0a 2020  v):..    """..  
-00014ee0: 2020 506c 6f74 2074 6970 7320 6675 6e63    Plot tips func
-00014ef0: 7469 6f6e 2077 6974 6820 2074 6872 6565  tion with  three
-00014f00: 2076 6563 746f 7273 2e20 0d0a 2020 2020   vectors. ..    
-00014f10: 0d0a 2020 2020 3a70 6172 616d 2075 3a20  ..    :param u: 
-00014f20: 7665 6374 6f72 2075 202d 2061 2076 6563  vector u - a vec
-00014f30: 746f 7220 0d0a 2020 2020 3a74 7970 6520  tor ..    :type 
-00014f40: 753a 2061 7272 6179 206c 696b 6520 200d  u: array like  .
-00014f50: 0a20 2020 200d 0a20 2020 203a 7061 7261  .    ..    :para
-00014f60: 6d20 7a3a 2076 6563 746f 7220 7a20 0d0a  m z: vector z ..
-00014f70: 2020 2020 3a74 7970 6520 7a3a 2061 7272      :type z: arr
-00014f80: 6179 5f6c 696b 6520 0d0a 2020 2020 0d0a  ay_like ..    ..
-00014f90: 2020 2020 3a70 6172 616d 2076 3a20 7665      :param v: ve
-00014fa0: 6374 6f72 2076 200d 0a20 2020 203a 7479  ctor v ..    :ty
-00014fb0: 7065 2076 3a20 6172 7261 795f 6c69 6b65  pe v: array_like
-00014fc0: 200d 0a20 2020 200d 0a20 2020 2072 6574   ..    ..    ret
-00014fd0: 7572 6e3a 2070 6c6f 7420 0d0a 2020 2020  urn: plot ..    
-00014fe0: 0d0a 2020 2020 2222 220d 0a20 2020 200d  ..    """..    .
-00014ff0: 0a20 2020 2061 7820 3d20 706c 742e 6178  .    ax = plt.ax
-00015000: 6573 2829 0d0a 2020 2020 6178 2e61 7272  es()..    ax.arr
-00015010: 6f77 2830 2c20 302c 202a 752c 2068 6561  ow(0, 0, *u, hea
-00015020: 645f 7769 6474 683d 302e 3035 2c20 636f  d_width=0.05, co
-00015030: 6c6f 723d 2772 272c 2068 6561 645f 6c65  lor='r', head_le
-00015040: 6e67 7468 3d30 2e31 290d 0a20 2020 2070  ngth=0.1)..    p
-00015050: 6c74 2e74 6578 7428 2a28 7520 2b20 302e  lt.text(*(u + 0.
-00015060: 3129 2c20 2775 2729 0d0a 2020 2020 0d0a  1), 'u')..    ..
-00015070: 2020 2020 6178 2e61 7272 6f77 2830 2c20      ax.arrow(0, 
-00015080: 302c 202a 762c 2068 6561 645f 7769 6474  0, *v, head_widt
-00015090: 683d 302e 3035 2c20 636f 6c6f 723d 2762  h=0.05, color='b
-000150a0: 272c 2068 6561 645f 6c65 6e67 7468 3d30  ', head_length=0
-000150b0: 2e31 290d 0a20 2020 2070 6c74 2e74 6578  .1)..    plt.tex
-000150c0: 7428 2a28 7620 2b20 302e 3129 2c20 2776  t(*(v + 0.1), 'v
-000150d0: 2729 0d0a 2020 2020 6178 2e61 7272 6f77  ')..    ax.arrow
-000150e0: 2830 2c20 302c 202a 7a2c 2068 6561 645f  (0, 0, *z, head_
-000150f0: 7769 6474 683d 302e 3035 2c20 6865 6164  width=0.05, head
-00015100: 5f6c 656e 6774 683d 302e 3129 0d0a 2020  _length=0.1)..  
-00015110: 2020 706c 742e 7465 7874 282a 287a 202b    plt.text(*(z +
-00015120: 2030 2e31 292c 2027 7a27 290d 0a20 2020   0.1), 'z')..   
-00015130: 2070 6c74 2e79 6c69 6d28 2d32 2c20 3229   plt.ylim(-2, 2)
-00015140: 0d0a 2020 2020 706c 742e 786c 696d 282d  ..    plt.xlim(-
-00015150: 322c 2032 290d 0a0d 0a64 6566 2070 6c6f  2, 2)....def plo
-00015160: 7476 6563 3228 612c 6229 3a0d 0a20 2020  tvec2(a,b):..   
-00015170: 2022 2222 0d0a 2020 2020 506c 6f74 2074   """..    Plot t
-00015180: 6970 7320 6675 6e63 7469 6f6e 2077 6974  ips function wit
-00015190: 6820 7477 6f20 7665 6374 6f72 730d 0a20  h two vectors.. 
-000151a0: 2020 204a 7573 7420 7573 6520 746f 2067     Just use to g
-000151b0: 6574 2074 6865 206f 7274 686f 676f 6e61  et the orthogona
-000151c0: 6c69 7479 206f 6620 7477 6f20 7665 6374  lity of two vect
-000151d0: 6f72 2066 6f72 206f 7468 6572 2070 7572  or for other pur
-000151e0: 706f 7365 7320 0d0a 0d0a 2020 2020 3a70  poses ....    :p
-000151f0: 6172 616d 2061 3a20 7665 6374 6f72 2075  aram a: vector u
-00015200: 200d 0a20 2020 203a 7479 7065 2061 3a20   ..    :type a: 
-00015210: 6172 7261 7920 6c69 6b65 2020 2d20 6120  array like  - a 
-00015220: 7665 6374 6f72 200d 0a20 2020 203a 7061  vector ..    :pa
-00015230: 7261 6d20 623a 2076 6563 746f 7220 7a20  ram b: vector z 
-00015240: 0d0a 2020 2020 3a74 7970 6520 623a 2061  ..    :type b: a
-00015250: 7272 6179 5f6c 696b 6520 0d0a 2020 2020  rray_like ..    
-00015260: 0d0a 2020 2020 2a20 2057 7269 7465 2079  ..    *  Write y
-00015270: 6f75 7220 636f 6465 2062 656c 6f77 2061  our code below a
-00015280: 6e64 2070 7265 7373 2053 6869 6674 2b45  nd press Shift+E
-00015290: 6e74 6572 2074 6f20 6578 6563 7574 650d  nter to execute.
-000152a0: 0a20 2020 200d 0a20 2020 203a 4578 616d  .    ..    :Exam
-000152b0: 706c 653a 200d 0a20 2020 2020 2020 200d  ple: ..        .
-000152c0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-000152d0: 6f72 7420 6e75 6d70 7920 6173 206e 7020  ort numpy as np 
-000152e0: 0d0a 2020 2020 2020 2020 3e3e 3e20 6672  ..        >>> fr
-000152f0: 6f6d 2077 6174 6578 2e75 7469 6c73 2e70  om watex.utils.p
-00015300: 6c6f 7475 7469 6c73 2069 6d70 6f72 7420  lotutils import 
-00015310: 706c 6f74 7665 6332 0d0a 2020 2020 2020  plotvec2..      
-00015320: 2020 3e3e 3e20 613d 6e70 2e61 7272 6179    >>> a=np.array
-00015330: 285b 312c 305d 290d 0a20 2020 2020 2020  ([1,0])..       
-00015340: 203e 3e3e 2062 3d6e 702e 6172 7261 7928   >>> b=np.array(
-00015350: 5b30 2c31 5d29 0d0a 2020 2020 2020 2020  [0,1])..        
-00015360: 3e3e 3e20 506c 6f74 7665 6332 2861 2c62  >>> Plotvec2(a,b
-00015370: 290d 0a20 2020 2020 2020 203e 3e3e 2070  )..        >>> p
-00015380: 7269 6e74 2827 7468 6520 7072 6f64 7563  rint('the produc
-00015390: 7420 6120 746f 2062 2069 7320 3d27 2c20  t a to b is =', 
-000153a0: 6e70 2e64 6f74 2861 2c62 2929 0d0a 0d0a  np.dot(a,b))....
-000153b0: 2020 2020 2222 220d 0a20 2020 2061 7820      """..    ax 
-000153c0: 3d20 706c 742e 6178 6573 2829 0d0a 2020  = plt.axes()..  
-000153d0: 2020 6178 2e61 7272 6f77 2830 2c20 302c    ax.arrow(0, 0,
-000153e0: 202a 612c 2068 6561 645f 7769 6474 683d   *a, head_width=
-000153f0: 302e 3035 2c20 636f 6c6f 7220 3d27 7227  0.05, color ='r'
-00015400: 2c20 6865 6164 5f6c 656e 6774 683d 302e  , head_length=0.
-00015410: 3129 0d0a 2020 2020 706c 742e 7465 7874  1)..    plt.text
-00015420: 282a 2861 202b 2030 2e31 292c 2027 6127  (*(a + 0.1), 'a'
-00015430: 290d 0a20 2020 2061 782e 6172 726f 7728  )..    ax.arrow(
-00015440: 302c 2030 2c20 2a62 2c20 6865 6164 5f77  0, 0, *b, head_w
-00015450: 6964 7468 3d30 2e30 352c 2063 6f6c 6f72  idth=0.05, color
-00015460: 203d 2762 272c 2068 6561 645f 6c65 6e67   ='b', head_leng
-00015470: 7468 3d30 2e31 290d 0a20 2020 2070 6c74  th=0.1)..    plt
-00015480: 2e74 6578 7428 2a28 6220 2b20 302e 3129  .text(*(b + 0.1)
-00015490: 2c20 2762 2729 0d0a 2020 2020 706c 742e  , 'b')..    plt.
-000154a0: 796c 696d 282d 322c 2032 290d 0a20 2020  ylim(-2, 2)..   
-000154b0: 2070 6c74 2e78 6c69 6d28 2d32 2c20 3229   plt.xlim(-2, 2)
-000154c0: 2020 0d0a 0d0a 6465 6620 706c 6f74 5f65    ....def plot_e
-000154d0: 7272 6f72 6261 7228 0d0a 2020 2020 2020  rrorbar(..      
-000154e0: 2020 6178 2c0d 0a20 2020 2020 2020 2078    ax,..        x
-000154f0: 5f61 722c 0d0a 2020 2020 2020 2020 795f  _ar,..        y_
-00015500: 6172 2c0d 0a20 2020 2020 2020 2079 5f65  ar,..        y_e
-00015510: 7272 3d4e 6f6e 652c 0d0a 2020 2020 2020  rr=None,..      
-00015520: 2020 785f 6572 723d 4e6f 6e65 2c0d 0a20    x_err=None,.. 
-00015530: 2020 2020 2020 2063 6f6c 6f72 3d27 6b27         color='k'
-00015540: 2c0d 0a20 2020 2020 2020 206d 6172 6b65  ,..        marke
-00015550: 723d 2778 272c 0d0a 2020 2020 2020 2020  r='x',..        
-00015560: 6d73 3d32 2c20 0d0a 2020 2020 2020 2020  ms=2, ..        
-00015570: 6c73 3d27 3a27 2c20 0d0a 2020 2020 2020  ls=':', ..      
-00015580: 2020 6c77 3d31 2c20 0d0a 2020 2020 2020    lw=1, ..      
-00015590: 2020 655f 6361 7073 697a 653d 322c 0d0a    e_capsize=2,..
-000155a0: 2020 2020 2020 2020 655f 6361 7074 6869          e_capthi
-000155b0: 636b 3d2e 352c 0d0a 2020 2020 2020 2020  ck=.5,..        
-000155c0: 7069 636b 6572 3d4e 6f6e 652c 0d0a 2020  picker=None,..  
-000155d0: 2020 2020 2020 2a2a 6b77 730d 0a20 293a        **kws.. ):
-000155e0: 0d0a 2020 2020 2222 220d 0a20 2020 2063  ..    """..    c
-000155f0: 6f6e 7669 6e69 656e 6365 2066 756e 6374  onvinience funct
-00015600: 696f 6e20 746f 206d 616b 6520 616e 2065  ion to make an e
-00015610: 7272 6f72 2062 6172 2069 6e73 7461 6e63  rror bar instanc
-00015620: 650d 0a20 2020 200d 0a20 2020 2050 6172  e..    ..    Par
-00015630: 616d 6574 6572 730d 0a20 2020 202d 2d2d  ameters..    ---
-00015640: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 200d  ---------..    .
-00015650: 0a20 2020 2061 783a 206d 6174 706c 6f74  .    ax: matplot
-00015660: 6c69 622e 6178 6573 200d 0a20 2020 2020  lib.axes ..     
-00015670: 2020 2069 6e73 7461 6e63 6520 6178 6573     instance axes
-00015680: 2074 6f20 7075 7420 6572 726f 7220 6261   to put error ba
-00015690: 7220 706c 6f74 206f 6e0d 0a0d 0a20 2020  r plot on....   
-000156a0: 2078 5f61 7272 6179 3a20 6e70 2e6e 6461   x_array: np.nda
-000156b0: 7272 6179 286e 7829 0d0a 2020 2020 2020  rray(nx)..      
-000156c0: 2020 6172 7261 7920 6f66 2078 2076 616c    array of x val
-000156d0: 7565 7320 746f 2070 6c6f 740d 0a20 2020  ues to plot..   
-000156e0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
-000156f0: 0a20 2020 2079 5f61 7272 6179 3a20 6e70  .    y_array: np
+00013aa0: 2020 2020 6362 6d69 6e2c 0d0a 2020 2020      cbmin,..    
+00013ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ac0: 2020 2020 2020 2020 206e 756d 6265 725f           number_
+00013ad0: 6f66 5f74 6963 6b73 203d 2035 2c20 0d0a  of_ticks = 5, ..
+00013ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013af0: 2020 2020 2020 2020 2020 2020 206c 6f67               log
+00013b00: 7363 616c 653d 4661 6c73 6529 3a20 0d0a  scale=False): ..
+00013b10: 2020 2020 2222 220d 0a20 2020 2046 756e      """..    Fun
+00013b20: 6374 696f 6e20 746f 2072 6573 6574 2063  ction to reset c
+00013b30: 6f6c 6f72 6261 7220 7469 636b 7320 6d6f  olorbar ticks mo
+00013b40: 7265 2065 6173 7920 746f 2072 6561 6420  re easy to read 
+00013b50: 0d0a 2020 2020 0d0a 2020 2020 3a70 6172  ..    ..    :par
+00013b60: 616d 2063 626d 6178 3a20 7661 6c75 6520  am cbmax: value 
+00013b70: 6d61 7869 6d75 6d20 6f66 2063 6f6c 6f72  maximum of color
+00013b80: 6261 7220 0d0a 2020 2020 3a74 7970 6520  bar ..    :type 
+00013b90: 6362 6d61 783a 2066 6c6f 6174 200d 0a20  cbmax: float .. 
+00013ba0: 2020 200d 0a20 2020 203a 7061 7261 6d20     ..    :param 
+00013bb0: 6362 6d69 6e3a 206d 696e 696d 756d 2064  cbmin: minimum d
+00013bc0: 6174 6120 7661 6c75 6520 0d0a 2020 2020  ata value ..    
+00013bd0: 3a74 7970 6520 6362 6d69 6e3a 2066 6c6f  :type cbmin: flo
+00013be0: 6174 2020 6d69 6e69 6d75 6d20 6461 7461  at  minimum data
+00013bf0: 2076 616c 7565 0d0a 2020 2020 0d0a 2020   value..    ..  
+00013c00: 2020 3a70 6172 616d 206e 756d 6265 725f    :param number_
+00013c10: 6f66 5f74 6963 6b73 3a20 206e 756d 6265  of_ticks:  numbe
+00013c20: 7220 6f66 2074 6963 6b73 2073 686f 756c  r of ticks shoul
+00013c30: 6420 6265 200d 0a20 2020 2020 2020 2020  d be ..         
+00013c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c50: 2020 206c 6f63 6174 6564 206f 6e20 7468     located on th
+00013c60: 6520 636f 6c6f 7220 6261 7220 2e20 4465  e color bar . De
+00013c70: 6661 756c 7420 6973 2035 2e0d 0a20 2020  fault is 5...   
+00013c80: 203a 7479 7065 206e 756d 6265 725f 6f66   :type number_of
+00013c90: 5f74 6963 6b73 3a20 696e 7420 0d0a 2020  _ticks: int ..  
+00013ca0: 2020 0d0a 2020 2020 3a70 6172 616d 206c    ..    :param l
+00013cb0: 6f67 7363 616c 653a 2073 6574 2074 6f20  ogscale: set to 
+00013cc0: 5472 7565 2069 6620 796f 7572 2064 6174  True if your dat
+00013cd0: 6120 6172 6520 6c6f 6772 6169 7468 2064  a are lograith d
+00013ce0: 6174 6120 2e20 0d0a 2020 2020 3a74 7970  ata . ..    :typ
+00013cf0: 6520 6c6f 6773 6361 6c65 3a20 626f 6f6c  e logscale: bool
+00013d00: 200d 0a20 2020 200d 0a20 2020 203a 7265   ..    ..    :re
+00013d10: 7475 726e 733a 2061 7272 6179 206f 6620  turns: array of 
+00013d20: 636f 6c6f 7220 6261 7220 7469 636b 7320  color bar ticks 
+00013d30: 7661 6c75 652e 0d0a 2020 2020 3a72 7479  value...    :rty
+00013d40: 7065 3a20 6172 7261 795f 6c69 6b65 200d  pe: array_like .
+00013d50: 0a20 2020 2022 2222 0d0a 2020 2020 6465  .    """..    de
+00013d60: 6620 726f 756e 645f 6d6f 6475 6c6f 3130  f round_modulo10
+00013d70: 2876 616c 7565 293a 200d 0a20 2020 2020  (value): ..     
+00013d80: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00013d90: 726f 756e 6420 746f 206d 6f64 756c 6f20  round to modulo 
+00013da0: 3130 206f 7220 6c6f 6761 7269 7468 6d20  10 or logarithm 
+00013db0: 7363 616c 6520 202c 200d 0a20 2020 2020  scale  , ..     
+00013dc0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00013dd0: 6966 2076 616c 7565 2025 6d6f 6431 3020  if value %mod10 
+00013de0: 203d 3d20 3020 3a20 7265 7475 726e 2076   == 0 : return v
+00013df0: 616c 7565 200d 0a20 2020 2020 2020 2069  alue ..        i
+00013e00: 6620 7661 6c75 6520 256d 6f64 3130 2020  f value %mod10  
+00013e10: 213d 3020 3a20 0d0a 2020 2020 2020 2020  !=0 : ..        
+00013e20: 2020 2020 6966 2076 616c 7565 2025 286d      if value %(m
+00013e30: 6f64 3130 202f 3229 203d 3d30 203a 2072  od10 /2) ==0 : r
+00013e40: 6574 7572 6e20 7661 6c75 6520 0d0a 2020  eturn value ..  
+00013e50: 2020 2020 2020 2020 2020 656c 7365 203a            else :
+00013e60: 2072 6574 7572 6e20 2876 616c 7565 202d   return (value -
+00013e70: 2076 616c 7565 2025 6d6f 6431 3020 290d   value %mod10 ).
+00013e80: 0a20 2020 200d 0a20 2020 2069 6620 6e6f  .    ..    if no
+00013e90: 7428 6e75 6d62 6572 5f6f 665f 7469 636b  t(number_of_tick
+00013ea0: 732c 2028 666c 6f61 742c 2069 6e74 2929  s, (float, int))
+00013eb0: 3a20 0d0a 2020 2020 2020 2020 7472 7920  : ..        try 
+00013ec0: 3a20 6e75 6d62 6572 5f6f 665f 7469 636b  : number_of_tick
+00013ed0: 733d 696e 7428 6e75 6d62 6572 5f6f 665f  s=int(number_of_
+00013ee0: 7469 636b 7329 200d 0a20 2020 2020 2020  ticks) ..       
+00013ef0: 2065 7863 6570 7420 3a20 0d0a 2020 2020   except : ..    
+00013f00: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00013f10: 2e77 6172 6e28 2722 4e75 6d62 6572 5f6f  .warn('"Number_o
+00013f20: 665f 7469 636b 7322 2061 7267 756d 656e  f_ticks" argumen
+00013f30: 7473 2027 0d0a 2020 2020 2020 2020 2020  ts '..          
+00013f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f50: 2769 7320 7468 6520 7469 6d65 7320 746f  'is the times to
+00013f60: 2073 6565 2074 6865 2074 6963 6b73 206f   see the ticks o
+00013f70: 6e20 787c 7920 6178 6973 2e27 0d0a 2020  n x|y axis.'..  
+00013f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f90: 2020 2020 2020 2020 2720 4d75 7374 2062          ' Must b
+00013fa0: 6520 696e 7465 6765 7220 6e6f 7420 3c7b  e integer not <{
+00013fb0: 307d 3e2e 272e 666f 726d 6174 280d 0a20  0}>.'.format(.. 
+00013fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013fd0: 2020 2020 2020 2020 2020 2020 2074 7970               typ
+00013fe0: 6528 6e75 6d62 6572 5f6f 665f 7469 636b  e(number_of_tick
+00013ff0: 7329 2929 0d0a 2020 2020 2020 2020 2020  s)))..          
+00014000: 2020 7261 6973 6520 5469 7045 7272 6f72    raise TipError
+00014010: 2827 3c7b 307d 3e20 6465 7465 6374 6564  ('<{0}> detected
+00014020: 2e20 4d75 7374 2062 6520 696e 7465 6765  . Must be intege
+00014030: 722e 2729 0d0a 2020 2020 2020 2020 0d0a  r.')..        ..
+00014040: 2020 2020 6e75 6d62 6572 5f6f 665f 7469      number_of_ti
+00014050: 636b 733d 696e 7428 6e75 6d62 6572 5f6f  cks=int(number_o
+00014060: 665f 7469 636b 7329 0d0a 2020 2020 0d0a  f_ticks)..    ..
+00014070: 2020 2020 6966 206c 6f67 7363 616c 6520      if logscale 
+00014080: 6973 2054 7275 6520 3a20 206d 6f64 3130  is True :  mod10
+00014090: 203d 6e70 2e6c 6f67 3130 2831 3029 0d0a   =np.log10(10)..
+000140a0: 2020 2020 656c 7365 203a 6d6f 6431 3020      else :mod10 
+000140b0: 3d20 3130 200d 0a20 2020 2020 2020 0d0a  = 10 ..       ..
+000140c0: 2020 2020 6966 2063 626d 6178 2025 2063      if cbmax % c
+000140d0: 626d 696e 203d 3d20 3020 3a20 0d0a 2020  bmin == 0 : ..  
+000140e0: 2020 2020 2020 7265 7475 726e 206e 702e        return np.
+000140f0: 6c69 6e73 7061 6365 2863 626d 696e 2c20  linspace(cbmin, 
+00014100: 6362 6d61 7820 2c20 6e75 6d62 6572 5f6f  cbmax , number_o
+00014110: 665f 7469 636b 7329 0d0a 2020 2020 656c  f_ticks)..    el
+00014120: 6966 2063 626d 6178 2520 6362 6d69 6e20  if cbmax% cbmin 
+00014130: 213d 2030 203a 0d0a 2020 2020 2020 2020  != 0 :..        
+00014140: 7374 6172 7470 6f69 6e74 203d 2063 626d  startpoint = cbm
+00014150: 696e 202b 2028 6d6f 6431 3020 202d 2063  in + (mod10  - c
+00014160: 626d 696e 2025 206d 6f64 3130 2029 0d0a  bmin % mod10 )..
+00014170: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
+00014180: 203d 2063 626d 6178 202d 2063 626d 6178   = cbmax - cbmax
+00014190: 2025 206d 6f64 3130 2020 0d0a 2020 2020   % mod10  ..    
+000141a0: 2020 2020 7265 7475 726e 206e 702e 6172      return np.ar
+000141b0: 7261 7928 0d0a 2020 2020 2020 2020 2020  ray(..          
+000141c0: 2020 5b72 6f75 6e64 5f6d 6f64 756c 6f31    [round_modulo1
+000141d0: 3028 6969 2920 666f 7220 6969 2069 6e20  0(ii) for ii in 
+000141e0: 6e70 2e6c 696e 7370 6163 6528 0d0a 2020  np.linspace(..  
+000141f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014200: 2020 2020 2020 2020 2020 2073 7461 7274             start
+00014210: 706f 696e 742c 656e 6470 6f69 6e74 2c20  point,endpoint, 
+00014220: 6e75 6d62 6572 5f6f 665f 7469 636b 7329  number_of_ticks)
+00014230: 5d0d 0a20 2020 2020 2020 2020 2020 2029  ]..            )
+00014240: 0d0a 2020 2020 0d0a 0d0a 2020 2020 2020  ..    ....      
+00014250: 2020 2020 2020 0d0a 6465 6620 636f 6e74        ..def cont
+00014260: 726f 6c65 5f64 656c 696e 6561 7465 5f63  role_delineate_c
+00014270: 7572 7665 2872 6573 5f64 656c 696e 6520  urve(res_deline 
+00014280: 3d4e 6f6e 6520 2c20 7068 6173 655f 6465  =None , phase_de
+00014290: 6c69 6e65 203d 4e6f 6e65 2029 3a20 0d0a  line =None ): ..
+000142a0: 2020 2020 2222 220d 0a20 2020 2066 6f6e      """..    fon
+000142b0: 6374 696f 6e20 746f 2063 6f6e 7472 6f6c  ction to control
+000142c0: 6520 6465 6c69 6e65 6174 6520 7661 6c75  e delineate valu
+000142d0: 6520 6769 7665 6e20 2061 6e64 2072 6574  e given  and ret
+000142e0: 7572 6e20 7661 6c75 6520 6365 696c 6c69  urn value ceilli
+000142f0: 6e67 202e 0d0a 2020 2020 0d0a 2020 2020  ng ...    ..    
+00014300: 3a70 6172 616d 2020 7265 735f 6465 6c69  :param  res_deli
+00014310: 6e65 3a20 2072 6573 6973 7469 7669 7479  ne:  resistivity
+00014320: 2020 7661 6c75 6520 746f 6465 6c69 6e65    value todeline
+00014330: 6174 652e 2075 6e69 7420 6f66 2052 6573  ate. unit of Res
+00014340: 2069 6e20 606f 686d 2e6d 600d 0a20 2020   in `ohm.m`..   
+00014350: 203a 7479 7065 2020 7265 735f 6465 6c69   :type  res_deli
+00014360: 6e65 3a20 666c 6f61 747c 696e 747c 6c69  ne: float|int|li
+00014370: 7374 2020 0d0a 2020 2020 0d0a 2020 2020  st  ..    ..    
+00014380: 3a70 6172 616d 2020 7068 6173 655f 6465  :param  phase_de
+00014390: 6c69 6e65 3a20 2020 7068 6173 6520 7661  line:   phase va
+000143a0: 6c75 6520 746f 2020 6465 6c69 6e65 6174  lue to  delineat
+000143b0: 6520 2c20 756e 6974 206f 6620 7068 6173  e , unit of phas
+000143c0: 6520 696e 2064 6567 7265 650d 0a20 2020  e in degree..   
+000143d0: 203a 7479 7065 2070 6861 7365 5f64 656c   :type phase_del
+000143e0: 696e 653a 2066 6c6f 6174 7c69 6e74 7c6c  ine: float|int|l
+000143f0: 6973 7420 200d 0a20 2020 200d 0a20 2020  ist  ..    ..   
+00014400: 203a 7265 7475 726e 733a 2064 656c 696e   :returns: delin
+00014410: 6561 7465 2072 6573 6973 7469 7669 7479  eate resistivity
+00014420: 206f 7220 7068 6173 6520 7661 6c75 6573   or phase values
+00014430: 200d 0a20 2020 203a 7274 7970 653a 2061   ..    :rtype: a
+00014440: 7272 6179 5f6c 696b 6520 0d0a 2020 2020  rray_like ..    
+00014450: 2222 220d 0a20 2020 2066 6d74 3d5b 2772  """..    fmt=['r
+00014460: 6573 6973 7469 7669 7479 2c20 7068 6173  esistivity, phas
+00014470: 6527 5d0d 0a20 0d0a 2020 2020 666f 7220  e'].. ..    for 
+00014480: 6969 2c20 7878 5f64 656c 696e 6520 696e  ii, xx_deline in
+00014490: 2065 6e75 6d65 7261 7465 285b 7265 735f   enumerate([res_
+000144a0: 6465 6c69 6e65 202c 2070 6861 7365 5f64  deline , phase_d
+000144b0: 656c 696e 655d 293a 200d 0a20 2020 2020  eline]): ..     
+000144c0: 2020 2069 6620 7878 5f64 656c 696e 6520     if xx_deline 
+000144d0: 6973 2020 6e6f 7420 4e6f 6e65 2020 3a20  is  not None  : 
+000144e0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000144f0: 2069 7369 6e73 7461 6e63 6528 7878 5f64   isinstance(xx_d
+00014500: 656c 696e 652c 2028 666c 6f61 742c 2069  eline, (float, i
+00014510: 6e74 2c20 7374 7229 293a 0d0a 2020 2020  nt, str)):..    
+00014520: 2020 2020 2020 2020 2020 2020 7472 7920              try 
+00014530: 3a78 785f 6465 6c69 6e65 3d20 666c 6f61  :xx_deline= floa
+00014540: 7428 7878 5f64 656c 696e 6529 0d0a 2020  t(xx_deline)..  
+00014550: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00014560: 6365 7074 203a 2072 6169 7365 2054 6970  cept : raise Tip
+00014570: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+00014580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014590: 2756 616c 7565 203c 7b30 7d3e 2074 6f20  'Value <{0}> to 
+000145a0: 6465 6c69 6e65 6174 6520 3c7b 317d 3e20  delineate <{1}> 
+000145b0: 6973 2075 6e61 6363 6570 7461 626c 652e  is unacceptable.
+000145c0: 275c 0d0a 2020 2020 2020 2020 2020 2020  '\..            
+000145d0: 2020 2020 2020 2020 2020 2020 2027 2050               ' P
+000145e0: 6c65 6173 6520 636b 6563 6b20 796f 7572  lease ckeck your
+000145f0: 2076 616c 7565 2e27 2e66 6f72 6d61 7428   value.'.format(
+00014600: 7878 5f64 656c 696e 652c 2066 6d74 5b69  xx_deline, fmt[i
+00014610: 695d 2929 0d0a 2020 2020 2020 2020 2020  i]))..          
+00014620: 2020 2020 2020 656c 7365 203a 0d0a 2020        else :..  
+00014630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014640: 2020 6966 2069 6920 3d3d 3020 3a20 7265    if ii ==0 : re
+00014650: 7475 726e 205b 6e70 2e63 6569 6c28 6e70  turn [np.ceil(np
+00014660: 2e6c 6f67 3130 2878 785f 6465 6c69 6e65  .log10(xx_deline
+00014670: 2929 5d0d 0a20 2020 2020 2020 2020 2020  ))]..           
+00014680: 2020 2020 2020 2020 2069 6620 6969 203d           if ii =
+00014690: 3d31 203a 2072 6574 7572 6e20 5b6e 702e  =1 : return [np.
+000146a0: 6365 696c 2878 785f 6465 6c69 6e65 295d  ceil(xx_deline)]
+000146b0: 0d0a 2020 0d0a 2020 2020 2020 2020 2020  ..  ..          
+000146c0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+000146d0: 7878 5f64 656c 696e 6520 2c20 286c 6973  xx_deline , (lis
+000146e0: 742c 2074 7570 6c65 2c20 6e70 2e6e 6461  t, tuple, np.nda
+000146f0: 7272 6179 2929 3a0d 0a20 2020 2020 2020  rray)):..       
+00014700: 2020 2020 2020 2020 2078 785f 6465 6c69           xx_deli
+00014710: 6e65 203d 6c69 7374 2878 785f 6465 6c69  ne =list(xx_deli
+00014720: 6e65 290d 0a20 2020 2020 2020 2020 2020  ne)..           
+00014730: 2020 2020 2074 7279 203a 0d0a 2020 2020       try :..    
+00014740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014750: 6966 2069 6920 3d3d 2030 203a 2078 785f  if ii == 0 : xx_
+00014760: 6465 6c69 6e65 203d 205b 0d0a 2020 2020  deline = [..    
+00014770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014780: 2020 2020 2020 2020 6e70 2e63 6569 6c28          np.ceil(
+00014790: 6e70 2e6c 6f67 3130 2866 6c6f 6174 2878  np.log10(float(x
+000147a0: 7829 2929 2066 6f72 2078 7820 696e 2078  x))) for xx in x
+000147b0: 785f 6465 6c69 6e65 5d0d 0a20 2020 2020  x_deline]..     
+000147c0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000147d0: 6c69 6620 2069 6920 3d3d 3120 3a20 7878  lif  ii ==1 : xx
+000147e0: 5f64 656c 696e 6520 3d20 5b0d 0a20 2020  _deline = [..   
+000147f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014800: 2020 2020 2020 2020 206e 702e 6365 696c           np.ceil
+00014810: 2866 6c6f 6174 2878 7829 2920 666f 7220  (float(xx)) for 
+00014820: 7878 2069 6e20 7878 5f64 656c 696e 655d  xx in xx_deline]
+00014830: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014840: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00014850: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00014860: 7074 203a 2072 6169 7365 2054 6970 4572  pt : raise TipEr
+00014870: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
+00014880: 2020 2020 2020 2020 2020 2020 2020 2756                'V
+00014890: 616c 7565 2074 6f20 6465 6c69 6e65 6174  alue to delineat
+000148a0: 6520 3c7b 307d 3e20 6973 2075 6e61 6363  e <{0}> is unacc
+000148b0: 6570 7461 626c 652e 275c 0d0a 2020 2020  eptable.'\..    
+000148c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000148d0: 2020 2020 2027 2050 6c65 6173 6520 636b       ' Please ck
+000148e0: 6563 6b20 796f 7572 2076 616c 7565 2e27  eck your value.'
+000148f0: 2e66 6f72 6d61 7428 666d 745b 6969 5d29  .format(fmt[ii])
+00014900: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00014910: 2020 2065 6c73 6520 3a20 7265 7475 726e     else : return
+00014920: 2078 785f 6465 6c69 6e65 0d0a 0d0a 0d0a   xx_deline......
+00014930: 6465 6620 666d 745f 7465 7874 2028 6461  def fmt_text (da
+00014940: 7461 5f74 6578 742c 2066 6d74 3d27 7e27  ta_text, fmt='~'
+00014950: 2c20 6c65 6674 7370 6163 6520 3d20 332c  , leftspace = 3,
+00014960: 2072 6574 7572 6e5f 746f 5f6c 696e 6520   return_to_line 
+00014970: 3d37 3729 203a 200d 0a20 2020 2022 2222  =77) : ..    """
+00014980: 0d0a 2020 2020 416c 6c6f 7720 746f 2066  ..    Allow to f
+00014990: 6f72 6d61 7420 7265 706f 7274 2077 6974  ormat report wit
+000149a0: 6820 6461 7461 2074 6578 7420 2c20 666d  h data text , fm
+000149b0: 2061 6e64 206c 6566 7473 7061 6365 200d   and leftspace .
+000149c0: 0a0d 0a20 2020 203a 7061 7261 6d20 2064  ...    :param  d
+000149d0: 6174 615f 7465 7874 3a20 6120 6c6f 6e67  ata_text: a long
+000149e0: 2074 6578 7420 0d0a 2020 2020 3a74 7970   text ..    :typ
+000149f0: 6520 2064 6174 615f 7465 7874 3a20 7374  e  data_text: st
+00014a00: 7220 200d 0a20 2020 2020 2020 200d 0a20  r  ..        .. 
+00014a10: 2020 203a 7061 7261 6d20 666d 743a 2020     :param fmt:  
+00014a20: 7479 7065 206f 6620 756e 6465 726c 696e  type of underlin
+00014a30: 6520 7465 7874 200d 0a20 2020 203a 7479  e text ..    :ty
+00014a40: 7065 2066 6d74 3a20 7374 720d 0a0d 0a20  pe fmt: str.... 
+00014a50: 2020 203a 7061 7261 6d20 6c65 6674 7370     :param leftsp
+00014a60: 6165 3a20 486f 7720 6d61 6e79 2073 7061  ae: How many spa
+00014a70: 6365 2064 6f20 796f 7520 7761 6e74 2062  ce do you want b
+00014a80: 6566 6f72 6520 7374 6172 7469 6e67 2077  efore starting w
+00014a90: 7269 6e74 696e 6720 7265 706f 7274 202e  rinting report .
+00014aa0: 0d0a 2020 2020 3a74 7970 6520 6c65 6674  ..    :type left
+00014ab0: 7370 6165 3a20 696e 7420 0d0a 2020 2020  spae: int ..    
+00014ac0: 0d0a 2020 2020 3a70 6172 616d 2072 6574  ..    :param ret
+00014ad0: 7572 6e5f 746f 5f6c 696e 653a 206e 756d  urn_to_line: num
+00014ae0: 6265 7220 6f66 2063 6861 7261 6374 6572  ber of character
+00014af0: 2074 6f20 7265 7475 726e 2074 6f20 6c69   to return to li
+00014b00: 6e65 0d0a 2020 2020 3a74 7970 6520 7265  ne..    :type re
+00014b10: 7475 726e 5f74 6f5f 6c69 6e65 3a20 696e  turn_to_line: in
+00014b20: 7420 0d0a 2020 2020 2222 220d 0a0d 0a20  t ..    """.... 
+00014b30: 2020 2072 6574 7572 6e5f 746f 5f6c 696e     return_to_lin
+00014b40: 653d 2069 6e74 2872 6574 7572 6e5f 746f  e= int(return_to
+00014b50: 5f6c 696e 6529 0d0a 2020 2020 6265 6769  _line)..    begi
+00014b60: 6e5f 7465 7874 3d20 6c65 6674 7370 6163  n_text= leftspac
+00014b70: 6520 2a27 2027 0d0a 2020 2020 7465 7874  e *' '..    text
+00014b80: 3d20 6265 6769 6e5f 7465 7874 202b 2066  = begin_text + f
+00014b90: 6d74 2a28 7265 7475 726e 5f74 6f5f 6c69  mt*(return_to_li
+00014ba0: 6e65 202b 3729 202b 2027 5c6e 272b 2062  ne +7) + '\n'+ b
+00014bb0: 6567 696e 5f74 6578 740d 0a0d 0a20 2020  egin_text....   
+00014bc0: 200d 0a20 2020 2073 733d 300d 0a20 2020   ..    ss=0..   
+00014bd0: 200d 0a20 2020 2066 6f72 2020 6969 2c20   ..    for  ii, 
+00014be0: 6e75 6d20 696e 2065 6e75 6d65 7261 7465  num in enumerate
+00014bf0: 2864 6174 615f 7465 7874 2920 3a20 2320  (data_text) : # 
+00014c00: 6c6f 6f70 2074 6865 2074 6578 7420 0d0a  loop the text ..
+00014c10: 2020 2020 2020 2020 6966 2069 6920 3d3d          if ii ==
+00014c20: 206c 656e 2864 6174 615f 7465 7874 292d   len(data_text)-
+00014c30: 3120 3a20 2020 2020 2020 2020 2023 2069  1 :          # i
+00014c40: 6620 6669 6e64 2074 6865 206c 6173 7420  f find the last 
+00014c50: 6368 6172 6163 7465 7220 6f66 2074 6578  character of tex
+00014c60: 7420 0d0a 2020 2020 2020 2020 2020 2020  t ..            
+00014c70: 2374 6578 7420 3d20 7465 7874 202b 2064  #text = text + d
+00014c80: 6174 615f 7465 7874 5b73 733a 5d20 2b20  ata_text[ss:] + 
+00014c90: 2720 7b30 7d5c 6e27 2e66 6f72 6d61 7428  ' {0}\n'.format(
+00014ca0: 666d 7429 2023 2074 616b 6520 7468 6520  fmt) # take the 
+00014cb0: 0d0a 2020 2020 2020 2020 2020 2020 2372  ..            #r
+00014cc0: 656d 6169 6e20 616e 6420 6164 6420 7265  emain and add re
+00014cd0: 7475 726e 2063 6861 7269 6f74 200d 0a20  turn chariot .. 
+00014ce0: 2020 2020 2020 2020 2020 2074 6578 7420             text 
+00014cf0: 3d20 7465 7874 2b20 2720 7b30 7d5c 6e27  = text+ ' {0}\n'
+00014d00: 2e66 6f72 6d61 7428 666d 7429 202b 5c0d  .format(fmt) +\.
+00014d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014d20: 2062 6567 696e 5f74 6578 7420 2b66 6d74   begin_text +fmt
+00014d30: 2a28 7265 7475 726e 5f74 6f5f 6c69 6e65  *(return_to_line
+00014d40: 2b37 2920 2b27 5c6e 2720 0d0a 2020 2020  +7) +'\n' ..    
+00014d50: 2020 0d0a 200d 0a20 2020 2020 2020 2020    .. ..         
+00014d60: 2020 2062 7265 616b 200d 0a20 2020 2020     break ..     
+00014d70: 2020 2069 6620 7373 203d 3d20 7265 7475     if ss == retu
+00014d80: 726e 5f74 6f5f 6c69 6e65 203a 2020 2020  rn_to_line :    
+00014d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014da0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00014db0: 2069 6620 6461 7461 5f74 6578 745b 6969   if data_text[ii
+00014dc0: 2b31 5d20 213d 2720 2720 3a20 0d0a 2020  +1] !=' ' : ..  
+00014dd0: 2020 2020 2020 2020 2020 2020 2020 7465                te
+00014de0: 7874 203d 2027 7b30 7d20 7b31 7d2d 205c  xt = '{0} {1}- \
+00014df0: 6e20 7b32 7d20 272e 666f 726d 6174 280d  n {2} '.format(.
+00014e00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014e10: 2020 2020 2074 6578 742c 2066 6d74 2c20       text, fmt, 
+00014e20: 6265 6769 6e5f 7465 7874 202b 2066 6d74  begin_text + fmt
+00014e30: 2029 200d 0a20 2020 2020 2020 2020 2020   ) ..           
+00014e40: 2065 6c73 6520 3a20 0d0a 2020 2020 2020   else : ..      
+00014e50: 2020 2020 2020 2020 2020 7465 7874 203d            text =
+00014e60: 277b 307d 207b 317d 205c 6e20 7b32 7d20  '{0} {1} \n {2} 
+00014e70: 272e 666f 726d 6174 280d 0a20 2020 2020  '.format(..     
+00014e80: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00014e90: 6578 742c 2066 6d74 2c20 6265 6769 6e5f  ext, fmt, begin_
+00014ea0: 7465 7874 2b66 6d74 2029 200d 0a20 2020  text+fmt ) ..   
+00014eb0: 2020 2020 2020 2020 2073 733d 300d 0a20           ss=0.. 
+00014ec0: 2020 2020 2020 2074 6578 7420 2b3d 206e         text += n
+00014ed0: 756d 2020 2020 2320 6164 6420 6368 6172  um    # add char
+00014ee0: 6174 6563 7465 7220 200d 0a20 2020 2020  atecter  ..     
+00014ef0: 2020 2073 7320 2b3d 310d 0a0d 0a20 2020     ss +=1....   
+00014f00: 2072 6574 7572 6e20 7465 7874 200d 0a0d   return text ...
+00014f10: 0a64 6566 2070 6c6f 7476 6563 3128 752c  .def plotvec1(u,
+00014f20: 207a 2c20 7629 3a0d 0a20 2020 2022 2222   z, v):..    """
+00014f30: 0d0a 2020 2020 506c 6f74 2074 6970 7320  ..    Plot tips 
+00014f40: 6675 6e63 7469 6f6e 2077 6974 6820 2074  function with  t
+00014f50: 6872 6565 2076 6563 746f 7273 2e20 0d0a  hree vectors. ..
+00014f60: 2020 2020 0d0a 2020 2020 3a70 6172 616d      ..    :param
+00014f70: 2075 3a20 7665 6374 6f72 2075 202d 2061   u: vector u - a
+00014f80: 2076 6563 746f 7220 0d0a 2020 2020 3a74   vector ..    :t
+00014f90: 7970 6520 753a 2061 7272 6179 206c 696b  ype u: array lik
+00014fa0: 6520 200d 0a20 2020 200d 0a20 2020 203a  e  ..    ..    :
+00014fb0: 7061 7261 6d20 7a3a 2076 6563 746f 7220  param z: vector 
+00014fc0: 7a20 0d0a 2020 2020 3a74 7970 6520 7a3a  z ..    :type z:
+00014fd0: 2061 7272 6179 5f6c 696b 6520 0d0a 2020   array_like ..  
+00014fe0: 2020 0d0a 2020 2020 3a70 6172 616d 2076    ..    :param v
+00014ff0: 3a20 7665 6374 6f72 2076 200d 0a20 2020  : vector v ..   
+00015000: 203a 7479 7065 2076 3a20 6172 7261 795f   :type v: array_
+00015010: 6c69 6b65 200d 0a20 2020 200d 0a20 2020  like ..    ..   
+00015020: 2072 6574 7572 6e3a 2070 6c6f 7420 0d0a   return: plot ..
+00015030: 2020 2020 0d0a 2020 2020 2222 220d 0a20      ..    """.. 
+00015040: 2020 200d 0a20 2020 2061 7820 3d20 706c     ..    ax = pl
+00015050: 742e 6178 6573 2829 0d0a 2020 2020 6178  t.axes()..    ax
+00015060: 2e61 7272 6f77 2830 2c20 302c 202a 752c  .arrow(0, 0, *u,
+00015070: 2068 6561 645f 7769 6474 683d 302e 3035   head_width=0.05
+00015080: 2c20 636f 6c6f 723d 2772 272c 2068 6561  , color='r', hea
+00015090: 645f 6c65 6e67 7468 3d30 2e31 290d 0a20  d_length=0.1).. 
+000150a0: 2020 2070 6c74 2e74 6578 7428 2a28 7520     plt.text(*(u 
+000150b0: 2b20 302e 3129 2c20 2775 2729 0d0a 2020  + 0.1), 'u')..  
+000150c0: 2020 0d0a 2020 2020 6178 2e61 7272 6f77    ..    ax.arrow
+000150d0: 2830 2c20 302c 202a 762c 2068 6561 645f  (0, 0, *v, head_
+000150e0: 7769 6474 683d 302e 3035 2c20 636f 6c6f  width=0.05, colo
+000150f0: 723d 2762 272c 2068 6561 645f 6c65 6e67  r='b', head_leng
+00015100: 7468 3d30 2e31 290d 0a20 2020 2070 6c74  th=0.1)..    plt
+00015110: 2e74 6578 7428 2a28 7620 2b20 302e 3129  .text(*(v + 0.1)
+00015120: 2c20 2776 2729 0d0a 2020 2020 6178 2e61  , 'v')..    ax.a
+00015130: 7272 6f77 2830 2c20 302c 202a 7a2c 2068  rrow(0, 0, *z, h
+00015140: 6561 645f 7769 6474 683d 302e 3035 2c20  ead_width=0.05, 
+00015150: 6865 6164 5f6c 656e 6774 683d 302e 3129  head_length=0.1)
+00015160: 0d0a 2020 2020 706c 742e 7465 7874 282a  ..    plt.text(*
+00015170: 287a 202b 2030 2e31 292c 2027 7a27 290d  (z + 0.1), 'z').
+00015180: 0a20 2020 2070 6c74 2e79 6c69 6d28 2d32  .    plt.ylim(-2
+00015190: 2c20 3229 0d0a 2020 2020 706c 742e 786c  , 2)..    plt.xl
+000151a0: 696d 282d 322c 2032 290d 0a0d 0a64 6566  im(-2, 2)....def
+000151b0: 2070 6c6f 7476 6563 3228 612c 6229 3a0d   plotvec2(a,b):.
+000151c0: 0a20 2020 2022 2222 0d0a 2020 2020 506c  .    """..    Pl
+000151d0: 6f74 2074 6970 7320 6675 6e63 7469 6f6e  ot tips function
+000151e0: 2077 6974 6820 7477 6f20 7665 6374 6f72   with two vector
+000151f0: 730d 0a20 2020 204a 7573 7420 7573 6520  s..    Just use 
+00015200: 746f 2067 6574 2074 6865 206f 7274 686f  to get the ortho
+00015210: 676f 6e61 6c69 7479 206f 6620 7477 6f20  gonality of two 
+00015220: 7665 6374 6f72 2066 6f72 206f 7468 6572  vector for other
+00015230: 2070 7572 706f 7365 7320 0d0a 0d0a 2020   purposes ....  
+00015240: 2020 3a70 6172 616d 2061 3a20 7665 6374    :param a: vect
+00015250: 6f72 2075 200d 0a20 2020 203a 7479 7065  or u ..    :type
+00015260: 2061 3a20 6172 7261 7920 6c69 6b65 2020   a: array like  
+00015270: 2d20 6120 7665 6374 6f72 200d 0a20 2020  - a vector ..   
+00015280: 203a 7061 7261 6d20 623a 2076 6563 746f   :param b: vecto
+00015290: 7220 7a20 0d0a 2020 2020 3a74 7970 6520  r z ..    :type 
+000152a0: 623a 2061 7272 6179 5f6c 696b 6520 0d0a  b: array_like ..
+000152b0: 2020 2020 0d0a 2020 2020 2a20 2057 7269      ..    *  Wri
+000152c0: 7465 2079 6f75 7220 636f 6465 2062 656c  te your code bel
+000152d0: 6f77 2061 6e64 2070 7265 7373 2053 6869  ow and press Shi
+000152e0: 6674 2b45 6e74 6572 2074 6f20 6578 6563  ft+Enter to exec
+000152f0: 7574 650d 0a20 2020 200d 0a20 2020 203a  ute..    ..    :
+00015300: 4578 616d 706c 653a 200d 0a20 2020 2020  Example: ..     
+00015310: 2020 200d 0a20 2020 2020 2020 203e 3e3e     ..        >>>
+00015320: 2069 6d70 6f72 7420 6e75 6d70 7920 6173   import numpy as
+00015330: 206e 7020 0d0a 2020 2020 2020 2020 3e3e   np ..        >>
+00015340: 3e20 6672 6f6d 2077 6174 6578 2e75 7469  > from watex.uti
+00015350: 6c73 2e70 6c6f 7475 7469 6c73 2069 6d70  ls.plotutils imp
+00015360: 6f72 7420 706c 6f74 7665 6332 0d0a 2020  ort plotvec2..  
+00015370: 2020 2020 2020 3e3e 3e20 613d 6e70 2e61        >>> a=np.a
+00015380: 7272 6179 285b 312c 305d 290d 0a20 2020  rray([1,0])..   
+00015390: 2020 2020 203e 3e3e 2062 3d6e 702e 6172       >>> b=np.ar
+000153a0: 7261 7928 5b30 2c31 5d29 0d0a 2020 2020  ray([0,1])..    
+000153b0: 2020 2020 3e3e 3e20 506c 6f74 7665 6332      >>> Plotvec2
+000153c0: 2861 2c62 290d 0a20 2020 2020 2020 203e  (a,b)..        >
+000153d0: 3e3e 2070 7269 6e74 2827 7468 6520 7072  >> print('the pr
+000153e0: 6f64 7563 7420 6120 746f 2062 2069 7320  oduct a to b is 
+000153f0: 3d27 2c20 6e70 2e64 6f74 2861 2c62 2929  =', np.dot(a,b))
+00015400: 0d0a 0d0a 2020 2020 2222 220d 0a20 2020  ....    """..   
+00015410: 2061 7820 3d20 706c 742e 6178 6573 2829   ax = plt.axes()
+00015420: 0d0a 2020 2020 6178 2e61 7272 6f77 2830  ..    ax.arrow(0
+00015430: 2c20 302c 202a 612c 2068 6561 645f 7769  , 0, *a, head_wi
+00015440: 6474 683d 302e 3035 2c20 636f 6c6f 7220  dth=0.05, color 
+00015450: 3d27 7227 2c20 6865 6164 5f6c 656e 6774  ='r', head_lengt
+00015460: 683d 302e 3129 0d0a 2020 2020 706c 742e  h=0.1)..    plt.
+00015470: 7465 7874 282a 2861 202b 2030 2e31 292c  text(*(a + 0.1),
+00015480: 2027 6127 290d 0a20 2020 2061 782e 6172   'a')..    ax.ar
+00015490: 726f 7728 302c 2030 2c20 2a62 2c20 6865  row(0, 0, *b, he
+000154a0: 6164 5f77 6964 7468 3d30 2e30 352c 2063  ad_width=0.05, c
+000154b0: 6f6c 6f72 203d 2762 272c 2068 6561 645f  olor ='b', head_
+000154c0: 6c65 6e67 7468 3d30 2e31 290d 0a20 2020  length=0.1)..   
+000154d0: 2070 6c74 2e74 6578 7428 2a28 6220 2b20   plt.text(*(b + 
+000154e0: 302e 3129 2c20 2762 2729 0d0a 2020 2020  0.1), 'b')..    
+000154f0: 706c 742e 796c 696d 282d 322c 2032 290d  plt.ylim(-2, 2).
+00015500: 0a20 2020 2070 6c74 2e78 6c69 6d28 2d32  .    plt.xlim(-2
+00015510: 2c20 3229 2020 0d0a 0d0a 6465 6620 706c  , 2)  ....def pl
+00015520: 6f74 5f65 7272 6f72 6261 7228 0d0a 2020  ot_errorbar(..  
+00015530: 2020 2020 2020 6178 2c0d 0a20 2020 2020        ax,..     
+00015540: 2020 2078 5f61 722c 0d0a 2020 2020 2020     x_ar,..      
+00015550: 2020 795f 6172 2c0d 0a20 2020 2020 2020    y_ar,..       
+00015560: 2079 5f65 7272 3d4e 6f6e 652c 0d0a 2020   y_err=None,..  
+00015570: 2020 2020 2020 785f 6572 723d 4e6f 6e65        x_err=None
+00015580: 2c0d 0a20 2020 2020 2020 2063 6f6c 6f72  ,..        color
+00015590: 3d27 6b27 2c0d 0a20 2020 2020 2020 206d  ='k',..        m
+000155a0: 6172 6b65 723d 2778 272c 0d0a 2020 2020  arker='x',..    
+000155b0: 2020 2020 6d73 3d32 2c20 0d0a 2020 2020      ms=2, ..    
+000155c0: 2020 2020 6c73 3d27 3a27 2c20 0d0a 2020      ls=':', ..  
+000155d0: 2020 2020 2020 6c77 3d31 2c20 0d0a 2020        lw=1, ..  
+000155e0: 2020 2020 2020 655f 6361 7073 697a 653d        e_capsize=
+000155f0: 322c 0d0a 2020 2020 2020 2020 655f 6361  2,..        e_ca
+00015600: 7074 6869 636b 3d2e 352c 0d0a 2020 2020  pthick=.5,..    
+00015610: 2020 2020 7069 636b 6572 3d4e 6f6e 652c      picker=None,
+00015620: 0d0a 2020 2020 2020 2020 2a2a 6b77 730d  ..        **kws.
+00015630: 0a20 293a 0d0a 2020 2020 2222 220d 0a20  . ):..    """.. 
+00015640: 2020 2063 6f6e 7669 6e69 656e 6365 2066     convinience f
+00015650: 756e 6374 696f 6e20 746f 206d 616b 6520  unction to make 
+00015660: 616e 2065 7272 6f72 2062 6172 2069 6e73  an error bar ins
+00015670: 7461 6e63 650d 0a20 2020 200d 0a20 2020  tance..    ..   
+00015680: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00015690: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20   ------------.. 
+000156a0: 2020 200d 0a20 2020 2061 783a 206d 6174     ..    ax: mat
+000156b0: 706c 6f74 6c69 622e 6178 6573 200d 0a20  plotlib.axes .. 
+000156c0: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
+000156d0: 6178 6573 2074 6f20 7075 7420 6572 726f  axes to put erro
+000156e0: 7220 6261 7220 706c 6f74 206f 6e0d 0a0d  r bar plot on...
+000156f0: 0a20 2020 2078 5f61 7272 6179 3a20 6e70  .    x_array: np
 00015700: 2e6e 6461 7272 6179 286e 7829 0d0a 2020  .ndarray(nx)..  
-00015710: 2020 2020 2020 6172 7261 7920 6f66 2079        array of y
+00015710: 2020 2020 2020 6172 7261 7920 6f66 2078        array of x
 00015720: 2076 616c 7565 7320 746f 2070 6c6f 740d   values to plot.
 00015730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015740: 2020 200d 0a20 2020 2079 5f65 7272 6f72     ..    y_error
+00015740: 2020 200d 0a20 2020 2079 5f61 7272 6179     ..    y_array
 00015750: 3a20 6e70 2e6e 6461 7272 6179 286e 7829  : np.ndarray(nx)
 00015760: 0d0a 2020 2020 2020 2020 6172 7261 7920  ..        array 
-00015770: 6f66 2065 7272 6f72 7320 696e 2079 2d64  of errors in y-d
-00015780: 6972 6563 7469 6f6e 2074 6f20 706c 6f74  irection to plot
-00015790: 0d0a 2020 2020 0d0a 2020 2020 785f 6572  ..    ..    x_er
-000157a0: 726f 723a 206e 702e 6e64 6172 7261 7928  ror: np.ndarray(
-000157b0: 6e73 290d 0a20 2020 2020 2020 2061 7272  ns)..        arr
-000157c0: 6179 206f 6620 6572 726f 7220 696e 2078  ay of error in x
-000157d0: 2d64 6972 6563 7469 6f6e 2074 6f20 706c  -direction to pl
-000157e0: 6f74 0d0a 2020 2020 2020 2020 2020 2020  ot..            
-000157f0: 2020 2020 2020 0d0a 2020 2020 636f 6c6f        ..    colo
-00015800: 723a 2073 7472 696e 6720 6f72 2028 722c  r: string or (r,
-00015810: 2067 2c20 6229 0d0a 2020 2020 2020 2020   g, b)..        
-00015820: 636f 6c6f 7220 6f66 206d 6172 6b65 722c  color of marker,
-00015830: 206c 696e 6520 616e 6420 6572 726f 7220   line and error 
-00015840: 6261 720d 0a20 2020 2020 2020 2020 2020  bar..           
-00015850: 2020 2020 200d 0a20 2020 206d 6172 6b65       ..    marke
-00015860: 723a 2073 7472 696e 670d 0a20 2020 2020  r: string..     
-00015870: 2020 206d 6172 6b65 7220 7479 7065 2074     marker type t
-00015880: 6f20 706c 6f74 2064 6174 6120 6173 0d0a  o plot data as..
-00015890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000158a0: 200d 0a20 2020 206d 733a 2066 6c6f 6174   ..    ms: float
-000158b0: 0d0a 2020 2020 2020 2020 7369 7a65 206f  ..        size o
-000158c0: 6620 6d61 726b 6572 0d0a 2020 2020 2020  f marker..      
-000158d0: 2020 2020 2020 200d 0a20 2020 206c 733a         ..    ls:
-000158e0: 2073 7472 696e 670d 0a20 2020 2020 2020   string..       
-000158f0: 206c 696e 6520 7374 796c 6520 6265 7477   line style betw
-00015900: 6565 6e20 6d61 726b 6572 730d 0a20 2020  een markers..   
-00015910: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00015920: 6c77 3a20 666c 6f61 740d 0a20 2020 2020  lw: float..     
-00015930: 2020 2077 6964 7468 206f 6620 6c69 6e65     width of line
-00015940: 2062 6574 7765 656e 206d 6172 6b65 7273   between markers
-00015950: 0d0a 2020 2020 0d0a 2020 2020 655f 6361  ..    ..    e_ca
-00015960: 7073 697a 653a 2066 6c6f 6174 0d0a 2020  psize: float..  
-00015970: 2020 2020 2020 7369 7a65 206f 6620 6572        size of er
-00015980: 726f 7220 6261 7220 6361 700d 0a20 2020  ror bar cap..   
-00015990: 200d 0a20 2020 2065 5f63 6170 7468 6963   ..    e_capthic
-000159a0: 6b3a 2066 6c6f 6174 0d0a 2020 2020 2020  k: float..      
-000159b0: 2020 7468 6963 6b6e 6573 7320 6f66 2065    thickness of e
-000159c0: 7272 6f72 2062 6172 2063 6170 0d0a 2020  rror bar cap..  
-000159d0: 2020 0d0a 2020 2020 7069 636b 6572 3a20    ..    picker: 
-000159e0: 666c 6f61 740d 0a20 2020 2020 2020 2020  float..         
-000159f0: 2072 6164 6975 7320 696e 2070 6f69 6e74   radius in point
-00015a00: 7320 746f 2062 6520 6162 6c65 2074 6f20  s to be able to 
-00015a10: 7069 636b 2061 2070 6f69 6e74 2e20 0d0a  pick a point. ..
-00015a20: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00015a30: 2020 0d0a 2020 2020 5265 7475 726e 733a    ..    Returns:
-00015a40: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0d  ..    ---------.
-00015a50: 0a20 2020 2065 7272 6f72 6261 725f 6f62  .    errorbar_ob
-00015a60: 6a65 6374 3a20 6d61 7470 6c6f 746c 6962  ject: matplotlib
-00015a70: 2e41 7865 732e 6572 726f 7262 6172 200d  .Axes.errorbar .
-00015a80: 0a20 2020 2020 2020 2020 2020 6572 726f  .           erro
-00015a90: 7220 6261 7220 6f62 6a65 6374 2063 6f6e  r bar object con
-00015aa0: 7461 696e 696e 6720 6c69 6e65 2064 6174  taining line dat
-00015ab0: 612c 2065 7272 6f72 6261 7273 2c20 6574  a, errorbars, et
-00015ac0: 632e 0d0a 2020 2020 2222 220d 0a20 2020  c...    """..   
-00015ad0: 2023 2074 6869 7320 6973 2074 6f20 6d61   # this is to ma
-00015ae0: 6b65 2073 7572 6520 6572 726f 7220 6261  ke sure error ba
-00015af0: 7273 200d 0a20 2020 2023 706c 6f74 2069  rs ..    #plot i
-00015b00: 6e20 6675 6c6c 2061 6e64 206e 6f74 206a  n full and not j
-00015b10: 7573 7420 6120 6461 7368 6564 206c 696e  ust a dashed lin
-00015b20: 650d 0a20 2020 2065 6f62 6a20 3d20 6178  e..    eobj = ax
-00015b30: 2e65 7272 6f72 6261 7228 0d0a 2020 2020  .errorbar(..    
-00015b40: 2020 2020 785f 6172 2c0d 0a20 2020 2020      x_ar,..     
-00015b50: 2020 2079 5f61 722c 0d0a 2020 2020 2020     y_ar,..      
-00015b60: 2020 6d61 726b 6572 3d6d 6172 6b65 722c    marker=marker,
-00015b70: 0d0a 2020 2020 2020 2020 6d73 3d6d 732c  ..        ms=ms,
-00015b80: 0d0a 2020 2020 2020 2020 6d66 633d 274e  ..        mfc='N
-00015b90: 6f6e 6527 2c0d 0a20 2020 2020 2020 206d  one',..        m
-00015ba0: 6577 3d6c 772c 0d0a 2020 2020 2020 2020  ew=lw,..        
-00015bb0: 6d65 633d 636f 6c6f 722c 0d0a 2020 2020  mec=color,..    
-00015bc0: 2020 2020 6c73 3d6c 732c 0d0a 2020 2020      ls=ls,..    
-00015bd0: 2020 2020 7865 7272 3d78 5f65 7272 2c0d      xerr=x_err,.
-00015be0: 0a20 2020 2020 2020 2079 6572 723d 795f  .        yerr=y_
-00015bf0: 6572 722c 0d0a 2020 2020 2020 2020 6563  err,..        ec
-00015c00: 6f6c 6f72 3d63 6f6c 6f72 2c0d 0a20 2020  olor=color,..   
-00015c10: 2020 2020 2063 6f6c 6f72 3d63 6f6c 6f72       color=color
-00015c20: 2c0d 0a20 2020 2020 2020 2070 6963 6b65  ,..        picke
-00015c30: 723d 7069 636b 6572 2c0d 0a20 2020 2020  r=picker,..     
-00015c40: 2020 206c 773d 6c77 2c0d 0a20 2020 2020     lw=lw,..     
-00015c50: 2020 2065 6c69 6e65 7769 6474 683d 6c77     elinewidth=lw
-00015c60: 2c0d 0a20 2020 2020 2020 2063 6170 7369  ,..        capsi
-00015c70: 7a65 3d65 5f63 6170 7369 7a65 2c0d 0a20  ze=e_capsize,.. 
-00015c80: 2020 2020 2020 2023 2063 6170 7468 6963         # capthic
-00015c90: 6b3d 655f 6361 7074 6869 636b 0d0a 2020  k=e_capthick..  
-00015ca0: 2020 2020 2020 2a2a 6b77 730d 0a20 2020        **kws..   
-00015cb0: 2020 2020 2020 290d 0a20 2020 200d 0a20        )..    .. 
-00015cc0: 2020 2072 6574 7572 6e20 656f 626a 0d0a     return eobj..
-00015cd0: 0d0a 6465 6620 6765 745f 636f 6c6f 725f  ..def get_color_
-00015ce0: 7061 6c65 7474 6520 2852 4742 5f63 6f6c  palette (RGB_col
-00015cf0: 6f72 5f70 616c 6574 7465 293a 200d 0a20  or_palette): .. 
-00015d00: 2020 2022 2222 0d0a 2020 2020 436f 6e76     """..    Conv
-00015d10: 6572 7420 5247 4220 636f 6c6f 7220 696e  ert RGB color in
-00015d20: 746f 206d 6174 706c 6f74 6c69 6220 636f  to matplotlib co
-00015d30: 6c6f 7220 7061 6c65 7474 652e 2049 6e20  lor palette. In 
-00015d40: 7468 6520 5247 4220 636f 6c6f 7220 0d0a  the RGB color ..
-00015d50: 2020 2020 7379 7374 656d 2074 776f 2062      system two b
-00015d60: 6974 7320 6f66 2064 6174 6120 6172 6520  its of data are 
-00015d70: 7573 6564 2066 6f72 2065 6163 6820 636f  used for each co
-00015d80: 6c6f 722c 2072 6564 2c20 6772 6565 6e2c  lor, red, green,
-00015d90: 2061 6e64 2062 6c75 652e 200d 0a20 2020   and blue. ..   
-00015da0: 2054 6861 7420 6d65 616e 7320 7468 6174   That means that
-00015db0: 2065 6163 6820 636f 6c6f 7220 7275 6e73   each color runs
-00015dc0: 6f6e 2061 2073 6361 6c65 2066 726f 6d20  on a scale from 
-00015dd0: 3020 746f 2032 3535 2e20 426c 6163 6b20  0 to 255. Black 
-00015de0: 2077 6f75 6c64 2062 650d 0a20 2020 2030   would be..    0
-00015df0: 302c 3030 2c30 302c 2077 6869 6c65 2077  0,00,00, while w
-00015e00: 6869 7465 2077 6f75 6c64 2062 6520 3235  hite would be 25
-00015e10: 352c 3235 352c 3235 352e 204d 6174 706c  5,255,255. Matpl
-00015e20: 6f74 6c69 6220 6861 7320 6c6f 7473 206f  otlib has lots o
-00015e30: 660d 0a20 2020 2070 7265 2d64 6566 696e  f..    pre-defin
-00015e40: 6564 2063 6f6c 6f72 6d61 7073 2066 6f72  ed colormaps for
-00015e50: 2075 7320 2e20 5468 6579 2061 7265 2061   us . They are a
-00015e60: 6c6c 206e 6f72 6d61 6c69 7a65 6420 746f  ll normalized to
-00015e70: 2032 3535 2c20 736f 2074 6865 7920 7275   255, so they ru
-00015e80: 6e0d 0a20 2020 2066 726f 6d20 3020 746f  n..    from 0 to
-00015e90: 2031 2e20 536f 2079 6f75 206e 6565 6420   1. So you need 
-00015ea0: 6f6e 6c79 206e 6f72 6d61 6c69 7a65 2064  only normalize d
-00015eb0: 6174 612c 2074 6865 6e20 7765 2063 616e  ata, then we can
-00015ec0: 206d 616e 7561 6c6c 7920 2073 656c 6563   manually  selec
-00015ed0: 7420 0d0a 2020 2020 636f 6c6f 7273 2066  t ..    colors f
-00015ee0: 726f 6d20 6120 636f 6c6f 7220 6d61 7020  rom a color map 
-00015ef0: 200d 0a0d 0a20 2020 203a 7061 7261 6d20   ....    :param 
-00015f00: 5247 425f 636f 6c6f 725f 7061 6c65 7474  RGB_color_palett
-00015f10: 653a 2073 7472 2076 616c 7565 206f 6620  e: str value of 
-00015f20: 5247 4220 7661 6c75 6520 0d0a 2020 2020  RGB value ..    
-00015f30: 3a74 7970 6520 5247 425f 636f 6c6f 725f  :type RGB_color_
-00015f40: 7061 6c65 7474 653a 2073 7472 200d 0a20  palette: str .. 
-00015f50: 2020 2020 2020 200d 0a20 2020 203a 7265         ..    :re
-00015f60: 7475 726e 733a 2072 6762 612c 2074 7570  turns: rgba, tup
-00015f70: 6c65 206f 6620 2852 2c20 472c 2042 290d  le of (R, G, B).
-00015f80: 0a20 2020 203a 7274 7970 653a 2074 7570  .    :rtype: tup
-00015f90: 6c65 0d0a 2020 2020 200d 0a20 2020 203a  le..     ..    :
-00015fa0: 4578 616d 706c 653a 200d 0a20 2020 2020  Example: ..     
-00015fb0: 2020 200d 0a20 2020 2020 2020 203e 3e3e     ..        >>>
-00015fc0: 2066 726f 6d20 7761 7465 782e 7574 696c   from watex.util
-00015fd0: 732e 706c 6f74 7574 696c 7320 696d 706f  s.plotutils impo
-00015fe0: 7274 2067 6574 5f63 6f6c 6f72 5f70 616c  rt get_color_pal
-00015ff0: 6574 7465 200d 0a20 2020 2020 2020 203e  ette ..        >
-00016000: 3e3e 2067 6574 5f63 6f6c 6f72 5f70 616c  >> get_color_pal
-00016010: 6574 7465 2028 5247 425f 636f 6c6f 725f  ette (RGB_color_
-00016020: 7061 6c65 7474 6520 3d27 5231 3238 4231  palette ='R128B1
-00016030: 3238 2729 0d0a 2020 2020 2222 2220 200d  28')..    """  .
-00016040: 0a20 2020 200d 0a20 2020 2064 6566 2061  .    ..    def a
-00016050: 7363 6572 7461 696e 5f63 7020 2863 7029  scertain_cp (cp)
-00016060: 3a20 0d0a 2020 2020 2020 2020 6966 2063  : ..        if c
-00016070: 7020 3e32 3535 2e20 3a20 0d0a 2020 2020  p >255. : ..    
-00016080: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-00016090: 2e77 6172 6e28 0d0a 2020 2020 2020 2020  .warn(..        
-000160a0: 2020 2020 2020 2020 2720 2152 4742 2076          ' !RGB v
-000160b0: 616c 7565 2069 7320 7261 6e67 6520 3020  alue is range 0 
-000160c0: 746f 2032 3535 2070 6978 656c 7320 2c20  to 255 pixels , 
-000160d0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-000160e0: 2020 2027 6e6f 7420 6265 796f 6e64 2021     'not beyond !
-000160f0: 2e20 596f 7572 2069 6e70 7574 2076 616c  . Your input val
-00016100: 7565 7320 6973 203d 207b 307d 2e27 2e66  ues is = {0}.'.f
-00016110: 6f72 6d61 7428 6370 2929 0d0a 2020 2020  ormat(cp))..    
-00016120: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00016130: 6c75 6545 7272 6f72 2827 4572 726f 7220  lueError('Error 
-00016140: 636f 6c6f 7220 5247 4241 2076 616c 7565  color RGBA value
-00016150: 2021 2027 0d0a 2020 2020 2020 2020 2020   ! '..          
-00016160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016170: 2020 2027 5247 4220 7661 6c75 6520 2070     'RGB value  p
-00016180: 726f 7669 6465 6420 6973 203d 207b 307d  rovided is = {0}
-00016190: 2e27 0d0a 2020 2020 2020 2020 2020 2020  .'..            
-000161a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000161b0: 2720 4974 2069 7320 6c61 7267 6572 2074  ' It is larger t
-000161c0: 6861 6e20 3235 3520 7069 7865 6c73 2e27  han 255 pixels.'
-000161d0: 2e66 6f72 6d61 7428 6370 2929 0d0a 2020  .format(cp))..  
-000161e0: 2020 2020 2020 7265 7475 726e 2063 700d        return cp.
-000161f0: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
-00016200: 6365 2852 4742 5f63 6f6c 6f72 5f70 616c  ce(RGB_color_pal
-00016210: 6574 7465 2c28 666c 6f61 742c 2069 6e74  ette,(float, int
-00016220: 2c20 7374 7229 293a 200d 0a20 2020 2020  , str)): ..     
-00016230: 2020 2074 7279 203a 200d 0a20 2020 2020     try : ..     
-00016240: 2020 2020 2020 2066 6c6f 6174 2852 4742         float(RGB
-00016250: 5f63 6f6c 6f72 5f70 616c 6574 7465 290d  _color_palette).
-00016260: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00016270: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00016280: 2020 5247 425f 636f 6c6f 725f 7061 6c65    RGB_color_pale
-00016290: 7474 653d 2052 4742 5f63 6f6c 6f72 5f70  tte= RGB_color_p
-000162a0: 616c 6574 7465 2e6c 6f77 6572 2829 0d0a  alette.lower()..
-000162b0: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-000162c0: 2020 2020 2020 2065 6c73 6520 3a20 7265         else : re
-000162d0: 7475 726e 2061 7363 6572 7461 696e 5f63  turn ascertain_c
-000162e0: 7028 666c 6f61 7428 5247 425f 636f 6c6f  p(float(RGB_colo
-000162f0: 725f 7061 6c65 7474 6529 292f 3235 352e  r_palette))/255.
-00016300: 0d0a 2020 2020 0d0a 2020 2020 7267 6261  ..    ..    rgba
-00016310: 203d 206e 702e 7a65 726f 7328 2833 2c29   = np.zeros((3,)
-00016320: 290d 0a20 2020 200d 0a20 2020 2069 6620  )..    ..    if 
-00016330: 2772 2720 696e 2052 4742 5f63 6f6c 6f72  'r' in RGB_color
-00016340: 5f70 616c 6574 7465 203a 200d 0a20 2020  _palette : ..   
-00016350: 2020 2020 206b 6e61 6520 3d20 5247 425f       knae = RGB_
-00016360: 636f 6c6f 725f 7061 6c65 7474 6520 2e72  color_palette .r
-00016370: 6570 6c61 6365 2827 7227 2c20 2727 292e  eplace('r', '').
-00016380: 7265 706c 6163 6528 0d0a 2020 2020 2020  replace(..      
-00016390: 2020 2020 2020 2767 272c 2027 2f27 292e        'g', '/').
-000163a0: 7265 706c 6163 6528 2762 272c 2027 2f27  replace('b', '/'
-000163b0: 292e 7370 6c69 7428 272f 2729 0d0a 2020  ).split('/')..  
-000163c0: 2020 2020 2020 7472 7920 3a0d 0a20 2020        try :..   
-000163d0: 2020 2020 2020 2020 205f 6b6e 6165 203d           _knae =
-000163e0: 2061 7363 6572 7461 696e 5f63 7028 666c   ascertain_cp(fl
-000163f0: 6f61 7428 6b6e 6165 5b30 5d29 290d 0a20  oat(knae[0])).. 
-00016400: 2020 2020 2020 2065 7863 6570 7420 3a20         except : 
-00016410: 0d0a 2020 2020 2020 2020 2020 2020 7267  ..            rg
-00016420: 6261 5b30 5d3d 312e 0d0a 2020 2020 2020  ba[0]=1...      
-00016430: 2020 656c 7365 203a 2072 6762 6120 5b30    else : rgba [0
-00016440: 5d20 3d20 5f6b 6e61 6520 2f32 3535 2e0d  ] = _knae /255..
-00016450: 0a20 2020 2020 2020 200d 0a20 2020 2069  .        ..    i
-00016460: 6620 2767 2720 696e 2052 4742 5f63 6f6c  f 'g' in RGB_col
-00016470: 6f72 5f70 616c 6574 7465 203a 200d 0a20  or_palette : .. 
-00016480: 2020 2020 2020 206b 6e61 6520 3d20 5247         knae = RG
-00016490: 425f 636f 6c6f 725f 7061 6c65 7474 6520  B_color_palette 
-000164a0: 2e72 6570 6c61 6365 2827 6727 2c20 272f  .replace('g', '/
-000164b0: 2729 2e72 6570 6c61 6365 280d 0a20 2020  ').replace(..   
-000164c0: 2020 2020 2020 2020 2027 6227 2c20 272f           'b', '/
-000164d0: 2729 2e73 706c 6974 2827 2f27 290d 0a20  ').split('/').. 
-000164e0: 2020 2020 2020 2074 7279 203a 200d 0a20         try : .. 
-000164f0: 2020 2020 2020 2020 2020 205f 6b6e 6165             _knae
-00016500: 203d 6173 6365 7274 6169 6e5f 6370 2866   =ascertain_cp(f
-00016510: 6c6f 6174 286b 6e61 655b 315d 2929 0d0a  loat(knae[1]))..
-00016520: 2020 2020 2020 2020 6578 6365 7074 203a          except :
-00016530: 200d 0a20 2020 2020 2020 2020 2020 2072   ..            r
-00016540: 6762 6120 5b31 5d3d 312e 0d0a 2020 2020  gba [1]=1...    
-00016550: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00016560: 2020 656c 7365 203a 7267 6261 5b31 5d3d    else :rgba[1]=
-00016570: 205f 6b6e 6165 202f 3235 352e 0d0a 2020   _knae /255...  
-00016580: 2020 6966 2027 6227 2069 6e20 5247 425f    if 'b' in RGB_
-00016590: 636f 6c6f 725f 7061 6c65 7474 6520 3a20  color_palette : 
-000165a0: 0d0a 2020 2020 2020 2020 6b6e 6165 203d  ..        knae =
-000165b0: 206b 6e61 6520 3d20 5247 425f 636f 6c6f   knae = RGB_colo
-000165c0: 725f 7061 6c65 7474 6520 2e72 6570 6c61  r_palette .repla
-000165d0: 6365 2827 6727 2c20 272f 2729 2e73 706c  ce('g', '/').spl
-000165e0: 6974 2827 2f27 290d 0a20 2020 2020 2020  it('/')..       
-000165f0: 2074 7279 203a 200d 0a20 2020 2020 2020   try : ..       
-00016600: 2020 2020 205f 6b6e 6165 203d 6173 6365       _knae =asce
-00016610: 7274 6169 6e5f 6370 2866 6c6f 6174 286b  rtain_cp(float(k
-00016620: 6e61 655b 315d 2929 0d0a 2020 2020 2020  nae[1]))..      
-00016630: 2020 6578 6365 7074 203a 0d0a 2020 2020    except :..    
-00016640: 2020 2020 2020 2020 7267 6261 5b32 5d3d          rgba[2]=
-00016650: 312e 0d0a 2020 2020 2020 2020 656c 7365  1...        else
-00016660: 203a 7267 6261 5b32 5d3d 205f 6b6e 6165   :rgba[2]= _knae
-00016670: 202f 3235 352e 0d0a 2020 2020 2020 2020   /255...        
-00016680: 0d0a 2020 2020 7265 7475 726e 2074 7570  ..    return tup
-00016690: 6c65 2872 6762 6129 2020 2020 2020 200d  le(rgba)       .
-000166a0: 0a0d 0a64 6566 205f 6765 745f 7874 6963  ...def _get_xtic
-000166b0: 6b73 5f66 6f72 6d61 7461 6765 2028 0d0a  ks_formatage (..
-000166c0: 2020 2020 2020 2020 6178 2c20 2078 7469          ax,  xti
-000166d0: 636b 5f72 616e 6765 2c20 7370 6163 653d  ck_range, space=
-000166e0: 2031 3420 2c20 7374 6570 3d37 2c0d 0a20   14 , step=7,.. 
-000166f0: 2020 2020 2020 2066 6d74 203d 277b 7d27         fmt ='{}'
-00016700: 2c61 7574 6f20 3d20 4661 6c73 652c 2074  ,auto = False, t
-00016710: 6963 6b73 203d 2778 272c 202a 2a78 6c6b  icks ='x', **xlk
-00016720: 7773 293a 0d0a 2020 2020 2222 2220 536b  ws):..    """ Sk
-00016730: 6970 2078 7469 636b 7320 6c61 6265 6c20  ip xticks label 
-00016740: 6174 2065 7665 7279 206e 756d 6265 7220  at every number 
-00016750: 6f66 2073 7061 6365 7320 0d0a 2020 2020  of spaces ..    
-00016760: 3a70 6172 616d 2061 783a 206d 6174 706c  :param ax: matpl
-00016770: 6f74 6c69 6220 6178 6573 200d 0a20 2020  otlib axes ..   
-00016780: 203a 7061 7261 6d20 7874 6963 6b5f 7261   :param xtick_ra
-00016790: 6e67 653a 206c 6973 7420 6f66 2074 6865  nge: list of the
-000167a0: 2078 7469 636b 7320 7661 6c75 6573 200d   xticks values .
-000167b0: 0a20 2020 203a 7061 7261 6d20 7370 6163  .    :param spac
-000167c0: 653a 2069 6e74 6572 7661 6c20 7468 6174  e: interval that
-000167d0: 2074 6865 206c 6162 656c 206d 7573 7420   the label must 
-000167e0: 6265 2073 686f 776e 2e0d 0a20 2020 203a  be shown...    :
-000167f0: 7061 7261 6d20 7374 6570 3a20 7468 6520  param step: the 
-00016800: 6e75 6d62 6572 206f 6620 6c61 6265 6c20  number of label 
-00016810: 746f 2073 6b69 702e 0d0a 2020 2020 3a70  to skip...    :p
-00016820: 6172 616d 2066 6d74 3a20 7374 722c 2066  aram fmt: str, f
-00016830: 6f72 6d61 7461 6765 2074 7970 652e 200d  ormatage type. .
-00016840: 0a20 2020 203a 7061 7261 6d20 7469 636b  .    :param tick
-00016850: 733a 2073 7472 2c20 6465 6661 756c 743d  s: str, default=
-00016860: 2778 272c 2074 6865 2074 6963 6b73 2061  'x', the ticks a
-00016870: 7869 7320 746f 2066 6f72 6d61 7420 7468  xis to format th
-00016880: 6520 6c61 6265 6c73 2e20 0d0a 2020 2020  e labels. ..    
-00016890: 2020 6361 6e20 6265 2060 6027 7927 6060    can be ``'y'``
-000168a0: 2e20 0d0a 2020 2020 3a70 6172 616d 2061  . ..    :param a
-000168b0: 7574 6f3a 2062 6f6f 6c20 2c20 6966 2060  uto: bool , if `
-000168c0: 6054 7275 6560 6020 6120 6479 6e61 6d69  `True`` a dynami
-000168d0: 6320 7469 636b 2066 6f72 6d61 7461 6765  c tick formatage
-000168e0: 2077 696c 6c20 7374 6172 742e 200d 0a20   will start. .. 
-000168f0: 2020 200d 0a20 2020 2022 2222 0d0a 2020     ..    """..  
-00016900: 2020 6465 6620 666f 726d 6174 5f74 6963    def format_tic
-00016910: 6b73 2028 696e 642c 2078 293a 0d0a 2020  ks (ind, x):..  
-00016920: 2020 2020 2020 2222 2220 466f 726d 6174        """ Format
-00016930: 2074 6869 636b 2070 6172 616d 6574 6572   thick parameter
-00016940: 2077 6974 6820 2746 756e 6346 6f72 6d61   with 'FuncForma
-00016950: 7474 6572 2866 756e 6329 270d 0a20 2020  tter(func)'..   
-00016960: 2020 2020 2072 6174 6865 7220 7468 616e       rather than
-00016970: 2075 7369 6e67 3a3a 200d 0a20 2020 2020   using:: ..     
-00016980: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00016990: 2061 7869 2e78 6178 6973 2e73 6574 5f6d   axi.xaxis.set_m
-000169a0: 616a 6f72 5f6c 6f63 6174 6f72 2028 706c  ajor_locator (pl
-000169b0: 742e 4d61 784e 4c6f 6361 746f 7228 3329  t.MaxNLocator(3)
-000169c0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
-000169d0: 2020 2020 2061 782e 7861 7869 732e 7365       ax.xaxis.se
-000169e0: 745f 6d61 6a6f 725f 666f 726d 6174 7465  t_major_formatte
-000169f0: 7220 2870 6c74 2e46 756e 6346 6f72 6d61  r (plt.FuncForma
-00016a00: 7474 6572 2866 6f72 6d61 745f 7468 6963  tter(format_thic
-00016a10: 6b73 2929 0d0a 2020 2020 2020 2020 2222  ks))..        ""
-00016a20: 220d 0a20 2020 2020 2020 2069 6620 696e  "..        if in
-00016a30: 6420 2520 7374 6570 203d 3d30 3a20 0d0a  d % step ==0: ..
-00016a40: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00016a50: 726e 2066 6d74 2e66 6f72 6d61 7420 2869  rn fmt.format (i
-00016a60: 6e64 290d 0a20 2020 2020 2020 2065 6c73  nd)..        els
-00016a70: 653a 204e 6f6e 6520 0d0a 2020 2020 2020  e: None ..      
-00016a80: 2020 0d0a 2020 2020 2320 7368 6f77 206c    ..    # show l
-00016a90: 6162 656c 2065 7665 7279 2027 7370 6163  abel every 'spac
-00016aa0: 6527 7361 6d70 6c65 7320 0d0a 2020 2020  e'samples ..    
-00016ab0: 6966 2061 7574 6f3a 200d 0a20 2020 2020  if auto: ..     
-00016ac0: 2020 2073 7061 6365 203d 2031 302e 0d0a     space = 10...
-00016ad0: 2020 2020 2020 2020 7374 6570 203d 2069          step = i
-00016ae0: 6e74 2028 6e70 2e63 6569 6c20 2820 6c65  nt (np.ceil ( le
-00016af0: 6e28 7874 6963 6b5f 7261 6e67 6529 2f20  n(xtick_range)/ 
-00016b00: 7370 6163 6520 2929 200d 0a20 2020 2020  space )) ..     
-00016b10: 2020 200d 0a20 2020 2072 6f74 6174 696f     ..    rotatio
-00016b20: 6e20 3d20 786c 6b77 732e 6765 7428 2772  n = xlkws.get('r
-00016b30: 6f74 6174 696f 6e27 2c20 3930 2029 2069  otation', 90 ) i
-00016b40: 6620 2772 6f74 6174 696f 6e27 2069 6e20  f 'rotation' in 
-00016b50: 786c 6b77 732e 6b65 7973 2028 0d0a 2020  xlkws.keys (..  
-00016b60: 2020 2020 2020 2920 656c 7365 2078 6c6b        ) else xlk
-00016b70: 7773 2e67 6574 2827 726f 7461 7465 5f78  ws.get('rotate_x
-00016b80: 6c61 6265 6c27 2c20 3930 2029 0d0a 2020  label', 90 )..  
-00016b90: 2020 0d0a 2020 2020 6966 206c 656e 2878    ..    if len(x
-00016ba0: 7469 636b 5f72 616e 6765 2920 3e3d 2073  tick_range) >= s
-00016bb0: 7061 6365 203a 0d0a 2020 2020 2020 2020  pace :..        
-00016bc0: 6966 2074 6963 6b73 3d3d 2779 273a 200d  if ticks=='y': .
-00016bd0: 0a20 2020 2020 2020 2020 2020 2061 782e  .            ax.
-00016be0: 7961 7869 732e 7365 745f 6d61 6a6f 725f  yaxis.set_major_
-00016bf0: 666f 726d 6174 7465 7220 2870 6c74 2e46  formatter (plt.F
-00016c00: 756e 6346 6f72 6d61 7474 6572 2866 6f72  uncFormatter(for
-00016c10: 6d61 745f 7469 636b 7329 290d 0a20 2020  mat_ticks))..   
-00016c20: 2020 2020 2065 6c73 653a 200d 0a20 2020       else: ..   
-00016c30: 2020 2020 2020 2020 2061 782e 7861 7869           ax.xaxi
-00016c40: 732e 7365 745f 6d61 6a6f 725f 666f 726d  s.set_major_form
-00016c50: 6174 7465 7220 2870 6c74 2e46 756e 6346  atter (plt.FuncF
-00016c60: 6f72 6d61 7474 6572 2866 6f72 6d61 745f  ormatter(format_
-00016c70: 7469 636b 7329 290d 0a0d 0a20 2020 2020  ticks))....     
-00016c80: 2020 2070 6c74 2e73 6574 7028 6178 2e67     plt.setp(ax.g
-00016c90: 6574 5f79 7469 636b 6c61 6265 6c73 2829  et_yticklabels()
-00016ca0: 2069 6620 7469 636b 733d 3d27 7927 2065   if ticks=='y' e
-00016cb0: 6c73 6520 6178 2e67 6574 5f78 7469 636b  lse ax.get_xtick
-00016cc0: 6c61 6265 6c73 2829 2c20 0d0a 2020 2020  labels(), ..    
-00016cd0: 2020 2020 2020 2020 2020 2020 2072 6f74               rot
-00016ce0: 6174 696f 6e20 3d20 726f 7461 7469 6f6e  ation = rotation
-00016cf0: 2029 0d0a 2020 2020 656c 7365 3a20 0d0a   )..    else: ..
-00016d00: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00016d10: 2020 2320 6178 2e78 6178 6973 2e73 6574    # ax.xaxis.set
-00016d20: 5f6d 616a 6f72 5f6c 6f63 6174 6f72 286d  _major_locator(m
-00016d30: 706c 2e74 6963 6b65 722e 4d61 784e 4c6f  pl.ticker.MaxNLo
-00016d40: 6361 746f 7228 3329 290d 0a20 2020 2020  cator(3))..     
-00016d50: 2020 2023 2023 2074 6963 6b73 5f6c 6f63     # # ticks_loc
-00016d60: 203d 2061 782e 6765 745f 7874 6963 6b73   = ax.get_xticks
-00016d70: 2829 2e74 6f6c 6973 7428 290d 0a20 2020  ().tolist()..   
-00016d80: 2020 2020 2023 2061 782e 7861 7869 732e       # ax.xaxis.
-00016d90: 7365 745f 6d61 6a6f 725f 6c6f 6361 746f  set_major_locato
-00016da0: 7228 6d70 6c2e 7469 636b 6572 2e46 6978  r(mpl.ticker.Fix
-00016db0: 6564 4c6f 6361 746f 7228 7469 636b 735f  edLocator(ticks_
-00016dc0: 6c6f 6329 290d 0a20 2020 2020 2020 2023  loc))..        #
-00016dd0: 2061 782e 7365 745f 7874 6963 6b6c 6162   ax.set_xticklab
-00016de0: 656c 7328 5b66 6d74 2e66 6f72 6d61 7428  els([fmt.format(
-00016df0: 7829 2066 6f72 2078 2069 6e20 7469 636b  x) for x in tick
-00016e00: 735f 6c6f 635d 290d 0a20 2020 2020 2020  s_loc])..       
-00016e10: 2074 6c73 7420 3d20 5b66 6d74 2e66 6f72   tlst = [fmt.for
-00016e20: 6d61 7428 6974 656d 2920 666f 7220 6974  mat(item) for it
-00016e30: 656d 2069 6e20 2078 7469 636b 5f72 616e  em in  xtick_ran
-00016e40: 6765 5d0d 0a20 2020 2020 2020 2061 782e  ge]..        ax.
-00016e50: 7365 745f 7974 6963 6b6c 6162 656c 7328  set_yticklabels(
-00016e60: 746c 7374 2c20 2a2a 786c 6b77 7329 2069  tlst, **xlkws) i
-00016e70: 6620 7469 636b 733d 3d27 7927 205c 0d0a  f ticks=='y' \..
-00016e80: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00016e90: 2061 782e 7365 745f 7874 6963 6b6c 6162   ax.set_xticklab
-00016ea0: 656c 7328 746c 7374 2c20 2a2a 786c 6b77  els(tlst, **xlkw
-00016eb0: 7329 200d 0a20 200d 0a64 6566 205f 7365  s) ..  ..def _se
-00016ec0: 745f 736e 735f 7374 796c 6520 2873 2c20  t_sns_style (s, 
-00016ed0: 2f29 3a20 0d0a 2020 2020 2222 2220 5365  /): ..    """ Se
-00016ee0: 7420 736e 7320 7374 796c 6520 7768 6574  t sns style whet
-00016ef0: 6865 7220 626f 6f6c 6561 6e20 6f72 2073  her boolean or s
-00016f00: 7472 696e 6720 6973 2067 6976 656e 2222  tring is given""
-00016f10: 2220 0d0a 2020 2020 7320 3d20 7374 7228  " ..    s = str(
-00016f20: 7329 2e6c 6f77 6572 2829 0d0a 2020 2020  s).lower()..    
-00016f30: 7320 3d20 7265 2e73 7562 2872 2774 7275  s = re.sub(r'tru
-00016f40: 657c 6e6f 6e65 272c 2027 6461 726b 6772  e|none', 'darkgr
-00016f50: 6964 272c 2073 290d 0a20 2020 2072 6574  id', s)..    ret
-00016f60: 7572 6e20 736e 732e 7365 745f 7374 796c  urn sns.set_styl
-00016f70: 6528 7329 200d 0a0d 0a64 6566 205f 6973  e(s) ....def _is
-00016f80: 5f74 6172 6765 745f 696e 2028 582c 2079  _target_in (X, y
-00016f90: 3d4e 6f6e 652c 2074 6e61 6d65 3d4e 6f6e  =None, tname=Non
-00016fa0: 6529 3a20 0d0a 2020 2020 2222 2220 4372  e): ..    """ Cr
-00016fb0: 6561 7465 206e 6577 2074 6172 6765 7420  eate new target 
-00016fc0: 6e61 6d65 2066 6f72 2074 6e61 6d65 2069  name for tname i
-00016fd0: 6620 6769 7665 6e20 0d0a 2020 2020 0d0a  f given ..    ..
-00016fe0: 2020 2020 3a70 6172 616d 2058 3a20 6461      :param X: da
-00016ff0: 7461 6672 616d 6520 0d0a 2020 2020 2020  taframe ..      
-00017000: 2020 6461 7461 6672 616d 6520 636f 6e74    dataframe cont
-00017010: 6169 6e69 6e67 2074 6865 2064 6174 6120  aining the data 
-00017020: 666f 7220 706c 6f74 7469 6e67 200d 0a20  for plotting .. 
-00017030: 2020 203a 7061 7261 6d20 793a 2061 7272     :param y: arr
-00017040: 6179 206f 7220 7365 7269 6573 0d0a 2020  ay or series..  
-00017050: 2020 2020 2020 7461 7267 6574 2064 6174        target dat
-00017060: 6120 666f 7220 706c 6f74 7469 6e67 2e20  a for plotting. 
-00017070: 4e6f 7465 2074 6861 7420 6d75 6c74 6974  Note that multit
-00017080: 6172 6765 7420 6f75 7470 6f75 7420 6973  arget outpout is
-00017090: 206e 6f74 200d 0a20 2020 2020 2020 2061   not ..        a
-000170a0: 6c6c 6f77 6564 2079 6574 2e20 4d6f 726f  llowed yet. Moro
-000170b0: 6576 6572 2c20 6974 2060 7960 2069 7320  ever, it `y` is 
-000170c0: 6769 7665 6e20 6173 2061 2064 6174 6166  given as a dataf
-000170d0: 7261 6d65 2c20 2774 6e61 6d65 2720 6d75  rame, 'tname' mu
-000170e0: 7374 200d 0a20 2020 2020 2020 2062 6520  st ..        be 
-000170f0: 7375 7070 6c69 6564 2074 6f20 7265 7472  supplied to retr
-00017100: 6976 6520 7920 6173 2061 2070 616e 6461  ive y as a panda
-00017110: 7320 7365 7269 6573 206f 626a 6563 742c  s series object,
-00017120: 206f 7468 6572 7769 7365 2061 6e20 0d0a   otherwise an ..
-00017130: 2020 2020 2020 2020 6572 726f 7220 7769          error wi
-00017140: 6c6c 2072 6169 7365 2e20 0d0a 2020 2020  ll raise. ..    
-00017150: 3a70 6172 616d 2074 6e61 6d65 3a20 7374  :param tname: st
-00017160: 722c 2020 0d0a 2020 2020 2020 2020 7461  r,  ..        ta
-00017170: 7267 6574 206e 616d 652e 2049 6620 6769  rget name. If gi
-00017180: 7665 6e20 616e 6420 6079 6020 6973 2060  ven and `y` is `
-00017190: 604e 6f6e 6560 602c 2057 696c 6c20 7472  `None``, Will tr
-000171a0: 7920 746f 2066 696e 6420 6074 6e61 6d65  y to find `tname
-000171b0: 600d 0a20 2020 2020 2020 2069 6e20 7468  `..        in th
-000171c0: 6520 6058 6020 636f 6c75 6d6e 732e 2049  e `X` columns. I
-000171d0: 6620 2774 6e61 6d65 2720 646f 6573 206e  f 'tname' does n
-000171e0: 6f74 2065 7869 7374 2c20 706c 6f74 2066  ot exist, plot f
-000171f0: 6f72 2074 6172 6765 7420 6973 200d 0a20  or target is .. 
-00017200: 2020 2020 2020 2063 616e 6365 6c6c 6564         cancelled
-00017210: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
-00017220: 2020 3a72 6574 7572 6e20 793a 2053 6572    :return y: Ser
-00017230: 6965 7320 0d0a 2020 2020 2222 220d 0a20  ies ..    """.. 
-00017240: 2020 205f 6173 7365 7274 5f61 6c6c 5f74     _assert_all_t
-00017250: 7970 6573 2858 2c20 7064 2e44 6174 6146  ypes(X, pd.DataF
-00017260: 7261 6d65 290d 0a20 2020 200d 0a20 2020  rame)..    ..   
-00017270: 2069 6620 7920 6973 206e 6f74 204e 6f6e   if y is not Non
-00017280: 653a 200d 0a20 2020 2020 2020 2079 203d  e: ..        y =
-00017290: 205f 6173 7365 7274 5f61 6c6c 5f74 7970   _assert_all_typ
-000172a0: 6573 2879 202c 2070 642e 5365 7269 6573  es(y , pd.Series
-000172b0: 2c20 7064 2e44 6174 6146 7261 6d65 2c20  , pd.DataFrame, 
-000172c0: 6e70 2e6e 6461 7272 6179 290d 0a20 2020  np.ndarray)..   
-000172d0: 2020 2020 200d 0a20 2020 2020 2020 2069       ..        i
-000172e0: 6620 6861 7361 7474 7220 2879 2c20 2763  f hasattr (y, 'c
-000172f0: 6f6c 756d 6e73 2729 3a20 0d0a 2020 2020  olumns'): ..    
-00017300: 2020 2020 2020 2020 6966 2074 6e61 6d65          if tname
-00017310: 206e 6f74 2069 6e20 2879 2e63 6f6c 756d   not in (y.colum
-00017320: 6e73 293a 2074 6e61 6d65 203d 204e 6f6e  ns): tname = Non
-00017330: 6520 0d0a 2020 2020 2020 2020 2020 2020  e ..            
-00017340: 6966 2074 6e61 6d65 2069 7320 4e6f 6e65  if tname is None
-00017350: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00017360: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00017370: 726f 7220 280d 0a20 2020 2020 2020 2020  ror (..         
-00017380: 2020 2020 2020 2020 2020 2022 2774 6e61             "'tna
-00017390: 6d65 2720 6d75 7374 2062 6520 7375 7070  me' must be supp
-000173a0: 6c69 6564 2077 6865 6e20 7920 6973 2061  lied when y is a
-000173b0: 2064 6174 6166 7261 6d65 2e22 290d 0a20   dataframe.").. 
-000173c0: 2020 2020 2020 2020 2020 2079 203d 2079             y = y
-000173d0: 205b 746e 616d 6520 5d0d 0a20 2020 2020   [tname ]..     
-000173e0: 2020 2065 6c69 6620 6861 7361 7474 7220     elif hasattr 
-000173f0: 2879 2c20 276e 616d 6527 293a 200d 0a20  (y, 'name'): .. 
-00017400: 2020 2020 2020 2020 2020 2074 6e61 6d65             tname
-00017410: 203d 2074 6e61 6d65 206f 7220 792e 6e61   = tname or y.na
-00017420: 6d65 200d 0a20 2020 2020 2020 2020 2020  me ..           
-00017430: 2023 2072 6566 6f72 6d61 7420 696e 706c   # reformat inpl
-00017440: 6163 6520 7468 6520 6e61 6d65 206f 6620  ace the name of 
-00017450: 7365 7269 6573 200d 0a20 2020 2020 2020  series ..       
-00017460: 2020 2020 2079 2e6e 616d 6520 3d20 746e       y.name = tn
-00017470: 616d 6520 0d0a 2020 2020 2020 2020 2020  ame ..          
-00017480: 2020 0d0a 2020 2020 2020 2020 656c 6966    ..        elif
-00017490: 2068 6173 6174 7472 2879 2c20 275f 5f61   hasattr(y, '__a
-000174a0: 7272 6179 5f5f 2729 3a20 0d0a 2020 2020  rray__'): ..    
-000174b0: 2020 2020 2020 2020 7920 3d20 7064 2e53          y = pd.S
-000174c0: 6572 6965 7320 2879 2c20 6e61 6d65 203d  eries (y, name =
-000174d0: 2074 6e61 6d65 206f 7220 2774 6172 6765   tname or 'targe
-000174e0: 7427 290d 0a20 2020 2020 2020 2020 2020  t')..           
-000174f0: 200d 0a20 2020 2065 6c69 6620 7920 6973   ..    elif y is
-00017500: 204e 6f6e 653a 200d 0a20 2020 2020 2020   None: ..       
-00017510: 2069 6620 746e 616d 6520 696e 2058 2e63   if tname in X.c
-00017520: 6f6c 756d 6e73 203a 0d0a 2020 2020 2020  olumns :..      
-00017530: 2020 2020 2020 7920 3d20 582e 706f 7028        y = X.pop(
-00017540: 746e 616d 6529 0d0a 0d0a 2020 2020 7265  tname)....    re
-00017550: 7475 726e 2058 2c20 7920 0d0a 0d0a 6465  turn X, y ....de
-00017560: 6620 5f74 6f67 676c 655f 7461 7267 6574  f _toggle_target
-00017570: 5f69 6e20 2028 5820 2c20 7920 2c20 706f  _in  (X , y , po
-00017580: 733d 4e6f 6e65 293a 200d 0a20 2020 2022  s=None): ..    "
-00017590: 2222 2054 6f67 676c 6520 7468 6520 7461  "" Toggle the ta
-000175a0: 7267 6574 2069 6e20 7468 6520 636f 6e76  rget in the conv
-000175b0: 656e 6965 6e74 2070 6f73 6974 696f 6e2e  enient position.
-000175c0: 2042 7920 6465 6661 756c 7420 7468 6520   By default the 
-000175d0: 7461 7267 6574 200d 0a20 2020 2070 6c6f  target ..    plo
-000175e0: 7420 6973 2074 6865 206c 6173 7420 7375  t is the last su
-000175f0: 6270 6c6f 7473 200d 0a20 2020 200d 0a20  bplots ..    .. 
-00017600: 2020 203a 7061 7261 6d20 583a 2064 6174     :param X: dat
-00017610: 6166 7261 6d65 200d 0a20 2020 2020 2020  aframe ..       
-00017620: 2064 6174 6166 7261 6d65 2063 6f6e 7461   dataframe conta
-00017630: 696e 696e 6720 7468 6520 6461 7461 2066  ining the data f
-00017640: 6f72 2070 6c6f 7474 696e 6720 0d0a 2020  or plotting ..  
-00017650: 2020 3a70 6172 616d 2079 3a20 6172 7261    :param y: arra
-00017660: 7920 6f72 2073 6572 6965 730d 0a20 2020  y or series..   
-00017670: 2020 2020 2074 6865 2074 6172 6765 7420       the target 
-00017680: 666f 7220 2070 6c6f 7474 696e 672e 200d  for  plotting. .
-00017690: 0a20 2020 203a 7061 7261 6d20 706f 733a  .    :param pos:
-000176a0: 2069 6e74 2c20 7468 6520 706f 7369 7469   int, the positi
-000176b0: 6f6e 2074 6f20 696e 7365 7274 2079 2069  on to insert y i
-000176c0: 6e20 7468 6520 6461 7461 6672 616d 6520  n the dataframe 
-000176d0: 5820 0d0a 2020 2020 2020 2020 4279 2064  X ..        By d
-000176e0: 6566 6175 6c74 202c 2060 7960 2069 7320  efault , `y` is 
-000176f0: 6c6f 6361 7465 6420 6174 2074 6865 206c  located at the l
-00017700: 6173 7420 706f 7369 7469 6f6e 200d 0a20  ast position .. 
-00017710: 2020 2020 2020 200d 0a20 2020 203a 7265         ..    :re
-00017720: 7475 726e 3a20 4461 7461 6672 616d 6520  turn: Dataframe 
-00017730: 0d0a 2020 2020 2020 2020 4461 7461 6672  ..        Datafr
-00017740: 616d 6520 636f 6e74 6169 6e69 6e67 2074  ame containing t
-00017750: 6865 2074 6172 6765 7420 2779 270d 0a20  he target 'y'.. 
-00017760: 2020 2020 2020 200d 0a20 2020 2022 2222         ..    """
-00017770: 0d0a 2020 2020 0d0a 2020 2020 706f 7320  ..    ..    pos 
-00017780: 3d20 2030 2069 6620 706f 7320 3d3d 3020  =  0 if pos ==0 
-00017790: 2065 6c73 6520 2820 706f 7320 6f72 2058   else ( pos or X
-000177a0: 2e73 6861 7065 205b 315d 290d 0a0d 0a20  .shape [1]).... 
-000177b0: 2020 2070 6f73 3d20 696e 7420 2820 5f61     pos= int ( _a
-000177c0: 7373 6572 745f 616c 6c5f 7479 7065 7328  ssert_all_types(
-000177d0: 706f 732c 2069 6e74 2c20 666c 6f61 7420  pos, int, float 
-000177e0: 2920 2920 0d0a 2020 2020 6d73 3d20 2822  ) ) ..    ms= ("
-000177f0: 5468 6520 706f 7369 7469 6f6e 6e69 6e67  The positionning
-00017800: 206f 6620 7468 6520 7461 7267 6574 2069   of the target i
-00017810: 7320 6f75 7420 6f66 2074 6865 2062 6f75  s out of the bou
-00017820: 6e64 2e22 0d0a 2020 2020 2020 2020 2022  nd."..         "
-00017830: 7b7d 2070 6f73 6974 696f 6e20 6973 2075  {} position is u
-00017840: 7365 6420 696e 7374 6561 642e 2229 0d0a  sed instead.")..
-00017850: 2020 2020 0d0a 2020 2020 6966 2070 6f73      ..    if pos
-00017860: 203e 2058 2e73 6861 7065 5b31 5d20 3a20   > X.shape[1] : 
-00017870: 0d0a 2020 2020 2020 2020 7761 726e 696e  ..        warnin
-00017880: 6773 2e77 6172 6e28 6d73 2e66 6f72 6d61  gs.warn(ms.forma
-00017890: 7428 2754 6865 206c 6173 7427 2929 0d0a  t('The last'))..
-000178a0: 2020 2020 2020 2020 706f 733d 582e 7368          pos=X.sh
-000178b0: 6170 655b 315d 0d0a 2020 2020 656c 6966  ape[1]..    elif
-000178c0: 2070 6f73 203c 2030 3a20 0d0a 2020 2020   pos < 0: ..    
-000178d0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-000178e0: 6e28 6d73 2e66 6f72 6d61 7428 0d0a 2020  n(ms.format(..  
-000178f0: 2020 2020 2020 2020 2020 2220 4e65 6761            " Nega
-00017900: 7469 7665 2069 6e64 6578 2069 7320 6e6f  tive index is no
-00017910: 7420 616c 6c6f 7765 642e 2054 6865 2066  t allowed. The f
-00017920: 6972 7374 2229 0d0a 2020 2020 2020 2020  irst")..        
-00017930: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-00017940: 0a20 2020 2020 2020 2070 6f73 3d30 200d  .        pos=0 .
-00017950: 0a20 0d0a 2020 2020 582e 696e 7365 7274  . ..    X.insert
-00017960: 2028 706f 732c 2079 2e6e 616d 652c 2079   (pos, y.name, y
-00017970: 2029 0d0a 2020 2020 0d0a 2020 2020 7265   )..    ..    re
-00017980: 7475 726e 2058 0d0a 2020 2020 0d0a 6465  turn X..    ..de
-00017990: 6620 5f73 6b69 705f 6c6f 6731 305f 636f  f _skip_log10_co
-000179a0: 6c75 6d6e 7320 2820 582c 2063 6f6c 756d  lumns ( X, colum
-000179b0: 6e32 736b 6970 2c20 7061 7474 6572 6e20  n2skip, pattern 
-000179c0: 3d4e 6f6e 6520 2c20 696e 706c 6163 6520  =None , inplace 
-000179d0: 3d54 7275 6529 3a20 0d0a 2020 2020 2222  =True): ..    ""
-000179e0: 2220 536b 6970 2074 6865 2063 6f6c 756d  " Skip the colum
-000179f0: 6e73 2074 6861 7420 646f 6e74 206e 6565  ns that dont nee
-00017a00: 6420 746f 2070 7574 2076 616c 7565 2069  d to put value i
-00017a10: 6e20 6c6f 6761 7269 7468 6d73 2e0d 0a20  n logarithms... 
-00017a20: 2020 200d 0a20 2020 203a 7061 7261 6d20     ..    :param 
-00017a30: 583a 2064 6174 6166 7261 6d65 200d 0a20  X: dataframe .. 
-00017a40: 2020 2020 2020 2070 616e 6461 7320 6461         pandas da
-00017a50: 7461 6672 616d 6520 7769 7468 2076 616c  taframe with val
-00017a60: 6964 2063 6f6c 756d 6e73 200d 0a20 2020  id columns ..   
-00017a70: 203a 7061 7261 6d20 636f 6c75 6d6e 3273   :param column2s
-00017a80: 6b69 703a 206c 6973 7420 6f72 2073 7472  kip: list or str
-00017a90: 202c 200d 0a20 2020 2020 2020 204c 6973   , ..        Lis
-00017aa0: 7420 6f66 2063 6f6c 756d 6e73 2074 6f20  t of columns to 
-00017ab0: 736b 6970 2e20 4966 2067 6976 656e 2061  skip. If given a
-00017ac0: 7320 7374 7269 6e67 2061 6e64 2073 6570  s string and sep
-00017ad0: 6172 6564 2062 7920 7468 6520 6465 6661  ared by the defa
-00017ae0: 756c 740d 0a20 2020 2020 2020 2070 6174  ult..        pat
-00017af0: 7465 726e 2069 7465 6d73 2c20 6974 2073  tern items, it s
-00017b00: 686f 756c 6420 6265 2063 6f6e 7665 7274  hould be convert
-00017b10: 6564 2074 6f20 6120 6c69 7374 2061 6e64  ed to a list and
-00017b20: 206d 616b 6520 7375 7265 2074 6865 200d   make sure the .
-00017b30: 0a20 2020 2020 2020 2063 6f6c 756d 6e73  .        columns
-00017b40: 206e 616d 6520 6578 6973 7420 696e 2074   name exist in t
-00017b50: 6865 2064 6174 6166 7261 6d65 2e20 4f74  he dataframe. Ot
-00017b60: 6865 7277 6973 6520 616e 2065 7272 6f72  herwise an error
-00017b70: 2077 6974 6820 0d0a 2020 2020 2020 2020   with ..        
-00017b80: 7261 6973 652e 200d 0a20 2020 203a 7061  raise. ..    :pa
-00017b90: 7261 6d20 7061 7474 6572 6e3a 2073 7472  ram pattern: str
-00017ba0: 2c20 6465 6661 756c 7420 3d20 275b 2326  , default = '[#&
-00017bb0: 2a40 212c 3b5c 735d 5c73 2a27 0d0a 2020  *@!,;\s]\s*'..  
-00017bc0: 2020 2020 2020 5468 6520 6261 7365 2070        The base p
-00017bd0: 6174 7465 726e 2074 6f20 7370 6c69 7420  attern to split 
-00017be0: 7468 6520 7465 7874 2069 6e20 6063 6f6c  the text in `col
-00017bf0: 756d 6e32 736b 6970 6020 696e 746f 2061  umn2skip` into a
-00017c00: 2063 6f6c 756d 6e73 0d0a 2020 2020 2020   columns..      
-00017c10: 2020 0d0a 2020 2020 3a72 6574 7572 6e20    ..    :return 
-00017c20: 583a 2044 6174 6166 7261 6d65 0d0a 2020  X: Dataframe..  
-00017c30: 2020 2020 2020 4461 7461 6672 616d 6520        Dataframe 
-00017c40: 6d6f 6469 6669 6564 2069 6e70 6c61 6365  modified inplace
-00017c50: 2077 6974 6820 7661 6c75 6573 2063 6f6d   with values com
-00017c60: 7075 7465 6420 696e 206c 6f67 3130 200d  puted in log10 .
-00017c70: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00017c80: 7468 6520 736b 6970 7065 6420 636f 6c75  the skipped colu
-00017c90: 6d6e 732e 200d 0a20 2020 2020 2020 200d  mns. ..        .
-00017ca0: 0a20 2020 203a 6578 616d 706c 653a 200d  .    :example: .
-00017cb0: 0a20 2020 2020 2020 3e3e 3e20 6672 6f6d  .       >>> from
-00017cc0: 2077 6174 6578 2e64 6174 6173 6574 7320   watex.datasets 
-00017cd0: 696d 706f 7274 206c 6f61 645f 686c 6f67  import load_hlog
-00017ce0: 7320 0d0a 2020 2020 2020 203e 3e3e 2066  s ..       >>> f
-00017cf0: 726f 6d20 7761 7465 782e 7574 696c 732e  rom watex.utils.
-00017d00: 706c 6f74 7574 696c 7320 696d 706f 7274  plotutils import
-00017d10: 205f 736b 6970 5f6c 6f67 3130 5f63 6f6c   _skip_log10_col
-00017d20: 756d 6e73 200d 0a20 2020 2020 2020 3e3e  umns ..       >>
-00017d30: 3e20 5830 2c20 5f3d 206c 6f61 645f 686c  > X0, _= load_hl
-00017d40: 6f67 7320 2861 735f 6672 616d 6520 3d54  ogs (as_frame =T
-00017d50: 7275 6520 2920 0d0a 2020 2020 2020 203e  rue ) ..       >
-00017d60: 3e3e 2023 206c 6574 2076 6973 7561 6c69  >> # let visuali
-00017d70: 7a65 2074 6865 2020 6669 7273 7433 2076  ze the  first3 v
-00017d80: 616c 7565 7320 6f66 2060 7370 6020 616e  alues of `sp` an
-00017d90: 6420 6072 6573 6973 7469 7669 7479 6020  d `resistivity` 
-00017da0: 6b65 7973 200d 0a20 2020 2020 2020 3e3e  keys ..       >>
-00017db0: 3e20 5830 5b27 7370 275d 5b3a 335d 202c  > X0['sp'][:3] ,
-00017dc0: 2058 305b 2772 6573 6973 7469 7669 7479   X0['resistivity
-00017dd0: 275d 5b3a 335d 2020 0d0a 2020 2020 2020  '][:3]  ..      
-00017de0: 202e 2e2e 2028 3020 2020 2d31 2e35 3830   ... (0   -1.580
-00017df0: 3030 300d 0a20 2020 2020 2020 2020 2020  000..           
-00017e00: 2031 2020 202d 312e 3538 3030 3030 0d0a   1   -1.580000..
-00017e10: 2020 2020 2020 2020 2020 2020 3220 2020              2   
-00017e20: 2d31 2e39 3232 3633 320d 0a20 2020 2020  -1.922632..     
-00017e30: 2020 2020 2020 204e 616d 653a 2073 702c         Name: sp,
-00017e40: 2064 7479 7065 3a20 666c 6f61 7436 342c   dtype: float64,
-00017e50: 0d0a 2020 2020 2020 2020 2020 2020 3020  ..            0 
-00017e60: 2020 2031 352e 3931 3931 3330 0d0a 2020     15.919130..  
-00017e70: 2020 2020 2020 2020 2020 3120 2020 2031            1    1
-00017e80: 362e 3030 3030 3030 0d0a 2020 2020 2020  6.000000..      
-00017e90: 2020 2020 2020 3220 2020 2032 342e 3432        2    24.42
-00017ea0: 3233 3136 0d0a 2020 2020 2020 2020 2020  2316..          
-00017eb0: 2020 4e61 6d65 3a20 7265 7369 7374 6976    Name: resistiv
-00017ec0: 6974 792c 2064 7479 7065 3a20 666c 6f61  ity, dtype: floa
-00017ed0: 7436 3429 0d0a 2020 2020 2020 203e 3e3e  t64)..       >>>
-00017ee0: 2063 6f6c 756d 6e32 736b 6970 203d 205b   column2skip = [
-00017ef0: 2768 6f6c 655f 6964 272c 2764 6570 7468  'hole_id','depth
-00017f00: 5f74 6f70 272c 2027 6465 7074 685f 626f  _top', 'depth_bo
-00017f10: 7474 6f6d 272c 200d 0a20 2020 2020 2020  ttom', ..       
-00017f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017f30: 2020 2773 7472 6174 615f 6e61 6d65 272c    'strata_name',
-00017f40: 2027 726f 636b 5f6e 616d 6527 2c20 2777   'rock_name', 'w
-00017f50: 656c 6c5f 6469 616d 6574 6572 272c 2027  ell_diameter', '
-00017f60: 7370 275d 0d0a 2020 2020 2020 203e 3e3e  sp']..       >>>
-00017f70: 205f 736b 6970 5f6c 6f67 3130 5f63 6f6c   _skip_log10_col
-00017f80: 756d 6e73 2028 5830 2c20 636f 6c75 6d6e  umns (X0, column
-00017f90: 3273 6b69 7029 0d0a 2020 2020 2020 203e  2skip)..       >
-00017fa0: 3e3e 2023 206e 6f77 206c 6574 2076 6973  >> # now let vis
-00017fb0: 7561 6c69 7a65 2074 6865 2073 616d 6520  ualize the same 
-00017fc0: 6b65 7973 2076 616c 7565 7320 0d0a 2020  keys values ..  
-00017fd0: 2020 2020 203e 3e3e 2058 305b 2773 7027       >>> X0['sp'
-00017fe0: 5d5b 3a33 5d20 2c20 5830 5b27 7265 7369  ][:3] , X0['resi
-00017ff0: 7374 6976 6974 7927 5d5b 3a33 5d0d 0a20  stivity'][:3].. 
-00018000: 2020 2020 2020 2e2e 2e20 2830 2020 202d        ... (0   -
-00018010: 312e 3538 3030 3030 0d0a 2020 2020 2020  1.580000..      
-00018020: 2020 2020 2020 3120 2020 2d31 2e35 3830        1   -1.580
-00018030: 3030 300d 0a20 2020 2020 2020 2020 2020  000..           
-00018040: 2032 2020 202d 312e 3932 3236 3332 0d0a   2   -1.922632..
-00018050: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
-00018060: 3a20 7370 2c20 6474 7970 653a 2066 6c6f  : sp, dtype: flo
-00018070: 6174 3634 2c0d 0a20 2020 2020 2020 2020  at64,..         
-00018080: 2020 2030 2020 2020 312e 3230 3139 3139     0    1.201919
-00018090: 0d0a 2020 2020 2020 2020 2020 2020 3120  ..            1 
-000180a0: 2020 2031 2e32 3034 3132 300d 0a20 2020     1.204120..   
-000180b0: 2020 2020 2020 2020 2032 2020 2020 312e           2    1.
-000180c0: 3338 3737 3837 0d0a 2020 2020 2020 2020  387787..        
-000180d0: 2020 2020 4e61 6d65 3a20 7265 7369 7374      Name: resist
-000180e0: 6976 6974 792c 2064 7479 7065 3a20 666c  ivity, dtype: fl
-000180f0: 6f61 7436 3429 0d0a 2020 2020 2020 3e3e  oat64)..      >>
-00018100: 3e20 2320 6974 2069 7320 6f62 7669 6f75  > # it is obviou
-00018110: 7320 7468 6520 6072 6573 6973 7469 7669  s the `resistivi
-00018120: 7960 2076 616c 7565 7320 6973 206c 6f67  y` values is log
-00018130: 3130 200d 0a20 2020 2020 203e 3e3e 2023  10 ..      >>> #
-00018140: 2077 6869 6c65 2060 7370 6020 7374 696c   while `sp` stil
-00018150: 6c20 7265 6d61 696e 7320 7468 6520 7361  l remains the sa
-00018160: 6d65 200d 0a20 2020 2020 200d 0a20 2020  me ..      ..   
-00018170: 2022 2222 0d0a 2020 2020 5830 203d 2058   """..    X0 = X
-00018180: 2e63 6f70 7920 2829 200d 0a20 2020 2069  .copy () ..    i
-00018190: 6620 6e6f 7420 6973 5f69 7465 7261 626c  f not is_iterabl
-000181a0: 6528 2063 6f6c 756d 6e32 736b 6970 293a  e( column2skip):
-000181b0: 200d 0a20 2020 2020 2020 2072 6169 7365   ..        raise
-000181c0: 2054 7970 6545 7272 6f72 2028 2243 6f6c   TypeError ("Col
-000181d0: 756d 6e73 2020 746f 2073 6b69 7020 6578  umns  to skip ex
-000181e0: 7065 6374 2061 6e20 6974 6572 6162 6c65  pect an iterable
-000181f0: 206f 626a 6563 743b 220d 0a20 2020 2020   object;"..     
-00018200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018210: 2020 2020 6622 2067 6f74 207b 7479 7065      f" got {type
-00018220: 2863 6f6c 756d 6e32 736b 6970 292e 5f5f  (column2skip).__
-00018230: 6e61 6d65 5f5f 2172 7d22 290d 0a20 2020  name__!r}")..   
-00018240: 2020 2020 200d 0a20 2020 2070 6174 7465       ..    patte
-00018250: 726e 203d 2070 6174 7465 726e 206f 7220  rn = pattern or 
-00018260: 7227 5b23 262a 4021 2c3b 5c73 5d5c 732a  r'[#&*@!,;\s]\s*
-00018270: 270d 0a20 2020 200d 0a20 2020 2069 6620  '..    ..    if 
-00018280: 6973 696e 7374 616e 6365 2863 6f6c 756d  isinstance(colum
-00018290: 6e32 736b 6970 2c20 7374 7229 3a0d 0a20  n2skip, str):.. 
-000182a0: 2020 2020 2020 2063 6f6c 756d 6e32 736b         column2sk
-000182b0: 6970 203d 2073 7472 3263 6f6c 756d 6e73  ip = str2columns
-000182c0: 2028 636f 6c75 6d6e 3273 6b69 702c 2070   (column2skip, p
-000182d0: 6174 7465 726e 3d70 6174 7465 726e 2020  attern=pattern  
-000182e0: 290d 0a20 2020 2023 6173 7365 7274 2077  )..    #assert w
-000182f0: 6865 7468 6572 2063 6f6c 756d 6e20 746f  hether column to
-00018300: 2073 6b69 7020 6973 2069 6e20 0d0a 2020   skip is in ..  
-00018310: 2020 6966 2063 6f6c 756d 6e32 736b 6970    if column2skip
-00018320: 3a0d 0a20 2020 2020 2020 2063 736b 6970  :..        cskip
-00018330: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
-00018340: 2028 636f 6c75 6d6e 3273 6b69 7029 200d   (column2skip) .
-00018350: 0a20 2020 2020 2020 2063 6f6c 756d 6e32  .        column2
-00018360: 736b 6970 203d 2069 735f 696e 5f69 6628  skip = is_in_if(
-00018370: 582e 636f 6c75 6d6e 732c 2063 6f6c 756d  X.columns, colum
-00018380: 6e32 736b 6970 2c20 7265 7475 726e 5f64  n2skip, return_d
-00018390: 6966 663d 2054 7275 6529 0d0a 2020 2020  iff= True)..    
-000183a0: 2020 2020 6966 206c 656e 2863 6f6c 756d      if len(colum
-000183b0: 6e32 736b 6970 2920 3d3d 6c65 6e20 2858  n2skip) ==len (X
-000183c0: 2e63 6f6c 756d 6e73 293a 200d 0a20 2020  .columns): ..   
-000183d0: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
-000183e0: 732e 7761 726e 2822 5661 6c75 6528 7329  s.warn("Value(s)
-000183f0: 2074 6f20 736b 6970 2061 7265 206e 6f74   to skip are not
-00018400: 2064 6574 6563 7465 642e 2229 0d0a 2020   detected.")..  
-00018410: 2020 2020 2020 6966 2069 6e70 6c61 6365        if inplace
-00018420: 203a 200d 0a20 2020 2020 2020 2020 2020   : ..           
-00018430: 2058 5b63 6f6c 756d 6e32 736b 6970 5d20   X[column2skip] 
-00018440: 3d20 6e70 2e6c 6f67 3130 2028 2058 5b63  = np.log10 ( X[c
-00018450: 6f6c 756d 6e32 736b 6970 5d20 2920 0d0a  olumn2skip] ) ..
-00018460: 2020 2020 2020 2020 2020 2020 582e 6472              X.dr
-00018470: 6f70 2028 636f 6c75 6d6e 7320 3d63 736b  op (columns =csk
-00018480: 6970 202c 2069 6e70 6c61 6365 203d 5472  ip , inplace =Tr
-00018490: 7565 2029 0d0a 2020 2020 2020 2020 2020  ue )..          
-000184a0: 2020 7265 7475 726e 2020 0d0a 2020 2020    return  ..    
-000184b0: 2020 2020 656c 7365 203a 200d 0a20 2020      else : ..   
-000184c0: 2020 2020 2020 2020 2058 305b 636f 6c75           X0[colu
-000184d0: 6d6e 3273 6b69 705d 203d 206e 702e 6c6f  mn2skip] = np.lo
-000184e0: 6731 3020 2820 5830 5b63 6f6c 756d 6e32  g10 ( X0[column2
-000184f0: 736b 6970 5d20 2920 0d0a 2020 2020 2020  skip] ) ..      
-00018500: 2020 2020 2020 0d0a 2020 2020 7265 7475        ..    retu
-00018510: 726e 2058 300d 0a20 2020 200d 0a64 6566  rn X0..    ..def
-00018520: 2070 6c6f 745f 6261 7228 782c 2079 2c20   plot_bar(x, y, 
-00018530: 7768 3d20 2e38 2c20 206b 696e 6420 3d27  wh= .8,  kind ='
-00018540: 7627 2c20 6669 675f 7369 7a65 203d 2838  v', fig_size =(8
-00018550: 2c20 3629 2c20 7361 7665 6669 673d 4e6f  , 6), savefig=No
-00018560: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-00018570: 2020 786c 6162 656c 203d 4e6f 6e65 2c20    xlabel =None, 
-00018580: 796c 6162 656c 3d4e 6f6e 652c 2066 6967  ylabel=None, fig
-00018590: 5f74 6974 6c65 3d4e 6f6e 652c 202a 2a62  _title=None, **b
-000185a0: 6172 5f6b 7773 293a 200d 0a20 2020 2022  ar_kws): ..    "
-000185b0: 2222 0d0a 2020 2020 4d61 6b65 2061 2076  ""..    Make a v
-000185c0: 6572 7469 6361 6c20 6f72 2068 6f72 697a  ertical or horiz
-000185d0: 6f6e 7461 6c20 6261 7220 706c 6f74 2e0d  ontal bar plot..
-000185e0: 0a0d 0a20 2020 2054 6865 2062 6172 7320  ...    The bars 
-000185f0: 6172 6520 706f 7369 7469 6f6e 6564 2061  are positioned a
-00018600: 7420 7820 6f72 2079 2077 6974 6820 7468  t x or y with th
-00018610: 6520 6769 7665 6e20 616c 6967 6e6d 656e  e given alignmen
-00018620: 742e 2054 6865 6972 2064 696d 656e 7369  t. Their dimensi
-00018630: 6f6e 7320 0d0a 2020 2020 6172 6520 6769  ons ..    are gi
-00018640: 7665 6e20 6279 2077 6964 7468 2061 6e64  ven by width and
-00018650: 2068 6569 6768 742e 2054 6865 2068 6f72   height. The hor
-00018660: 697a 6f6e 7461 6c20 6261 7365 6c69 6e65  izontal baseline
-00018670: 2069 7320 6c65 6674 2028 6465 6661 756c   is left (defaul
-00018680: 7420 3029 0d0a 2020 2020 7768 696c 6520  t 0)..    while 
-00018690: 7468 6520 7665 7274 6963 616c 2062 6173  the vertical bas
-000186a0: 656c 696e 6520 6973 2062 6f74 746f 6d20  eline is bottom 
-000186b0: 2864 6566 6175 6c74 3d30 290d 0a20 2020  (default=0)..   
-000186c0: 200d 0a20 2020 204d 616e 7920 7061 7261   ..    Many para
-000186d0: 6d65 7465 7273 2063 616e 2074 616b 6520  meters can take 
-000186e0: 6569 7468 6572 2061 2073 696e 676c 6520  either a single 
-000186f0: 7661 6c75 6520 6170 706c 7969 6e67 2074  value applying t
-00018700: 6f20 616c 6c20 6261 7273 206f 7220 6120  o all bars or a 
-00018710: 0d0a 2020 2020 7365 7175 656e 6365 206f  ..    sequence o
-00018720: 6620 7661 6c75 6573 2c20 6f6e 6520 666f  f values, one fo
-00018730: 7220 6561 6368 2062 6172 2e0d 0a20 2020  r each bar...   
-00018740: 200d 0a20 2020 2050 6172 616d 6574 6572   ..    Parameter
-00018750: 7320 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  s ..    --------
-00018760: 2d2d 2d0d 0a20 2020 2078 3a20 666c 6f61  ---..    x: floa
-00018770: 7420 6f72 2061 7272 6179 2d6c 696b 650d  t or array-like.
-00018780: 0a20 2020 2020 2020 2054 6865 2078 2063  .        The x c
-00018790: 6f6f 7264 696e 6174 6573 206f 6620 7468  oordinates of th
-000187a0: 6520 6261 7273 2e20 6973 2027 7827 2066  e bars. is 'x' f
-000187b0: 6f72 2076 6572 7469 6361 6c20 6261 7220  or vertical bar 
-000187c0: 706c 6f74 2061 7320 606b 696e 6460 200d  plot as `kind` .
-000187d0: 0a20 2020 2020 2020 2069 7320 7365 7420  .        is set 
-000187e0: 746f 2060 6076 6060 2864 6566 6175 6c74  to ``v``(default
-000187f0: 2920 6f72 2060 7960 2066 6f72 2068 6f72  ) or `y` for hor
-00018800: 697a 6f6e 7461 6c20 6261 7220 706c 6f74  izontal bar plot
-00018810: 2061 7320 606b 696e 6460 2069 7320 0d0a   as `kind` is ..
-00018820: 2020 2020 2020 2020 7365 7420 746f 6060          set to``
-00018830: 6860 602e 200d 0a20 2020 2020 2020 2053  h``. ..        S
-00018840: 6565 2061 6c73 6f20 616c 6967 6e20 666f  ee also align fo
-00018850: 7220 7468 6520 616c 6967 6e6d 656e 7420  r the alignment 
-00018860: 6f66 2074 6865 2062 6172 7320 746f 2074  of the bars to t
-00018870: 6865 2063 6f6f 7264 696e 6174 6573 2e0d  he coordinates..
-00018880: 0a20 2020 2079 3a20 666c 6f61 7420 6f72  .    y: float or
-00018890: 2061 7272 6179 2d6c 696b 650d 0a20 2020   array-like..   
-000188a0: 2020 2020 2054 6865 2068 6569 6768 7428       The height(
-000188b0: 7329 2066 6f72 2076 6572 7469 6361 6c20  s) for vertical 
-000188c0: 616e 6420 7769 6474 6828 7329 2066 6f72  and width(s) for
-000188d0: 2068 6f72 697a 6f6e 6174 616c 206f 6620   horizonatal of 
-000188e0: 7468 6520 6261 7273 2e0d 0a20 2020 200d  the bars...    .
-000188f0: 0a20 2020 2077 683a 2066 6c6f 6174 206f  .    wh: float o
-00018900: 7220 6172 7261 792d 6c69 6b65 2c20 6465  r array-like, de
-00018910: 6661 756c 743a 2030 2e38 0d0a 2020 2020  fault: 0.8..    
-00018920: 2020 2020 5468 6520 7769 6474 6828 7329      The width(s)
-00018930: 2066 6f72 2076 6572 7469 6361 6c20 6f72   for vertical or
-00018940: 2068 6569 6768 7428 7329 2066 6f72 2068   height(s) for h
-00018950: 6f72 697a 616f 6e74 616c 206f 6620 7468  orizaontal of th
-00018960: 6520 6261 7273 2e0d 0a20 2020 2020 2020  e bars...       
-00018970: 200d 0a20 2020 206b 696e 643a 2073 7472   ..    kind: str
-00018980: 2c20 5b27 7665 7274 6963 616c 272c 2027  , ['vertical', '
-00018990: 686f 7269 7a6f 6e74 616c 275d 2c20 6465  horizontal'], de
-000189a0: 6661 756c 743d 2776 6572 7469 6361 6c27  fault='vertical'
-000189b0: 0d0a 2020 2020 2020 2020 5468 6520 6b69  ..        The ki
-000189c0: 6e64 206f 6620 6261 7220 706c 6f74 2e20  nd of bar plot. 
-000189d0: 4361 6e20 6265 2074 6865 2068 6f72 697a  Can be the horiz
-000189e0: 6f6e 7461 6c20 6f72 2076 6572 7469 6361  ontal or vertica
-000189f0: 6c20 6261 7220 706c 6f74 732e 200d 0a20  l bar plots. .. 
-00018a00: 2020 2062 6172 5f6b 7773 3a20 6469 6374     bar_kws: dict
-00018a10: 2c20 0d0a 2020 2020 2020 2020 4164 6469  , ..        Addi
-00018a20: 7469 6f6e 616c 206b 6579 776f 7264 7320  tional keywords 
-00018a30: 6172 6775 6d65 6e74 7320 7061 7373 6564  arguments passed
-00018a40: 2074 6f20 3a20 0d0a 2020 2020 2020 2020   to : ..        
-00018a50: 2020 2020 3a66 756e 633a 607e 6d61 7470      :func:`~matp
-00018a60: 6c6f 746c 6962 2e70 7970 6c6f 742e 6261  lotlib.pyplot.ba
-00018a70: 7260 206f 7220 3a66 756e 633a 607e 6d61  r` or :func:`~ma
-00018a80: 7470 6c6f 746c 6962 2e70 7970 6c6f 742e  tplotlib.pyplot.
-00018a90: 6261 7268 602e 200d 0a20 2020 2022 2222  barh`. ..    """
-00018aa0: 0d0a 2020 2020 0d0a 2020 2020 6173 7365  ..    ..    asse
-00018ab0: 7274 2073 7472 286b 696e 6429 2e6c 6f77  rt str(kind).low
-00018ac0: 6572 2829 2e73 7472 6970 2829 2069 6e20  er().strip() in 
-00018ad0: 2822 7665 7274 6963 616c 222c 2027 7627  ("vertical", 'v'
-00018ae0: 2c22 686f 7269 7a6f 6e74 616c 222c 2022  ,"horizontal", "
-00018af0: 6822 292c 2028 0d0a 2020 2020 2020 2020  h"), (..        
-00018b00: 2253 7570 706f 7274 206f 6e6c 7920 7468  "Support only th
-00018b10: 6520 686f 7269 7a6f 6e74 616c 2027 6827  e horizontal 'h'
-00018b20: 2061 6e64 2076 6572 7469 6361 6c20 2776   and vertical 'v
-00018b30: 2720 6261 7220 706c 6f74 732e 220d 0a20  ' bar plots.".. 
-00018b40: 2020 2020 2020 2022 2047 6f74 207b 6b69         " Got {ki
-00018b50: 6e64 2172 7d22 290d 0a20 2020 206b 696e  nd!r}")..    kin
-00018b60: 6420 3d73 7472 286b 696e 6429 2e6c 6f77  d =str(kind).low
-00018b70: 6572 2829 2e73 7472 6970 2829 0d0a 2020  er().strip()..  
-00018b80: 2020 0d0a 2020 2020 6669 672c 2061 7820    ..    fig, ax 
-00018b90: 3d20 706c 742e 7375 6270 6c6f 7473 286e  = plt.subplots(n
-00018ba0: 726f 7773 3d31 2c20 6e63 6f6c 733d 312c  rows=1, ncols=1,
-00018bb0: 2066 6967 7369 7a65 203d 6669 675f 7369   figsize =fig_si
-00018bc0: 7a65 290d 0a20 2020 2069 6620 6b69 6e64  ze)..    if kind
-00018bd0: 2069 6e20 2822 7665 7274 6963 616c 222c   in ("vertical",
-00018be0: 2022 7622 293a 200d 0a20 2020 2020 2020   "v"): ..       
-00018bf0: 2061 782e 6261 7220 2878 2c20 6865 6967   ax.bar (x, heig
-00018c00: 6874 3d20 792c 2077 6964 7468 203d 2020  ht= y, width =  
-00018c10: 7768 202c 202a 2a62 6172 5f6b 7773 290d  wh , **bar_kws).
-00018c20: 0a20 2020 2065 6c69 6620 6b69 6e64 2069  .    elif kind i
-00018c30: 6e20 2822 686f 7269 7a6f 6e74 616c 222c  n ("horizontal",
-00018c40: 2022 6822 293a 200d 0a20 2020 2020 2020   "h"): ..       
-00018c50: 2061 782e 6261 7268 2028 7820 2c20 7769   ax.barh (x , wi
-00018c60: 6474 6820 3d79 202c 2068 6569 6768 7420  dth =y , height 
-00018c70: 3d77 682c 202a 2a62 6172 5f6b 7773 290d  =wh, **bar_kws).
-00018c80: 0a20 2020 2020 2020 200d 0a20 2020 2061  .        ..    a
-00018c90: 782e 7365 745f 786c 6162 656c 2028 786c  x.set_xlabel (xl
-00018ca0: 6162 656c 2029 0d0a 2020 2020 6178 2e73  abel )..    ax.s
-00018cb0: 6574 5f79 6c61 6265 6c28 796c 6162 656c  et_ylabel(ylabel
-00018cc0: 2920 0d0a 2020 2020 6178 2e73 6574 5f74  ) ..    ax.set_t
-00018cd0: 6974 6c65 2028 6669 675f 7469 746c 6529  itle (fig_title)
-00018ce0: 0d0a 2020 2020 6966 2073 6176 6566 6967  ..    if savefig
-00018cf0: 2069 7320 6e6f 7420 204e 6f6e 653a 200d   is not  None: .
-00018d00: 0a20 2020 2020 2020 2073 6176 6566 6967  .        savefig
-00018d10: 7572 6520 2866 6967 2c20 7361 7665 6669  ure (fig, savefi
-00018d20: 672c 2064 7069 203d 2033 3030 290d 0a20  g, dpi = 300).. 
-00018d30: 2020 2020 2020 200d 0a20 2020 2070 6c74         ..    plt
-00018d40: 2e63 6c6f 7365 2028 2920 6966 2073 6176  .close () if sav
-00018d50: 6566 6967 2069 7320 6e6f 7420 4e6f 6e65  efig is not None
-00018d60: 2065 6c73 6520 706c 742e 7368 6f77 2829   else plt.show()
-00018d70: 200d 0a20 2020 200d 0a64 6566 2070 6c6f   ..    ..def plo
-00018d80: 745f 7072 6f66 696c 696e 6720 280d 0a20  t_profiling (.. 
-00018d90: 2020 2065 7270 2c20 0d0a 2020 2020 2f2c     erp, ..    /,
-00018da0: 200d 0a20 2020 2073 7461 7469 6f6e 203d   ..    station =
-00018db0: 204e 6f6e 652c 2020 0d0a 2020 2020 637a   None,  ..    cz
-00018dc0: 3d4e 6f6e 652c 200d 0a20 2020 202a 2c20  =None, ..    *, 
-00018dd0: 0d0a 2020 2020 7374 796c 6520 3d20 2763  ..    style = 'c
-00018de0: 6c61 7373 6963 272c 200d 0a20 2020 2066  lassic', ..    f
-00018df0: 6967 5f73 697a 6520 3d20 2831 302c 2034  ig_size = (10, 4
-00018e00: 292c 200d 0a20 2020 2063 7a5f 706c 6f74  ), ..    cz_plot
-00018e10: 5f6b 7773 3d20 4e6f 6e65 2c0d 0a20 2020  _kws= None,..   
-00018e20: 206d 6172 6b65 725f 6b77 733d 204e 6f6e   marker_kws= Non
-00018e30: 652c 200d 0a20 2020 2073 6176 6566 6967  e, ..    savefig
-00018e40: 203d 4e6f 6e65 2c20 0d0a 2020 2020 2a2a   =None, ..    **
-00018e50: 706c 6f74 5f6b 7773 0d0a 2020 2020 293a  plot_kws..    ):
-00018e60: 200d 0a20 2020 2022 2222 200d 0a20 2020   ..    """ ..   
-00018e70: 2056 6973 7561 6c69 7a65 7320 2074 6865   Visualizes  the
-00018e80: 2072 6573 6973 7469 7669 7479 2070 726f   resistivity pro
-00018e90: 6669 6c69 6e67 206f 6620 2045 5250 2064  filing of  ERP d
-00018ea0: 6174 612e 200d 0a20 2020 200d 0a20 2020  ata. ..    ..   
-00018eb0: 2046 756e 6374 696f 6e20 6361 6e20 6f76   Function can ov
-00018ec0: 6572 6c61 696e 2074 6865 2073 656c 6563  erlain the selec
-00018ed0: 7465 6420 636f 6e64 7563 7469 7665 207a  ted conductive z
-00018ee0: 6f6e 6520 746f 2074 6865 2045 5250 2069  one to the ERP i
-00018ef0: 6620 6063 7a60 2069 7320 0d0a 2020 2020  f `cz` is ..    
-00018f00: 6769 7665 6e2e 200d 0a20 2020 200d 0a20  given. ..    .. 
-00018f10: 2020 2050 6172 616d 6574 6572 7320 0d0a     Parameters ..
-00018f20: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d      -----------.
-00018f30: 0a20 2020 2065 7270 3a20 6172 7261 795f  .    erp: array_
-00018f40: 6c69 6b65 2031 640d 0a20 2020 2020 2020  like 1d..       
-00018f50: 2054 6865 2065 6c65 6374 7269 6361 6c20   The electrical 
-00018f60: 7265 7369 7374 6976 6974 7920 7072 6f66  resistivity prof
-00018f70: 696c 696e 6720 6172 7261 792e 2049 6620  iling array. If 
-00018f80: 6461 7461 6672 616d 6520 6973 2070 6173  dataframe is pas
-00018f90: 7365 642c 200d 0a20 2020 2020 2020 2060  sed, ..        `
-00018fa0: 7265 7369 7374 6976 6974 7960 2063 6f6c  resistivity` col
-00018fb0: 756d 6e20 6d75 7374 2062 6520 696e 636c  umn must be incl
-00018fc0: 7564 6564 2e20 0d0a 2020 2020 2020 2020  uded. ..        
-00018fd0: 0d0a 2020 2020 2020 2020 2e2e 2076 6572  ..        .. ver
-00018fe0: 7369 6f6e 6368 616e 6765 643a 3a20 302e  sionchanged:: 0.
-00018ff0: 322e 3120 0d0a 2020 2020 2020 2020 2020  2.1 ..          
-00019000: 2043 616e 2068 656e 6365 666f 7274 6820   Can henceforth 
-00019010: 6163 6365 7074 2064 6174 6166 7261 6d65  accept dataframe
-00019020: 2074 6861 7420 636f 6e74 6169 6e73 2072   that contains r
-00019030: 6573 6973 7469 7669 7479 2076 616c 7565  esistivity value
-00019040: 732e 200d 0a20 0d0a 2020 2020 7374 6174  s. .. ..    stat
-00019050: 696f 6e3a 2073 7472 2c20 696e 742c 206f  ion: str, int, o
-00019060: 7074 696f 6e61 6c20 0d0a 2020 2020 2020  ptional ..      
-00019070: 2020 5374 6174 696f 6e20 6973 2075 7365    Station is use
-00019080: 6420 746f 2076 6973 7561 6c69 7a65 2074  d to visualize t
-00019090: 6865 2063 6f6e 6475 6374 6976 6520 7a6f  he conductive zo
-000190a0: 6e65 2069 6e20 7468 6520 6065 7270 6020  ne in the `erp` 
-000190b0: 7072 6f66 696c 652e 200d 0a20 2020 2020  profile. ..     
-000190c0: 2020 2054 6869 7320 7365 656d 7320 7573     This seems us
-000190d0: 6566 756c 2069 6620 6063 7a60 2069 7320  eful if `cz` is 
-000190e0: 6e6f 7420 6769 7665 6e2e 200d 0a20 2020  not given. ..   
-000190f0: 2020 2020 2057 6865 6e20 6073 7461 7469       When `stati
-00019100: 6f6e 3d27 6175 746f 2760 2069 7420 6175  on='auto'` it au
-00019110: 746f 6d61 7469 6361 6c6c 7920 6465 7465  tomatically dete
-00019120: 6374 2074 6865 2062 6573 7420 636f 6e64  ct the best cond
-00019130: 7563 7469 7665 207a 6f6e 6520 0d0a 2020  uctive zone ..  
-00019140: 2020 2020 2020 6173 7375 6d69 6e67 2074        assuming t
-00019150: 6865 2076 6572 7920 6c6f 7720 7265 7369  he very low resi
-00019160: 7374 6976 6974 7920 696e 2074 6865 2070  stivity in the p
-00019170: 726f 6669 6c65 2061 6e64 2070 6c6f 7420  rofile and plot 
-00019180: 7468 6520 0d0a 2020 2020 2020 2020 636f  the ..        co
-00019190: 6e64 7563 7469 7665 207a 6f6e 652e 2054  nductive zone. T
-000191a0: 6f20 6861 7665 2074 6865 2065 7870 6563  o have the expec
-000191b0: 7465 6420 7265 7375 6c74 732c 2060 7374  ted results, `st
-000191c0: 6174 696f 6e60 2070 6f73 6974 696f 6e20  ation` position 
-000191d0: 6f72 200d 0a20 2020 2020 2020 2060 637a  or ..        `cz
-000191e0: 6020 6d75 7374 2062 6520 6769 7665 6e20  ` must be given 
-000191f0: 6f72 2074 6865 202e 200d 0a20 2020 2020  or the . ..     
-00019200: 2020 200d 0a20 2020 2020 2020 2e2e 2076     ..       .. v
-00019210: 6572 7369 6f6e 6164 6465 643a 3a20 302e  ersionadded:: 0.
-00019220: 322e 3120 0d0a 2020 2020 2020 2020 2020  2.1 ..          
-00019230: 2043 616e 2068 656e 6365 666f 7274 6820   Can henceforth 
-00019240: 7061 7373 2074 6865 2073 7461 7469 6f6e  pass the station
-00019250: 2074 6f20 706c 6f74 2074 6865 2063 6f6e   to plot the con
-00019260: 6475 6374 6976 6520 7a6f 6e65 2e20 0d0a  ductive zone. ..
-00019270: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00019280: 2063 7a3a 2061 7272 6179 5f6c 696b 652c   cz: array_like,
-00019290: 206f 7074 696f 6e61 6c2c 200d 0a20 2020   optional, ..   
-000192a0: 2020 2020 2054 6865 2073 656c 6563 7465       The selecte
-000192b0: 6420 636f 6e64 7563 7469 7665 207a 6f6e  d conductive zon
-000192c0: 652e 2049 6620 6060 4e6f 6e65 6060 2c20  e. If ``None``, 
-000192d0: 6063 7a60 2073 686f 756c 6420 6e6f 7420  `cz` should not 
-000192e0: 6265 2070 6c6f 7474 6564 2e0d 0a20 2020  be plotted...   
-000192f0: 2020 2020 200d 0a20 2020 2073 7479 6c65       ..    style
-00019300: 3a20 7374 722c 2064 6566 6175 6c74 3d27  : str, default='
-00019310: 636c 6173 7369 6327 0d0a 2020 2020 2020  classic'..      
-00019320: 2020 4d61 7470 6c6f 746c 6962 2070 6c6f    Matplotlib plo
-00019330: 7474 696e 6773 2073 7479 6c65 2e0d 0a20  ttings style... 
-00019340: 2020 2020 2020 200d 0a20 2020 2066 6967         ..    fig
-00019350: 5f73 697a 653a 2074 7570 6c65 2c20 6465  _size: tuple, de
-00019360: 6661 756c 743d 2028 3130 2c20 3429 200d  fault= (10, 4) .
-00019370: 0a20 2020 2020 2020 204d 6174 706c 6f74  .        Matplot
-00019380: 6c69 6220 6669 6775 7265 2073 697a 652e  lib figure size.
-00019390: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
-000193a0: 206d 6172 6b65 725f 6b77 733a 2064 6963   marker_kws: dic
-000193b0: 742c 2064 6566 6175 6c74 203d 207b 276d  t, default = {'m
-000193c0: 6172 6b65 7227 3a27 6f27 2c20 2763 273a  arker':'o', 'c':
-000193d0: 2723 3945 4233 4444 2720 7d0d 0a20 2020  '#9EB3DD' }..   
-000193e0: 2020 2020 2054 6865 2064 6963 7469 6f6e       The diction
-000193f0: 6e61 7279 2074 6f20 6375 7374 6f6d 697a  nary to customiz
-00019400: 6520 6d61 726b 6572 2069 6e20 7468 6520  e marker in the 
-00019410: 706c 6f74 200d 0a20 2020 2020 2020 200d  plot ..        .
-00019420: 0a20 2020 2063 7a5f 706c 6f74 5f6b 7773  .    cz_plot_kws
-00019430: 3a20 6469 6374 2c20 6465 6661 756c 7420  : dict, default 
-00019440: 3d20 7b27 6c73 273a 272d 272c 2763 273a  = {'ls':'-','c':
-00019450: 2723 3041 3443 4545 272c 2027 6c77 274c  '#0A4CEE', 'lw'L
-00019460: 3220 7d0d 0a20 2020 2020 2020 2054 6865  2 }..        The
-00019470: 2064 6963 7469 6f6e 6e61 7279 2074 6f20   dictionnary to 
-00019480: 6375 7374 6f6d 697a 6520 7468 6520 636f  customize the co
-00019490: 6e64 7563 7469 7a65 207a 6f6e 6520 696e  nductize zone in
-000194a0: 2074 6865 2070 6c6f 742e 0d0a 2020 2020   the plot...    
-000194b0: 2020 2020 0d0a 2020 2020 7361 7665 6669      ..    savefi
-000194c0: 673a 2073 7472 2c20 6f70 7469 6f6e 616c  g: str, optional
-000194d0: 200d 0a20 2020 2020 2020 2053 6176 6520   ..        Save 
-000194e0: 6669 6775 7265 206e 616d 652e 2054 6865  figure name. The
-000194f0: 2064 6566 6175 6c74 2072 6573 6f6c 7574   default resolut
-00019500: 696f 6e20 646f 742d 7065 722d 696e 6368  ion dot-per-inch
-00019510: 2069 7320 6060 3330 3060 602e 200d 0a20   is ``300``. .. 
-00019520: 2020 2020 2020 200d 0a20 2020 2070 6c6f         ..    plo
-00019530: 745f 6b77 733a 2064 6963 742c 200d 0a20  t_kws: dict, .. 
-00019540: 2020 2020 2020 2041 6464 6974 696f 6e61         Additiona
-00019550: 6c20 6b65 7977 6f72 6420 6172 6775 6d65  l keyword argume
-00019560: 6e74 7320 7061 7373 6564 2074 6f20 3a66  nts passed to :f
-00019570: 756e 633a 606d 6174 706c 6f74 6c69 622e  unc:`matplotlib.
-00019580: 7079 706c 6f74 2e70 6c6f 7460 200d 0a20  pyplot.plot` .. 
-00019590: 2020 2020 2020 2066 756e 6374 696f 6e20         function 
-000195a0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-000195b0: 5265 7475 726e 0d0a 2020 2020 2d2d 2d2d  Return..    ----
-000195c0: 2d2d 2d2d 0d0a 2020 2020 6178 3a20 4d61  ----..    ax: Ma
-000195d0: 7470 6c6f 746c 6962 2e70 7970 6c6f 742e  tplotlib.pyplot.
-000195e0: 4178 6973 200d 0a20 2020 2020 2020 2052  Axis ..        R
-000195f0: 6574 7572 6e20 6178 6973 2020 0d0a 2020  eturn axis  ..  
-00019600: 2020 2020 2020 0d0a 2020 2020 4578 616d        ..    Exam
-00019610: 706c 6573 200d 0a20 2020 202d 2d2d 2d2d  ples ..    -----
-00019620: 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e 2066  -----..    >>> f
-00019630: 726f 6d20 7761 7465 782e 6461 7461 7365  rom watex.datase
-00019640: 7473 2069 6d70 6f72 7420 6d61 6b65 5f65  ts import make_e
-00019650: 7270 200d 0a20 2020 203e 3e3e 2066 726f  rp ..    >>> fro
-00019660: 6d20 7761 7465 782e 7574 696c 732e 706c  m watex.utils.pl
-00019670: 6f74 7574 696c 7320 696d 706f 7274 2070  otutils import p
-00019680: 6c6f 745f 7072 6f66 696c 696e 6720 0d0a  lot_profiling ..
-00019690: 2020 2020 3e3e 3e20 643d 206d 616b 655f      >>> d= make_
-000196a0: 6572 7020 286e 5f73 7461 7469 6f6e 7320  erp (n_stations 
-000196b0: 3d35 362c 2073 6565 6420 3d20 3432 290d  =56, seed = 42).
-000196c0: 0a20 2020 203e 3e3e 2070 6c6f 745f 7072  .    >>> plot_pr
-000196d0: 6f66 696c 696e 6720 2028 642e 7265 7369  ofiling  (d.resi
-000196e0: 7374 6976 6974 7929 0d0a 2020 2020 3e3e  stivity)..    >>
-000196f0: 3e20 2320 7265 6164 2074 6865 2066 7261  > # read the fra
-00019700: 6d65 2061 6e64 2067 6574 2074 6865 2072  me and get the r
-00019710: 6573 6973 7469 7669 7479 2076 616c 7565  esistivity value
-00019720: 7320 0d0a 2020 2020 3e3e 3e20 706c 6f74  s ..    >>> plot
-00019730: 5f70 726f 6669 6c69 6e67 2028 642e 6672  _profiling (d.fr
-00019740: 616d 652c 2073 7461 7469 6f6e 203d 2773  ame, station ='s
-00019750: 3037 2720 2920 0d0a 2020 2020 3c41 7865  07' ) ..    <Axe
-00019760: 7353 7562 706c 6f74 3a78 6c61 6265 6c3d  sSubplot:xlabel=
-00019770: 2753 7461 7469 6f6e 7327 2c20 796c 6162  'Stations', ylab
-00019780: 656c 3d27 4170 702e 7265 7369 7374 6976  el='App.resistiv
-00019790: 6974 7920 2824 5c5c 4f6d 6567 612e 6d24  ity ($\\Omega.m$
-000197a0: 2927 3e0d 0a20 2020 2022 2222 0d0a 2020  )'>..    """..  
-000197b0: 2020 706c 742e 7374 796c 652e 7573 6520    plt.style.use 
-000197c0: 2873 7479 6c65 2029 0d0a 2020 2020 0d0a  (style )..    ..
-000197d0: 2020 2020 6966 2068 6173 6174 7472 2028      if hasattr (
-000197e0: 2065 7270 202c 2027 636f 6c75 6d6e 7327   erp , 'columns'
-000197f0: 2920 616e 6420 6861 7361 7474 7220 2820  ) and hasattr ( 
-00019800: 6572 7020 2c20 275f 5f61 7272 6179 5f5f  erp , '__array__
-00019810: 2729 3a20 0d0a 2020 2020 2020 2020 6966  '): ..        if
-00019820: 2027 7265 7369 7374 6976 6974 7927 206e   'resistivity' n
-00019830: 6f74 2069 6e20 2065 7270 2e63 6f6c 756d  ot in  erp.colum
-00019840: 6e73 203a 200d 0a20 2020 2020 2020 2020  ns : ..         
-00019850: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00019860: 6f72 2028 224d 6973 7369 6e67 2072 6573  or ("Missing res
-00019870: 6973 7469 7669 7479 2063 6f6c 756d 6e20  istivity column 
-00019880: 696e 2074 6865 2064 6174 612e 2229 0d0a  in the data.")..
-00019890: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-000198a0: 2020 6572 7020 3d20 6572 702e 7265 7369    erp = erp.resi
-000198b0: 7374 6976 6974 7920 0d0a 2020 2020 0d0a  stivity ..    ..
-000198c0: 2020 2020 6572 7020 3d20 6368 6563 6b5f      erp = check_
-000198d0: 7920 2865 7270 202c 2069 6e70 7574 5f6e  y (erp , input_n
-000198e0: 616d 6520 3d22 7361 6d70 6c65 206f 6620  ame ="sample of 
-000198f0: 4552 5020 6461 7461 2229 0d0a 2020 200d  ERP data")..   .
-00019900: 0a20 2020 2069 6620 7374 6174 696f 6e20  .    if station 
-00019910: 6973 206e 6f74 204e 6f6e 653a 200d 0a20  is not None: .. 
-00019920: 2020 2020 2020 2066 726f 6d20 2e63 6f72         from .cor
-00019930: 6575 7469 6c73 2069 6d70 6f72 7420 6465  eutils import de
-00019940: 6669 6e65 436f 6e64 7563 7469 7665 5a6f  fineConductiveZo
-00019950: 6e65 200d 0a20 2020 2020 2020 200d 0a20  ne ..        .. 
-00019960: 2020 2020 2020 2061 7574 6f20 3d46 616c         auto =Fal
-00019970: 7365 200d 0a20 2020 2020 2020 2069 6620  se ..        if 
-00019980: 7374 7228 7374 6174 696f 6e29 2e6c 6f77  str(station).low
-00019990: 6572 2829 2e73 7472 6970 2028 2920 3d3d  er().strip () ==
-000199a0: 2761 7574 6f27 3a20 0d0a 2020 2020 2020  'auto': ..      
-000199b0: 2020 2020 2020 6175 746f 203d 2054 7275        auto = Tru
-000199c0: 6520 3b20 7374 6174 696f 6e20 3d4e 6f6e  e ; station =Non
-000199d0: 6520 0d0a 2020 2020 2020 2020 637a 2c20  e ..        cz, 
-000199e0: 2a5f 2020 3d20 6465 6669 6e65 436f 6e64  *_  = defineCond
-000199f0: 7563 7469 7665 5a6f 6e65 280d 0a20 2020  uctiveZone(..   
-00019a00: 2020 2020 2020 2020 2065 7270 202c 2073           erp , s
-00019a10: 7461 7469 6f6e 203d 2073 7461 7469 6f6e  tation = station
-00019a20: 202c 2061 7574 6f3d 2061 7574 6f20 290d   , auto= auto ).
-00019a30: 0a20 2020 200d 0a20 2020 2066 6967 2c20  .    ..    fig, 
-00019a40: 6178 203d 2070 6c74 2e73 7562 706c 6f74  ax = plt.subplot
-00019a50: 7328 312c 312c 2066 6967 7369 7a65 203d  s(1,1, figsize =
-00019a60: 6669 675f 7369 7a65 290d 0a20 2020 206c  fig_size)..    l
-00019a70: 6567 203d 5b5d 0d0a 2020 2020 0d0a 2020  eg =[]..    ..  
-00019a80: 2020 7a6c 2c20 3d20 6178 2e70 6c6f 7428    zl, = ax.plot(
-00019a90: 6e70 2e61 7261 6e67 6528 6c65 6e28 6572  np.arange(len(er
-00019aa0: 7029 292c 2065 7270 2c20 0d0a 2020 2020  p)), erp, ..    
-00019ab0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
-00019ac0: 6265 6c20 3d27 456c 6563 7472 6963 616c  bel ='Electrical
-00019ad0: 2072 6573 6973 7469 7669 7479 2070 726f   resistivity pro
-00019ae0: 6669 6c69 6e67 272c 200d 0a20 2020 2020  filing', ..     
-00019af0: 2020 2020 2020 2020 2020 2020 202a 2a70               **p
-00019b00: 6c6f 745f 6b77 7320 0d0a 2020 2020 2020  lot_kws ..      
-00019b10: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-00019b20: 2020 206d 6172 6b65 725f 6b77 7320 3d20     marker_kws = 
-00019b30: 6d61 726b 6572 5f6b 7773 206f 7220 6469  marker_kws or di
-00019b40: 6374 2028 6d61 726b 6572 203d 276f 272c  ct (marker ='o',
-00019b50: 2063 3d27 2339 4542 3344 4427 2029 0d0a   c='#9EB3DD' )..
-00019b60: 2020 2020 6178 2e73 6361 7474 6572 2028      ax.scatter (
-00019b70: 6e70 2e61 7261 6e67 6528 6c65 6e28 6572  np.arange(len(er
-00019b80: 7029 292c 2065 7270 2c20 2a2a 6d61 726b  p)), erp, **mark
-00019b90: 6572 5f6b 7773 2029 0d0a 2020 2020 0d0a  er_kws )..    ..
-00019ba0: 2020 2020 6c65 672e 6170 7065 6e64 287a      leg.append(z
-00019bb0: 6c29 2020 2020 0d0a 2020 2020 2020 2020  l)    ..        
-00019bc0: 0d0a 2020 2020 6966 2063 7a20 6973 206e  ..    if cz is n
-00019bd0: 6f74 204e 6f6e 653a 200d 0a20 2020 2020  ot None: ..     
-00019be0: 2020 2063 7a3d 2063 6865 636b 5f79 2028     cz= check_y (
-00019bf0: 637a 2c20 696e 7075 745f 6e61 6d65 203d  cz, input_name =
-00019c00: 2243 6f6e 6475 6374 6976 6520 7a6f 6e65  "Conductive zone
-00019c10: 2027 637a 2722 290d 0a20 2020 2020 2020   'cz'")..       
-00019c20: 207a 203d 206e 702e 6d61 2e6d 6173 6b65   z = np.ma.maske
-00019c30: 645f 7661 6c75 6573 2028 6572 702c 206e  d_values (erp, n
-00019c40: 702e 6973 696e 2865 7270 2c20 637a 2029  p.isin(erp, cz )
-00019c50: 290d 0a20 2020 2020 2020 2073 616d 706c  )..        sampl
-00019c60: 655f 6d61 736b 6564 203d 206e 702e 6d61  e_masked = np.ma
-00019c70: 2e61 7272 6179 280d 0a20 2020 2020 2020  .array(..       
-00019c80: 2020 2020 2065 7270 2c20 6d61 736b 203d       erp, mask =
-00019c90: 207e 7a2e 6669 6c6c 5f76 616c 7565 2e61   ~z.fill_value.a
-00019ca0: 7374 7970 6528 2762 6f6f 6c27 2920 290d  stype('bool') ).
-00019cb0: 0a20 2020 200d 0a20 2020 2020 2020 2063  .    ..        c
-00019cc0: 7a5f 706c 6f74 5f6b 7773 203d 2063 7a5f  z_plot_kws = cz_
-00019cd0: 706c 6f74 5f6b 7773 206f 7220 6469 6374  plot_kws or dict
-00019ce0: 2028 6c73 3d27 2d27 2c63 3d27 2330 4134   (ls='-',c='#0A4
-00019cf0: 4345 4527 2c20 6c77 203d 3220 290d 0a20  CEE', lw =2 ).. 
-00019d00: 2020 2020 2020 2063 7a6c 2c20 3d20 6178         czl, = ax
-00019d10: 2e70 6c6f 7428 0d0a 2020 2020 2020 2020  .plot(..        
-00019d20: 2020 2020 6e70 2e61 7261 6e67 6528 6c65      np.arange(le
-00019d30: 6e28 6572 7029 292c 2073 616d 706c 655f  n(erp)), sample_
-00019d40: 6d61 736b 6564 2c20 0d0a 2020 2020 2020  masked, ..      
-00019d50: 2020 2020 2020 6c61 6265 6c20 3d27 436f        label ='Co
-00019d60: 6e64 7563 7469 7665 207a 6f6e 6527 2c20  nductive zone', 
-00019d70: 0d0a 2020 2020 2020 2020 2020 2020 2a2a  ..            **
-00019d80: 637a 5f70 6c6f 745f 6b77 730d 0a20 2020  cz_plot_kws..   
-00019d90: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-00019da0: 2020 2020 6c65 672e 6170 7065 6e64 2863      leg.append(c
-00019db0: 7a6c 290d 0a0d 0a20 2020 2061 782e 7365  zl)....    ax.se
-00019dc0: 745f 7874 6963 6b73 2872 616e 6765 286c  t_xticks(range(l
-00019dd0: 656e 2865 7270 2929 290d 0a20 2020 200d  en(erp)))..    .
-00019de0: 0a20 2020 2069 6620 6c65 6e28 6572 7020  .    if len(erp 
-00019df0: 2920 3e3d 2031 3420 3a20 0d0a 2020 2020  ) >= 14 : ..    
-00019e00: 2020 2020 6178 2e78 6178 6973 2e73 6574      ax.xaxis.set
-00019e10: 5f6d 616a 6f72 5f66 6f72 6d61 7474 6572  _major_formatter
-00019e20: 2028 706c 742e 4675 6e63 466f 726d 6174   (plt.FuncFormat
-00019e30: 7465 7228 5f66 6f72 6d61 745f 7469 636b  ter(_format_tick
-00019e40: 7329 290d 0a20 2020 2065 6c73 6520 3a20  s))..    else : 
-00019e50: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00019e60: 2020 2020 6178 2e73 6574 5f78 7469 636b      ax.set_xtick
-00019e70: 6c61 6265 6c73 280d 0a20 2020 2020 2020  labels(..       
-00019e80: 2020 2020 205b 2753 7b3a 3032 7d27 2e66       ['S{:02}'.f
-00019e90: 6f72 6d61 7428 696e 7428 6929 2b31 2920  ormat(int(i)+1) 
-00019ea0: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
-00019eb0: 656e 2865 7270 2929 5d29 200d 0a20 2020  en(erp))]) ..   
-00019ec0: 2020 2020 2020 0d0a 2020 2020 6178 2e73        ..    ax.s
-00019ed0: 6574 5f78 6c61 6265 6c28 2753 7461 7469  et_xlabel('Stati
-00019ee0: 6f6e 7327 290d 0a20 2020 2061 782e 7365  ons')..    ax.se
-00019ef0: 745f 796c 6162 656c 2827 4170 702e 7265  t_ylabel('App.re
-00019f00: 7369 7374 6976 6974 7920 2824 5c4f 6d65  sistivity ($\Ome
-00019f10: 6761 2e6d 2429 2729 0d0a 2020 2020 6178  ga.m$)')..    ax
-00019f20: 2e6c 6567 656e 6428 2068 616e 646c 6573  .legend( handles
-00019f30: 203d 206c 6567 2c20 6c6f 6320 3d27 6265   = leg, loc ='be
-00019f40: 7374 2729 0d0a 2020 2020 6178 2e73 6574  st')..    ax.set
-00019f50: 5f78 6c69 6d20 285b 2d31 2c20 6c65 6e28  _xlim ([-1, len(
-00019f60: 6572 7029 5d29 0d0a 0d0a 2020 2020 6966  erp)])....    if
-00019f70: 2073 6176 6566 6967 2069 7320 6e6f 7420   savefig is not 
-00019f80: 204e 6f6e 653a 2073 6176 6566 6967 7572   None: savefigur
-00019f90: 6520 2866 6967 2c20 7361 7665 6669 672c  e (fig, savefig,
-00019fa0: 2064 7069 203d 2033 3030 290d 0a20 2020   dpi = 300)..   
-00019fb0: 2020 2020 200d 0a20 2020 2070 6c74 2e63       ..    plt.c
-00019fc0: 6c6f 7365 2028 2920 6966 2073 6176 6566  lose () if savef
-00019fd0: 6967 2069 7320 6e6f 7420 4e6f 6e65 2065  ig is not None e
-00019fe0: 6c73 6520 706c 742e 7368 6f77 2829 200d  lse plt.show() .
-00019ff0: 0a20 2020 200d 0a20 2020 2072 6574 7572  .    ..    retur
-0001a000: 6e20 6178 200d 0a0d 0a64 6566 2070 6c6f  n ax ....def plo
-0001a010: 745f 736b 6577 2028 0d0a 2020 2020 6564  t_skew (..    ed
-0001a020: 695f 6f62 6a2c 200d 0a20 2020 206d 6574  i_obj, ..    met
-0001a030: 686f 643d 2742 6168 7227 2c20 0d0a 2020  hod='Bahr', ..  
-0001a040: 2020 6d6f 6465 3d4e 6f6e 652c 200d 0a20    mode=None, .. 
-0001a050: 2020 2074 6872 6573 686f 6c64 5f6c 696e     threshold_lin
-0001a060: 6520 3d4e 6f6e 652c 200d 0a20 2020 2066  e =None, ..    f
-0001a070: 6967 5f73 697a 6520 3d20 2837 2c20 3529  ig_size = (7, 5)
-0001a080: 2c20 0d0a 2020 2020 7361 7665 6669 6720  , ..    savefig 
-0001a090: 3d20 4e6f 6e65 2c20 0d0a 2020 2020 7669  = None, ..    vi
-0001a0a0: 6577 3d4e 6f6e 652c 0d0a 2020 2020 7374  ew=None,..    st
-0001a0b0: 796c 653d 4e6f 6e65 2c20 0d0a 2020 2020  yle=None, ..    
-0001a0c0: 2a2a 6b77 7320 0d0a 2020 2020 293a 0d0a  **kws ..    ):..
-0001a0d0: 2020 2020 2222 2220 506c 6f74 2070 6861      """ Plot pha
-0001a0e0: 7365 2073 656e 7369 7469 7665 2073 6b65  se sensitive ske
-0001a0f0: 7720 7669 7375 616c 697a 6174 696f 6e2e  w visualization.
-0001a100: 200d 0a20 2020 200d 0a20 2020 2050 6861   ..    ..    Pha
-0001a110: 7365 2053 656e 7369 7469 7669 7479 2053  se Sensitivity S
-0001a120: 6b65 7720 283a 6d61 7468 3a60 5c65 7461  kew (:math:`\eta
-0001a130: 6029 2069 7320 6120 6469 6d65 6e73 696f  `) is a dimensio
-0001a140: 6e61 6c69 7479 2074 6f6f 6c20 7468 6174  nality tool that
-0001a150: 200d 0a20 2020 2072 6570 7265 7365 6e74   ..    represent
-0001a160: 7320 6120 6d65 6173 7572 6520 6f66 2074  s a measure of t
-0001a170: 6865 2073 6b65 7720 6f66 2074 6865 2020  he skew of the  
-0001a180: 7068 6173 6573 206f 6620 7468 6520 696d  phases of the im
-0001a190: 7065 6461 6e63 6520 0d0a 2020 2020 7465  pedance ..    te
-0001a1a0: 6e73 6f72 2e20 5468 6520 7061 7261 6d65  nsor. The parame
-0001a1b0: 7465 7220 6973 2074 6875 7320 756e 6166  ter is thus unaf
-0001a1c0: 6665 6374 6564 2062 7920 7468 6520 6469  fected by the di
-0001a1d0: 7374 6f72 7469 6f6e 200d 0a20 2020 2065  stortion ..    e
-0001a1e0: 6666 6563 742c 2075 6e6c 696b 6520 7468  ffect, unlike th
-0001a1f0: 6520 5377 6966 742d 736b 6577 2061 6e64  e Swift-skew and
-0001a200: 2065 6c6c 6970 7469 6369 7479 2064 696d   ellipticity dim
-0001a210: 656e 7369 6f6e 616c 6974 7920 0d0a 2020  ensionality ..  
-0001a220: 2020 746f 6f6c 7320 5b31 5d5f 2e20 0d0a    tools [1]_. ..
-0001a230: 2020 2020 0d0a 2020 2020 5661 6c75 6573      ..    Values
-0001a240: 206f 6620 3a6d 6174 683a 605c 6574 6160   of :math:`\eta`
-0001a250: 203e 2030 2e33 2061 7265 2063 6f6e 7369   > 0.3 are consi
-0001a260: 6465 7265 6420 746f 2072 6570 7265 7365  dered to represe
-0001a270: 6e74 2033 4420 6461 7461 2e20 0d0a 2020  nt 3D data. ..  
-0001a280: 2020 5068 6173 652d 7365 6e73 6974 6976    Phase-sensitiv
-0001a290: 6520 736b 6577 7320 6c65 7373 2074 6861  e skews less tha
-0001a2a0: 6e20 302e 3120 696e 6469 6361 7465 2031  n 0.1 indicate 1
-0001a2b0: 442c 2032 4420 6f72 2064 6973 746f 7274  D, 2D or distort
-0001a2c0: 6564 200d 0a20 2020 2032 4420 2833 2d44  ed ..    2D (3-D
-0001a2d0: 202f 322d 4429 2063 6173 6573 2e20 5661   /2-D) cases. Va
-0001a2e0: 6c75 6573 206f 6620 3a6d 6174 683a 605c  lues of :math:`\
-0001a2f0: 6574 6160 2062 6574 7765 656e 2030 2e31  eta` between 0.1
-0001a300: 2061 6e64 2030 2e33 2069 6e64 6963 6174   and 0.3 indicat
-0001a310: 6573 200d 0a20 2020 206d 6f64 6966 6965  es ..    modifie
-0001a320: 6420 3344 2f32 4420 7374 7275 6374 7572  d 3D/2D structur
-0001a330: 6573 205b 325d 5f20 6163 636f 7264 696e  es [2]_ accordin
-0001a340: 6720 746f 2060 4261 6872 2720 6d65 7468  g to `Bahr' meth
-0001a350: 6f64 732e 2048 6f77 6576 6572 2c0d 0a20  ods. However,.. 
-0001a360: 2020 2076 616c 7565 7320 3a6d 6174 683a     values :math:
-0001a370: 605c 6574 6120 3e3d 302e 3260 2075 7369  `\eta >=0.2` usi
-0001a380: 6e67 2074 6865 2060 5377 6966 7460 206d  ng the `Swift` m
-0001a390: 6574 686f 6473 2c20 7468 6520 736d 616c  ethods, the smal
-0001a3a0: 6c65 7220 7468 6520 7661 6c75 6520 0d0a  ler the value ..
-0001a3b0: 2020 2020 3a6d 6174 683a 605c 6574 6160      :math:`\eta`
-0001a3c0: 2028 2063 6c6f 7365 2074 6f20 3a6d 6174   ( close to :mat
-0001a3d0: 683a 6030 2e60 292c 2074 6865 2063 6c6f  h:`0.`), the clo
-0001a3e0: 7365 7220 7468 6520 7374 7275 6374 7572  ser the structur
-0001a3f0: 6520 746f 2032 4420 0d0a 2020 2020 7374  e to 2D ..    st
-0001a400: 7275 6374 7572 6520 616e 6420 7669 6365  ructure and vice
-0001a410: 2076 6572 7361 2e48 6f77 6576 6572 2c20   versa.However, 
-0001a420: 6974 2069 7320 6765 6e65 7261 6c6c 7920  it is generally 
-0001a430: 636f 6e73 6964 6572 6564 2074 6861 7420  considered that 
-0001a440: 0d0a 2020 2020 616e 2065 6c65 6374 7269  ..    an electri
-0001a450: 6361 6c20 7374 7275 6374 7572 6520 6f66  cal structure of
-0001a460: 203a 6d61 7468 3a60 5c65 7461 203c 2030   :math:`\eta < 0
-0001a470: 2e34 6020 6361 6e20 6265 2074 7265 6174  .4` can be treat
-0001a480: 6564 2061 7320 6120 3244 200d 0a20 2020  ed as a 2D ..   
-0001a490: 206d 6564 6975 6d2e 2048 6572 6520 6173   medium. Here as
-0001a4a0: 2074 6865 2060 6074 6872 6573 686f 6c64   the ``threshold
-0001a4b0: 5f6c 696e 6560 6020 666f 7220 3a6d 6574  _line`` for :met
-0001a4c0: 683a 605c 6574 6160 2075 7369 6e67 2074  h:`\eta` using t
-0001a4d0: 6865 200d 0a20 2020 2053 7769 6674 206d  he ..    Swift m
-0001a4e0: 6574 686f 6420 7368 6f75 6c64 2062 6520  ethod should be 
-0001a4f0: 7365 7420 6173 2060 302e 3460 2e20 0d0a  set as `0.4`. ..
-0001a500: 2020 2020 0d0a 2020 2020 2e2e 2076 6572      ..    .. ver
-0001a510: 7369 6f6e 6164 6465 643a 3a20 302e 312e  sionadded:: 0.1.
-0001a520: 3520 0d0a 2020 2020 0d0a 2020 2020 5061  5 ..    ..    Pa
-0001a530: 7261 6d65 7465 7273 0d0a 2020 2020 2d2d  rameters..    --
-0001a540: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2065  ---------..    e
-0001a550: 6469 5f6f 626a 3a20 7374 722c 203a 636c  di_obj: str, :cl
-0001a560: 6173 733a 6077 6174 6578 2e65 6469 2e45  ass:`watex.edi.E
-0001a570: 6469 6020 0d0a 2020 2020 2020 2020 4675  di` ..        Fu
-0001a580: 6c6c 2070 6174 6820 746f 2065 6469 6669  ll path to edifi
-0001a590: 6c65 7320 6f72 2020 3a63 6c61 7373 3a60  les or  :class:`
-0001a5a0: 7e77 6174 6578 2e65 6469 2e45 6469 6020  ~watex.edi.Edi` 
-0001a5b0: 6f62 6a65 6374 2e20 0d0a 2020 2020 2020  object. ..      
-0001a5c0: 2020 0d0a 2020 2020 6d65 7468 6f64 3a20    ..    method: 
-0001a5d0: 7374 722c 2064 6566 6175 6c74 3d27 4261  str, default='Ba
-0001a5e0: 6872 273a 200d 0a20 2020 2020 2020 204b  hr': ..        K
-0001a5f0: 696e 6420 6f66 2063 6f72 7265 6374 696f  ind of correctio
-0001a600: 6e2e 2043 616e 2062 6520 6060 7377 6966  n. Can be ``swif
-0001a610: 7460 6020 666f 7220 7468 6520 7265 6d6f  t`` for the remo
-0001a620: 7665 2064 6973 746f 7273 696f 6e20 7072  ve distorsion pr
-0001a630: 6f70 6f73 6564 200d 0a20 2020 2020 2020  oposed ..       
-0001a640: 2062 7920 5377 6966 7420 696e 2031 3936   by Swift in 196
-0001a650: 3720 5b33 5d5f 2e20 5468 6520 7661 6c75  7 [3]_. The valu
-0001a660: 6520 636c 6f73 6520 746f 2030 2e20 6173  e close to 0. as
-0001a670: 7375 6d65 2074 6865 2031 4420 616e 6420  sume the 1D and 
-0001a680: 3244 200d 0a20 2020 2020 2020 2073 7472  2D ..        str
-0001a690: 7563 7475 7265 732c 2061 6e64 2033 4420  uctures, and 3D 
-0001a6a0: 6f74 6865 7277 6973 652e 2043 6f6e 7665  otherwise. Conve
-0001a6b0: 7273 6c79 2074 6f20 6060 6261 6872 6060  rsly to ``bahr``
-0001a6c0: 2066 6f72 2074 6865 2072 656d 6f76 6520   for the remove 
-0001a6d0: 0d0a 2020 2020 2020 2020 6469 7374 6f72  ..        distor
-0001a6e0: 7369 6f6e 2070 726f 706f 7365 6420 2062  sion proposed  b
-0001a6f0: 7920 4261 6872 2069 6e20 3139 3931 205b  y Bahr in 1991 [
-0001a700: 325d 5f2e 2054 6865 206c 6174 7465 7220  2]_. The latter 
-0001a710: 7468 7265 7368 6f6c 6420 6973 2073 6574  threshold is set
-0001a720: 200d 0a20 2020 2020 2020 2074 6f20 302e   ..        to 0.
-0001a730: 332e 2041 626f 7665 2074 6869 7320 7661  3. Above this va
-0001a740: 6c75 6520 7468 6520 7374 7275 6374 7572  lue the structur
-0001a750: 6573 2069 7320 3344 2e20 0d0a 2020 2020  es is 3D. ..    
-0001a760: 2020 2020 0d0a 2020 2020 7468 7265 7368      ..    thresh
-0001a770: 6f6c 645f 6c69 6e65 3a20 666c 6f61 742c  old_line: float,
-0001a780: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-0001a790: 2020 5669 7375 616c 697a 6520 7468 2074    Visualize th t
-0001a7a0: 6872 6573 686f 6c64 206c 696e 652e 2043  hreshold line. C
-0001a7b0: 616e 2062 6520 5b27 6261 6872 272c 2027  an be ['bahr', '
-0001a7c0: 7377 6966 7427 2c20 2762 6f74 6827 5d3a  swift', 'both']:
-0001a7d0: 0d0a 2020 2020 2020 2020 2020 200d 0a20  ..           .. 
-0001a7e0: 2020 2020 2020 2d20 4e6f 7465 2074 6861        - Note tha
-0001a7f0: 7420 7768 656e 206d 6574 686f 6420 6973  t when method is
-0001a800: 2073 6574 2074 6f20 6060 7377 6966 7460   set to ``swift`
-0001a810: 602c 2074 6865 2076 616c 7565 2063 6c6f  `, the value clo
-0001a820: 7365 2074 6f20 636c 6f73 6520 0d0a 2020  se to close ..  
-0001a830: 2020 2020 2020 2074 6f20 3a6d 6174 683a         to :math:
-0001a840: 6030 2e60 2061 7373 756d 6520 7468 6520  `0.` assume the 
-0001a850: 3144 2061 6e64 2032 4420 7374 7275 6374  1D and 2D struct
-0001a860: 7572 6573 2c20 2061 6e64 2033 4420 6f74  ures,  and 3D ot
-0001a870: 6865 7277 6973 652e 200d 0a20 2020 2020  herwise. ..     
-0001a880: 2020 2d20 7768 656e 206d 6574 686f 6420    - when method 
-0001a890: 6973 2073 6574 2074 6f20 6060 4261 6872  is set to ``Bahr
-0001a8a0: 6060 2c20 3a6d 6174 683a 605c 6d75 203e  ``, :math:`\mu >
-0001a8b0: 2030 2e33 6060 2020 6973 2033 4420 7374   0.3``  is 3D st
-0001a8c0: 7275 6374 7572 6573 2c20 0d0a 2020 2020  ructures, ..    
-0001a8d0: 2020 2020 2062 6574 7765 656e 203a 6d61       between :ma
-0001a8e0: 7468 3a60 5b30 2e31 202d 2030 2e33 5d60  th:`[0.1 - 0.3]`
-0001a8f0: 2061 7373 756d 6573 206d 6f64 6966 6965   assumes modifie
-0001a900: 6420 3344 2f32 4420 7374 7275 6374 7572  d 3D/2D structur
-0001a910: 6573 2077 6865 7265 6173 200d 0a20 2020  es whereas ..   
-0001a920: 2020 2020 2020 3a6d 6174 683a 603c 302e        :math:`<0.
-0001a930: 3160 2031 442c 2032 4420 6f72 2064 6973  1` 1D, 2D or dis
-0001a940: 746f 7274 6564 2032 442e 200d 0a20 2020  torted 2D. ..   
-0001a950: 2020 2020 2020 0d0a 2020 2020 6d6f 6465        ..    mode
-0001a960: 3a73 7472 2c20 6f70 7469 6f6e 616c 200d  :str, optional .
-0001a970: 0a20 2020 2020 2020 582d 6178 6973 2063  .       X-axis c
-0001a980: 6f6f 7264 696e 6174 6573 2066 6f72 2076  oordinates for v
-0001a990: 6973 7561 6c69 7361 7469 6f6e 2e20 706c  isualisation. pl
-0001a9a0: 6f74 2065 6974 6865 7220 6060 2766 7265  ot either ``'fre
-0001a9b0: 7175 656e 6379 2760 6020 6f72 0d0a 2020  quency'`` or..  
-0001a9c0: 2020 2020 2060 6027 7065 7269 6f64 7327       ``'periods'
-0001a9d0: 6060 2e20 2054 6865 2064 6566 6175 6c74  ``.  The default
-0001a9e0: 2069 7320 6060 2766 7265 7175 656e 6379   is ``'frequency
-0001a9f0: 2760 6020 0d0a 2020 2020 2020 200d 0a20  '`` ..       .. 
-0001aa00: 2020 2076 6965 773a 2073 7472 2c20 6465     view: str, de
-0001aa10: 6661 756c 743d 2773 6b65 7727 0d0a 2020  fault='skew'..  
-0001aa20: 2020 2020 2070 6861 7365 2073 656e 7369       phase sensi
-0001aa30: 7374 6976 6520 7669 7375 616c 697a 6174  stive visualizat
-0001aa40: 696f 6e2e 2043 616e 2062 6520 726f 7461  ion. Can be rota
-0001aa50: 7469 6f6e 616c 2069 6e76 6172 6961 6e74  tional invariant
-0001aa60: 200d 0a20 2020 2020 2020 6060 696e 7661   ..       ``inva
-0001aa70: 7269 616e 7460 602e 204e 6f74 6520 7468  riant``. Note th
-0001aa80: 6174 2073 6574 7469 6e67 2074 6f20 6060  at setting to ``
-0001aa90: 6d75 6060 206f 7220 6060 696e 7661 7269  mu`` or ``invari
-0001aaa0: 616e 7460 6020 646f 6573 200d 0a20 2020  ant`` does ..   
-0001aab0: 2020 2020 6e6f 7420 6368 616e 6765 2061      not change a
-0001aac0: 6e79 2069 6e74 6572 7072 6574 6174 696f  ny interpretatio
-0001aad0: 6e20 7369 6e63 6520 7468 6520 6469 7374  n since the dist
-0001aae0: 6f72 7469 6f6e 206f 6620 5a20 6172 6520  ortion of Z are 
-0001aaf0: 616c 6c20 0d0a 2020 2020 2020 2072 6f74  all ..       rot
-0001ab00: 6174 696f 6e61 6c20 696e 7661 7269 616e  ational invarian
-0001ab10: 7420 7768 6574 6865 7220 7573 696e 6720  t whether using 
-0001ab20: 7468 6520 6060 4261 6872 6060 206f 7220  the ``Bahr`` or 
-0001ab30: 6060 7377 6966 7460 600d 0a20 2020 2020  ``swift``..     
-0001ab40: 2020 6d65 7468 6f64 732e 200d 0a20 200d    methods. ..  .
-0001ab50: 0a20 2020 2066 6967 5f73 697a 653a 2074  .    fig_size: t
-0001ab60: 7570 6c65 2c20 6465 6661 756c 743d 2028  uple, default= (
-0001ab70: 3130 2c20 3429 200d 0a20 2020 2020 2020  10, 4) ..       
-0001ab80: 204d 6174 706c 6f74 6c69 6220 6669 6775   Matplotlib figu
-0001ab90: 7265 2073 697a 652e 200d 0a20 2020 2020  re size. ..     
-0001aba0: 2020 200d 0a20 2020 2073 6176 6566 6967     ..    savefig
-0001abb0: 3a20 7374 722c 206f 7074 696f 6e61 6c20  : str, optional 
-0001abc0: 0d0a 2020 2020 2020 2020 2053 6176 6520  ..         Save 
-0001abd0: 6669 6775 7265 206e 616d 652e 2054 6865  figure name. The
-0001abe0: 2064 6566 6175 6c74 2072 6573 6f6c 7574   default resolut
-0001abf0: 696f 6e20 646f 742d 7065 722d 696e 6368  ion dot-per-inch
-0001ac00: 2069 7320 6060 3330 3060 602e 200d 0a20   is ``300``. .. 
-0001ac10: 2020 2020 2020 2020 0d0a 2020 2020 7374          ..    st
-0001ac20: 796c 653a 2073 7472 2c20 6465 6661 756c  yle: str, defaul
-0001ac30: 743d 2763 6c61 7373 6963 270d 0a20 2020  t='classic'..   
-0001ac40: 2020 2020 204d 6174 706c 6f74 6c69 6220       Matplotlib 
-0001ac50: 706c 6f74 7469 6e67 7320 7374 796c 652e  plottings style.
-0001ac60: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001ac70: 6b77 733a 2064 6963 742c 200d 0a20 2020  kws: dict, ..   
-0001ac80: 2020 2020 4d61 7470 6c6f 746c 6962 2041      Matplotlib A
-0001ac90: 7865 7320 7363 6174 7465 7270 6c6f 7420  xes scatterplot 
-0001aca0: 6164 6469 7469 6f6e 616c 206b 6579 776f  additional keywo
-0001acb0: 7264 7320 6172 6775 6d65 6e74 732e 200d  rds arguments. .
-0001acc0: 0a20 2020 2020 2020 200d 0a20 2020 2052  .        ..    R
-0001acd0: 6574 7572 6e0d 0a20 2020 202d 2d2d 2d2d  eturn..    -----
-0001ace0: 2d2d 2d0d 0a20 2020 2061 783a 204d 6174  ---..    ax: Mat
-0001acf0: 706c 6f74 6c69 622e 7079 706c 6f74 2e41  plotlib.pyplot.A
-0001ad00: 7869 7320 0d0a 2020 2020 2020 2020 5265  xis ..        Re
-0001ad10: 7475 726e 2061 7869 7320 200d 0a20 2020  turn axis  ..   
-0001ad20: 2020 2020 200d 0a20 2020 2053 6565 2041       ..    See A
-0001ad30: 6c73 6f20 0d0a 2020 2020 2d2d 2d2d 2d2d  lso ..    ------
-0001ad40: 2d2d 2d0d 0a20 2020 2077 6174 6578 2e6d  ---..    watex.m
-0001ad50: 6574 686f 6473 2e65 6d2e 5072 6f63 6573  ethods.em.Proces
-0001ad60: 7369 6e67 2e73 6b65 773a 200d 0a20 2020  sing.skew: ..   
-0001ad70: 2020 2020 2053 6b65 7720 6571 7561 7469       Skew equati
-0001ad80: 6f6e 2066 6f72 6d75 6c61 7469 6f6e 732e  on formulations.
-0001ad90: 200d 0a20 2020 2077 6174 6578 2e76 6965   ..    watex.vie
-0001ada0: 772e 5450 6c6f 742e 706c 6f74 536b 6577  w.TPlot.plotSkew
-0001adb0: 3a20 0d0a 2020 2020 2020 2020 4769 7665  : ..        Give
-0001adc0: 2061 2063 6f6e 7369 7374 656e 7420 706c   a consistent pl
-0001add0: 6f74 2077 6865 7265 2075 7365 7220 6361  ot where user ca
-0001ade0: 6e20 6375 7374 6f6d 697a 6520 7468 6520  n customize the 
-0001adf0: 706c 6f74 2075 7369 6e67 2074 6865 200d  plot using the .
-0001ae00: 0a20 2020 2020 2020 2070 6c6f 7420 7061  .        plot pa
-0001ae10: 7261 6d65 7465 7220 6f66 203a 636c 6173  rameter of :clas
-0001ae20: 733a 6077 6174 6578 2e70 726f 7065 7274  s:`watex.propert
-0001ae30: 792e 4261 7365 506c 6f74 6020 636c 6173  y.BasePlot` clas
-0001ae40: 732e 0d0a 2020 2020 2020 2020 0d0a 2020  s...        ..  
-0001ae50: 2020 5265 6665 7265 6e63 6573 200d 0a20    References .. 
-0001ae60: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a     -----------..
-0001ae70: 2020 2020 2e2e 205b 315d 2042 6168 722c      .. [1] Bahr,
-0001ae80: 204b 2e20 2831 3938 3829 2049 6e74 6572   K. (1988) Inter
-0001ae90: 7072 6574 6174 696f 6e20 6f66 2074 6865  pretation of the
-0001aea0: 206d 6167 6e65 746f 7465 6c6c 7572 6963   magnetotelluric
-0001aeb0: 2069 6d70 6564 616e 6365 200d 0a20 2020   impedance ..   
-0001aec0: 2020 2020 2020 2020 7465 6e73 6f72 3a20          tensor: 
-0001aed0: 7265 6769 6f6e 616c 2069 6e64 7563 7469  regional inducti
-0001aee0: 6f6e 2033 3935 2061 6e64 206c 6f63 616c  on 395 and local
-0001aef0: 2074 656c 6c75 7269 6320 6469 7374 6f72   telluric distor
-0001af00: 7469 6f6e 2e20 4a2e 200d 0a20 2020 2020  tion. J. ..     
-0001af10: 2020 2020 2020 4765 6f70 6879 732e 2052        Geophys. R
-0001af20: 6573 2e2c 2036 322c 2031 3139 e280 9331  es., 62, 119...1
-0001af30: 3237 2e0d 0a20 2020 202e 2e20 5b32 5d20  27...    .. [2] 
-0001af40: 4261 6872 2c20 4b2e 2028 3139 3931 2920  Bahr, K. (1991) 
-0001af50: 4765 6f6c 6f67 6963 616c 206e 6f69 7365  Geological noise
-0001af60: 2069 6e20 6d61 676e 6574 6f74 656c 6c75   in magnetotellu
-0001af70: 7269 6320 6461 7461 3a20 0d0a 2020 2020  ric data: ..    
-0001af80: 2020 2020 2020 2061 2063 6c61 7373 6966         a classif
-0001af90: 6963 6174 696f 6e20 6f66 2064 6973 746f  ication of disto
-0001afa0: 7274 696f 6e20 7479 7065 732e 2033 3937  rtion types. 397
-0001afb0: 2050 6879 732e 2045 6172 7468 2050 6c61   Phys. Earth Pla
-0001afc0: 6e65 742e 200d 0a20 2020 2020 2020 2020  net. ..         
-0001afd0: 2020 496e 7465 722e 2c20 3636 2c20 3234    Inter., 66, 24
-0001afe0: e280 9333 382e 0d0a 2020 2020 2e2e 205b  ...38...    .. [
-0001aff0: 335d 2042 6168 722c 204b 2e2c 2031 3939  3] Bahr, K., 199
-0001b000: 312e 2047 656f 6c6f 6769 6361 6c20 6e6f  1. Geological no
-0001b010: 6973 6520 696e 206d 6167 6e65 746f 7465  ise in magnetote
-0001b020: 6c6c 7572 6963 2064 6174 613a 2061 200d  lluric data: a .
-0001b030: 0a20 2020 2020 2020 2020 2020 636c 6173  .           clas
-0001b040: 7369 6669 6361 7469 6f6e 206f 6620 6469  sification of di
-0001b050: 7374 6f72 7469 6f6e 2074 7970 6573 2e20  stortion types. 
-0001b060: 5068 7973 6963 7320 6f66 2074 6865 2045  Physics of the E
-0001b070: 6172 7468 2061 6e64 200d 0a20 2020 2020  arth and ..     
-0001b080: 2020 2020 2020 506c 616e 6574 6172 7920        Planetary 
-0001b090: 496e 7465 7269 6f72 7320 3636 2028 31e2  Interiors 66 (1.
-0001b0a0: 8093 3229 2c20 3234 e280 9333 382e 2020  ..2), 24...38.  
-0001b0b0: 0d0a 2020 2020 4578 616d 706c 6573 200d  ..    Examples .
-0001b0c0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 0d0a  .    ---------..
-0001b0d0: 2020 2020 3e3e 3e20 696d 706f 7274 2077      >>> import w
-0001b0e0: 6174 6578 2061 7320 7778 200d 0a20 2020  atex as wx ..   
-0001b0f0: 203e 3e3e 2066 726f 6d20 7761 7465 782e   >>> from watex.
-0001b100: 7574 696c 732e 706c 6f74 7574 696c 7320  utils.plotutils 
-0001b110: 696d 706f 7274 2070 6c6f 745f 736b 6577  import plot_skew
-0001b120: 200d 0a20 2020 203e 3e3e 2065 6469 5f73   ..    >>> edi_s
-0001b130: 6b20 3d20 7778 2e66 6574 6368 5f64 6174  k = wx.fetch_dat
-0001b140: 6120 2822 6564 6973 222c 2072 6574 7572  a ("edis", retur
-0001b150: 6e5f 6461 7461 203d 5472 7565 202c 2073  n_data =True , s
-0001b160: 616d 706c 6573 203d 2032 3020 2920 0d0a  amples = 20 ) ..
-0001b170: 2020 2020 3e3e 3e20 706c 6f74 5f73 6b65      >>> plot_ske
-0001b180: 7720 2865 6469 5f73 6b29 200d 0a20 2020  w (edi_sk) ..   
-0001b190: 203e 3e3e 2070 6c6f 745f 736b 6577 2028   >>> plot_skew (
-0001b1a0: 6564 695f 736b 2c20 7468 7265 7368 6f6c  edi_sk, threshol
-0001b1b0: 645f 6c69 6e65 3d20 5472 7565 2920 0d0a  d_line= True) ..
-0001b1c0: 2020 2020 0d0a 2020 2020 2222 220d 0a20      ..    """.. 
-0001b1d0: 2020 2069 6620 7374 796c 6520 6973 206e     if style is n
-0001b1e0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-0001b1f0: 2020 706c 742e 7374 796c 652e 7573 6520    plt.style.use 
-0001b200: 2873 7479 6c65 2029 0d0a 2020 2020 2020  (style )..      
-0001b210: 2020 0d0a 2020 2020 7669 6577 203d 2076    ..    view = v
-0001b220: 6965 7720 6f72 2027 736b 6577 270d 0a20  iew or 'skew'.. 
-0001b230: 2020 200d 0a20 2020 2069 6620 2827 696e     ..    if ('in
-0001b240: 7627 2020 696e 2073 7472 2028 7669 6577  v'  in str (view
-0001b250: 292e 6c6f 7765 7228 290d 0a20 2020 2020  ).lower()..     
-0001b260: 2020 206f 7220 2772 6f74 2720 696e 2073     or 'rot' in s
-0001b270: 7472 2028 7669 6577 292e 6c6f 7765 7228  tr (view).lower(
-0001b280: 290d 0a20 2020 2020 2020 206f 7220 276d  )..        or 'm
-0001b290: 7527 2069 6e20 7374 7220 2876 6965 7729  u' in str (view)
-0001b2a0: 2e6c 6f77 6572 2829 0d0a 2020 2020 2020  .lower()..      
-0001b2b0: 2020 2920 3a20 0d0a 2020 2020 2020 2020    ) : ..        
-0001b2c0: 7669 6577 203d 276d 7527 0d0a 2020 2020  view ='mu'..    
-0001b2d0: 2020 2020 0d0a 2020 2020 6966 2027 7065      ..    if 'pe
-0001b2e0: 7269 6f64 2720 696e 2073 7472 286d 6f64  riod' in str(mod
-0001b2f0: 6529 2e6c 6f77 6572 2829 3a20 0d0a 2020  e).lower(): ..  
-0001b300: 2020 2020 2020 6d6f 6465 203d 2770 6572        mode ='per
-0001b310: 696f 6427 0d0a 2020 2020 2020 2020 0d0a  iod'..        ..
-0001b320: 2020 2020 6966 2073 7472 2874 6872 6573      if str(thres
-0001b330: 686f 6c64 5f6c 696e 6529 2e6c 6f77 6572  hold_line).lower
-0001b340: 2829 3d3d 2774 7275 6527 3a20 0d0a 2020  ()=='true': ..  
-0001b350: 2020 2020 2020 7468 7265 7368 6f6c 645f        threshold_
-0001b360: 6c69 6e65 203d 2073 7472 286d 6574 686f  line = str(metho
-0001b370: 6429 2e6c 6f77 6572 2829 200d 0a20 2020  d).lower() ..   
-0001b380: 2020 2020 2020 2020 200d 0a20 2020 2069           ..    i
-0001b390: 6d70 6f72 7420 7761 7465 7820 6173 2077  mport watex as w
-0001b3a0: 7820 0d0a 2020 2020 706f 203d 2020 7778  x ..    po =  wx
-0001b3b0: 2e45 4d50 726f 6365 7373 696e 6728 292e  .EMProcessing().
-0001b3c0: 6669 7428 6564 695f 6f62 6a29 0d0a 2020  fit(edi_obj)..  
-0001b3d0: 2020 0d0a 2020 2020 2320 7265 6d6f 7665    ..    # remove
-0001b3e0: 2074 6865 206f 7574 6c69 6572 7320 696e   the outliers in
-0001b3f0: 2074 6865 2064 6174 610d 0a20 2020 2023   the data..    #
-0001b400: 2061 6e64 2066 696c 6c65 6420 7769 7468   and filled with
-0001b410: 204e 614e 200d 0a20 2020 2073 6b65 772c   NaN ..    skew,
-0001b420: 206d 7520 3d70 6f2e 736b 6577 286d 6574   mu =po.skew(met
-0001b430: 686f 6420 3d20 6d65 7468 6f64 2c20 7375  hod = method, su
-0001b440: 7070 7265 7373 5f6f 7574 6c69 6572 7320  ppress_outliers 
-0001b450: 3d20 5472 7565 2020 290d 0a20 2020 2066  = True  )..    f
-0001b460: 7265 7173 203d 2020 312f 2070 6f2e 6672  reqs =  1/ po.fr
-0001b470: 6571 735f 2069 6620 6d6f 6465 203d 3d27  eqs_ if mode =='
-0001b480: 7065 7269 6f64 2720 656c 7365 2070 6f2e  period' else po.
-0001b490: 6672 6571 735f 200d 0a20 2020 2079 6d61  freqs_ ..    yma
-0001b4a0: 7420 3d20 736b 6577 2069 6620 7669 6577  t = skew if view
-0001b4b0: 203d 3d27 736b 6577 2720 656c 7365 206d   =='skew' else m
-0001b4c0: 7520 0d0a 2020 2020 0d0a 2020 2020 6669  u ..    ..    fi
-0001b4d0: 672c 2061 7820 3d20 706c 742e 7375 6270  g, ax = plt.subp
-0001b4e0: 6c6f 7473 2831 2c31 2c20 6669 6773 697a  lots(1,1, figsiz
-0001b4f0: 6520 3d66 6967 5f73 697a 6529 0d0a 0d0a  e =fig_size)....
-0001b500: 2020 2020 232d 2d2d 6d61 6e61 6765 2074      #---manage t
-0001b510: 6872 6573 686f 6c64 206c 696e 6520 2d2d  hreshold line --
-0001b520: 2d2d 2d2d 0d0a 2020 2020 7468 725f 636f  ----..    thr_co
-0001b530: 6465 203d 207b 2262 6168 7222 3a20 5b31  de = {"bahr": [1
-0001b540: 5d20 2c20 2273 7769 6674 223a 5b20 325d  ] , "swift":[ 2]
-0001b550: 202c 2027 626f 7468 273a 5b31 2c20 325d   , 'both':[1, 2]
-0001b560: 207d 0d0a 0d0a 2020 2020 2020 2020 0d0a   }....        ..
-0001b570: 2020 2020 6966 2074 6872 6573 686f 6c64      if threshold
-0001b580: 5f6c 696e 6520 6973 206e 6f74 204e 6f6e  _line is not Non
-0001b590: 653a 200d 0a20 2020 2020 2020 2069 6620  e: ..        if 
-0001b5a0: 7374 7228 7468 7265 7368 6f6c 645f 6c69  str(threshold_li
-0001b5b0: 6e65 292e 6c6f 7765 7228 2920 696e 2028  ne).lower() in (
-0001b5c0: 222a 222c 2022 626f 7468 2229 3a20 0d0a  "*", "both"): ..
-0001b5d0: 2020 2020 2020 2020 2020 2020 7468 7265              thre
-0001b5e0: 7368 6f6c 645f 6c69 6e65 203d 2027 626f  shold_line = 'bo
-0001b5f0: 7468 270d 0a20 2020 2020 2020 2020 2020  th'..           
-0001b600: 200d 0a20 2020 2063 7420 3d20 7468 725f   ..    ct = thr_
-0001b610: 636f 6465 2e67 6574 2873 7472 2874 6872  code.get(str(thr
-0001b620: 6573 686f 6c64 5f6c 696e 6529 2e6c 6f77  eshold_line).low
-0001b630: 6572 2829 2c20 4e6f 6e65 2029 200d 0a20  er(), None ) .. 
-0001b640: 2020 200d 0a20 2020 2066 6f72 2069 2069     ..    for i i
-0001b650: 6e20 7261 6e67 6520 2873 6b65 772e 7368  n range (skew.sh
-0001b660: 6170 655b 315d 293a 200d 0a20 2020 2020  ape[1]): ..     
-0001b670: 2020 2061 782e 7363 6174 7465 7220 2820     ax.scatter ( 
-0001b680: 6672 6571 732c 2072 6573 6861 7065 2028  freqs, reshape (
-0001b690: 796d 6174 5b3a 2c20 695d 292c 2a2a 6b77  ymat[:, i]),**kw
-0001b6a0: 7320 290d 0a20 2020 2020 2020 200d 0a20  s )..        .. 
-0001b6b0: 2020 2069 6620 6374 3a20 0d0a 2020 2020     if ct: ..    
-0001b6c0: 2020 2020 666f 7220 6d20 696e 2063 743a      for m in ct:
-0001b6d0: 200d 0a20 2020 2020 2020 2020 2020 2070   ..            p
-0001b6e0: 6c74 2e61 7868 6c69 6e65 2879 3d30 2e34  lt.axhline(y=0.4
-0001b6f0: 2069 6620 6d3d 3d32 2065 6c73 6520 302e   if m==2 else 0.
-0001b700: 3320 2c20 636f 6c6f 723d 226b 2220 6966  3 , color="k" if
-0001b710: 206d 3d3d 3120 656c 7365 2022 7222 2c0d   m==1 else "r",.
-0001b720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b730: 2020 2020 2020 2020 206c 696e 6573 7479           linesty
-0001b740: 6c65 3d22 2d22 2c0d 0a20 2020 2020 2020  le="-",..       
-0001b750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b760: 206c 6162 656c 3d66 2774 6872 6573 686f   label=f'thresho
-0001b770: 6c64 3a20 245c 6d75 3d7b 302e 3420 6966  ld: $\mu={0.4 if
-0001b780: 206d 3d3d 3220 656c 7365 2030 2e33 7d24   m==2 else 0.3}$
-0001b790: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-0001b7a0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-0001b7b0: 2020 2020 2020 2020 2020 6178 2e6c 6567            ax.leg
-0001b7c0: 656e 6428 2920 0d0a 0d0a 2020 2020 6178  end() ....    ax
-0001b7d0: 2e73 6574 5f78 7363 616c 6528 276c 6f67  .set_xscale('log
-0001b7e0: 2729 0d0a 2020 2020 0d0a 2020 2020 6178  ')..    ..    ax
-0001b7f0: 2e73 6574 5f78 6c61 6265 6c28 2750 6572  .set_xlabel('Per
-0001b800: 696f 6420 2824 7324 2927 2069 6620 6d6f  iod ($s$)' if mo
-0001b810: 6465 3d3d 2770 6572 696f 6427 200d 0a20  de=='period' .. 
-0001b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b830: 2065 6c73 6520 2746 7265 7175 656e 6379   else 'Frequency
-0001b840: 2028 2448 5f7a 2429 2729 0d0a 2020 2020   ($H_z$)')..    
-0001b850: 6178 2e73 6574 5f79 6c61 6265 6c28 6622  ax.set_ylabel(f"
-0001b860: 7b27 536b 6577 2720 6966 2076 6965 7720  {'Skew' if view 
-0001b870: 3d3d 2773 6b65 7727 2065 6c73 6520 2752  =='skew' else 'R
-0001b880: 6f74 2e49 6e76 6172 6961 6e74 277d 2220  ot.Invariant'}" 
-0001b890: 2b20 2228 245c 6d75 2429 2229 0d0a 0d0a  + "($\mu$)")....
-0001b8a0: 2020 2020 706c 742e 786c 696d 2028 5b20      plt.xlim ([ 
-0001b8b0: 6672 6571 732e 6d69 6e28 2920 2c20 6672  freqs.min() , fr
-0001b8c0: 6571 732e 6d61 7828 295d 290d 0a20 2020  eqs.max()])..   
-0001b8d0: 200d 0a20 2020 2023 706c 742e 786c 696d   ..    #plt.xlim
-0001b8e0: 2829 200d 0a0d 0a20 2020 2069 6620 7361  () ....    if sa
-0001b8f0: 7665 6669 6720 6973 206e 6f74 2020 4e6f  vefig is not  No
-0001b900: 6e65 3a20 0d0a 2020 2020 2020 2020 7361  ne: ..        sa
-0001b910: 7665 6669 6775 7265 2028 6669 672c 2073  vefigure (fig, s
-0001b920: 6176 6566 6967 2c20 6470 6920 3d20 3330  avefig, dpi = 30
-0001b930: 3029 0d0a 2020 2020 2020 2020 0d0a 2020  0)..        ..  
-0001b940: 2020 706c 742e 636c 6f73 6520 2829 2069    plt.close () i
-0001b950: 6620 7361 7665 6669 6720 6973 206e 6f74  f savefig is not
-0001b960: 204e 6f6e 6520 656c 7365 2070 6c74 2e73   None else plt.s
-0001b970: 686f 7728 2920 0d0a 2020 2020 0d0a 2020  how() ..    ..  
-0001b980: 2020 7265 7475 726e 2061 7820 0d0a 0d0a    return ax ....
-0001b990: 6465 6620 5f66 6f72 6d61 745f 7469 636b  def _format_tick
-0001b9a0: 7320 2876 616c 7565 2c20 7469 636b 5f6e  s (value, tick_n
-0001b9b0: 756d 6265 722c 2066 6d74 203d 2753 7b3a  umber, fmt ='S{:
-0001b9c0: 3032 7d27 2c20 6e73 6b69 7020 3d37 2029  02}', nskip =7 )
-0001b9d0: 3a0d 0a20 2020 2022 2222 2046 6f72 6d61  :..    """ Forma
-0001b9e0: 7420 7468 6963 6b20 7061 7261 6d65 7465  t thick paramete
-0001b9f0: 7220 7769 7468 2027 4675 6e63 466f 726d  r with 'FuncForm
-0001ba00: 6174 7465 7228 6675 6e63 2927 0d0a 2020  atter(func)'..  
-0001ba10: 2020 7261 7468 6572 2074 6861 6e20 7573    rather than us
-0001ba20: 696e 6720 6061 7869 2e78 6178 6973 2e73  ing `axi.xaxis.s
-0001ba30: 6574 5f6d 616a 6f72 5f6c 6f63 6174 6f72  et_major_locator
-0001ba40: 2028 706c 742e 4d61 784e 4c6f 6361 746f   (plt.MaxNLocato
-0001ba50: 7228 3329 2960 0d0a 2020 2020 6178 2e78  r(3))`..    ax.x
-0001ba60: 6178 6973 2e73 6574 5f6d 616a 6f72 5f66  axis.set_major_f
-0001ba70: 6f72 6d61 7474 6572 2028 706c 742e 4675  ormatter (plt.Fu
-0001ba80: 6e63 466f 726d 6174 7465 7228 666f 726d  ncFormatter(form
-0001ba90: 6174 5f74 6869 636b 7329 290d 0a20 2020  at_thicks))..   
-0001baa0: 200d 0a20 2020 203a 7061 7261 6d20 7661   ..    :param va
-0001bab0: 6c75 653a 2074 6963 6b20 7261 6e67 6520  lue: tick range 
-0001bac0: 7661 6c75 6573 2066 6f72 2066 6f72 6d61  values for forma
-0001bad0: 7474 696e 6720 0d0a 2020 2020 3a70 6172  tting ..    :par
-0001bae0: 616d 2074 6963 6b5f 6e75 6d62 6572 3a20  am tick_number: 
-0001baf0: 6e75 6d62 6572 206f 6620 7469 636b 7320  number of ticks 
-0001bb00: 746f 2066 6f72 6d61 7420 0d0a 2020 2020  to format ..    
-0001bb10: 3a70 6172 616d 2066 6d74 3a20 7374 722c  :param fmt: str,
-0001bb20: 2064 6566 6175 6c74 3d27 537b 3a30 327d   default='S{:02}
-0001bb30: 272c 206b 696e 6420 6f66 2074 6963 6b20  ', kind of tick 
-0001bb40: 666f 726d 6174 6167 6520 0d0a 2020 2020  formatage ..    
-0001bb50: 3a70 6172 616d 206e 736b 6970 3a20 696e  :param nskip: in
-0001bb60: 742c 2064 6566 6175 6c74 203d 372c 206e  t, default =7, n
-0001bb70: 756d 6265 7220 6f66 2074 6963 6b20 746f  umber of tick to
-0001bb80: 2073 6b69 7020 0d0a 2020 2020 0d0a 2020   skip ..    ..  
-0001bb90: 2020 2222 220d 0a20 2020 2069 6620 7661    """..    if va
-0001bba0: 6c75 6520 2520 6e73 6b69 703d 3d30 3a20  lue % nskip==0: 
-0001bbb0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0001bbc0: 2066 6d74 2e66 6f72 6d61 7428 696e 7428   fmt.format(int(
-0001bbd0: 7661 6c75 6529 2b20 3129 0d0a 2020 2020  value)+ 1)..    
-0001bbe0: 656c 7365 3a20 4e6f 6e65 200d 0a20 2020  else: None ..   
-0001bbf0: 200d 0a23 5858 5820 4f50 5449 4d49 5a45   ..#XXX OPTIMIZE
-0001bc00: 200d 0a64 6566 2070 6c6f 745f 636f 6e66   ..def plot_conf
-0001bc10: 6964 656e 6365 2028 0d0a 2020 2020 6461  idence (..    da
-0001bc20: 7461 203d 204e 6f6e 652c 200d 0a20 2020  ta = None, ..   
-0001bc30: 202a 2c20 200d 0a20 2020 2079 3d4e 6f6e   *,  ..    y=Non
-0001bc40: 652c 200d 0a20 2020 2078 3d4e 6f6e 652c  e, ..    x=None,
-0001bc50: 200d 0a20 2020 2063 6920 3d2e 3935 202c   ..    ci =.95 ,
-0001bc60: 2020 0d0a 2020 2020 6b69 6e64 203d 276c    ..    kind ='l
-0001bc70: 696e 6527 2c20 0d0a 2020 2020 625f 7361  ine', ..    b_sa
-0001bc80: 6d70 6c65 7320 3d20 3130 3030 2c20 0d0a  mples = 1000, ..
-0001bc90: 2020 2020 2a2a 736e 735f 6b77 730d 0a20      **sns_kws.. 
-0001bca0: 2020 2029 3a20 0d0a 2020 2020 2222 2220     ): ..    """ 
-0001bcb0: 506c 6f74 2063 6f6e 6669 6465 6e63 6520  Plot confidence 
-0001bcc0: 6461 7461 200d 0a20 2020 200d 0a20 2020  data ..    ..   
-0001bcd0: 2043 6f6e 6669 6465 6e63 6520 496e 7465   Confidence Inte
-0001bce0: 7276 616c 2028 4349 2920 2069 7320 6120  rval (CI)  is a 
-0001bcf0: 7479 7065 206f 6620 6573 7469 6d61 7465  type of estimate
-0001bd00: 2063 6f6d 7075 7465 6420 6672 6f6d 2074   computed from t
-0001bd10: 6865 2073 7461 7469 7374 6963 7320 0d0a  he statistics ..
-0001bd20: 2020 2020 6f66 2074 6865 206f 6273 6572      of the obser
-0001bd30: 7665 6420 6461 7461 2077 6869 6368 2067  ved data which g
-0001bd40: 6976 6573 2061 2072 616e 6765 206f 6620  ives a range of 
-0001bd50: 7661 6c75 6573 2074 6861 74e2 8099 7320  values that...s 
-0001bd60: 6c69 6b65 6c79 2074 6f20 0d0a 2020 2020  likely to ..    
-0001bd70: 636f 6e74 6169 6e20 6120 706f 7075 6c61  contain a popula
-0001bd80: 7469 6f6e 2070 6172 616d 6574 6572 2077  tion parameter w
-0001bd90: 6974 6820 6120 7061 7274 6963 756c 6172  ith a particular
-0001bda0: 206c 6576 656c 206f 6620 636f 6e66 6964   level of confid
-0001bdb0: 656e 6365 2e0d 0a20 2020 2043 4920 6173  ence...    CI as
-0001bdc0: 2061 2063 6f6e 6365 7074 2077 6173 2070   a concept was p
-0001bdd0: 7574 2066 6f72 7468 2062 7920 4a65 727a  ut forth by Jerz
-0001bde0: 7920 4e65 796d 616e 2069 6e20 6120 7061  y Neyman in a pa
-0001bdf0: 7065 7220 7075 626c 6973 6865 6420 0d0a  per published ..
-0001be00: 2020 2020 696e 2031 3933 372e 2054 6865      in 1937. The
-0001be10: 7265 2061 7265 2076 6172 696f 7573 2074  re are various t
-0001be20: 7970 6573 206f 6620 7468 6520 636f 6e66  ypes of the conf
-0001be30: 6964 656e 6365 2069 6e74 6572 7661 6c2c  idence interval,
-0001be40: 2073 6f6d 6520 6f66 200d 0a20 2020 2074   some of ..    t
-0001be50: 6865 206d 6f73 7420 636f 6d6d 6f6e 6c79  he most commonly
-0001be60: 2075 7365 6420 6f6e 6573 2061 7265 3a20   used ones are: 
-0001be70: 4349 2066 6f72 206d 6561 6e2c 2043 4920  CI for mean, CI 
-0001be80: 666f 7220 7468 6520 6d65 6469 616e 2c20  for the median, 
-0001be90: 4349 2066 6f72 200d 0a20 2020 2074 6865  CI for ..    the
-0001bea0: 2064 6966 6665 7265 6e63 6520 6265 7477   difference betw
-0001beb0: 6565 6e20 6d65 616e 732c 2043 4920 666f  een means, CI fo
-0001bec0: 7220 6120 7072 6f70 6f72 7469 6f6e 2061  r a proportion a
-0001bed0: 6e64 2043 4920 666f 7220 7468 6520 6469  nd CI for the di
-0001bee0: 6666 6572 656e 6365 200d 0a20 2020 2069  fference ..    i
-0001bef0: 6e20 7072 6f70 6f72 7469 6f6e 732e 0d0a  n proportions...
-0001bf00: 2020 2020 0d0a 2020 2020 5061 7261 6d65      ..    Parame
-0001bf10: 7465 7273 200d 0a20 2020 202d 2d2d 2d2d  ters ..    -----
-0001bf20: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2064 6174  -------..    dat
-0001bf30: 613a 2070 616e 6461 732e 4461 7461 4672  a: pandas.DataFr
-0001bf40: 616d 652c 206e 756d 7079 2e6e 6461 7272  ame, numpy.ndarr
-0001bf50: 6179 2c20 6d61 7070 696e 672c 206f 7220  ay, mapping, or 
-0001bf60: 7365 7175 656e 6365 0d0a 2020 2020 2020  sequence..      
-0001bf70: 2049 6e70 7574 2064 6174 6120 7374 7275   Input data stru
-0001bf80: 6374 7572 652e 2045 6974 6865 7220 6120  cture. Either a 
-0001bf90: 6c6f 6e67 2d66 6f72 6d20 636f 6c6c 6563  long-form collec
-0001bfa0: 7469 6f6e 206f 6620 7665 6374 6f72 7320  tion of vectors 
-0001bfb0: 0d0a 2020 2020 2020 2074 6861 7420 6361  ..       that ca
-0001bfc0: 6e20 6265 2061 7373 6967 6e65 6420 746f  n be assigned to
-0001bfd0: 206e 616d 6564 2076 6172 6961 626c 6573   named variables
-0001bfe0: 206f 7220 6120 7769 6465 2d66 6f72 6d20   or a wide-form 
-0001bff0: 6461 7461 7365 7420 0d0a 2020 2020 2020  dataset ..      
-0001c000: 2074 6861 7420 7769 6c6c 2062 6520 696e   that will be in
-0001c010: 7465 726e 616c 6c79 2072 6573 6861 7065  ternally reshape
-0001c020: 642e 0d0a 0d0a 2020 2020 782c 2079 3a20  d.....    x, y: 
-0001c030: 7665 6374 6f72 7320 6f72 206b 6579 7320  vectors or keys 
-0001c040: 696e 2064 6174 610d 0a20 2020 2020 2020  in data..       
-0001c050: 5661 7269 6162 6c65 7320 7468 6174 2073  Variables that s
-0001c060: 7065 6369 6679 2070 6f73 6974 696f 6e73  pecify positions
-0001c070: 206f 6e20 7468 6520 7820 616e 6420 7920   on the x and y 
-0001c080: 6178 6573 2e0d 0a20 2020 2020 2020 0d0a  axes...       ..
-0001c090: 2020 2020 6369 3a20 666c 6f61 742c 2064      ci: float, d
-0001c0a0: 6566 6175 6c74 3d2e 3935 200d 0a20 2020  efault=.95 ..   
-0001c0b0: 2020 2020 436f 6e66 6964 656e 6365 2076      Confidence v
-0001c0c0: 616c 7565 2e20 0d0a 2020 2020 2020 200d  alue. ..       .
-0001c0d0: 0a20 2020 206b 696e 643a 2073 7472 2c20  .    kind: str, 
-0001c0e0: 6465 6661 756c 743d 276c 696e 6527 200d  default='line' .
-0001c0f0: 0a20 2020 2020 2020 6b69 6e64 206f 6620  .       kind of 
-0001c100: 636f 6e66 6964 656e 6365 2069 6e74 6572  confidence inter
-0001c110: 7676 616c 2070 6c6f 742e 200d 0a20 2020  vval plot. ..   
-0001c120: 2020 200d 0a20 2020 2062 5f73 616d 706c     ..    b_sampl
-0001c130: 6573 3a20 696e 742c 2064 6566 6175 6c74  es: int, default
-0001c140: 3d31 3030 300d 0a20 2020 2020 2020 204e  =1000..        N
-0001c150: 756d 6265 7220 6f66 2062 6f6f 7473 7472  umber of bootstr
-0001c160: 6170 7320 746f 2075 7365 2066 6f72 2063  aps to use for c
-0001c170: 6f6d 7075 7469 6e67 2074 6865 2063 6f6e  omputing the con
-0001c180: 6669 6465 6e63 6520 696e 7465 7276 616c  fidence interval
-0001c190: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
-0001c1a0: 2073 6e73 5f6b 7773 3a20 6469 6374 2c20   sns_kws: dict, 
-0001c1b0: 0d0a 2020 2020 2020 204b 6579 776f 7264  ..       Keyword
-0001c1c0: 7320 6172 6775 6d65 6e74 7320 7061 7373  s arguments pass
-0001c1d0: 6564 2074 6f20 7468 6520 6073 6e73 2e6c  ed to the `sns.l
-0001c1e0: 696e 6570 6c6f 7460 206f 7220 6073 6e73  ineplot` or `sns
-0001c1f0: 2e72 6567 706c 6f74 600d 0a20 2020 2020  .regplot`..     
-0001c200: 2020 0d0a 2020 2020 5265 7475 726e 7320    ..    Returns 
-0001c210: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
-0001c220: 0d0a 2020 2020 6178 3a20 6d61 7470 6c6f  ..    ax: matplo
-0001c230: 746c 6962 2e61 7865 732e 4178 6573 0d0a  tlib.axes.Axes..
-0001c240: 2020 2020 2020 2054 6865 206d 6174 706c         The matpl
-0001c250: 6f74 6c69 6220 6178 6573 2063 6f6e 7461  otlib axes conta
-0001c260: 696e 696e 6720 7468 6520 706c 6f74 2e0d  ining the plot..
-0001c270: 0a20 2020 2020 2020 0d0a 2020 2020 2222  .       ..    ""
-0001c280: 2220 2020 0d0a 2020 2020 2379 203d 206e  "   ..    #y = n
-0001c290: 702e 6172 7261 7920 2879 2920 0d0a 2020  p.array (y) ..  
-0001c2a0: 2020 2378 3d20 7820 6f72 2028 206e 702e    #x= x or ( np.
-0001c2b0: 6172 616e 6765 2028 6c65 6e28 7929 2920  arange (len(y)) 
-0001c2c0: 6966 200d 0a20 2020 2061 783d 4e6f 6e65  if ..    ax=None
-0001c2d0: 200d 0a20 2020 2069 6620 276c 696e 2720   ..    if 'lin' 
-0001c2e0: 696e 2073 7472 286b 696e 6429 2e6c 6f77  in str(kind).low
-0001c2f0: 6572 2829 3a20 0d0a 2020 2020 2020 2020  er(): ..        
-0001c300: 6178 203d 2073 6e73 2e6c 696e 6570 6c6f  ax = sns.lineplo
-0001c310: 7428 6461 7461 3d20 6461 7461 2c20 783d  t(data= data, x=
-0001c320: 782c 2079 3d79 2c20 6369 3d63 692c 202a  x, y=y, ci=ci, *
-0001c330: 2a73 6e73 5f6b 7773 290d 0a20 2020 2065  *sns_kws)..    e
-0001c340: 6c69 6620 2772 6567 2720 696e 2020 7374  lif 'reg' in  st
-0001c350: 7228 6b69 6e64 292e 6c6f 7765 7228 293a  r(kind).lower():
-0001c360: 200d 0a20 2020 2020 2020 2061 7820 3d20   ..        ax = 
-0001c370: 736e 732e 7265 6770 6c6f 7428 6461 7461  sns.regplot(data
-0001c380: 203d 2064 6174 612c 2078 3d78 2c20 793d   = data, x=x, y=
-0001c390: 792c 2063 693d 6369 2c20 2a2a 736e 735f  y, ci=ci, **sns_
-0001c3a0: 6b77 7320 2920 0d0a 2020 2020 656c 7365  kws ) ..    else
-0001c3b0: 3a20 0d0a 2020 2020 2020 2020 6966 206e  : ..        if n
-0001c3c0: 6f74 2079 3a20 0d0a 2020 2020 2020 2020  ot y: ..        
-0001c3d0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001c3e0: 7272 6f72 2822 7920 7368 6f75 6c64 206e  rror("y should n
-0001c3f0: 6f74 2062 6520 4e6f 6e65 2077 6865 6e20  ot be None when 
-0001c400: 7573 696e 6720 7468 6520 626f 6f73 7472  using the boostr
-0001c410: 6170 7069 6e67 220d 0a20 2020 2020 2020  apping"..       
-0001c420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c430: 2020 2020 2020 2220 666f 7220 706c 6f74        " for plot
-0001c440: 7469 6e67 2074 6865 2063 6f6e 6669 6465  ting the confide
-0001c450: 6e63 6520 696e 7465 7276 616c 2e22 290d  nce interval.").
-0001c460: 0a20 2020 2020 2020 2062 5f73 616d 706c  .        b_sampl
-0001c470: 6573 203d 205f 6173 7365 7274 5f61 6c6c  es = _assert_all
-0001c480: 5f74 7970 6573 280d 0a20 2020 2020 2020  _types(..       
-0001c490: 2020 2020 2062 5f73 616d 706c 6573 2c20       b_samples, 
-0001c4a0: 696e 742c 2066 6c6f 6174 2c20 6f62 6a6e  int, float, objn
-0001c4b0: 616d 653d 2242 6f6f 7473 7472 6170 2073  ame="Bootstrap s
-0001c4c0: 616d 706c 6573 2060 625f 7361 6d70 6c65  amples `b_sample
-0001c4d0: 7360 2229 0d0a 2020 2020 2020 2020 0d0a  s`")..        ..
-0001c4e0: 2020 2020 2020 2020 6672 6f6d 2073 6b6c          from skl
-0001c4f0: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
-0001c500: 6f72 7420 7265 7361 6d70 6c65 200d 0a20  ort resample .. 
-0001c510: 2020 2020 2020 2023 2063 6f6e 6669 6775         # configu
-0001c520: 7265 2062 6f6f 7473 7472 6170 0d0a 2020  re bootstrap..  
-0001c530: 2020 2020 2020 6e5f 6974 6572 6174 696f        n_iteratio
-0001c540: 6e73 203d 2031 3030 3020 2320 6865 7265  ns = 1000 # here
-0001c550: 206b 3d6e 6f2e 206f 6620 626f 6f74 7374   k=no. of bootst
-0001c560: 7261 7070 6564 2073 616d 706c 6573 0d0a  rapped samples..
-0001c570: 2020 2020 2020 2020 6e5f 7369 7a65 203d          n_size =
-0001c580: 2069 6e74 286c 656e 2879 2929 0d0a 2020   int(len(y))..  
-0001c590: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0001c5a0: 2020 2320 7275 6e20 626f 6f74 7374 7261    # run bootstra
-0001c5b0: 700d 0a20 2020 2020 2020 206d 6564 6961  p..        media
-0001c5c0: 6e73 203d 206c 6973 7428 290d 0a20 2020  ns = list()..   
-0001c5d0: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-0001c5e0: 6e67 6528 6e5f 6974 6572 6174 696f 6e73  nge(n_iterations
-0001c5f0: 293a 0d0a 2020 2020 2020 2020 2020 2073  ):..           s
-0001c600: 203d 2072 6573 616d 706c 6528 792c 206e   = resample(y, n
-0001c610: 5f73 616d 706c 6573 3d6e 5f73 697a 6529  _samples=n_size)
-0001c620: 3b0d 0a20 2020 2020 2020 2020 2020 6d20  ;..           m 
-0001c630: 3d20 6e70 2e6d 6564 6961 6e28 7329 3b0d  = np.median(s);.
-0001c640: 0a20 2020 2020 2020 2020 2020 6d65 6469  .           medi
-0001c650: 616e 732e 6170 7065 6e64 286d 290d 0a20  ans.append(m).. 
-0001c660: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0001c670: 2020 2023 2070 6c6f 7420 7363 6f72 6573     # plot scores
-0001c680: 0d0a 2020 2020 2020 2020 706c 742e 6869  ..        plt.hi
-0001c690: 7374 286d 6564 6961 6e73 290d 0a20 2020  st(medians)..   
-0001c6a0: 2020 2020 2070 6c74 2e73 686f 7728 290d       plt.show().
-0001c6b0: 0a20 2020 2020 2020 2020 200d 0a20 2020  .          ..   
-0001c6c0: 2020 2020 2023 2063 6f6e 6669 6465 6e63       # confidenc
-0001c6d0: 6520 696e 7465 7276 616c 730d 0a20 2020  e intervals..   
-0001c6e0: 2020 2020 2070 203d 2028 2831 2e30 2d63       p = ((1.0-c
-0001c6f0: 6929 2f32 2e30 2920 2a20 3130 300d 0a20  i)/2.0) * 100.. 
-0001c700: 2020 2020 2020 206c 6f77 6572 203d 2020         lower =  
-0001c710: 6e70 2e70 6572 6365 6e74 696c 6528 6d65  np.percentile(me
-0001c720: 6469 616e 732c 2070 290d 0a20 2020 2020  dians, p)..     
-0001c730: 2020 2070 203d 2028 6369 2b28 2831 2e30     p = (ci+((1.0
-0001c740: 2d63 6929 2f32 2e30 2929 202a 2031 3030  -ci)/2.0)) * 100
-0001c750: 0d0a 2020 2020 2020 2020 7570 7065 7220  ..        upper 
-0001c760: 3d20 206e 702e 7065 7263 656e 7469 6c65  =  np.percentile
-0001c770: 286d 6564 6961 6e73 2c20 7029 0d0a 2020  (medians, p)..  
-0001c780: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-0001c790: 6622 5c6e 7b63 692a 3130 307d 2063 6f6e  f"\n{ci*100} con
-0001c7a0: 6669 6465 6e63 6520 696e 7465 7276 616c  fidence interval
-0001c7b0: 207b 6c6f 7765 727d 2061 6e64 207b 7570   {lower} and {up
-0001c7c0: 7065 727d 2229 0d0a 2020 2020 0d0a 2020  per}")..    ..  
-0001c7d0: 2020 7265 7475 726e 2061 7820 0d0a 0d0a    return ax ....
-0001c7e0: 6465 6620 706c 6f74 5f63 6f6e 6669 6465  def plot_confide
-0001c7f0: 6e63 655f 656c 6c69 7073 6520 2878 2c20  nce_ellipse (x, 
-0001c800: 7920 293a 200d 0a20 2020 2022 2222 2050  y ): ..    """ P
-0001c810: 6c6f 7420 6120 636f 6e66 6964 656e 6365  lot a confidence
-0001c820: 2065 6c6c 6970 7365 206f 6620 6120 7477   ellipse of a tw
-0001c830: 6f2d 6469 6d65 6e73 696f 6e61 6c20 6461  o-dimensional da
-0001c840: 7461 7365 7420 0d0a 2020 2020 0d0a 2020  taset ..    ..  
-0001c850: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
-0001c860: 706c 6f74 7320 7468 6520 636f 6e66 6964  plots the confid
+00015770: 6f66 2079 2076 616c 7565 7320 746f 2070  of y values to p
+00015780: 6c6f 740d 0a20 2020 2020 2020 2020 2020  lot..           
+00015790: 2020 2020 2020 200d 0a20 2020 2079 5f65         ..    y_e
+000157a0: 7272 6f72 3a20 6e70 2e6e 6461 7272 6179  rror: np.ndarray
+000157b0: 286e 7829 0d0a 2020 2020 2020 2020 6172  (nx)..        ar
+000157c0: 7261 7920 6f66 2065 7272 6f72 7320 696e  ray of errors in
+000157d0: 2079 2d64 6972 6563 7469 6f6e 2074 6f20   y-direction to 
+000157e0: 706c 6f74 0d0a 2020 2020 0d0a 2020 2020  plot..    ..    
+000157f0: 785f 6572 726f 723a 206e 702e 6e64 6172  x_error: np.ndar
+00015800: 7261 7928 6e73 290d 0a20 2020 2020 2020  ray(ns)..       
+00015810: 2061 7272 6179 206f 6620 6572 726f 7220   array of error 
+00015820: 696e 2078 2d64 6972 6563 7469 6f6e 2074  in x-direction t
+00015830: 6f20 706c 6f74 0d0a 2020 2020 2020 2020  o plot..        
+00015840: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00015850: 636f 6c6f 723a 2073 7472 696e 6720 6f72  color: string or
+00015860: 2028 722c 2067 2c20 6229 0d0a 2020 2020   (r, g, b)..    
+00015870: 2020 2020 636f 6c6f 7220 6f66 206d 6172      color of mar
+00015880: 6b65 722c 206c 696e 6520 616e 6420 6572  ker, line and er
+00015890: 726f 7220 6261 720d 0a20 2020 2020 2020  ror bar..       
+000158a0: 2020 2020 2020 2020 200d 0a20 2020 206d           ..    m
+000158b0: 6172 6b65 723a 2073 7472 696e 670d 0a20  arker: string.. 
+000158c0: 2020 2020 2020 206d 6172 6b65 7220 7479         marker ty
+000158d0: 7065 2074 6f20 706c 6f74 2064 6174 6120  pe to plot data 
+000158e0: 6173 0d0a 2020 2020 2020 2020 2020 2020  as..            
+000158f0: 2020 2020 200d 0a20 2020 206d 733a 2066       ..    ms: f
+00015900: 6c6f 6174 0d0a 2020 2020 2020 2020 7369  loat..        si
+00015910: 7a65 206f 6620 6d61 726b 6572 0d0a 2020  ze of marker..  
+00015920: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00015930: 206c 733a 2073 7472 696e 670d 0a20 2020   ls: string..   
+00015940: 2020 2020 206c 696e 6520 7374 796c 6520       line style 
+00015950: 6265 7477 6565 6e20 6d61 726b 6572 730d  between markers.
+00015960: 0a20 2020 2020 2020 2020 2020 2020 0d0a  .             ..
+00015970: 2020 2020 6c77 3a20 666c 6f61 740d 0a20      lw: float.. 
+00015980: 2020 2020 2020 2077 6964 7468 206f 6620         width of 
+00015990: 6c69 6e65 2062 6574 7765 656e 206d 6172  line between mar
+000159a0: 6b65 7273 0d0a 2020 2020 0d0a 2020 2020  kers..    ..    
+000159b0: 655f 6361 7073 697a 653a 2066 6c6f 6174  e_capsize: float
+000159c0: 0d0a 2020 2020 2020 2020 7369 7a65 206f  ..        size o
+000159d0: 6620 6572 726f 7220 6261 7220 6361 700d  f error bar cap.
+000159e0: 0a20 2020 200d 0a20 2020 2065 5f63 6170  .    ..    e_cap
+000159f0: 7468 6963 6b3a 2066 6c6f 6174 0d0a 2020  thick: float..  
+00015a00: 2020 2020 2020 7468 6963 6b6e 6573 7320        thickness 
+00015a10: 6f66 2065 7272 6f72 2062 6172 2063 6170  of error bar cap
+00015a20: 0d0a 2020 2020 0d0a 2020 2020 7069 636b  ..    ..    pick
+00015a30: 6572 3a20 666c 6f61 740d 0a20 2020 2020  er: float..     
+00015a40: 2020 2020 2072 6164 6975 7320 696e 2070       radius in p
+00015a50: 6f69 6e74 7320 746f 2062 6520 6162 6c65  oints to be able
+00015a60: 2074 6f20 7069 636b 2061 2070 6f69 6e74   to pick a point
+00015a70: 2e20 0d0a 2020 2020 2020 2020 0d0a 2020  . ..        ..  
+00015a80: 2020 2020 2020 0d0a 2020 2020 5265 7475        ..    Retu
+00015a90: 726e 733a 0d0a 2020 2020 2d2d 2d2d 2d2d  rns:..    ------
+00015aa0: 2d2d 2d0d 0a20 2020 2065 7272 6f72 6261  ---..    errorba
+00015ab0: 725f 6f62 6a65 6374 3a20 6d61 7470 6c6f  r_object: matplo
+00015ac0: 746c 6962 2e41 7865 732e 6572 726f 7262  tlib.Axes.errorb
+00015ad0: 6172 200d 0a20 2020 2020 2020 2020 2020  ar ..           
+00015ae0: 6572 726f 7220 6261 7220 6f62 6a65 6374  error bar object
+00015af0: 2063 6f6e 7461 696e 696e 6720 6c69 6e65   containing line
+00015b00: 2064 6174 612c 2065 7272 6f72 6261 7273   data, errorbars
+00015b10: 2c20 6574 632e 0d0a 2020 2020 2222 220d  , etc...    """.
+00015b20: 0a20 2020 2023 2074 6869 7320 6973 2074  .    # this is t
+00015b30: 6f20 6d61 6b65 2073 7572 6520 6572 726f  o make sure erro
+00015b40: 7220 6261 7273 200d 0a20 2020 2023 706c  r bars ..    #pl
+00015b50: 6f74 2069 6e20 6675 6c6c 2061 6e64 206e  ot in full and n
+00015b60: 6f74 206a 7573 7420 6120 6461 7368 6564  ot just a dashed
+00015b70: 206c 696e 650d 0a20 2020 2065 6f62 6a20   line..    eobj 
+00015b80: 3d20 6178 2e65 7272 6f72 6261 7228 0d0a  = ax.errorbar(..
+00015b90: 2020 2020 2020 2020 785f 6172 2c0d 0a20          x_ar,.. 
+00015ba0: 2020 2020 2020 2079 5f61 722c 0d0a 2020         y_ar,..  
+00015bb0: 2020 2020 2020 6d61 726b 6572 3d6d 6172        marker=mar
+00015bc0: 6b65 722c 0d0a 2020 2020 2020 2020 6d73  ker,..        ms
+00015bd0: 3d6d 732c 0d0a 2020 2020 2020 2020 6d66  =ms,..        mf
+00015be0: 633d 274e 6f6e 6527 2c0d 0a20 2020 2020  c='None',..     
+00015bf0: 2020 206d 6577 3d6c 772c 0d0a 2020 2020     mew=lw,..    
+00015c00: 2020 2020 6d65 633d 636f 6c6f 722c 0d0a      mec=color,..
+00015c10: 2020 2020 2020 2020 6c73 3d6c 732c 0d0a          ls=ls,..
+00015c20: 2020 2020 2020 2020 7865 7272 3d78 5f65          xerr=x_e
+00015c30: 7272 2c0d 0a20 2020 2020 2020 2079 6572  rr,..        yer
+00015c40: 723d 795f 6572 722c 0d0a 2020 2020 2020  r=y_err,..      
+00015c50: 2020 6563 6f6c 6f72 3d63 6f6c 6f72 2c0d    ecolor=color,.
+00015c60: 0a20 2020 2020 2020 2063 6f6c 6f72 3d63  .        color=c
+00015c70: 6f6c 6f72 2c0d 0a20 2020 2020 2020 2070  olor,..        p
+00015c80: 6963 6b65 723d 7069 636b 6572 2c0d 0a20  icker=picker,.. 
+00015c90: 2020 2020 2020 206c 773d 6c77 2c0d 0a20         lw=lw,.. 
+00015ca0: 2020 2020 2020 2065 6c69 6e65 7769 6474         elinewidt
+00015cb0: 683d 6c77 2c0d 0a20 2020 2020 2020 2063  h=lw,..        c
+00015cc0: 6170 7369 7a65 3d65 5f63 6170 7369 7a65  apsize=e_capsize
+00015cd0: 2c0d 0a20 2020 2020 2020 2023 2063 6170  ,..        # cap
+00015ce0: 7468 6963 6b3d 655f 6361 7074 6869 636b  thick=e_capthick
+00015cf0: 0d0a 2020 2020 2020 2020 2a2a 6b77 730d  ..        **kws.
+00015d00: 0a20 2020 2020 2020 2020 290d 0a20 2020  .         )..   
+00015d10: 200d 0a20 2020 2072 6574 7572 6e20 656f   ..    return eo
+00015d20: 626a 0d0a 0d0a 6465 6620 6765 745f 636f  bj....def get_co
+00015d30: 6c6f 725f 7061 6c65 7474 6520 2852 4742  lor_palette (RGB
+00015d40: 5f63 6f6c 6f72 5f70 616c 6574 7465 293a  _color_palette):
+00015d50: 200d 0a20 2020 2022 2222 0d0a 2020 2020   ..    """..    
+00015d60: 436f 6e76 6572 7420 5247 4220 636f 6c6f  Convert RGB colo
+00015d70: 7220 696e 746f 206d 6174 706c 6f74 6c69  r into matplotli
+00015d80: 6220 636f 6c6f 7220 7061 6c65 7474 652e  b color palette.
+00015d90: 2049 6e20 7468 6520 5247 4220 636f 6c6f   In the RGB colo
+00015da0: 7220 0d0a 2020 2020 7379 7374 656d 2074  r ..    system t
+00015db0: 776f 2062 6974 7320 6f66 2064 6174 6120  wo bits of data 
+00015dc0: 6172 6520 7573 6564 2066 6f72 2065 6163  are used for eac
+00015dd0: 6820 636f 6c6f 722c 2072 6564 2c20 6772  h color, red, gr
+00015de0: 6565 6e2c 2061 6e64 2062 6c75 652e 200d  een, and blue. .
+00015df0: 0a20 2020 2054 6861 7420 6d65 616e 7320  .    That means 
+00015e00: 7468 6174 2065 6163 6820 636f 6c6f 7220  that each color 
+00015e10: 7275 6e73 6f6e 2061 2073 6361 6c65 2066  runson a scale f
+00015e20: 726f 6d20 3020 746f 2032 3535 2e20 426c  rom 0 to 255. Bl
+00015e30: 6163 6b20 2077 6f75 6c64 2062 650d 0a20  ack  would be.. 
+00015e40: 2020 2030 302c 3030 2c30 302c 2077 6869     00,00,00, whi
+00015e50: 6c65 2077 6869 7465 2077 6f75 6c64 2062  le white would b
+00015e60: 6520 3235 352c 3235 352c 3235 352e 204d  e 255,255,255. M
+00015e70: 6174 706c 6f74 6c69 6220 6861 7320 6c6f  atplotlib has lo
+00015e80: 7473 206f 660d 0a20 2020 2070 7265 2d64  ts of..    pre-d
+00015e90: 6566 696e 6564 2063 6f6c 6f72 6d61 7073  efined colormaps
+00015ea0: 2066 6f72 2075 7320 2e20 5468 6579 2061   for us . They a
+00015eb0: 7265 2061 6c6c 206e 6f72 6d61 6c69 7a65  re all normalize
+00015ec0: 6420 746f 2032 3535 2c20 736f 2074 6865  d to 255, so the
+00015ed0: 7920 7275 6e0d 0a20 2020 2066 726f 6d20  y run..    from 
+00015ee0: 3020 746f 2031 2e20 536f 2079 6f75 206e  0 to 1. So you n
+00015ef0: 6565 6420 6f6e 6c79 206e 6f72 6d61 6c69  eed only normali
+00015f00: 7a65 2064 6174 612c 2074 6865 6e20 7765  ze data, then we
+00015f10: 2063 616e 206d 616e 7561 6c6c 7920 2073   can manually  s
+00015f20: 656c 6563 7420 0d0a 2020 2020 636f 6c6f  elect ..    colo
+00015f30: 7273 2066 726f 6d20 6120 636f 6c6f 7220  rs from a color 
+00015f40: 6d61 7020 200d 0a0d 0a20 2020 203a 7061  map  ....    :pa
+00015f50: 7261 6d20 5247 425f 636f 6c6f 725f 7061  ram RGB_color_pa
+00015f60: 6c65 7474 653a 2073 7472 2076 616c 7565  lette: str value
+00015f70: 206f 6620 5247 4220 7661 6c75 6520 0d0a   of RGB value ..
+00015f80: 2020 2020 3a74 7970 6520 5247 425f 636f      :type RGB_co
+00015f90: 6c6f 725f 7061 6c65 7474 653a 2073 7472  lor_palette: str
+00015fa0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00015fb0: 203a 7265 7475 726e 733a 2072 6762 612c   :returns: rgba,
+00015fc0: 2074 7570 6c65 206f 6620 2852 2c20 472c   tuple of (R, G,
+00015fd0: 2042 290d 0a20 2020 203a 7274 7970 653a   B)..    :rtype:
+00015fe0: 2074 7570 6c65 0d0a 2020 2020 200d 0a20   tuple..     .. 
+00015ff0: 2020 203a 4578 616d 706c 653a 200d 0a20     :Example: .. 
+00016000: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00016010: 203e 3e3e 2066 726f 6d20 7761 7465 782e   >>> from watex.
+00016020: 7574 696c 732e 706c 6f74 7574 696c 7320  utils.plotutils 
+00016030: 696d 706f 7274 2067 6574 5f63 6f6c 6f72  import get_color
+00016040: 5f70 616c 6574 7465 200d 0a20 2020 2020  _palette ..     
+00016050: 2020 203e 3e3e 2067 6574 5f63 6f6c 6f72     >>> get_color
+00016060: 5f70 616c 6574 7465 2028 5247 425f 636f  _palette (RGB_co
+00016070: 6c6f 725f 7061 6c65 7474 6520 3d27 5231  lor_palette ='R1
+00016080: 3238 4231 3238 2729 0d0a 2020 2020 2222  28B128')..    ""
+00016090: 2220 200d 0a20 2020 200d 0a20 2020 2064  "  ..    ..    d
+000160a0: 6566 2061 7363 6572 7461 696e 5f63 7020  ef ascertain_cp 
+000160b0: 2863 7029 3a20 0d0a 2020 2020 2020 2020  (cp): ..        
+000160c0: 6966 2063 7020 3e32 3535 2e20 3a20 0d0a  if cp >255. : ..
+000160d0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+000160e0: 696e 6773 2e77 6172 6e28 0d0a 2020 2020  ings.warn(..    
+000160f0: 2020 2020 2020 2020 2020 2020 2720 2152              ' !R
+00016100: 4742 2076 616c 7565 2069 7320 7261 6e67  GB value is rang
+00016110: 6520 3020 746f 2032 3535 2070 6978 656c  e 0 to 255 pixel
+00016120: 7320 2c20 270d 0a20 2020 2020 2020 2020  s , '..         
+00016130: 2020 2020 2020 2027 6e6f 7420 6265 796f         'not beyo
+00016140: 6e64 2021 2e20 596f 7572 2069 6e70 7574  nd !. Your input
+00016150: 2076 616c 7565 7320 6973 203d 207b 307d   values is = {0}
+00016160: 2e27 2e66 6f72 6d61 7428 6370 2929 0d0a  .'.format(cp))..
+00016170: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00016180: 6520 5661 6c75 6545 7272 6f72 2827 4572  e ValueError('Er
+00016190: 726f 7220 636f 6c6f 7220 5247 4241 2076  ror color RGBA v
+000161a0: 616c 7565 2021 2027 0d0a 2020 2020 2020  alue ! '..      
+000161b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000161c0: 2020 2020 2020 2027 5247 4220 7661 6c75         'RGB valu
+000161d0: 6520 2070 726f 7669 6465 6420 6973 203d  e  provided is =
+000161e0: 207b 307d 2e27 0d0a 2020 2020 2020 2020   {0}.'..        
+000161f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016200: 2020 2020 2720 4974 2069 7320 6c61 7267      ' It is larg
+00016210: 6572 2074 6861 6e20 3235 3520 7069 7865  er than 255 pixe
+00016220: 6c73 2e27 2e66 6f72 6d61 7428 6370 2929  ls.'.format(cp))
+00016230: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00016240: 2063 700d 0a20 2020 2069 6620 6973 696e   cp..    if isin
+00016250: 7374 616e 6365 2852 4742 5f63 6f6c 6f72  stance(RGB_color
+00016260: 5f70 616c 6574 7465 2c28 666c 6f61 742c  _palette,(float,
+00016270: 2069 6e74 2c20 7374 7229 293a 200d 0a20   int, str)): .. 
+00016280: 2020 2020 2020 2074 7279 203a 200d 0a20         try : .. 
+00016290: 2020 2020 2020 2020 2020 2066 6c6f 6174             float
+000162a0: 2852 4742 5f63 6f6c 6f72 5f70 616c 6574  (RGB_color_palet
+000162b0: 7465 290d 0a20 2020 2020 2020 2065 7863  te)..        exc
+000162c0: 6570 7420 3a20 0d0a 2020 2020 2020 2020  ept : ..        
+000162d0: 2020 2020 2020 5247 425f 636f 6c6f 725f        RGB_color_
+000162e0: 7061 6c65 7474 653d 2052 4742 5f63 6f6c  palette= RGB_col
+000162f0: 6f72 5f70 616c 6574 7465 2e6c 6f77 6572  or_palette.lower
+00016300: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00016310: 200d 0a20 2020 2020 2020 2065 6c73 6520   ..        else 
+00016320: 3a20 7265 7475 726e 2061 7363 6572 7461  : return ascerta
+00016330: 696e 5f63 7028 666c 6f61 7428 5247 425f  in_cp(float(RGB_
+00016340: 636f 6c6f 725f 7061 6c65 7474 6529 292f  color_palette))/
+00016350: 3235 352e 0d0a 2020 2020 0d0a 2020 2020  255...    ..    
+00016360: 7267 6261 203d 206e 702e 7a65 726f 7328  rgba = np.zeros(
+00016370: 2833 2c29 290d 0a20 2020 200d 0a20 2020  (3,))..    ..   
+00016380: 2069 6620 2772 2720 696e 2052 4742 5f63   if 'r' in RGB_c
+00016390: 6f6c 6f72 5f70 616c 6574 7465 203a 200d  olor_palette : .
+000163a0: 0a20 2020 2020 2020 206b 6e61 6520 3d20  .        knae = 
+000163b0: 5247 425f 636f 6c6f 725f 7061 6c65 7474  RGB_color_palett
+000163c0: 6520 2e72 6570 6c61 6365 2827 7227 2c20  e .replace('r', 
+000163d0: 2727 292e 7265 706c 6163 6528 0d0a 2020  '').replace(..  
+000163e0: 2020 2020 2020 2020 2020 2767 272c 2027            'g', '
+000163f0: 2f27 292e 7265 706c 6163 6528 2762 272c  /').replace('b',
+00016400: 2027 2f27 292e 7370 6c69 7428 272f 2729   '/').split('/')
+00016410: 0d0a 2020 2020 2020 2020 7472 7920 3a0d  ..        try :.
+00016420: 0a20 2020 2020 2020 2020 2020 205f 6b6e  .            _kn
+00016430: 6165 203d 2061 7363 6572 7461 696e 5f63  ae = ascertain_c
+00016440: 7028 666c 6f61 7428 6b6e 6165 5b30 5d29  p(float(knae[0])
+00016450: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
+00016460: 7420 3a20 0d0a 2020 2020 2020 2020 2020  t : ..          
+00016470: 2020 7267 6261 5b30 5d3d 312e 0d0a 2020    rgba[0]=1...  
+00016480: 2020 2020 2020 656c 7365 203a 2072 6762        else : rgb
+00016490: 6120 5b30 5d20 3d20 5f6b 6e61 6520 2f32  a [0] = _knae /2
+000164a0: 3535 2e0d 0a20 2020 2020 2020 200d 0a20  55...        .. 
+000164b0: 2020 2069 6620 2767 2720 696e 2052 4742     if 'g' in RGB
+000164c0: 5f63 6f6c 6f72 5f70 616c 6574 7465 203a  _color_palette :
+000164d0: 200d 0a20 2020 2020 2020 206b 6e61 6520   ..        knae 
+000164e0: 3d20 5247 425f 636f 6c6f 725f 7061 6c65  = RGB_color_pale
+000164f0: 7474 6520 2e72 6570 6c61 6365 2827 6727  tte .replace('g'
+00016500: 2c20 272f 2729 2e72 6570 6c61 6365 280d  , '/').replace(.
+00016510: 0a20 2020 2020 2020 2020 2020 2027 6227  .            'b'
+00016520: 2c20 272f 2729 2e73 706c 6974 2827 2f27  , '/').split('/'
+00016530: 290d 0a20 2020 2020 2020 2074 7279 203a  )..        try :
+00016540: 200d 0a20 2020 2020 2020 2020 2020 205f   ..            _
+00016550: 6b6e 6165 203d 6173 6365 7274 6169 6e5f  knae =ascertain_
+00016560: 6370 2866 6c6f 6174 286b 6e61 655b 315d  cp(float(knae[1]
+00016570: 2929 0d0a 2020 2020 2020 2020 6578 6365  ))..        exce
+00016580: 7074 203a 200d 0a20 2020 2020 2020 2020  pt : ..         
+00016590: 2020 2072 6762 6120 5b31 5d3d 312e 0d0a     rgba [1]=1...
+000165a0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+000165b0: 2020 2020 2020 656c 7365 203a 7267 6261        else :rgba
+000165c0: 5b31 5d3d 205f 6b6e 6165 202f 3235 352e  [1]= _knae /255.
+000165d0: 0d0a 2020 2020 6966 2027 6227 2069 6e20  ..    if 'b' in 
+000165e0: 5247 425f 636f 6c6f 725f 7061 6c65 7474  RGB_color_palett
+000165f0: 6520 3a20 0d0a 2020 2020 2020 2020 6b6e  e : ..        kn
+00016600: 6165 203d 206b 6e61 6520 3d20 5247 425f  ae = knae = RGB_
+00016610: 636f 6c6f 725f 7061 6c65 7474 6520 2e72  color_palette .r
+00016620: 6570 6c61 6365 2827 6727 2c20 272f 2729  eplace('g', '/')
+00016630: 2e73 706c 6974 2827 2f27 290d 0a20 2020  .split('/')..   
+00016640: 2020 2020 2074 7279 203a 200d 0a20 2020       try : ..   
+00016650: 2020 2020 2020 2020 205f 6b6e 6165 203d           _knae =
+00016660: 6173 6365 7274 6169 6e5f 6370 2866 6c6f  ascertain_cp(flo
+00016670: 6174 286b 6e61 655b 315d 2929 0d0a 2020  at(knae[1]))..  
+00016680: 2020 2020 2020 6578 6365 7074 203a 0d0a        except :..
+00016690: 2020 2020 2020 2020 2020 2020 7267 6261              rgba
+000166a0: 5b32 5d3d 312e 0d0a 2020 2020 2020 2020  [2]=1...        
+000166b0: 656c 7365 203a 7267 6261 5b32 5d3d 205f  else :rgba[2]= _
+000166c0: 6b6e 6165 202f 3235 352e 0d0a 2020 2020  knae /255...    
+000166d0: 2020 2020 0d0a 2020 2020 7265 7475 726e      ..    return
+000166e0: 2074 7570 6c65 2872 6762 6129 2020 2020   tuple(rgba)    
+000166f0: 2020 200d 0a0d 0a64 6566 205f 6765 745f     ....def _get_
+00016700: 7874 6963 6b73 5f66 6f72 6d61 7461 6765  xticks_formatage
+00016710: 2028 0d0a 2020 2020 2020 2020 6178 2c20   (..        ax, 
+00016720: 2078 7469 636b 5f72 616e 6765 2c20 7370   xtick_range, sp
+00016730: 6163 653d 2031 3420 2c20 7374 6570 3d37  ace= 14 , step=7
+00016740: 2c0d 0a20 2020 2020 2020 2066 6d74 203d  ,..        fmt =
+00016750: 277b 7d27 2c61 7574 6f20 3d20 4661 6c73  '{}',auto = Fals
+00016760: 652c 2074 6963 6b73 203d 2778 272c 202a  e, ticks ='x', *
+00016770: 2a78 6c6b 7773 293a 0d0a 2020 2020 2222  *xlkws):..    ""
+00016780: 2220 536b 6970 2078 7469 636b 7320 6c61  " Skip xticks la
+00016790: 6265 6c20 6174 2065 7665 7279 206e 756d  bel at every num
+000167a0: 6265 7220 6f66 2073 7061 6365 7320 0d0a  ber of spaces ..
+000167b0: 2020 2020 3a70 6172 616d 2061 783a 206d      :param ax: m
+000167c0: 6174 706c 6f74 6c69 6220 6178 6573 200d  atplotlib axes .
+000167d0: 0a20 2020 203a 7061 7261 6d20 7874 6963  .    :param xtic
+000167e0: 6b5f 7261 6e67 653a 206c 6973 7420 6f66  k_range: list of
+000167f0: 2074 6865 2078 7469 636b 7320 7661 6c75   the xticks valu
+00016800: 6573 200d 0a20 2020 203a 7061 7261 6d20  es ..    :param 
+00016810: 7370 6163 653a 2069 6e74 6572 7661 6c20  space: interval 
+00016820: 7468 6174 2074 6865 206c 6162 656c 206d  that the label m
+00016830: 7573 7420 6265 2073 686f 776e 2e0d 0a20  ust be shown... 
+00016840: 2020 203a 7061 7261 6d20 7374 6570 3a20     :param step: 
+00016850: 7468 6520 6e75 6d62 6572 206f 6620 6c61  the number of la
+00016860: 6265 6c20 746f 2073 6b69 702e 0d0a 2020  bel to skip...  
+00016870: 2020 3a70 6172 616d 2066 6d74 3a20 7374    :param fmt: st
+00016880: 722c 2066 6f72 6d61 7461 6765 2074 7970  r, formatage typ
+00016890: 652e 200d 0a20 2020 203a 7061 7261 6d20  e. ..    :param 
+000168a0: 7469 636b 733a 2073 7472 2c20 6465 6661  ticks: str, defa
+000168b0: 756c 743d 2778 272c 2074 6865 2074 6963  ult='x', the tic
+000168c0: 6b73 2061 7869 7320 746f 2066 6f72 6d61  ks axis to forma
+000168d0: 7420 7468 6520 6c61 6265 6c73 2e20 0d0a  t the labels. ..
+000168e0: 2020 2020 2020 6361 6e20 6265 2060 6027        can be ``'
+000168f0: 7927 6060 2e20 0d0a 2020 2020 3a70 6172  y'``. ..    :par
+00016900: 616d 2061 7574 6f3a 2062 6f6f 6c20 2c20  am auto: bool , 
+00016910: 6966 2060 6054 7275 6560 6020 6120 6479  if ``True`` a dy
+00016920: 6e61 6d69 6320 7469 636b 2066 6f72 6d61  namic tick forma
+00016930: 7461 6765 2077 696c 6c20 7374 6172 742e  tage will start.
+00016940: 200d 0a20 2020 200d 0a20 2020 2022 2222   ..    ..    """
+00016950: 0d0a 2020 2020 6465 6620 666f 726d 6174  ..    def format
+00016960: 5f74 6963 6b73 2028 696e 642c 2078 293a  _ticks (ind, x):
+00016970: 0d0a 2020 2020 2020 2020 2222 2220 466f  ..        """ Fo
+00016980: 726d 6174 2074 6869 636b 2070 6172 616d  rmat thick param
+00016990: 6574 6572 2077 6974 6820 2746 756e 6346  eter with 'FuncF
+000169a0: 6f72 6d61 7474 6572 2866 756e 6329 270d  ormatter(func)'.
+000169b0: 0a20 2020 2020 2020 2072 6174 6865 7220  .        rather 
+000169c0: 7468 616e 2075 7369 6e67 3a3a 200d 0a20  than using:: .. 
+000169d0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+000169e0: 2020 2020 2061 7869 2e78 6178 6973 2e73       axi.xaxis.s
+000169f0: 6574 5f6d 616a 6f72 5f6c 6f63 6174 6f72  et_major_locator
+00016a00: 2028 706c 742e 4d61 784e 4c6f 6361 746f   (plt.MaxNLocato
+00016a10: 7228 3329 290d 0a20 2020 2020 2020 200d  r(3))..        .
+00016a20: 0a20 2020 2020 2020 2061 782e 7861 7869  .        ax.xaxi
+00016a30: 732e 7365 745f 6d61 6a6f 725f 666f 726d  s.set_major_form
+00016a40: 6174 7465 7220 2870 6c74 2e46 756e 6346  atter (plt.FuncF
+00016a50: 6f72 6d61 7474 6572 2866 6f72 6d61 745f  ormatter(format_
+00016a60: 7468 6963 6b73 2929 0d0a 2020 2020 2020  thicks))..      
+00016a70: 2020 2222 220d 0a20 2020 2020 2020 2069    """..        i
+00016a80: 6620 696e 6420 2520 7374 6570 203d 3d30  f ind % step ==0
+00016a90: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+00016aa0: 7265 7475 726e 2066 6d74 2e66 6f72 6d61  return fmt.forma
+00016ab0: 7420 2869 6e64 290d 0a20 2020 2020 2020  t (ind)..       
+00016ac0: 2065 6c73 653a 204e 6f6e 6520 0d0a 2020   else: None ..  
+00016ad0: 2020 2020 2020 0d0a 2020 2020 2320 7368        ..    # sh
+00016ae0: 6f77 206c 6162 656c 2065 7665 7279 2027  ow label every '
+00016af0: 7370 6163 6527 7361 6d70 6c65 7320 0d0a  space'samples ..
+00016b00: 2020 2020 6966 2061 7574 6f3a 200d 0a20      if auto: .. 
+00016b10: 2020 2020 2020 2073 7061 6365 203d 2031         space = 1
+00016b20: 302e 0d0a 2020 2020 2020 2020 7374 6570  0...        step
+00016b30: 203d 2069 6e74 2028 6e70 2e63 6569 6c20   = int (np.ceil 
+00016b40: 2820 6c65 6e28 7874 6963 6b5f 7261 6e67  ( len(xtick_rang
+00016b50: 6529 2f20 7370 6163 6520 2929 200d 0a20  e)/ space )) .. 
+00016b60: 2020 2020 2020 200d 0a20 2020 2072 6f74         ..    rot
+00016b70: 6174 696f 6e20 3d20 786c 6b77 732e 6765  ation = xlkws.ge
+00016b80: 7428 2772 6f74 6174 696f 6e27 2c20 3930  t('rotation', 90
+00016b90: 2029 2069 6620 2772 6f74 6174 696f 6e27   ) if 'rotation'
+00016ba0: 2069 6e20 786c 6b77 732e 6b65 7973 2028   in xlkws.keys (
+00016bb0: 0d0a 2020 2020 2020 2020 2920 656c 7365  ..        ) else
+00016bc0: 2078 6c6b 7773 2e67 6574 2827 726f 7461   xlkws.get('rota
+00016bd0: 7465 5f78 6c61 6265 6c27 2c20 3930 2029  te_xlabel', 90 )
+00016be0: 0d0a 2020 2020 0d0a 2020 2020 6966 206c  ..    ..    if l
+00016bf0: 656e 2878 7469 636b 5f72 616e 6765 2920  en(xtick_range) 
+00016c00: 3e3d 2073 7061 6365 203a 0d0a 2020 2020  >= space :..    
+00016c10: 2020 2020 6966 2074 6963 6b73 3d3d 2779      if ticks=='y
+00016c20: 273a 200d 0a20 2020 2020 2020 2020 2020  ': ..           
+00016c30: 2061 782e 7961 7869 732e 7365 745f 6d61   ax.yaxis.set_ma
+00016c40: 6a6f 725f 666f 726d 6174 7465 7220 2870  jor_formatter (p
+00016c50: 6c74 2e46 756e 6346 6f72 6d61 7474 6572  lt.FuncFormatter
+00016c60: 2866 6f72 6d61 745f 7469 636b 7329 290d  (format_ticks)).
+00016c70: 0a20 2020 2020 2020 2065 6c73 653a 200d  .        else: .
+00016c80: 0a20 2020 2020 2020 2020 2020 2061 782e  .            ax.
+00016c90: 7861 7869 732e 7365 745f 6d61 6a6f 725f  xaxis.set_major_
+00016ca0: 666f 726d 6174 7465 7220 2870 6c74 2e46  formatter (plt.F
+00016cb0: 756e 6346 6f72 6d61 7474 6572 2866 6f72  uncFormatter(for
+00016cc0: 6d61 745f 7469 636b 7329 290d 0a0d 0a20  mat_ticks)).... 
+00016cd0: 2020 2020 2020 2070 6c74 2e73 6574 7028         plt.setp(
+00016ce0: 6178 2e67 6574 5f79 7469 636b 6c61 6265  ax.get_yticklabe
+00016cf0: 6c73 2829 2069 6620 7469 636b 733d 3d27  ls() if ticks=='
+00016d00: 7927 2065 6c73 6520 6178 2e67 6574 5f78  y' else ax.get_x
+00016d10: 7469 636b 6c61 6265 6c73 2829 2c20 0d0a  ticklabels(), ..
+00016d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d30: 2072 6f74 6174 696f 6e20 3d20 726f 7461   rotation = rota
+00016d40: 7469 6f6e 2029 0d0a 2020 2020 656c 7365  tion )..    else
+00016d50: 3a20 0d0a 2020 2020 2020 2020 0d0a 2020  : ..        ..  
+00016d60: 2020 2020 2020 2320 6178 2e78 6178 6973        # ax.xaxis
+00016d70: 2e73 6574 5f6d 616a 6f72 5f6c 6f63 6174  .set_major_locat
+00016d80: 6f72 286d 706c 2e74 6963 6b65 722e 4d61  or(mpl.ticker.Ma
+00016d90: 784e 4c6f 6361 746f 7228 3329 290d 0a20  xNLocator(3)).. 
+00016da0: 2020 2020 2020 2023 2023 2074 6963 6b73         # # ticks
+00016db0: 5f6c 6f63 203d 2061 782e 6765 745f 7874  _loc = ax.get_xt
+00016dc0: 6963 6b73 2829 2e74 6f6c 6973 7428 290d  icks().tolist().
+00016dd0: 0a20 2020 2020 2020 2023 2061 782e 7861  .        # ax.xa
+00016de0: 7869 732e 7365 745f 6d61 6a6f 725f 6c6f  xis.set_major_lo
+00016df0: 6361 746f 7228 6d70 6c2e 7469 636b 6572  cator(mpl.ticker
+00016e00: 2e46 6978 6564 4c6f 6361 746f 7228 7469  .FixedLocator(ti
+00016e10: 636b 735f 6c6f 6329 290d 0a20 2020 2020  cks_loc))..     
+00016e20: 2020 2023 2061 782e 7365 745f 7874 6963     # ax.set_xtic
+00016e30: 6b6c 6162 656c 7328 5b66 6d74 2e66 6f72  klabels([fmt.for
+00016e40: 6d61 7428 7829 2066 6f72 2078 2069 6e20  mat(x) for x in 
+00016e50: 7469 636b 735f 6c6f 635d 290d 0a20 2020  ticks_loc])..   
+00016e60: 2020 2020 2074 6c73 7420 3d20 5b66 6d74       tlst = [fmt
+00016e70: 2e66 6f72 6d61 7428 6974 656d 2920 666f  .format(item) fo
+00016e80: 7220 6974 656d 2069 6e20 2078 7469 636b  r item in  xtick
+00016e90: 5f72 616e 6765 5d0d 0a20 2020 2020 2020  _range]..       
+00016ea0: 2061 782e 7365 745f 7974 6963 6b6c 6162   ax.set_yticklab
+00016eb0: 656c 7328 746c 7374 2c20 2a2a 786c 6b77  els(tlst, **xlkw
+00016ec0: 7329 2069 6620 7469 636b 733d 3d27 7927  s) if ticks=='y'
+00016ed0: 205c 0d0a 2020 2020 2020 2020 2020 2020   \..            
+00016ee0: 656c 7365 2061 782e 7365 745f 7874 6963  else ax.set_xtic
+00016ef0: 6b6c 6162 656c 7328 746c 7374 2c20 2a2a  klabels(tlst, **
+00016f00: 786c 6b77 7329 200d 0a20 200d 0a64 6566  xlkws) ..  ..def
+00016f10: 205f 7365 745f 736e 735f 7374 796c 6520   _set_sns_style 
+00016f20: 2873 2c20 2f29 3a20 0d0a 2020 2020 2222  (s, /): ..    ""
+00016f30: 2220 5365 7420 736e 7320 7374 796c 6520  " Set sns style 
+00016f40: 7768 6574 6865 7220 626f 6f6c 6561 6e20  whether boolean 
+00016f50: 6f72 2073 7472 696e 6720 6973 2067 6976  or string is giv
+00016f60: 656e 2222 2220 0d0a 2020 2020 7320 3d20  en""" ..    s = 
+00016f70: 7374 7228 7329 2e6c 6f77 6572 2829 0d0a  str(s).lower()..
+00016f80: 2020 2020 7320 3d20 7265 2e73 7562 2872      s = re.sub(r
+00016f90: 2774 7275 657c 6e6f 6e65 272c 2027 6461  'true|none', 'da
+00016fa0: 726b 6772 6964 272c 2073 290d 0a20 2020  rkgrid', s)..   
+00016fb0: 2072 6574 7572 6e20 736e 732e 7365 745f   return sns.set_
+00016fc0: 7374 796c 6528 7329 200d 0a0d 0a64 6566  style(s) ....def
+00016fd0: 205f 6973 5f74 6172 6765 745f 696e 2028   _is_target_in (
+00016fe0: 582c 2079 3d4e 6f6e 652c 2074 6e61 6d65  X, y=None, tname
+00016ff0: 3d4e 6f6e 6529 3a20 0d0a 2020 2020 2222  =None): ..    ""
+00017000: 2220 4372 6561 7465 206e 6577 2074 6172  " Create new tar
+00017010: 6765 7420 6e61 6d65 2066 6f72 2074 6e61  get name for tna
+00017020: 6d65 2069 6620 6769 7665 6e20 0d0a 2020  me if given ..  
+00017030: 2020 0d0a 2020 2020 3a70 6172 616d 2058    ..    :param X
+00017040: 3a20 6461 7461 6672 616d 6520 0d0a 2020  : dataframe ..  
+00017050: 2020 2020 2020 6461 7461 6672 616d 6520        dataframe 
+00017060: 636f 6e74 6169 6e69 6e67 2074 6865 2064  containing the d
+00017070: 6174 6120 666f 7220 706c 6f74 7469 6e67  ata for plotting
+00017080: 200d 0a20 2020 203a 7061 7261 6d20 793a   ..    :param y:
+00017090: 2061 7272 6179 206f 7220 7365 7269 6573   array or series
+000170a0: 0d0a 2020 2020 2020 2020 7461 7267 6574  ..        target
+000170b0: 2064 6174 6120 666f 7220 706c 6f74 7469   data for plotti
+000170c0: 6e67 2e20 4e6f 7465 2074 6861 7420 6d75  ng. Note that mu
+000170d0: 6c74 6974 6172 6765 7420 6f75 7470 6f75  ltitarget outpou
+000170e0: 7420 6973 206e 6f74 200d 0a20 2020 2020  t is not ..     
+000170f0: 2020 2061 6c6c 6f77 6564 2079 6574 2e20     allowed yet. 
+00017100: 4d6f 726f 6576 6572 2c20 6974 2060 7960  Moroever, it `y`
+00017110: 2069 7320 6769 7665 6e20 6173 2061 2064   is given as a d
+00017120: 6174 6166 7261 6d65 2c20 2774 6e61 6d65  ataframe, 'tname
+00017130: 2720 6d75 7374 200d 0a20 2020 2020 2020  ' must ..       
+00017140: 2062 6520 7375 7070 6c69 6564 2074 6f20   be supplied to 
+00017150: 7265 7472 6976 6520 7920 6173 2061 2070  retrive y as a p
+00017160: 616e 6461 7320 7365 7269 6573 206f 626a  andas series obj
+00017170: 6563 742c 206f 7468 6572 7769 7365 2061  ect, otherwise a
+00017180: 6e20 0d0a 2020 2020 2020 2020 6572 726f  n ..        erro
+00017190: 7220 7769 6c6c 2072 6169 7365 2e20 0d0a  r will raise. ..
+000171a0: 2020 2020 3a70 6172 616d 2074 6e61 6d65      :param tname
+000171b0: 3a20 7374 722c 2020 0d0a 2020 2020 2020  : str,  ..      
+000171c0: 2020 7461 7267 6574 206e 616d 652e 2049    target name. I
+000171d0: 6620 6769 7665 6e20 616e 6420 6079 6020  f given and `y` 
+000171e0: 6973 2060 604e 6f6e 6560 602c 2057 696c  is ``None``, Wil
+000171f0: 6c20 7472 7920 746f 2066 696e 6420 6074  l try to find `t
+00017200: 6e61 6d65 600d 0a20 2020 2020 2020 2069  name`..        i
+00017210: 6e20 7468 6520 6058 6020 636f 6c75 6d6e  n the `X` column
+00017220: 732e 2049 6620 2774 6e61 6d65 2720 646f  s. If 'tname' do
+00017230: 6573 206e 6f74 2065 7869 7374 2c20 706c  es not exist, pl
+00017240: 6f74 2066 6f72 2074 6172 6765 7420 6973  ot for target is
+00017250: 200d 0a20 2020 2020 2020 2063 616e 6365   ..        cance
+00017260: 6c6c 6564 2e20 0d0a 2020 2020 2020 2020  lled. ..        
+00017270: 0d0a 2020 2020 3a72 6574 7572 6e20 793a  ..    :return y:
+00017280: 2053 6572 6965 7320 0d0a 2020 2020 2222   Series ..    ""
+00017290: 220d 0a20 2020 205f 6173 7365 7274 5f61  "..    _assert_a
+000172a0: 6c6c 5f74 7970 6573 2858 2c20 7064 2e44  ll_types(X, pd.D
+000172b0: 6174 6146 7261 6d65 290d 0a20 2020 200d  ataFrame)..    .
+000172c0: 0a20 2020 2069 6620 7920 6973 206e 6f74  .    if y is not
+000172d0: 204e 6f6e 653a 200d 0a20 2020 2020 2020   None: ..       
+000172e0: 2079 203d 205f 6173 7365 7274 5f61 6c6c   y = _assert_all
+000172f0: 5f74 7970 6573 2879 202c 2070 642e 5365  _types(y , pd.Se
+00017300: 7269 6573 2c20 7064 2e44 6174 6146 7261  ries, pd.DataFra
+00017310: 6d65 2c20 6e70 2e6e 6461 7272 6179 290d  me, np.ndarray).
+00017320: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00017330: 2020 2069 6620 6861 7361 7474 7220 2879     if hasattr (y
+00017340: 2c20 2763 6f6c 756d 6e73 2729 3a20 0d0a  , 'columns'): ..
+00017350: 2020 2020 2020 2020 2020 2020 6966 2074              if t
+00017360: 6e61 6d65 206e 6f74 2069 6e20 2879 2e63  name not in (y.c
+00017370: 6f6c 756d 6e73 293a 2074 6e61 6d65 203d  olumns): tname =
+00017380: 204e 6f6e 6520 0d0a 2020 2020 2020 2020   None ..        
+00017390: 2020 2020 6966 2074 6e61 6d65 2069 7320      if tname is 
+000173a0: 4e6f 6e65 3a20 0d0a 2020 2020 2020 2020  None: ..        
+000173b0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+000173c0: 7065 4572 726f 7220 280d 0a20 2020 2020  peError (..     
+000173d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000173e0: 2774 6e61 6d65 2720 6d75 7374 2062 6520  'tname' must be 
+000173f0: 7375 7070 6c69 6564 2077 6865 6e20 7920  supplied when y 
+00017400: 6973 2061 2064 6174 6166 7261 6d65 2e22  is a dataframe."
+00017410: 290d 0a20 2020 2020 2020 2020 2020 2079  )..            y
+00017420: 203d 2079 205b 746e 616d 6520 5d0d 0a20   = y [tname ].. 
+00017430: 2020 2020 2020 2065 6c69 6620 6861 7361         elif hasa
+00017440: 7474 7220 2879 2c20 276e 616d 6527 293a  ttr (y, 'name'):
+00017450: 200d 0a20 2020 2020 2020 2020 2020 2074   ..            t
+00017460: 6e61 6d65 203d 2074 6e61 6d65 206f 7220  name = tname or 
+00017470: 792e 6e61 6d65 200d 0a20 2020 2020 2020  y.name ..       
+00017480: 2020 2020 2023 2072 6566 6f72 6d61 7420       # reformat 
+00017490: 696e 706c 6163 6520 7468 6520 6e61 6d65  inplace the name
+000174a0: 206f 6620 7365 7269 6573 200d 0a20 2020   of series ..   
+000174b0: 2020 2020 2020 2020 2079 2e6e 616d 6520           y.name 
+000174c0: 3d20 746e 616d 6520 0d0a 2020 2020 2020  = tname ..      
+000174d0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+000174e0: 656c 6966 2068 6173 6174 7472 2879 2c20  elif hasattr(y, 
+000174f0: 275f 5f61 7272 6179 5f5f 2729 3a20 0d0a  '__array__'): ..
+00017500: 2020 2020 2020 2020 2020 2020 7920 3d20              y = 
+00017510: 7064 2e53 6572 6965 7320 2879 2c20 6e61  pd.Series (y, na
+00017520: 6d65 203d 2074 6e61 6d65 206f 7220 2774  me = tname or 't
+00017530: 6172 6765 7427 290d 0a20 2020 2020 2020  arget')..       
+00017540: 2020 2020 200d 0a20 2020 2065 6c69 6620       ..    elif 
+00017550: 7920 6973 204e 6f6e 653a 200d 0a20 2020  y is None: ..   
+00017560: 2020 2020 2069 6620 746e 616d 6520 696e       if tname in
+00017570: 2058 2e63 6f6c 756d 6e73 203a 0d0a 2020   X.columns :..  
+00017580: 2020 2020 2020 2020 2020 7920 3d20 582e            y = X.
+00017590: 706f 7028 746e 616d 6529 0d0a 0d0a 2020  pop(tname)....  
+000175a0: 2020 7265 7475 726e 2058 2c20 7920 0d0a    return X, y ..
+000175b0: 0d0a 6465 6620 5f74 6f67 676c 655f 7461  ..def _toggle_ta
+000175c0: 7267 6574 5f69 6e20 2028 5820 2c20 7920  rget_in  (X , y 
+000175d0: 2c20 706f 733d 4e6f 6e65 293a 200d 0a20  , pos=None): .. 
+000175e0: 2020 2022 2222 2054 6f67 676c 6520 7468     """ Toggle th
+000175f0: 6520 7461 7267 6574 2069 6e20 7468 6520  e target in the 
+00017600: 636f 6e76 656e 6965 6e74 2070 6f73 6974  convenient posit
+00017610: 696f 6e2e 2042 7920 6465 6661 756c 7420  ion. By default 
+00017620: 7468 6520 7461 7267 6574 200d 0a20 2020  the target ..   
+00017630: 2070 6c6f 7420 6973 2074 6865 206c 6173   plot is the las
+00017640: 7420 7375 6270 6c6f 7473 200d 0a20 2020  t subplots ..   
+00017650: 200d 0a20 2020 203a 7061 7261 6d20 583a   ..    :param X:
+00017660: 2064 6174 6166 7261 6d65 200d 0a20 2020   dataframe ..   
+00017670: 2020 2020 2064 6174 6166 7261 6d65 2063       dataframe c
+00017680: 6f6e 7461 696e 696e 6720 7468 6520 6461  ontaining the da
+00017690: 7461 2066 6f72 2070 6c6f 7474 696e 6720  ta for plotting 
+000176a0: 0d0a 2020 2020 3a70 6172 616d 2079 3a20  ..    :param y: 
+000176b0: 6172 7261 7920 6f72 2073 6572 6965 730d  array or series.
+000176c0: 0a20 2020 2020 2020 2074 6865 2074 6172  .        the tar
+000176d0: 6765 7420 666f 7220 2070 6c6f 7474 696e  get for  plottin
+000176e0: 672e 200d 0a20 2020 203a 7061 7261 6d20  g. ..    :param 
+000176f0: 706f 733a 2069 6e74 2c20 7468 6520 706f  pos: int, the po
+00017700: 7369 7469 6f6e 2074 6f20 696e 7365 7274  sition to insert
+00017710: 2079 2069 6e20 7468 6520 6461 7461 6672   y in the datafr
+00017720: 616d 6520 5820 0d0a 2020 2020 2020 2020  ame X ..        
+00017730: 4279 2064 6566 6175 6c74 202c 2060 7960  By default , `y`
+00017740: 2069 7320 6c6f 6361 7465 6420 6174 2074   is located at t
+00017750: 6865 206c 6173 7420 706f 7369 7469 6f6e  he last position
+00017760: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00017770: 203a 7265 7475 726e 3a20 4461 7461 6672   :return: Datafr
+00017780: 616d 6520 0d0a 2020 2020 2020 2020 4461  ame ..        Da
+00017790: 7461 6672 616d 6520 636f 6e74 6169 6e69  taframe containi
+000177a0: 6e67 2074 6865 2074 6172 6765 7420 2779  ng the target 'y
+000177b0: 270d 0a20 2020 2020 2020 200d 0a20 2020  '..        ..   
+000177c0: 2022 2222 0d0a 2020 2020 0d0a 2020 2020   """..    ..    
+000177d0: 706f 7320 3d20 2030 2069 6620 706f 7320  pos =  0 if pos 
+000177e0: 3d3d 3020 2065 6c73 6520 2820 706f 7320  ==0  else ( pos 
+000177f0: 6f72 2058 2e73 6861 7065 205b 315d 290d  or X.shape [1]).
+00017800: 0a0d 0a20 2020 2070 6f73 3d20 696e 7420  ...    pos= int 
+00017810: 2820 5f61 7373 6572 745f 616c 6c5f 7479  ( _assert_all_ty
+00017820: 7065 7328 706f 732c 2069 6e74 2c20 666c  pes(pos, int, fl
+00017830: 6f61 7420 2920 2920 0d0a 2020 2020 6d73  oat ) ) ..    ms
+00017840: 3d20 2822 5468 6520 706f 7369 7469 6f6e  = ("The position
+00017850: 6e69 6e67 206f 6620 7468 6520 7461 7267  ning of the targ
+00017860: 6574 2069 7320 6f75 7420 6f66 2074 6865  et is out of the
+00017870: 2062 6f75 6e64 2e22 0d0a 2020 2020 2020   bound."..      
+00017880: 2020 2022 7b7d 2070 6f73 6974 696f 6e20     "{} position 
+00017890: 6973 2075 7365 6420 696e 7374 6561 642e  is used instead.
+000178a0: 2229 0d0a 2020 2020 0d0a 2020 2020 6966  ")..    ..    if
+000178b0: 2070 6f73 203e 2058 2e73 6861 7065 5b31   pos > X.shape[1
+000178c0: 5d20 3a20 0d0a 2020 2020 2020 2020 7761  ] : ..        wa
+000178d0: 726e 696e 6773 2e77 6172 6e28 6d73 2e66  rnings.warn(ms.f
+000178e0: 6f72 6d61 7428 2754 6865 206c 6173 7427  ormat('The last'
+000178f0: 2929 0d0a 2020 2020 2020 2020 706f 733d  ))..        pos=
+00017900: 582e 7368 6170 655b 315d 0d0a 2020 2020  X.shape[1]..    
+00017910: 656c 6966 2070 6f73 203c 2030 3a20 0d0a  elif pos < 0: ..
+00017920: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00017930: 2e77 6172 6e28 6d73 2e66 6f72 6d61 7428  .warn(ms.format(
+00017940: 0d0a 2020 2020 2020 2020 2020 2020 2220  ..            " 
+00017950: 4e65 6761 7469 7665 2069 6e64 6578 2069  Negative index i
+00017960: 7320 6e6f 7420 616c 6c6f 7765 642e 2054  s not allowed. T
+00017970: 6865 2066 6972 7374 2229 0d0a 2020 2020  he first")..    
+00017980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017990: 2020 290d 0a20 2020 2020 2020 2070 6f73    )..        pos
+000179a0: 3d30 200d 0a20 0d0a 2020 2020 582e 696e  =0 .. ..    X.in
+000179b0: 7365 7274 2028 706f 732c 2079 2e6e 616d  sert (pos, y.nam
+000179c0: 652c 2079 2029 0d0a 2020 2020 0d0a 2020  e, y )..    ..  
+000179d0: 2020 7265 7475 726e 2058 0d0a 2020 2020    return X..    
+000179e0: 0d0a 6465 6620 5f73 6b69 705f 6c6f 6731  ..def _skip_log1
+000179f0: 305f 636f 6c75 6d6e 7320 2820 582c 2063  0_columns ( X, c
+00017a00: 6f6c 756d 6e32 736b 6970 2c20 7061 7474  olumn2skip, patt
+00017a10: 6572 6e20 3d4e 6f6e 6520 2c20 696e 706c  ern =None , inpl
+00017a20: 6163 6520 3d54 7275 6529 3a20 0d0a 2020  ace =True): ..  
+00017a30: 2020 2222 2220 536b 6970 2074 6865 2063    """ Skip the c
+00017a40: 6f6c 756d 6e73 2074 6861 7420 646f 6e74  olumns that dont
+00017a50: 206e 6565 6420 746f 2070 7574 2076 616c   need to put val
+00017a60: 7565 2069 6e20 6c6f 6761 7269 7468 6d73  ue in logarithms
+00017a70: 2e0d 0a20 2020 200d 0a20 2020 203a 7061  ...    ..    :pa
+00017a80: 7261 6d20 583a 2064 6174 6166 7261 6d65  ram X: dataframe
+00017a90: 200d 0a20 2020 2020 2020 2070 616e 6461   ..        panda
+00017aa0: 7320 6461 7461 6672 616d 6520 7769 7468  s dataframe with
+00017ab0: 2076 616c 6964 2063 6f6c 756d 6e73 200d   valid columns .
+00017ac0: 0a20 2020 203a 7061 7261 6d20 636f 6c75  .    :param colu
+00017ad0: 6d6e 3273 6b69 703a 206c 6973 7420 6f72  mn2skip: list or
+00017ae0: 2073 7472 202c 200d 0a20 2020 2020 2020   str , ..       
+00017af0: 204c 6973 7420 6f66 2063 6f6c 756d 6e73   List of columns
+00017b00: 2074 6f20 736b 6970 2e20 4966 2067 6976   to skip. If giv
+00017b10: 656e 2061 7320 7374 7269 6e67 2061 6e64  en as string and
+00017b20: 2073 6570 6172 6564 2062 7920 7468 6520   separed by the 
+00017b30: 6465 6661 756c 740d 0a20 2020 2020 2020  default..       
+00017b40: 2070 6174 7465 726e 2069 7465 6d73 2c20   pattern items, 
+00017b50: 6974 2073 686f 756c 6420 6265 2063 6f6e  it should be con
+00017b60: 7665 7274 6564 2074 6f20 6120 6c69 7374  verted to a list
+00017b70: 2061 6e64 206d 616b 6520 7375 7265 2074   and make sure t
+00017b80: 6865 200d 0a20 2020 2020 2020 2063 6f6c  he ..        col
+00017b90: 756d 6e73 206e 616d 6520 6578 6973 7420  umns name exist 
+00017ba0: 696e 2074 6865 2064 6174 6166 7261 6d65  in the dataframe
+00017bb0: 2e20 4f74 6865 7277 6973 6520 616e 2065  . Otherwise an e
+00017bc0: 7272 6f72 2077 6974 6820 0d0a 2020 2020  rror with ..    
+00017bd0: 2020 2020 7261 6973 652e 200d 0a20 2020      raise. ..   
+00017be0: 203a 7061 7261 6d20 7061 7474 6572 6e3a   :param pattern:
+00017bf0: 2073 7472 2c20 6465 6661 756c 7420 3d20   str, default = 
+00017c00: 275b 2326 2a40 212c 3b5c 735d 5c73 2a27  '[#&*@!,;\s]\s*'
+00017c10: 0d0a 2020 2020 2020 2020 5468 6520 6261  ..        The ba
+00017c20: 7365 2070 6174 7465 726e 2074 6f20 7370  se pattern to sp
+00017c30: 6c69 7420 7468 6520 7465 7874 2069 6e20  lit the text in 
+00017c40: 6063 6f6c 756d 6e32 736b 6970 6020 696e  `column2skip` in
+00017c50: 746f 2061 2063 6f6c 756d 6e73 0d0a 2020  to a columns..  
+00017c60: 2020 2020 2020 0d0a 2020 2020 3a72 6574        ..    :ret
+00017c70: 7572 6e20 583a 2044 6174 6166 7261 6d65  urn X: Dataframe
+00017c80: 0d0a 2020 2020 2020 2020 4461 7461 6672  ..        Datafr
+00017c90: 616d 6520 6d6f 6469 6669 6564 2069 6e70  ame modified inp
+00017ca0: 6c61 6365 2077 6974 6820 7661 6c75 6573  lace with values
+00017cb0: 2063 6f6d 7075 7465 6420 696e 206c 6f67   computed in log
+00017cc0: 3130 200d 0a20 2020 2020 2020 2065 7863  10 ..        exc
+00017cd0: 6570 7420 7468 6520 736b 6970 7065 6420  ept the skipped 
+00017ce0: 636f 6c75 6d6e 732e 200d 0a20 2020 2020  columns. ..     
+00017cf0: 2020 200d 0a20 2020 203a 6578 616d 706c     ..    :exampl
+00017d00: 653a 200d 0a20 2020 2020 2020 3e3e 3e20  e: ..       >>> 
+00017d10: 6672 6f6d 2077 6174 6578 2e64 6174 6173  from watex.datas
+00017d20: 6574 7320 696d 706f 7274 206c 6f61 645f  ets import load_
+00017d30: 686c 6f67 7320 0d0a 2020 2020 2020 203e  hlogs ..       >
+00017d40: 3e3e 2066 726f 6d20 7761 7465 782e 7574  >> from watex.ut
+00017d50: 696c 732e 706c 6f74 7574 696c 7320 696d  ils.plotutils im
+00017d60: 706f 7274 205f 736b 6970 5f6c 6f67 3130  port _skip_log10
+00017d70: 5f63 6f6c 756d 6e73 200d 0a20 2020 2020  _columns ..     
+00017d80: 2020 3e3e 3e20 5830 2c20 5f3d 206c 6f61    >>> X0, _= loa
+00017d90: 645f 686c 6f67 7320 2861 735f 6672 616d  d_hlogs (as_fram
+00017da0: 6520 3d54 7275 6520 2920 0d0a 2020 2020  e =True ) ..    
+00017db0: 2020 203e 3e3e 2023 206c 6574 2076 6973     >>> # let vis
+00017dc0: 7561 6c69 7a65 2074 6865 2020 6669 7273  ualize the  firs
+00017dd0: 7433 2076 616c 7565 7320 6f66 2060 7370  t3 values of `sp
+00017de0: 6020 616e 6420 6072 6573 6973 7469 7669  ` and `resistivi
+00017df0: 7479 6020 6b65 7973 200d 0a20 2020 2020  ty` keys ..     
+00017e00: 2020 3e3e 3e20 5830 5b27 7370 275d 5b3a    >>> X0['sp'][:
+00017e10: 335d 202c 2058 305b 2772 6573 6973 7469  3] , X0['resisti
+00017e20: 7669 7479 275d 5b3a 335d 2020 0d0a 2020  vity'][:3]  ..  
+00017e30: 2020 2020 202e 2e2e 2028 3020 2020 2d31       ... (0   -1
+00017e40: 2e35 3830 3030 300d 0a20 2020 2020 2020  .580000..       
+00017e50: 2020 2020 2031 2020 202d 312e 3538 3030       1   -1.5800
+00017e60: 3030 0d0a 2020 2020 2020 2020 2020 2020  00..            
+00017e70: 3220 2020 2d31 2e39 3232 3633 320d 0a20  2   -1.922632.. 
+00017e80: 2020 2020 2020 2020 2020 204e 616d 653a             Name:
+00017e90: 2073 702c 2064 7479 7065 3a20 666c 6f61   sp, dtype: floa
+00017ea0: 7436 342c 0d0a 2020 2020 2020 2020 2020  t64,..          
+00017eb0: 2020 3020 2020 2031 352e 3931 3931 3330    0    15.919130
+00017ec0: 0d0a 2020 2020 2020 2020 2020 2020 3120  ..            1 
+00017ed0: 2020 2031 362e 3030 3030 3030 0d0a 2020     16.000000..  
+00017ee0: 2020 2020 2020 2020 2020 3220 2020 2032            2    2
+00017ef0: 342e 3432 3233 3136 0d0a 2020 2020 2020  4.422316..      
+00017f00: 2020 2020 2020 4e61 6d65 3a20 7265 7369        Name: resi
+00017f10: 7374 6976 6974 792c 2064 7479 7065 3a20  stivity, dtype: 
+00017f20: 666c 6f61 7436 3429 0d0a 2020 2020 2020  float64)..      
+00017f30: 203e 3e3e 2063 6f6c 756d 6e32 736b 6970   >>> column2skip
+00017f40: 203d 205b 2768 6f6c 655f 6964 272c 2764   = ['hole_id','d
+00017f50: 6570 7468 5f74 6f70 272c 2027 6465 7074  epth_top', 'dept
+00017f60: 685f 626f 7474 6f6d 272c 200d 0a20 2020  h_bottom', ..   
+00017f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017f80: 2020 2020 2020 2773 7472 6174 615f 6e61        'strata_na
+00017f90: 6d65 272c 2027 726f 636b 5f6e 616d 6527  me', 'rock_name'
+00017fa0: 2c20 2777 656c 6c5f 6469 616d 6574 6572  , 'well_diameter
+00017fb0: 272c 2027 7370 275d 0d0a 2020 2020 2020  ', 'sp']..      
+00017fc0: 203e 3e3e 205f 736b 6970 5f6c 6f67 3130   >>> _skip_log10
+00017fd0: 5f63 6f6c 756d 6e73 2028 5830 2c20 636f  _columns (X0, co
+00017fe0: 6c75 6d6e 3273 6b69 7029 0d0a 2020 2020  lumn2skip)..    
+00017ff0: 2020 203e 3e3e 2023 206e 6f77 206c 6574     >>> # now let
+00018000: 2076 6973 7561 6c69 7a65 2074 6865 2073   visualize the s
+00018010: 616d 6520 6b65 7973 2076 616c 7565 7320  ame keys values 
+00018020: 0d0a 2020 2020 2020 203e 3e3e 2058 305b  ..       >>> X0[
+00018030: 2773 7027 5d5b 3a33 5d20 2c20 5830 5b27  'sp'][:3] , X0['
+00018040: 7265 7369 7374 6976 6974 7927 5d5b 3a33  resistivity'][:3
+00018050: 5d0d 0a20 2020 2020 2020 2e2e 2e20 2830  ]..       ... (0
+00018060: 2020 202d 312e 3538 3030 3030 0d0a 2020     -1.580000..  
+00018070: 2020 2020 2020 2020 2020 3120 2020 2d31            1   -1
+00018080: 2e35 3830 3030 300d 0a20 2020 2020 2020  .580000..       
+00018090: 2020 2020 2032 2020 202d 312e 3932 3236       2   -1.9226
+000180a0: 3332 0d0a 2020 2020 2020 2020 2020 2020  32..            
+000180b0: 4e61 6d65 3a20 7370 2c20 6474 7970 653a  Name: sp, dtype:
+000180c0: 2066 6c6f 6174 3634 2c0d 0a20 2020 2020   float64,..     
+000180d0: 2020 2020 2020 2030 2020 2020 312e 3230         0    1.20
+000180e0: 3139 3139 0d0a 2020 2020 2020 2020 2020  1919..          
+000180f0: 2020 3120 2020 2031 2e32 3034 3132 300d    1    1.204120.
+00018100: 0a20 2020 2020 2020 2020 2020 2032 2020  .            2  
+00018110: 2020 312e 3338 3737 3837 0d0a 2020 2020    1.387787..    
+00018120: 2020 2020 2020 2020 4e61 6d65 3a20 7265          Name: re
+00018130: 7369 7374 6976 6974 792c 2064 7479 7065  sistivity, dtype
+00018140: 3a20 666c 6f61 7436 3429 0d0a 2020 2020  : float64)..    
+00018150: 2020 3e3e 3e20 2320 6974 2069 7320 6f62    >>> # it is ob
+00018160: 7669 6f75 7320 7468 6520 6072 6573 6973  vious the `resis
+00018170: 7469 7669 7960 2076 616c 7565 7320 6973  tiviy` values is
+00018180: 206c 6f67 3130 200d 0a20 2020 2020 203e   log10 ..      >
+00018190: 3e3e 2023 2077 6869 6c65 2060 7370 6020  >> # while `sp` 
+000181a0: 7374 696c 6c20 7265 6d61 696e 7320 7468  still remains th
+000181b0: 6520 7361 6d65 200d 0a20 2020 2020 200d  e same ..      .
+000181c0: 0a20 2020 2022 2222 0d0a 2020 2020 5830  .    """..    X0
+000181d0: 203d 2058 2e63 6f70 7920 2829 200d 0a20   = X.copy () .. 
+000181e0: 2020 2069 6620 6e6f 7420 6973 5f69 7465     if not is_ite
+000181f0: 7261 626c 6528 2063 6f6c 756d 6e32 736b  rable( column2sk
+00018200: 6970 293a 200d 0a20 2020 2020 2020 2072  ip): ..        r
+00018210: 6169 7365 2054 7970 6545 7272 6f72 2028  aise TypeError (
+00018220: 2243 6f6c 756d 6e73 2020 746f 2073 6b69  "Columns  to ski
+00018230: 7020 6578 7065 6374 2061 6e20 6974 6572  p expect an iter
+00018240: 6162 6c65 206f 626a 6563 743b 220d 0a20  able object;".. 
+00018250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018260: 2020 2020 2020 2020 6622 2067 6f74 207b          f" got {
+00018270: 7479 7065 2863 6f6c 756d 6e32 736b 6970  type(column2skip
+00018280: 292e 5f5f 6e61 6d65 5f5f 2172 7d22 290d  ).__name__!r}").
+00018290: 0a20 2020 2020 2020 200d 0a20 2020 2070  .        ..    p
+000182a0: 6174 7465 726e 203d 2070 6174 7465 726e  attern = pattern
+000182b0: 206f 7220 7227 5b23 262a 4021 2c3b 5c73   or r'[#&*@!,;\s
+000182c0: 5d5c 732a 270d 0a20 2020 200d 0a20 2020  ]\s*'..    ..   
+000182d0: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
+000182e0: 6f6c 756d 6e32 736b 6970 2c20 7374 7229  olumn2skip, str)
+000182f0: 3a0d 0a20 2020 2020 2020 2063 6f6c 756d  :..        colum
+00018300: 6e32 736b 6970 203d 2073 7472 3263 6f6c  n2skip = str2col
+00018310: 756d 6e73 2028 636f 6c75 6d6e 3273 6b69  umns (column2ski
+00018320: 702c 2070 6174 7465 726e 3d70 6174 7465  p, pattern=patte
+00018330: 726e 2020 290d 0a20 2020 2023 6173 7365  rn  )..    #asse
+00018340: 7274 2077 6865 7468 6572 2063 6f6c 756d  rt whether colum
+00018350: 6e20 746f 2073 6b69 7020 6973 2069 6e20  n to skip is in 
+00018360: 0d0a 2020 2020 6966 2063 6f6c 756d 6e32  ..    if column2
+00018370: 736b 6970 3a0d 0a20 2020 2020 2020 2063  skip:..        c
+00018380: 736b 6970 203d 2063 6f70 792e 6465 6570  skip = copy.deep
+00018390: 636f 7079 2028 636f 6c75 6d6e 3273 6b69  copy (column2ski
+000183a0: 7029 200d 0a20 2020 2020 2020 2063 6f6c  p) ..        col
+000183b0: 756d 6e32 736b 6970 203d 2069 735f 696e  umn2skip = is_in
+000183c0: 5f69 6628 582e 636f 6c75 6d6e 732c 2063  _if(X.columns, c
+000183d0: 6f6c 756d 6e32 736b 6970 2c20 7265 7475  olumn2skip, retu
+000183e0: 726e 5f64 6966 663d 2054 7275 6529 0d0a  rn_diff= True)..
+000183f0: 2020 2020 2020 2020 6966 206c 656e 2863          if len(c
+00018400: 6f6c 756d 6e32 736b 6970 2920 3d3d 6c65  olumn2skip) ==le
+00018410: 6e20 2858 2e63 6f6c 756d 6e73 293a 200d  n (X.columns): .
+00018420: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+00018430: 6e69 6e67 732e 7761 726e 2822 5661 6c75  nings.warn("Valu
+00018440: 6528 7329 2074 6f20 736b 6970 2061 7265  e(s) to skip are
+00018450: 206e 6f74 2064 6574 6563 7465 642e 2229   not detected.")
+00018460: 0d0a 2020 2020 2020 2020 6966 2069 6e70  ..        if inp
+00018470: 6c61 6365 203a 200d 0a20 2020 2020 2020  lace : ..       
+00018480: 2020 2020 2058 5b63 6f6c 756d 6e32 736b       X[column2sk
+00018490: 6970 5d20 3d20 6e70 2e6c 6f67 3130 2028  ip] = np.log10 (
+000184a0: 2058 5b63 6f6c 756d 6e32 736b 6970 5d20   X[column2skip] 
+000184b0: 2920 0d0a 2020 2020 2020 2020 2020 2020  ) ..            
+000184c0: 582e 6472 6f70 2028 636f 6c75 6d6e 7320  X.drop (columns 
+000184d0: 3d63 736b 6970 202c 2069 6e70 6c61 6365  =cskip , inplace
+000184e0: 203d 5472 7565 2029 0d0a 2020 2020 2020   =True )..      
+000184f0: 2020 2020 2020 7265 7475 726e 2020 0d0a        return  ..
+00018500: 2020 2020 2020 2020 656c 7365 203a 200d          else : .
+00018510: 0a20 2020 2020 2020 2020 2020 2058 305b  .            X0[
+00018520: 636f 6c75 6d6e 3273 6b69 705d 203d 206e  column2skip] = n
+00018530: 702e 6c6f 6731 3020 2820 5830 5b63 6f6c  p.log10 ( X0[col
+00018540: 756d 6e32 736b 6970 5d20 2920 0d0a 2020  umn2skip] ) ..  
+00018550: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00018560: 7265 7475 726e 2058 300d 0a20 2020 200d  return X0..    .
+00018570: 0a64 6566 2070 6c6f 745f 6261 7228 782c  .def plot_bar(x,
+00018580: 2079 2c20 7768 3d20 2e38 2c20 206b 696e   y, wh= .8,  kin
+00018590: 6420 3d27 7627 2c20 6669 675f 7369 7a65  d ='v', fig_size
+000185a0: 203d 2838 2c20 3629 2c20 7361 7665 6669   =(8, 6), savefi
+000185b0: 673d 4e6f 6e65 2c0d 0a20 2020 2020 2020  g=None,..       
+000185c0: 2020 2020 2020 786c 6162 656c 203d 4e6f        xlabel =No
+000185d0: 6e65 2c20 796c 6162 656c 3d4e 6f6e 652c  ne, ylabel=None,
+000185e0: 2066 6967 5f74 6974 6c65 3d4e 6f6e 652c   fig_title=None,
+000185f0: 202a 2a62 6172 5f6b 7773 293a 200d 0a20   **bar_kws): .. 
+00018600: 2020 2022 2222 0d0a 2020 2020 4d61 6b65     """..    Make
+00018610: 2061 2076 6572 7469 6361 6c20 6f72 2068   a vertical or h
+00018620: 6f72 697a 6f6e 7461 6c20 6261 7220 706c  orizontal bar pl
+00018630: 6f74 2e0d 0a0d 0a20 2020 2054 6865 2062  ot.....    The b
+00018640: 6172 7320 6172 6520 706f 7369 7469 6f6e  ars are position
+00018650: 6564 2061 7420 7820 6f72 2079 2077 6974  ed at x or y wit
+00018660: 6820 7468 6520 6769 7665 6e20 616c 6967  h the given alig
+00018670: 6e6d 656e 742e 2054 6865 6972 2064 696d  nment. Their dim
+00018680: 656e 7369 6f6e 7320 0d0a 2020 2020 6172  ensions ..    ar
+00018690: 6520 6769 7665 6e20 6279 2077 6964 7468  e given by width
+000186a0: 2061 6e64 2068 6569 6768 742e 2054 6865   and height. The
+000186b0: 2068 6f72 697a 6f6e 7461 6c20 6261 7365   horizontal base
+000186c0: 6c69 6e65 2069 7320 6c65 6674 2028 6465  line is left (de
+000186d0: 6661 756c 7420 3029 0d0a 2020 2020 7768  fault 0)..    wh
+000186e0: 696c 6520 7468 6520 7665 7274 6963 616c  ile the vertical
+000186f0: 2062 6173 656c 696e 6520 6973 2062 6f74   baseline is bot
+00018700: 746f 6d20 2864 6566 6175 6c74 3d30 290d  tom (default=0).
+00018710: 0a20 2020 200d 0a20 2020 204d 616e 7920  .    ..    Many 
+00018720: 7061 7261 6d65 7465 7273 2063 616e 2074  parameters can t
+00018730: 616b 6520 6569 7468 6572 2061 2073 696e  ake either a sin
+00018740: 676c 6520 7661 6c75 6520 6170 706c 7969  gle value applyi
+00018750: 6e67 2074 6f20 616c 6c20 6261 7273 206f  ng to all bars o
+00018760: 7220 6120 0d0a 2020 2020 7365 7175 656e  r a ..    sequen
+00018770: 6365 206f 6620 7661 6c75 6573 2c20 6f6e  ce of values, on
+00018780: 6520 666f 7220 6561 6368 2062 6172 2e0d  e for each bar..
+00018790: 0a20 2020 200d 0a20 2020 2050 6172 616d  .    ..    Param
+000187a0: 6574 6572 7320 0d0a 2020 2020 2d2d 2d2d  eters ..    ----
+000187b0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2078 3a20  -------..    x: 
+000187c0: 666c 6f61 7420 6f72 2061 7272 6179 2d6c  float or array-l
+000187d0: 696b 650d 0a20 2020 2020 2020 2054 6865  ike..        The
+000187e0: 2078 2063 6f6f 7264 696e 6174 6573 206f   x coordinates o
+000187f0: 6620 7468 6520 6261 7273 2e20 6973 2027  f the bars. is '
+00018800: 7827 2066 6f72 2076 6572 7469 6361 6c20  x' for vertical 
+00018810: 6261 7220 706c 6f74 2061 7320 606b 696e  bar plot as `kin
+00018820: 6460 200d 0a20 2020 2020 2020 2069 7320  d` ..        is 
+00018830: 7365 7420 746f 2060 6076 6060 2864 6566  set to ``v``(def
+00018840: 6175 6c74 2920 6f72 2060 7960 2066 6f72  ault) or `y` for
+00018850: 2068 6f72 697a 6f6e 7461 6c20 6261 7220   horizontal bar 
+00018860: 706c 6f74 2061 7320 606b 696e 6460 2069  plot as `kind` i
+00018870: 7320 0d0a 2020 2020 2020 2020 7365 7420  s ..        set 
+00018880: 746f 6060 6860 602e 200d 0a20 2020 2020  to``h``. ..     
+00018890: 2020 2053 6565 2061 6c73 6f20 616c 6967     See also alig
+000188a0: 6e20 666f 7220 7468 6520 616c 6967 6e6d  n for the alignm
+000188b0: 656e 7420 6f66 2074 6865 2062 6172 7320  ent of the bars 
+000188c0: 746f 2074 6865 2063 6f6f 7264 696e 6174  to the coordinat
+000188d0: 6573 2e0d 0a20 2020 2079 3a20 666c 6f61  es...    y: floa
+000188e0: 7420 6f72 2061 7272 6179 2d6c 696b 650d  t or array-like.
+000188f0: 0a20 2020 2020 2020 2054 6865 2068 6569  .        The hei
+00018900: 6768 7428 7329 2066 6f72 2076 6572 7469  ght(s) for verti
+00018910: 6361 6c20 616e 6420 7769 6474 6828 7329  cal and width(s)
+00018920: 2066 6f72 2068 6f72 697a 6f6e 6174 616c   for horizonatal
+00018930: 206f 6620 7468 6520 6261 7273 2e0d 0a20   of the bars... 
+00018940: 2020 200d 0a20 2020 2077 683a 2066 6c6f     ..    wh: flo
+00018950: 6174 206f 7220 6172 7261 792d 6c69 6b65  at or array-like
+00018960: 2c20 6465 6661 756c 743a 2030 2e38 0d0a  , default: 0.8..
+00018970: 2020 2020 2020 2020 5468 6520 7769 6474          The widt
+00018980: 6828 7329 2066 6f72 2076 6572 7469 6361  h(s) for vertica
+00018990: 6c20 6f72 2068 6569 6768 7428 7329 2066  l or height(s) f
+000189a0: 6f72 2068 6f72 697a 616f 6e74 616c 206f  or horizaontal o
+000189b0: 6620 7468 6520 6261 7273 2e0d 0a20 2020  f the bars...   
+000189c0: 2020 2020 200d 0a20 2020 206b 696e 643a       ..    kind:
+000189d0: 2073 7472 2c20 5b27 7665 7274 6963 616c   str, ['vertical
+000189e0: 272c 2027 686f 7269 7a6f 6e74 616c 275d  ', 'horizontal']
+000189f0: 2c20 6465 6661 756c 743d 2776 6572 7469  , default='verti
+00018a00: 6361 6c27 0d0a 2020 2020 2020 2020 5468  cal'..        Th
+00018a10: 6520 6b69 6e64 206f 6620 6261 7220 706c  e kind of bar pl
+00018a20: 6f74 2e20 4361 6e20 6265 2074 6865 2068  ot. Can be the h
+00018a30: 6f72 697a 6f6e 7461 6c20 6f72 2076 6572  orizontal or ver
+00018a40: 7469 6361 6c20 6261 7220 706c 6f74 732e  tical bar plots.
+00018a50: 200d 0a20 2020 2062 6172 5f6b 7773 3a20   ..    bar_kws: 
+00018a60: 6469 6374 2c20 0d0a 2020 2020 2020 2020  dict, ..        
+00018a70: 4164 6469 7469 6f6e 616c 206b 6579 776f  Additional keywo
+00018a80: 7264 7320 6172 6775 6d65 6e74 7320 7061  rds arguments pa
+00018a90: 7373 6564 2074 6f20 3a20 0d0a 2020 2020  ssed to : ..    
+00018aa0: 2020 2020 2020 2020 3a66 756e 633a 607e          :func:`~
+00018ab0: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
+00018ac0: 742e 6261 7260 206f 7220 3a66 756e 633a  t.bar` or :func:
+00018ad0: 607e 6d61 7470 6c6f 746c 6962 2e70 7970  `~matplotlib.pyp
+00018ae0: 6c6f 742e 6261 7268 602e 200d 0a20 2020  lot.barh`. ..   
+00018af0: 2022 2222 0d0a 2020 2020 0d0a 2020 2020   """..    ..    
+00018b00: 6173 7365 7274 2073 7472 286b 696e 6429  assert str(kind)
+00018b10: 2e6c 6f77 6572 2829 2e73 7472 6970 2829  .lower().strip()
+00018b20: 2069 6e20 2822 7665 7274 6963 616c 222c   in ("vertical",
+00018b30: 2027 7627 2c22 686f 7269 7a6f 6e74 616c   'v',"horizontal
+00018b40: 222c 2022 6822 292c 2028 0d0a 2020 2020  ", "h"), (..    
+00018b50: 2020 2020 2253 7570 706f 7274 206f 6e6c      "Support onl
+00018b60: 7920 7468 6520 686f 7269 7a6f 6e74 616c  y the horizontal
+00018b70: 2027 6827 2061 6e64 2076 6572 7469 6361   'h' and vertica
+00018b80: 6c20 2776 2720 6261 7220 706c 6f74 732e  l 'v' bar plots.
+00018b90: 220d 0a20 2020 2020 2020 2022 2047 6f74  "..        " Got
+00018ba0: 207b 6b69 6e64 2172 7d22 290d 0a20 2020   {kind!r}")..   
+00018bb0: 206b 696e 6420 3d73 7472 286b 696e 6429   kind =str(kind)
+00018bc0: 2e6c 6f77 6572 2829 2e73 7472 6970 2829  .lower().strip()
+00018bd0: 0d0a 2020 2020 0d0a 2020 2020 6669 672c  ..    ..    fig,
+00018be0: 2061 7820 3d20 706c 742e 7375 6270 6c6f   ax = plt.subplo
+00018bf0: 7473 286e 726f 7773 3d31 2c20 6e63 6f6c  ts(nrows=1, ncol
+00018c00: 733d 312c 2066 6967 7369 7a65 203d 6669  s=1, figsize =fi
+00018c10: 675f 7369 7a65 290d 0a20 2020 2069 6620  g_size)..    if 
+00018c20: 6b69 6e64 2069 6e20 2822 7665 7274 6963  kind in ("vertic
+00018c30: 616c 222c 2022 7622 293a 200d 0a20 2020  al", "v"): ..   
+00018c40: 2020 2020 2061 782e 6261 7220 2878 2c20       ax.bar (x, 
+00018c50: 6865 6967 6874 3d20 792c 2077 6964 7468  height= y, width
+00018c60: 203d 2020 7768 202c 202a 2a62 6172 5f6b   =  wh , **bar_k
+00018c70: 7773 290d 0a20 2020 2065 6c69 6620 6b69  ws)..    elif ki
+00018c80: 6e64 2069 6e20 2822 686f 7269 7a6f 6e74  nd in ("horizont
+00018c90: 616c 222c 2022 6822 293a 200d 0a20 2020  al", "h"): ..   
+00018ca0: 2020 2020 2061 782e 6261 7268 2028 7820       ax.barh (x 
+00018cb0: 2c20 7769 6474 6820 3d79 202c 2068 6569  , width =y , hei
+00018cc0: 6768 7420 3d77 682c 202a 2a62 6172 5f6b  ght =wh, **bar_k
+00018cd0: 7773 290d 0a20 2020 2020 2020 200d 0a20  ws)..        .. 
+00018ce0: 2020 2061 782e 7365 745f 786c 6162 656c     ax.set_xlabel
+00018cf0: 2028 786c 6162 656c 2029 0d0a 2020 2020   (xlabel )..    
+00018d00: 6178 2e73 6574 5f79 6c61 6265 6c28 796c  ax.set_ylabel(yl
+00018d10: 6162 656c 2920 0d0a 2020 2020 6178 2e73  abel) ..    ax.s
+00018d20: 6574 5f74 6974 6c65 2028 6669 675f 7469  et_title (fig_ti
+00018d30: 746c 6529 0d0a 2020 2020 6966 2073 6176  tle)..    if sav
+00018d40: 6566 6967 2069 7320 6e6f 7420 204e 6f6e  efig is not  Non
+00018d50: 653a 200d 0a20 2020 2020 2020 2073 6176  e: ..        sav
+00018d60: 6566 6967 7572 6520 2866 6967 2c20 7361  efigure (fig, sa
+00018d70: 7665 6669 672c 2064 7069 203d 2033 3030  vefig, dpi = 300
+00018d80: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00018d90: 2070 6c74 2e63 6c6f 7365 2028 2920 6966   plt.close () if
+00018da0: 2073 6176 6566 6967 2069 7320 6e6f 7420   savefig is not 
+00018db0: 4e6f 6e65 2065 6c73 6520 706c 742e 7368  None else plt.sh
+00018dc0: 6f77 2829 200d 0a20 2020 200d 0a64 6566  ow() ..    ..def
+00018dd0: 2070 6c6f 745f 7072 6f66 696c 696e 6720   plot_profiling 
+00018de0: 280d 0a20 2020 2065 7270 2c20 0d0a 2020  (..    erp, ..  
+00018df0: 2020 2f2c 200d 0a20 2020 2073 7461 7469    /, ..    stati
+00018e00: 6f6e 203d 204e 6f6e 652c 2020 0d0a 2020  on = None,  ..  
+00018e10: 2020 637a 3d4e 6f6e 652c 200d 0a20 2020    cz=None, ..   
+00018e20: 202a 2c20 0d0a 2020 2020 7374 796c 6520   *, ..    style 
+00018e30: 3d20 2763 6c61 7373 6963 272c 200d 0a20  = 'classic', .. 
+00018e40: 2020 2066 6967 5f73 697a 6520 3d20 2831     fig_size = (1
+00018e50: 302c 2034 292c 200d 0a20 2020 2063 7a5f  0, 4), ..    cz_
+00018e60: 706c 6f74 5f6b 7773 3d20 4e6f 6e65 2c0d  plot_kws= None,.
+00018e70: 0a20 2020 206d 6172 6b65 725f 6b77 733d  .    marker_kws=
+00018e80: 204e 6f6e 652c 200d 0a20 2020 2073 6176   None, ..    sav
+00018e90: 6566 6967 203d 4e6f 6e65 2c20 0d0a 2020  efig =None, ..  
+00018ea0: 2020 2a2a 706c 6f74 5f6b 7773 0d0a 2020    **plot_kws..  
+00018eb0: 2020 293a 200d 0a20 2020 2022 2222 200d    ): ..    """ .
+00018ec0: 0a20 2020 2056 6973 7561 6c69 7a65 7320  .    Visualizes 
+00018ed0: 2074 6865 2072 6573 6973 7469 7669 7479   the resistivity
+00018ee0: 2070 726f 6669 6c69 6e67 206f 6620 2045   profiling of  E
+00018ef0: 5250 2064 6174 612e 200d 0a20 2020 200d  RP data. ..    .
+00018f00: 0a20 2020 2046 756e 6374 696f 6e20 6361  .    Function ca
+00018f10: 6e20 6f76 6572 6c61 696e 2074 6865 2073  n overlain the s
+00018f20: 656c 6563 7465 6420 636f 6e64 7563 7469  elected conducti
+00018f30: 7665 207a 6f6e 6520 746f 2074 6865 2045  ve zone to the E
+00018f40: 5250 2069 6620 6063 7a60 2069 7320 0d0a  RP if `cz` is ..
+00018f50: 2020 2020 6769 7665 6e2e 200d 0a20 2020      given. ..   
+00018f60: 200d 0a20 2020 2050 6172 616d 6574 6572   ..    Parameter
+00018f70: 7320 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  s ..    --------
+00018f80: 2d2d 2d0d 0a20 2020 2065 7270 3a20 6172  ---..    erp: ar
+00018f90: 7261 795f 6c69 6b65 2031 640d 0a20 2020  ray_like 1d..   
+00018fa0: 2020 2020 2054 6865 2065 6c65 6374 7269       The electri
+00018fb0: 6361 6c20 7265 7369 7374 6976 6974 7920  cal resistivity 
+00018fc0: 7072 6f66 696c 696e 6720 6172 7261 792e  profiling array.
+00018fd0: 2049 6620 6461 7461 6672 616d 6520 6973   If dataframe is
+00018fe0: 2070 6173 7365 642c 200d 0a20 2020 2020   passed, ..     
+00018ff0: 2020 2060 7265 7369 7374 6976 6974 7960     `resistivity`
+00019000: 2063 6f6c 756d 6e20 6d75 7374 2062 6520   column must be 
+00019010: 696e 636c 7564 6564 2e20 0d0a 2020 2020  included. ..    
+00019020: 2020 2020 0d0a 2020 2020 2020 2020 2e2e      ..        ..
+00019030: 2076 6572 7369 6f6e 6368 616e 6765 643a   versionchanged:
+00019040: 3a20 302e 322e 3120 0d0a 2020 2020 2020  : 0.2.1 ..      
+00019050: 2020 2020 2043 616e 2068 656e 6365 666f       Can hencefo
+00019060: 7274 6820 6163 6365 7074 2064 6174 6166  rth accept dataf
+00019070: 7261 6d65 2074 6861 7420 636f 6e74 6169  rame that contai
+00019080: 6e73 2072 6573 6973 7469 7669 7479 2076  ns resistivity v
+00019090: 616c 7565 732e 200d 0a20 0d0a 2020 2020  alues. .. ..    
+000190a0: 7374 6174 696f 6e3a 2073 7472 2c20 696e  station: str, in
+000190b0: 742c 206f 7074 696f 6e61 6c20 0d0a 2020  t, optional ..  
+000190c0: 2020 2020 2020 5374 6174 696f 6e20 6973        Station is
+000190d0: 2075 7365 6420 746f 2076 6973 7561 6c69   used to visuali
+000190e0: 7a65 2074 6865 2063 6f6e 6475 6374 6976  ze the conductiv
+000190f0: 6520 7a6f 6e65 2069 6e20 7468 6520 6065  e zone in the `e
+00019100: 7270 6020 7072 6f66 696c 652e 200d 0a20  rp` profile. .. 
+00019110: 2020 2020 2020 2054 6869 7320 7365 656d         This seem
+00019120: 7320 7573 6566 756c 2069 6620 6063 7a60  s useful if `cz`
+00019130: 2069 7320 6e6f 7420 6769 7665 6e2e 200d   is not given. .
+00019140: 0a20 2020 2020 2020 2057 6865 6e20 6073  .        When `s
+00019150: 7461 7469 6f6e 3d27 6175 746f 2760 2069  tation='auto'` i
+00019160: 7420 6175 746f 6d61 7469 6361 6c6c 7920  t automatically 
+00019170: 6465 7465 6374 2074 6865 2062 6573 7420  detect the best 
+00019180: 636f 6e64 7563 7469 7665 207a 6f6e 6520  conductive zone 
+00019190: 0d0a 2020 2020 2020 2020 6173 7375 6d69  ..        assumi
+000191a0: 6e67 2074 6865 2076 6572 7920 6c6f 7720  ng the very low 
+000191b0: 7265 7369 7374 6976 6974 7920 696e 2074  resistivity in t
+000191c0: 6865 2070 726f 6669 6c65 2061 6e64 2070  he profile and p
+000191d0: 6c6f 7420 7468 6520 0d0a 2020 2020 2020  lot the ..      
+000191e0: 2020 636f 6e64 7563 7469 7665 207a 6f6e    conductive zon
+000191f0: 652e 2054 6f20 6861 7665 2074 6865 2065  e. To have the e
+00019200: 7870 6563 7465 6420 7265 7375 6c74 732c  xpected results,
+00019210: 2060 7374 6174 696f 6e60 2070 6f73 6974   `station` posit
+00019220: 696f 6e20 6f72 200d 0a20 2020 2020 2020  ion or ..       
+00019230: 2060 637a 6020 6d75 7374 2062 6520 6769   `cz` must be gi
+00019240: 7665 6e20 6f72 2074 6865 202e 200d 0a20  ven or the . .. 
+00019250: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00019260: 2e2e 2076 6572 7369 6f6e 6164 6465 643a  .. versionadded:
+00019270: 3a20 302e 322e 3120 0d0a 2020 2020 2020  : 0.2.1 ..      
+00019280: 2020 2020 2043 616e 2068 656e 6365 666f       Can hencefo
+00019290: 7274 6820 7061 7373 2074 6865 2073 7461  rth pass the sta
+000192a0: 7469 6f6e 2074 6f20 706c 6f74 2074 6865  tion to plot the
+000192b0: 2063 6f6e 6475 6374 6976 6520 7a6f 6e65   conductive zone
+000192c0: 2e20 0d0a 2020 2020 2020 2020 2020 200d  . ..           .
+000192d0: 0a20 2020 2063 7a3a 2061 7272 6179 5f6c  .    cz: array_l
+000192e0: 696b 652c 206f 7074 696f 6e61 6c2c 200d  ike, optional, .
+000192f0: 0a20 2020 2020 2020 2054 6865 2073 656c  .        The sel
+00019300: 6563 7465 6420 636f 6e64 7563 7469 7665  ected conductive
+00019310: 207a 6f6e 652e 2049 6620 6060 4e6f 6e65   zone. If ``None
+00019320: 6060 2c20 6063 7a60 2073 686f 756c 6420  ``, `cz` should 
+00019330: 6e6f 7420 6265 2070 6c6f 7474 6564 2e0d  not be plotted..
+00019340: 0a20 2020 2020 2020 200d 0a20 2020 2073  .        ..    s
+00019350: 7479 6c65 3a20 7374 722c 2064 6566 6175  tyle: str, defau
+00019360: 6c74 3d27 636c 6173 7369 6327 0d0a 2020  lt='classic'..  
+00019370: 2020 2020 2020 4d61 7470 6c6f 746c 6962        Matplotlib
+00019380: 2070 6c6f 7474 696e 6773 2073 7479 6c65   plottings style
+00019390: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
+000193a0: 2066 6967 5f73 697a 653a 2074 7570 6c65   fig_size: tuple
+000193b0: 2c20 6465 6661 756c 743d 2028 3130 2c20  , default= (10, 
+000193c0: 3429 200d 0a20 2020 2020 2020 204d 6174  4) ..        Mat
+000193d0: 706c 6f74 6c69 6220 6669 6775 7265 2073  plotlib figure s
+000193e0: 697a 652e 200d 0a20 2020 2020 2020 200d  ize. ..        .
+000193f0: 0a20 2020 206d 6172 6b65 725f 6b77 733a  .    marker_kws:
+00019400: 2064 6963 742c 2064 6566 6175 6c74 203d   dict, default =
+00019410: 207b 276d 6172 6b65 7227 3a27 6f27 2c20   {'marker':'o', 
+00019420: 2763 273a 2723 3945 4233 4444 2720 7d0d  'c':'#9EB3DD' }.
+00019430: 0a20 2020 2020 2020 2054 6865 2064 6963  .        The dic
+00019440: 7469 6f6e 6e61 7279 2074 6f20 6375 7374  tionnary to cust
+00019450: 6f6d 697a 6520 6d61 726b 6572 2069 6e20  omize marker in 
+00019460: 7468 6520 706c 6f74 200d 0a20 2020 2020  the plot ..     
+00019470: 2020 200d 0a20 2020 2063 7a5f 706c 6f74     ..    cz_plot
+00019480: 5f6b 7773 3a20 6469 6374 2c20 6465 6661  _kws: dict, defa
+00019490: 756c 7420 3d20 7b27 6c73 273a 272d 272c  ult = {'ls':'-',
+000194a0: 2763 273a 2723 3041 3443 4545 272c 2027  'c':'#0A4CEE', '
+000194b0: 6c77 274c 3220 7d0d 0a20 2020 2020 2020  lw'L2 }..       
+000194c0: 2054 6865 2064 6963 7469 6f6e 6e61 7279   The dictionnary
+000194d0: 2074 6f20 6375 7374 6f6d 697a 6520 7468   to customize th
+000194e0: 6520 636f 6e64 7563 7469 7a65 207a 6f6e  e conductize zon
+000194f0: 6520 696e 2074 6865 2070 6c6f 742e 0d0a  e in the plot...
+00019500: 2020 2020 2020 2020 0d0a 2020 2020 7361          ..    sa
+00019510: 7665 6669 673a 2073 7472 2c20 6f70 7469  vefig: str, opti
+00019520: 6f6e 616c 200d 0a20 2020 2020 2020 2053  onal ..        S
+00019530: 6176 6520 6669 6775 7265 206e 616d 652e  ave figure name.
+00019540: 2054 6865 2064 6566 6175 6c74 2072 6573   The default res
+00019550: 6f6c 7574 696f 6e20 646f 742d 7065 722d  olution dot-per-
+00019560: 696e 6368 2069 7320 6060 3330 3060 602e  inch is ``300``.
+00019570: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+00019580: 2070 6c6f 745f 6b77 733a 2064 6963 742c   plot_kws: dict,
+00019590: 200d 0a20 2020 2020 2020 2041 6464 6974   ..        Addit
+000195a0: 696f 6e61 6c20 6b65 7977 6f72 6420 6172  ional keyword ar
+000195b0: 6775 6d65 6e74 7320 7061 7373 6564 2074  guments passed t
+000195c0: 6f20 3a66 756e 633a 606d 6174 706c 6f74  o :func:`matplot
+000195d0: 6c69 622e 7079 706c 6f74 2e70 6c6f 7460  lib.pyplot.plot`
+000195e0: 200d 0a20 2020 2020 2020 2066 756e 6374   ..        funct
+000195f0: 696f 6e20 0d0a 2020 2020 2020 2020 0d0a  ion ..        ..
+00019600: 2020 2020 5265 7475 726e 0d0a 2020 2020      Return..    
+00019610: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 6178  --------..    ax
+00019620: 3a20 4d61 7470 6c6f 746c 6962 2e70 7970  : Matplotlib.pyp
+00019630: 6c6f 742e 4178 6973 200d 0a20 2020 2020  lot.Axis ..     
+00019640: 2020 2052 6574 7572 6e20 6178 6973 2020     Return axis  
+00019650: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+00019660: 4578 616d 706c 6573 200d 0a20 2020 202d  Examples ..    -
+00019670: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 203e  ---------..    >
+00019680: 3e3e 2066 726f 6d20 7761 7465 782e 6461  >> from watex.da
+00019690: 7461 7365 7473 2069 6d70 6f72 7420 6d61  tasets import ma
+000196a0: 6b65 5f65 7270 200d 0a20 2020 203e 3e3e  ke_erp ..    >>>
+000196b0: 2066 726f 6d20 7761 7465 782e 7574 696c   from watex.util
+000196c0: 732e 706c 6f74 7574 696c 7320 696d 706f  s.plotutils impo
+000196d0: 7274 2070 6c6f 745f 7072 6f66 696c 696e  rt plot_profilin
+000196e0: 6720 0d0a 2020 2020 3e3e 3e20 643d 206d  g ..    >>> d= m
+000196f0: 616b 655f 6572 7020 286e 5f73 7461 7469  ake_erp (n_stati
+00019700: 6f6e 7320 3d35 362c 2073 6565 6420 3d20  ons =56, seed = 
+00019710: 3432 290d 0a20 2020 203e 3e3e 2070 6c6f  42)..    >>> plo
+00019720: 745f 7072 6f66 696c 696e 6720 2028 642e  t_profiling  (d.
+00019730: 7265 7369 7374 6976 6974 7929 0d0a 2020  resistivity)..  
+00019740: 2020 3e3e 3e20 2320 7265 6164 2074 6865    >>> # read the
+00019750: 2066 7261 6d65 2061 6e64 2067 6574 2074   frame and get t
+00019760: 6865 2072 6573 6973 7469 7669 7479 2076  he resistivity v
+00019770: 616c 7565 7320 0d0a 2020 2020 3e3e 3e20  alues ..    >>> 
+00019780: 706c 6f74 5f70 726f 6669 6c69 6e67 2028  plot_profiling (
+00019790: 642e 6672 616d 652c 2073 7461 7469 6f6e  d.frame, station
+000197a0: 203d 2773 3037 2720 2920 0d0a 2020 2020   ='s07' ) ..    
+000197b0: 3c41 7865 7353 7562 706c 6f74 3a78 6c61  <AxesSubplot:xla
+000197c0: 6265 6c3d 2753 7461 7469 6f6e 7327 2c20  bel='Stations', 
+000197d0: 796c 6162 656c 3d27 4170 702e 7265 7369  ylabel='App.resi
+000197e0: 7374 6976 6974 7920 2824 5c5c 4f6d 6567  stivity ($\\Omeg
+000197f0: 612e 6d24 2927 3e0d 0a20 2020 2022 2222  a.m$)'>..    """
+00019800: 0d0a 2020 2020 706c 742e 7374 796c 652e  ..    plt.style.
+00019810: 7573 6520 2873 7479 6c65 2029 0d0a 2020  use (style )..  
+00019820: 2020 0d0a 2020 2020 6966 2068 6173 6174    ..    if hasat
+00019830: 7472 2028 2065 7270 202c 2027 636f 6c75  tr ( erp , 'colu
+00019840: 6d6e 7327 2920 616e 6420 6861 7361 7474  mns') and hasatt
+00019850: 7220 2820 6572 7020 2c20 275f 5f61 7272  r ( erp , '__arr
+00019860: 6179 5f5f 2729 3a20 0d0a 2020 2020 2020  ay__'): ..      
+00019870: 2020 6966 2027 7265 7369 7374 6976 6974    if 'resistivit
+00019880: 7927 206e 6f74 2069 6e20 2065 7270 2e63  y' not in  erp.c
+00019890: 6f6c 756d 6e73 203a 200d 0a20 2020 2020  olumns : ..     
+000198a0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+000198b0: 6545 7272 6f72 2028 224d 6973 7369 6e67  eError ("Missing
+000198c0: 2072 6573 6973 7469 7669 7479 2063 6f6c   resistivity col
+000198d0: 756d 6e20 696e 2074 6865 2064 6174 612e  umn in the data.
+000198e0: 2229 0d0a 2020 2020 2020 2020 0d0a 2020  ")..        ..  
+000198f0: 2020 2020 2020 6572 7020 3d20 6572 702e        erp = erp.
+00019900: 7265 7369 7374 6976 6974 7920 0d0a 2020  resistivity ..  
+00019910: 2020 0d0a 2020 2020 6572 7020 3d20 6368    ..    erp = ch
+00019920: 6563 6b5f 7920 2865 7270 202c 2069 6e70  eck_y (erp , inp
+00019930: 7574 5f6e 616d 6520 3d22 7361 6d70 6c65  ut_name ="sample
+00019940: 206f 6620 4552 5020 6461 7461 2229 0d0a   of ERP data")..
+00019950: 2020 200d 0a20 2020 2069 6620 7374 6174     ..    if stat
+00019960: 696f 6e20 6973 206e 6f74 204e 6f6e 653a  ion is not None:
+00019970: 200d 0a20 2020 2020 2020 2066 726f 6d20   ..        from 
+00019980: 2e63 6f72 6575 7469 6c73 2069 6d70 6f72  .coreutils impor
+00019990: 7420 6465 6669 6e65 436f 6e64 7563 7469  t defineConducti
+000199a0: 7665 5a6f 6e65 200d 0a20 2020 2020 2020  veZone ..       
+000199b0: 200d 0a20 2020 2020 2020 2061 7574 6f20   ..        auto 
+000199c0: 3d46 616c 7365 200d 0a20 2020 2020 2020  =False ..       
+000199d0: 2069 6620 7374 7228 7374 6174 696f 6e29   if str(station)
+000199e0: 2e6c 6f77 6572 2829 2e73 7472 6970 2028  .lower().strip (
+000199f0: 2920 3d3d 2761 7574 6f27 3a20 0d0a 2020  ) =='auto': ..  
+00019a00: 2020 2020 2020 2020 2020 6175 746f 203d            auto =
+00019a10: 2054 7275 6520 3b20 7374 6174 696f 6e20   True ; station 
+00019a20: 3d4e 6f6e 6520 0d0a 2020 2020 2020 2020  =None ..        
+00019a30: 637a 2c20 2a5f 2020 3d20 6465 6669 6e65  cz, *_  = define
+00019a40: 436f 6e64 7563 7469 7665 5a6f 6e65 280d  ConductiveZone(.
+00019a50: 0a20 2020 2020 2020 2020 2020 2065 7270  .            erp
+00019a60: 202c 2073 7461 7469 6f6e 203d 2073 7461   , station = sta
+00019a70: 7469 6f6e 202c 2061 7574 6f3d 2061 7574  tion , auto= aut
+00019a80: 6f20 290d 0a20 2020 200d 0a20 2020 2066  o )..    ..    f
+00019a90: 6967 2c20 6178 203d 2070 6c74 2e73 7562  ig, ax = plt.sub
+00019aa0: 706c 6f74 7328 312c 312c 2066 6967 7369  plots(1,1, figsi
+00019ab0: 7a65 203d 6669 675f 7369 7a65 290d 0a20  ze =fig_size).. 
+00019ac0: 2020 206c 6567 203d 5b5d 0d0a 2020 2020     leg =[]..    
+00019ad0: 0d0a 2020 2020 7a6c 2c20 3d20 6178 2e70  ..    zl, = ax.p
+00019ae0: 6c6f 7428 6e70 2e61 7261 6e67 6528 6c65  lot(np.arange(le
+00019af0: 6e28 6572 7029 292c 2065 7270 2c20 0d0a  n(erp)), erp, ..
+00019b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b10: 2020 6c61 6265 6c20 3d27 456c 6563 7472    label ='Electr
+00019b20: 6963 616c 2072 6573 6973 7469 7669 7479  ical resistivity
+00019b30: 2070 726f 6669 6c69 6e67 272c 200d 0a20   profiling', .. 
+00019b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b50: 202a 2a70 6c6f 745f 6b77 7320 0d0a 2020   **plot_kws ..  
+00019b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b70: 290d 0a20 2020 206d 6172 6b65 725f 6b77  )..    marker_kw
+00019b80: 7320 3d20 6d61 726b 6572 5f6b 7773 206f  s = marker_kws o
+00019b90: 7220 6469 6374 2028 6d61 726b 6572 203d  r dict (marker =
+00019ba0: 276f 272c 2063 3d27 2339 4542 3344 4427  'o', c='#9EB3DD'
+00019bb0: 2029 0d0a 2020 2020 6178 2e73 6361 7474   )..    ax.scatt
+00019bc0: 6572 2028 6e70 2e61 7261 6e67 6528 6c65  er (np.arange(le
+00019bd0: 6e28 6572 7029 292c 2065 7270 2c20 2a2a  n(erp)), erp, **
+00019be0: 6d61 726b 6572 5f6b 7773 2029 0d0a 2020  marker_kws )..  
+00019bf0: 2020 0d0a 2020 2020 6c65 672e 6170 7065    ..    leg.appe
+00019c00: 6e64 287a 6c29 2020 2020 0d0a 2020 2020  nd(zl)    ..    
+00019c10: 2020 2020 0d0a 2020 2020 6966 2063 7a20      ..    if cz 
+00019c20: 6973 206e 6f74 204e 6f6e 653a 200d 0a20  is not None: .. 
+00019c30: 2020 2020 2020 2063 7a3d 2063 6865 636b         cz= check
+00019c40: 5f79 2028 637a 2c20 696e 7075 745f 6e61  _y (cz, input_na
+00019c50: 6d65 203d 2243 6f6e 6475 6374 6976 6520  me ="Conductive 
+00019c60: 7a6f 6e65 2027 637a 2722 290d 0a20 2020  zone 'cz'")..   
+00019c70: 2020 2020 207a 203d 206e 702e 6d61 2e6d       z = np.ma.m
+00019c80: 6173 6b65 645f 7661 6c75 6573 2028 6572  asked_values (er
+00019c90: 702c 206e 702e 6973 696e 2865 7270 2c20  p, np.isin(erp, 
+00019ca0: 637a 2029 290d 0a20 2020 2020 2020 2073  cz ))..        s
+00019cb0: 616d 706c 655f 6d61 736b 6564 203d 206e  ample_masked = n
+00019cc0: 702e 6d61 2e61 7272 6179 280d 0a20 2020  p.ma.array(..   
+00019cd0: 2020 2020 2020 2020 2065 7270 2c20 6d61           erp, ma
+00019ce0: 736b 203d 207e 7a2e 6669 6c6c 5f76 616c  sk = ~z.fill_val
+00019cf0: 7565 2e61 7374 7970 6528 2762 6f6f 6c27  ue.astype('bool'
+00019d00: 2920 290d 0a20 2020 200d 0a20 2020 2020  ) )..    ..     
+00019d10: 2020 2063 7a5f 706c 6f74 5f6b 7773 203d     cz_plot_kws =
+00019d20: 2063 7a5f 706c 6f74 5f6b 7773 206f 7220   cz_plot_kws or 
+00019d30: 6469 6374 2028 6c73 3d27 2d27 2c63 3d27  dict (ls='-',c='
+00019d40: 2330 4134 4345 4527 2c20 6c77 203d 3220  #0A4CEE', lw =2 
+00019d50: 290d 0a20 2020 2020 2020 2063 7a6c 2c20  )..        czl, 
+00019d60: 3d20 6178 2e70 6c6f 7428 0d0a 2020 2020  = ax.plot(..    
+00019d70: 2020 2020 2020 2020 6e70 2e61 7261 6e67          np.arang
+00019d80: 6528 6c65 6e28 6572 7029 292c 2073 616d  e(len(erp)), sam
+00019d90: 706c 655f 6d61 736b 6564 2c20 0d0a 2020  ple_masked, ..  
+00019da0: 2020 2020 2020 2020 2020 6c61 6265 6c20            label 
+00019db0: 3d27 436f 6e64 7563 7469 7665 207a 6f6e  ='Conductive zon
+00019dc0: 6527 2c20 0d0a 2020 2020 2020 2020 2020  e', ..          
+00019dd0: 2020 2a2a 637a 5f70 6c6f 745f 6b77 730d    **cz_plot_kws.
+00019de0: 0a20 2020 2020 2020 2020 2020 2029 0d0a  .            )..
+00019df0: 2020 2020 2020 2020 6c65 672e 6170 7065          leg.appe
+00019e00: 6e64 2863 7a6c 290d 0a0d 0a20 2020 2061  nd(czl)....    a
+00019e10: 782e 7365 745f 7874 6963 6b73 2872 616e  x.set_xticks(ran
+00019e20: 6765 286c 656e 2865 7270 2929 290d 0a20  ge(len(erp))).. 
+00019e30: 2020 200d 0a20 2020 2069 6620 6c65 6e28     ..    if len(
+00019e40: 6572 7020 2920 3e3d 2031 3420 3a20 0d0a  erp ) >= 14 : ..
+00019e50: 2020 2020 2020 2020 6178 2e78 6178 6973          ax.xaxis
+00019e60: 2e73 6574 5f6d 616a 6f72 5f66 6f72 6d61  .set_major_forma
+00019e70: 7474 6572 2028 706c 742e 4675 6e63 466f  tter (plt.FuncFo
+00019e80: 726d 6174 7465 7228 5f66 6f72 6d61 745f  rmatter(_format_
+00019e90: 7469 636b 7329 290d 0a20 2020 2065 6c73  ticks))..    els
+00019ea0: 6520 3a20 0d0a 2020 2020 2020 2020 0d0a  e : ..        ..
+00019eb0: 2020 2020 2020 2020 6178 2e73 6574 5f78          ax.set_x
+00019ec0: 7469 636b 6c61 6265 6c73 280d 0a20 2020  ticklabels(..   
+00019ed0: 2020 2020 2020 2020 205b 2753 7b3a 3032           ['S{:02
+00019ee0: 7d27 2e66 6f72 6d61 7428 696e 7428 6929  }'.format(int(i)
+00019ef0: 2b31 2920 666f 7220 6920 696e 2072 616e  +1) for i in ran
+00019f00: 6765 286c 656e 2865 7270 2929 5d29 200d  ge(len(erp))]) .
+00019f10: 0a20 2020 2020 2020 2020 0d0a 2020 2020  .         ..    
+00019f20: 6178 2e73 6574 5f78 6c61 6265 6c28 2753  ax.set_xlabel('S
+00019f30: 7461 7469 6f6e 7327 290d 0a20 2020 2061  tations')..    a
+00019f40: 782e 7365 745f 796c 6162 656c 2827 4170  x.set_ylabel('Ap
+00019f50: 702e 7265 7369 7374 6976 6974 7920 2824  p.resistivity ($
+00019f60: 5c4f 6d65 6761 2e6d 2429 2729 0d0a 2020  \Omega.m$)')..  
+00019f70: 2020 6178 2e6c 6567 656e 6428 2068 616e    ax.legend( han
+00019f80: 646c 6573 203d 206c 6567 2c20 6c6f 6320  dles = leg, loc 
+00019f90: 3d27 6265 7374 2729 0d0a 2020 2020 6178  ='best')..    ax
+00019fa0: 2e73 6574 5f78 6c69 6d20 285b 2d31 2c20  .set_xlim ([-1, 
+00019fb0: 6c65 6e28 6572 7029 5d29 0d0a 0d0a 2020  len(erp)])....  
+00019fc0: 2020 6966 2073 6176 6566 6967 2069 7320    if savefig is 
+00019fd0: 6e6f 7420 204e 6f6e 653a 2073 6176 6566  not  None: savef
+00019fe0: 6967 7572 6520 2866 6967 2c20 7361 7665  igure (fig, save
+00019ff0: 6669 672c 2064 7069 203d 2033 3030 290d  fig, dpi = 300).
+0001a000: 0a20 2020 2020 2020 200d 0a20 2020 2070  .        ..    p
+0001a010: 6c74 2e63 6c6f 7365 2028 2920 6966 2073  lt.close () if s
+0001a020: 6176 6566 6967 2069 7320 6e6f 7420 4e6f  avefig is not No
+0001a030: 6e65 2065 6c73 6520 706c 742e 7368 6f77  ne else plt.show
+0001a040: 2829 200d 0a20 2020 200d 0a20 2020 2072  () ..    ..    r
+0001a050: 6574 7572 6e20 6178 200d 0a0d 0a64 6566  eturn ax ....def
+0001a060: 2070 6c6f 745f 736b 6577 2028 0d0a 2020   plot_skew (..  
+0001a070: 2020 6564 695f 6f62 6a2c 200d 0a20 2020    edi_obj, ..   
+0001a080: 206d 6574 686f 643d 2742 6168 7227 2c20   method='Bahr', 
+0001a090: 0d0a 2020 2020 6d6f 6465 3d4e 6f6e 652c  ..    mode=None,
+0001a0a0: 200d 0a20 2020 2074 6872 6573 686f 6c64   ..    threshold
+0001a0b0: 5f6c 696e 6520 3d4e 6f6e 652c 200d 0a20  _line =None, .. 
+0001a0c0: 2020 2066 6967 5f73 697a 6520 3d20 2837     fig_size = (7
+0001a0d0: 2c20 3529 2c20 0d0a 2020 2020 7361 7665  , 5), ..    save
+0001a0e0: 6669 6720 3d20 4e6f 6e65 2c20 0d0a 2020  fig = None, ..  
+0001a0f0: 2020 7669 6577 3d4e 6f6e 652c 0d0a 2020    view=None,..  
+0001a100: 2020 7374 796c 653d 4e6f 6e65 2c20 0d0a    style=None, ..
+0001a110: 2020 2020 2a2a 6b77 7320 0d0a 2020 2020      **kws ..    
+0001a120: 293a 0d0a 2020 2020 2222 2220 506c 6f74  ):..    """ Plot
+0001a130: 2070 6861 7365 2073 656e 7369 7469 7665   phase sensitive
+0001a140: 2073 6b65 7720 7669 7375 616c 697a 6174   skew visualizat
+0001a150: 696f 6e2e 200d 0a20 2020 200d 0a20 2020  ion. ..    ..   
+0001a160: 2050 6861 7365 2053 656e 7369 7469 7669   Phase Sensitivi
+0001a170: 7479 2053 6b65 7720 283a 6d61 7468 3a60  ty Skew (:math:`
+0001a180: 5c65 7461 6029 2069 7320 6120 6469 6d65  \eta`) is a dime
+0001a190: 6e73 696f 6e61 6c69 7479 2074 6f6f 6c20  nsionality tool 
+0001a1a0: 7468 6174 200d 0a20 2020 2072 6570 7265  that ..    repre
+0001a1b0: 7365 6e74 7320 6120 6d65 6173 7572 6520  sents a measure 
+0001a1c0: 6f66 2074 6865 2073 6b65 7720 6f66 2074  of the skew of t
+0001a1d0: 6865 2020 7068 6173 6573 206f 6620 7468  he  phases of th
+0001a1e0: 6520 696d 7065 6461 6e63 6520 0d0a 2020  e impedance ..  
+0001a1f0: 2020 7465 6e73 6f72 2e20 5468 6520 7061    tensor. The pa
+0001a200: 7261 6d65 7465 7220 6973 2074 6875 7320  rameter is thus 
+0001a210: 756e 6166 6665 6374 6564 2062 7920 7468  unaffected by th
+0001a220: 6520 6469 7374 6f72 7469 6f6e 200d 0a20  e distortion .. 
+0001a230: 2020 2065 6666 6563 742c 2075 6e6c 696b     effect, unlik
+0001a240: 6520 7468 6520 5377 6966 742d 736b 6577  e the Swift-skew
+0001a250: 2061 6e64 2065 6c6c 6970 7469 6369 7479   and ellipticity
+0001a260: 2064 696d 656e 7369 6f6e 616c 6974 7920   dimensionality 
+0001a270: 0d0a 2020 2020 746f 6f6c 7320 5b31 5d5f  ..    tools [1]_
+0001a280: 2e20 0d0a 2020 2020 0d0a 2020 2020 5661  . ..    ..    Va
+0001a290: 6c75 6573 206f 6620 3a6d 6174 683a 605c  lues of :math:`\
+0001a2a0: 6574 6160 203e 2030 2e33 2061 7265 2063  eta` > 0.3 are c
+0001a2b0: 6f6e 7369 6465 7265 6420 746f 2072 6570  onsidered to rep
+0001a2c0: 7265 7365 6e74 2033 4420 6461 7461 2e20  resent 3D data. 
+0001a2d0: 0d0a 2020 2020 5068 6173 652d 7365 6e73  ..    Phase-sens
+0001a2e0: 6974 6976 6520 736b 6577 7320 6c65 7373  itive skews less
+0001a2f0: 2074 6861 6e20 302e 3120 696e 6469 6361   than 0.1 indica
+0001a300: 7465 2031 442c 2032 4420 6f72 2064 6973  te 1D, 2D or dis
+0001a310: 746f 7274 6564 200d 0a20 2020 2032 4420  torted ..    2D 
+0001a320: 2833 2d44 202f 322d 4429 2063 6173 6573  (3-D /2-D) cases
+0001a330: 2e20 5661 6c75 6573 206f 6620 3a6d 6174  . Values of :mat
+0001a340: 683a 605c 6574 6160 2062 6574 7765 656e  h:`\eta` between
+0001a350: 2030 2e31 2061 6e64 2030 2e33 2069 6e64   0.1 and 0.3 ind
+0001a360: 6963 6174 6573 200d 0a20 2020 206d 6f64  icates ..    mod
+0001a370: 6966 6965 6420 3344 2f32 4420 7374 7275  ified 3D/2D stru
+0001a380: 6374 7572 6573 205b 325d 5f20 6163 636f  ctures [2]_ acco
+0001a390: 7264 696e 6720 746f 2060 4261 6872 2720  rding to `Bahr' 
+0001a3a0: 6d65 7468 6f64 732e 2048 6f77 6576 6572  methods. However
+0001a3b0: 2c0d 0a20 2020 2076 616c 7565 7320 3a6d  ,..    values :m
+0001a3c0: 6174 683a 605c 6574 6120 3e3d 302e 3260  ath:`\eta >=0.2`
+0001a3d0: 2075 7369 6e67 2074 6865 2060 5377 6966   using the `Swif
+0001a3e0: 7460 206d 6574 686f 6473 2c20 7468 6520  t` methods, the 
+0001a3f0: 736d 616c 6c65 7220 7468 6520 7661 6c75  smaller the valu
+0001a400: 6520 0d0a 2020 2020 3a6d 6174 683a 605c  e ..    :math:`\
+0001a410: 6574 6160 2028 2063 6c6f 7365 2074 6f20  eta` ( close to 
+0001a420: 3a6d 6174 683a 6030 2e60 292c 2074 6865  :math:`0.`), the
+0001a430: 2063 6c6f 7365 7220 7468 6520 7374 7275   closer the stru
+0001a440: 6374 7572 6520 746f 2032 4420 0d0a 2020  cture to 2D ..  
+0001a450: 2020 7374 7275 6374 7572 6520 616e 6420    structure and 
+0001a460: 7669 6365 2076 6572 7361 2e48 6f77 6576  vice versa.Howev
+0001a470: 6572 2c20 6974 2069 7320 6765 6e65 7261  er, it is genera
+0001a480: 6c6c 7920 636f 6e73 6964 6572 6564 2074  lly considered t
+0001a490: 6861 7420 0d0a 2020 2020 616e 2065 6c65  hat ..    an ele
+0001a4a0: 6374 7269 6361 6c20 7374 7275 6374 7572  ctrical structur
+0001a4b0: 6520 6f66 203a 6d61 7468 3a60 5c65 7461  e of :math:`\eta
+0001a4c0: 203c 2030 2e34 6020 6361 6e20 6265 2074   < 0.4` can be t
+0001a4d0: 7265 6174 6564 2061 7320 6120 3244 200d  reated as a 2D .
+0001a4e0: 0a20 2020 206d 6564 6975 6d2e 2048 6572  .    medium. Her
+0001a4f0: 6520 6173 2074 6865 2060 6074 6872 6573  e as the ``thres
+0001a500: 686f 6c64 5f6c 696e 6560 6020 666f 7220  hold_line`` for 
+0001a510: 3a6d 6574 683a 605c 6574 6160 2075 7369  :meth:`\eta` usi
+0001a520: 6e67 2074 6865 200d 0a20 2020 2053 7769  ng the ..    Swi
+0001a530: 6674 206d 6574 686f 6420 7368 6f75 6c64  ft method should
+0001a540: 2062 6520 7365 7420 6173 2060 302e 3460   be set as `0.4`
+0001a550: 2e20 0d0a 2020 2020 0d0a 2020 2020 2e2e  . ..    ..    ..
+0001a560: 2076 6572 7369 6f6e 6164 6465 643a 3a20   versionadded:: 
+0001a570: 302e 312e 3520 0d0a 2020 2020 0d0a 2020  0.1.5 ..    ..  
+0001a580: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+0001a590: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20    -----------.. 
+0001a5a0: 2020 2065 6469 5f6f 626a 3a20 7374 722c     edi_obj: str,
+0001a5b0: 203a 636c 6173 733a 6077 6174 6578 2e65   :class:`watex.e
+0001a5c0: 6469 2e45 6469 6020 0d0a 2020 2020 2020  di.Edi` ..      
+0001a5d0: 2020 4675 6c6c 2070 6174 6820 746f 2065    Full path to e
+0001a5e0: 6469 6669 6c65 7320 6f72 2020 3a63 6c61  difiles or  :cla
+0001a5f0: 7373 3a60 7e77 6174 6578 2e65 6469 2e45  ss:`~watex.edi.E
+0001a600: 6469 6020 6f62 6a65 6374 2e20 0d0a 2020  di` object. ..  
+0001a610: 2020 2020 2020 0d0a 2020 2020 6d65 7468        ..    meth
+0001a620: 6f64 3a20 7374 722c 2064 6566 6175 6c74  od: str, default
+0001a630: 3d27 4261 6872 273a 200d 0a20 2020 2020  ='Bahr': ..     
+0001a640: 2020 204b 696e 6420 6f66 2063 6f72 7265     Kind of corre
+0001a650: 6374 696f 6e2e 2043 616e 2062 6520 6060  ction. Can be ``
+0001a660: 7377 6966 7460 6020 666f 7220 7468 6520  swift`` for the 
+0001a670: 7265 6d6f 7665 2064 6973 746f 7273 696f  remove distorsio
+0001a680: 6e20 7072 6f70 6f73 6564 200d 0a20 2020  n proposed ..   
+0001a690: 2020 2020 2062 7920 5377 6966 7420 696e       by Swift in
+0001a6a0: 2031 3936 3720 5b33 5d5f 2e20 5468 6520   1967 [3]_. The 
+0001a6b0: 7661 6c75 6520 636c 6f73 6520 746f 2030  value close to 0
+0001a6c0: 2e20 6173 7375 6d65 2074 6865 2031 4420  . assume the 1D 
+0001a6d0: 616e 6420 3244 200d 0a20 2020 2020 2020  and 2D ..       
+0001a6e0: 2073 7472 7563 7475 7265 732c 2061 6e64   structures, and
+0001a6f0: 2033 4420 6f74 6865 7277 6973 652e 2043   3D otherwise. C
+0001a700: 6f6e 7665 7273 6c79 2074 6f20 6060 6261  onversly to ``ba
+0001a710: 6872 6060 2066 6f72 2074 6865 2072 656d  hr`` for the rem
+0001a720: 6f76 6520 0d0a 2020 2020 2020 2020 6469  ove ..        di
+0001a730: 7374 6f72 7369 6f6e 2070 726f 706f 7365  storsion propose
+0001a740: 6420 2062 7920 4261 6872 2069 6e20 3139  d  by Bahr in 19
+0001a750: 3931 205b 325d 5f2e 2054 6865 206c 6174  91 [2]_. The lat
+0001a760: 7465 7220 7468 7265 7368 6f6c 6420 6973  ter threshold is
+0001a770: 2073 6574 200d 0a20 2020 2020 2020 2074   set ..        t
+0001a780: 6f20 302e 332e 2041 626f 7665 2074 6869  o 0.3. Above thi
+0001a790: 7320 7661 6c75 6520 7468 6520 7374 7275  s value the stru
+0001a7a0: 6374 7572 6573 2069 7320 3344 2e20 0d0a  ctures is 3D. ..
+0001a7b0: 2020 2020 2020 2020 0d0a 2020 2020 7468          ..    th
+0001a7c0: 7265 7368 6f6c 645f 6c69 6e65 3a20 666c  reshold_line: fl
+0001a7d0: 6f61 742c 206f 7074 696f 6e61 6c0d 0a20  oat, optional.. 
+0001a7e0: 2020 2020 2020 5669 7375 616c 697a 6520        Visualize 
+0001a7f0: 7468 2074 6872 6573 686f 6c64 206c 696e  th threshold lin
+0001a800: 652e 2043 616e 2062 6520 5b27 6261 6872  e. Can be ['bahr
+0001a810: 272c 2027 7377 6966 7427 2c20 2762 6f74  ', 'swift', 'bot
+0001a820: 6827 5d3a 0d0a 2020 2020 2020 2020 2020  h']:..          
+0001a830: 200d 0a20 2020 2020 2020 2d20 4e6f 7465   ..       - Note
+0001a840: 2074 6861 7420 7768 656e 206d 6574 686f   that when metho
+0001a850: 6420 6973 2073 6574 2074 6f20 6060 7377  d is set to ``sw
+0001a860: 6966 7460 602c 2074 6865 2076 616c 7565  ift``, the value
+0001a870: 2063 6c6f 7365 2074 6f20 636c 6f73 6520   close to close 
+0001a880: 0d0a 2020 2020 2020 2020 2074 6f20 3a6d  ..         to :m
+0001a890: 6174 683a 6030 2e60 2061 7373 756d 6520  ath:`0.` assume 
+0001a8a0: 7468 6520 3144 2061 6e64 2032 4420 7374  the 1D and 2D st
+0001a8b0: 7275 6374 7572 6573 2c20 2061 6e64 2033  ructures,  and 3
+0001a8c0: 4420 6f74 6865 7277 6973 652e 200d 0a20  D otherwise. .. 
+0001a8d0: 2020 2020 2020 2d20 7768 656e 206d 6574        - when met
+0001a8e0: 686f 6420 6973 2073 6574 2074 6f20 6060  hod is set to ``
+0001a8f0: 4261 6872 6060 2c20 3a6d 6174 683a 605c  Bahr``, :math:`\
+0001a900: 6d75 203e 2030 2e33 6060 2020 6973 2033  mu > 0.3``  is 3
+0001a910: 4420 7374 7275 6374 7572 6573 2c20 0d0a  D structures, ..
+0001a920: 2020 2020 2020 2020 2062 6574 7765 656e           between
+0001a930: 203a 6d61 7468 3a60 5b30 2e31 202d 2030   :math:`[0.1 - 0
+0001a940: 2e33 5d60 2061 7373 756d 6573 206d 6f64  .3]` assumes mod
+0001a950: 6966 6965 6420 3344 2f32 4420 7374 7275  ified 3D/2D stru
+0001a960: 6374 7572 6573 2077 6865 7265 6173 200d  ctures whereas .
+0001a970: 0a20 2020 2020 2020 2020 3a6d 6174 683a  .         :math:
+0001a980: 603c 302e 3160 2031 442c 2032 4420 6f72  `<0.1` 1D, 2D or
+0001a990: 2064 6973 746f 7274 6564 2032 442e 200d   distorted 2D. .
+0001a9a0: 0a20 2020 2020 2020 2020 0d0a 2020 2020  .         ..    
+0001a9b0: 6d6f 6465 3a73 7472 2c20 6f70 7469 6f6e  mode:str, option
+0001a9c0: 616c 200d 0a20 2020 2020 2020 582d 6178  al ..       X-ax
+0001a9d0: 6973 2063 6f6f 7264 696e 6174 6573 2066  is coordinates f
+0001a9e0: 6f72 2076 6973 7561 6c69 7361 7469 6f6e  or visualisation
+0001a9f0: 2e20 706c 6f74 2065 6974 6865 7220 6060  . plot either ``
+0001aa00: 2766 7265 7175 656e 6379 2760 6020 6f72  'frequency'`` or
+0001aa10: 0d0a 2020 2020 2020 2060 6027 7065 7269  ..       ``'peri
+0001aa20: 6f64 7327 6060 2e20 2054 6865 2064 6566  ods'``.  The def
+0001aa30: 6175 6c74 2069 7320 6060 2766 7265 7175  ault is ``'frequ
+0001aa40: 656e 6379 2760 6020 0d0a 2020 2020 2020  ency'`` ..      
+0001aa50: 200d 0a20 2020 2076 6965 773a 2073 7472   ..    view: str
+0001aa60: 2c20 6465 6661 756c 743d 2773 6b65 7727  , default='skew'
+0001aa70: 0d0a 2020 2020 2020 2070 6861 7365 2073  ..       phase s
+0001aa80: 656e 7369 7374 6976 6520 7669 7375 616c  ensistive visual
+0001aa90: 697a 6174 696f 6e2e 2043 616e 2062 6520  ization. Can be 
+0001aaa0: 726f 7461 7469 6f6e 616c 2069 6e76 6172  rotational invar
+0001aab0: 6961 6e74 200d 0a20 2020 2020 2020 6060  iant ..       ``
+0001aac0: 696e 7661 7269 616e 7460 602e 204e 6f74  invariant``. Not
+0001aad0: 6520 7468 6174 2073 6574 7469 6e67 2074  e that setting t
+0001aae0: 6f20 6060 6d75 6060 206f 7220 6060 696e  o ``mu`` or ``in
+0001aaf0: 7661 7269 616e 7460 6020 646f 6573 200d  variant`` does .
+0001ab00: 0a20 2020 2020 2020 6e6f 7420 6368 616e  .       not chan
+0001ab10: 6765 2061 6e79 2069 6e74 6572 7072 6574  ge any interpret
+0001ab20: 6174 696f 6e20 7369 6e63 6520 7468 6520  ation since the 
+0001ab30: 6469 7374 6f72 7469 6f6e 206f 6620 5a20  distortion of Z 
+0001ab40: 6172 6520 616c 6c20 0d0a 2020 2020 2020  are all ..      
+0001ab50: 2072 6f74 6174 696f 6e61 6c20 696e 7661   rotational inva
+0001ab60: 7269 616e 7420 7768 6574 6865 7220 7573  riant whether us
+0001ab70: 696e 6720 7468 6520 6060 4261 6872 6060  ing the ``Bahr``
+0001ab80: 206f 7220 6060 7377 6966 7460 600d 0a20   or ``swift``.. 
+0001ab90: 2020 2020 2020 6d65 7468 6f64 732e 200d        methods. .
+0001aba0: 0a20 200d 0a20 2020 2066 6967 5f73 697a  .  ..    fig_siz
+0001abb0: 653a 2074 7570 6c65 2c20 6465 6661 756c  e: tuple, defaul
+0001abc0: 743d 2028 3130 2c20 3429 200d 0a20 2020  t= (10, 4) ..   
+0001abd0: 2020 2020 204d 6174 706c 6f74 6c69 6220       Matplotlib 
+0001abe0: 6669 6775 7265 2073 697a 652e 200d 0a20  figure size. .. 
+0001abf0: 2020 2020 2020 200d 0a20 2020 2073 6176         ..    sav
+0001ac00: 6566 6967 3a20 7374 722c 206f 7074 696f  efig: str, optio
+0001ac10: 6e61 6c20 0d0a 2020 2020 2020 2020 2053  nal ..         S
+0001ac20: 6176 6520 6669 6775 7265 206e 616d 652e  ave figure name.
+0001ac30: 2054 6865 2064 6566 6175 6c74 2072 6573   The default res
+0001ac40: 6f6c 7574 696f 6e20 646f 742d 7065 722d  olution dot-per-
+0001ac50: 696e 6368 2069 7320 6060 3330 3060 602e  inch is ``300``.
+0001ac60: 200d 0a20 2020 2020 2020 2020 0d0a 2020   ..         ..  
+0001ac70: 2020 7374 796c 653a 2073 7472 2c20 6465    style: str, de
+0001ac80: 6661 756c 743d 2763 6c61 7373 6963 270d  fault='classic'.
+0001ac90: 0a20 2020 2020 2020 204d 6174 706c 6f74  .        Matplot
+0001aca0: 6c69 6220 706c 6f74 7469 6e67 7320 7374  lib plottings st
+0001acb0: 796c 652e 0d0a 2020 2020 2020 2020 0d0a  yle...        ..
+0001acc0: 2020 2020 6b77 733a 2064 6963 742c 200d      kws: dict, .
+0001acd0: 0a20 2020 2020 2020 4d61 7470 6c6f 746c  .       Matplotl
+0001ace0: 6962 2041 7865 7320 7363 6174 7465 7270  ib Axes scatterp
+0001acf0: 6c6f 7420 6164 6469 7469 6f6e 616c 206b  lot additional k
+0001ad00: 6579 776f 7264 7320 6172 6775 6d65 6e74  eywords argument
+0001ad10: 732e 200d 0a20 2020 2020 2020 200d 0a20  s. ..        .. 
+0001ad20: 2020 2052 6574 7572 6e0d 0a20 2020 202d     Return..    -
+0001ad30: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2061 783a  -------..    ax:
+0001ad40: 204d 6174 706c 6f74 6c69 622e 7079 706c   Matplotlib.pypl
+0001ad50: 6f74 2e41 7869 7320 0d0a 2020 2020 2020  ot.Axis ..      
+0001ad60: 2020 5265 7475 726e 2061 7869 7320 200d    Return axis  .
+0001ad70: 0a20 2020 2020 2020 200d 0a20 2020 2053  .        ..    S
+0001ad80: 6565 2041 6c73 6f20 0d0a 2020 2020 2d2d  ee Also ..    --
+0001ad90: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2077 6174  -------..    wat
+0001ada0: 6578 2e6d 6574 686f 6473 2e65 6d2e 5072  ex.methods.em.Pr
+0001adb0: 6f63 6573 7369 6e67 2e73 6b65 773a 200d  ocessing.skew: .
+0001adc0: 0a20 2020 2020 2020 2053 6b65 7720 6571  .        Skew eq
+0001add0: 7561 7469 6f6e 2066 6f72 6d75 6c61 7469  uation formulati
+0001ade0: 6f6e 732e 200d 0a20 2020 2077 6174 6578  ons. ..    watex
+0001adf0: 2e76 6965 772e 5450 6c6f 742e 706c 6f74  .view.TPlot.plot
+0001ae00: 536b 6577 3a20 0d0a 2020 2020 2020 2020  Skew: ..        
+0001ae10: 4769 7665 2061 2063 6f6e 7369 7374 656e  Give a consisten
+0001ae20: 7420 706c 6f74 2077 6865 7265 2075 7365  t plot where use
+0001ae30: 7220 6361 6e20 6375 7374 6f6d 697a 6520  r can customize 
+0001ae40: 7468 6520 706c 6f74 2075 7369 6e67 2074  the plot using t
+0001ae50: 6865 200d 0a20 2020 2020 2020 2070 6c6f  he ..        plo
+0001ae60: 7420 7061 7261 6d65 7465 7220 6f66 203a  t parameter of :
+0001ae70: 636c 6173 733a 6077 6174 6578 2e70 726f  class:`watex.pro
+0001ae80: 7065 7274 792e 4261 7365 506c 6f74 6020  perty.BasePlot` 
+0001ae90: 636c 6173 732e 0d0a 2020 2020 2020 2020  class...        
+0001aea0: 0d0a 2020 2020 5265 6665 7265 6e63 6573  ..    References
+0001aeb0: 200d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d   ..    ---------
+0001aec0: 2d2d 0d0a 2020 2020 2e2e 205b 315d 2042  --..    .. [1] B
+0001aed0: 6168 722c 204b 2e20 2831 3938 3829 2049  ahr, K. (1988) I
+0001aee0: 6e74 6572 7072 6574 6174 696f 6e20 6f66  nterpretation of
+0001aef0: 2074 6865 206d 6167 6e65 746f 7465 6c6c   the magnetotell
+0001af00: 7572 6963 2069 6d70 6564 616e 6365 200d  uric impedance .
+0001af10: 0a20 2020 2020 2020 2020 2020 7465 6e73  .           tens
+0001af20: 6f72 3a20 7265 6769 6f6e 616c 2069 6e64  or: regional ind
+0001af30: 7563 7469 6f6e 2033 3935 2061 6e64 206c  uction 395 and l
+0001af40: 6f63 616c 2074 656c 6c75 7269 6320 6469  ocal telluric di
+0001af50: 7374 6f72 7469 6f6e 2e20 4a2e 200d 0a20  stortion. J. .. 
+0001af60: 2020 2020 2020 2020 2020 4765 6f70 6879            Geophy
+0001af70: 732e 2052 6573 2e2c 2036 322c 2031 3139  s. Res., 62, 119
+0001af80: e280 9331 3237 2e0d 0a20 2020 202e 2e20  ...127...    .. 
+0001af90: 5b32 5d20 4261 6872 2c20 4b2e 2028 3139  [2] Bahr, K. (19
+0001afa0: 3931 2920 4765 6f6c 6f67 6963 616c 206e  91) Geological n
+0001afb0: 6f69 7365 2069 6e20 6d61 676e 6574 6f74  oise in magnetot
+0001afc0: 656c 6c75 7269 6320 6461 7461 3a20 0d0a  elluric data: ..
+0001afd0: 2020 2020 2020 2020 2020 2061 2063 6c61             a cla
+0001afe0: 7373 6966 6963 6174 696f 6e20 6f66 2064  ssification of d
+0001aff0: 6973 746f 7274 696f 6e20 7479 7065 732e  istortion types.
+0001b000: 2033 3937 2050 6879 732e 2045 6172 7468   397 Phys. Earth
+0001b010: 2050 6c61 6e65 742e 200d 0a20 2020 2020   Planet. ..     
+0001b020: 2020 2020 2020 496e 7465 722e 2c20 3636        Inter., 66
+0001b030: 2c20 3234 e280 9333 382e 0d0a 2020 2020  , 24...38...    
+0001b040: 2e2e 205b 335d 2042 6168 722c 204b 2e2c  .. [3] Bahr, K.,
+0001b050: 2031 3939 312e 2047 656f 6c6f 6769 6361   1991. Geologica
+0001b060: 6c20 6e6f 6973 6520 696e 206d 6167 6e65  l noise in magne
+0001b070: 746f 7465 6c6c 7572 6963 2064 6174 613a  totelluric data:
+0001b080: 2061 200d 0a20 2020 2020 2020 2020 2020   a ..           
+0001b090: 636c 6173 7369 6669 6361 7469 6f6e 206f  classification o
+0001b0a0: 6620 6469 7374 6f72 7469 6f6e 2074 7970  f distortion typ
+0001b0b0: 6573 2e20 5068 7973 6963 7320 6f66 2074  es. Physics of t
+0001b0c0: 6865 2045 6172 7468 2061 6e64 200d 0a20  he Earth and .. 
+0001b0d0: 2020 2020 2020 2020 2020 506c 616e 6574            Planet
+0001b0e0: 6172 7920 496e 7465 7269 6f72 7320 3636  ary Interiors 66
+0001b0f0: 2028 31e2 8093 3229 2c20 3234 e280 9333   (1...2), 24...3
+0001b100: 382e 2020 0d0a 2020 2020 4578 616d 706c  8.  ..    Exampl
+0001b110: 6573 200d 0a20 2020 202d 2d2d 2d2d 2d2d  es ..    -------
+0001b120: 2d2d 0d0a 2020 2020 3e3e 3e20 696d 706f  --..    >>> impo
+0001b130: 7274 2077 6174 6578 2061 7320 7778 200d  rt watex as wx .
+0001b140: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
+0001b150: 7465 782e 7574 696c 732e 706c 6f74 7574  tex.utils.plotut
+0001b160: 696c 7320 696d 706f 7274 2070 6c6f 745f  ils import plot_
+0001b170: 736b 6577 200d 0a20 2020 203e 3e3e 2065  skew ..    >>> e
+0001b180: 6469 5f73 6b20 3d20 7778 2e66 6574 6368  di_sk = wx.fetch
+0001b190: 5f64 6174 6120 2822 6564 6973 222c 2072  _data ("edis", r
+0001b1a0: 6574 7572 6e5f 6461 7461 203d 5472 7565  eturn_data =True
+0001b1b0: 202c 2073 616d 706c 6573 203d 2032 3020   , samples = 20 
+0001b1c0: 2920 0d0a 2020 2020 3e3e 3e20 706c 6f74  ) ..    >>> plot
+0001b1d0: 5f73 6b65 7720 2865 6469 5f73 6b29 200d  _skew (edi_sk) .
+0001b1e0: 0a20 2020 203e 3e3e 2070 6c6f 745f 736b  .    >>> plot_sk
+0001b1f0: 6577 2028 6564 695f 736b 2c20 7468 7265  ew (edi_sk, thre
+0001b200: 7368 6f6c 645f 6c69 6e65 3d20 5472 7565  shold_line= True
+0001b210: 2920 0d0a 2020 2020 0d0a 2020 2020 2222  ) ..    ..    ""
+0001b220: 220d 0a20 2020 2069 6620 7374 796c 6520  "..    if style 
+0001b230: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+0001b240: 2020 2020 2020 706c 742e 7374 796c 652e        plt.style.
+0001b250: 7573 6520 2873 7479 6c65 2029 0d0a 2020  use (style )..  
+0001b260: 2020 2020 2020 0d0a 2020 2020 7669 6577        ..    view
+0001b270: 203d 2076 6965 7720 6f72 2027 736b 6577   = view or 'skew
+0001b280: 270d 0a20 2020 200d 0a20 2020 2069 6620  '..    ..    if 
+0001b290: 2827 696e 7627 2020 696e 2073 7472 2028  ('inv'  in str (
+0001b2a0: 7669 6577 292e 6c6f 7765 7228 290d 0a20  view).lower().. 
+0001b2b0: 2020 2020 2020 206f 7220 2772 6f74 2720         or 'rot' 
+0001b2c0: 696e 2073 7472 2028 7669 6577 292e 6c6f  in str (view).lo
+0001b2d0: 7765 7228 290d 0a20 2020 2020 2020 206f  wer()..        o
+0001b2e0: 7220 276d 7527 2069 6e20 7374 7220 2876  r 'mu' in str (v
+0001b2f0: 6965 7729 2e6c 6f77 6572 2829 0d0a 2020  iew).lower()..  
+0001b300: 2020 2020 2020 2920 3a20 0d0a 2020 2020        ) : ..    
+0001b310: 2020 2020 7669 6577 203d 276d 7527 0d0a      view ='mu'..
+0001b320: 2020 2020 2020 2020 0d0a 2020 2020 6966          ..    if
+0001b330: 2027 7065 7269 6f64 2720 696e 2073 7472   'period' in str
+0001b340: 286d 6f64 6529 2e6c 6f77 6572 2829 3a20  (mode).lower(): 
+0001b350: 0d0a 2020 2020 2020 2020 6d6f 6465 203d  ..        mode =
+0001b360: 2770 6572 696f 6427 0d0a 2020 2020 2020  'period'..      
+0001b370: 2020 0d0a 2020 2020 6966 2073 7472 2874    ..    if str(t
+0001b380: 6872 6573 686f 6c64 5f6c 696e 6529 2e6c  hreshold_line).l
+0001b390: 6f77 6572 2829 3d3d 2774 7275 6527 3a20  ower()=='true': 
+0001b3a0: 0d0a 2020 2020 2020 2020 7468 7265 7368  ..        thresh
+0001b3b0: 6f6c 645f 6c69 6e65 203d 2073 7472 286d  old_line = str(m
+0001b3c0: 6574 686f 6429 2e6c 6f77 6572 2829 200d  ethod).lower() .
+0001b3d0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+0001b3e0: 2020 2069 6d70 6f72 7420 7761 7465 7820     import watex 
+0001b3f0: 6173 2077 7820 0d0a 2020 2020 706f 203d  as wx ..    po =
+0001b400: 2020 7778 2e45 4d50 726f 6365 7373 696e    wx.EMProcessin
+0001b410: 6728 292e 6669 7428 6564 695f 6f62 6a29  g().fit(edi_obj)
+0001b420: 0d0a 2020 2020 0d0a 2020 2020 2320 7265  ..    ..    # re
+0001b430: 6d6f 7665 2074 6865 206f 7574 6c69 6572  move the outlier
+0001b440: 7320 696e 2074 6865 2064 6174 610d 0a20  s in the data.. 
+0001b450: 2020 2023 2061 6e64 2066 696c 6c65 6420     # and filled 
+0001b460: 7769 7468 204e 614e 200d 0a20 2020 2073  with NaN ..    s
+0001b470: 6b65 772c 206d 7520 3d70 6f2e 736b 6577  kew, mu =po.skew
+0001b480: 286d 6574 686f 6420 3d20 6d65 7468 6f64  (method = method
+0001b490: 2c20 7375 7070 7265 7373 5f6f 7574 6c69  , suppress_outli
+0001b4a0: 6572 7320 3d20 5472 7565 2020 290d 0a20  ers = True  ).. 
+0001b4b0: 2020 2066 7265 7173 203d 2020 312f 2070     freqs =  1/ p
+0001b4c0: 6f2e 6672 6571 735f 2069 6620 6d6f 6465  o.freqs_ if mode
+0001b4d0: 203d 3d27 7065 7269 6f64 2720 656c 7365   =='period' else
+0001b4e0: 2070 6f2e 6672 6571 735f 200d 0a20 2020   po.freqs_ ..   
+0001b4f0: 2079 6d61 7420 3d20 736b 6577 2069 6620   ymat = skew if 
+0001b500: 7669 6577 203d 3d27 736b 6577 2720 656c  view =='skew' el
+0001b510: 7365 206d 7520 0d0a 2020 2020 0d0a 2020  se mu ..    ..  
+0001b520: 2020 6669 672c 2061 7820 3d20 706c 742e    fig, ax = plt.
+0001b530: 7375 6270 6c6f 7473 2831 2c31 2c20 6669  subplots(1,1, fi
+0001b540: 6773 697a 6520 3d66 6967 5f73 697a 6529  gsize =fig_size)
+0001b550: 0d0a 0d0a 2020 2020 232d 2d2d 6d61 6e61  ....    #---mana
+0001b560: 6765 2074 6872 6573 686f 6c64 206c 696e  ge threshold lin
+0001b570: 6520 2d2d 2d2d 2d2d 0d0a 2020 2020 7468  e ------..    th
+0001b580: 725f 636f 6465 203d 207b 2262 6168 7222  r_code = {"bahr"
+0001b590: 3a20 5b31 5d20 2c20 2273 7769 6674 223a  : [1] , "swift":
+0001b5a0: 5b20 325d 202c 2027 626f 7468 273a 5b31  [ 2] , 'both':[1
+0001b5b0: 2c20 325d 207d 0d0a 0d0a 2020 2020 2020  , 2] }....      
+0001b5c0: 2020 0d0a 2020 2020 6966 2074 6872 6573    ..    if thres
+0001b5d0: 686f 6c64 5f6c 696e 6520 6973 206e 6f74  hold_line is not
+0001b5e0: 204e 6f6e 653a 200d 0a20 2020 2020 2020   None: ..       
+0001b5f0: 2069 6620 7374 7228 7468 7265 7368 6f6c   if str(threshol
+0001b600: 645f 6c69 6e65 292e 6c6f 7765 7228 2920  d_line).lower() 
+0001b610: 696e 2028 222a 222c 2022 626f 7468 2229  in ("*", "both")
+0001b620: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0001b630: 7468 7265 7368 6f6c 645f 6c69 6e65 203d  threshold_line =
+0001b640: 2027 626f 7468 270d 0a20 2020 2020 2020   'both'..       
+0001b650: 2020 2020 200d 0a20 2020 2063 7420 3d20       ..    ct = 
+0001b660: 7468 725f 636f 6465 2e67 6574 2873 7472  thr_code.get(str
+0001b670: 2874 6872 6573 686f 6c64 5f6c 696e 6529  (threshold_line)
+0001b680: 2e6c 6f77 6572 2829 2c20 4e6f 6e65 2029  .lower(), None )
+0001b690: 200d 0a20 2020 200d 0a20 2020 2066 6f72   ..    ..    for
+0001b6a0: 2069 2069 6e20 7261 6e67 6520 2873 6b65   i in range (ske
+0001b6b0: 772e 7368 6170 655b 315d 293a 200d 0a20  w.shape[1]): .. 
+0001b6c0: 2020 2020 2020 2061 782e 7363 6174 7465         ax.scatte
+0001b6d0: 7220 2820 6672 6571 732c 2072 6573 6861  r ( freqs, resha
+0001b6e0: 7065 2028 796d 6174 5b3a 2c20 695d 292c  pe (ymat[:, i]),
+0001b6f0: 2a2a 6b77 7320 290d 0a20 2020 2020 2020  **kws )..       
+0001b700: 200d 0a20 2020 2069 6620 6374 3a20 0d0a   ..    if ct: ..
+0001b710: 2020 2020 2020 2020 666f 7220 6d20 696e          for m in
+0001b720: 2063 743a 200d 0a20 2020 2020 2020 2020   ct: ..         
+0001b730: 2020 2070 6c74 2e61 7868 6c69 6e65 2879     plt.axhline(y
+0001b740: 3d30 2e34 2069 6620 6d3d 3d32 2065 6c73  =0.4 if m==2 els
+0001b750: 6520 302e 3320 2c20 636f 6c6f 723d 226b  e 0.3 , color="k
+0001b760: 2220 6966 206d 3d3d 3120 656c 7365 2022  " if m==1 else "
+0001b770: 7222 2c0d 0a20 2020 2020 2020 2020 2020  r",..           
+0001b780: 2020 2020 2020 2020 2020 2020 206c 696e               lin
+0001b790: 6573 7479 6c65 3d22 2d22 2c0d 0a20 2020  estyle="-",..   
+0001b7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b7b0: 2020 2020 206c 6162 656c 3d66 2774 6872       label=f'thr
+0001b7c0: 6573 686f 6c64 3a20 245c 6d75 3d7b 302e  eshold: $\mu={0.
+0001b7d0: 3420 6966 206d 3d3d 3220 656c 7365 2030  4 if m==2 else 0
+0001b7e0: 2e33 7d24 270d 0a20 2020 2020 2020 2020  .3}$'..         
+0001b7f0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001b800: 0d0a 2020 2020 2020 2020 2020 2020 6178  ..            ax
+0001b810: 2e6c 6567 656e 6428 2920 0d0a 0d0a 2020  .legend() ....  
+0001b820: 2020 6178 2e73 6574 5f78 7363 616c 6528    ax.set_xscale(
+0001b830: 276c 6f67 2729 0d0a 2020 2020 0d0a 2020  'log')..    ..  
+0001b840: 2020 6178 2e73 6574 5f78 6c61 6265 6c28    ax.set_xlabel(
+0001b850: 2750 6572 696f 6420 2824 7324 2927 2069  'Period ($s$)' i
+0001b860: 6620 6d6f 6465 3d3d 2770 6572 696f 6427  f mode=='period'
+0001b870: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0001b880: 2020 2020 2065 6c73 6520 2746 7265 7175       else 'Frequ
+0001b890: 656e 6379 2028 2448 5f7a 2429 2729 0d0a  ency ($H_z$)')..
+0001b8a0: 2020 2020 6178 2e73 6574 5f79 6c61 6265      ax.set_ylabe
+0001b8b0: 6c28 6622 7b27 536b 6577 2720 6966 2076  l(f"{'Skew' if v
+0001b8c0: 6965 7720 3d3d 2773 6b65 7727 2065 6c73  iew =='skew' els
+0001b8d0: 6520 2752 6f74 2e49 6e76 6172 6961 6e74  e 'Rot.Invariant
+0001b8e0: 277d 2220 2b20 2228 245c 6d75 2429 2229  '}" + "($\mu$)")
+0001b8f0: 0d0a 0d0a 2020 2020 706c 742e 786c 696d  ....    plt.xlim
+0001b900: 2028 5b20 6672 6571 732e 6d69 6e28 2920   ([ freqs.min() 
+0001b910: 2c20 6672 6571 732e 6d61 7828 295d 290d  , freqs.max()]).
+0001b920: 0a20 2020 200d 0a20 2020 2023 706c 742e  .    ..    #plt.
+0001b930: 786c 696d 2829 200d 0a0d 0a20 2020 2069  xlim() ....    i
+0001b940: 6620 7361 7665 6669 6720 6973 206e 6f74  f savefig is not
+0001b950: 2020 4e6f 6e65 3a20 0d0a 2020 2020 2020    None: ..      
+0001b960: 2020 7361 7665 6669 6775 7265 2028 6669    savefigure (fi
+0001b970: 672c 2073 6176 6566 6967 2c20 6470 6920  g, savefig, dpi 
+0001b980: 3d20 3330 3029 0d0a 2020 2020 2020 2020  = 300)..        
+0001b990: 0d0a 2020 2020 706c 742e 636c 6f73 6520  ..    plt.close 
+0001b9a0: 2829 2069 6620 7361 7665 6669 6720 6973  () if savefig is
+0001b9b0: 206e 6f74 204e 6f6e 6520 656c 7365 2070   not None else p
+0001b9c0: 6c74 2e73 686f 7728 2920 0d0a 2020 2020  lt.show() ..    
+0001b9d0: 0d0a 2020 2020 7265 7475 726e 2061 7820  ..    return ax 
+0001b9e0: 0d0a 0d0a 6465 6620 5f66 6f72 6d61 745f  ....def _format_
+0001b9f0: 7469 636b 7320 2876 616c 7565 2c20 7469  ticks (value, ti
+0001ba00: 636b 5f6e 756d 6265 722c 2066 6d74 203d  ck_number, fmt =
+0001ba10: 2753 7b3a 3032 7d27 2c20 6e73 6b69 7020  'S{:02}', nskip 
+0001ba20: 3d37 2029 3a0d 0a20 2020 2022 2222 2046  =7 ):..    """ F
+0001ba30: 6f72 6d61 7420 7468 6963 6b20 7061 7261  ormat thick para
+0001ba40: 6d65 7465 7220 7769 7468 2027 4675 6e63  meter with 'Func
+0001ba50: 466f 726d 6174 7465 7228 6675 6e63 2927  Formatter(func)'
+0001ba60: 0d0a 2020 2020 7261 7468 6572 2074 6861  ..    rather tha
+0001ba70: 6e20 7573 696e 6720 6061 7869 2e78 6178  n using `axi.xax
+0001ba80: 6973 2e73 6574 5f6d 616a 6f72 5f6c 6f63  is.set_major_loc
+0001ba90: 6174 6f72 2028 706c 742e 4d61 784e 4c6f  ator (plt.MaxNLo
+0001baa0: 6361 746f 7228 3329 2960 0d0a 2020 2020  cator(3))`..    
+0001bab0: 6178 2e78 6178 6973 2e73 6574 5f6d 616a  ax.xaxis.set_maj
+0001bac0: 6f72 5f66 6f72 6d61 7474 6572 2028 706c  or_formatter (pl
+0001bad0: 742e 4675 6e63 466f 726d 6174 7465 7228  t.FuncFormatter(
+0001bae0: 666f 726d 6174 5f74 6869 636b 7329 290d  format_thicks)).
+0001baf0: 0a20 2020 200d 0a20 2020 203a 7061 7261  .    ..    :para
+0001bb00: 6d20 7661 6c75 653a 2074 6963 6b20 7261  m value: tick ra
+0001bb10: 6e67 6520 7661 6c75 6573 2066 6f72 2066  nge values for f
+0001bb20: 6f72 6d61 7474 696e 6720 0d0a 2020 2020  ormatting ..    
+0001bb30: 3a70 6172 616d 2074 6963 6b5f 6e75 6d62  :param tick_numb
+0001bb40: 6572 3a20 6e75 6d62 6572 206f 6620 7469  er: number of ti
+0001bb50: 636b 7320 746f 2066 6f72 6d61 7420 0d0a  cks to format ..
+0001bb60: 2020 2020 3a70 6172 616d 2066 6d74 3a20      :param fmt: 
+0001bb70: 7374 722c 2064 6566 6175 6c74 3d27 537b  str, default='S{
+0001bb80: 3a30 327d 272c 206b 696e 6420 6f66 2074  :02}', kind of t
+0001bb90: 6963 6b20 666f 726d 6174 6167 6520 0d0a  ick formatage ..
+0001bba0: 2020 2020 3a70 6172 616d 206e 736b 6970      :param nskip
+0001bbb0: 3a20 696e 742c 2064 6566 6175 6c74 203d  : int, default =
+0001bbc0: 372c 206e 756d 6265 7220 6f66 2074 6963  7, number of tic
+0001bbd0: 6b20 746f 2073 6b69 7020 0d0a 2020 2020  k to skip ..    
+0001bbe0: 0d0a 2020 2020 2222 220d 0a20 2020 2069  ..    """..    i
+0001bbf0: 6620 7661 6c75 6520 2520 6e73 6b69 703d  f value % nskip=
+0001bc00: 3d30 3a20 0d0a 2020 2020 2020 2020 7265  =0: ..        re
+0001bc10: 7475 726e 2066 6d74 2e66 6f72 6d61 7428  turn fmt.format(
+0001bc20: 696e 7428 7661 6c75 6529 2b20 3129 0d0a  int(value)+ 1)..
+0001bc30: 2020 2020 656c 7365 3a20 4e6f 6e65 200d      else: None .
+0001bc40: 0a20 2020 200d 0a23 5858 5820 4f50 5449  .    ..#XXX OPTI
+0001bc50: 4d49 5a45 200d 0a64 6566 2070 6c6f 745f  MIZE ..def plot_
+0001bc60: 636f 6e66 6964 656e 6365 2028 0d0a 2020  confidence (..  
+0001bc70: 2020 6461 7461 203d 204e 6f6e 652c 200d    data = None, .
+0001bc80: 0a20 2020 202a 2c20 200d 0a20 2020 2079  .    *,  ..    y
+0001bc90: 3d4e 6f6e 652c 200d 0a20 2020 2078 3d4e  =None, ..    x=N
+0001bca0: 6f6e 652c 200d 0a20 2020 2063 6920 3d2e  one, ..    ci =.
+0001bcb0: 3935 202c 2020 0d0a 2020 2020 6b69 6e64  95 ,  ..    kind
+0001bcc0: 203d 276c 696e 6527 2c20 0d0a 2020 2020   ='line', ..    
+0001bcd0: 625f 7361 6d70 6c65 7320 3d20 3130 3030  b_samples = 1000
+0001bce0: 2c20 0d0a 2020 2020 2a2a 736e 735f 6b77  , ..    **sns_kw
+0001bcf0: 730d 0a20 2020 2029 3a20 0d0a 2020 2020  s..    ): ..    
+0001bd00: 2222 2220 506c 6f74 2063 6f6e 6669 6465  """ Plot confide
+0001bd10: 6e63 6520 6461 7461 200d 0a20 2020 200d  nce data ..    .
+0001bd20: 0a20 2020 2043 6f6e 6669 6465 6e63 6520  .    Confidence 
+0001bd30: 496e 7465 7276 616c 2028 4349 2920 2069  Interval (CI)  i
+0001bd40: 7320 6120 7479 7065 206f 6620 6573 7469  s a type of esti
+0001bd50: 6d61 7465 2063 6f6d 7075 7465 6420 6672  mate computed fr
+0001bd60: 6f6d 2074 6865 2073 7461 7469 7374 6963  om the statistic
+0001bd70: 7320 0d0a 2020 2020 6f66 2074 6865 206f  s ..    of the o
+0001bd80: 6273 6572 7665 6420 6461 7461 2077 6869  bserved data whi
+0001bd90: 6368 2067 6976 6573 2061 2072 616e 6765  ch gives a range
+0001bda0: 206f 6620 7661 6c75 6573 2074 6861 74e2   of values that.
+0001bdb0: 8099 7320 6c69 6b65 6c79 2074 6f20 0d0a  ..s likely to ..
+0001bdc0: 2020 2020 636f 6e74 6169 6e20 6120 706f      contain a po
+0001bdd0: 7075 6c61 7469 6f6e 2070 6172 616d 6574  pulation paramet
+0001bde0: 6572 2077 6974 6820 6120 7061 7274 6963  er with a partic
+0001bdf0: 756c 6172 206c 6576 656c 206f 6620 636f  ular level of co
+0001be00: 6e66 6964 656e 6365 2e0d 0a20 2020 2043  nfidence...    C
+0001be10: 4920 6173 2061 2063 6f6e 6365 7074 2077  I as a concept w
+0001be20: 6173 2070 7574 2066 6f72 7468 2062 7920  as put forth by 
+0001be30: 4a65 727a 7920 4e65 796d 616e 2069 6e20  Jerzy Neyman in 
+0001be40: 6120 7061 7065 7220 7075 626c 6973 6865  a paper publishe
+0001be50: 6420 0d0a 2020 2020 696e 2031 3933 372e  d ..    in 1937.
+0001be60: 2054 6865 7265 2061 7265 2076 6172 696f   There are vario
+0001be70: 7573 2074 7970 6573 206f 6620 7468 6520  us types of the 
+0001be80: 636f 6e66 6964 656e 6365 2069 6e74 6572  confidence inter
+0001be90: 7661 6c2c 2073 6f6d 6520 6f66 200d 0a20  val, some of .. 
+0001bea0: 2020 2074 6865 206d 6f73 7420 636f 6d6d     the most comm
+0001beb0: 6f6e 6c79 2075 7365 6420 6f6e 6573 2061  only used ones a
+0001bec0: 7265 3a20 4349 2066 6f72 206d 6561 6e2c  re: CI for mean,
+0001bed0: 2043 4920 666f 7220 7468 6520 6d65 6469   CI for the medi
+0001bee0: 616e 2c20 4349 2066 6f72 200d 0a20 2020  an, CI for ..   
+0001bef0: 2074 6865 2064 6966 6665 7265 6e63 6520   the difference 
+0001bf00: 6265 7477 6565 6e20 6d65 616e 732c 2043  between means, C
+0001bf10: 4920 666f 7220 6120 7072 6f70 6f72 7469  I for a proporti
+0001bf20: 6f6e 2061 6e64 2043 4920 666f 7220 7468  on and CI for th
+0001bf30: 6520 6469 6666 6572 656e 6365 200d 0a20  e difference .. 
+0001bf40: 2020 2069 6e20 7072 6f70 6f72 7469 6f6e     in proportion
+0001bf50: 732e 0d0a 2020 2020 0d0a 2020 2020 5061  s...    ..    Pa
+0001bf60: 7261 6d65 7465 7273 200d 0a20 2020 202d  rameters ..    -
+0001bf70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
+0001bf80: 2064 6174 613a 2070 616e 6461 732e 4461   data: pandas.Da
+0001bf90: 7461 4672 616d 652c 206e 756d 7079 2e6e  taFrame, numpy.n
+0001bfa0: 6461 7272 6179 2c20 6d61 7070 696e 672c  darray, mapping,
+0001bfb0: 206f 7220 7365 7175 656e 6365 0d0a 2020   or sequence..  
+0001bfc0: 2020 2020 2049 6e70 7574 2064 6174 6120       Input data 
+0001bfd0: 7374 7275 6374 7572 652e 2045 6974 6865  structure. Eithe
+0001bfe0: 7220 6120 6c6f 6e67 2d66 6f72 6d20 636f  r a long-form co
+0001bff0: 6c6c 6563 7469 6f6e 206f 6620 7665 6374  llection of vect
+0001c000: 6f72 7320 0d0a 2020 2020 2020 2074 6861  ors ..       tha
+0001c010: 7420 6361 6e20 6265 2061 7373 6967 6e65  t can be assigne
+0001c020: 6420 746f 206e 616d 6564 2076 6172 6961  d to named varia
+0001c030: 626c 6573 206f 7220 6120 7769 6465 2d66  bles or a wide-f
+0001c040: 6f72 6d20 6461 7461 7365 7420 0d0a 2020  orm dataset ..  
+0001c050: 2020 2020 2074 6861 7420 7769 6c6c 2062       that will b
+0001c060: 6520 696e 7465 726e 616c 6c79 2072 6573  e internally res
+0001c070: 6861 7065 642e 0d0a 0d0a 2020 2020 782c  haped.....    x,
+0001c080: 2079 3a20 7665 6374 6f72 7320 6f72 206b   y: vectors or k
+0001c090: 6579 7320 696e 2064 6174 610d 0a20 2020  eys in data..   
+0001c0a0: 2020 2020 5661 7269 6162 6c65 7320 7468      Variables th
+0001c0b0: 6174 2073 7065 6369 6679 2070 6f73 6974  at specify posit
+0001c0c0: 696f 6e73 206f 6e20 7468 6520 7820 616e  ions on the x an
+0001c0d0: 6420 7920 6178 6573 2e0d 0a20 2020 2020  d y axes...     
+0001c0e0: 2020 0d0a 2020 2020 6369 3a20 666c 6f61    ..    ci: floa
+0001c0f0: 742c 2064 6566 6175 6c74 3d2e 3935 200d  t, default=.95 .
+0001c100: 0a20 2020 2020 2020 436f 6e66 6964 656e  .       Confiden
+0001c110: 6365 2076 616c 7565 2e20 0d0a 2020 2020  ce value. ..    
+0001c120: 2020 200d 0a20 2020 206b 696e 643a 2073     ..    kind: s
+0001c130: 7472 2c20 6465 6661 756c 743d 276c 696e  tr, default='lin
+0001c140: 6527 200d 0a20 2020 2020 2020 6b69 6e64  e' ..       kind
+0001c150: 206f 6620 636f 6e66 6964 656e 6365 2069   of confidence i
+0001c160: 6e74 6572 7676 616c 2070 6c6f 742e 200d  ntervval plot. .
+0001c170: 0a20 2020 2020 200d 0a20 2020 2062 5f73  .      ..    b_s
+0001c180: 616d 706c 6573 3a20 696e 742c 2064 6566  amples: int, def
+0001c190: 6175 6c74 3d31 3030 300d 0a20 2020 2020  ault=1000..     
+0001c1a0: 2020 204e 756d 6265 7220 6f66 2062 6f6f     Number of boo
+0001c1b0: 7473 7472 6170 7320 746f 2075 7365 2066  tstraps to use f
+0001c1c0: 6f72 2063 6f6d 7075 7469 6e67 2074 6865  or computing the
+0001c1d0: 2063 6f6e 6669 6465 6e63 6520 696e 7465   confidence inte
+0001c1e0: 7276 616c 2e0d 0a20 2020 2020 2020 200d  rval...        .
+0001c1f0: 0a20 2020 2073 6e73 5f6b 7773 3a20 6469  .    sns_kws: di
+0001c200: 6374 2c20 0d0a 2020 2020 2020 204b 6579  ct, ..       Key
+0001c210: 776f 7264 7320 6172 6775 6d65 6e74 7320  words arguments 
+0001c220: 7061 7373 6564 2074 6f20 7468 6520 6073  passed to the `s
+0001c230: 6e73 2e6c 696e 6570 6c6f 7460 206f 7220  ns.lineplot` or 
+0001c240: 6073 6e73 2e72 6567 706c 6f74 600d 0a20  `sns.regplot`.. 
+0001c250: 2020 2020 2020 0d0a 2020 2020 5265 7475        ..    Retu
+0001c260: 726e 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  rns ..    ------
+0001c270: 2d2d 2d2d 0d0a 2020 2020 6178 3a20 6d61  ----..    ax: ma
+0001c280: 7470 6c6f 746c 6962 2e61 7865 732e 4178  tplotlib.axes.Ax
+0001c290: 6573 0d0a 2020 2020 2020 2054 6865 206d  es..       The m
+0001c2a0: 6174 706c 6f74 6c69 6220 6178 6573 2063  atplotlib axes c
+0001c2b0: 6f6e 7461 696e 696e 6720 7468 6520 706c  ontaining the pl
+0001c2c0: 6f74 2e0d 0a20 2020 2020 2020 0d0a 2020  ot...       ..  
+0001c2d0: 2020 2222 2220 2020 0d0a 2020 2020 2379    """   ..    #y
+0001c2e0: 203d 206e 702e 6172 7261 7920 2879 2920   = np.array (y) 
+0001c2f0: 0d0a 2020 2020 2378 3d20 7820 6f72 2028  ..    #x= x or (
+0001c300: 206e 702e 6172 616e 6765 2028 6c65 6e28   np.arange (len(
+0001c310: 7929 2920 6966 200d 0a20 2020 2061 783d  y)) if ..    ax=
+0001c320: 4e6f 6e65 200d 0a20 2020 2069 6620 276c  None ..    if 'l
+0001c330: 696e 2720 696e 2073 7472 286b 696e 6429  in' in str(kind)
+0001c340: 2e6c 6f77 6572 2829 3a20 0d0a 2020 2020  .lower(): ..    
+0001c350: 2020 2020 6178 203d 2073 6e73 2e6c 696e      ax = sns.lin
+0001c360: 6570 6c6f 7428 6461 7461 3d20 6461 7461  eplot(data= data
+0001c370: 2c20 783d 782c 2079 3d79 2c20 6369 3d63  , x=x, y=y, ci=c
+0001c380: 692c 202a 2a73 6e73 5f6b 7773 290d 0a20  i, **sns_kws).. 
+0001c390: 2020 2065 6c69 6620 2772 6567 2720 696e     elif 'reg' in
+0001c3a0: 2020 7374 7228 6b69 6e64 292e 6c6f 7765    str(kind).lowe
+0001c3b0: 7228 293a 200d 0a20 2020 2020 2020 2061  r(): ..        a
+0001c3c0: 7820 3d20 736e 732e 7265 6770 6c6f 7428  x = sns.regplot(
+0001c3d0: 6461 7461 203d 2064 6174 612c 2078 3d78  data = data, x=x
+0001c3e0: 2c20 793d 792c 2063 693d 6369 2c20 2a2a  , y=y, ci=ci, **
+0001c3f0: 736e 735f 6b77 7320 2920 0d0a 2020 2020  sns_kws ) ..    
+0001c400: 656c 7365 3a20 0d0a 2020 2020 2020 2020  else: ..        
+0001c410: 6966 206e 6f74 2079 3a20 0d0a 2020 2020  if not y: ..    
+0001c420: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001c430: 6c75 6545 7272 6f72 2822 7920 7368 6f75  lueError("y shou
+0001c440: 6c64 206e 6f74 2062 6520 4e6f 6e65 2077  ld not be None w
+0001c450: 6865 6e20 7573 696e 6720 7468 6520 626f  hen using the bo
+0001c460: 6f73 7472 6170 7069 6e67 220d 0a20 2020  ostrapping"..   
+0001c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c480: 2020 2020 2020 2020 2020 2220 666f 7220            " for 
+0001c490: 706c 6f74 7469 6e67 2074 6865 2063 6f6e  plotting the con
+0001c4a0: 6669 6465 6e63 6520 696e 7465 7276 616c  fidence interval
+0001c4b0: 2e22 290d 0a20 2020 2020 2020 2062 5f73  .")..        b_s
+0001c4c0: 616d 706c 6573 203d 205f 6173 7365 7274  amples = _assert
+0001c4d0: 5f61 6c6c 5f74 7970 6573 280d 0a20 2020  _all_types(..   
+0001c4e0: 2020 2020 2020 2020 2062 5f73 616d 706c           b_sampl
+0001c4f0: 6573 2c20 696e 742c 2066 6c6f 6174 2c20  es, int, float, 
+0001c500: 6f62 6a6e 616d 653d 2242 6f6f 7473 7472  objname="Bootstr
+0001c510: 6170 2073 616d 706c 6573 2060 625f 7361  ap samples `b_sa
+0001c520: 6d70 6c65 7360 2229 0d0a 2020 2020 2020  mples`")..      
+0001c530: 2020 0d0a 2020 2020 2020 2020 6672 6f6d    ..        from
+0001c540: 2073 6b6c 6561 726e 2e6d 6574 7269 6373   sklearn.metrics
+0001c550: 2069 6d70 6f72 7420 7265 7361 6d70 6c65   import resample
+0001c560: 200d 0a20 2020 2020 2020 2023 2063 6f6e   ..        # con
+0001c570: 6669 6775 7265 2062 6f6f 7473 7472 6170  figure bootstrap
+0001c580: 0d0a 2020 2020 2020 2020 6e5f 6974 6572  ..        n_iter
+0001c590: 6174 696f 6e73 203d 2031 3030 3020 2320  ations = 1000 # 
+0001c5a0: 6865 7265 206b 3d6e 6f2e 206f 6620 626f  here k=no. of bo
+0001c5b0: 6f74 7374 7261 7070 6564 2073 616d 706c  otstrapped sampl
+0001c5c0: 6573 0d0a 2020 2020 2020 2020 6e5f 7369  es..        n_si
+0001c5d0: 7a65 203d 2069 6e74 286c 656e 2879 2929  ze = int(len(y))
+0001c5e0: 0d0a 2020 2020 2020 2020 2020 0d0a 2020  ..          ..  
+0001c5f0: 2020 2020 2020 2320 7275 6e20 626f 6f74        # run boot
+0001c600: 7374 7261 700d 0a20 2020 2020 2020 206d  strap..        m
+0001c610: 6564 6961 6e73 203d 206c 6973 7428 290d  edians = list().
+0001c620: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+0001c630: 6e20 7261 6e67 6528 6e5f 6974 6572 6174  n range(n_iterat
+0001c640: 696f 6e73 293a 0d0a 2020 2020 2020 2020  ions):..        
+0001c650: 2020 2073 203d 2072 6573 616d 706c 6528     s = resample(
+0001c660: 792c 206e 5f73 616d 706c 6573 3d6e 5f73  y, n_samples=n_s
+0001c670: 697a 6529 3b0d 0a20 2020 2020 2020 2020  ize);..         
+0001c680: 2020 6d20 3d20 6e70 2e6d 6564 6961 6e28    m = np.median(
+0001c690: 7329 3b0d 0a20 2020 2020 2020 2020 2020  s);..           
+0001c6a0: 6d65 6469 616e 732e 6170 7065 6e64 286d  medians.append(m
+0001c6b0: 290d 0a20 2020 2020 2020 2020 200d 0a20  )..          .. 
+0001c6c0: 2020 2020 2020 2023 2070 6c6f 7420 7363         # plot sc
+0001c6d0: 6f72 6573 0d0a 2020 2020 2020 2020 706c  ores..        pl
+0001c6e0: 742e 6869 7374 286d 6564 6961 6e73 290d  t.hist(medians).
+0001c6f0: 0a20 2020 2020 2020 2070 6c74 2e73 686f  .        plt.sho
+0001c700: 7728 290d 0a20 2020 2020 2020 2020 200d  w()..          .
+0001c710: 0a20 2020 2020 2020 2023 2063 6f6e 6669  .        # confi
+0001c720: 6465 6e63 6520 696e 7465 7276 616c 730d  dence intervals.
+0001c730: 0a20 2020 2020 2020 2070 203d 2028 2831  .        p = ((1
+0001c740: 2e30 2d63 6929 2f32 2e30 2920 2a20 3130  .0-ci)/2.0) * 10
+0001c750: 300d 0a20 2020 2020 2020 206c 6f77 6572  0..        lower
+0001c760: 203d 2020 6e70 2e70 6572 6365 6e74 696c   =  np.percentil
+0001c770: 6528 6d65 6469 616e 732c 2070 290d 0a20  e(medians, p).. 
+0001c780: 2020 2020 2020 2070 203d 2028 6369 2b28         p = (ci+(
+0001c790: 2831 2e30 2d63 6929 2f32 2e30 2929 202a  (1.0-ci)/2.0)) *
+0001c7a0: 2031 3030 0d0a 2020 2020 2020 2020 7570   100..        up
+0001c7b0: 7065 7220 3d20 206e 702e 7065 7263 656e  per =  np.percen
+0001c7c0: 7469 6c65 286d 6564 6961 6e73 2c20 7029  tile(medians, p)
+0001c7d0: 0d0a 2020 0d0a 2020 2020 2020 2020 7072  ..  ..        pr
+0001c7e0: 696e 7428 6622 5c6e 7b63 692a 3130 307d  int(f"\n{ci*100}
+0001c7f0: 2063 6f6e 6669 6465 6e63 6520 696e 7465   confidence inte
+0001c800: 7276 616c 207b 6c6f 7765 727d 2061 6e64  rval {lower} and
+0001c810: 207b 7570 7065 727d 2229 0d0a 2020 2020   {upper}")..    
+0001c820: 0d0a 2020 2020 7265 7475 726e 2061 7820  ..    return ax 
+0001c830: 0d0a 0d0a 6465 6620 706c 6f74 5f63 6f6e  ....def plot_con
+0001c840: 6669 6465 6e63 655f 656c 6c69 7073 6520  fidence_ellipse 
+0001c850: 2878 2c20 7920 293a 200d 0a20 2020 2022  (x, y ): ..    "
+0001c860: 2222 2050 6c6f 7420 6120 636f 6e66 6964  "" Plot a confid
 0001c870: 656e 6365 2065 6c6c 6970 7365 206f 6620  ence ellipse of 
-0001c880: 7468 6520 636f 7661 7269 616e 6365 206f  the covariance o
-0001c890: 6620 0d0a 2020 2020 7468 6520 6769 7665  f ..    the give
-0001c8a0: 6e20 6172 7261 792d 6c69 6b65 2076 6172  n array-like var
-0001c8b0: 6961 626c 6573 2078 2061 6e64 2079 2e20  iables x and y. 
-0001c8c0: 5468 6520 656c 6c69 7073 6520 6973 2070  The ellipse is p
-0001c8d0: 6c6f 7474 6564 200d 0a20 2020 2069 6e74  lotted ..    int
-0001c8e0: 6f20 7468 6520 6769 7665 6e20 6178 6573  o the given axes
-0001c8f0: 2d6f 626a 6563 7420 6178 2e0d 0a20 2020  -object ax...   
-0001c900: 200d 0a20 2020 2054 6865 2061 7070 726f   ..    The appro
-0001c910: 6163 6820 7468 6174 2069 7320 7573 6564  ach that is used
-0001c920: 2074 6f20 6f62 7461 696e 2074 6865 2063   to obtain the c
-0001c930: 6f72 7265 6374 2067 656f 6d65 7472 7920  orrect geometry 
-0001c940: 0d0a 2020 2020 6973 2065 7870 6c61 696e  ..    is explain
-0001c950: 6564 2061 6e64 2070 726f 7665 6420 6865  ed and proved he
-0001c960: 7265 3a0d 0a20 2020 2020 2068 7474 7073  re:..      https
-0001c970: 3a2f 2f63 6172 7374 656e 7363 6865 6c70  ://carstenschelp
-0001c980: 2e67 6974 6875 622e 696f 2f32 3031 382f  .github.io/2018/
-0001c990: 3039 2f31 342f 506c 6f74 5f43 6f6e 6669  09/14/Plot_Confi
-0001c9a0: 6465 6e63 655f 456c 6c69 7073 655f 3030  dence_Ellipse_00
-0001c9b0: 312e 6874 6d6c 0d0a 2020 2020 2020 0d0a  1.html..      ..
-0001c9c0: 2020 2020 5468 6520 6d65 7468 6f64 2061      The method a
-0001c9d0: 766f 6964 7320 7468 6520 7573 6520 6f66  voids the use of
-0001c9e0: 2061 6e20 6974 6572 6174 6976 6520 6569   an iterative ei
-0001c9f0: 6765 6e20 6465 636f 6d70 6f73 6974 696f  gen decompositio
-0001ca00: 6e20 0d0a 2020 2020 616c 676f 7269 7468  n ..    algorith
-0001ca10: 6d20 616e 6420 6d61 6b65 7320 7573 6520  m and makes use 
-0001ca20: 6f66 2074 6865 2066 6163 7420 7468 6174  of the fact that
-0001ca30: 2061 206e 6f72 6d61 6c69 7a65 6420 636f   a normalized co
-0001ca40: 7661 7269 616e 6365 200d 0a20 2020 206d  variance ..    m
-0001ca50: 6174 7269 7820 2863 6f6d 706f 7365 6420  atrix (composed 
-0001ca60: 6f66 2070 6561 7273 6f6e 2063 6f72 7265  of pearson corre
-0001ca70: 6c61 7469 6f6e 2063 6f65 6666 6963 6965  lation coefficie
-0001ca80: 6e74 7320 616e 6420 6f6e 6573 2920 6973  nts and ones) is
-0001ca90: 200d 0a20 2020 2070 6172 7469 6375 6c61   ..    particula
-0001caa0: 726c 7920 6561 7379 2074 6f20 6861 6e64  rly easy to hand
-0001cab0: 6c65 2e0d 0a20 2020 200d 0a20 2020 2022  le...    ..    "
-0001cac0: 2222 0d0a 2020 2020 6669 672c 2061 785f  ""..    fig, ax_
-0001cad0: 6e73 7464 203d 2070 6c74 2e73 7562 706c  nstd = plt.subpl
-0001cae0: 6f74 7328 6669 6773 697a 653d 2836 2c20  ots(figsize=(6, 
-0001caf0: 3629 290d 0a20 2020 2023 2064 6570 656e  6))..    # depen
-0001cb00: 6465 6e63 795f 6e73 7464 203d 205b 5b30  dency_nstd = [[0
-0001cb10: 2e38 2c20 302e 3735 5d2c 0d0a 2020 2020  .8, 0.75],..    
-0001cb20: 2320 2020 2020 2020 2020 2020 2020 2020  #               
-0001cb30: 2020 2020 205b 2d30 2e32 2c20 302e 3335       [-0.2, 0.35
-0001cb40: 5d5d 0d0a 2020 2020 6d75 203d 2030 2c20  ]]..    mu = 0, 
-0001cb50: 300d 0a20 2020 2023 2073 6361 6c65 203d  0..    # scale =
-0001cb60: 2038 2c20 350d 0a20 2020 2061 785f 6e73   8, 5..    ax_ns
-0001cb70: 7464 2e61 7876 6c69 6e65 2863 3d27 6772  td.axvline(c='gr
-0001cb80: 6579 272c 206c 773d 3129 0d0a 2020 2020  ey', lw=1)..    
-0001cb90: 6178 5f6e 7374 642e 6178 686c 696e 6528  ax_nstd.axhline(
-0001cba0: 633d 2767 7265 7927 2c20 6c77 3d31 290d  c='grey', lw=1).
-0001cbb0: 0a20 2020 200d 0a20 2020 2023 782c 2079  .    ..    #x, y
-0001cbc0: 203d 2067 6574 5f63 6f72 7265 6c61 7465   = get_correlate
-0001cbd0: 645f 6461 7461 7365 7428 3530 302c 2064  d_dataset(500, d
-0001cbe0: 6570 656e 6465 6e63 795f 6e73 7464 2c20  ependency_nstd, 
-0001cbf0: 6d75 2c20 7363 616c 6529 0d0a 2020 2020  mu, scale)..    
-0001cc00: 6178 5f6e 7374 642e 7363 6174 7465 7228  ax_nstd.scatter(
-0001cc10: 782c 2079 2c20 733d 302e 3529 0d0a 2020  x, y, s=0.5)..  
-0001cc20: 2020 0d0a 2020 2020 636f 6e66 6964 656e    ..    confiden
-0001cc30: 6365 5f65 6c6c 6970 7365 2878 2c20 792c  ce_ellipse(x, y,
-0001cc40: 2061 785f 6e73 7464 2c20 6e5f 7374 643d   ax_nstd, n_std=
-0001cc50: 312c 0d0a 2020 2020 2020 2020 2020 2020  1,..            
-0001cc60: 2020 2020 2020 2020 2020 206c 6162 656c             label
-0001cc70: 3d72 2724 315c 7369 676d 6124 272c 2065  =r'$1\sigma$', e
-0001cc80: 6467 6563 6f6c 6f72 3d27 6669 7265 6272  dgecolor='firebr
-0001cc90: 6963 6b27 290d 0a20 2020 2063 6f6e 6669  ick')..    confi
-0001cca0: 6465 6e63 655f 656c 6c69 7073 6528 782c  dence_ellipse(x,
-0001ccb0: 2079 2c20 6178 5f6e 7374 642c 206e 5f73   y, ax_nstd, n_s
-0001ccc0: 7464 3d32 2c0d 0a20 2020 2020 2020 2020  td=2,..         
-0001ccd0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
-0001cce0: 6265 6c3d 7227 2432 5c73 6967 6d61 2427  bel=r'$2\sigma$'
-0001ccf0: 2c20 6564 6765 636f 6c6f 723d 2766 7563  , edgecolor='fuc
-0001cd00: 6873 6961 272c 0d0a 2020 2020 2020 2020  hsia',..        
-0001cd10: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0001cd20: 696e 6573 7479 6c65 3d27 2d2d 2729 0d0a  inestyle='--')..
-0001cd30: 2020 2020 636f 6e66 6964 656e 6365 5f65      confidence_e
-0001cd40: 6c6c 6970 7365 2878 2c20 792c 2061 785f  llipse(x, y, ax_
-0001cd50: 6e73 7464 2c20 6e5f 7374 643d 332c 0d0a  nstd, n_std=3,..
+0001c880: 6120 7477 6f2d 6469 6d65 6e73 696f 6e61  a two-dimensiona
+0001c890: 6c20 6461 7461 7365 7420 0d0a 2020 2020  l dataset ..    
+0001c8a0: 0d0a 2020 2020 5468 6973 2066 756e 6374  ..    This funct
+0001c8b0: 696f 6e20 706c 6f74 7320 7468 6520 636f  ion plots the co
+0001c8c0: 6e66 6964 656e 6365 2065 6c6c 6970 7365  nfidence ellipse
+0001c8d0: 206f 6620 7468 6520 636f 7661 7269 616e   of the covarian
+0001c8e0: 6365 206f 6620 0d0a 2020 2020 7468 6520  ce of ..    the 
+0001c8f0: 6769 7665 6e20 6172 7261 792d 6c69 6b65  given array-like
+0001c900: 2076 6172 6961 626c 6573 2078 2061 6e64   variables x and
+0001c910: 2079 2e20 5468 6520 656c 6c69 7073 6520   y. The ellipse 
+0001c920: 6973 2070 6c6f 7474 6564 200d 0a20 2020  is plotted ..   
+0001c930: 2069 6e74 6f20 7468 6520 6769 7665 6e20   into the given 
+0001c940: 6178 6573 2d6f 626a 6563 7420 6178 2e0d  axes-object ax..
+0001c950: 0a20 2020 200d 0a20 2020 2054 6865 2061  .    ..    The a
+0001c960: 7070 726f 6163 6820 7468 6174 2069 7320  pproach that is 
+0001c970: 7573 6564 2074 6f20 6f62 7461 696e 2074  used to obtain t
+0001c980: 6865 2063 6f72 7265 6374 2067 656f 6d65  he correct geome
+0001c990: 7472 7920 0d0a 2020 2020 6973 2065 7870  try ..    is exp
+0001c9a0: 6c61 696e 6564 2061 6e64 2070 726f 7665  lained and prove
+0001c9b0: 6420 6865 7265 3a0d 0a20 2020 2020 2068  d here:..      h
+0001c9c0: 7474 7073 3a2f 2f63 6172 7374 656e 7363  ttps://carstensc
+0001c9d0: 6865 6c70 2e67 6974 6875 622e 696f 2f32  help.github.io/2
+0001c9e0: 3031 382f 3039 2f31 342f 506c 6f74 5f43  018/09/14/Plot_C
+0001c9f0: 6f6e 6669 6465 6e63 655f 456c 6c69 7073  onfidence_Ellips
+0001ca00: 655f 3030 312e 6874 6d6c 0d0a 2020 2020  e_001.html..    
+0001ca10: 2020 0d0a 2020 2020 5468 6520 6d65 7468    ..    The meth
+0001ca20: 6f64 2061 766f 6964 7320 7468 6520 7573  od avoids the us
+0001ca30: 6520 6f66 2061 6e20 6974 6572 6174 6976  e of an iterativ
+0001ca40: 6520 6569 6765 6e20 6465 636f 6d70 6f73  e eigen decompos
+0001ca50: 6974 696f 6e20 0d0a 2020 2020 616c 676f  ition ..    algo
+0001ca60: 7269 7468 6d20 616e 6420 6d61 6b65 7320  rithm and makes 
+0001ca70: 7573 6520 6f66 2074 6865 2066 6163 7420  use of the fact 
+0001ca80: 7468 6174 2061 206e 6f72 6d61 6c69 7a65  that a normalize
+0001ca90: 6420 636f 7661 7269 616e 6365 200d 0a20  d covariance .. 
+0001caa0: 2020 206d 6174 7269 7820 2863 6f6d 706f     matrix (compo
+0001cab0: 7365 6420 6f66 2070 6561 7273 6f6e 2063  sed of pearson c
+0001cac0: 6f72 7265 6c61 7469 6f6e 2063 6f65 6666  orrelation coeff
+0001cad0: 6963 6965 6e74 7320 616e 6420 6f6e 6573  icients and ones
+0001cae0: 2920 6973 200d 0a20 2020 2070 6172 7469  ) is ..    parti
+0001caf0: 6375 6c61 726c 7920 6561 7379 2074 6f20  cularly easy to 
+0001cb00: 6861 6e64 6c65 2e0d 0a20 2020 200d 0a20  handle...    .. 
+0001cb10: 2020 2022 2222 0d0a 2020 2020 6669 672c     """..    fig,
+0001cb20: 2061 785f 6e73 7464 203d 2070 6c74 2e73   ax_nstd = plt.s
+0001cb30: 7562 706c 6f74 7328 6669 6773 697a 653d  ubplots(figsize=
+0001cb40: 2836 2c20 3629 290d 0a20 2020 2023 2064  (6, 6))..    # d
+0001cb50: 6570 656e 6465 6e63 795f 6e73 7464 203d  ependency_nstd =
+0001cb60: 205b 5b30 2e38 2c20 302e 3735 5d2c 0d0a   [[0.8, 0.75],..
+0001cb70: 2020 2020 2320 2020 2020 2020 2020 2020      #           
+0001cb80: 2020 2020 2020 2020 205b 2d30 2e32 2c20           [-0.2, 
+0001cb90: 302e 3335 5d5d 0d0a 2020 2020 6d75 203d  0.35]]..    mu =
+0001cba0: 2030 2c20 300d 0a20 2020 2023 2073 6361   0, 0..    # sca
+0001cbb0: 6c65 203d 2038 2c20 350d 0a20 2020 2061  le = 8, 5..    a
+0001cbc0: 785f 6e73 7464 2e61 7876 6c69 6e65 2863  x_nstd.axvline(c
+0001cbd0: 3d27 6772 6579 272c 206c 773d 3129 0d0a  ='grey', lw=1)..
+0001cbe0: 2020 2020 6178 5f6e 7374 642e 6178 686c      ax_nstd.axhl
+0001cbf0: 696e 6528 633d 2767 7265 7927 2c20 6c77  ine(c='grey', lw
+0001cc00: 3d31 290d 0a20 2020 200d 0a20 2020 2023  =1)..    ..    #
+0001cc10: 782c 2079 203d 2067 6574 5f63 6f72 7265  x, y = get_corre
+0001cc20: 6c61 7465 645f 6461 7461 7365 7428 3530  lated_dataset(50
+0001cc30: 302c 2064 6570 656e 6465 6e63 795f 6e73  0, dependency_ns
+0001cc40: 7464 2c20 6d75 2c20 7363 616c 6529 0d0a  td, mu, scale)..
+0001cc50: 2020 2020 6178 5f6e 7374 642e 7363 6174      ax_nstd.scat
+0001cc60: 7465 7228 782c 2079 2c20 733d 302e 3529  ter(x, y, s=0.5)
+0001cc70: 0d0a 2020 2020 0d0a 2020 2020 636f 6e66  ..    ..    conf
+0001cc80: 6964 656e 6365 5f65 6c6c 6970 7365 2878  idence_ellipse(x
+0001cc90: 2c20 792c 2061 785f 6e73 7464 2c20 6e5f  , y, ax_nstd, n_
+0001cca0: 7374 643d 312c 0d0a 2020 2020 2020 2020  std=1,..        
+0001ccb0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0001ccc0: 6162 656c 3d72 2724 315c 7369 676d 6124  abel=r'$1\sigma$
+0001ccd0: 272c 2065 6467 6563 6f6c 6f72 3d27 6669  ', edgecolor='fi
+0001cce0: 7265 6272 6963 6b27 290d 0a20 2020 2063  rebrick')..    c
+0001ccf0: 6f6e 6669 6465 6e63 655f 656c 6c69 7073  onfidence_ellips
+0001cd00: 6528 782c 2079 2c20 6178 5f6e 7374 642c  e(x, y, ax_nstd,
+0001cd10: 206e 5f73 7464 3d32 2c0d 0a20 2020 2020   n_std=2,..     
+0001cd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd30: 2020 6c61 6265 6c3d 7227 2432 5c73 6967    label=r'$2\sig
+0001cd40: 6d61 2427 2c20 6564 6765 636f 6c6f 723d  ma$', edgecolor=
+0001cd50: 2766 7563 6873 6961 272c 0d0a 2020 2020  'fuchsia',..    
 0001cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd70: 2020 2020 2020 206c 6162 656c 3d72 2724         label=r'$
-0001cd80: 335c 7369 676d 6124 272c 2065 6467 6563  3\sigma$', edgec
-0001cd90: 6f6c 6f72 3d27 626c 7565 272c 200d 0a20  olor='blue', .. 
-0001cda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cdb0: 2020 2020 2020 6c69 6e65 7374 796c 653d        linestyle=
-0001cdc0: 273a 2729 0d0a 2020 2020 0d0a 2020 2020  ':')..    ..    
-0001cdd0: 6178 5f6e 7374 642e 7363 6174 7465 7228  ax_nstd.scatter(
-0001cde0: 6d75 5b30 5d2c 206d 755b 315d 2c20 633d  mu[0], mu[1], c=
-0001cdf0: 2772 6564 272c 2073 3d33 290d 0a20 2020  'red', s=3)..   
-0001ce00: 2061 785f 6e73 7464 2e73 6574 5f74 6974   ax_nstd.set_tit
-0001ce10: 6c65 2827 4469 6666 6572 656e 7420 7374  le('Different st
-0001ce20: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
-0001ce30: 7327 290d 0a20 2020 2061 785f 6e73 7464  s')..    ax_nstd
-0001ce40: 2e6c 6567 656e 6428 290d 0a20 2020 2070  .legend()..    p
-0001ce50: 6c74 2e73 686f 7728 290d 0a20 2020 200d  lt.show()..    .
-0001ce60: 0a64 6566 2063 6f6e 6669 6465 6e63 655f  .def confidence_
-0001ce70: 656c 6c69 7073 6528 0d0a 2020 2020 782c  ellipse(..    x,
-0001ce80: 200d 0a20 2020 2079 2c20 0d0a 2020 2020   ..    y, ..    
-0001ce90: 6178 2c20 0d0a 2020 2020 6e5f 7374 643d  ax, ..    n_std=
-0001cea0: 332e 302c 200d 0a20 2020 2066 6163 6563  3.0, ..    facec
-0001ceb0: 6f6c 6f72 3d27 6e6f 6e65 272c 200d 0a20  olor='none', .. 
-0001cec0: 2020 202a 2a6b 7761 7267 730d 0a20 2020     **kwargs..   
-0001ced0: 2029 3a0d 0a20 2020 2022 2222 0d0a 2020   ):..    """..  
-0001cee0: 2020 4372 6561 7465 2061 2070 6c6f 7420    Create a plot 
-0001cef0: 6f66 2074 6865 2063 6f76 6172 6961 6e63  of the covarianc
-0001cf00: 6520 636f 6e66 6964 656e 6365 2065 6c6c  e confidence ell
-0001cf10: 6970 7365 206f 6620 2a78 2a20 616e 6420  ipse of *x* and 
-0001cf20: 2a79 2a2e 0d0a 0d0a 2020 2020 5061 7261  *y*.....    Para
-0001cf30: 6d65 7465 7273 0d0a 2020 2020 2d2d 2d2d  meters..    ----
-0001cf40: 2d2d 2d2d 2d2d 0d0a 2020 2020 782c 2079  ------..    x, y
-0001cf50: 203a 2061 7272 6179 2d6c 696b 652c 2073   : array-like, s
-0001cf60: 6861 7065 2028 6e2c 2029 0d0a 2020 2020  hape (n, )..    
-0001cf70: 2020 2020 496e 7075 7420 6461 7461 2e0d      Input data..
-0001cf80: 0a0d 0a20 2020 2061 7820 3a20 6d61 7470  ...    ax : matp
-0001cf90: 6c6f 746c 6962 2e61 7865 732e 4178 6573  lotlib.axes.Axes
-0001cfa0: 0d0a 2020 2020 2020 2020 5468 6520 6178  ..        The ax
-0001cfb0: 6573 206f 626a 6563 7420 746f 2064 7261  es object to dra
-0001cfc0: 7720 7468 6520 656c 6c69 7073 6520 696e  w the ellipse in
-0001cfd0: 746f 2e0d 0a0d 0a20 2020 206e 5f73 7464  to.....    n_std
-0001cfe0: 203a 2066 6c6f 6174 0d0a 2020 2020 2020   : float..      
-0001cff0: 2020 5468 6520 6e75 6d62 6572 206f 6620    The number of 
-0001d000: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
-0001d010: 6f6e 7320 746f 2064 6574 6572 6d69 6e65  ons to determine
-0001d020: 2074 6865 2065 6c6c 6970 7365 2773 2072   the ellipse's r
-0001d030: 6164 6975 7365 732e 0d0a 0d0a 2020 2020  adiuses.....    
-0001d040: 2a2a 6b77 6172 6773 0d0a 2020 2020 2020  **kwargs..      
-0001d050: 2020 466f 7277 6172 6465 6420 746f 2060    Forwarded to `
-0001d060: 7e6d 6174 706c 6f74 6c69 622e 7061 7463  ~matplotlib.patc
-0001d070: 6865 732e 456c 6c69 7073 6560 0d0a 0d0a  hes.Ellipse`....
-0001d080: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-0001d090: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 6d70   -------..    mp
-0001d0a0: 6c2e 7061 7463 6865 732e 456c 6c69 7073  l.patches.Ellips
-0001d0b0: 650d 0a20 2020 2022 2222 0d0a 2020 2020  e..    """..    
-0001d0c0: 6966 2078 2e73 697a 6520 213d 2079 2e73  if x.size != y.s
-0001d0d0: 697a 653a 0d0a 2020 2020 2020 2020 7261  ize:..        ra
-0001d0e0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-0001d0f0: 7820 616e 6420 7920 6d75 7374 2062 6520  x and y must be 
-0001d100: 7468 6520 7361 6d65 2073 697a 6522 290d  the same size").
-0001d110: 0a0d 0a20 2020 2063 6f76 203d 206e 702e  ...    cov = np.
-0001d120: 636f 7628 782c 2079 290d 0a20 2020 2070  cov(x, y)..    p
-0001d130: 6561 7273 6f6e 203d 2063 6f76 5b30 2c20  earson = cov[0, 
-0001d140: 315d 2f6e 702e 7371 7274 2863 6f76 5b30  1]/np.sqrt(cov[0
-0001d150: 2c20 305d 202a 2063 6f76 5b31 2c20 315d  , 0] * cov[1, 1]
-0001d160: 290d 0a20 2020 2023 2055 7369 6e67 2061  )..    # Using a
-0001d170: 2073 7065 6369 616c 2063 6173 6520 746f   special case to
-0001d180: 206f 6274 6169 6e20 7468 6520 6569 6765   obtain the eige
-0001d190: 6e76 616c 7565 7320 6f66 2074 6869 730d  nvalues of this.
-0001d1a0: 0a20 2020 2023 2074 776f 2d64 696d 656e  .    # two-dimen
-0001d1b0: 7369 6f6e 616c 2064 6174 6173 6574 2e0d  sional dataset..
-0001d1c0: 0a20 2020 2065 6c6c 5f72 6164 6975 735f  .    ell_radius_
-0001d1d0: 7820 3d20 6e70 2e73 7172 7428 3120 2b20  x = np.sqrt(1 + 
-0001d1e0: 7065 6172 736f 6e29 0d0a 2020 2020 656c  pearson)..    el
-0001d1f0: 6c5f 7261 6469 7573 5f79 203d 206e 702e  l_radius_y = np.
-0001d200: 7371 7274 2831 202d 2070 6561 7273 6f6e  sqrt(1 - pearson
-0001d210: 290d 0a20 2020 2065 6c6c 6970 7365 203d  )..    ellipse =
-0001d220: 2045 6c6c 6970 7365 2828 302c 2030 292c   Ellipse((0, 0),
-0001d230: 2077 6964 7468 3d65 6c6c 5f72 6164 6975   width=ell_radiu
-0001d240: 735f 7820 2a20 322c 2068 6569 6768 743d  s_x * 2, height=
-0001d250: 656c 6c5f 7261 6469 7573 5f79 202a 2032  ell_radius_y * 2
-0001d260: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0001d270: 2020 2020 2020 2020 2066 6163 6563 6f6c           facecol
-0001d280: 6f72 3d66 6163 6563 6f6c 6f72 2c20 2a2a  or=facecolor, **
-0001d290: 6b77 6172 6773 290d 0a0d 0a20 2020 2023  kwargs)....    #
-0001d2a0: 2043 616c 6375 6c61 7469 6e67 2074 6865   Calculating the
-0001d2b0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
-0001d2c0: 696f 6e20 6f66 2078 2066 726f 6d0d 0a20  ion of x from.. 
-0001d2d0: 2020 2023 2074 6865 2073 7175 6172 6572     # the squarer
-0001d2e0: 6f6f 7420 6f66 2074 6865 2076 6172 6961  oot of the varia
-0001d2f0: 6e63 6520 616e 6420 6d75 6c74 6970 6c79  nce and multiply
-0001d300: 696e 670d 0a20 2020 2023 2077 6974 6820  ing..    # with 
-0001d310: 7468 6520 6769 7665 6e20 6e75 6d62 6572  the given number
-0001d320: 206f 6620 7374 616e 6461 7264 2064 6576   of standard dev
-0001d330: 6961 7469 6f6e 732e 0d0a 2020 2020 7363  iations...    sc
-0001d340: 616c 655f 7820 3d20 6e70 2e73 7172 7428  ale_x = np.sqrt(
-0001d350: 636f 765b 302c 2030 5d29 202a 206e 5f73  cov[0, 0]) * n_s
-0001d360: 7464 0d0a 2020 2020 6d65 616e 5f78 203d  td..    mean_x =
-0001d370: 206e 702e 6d65 616e 2878 290d 0a0d 0a20   np.mean(x).... 
-0001d380: 2020 2023 2063 616c 6375 6c61 7469 6e67     # calculating
-0001d390: 2074 6865 2073 7461 6e64 6172 6420 6465   the standard de
-0001d3a0: 7669 6174 696f 6e20 6f66 2079 202e 2e2e  viation of y ...
-0001d3b0: 0d0a 2020 2020 7363 616c 655f 7920 3d20  ..    scale_y = 
-0001d3c0: 6e70 2e73 7172 7428 636f 765b 312c 2031  np.sqrt(cov[1, 1
-0001d3d0: 5d29 202a 206e 5f73 7464 0d0a 2020 2020  ]) * n_std..    
-0001d3e0: 6d65 616e 5f79 203d 206e 702e 6d65 616e  mean_y = np.mean
-0001d3f0: 2879 290d 0a0d 0a20 2020 2074 7261 6e73  (y)....    trans
-0001d400: 6620 3d20 7472 616e 7366 6f72 6d73 2e41  f = transforms.A
-0001d410: 6666 696e 6532 4428 2920 5c0d 0a20 2020  ffine2D() \..   
-0001d420: 2020 2020 202e 726f 7461 7465 5f64 6567       .rotate_deg
-0001d430: 2834 3529 205c 0d0a 2020 2020 2020 2020  (45) \..        
-0001d440: 2e73 6361 6c65 2873 6361 6c65 5f78 2c20  .scale(scale_x, 
-0001d450: 7363 616c 655f 7929 205c 0d0a 2020 2020  scale_y) \..    
-0001d460: 2020 2020 2e74 7261 6e73 6c61 7465 286d      .translate(m
-0001d470: 6561 6e5f 782c 206d 6561 6e5f 7929 0d0a  ean_x, mean_y)..
-0001d480: 0d0a 2020 2020 656c 6c69 7073 652e 7365  ..    ellipse.se
-0001d490: 745f 7472 616e 7366 6f72 6d28 7472 616e  t_transform(tran
-0001d4a0: 7366 202b 2061 782e 7472 616e 7344 6174  sf + ax.transDat
-0001d4b0: 6129 0d0a 2020 2020 7265 7475 726e 2061  a)..    return a
-0001d4c0: 782e 6164 645f 7061 7463 6828 656c 6c69  x.add_patch(elli
-0001d4d0: 7073 6529 2020 0d0a 2020 200d 0a64 6566  pse)  ..   ..def
-0001d4e0: 2070 6c6f 745f 7374 7269 6b65 2028 0d0a   plot_strike (..
-0001d4f0: 2020 2020 6c69 7374 5f6f 665f 6564 6973      list_of_edis
-0001d500: 2c20 2f2c 200d 0a20 2020 206b 696e 6420  , /, ..    kind 
-0001d510: 3d20 322c 0d0a 2020 2020 7065 7269 6f64  = 2,..    period
-0001d520: 5f74 6f6c 6572 616e 6365 3d2e 3035 2c20  _tolerance=.05, 
-0001d530: 0d0a 2020 2020 7465 7874 5f70 6164 203d  ..    text_pad =
-0001d540: 312e 3635 202c 200d 0a20 2020 2072 6f74  1.65 , ..    rot
-0001d550: 5f7a 3d30 2e20 2c20 0d0a 2020 2020 2a2a  _z=0. , ..    **
-0001d560: 6b77 730d 0a20 2020 2029 3a20 0d0a 2020  kws..    ): ..  
-0001d570: 2020 0d0a 2020 2020 6578 7472 6120 3d28    ..    extra =(
-0001d580: 2250 6c6f 7453 7472 696b 6520 7573 6573  "PlotStrike uses
-0001d590: 2027 6d74 7079 2720 6f72 2027 7079 6373   'mtpy' or 'pycs
-0001d5a0: 616d 7427 2061 7320 6465 7065 6e64 656e  amt' as dependen
-0001d5b0: 6379 2e22 0d0a 2020 2020 2020 2020 2020  cy."..          
-0001d5c0: 2020 290d 0a20 2020 2069 6d70 6f72 745f    )..    import_
-0001d5d0: 6f70 7469 6f6e 616c 5f64 6570 656e 6465  optional_depende
-0001d5e0: 6e63 7920 2827 6d74 7079 272c 2065 7874  ncy ('mtpy', ext
-0001d5f0: 7261 203d 2065 7874 7261 2029 0d0a 2020  ra = extra )..  
-0001d600: 2020 2378 7878 7878 7878 7878 7878 7878    #xxxxxxxxxxxxx
-0001d610: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0001d620: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0001d630: 7878 7878 0d0a 2020 2020 6672 6f6d 206d  xxxx..    from m
-0001d640: 7470 792e 696d 6167 696e 672e 706c 6f74  tpy.imaging.plot
-0001d650: 7374 7269 6b65 2069 6d70 6f72 7420 506c  strike import Pl
-0001d660: 6f74 5374 7269 6b65 0d0a 2020 2020 6672  otStrike..    fr
-0001d670: 6f6d 202e 2e70 726f 7065 7274 7920 696d  om ..property im
-0001d680: 706f 7274 2049 7345 6469 0d0a 2020 2020  port IsEdi..    
-0001d690: 2378 7878 7878 7878 7878 7878 7878 7878  #xxxxxxxxxxxxxxx
-0001d6a0: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0001d6b0: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
-0001d6c0: 7878 0d0a 2020 2020 6966 2069 7369 6e73  xx..    if isins
-0001d6d0: 7461 6e63 6520 2820 6c69 7374 5f6f 665f  tance ( list_of_
-0001d6e0: 6564 6973 2c20 7374 7229 3a20 0d0a 2020  edis, str): ..  
-0001d6f0: 2020 2020 2020 6966 206f 732e 7061 7468        if os.path
-0001d700: 2e69 7364 6972 2028 206c 6973 745f 6f66  .isdir ( list_of
-0001d710: 5f65 6469 7320 293a 200d 0a20 2020 2020  _edis ): ..     
-0001d720: 2020 2020 2020 206c 6973 745f 6f66 5f65         list_of_e
-0001d730: 6469 7320 3d20 5b6f 732e 7061 7468 2e6a  dis = [os.path.j
-0001d740: 6f69 6e28 2066 2920 666f 7220 6620 696e  oin( f) for f in
-0001d750: 206f 732e 6c69 7374 6469 7220 286c 6973   os.listdir (lis
-0001d760: 745f 6f66 5f65 6469 7329 0d0a 2020 2020  t_of_edis)..    
-0001d770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d780: 2020 2020 2020 2020 6966 2073 7472 2866          if str(f
-0001d790: 292e 6c6f 7765 7228 292e 656e 6473 7769  ).lower().endswi
-0001d7a0: 7468 2028 272e 6564 6927 295d 0d0a 2020  th ('.edi')]..  
-0001d7b0: 2020 2020 2020 6966 206f 732e 7061 7468        if os.path
-0001d7c0: 2e69 7366 696c 6520 286c 6973 745f 6f66  .isfile (list_of
-0001d7d0: 5f65 6469 7329 3a20 0d0a 2020 2020 2020  _edis): ..      
-0001d7e0: 2020 2020 2020 6c69 7374 5f6f 665f 6564        list_of_ed
-0001d7f0: 6973 203d 5b6c 6973 745f 6f66 5f65 6469  is =[list_of_edi
-0001d800: 7320 5d0d 0a20 2020 2020 2020 200d 0a20  s ]..        .. 
-0001d810: 2020 2023 206e 6f77 2063 6865 636b 2077     # now check w
-0001d820: 6865 7468 6572 2069 7320 7661 6c69 6420  hether is valid 
-0001d830: 4544 4920 2020 2020 0d0a 2020 2020 2320  EDI     ..    # 
-0001d840: 6c69 7374 2063 6f6d 7072 6568 656e 7369  list comprehensi
-0001d850: 6f6e 2066 6173 7465 7220 7468 616e 0d0a  on faster than..
-0001d860: 2020 2020 2320 7475 706c 6520 286d 6170      # tuple (map
-0001d870: 2028 6c61 6d62 6461 2066 3a20 2049 7345   (lambda f:  IsE
-0001d880: 6469 2e5f 6173 7365 7274 5f65 6469 2028  di._assert_edi (
-0001d890: 6620 292c 206c 6973 745f 6f66 5f65 6469  f ), list_of_edi
-0001d8a0: 7320 2920 290d 0a20 2020 205b 2049 7345  s ) )..    [ IsE
-0001d8b0: 6469 2e5f 6173 7365 7274 5f65 6469 2028  di._assert_edi (
-0001d8c0: 6620 2920 666f 7220 6620 696e 206c 6973  f ) for f in lis
-0001d8d0: 745f 6f66 5f65 6469 7320 5d20 0d0a 2020  t_of_edis ] ..  
-0001d8e0: 2020 2320 7375 7070 7265 7373 2074 6869    # suppress thi
-0001d8f0: 7264 2070 6172 7479 2076 6572 626f 7369  rd party verbosi
-0001d900: 7479 200d 0a20 2020 2077 6974 6820 6e75  ty ..    with nu
-0001d910: 6c6c 6966 795f 6f75 7470 7574 2829 3a0d  llify_output():.
-0001d920: 0a20 2020 2020 2020 2050 6c6f 7453 7472  .        PlotStr
-0001d930: 696b 6528 0d0a 2020 2020 2020 2020 2020  ike(..          
-0001d940: 2020 666e 5f6c 6973 743d 6c69 7374 5f6f    fn_list=list_o
-0001d950: 665f 6564 6973 2c0d 0a20 2020 2020 2020  f_edis,..       
-0001d960: 2020 2020 2070 6c6f 745f 7479 7065 3d6b       plot_type=k
-0001d970: 696e 642c 0d0a 2020 2020 2020 2020 2020  ind,..          
-0001d980: 2020 2a2a 6b77 730d 0a20 2020 2020 2020    **kws..       
-0001d990: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-0001d9a0: 0d0a 706c 6f74 5f73 7472 696b 652e 5f5f  ..plot_strike.__
-0001d9b0: 646f 635f 5f3d 2222 2220 0d0a 506c 6f74  doc__=""" ..Plot
-0001d9c0: 2074 6865 2073 7472 696b 6520 6573 7469   the strike esti
-0001d9d0: 6d61 7465 6420 6672 6f6d 2074 6865 2069  mated from the i
-0001d9e0: 6e76 6172 6961 6e74 7320 616e 6420 7068  nvariants and ph
-0001d9f0: 6173 6520 7465 6e73 6f72 2e20 0d0a 696e  ase tensor. ..in
-0001da00: 2061 2072 6f73 6520 6469 6167 7261 6d20   a rose diagram 
-0001da10: 6f66 2078 7920 706c 6f74 2e20 0d0a 0d0a  of xy plot. ....
-0001da20: 5061 7261 6d65 7465 7273 200d 0a2d 2d2d  Parameters ..---
-0001da30: 2d2d 2d2d 2d2d 2d2d 2d0d 0a6c 6973 745f  ---------..list_
-0001da40: 6f66 5f65 6469 733a 206c 6973 742c 200d  of_edis: list, .
-0001da50: 0a20 2020 2066 756c 6c20 7061 7468 7320  .    full paths 
-0001da60: 746f 202e 6564 6920 6669 6c65 7320 746f  to .edi files to
-0001da70: 2070 6c6f 7420 6f72 206c 6973 7420 6f66   plot or list of
-0001da80: 203a 7465 726d 3a60 4544 492d 6669 6c65   :term:`EDI-file
-0001da90: 7360 2e20 0d0a 2020 2020 0d0a 2020 202e  s`. ..    ..   .
-0001daa0: 2e20 7665 7273 696f 6e63 6861 6e67 6564  . versionchanged
-0001dab0: 3a3a 2030 2e32 2e30 200d 0a20 2020 2020  :: 0.2.0 ..     
-0001dac0: 204e 6f20 6e65 6564 2074 6f20 7072 6f76   No need to prov
-0001dad0: 6964 6520 6120 6c69 7374 206f 6620 7465  ide a list of te
-0001dae0: 726d 3a60 4544 4960 2066 696c 6573 2e20  rm:`EDI` files. 
-0001daf0: 4865 6e63 6566 6f72 7468 2060 6c69 7374  Henceforth `list
-0001db00: 5f6f 665f 6564 6973 600d 0a20 2020 2020  _of_edis`..     
-0001db10: 2061 6363 6570 7473 2074 6865 2045 4449   accepts the EDI
-0001db20: 2070 6174 682d 6c69 6b65 206f 626a 6563   path-like objec
-0001db30: 7420 6f66 2073 696e 676c 6520 4544 4920  t of single EDI 
-0001db40: 6669 6c65 2074 6865 6e20 6173 7365 7274  file then assert
-0001db50: 7320 0d0a 2020 2020 2020 7468 6520 7661  s ..      the va
-0001db60: 6c69 6469 7479 206f 6620 7468 6520 4544  lidity of the ED
-0001db70: 4920 6669 6c65 7320 6166 7465 7277 6172  I files afterwar
-0001db80: 642e 200d 0a0d 0a6b 696e 643a 2069 6e74  d. ....kind: int
-0001db90: 2c20 6465 6661 756c 743d 3220 0d0a 2020  , default=2 ..  
-0001dba0: 2020 4361 6e20 6265 205b 2031 207c 2032    Can be [ 1 | 2
-0001dbb0: 205d 2077 6865 7265 3a0d 0a20 2020 2020   ] where:..     
-0001dbc0: 2020 0d0a 2020 202d 202a 312a 2074 6f20    ..   - *1* to 
-0001dbd0: 706c 6f74 2069 6e64 6976 6964 7561 6c20  plot individual 
-0001dbe0: 6465 6361 6465 7320 696e 206f 6e65 2070  decades in one p
-0001dbf0: 6c6f 740d 0a20 2020 2d20 2a32 2a20 746f  lot..   - *2* to
-0001dc00: 2070 6c6f 7420 616c 6c20 7065 7269 6f64   plot all period
-0001dc10: 2072 616e 6765 7320 696e 746f 206f 6e65   ranges into one
-0001dc20: 2070 6f6c 6172 2064 6961 6772 616d 2066   polar diagram f
-0001dc30: 6f72 2065 6163 6820 0d0a 2020 2020 2073  or each ..     s
-0001dc40: 7472 696b 6520 616e 676c 6520 6573 7469  trike angle esti
-0001dc50: 6d61 7469 6f6e 0d0a 2020 2020 2020 2020  mation..        
-0001dc60: 200d 0a20 2020 4f6e 6520 636f 756c 6420   ..   One could 
-0001dc70: 7472 7920 616c 736f 2070 6c6f 745f 7479  try also plot_ty
-0001dc80: 7065 203d 2031 2074 6f20 706c 6f74 2062  pe = 1 to plot b
-0001dc90: 7920 6465 6361 6465 0d0a 2020 2020 2020  y decade..      
-0001dca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dcd0: 2020 2020 2020 2020 2020 2020 200d 0a66               ..f
-0001dce0: 6967 5f6e 756d 3a20 696e 742c 2064 6566  ig_num: int, def
-0001dcf0: 6175 6c74 3d31 2c20 0d0a 2020 2066 6967  ault=1, ..   fig
-0001dd00: 7572 6520 6e75 6d62 6572 2074 6f20 6265  ure number to be
-0001dd10: 2070 6c6f 7474 6564 2e20 2a44 6566 6175   plotted. *Defau
-0001dd20: 6c74 2a20 6973 2031 0d0a 2020 2020 2020  lt* is 1..      
-0001dd30: 2020 0d0a 666f 6e74 5f73 697a 653a 2066    ..font_size: f
-0001dd40: 6c6f 6174 2c20 6465 6661 756c 743d 3130  loat, default=10
-0001dd50: 2c20 0d0a 2020 2046 6967 7572 6520 7369  , ..   Figure si
-0001dd60: 7a65 200d 0a20 2020 0d0a 726f 745f 7a3a  ze ..   ..rot_z:
-0001dd70: 2066 6c6f 6174 2c20 6465 6661 756c 743d   float, default=
-0001dd80: 302e 2c20 0d0a 2020 2061 6e67 6c65 206f  0., ..   angle o
-0001dd90: 6620 726f 7461 7469 6f6e 2063 6c6f 636b  f rotation clock
-0001dda0: 7769 7365 2070 6f73 6974 6976 652e 200d  wise positive. .
-0001ddb0: 0a0d 0a70 6572 696f 645f 746f 6c65 7261  ...period_tolera
-0001ddc0: 6e63 653a 2066 6c6f 6174 2c20 6465 6661  nce: float, defa
-0001ddd0: 756c 743d 2e30 3520 0d0a 2020 2020 546f  ult=.05 ..    To
-0001dde0: 6c65 7261 6e63 6520 6c65 7665 6c20 746f  lerance level to
-0001ddf0: 206d 6174 6368 2070 6572 696f 6473 2066   match periods f
-0001de00: 726f 6d20 6469 6666 6572 656e 7420 6564  rom different ed
-0001de10: 6920 6669 6c65 732e 0d0a 2020 2020 2a44  i files...    *D
-0001de20: 6566 6175 6c74 2a20 6973 2030 2e30 350d  efault* is 0.05.
-0001de30: 0a0d 0a74 6578 745f 7061 643a 2066 6c6f  ...text_pad: flo
-0001de40: 6174 2c20 6465 6661 756c 743d 312e 3635  at, default=1.65
-0001de50: 0d0a 2020 2070 6164 6469 6e67 206f 6620  ..   padding of 
-0001de60: 7468 6520 616e 676c 6520 6c61 6265 6c20  the angle label 
-0001de70: 6174 2074 6865 2062 6f74 746f 6d20 6f66  at the bottom of
-0001de80: 2065 6163 680d 0a20 2020 2020 2020 2020   each..         
-0001de90: 2020 2020 2020 2020 706f 6c61 7220 6469          polar di
-0001dea0: 6167 7261 6d2e 2020 2a44 6566 6175 6c74  agram.  *Default
-0001deb0: 2a20 6973 2031 2e36 350d 0a70 6c6f 745f  * is 1.65..plot_
-0001dec0: 7261 6e67 653a 2020 7374 722c 2074 7570  range:  str, tup
-0001ded0: 6c65 200d 0a20 2020 5468 6520 7065 7269  le ..   The peri
-0001dee0: 6f64 2072 616e 6765 2074 6f20 6573 7469  od range to esti
-0001def0: 6d61 7465 2074 6865 2073 7472 696b 6520  mate the strike 
-0001df00: 616e 676c 652e 2049 7420 6361 6e20 6265  angle. It can be
-0001df10: 200d 0a20 2020 5b20 2764 6174 6127 207c   ..   [ 'data' |
-0001df20: 2028 7065 7269 6f64 5f6d 696e 2c70 6572   (period_min,per
-0001df30: 696f 645f 6d61 7829 205d 2e20 204f 7074  iod_max) ].  Opt
-0001df40: 696f 6e73 2061 7265 3a0d 0a20 2020 2020  ions are:..     
-0001df50: 2020 0d0a 2020 202a 202a 2764 6174 6127    ..   * *'data'
-0001df60: 2a20 666f 7220 6573 7469 6d61 7469 6e67  * for estimating
-0001df70: 2074 6865 2073 7472 696b 6520 666f 7220   the strike for 
-0001df80: 616c 6c20 7065 7269 6f64 730d 0a20 2020  all periods..   
-0001df90: 2020 696e 2074 6865 2064 6174 612e 0d0a    in the data...
-0001dfa0: 2020 202a 2028 706d 696e 2c70 6d61 7829     * (pmin,pmax)
-0001dfb0: 2066 6f72 2070 6572 696f 6420 6d69 6e20   for period min 
-0001dfc0: 616e 6420 7065 7269 6f64 206d 6178 2c20  and period max, 
-0001dfd0: 696e 7075 7420 6173 0d0a 2020 2020 2028  input as..     (
-0001dfe0: 6c6f 6731 3028 706d 696e 292c 6c6f 6731  log10(pmin),log1
-0001dff0: 3028 706d 6178 2929 0d0a 0d0a 706c 6f74  0(pmax))....plot
-0001e000: 5f74 6970 7065 723a 205b 2054 7275 6520  _tipper: [ True 
-0001e010: 7c20 4661 6c73 6520 5d0d 0a20 2020 202d  | False ]..    -
-0001e020: 2054 7275 6520 746f 2070 6c6f 7420 7468   True to plot th
-0001e030: 6520 7469 7070 6572 2073 7472 696b 650d  e tipper strike.
-0001e040: 0a20 2020 202d 2046 616c 7365 2074 6f20  .    - False to 
-0001e050: 6e6f 7420 706c 6f74 2074 6970 7065 7220  not plot tipper 
-0001e060: 7374 7269 6b65 0d0a 2020 200d 0a70 745f  strike..   ..pt_
-0001e070: 6572 726f 725f 666c 6f6f 723a 2069 6e74  error_floor: int
-0001e080: 2c20 6f70 7469 6f6e 616c 200d 0a20 2020  , optional ..   
-0001e090: 4d61 7869 6d75 6d20 6572 726f 7220 696e  Maximum error in
-0001e0a0: 2064 6567 7265 6573 2074 6861 7420 6973   degrees that is
-0001e0b0: 2061 6c6c 6f77 6564 2074 6f20 0d0a 2020   allowed to ..  
-0001e0c0: 2065 7374 696d 6174 6520 7374 7269 6b65   estimate strike
-0001e0d0: 2e20 2a44 6566 6175 6c74 2a20 6973 204e  . *Default* is N
-0001e0e0: 6f6e 6520 616c 6c6f 7769 6e67 2061 6c6c  one allowing all
-0001e0f0: 200d 0a20 2020 6573 7469 6d61 7465 7320   ..   estimates 
-0001e100: 746f 2062 6520 7573 6564 2e0d 0a0d 0a66  to be used.....f
-0001e110: 6f6c 643a 205b 2054 7275 6520 7c20 4661  old: [ True | Fa
-0001e120: 6c73 6520 5d0d 0a20 2020 2a20 5472 7565  lse ]..   * True
-0001e130: 2074 6f20 706c 6f74 206f 6e6c 7920 6672   to plot only fr
-0001e140: 6f6d 2030 2074 6f20 3138 300d 0a20 2020  om 0 to 180..   
-0001e150: 2a20 4661 6c73 6520 746f 2070 6c6f 7420  * False to plot 
-0001e160: 6672 6f6d 2030 2074 6f20 3336 300d 0a20  from 0 to 360.. 
-0001e170: 2020 2020 2020 2020 2020 200d 0a70 6c6f             ..plo
-0001e180: 745f 6f72 7468 6f67 6f6e 616c 3a20 5b20  t_orthogonal: [ 
-0001e190: 5472 7565 207c 2046 616c 7365 5d0d 0a20  True | False].. 
-0001e1a0: 2020 202a 2054 7275 6520 746f 2070 6c6f     * True to plo
-0001e1b0: 7420 7468 6520 6f72 7468 6f67 6f6e 616c  t the orthogonal
-0001e1c0: 2073 7472 696b 6520 6469 7265 6374 696f   strike directio
-0001e1d0: 6e73 0d0a 2020 2020 2a20 4661 6c73 6520  ns..    * False 
-0001e1e0: 746f 206e 6f74 0d0a 0d0a 636f 6c6f 723a  to not....color:
-0001e1f0: 205b 2054 7275 6520 7c20 4661 6c73 6520   [ True | False 
-0001e200: 5d0d 0a20 2020 202a 2054 7275 6520 746f  ]..    * True to
-0001e210: 2070 6c6f 7420 7368 6164 6520 636f 6c6f   plot shade colo
-0001e220: 7273 0d0a 2020 2020 2a20 4661 6c73 6520  rs..    * False 
-0001e230: 746f 2070 6c6f 7420 616c 6c20 696e 206f  to plot all in o
-0001e240: 6e65 2063 6f6c 6f72 0d0a 2020 2020 2020  ne color..      
-0001e250: 2020 2020 2020 2020 0d0a 636f 6c6f 725f          ..color_
-0001e260: 696e 763a 7374 722c 200d 0a20 2020 636f  inv:str, ..   co
-0001e270: 6c6f 7220 6f66 2069 6e76 6172 6961 6e74  lor of invariant
-0001e280: 7320 706c 6f74 730d 0a0d 0a63 6f6c 6f72  s plots....color
-0001e290: 5f70 743a 2073 7472 2c20 0d0a 2020 2063  _pt: str, ..   c
-0001e2a0: 6f6c 6f72 206f 6620 7068 6173 6520 7465  olor of phase te
-0001e2b0: 6e73 6f72 2070 6c6f 7473 0d0a 0d0a 636f  nsor plots....co
-0001e2c0: 6c6f 725f 7469 703a 2073 7472 200d 0a20  lor_tip: str .. 
-0001e2d0: 2020 636f 6c6f 7220 6f66 2074 6970 7065    color of tippe
-0001e2e0: 7220 706c 6f74 730d 0a0d 0a72 696e 675f  r plots....ring_
-0001e2f0: 7370 6163 696e 673a 2066 6c6f 6174 2c20  spacing: float, 
-0001e300: 6f70 7469 6f6e 616c 200d 0a20 2020 2073  optional ..    s
-0001e310: 7061 6369 6e67 206f 6620 7269 6e67 7320  pacing of rings 
-0001e320: 696e 2070 6f6c 6172 2070 6c6f 7473 0d0a  in polar plots..
-0001e330: 0d0a 7269 6e67 5f6c 696d 6974 733a 2074  ..ring_limits: t
-0001e340: 7570 6c65 206f 6620 696e 742c 200d 0a20  uple of int, .. 
-0001e350: 2020 706c 6f74 206c 696d 6974 7320 286d    plot limits (m
-0001e360: 696e 2063 6f75 6e74 2c20 6d61 7820 636f  in count, max co
-0001e370: 756e 7429 2073 6574 2065 6163 6820 706c  unt) set each pl
-0001e380: 6f74 2068 6176 6520 7468 6573 6520 6c69  ot have these li
-0001e390: 6d69 7473 200d 0a20 2020 2020 2020 2020  mits ..         
-0001e3a0: 2020 2020 2020 2020 2020 200d 0a70 6c6f             ..plo
-0001e3b0: 745f 6f72 6965 6e74 6174 696f 6e3a 2073  t_orientation: s
-0001e3c0: 7472 2c20 5b20 2768 2720 7c20 2776 2720  tr, [ 'h' | 'v' 
-0001e3d0: 5d20 0d0a 2020 2068 6f72 697a 6f6e 7461  ] ..   horizonta
-0001e3e0: 6c20 6f72 2076 6572 7469 6361 6c20 706c  l or vertical pl
-0001e3f0: 6f74 730d 0a0d 0a0d 0a53 6565 204d 6f72  ots......See Mor
-0001e400: 650d 0a2d 2d2d 2d2d 2d2d 2d0d 0a50 6c6f  e..--------..Plo
-0001e410: 7473 2074 6865 2073 7472 696b 6520 616e  ts the strike an
-0001e420: 676c 6520 6173 2064 6574 6572 6d69 6e65  gle as determine
-0001e430: 6420 6279 2069 6e76 6172 6961 6e74 7320  d by invariants 
-0001e440: 6f66 2074 6865 2069 6d70 6564 616e 6365  of the impedance
-0001e450: 2074 656e 736f 7220 0d0a 2857 6561 7665   tensor ..(Weave
-0001e460: 7220 6574 2061 6c2e 205b 3230 3033 5d20  r et al. [2003] 
-0001e470: 5b31 5d5f 2920 616e 6420 7068 6173 6520  [1]_) and phase 
-0001e480: 7465 6e73 6f72 2061 7a69 6d75 7468 200d  tensor azimuth .
-0001e490: 0a28 4361 6c64 7765 6c6c 2065 7420 616c  .(Caldwell et al
-0001e4a0: 2e20 5b32 3030 345d 205b 325d 5f29 200d  . [2004] [2]_) .
-0001e4b0: 0a0d 0a54 6865 2064 6174 6120 6973 2073  ...The data is s
-0001e4c0: 706c 6974 2069 6e74 6f20 6465 6361 6465  plit into decade
-0001e4d0: 7320 7768 6572 6520 7468 6520 6869 7374  s where the hist
-0001e4e0: 6f67 7261 6d20 666f 7220 6561 6368 2069  ogram for each i
-0001e4f0: 7320 706c 6f74 7465 6420 696e 0d0a 7468  s plotted in..th
-0001e500: 6520 666f 726d 206f 6620 6120 726f 7365  e form of a rose
-0001e510: 2064 6961 6772 616d 2077 6974 6820 6120   diagram with a 
-0001e520: 7261 6e67 6520 6f66 2030 2074 6f20 3138  range of 0 to 18
-0001e530: 3020 6465 6772 6565 732e 0d0a 5768 6572  0 degrees...Wher
-0001e540: 6520 3020 6973 204e 6f72 7468 2061 6e64  e 0 is North and
-0001e550: 2039 3020 6973 2045 6173 742e 2020 5468   90 is East.  Th
-0001e560: 6520 6d65 6469 616e 2061 6e67 6c65 206f  e median angle o
-0001e570: 6620 7468 6520 7065 7269 6f64 2062 616e  f the period ban
-0001e580: 6420 6973 0d0a 7365 7420 696e 2070 6f6c  d is..set in pol
-0001e590: 6172 2064 6961 6772 616d 2e20 2054 6865  ar diagram.  The
-0001e5a0: 2074 6f70 2072 6f77 2069 7320 7468 6520   top row is the 
-0001e5b0: 7374 7269 6b65 2065 7374 696d 6174 6564  strike estimated
-0001e5c0: 2066 726f 6d0d 0a74 6865 2069 6e76 6172   from..the invar
-0001e5d0: 6961 6e74 7320 6f66 2074 6865 2069 6d70  iants of the imp
-0001e5e0: 6564 616e 6365 2074 656e 736f 722e 2020  edance tensor.  
-0001e5f0: 5468 6520 626f 7474 6f6d 2072 6f77 2069  The bottom row i
-0001e600: 7320 7468 6520 617a 696d 7574 680d 0a65  s the azimuth..e
-0001e610: 7374 696d 6174 6564 2066 726f 6d20 7468  stimated from th
-0001e620: 6520 7068 6173 6520 7465 6e73 6f72 2e20  e phase tensor. 
-0001e630: 2049 6620 7469 7070 6572 2069 7320 2779   If tipper is 'y
-0001e640: 2720 7468 656e 2074 6865 2033 7264 2072  ' then the 3rd r
-0001e650: 6f77 2069 7320 7468 650d 0a73 7472 696b  ow is the..strik
-0001e660: 6520 6465 7465 726d 696e 6564 2066 726f  e determined fro
-0001e670: 6d20 7468 6520 7469 7070 6572 2c20 7768  m the tipper, wh
-0001e680: 6963 6820 6973 206f 7274 686f 676f 6e61  ich is orthogona
-0001e690: 6c20 746f 2074 6865 2069 6e64 7563 7469  l to the inducti
-0001e6a0: 6f6e 0d0a 6172 726f 7720 6469 7265 6374  on..arrow direct
-0001e6b0: 696f 6e2e 0d0a 0d0a 5265 6665 7265 6e63  ion.....Referenc
-0001e6c0: 6573 200d 0a2d 2d2d 2d2d 2d2d 2d2d 2d0d  es ..----------.
-0001e6d0: 0a2e 2e20 5b31 5d20 5765 6176 6572 204a  ... [1] Weaver J
-0001e6e0: 2e54 2c20 4c69 6c6c 6579 2046 2e45 2e4d  .T, Lilley F.E.M
-0001e6f0: 2e28 3230 3033 2920 2049 6e76 6172 6961  .(2003)  Invaria
-0001e700: 6e74 7320 6f66 2072 6f74 6174 696f 6e20  nts of rotation 
-0001e710: 6f66 2061 7865 7320 616e 6420 696e 6469  of axes and indi
-0001e720: 6361 746f 7273 206f 660d 0a20 2020 2020  cators of..     
-0001e730: 2020 6469 6d65 6e73 696f 6e61 6c69 7479    dimensionality
-0001e740: 2069 6e20 6d61 676e 6574 6f74 656c 6c75   in magnetotellu
-0001e750: 7269 6373 2c20 4175 7374 7261 6c69 616e  rics, Australian
-0001e760: 204e 6174 696f 6e61 6c20 556e 6976 6572   National Univer
-0001e770: 7369 7479 2c0d 0a20 2020 2020 2020 556e  sity,..       Un
-0001e780: 6976 6572 7369 7479 206f 6620 5669 6374  iversity of Vict
-0001e790: 6f72 6961 3b20 6874 7470 3a2f 2f62 6962  oria; http://bib
-0001e7a0: 2e67 667a 2d70 6f74 7364 616d 2e64 652f  .gfz-potsdam.de/
-0001e7b0: 656d 7466 2f32 3030 372f 7064 662f 6c69  emtf/2007/pdf/li
-0001e7c0: 6c6c 6579 2e70 6466 0d0a 2e2e 205b 325d  lley.pdf.... [2]
-0001e7d0: 2054 2e20 4772 616e 7420 4361 6c64 7765   T. Grant Caldwe
-0001e7e0: 6c6c 2c20 4875 6768 204d 2e20 4269 6262  ll, Hugh M. Bibb
-0001e7f0: 792c 2043 6f6c 696e 2042 726f 776e 2c20  y, Colin Brown, 
-0001e800: 5468 6520 6d61 676e 6574 6f74 656c 6c75  The magnetotellu
-0001e810: 7269 6320 7068 6173 6520 7465 6e73 6f72  ric phase tensor
-0001e820: 2c20 0d0a 2020 2020 2020 2047 656f 7068  , ..       Geoph
-0001e830: 7973 6963 616c 204a 6f75 726e 616c 2049  ysical Journal I
-0001e840: 6e74 6572 6e61 7469 6f6e 616c 2c20 566f  nternational, Vo
-0001e850: 6c75 6d65 2031 3538 2c20 4973 7375 6520  lume 158, Issue 
-0001e860: 322c 2041 7567 7573 7420 3230 3034 2c20  2, August 2004, 
-0001e870: 0d0a 2020 2020 2020 2050 6167 6573 2034  ..       Pages 4
-0001e880: 3537 e280 9334 3639 2c20 6874 7470 733a  57...469, https:
-0001e890: 2f2f 646f 692e 6f72 672f 3130 2e31 3131  //doi.org/10.111
-0001e8a0: 312f 6a2e 3133 3635 2d32 3436 582e 3230  1/j.1365-246X.20
-0001e8b0: 3034 2e30 3232 3831 2e78 0d0a 4578 616d  04.02281.x..Exam
-0001e8c0: 706c 6573 200d 0a2d 2d2d 2d2d 2d2d 2d2d  ples ..---------
-0001e8d0: 2d0d 0a3e 3e3e 2069 6d70 6f72 7420 6f73  -..>>> import os
-0001e8e0: 200d 0a3e 3e3e 2066 726f 6d20 7761 7465   ..>>> from wate
-0001e8f0: 782e 6461 7461 7365 7473 2069 6d70 6f72  x.datasets impor
-0001e900: 7420 6665 7463 685f 6461 7461 200d 0a3e  t fetch_data ..>
-0001e910: 3e3e 2066 726f 6d20 7761 7465 782e 7574  >> from watex.ut
-0001e920: 696c 732e 706c 6f74 7574 696c 7320 696d  ils.plotutils im
-0001e930: 706f 7274 2070 6c6f 745f 7374 7269 6b65  port plot_strike
-0001e940: 200d 0a3e 3e3e 2066 726f 6d20 7761 7465   ..>>> from wate
-0001e950: 782e 6461 7461 7365 7473 2e5f 696f 2069  x.datasets._io i
-0001e960: 6d70 6f72 7420 6765 745f 6461 7461 2023  mport get_data #
-0001e970: 2067 6574 2065 6469 6461 7461 2069 6e20   get edidata in 
-0001e980: 6361 6368 6520 200d 0a3e 3e3e 2066 6574  cache  ..>>> fet
-0001e990: 6368 5f64 6174 6120 2820 2768 7561 7975  ch_data ( 'huayu
-0001e9a0: 616e 272c 2073 616d 706c 6573 203d 2032  an', samples = 2
-0001e9b0: 3520 2920 2320 7374 6f72 6520 6564 6920  5 ) # store edi 
-0001e9c0: 696e 2063 6163 6865 200d 0a3e 3e3e 2023  in cache ..>>> #
-0001e9d0: 2067 6574 2074 6865 2065 6469 2069 6e20   get the edi in 
-0001e9e0: 6361 6368 6520 616e 6420 706c 6f74 5374  cache and plotSt
-0001e9f0: 7269 6b65 200d 0a3e 3e3e 2065 6469 5f66  rike ..>>> edi_f
-0001ea00: 6e5f 6c73 7420 3d20 5b6f 732e 7061 7468  n_lst = [os.path
-0001ea10: 2e6a 6f69 6e28 6765 745f 6461 7461 2829  .join(get_data()
-0001ea20: 2c66 6629 2066 6f72 2066 6620 696e 206f  ,ff) for ff in o
-0001ea30: 732e 6c69 7374 6469 7228 6765 745f 6461  s.listdir(get_da
-0001ea40: 7461 2829 2920 0d0a 2e2e 2e20 2020 2020  ta()) .....     
-0001ea50: 2020 2020 6966 2066 662e 656e 6473 7769      if ff.endswi
-0001ea60: 7468 2827 2e65 6469 2729 5d20 0d0a 3e3e  th('.edi')] ..>>
-0001ea70: 3e20 706c 6f74 5f73 7472 696b 6528 6564  > plot_strike(ed
-0001ea80: 695f 666e 5f6c 7374 2029 0d0a 0d0a 2222  i_fn_lst )....""
-0001ea90: 220d 0a64 6566 2070 6c6f 745f 7465 7874  "..def plot_text
-0001eaa0: 2028 0d0a 2020 2020 782c 2079 2c20 0d0a   (..    x, y, ..
-0001eab0: 2020 2020 7465 7874 3d4e 6f6e 6520 2c20      text=None , 
-0001eac0: 0d0a 2020 2020 6461 7461 203d 4e6f 6e65  ..    data =None
-0001ead0: 2c20 0d0a 2020 2020 636f 6572 6365 203d  , ..    coerce =
-0001eae0: 4661 6c73 652c 200d 0a20 2020 2062 6173  False, ..    bas
-0001eaf0: 656e 616d 6520 3d27 5327 2c20 0d0a 2020  ename ='S', ..  
-0001eb00: 2020 6669 675f 7369 7a65 203d 2820 372c    fig_size =( 7,
-0001eb10: 2037 2029 2c20 0d0a 2020 2020 7368 6f77   7 ), ..    show
-0001eb20: 5f6c 696e 6520 3d46 616c 7365 2c20 0d0a  _line =False, ..
-0001eb30: 2020 2020 7374 6570 203d 204e 6f6e 6520      step = None 
-0001eb40: 2c20 0d0a 2020 2020 786c 6162 656c 203d  , ..    xlabel =
-0001eb50: 2727 2c20 0d0a 2020 2020 796c 6162 656c  '', ..    ylabel
-0001eb60: 203d 2727 2c20 0d0a 2020 2020 636f 6c6f   ='', ..    colo
-0001eb70: 723d 4e6f 6e65 2c20 0d0a 2020 2020 7368  r=None, ..    sh
-0001eb80: 6f77 5f6c 6567 203d 4661 6c73 652c 0d0a  ow_leg =False,..
-0001eb90: 2020 2020 6c69 6e65 6c61 6265 6c3d 2727      linelabel=''
-0001eba0: 2c20 0d0a 2020 2020 6d61 726b 6572 6c61  , ..    markerla
-0001ebb0: 6265 6c3d 2727 2c20 0d0a 2020 2020 2a2a  bel='', ..    **
-0001ebc0: 7465 7874 5f6b 7773 0d0a 2020 2020 293a  text_kws..    ):
-0001ebd0: 200d 0a20 2020 2022 2222 2050 6c6f 7420   ..    """ Plot 
-0001ebe0: 7465 7874 2873 2920 696e 6469 6361 7469  text(s) indicati
-0001ebf0: 6e67 2065 6163 6820 706f 7369 7469 6f6e  ng each position
-0001ec00: 2069 6e20 7468 6520 6c69 6e65 2e20 0d0a   in the line. ..
-0001ec10: 2020 2020 0d0a 2020 2020 5061 7261 6d65      ..    Parame
-0001ec20: 7465 7273 200d 0a20 2020 202d 2d2d 2d2d  ters ..    -----
-0001ec30: 2d2d 2d2d 2d2d 0d0a 2020 2020 782c 2079  ------..    x, y
-0001ec40: 3a20 7374 722c 2066 6c6f 6174 2c20 4172  : str, float, Ar
-0001ec50: 7261 792d 6c69 6b65 200d 0a20 2020 2020  ray-like ..     
-0001ec60: 2020 2054 6865 2070 6f73 6974 696f 6e20     The position 
-0001ec70: 746f 2070 6c61 6365 2074 6865 2074 6578  to place the tex
-0001ec80: 742e 2042 7920 6465 6661 756c 742c 2074  t. By default, t
-0001ec90: 6869 7320 6973 2069 6e20 6461 7461 200d  his is in data .
-0001eca0: 0a20 2020 2020 2020 2063 6f6f 7264 696e  .        coordin
-0001ecb0: 6174 6573 2e20 5468 6520 636f 6f72 6469  ates. The coordi
-0001ecc0: 6e61 7465 2073 7973 7465 6d20 6361 6e20  nate system can 
-0001ecd0: 6265 2063 6861 6e67 6564 2075 7369 6e67  be changed using
-0001ece0: 2074 6865 200d 0a20 2020 2020 2020 2074   the ..        t
-0001ecf0: 7261 6e73 666f 726d 2070 6172 616d 6574  ransform paramet
-0001ed00: 6572 2e0d 0a20 2020 2020 2020 200d 0a20  er...        .. 
-0001ed10: 2020 2074 6578 743a 2073 7472 2c20 0d0a     text: str, ..
-0001ed20: 2020 2020 2020 2020 5468 6520 7465 7874          The text
-0001ed30: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001ed40: 6461 7461 3a20 7064 2e44 6174 6146 7261  data: pd.DataFra
-0001ed50: 6d65 2c20 0d0a 2020 2020 2020 2044 6174  me, ..       Dat
-0001ed60: 6120 636f 6e74 6169 6e69 6e67 2078 2061  a containing x a
-0001ed70: 6e64 2079 206e 616d 6573 2e20 4e65 6564  nd y names. Need
-0001ed80: 2074 6f20 6265 2073 7570 706c 6965 6420   to be supplied 
-0001ed90: 7768 656e 2078 2061 6e64 2079 200d 0a20  when x and y .. 
-0001eda0: 2020 2020 2020 6172 6520 6769 7665 6e20        are given 
-0001edb0: 6173 2073 7472 696e 6720 6e61 6d65 732e  as string names.
-0001edc0: 200d 0a20 2020 2020 2020 0d0a 2020 2020   ..       ..    
-0001edd0: 636f 6572 6365 3a62 6f6f 6c2c 2064 6566  coerce:bool, def
-0001ede0: 6175 6c74 3d46 616c 7365 200d 0a20 2020  ault=False ..   
-0001edf0: 2020 2020 466f 7263 6520 7468 6520 706c      Force the pl
-0001ee00: 6f74 2064 6573 7069 7465 2074 6865 2067  ot despite the g
-0001ee10: 6976 656e 2074 6578 7465 7320 646f 206e  iven textes do n
-0001ee20: 6f74 206d 6174 6368 2074 6865 206e 756d  ot match the num
-0001ee30: 6265 7220 6f66 2020 0d0a 2020 2020 2020  ber of  ..      
-0001ee40: 2070 6f73 6974 696f 6e73 2060 7860 2061   positions `x` a
-0001ee50: 6e64 2060 7960 2e20 4966 2060 6046 616c  nd `y`. If ``Fal
-0001ee60: 7365 6060 2c20 6e75 6d62 6572 206f 6620  se``, number of 
-0001ee70: 706f 7369 7469 6f6e 7320 6d75 7374 2062  positions must b
-0001ee80: 6520 0d0a 2020 2020 2020 2063 6f6e 7369  e ..       consi
-0001ee90: 7374 656e 7420 7769 7468 2078 2061 6e64  stent with x and
-0001eea0: 2079 2c20 6f74 6865 7277 6973 6520 6572   y, otherwise er
-0001eeb0: 726f 7220 7261 6973 6573 2e20 0d0a 2020  ror raises. ..  
-0001eec0: 2020 2020 200d 0a20 2020 2062 6173 656e       ..    basen
-0001eed0: 616d 653a 2073 7472 2c20 6465 6661 756c  ame: str, defaul
-0001eee0: 743d 2753 2720 0d0a 2020 2020 2020 2074  t='S' ..       t
-0001eef0: 6865 2074 6578 7420 746f 2070 7265 6669  he text to prefi
-0001ef00: 7820 7468 6520 706f 7369 7469 6f6e 2077  x the position w
-0001ef10: 6865 6e20 7468 6520 7465 7874 2069 7320  hen the text is 
-0001ef20: 6e6f 7420 6769 7665 6e2e 200d 0a20 2020  not given. ..   
-0001ef30: 2020 2020 0d0a 2020 2020 6669 675f 7369      ..    fig_si
-0001ef40: 7a65 3a20 7475 706c 652c 2064 6566 6175  ze: tuple, defau
-0001ef50: 6c74 3d28 372c 2037 2920 0d0a 2020 2020  lt=(7, 7) ..    
-0001ef60: 2020 204d 6174 706c 6f74 6c69 6220 6669     Matplotlib fi
-0001ef70: 6775 7265 2073 697a 652e 0d0a 2020 2020  gure size...    
-0001ef80: 2020 200d 0a20 2020 2073 686f 775f 6c69     ..    show_li
-0001ef90: 6e65 3a20 626f 6f6c 2c20 6465 6661 756c  ne: bool, defaul
-0001efa0: 743d 4661 6c73 6520 0d0a 2020 2020 2020  t=False ..      
-0001efb0: 2044 6973 706c 6179 2074 6865 206c 696e   Display the lin
-0001efc0: 6520 6672 6f6d 2078 2c20 792e 200d 0a20  e from x, y. .. 
-0001efd0: 2020 2020 2020 0d0a 2020 2020 7374 6570        ..    step
-0001efe0: 3a20 696e 742c 4f70 7469 6f6e 616c 200d  : int,Optional .
-0001eff0: 0a20 2020 2020 2020 5468 6520 6e75 6d62  .       The numb
-0001f000: 6572 206f 6620 696e 7465 726d 6564 6961  er of intermedia
-0001f010: 7465 2070 6f73 6974 696f 6e73 2074 6f20  te positions to 
-0001f020: 736b 6970 2069 6e20 7468 6520 706c 6f74  skip in the plot
-0001f030: 7469 6e67 2074 6578 742e 200d 0a20 2020  ting text. ..   
-0001f040: 2020 2020 0d0a 2020 2020 786c 6162 656c      ..    xlabel
-0001f050: 2c20 796c 6162 656c 3a20 7374 722c 204f  , ylabel: str, O
-0001f060: 7074 696f 6e61 6c2c 200d 0a20 2020 2020  ptional, ..     
-0001f070: 2020 5468 6520 6c61 6265 6c73 206f 6620    The labels of 
-0001f080: 7820 616e 6420 792e 200d 0a20 2020 2063  x and y. ..    c
-0001f090: 6f6c 6f72 3a20 7374 722c 204f 7074 696f  olor: str, Optio
-0001f0a0: 6e61 6c20 0d0a 2020 2020 2020 204c 696e  nal ..       Lin
-0001f0b0: 6520 636f 6c6f 7220 6966 2060 7368 6f77  e color if `show
-0001f0c0: 5f6c 696e 6560 2069 7320 7365 7420 746f  _line` is set to
-0001f0d0: 2060 6054 7275 6560 602e 200d 0a20 2020   ``True``. ..   
-0001f0e0: 2020 2020 0d0a 2020 2020 7368 6f77 5f6c      ..    show_l
-0001f0f0: 6567 3a20 626f 6f6c 2c20 6465 6661 756c  eg: bool, defaul
-0001f100: 743d 4661 6c73 6520 0d0a 2020 2020 2020  t=False ..      
-0001f110: 2044 6973 706c 6179 2074 6865 206c 6567   Display the leg
-0001f120: 656e 6420 6f66 206c 696e 6520 616e 6420  end of line and 
-0001f130: 6d61 726b 6572 206c 6162 656c 732e 200d  marker labels. .
-0001f140: 0a20 2020 2020 2020 0d0a 2020 2020 6c69  .       ..    li
-0001f150: 6e65 6c61 6265 6c2c 206d 6172 6b65 726c  nelabel, markerl
-0001f160: 6162 656c 3a20 7374 722c 204f 7074 696f  abel: str, Optio
-0001f170: 6e61 6c20 0d0a 2020 2020 2020 2020 5468  nal ..        Th
-0001f180: 6520 6c61 6265 6c73 206f 6620 7468 6520  e labels of the 
-0001f190: 6c69 6e65 2061 6e64 206d 6172 6b65 722e  line and marker.
-0001f1a0: 200d 0a20 2020 2020 2020 0d0a 2020 2020   ..       ..    
-0001f1b0: 7465 7874 5f6b 7773 3a20 6469 6374 2c20  text_kws: dict, 
-0001f1c0: 0d0a 2020 2020 2020 204b 6579 776f 7264  ..       Keyword
-0001f1d0: 2061 7267 756d 656e 7473 2070 6173 7365   arguments passe
-0001f1e0: 6420 746f 203a 6d65 7468 3a60 6d61 7470  d to :meth:`matp
-0001f1f0: 6c6f 746c 6962 2e61 7865 732e 4178 6573  lotlib.axes.Axes
-0001f200: 2e74 6578 7460 2e20 0d0a 0d0a 2020 2020  .text`. ....    
-0001f210: 4578 616d 706c 6573 200d 0a20 2020 202d  Examples ..    -
-0001f220: 2d2d 2d2d 2d2d 2d0d 0a20 2020 203e 3e3e  -------..    >>>
-0001f230: 2069 6d70 6f72 7420 7761 7465 7820 6173   import watex as
-0001f240: 2077 7820 0d0a 2020 2020 3e3e 3e20 6461   wx ..    >>> da
-0001f250: 7461 203d 7778 2e6d 616b 655f 6572 7020  ta =wx.make_erp 
-0001f260: 2861 735f 6672 616d 6520 3d54 7275 652c  (as_frame =True,
-0001f270: 206e 5f73 7461 7469 6f6e 733d 2037 2029   n_stations= 7 )
-0001f280: 0d0a 2020 2020 3e3e 3e20 7820 2c20 7920  ..    >>> x , y 
-0001f290: 3d5b 2030 2c20 312c 2033 205d 2c20 5b32  =[ 0, 1, 3 ], [2
-0001f2a0: 2c20 332c 2036 5d20 0d0a 2020 2020 3e3e  , 3, 6] ..    >>
-0001f2b0: 3e20 7465 7874 6f20 3d20 5b27 414d 542d  > texto = ['AMT-
-0001f2c0: 4531 3134 3727 2c20 2741 4d54 2d45 3131  E1147', 'AMT-E11
-0001f2d0: 3438 272c 2020 2741 4d54 2d45 3138 3027  48',  'AMT-E180'
-0001f2e0: 5d0d 0a20 2020 203e 3e3e 2070 6c6f 745f  ]..    >>> plot_
-0001f2f0: 7465 7874 2028 782c 2079 202c 2074 6578  text (x, y , tex
-0001f300: 7420 3d20 7465 7874 6f29 2320 6e6f 206e  t = texto)# no n
-0001f310: 6565 6420 746f 2073 6574 2020 636f 6572  eed to set  coer
-0001f320: 6365 2c20 7361 6d65 206c 656e 6774 6820  ce, same length 
-0001f330: 0d0a 2020 2020 3e3e 3e20 6461 7461 203d  ..    >>> data =
-0001f340: 7778 2e6d 616b 655f 6572 7020 2861 735f  wx.make_erp (as_
-0001f350: 6672 616d 6520 3d54 7275 652c 206e 5f73  frame =True, n_s
-0001f360: 7461 7469 6f6e 733d 2032 3020 290d 0a20  tations= 20 ).. 
-0001f370: 2020 203e 3e3e 2078 202c 2079 203d 2064     >>> x , y = d
-0001f380: 6174 612e 6561 7374 696e 672c 2064 6174  ata.easting, dat
-0001f390: 612e 6e6f 7274 6869 6e67 0d0a 2020 2020  a.northing..    
-0001f3a0: 3e3e 3e20 7465 7874 3120 3d20 5b27 414d  >>> text1 = ['AM
-0001f3b0: 542d 4531 3134 3727 2c20 2741 4d54 2d45  T-E1147', 'AMT-E
-0001f3c0: 3131 3438 272c 2020 2741 4d54 2d45 3138  1148',  'AMT-E18
-0001f3d0: 3027 5d20 0d0a 2020 2020 3e3e 3e20 706c  0'] ..    >>> pl
-0001f3e0: 6f74 5f74 6578 7420 2878 2c20 7920 2c20  ot_text (x, y , 
-0001f3f0: 636f 6572 6365 203d 5472 7565 202c 2074  coerce =True , t
-0001f400: 6578 7420 3d20 7465 7874 3120 2c20 7368  ext = text1 , sh
-0001f410: 6f77 5f6c 6567 3d20 5472 7565 2c20 0d0a  ow_leg= True, ..
-0001f420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f430: 2020 2073 686f 775f 6c69 6e65 3d54 7275     show_line=Tru
-0001f440: 652c 206c 696e 656c 6162 656c 3d27 4531  e, linelabel='E1
-0001f450: 2d6c 696e 6527 2c20 6d61 726b 6572 6c61  -line', markerla
-0001f460: 6265 6c3d 2027 5369 7465 272c 200d 0a20  bel= 'Site', .. 
-0001f470: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-0001f480: 7365 6e61 6d65 203d 2741 4d54 2d45 3027  sename ='AMT-E0'
-0001f490: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0001f4a0: 2020 290d 0a20 2020 2022 2222 0d0a 2020    )..    """..  
-0001f4b0: 2020 2320 6173 7375 6d65 2078 2c20 7920    # assume x, y 
-0001f4c0: 2073 6572 6965 7320 6172 6520 7061 7373   series are pass
-0001f4d0: 6564 200d 0a20 2020 2069 6620 6973 696e  ed ..    if isin
-0001f4e0: 7374 616e 6365 2878 2c20 7374 7229 206f  stance(x, str) o
-0001f4f0: 7220 6861 7361 7474 7220 2820 782c 2027  r hasattr ( x, '
-0001f500: 6e61 6d65 2729 3a20 0d0a 2020 2020 2020  name'): ..      
-0001f510: 2020 786c 6162 656c 203d 2078 2020 6966    xlabel = x  if
-0001f520: 2069 7369 6e73 7461 6e63 6528 782c 2073   isinstance(x, s
-0001f530: 7472 2920 656c 7365 2078 2e6e 616d 6520  tr) else x.name 
-0001f540: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-0001f550: 6966 2069 7369 6e73 7461 6e63 6528 792c  if isinstance(y,
-0001f560: 2073 7472 2920 6f72 2068 6173 6174 7472   str) or hasattr
-0001f570: 2028 2079 2c20 276e 616d 6527 293a 200d   ( y, 'name'): .
-0001f580: 0a20 2020 2020 2020 2079 6c61 6265 6c20  .        ylabel 
-0001f590: 3d20 7920 2069 6620 6973 696e 7374 616e  = y  if isinstan
-0001f5a0: 6365 2879 2c20 7374 7229 2065 6c73 6520  ce(y, str) else 
-0001f5b0: 792e 6e61 6d65 200d 0a20 2020 2020 2020  y.name ..       
-0001f5c0: 200d 0a20 2020 2069 6620 7820 6973 204e   ..    if x is N
-0001f5d0: 6f6e 6520 616e 6420 2079 2069 7320 4e6f  one and  y is No
-0001f5e0: 6e65 3a0d 0a20 2020 2020 2020 2072 6169  ne:..        rai
-0001f5f0: 7365 2054 7970 6545 7272 6f72 2822 7820  se TypeError("x 
-0001f600: 616e 6420 7920 6172 6520 6e65 6564 6564  and y are needed
-0001f610: 2066 6f72 2074 6578 7420 706c 6f74 2e20   for text plot. 
-0001f620: 4e6f 6e65 5479 7065 220d 0a20 2020 2020  NoneType"..     
-0001f630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f640: 2020 2022 2063 616e 6e6f 7420 6265 2070     " cannot be p
-0001f650: 6c6f 7474 6564 2e22 2920 2020 200d 0a20  lotted.")    .. 
-0001f660: 2020 2020 2020 200d 0a20 2020 2078 2c20         ..    x, 
-0001f670: 7920 3d20 6173 7365 7274 5f78 795f 696e  y = assert_xy_in
-0001f680: 2878 2c20 792c 2064 6174 6120 3d20 6461  (x, y, data = da
-0001f690: 7461 2029 200d 0a0d 0a20 2020 2069 6620  ta ) ....    if 
-0001f6a0: 7465 7874 2069 7320 4e6f 6e65 2061 6e64  text is None and
-0001f6b0: 206e 6f74 2063 6f65 7263 653a 200d 0a20   not coerce: .. 
-0001f6c0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-0001f6d0: 4572 726f 7220 2822 5465 7874 2063 616e  Error ("Text can
-0001f6e0: 6e6f 7420 6265 2070 6c6f 7474 6564 2e20  not be plotted. 
-0001f6f0: 546f 2066 6f72 6365 2070 6c6f 7474 696e  To force plottin
-0001f700: 6720 7465 7874 2077 6974 6822 0d0a 2020  g text with"..  
-0001f710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f720: 2020 2020 2020 2220 7468 6520 6261 7365        " the base
-0001f730: 6e61 6d65 2c20 7365 7420 6060 636f 6572  name, set ``coer
-0001f740: 6365 3d54 7275 6560 602e 2229 0d0a 0d0a  ce=True``.")....
-0001f750: 2020 2020 7465 7874 203d 2069 735f 6974      text = is_it
-0001f760: 6572 6162 6c65 2874 6578 7420 2c20 6578  erable(text , ex
-0001f770: 636c 7564 655f 7374 7269 6e67 3d20 5472  clude_string= Tr
-0001f780: 7565 202c 2074 7261 6e73 666f 726d 203d  ue , transform =
-0001f790: 5472 7565 2029 0d0a 2020 2020 0d0a 2020  True )..    ..  
-0001f7a0: 2020 6966 2028 206c 656e 2874 6578 7429    if ( len(text)
-0001f7b0: 2021 3d20 6c65 6e28 7929 200d 0a20 2020   != len(y) ..   
-0001f7c0: 2020 2020 2061 6e64 206e 6f74 2063 6f65       and not coe
-0001f7d0: 7263 6529 203a 200d 0a20 2020 2020 2020  rce) : ..       
-0001f7e0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0001f7f0: 7228 2249 6e20 7072 696e 6369 706c 6520  r("In principle 
-0001f800: 7465 7874 2061 7272 6179 2061 6e64 2078  text array and x
-0001f810: 2f79 206d 7573 7420 6265 2063 6f6e 7369  /y must be consi
-0001f820: 7374 656e 742e 220d 0a20 2020 2020 2020  stent."..       
-0001f830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f840: 2020 6622 2047 6f74 207b 6c65 6e28 7465    f" Got {len(te
-0001f850: 7874 297d 2061 6e64 207b 6c65 6e28 7929  xt)} and {len(y)
-0001f860: 7d2e 2054 6f20 706c 6f74 2061 6e79 7761  }. To plot anywa
-0001f870: 792c 220d 0a20 2020 2020 2020 2020 2020  y,"..           
-0001f880: 2020 2020 2020 2020 2020 2020 2020 2220                " 
-0001f890: 7365 7420 6060 636f 6572 6365 3d54 7275  set ``coerce=Tru
-0001f8a0: 6560 602e 2229 0d0a 2020 2020 6966 2063  e``.")..    if c
-0001f8b0: 6f65 7263 6520 3a20 0d0a 2020 2020 2020  oerce : ..      
-0001f8c0: 2020 6261 7365 6e61 6d65 203d 7374 7228    basename =str(
-0001f8d0: 6261 7365 6e61 6d65 290d 0a20 2020 2020  basename)..     
-0001f8e0: 2020 2074 6578 7420 2b3d 205b 6627 7b62     text += [f'{b
-0001f8f0: 6173 656e 616d 657d 7b69 2b6c 656e 2874  asename}{i+len(t
-0001f900: 6578 7429 3a30 327d 2720 666f 7220 6920  ext):02}' for i 
-0001f910: 696e 2072 616e 6765 2028 6c65 6e28 7929  in range (len(y)
-0001f920: 2029 5d0d 0a0d 0a20 2020 2069 6620 7374   )]....    if st
-0001f930: 6570 2069 7320 6e6f 7420 4e6f 6e65 3a20  ep is not None: 
-0001f940: 0d0a 2020 2020 2020 2020 7374 6570 203d  ..        step =
-0001f950: 205f 6173 7365 7274 5f61 6c6c 5f74 7970   _assert_all_typ
-0001f960: 6573 2873 7465 7020 2c20 666c 6f61 742c  es(step , float,
-0001f970: 2069 6e74 202c 206f 626a 6e61 6d65 203d   int , objname =
-0001f980: 2753 7465 7027 2920 0d0a 2020 2020 2020  'Step') ..      
-0001f990: 2020 666f 7220 6969 2069 6e20 7261 6e67    for ii in rang
-0001f9a0: 6528 6c65 6e28 7465 7874 2929 3a20 0d0a  e(len(text)): ..
-0001f9b0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0001f9c0: 6f74 2069 6925 2073 7465 7020 3d3d 303a  ot ii% step ==0:
-0001f9d0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0001f9e0: 2020 2074 6578 745b 6969 5d3d 2727 0d0a     text[ii]=''..
-0001f9f0: 0d0a 2020 2020 6669 672c 2061 7820 3d20  ..    fig, ax = 
-0001fa00: 706c 742e 7375 6270 6c6f 7473 2831 2c31  plt.subplots(1,1
-0001fa10: 2c20 6669 6773 697a 6520 3d66 6967 5f73  , figsize =fig_s
-0001fa20: 697a 6529 0d0a 2020 2020 0d0a 2020 2020  ize)..    ..    
-0001fa30: 2320 706c 6f74 203d 2061 782e 7363 6174  # plot = ax.scat
-0001fa40: 7465 7220 6966 2073 686f 775f 6c69 6e65  ter if show_line
-0001fa50: 2065 6c73 6520 6178 2e70 6c6f 7420 0d0a   else ax.plot ..
-0001fa60: 2020 2020 6178 5f6d 203d 204e 6f6e 6520      ax_m = None 
-0001fa70: 0d0a 2020 2020 6966 2073 686f 775f 6c69  ..    if show_li
-0001fa80: 6e65 3a20 0d0a 2020 2020 2020 2020 6178  ne: ..        ax
-0001fa90: 2e70 6c6f 7420 2878 2c20 7920 2c20 6c61  .plot (x, y , la
-0001faa0: 6265 6c20 3d20 6c69 6e65 6c61 6265 6c2c  bel = linelabel,
-0001fab0: 2063 6f6c 6f72 203d 636f 6c6f 7220 0d0a   color =color ..
-0001fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fad0: 2029 200d 0a20 2020 2020 2020 200d 0a20   ) ..        .. 
-0001fae0: 2020 2066 6f72 2069 782c 2069 7920 2c20     for ix, iy , 
-0001faf0: 6e61 6d65 2069 6e20 7a69 7020 2878 2c20  name in zip (x, 
-0001fb00: 792c 2074 6578 7420 293a 200d 0a20 2020  y, text ): ..   
-0001fb10: 2020 2020 2061 782e 7465 7874 2028 2069       ax.text ( i
-0001fb20: 7820 2c20 6979 202c 206e 616d 6520 2c20  x , iy , name , 
-0001fb30: 2a2a 7465 7874 5f6b 7773 290d 0a20 2020  **text_kws)..   
-0001fb40: 2020 2020 2069 6620 6e61 6d65 2021 3d27       if name !='
-0001fb50: 273a 0d0a 2020 2020 2020 2020 2020 2061  ':..           a
-0001fb60: 785f 6d20 203d 2061 782e 7363 6174 7465  x_m  = ax.scatte
-0001fb70: 7220 2820 5b69 785d 2c20 5b69 795d 202c  r ( [ix], [iy] ,
-0001fb80: 206d 6172 6b65 7220 3d27 6f27 2c20 636f   marker ='o', co
-0001fb90: 6c6f 7220 3d27 6b27 2c20 0d0a 2020 2020  lor ='k', ..    
-0001fba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fbb0: 2020 2029 0d0a 2020 0d0a 2020 2020 6178     )..  ..    ax
-0001fbc0: 2e73 6574 5f78 6c61 6265 6c20 2878 6c61  .set_xlabel (xla
-0001fbd0: 6265 6c29 0d0a 2020 2020 6178 2e73 6574  bel)..    ax.set
-0001fbe0: 5f79 6c61 6265 6c20 2879 6c61 6265 6c29  _ylabel (ylabel)
-0001fbf0: 200d 0a20 2020 200d 0a20 2020 2061 785f   ..    ..    ax_
-0001fc00: 6d2e 7365 745f 6c61 6265 6c20 2820 6d61  m.set_label ( ma
-0001fc10: 726b 6572 6c61 6265 6c29 2069 6620 6178  rkerlabel) if ax
-0001fc20: 5f6d 2069 7320 6e6f 7420 4e6f 6e65 2065  _m is not None e
-0001fc30: 6c73 6520 4e6f 6e65 200d 0a20 2020 200d  lse None ..    .
-0001fc40: 0a20 2020 2069 6620 7368 6f77 5f6c 6567  .    if show_leg
-0001fc50: 203a 200d 0a20 2020 2020 2020 2061 782e   : ..        ax.
-0001fc60: 6c65 6765 6e64 2028 2920 0d0a 2020 2020  legend () ..    
-0001fc70: 0d0a 6465 6620 706c 6f74 5f76 6f72 6f6e  ..def plot_voron
-0001fc80: 6f69 280d 0a20 2020 2058 2c20 792c 202a  oi(..    X, y, *
-0001fc90: 2c20 0d0a 2020 2020 636c 7573 7465 725f  , ..    cluster_
-0001fca0: 6365 6e74 6572 732c 0d0a 2020 2020 6178  centers,..    ax
-0001fcb0: 3d20 4e6f 6e65 2c0d 0a20 2020 2073 686f  = None,..    sho
-0001fcc0: 775f 7665 7274 6963 6573 3d46 616c 7365  w_vertices=False
-0001fcd0: 2c20 0d0a 2020 2020 6c69 6e65 5f63 6f6c  , ..    line_col
-0001fce0: 6f72 733d 276b 272c 0d0a 2020 2020 6c69  ors='k',..    li
-0001fcf0: 6e65 5f77 6964 7468 3d31 2e20 2c0d 0a20  ne_width=1. ,.. 
-0001fd00: 2020 206c 696e 655f 616c 7068 613d 312e     line_alpha=1.
-0001fd10: 2c20 2020 0d0a 2020 2020 6669 675f 7369  ,   ..    fig_si
-0001fd20: 7a65 203d 2028 372c 2037 292c 200d 0a20  ze = (7, 7), .. 
-0001fd30: 2020 2066 6967 5f74 6974 6c65 203d 2027     fig_title = '
-0001fd40: 270d 0a20 2020 2029 3a0d 0a20 2020 2022  '..    ):..    "
-0001fd50: 2222 506c 6f74 7320 7468 6520 566f 726f  ""Plots the Voro
-0001fd60: 6e6f 6920 6469 6167 7261 6d20 6f66 2074  noi diagram of t
-0001fd70: 6865 206b 2d6d 6561 6e73 2063 6c75 7374  he k-means clust
-0001fd80: 6572 7320 6f76 6572 6c61 6964 2077 6974  ers overlaid wit
-0001fd90: 6820 0d0a 2020 2020 7468 6520 6461 7461  h ..    the data
-0001fda0: 0d0a 2020 2020 0d0a 2020 2020 5061 7261  ..    ..    Para
-0001fdb0: 6d65 7465 7273 200d 0a20 2020 202d 2d2d  meters ..    ---
-0001fdc0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 582c  --------..    X,
-0001fdd0: 2079 203a 204e 4461 7272 6179 2c20 4172   y : NDarray, Ar
-0001fde0: 7261 796c 696b 6520 3164 200d 0a20 2020  raylike 1d ..   
-0001fdf0: 2020 2044 6174 6120 7472 6169 6e69 6e67     Data training
-0001fe00: 2058 2061 6e64 2079 2e20 4d75 7374 2068   X and y. Must h
-0001fe10: 6176 6520 7468 6520 7361 6d65 206c 656e  ave the same len
-0001fe20: 6774 6820 0d0a 2020 2020 636c 7573 7465  gth ..    cluste
-0001fe30: 725f 6365 6e74 6572 3a20 696e 742c 200d  r_center: int, .
-0001fe40: 0a20 2020 2020 2020 436c 7573 7465 7220  .       Cluster 
-0001fe50: 6365 6e74 6572 2e20 436c 7573 7465 7220  center. Cluster 
-0001fe60: 6365 6e74 6572 2063 616e 2062 6520 6f62  center can be ob
-0001fe70: 7461 696e 2077 6974 6865 204b 4d65 616e  tain withe KMean
-0001fe80: 7320 616c 676f 7269 7468 6d73 200d 0a20  s algorithms .. 
-0001fe90: 2020 2073 686f 775f 7665 7274 6963 6573     show_vertices
-0001fea0: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
-0001feb0: 6c0d 0a20 2020 2020 2020 2041 6464 2074  l..        Add t
-0001fec0: 6865 2056 6f72 6f6e 6f69 2076 6572 7469  he Voronoi verti
-0001fed0: 6365 7320 746f 2074 6865 2070 6c6f 742e  ces to the plot.
-0001fee0: 0d0a 2020 2020 6c69 6e65 5f63 6f6c 6f72  ..    line_color
-0001fef0: 7320 3a20 7374 7269 6e67 2c20 6f70 7469  s : string, opti
-0001ff00: 6f6e 616c 0d0a 2020 2020 2020 2020 5370  onal..        Sp
-0001ff10: 6563 6966 6965 7320 7468 6520 6c69 6e65  ecifies the line
-0001ff20: 2063 6f6c 6f72 2066 6f72 2070 6f6c 7967   color for polyg
-0001ff30: 6f6e 2062 6f75 6e64 6172 6965 730d 0a20  on boundaries.. 
-0001ff40: 2020 206c 696e 655f 7769 6474 6820 3a20     line_width : 
-0001ff50: 666c 6f61 742c 206f 7074 696f 6e61 6c0d  float, optional.
-0001ff60: 0a20 2020 2020 2020 2053 7065 6369 6669  .        Specifi
-0001ff70: 6573 2074 6865 206c 696e 6520 7769 6474  es the line widt
-0001ff80: 6820 666f 7220 706f 6c79 676f 6e20 626f  h for polygon bo
-0001ff90: 756e 6461 7269 6573 0d0a 2020 2020 6c69  undaries..    li
-0001ffa0: 6e65 5f61 6c70 6861 203a 2066 6c6f 6174  ne_alpha : float
-0001ffb0: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-0001ffc0: 2020 2020 5370 6563 6966 6965 7320 7468      Specifies th
-0001ffd0: 6520 6c69 6e65 2061 6c70 6861 2066 6f72  e line alpha for
-0001ffe0: 2070 6f6c 7967 6f6e 2062 6f75 6e64 6172   polygon boundar
-0001fff0: 6965 730d 0a20 2020 2070 6f69 6e74 5f73  ies..    point_s
-00020000: 697a 6520 3a20 666c 6f61 742c 206f 7074  ize : float, opt
-00020010: 696f 6e61 6c0d 0a20 2020 2020 2020 2053  ional..        S
-00020020: 7065 6369 6669 6573 2074 6865 2073 697a  pecifies the siz
-00020030: 6520 6f66 2070 6f69 6e74 730d 0a20 2020  e of points..   
-00020040: 2061 783a 204d 6174 706c 6f74 6c69 622e   ax: Matplotlib.
-00020050: 4178 6573 200d 0a20 2020 2020 2020 4d61  Axes ..       Ma
-00020060: 706c 6f74 6c69 6220 6178 6573 2e20 4966  plotlib axes. If
-00020070: 2060 4e6f 6e65 602c 2061 2061 7869 7320   `None`, a axis 
-00020080: 6973 2063 7265 6174 6564 2069 6e73 7465  is created inste
-00020090: 6164 2e20 0d0a 2020 2020 2020 200d 0a20  ad. ..       .. 
-000200a0: 2020 2066 6967 5f73 697a 653a 2074 7570     fig_size: tup
-000200b0: 6c65 2c20 6465 6661 756c 7420 3d20 2837  le, default = (7
-000200c0: 2c20 3729 200d 0a20 2020 2020 2020 5369  , 7) ..       Si
-000200d0: 7a65 206f 6620 7468 6520 6669 6775 7265  ze of the figure
-000200e0: 732e 200d 0a20 2020 2020 2020 0d0a 2020  s. ..       ..  
-000200f0: 2020 5265 7475 726e 0d0a 2020 2020 2d2d    Return..    --
-00020100: 2d2d 2d2d 2d0d 0a20 2020 2061 783a 204d  -----..    ax: M
-00020110: 6174 706c 6f74 6c69 622e 4178 6573 200d  atplotlib.Axes .
-00020120: 0a20 2020 2020 2020 4178 6573 2074 6f20  .       Axes to 
-00020130: 7375 7070 6f72 7420 7468 6520 6669 6775  support the figu
-00020140: 7265 0d0a 2020 2020 2020 200d 0a20 2020  re..       ..   
-00020150: 2045 7861 6d70 6c65 7320 0d0a 2020 2020   Examples ..    
-00020160: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 203e  ---------..    >
-00020170: 3e3e 2066 726f 6d20 736b 6c65 6172 6e2e  >> from sklearn.
-00020180: 6461 7461 7365 7473 2069 6d70 6f72 7420  datasets import 
-00020190: 6d61 6b65 5f6d 6f6f 6e73 0d0a 2020 2020  make_moons..    
-000201a0: 3e3e 3e20 6672 6f6d 2073 6b6c 6561 726e  >>> from sklearn
-000201b0: 2e63 6c75 7374 6572 2069 6d70 6f72 7420  .cluster import 
-000201c0: 4b4d 6561 6e73 200d 0a20 2020 203e 3e3e  KMeans ..    >>>
-000201d0: 2066 726f 6d20 7761 7465 782e 7574 696c   from watex.util
-000201e0: 732e 706c 6f74 7574 696c 7320 696d 706f  s.plotutils impo
-000201f0: 7274 2070 6c6f 745f 766f 726f 6e6f 690d  rt plot_voronoi.
-00020200: 0a20 2020 203e 3e3e 2058 2c20 7920 3d20  .    >>> X, y = 
-00020210: 6d61 6b65 5f6d 6f6f 6e73 286e 5f73 616d  make_moons(n_sam
-00020220: 706c 6573 3d32 3030 302c 206e 6f69 7365  ples=2000, noise
-00020230: 3d30 2e32 290d 0a20 2020 203e 3e3e 206b  =0.2)..    >>> k
-00020240: 6d20 3d20 4b4d 6561 6e73 2028 6e5f 696e  m = KMeans (n_in
-00020250: 6974 203d 2761 7574 6f27 292e 6669 7428  it ='auto').fit(
-00020260: 582c 2079 2029 200d 0a20 2020 203e 3e3e  X, y ) ..    >>>
-00020270: 2070 6c6f 745f 766f 726f 6e6f 6920 2820   plot_voronoi ( 
-00020280: 582c 2079 202c 2063 6c75 7374 6572 5f63  X, y , cluster_c
-00020290: 656e 7465 7273 203d 206b 6d2e 636c 7573  enters = km.clus
-000202a0: 7465 725f 6365 6e74 6572 735f 2920 0d0a  ter_centers_) ..
-000202b0: 2020 2020 2222 220d 0a20 2020 2058 2c20      """..    X, 
-000202c0: 7920 3d20 6368 6563 6b5f 585f 7928 582c  y = check_X_y(X,
-000202d0: 2079 2c20 290d 0a20 2020 2063 6c75 7374   y, )..    clust
-000202e0: 6572 5f63 656e 7465 7273 203d 2063 6865  er_centers = che
-000202f0: 636b 5f61 7272 6179 2863 6c75 7374 6572  ck_array(cluster
-00020300: 5f63 656e 7465 7273 2029 0d0a 2020 2020  _centers )..    
-00020310: 0d0a 2020 2020 6966 2061 7820 6973 204e  ..    if ax is N
-00020320: 6f6e 653a 200d 0a20 2020 2020 2020 2066  one: ..        f
-00020330: 6967 2c20 6178 203d 2070 6c74 2e73 7562  ig, ax = plt.sub
-00020340: 706c 6f74 7328 312c 312c 2066 6967 7369  plots(1,1, figsi
-00020350: 7a65 203d 6669 675f 7369 7a65 290d 0a20  ze =fig_size).. 
-00020360: 2020 2020 2020 200d 0a20 2020 2066 726f         ..    fro
-00020370: 6d20 7363 6970 792e 7370 6174 6961 6c20  m scipy.spatial 
-00020380: 696d 706f 7274 2056 6f72 6f6e 6f69 2c20  import Voronoi, 
-00020390: 766f 726f 6e6f 695f 706c 6f74 5f32 640d  voronoi_plot_2d.
-000203a0: 0a20 2020 200d 0a20 2020 2061 782e 7363  .    ..    ax.sc
-000203b0: 6174 7465 7228 585b 3a2c 2030 5d2c 2058  atter(X[:, 0], X
-000203c0: 5b3a 2c20 315d 2c20 633d 792c 2063 6d61  [:, 1], c=y, cma
-000203d0: 703d 2753 6574 3127 2c20 616c 7068 613d  p='Set1', alpha=
-000203e0: 302e 322c 200d 0a20 2020 2020 2020 2020  0.2, ..         
-000203f0: 2020 2020 2020 6c61 6265 6c20 3d20 2756        label = 'V
-00020400: 6f72 6f6e 6f69 2070 6c6f 7427 290d 0a20  oronoi plot').. 
-00020410: 2020 2076 6f72 203d 2056 6f72 6f6e 6f69     vor = Voronoi
-00020420: 2863 6c75 7374 6572 5f63 656e 7465 7273  (cluster_centers
-00020430: 290d 0a20 2020 2076 6f72 6f6e 6f69 5f70  )..    voronoi_p
-00020440: 6c6f 745f 3264 2876 6f72 2c20 6178 3d61  lot_2d(vor, ax=a
-00020450: 782c 2073 686f 775f 7665 7274 6963 6573  x, show_vertices
-00020460: 3d73 686f 775f 7665 7274 6963 6573 2c20  =show_vertices, 
-00020470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00020480: 2020 2020 2020 616c 7068 613d 302e 352c        alpha=0.5,
-00020490: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000204a0: 2020 2020 2020 206c 696e 655f 636f 6c6f         line_colo
-000204b0: 7273 3d6c 696e 655f 636f 6c6f 7273 2c0d  rs=line_colors,.
-000204c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000204d0: 2020 2020 206c 696e 655f 7769 6474 683d       line_width=
-000204e0: 6c69 6e65 5f77 6964 7468 202c 0d0a 2020  line_width ,..  
-000204f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020500: 2020 6c69 6e65 5f61 6c70 6861 3d6c 696e    line_alpha=lin
-00020510: 655f 616c 7068 612c 2020 0d0a 2020 2020  e_alpha,  ..    
-00020520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020530: 290d 0a20 2020 2023 6178 2e6c 6567 656e  )..    #ax.legen
-00020540: 6428 2920 0d0a 2020 2020 6178 2e73 6574  d() ..    ax.set
-00020550: 5f74 6974 6c65 2028 6669 675f 7469 746c  _title (fig_titl
-00020560: 6520 2c20 666f 6e74 7369 7a65 3d32 3029  e , fontsize=20)
-00020570: 0d0a 2020 2020 2366 6967 2e73 7570 7469  ..    #fig.supti
-00020580: 746c 6528 6669 675f 7469 746c 652c 2066  tle(fig_title, f
-00020590: 6f6e 7473 697a 653d 3230 2920 0d0a 2020  ontsize=20) ..  
-000205a0: 2020 0d0a 2020 2020 7265 7475 726e 2061    ..    return a
-000205b0: 7820 0d0a 200d 0a20 2020 200d 0a64 6566  x .. ..    ..def
-000205c0: 205f 6d61 6b65 5f61 7865 5f6d 756c 7469   _make_axe_multi
-000205d0: 706c 6520 2820 6e2c 206e 636f 6c73 203d  ple ( n, ncols =
-000205e0: 2033 202c 2066 6967 5f73 697a 6520 3d4e   3 , fig_size =N
-000205f0: 6f6e 652c 2066 6967 203d 4e6f 6e65 2c20  one, fig =None, 
-00020600: 6178 3d20 2e2e 2e20 293a 200d 0a20 2020  ax= ... ): ..   
-00020610: 2022 2222 204d 616b 6520 6d75 6c74 6970   """ Make multip
-00020620: 6c65 2073 7562 706c 6f74 2061 7865 7320  le subplot axes 
-00020630: 6672 6f6d 206e 756d 6265 7220 6f66 206f  from number of o
-00020640: 626a 6563 7473 2e20 2222 220d 0a20 2020  bjects. """..   
-00020650: 2069 6620 6973 5f69 7465 7261 626c 6520   if is_iterable 
-00020660: 286e 293a 200d 0a20 2020 2020 2020 6e20  (n): ..       n 
-00020670: 3d20 6c65 6e28 6e29 200d 0a20 2020 2020  = len(n) ..     
-00020680: 0d0a 2020 2020 6e72 6f77 7320 3d20 6e20  ..    nrows = n 
-00020690: 2f2f 206e 636f 6c73 202b 2028 206e 2025  // ncols + ( n %
-000206a0: 206e 636f 6c73 2029 200d 0a20 2020 2069   ncols ) ..    i
-000206b0: 6620 6e72 6f77 7320 3d3d 303a 200d 0a20  f nrows ==0: .. 
-000206c0: 2020 2020 2020 6e72 6f77 7320 3d31 200d        nrows =1 .
-000206d0: 0a20 2020 2020 2020 0d0a 2020 2020 6966  .       ..    if
-000206e0: 2061 7820 696e 2028 202e 2e2e 202c 204e   ax in ( ... , N
-000206f0: 6f6e 6529 203a 200d 0a20 2020 2020 2020  one) : ..       
-00020700: 2066 6967 2c20 6178 203d 2070 6c74 2e73   fig, ax = plt.s
-00020710: 7562 706c 6f74 7320 286e 726f 7773 2c20  ubplots (nrows, 
-00020720: 6e63 6f6c 732c 2066 6967 7369 7a65 203d  ncols, figsize =
-00020730: 2066 6967 5f73 697a 6520 2920 200d 0a20   fig_size )  .. 
-00020740: 2020 200d 0a20 2020 2072 6574 7572 6e20     ..    return 
-00020750: 6669 6720 2c20 6178 200d 0a20 2020 200d  fig , ax ..    .
-00020760: 0a64 6566 2070 6c6f 745f 726f 635f 6375  .def plot_roc_cu
-00020770: 7276 6573 2028 0d0a 2020 2063 6c66 732c  rves (..   clfs,
-00020780: 202f 2c20 0d0a 2020 2058 2c20 792c 200d   /, ..   X, y, .
-00020790: 0a20 2020 6e61 6d65 7320 3d2e 2e2e 2c20  .   names =..., 
-000207a0: 0d0a 2020 2063 6f6c 6f72 7320 3d2e 2e2e  ..   colors =...
-000207b0: 2c20 0d0a 2020 206e 636f 6c73 203d 2033  , ..   ncols = 3
-000207c0: 2c20 0d0a 2020 2061 6c6c 3d46 616c 7365  , ..   all=False
-000207d0: 2c0d 0a20 2020 6178 203d 204e 6f6e 652c  ,..   ax = None,
-000207e0: 2020 0d0a 2020 2066 6967 5f73 697a 653d    ..   fig_size=
-000207f0: 2820 372c 2037 292c 200d 0a20 2020 2a2a  ( 7, 7), ..   **
-00020800: 726f 635f 6b77 7320 293a 200d 0a20 2020  roc_kws ): ..   
-00020810: 2022 2222 2051 7569 636b 2070 6c6f 7420   """ Quick plot 
-00020820: 6f66 2052 6563 6569 7669 6e67 204f 7065  of Receiving Ope
-00020830: 7261 7469 6e67 2043 6861 7261 6374 6572  rating Character
-00020840: 6973 6374 6963 2028 524f 4329 206f 6620  isctic (ROC) of 
-00020850: 6669 7474 6564 206d 6f64 656c 7320 0d0a  fitted models ..
-00020860: 2020 2020 0d0a 2020 2020 5061 7261 6d65      ..    Parame
-00020870: 7465 7273 200d 0a20 2020 202d 2d2d 2d2d  ters ..    -----
-00020880: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2063 6c66  -------..    clf
-00020890: 733a 206c 6973 742c 200d 0a20 2020 2020  s: list, ..     
-000208a0: 2020 6c69 7374 206f 6620 6d6f 6465 6c73    list of models
-000208b0: 2066 6f72 2052 4f43 2065 7661 6c75 6174   for ROC evaluat
-000208c0: 696f 6e2e 204d 6f64 656c 2073 686f 756c  ion. Model shoul
-000208d0: 6420 6265 2061 2073 6369 6b69 742d 6c65  d be a scikit-le
-000208e0: 6172 6e20 0d0a 2020 2020 2020 206f 7220  arn ..       or 
-000208f0: 2058 4742 6f6f 7374 2065 7374 696d 6174   XGBoost estimat
-00020900: 6f72 7320 0d0a 2020 2020 2020 200d 0a20  ors ..       .. 
-00020910: 2020 2058 203a 207b 6172 7261 792d 6c69     X : {array-li
-00020920: 6b65 2c20 7370 6172 7365 206d 6174 7269  ke, sparse matri
-00020930: 787d 206f 6620 7368 6170 6520 286e 5f73  x} of shape (n_s
-00020940: 616d 706c 6573 2c20 6e5f 6665 6174 7572  amples, n_featur
-00020950: 6573 290d 0a20 2020 2020 2020 2054 7261  es)..        Tra
-00020960: 696e 696e 6720 696e 7374 616e 6365 7320  ining instances 
-00020970: 746f 2063 6c75 7374 6572 2e20 4974 206d  to cluster. It m
-00020980: 7573 7420 6265 206e 6f74 6564 2074 6861  ust be noted tha
-00020990: 7420 7468 6520 6461 7461 0d0a 2020 2020  t the data..    
-000209a0: 2020 2020 7769 6c6c 2062 6520 636f 6e76      will be conv
-000209b0: 6572 7465 6420 746f 2043 206f 7264 6572  erted to C order
-000209c0: 696e 672c 2077 6869 6368 2077 696c 6c20  ing, which will 
-000209d0: 6361 7573 6520 6120 6d65 6d6f 7279 0d0a  cause a memory..
-000209e0: 2020 2020 2020 2020 636f 7079 2069 6620          copy if 
-000209f0: 7468 6520 6769 7665 6e20 6461 7461 2069  the given data i
-00020a00: 7320 6e6f 7420 432d 636f 6e74 6967 756f  s not C-contiguo
-00020a10: 7573 2e0d 0a20 2020 2020 2020 2049 6620  us...        If 
-00020a20: 6120 7370 6172 7365 206d 6174 7269 7820  a sparse matrix 
-00020a30: 6973 2070 6173 7365 642c 2061 2063 6f70  is passed, a cop
-00020a40: 7920 7769 6c6c 2062 6520 6d61 6465 2069  y will be made i
-00020a50: 6620 6974 2773 206e 6f74 2069 6e0d 0a20  f it's not in.. 
-00020a60: 2020 2020 2020 2043 5352 2066 6f72 6d61         CSR forma
-00020a70: 742e 0d0a 2020 2020 0d0a 2020 2020 7920  t...    ..    y 
-00020a80: 3a20 6e64 6172 7261 7920 6f72 2053 6572  : ndarray or Ser
-00020a90: 6965 7320 6f66 206c 656e 6774 6820 286e  ies of length (n
-00020aa0: 5f73 616d 706c 6573 2c20 290d 0a20 2020  _samples, )..   
-00020ab0: 2020 2020 2041 6e20 6172 7261 7920 6f72       An array or
-00020ac0: 2073 6572 6965 7320 6f66 2074 6172 6765   series of targe
-00020ad0: 7420 6f72 2063 6c61 7373 2076 616c 7565  t or class value
-00020ae0: 732e 2050 7265 6665 7261 626c 792c 2074  s. Preferably, t
-00020af0: 6865 2061 7272 6179 200d 0a20 2020 2020  he array ..     
-00020b00: 2020 2072 6570 7265 7365 6e74 2074 6865     represent the
-00020b10: 2074 6573 7420 636c 6173 7320 6c61 6265   test class labe
-00020b20: 6c73 2064 6174 6120 666f 7220 6572 726f  ls data for erro
-00020b30: 7220 6576 616c 7561 7469 6f6e 2e20 200d  r evaluation.  .
-00020b40: 0a20 2020 200d 0a20 2020 2063 6f6c 6f72  .    ..    color
-00020b50: 7320 3a20 7374 722c 206c 6973 7420 0d0a  s : str, list ..
-00020b60: 2020 2020 2020 2043 6f6c 6f72 7320 746f         Colors to
-00020b70: 2073 7065 6369 6679 2065 6163 6820 6d6f   specify each mo
-00020b80: 6465 6c20 706c 6f74 2e20 0d0a 2020 2020  del plot. ..    
-00020b90: 2020 200d 0a20 2020 206e 636f 6c73 3a20     ..    ncols: 
-00020ba0: 696e 742c 2064 6566 6175 6c74 3d33 200d  int, default=3 .
-00020bb0: 0a20 2020 2020 2020 4e75 6d62 6572 206f  .       Number o
-00020bc0: 6620 706c 6f74 2074 6f20 6265 2070 6c61  f plot to be pla
-00020bd0: 6365 6420 696e 6c69 6e65 2062 6566 6f72  ced inline befor
-00020be0: 6520 736b 6970 7069 6e67 2074 6f20 7468  e skipping to th
-00020bf0: 6520 6e65 7874 2063 6f6c 756d 6e2e 200d  e next column. .
-00020c00: 0a20 2020 2020 2020 5468 6973 2069 7320  .       This is 
-00020c10: 6665 6173 6962 6c65 2069 6620 606d 616e  feasible if `man
-00020c20: 7960 2069 7320 7365 7420 746f 2060 6054  y` is set to ``T
-00020c30: 7275 6560 602e 200d 0a20 2020 2020 2020  rue``. ..       
-00020c40: 0d0a 2020 2020 616c 6c3a 2073 7472 2c20  ..    all: str, 
-00020c50: 6465 6661 756c 743d 4661 6c73 6520 0d0a  default=False ..
-00020c60: 2020 2020 2020 2069 6620 6060 5472 7565         if ``True
-00020c70: 6060 2c20 706c 6f74 2065 6163 6820 524f  ``, plot each RO
-00020c80: 4320 6d6f 6465 6c20 7365 7061 7261 7465  C model separate
-00020c90: 6c79 200d 0a20 2020 2020 0d0a 2020 2020  ly ..     ..    
-00020ca0: 6e61 6d65 733a 206c 6973 742c 200d 0a20  names: list, .. 
-00020cb0: 2020 2020 2020 4c69 7374 206f 6620 6d6f        List of mo
-00020cc0: 6465 6c20 6e61 6d65 732e 2049 6620 6e6f  del names. If no
-00020cd0: 7420 6769 7665 6e2c 2061 2072 6177 206e  t given, a raw n
-00020ce0: 616d 6520 6f66 2074 6865 206d 6f64 656c  ame of the model
-00020cf0: 2069 7320 7061 7373 6564 200d 0a20 2020   is passed ..   
-00020d00: 2020 2020 696e 7374 6561 642e 0d0a 2020      instead...  
-00020d10: 2020 2020 200d 0a20 2020 206b 7773 3a20       ..    kws: 
-00020d20: 6469 6374 2c0d 0a20 2020 2020 2020 206b  dict,..        k
-00020d30: 6579 776f 7264 2061 7267 756d 656e 7420  eyword argument 
-00020d40: 6f66 203a 6675 6e63 3a60 736b 6c65 6172  of :func:`sklear
-00020d50: 6e2e 6d65 7472 6963 732e 726f 635f 6375  n.metrics.roc_cu
-00020d60: 7276 6520 0d0a 2020 2020 2020 2020 0d0a  rve ..        ..
-00020d70: 2020 2020 5265 7475 726e 0d0a 2020 2020      Return..    
-00020d80: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2061 783a  -------..    ax:
-00020d90: 2041 7865 732e 5375 6270 6c6f 742e 200d   Axes.Subplot. .
-00020da0: 0a20 2020 200d 0a20 2020 2045 7861 6d70  .    ..    Examp
-00020db0: 6c65 7320 0d0a 2020 2020 2d2d 2d2d 2d2d  les ..    ------
-00020dc0: 2d2d 0d0a 2020 2020 3e3e 3e20 6672 6f6d  --..    >>> from
-00020dd0: 2077 6174 6578 2e75 7469 6c73 2e70 6c6f   watex.utils.plo
-00020de0: 7475 7469 6c73 2069 6d70 6f72 7420 706c  tutils import pl
-00020df0: 6f74 5f72 6f63 5f63 7572 7665 7320 0d0a  ot_roc_curves ..
-00020e00: 2020 2020 3e3e 3e20 6672 6f6d 2073 6b6c      >>> from skl
-00020e10: 6561 726e 2e64 6174 6173 6574 7320 696d  earn.datasets im
-00020e20: 706f 7274 206d 616b 655f 6d6f 6f6e 7320  port make_moons 
-00020e30: 0d0a 2020 2020 3e3e 3e20 6672 6f6d 2077  ..    >>> from w
-00020e40: 6174 6578 2e65 786c 6962 2069 6d70 6f72  atex.exlib impor
-00020e50: 7420 7472 6169 6e5f 7465 7374 5f73 706c  t train_test_spl
-00020e60: 6974 2c20 4b4e 6569 6768 626f 7273 436c  it, KNeighborsCl
-00020e70: 6173 7369 6669 6572 2c20 5356 4320 2c0d  assifier, SVC ,.
-00020e80: 0a20 2020 2058 4742 436c 6173 7369 6669  .    XGBClassifi
-00020e90: 6572 2c20 4c6f 6769 7374 6963 5265 6772  er, LogisticRegr
-00020ea0: 6573 7369 6f6e 200d 0a20 2020 203e 3e3e  ession ..    >>>
-00020eb0: 2058 2c20 7920 3d20 6d61 6b65 5f6d 6f6f   X, y = make_moo
-00020ec0: 6e73 2028 6e5f 7361 6d70 6c65 733d 3230  ns (n_samples=20
-00020ed0: 3030 2c20 6e6f 6973 653d 302e 3229 0d0a  00, noise=0.2)..
-00020ee0: 2020 2020 3e3e 3e20 582c 2058 742c 2079      >>> X, Xt, y
-00020ef0: 2c20 7974 203d 2074 7261 696e 5f74 6573  , yt = train_tes
-00020f00: 745f 7370 6c69 7420 2858 2c20 792c 2074  t_split (X, y, t
-00020f10: 6573 745f 7369 7a65 3d30 2e32 2920 0d0a  est_size=0.2) ..
-00020f20: 2020 2020 3e3e 3e20 636c 6673 203d 205b      >>> clfs = [
-00020f30: 206d 2829 2e66 6974 2858 2c20 7929 2066   m().fit(X, y) f
-00020f40: 6f72 206d 2069 6e20 2820 4b4e 6569 6768  or m in ( KNeigh
-00020f50: 626f 7273 436c 6173 7369 6669 6572 2c20  borsClassifier, 
-00020f60: 5356 4320 2c20 0d0a 2020 2020 2020 2020  SVC , ..        
-00020f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f90: 2058 4742 436c 6173 7369 6669 6572 2c20   XGBClassifier, 
-00020fa0: 4c6f 6769 7374 6963 5265 6772 6573 7369  LogisticRegressi
-00020fb0: 6f6e 295d 0d0a 2020 2020 3e3e 3e20 706c  on)]..    >>> pl
-00020fc0: 6f74 5f72 6f63 5f63 7572 7665 7328 636c  ot_roc_curves(cl
-00020fd0: 6673 2c20 5874 2c20 7974 290d 0a20 2020  fs, Xt, yt)..   
-00020fe0: 204f 7574 5b36 365d 3a20 3c41 7865 7353   Out[66]: <AxesS
-00020ff0: 7562 706c 6f74 3a78 6c61 6265 6c3d 2746  ubplot:xlabel='F
-00021000: 616c 7365 2050 6f73 6974 6976 6520 5261  alse Positive Ra
-00021010: 7465 2028 4650 5229 272c 2079 6c61 6265  te (FPR)', ylabe
-00021020: 6c3d 2754 7275 6520 506f 7369 7469 7665  l='True Positive
-00021030: 2052 6174 6520 2846 5052 2927 3e0d 0a20   Rate (FPR)'>.. 
-00021040: 2020 203e 3e3e 2070 6c6f 745f 726f 635f     >>> plot_roc_
-00021050: 6375 7276 6573 2863 6c66 732c 2058 742c  curves(clfs, Xt,
-00021060: 2079 742c 616c 6c3d 5472 7565 2c20 6e63   yt,all=True, nc
-00021070: 6f6c 7320 3d20 3420 2c20 6669 675f 7369  ols = 4 , fig_si
-00021080: 7a65 203d 2028 3130 2c20 3429 290d 0a20  ze = (10, 4)).. 
-00021090: 2020 2022 2222 0d0a 2020 2020 6672 6f6d     """..    from
-000210a0: 202e 7661 6c69 6461 746f 7220 696d 706f   .validator impo
-000210b0: 7274 2020 6765 745f 6573 7469 6d61 746f  rt  get_estimato
-000210c0: 725f 6e61 6d65 0d0a 2020 2020 0d0a 2020  r_name..    ..  
-000210d0: 2020 6465 6620 706c 6f74 5f72 6f63 286d    def plot_roc(m
-000210e0: 6f64 656c 2c20 6461 7461 2c20 6c61 6265  odel, data, labe
-000210f0: 6c73 293a 0d0a 2020 2020 2020 2020 6966  ls):..        if
-00021100: 2068 6173 6174 7472 286d 6f64 656c 2c20   hasattr(model, 
-00021110: 2264 6563 6973 696f 6e5f 6675 6e63 7469  "decision_functi
-00021120: 6f6e 2229 3a0d 0a20 2020 2020 2020 2020  on"):..         
-00021130: 2020 2070 7265 6469 6374 696f 6e73 203d     predictions =
-00021140: 206d 6f64 656c 2e64 6563 6973 696f 6e5f   model.decision_
-00021150: 6675 6e63 7469 6f6e 2864 6174 6129 0d0a  function(data)..
-00021160: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00021170: 2020 2020 2020 2020 2020 2070 7265 6469             predi
-00021180: 6374 696f 6e73 203d 206d 6f64 656c 2e70  ctions = model.p
-00021190: 7265 6469 6374 5f70 726f 6261 2864 6174  redict_proba(dat
-000211a0: 6129 5b3a 2c31 5d0d 0a20 2020 2020 2020  a)[:,1]..       
-000211b0: 2020 2020 200d 0a20 2020 2020 2020 2066       ..        f
-000211c0: 7072 2c20 7470 722c 205f 203d 2072 6f63  pr, tpr, _ = roc
-000211d0: 5f63 7572 7665 286c 6162 656c 732c 2070  _curve(labels, p
-000211e0: 7265 6469 6374 696f 6e73 2c20 2a2a 726f  redictions, **ro
-000211f0: 635f 6b77 7320 290d 0a20 2020 2020 2020  c_kws )..       
-00021200: 200d 0a20 2020 2020 2020 2072 6574 7572   ..        retur
-00021210: 6e20 6670 722c 2074 7072 0d0a 2020 2020  n fpr, tpr..    
-00021220: 0d0a 2020 2020 6966 206e 6f74 2069 735f  ..    if not is_
-00021230: 6974 6572 6162 6c65 2028 2063 6c66 7329  iterable ( clfs)
-00021240: 3a20 0d0a 2020 2020 2020 2063 6c66 7320  : ..       clfs 
-00021250: 3d20 6973 5f69 7465 7261 626c 6520 2820  = is_iterable ( 
-00021260: 636c 6673 2c20 6578 636c 7564 655f 7374  clfs, exclude_st
-00021270: 7269 6e67 203d 5472 7565 202c 2074 7261  ring =True , tra
-00021280: 6e73 666f 726d 203d 5472 7565 2029 200d  nsform =True ) .
-00021290: 0a20 2020 2020 2020 0d0a 2020 2020 2320  .       ..    # 
-000212a0: 6d61 6b65 2064 6566 6175 6c74 5f63 6f6c  make default_col
-000212b0: 6f72 7320 0d0a 2020 2020 636f 6c6f 7273  ors ..    colors
-000212c0: 203d 206d 616b 655f 706c 6f74 5f63 6f6c   = make_plot_col
-000212d0: 6f72 7328 636c 6673 2c20 636f 6c6f 7273  ors(clfs, colors
-000212e0: 203d 2063 6f6c 6f72 7320 290d 0a20 2020   = colors )..   
-000212f0: 2023 2073 6176 6520 7468 6520 6e61 6d65   # save the name
-00021300: 206f 6620 6d6f 6465 6c73 200d 0a20 2020   of models ..   
-00021310: 206e 616d 6573 203d 206d 616b 655f 6f62   names = make_ob
-00021320: 6a5f 636f 6e73 6973 7465 6e74 5f69 6620  j_consistent_if 
-00021330: 2820 6e61 6d65 7320 2c20 5b20 6765 745f  ( names , [ get_
-00021340: 6573 7469 6d61 746f 725f 6e61 6d65 286d  estimator_name(m
-00021350: 2920 666f 7220 6d20 696e 2063 6c66 7320  ) for m in clfs 
-00021360: 5d29 200d 0a0d 0a20 2020 2023 2063 6865  ]) ....    # che
-00021370: 636b 2077 6865 7468 6572 2074 6865 206d  ck whether the m
-00021380: 6f64 656c 2069 7320 6669 7474 6564 200d  odel is fitted .
-00021390: 0a20 2020 2069 6620 616c 6c3a 200d 0a20  .    if all: .. 
-000213a0: 2020 2020 2020 2066 6967 2c20 6178 203d         fig, ax =
-000213b0: 205f 6d61 6b65 5f61 7865 5f6d 756c 7469   _make_axe_multi
-000213c0: 706c 6520 2820 636c 6673 2c20 6e63 6f6c  ple ( clfs, ncol
-000213d0: 7320 3d20 6e63 6f6c 7320 2c20 6178 203d  s = ncols , ax =
-000213e0: 2061 782c 2066 6967 5f73 697a 6520 3d20   ax, fig_size = 
-000213f0: 6669 675f 7369 7a65 200d 0a20 2020 2020  fig_size ..     
-00021400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021410: 2020 2020 2020 2020 2020 2020 2029 200d               ) .
-00021420: 0a20 2020 2020 2020 200d 0a20 2020 2065  .        ..    e
-00021430: 6c73 653a 200d 0a20 2020 2020 2020 2069  lse: ..        i
-00021440: 6620 6178 2069 7320 4e6f 6e65 3a20 0d0a  f ax is None: ..
-00021450: 2020 2020 2020 2020 2020 2020 6669 672c              fig,
-00021460: 2061 7820 3d20 706c 742e 7375 6270 6c6f   ax = plt.subplo
-00021470: 7473 2028 312c 2031 2c20 6669 6773 697a  ts (1, 1, figsiz
-00021480: 6520 3d20 6669 675f 7369 7a65 2029 2020  e = fig_size )  
-00021490: 0d0a 2020 2020 0d0a 2020 2020 666f 7220  ..    ..    for 
-000214a0: 6b2c 2028 206d 6f64 656c 2c20 6e61 6d65  k, ( model, name
-000214b0: 2920 2069 6e20 656e 756d 6572 6174 6520  )  in enumerate 
-000214c0: 287a 6970 2028 636c 6673 2c20 6e61 6d65  (zip (clfs, name
-000214d0: 7320 2929 3a20 0d0a 2020 2020 2020 2020  s )): ..        
-000214e0: 6368 6563 6b5f 6973 5f66 6974 7465 6428  check_is_fitted(
-000214f0: 6d6f 6465 6c20 290d 0a20 2020 2020 2020  model )..       
-00021500: 2066 7072 2c20 7470 7220 3d20 706c 6f74   fpr, tpr = plot
-00021510: 5f72 6f63 286d 6f64 656c 2c20 582c 2079  _roc(model, X, y
-00021520: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
-00021530: 6861 7361 7474 7220 2861 782c 2027 5f5f  hasattr (ax, '__
-00021540: 6c65 6e5f 5f27 293a 200d 0a20 2020 2020  len__'): ..     
-00021550: 2020 2020 2020 2069 6620 6c65 6e28 6178         if len(ax
-00021560: 2e73 6861 7065 293e 313a 200d 0a20 2020  .shape)>1: ..   
-00021570: 2020 2020 2020 2020 2020 2020 2069 2c20               i, 
-00021580: 6a20 203d 2020 6b20 2f2f 206e 636f 6c73  j  =  k // ncols
-00021590: 202c 206b 2025 206e 636f 6c73 200d 0a20   , k % ncols .. 
-000215a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000215b0: 7865 203d 2061 7820 5b69 2c20 6a5d 0d0a  xe = ax [i, j]..
-000215c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000215d0: 3a20 6178 6520 3d20 6178 5b6b 5d0d 0a20  : axe = ax[k].. 
-000215e0: 2020 2020 2020 2065 6c73 653a 2061 7865         else: axe
-000215f0: 203d 2061 7820 0d0a 2020 2020 2020 2020   = ax ..        
-00021600: 2020 2020 0d0a 0d0a 2020 2020 2020 2020      ....        
-00021610: 6178 652e 706c 6f74 2866 7072 2c20 7470  axe.plot(fpr, tp
-00021620: 722c 206c 6162 656c 3d6e 616d 652c 2063  r, label=name, c
-00021630: 6f6c 6f72 203d 2063 6f6c 6f72 735b 6b5d  olor = colors[k]
-00021640: 2020 290d 0a20 2020 2020 2020 200d 0a20    )..        .. 
-00021650: 2020 2020 2020 2069 6620 616c 6c3a 200d         if all: .
-00021660: 0a20 2020 2020 2020 2020 2020 2061 7865  .            axe
-00021670: 2e70 6c6f 7428 5b30 2c20 315d 2c20 5b30  .plot([0, 1], [0
-00021680: 2c20 315d 2c20 276b 2d2d 2729 200d 0a20  , 1], 'k--') .. 
-00021690: 2020 2020 2020 2020 2020 2061 7865 2e6c             axe.l
-000216a0: 6567 656e 6420 2829 0d0a 2020 2020 2020  egend ()..      
-000216b0: 2020 2020 2020 6178 652e 7365 745f 786c        axe.set_xl
-000216c0: 6162 656c 2028 2246 616c 7365 2050 6f73  abel ("False Pos
-000216d0: 6974 6976 6520 5261 7465 2028 4650 5229  itive Rate (FPR)
-000216e0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-000216f0: 6178 652e 7365 745f 796c 6162 656c 2028  axe.set_ylabel (
-00021700: 2254 7275 6520 506f 7369 7469 7665 2052  "True Positive R
-00021710: 6174 6520 2846 5052 2922 290d 0a20 2020  ate (FPR)")..   
-00021720: 2020 2020 2023 2065 6c73 653a 200d 0a20       # else: .. 
-00021730: 2020 2020 2020 2023 2020 2020 2061 782e         #     ax.
-00021740: 706c 6f74 2866 7072 2c20 7470 722c 206c  plot(fpr, tpr, l
-00021750: 6162 656c 3d6e 616d 652c 2063 6f6c 6f72  abel=name, color
-00021760: 203d 2063 6f6c 6f72 735b 6b5d 290d 0a20   = colors[k]).. 
-00021770: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00021780: 2069 6620 6e6f 7420 616c 6c3a 200d 0a20   if not all: .. 
-00021790: 2020 2020 2020 2061 782e 706c 6f74 285b         ax.plot([
-000217a0: 302c 2031 5d2c 205b 302c 2031 5d2c 2027  0, 1], [0, 1], '
-000217b0: 6b2d 2d27 2920 2320 4155 4320 3d2e 3520  k--') # AUC =.5 
-000217c0: 0d0a 2020 2020 2020 2020 6178 2e73 6574  ..        ax.set
-000217d0: 5f78 6c61 6265 6c20 2822 4661 6c73 6520  _xlabel ("False 
-000217e0: 506f 7369 7469 7665 2052 6174 6520 2846  Positive Rate (F
-000217f0: 5052 2922 290d 0a20 2020 2020 2020 2061  PR)")..        a
-00021800: 782e 7365 745f 796c 6162 656c 2028 2254  x.set_ylabel ("T
-00021810: 7275 6520 506f 7369 7469 7665 2052 6174  rue Positive Rat
-00021820: 6520 2846 5052 2922 290d 0a20 2020 2020  e (FPR)")..     
-00021830: 2020 2061 782e 6c65 6765 6e64 2829 200d     ax.legend() .
-00021840: 0a20 2020 2020 2020 200d 0a20 2020 2072  .        ..    r
-00021850: 6574 7572 6e20 6178 200d 0a20 2020 2020  eturn ax ..     
-00021860: 2020 200d 0a0d 0a20 2020 200d 0a20 200d     ....    ..  .
-00021870: 0a20 2020 200d 0a20 200d 0a20 2020 200d  .    ..  ..    .
-00021880: 0a20 200d 0a20 2020 200d 0a20 200d 0a20  .  ..    ..  .. 
-00021890: 2020 200d 0a20 200d 0a20 2020 200d 0a20     ..  ..    .. 
-000218a0: 200d 0a20 2020 200d 0a20 200d 0a20 2020   ..    ..  ..   
-000218b0: 200d 0a20 200d 0a20 2020 200d 0a20 200d   ..  ..    ..  .
-000218c0: 0a20 2020 200d 0a20 200d 0a20 2020 200d  .    ..  ..    .
-000218d0: 0a20 200d 0a20 2020 200d 0a20 200d 0a20  .  ..    ..  .. 
-000218e0: 2020 200d 0a20 200d 0a20 2020 200d 0a20     ..  ..    .. 
-000218f0: 200d 0a20 2020 200d 0a20 200d 0a20 2020   ..    ..  ..   
-00021900: 200d 0a20 200d 0a20 2020 200d 0a20 200d   ..  ..    ..  .
-00021910: 0a20 2020 200d 0a20 200d 0a20 2020 200d  .    ..  ..    .
-00021920: 0a20 200d 0a20 2020 200d 0a20 200d 0a20  .  ..    ..  .. 
-00021930: 2020 200d 0a20 200d 0a20 2020 200d 0a20     ..  ..    .. 
-00021940: 200d 0a20 2020 200d 0a20 2020 200d 0a20   ..    ..    .. 
-00021950: 2020 200d 0a20 2020 200d 0a                 ..    ..
+0001cd70: 2020 206c 696e 6573 7479 6c65 3d27 2d2d     linestyle='--
+0001cd80: 2729 0d0a 2020 2020 636f 6e66 6964 656e  ')..    confiden
+0001cd90: 6365 5f65 6c6c 6970 7365 2878 2c20 792c  ce_ellipse(x, y,
+0001cda0: 2061 785f 6e73 7464 2c20 6e5f 7374 643d   ax_nstd, n_std=
+0001cdb0: 332c 0d0a 2020 2020 2020 2020 2020 2020  3,..            
+0001cdc0: 2020 2020 2020 2020 2020 206c 6162 656c             label
+0001cdd0: 3d72 2724 335c 7369 676d 6124 272c 2065  =r'$3\sigma$', e
+0001cde0: 6467 6563 6f6c 6f72 3d27 626c 7565 272c  dgecolor='blue',
+0001cdf0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0001ce00: 2020 2020 2020 2020 2020 6c69 6e65 7374            linest
+0001ce10: 796c 653d 273a 2729 0d0a 2020 2020 0d0a  yle=':')..    ..
+0001ce20: 2020 2020 6178 5f6e 7374 642e 7363 6174      ax_nstd.scat
+0001ce30: 7465 7228 6d75 5b30 5d2c 206d 755b 315d  ter(mu[0], mu[1]
+0001ce40: 2c20 633d 2772 6564 272c 2073 3d33 290d  , c='red', s=3).
+0001ce50: 0a20 2020 2061 785f 6e73 7464 2e73 6574  .    ax_nstd.set
+0001ce60: 5f74 6974 6c65 2827 4469 6666 6572 656e  _title('Differen
+0001ce70: 7420 7374 616e 6461 7264 2064 6576 6961  t standard devia
+0001ce80: 7469 6f6e 7327 290d 0a20 2020 2061 785f  tions')..    ax_
+0001ce90: 6e73 7464 2e6c 6567 656e 6428 290d 0a20  nstd.legend().. 
+0001cea0: 2020 2070 6c74 2e73 686f 7728 290d 0a20     plt.show().. 
+0001ceb0: 2020 200d 0a64 6566 2063 6f6e 6669 6465     ..def confide
+0001cec0: 6e63 655f 656c 6c69 7073 6528 0d0a 2020  nce_ellipse(..  
+0001ced0: 2020 782c 200d 0a20 2020 2079 2c20 0d0a    x, ..    y, ..
+0001cee0: 2020 2020 6178 2c20 0d0a 2020 2020 6e5f      ax, ..    n_
+0001cef0: 7374 643d 332e 302c 200d 0a20 2020 2066  std=3.0, ..    f
+0001cf00: 6163 6563 6f6c 6f72 3d27 6e6f 6e65 272c  acecolor='none',
+0001cf10: 200d 0a20 2020 202a 2a6b 7761 7267 730d   ..    **kwargs.
+0001cf20: 0a20 2020 2029 3a0d 0a20 2020 2022 2222  .    ):..    """
+0001cf30: 0d0a 2020 2020 4372 6561 7465 2061 2070  ..    Create a p
+0001cf40: 6c6f 7420 6f66 2074 6865 2063 6f76 6172  lot of the covar
+0001cf50: 6961 6e63 6520 636f 6e66 6964 656e 6365  iance confidence
+0001cf60: 2065 6c6c 6970 7365 206f 6620 2a78 2a20   ellipse of *x* 
+0001cf70: 616e 6420 2a79 2a2e 0d0a 0d0a 2020 2020  and *y*.....    
+0001cf80: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+0001cf90: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+0001cfa0: 782c 2079 203a 2061 7272 6179 2d6c 696b  x, y : array-lik
+0001cfb0: 652c 2073 6861 7065 2028 6e2c 2029 0d0a  e, shape (n, )..
+0001cfc0: 2020 2020 2020 2020 496e 7075 7420 6461          Input da
+0001cfd0: 7461 2e0d 0a0d 0a20 2020 2061 7820 3a20  ta.....    ax : 
+0001cfe0: 6d61 7470 6c6f 746c 6962 2e61 7865 732e  matplotlib.axes.
+0001cff0: 4178 6573 0d0a 2020 2020 2020 2020 5468  Axes..        Th
+0001d000: 6520 6178 6573 206f 626a 6563 7420 746f  e axes object to
+0001d010: 2064 7261 7720 7468 6520 656c 6c69 7073   draw the ellips
+0001d020: 6520 696e 746f 2e0d 0a0d 0a20 2020 206e  e into.....    n
+0001d030: 5f73 7464 203a 2066 6c6f 6174 0d0a 2020  _std : float..  
+0001d040: 2020 2020 2020 5468 6520 6e75 6d62 6572        The number
+0001d050: 206f 6620 7374 616e 6461 7264 2064 6576   of standard dev
+0001d060: 6961 7469 6f6e 7320 746f 2064 6574 6572  iations to deter
+0001d070: 6d69 6e65 2074 6865 2065 6c6c 6970 7365  mine the ellipse
+0001d080: 2773 2072 6164 6975 7365 732e 0d0a 0d0a  's radiuses.....
+0001d090: 2020 2020 2a2a 6b77 6172 6773 0d0a 2020      **kwargs..  
+0001d0a0: 2020 2020 2020 466f 7277 6172 6465 6420        Forwarded 
+0001d0b0: 746f 2060 7e6d 6174 706c 6f74 6c69 622e  to `~matplotlib.
+0001d0c0: 7061 7463 6865 732e 456c 6c69 7073 6560  patches.Ellipse`
+0001d0d0: 0d0a 0d0a 2020 2020 5265 7475 726e 730d  ....    Returns.
+0001d0e0: 0a20 2020 202d 2d2d 2d2d 2d2d 0d0a 2020  .    -------..  
+0001d0f0: 2020 6d70 6c2e 7061 7463 6865 732e 456c    mpl.patches.El
+0001d100: 6c69 7073 650d 0a20 2020 2022 2222 0d0a  lipse..    """..
+0001d110: 2020 2020 6966 2078 2e73 697a 6520 213d      if x.size !=
+0001d120: 2079 2e73 697a 653a 0d0a 2020 2020 2020   y.size:..      
+0001d130: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0001d140: 6f72 2822 7820 616e 6420 7920 6d75 7374  or("x and y must
+0001d150: 2062 6520 7468 6520 7361 6d65 2073 697a   be the same siz
+0001d160: 6522 290d 0a0d 0a20 2020 2063 6f76 203d  e")....    cov =
+0001d170: 206e 702e 636f 7628 782c 2079 290d 0a20   np.cov(x, y).. 
+0001d180: 2020 2070 6561 7273 6f6e 203d 2063 6f76     pearson = cov
+0001d190: 5b30 2c20 315d 2f6e 702e 7371 7274 2863  [0, 1]/np.sqrt(c
+0001d1a0: 6f76 5b30 2c20 305d 202a 2063 6f76 5b31  ov[0, 0] * cov[1
+0001d1b0: 2c20 315d 290d 0a20 2020 2023 2055 7369  , 1])..    # Usi
+0001d1c0: 6e67 2061 2073 7065 6369 616c 2063 6173  ng a special cas
+0001d1d0: 6520 746f 206f 6274 6169 6e20 7468 6520  e to obtain the 
+0001d1e0: 6569 6765 6e76 616c 7565 7320 6f66 2074  eigenvalues of t
+0001d1f0: 6869 730d 0a20 2020 2023 2074 776f 2d64  his..    # two-d
+0001d200: 696d 656e 7369 6f6e 616c 2064 6174 6173  imensional datas
+0001d210: 6574 2e0d 0a20 2020 2065 6c6c 5f72 6164  et...    ell_rad
+0001d220: 6975 735f 7820 3d20 6e70 2e73 7172 7428  ius_x = np.sqrt(
+0001d230: 3120 2b20 7065 6172 736f 6e29 0d0a 2020  1 + pearson)..  
+0001d240: 2020 656c 6c5f 7261 6469 7573 5f79 203d    ell_radius_y =
+0001d250: 206e 702e 7371 7274 2831 202d 2070 6561   np.sqrt(1 - pea
+0001d260: 7273 6f6e 290d 0a20 2020 2065 6c6c 6970  rson)..    ellip
+0001d270: 7365 203d 2045 6c6c 6970 7365 2828 302c  se = Ellipse((0,
+0001d280: 2030 292c 2077 6964 7468 3d65 6c6c 5f72   0), width=ell_r
+0001d290: 6164 6975 735f 7820 2a20 322c 2068 6569  adius_x * 2, hei
+0001d2a0: 6768 743d 656c 6c5f 7261 6469 7573 5f79  ght=ell_radius_y
+0001d2b0: 202a 2032 2c0d 0a20 2020 2020 2020 2020   * 2,..         
+0001d2c0: 2020 2020 2020 2020 2020 2020 2066 6163               fac
+0001d2d0: 6563 6f6c 6f72 3d66 6163 6563 6f6c 6f72  ecolor=facecolor
+0001d2e0: 2c20 2a2a 6b77 6172 6773 290d 0a0d 0a20  , **kwargs).... 
+0001d2f0: 2020 2023 2043 616c 6375 6c61 7469 6e67     # Calculating
+0001d300: 2074 6865 2073 7461 6e64 6172 6420 6465   the standard de
+0001d310: 7669 6174 696f 6e20 6f66 2078 2066 726f  viation of x fro
+0001d320: 6d0d 0a20 2020 2023 2074 6865 2073 7175  m..    # the squ
+0001d330: 6172 6572 6f6f 7420 6f66 2074 6865 2076  areroot of the v
+0001d340: 6172 6961 6e63 6520 616e 6420 6d75 6c74  ariance and mult
+0001d350: 6970 6c79 696e 670d 0a20 2020 2023 2077  iplying..    # w
+0001d360: 6974 6820 7468 6520 6769 7665 6e20 6e75  ith the given nu
+0001d370: 6d62 6572 206f 6620 7374 616e 6461 7264  mber of standard
+0001d380: 2064 6576 6961 7469 6f6e 732e 0d0a 2020   deviations...  
+0001d390: 2020 7363 616c 655f 7820 3d20 6e70 2e73    scale_x = np.s
+0001d3a0: 7172 7428 636f 765b 302c 2030 5d29 202a  qrt(cov[0, 0]) *
+0001d3b0: 206e 5f73 7464 0d0a 2020 2020 6d65 616e   n_std..    mean
+0001d3c0: 5f78 203d 206e 702e 6d65 616e 2878 290d  _x = np.mean(x).
+0001d3d0: 0a0d 0a20 2020 2023 2063 616c 6375 6c61  ...    # calcula
+0001d3e0: 7469 6e67 2074 6865 2073 7461 6e64 6172  ting the standar
+0001d3f0: 6420 6465 7669 6174 696f 6e20 6f66 2079  d deviation of y
+0001d400: 202e 2e2e 0d0a 2020 2020 7363 616c 655f   .....    scale_
+0001d410: 7920 3d20 6e70 2e73 7172 7428 636f 765b  y = np.sqrt(cov[
+0001d420: 312c 2031 5d29 202a 206e 5f73 7464 0d0a  1, 1]) * n_std..
+0001d430: 2020 2020 6d65 616e 5f79 203d 206e 702e      mean_y = np.
+0001d440: 6d65 616e 2879 290d 0a0d 0a20 2020 2074  mean(y)....    t
+0001d450: 7261 6e73 6620 3d20 7472 616e 7366 6f72  ransf = transfor
+0001d460: 6d73 2e41 6666 696e 6532 4428 2920 5c0d  ms.Affine2D() \.
+0001d470: 0a20 2020 2020 2020 202e 726f 7461 7465  .        .rotate
+0001d480: 5f64 6567 2834 3529 205c 0d0a 2020 2020  _deg(45) \..    
+0001d490: 2020 2020 2e73 6361 6c65 2873 6361 6c65      .scale(scale
+0001d4a0: 5f78 2c20 7363 616c 655f 7929 205c 0d0a  _x, scale_y) \..
+0001d4b0: 2020 2020 2020 2020 2e74 7261 6e73 6c61          .transla
+0001d4c0: 7465 286d 6561 6e5f 782c 206d 6561 6e5f  te(mean_x, mean_
+0001d4d0: 7929 0d0a 0d0a 2020 2020 656c 6c69 7073  y)....    ellips
+0001d4e0: 652e 7365 745f 7472 616e 7366 6f72 6d28  e.set_transform(
+0001d4f0: 7472 616e 7366 202b 2061 782e 7472 616e  transf + ax.tran
+0001d500: 7344 6174 6129 0d0a 2020 2020 7265 7475  sData)..    retu
+0001d510: 726e 2061 782e 6164 645f 7061 7463 6828  rn ax.add_patch(
+0001d520: 656c 6c69 7073 6529 2020 0d0a 2020 200d  ellipse)  ..   .
+0001d530: 0a64 6566 2070 6c6f 745f 7374 7269 6b65  .def plot_strike
+0001d540: 2028 0d0a 2020 2020 6c69 7374 5f6f 665f   (..    list_of_
+0001d550: 6564 6973 2c20 2f2c 200d 0a20 2020 206b  edis, /, ..    k
+0001d560: 696e 6420 3d20 322c 0d0a 2020 2020 7065  ind = 2,..    pe
+0001d570: 7269 6f64 5f74 6f6c 6572 616e 6365 3d2e  riod_tolerance=.
+0001d580: 3035 2c20 0d0a 2020 2020 7465 7874 5f70  05, ..    text_p
+0001d590: 6164 203d 312e 3635 202c 200d 0a20 2020  ad =1.65 , ..   
+0001d5a0: 2072 6f74 5f7a 3d30 2e20 2c20 0d0a 2020   rot_z=0. , ..  
+0001d5b0: 2020 2a2a 6b77 730d 0a20 2020 2029 3a20    **kws..    ): 
+0001d5c0: 0d0a 2020 2020 0d0a 2020 2020 6578 7472  ..    ..    extr
+0001d5d0: 6120 3d28 2250 6c6f 7453 7472 696b 6520  a =("PlotStrike 
+0001d5e0: 7573 6573 2027 6d74 7079 2720 6f72 2027  uses 'mtpy' or '
+0001d5f0: 7079 6373 616d 7427 2061 7320 6465 7065  pycsamt' as depe
+0001d600: 6e64 656e 6379 2e22 0d0a 2020 2020 2020  ndency."..      
+0001d610: 2020 2020 2020 290d 0a20 2020 2069 6d70        )..    imp
+0001d620: 6f72 745f 6f70 7469 6f6e 616c 5f64 6570  ort_optional_dep
+0001d630: 656e 6465 6e63 7920 2827 6d74 7079 272c  endency ('mtpy',
+0001d640: 2065 7874 7261 203d 2065 7874 7261 2029   extra = extra )
+0001d650: 0d0a 2020 2020 2378 7878 7878 7878 7878  ..    #xxxxxxxxx
+0001d660: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
+0001d670: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
+0001d680: 7878 7878 7878 7878 0d0a 2020 2020 6672  xxxxxxxx..    fr
+0001d690: 6f6d 206d 7470 792e 696d 6167 696e 672e  om mtpy.imaging.
+0001d6a0: 706c 6f74 7374 7269 6b65 2069 6d70 6f72  plotstrike impor
+0001d6b0: 7420 506c 6f74 5374 7269 6b65 0d0a 2020  t PlotStrike..  
+0001d6c0: 2020 6672 6f6d 202e 2e70 726f 7065 7274    from ..propert
+0001d6d0: 7920 696d 706f 7274 2049 7345 6469 0d0a  y import IsEdi..
+0001d6e0: 2020 2020 2378 7878 7878 7878 7878 7878      #xxxxxxxxxxx
+0001d6f0: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
+0001d700: 7878 7878 7878 7878 7878 7878 7878 7878  xxxxxxxxxxxxxxxx
+0001d710: 7878 7878 7878 0d0a 2020 2020 6966 2069  xxxxxx..    if i
+0001d720: 7369 6e73 7461 6e63 6520 2820 6c69 7374  sinstance ( list
+0001d730: 5f6f 665f 6564 6973 2c20 7374 7229 3a20  _of_edis, str): 
+0001d740: 0d0a 2020 2020 2020 2020 6966 206f 732e  ..        if os.
+0001d750: 7061 7468 2e69 7364 6972 2028 206c 6973  path.isdir ( lis
+0001d760: 745f 6f66 5f65 6469 7320 293a 200d 0a20  t_of_edis ): .. 
+0001d770: 2020 2020 2020 2020 2020 206c 6973 745f             list_
+0001d780: 6f66 5f65 6469 7320 3d20 5b6f 732e 7061  of_edis = [os.pa
+0001d790: 7468 2e6a 6f69 6e28 2066 2920 666f 7220  th.join( f) for 
+0001d7a0: 6620 696e 206f 732e 6c69 7374 6469 7220  f in os.listdir 
+0001d7b0: 286c 6973 745f 6f66 5f65 6469 7329 0d0a  (list_of_edis)..
+0001d7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d7d0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001d7e0: 7472 2866 292e 6c6f 7765 7228 292e 656e  tr(f).lower().en
+0001d7f0: 6473 7769 7468 2028 272e 6564 6927 295d  dswith ('.edi')]
+0001d800: 0d0a 2020 2020 2020 2020 6966 206f 732e  ..        if os.
+0001d810: 7061 7468 2e69 7366 696c 6520 286c 6973  path.isfile (lis
+0001d820: 745f 6f66 5f65 6469 7329 3a20 0d0a 2020  t_of_edis): ..  
+0001d830: 2020 2020 2020 2020 2020 6c69 7374 5f6f            list_o
+0001d840: 665f 6564 6973 203d 5b6c 6973 745f 6f66  f_edis =[list_of
+0001d850: 5f65 6469 7320 5d0d 0a20 2020 2020 2020  _edis ]..       
+0001d860: 200d 0a20 2020 2023 206e 6f77 2063 6865   ..    # now che
+0001d870: 636b 2077 6865 7468 6572 2069 7320 7661  ck whether is va
+0001d880: 6c69 6420 4544 4920 2020 2020 0d0a 2020  lid EDI     ..  
+0001d890: 2020 2320 6c69 7374 2063 6f6d 7072 6568    # list compreh
+0001d8a0: 656e 7369 6f6e 2066 6173 7465 7220 7468  ension faster th
+0001d8b0: 616e 0d0a 2020 2020 2320 7475 706c 6520  an..    # tuple 
+0001d8c0: 286d 6170 2028 6c61 6d62 6461 2066 3a20  (map (lambda f: 
+0001d8d0: 2049 7345 6469 2e5f 6173 7365 7274 5f65   IsEdi._assert_e
+0001d8e0: 6469 2028 6620 292c 206c 6973 745f 6f66  di (f ), list_of
+0001d8f0: 5f65 6469 7320 2920 290d 0a20 2020 205b  _edis ) )..    [
+0001d900: 2049 7345 6469 2e5f 6173 7365 7274 5f65   IsEdi._assert_e
+0001d910: 6469 2028 6620 2920 666f 7220 6620 696e  di (f ) for f in
+0001d920: 206c 6973 745f 6f66 5f65 6469 7320 5d20   list_of_edis ] 
+0001d930: 0d0a 2020 2020 2320 7375 7070 7265 7373  ..    # suppress
+0001d940: 2074 6869 7264 2070 6172 7479 2076 6572   third party ver
+0001d950: 626f 7369 7479 200d 0a20 2020 2077 6974  bosity ..    wit
+0001d960: 6820 6e75 6c6c 6966 795f 6f75 7470 7574  h nullify_output
+0001d970: 2829 3a0d 0a20 2020 2020 2020 2050 6c6f  ():..        Plo
+0001d980: 7453 7472 696b 6528 0d0a 2020 2020 2020  tStrike(..      
+0001d990: 2020 2020 2020 666e 5f6c 6973 743d 6c69        fn_list=li
+0001d9a0: 7374 5f6f 665f 6564 6973 2c0d 0a20 2020  st_of_edis,..   
+0001d9b0: 2020 2020 2020 2020 2070 6c6f 745f 7479           plot_ty
+0001d9c0: 7065 3d6b 696e 642c 0d0a 2020 2020 2020  pe=kind,..      
+0001d9d0: 2020 2020 2020 2a2a 6b77 730d 0a20 2020        **kws..   
+0001d9e0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+0001d9f0: 2020 2020 0d0a 706c 6f74 5f73 7472 696b      ..plot_strik
+0001da00: 652e 5f5f 646f 635f 5f3d 2222 2220 0d0a  e.__doc__=""" ..
+0001da10: 506c 6f74 2074 6865 2073 7472 696b 6520  Plot the strike 
+0001da20: 6573 7469 6d61 7465 6420 6672 6f6d 2074  estimated from t
+0001da30: 6865 2069 6e76 6172 6961 6e74 7320 616e  he invariants an
+0001da40: 6420 7068 6173 6520 7465 6e73 6f72 2e20  d phase tensor. 
+0001da50: 0d0a 696e 2061 2072 6f73 6520 6469 6167  ..in a rose diag
+0001da60: 7261 6d20 6f66 2078 7920 706c 6f74 2e20  ram of xy plot. 
+0001da70: 0d0a 0d0a 5061 7261 6d65 7465 7273 200d  ....Parameters .
+0001da80: 0a2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a6c  .------------..l
+0001da90: 6973 745f 6f66 5f65 6469 733a 206c 6973  ist_of_edis: lis
+0001daa0: 742c 200d 0a20 2020 2066 756c 6c20 7061  t, ..    full pa
+0001dab0: 7468 7320 746f 202e 6564 6920 6669 6c65  ths to .edi file
+0001dac0: 7320 746f 2070 6c6f 7420 6f72 206c 6973  s to plot or lis
+0001dad0: 7420 6f66 203a 7465 726d 3a60 4544 492d  t of :term:`EDI-
+0001dae0: 6669 6c65 7360 2e20 0d0a 2020 2020 0d0a  files`. ..    ..
+0001daf0: 2020 202e 2e20 7665 7273 696f 6e63 6861     .. versioncha
+0001db00: 6e67 6564 3a3a 2030 2e32 2e30 200d 0a20  nged:: 0.2.0 .. 
+0001db10: 2020 2020 204e 6f20 6e65 6564 2074 6f20       No need to 
+0001db20: 7072 6f76 6964 6520 6120 6c69 7374 206f  provide a list o
+0001db30: 6620 7465 726d 3a60 4544 4960 2066 696c  f term:`EDI` fil
+0001db40: 6573 2e20 4865 6e63 6566 6f72 7468 2060  es. Henceforth `
+0001db50: 6c69 7374 5f6f 665f 6564 6973 600d 0a20  list_of_edis`.. 
+0001db60: 2020 2020 2061 6363 6570 7473 2074 6865       accepts the
+0001db70: 2045 4449 2070 6174 682d 6c69 6b65 206f   EDI path-like o
+0001db80: 626a 6563 7420 6f66 2073 696e 676c 6520  bject of single 
+0001db90: 4544 4920 6669 6c65 2074 6865 6e20 6173  EDI file then as
+0001dba0: 7365 7274 7320 0d0a 2020 2020 2020 7468  serts ..      th
+0001dbb0: 6520 7661 6c69 6469 7479 206f 6620 7468  e validity of th
+0001dbc0: 6520 4544 4920 6669 6c65 7320 6166 7465  e EDI files afte
+0001dbd0: 7277 6172 642e 200d 0a0d 0a6b 696e 643a  rward. ....kind:
+0001dbe0: 2069 6e74 2c20 6465 6661 756c 743d 3220   int, default=2 
+0001dbf0: 0d0a 2020 2020 4361 6e20 6265 205b 2031  ..    Can be [ 1
+0001dc00: 207c 2032 205d 2077 6865 7265 3a0d 0a20   | 2 ] where:.. 
+0001dc10: 2020 2020 2020 0d0a 2020 202d 202a 312a        ..   - *1*
+0001dc20: 2074 6f20 706c 6f74 2069 6e64 6976 6964   to plot individ
+0001dc30: 7561 6c20 6465 6361 6465 7320 696e 206f  ual decades in o
+0001dc40: 6e65 2070 6c6f 740d 0a20 2020 2d20 2a32  ne plot..   - *2
+0001dc50: 2a20 746f 2070 6c6f 7420 616c 6c20 7065  * to plot all pe
+0001dc60: 7269 6f64 2072 616e 6765 7320 696e 746f  riod ranges into
+0001dc70: 206f 6e65 2070 6f6c 6172 2064 6961 6772   one polar diagr
+0001dc80: 616d 2066 6f72 2065 6163 6820 0d0a 2020  am for each ..  
+0001dc90: 2020 2073 7472 696b 6520 616e 676c 6520     strike angle 
+0001dca0: 6573 7469 6d61 7469 6f6e 0d0a 2020 2020  estimation..    
+0001dcb0: 2020 2020 200d 0a20 2020 4f6e 6520 636f       ..   One co
+0001dcc0: 756c 6420 7472 7920 616c 736f 2070 6c6f  uld try also plo
+0001dcd0: 745f 7479 7065 203d 2031 2074 6f20 706c  t_type = 1 to pl
+0001dce0: 6f74 2062 7920 6465 6361 6465 0d0a 2020  ot by decade..  
+0001dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd30: 200d 0a66 6967 5f6e 756d 3a20 696e 742c   ..fig_num: int,
+0001dd40: 2064 6566 6175 6c74 3d31 2c20 0d0a 2020   default=1, ..  
+0001dd50: 2066 6967 7572 6520 6e75 6d62 6572 2074   figure number t
+0001dd60: 6f20 6265 2070 6c6f 7474 6564 2e20 2a44  o be plotted. *D
+0001dd70: 6566 6175 6c74 2a20 6973 2031 0d0a 2020  efault* is 1..  
+0001dd80: 2020 2020 2020 0d0a 666f 6e74 5f73 697a        ..font_siz
+0001dd90: 653a 2066 6c6f 6174 2c20 6465 6661 756c  e: float, defaul
+0001dda0: 743d 3130 2c20 0d0a 2020 2046 6967 7572  t=10, ..   Figur
+0001ddb0: 6520 7369 7a65 200d 0a20 2020 0d0a 726f  e size ..   ..ro
+0001ddc0: 745f 7a3a 2066 6c6f 6174 2c20 6465 6661  t_z: float, defa
+0001ddd0: 756c 743d 302e 2c20 0d0a 2020 2061 6e67  ult=0., ..   ang
+0001dde0: 6c65 206f 6620 726f 7461 7469 6f6e 2063  le of rotation c
+0001ddf0: 6c6f 636b 7769 7365 2070 6f73 6974 6976  lockwise positiv
+0001de00: 652e 200d 0a0d 0a70 6572 696f 645f 746f  e. ....period_to
+0001de10: 6c65 7261 6e63 653a 2066 6c6f 6174 2c20  lerance: float, 
+0001de20: 6465 6661 756c 743d 2e30 3520 0d0a 2020  default=.05 ..  
+0001de30: 2020 546f 6c65 7261 6e63 6520 6c65 7665    Tolerance leve
+0001de40: 6c20 746f 206d 6174 6368 2070 6572 696f  l to match perio
+0001de50: 6473 2066 726f 6d20 6469 6666 6572 656e  ds from differen
+0001de60: 7420 6564 6920 6669 6c65 732e 0d0a 2020  t edi files...  
+0001de70: 2020 2a44 6566 6175 6c74 2a20 6973 2030    *Default* is 0
+0001de80: 2e30 350d 0a0d 0a74 6578 745f 7061 643a  .05....text_pad:
+0001de90: 2066 6c6f 6174 2c20 6465 6661 756c 743d   float, default=
+0001dea0: 312e 3635 0d0a 2020 2070 6164 6469 6e67  1.65..   padding
+0001deb0: 206f 6620 7468 6520 616e 676c 6520 6c61   of the angle la
+0001dec0: 6265 6c20 6174 2074 6865 2062 6f74 746f  bel at the botto
+0001ded0: 6d20 6f66 2065 6163 680d 0a20 2020 2020  m of each..     
+0001dee0: 2020 2020 2020 2020 2020 2020 706f 6c61              pola
+0001def0: 7220 6469 6167 7261 6d2e 2020 2a44 6566  r diagram.  *Def
+0001df00: 6175 6c74 2a20 6973 2031 2e36 350d 0a70  ault* is 1.65..p
+0001df10: 6c6f 745f 7261 6e67 653a 2020 7374 722c  lot_range:  str,
+0001df20: 2074 7570 6c65 200d 0a20 2020 5468 6520   tuple ..   The 
+0001df30: 7065 7269 6f64 2072 616e 6765 2074 6f20  period range to 
+0001df40: 6573 7469 6d61 7465 2074 6865 2073 7472  estimate the str
+0001df50: 696b 6520 616e 676c 652e 2049 7420 6361  ike angle. It ca
+0001df60: 6e20 6265 200d 0a20 2020 5b20 2764 6174  n be ..   [ 'dat
+0001df70: 6127 207c 2028 7065 7269 6f64 5f6d 696e  a' | (period_min
+0001df80: 2c70 6572 696f 645f 6d61 7829 205d 2e20  ,period_max) ]. 
+0001df90: 204f 7074 696f 6e73 2061 7265 3a0d 0a20   Options are:.. 
+0001dfa0: 2020 2020 2020 0d0a 2020 202a 202a 2764        ..   * *'d
+0001dfb0: 6174 6127 2a20 666f 7220 6573 7469 6d61  ata'* for estima
+0001dfc0: 7469 6e67 2074 6865 2073 7472 696b 6520  ting the strike 
+0001dfd0: 666f 7220 616c 6c20 7065 7269 6f64 730d  for all periods.
+0001dfe0: 0a20 2020 2020 696e 2074 6865 2064 6174  .     in the dat
+0001dff0: 612e 0d0a 2020 202a 2028 706d 696e 2c70  a...   * (pmin,p
+0001e000: 6d61 7829 2066 6f72 2070 6572 696f 6420  max) for period 
+0001e010: 6d69 6e20 616e 6420 7065 7269 6f64 206d  min and period m
+0001e020: 6178 2c20 696e 7075 7420 6173 0d0a 2020  ax, input as..  
+0001e030: 2020 2028 6c6f 6731 3028 706d 696e 292c     (log10(pmin),
+0001e040: 6c6f 6731 3028 706d 6178 2929 0d0a 0d0a  log10(pmax))....
+0001e050: 706c 6f74 5f74 6970 7065 723a 205b 2054  plot_tipper: [ T
+0001e060: 7275 6520 7c20 4661 6c73 6520 5d0d 0a20  rue | False ].. 
+0001e070: 2020 202d 2054 7275 6520 746f 2070 6c6f     - True to plo
+0001e080: 7420 7468 6520 7469 7070 6572 2073 7472  t the tipper str
+0001e090: 696b 650d 0a20 2020 202d 2046 616c 7365  ike..    - False
+0001e0a0: 2074 6f20 6e6f 7420 706c 6f74 2074 6970   to not plot tip
+0001e0b0: 7065 7220 7374 7269 6b65 0d0a 2020 200d  per strike..   .
+0001e0c0: 0a70 745f 6572 726f 725f 666c 6f6f 723a  .pt_error_floor:
+0001e0d0: 2069 6e74 2c20 6f70 7469 6f6e 616c 200d   int, optional .
+0001e0e0: 0a20 2020 4d61 7869 6d75 6d20 6572 726f  .   Maximum erro
+0001e0f0: 7220 696e 2064 6567 7265 6573 2074 6861  r in degrees tha
+0001e100: 7420 6973 2061 6c6c 6f77 6564 2074 6f20  t is allowed to 
+0001e110: 0d0a 2020 2065 7374 696d 6174 6520 7374  ..   estimate st
+0001e120: 7269 6b65 2e20 2a44 6566 6175 6c74 2a20  rike. *Default* 
+0001e130: 6973 204e 6f6e 6520 616c 6c6f 7769 6e67  is None allowing
+0001e140: 2061 6c6c 200d 0a20 2020 6573 7469 6d61   all ..   estima
+0001e150: 7465 7320 746f 2062 6520 7573 6564 2e0d  tes to be used..
+0001e160: 0a0d 0a66 6f6c 643a 205b 2054 7275 6520  ...fold: [ True 
+0001e170: 7c20 4661 6c73 6520 5d0d 0a20 2020 2a20  | False ]..   * 
+0001e180: 5472 7565 2074 6f20 706c 6f74 206f 6e6c  True to plot onl
+0001e190: 7920 6672 6f6d 2030 2074 6f20 3138 300d  y from 0 to 180.
+0001e1a0: 0a20 2020 2a20 4661 6c73 6520 746f 2070  .   * False to p
+0001e1b0: 6c6f 7420 6672 6f6d 2030 2074 6f20 3336  lot from 0 to 36
+0001e1c0: 300d 0a20 2020 2020 2020 2020 2020 200d  0..            .
+0001e1d0: 0a70 6c6f 745f 6f72 7468 6f67 6f6e 616c  .plot_orthogonal
+0001e1e0: 3a20 5b20 5472 7565 207c 2046 616c 7365  : [ True | False
+0001e1f0: 5d0d 0a20 2020 202a 2054 7275 6520 746f  ]..    * True to
+0001e200: 2070 6c6f 7420 7468 6520 6f72 7468 6f67   plot the orthog
+0001e210: 6f6e 616c 2073 7472 696b 6520 6469 7265  onal strike dire
+0001e220: 6374 696f 6e73 0d0a 2020 2020 2a20 4661  ctions..    * Fa
+0001e230: 6c73 6520 746f 206e 6f74 0d0a 0d0a 636f  lse to not....co
+0001e240: 6c6f 723a 205b 2054 7275 6520 7c20 4661  lor: [ True | Fa
+0001e250: 6c73 6520 5d0d 0a20 2020 202a 2054 7275  lse ]..    * Tru
+0001e260: 6520 746f 2070 6c6f 7420 7368 6164 6520  e to plot shade 
+0001e270: 636f 6c6f 7273 0d0a 2020 2020 2a20 4661  colors..    * Fa
+0001e280: 6c73 6520 746f 2070 6c6f 7420 616c 6c20  lse to plot all 
+0001e290: 696e 206f 6e65 2063 6f6c 6f72 0d0a 2020  in one color..  
+0001e2a0: 2020 2020 2020 2020 2020 2020 0d0a 636f              ..co
+0001e2b0: 6c6f 725f 696e 763a 7374 722c 200d 0a20  lor_inv:str, .. 
+0001e2c0: 2020 636f 6c6f 7220 6f66 2069 6e76 6172    color of invar
+0001e2d0: 6961 6e74 7320 706c 6f74 730d 0a0d 0a63  iants plots....c
+0001e2e0: 6f6c 6f72 5f70 743a 2073 7472 2c20 0d0a  olor_pt: str, ..
+0001e2f0: 2020 2063 6f6c 6f72 206f 6620 7068 6173     color of phas
+0001e300: 6520 7465 6e73 6f72 2070 6c6f 7473 0d0a  e tensor plots..
+0001e310: 0d0a 636f 6c6f 725f 7469 703a 2073 7472  ..color_tip: str
+0001e320: 200d 0a20 2020 636f 6c6f 7220 6f66 2074   ..   color of t
+0001e330: 6970 7065 7220 706c 6f74 730d 0a0d 0a72  ipper plots....r
+0001e340: 696e 675f 7370 6163 696e 673a 2066 6c6f  ing_spacing: flo
+0001e350: 6174 2c20 6f70 7469 6f6e 616c 200d 0a20  at, optional .. 
+0001e360: 2020 2073 7061 6369 6e67 206f 6620 7269     spacing of ri
+0001e370: 6e67 7320 696e 2070 6f6c 6172 2070 6c6f  ngs in polar plo
+0001e380: 7473 0d0a 0d0a 7269 6e67 5f6c 696d 6974  ts....ring_limit
+0001e390: 733a 2074 7570 6c65 206f 6620 696e 742c  s: tuple of int,
+0001e3a0: 200d 0a20 2020 706c 6f74 206c 696d 6974   ..   plot limit
+0001e3b0: 7320 286d 696e 2063 6f75 6e74 2c20 6d61  s (min count, ma
+0001e3c0: 7820 636f 756e 7429 2073 6574 2065 6163  x count) set eac
+0001e3d0: 6820 706c 6f74 2068 6176 6520 7468 6573  h plot have thes
+0001e3e0: 6520 6c69 6d69 7473 200d 0a20 2020 2020  e limits ..     
+0001e3f0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+0001e400: 0a70 6c6f 745f 6f72 6965 6e74 6174 696f  .plot_orientatio
+0001e410: 6e3a 2073 7472 2c20 5b20 2768 2720 7c20  n: str, [ 'h' | 
+0001e420: 2776 2720 5d20 0d0a 2020 2068 6f72 697a  'v' ] ..   horiz
+0001e430: 6f6e 7461 6c20 6f72 2076 6572 7469 6361  ontal or vertica
+0001e440: 6c20 706c 6f74 730d 0a0d 0a0d 0a53 6565  l plots......See
+0001e450: 204d 6f72 650d 0a2d 2d2d 2d2d 2d2d 2d0d   More..--------.
+0001e460: 0a50 6c6f 7473 2074 6865 2073 7472 696b  .Plots the strik
+0001e470: 6520 616e 676c 6520 6173 2064 6574 6572  e angle as deter
+0001e480: 6d69 6e65 6420 6279 2069 6e76 6172 6961  mined by invaria
+0001e490: 6e74 7320 6f66 2074 6865 2069 6d70 6564  nts of the imped
+0001e4a0: 616e 6365 2074 656e 736f 7220 0d0a 2857  ance tensor ..(W
+0001e4b0: 6561 7665 7220 6574 2061 6c2e 205b 3230  eaver et al. [20
+0001e4c0: 3033 5d20 5b31 5d5f 2920 616e 6420 7068  03] [1]_) and ph
+0001e4d0: 6173 6520 7465 6e73 6f72 2061 7a69 6d75  ase tensor azimu
+0001e4e0: 7468 200d 0a28 4361 6c64 7765 6c6c 2065  th ..(Caldwell e
+0001e4f0: 7420 616c 2e20 5b32 3030 345d 205b 325d  t al. [2004] [2]
+0001e500: 5f29 200d 0a0d 0a54 6865 2064 6174 6120  _) ....The data 
+0001e510: 6973 2073 706c 6974 2069 6e74 6f20 6465  is split into de
+0001e520: 6361 6465 7320 7768 6572 6520 7468 6520  cades where the 
+0001e530: 6869 7374 6f67 7261 6d20 666f 7220 6561  histogram for ea
+0001e540: 6368 2069 7320 706c 6f74 7465 6420 696e  ch is plotted in
+0001e550: 0d0a 7468 6520 666f 726d 206f 6620 6120  ..the form of a 
+0001e560: 726f 7365 2064 6961 6772 616d 2077 6974  rose diagram wit
+0001e570: 6820 6120 7261 6e67 6520 6f66 2030 2074  h a range of 0 t
+0001e580: 6f20 3138 3020 6465 6772 6565 732e 0d0a  o 180 degrees...
+0001e590: 5768 6572 6520 3020 6973 204e 6f72 7468  Where 0 is North
+0001e5a0: 2061 6e64 2039 3020 6973 2045 6173 742e   and 90 is East.
+0001e5b0: 2020 5468 6520 6d65 6469 616e 2061 6e67    The median ang
+0001e5c0: 6c65 206f 6620 7468 6520 7065 7269 6f64  le of the period
+0001e5d0: 2062 616e 6420 6973 0d0a 7365 7420 696e   band is..set in
+0001e5e0: 2070 6f6c 6172 2064 6961 6772 616d 2e20   polar diagram. 
+0001e5f0: 2054 6865 2074 6f70 2072 6f77 2069 7320   The top row is 
+0001e600: 7468 6520 7374 7269 6b65 2065 7374 696d  the strike estim
+0001e610: 6174 6564 2066 726f 6d0d 0a74 6865 2069  ated from..the i
+0001e620: 6e76 6172 6961 6e74 7320 6f66 2074 6865  nvariants of the
+0001e630: 2069 6d70 6564 616e 6365 2074 656e 736f   impedance tenso
+0001e640: 722e 2020 5468 6520 626f 7474 6f6d 2072  r.  The bottom r
+0001e650: 6f77 2069 7320 7468 6520 617a 696d 7574  ow is the azimut
+0001e660: 680d 0a65 7374 696d 6174 6564 2066 726f  h..estimated fro
+0001e670: 6d20 7468 6520 7068 6173 6520 7465 6e73  m the phase tens
+0001e680: 6f72 2e20 2049 6620 7469 7070 6572 2069  or.  If tipper i
+0001e690: 7320 2779 2720 7468 656e 2074 6865 2033  s 'y' then the 3
+0001e6a0: 7264 2072 6f77 2069 7320 7468 650d 0a73  rd row is the..s
+0001e6b0: 7472 696b 6520 6465 7465 726d 696e 6564  trike determined
+0001e6c0: 2066 726f 6d20 7468 6520 7469 7070 6572   from the tipper
+0001e6d0: 2c20 7768 6963 6820 6973 206f 7274 686f  , which is ortho
+0001e6e0: 676f 6e61 6c20 746f 2074 6865 2069 6e64  gonal to the ind
+0001e6f0: 7563 7469 6f6e 0d0a 6172 726f 7720 6469  uction..arrow di
+0001e700: 7265 6374 696f 6e2e 0d0a 0d0a 5265 6665  rection.....Refe
+0001e710: 7265 6e63 6573 200d 0a2d 2d2d 2d2d 2d2d  rences ..-------
+0001e720: 2d2d 2d0d 0a2e 2e20 5b31 5d20 5765 6176  ---.... [1] Weav
+0001e730: 6572 204a 2e54 2c20 4c69 6c6c 6579 2046  er J.T, Lilley F
+0001e740: 2e45 2e4d 2e28 3230 3033 2920 2049 6e76  .E.M.(2003)  Inv
+0001e750: 6172 6961 6e74 7320 6f66 2072 6f74 6174  ariants of rotat
+0001e760: 696f 6e20 6f66 2061 7865 7320 616e 6420  ion of axes and 
+0001e770: 696e 6469 6361 746f 7273 206f 660d 0a20  indicators of.. 
+0001e780: 2020 2020 2020 6469 6d65 6e73 696f 6e61        dimensiona
+0001e790: 6c69 7479 2069 6e20 6d61 676e 6574 6f74  lity in magnetot
+0001e7a0: 656c 6c75 7269 6373 2c20 4175 7374 7261  ellurics, Austra
+0001e7b0: 6c69 616e 204e 6174 696f 6e61 6c20 556e  lian National Un
+0001e7c0: 6976 6572 7369 7479 2c0d 0a20 2020 2020  iversity,..     
+0001e7d0: 2020 556e 6976 6572 7369 7479 206f 6620    University of 
+0001e7e0: 5669 6374 6f72 6961 3b20 6874 7470 3a2f  Victoria; http:/
+0001e7f0: 2f62 6962 2e67 667a 2d70 6f74 7364 616d  /bib.gfz-potsdam
+0001e800: 2e64 652f 656d 7466 2f32 3030 372f 7064  .de/emtf/2007/pd
+0001e810: 662f 6c69 6c6c 6579 2e70 6466 0d0a 2e2e  f/lilley.pdf....
+0001e820: 205b 325d 2054 2e20 4772 616e 7420 4361   [2] T. Grant Ca
+0001e830: 6c64 7765 6c6c 2c20 4875 6768 204d 2e20  ldwell, Hugh M. 
+0001e840: 4269 6262 792c 2043 6f6c 696e 2042 726f  Bibby, Colin Bro
+0001e850: 776e 2c20 5468 6520 6d61 676e 6574 6f74  wn, The magnetot
+0001e860: 656c 6c75 7269 6320 7068 6173 6520 7465  elluric phase te
+0001e870: 6e73 6f72 2c20 0d0a 2020 2020 2020 2047  nsor, ..       G
+0001e880: 656f 7068 7973 6963 616c 204a 6f75 726e  eophysical Journ
+0001e890: 616c 2049 6e74 6572 6e61 7469 6f6e 616c  al International
+0001e8a0: 2c20 566f 6c75 6d65 2031 3538 2c20 4973  , Volume 158, Is
+0001e8b0: 7375 6520 322c 2041 7567 7573 7420 3230  sue 2, August 20
+0001e8c0: 3034 2c20 0d0a 2020 2020 2020 2050 6167  04, ..       Pag
+0001e8d0: 6573 2034 3537 e280 9334 3639 2c20 6874  es 457...469, ht
+0001e8e0: 7470 733a 2f2f 646f 692e 6f72 672f 3130  tps://doi.org/10
+0001e8f0: 2e31 3131 312f 6a2e 3133 3635 2d32 3436  .1111/j.1365-246
+0001e900: 582e 3230 3034 2e30 3232 3831 2e78 0d0a  X.2004.02281.x..
+0001e910: 4578 616d 706c 6573 200d 0a2d 2d2d 2d2d  Examples ..-----
+0001e920: 2d2d 2d2d 2d0d 0a3e 3e3e 2069 6d70 6f72  -----..>>> impor
+0001e930: 7420 6f73 200d 0a3e 3e3e 2066 726f 6d20  t os ..>>> from 
+0001e940: 7761 7465 782e 6461 7461 7365 7473 2069  watex.datasets i
+0001e950: 6d70 6f72 7420 6665 7463 685f 6461 7461  mport fetch_data
+0001e960: 200d 0a3e 3e3e 2066 726f 6d20 7761 7465   ..>>> from wate
+0001e970: 782e 7574 696c 732e 706c 6f74 7574 696c  x.utils.plotutil
+0001e980: 7320 696d 706f 7274 2070 6c6f 745f 7374  s import plot_st
+0001e990: 7269 6b65 200d 0a3e 3e3e 2066 726f 6d20  rike ..>>> from 
+0001e9a0: 7761 7465 782e 6461 7461 7365 7473 2e5f  watex.datasets._
+0001e9b0: 696f 2069 6d70 6f72 7420 6765 745f 6461  io import get_da
+0001e9c0: 7461 2023 2067 6574 2065 6469 6461 7461  ta # get edidata
+0001e9d0: 2069 6e20 6361 6368 6520 200d 0a3e 3e3e   in cache  ..>>>
+0001e9e0: 2066 6574 6368 5f64 6174 6120 2820 2768   fetch_data ( 'h
+0001e9f0: 7561 7975 616e 272c 2073 616d 706c 6573  uayuan', samples
+0001ea00: 203d 2032 3520 2920 2320 7374 6f72 6520   = 25 ) # store 
+0001ea10: 6564 6920 696e 2063 6163 6865 200d 0a3e  edi in cache ..>
+0001ea20: 3e3e 2023 2067 6574 2074 6865 2065 6469  >> # get the edi
+0001ea30: 2069 6e20 6361 6368 6520 616e 6420 706c   in cache and pl
+0001ea40: 6f74 5374 7269 6b65 200d 0a3e 3e3e 2065  otStrike ..>>> e
+0001ea50: 6469 5f66 6e5f 6c73 7420 3d20 5b6f 732e  di_fn_lst = [os.
+0001ea60: 7061 7468 2e6a 6f69 6e28 6765 745f 6461  path.join(get_da
+0001ea70: 7461 2829 2c66 6629 2066 6f72 2066 6620  ta(),ff) for ff 
+0001ea80: 696e 206f 732e 6c69 7374 6469 7228 6765  in os.listdir(ge
+0001ea90: 745f 6461 7461 2829 2920 0d0a 2e2e 2e20  t_data()) ..... 
+0001eaa0: 2020 2020 2020 2020 6966 2066 662e 656e          if ff.en
+0001eab0: 6473 7769 7468 2827 2e65 6469 2729 5d20  dswith('.edi')] 
+0001eac0: 0d0a 3e3e 3e20 706c 6f74 5f73 7472 696b  ..>>> plot_strik
+0001ead0: 6528 6564 695f 666e 5f6c 7374 2029 0d0a  e(edi_fn_lst )..
+0001eae0: 0d0a 2222 220d 0a64 6566 2070 6c6f 745f  .."""..def plot_
+0001eaf0: 7465 7874 2028 0d0a 2020 2020 782c 2079  text (..    x, y
+0001eb00: 2c20 0d0a 2020 2020 7465 7874 3d4e 6f6e  , ..    text=Non
+0001eb10: 6520 2c20 0d0a 2020 2020 6461 7461 203d  e , ..    data =
+0001eb20: 4e6f 6e65 2c20 0d0a 2020 2020 636f 6572  None, ..    coer
+0001eb30: 6365 203d 4661 6c73 652c 200d 0a20 2020  ce =False, ..   
+0001eb40: 2062 6173 656e 616d 6520 3d27 5327 2c20   basename ='S', 
+0001eb50: 0d0a 2020 2020 6669 675f 7369 7a65 203d  ..    fig_size =
+0001eb60: 2820 372c 2037 2029 2c20 0d0a 2020 2020  ( 7, 7 ), ..    
+0001eb70: 7368 6f77 5f6c 696e 6520 3d46 616c 7365  show_line =False
+0001eb80: 2c20 0d0a 2020 2020 7374 6570 203d 204e  , ..    step = N
+0001eb90: 6f6e 6520 2c20 0d0a 2020 2020 786c 6162  one , ..    xlab
+0001eba0: 656c 203d 2727 2c20 0d0a 2020 2020 796c  el ='', ..    yl
+0001ebb0: 6162 656c 203d 2727 2c20 0d0a 2020 2020  abel ='', ..    
+0001ebc0: 636f 6c6f 723d 4e6f 6e65 2c20 0d0a 2020  color=None, ..  
+0001ebd0: 2020 7368 6f77 5f6c 6567 203d 4661 6c73    show_leg =Fals
+0001ebe0: 652c 0d0a 2020 2020 6c69 6e65 6c61 6265  e,..    linelabe
+0001ebf0: 6c3d 2727 2c20 0d0a 2020 2020 6d61 726b  l='', ..    mark
+0001ec00: 6572 6c61 6265 6c3d 2727 2c20 0d0a 2020  erlabel='', ..  
+0001ec10: 2020 2a2a 7465 7874 5f6b 7773 0d0a 2020    **text_kws..  
+0001ec20: 2020 293a 200d 0a20 2020 2022 2222 2050    ): ..    """ P
+0001ec30: 6c6f 7420 7465 7874 2873 2920 696e 6469  lot text(s) indi
+0001ec40: 6361 7469 6e67 2065 6163 6820 706f 7369  cating each posi
+0001ec50: 7469 6f6e 2069 6e20 7468 6520 6c69 6e65  tion in the line
+0001ec60: 2e20 0d0a 2020 2020 0d0a 2020 2020 5061  . ..    ..    Pa
+0001ec70: 7261 6d65 7465 7273 200d 0a20 2020 202d  rameters ..    -
+0001ec80: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+0001ec90: 782c 2079 3a20 7374 722c 2066 6c6f 6174  x, y: str, float
+0001eca0: 2c20 4172 7261 792d 6c69 6b65 200d 0a20  , Array-like .. 
+0001ecb0: 2020 2020 2020 2054 6865 2070 6f73 6974         The posit
+0001ecc0: 696f 6e20 746f 2070 6c61 6365 2074 6865  ion to place the
+0001ecd0: 2074 6578 742e 2042 7920 6465 6661 756c   text. By defaul
+0001ece0: 742c 2074 6869 7320 6973 2069 6e20 6461  t, this is in da
+0001ecf0: 7461 200d 0a20 2020 2020 2020 2063 6f6f  ta ..        coo
+0001ed00: 7264 696e 6174 6573 2e20 5468 6520 636f  rdinates. The co
+0001ed10: 6f72 6469 6e61 7465 2073 7973 7465 6d20  ordinate system 
+0001ed20: 6361 6e20 6265 2063 6861 6e67 6564 2075  can be changed u
+0001ed30: 7369 6e67 2074 6865 200d 0a20 2020 2020  sing the ..     
+0001ed40: 2020 2074 7261 6e73 666f 726d 2070 6172     transform par
+0001ed50: 616d 6574 6572 2e0d 0a20 2020 2020 2020  ameter...       
+0001ed60: 200d 0a20 2020 2074 6578 743a 2073 7472   ..    text: str
+0001ed70: 2c20 0d0a 2020 2020 2020 2020 5468 6520  , ..        The 
+0001ed80: 7465 7874 0d0a 2020 2020 2020 2020 0d0a  text..        ..
+0001ed90: 2020 2020 6461 7461 3a20 7064 2e44 6174      data: pd.Dat
+0001eda0: 6146 7261 6d65 2c20 0d0a 2020 2020 2020  aFrame, ..      
+0001edb0: 2044 6174 6120 636f 6e74 6169 6e69 6e67   Data containing
+0001edc0: 2078 2061 6e64 2079 206e 616d 6573 2e20   x and y names. 
+0001edd0: 4e65 6564 2074 6f20 6265 2073 7570 706c  Need to be suppl
+0001ede0: 6965 6420 7768 656e 2078 2061 6e64 2079  ied when x and y
+0001edf0: 200d 0a20 2020 2020 2020 6172 6520 6769   ..       are gi
+0001ee00: 7665 6e20 6173 2073 7472 696e 6720 6e61  ven as string na
+0001ee10: 6d65 732e 200d 0a20 2020 2020 2020 0d0a  mes. ..       ..
+0001ee20: 2020 2020 636f 6572 6365 3a62 6f6f 6c2c      coerce:bool,
+0001ee30: 2064 6566 6175 6c74 3d46 616c 7365 200d   default=False .
+0001ee40: 0a20 2020 2020 2020 466f 7263 6520 7468  .       Force th
+0001ee50: 6520 706c 6f74 2064 6573 7069 7465 2074  e plot despite t
+0001ee60: 6865 2067 6976 656e 2074 6578 7465 7320  he given textes 
+0001ee70: 646f 206e 6f74 206d 6174 6368 2074 6865  do not match the
+0001ee80: 206e 756d 6265 7220 6f66 2020 0d0a 2020   number of  ..  
+0001ee90: 2020 2020 2070 6f73 6974 696f 6e73 2060       positions `
+0001eea0: 7860 2061 6e64 2060 7960 2e20 4966 2060  x` and `y`. If `
+0001eeb0: 6046 616c 7365 6060 2c20 6e75 6d62 6572  `False``, number
+0001eec0: 206f 6620 706f 7369 7469 6f6e 7320 6d75   of positions mu
+0001eed0: 7374 2062 6520 0d0a 2020 2020 2020 2063  st be ..       c
+0001eee0: 6f6e 7369 7374 656e 7420 7769 7468 2078  onsistent with x
+0001eef0: 2061 6e64 2079 2c20 6f74 6865 7277 6973   and y, otherwis
+0001ef00: 6520 6572 726f 7220 7261 6973 6573 2e20  e error raises. 
+0001ef10: 0d0a 2020 2020 2020 200d 0a20 2020 2062  ..       ..    b
+0001ef20: 6173 656e 616d 653a 2073 7472 2c20 6465  asename: str, de
+0001ef30: 6661 756c 743d 2753 2720 0d0a 2020 2020  fault='S' ..    
+0001ef40: 2020 2074 6865 2074 6578 7420 746f 2070     the text to p
+0001ef50: 7265 6669 7820 7468 6520 706f 7369 7469  refix the positi
+0001ef60: 6f6e 2077 6865 6e20 7468 6520 7465 7874  on when the text
+0001ef70: 2069 7320 6e6f 7420 6769 7665 6e2e 200d   is not given. .
+0001ef80: 0a20 2020 2020 2020 0d0a 2020 2020 6669  .       ..    fi
+0001ef90: 675f 7369 7a65 3a20 7475 706c 652c 2064  g_size: tuple, d
+0001efa0: 6566 6175 6c74 3d28 372c 2037 2920 0d0a  efault=(7, 7) ..
+0001efb0: 2020 2020 2020 204d 6174 706c 6f74 6c69         Matplotli
+0001efc0: 6220 6669 6775 7265 2073 697a 652e 0d0a  b figure size...
+0001efd0: 2020 2020 2020 200d 0a20 2020 2073 686f         ..    sho
+0001efe0: 775f 6c69 6e65 3a20 626f 6f6c 2c20 6465  w_line: bool, de
+0001eff0: 6661 756c 743d 4661 6c73 6520 0d0a 2020  fault=False ..  
+0001f000: 2020 2020 2044 6973 706c 6179 2074 6865       Display the
+0001f010: 206c 696e 6520 6672 6f6d 2078 2c20 792e   line from x, y.
+0001f020: 200d 0a20 2020 2020 2020 0d0a 2020 2020   ..       ..    
+0001f030: 7374 6570 3a20 696e 742c 4f70 7469 6f6e  step: int,Option
+0001f040: 616c 200d 0a20 2020 2020 2020 5468 6520  al ..       The 
+0001f050: 6e75 6d62 6572 206f 6620 696e 7465 726d  number of interm
+0001f060: 6564 6961 7465 2070 6f73 6974 696f 6e73  ediate positions
+0001f070: 2074 6f20 736b 6970 2069 6e20 7468 6520   to skip in the 
+0001f080: 706c 6f74 7469 6e67 2074 6578 742e 200d  plotting text. .
+0001f090: 0a20 2020 2020 2020 0d0a 2020 2020 786c  .       ..    xl
+0001f0a0: 6162 656c 2c20 796c 6162 656c 3a20 7374  abel, ylabel: st
+0001f0b0: 722c 204f 7074 696f 6e61 6c2c 200d 0a20  r, Optional, .. 
+0001f0c0: 2020 2020 2020 5468 6520 6c61 6265 6c73        The labels
+0001f0d0: 206f 6620 7820 616e 6420 792e 200d 0a20   of x and y. .. 
+0001f0e0: 2020 2063 6f6c 6f72 3a20 7374 722c 204f     color: str, O
+0001f0f0: 7074 696f 6e61 6c20 0d0a 2020 2020 2020  ptional ..      
+0001f100: 204c 696e 6520 636f 6c6f 7220 6966 2060   Line color if `
+0001f110: 7368 6f77 5f6c 696e 6560 2069 7320 7365  show_line` is se
+0001f120: 7420 746f 2060 6054 7275 6560 602e 200d  t to ``True``. .
+0001f130: 0a20 2020 2020 2020 0d0a 2020 2020 7368  .       ..    sh
+0001f140: 6f77 5f6c 6567 3a20 626f 6f6c 2c20 6465  ow_leg: bool, de
+0001f150: 6661 756c 743d 4661 6c73 6520 0d0a 2020  fault=False ..  
+0001f160: 2020 2020 2044 6973 706c 6179 2074 6865       Display the
+0001f170: 206c 6567 656e 6420 6f66 206c 696e 6520   legend of line 
+0001f180: 616e 6420 6d61 726b 6572 206c 6162 656c  and marker label
+0001f190: 732e 200d 0a20 2020 2020 2020 0d0a 2020  s. ..       ..  
+0001f1a0: 2020 6c69 6e65 6c61 6265 6c2c 206d 6172    linelabel, mar
+0001f1b0: 6b65 726c 6162 656c 3a20 7374 722c 204f  kerlabel: str, O
+0001f1c0: 7074 696f 6e61 6c20 0d0a 2020 2020 2020  ptional ..      
+0001f1d0: 2020 5468 6520 6c61 6265 6c73 206f 6620    The labels of 
+0001f1e0: 7468 6520 6c69 6e65 2061 6e64 206d 6172  the line and mar
+0001f1f0: 6b65 722e 200d 0a20 2020 2020 2020 0d0a  ker. ..       ..
+0001f200: 2020 2020 7465 7874 5f6b 7773 3a20 6469      text_kws: di
+0001f210: 6374 2c20 0d0a 2020 2020 2020 204b 6579  ct, ..       Key
+0001f220: 776f 7264 2061 7267 756d 656e 7473 2070  word arguments p
+0001f230: 6173 7365 6420 746f 203a 6d65 7468 3a60  assed to :meth:`
+0001f240: 6d61 7470 6c6f 746c 6962 2e61 7865 732e  matplotlib.axes.
+0001f250: 4178 6573 2e74 6578 7460 2e20 0d0a 0d0a  Axes.text`. ....
+0001f260: 2020 2020 4578 616d 706c 6573 200d 0a20      Examples .. 
+0001f270: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
+0001f280: 203e 3e3e 2069 6d70 6f72 7420 7761 7465   >>> import wate
+0001f290: 7820 6173 2077 7820 0d0a 2020 2020 3e3e  x as wx ..    >>
+0001f2a0: 3e20 6461 7461 203d 7778 2e6d 616b 655f  > data =wx.make_
+0001f2b0: 6572 7020 2861 735f 6672 616d 6520 3d54  erp (as_frame =T
+0001f2c0: 7275 652c 206e 5f73 7461 7469 6f6e 733d  rue, n_stations=
+0001f2d0: 2037 2029 0d0a 2020 2020 3e3e 3e20 7820   7 )..    >>> x 
+0001f2e0: 2c20 7920 3d5b 2030 2c20 312c 2033 205d  , y =[ 0, 1, 3 ]
+0001f2f0: 2c20 5b32 2c20 332c 2036 5d20 0d0a 2020  , [2, 3, 6] ..  
+0001f300: 2020 3e3e 3e20 7465 7874 6f20 3d20 5b27    >>> texto = ['
+0001f310: 414d 542d 4531 3134 3727 2c20 2741 4d54  AMT-E1147', 'AMT
+0001f320: 2d45 3131 3438 272c 2020 2741 4d54 2d45  -E1148',  'AMT-E
+0001f330: 3138 3027 5d0d 0a20 2020 203e 3e3e 2070  180']..    >>> p
+0001f340: 6c6f 745f 7465 7874 2028 782c 2079 202c  lot_text (x, y ,
+0001f350: 2074 6578 7420 3d20 7465 7874 6f29 2320   text = texto)# 
+0001f360: 6e6f 206e 6565 6420 746f 2073 6574 2020  no need to set  
+0001f370: 636f 6572 6365 2c20 7361 6d65 206c 656e  coerce, same len
+0001f380: 6774 6820 0d0a 2020 2020 3e3e 3e20 6461  gth ..    >>> da
+0001f390: 7461 203d 7778 2e6d 616b 655f 6572 7020  ta =wx.make_erp 
+0001f3a0: 2861 735f 6672 616d 6520 3d54 7275 652c  (as_frame =True,
+0001f3b0: 206e 5f73 7461 7469 6f6e 733d 2032 3020   n_stations= 20 
+0001f3c0: 290d 0a20 2020 203e 3e3e 2078 202c 2079  )..    >>> x , y
+0001f3d0: 203d 2064 6174 612e 6561 7374 696e 672c   = data.easting,
+0001f3e0: 2064 6174 612e 6e6f 7274 6869 6e67 0d0a   data.northing..
+0001f3f0: 2020 2020 3e3e 3e20 7465 7874 3120 3d20      >>> text1 = 
+0001f400: 5b27 414d 542d 4531 3134 3727 2c20 2741  ['AMT-E1147', 'A
+0001f410: 4d54 2d45 3131 3438 272c 2020 2741 4d54  MT-E1148',  'AMT
+0001f420: 2d45 3138 3027 5d20 0d0a 2020 2020 3e3e  -E180'] ..    >>
+0001f430: 3e20 706c 6f74 5f74 6578 7420 2878 2c20  > plot_text (x, 
+0001f440: 7920 2c20 636f 6572 6365 203d 5472 7565  y , coerce =True
+0001f450: 202c 2074 6578 7420 3d20 7465 7874 3120   , text = text1 
+0001f460: 2c20 7368 6f77 5f6c 6567 3d20 5472 7565  , show_leg= True
+0001f470: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+0001f480: 2020 2020 2020 2073 686f 775f 6c69 6e65         show_line
+0001f490: 3d54 7275 652c 206c 696e 656c 6162 656c  =True, linelabel
+0001f4a0: 3d27 4531 2d6c 696e 6527 2c20 6d61 726b  ='E1-line', mark
+0001f4b0: 6572 6c61 6265 6c3d 2027 5369 7465 272c  erlabel= 'Site',
+0001f4c0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0001f4d0: 2020 6261 7365 6e61 6d65 203d 2741 4d54    basename ='AMT
+0001f4e0: 2d45 3027 200d 0a20 2020 2020 2020 2020  -E0' ..         
+0001f4f0: 2020 2020 2020 290d 0a20 2020 2022 2222        )..    """
+0001f500: 0d0a 2020 2020 2320 6173 7375 6d65 2078  ..    # assume x
+0001f510: 2c20 7920 2073 6572 6965 7320 6172 6520  , y  series are 
+0001f520: 7061 7373 6564 200d 0a20 2020 2069 6620  passed ..    if 
+0001f530: 6973 696e 7374 616e 6365 2878 2c20 7374  isinstance(x, st
+0001f540: 7229 206f 7220 6861 7361 7474 7220 2820  r) or hasattr ( 
+0001f550: 782c 2027 6e61 6d65 2729 3a20 0d0a 2020  x, 'name'): ..  
+0001f560: 2020 2020 2020 786c 6162 656c 203d 2078        xlabel = x
+0001f570: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0001f580: 782c 2073 7472 2920 656c 7365 2078 2e6e  x, str) else x.n
+0001f590: 616d 6520 0d0a 2020 2020 2020 2020 0d0a  ame ..        ..
+0001f5a0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0001f5b0: 6528 792c 2073 7472 2920 6f72 2068 6173  e(y, str) or has
+0001f5c0: 6174 7472 2028 2079 2c20 276e 616d 6527  attr ( y, 'name'
+0001f5d0: 293a 200d 0a20 2020 2020 2020 2079 6c61  ): ..        yla
+0001f5e0: 6265 6c20 3d20 7920 2069 6620 6973 696e  bel = y  if isin
+0001f5f0: 7374 616e 6365 2879 2c20 7374 7229 2065  stance(y, str) e
+0001f600: 6c73 6520 792e 6e61 6d65 200d 0a20 2020  lse y.name ..   
+0001f610: 2020 2020 200d 0a20 2020 2069 6620 7820       ..    if x 
+0001f620: 6973 204e 6f6e 6520 616e 6420 2079 2069  is None and  y i
+0001f630: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+0001f640: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0001f650: 2822 7820 616e 6420 7920 6172 6520 6e65  ("x and y are ne
+0001f660: 6564 6564 2066 6f72 2074 6578 7420 706c  eded for text pl
+0001f670: 6f74 2e20 4e6f 6e65 5479 7065 220d 0a20  ot. NoneType".. 
+0001f680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f690: 2020 2020 2020 2022 2063 616e 6e6f 7420         " cannot 
+0001f6a0: 6265 2070 6c6f 7474 6564 2e22 2920 2020  be plotted.")   
+0001f6b0: 200d 0a20 2020 2020 2020 200d 0a20 2020   ..        ..   
+0001f6c0: 2078 2c20 7920 3d20 6173 7365 7274 5f78   x, y = assert_x
+0001f6d0: 795f 696e 2878 2c20 792c 2064 6174 6120  y_in(x, y, data 
+0001f6e0: 3d20 6461 7461 2029 200d 0a0d 0a20 2020  = data ) ....   
+0001f6f0: 2069 6620 7465 7874 2069 7320 4e6f 6e65   if text is None
+0001f700: 2061 6e64 206e 6f74 2063 6f65 7263 653a   and not coerce:
+0001f710: 200d 0a20 2020 2020 2020 7261 6973 6520   ..       raise 
+0001f720: 5479 7065 4572 726f 7220 2822 5465 7874  TypeError ("Text
+0001f730: 2063 616e 6e6f 7420 6265 2070 6c6f 7474   cannot be plott
+0001f740: 6564 2e20 546f 2066 6f72 6365 2070 6c6f  ed. To force plo
+0001f750: 7474 696e 6720 7465 7874 2077 6974 6822  tting text with"
+0001f760: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001f770: 2020 2020 2020 2020 2020 2220 7468 6520            " the 
+0001f780: 6261 7365 6e61 6d65 2c20 7365 7420 6060  basename, set ``
+0001f790: 636f 6572 6365 3d54 7275 6560 602e 2229  coerce=True``.")
+0001f7a0: 0d0a 0d0a 2020 2020 7465 7874 203d 2069  ....    text = i
+0001f7b0: 735f 6974 6572 6162 6c65 2874 6578 7420  s_iterable(text 
+0001f7c0: 2c20 6578 636c 7564 655f 7374 7269 6e67  , exclude_string
+0001f7d0: 3d20 5472 7565 202c 2074 7261 6e73 666f  = True , transfo
+0001f7e0: 726d 203d 5472 7565 2029 0d0a 2020 2020  rm =True )..    
+0001f7f0: 0d0a 2020 2020 6966 2028 206c 656e 2874  ..    if ( len(t
+0001f800: 6578 7429 2021 3d20 6c65 6e28 7929 200d  ext) != len(y) .
+0001f810: 0a20 2020 2020 2020 2061 6e64 206e 6f74  .        and not
+0001f820: 2063 6f65 7263 6529 203a 200d 0a20 2020   coerce) : ..   
+0001f830: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0001f840: 4572 726f 7228 2249 6e20 7072 696e 6369  Error("In princi
+0001f850: 706c 6520 7465 7874 2061 7272 6179 2061  ple text array a
+0001f860: 6e64 2078 2f79 206d 7573 7420 6265 2063  nd x/y must be c
+0001f870: 6f6e 7369 7374 656e 742e 220d 0a20 2020  onsistent."..   
+0001f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f890: 2020 2020 2020 6622 2047 6f74 207b 6c65        f" Got {le
+0001f8a0: 6e28 7465 7874 297d 2061 6e64 207b 6c65  n(text)} and {le
+0001f8b0: 6e28 7929 7d2e 2054 6f20 706c 6f74 2061  n(y)}. To plot a
+0001f8c0: 6e79 7761 792c 220d 0a20 2020 2020 2020  nyway,"..       
+0001f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f8e0: 2020 2220 7365 7420 6060 636f 6572 6365    " set ``coerce
+0001f8f0: 3d54 7275 6560 602e 2229 0d0a 2020 2020  =True``.")..    
+0001f900: 6966 2063 6f65 7263 6520 3a20 0d0a 2020  if coerce : ..  
+0001f910: 2020 2020 2020 6261 7365 6e61 6d65 203d        basename =
+0001f920: 7374 7228 6261 7365 6e61 6d65 290d 0a20  str(basename).. 
+0001f930: 2020 2020 2020 2074 6578 7420 2b3d 205b         text += [
+0001f940: 6627 7b62 6173 656e 616d 657d 7b69 2b6c  f'{basename}{i+l
+0001f950: 656e 2874 6578 7429 3a30 327d 2720 666f  en(text):02}' fo
+0001f960: 7220 6920 696e 2072 616e 6765 2028 6c65  r i in range (le
+0001f970: 6e28 7929 2029 5d0d 0a0d 0a20 2020 2069  n(y) )]....    i
+0001f980: 6620 7374 6570 2069 7320 6e6f 7420 4e6f  f step is not No
+0001f990: 6e65 3a20 0d0a 2020 2020 2020 2020 7374  ne: ..        st
+0001f9a0: 6570 203d 205f 6173 7365 7274 5f61 6c6c  ep = _assert_all
+0001f9b0: 5f74 7970 6573 2873 7465 7020 2c20 666c  _types(step , fl
+0001f9c0: 6f61 742c 2069 6e74 202c 206f 626a 6e61  oat, int , objna
+0001f9d0: 6d65 203d 2753 7465 7027 2920 0d0a 2020  me ='Step') ..  
+0001f9e0: 2020 2020 2020 666f 7220 6969 2069 6e20        for ii in 
+0001f9f0: 7261 6e67 6528 6c65 6e28 7465 7874 2929  range(len(text))
+0001fa00: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+0001fa10: 6966 206e 6f74 2069 6925 2073 7465 7020  if not ii% step 
+0001fa20: 3d3d 303a 200d 0a20 2020 2020 2020 2020  ==0: ..         
+0001fa30: 2020 2020 2020 2074 6578 745b 6969 5d3d         text[ii]=
+0001fa40: 2727 0d0a 0d0a 2020 2020 6669 672c 2061  ''....    fig, a
+0001fa50: 7820 3d20 706c 742e 7375 6270 6c6f 7473  x = plt.subplots
+0001fa60: 2831 2c31 2c20 6669 6773 697a 6520 3d66  (1,1, figsize =f
+0001fa70: 6967 5f73 697a 6529 0d0a 2020 2020 0d0a  ig_size)..    ..
+0001fa80: 2020 2020 2320 706c 6f74 203d 2061 782e      # plot = ax.
+0001fa90: 7363 6174 7465 7220 6966 2073 686f 775f  scatter if show_
+0001faa0: 6c69 6e65 2065 6c73 6520 6178 2e70 6c6f  line else ax.plo
+0001fab0: 7420 0d0a 2020 2020 6178 5f6d 203d 204e  t ..    ax_m = N
+0001fac0: 6f6e 6520 0d0a 2020 2020 6966 2073 686f  one ..    if sho
+0001fad0: 775f 6c69 6e65 3a20 0d0a 2020 2020 2020  w_line: ..      
+0001fae0: 2020 6178 2e70 6c6f 7420 2878 2c20 7920    ax.plot (x, y 
+0001faf0: 2c20 6c61 6265 6c20 3d20 6c69 6e65 6c61  , label = linela
+0001fb00: 6265 6c2c 2063 6f6c 6f72 203d 636f 6c6f  bel, color =colo
+0001fb10: 7220 0d0a 2020 2020 2020 2020 2020 2020  r ..            
+0001fb20: 2020 2020 2029 200d 0a20 2020 2020 2020       ) ..       
+0001fb30: 200d 0a20 2020 2066 6f72 2069 782c 2069   ..    for ix, i
+0001fb40: 7920 2c20 6e61 6d65 2069 6e20 7a69 7020  y , name in zip 
+0001fb50: 2878 2c20 792c 2074 6578 7420 293a 200d  (x, y, text ): .
+0001fb60: 0a20 2020 2020 2020 2061 782e 7465 7874  .        ax.text
+0001fb70: 2028 2069 7820 2c20 6979 202c 206e 616d   ( ix , iy , nam
+0001fb80: 6520 2c20 2a2a 7465 7874 5f6b 7773 290d  e , **text_kws).
+0001fb90: 0a20 2020 2020 2020 2069 6620 6e61 6d65  .        if name
+0001fba0: 2021 3d27 273a 0d0a 2020 2020 2020 2020   !='':..        
+0001fbb0: 2020 2061 785f 6d20 203d 2061 782e 7363     ax_m  = ax.sc
+0001fbc0: 6174 7465 7220 2820 5b69 785d 2c20 5b69  atter ( [ix], [i
+0001fbd0: 795d 202c 206d 6172 6b65 7220 3d27 6f27  y] , marker ='o'
+0001fbe0: 2c20 636f 6c6f 7220 3d27 6b27 2c20 0d0a  , color ='k', ..
+0001fbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc00: 2020 2020 2020 2029 0d0a 2020 0d0a 2020         )..  ..  
+0001fc10: 2020 6178 2e73 6574 5f78 6c61 6265 6c20    ax.set_xlabel 
+0001fc20: 2878 6c61 6265 6c29 0d0a 2020 2020 6178  (xlabel)..    ax
+0001fc30: 2e73 6574 5f79 6c61 6265 6c20 2879 6c61  .set_ylabel (yla
+0001fc40: 6265 6c29 200d 0a20 2020 200d 0a20 2020  bel) ..    ..   
+0001fc50: 2061 785f 6d2e 7365 745f 6c61 6265 6c20   ax_m.set_label 
+0001fc60: 2820 6d61 726b 6572 6c61 6265 6c29 2069  ( markerlabel) i
+0001fc70: 6620 6178 5f6d 2069 7320 6e6f 7420 4e6f  f ax_m is not No
+0001fc80: 6e65 2065 6c73 6520 4e6f 6e65 200d 0a20  ne else None .. 
+0001fc90: 2020 200d 0a20 2020 2069 6620 7368 6f77     ..    if show
+0001fca0: 5f6c 6567 203a 200d 0a20 2020 2020 2020  _leg : ..       
+0001fcb0: 2061 782e 6c65 6765 6e64 2028 2920 0d0a   ax.legend () ..
+0001fcc0: 2020 2020 0d0a 6465 6620 706c 6f74 5f76      ..def plot_v
+0001fcd0: 6f72 6f6e 6f69 280d 0a20 2020 2058 2c20  oronoi(..    X, 
+0001fce0: 792c 202a 2c20 0d0a 2020 2020 636c 7573  y, *, ..    clus
+0001fcf0: 7465 725f 6365 6e74 6572 732c 0d0a 2020  ter_centers,..  
+0001fd00: 2020 6178 3d20 4e6f 6e65 2c0d 0a20 2020    ax= None,..   
+0001fd10: 2073 686f 775f 7665 7274 6963 6573 3d46   show_vertices=F
+0001fd20: 616c 7365 2c20 0d0a 2020 2020 6c69 6e65  alse, ..    line
+0001fd30: 5f63 6f6c 6f72 733d 276b 272c 0d0a 2020  _colors='k',..  
+0001fd40: 2020 6c69 6e65 5f77 6964 7468 3d31 2e20    line_width=1. 
+0001fd50: 2c0d 0a20 2020 206c 696e 655f 616c 7068  ,..    line_alph
+0001fd60: 613d 312e 2c20 2020 0d0a 2020 2020 6669  a=1.,   ..    fi
+0001fd70: 675f 7369 7a65 203d 2028 372c 2037 292c  g_size = (7, 7),
+0001fd80: 200d 0a20 2020 2066 6967 5f74 6974 6c65   ..    fig_title
+0001fd90: 203d 2027 270d 0a20 2020 2029 3a0d 0a20   = ''..    ):.. 
+0001fda0: 2020 2022 2222 506c 6f74 7320 7468 6520     """Plots the 
+0001fdb0: 566f 726f 6e6f 6920 6469 6167 7261 6d20  Voronoi diagram 
+0001fdc0: 6f66 2074 6865 206b 2d6d 6561 6e73 2063  of the k-means c
+0001fdd0: 6c75 7374 6572 7320 6f76 6572 6c61 6964  lusters overlaid
+0001fde0: 2077 6974 6820 0d0a 2020 2020 7468 6520   with ..    the 
+0001fdf0: 6461 7461 0d0a 2020 2020 0d0a 2020 2020  data..    ..    
+0001fe00: 5061 7261 6d65 7465 7273 200d 0a20 2020  Parameters ..   
+0001fe10: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020   -----------..  
+0001fe20: 2020 582c 2079 203a 204e 4461 7272 6179    X, y : NDarray
+0001fe30: 2c20 4172 7261 796c 696b 6520 3164 200d  , Arraylike 1d .
+0001fe40: 0a20 2020 2020 2044 6174 6120 7472 6169  .      Data trai
+0001fe50: 6e69 6e67 2058 2061 6e64 2079 2e20 4d75  ning X and y. Mu
+0001fe60: 7374 2068 6176 6520 7468 6520 7361 6d65  st have the same
+0001fe70: 206c 656e 6774 6820 0d0a 2020 2020 636c   length ..    cl
+0001fe80: 7573 7465 725f 6365 6e74 6572 3a20 696e  uster_center: in
+0001fe90: 742c 200d 0a20 2020 2020 2020 436c 7573  t, ..       Clus
+0001fea0: 7465 7220 6365 6e74 6572 2e20 436c 7573  ter center. Clus
+0001feb0: 7465 7220 6365 6e74 6572 2063 616e 2062  ter center can b
+0001fec0: 6520 6f62 7461 696e 2077 6974 6865 204b  e obtain withe K
+0001fed0: 4d65 616e 7320 616c 676f 7269 7468 6d73  Means algorithms
+0001fee0: 200d 0a20 2020 2073 686f 775f 7665 7274   ..    show_vert
+0001fef0: 6963 6573 203a 2062 6f6f 6c2c 206f 7074  ices : bool, opt
+0001ff00: 696f 6e61 6c0d 0a20 2020 2020 2020 2041  ional..        A
+0001ff10: 6464 2074 6865 2056 6f72 6f6e 6f69 2076  dd the Voronoi v
+0001ff20: 6572 7469 6365 7320 746f 2074 6865 2070  ertices to the p
+0001ff30: 6c6f 742e 0d0a 2020 2020 6c69 6e65 5f63  lot...    line_c
+0001ff40: 6f6c 6f72 7320 3a20 7374 7269 6e67 2c20  olors : string, 
+0001ff50: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+0001ff60: 2020 5370 6563 6966 6965 7320 7468 6520    Specifies the 
+0001ff70: 6c69 6e65 2063 6f6c 6f72 2066 6f72 2070  line color for p
+0001ff80: 6f6c 7967 6f6e 2062 6f75 6e64 6172 6965  olygon boundarie
+0001ff90: 730d 0a20 2020 206c 696e 655f 7769 6474  s..    line_widt
+0001ffa0: 6820 3a20 666c 6f61 742c 206f 7074 696f  h : float, optio
+0001ffb0: 6e61 6c0d 0a20 2020 2020 2020 2053 7065  nal..        Spe
+0001ffc0: 6369 6669 6573 2074 6865 206c 696e 6520  cifies the line 
+0001ffd0: 7769 6474 6820 666f 7220 706f 6c79 676f  width for polygo
+0001ffe0: 6e20 626f 756e 6461 7269 6573 0d0a 2020  n boundaries..  
+0001fff0: 2020 6c69 6e65 5f61 6c70 6861 203a 2066    line_alpha : f
+00020000: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0d0a  loat, optional..
+00020010: 2020 2020 2020 2020 5370 6563 6966 6965          Specifie
+00020020: 7320 7468 6520 6c69 6e65 2061 6c70 6861  s the line alpha
+00020030: 2066 6f72 2070 6f6c 7967 6f6e 2062 6f75   for polygon bou
+00020040: 6e64 6172 6965 730d 0a20 2020 2070 6f69  ndaries..    poi
+00020050: 6e74 5f73 697a 6520 3a20 666c 6f61 742c  nt_size : float,
+00020060: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+00020070: 2020 2053 7065 6369 6669 6573 2074 6865     Specifies the
+00020080: 2073 697a 6520 6f66 2070 6f69 6e74 730d   size of points.
+00020090: 0a20 2020 2061 783a 204d 6174 706c 6f74  .    ax: Matplot
+000200a0: 6c69 622e 4178 6573 200d 0a20 2020 2020  lib.Axes ..     
+000200b0: 2020 4d61 706c 6f74 6c69 6220 6178 6573    Maplotlib axes
+000200c0: 2e20 4966 2060 4e6f 6e65 602c 2061 2061  . If `None`, a a
+000200d0: 7869 7320 6973 2063 7265 6174 6564 2069  xis is created i
+000200e0: 6e73 7465 6164 2e20 0d0a 2020 2020 2020  nstead. ..      
+000200f0: 200d 0a20 2020 2066 6967 5f73 697a 653a   ..    fig_size:
+00020100: 2074 7570 6c65 2c20 6465 6661 756c 7420   tuple, default 
+00020110: 3d20 2837 2c20 3729 200d 0a20 2020 2020  = (7, 7) ..     
+00020120: 2020 5369 7a65 206f 6620 7468 6520 6669    Size of the fi
+00020130: 6775 7265 732e 200d 0a20 2020 2020 2020  gures. ..       
+00020140: 0d0a 2020 2020 5265 7475 726e 0d0a 2020  ..    Return..  
+00020150: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2061    -------..    a
+00020160: 783a 204d 6174 706c 6f74 6c69 622e 4178  x: Matplotlib.Ax
+00020170: 6573 200d 0a20 2020 2020 2020 4178 6573  es ..       Axes
+00020180: 2074 6f20 7375 7070 6f72 7420 7468 6520   to support the 
+00020190: 6669 6775 7265 0d0a 2020 2020 2020 200d  figure..       .
+000201a0: 0a20 2020 2045 7861 6d70 6c65 7320 0d0a  .    Examples ..
+000201b0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0d 0a20      ---------.. 
+000201c0: 2020 203e 3e3e 2066 726f 6d20 736b 6c65     >>> from skle
+000201d0: 6172 6e2e 6461 7461 7365 7473 2069 6d70  arn.datasets imp
+000201e0: 6f72 7420 6d61 6b65 5f6d 6f6f 6e73 0d0a  ort make_moons..
+000201f0: 2020 2020 3e3e 3e20 6672 6f6d 2073 6b6c      >>> from skl
+00020200: 6561 726e 2e63 6c75 7374 6572 2069 6d70  earn.cluster imp
+00020210: 6f72 7420 4b4d 6561 6e73 200d 0a20 2020  ort KMeans ..   
+00020220: 203e 3e3e 2066 726f 6d20 7761 7465 782e   >>> from watex.
+00020230: 7574 696c 732e 706c 6f74 7574 696c 7320  utils.plotutils 
+00020240: 696d 706f 7274 2070 6c6f 745f 766f 726f  import plot_voro
+00020250: 6e6f 690d 0a20 2020 203e 3e3e 2058 2c20  noi..    >>> X, 
+00020260: 7920 3d20 6d61 6b65 5f6d 6f6f 6e73 286e  y = make_moons(n
+00020270: 5f73 616d 706c 6573 3d32 3030 302c 206e  _samples=2000, n
+00020280: 6f69 7365 3d30 2e32 290d 0a20 2020 203e  oise=0.2)..    >
+00020290: 3e3e 206b 6d20 3d20 4b4d 6561 6e73 2028  >> km = KMeans (
+000202a0: 6e5f 696e 6974 203d 2761 7574 6f27 292e  n_init ='auto').
+000202b0: 6669 7428 582c 2079 2029 200d 0a20 2020  fit(X, y ) ..   
+000202c0: 203e 3e3e 2070 6c6f 745f 766f 726f 6e6f   >>> plot_vorono
+000202d0: 6920 2820 582c 2079 202c 2063 6c75 7374  i ( X, y , clust
+000202e0: 6572 5f63 656e 7465 7273 203d 206b 6d2e  er_centers = km.
+000202f0: 636c 7573 7465 725f 6365 6e74 6572 735f  cluster_centers_
+00020300: 2920 0d0a 2020 2020 2222 220d 0a20 2020  ) ..    """..   
+00020310: 2058 2c20 7920 3d20 6368 6563 6b5f 585f   X, y = check_X_
+00020320: 7928 582c 2079 2c20 290d 0a20 2020 2063  y(X, y, )..    c
+00020330: 6c75 7374 6572 5f63 656e 7465 7273 203d  luster_centers =
+00020340: 2063 6865 636b 5f61 7272 6179 2863 6c75   check_array(clu
+00020350: 7374 6572 5f63 656e 7465 7273 2029 0d0a  ster_centers )..
+00020360: 2020 2020 0d0a 2020 2020 6966 2061 7820      ..    if ax 
+00020370: 6973 204e 6f6e 653a 200d 0a20 2020 2020  is None: ..     
+00020380: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
+00020390: 2e73 7562 706c 6f74 7328 312c 312c 2066  .subplots(1,1, f
+000203a0: 6967 7369 7a65 203d 6669 675f 7369 7a65  igsize =fig_size
+000203b0: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+000203c0: 2066 726f 6d20 7363 6970 792e 7370 6174   from scipy.spat
+000203d0: 6961 6c20 696d 706f 7274 2056 6f72 6f6e  ial import Voron
+000203e0: 6f69 2c20 766f 726f 6e6f 695f 706c 6f74  oi, voronoi_plot
+000203f0: 5f32 640d 0a20 2020 200d 0a20 2020 2061  _2d..    ..    a
+00020400: 782e 7363 6174 7465 7228 585b 3a2c 2030  x.scatter(X[:, 0
+00020410: 5d2c 2058 5b3a 2c20 315d 2c20 633d 792c  ], X[:, 1], c=y,
+00020420: 2063 6d61 703d 2753 6574 3127 2c20 616c   cmap='Set1', al
+00020430: 7068 613d 302e 322c 200d 0a20 2020 2020  pha=0.2, ..     
+00020440: 2020 2020 2020 2020 2020 6c61 6265 6c20            label 
+00020450: 3d20 2756 6f72 6f6e 6f69 2070 6c6f 7427  = 'Voronoi plot'
+00020460: 290d 0a20 2020 2076 6f72 203d 2056 6f72  )..    vor = Vor
+00020470: 6f6e 6f69 2863 6c75 7374 6572 5f63 656e  onoi(cluster_cen
+00020480: 7465 7273 290d 0a20 2020 2076 6f72 6f6e  ters)..    voron
+00020490: 6f69 5f70 6c6f 745f 3264 2876 6f72 2c20  oi_plot_2d(vor, 
+000204a0: 6178 3d61 782c 2073 686f 775f 7665 7274  ax=ax, show_vert
+000204b0: 6963 6573 3d73 686f 775f 7665 7274 6963  ices=show_vertic
+000204c0: 6573 2c20 0d0a 2020 2020 2020 2020 2020  es, ..          
+000204d0: 2020 2020 2020 2020 2020 616c 7068 613d            alpha=
+000204e0: 302e 352c 200d 0a20 2020 2020 2020 2020  0.5, ..         
+000204f0: 2020 2020 2020 2020 2020 206c 696e 655f             line_
+00020500: 636f 6c6f 7273 3d6c 696e 655f 636f 6c6f  colors=line_colo
+00020510: 7273 2c0d 0a20 2020 2020 2020 2020 2020  rs,..           
+00020520: 2020 2020 2020 2020 206c 696e 655f 7769           line_wi
+00020530: 6474 683d 6c69 6e65 5f77 6964 7468 202c  dth=line_width ,
+00020540: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00020550: 2020 2020 2020 6c69 6e65 5f61 6c70 6861        line_alpha
+00020560: 3d6c 696e 655f 616c 7068 612c 2020 0d0a  =line_alpha,  ..
+00020570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020580: 2020 2020 290d 0a20 2020 2023 6178 2e6c      )..    #ax.l
+00020590: 6567 656e 6428 2920 0d0a 2020 2020 6178  egend() ..    ax
+000205a0: 2e73 6574 5f74 6974 6c65 2028 6669 675f  .set_title (fig_
+000205b0: 7469 746c 6520 2c20 666f 6e74 7369 7a65  title , fontsize
+000205c0: 3d32 3029 0d0a 2020 2020 2366 6967 2e73  =20)..    #fig.s
+000205d0: 7570 7469 746c 6528 6669 675f 7469 746c  uptitle(fig_titl
+000205e0: 652c 2066 6f6e 7473 697a 653d 3230 2920  e, fontsize=20) 
+000205f0: 0d0a 2020 2020 0d0a 2020 2020 7265 7475  ..    ..    retu
+00020600: 726e 2061 7820 0d0a 200d 0a20 2020 200d  rn ax .. ..    .
+00020610: 0a64 6566 205f 6d61 6b65 5f61 7865 5f6d  .def _make_axe_m
+00020620: 756c 7469 706c 6520 2820 6e2c 206e 636f  ultiple ( n, nco
+00020630: 6c73 203d 2033 202c 2066 6967 5f73 697a  ls = 3 , fig_siz
+00020640: 6520 3d4e 6f6e 652c 2066 6967 203d 4e6f  e =None, fig =No
+00020650: 6e65 2c20 6178 3d20 2e2e 2e20 293a 200d  ne, ax= ... ): .
+00020660: 0a20 2020 2022 2222 204d 616b 6520 6d75  .    """ Make mu
+00020670: 6c74 6970 6c65 2073 7562 706c 6f74 2061  ltiple subplot a
+00020680: 7865 7320 6672 6f6d 206e 756d 6265 7220  xes from number 
+00020690: 6f66 206f 626a 6563 7473 2e20 2222 220d  of objects. """.
+000206a0: 0a20 2020 2069 6620 6973 5f69 7465 7261  .    if is_itera
+000206b0: 626c 6520 286e 293a 200d 0a20 2020 2020  ble (n): ..     
+000206c0: 2020 6e20 3d20 6c65 6e28 6e29 200d 0a20    n = len(n) .. 
+000206d0: 2020 2020 0d0a 2020 2020 6e72 6f77 7320      ..    nrows 
+000206e0: 3d20 6e20 2f2f 206e 636f 6c73 202b 2028  = n // ncols + (
+000206f0: 206e 2025 206e 636f 6c73 2029 200d 0a20   n % ncols ) .. 
+00020700: 2020 2069 6620 6e72 6f77 7320 3d3d 303a     if nrows ==0:
+00020710: 200d 0a20 2020 2020 2020 6e72 6f77 7320   ..       nrows 
+00020720: 3d31 200d 0a20 2020 2020 2020 0d0a 2020  =1 ..       ..  
+00020730: 2020 6966 2061 7820 696e 2028 202e 2e2e    if ax in ( ...
+00020740: 202c 204e 6f6e 6529 203a 200d 0a20 2020   , None) : ..   
+00020750: 2020 2020 2066 6967 2c20 6178 203d 2070       fig, ax = p
+00020760: 6c74 2e73 7562 706c 6f74 7320 286e 726f  lt.subplots (nro
+00020770: 7773 2c20 6e63 6f6c 732c 2066 6967 7369  ws, ncols, figsi
+00020780: 7a65 203d 2066 6967 5f73 697a 6520 2920  ze = fig_size ) 
+00020790: 200d 0a20 2020 200d 0a20 2020 2072 6574   ..    ..    ret
+000207a0: 7572 6e20 6669 6720 2c20 6178 200d 0a20  urn fig , ax .. 
+000207b0: 2020 200d 0a64 6566 2070 6c6f 745f 726f     ..def plot_ro
+000207c0: 635f 6375 7276 6573 2028 0d0a 2020 2063  c_curves (..   c
+000207d0: 6c66 732c 202f 2c20 0d0a 2020 2058 2c20  lfs, /, ..   X, 
+000207e0: 792c 200d 0a20 2020 6e61 6d65 7320 3d2e  y, ..   names =.
+000207f0: 2e2e 2c20 0d0a 2020 2063 6f6c 6f72 7320  .., ..   colors 
+00020800: 3d2e 2e2e 2c20 0d0a 2020 206e 636f 6c73  =..., ..   ncols
+00020810: 203d 2033 2c20 0d0a 2020 2067 6574 5f73   = 3, ..   get_s
+00020820: 636f 7265 3d46 616c 7365 2c20 0d0a 2020  core=False, ..  
+00020830: 2061 6c6c 3d46 616c 7365 2c0d 0a20 2020   all=False,..   
+00020840: 6178 203d 204e 6f6e 652c 2020 0d0a 2020  ax = None,  ..  
+00020850: 2066 6967 5f73 697a 653d 2820 372c 2037   fig_size=( 7, 7
+00020860: 292c 200d 0a20 2020 2a2a 726f 635f 6b77  ), ..   **roc_kw
+00020870: 7320 293a 200d 0a20 2020 2022 2222 2051  s ): ..    """ Q
+00020880: 7569 636b 2070 6c6f 7420 6f66 2052 6563  uick plot of Rec
+00020890: 6569 7669 6e67 204f 7065 7261 7469 6e67  eiving Operating
+000208a0: 2043 6861 7261 6374 6572 6973 6374 6963   Characterisctic
+000208b0: 2028 524f 4329 206f 6620 6669 7474 6564   (ROC) of fitted
+000208c0: 206d 6f64 656c 7320 0d0a 2020 2020 0d0a   models ..    ..
+000208d0: 2020 2020 5061 7261 6d65 7465 7273 200d      Parameters .
+000208e0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d  .    -----------
+000208f0: 2d0d 0a20 2020 2063 6c66 733a 206c 6973  -..    clfs: lis
+00020900: 742c 200d 0a20 2020 2020 2020 6c69 7374  t, ..       list
+00020910: 206f 6620 6d6f 6465 6c73 2066 6f72 2052   of models for R
+00020920: 4f43 2065 7661 6c75 6174 696f 6e2e 204d  OC evaluation. M
+00020930: 6f64 656c 2073 686f 756c 6420 6265 2061  odel should be a
+00020940: 2073 6369 6b69 742d 6c65 6172 6e20 0d0a   scikit-learn ..
+00020950: 2020 2020 2020 206f 7220 2058 4742 6f6f         or  XGBoo
+00020960: 7374 2065 7374 696d 6174 6f72 7320 0d0a  st estimators ..
+00020970: 2020 2020 2020 200d 0a20 2020 2058 203a         ..    X :
+00020980: 207b 6172 7261 792d 6c69 6b65 2c20 7370   {array-like, sp
+00020990: 6172 7365 206d 6174 7269 787d 206f 6620  arse matrix} of 
+000209a0: 7368 6170 6520 286e 5f73 616d 706c 6573  shape (n_samples
+000209b0: 2c20 6e5f 6665 6174 7572 6573 290d 0a20  , n_features).. 
+000209c0: 2020 2020 2020 2054 7261 696e 696e 6720         Training 
+000209d0: 696e 7374 616e 6365 7320 746f 2063 6c75  instances to clu
+000209e0: 7374 6572 2e20 4974 206d 7573 7420 6265  ster. It must be
+000209f0: 206e 6f74 6564 2074 6861 7420 7468 6520   noted that the 
+00020a00: 6461 7461 0d0a 2020 2020 2020 2020 7769  data..        wi
+00020a10: 6c6c 2062 6520 636f 6e76 6572 7465 6420  ll be converted 
+00020a20: 746f 2043 206f 7264 6572 696e 672c 2077  to C ordering, w
+00020a30: 6869 6368 2077 696c 6c20 6361 7573 6520  hich will cause 
+00020a40: 6120 6d65 6d6f 7279 0d0a 2020 2020 2020  a memory..      
+00020a50: 2020 636f 7079 2069 6620 7468 6520 6769    copy if the gi
+00020a60: 7665 6e20 6461 7461 2069 7320 6e6f 7420  ven data is not 
+00020a70: 432d 636f 6e74 6967 756f 7573 2e0d 0a20  C-contiguous... 
+00020a80: 2020 2020 2020 2049 6620 6120 7370 6172         If a spar
+00020a90: 7365 206d 6174 7269 7820 6973 2070 6173  se matrix is pas
+00020aa0: 7365 642c 2061 2063 6f70 7920 7769 6c6c  sed, a copy will
+00020ab0: 2062 6520 6d61 6465 2069 6620 6974 2773   be made if it's
+00020ac0: 206e 6f74 2069 6e0d 0a20 2020 2020 2020   not in..       
+00020ad0: 2043 5352 2066 6f72 6d61 742e 0d0a 2020   CSR format...  
+00020ae0: 2020 0d0a 2020 2020 7920 3a20 6e64 6172    ..    y : ndar
+00020af0: 7261 7920 6f72 2053 6572 6965 7320 6f66  ray or Series of
+00020b00: 206c 656e 6774 6820 286e 5f73 616d 706c   length (n_sampl
+00020b10: 6573 2c20 290d 0a20 2020 2020 2020 2041  es, )..        A
+00020b20: 6e20 6172 7261 7920 6f72 2073 6572 6965  n array or serie
+00020b30: 7320 6f66 2074 6172 6765 7420 6f72 2063  s of target or c
+00020b40: 6c61 7373 2076 616c 7565 732e 2050 7265  lass values. Pre
+00020b50: 6665 7261 626c 792c 2074 6865 2061 7272  ferably, the arr
+00020b60: 6179 200d 0a20 2020 2020 2020 2072 6570  ay ..        rep
+00020b70: 7265 7365 6e74 2074 6865 2074 6573 7420  resent the test 
+00020b80: 636c 6173 7320 6c61 6265 6c73 2064 6174  class labels dat
+00020b90: 6120 666f 7220 6572 726f 7220 6576 616c  a for error eval
+00020ba0: 7561 7469 6f6e 2e20 200d 0a20 2020 200d  uation.  ..    .
+00020bb0: 0a20 2020 2063 6f6c 6f72 7320 3a20 7374  .    colors : st
+00020bc0: 722c 206c 6973 7420 0d0a 2020 2020 2020  r, list ..      
+00020bd0: 2043 6f6c 6f72 7320 746f 2073 7065 6369   Colors to speci
+00020be0: 6679 2065 6163 6820 6d6f 6465 6c20 706c  fy each model pl
+00020bf0: 6f74 2e20 0d0a 2020 2020 2020 200d 0a20  ot. ..       .. 
+00020c00: 2020 206e 636f 6c73 3a20 696e 742c 2064     ncols: int, d
+00020c10: 6566 6175 6c74 3d33 200d 0a20 2020 2020  efault=3 ..     
+00020c20: 2020 4e75 6d62 6572 206f 6620 706c 6f74    Number of plot
+00020c30: 2074 6f20 6265 2070 6c61 6365 6420 696e   to be placed in
+00020c40: 6c69 6e65 2062 6566 6f72 6520 736b 6970  line before skip
+00020c50: 7069 6e67 2074 6f20 7468 6520 6e65 7874  ping to the next
+00020c60: 2063 6f6c 756d 6e2e 200d 0a20 2020 2020   column. ..     
+00020c70: 2020 5468 6973 2069 7320 6665 6173 6962    This is feasib
+00020c80: 6c65 2069 6620 606d 616e 7960 2069 7320  le if `many` is 
+00020c90: 7365 7420 746f 2060 6054 7275 6560 602e  set to ``True``.
+00020ca0: 200d 0a20 2020 2020 2020 0d0a 2020 2020   ..       ..    
+00020cb0: 6765 745f 7363 6f72 653a 2062 6f6f 6c2c  get_score: bool,
+00020cc0: 6465 6661 756c 743d 5472 7565 0d0a 2020  default=True..  
+00020cd0: 2020 2020 4170 7065 6e64 2074 6865 2041      Append the A
+00020ce0: 7265 6120 556e 6465 7220 7468 6520 6375  rea Under the cu
+00020cf0: 7276 6520 746f 206c 6567 656e 642e 200d  rve to legend. .
+00020d00: 0a20 2020 2020 200d 0a20 2020 2020 202e  .      ..      .
+00020d10: 2e20 7665 7273 696f 6e61 6464 6564 3a3a  . versionadded::
+00020d20: 2030 2e32 2e34 200d 0a20 2020 2020 200d   0.2.4 ..      .
+00020d30: 0a20 2020 2061 6c6c 3a20 7374 722c 2064  .    all: str, d
+00020d40: 6566 6175 6c74 3d46 616c 7365 200d 0a20  efault=False .. 
+00020d50: 2020 2020 2020 6966 2060 6054 7275 6560        if ``True`
+00020d60: 602c 2070 6c6f 7420 6561 6368 2052 4f43  `, plot each ROC
+00020d70: 206d 6f64 656c 2073 6570 6172 6174 656c   model separatel
+00020d80: 7920 0d0a 2020 2020 200d 0a20 2020 206e  y ..     ..    n
+00020d90: 616d 6573 3a20 6c69 7374 2c20 0d0a 2020  ames: list, ..  
+00020da0: 2020 2020 204c 6973 7420 6f66 206d 6f64       List of mod
+00020db0: 656c 206e 616d 6573 2e20 4966 206e 6f74  el names. If not
+00020dc0: 2067 6976 656e 2c20 6120 7261 7720 6e61   given, a raw na
+00020dd0: 6d65 206f 6620 7468 6520 6d6f 6465 6c20  me of the model 
+00020de0: 6973 2070 6173 7365 6420 0d0a 2020 2020  is passed ..    
+00020df0: 2020 2069 6e73 7465 6164 2e0d 0a20 2020     instead...   
+00020e00: 2020 2020 0d0a 2020 2020 6b77 733a 2064      ..    kws: d
+00020e10: 6963 742c 0d0a 2020 2020 2020 2020 6b65  ict,..        ke
+00020e20: 7977 6f72 6420 6172 6775 6d65 6e74 206f  yword argument o
+00020e30: 6620 3a66 756e 633a 6073 6b6c 6561 726e  f :func:`sklearn
+00020e40: 2e6d 6574 7269 6373 2e72 6f63 5f63 7572  .metrics.roc_cur
+00020e50: 7665 200d 0a20 2020 2020 2020 200d 0a20  ve ..        .. 
+00020e60: 2020 2052 6574 7572 6e0d 0a20 2020 202d     Return..    -
+00020e70: 2d2d 2d2d 2d2d 0d0a 2020 2020 6178 3a20  ------..    ax: 
+00020e80: 4178 6573 2e53 7562 706c 6f74 2e20 0d0a  Axes.Subplot. ..
+00020e90: 2020 2020 0d0a 2020 2020 4578 616d 706c      ..    Exampl
+00020ea0: 6573 200d 0a20 2020 202d 2d2d 2d2d 2d2d  es ..    -------
+00020eb0: 2d0d 0a20 2020 203e 3e3e 2066 726f 6d20  -..    >>> from 
+00020ec0: 7761 7465 782e 7574 696c 732e 706c 6f74  watex.utils.plot
+00020ed0: 7574 696c 7320 696d 706f 7274 2070 6c6f  utils import plo
+00020ee0: 745f 726f 635f 6375 7276 6573 200d 0a20  t_roc_curves .. 
+00020ef0: 2020 203e 3e3e 2066 726f 6d20 736b 6c65     >>> from skle
+00020f00: 6172 6e2e 6461 7461 7365 7473 2069 6d70  arn.datasets imp
+00020f10: 6f72 7420 6d61 6b65 5f6d 6f6f 6e73 200d  ort make_moons .
+00020f20: 0a20 2020 203e 3e3e 2066 726f 6d20 7761  .    >>> from wa
+00020f30: 7465 782e 6578 6c69 6220 696d 706f 7274  tex.exlib import
+00020f40: 2028 2074 7261 696e 5f74 6573 745f 7370   ( train_test_sp
+00020f50: 6c69 742c 204b 4e65 6967 6862 6f72 7343  lit, KNeighborsC
+00020f60: 6c61 7373 6966 6965 722c 2053 5643 202c  lassifier, SVC ,
+00020f70: 0d0a 2020 2020 5847 4243 6c61 7373 6966  ..    XGBClassif
+00020f80: 6965 722c 204c 6f67 6973 7469 6352 6567  ier, LogisticReg
+00020f90: 7265 7373 696f 6e20 2920 0d0a 2020 2020  ression ) ..    
+00020fa0: 3e3e 3e20 582c 2079 203d 206d 616b 655f  >>> X, y = make_
+00020fb0: 6d6f 6f6e 7320 286e 5f73 616d 706c 6573  moons (n_samples
+00020fc0: 3d32 3030 302c 206e 6f69 7365 3d30 2e32  =2000, noise=0.2
+00020fd0: 290d 0a20 2020 203e 3e3e 2058 2c20 5874  )..    >>> X, Xt
+00020fe0: 2c20 792c 2079 7420 3d20 7472 6169 6e5f  , y, yt = train_
+00020ff0: 7465 7374 5f73 706c 6974 2028 582c 2079  test_split (X, y
+00021000: 2c20 7465 7374 5f73 697a 653d 302e 3229  , test_size=0.2)
+00021010: 200d 0a20 2020 203e 3e3e 2063 6c66 7320   ..    >>> clfs 
+00021020: 3d20 5b20 6d28 292e 6669 7428 582c 2079  = [ m().fit(X, y
+00021030: 2920 666f 7220 6d20 696e 2028 204b 4e65  ) for m in ( KNe
+00021040: 6967 6862 6f72 7343 6c61 7373 6966 6965  ighborsClassifie
+00021050: 722c 2053 5643 202c 200d 0a20 2020 2020  r, SVC , ..     
+00021060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021080: 2020 2020 5847 4243 6c61 7373 6966 6965      XGBClassifie
+00021090: 722c 204c 6f67 6973 7469 6352 6567 7265  r, LogisticRegre
+000210a0: 7373 696f 6e29 5d0d 0a20 2020 203e 3e3e  ssion)]..    >>>
+000210b0: 2070 6c6f 745f 726f 635f 6375 7276 6573   plot_roc_curves
+000210c0: 2863 6c66 732c 2058 742c 2079 7429 0d0a  (clfs, Xt, yt)..
+000210d0: 2020 2020 4f75 745b 3636 5d3a 203c 4178      Out[66]: <Ax
+000210e0: 6573 5375 6270 6c6f 743a 786c 6162 656c  esSubplot:xlabel
+000210f0: 3d27 4661 6c73 6520 506f 7369 7469 7665  ='False Positive
+00021100: 2052 6174 6520 2846 5052 2927 2c20 796c   Rate (FPR)', yl
+00021110: 6162 656c 3d27 5472 7565 2050 6f73 6974  abel='True Posit
+00021120: 6976 6520 5261 7465 2028 4650 5229 273e  ive Rate (FPR)'>
+00021130: 0d0a 2020 2020 3e3e 3e20 706c 6f74 5f72  ..    >>> plot_r
+00021140: 6f63 5f63 7572 7665 7328 636c 6673 2c20  oc_curves(clfs, 
+00021150: 5874 2c20 7974 2c61 6c6c 3d54 7275 652c  Xt, yt,all=True,
+00021160: 206e 636f 6c73 203d 2034 202c 2066 6967   ncols = 4 , fig
+00021170: 5f73 697a 6520 3d20 2831 302c 2034 2929  _size = (10, 4))
+00021180: 0d0a 2020 2020 2222 220d 0a20 2020 2066  ..    """..    f
+00021190: 726f 6d20 2e76 616c 6964 6174 6f72 2069  rom .validator i
+000211a0: 6d70 6f72 7420 2067 6574 5f65 7374 696d  mport  get_estim
+000211b0: 6174 6f72 5f6e 616d 650d 0a20 2020 200d  ator_name..    .
+000211c0: 0a20 2020 2064 6566 2070 6c6f 745f 726f  .    def plot_ro
+000211d0: 6328 6d6f 6465 6c2c 2064 6174 612c 206c  c(model, data, l
+000211e0: 6162 656c 732c 2067 6574 5f73 636f 7265  abels, get_score
+000211f0: 203d 4661 6c73 6520 293a 0d0a 2020 2020   =False ):..    
+00021200: 2020 2020 6966 2068 6173 6174 7472 286d      if hasattr(m
+00021210: 6f64 656c 2c20 2264 6563 6973 696f 6e5f  odel, "decision_
+00021220: 6675 6e63 7469 6f6e 2229 3a0d 0a20 2020  function"):..   
+00021230: 2020 2020 2020 2020 2070 7265 6469 6374           predict
+00021240: 696f 6e73 203d 206d 6f64 656c 2e64 6563  ions = model.dec
+00021250: 6973 696f 6e5f 6675 6e63 7469 6f6e 2864  ision_function(d
+00021260: 6174 6129 0d0a 2020 2020 2020 2020 656c  ata)..        el
+00021270: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00021280: 2070 7265 6469 6374 696f 6e73 203d 206d   predictions = m
+00021290: 6f64 656c 2e70 7265 6469 6374 5f70 726f  odel.predict_pro
+000212a0: 6261 2864 6174 6129 5b3a 2c31 5d0d 0a20  ba(data)[:,1].. 
+000212b0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+000212c0: 2020 2020 2066 7072 2c20 7470 722c 205f       fpr, tpr, _
+000212d0: 203d 2072 6f63 5f63 7572 7665 286c 6162   = roc_curve(lab
+000212e0: 656c 732c 2070 7265 6469 6374 696f 6e73  els, predictions
+000212f0: 2c20 2a2a 726f 635f 6b77 7320 290d 0a20  , **roc_kws ).. 
+00021300: 2020 2020 2020 2061 7563 5f73 636f 7265         auc_score
+00021310: 203d 204e 6f6e 6520 0d0a 2020 2020 2020   = None ..      
+00021320: 2020 6966 2067 6574 5f73 636f 7265 3a20    if get_score: 
+00021330: 0d0a 2020 2020 2020 2020 2020 2020 6175  ..            au
+00021340: 635f 7363 6f72 6520 3d20 726f 635f 6175  c_score = roc_au
+00021350: 635f 7363 6f72 6520 2820 6c61 6265 6c73  c_score ( labels
+00021360: 2c20 7072 6564 6963 7469 6f6e 732c 290d  , predictions,).
+00021370: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00021380: 2020 2020 2020 2072 6574 7572 6e20 6670         return fp
+00021390: 722c 2074 7072 202c 2061 7563 5f73 636f  r, tpr , auc_sco
+000213a0: 7265 0d0a 2020 2020 0d0a 2020 2020 6966  re..    ..    if
+000213b0: 206e 6f74 2069 735f 6974 6572 6162 6c65   not is_iterable
+000213c0: 2028 2063 6c66 7329 3a20 0d0a 2020 2020   ( clfs): ..    
+000213d0: 2020 2063 6c66 7320 3d20 6973 5f69 7465     clfs = is_ite
+000213e0: 7261 626c 6520 2820 636c 6673 2c20 6578  rable ( clfs, ex
+000213f0: 636c 7564 655f 7374 7269 6e67 203d 5472  clude_string =Tr
+00021400: 7565 202c 2074 7261 6e73 666f 726d 203d  ue , transform =
+00021410: 5472 7565 2029 200d 0a20 2020 2020 2020  True ) ..       
+00021420: 0d0a 2020 2020 2320 6d61 6b65 2064 6566  ..    # make def
+00021430: 6175 6c74 5f63 6f6c 6f72 7320 0d0a 2020  ault_colors ..  
+00021440: 2020 636f 6c6f 7273 203d 206d 616b 655f    colors = make_
+00021450: 706c 6f74 5f63 6f6c 6f72 7328 636c 6673  plot_colors(clfs
+00021460: 2c20 636f 6c6f 7273 203d 2063 6f6c 6f72  , colors = color
+00021470: 7320 290d 0a20 2020 2023 2073 6176 6520  s )..    # save 
+00021480: 7468 6520 6e61 6d65 206f 6620 6d6f 6465  the name of mode
+00021490: 6c73 200d 0a20 2020 206e 616d 6573 203d  ls ..    names =
+000214a0: 206d 616b 655f 6f62 6a5f 636f 6e73 6973   make_obj_consis
+000214b0: 7465 6e74 5f69 6620 280d 0a20 2020 2020  tent_if (..     
+000214c0: 2020 206e 616d 6573 202c 205b 2067 6574     names , [ get
+000214d0: 5f65 7374 696d 6174 6f72 5f6e 616d 6528  _estimator_name(
+000214e0: 6d29 2066 6f72 206d 2069 6e20 636c 6673  m) for m in clfs
+000214f0: 205d 2920 0d0a 0d0a 2020 2020 2320 6368   ]) ....    # ch
+00021500: 6563 6b20 7768 6574 6865 7220 7468 6520  eck whether the 
+00021510: 6d6f 6465 6c20 6973 2066 6974 7465 6420  model is fitted 
+00021520: 0d0a 2020 2020 6966 2061 6c6c 3a20 0d0a  ..    if all: ..
+00021530: 2020 2020 2020 2020 6669 672c 2061 7820          fig, ax 
+00021540: 3d20 5f6d 616b 655f 6178 655f 6d75 6c74  = _make_axe_mult
+00021550: 6970 6c65 2028 200d 0a20 2020 2020 2020  iple ( ..       
+00021560: 2020 2020 2063 6c66 732c 206e 636f 6c73       clfs, ncols
+00021570: 203d 206e 636f 6c73 202c 2061 7820 3d20   = ncols , ax = 
+00021580: 6178 2c20 6669 675f 7369 7a65 203d 2066  ax, fig_size = f
+00021590: 6967 5f73 697a 6520 0d0a 2020 2020 2020  ig_size ..      
+000215a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000215b0: 2020 2020 2020 2020 2020 2020 2920 0d0a              ) ..
+000215c0: 2020 2020 2020 2020 0d0a 2020 2020 656c          ..    el
+000215d0: 7365 3a20 0d0a 2020 2020 2020 2020 6966  se: ..        if
+000215e0: 2061 7820 6973 204e 6f6e 653a 200d 0a20   ax is None: .. 
+000215f0: 2020 2020 2020 2020 2020 2066 6967 2c20             fig, 
+00021600: 6178 203d 2070 6c74 2e73 7562 706c 6f74  ax = plt.subplot
+00021610: 7320 2831 2c20 312c 2066 6967 7369 7a65  s (1, 1, figsize
+00021620: 203d 2066 6967 5f73 697a 6520 2920 200d   = fig_size )  .
+00021630: 0a20 2020 200d 0a20 2020 2066 6f72 206b  .    ..    for k
+00021640: 2c20 2820 6d6f 6465 6c2c 206e 616d 6529  , ( model, name)
+00021650: 2020 696e 2065 6e75 6d65 7261 7465 2028    in enumerate (
+00021660: 7a69 7020 2863 6c66 732c 206e 616d 6573  zip (clfs, names
+00021670: 2029 293a 200d 0a20 2020 2020 2020 2063   )): ..        c
+00021680: 6865 636b 5f69 735f 6669 7474 6564 286d  heck_is_fitted(m
+00021690: 6f64 656c 2029 0d0a 2020 2020 2020 2020  odel )..        
+000216a0: 6670 722c 2074 7072 2c20 6175 635f 7363  fpr, tpr, auc_sc
+000216b0: 6f72 6520 3d20 706c 6f74 5f72 6f63 286d  ore = plot_roc(m
+000216c0: 6f64 656c 2c20 582c 2079 2c20 6765 745f  odel, X, y, get_
+000216d0: 7363 6f72 6529 0d0a 0d0a 2020 2020 2020  score)....      
+000216e0: 2020 6966 2068 6173 6174 7472 2028 6178    if hasattr (ax
+000216f0: 2c20 275f 5f6c 656e 5f5f 2729 3a20 0d0a  , '__len__'): ..
+00021700: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00021710: 656e 2861 782e 7368 6170 6529 3e31 3a20  en(ax.shape)>1: 
+00021720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021730: 2020 692c 206a 2020 3d20 206b 202f 2f20    i, j  =  k // 
+00021740: 6e63 6f6c 7320 2c20 6b20 2520 6e63 6f6c  ncols , k % ncol
+00021750: 7320 0d0a 2020 2020 2020 2020 2020 2020  s ..            
+00021760: 2020 2020 6178 6520 3d20 6178 205b 692c      axe = ax [i,
+00021770: 206a 5d0d 0a20 2020 2020 2020 2020 2020   j]..           
+00021780: 2065 6c73 653a 2061 7865 203d 2061 785b   else: axe = ax[
+00021790: 6b5d 0d0a 2020 2020 2020 2020 656c 7365  k]..        else
+000217a0: 3a20 6178 6520 3d20 6178 200d 0a20 2020  : axe = ax ..   
+000217b0: 2020 2020 2020 2020 200d 0a0d 0a20 2020           ....   
+000217c0: 2020 2020 2061 7865 2e70 6c6f 7428 6670       axe.plot(fp
+000217d0: 722c 2074 7072 2c20 6c61 6265 6c3d 6e61  r, tpr, label=na
+000217e0: 6d65 202b 2028 2727 2069 6620 6175 635f  me + ('' if auc_
+000217f0: 7363 6f72 6520 6973 204e 6f6e 6520 0d0a  score is None ..
+00021800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021820: 2020 2020 2020 2020 2065 6c73 6520 6622           else f"
+00021830: 4155 433d 7b72 6f75 6e64 2861 7563 5f73  AUC={round(auc_s
+00021840: 636f 7265 2c20 3329 207d 2229 202c 200d  core, 3) }") , .
+00021850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021860: 2020 636f 6c6f 7220 3d20 636f 6c6f 7273    color = colors
+00021870: 5b6b 5d20 2029 0d0a 2020 2020 2020 2020  [k]  )..        
+00021880: 0d0a 2020 2020 2020 2020 6966 2061 6c6c  ..        if all
+00021890: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
+000218a0: 6178 652e 706c 6f74 285b 302c 2031 5d2c  axe.plot([0, 1],
+000218b0: 205b 302c 2031 5d2c 2027 6b2d 2d27 2920   [0, 1], 'k--') 
+000218c0: 0d0a 2020 2020 2020 2020 2020 2020 6178  ..            ax
+000218d0: 652e 6c65 6765 6e64 2028 290d 0a20 2020  e.legend ()..   
+000218e0: 2020 2020 2020 2020 2061 7865 2e73 6574           axe.set
+000218f0: 5f78 6c61 6265 6c20 2822 4661 6c73 6520  _xlabel ("False 
+00021900: 506f 7369 7469 7665 2052 6174 6520 2846  Positive Rate (F
+00021910: 5052 2922 290d 0a20 2020 2020 2020 2020  PR)")..         
+00021920: 2020 2061 7865 2e73 6574 5f79 6c61 6265     axe.set_ylabe
+00021930: 6c20 2822 5472 7565 2050 6f73 6974 6976  l ("True Positiv
+00021940: 6520 5261 7465 2028 4650 5229 2229 0d0a  e Rate (FPR)")..
+00021950: 2020 2020 2020 2020 2320 656c 7365 3a20          # else: 
+00021960: 0d0a 2020 2020 2020 2020 2320 2020 2020  ..        #     
+00021970: 6178 2e70 6c6f 7428 6670 722c 2074 7072  ax.plot(fpr, tpr
+00021980: 2c20 6c61 6265 6c3d 6e61 6d65 2c20 636f  , label=name, co
+00021990: 6c6f 7220 3d20 636f 6c6f 7273 5b6b 5d29  lor = colors[k])
+000219a0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+000219b0: 2020 2020 6966 206e 6f74 2061 6c6c 3a20      if not all: 
+000219c0: 0d0a 2020 2020 2020 2020 6178 2e70 6c6f  ..        ax.plo
+000219d0: 7428 5b30 2c20 315d 2c20 5b30 2c20 315d  t([0, 1], [0, 1]
+000219e0: 2c20 276b 2d2d 2729 2023 2041 5543 203d  , 'k--') # AUC =
+000219f0: 2e35 200d 0a20 2020 2020 2020 2061 782e  .5 ..        ax.
+00021a00: 7365 745f 786c 6162 656c 2028 2246 616c  set_xlabel ("Fal
+00021a10: 7365 2050 6f73 6974 6976 6520 5261 7465  se Positive Rate
+00021a20: 2028 4650 5229 2229 0d0a 2020 2020 2020   (FPR)")..      
+00021a30: 2020 6178 2e73 6574 5f79 6c61 6265 6c20    ax.set_ylabel 
+00021a40: 2822 5472 7565 2050 6f73 6974 6976 6520  ("True Positive 
+00021a50: 5261 7465 2028 4650 5229 2229 0d0a 2020  Rate (FPR)")..  
+00021a60: 2020 2020 2020 6178 2e6c 6567 656e 6428        ax.legend(
+00021a70: 2920 0d0a 2020 2020 2020 2020 0d0a 2020  ) ..        ..  
+00021a80: 2020 7265 7475 726e 2061 7820 0d0a 2020    return ax ..  
+00021a90: 2020 2020 2020 0d0a 0d0a 2020 2020 0d0a        ....    ..
+00021aa0: 2020 0d0a 2020 2020 0d0a 2020 0d0a 2020    ..    ..  ..  
+00021ab0: 2020 0d0a 2020 0d0a 2020 2020 0d0a 2020    ..  ..    ..  
+00021ac0: 0d0a 2020 2020 0d0a 2020 0d0a 2020 2020  ..    ..  ..    
+00021ad0: 0d0a 2020 0d0a 2020 2020 0d0a 2020 0d0a  ..  ..    ..  ..
+00021ae0: 2020 2020 0d0a 2020 0d0a 2020 2020 0d0a      ..  ..    ..
+00021af0: 2020 0d0a 2020 2020 0d0a 2020 0d0a 2020    ..    ..  ..  
+00021b00: 2020 0d0a 2020 0d0a 2020 2020 0d0a 2020    ..  ..    ..  
+00021b10: 0d0a 2020 2020 0d0a 2020 0d0a 2020 2020  ..    ..  ..    
+00021b20: 0d0a 2020 0d0a 2020 2020 0d0a 2020 0d0a  ..  ..    ..  ..
+00021b30: 2020 2020 0d0a 2020 0d0a 2020 2020 0d0a      ..  ..    ..
+00021b40: 2020 0d0a 2020 2020 0d0a 2020 0d0a 2020    ..    ..  ..  
+00021b50: 2020 0d0a 2020 0d0a 2020 2020 0d0a 2020    ..  ..    ..  
+00021b60: 0d0a 2020 2020 0d0a 2020 0d0a 2020 2020  ..    ..  ..    
+00021b70: 0d0a 2020 0d0a 2020 2020 0d0a 2020 2020  ..  ..    ..    
+00021b80: 0d0a 2020 2020 0d0a 2020 2020 0d0a       ..    ..    ..
```

### Comparing `watex-0.2.3/watex/utils/setup.py` & `watex-0.2.4/watex/utils/setup.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/thread.py` & `watex-0.2.4/watex/utils/thread.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/utils/validator.py` & `watex-0.2.4/watex/utils/validator.py`

 * *Files 0% similar despite different names*

```diff
@@ -160,14 +160,15 @@
                       f" objects. Got {s_edi} objects.")
     else: 
         obj_type ='EDI' if isinstance ( 
             z_or_edis_obj_list[0], Edi) else 'Z'
         
     return obj_type 
        
+
 def assert_xy_in (
     x, 
     y, *, 
     data=None,
     asarray=True, 
     to_frame=False, 
     columns= None,
```

### Comparing `watex-0.2.3/watex/utils/version.py` & `watex-0.2.4/watex/utils/version.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/view/__init__.py` & `watex-0.2.4/watex/view/__init__.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/view/mlplot.py` & `watex-0.2.4/watex/view/mlplot.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/view/plot.py` & `watex-0.2.4/watex/view/plot.py`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex/wlog.yml` & `watex-0.2.4/watex/wlog.yml`

 * *Files identical despite different names*

### Comparing `watex-0.2.3/watex.egg-info/PKG-INFO` & `watex-0.2.4/watex.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: watex
-Version: 0.2.3
+Version: 0.2.4
 Summary: Machine learning research in water exploration
 Home-page: https://github.com/WEgeophysics/watex
 Download-URL: https://pypi.org/project/watex/#files
 Author: Laurent Kouadio
 Author-email: etanoyau@gmail.com
 Maintainer: Laurent Kouadio
 Maintainer-email: etanoyau@gmail.com
@@ -163,15 +163,15 @@
 ``k`` -aquifer similarity label prediction and the supervising learning for 
 final ``k``-value prediction. For our toy example, we use two boreholes data 
 stored in the software and merge them to compose a unique dataset. In addition, we dropped the 
 ``remark`` observation which is subjective data not useful for ``k`` prediction as:
 
 ```python
 import watex as wx
-h= wx.fetch_data("hlogs", key='*', drop_observations =True ) # returns log data object.
+h= wx.fetch_data("hlogs", key='h502 h2601', drop_observations =True ) # returns log data object.
 h.feature_names
 Out[3]: Index(['hole_id', 'depth_top', 'depth_bottom', 'strata_name', 'rock_name',
            'layer_thickness', 'resistivity', 'gamma_gamma', 'natural_gamma', 'sp',
            'short_distance_gamma', 'well_diameter'],
           dtype='object')
 hdata = h.frame 
 ```
```

### Comparing `watex-0.2.3/watex.egg-info/SOURCES.txt` & `watex-0.2.4/watex.egg-info/SOURCES.txt`

 * *Files 1% similar despite different names*

```diff
@@ -87,14 +87,15 @@
 docs/whatsnew/v0.1.7.rst
 docs/whatsnew/v0.1.8.rst
 docs/whatsnew/v0.1.9.rst
 docs/whatsnew/v0.2.0.rst
 docs/whatsnew/v0.2.1.rst
 docs/whatsnew/v0.2.2.rst
 docs/whatsnew/v0.2.3.rst
+docs/whatsnew/v0.2.4.rst
 examples/README.txt
 examples/analysis/README.txt
 examples/analysis/plot_decision_regions.py
 examples/analysis/plot_explained_variance_ratio.py
 examples/analysis/plot_linear_discriminant_analysis.py
 examples/analysis/plot_pca_vs_factor_with_scedatic_noises.py
 examples/applications/README.txt
```

